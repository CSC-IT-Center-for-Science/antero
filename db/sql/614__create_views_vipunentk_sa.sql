USE [VipunenTK_SA]
GO
/****** Object:  View [dbo].[v_6_2_Koulutuksen_jarjestajarekisteri_13]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_6_2_Koulutuksen_jarjestajarekisteri_13]'))
EXEC dbo.sp_executesql @statement = N'/****** Script for SelectTopNRows command from SSMS  ******/

CREATE VIEW [dbo].[v_6_2_Koulutuksen_jarjestajarekisteri_13] AS
SELECT [tilv]
      ,[jarj]
      , (CASE 
      WHEN [ysyntv]!= '''' and [ysyntkk]!= '''' THEN ''''+[ysyntv]+''-''+[ysyntkk]+''-01 00:00:00.0000000''
      WHEN [ysyntv] != '''' THEN  ''''+[ysyntv]+''-01-01 00:00:00.0000000''
      ELSE ''1999-01-01 00:00:00.0000000'' END) as alkaa
      ,(CASE 
      WHEN [ylakkv] = ''2012'' and [ylakkkk]!='''' THEN ''''+[ylakkv]+''-''+[ylakkkk]+''-01 00:00:00.0000000''
      WHEN [ylakkv] = ''2012'' THEN  ''''+[ylakkv]+''-01-01 00:00:00.0000000''
      ELSE ''9999-01-01 00:00:00.0000000'' END) as paattyy
      ,[ylnimi]
      ,''*SV*''+[ylnimi]+'''' as [ylnimi_SV]
      ,''*EN*''+[ylnimi]+'''' as [ylnimi_EN]
      ,[ysyntv]
      ,[ysyntkk]
      ,[ylakkv]
      ,[ylakkkk]
      ,[ujarj]
      ,[yolo]
      ,[yomist]
      ,[ykieli]
      ,[ykunta]
      ,[tietolahde]=''6_2_Koulutuksen_jarjestajarekisteri_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_6_2_sopv_13]
  where ylakkv>=''2012'' or ylakkv = ''''
' 
GO
/****** Object:  View [dbo].[v_K3_12_Perusk_paattaneet_amm_tutk_suorittaneet]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_K3_12_Perusk_paattaneet_amm_tutk_suorittaneet]'))
EXEC dbo.sp_executesql @statement = N'














CREATE VIEW [dbo].[v_K3_12_Perusk_paattaneet_amm_tutk_suorittaneet] AS
SELECT [tilv]
      ,[tilv_date]
      ,(case when [tutkryh] is NULL then '''' else [tutkryh] end ) as [tutkryh]
      ,(case when [suorv] is NULL then '''' else [suorv] end ) as [suorv]
	  ,(case when [suorlk] is NULL then '''' else [suorlk] end ) as [suorlk]
	  ,(case when [sp] is NULL then '''' else [sp] end ) as [sp]
      ,(case when [syntv] is NULL then '''' else [syntv] end ) as [syntv]
	  ,(case when [aikielir1] is NULL then '''' else [aikielir1] end ) as [aikielir1]
      ,(case when [tutkaskun] is NULL then '''' else [tutkaskun] end ) as [tutkaskun]
       ,(case when [kansalr1] is NULL then '''' else [kansalr1] end ) as [kansalr1]
    ,(case when [pohjmaa] is NULL then '''' else [pohjmaa] end ) as [pohjmaa]
      ,(case when [eumaa] is NULL then '''' else [eumaa] end ) as [eumaa]
        ,(case when [etamaa] is NULL then '''' else [etamaa] end ) as [etamaa]
       ,(case when [tunn] is NULL then '''' else [tunn] end ) as [tunn]
       ,(case when [jarj] is NULL then '''' else [jarj] end ) as [jarj]
      ,(case when [kkielir1] is NULL then '''' else [kkielir1] end ) as [kkielir1]
       ,(case when [tutklaja] is NULL then '''' else [tutklaja] end ) as [tutklaja]
      ,(case when [tutktav] is NULL then '''' else [tutktav] end ) as [tutktav]
      ,(case when [aikoul] is NULL then '''' else [aikoul] end ) as [aikoul]
       ,(case when [tutkmaak] is NULL then '''' else [tutkmaak] end ) as [tutkmaak]
	    ,(case when [luopiskkoulk2008] is NULL then '''' else [luopiskkoulk2008] end ) as [luopiskkoulk2008]
		 ,(case when [luopisktunn2008] is NULL then '''' else [luopisktunn2008] end ) as [luopisktunn2008]
		  ,(case when [luopiskjarj2008] is NULL then '''' else [luopiskjarj2008] end ) as [luopiskjarj2008]
		   ,(case when [luopiskmaak2008] is NULL then '''' else [luopiskmaak2008] end ) as [luopiskmaak2008]
      ,(case when [ammopiskkoulk2008] is NULL then '''' else [ammopiskkoulk2008] end ) as [ammopiskkoulk2008]
		 ,(case when [ammopisktunn2008] is NULL then '''' else [ammopisktunn2008] end ) as [ammopisktunn2008]
		  ,(case when [ammopiskjarj2008] is NULL then '''' else [ammopiskjarj2008] end ) as [ammopiskjarj2008]
		   ,(case when [ammopiskmaak2008] is NULL then '''' else [ammopiskmaak2008] end ) as [ammopiskmaak2008]
		   ,(case when [amkopiskkoulk2008] is NULL then '''' else [amkopiskkoulk2008] end ) as [amkopiskkoulk2008]
		 ,(case when [amkopisktunn2008] is NULL then '''' else [amkopisktunn2008] end ) as [amkopisktunn2008]
		  ,(case when [amkopiskjarj2008] is NULL then '''' else [amkopiskjarj2008] end ) as [amkopiskjarj2008]
		   ,(case when [amkopiskmaak2008] is NULL then '''' else [amkopiskmaak2008] end ) as [amkopiskmaak2008]
       ,(case when [yoopiskkoulk2008] is NULL then '''' else [yoopiskkoulk2008] end ) as [yoopiskkoulk2008]
		 ,(case when [yoopisktunn2008] is NULL then '''' else [yoopisktunn2008] end ) as [yoopisktunn2008]
		  ,(case when [yoopiskjarj2008] is NULL then '''' else [yoopiskjarj2008] end ) as [yoopiskjarj2008]
		   ,(case when [yoopiskmaak2008] is NULL then '''' else [yoopiskmaak2008] end ) as [yoopiskmaak2008]
     
   ,(case when [monihaku2008] is NULL then '''' else [monihaku2008] end ) as [monihaku2008]
		  ,(case when [ptoim1r4_2008] is NULL then '''' else [ptoim1r4_2008] end ) as [ptoim1r4_2008]
		   ,(case when [amas_2008] is NULL then '''' else [amas_2008] end ) as [amas_2008]
    
     
        ,(case when [luopiskkoulk2009] is NULL then '''' else [luopiskkoulk2009] end ) as [luopiskkoulk2009]
		 ,(case when [luopisktunn2009] is NULL then '''' else [luopisktunn2009] end ) as [luopisktunn2009]
		  ,(case when [luopiskjarj2009] is NULL then '''' else [luopiskjarj2009] end ) as [luopiskjarj2009]
		   ,(case when [luopiskmaak2009] is NULL then '''' else [luopiskmaak2009] end ) as [luopiskmaak2009]
      ,(case when [ammopiskkoulk2009] is NULL then '''' else [ammopiskkoulk2009] end ) as [ammopiskkoulk2009]
		 ,(case when [ammopisktunn2009] is NULL then '''' else [ammopisktunn2009] end ) as [ammopisktunn2009]
		  ,(case when [ammopiskjarj2009] is NULL then '''' else [ammopiskjarj2009] end ) as [ammopiskjarj2009]
		   ,(case when [ammopiskmaak2009] is NULL then '''' else [ammopiskmaak2009] end ) as [ammopiskmaak2009]
		   ,(case when [amkopiskkoulk2009] is NULL then '''' else [amkopiskkoulk2009] end ) as [amkopiskkoulk2009]
		 ,(case when [amkopisktunn2009] is NULL then '''' else [amkopisktunn2009] end ) as [amkopisktunn2009]
		  ,(case when [amkopiskjarj2009] is NULL then '''' else [amkopiskjarj2009] end ) as [amkopiskjarj2009]
		   ,(case when [amkopiskmaak2009] is NULL then '''' else [amkopiskmaak2009] end ) as [amkopiskmaak2009]
       ,(case when [yoopiskkoulk2009] is NULL then '''' else [yoopiskkoulk2009] end ) as [yoopiskkoulk2009]
		 ,(case when [yoopisktunn2009] is NULL then '''' else [yoopisktunn2009] end ) as [yoopisktunn2009]
		  ,(case when [yoopiskjarj2009] is NULL then '''' else [yoopiskjarj2009] end ) as [yoopiskjarj2009]
		   ,(case when [yoopiskmaak2009] is NULL then '''' else [yoopiskmaak2009] end ) as [yoopiskmaak2009]
     
   ,(case when [monihaku2009] is NULL then '''' else [monihaku2009] end ) as [monihaku2009]
		  ,(case when [ptoim1r4_2009] is NULL then '''' else [ptoim1r4_2009] end ) as [ptoim1r4_2009]
		   ,(case when [amas_2009] is NULL then '''' else [amas_2009] end ) as [amas_2009]
  ,(case when [luopiskkoulk2010] is NULL then '''' else [luopiskkoulk2010] end ) as [luopiskkoulk2010]
		 ,(case when [luopisktunn2010] is NULL then '''' else [luopisktunn2010] end ) as [luopisktunn2010]
		  ,(case when [luopiskjarj2010] is NULL then '''' else [luopiskjarj2010] end ) as [luopiskjarj2010]
		   ,(case when [luopiskmaak2010] is NULL then '''' else [luopiskmaak2010] end ) as [luopiskmaak2010]
      ,(case when [ammopiskkoulk2010] is NULL then '''' else [ammopiskkoulk2010] end ) as [ammopiskkoulk2010]
		 ,(case when [ammopisktunn2010] is NULL then '''' else [ammopisktunn2010] end ) as [ammopisktunn2010]
		  ,(case when [ammopiskjarj2010] is NULL then '''' else [ammopiskjarj2010] end ) as [ammopiskjarj2010]
		   ,(case when [ammopiskmaak2010] is NULL then '''' else [ammopiskmaak2010] end ) as [ammopiskmaak2010]
		   ,(case when [amkopiskkoulk2010] is NULL then '''' else [amkopiskkoulk2010] end ) as [amkopiskkoulk2010]
		 ,(case when [amkopisktunn2010] is NULL then '''' else [amkopisktunn2010] end ) as [amkopisktunn2010]
		  ,(case when [amkopiskjarj2010] is NULL then '''' else [amkopiskjarj2010] end ) as [amkopiskjarj2010]
		   ,(case when [amkopiskmaak2010] is NULL then '''' else [amkopiskmaak2010] end ) as [amkopiskmaak2010]
       ,(case when [yoopiskkoulk2010] is NULL then '''' else [yoopiskkoulk2010] end ) as [yoopiskkoulk2010]
		 ,(case when [yoopisktunn2010] is NULL then '''' else [yoopisktunn2010] end ) as [yoopisktunn2010]
		  ,(case when [yoopiskjarj2010] is NULL then '''' else [yoopiskjarj2010] end ) as [yoopiskjarj2010]
		   ,(case when [yoopiskmaak2010] is NULL then '''' else [yoopiskmaak2010] end ) as [yoopiskmaak2010]
     
   ,(case when [monihaku2010] is NULL then '''' else [monihaku2010] end ) as [monihaku2010]
		  ,(case when [ptoim1r4_2010] is NULL then '''' else [ptoim1r4_2010] end ) as [ptoim1r4_2010]
		   ,(case when [amas_2010] is NULL then '''' else [amas_2010] end ) as [amas_2010]
       ,(case when [luopiskkoulk2011] is NULL then '''' else [luopiskkoulk2011] end ) as [luopiskkoulk2011]
		 ,(case when [luopisktunn2011] is NULL then '''' else [luopisktunn2011] end ) as [luopisktunn2011]
		  ,(case when [luopiskjarj2011] is NULL then '''' else [luopiskjarj2011] end ) as [luopiskjarj2011]
		   ,(case when [luopiskmaak2011] is NULL then '''' else [luopiskmaak2011] end ) as [luopiskmaak2011]
      ,(case when [ammopiskkoulk2011] is NULL then '''' else [ammopiskkoulk2011] end ) as [ammopiskkoulk2011]
		 ,(case when [ammopisktunn2011] is NULL then '''' else [ammopisktunn2011] end ) as [ammopisktunn2011]
		  ,(case when [ammopiskjarj2011] is NULL then '''' else [ammopiskjarj2011] end ) as [ammopiskjarj2011]
		   ,(case when [ammopiskmaak2011] is NULL then '''' else [ammopiskmaak2011] end ) as [ammopiskmaak2011]
		   ,(case when [amkopiskkoulk2011] is NULL then '''' else [amkopiskkoulk2011] end ) as [amkopiskkoulk2011]
		 ,(case when [amkopisktunn2011] is NULL then '''' else [amkopisktunn2011] end ) as [amkopisktunn2011]
		  ,(case when [amkopiskjarj2011] is NULL then '''' else [amkopiskjarj2011] end ) as [amkopiskjarj2011]
		   ,(case when [amkopiskmaak2011] is NULL then '''' else [amkopiskmaak2011] end ) as [amkopiskmaak2011]
       ,(case when [yoopiskkoulk2011] is NULL then '''' else [yoopiskkoulk2011] end ) as [yoopiskkoulk2011]
		 ,(case when [yoopisktunn2011] is NULL then '''' else [yoopisktunn2011] end ) as [yoopisktunn2011]
		  ,(case when [yoopiskjarj2011] is NULL then '''' else [yoopiskjarj2011] end ) as [yoopiskjarj2011]
		   ,(case when [yoopiskmaak2011] is NULL then '''' else [yoopiskmaak2011] end ) as [yoopiskmaak2011]
     
   ,(case when [monihaku2011] is NULL then '''' else [monihaku2011] end ) as [monihaku2011]
		  ,(case when [ptoim1r4_2011] is NULL then '''' else [ptoim1r4_2011] end ) as [ptoim1r4_2011]
		   ,(case when [amas_2011] is NULL then '''' else [amas_2011] end ) as [amas_2011]
      
        ,(case when [luopiskkoulk2012] is NULL then '''' else [luopiskkoulk2012] end ) as [luopiskkoulk2012]
		 ,(case when [luopisktunn2012] is NULL then '''' else [luopisktunn2012] end ) as [luopisktunn2012]
		  ,(case when [luopiskjarj2012] is NULL then '''' else [luopiskjarj2012] end ) as [luopiskjarj2012]
		   ,(case when [luopiskmaak2012] is NULL then '''' else [luopiskmaak2012] end ) as [luopiskmaak2012]
      ,(case when [ammopiskkoulk2012] is NULL then '''' else [ammopiskkoulk2012] end ) as [ammopiskkoulk2012]
		 ,(case when [ammopisktunn2012] is NULL then '''' else [ammopisktunn2012] end ) as [ammopisktunn2012]
		  ,(case when [ammopiskjarj2012] is NULL then '''' else [ammopiskjarj2012] end ) as [ammopiskjarj2012]
		   ,(case when [ammopiskmaak2012] is NULL then '''' else [ammopiskmaak2012] end ) as [ammopiskmaak2012]
		   ,(case when [amkopiskkoulk2012] is NULL then '''' else [amkopiskkoulk2012] end ) as [amkopiskkoulk2012]
		 ,(case when [amkopisktunn2012] is NULL then '''' else [amkopisktunn2012] end ) as [amkopisktunn2012]
		  ,(case when [amkopiskjarj2012] is NULL then '''' else [amkopiskjarj2012] end ) as [amkopiskjarj2012]
		   ,(case when [amkopiskmaak2012] is NULL then '''' else [amkopiskmaak2012] end ) as [amkopiskmaak2012]
       ,(case when [yoopiskkoulk2012] is NULL then '''' else [yoopiskkoulk2012] end ) as [yoopiskkoulk2012]
		 ,(case when [yoopisktunn2012] is NULL then '''' else [yoopisktunn2012] end ) as [yoopisktunn2012]
		  ,(case when [yoopiskjarj2012] is NULL then '''' else [yoopiskjarj2012] end ) as [yoopiskjarj2012]
		   ,(case when [yoopiskmaak2012] is NULL then '''' else [yoopiskmaak2012] end ) as [yoopiskmaak2012]
     
   ,(case when [monihaku2012] is NULL then '''' else [monihaku2012] end ) as [monihaku2012]
		  ,(case when [ptoim1r4_2012] is NULL then '''' else [ptoim1r4_2012] end ) as [ptoim1r4_2012]
		   ,(case when [amas_2012] is NULL then '''' else [amas_2012] end ) as [amas_2012]
	   ,(case when [luopiskkoulk2013] is NULL then '''' else [luopiskkoulk2013] end ) as [luopiskkoulk2013]
		 ,(case when [luopisktunn2013] is NULL then '''' else [luopisktunn2013] end ) as [luopisktunn2013]
		  ,(case when [luopiskjarj2013] is NULL then '''' else [luopiskjarj2013] end ) as [luopiskjarj2013]
		   ,(case when [luopiskmaak2013] is NULL then '''' else [luopiskmaak2013] end ) as [luopiskmaak2013]
      ,(case when [ammopiskkoulk2013] is NULL then '''' else [ammopiskkoulk2013] end ) as [ammopiskkoulk2013]
		 ,(case when [ammopisktunn2013] is NULL then '''' else [ammopisktunn2013] end ) as [ammopisktunn2013]
		  ,(case when [ammopiskjarj2013] is NULL then '''' else [ammopiskjarj2013] end ) as [ammopiskjarj2013]
		   ,(case when [ammopiskmaak2013] is NULL then '''' else [ammopiskmaak2013] end ) as [ammopiskmaak2013]
		   ,(case when [amkopiskkoulk2013] is NULL then '''' else [amkopiskkoulk2013] end ) as [amkopiskkoulk2013]
		 ,(case when [amkopisktunn2013] is NULL then '''' else [amkopisktunn2013] end ) as [amkopisktunn2013]
		  ,(case when [amkopiskjarj2013] is NULL then '''' else [amkopiskjarj2013] end ) as [amkopiskjarj2013]
		   ,(case when [amkopiskmaak2013] is NULL then '''' else [amkopiskmaak2013] end ) as [amkopiskmaak2013]
       ,(case when [yoopiskkoulk2013] is NULL then '''' else [yoopiskkoulk2013] end ) as [yoopiskkoulk2013]
		 ,(case when [yoopisktunn2013] is NULL then '''' else [yoopisktunn2013] end ) as [yoopisktunn2013]
		  ,(case when [yoopiskjarj2013] is NULL then '''' else [yoopiskjarj2013] end ) as [yoopiskjarj2013]
		   ,(case when [yoopiskmaak2013] is NULL then '''' else [yoopiskmaak2013] end ) as [yoopiskmaak2013]
     
   ,(case when [monihaku2013] is NULL then '''' else [monihaku2013] end ) as [monihaku2013]
		  ,(case when [ptoim1r4_2013] is NULL then '''' else [ptoim1r4_2013] end ) as [ptoim1r4_2013]
		   ,(case when [amas_2013] is NULL then '''' else [amas_2013] end ) as [amas_2013]
		   	   ,(case when [luopiskkoulk2014] is NULL then '''' else [luopiskkoulk2014] end ) as [luopiskkoulk2014]
		 ,(case when [luopisktunn2014] is NULL then '''' else [luopisktunn2014] end ) as [luopisktunn2014]
		  ,(case when [luopiskjarj2014] is NULL then '''' else [luopiskjarj2014] end ) as [luopiskjarj2014]
		   ,(case when [luopiskmaak2014] is NULL then '''' else [luopiskmaak2014] end ) as [luopiskmaak2014]
      ,(case when [ammopiskkoulk2014] is NULL then '''' else [ammopiskkoulk2014] end ) as [ammopiskkoulk2014]
		 ,(case when [ammopisktunn2014] is NULL then '''' else [ammopisktunn2014] end ) as [ammopisktunn2014]
		  ,(case when [ammopiskjarj2014] is NULL then '''' else [ammopiskjarj2014] end ) as [ammopiskjarj2014]
		   ,(case when [ammopiskmaak2014] is NULL then '''' else [ammopiskmaak2014] end ) as [ammopiskmaak2014]
		   ,(case when [amkopiskkoulk2014] is NULL then '''' else [amkopiskkoulk2014] end ) as [amkopiskkoulk2014]
		 ,(case when [amkopisktunn2014] is NULL then '''' else [amkopisktunn2014] end ) as [amkopisktunn2014]
		  ,(case when [amkopiskjarj2014] is NULL then '''' else [amkopiskjarj2014] end ) as [amkopiskjarj2014]
		   ,(case when [amkopiskmaak2014] is NULL then '''' else [amkopiskmaak2014] end ) as [amkopiskmaak2014]
       ,(case when [yoopiskkoulk2014] is NULL then '''' else [yoopiskkoulk2014] end ) as [yoopiskkoulk2014]
		 ,(case when [yoopisktunn2014] is NULL then '''' else [yoopisktunn2014] end ) as [yoopisktunn2014]
		  ,(case when [yoopiskjarj2014] is NULL then '''' else [yoopiskjarj2014] end ) as [yoopiskjarj2014]
		   ,(case when [yoopiskmaak2014] is NULL then '''' else [yoopiskmaak2014] end ) as [yoopiskmaak2014]
     
   ,(case when [monihaku2014] is NULL then '''' else [monihaku2014] end ) as [monihaku2014]
		  ,(case when [ptoim1r4_2014] is NULL then '''' else [ptoim1r4_2014] end ) as [ptoim1r4_2014]
		   ,(case when [amas_2014] is NULL then '''' else [amas_2014] end ) as [amas_2014]
      ,[lkm]
	  ,(case when [pohjkoul] is NULL then '''' else [pohjkoul] end ) as [pohjkoul]
      ,[tietolahde]
      ,[rivinumero]
FROM (
SELECT
tilv, 
CAST(tilv + ''0101'' AS date) AS tilv_date,
tutkryh,
suorv,
suorlk,
sp,
(CASE WHEN [syntv]=''19XX'' THEN '''' ELSE [syntv] END) as syntv,
aikielir1,
-- tutkaskun 427 tuntemattomaksi Tilastokeskuksen luvalla, avoimet ongelmat sivulla 25.3.2014 tieto tullut tähän
(CASE WHEN [tutkaskun]=''427'' THEN '''' 
      WHEN [tutkaskun]= ''946'' and (tilv= ''2009'' or tilv=''2010'') then ''945''
      WHEN [tutkaskun]= ''198'' THEN ''''
	  WHEN [tutkaskun]=''999'' THEN ''''
ELSE [tutkaskun] END) as tutkaskun,
kansalr1,
pohjmaa,
eumaa,
etamaa,
(CASE WHEN [tunn] = ''BBBBB'' THEN ''''
      WHEN [tunn] = ''99999'' THEN ''''
      WHEN [tunn] = ''00000'' THEN '''' 
      when [tunn] = ''90009'' AND [tilv] = ''2009'' THEN ''''
      when [tunn] = ''90015'' AND [tilv] = ''2009'' THEN ''''
      when [tunn] = ''90010'' AND [tilv] = ''2009'' THEN ''''
      when [tunn] = ''90018'' AND [tilv] = ''2009'' THEN ''''
      when [tunn] = ''90008'' AND [tilv] = ''2010'' THEN ''''
      when [tunn] = ''90032'' AND [tilv] = ''2010'' THEN ''''
      when [tunn] = ''90032'' AND [tilv] = ''2011'' THEN ''''
      when [tunn] = ''90018'' AND [tilv] = ''2011'' THEN ''''
      when [tunn] = ''90006'' AND [tilv] = ''2009'' THEN ''''
      when [tunn] = ''90006'' AND [tilv] = ''2010'' THEN ''''
      when [tunn] = ''90006'' AND [tilv] = ''2011'' THEN ''''
      when [tunn] = ''90018'' AND [tilv] = ''2012'' THEN ''''
      ELSE [tunn] END) AS tunn,
jarj,
kkielir1,
tutklaja,
tutktav, 
aikoul, 
(CASE WHEN [tutkmaak] = ''99'' THEN '''' ELSE [tutkmaak] END) AS tutkmaak, 
luopiskkoulk_2008 AS luopiskkoulk2008, 
(CASE WHEN [luopisktunn_2008] = ''BBBBB'' THEN ''''
      WHEN [luopisktunn_2008] = ''99999'' THEN ''''
      WHEN [luopisktunn_2008] = ''00000'' THEN '''' 

      ELSE [luopisktunn_2008] END) AS luopisktunn2008,
luopiskjarj_2008 AS luopiskjarj2008,
(CASE WHEN [luopiskmaak_2008] = ''99'' THEN '''' ELSE [luopiskmaak_2008] END) AS luopiskmaak2008,
ammopiskkoulk_2008 AS ammopiskkoulk2008, 
(CASE WHEN [ammopisktunn_2008] = ''BBBBB'' THEN ''''
      WHEN [ammopisktunn_2008] = ''99999'' THEN ''''
      WHEN [ammopisktunn_2008] = ''00000'' THEN ''''
      when [ammopisktunn_2008]  = ''90009'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2008]  = ''90015'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2008]  = ''90010'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2008] = ''90018'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2008] = ''90008'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2008]  = ''90032'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2008]  = ''90032'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2008]  = ''90018'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2008]  = ''90006'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2008]  = ''90006'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2008]  = ''90006'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2008] = ''90018'' AND [tilv] = ''2012'' THEN ''''
      ELSE [ammopisktunn_2008] END) AS ammopisktunn2008,
ammopiskjarj_2008 AS ammopiskjarj2008, 
(CASE WHEN [ammopiskmaak_2008] = ''99'' THEN '''' ELSE [ammopiskmaak_2008] END) AS ammopiskmaak2008, 
amkopiskkoulk_2008 AS amkopiskkoulk2008, 
(CASE WHEN [amkopisktunn_2008] = ''BBBBB'' THEN ''''
      WHEN [amkopisktunn_2008] = ''99999'' THEN '''' 
       WHEN [amkopisktunn_2008] = ''00000'' THEN '''' ELSE [amkopisktunn_2008]  END) AS amkopisktunn2008,
amkopiskjarj_2008 AS amkopiskjarj2008, 
(CASE WHEN [amkopiskmaak_2008] = ''99'' THEN '''' ELSE [amkopiskmaak_2008]END) AS amkopiskmaak2008,
yoopiskkoulk_2008 AS yoopiskkoulk2008,
(CASE WHEN [yoopisktunn_2008] = ''BBBBB'' THEN ''''
      WHEN [yoopisktunn_2008] = ''99999'' THEN ''''
       WHEN [yoopisktunn_2008] = ''00000'' THEN ''''  ELSE [yoopisktunn_2008]  END) AS yoopisktunn2008,
yoopiskjarj_2008 AS yoopiskjarj2008, 
(CASE WHEN [yoopiskmaak_2008] = ''99'' THEN '''' ELSE [yoopiskmaak_2008] END) AS yoopiskmaak2008,
monihaku_2008 AS monihaku2008, 
ptoim1r4_2008, 
amas_2008, 
luopiskkoulk_2009 AS luopiskkoulk2009, 
(CASE WHEN [luopisktunn_2009] = ''BBBBB'' THEN ''''
      WHEN [luopisktunn_2009] = ''99999'' THEN ''''
      WHEN [luopisktunn_2009] = ''00000'' THEN '''' 
      ELSE [luopisktunn_2009] END) AS luopisktunn2009,
luopiskjarj_2009 AS luopiskjarj2009,
(CASE WHEN [luopiskmaak_2009] = ''99'' THEN '''' ELSE [luopiskmaak_2009] END) AS luopiskmaak2009,
ammopiskkoulk_2009 AS ammopiskkoulk2009, 
(CASE WHEN [ammopisktunn_2009] = ''BBBBB'' THEN ''''
      WHEN [ammopisktunn_2009] = ''99999'' THEN ''''
      WHEN [ammopisktunn_2009] = ''00000'' THEN '''' 
      when [ammopisktunn_2009] = ''90009'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2009] = ''90015'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2009]  = ''90010'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2009]  = ''90018'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2009]  = ''90008'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2009]  = ''90032'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2009]  = ''90032'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2009]  = ''90018'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2009]  = ''90006'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2009]  = ''90006'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2009] = ''90006'' AND [tilv] = ''2011'' THEN ''''
        when [ammopisktunn_2009] = ''90018'' AND [tilv] = ''2012'' THEN ''''
      ELSE [ammopisktunn_2009] END) AS ammopisktunn2009,
ammopiskjarj_2009 as ammopiskjarj2009, 
(CASE WHEN [ammopiskmaak_2009] = ''99'' THEN '''' ELSE [ammopiskmaak_2009] END) AS ammopiskmaak2009, 
amkopiskkoulk_2009 AS amkopiskkoulk2009, 
(CASE WHEN [amkopisktunn_2009] = ''BBBBB'' THEN ''''
      WHEN [amkopisktunn_2009] = ''99999'' THEN '''' 
      WHEN [amkopisktunn_2009] = ''00000'' THEN ''''ELSE [amkopisktunn_2009]  END) AS amkopisktunn2009,
amkopiskjarj_2009 AS amkopiskjarj2009, 
(CASE WHEN [amkopiskmaak_2009] = ''99'' THEN '''' ELSE [amkopiskmaak_2009]END) AS amkopiskmaak2009,
yoopiskkoulk_2009 AS yoopiskkoulk2009,
(CASE WHEN [yoopisktunn_2009] = ''BBBBB'' THEN ''''
      WHEN [yoopisktunn_2009] = ''99999'' THEN ''''
      WHEN [yoopisktunn_2009] = ''00000'' THEN '''' ELSE [yoopisktunn_2009]  END) AS yoopisktunn2009,
yoopiskjarj_2009 AS yoopiskjarj2009, 
(CASE WHEN [yoopiskmaak_2009] = ''99'' THEN '''' ELSE [yoopiskmaak_2009] END) AS yoopiskmaak2009,
monihaku_2009 as monihaku2009, 
ptoim1r4_2009, 
amas_2009, 
 luopiskkoulk2010 = '''',
luopisktunn2010 = '''',
luopiskjarj2010 = '''', 
luopiskmaak2010 = '''', 
ammopiskkoulk2010 = '''', 
ammopisktunn2010 = '''',
ammopiskjarj2010 = '''', 
ammopiskmaak2010 = '''', 
amkopiskkoulk2010 = '''', 
amkopisktunn2010 = '''',
amkopiskjarj2010 = '''',
amkopiskmaak2010 = '''', 
yoopiskkoulk2010 = '''', 
yoopisktunn2010 = '''',
yoopiskjarj2010 = '''', 
yoopiskmaak2010 = '''', 
monihaku2010 = '''',
ptoim1r4_2010 = '''', 
amas_2010 = '''',
 luopiskkoulk2011 = '''',
luopisktunn2011 = '''',
luopiskjarj2011 = '''', 
luopiskmaak2011 = '''', 
ammopiskkoulk2011 = '''', 
ammopisktunn2011 = '''',
ammopiskjarj2011 = '''', 
ammopiskmaak2011 = '''', 
amkopiskkoulk2011 = '''', 
amkopisktunn2011 = '''',
amkopiskjarj2011 = '''',
amkopiskmaak2011 = '''', 
yoopiskkoulk2011 = '''', 
yoopisktunn2011 = '''',
yoopiskjarj2011 = '''', 
yoopiskmaak2011 = '''', 
monihaku2011 = '''',
ptoim1r4_2011 = '''', 
amas_2011 = '''',
luopiskkoulk2012 = '''',
luopisktunn2012 = '''',
luopiskjarj2012 = '''', 
luopiskmaak2012 = '''', 
ammopiskkoulk2012 = '''', 
ammopisktunn2012 = '''',
ammopiskjarj2012 = '''', 
ammopiskmaak2012 = '''', 
amkopiskkoulk2012 = '''', 
amkopisktunn2012 = '''',
amkopiskjarj2012 = '''',
amkopiskmaak2012 = '''', 
yoopiskkoulk2012 = '''', 
yoopisktunn2012 = '''',
yoopiskjarj2012 = '''', 
yoopiskmaak2012 = '''', 
monihaku2012 = '''',
ptoim1r4_2012 = '''', 
amas_2012 = '''',
luopiskkoulk2013 = '''',
luopisktunn2013 = '''',
luopiskjarj2013 = '''', 
luopiskmaak2013 = '''', 
ammopiskkoulk2013 = '''', 
ammopisktunn2013 = '''',
ammopiskjarj2013 = '''', 
ammopiskmaak2013 = '''', 
amkopiskkoulk2013 = '''', 
amkopisktunn2013 = '''',
amkopiskjarj2013 = '''',
amkopiskmaak2013 = '''', 
yoopiskkoulk2013 = '''', 
yoopisktunn2013 = '''',
yoopiskjarj2013 = '''', 
yoopiskmaak2013 = '''', 
monihaku2013 = '''',
ptoim1r4_2013 = '''', 
amas_2013 = '''',
luopiskkoulk2014 = '''',
luopisktunn2014 = '''',
luopiskjarj2014 = '''', 
luopiskmaak2014 = '''', 
ammopiskkoulk2014 = '''', 
ammopisktunn2014= '''',
ammopiskjarj2014 = '''', 
ammopiskmaak2014 = '''', 
amkopiskkoulk2014 = '''', 
amkopisktunn2014 = '''', 
amkopiskjarj2014 = '''',
amkopiskmaak2014 = '''', 
yoopiskkoulk2014 = '''', 
yoopisktunn2014 = '''' ,
yoopiskjarj2014 = '''',
yoopiskmaak2014 = '''',
monihaku2014 = '''', 
ptoim1r4_2014 = '''', 
amas_2014 = '''',
lkm, 
pohjkoul,
 [tietolahde]=''K3_12_sopv_11'',
 [rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_K3_12_sopv_11]
 where suorv = ''2008'' and (suorlk = ''1'' or suorlk= ''2'')
 
 UNION ALL
 
 SELECT
tilv, 
CAST(tilv + ''0101'' AS date) AS tilv_date,
tutkryh,
suorv,
suorlk,
sp,
(CASE WHEN [syntv]=''19XX'' THEN '''' ELSE [syntv] END) as syntv,
aikielir1,
(CASE WHEN [tutkaskun]=''427'' THEN ''''
 WHEN [tutkaskun]= ''946'' and (tilv= ''2009'' or tilv=''2010'') then ''945''
      WHEN [tutkaskun]= ''198'' THEN ''''
	  WHEN [tutkaskun]=''999'' THEN '''' ELSE [tutkaskun] END) as tutkaskun,
kansalr1,
pohjmaa,
eumaa,
etamaa,
(CASE WHEN [tunn] = ''BBBBB'' THEN ''''
      WHEN [tunn] = ''99999'' THEN ''''
      WHEN [tunn] = ''00000'' THEN '''' 
      when [tunn] = ''90009'' AND [tilv] = ''2009'' THEN ''''
      when [tunn] = ''90015'' AND [tilv] = ''2009'' THEN ''''
      when [tunn] = ''90010'' AND [tilv] = ''2009'' THEN ''''
      when [tunn] = ''90018'' AND [tilv] = ''2009'' THEN ''''
      when [tunn] = ''90008'' AND [tilv] = ''2010'' THEN ''''
      when [tunn] = ''90032'' AND [tilv] = ''2010'' THEN ''''
      when [tunn] = ''90032'' AND [tilv] = ''2011'' THEN ''''
      when [tunn] = ''90018'' AND [tilv] = ''2011'' THEN ''''
      when [tunn] = ''90006'' AND [tilv] = ''2009'' THEN ''''
      when [tunn] = ''90006'' AND [tilv] = ''2010'' THEN ''''
      when [tunn] = ''90006'' AND [tilv] = ''2011'' THEN ''''
        when [tunn] = ''90018'' AND [tilv] = ''2012'' THEN ''''
      ELSE [tunn] END) AS tunn,
jarj,
kkielir1,
tutklaja,
tutktav, 
aikoul, 
(CASE WHEN [tutkmaak] = ''99'' THEN '''' ELSE [tutkmaak] END) as tutkmaak,  
luopiskkoulk2008 = '''', 
luopisktunn2008 = '''',
luopiskjarj2008= '''',
luopiskmaak2008= '''',
ammopiskkoulk2008= '''', 
ammopisktunn2008= '''',
ammopiskjarj2008 = '''',
ammopiskmaak2008= '''', 
amkopiskkoulk2008= '''', 
amkopisktunn2008= '''',
amkopiskjarj2008= '''', 
amkopiskmaak2008= '''',
yoopiskkoulk2008= '''',
yoopisktunn2008= '''',
yoopiskjarj2008= '''', 
yoopiskmaak2008= '''',
monihaku2008= '''', 
ptoim1r4_2008= '''', 
amas_2008= '''', 
luopiskkoulk_2009 AS luopiskkoulk2009,
(CASE WHEN [luopisktunn_2009] = ''BBBBB'' THEN ''''
      WHEN [luopisktunn_2009] = ''99999'' THEN ''''
      WHEN [luopisktunn_2009] = ''00000'' THEN ''''
      ELSE [luopisktunn_2009] END) AS luopisktunn2009,
luopiskjarj_2009 AS luopiskjarj2009, 
(CASE WHEN [luopiskmaak_2009] = ''99'' THEN ''''ELSE [luopiskmaak_2009] END) AS luopiskmaak2009, 
ammopiskkoulk_2009 AS ammopiskkoulk2009, 
(CASE WHEN [ammopisktunn_2009] = ''BBBBBB'' THEN ''''
      WHEN [ammopisktunn_2009] = ''99999'' THEN ''''
      WHEN [ammopisktunn_2009] = ''00000'' THEN '''' 
      when [ammopisktunn_2009]  = ''90009'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2009]  = ''90015'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2009]  = ''90010'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2009]  = ''90018'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2009]  = ''90008'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2009]  = ''90032'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2009]  = ''90032'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2009]  = ''90018'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2009]  = ''90006'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2009]  = ''90006'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2009] = ''90006'' AND [tilv] = ''2011'' THEN ''''
        when [ammopisktunn_2009] = ''90018'' AND [tilv] = ''2012'' THEN ''''
      ELSE [ammopisktunn_2009] END)AS ammopisktunn2009,
ammopiskjarj_2009 AS ammopiskjarj2009, 
(CASE WHEN [ammopiskmaak_2009] = ''99'' THEN ''''ELSE [ammopiskmaak_2009] END) as ammopiskmaak2009, 
amkopiskkoulk_2009 AS amkopiskkoulk2009, 
(CASE WHEN [amkopisktunn_2009] = ''BBBBB'' THEN ''''
      WHEN [amkopisktunn_2009] = ''99999'' THEN ''''
      WHEN [amkopisktunn_2009] = ''00000'' THEN '''' ELSE [amkopisktunn_2009] END) AS amkopisktunn2009,
amkopiskjarj_2009 AS amkopiskjarj2009,
(CASE WHEN [amkopiskmaak_2009] = ''99'' THEN '''' ELSE [amkopiskmaak_2009] END) AS amkopiskmaak2009, 
yoopiskkoulk_2009 AS yoopiskkoulk2009, 
(CASE WHEN [yoopisktunn_2009] = ''BBBBB'' THEN ''''
      WHEN [yoopisktunn_2009] = ''99999'' THEN ''''
      WHEN [yoopisktunn_2009] = ''00000'' THEN '''' ELSE [yoopisktunn_2009] END) AS yoopisktunn2009,
yoopiskjarj_2009 AS yoopiskjarj2009,
(CASE WHEN [yoopiskmaak_2009] = ''99'' THEN '''' ELSE [yoopiskmaak_2009] END) AS yoopiskmaak2009,
monihaku_2009 AS monihaku2009, 
ptoim1r4_2009, 
amas_2009, 
luopiskkoulk_2010 AS luopiskkoulk2010,
(CASE WHEN [luopisktunn_2010] = ''BBBBB'' THEN ''''
      WHEN [luopisktunn_2010] = ''99999'' THEN ''''
      WHEN [luopisktunn_2010] = ''00000'' THEN ''''
      ELSE [luopisktunn_2010] END) AS luopisktunn2010,
luopiskjarj_2010 AS luopiskjarj2010, 
(CASE WHEN [luopiskmaak_2010] = ''99'' THEN ''''ELSE [luopiskmaak_2010] END) AS luopiskmaak2010, 
ammopiskkoulk_2010 AS ammopiskkoulk2010, 
(CASE WHEN [ammopisktunn_2010] = ''BBBBBB'' THEN ''''
      WHEN [ammopisktunn_2010] = ''99999'' THEN ''''
      WHEN [ammopisktunn_2010] = ''00000'' THEN '''' 
      when [ammopisktunn_2010]  = ''90009'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2010]  = ''90015'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2010]  = ''90010'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2010]  = ''90018'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2010]  = ''90008'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2010]  = ''90032'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2010]  = ''90032'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2010]  = ''90018'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2010]  = ''90006'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2010]  = ''90006'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2010] = ''90006'' AND [tilv] = ''2011'' THEN ''''
        when [ammopisktunn_2010] = ''90018'' AND [tilv] = ''2012'' THEN ''''
      ELSE [ammopisktunn_2010] END)AS ammopisktunn2010,
ammopiskjarj_2010 AS ammopiskjarj2010, 
(CASE WHEN [ammopiskmaak_2010] = ''99'' THEN ''''ELSE [ammopiskmaak_2010] END) as ammopiskmaak2010, 
amkopiskkoulk_2010 AS amkopiskkoulk2010, 
(CASE WHEN [amkopisktunn_2010] = ''BBBBB'' THEN ''''
      WHEN [amkopisktunn_2010] = ''99999'' THEN ''''
      WHEN [amkopisktunn_2010] = ''00000'' THEN '''' ELSE [amkopisktunn_2010] END) AS amkopisktunn2010,
amkopiskjarj_2010 AS amkopiskjarj2010,
(CASE WHEN [amkopiskmaak_2010] = ''99'' THEN '''' ELSE [amkopiskmaak_2010] END) AS amkopiskmaak2010, 
yoopiskkoulk_2010 AS yoopiskkoulk2010, 
(CASE WHEN [yoopisktunn_2010] = ''BBBBB'' THEN ''''
      WHEN [yoopisktunn_2010] = ''99999'' THEN ''''
      WHEN [yoopisktunn_2010] = ''00000'' THEN '''' ELSE [yoopisktunn_2010] END) AS yoopisktunn2010,
yoopiskjarj_2010 AS yoopiskjarj2010,
(CASE WHEN [yoopiskmaak_2010] = ''99'' THEN '''' ELSE [yoopiskmaak_2010] END) AS yoopiskmaak2010,
monihaku_2010 AS monihaku2010,
ptoim1r4_2010, 
amas_2010,
 luopiskkoulk2011 = '''',
luopisktunn2011 = '''',
luopiskjarj2011 = '''', 
luopiskmaak2011 = '''', 
ammopiskkoulk2011 = '''', 
ammopisktunn2011 = '''',
ammopiskjarj2011 = '''', 
ammopiskmaak2011 = '''', 
amkopiskkoulk2011 = '''', 
amkopisktunn2011 = '''',
amkopiskjarj2011 = '''',
amkopiskmaak2011 = '''', 
yoopiskkoulk2011 = '''', 
yoopisktunn2011 = '''',
yoopiskjarj2011 = '''', 
yoopiskmaak2011 = '''', 
monihaku2011 = '''',
ptoim1r4_2011 = '''', 
amas_2011 = '''',
luopiskkoulk2012 = '''',
luopisktunn2012 = '''',
luopiskjarj2012 = '''', 
luopiskmaak2012 = '''', 
ammopiskkoulk2012 = '''', 
ammopisktunn2012 = '''',
ammopiskjarj2012 = '''', 
ammopiskmaak2012 = '''', 
amkopiskkoulk2012 = '''', 
amkopisktunn2012 = '''',
amkopiskjarj2012 = '''',
amkopiskmaak2012 = '''', 
yoopiskkoulk2012 = '''', 
yoopisktunn2012 = '''',
yoopiskjarj2012 = '''', 
yoopiskmaak2012 = '''', 
monihaku2012 = '''',
ptoim1r4_2012 = '''', 
amas_2012 = '''',
luopiskkoulk2013 = '''',
luopisktunn2013 = '''',
luopiskjarj2013 = '''', 
luopiskmaak2013 = '''', 
ammopiskkoulk2013 = '''', 
ammopisktunn2013 = '''',
ammopiskjarj2013 = '''', 
ammopiskmaak2013 = '''', 
amkopiskkoulk2013 = '''', 
amkopisktunn2013 = '''',
amkopiskjarj2013 = '''',
amkopiskmaak2013 = '''', 
yoopiskkoulk2013 = '''', 
yoopisktunn2013 = '''',
yoopiskjarj2013 = '''', 
yoopiskmaak2013 = '''', 
monihaku2013 = '''',
ptoim1r4_2013 = '''', 
amas_2013 = '''',
luopiskkoulk2014 = '''',
luopisktunn2014 = '''',
luopiskjarj2014 = '''', 
luopiskmaak2014 = '''', 
ammopiskkoulk2014 = '''', 
ammopisktunn2014= '''',
ammopiskjarj2014 = '''', 
ammopiskmaak2014 = '''', 
amkopiskkoulk2014 = '''', 
amkopisktunn2014 = '''', 
amkopiskjarj2014 = '''',
amkopiskmaak2014 = '''', 
yoopiskkoulk2014 = '''', 
yoopisktunn2014 = '''' ,
yoopiskjarj2014 = '''',
yoopiskmaak2014 = '''',
monihaku2014 = '''', 
ptoim1r4_2014 = '''', 
amas_2014 = '''',
lkm, 
pohjkoul, 
 [tietolahde]=''K3_12_sopv_12'',
 [rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_K3_12_sopv_12]
   where suorv = ''2009'' and (suorlk = ''1'' or suorlk= ''2'')
UNION ALL
 
SELECT
tilv, 
CAST(tilv + ''0101'' AS date) AS tilv_date,
tutkryh,
suorv,
suorlk,
sp,
(CASE WHEN [syntv]=''19XX'' THEN '''' ELSE [syntv] END) as syntv,
aikielir1,
(CASE WHEN [tutkaskun]=''427'' THEN ''''
 WHEN [tutkaskun]= ''946'' and (tilv= ''2009'' or tilv=''2010'') then ''945''
      WHEN [tutkaskun]= ''198'' THEN ''''
	  WHEN [tutkaskun]=''999'' THEN '''' ELSE [tutkaskun] END) as tutkaskun,
kansalr1,
pohjmaa,
eumaa,
etamaa,
(CASE WHEN [tunn] = ''BBBBB'' THEN ''''
      WHEN [tunn] = ''99999'' THEN ''''
      WHEN [tunn] = ''00000'' THEN '''' 
      when [tunn] = ''90009'' AND [tilv] = ''2009'' THEN ''''
      when [tunn] = ''90015'' AND [tilv] = ''2009'' THEN ''''
      when [tunn] = ''90010'' AND [tilv] = ''2009'' THEN ''''
      when [tunn] = ''90018'' AND [tilv] = ''2009'' THEN ''''
      when [tunn] = ''90008'' AND [tilv] = ''2010'' THEN ''''
      when [tunn] = ''90032'' AND [tilv] = ''2010'' THEN ''''
      when [tunn] = ''90032'' AND [tilv] = ''2011'' THEN ''''
      when [tunn] = ''90018'' AND [tilv] = ''2011'' THEN ''''
      when [tunn] = ''90006'' AND [tilv] = ''2009'' THEN ''''
      when [tunn] = ''90006'' AND [tilv] = ''2010'' THEN ''''
      when [tunn] = ''90006'' AND [tilv] = ''2011'' THEN ''''
        when [tunn] = ''90018'' AND [tilv] = ''2012'' THEN ''''
      ELSE [tunn] END) AS tunn,
jarj,
kkielir1,
tutklaja,
tutktav, 
aikoul, 
(CASE WHEN [tutkmaak] = ''99'' THEN '''' ELSE [tutkmaak] END) as tutkmaak, 
luopiskkoulk2008 = '''', 
luopisktunn2008 = '''',
luopiskjarj2008= '''',
luopiskmaak2008= '''',
ammopiskkoulk2008= '''', 
ammopisktunn2008= '''',
ammopiskjarj2008 = '''',
ammopiskmaak2008= '''', 
amkopiskkoulk2008= '''', 
amkopisktunn2008= '''',
amkopiskjarj2008= '''', 
amkopiskmaak2008= '''',
yoopiskkoulk2008= '''',
yoopisktunn2008= '''',
yoopiskjarj2008= '''', 
yoopiskmaak2008= '''',
monihaku2008= '''', 
ptoim1r4_2008= '''', 
amas_2008= '''', 
luopiskkoulk2009 = '''', 
luopisktunn2009 = '''',
luopiskjarj2009= '''',
luopiskmaak2009= '''',
ammopiskkoulk2009= '''', 
ammopisktunn2009= '''',
ammopiskjarj2009 = '''',
ammopiskmaak2009= '''', 
amkopiskkoulk2009= '''', 
amkopisktunn2009= '''',
amkopiskjarj2009= '''', 
amkopiskmaak2009= '''',
yoopiskkoulk2009= '''',
yoopisktunn2009= '''',
yoopiskjarj2009= '''', 
yoopiskmaak2009= '''',
monihaku2009= '''', 
ptoim1r4_2009= '''', 
amas_2009= '''',  
luopiskkoulk_2010 AS luopiskkoulk2010,
(CASE WHEN [luopisktunn_2010] = ''BBBBB'' THEN ''''
      WHEN [luopisktunn_2010] = ''99999'' THEN '''' 
      WHEN [luopisktunn_2010] = ''00000'' THEN ''''
      ELSE [luopisktunn_2010] END) AS luopisktunn2010,
luopiskjarj_2010 AS luopisjarj2010, 
(CASE WHEN [luopiskmaak_2010] = ''99'' THEN ''''ELSE [luopiskmaak_2010] END) AS luopiskmaak2010, 
ammopiskkoulk_2010 AS ammopiskkoulk2010, 
(CASE WHEN [ammopisktunn_2010] = ''BBBBBB'' THEN ''''
      WHEN [ammopisktunn_2010] = ''99999'' THEN '''' 
      WHEN [ammopisktunn_2010] = ''00000'' THEN ''''
      when [ammopisktunn_2010]  = ''90009'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2010]  = ''90015'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2010]  = ''90010'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2010]  = ''90018'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2010]  = ''90008'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2010]  = ''90032'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2010]  = ''90032'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2010]  = ''90018'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2010]  = ''90006'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2010]  = ''90006'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2010]  = ''90006'' AND [tilv] = ''2011'' THEN ''''
        when [ammopisktunn_2010] = ''90018'' AND [tilv] = ''2012'' THEN ''''
      ELSE [ammopisktunn_2010] END)AS ammopisktunn2010,
ammopiskjarj_2010 AS ammopiskjarj2010, 
(CASE WHEN [ammopiskmaak_2010] = ''99'' THEN ''''ELSE [ammopiskmaak_2010] END) as ammopiskmaak2010, 
amkopiskkoulk_2010 AS amkopiskkoulk2010, 
(CASE WHEN [amkopisktunn_2010] = ''BBBBB'' THEN ''''
      WHEN [amkopisktunn_2010] = ''99999'' THEN ''''
      WHEN [amkopisktunn_2010] = ''00000'' THEN '''' ELSE [amkopisktunn_2010] END) AS amkopisktunn2010,
amkopiskjarj_2010 AS amkopiskjarj2010,
(CASE WHEN [amkopiskmaak_2010] = ''99'' THEN '''' ELSE [amkopiskmaak_2010] END) AS amkopiskmaak2010, 
yoopiskkoulk_2010 AS yoopiskkoulk2010, 
(CASE WHEN [yoopisktunn_2010] = ''BBBBB'' THEN ''''
      WHEN [yoopisktunn_2010] = ''99999'' THEN ''''
      WHEN [yoopisktunn_2010] = ''00000'' THEN '''' ELSE [yoopisktunn_2010] END) AS yoopisktunn2010,
yoopiskjarj_2010 AS yoopiskjarj2010,
(CASE WHEN [yoopiskmaak_2010] = ''99'' THEN '''' ELSE [yoopiskmaak_2010] END) AS yoopiskmaak2010,
monihaku_2010 AS monihaku2010, 
ptoim1r4_2010, 
amas_2010, 
luopiskkoulk_2011 AS luopiskkoul2011,
(CASE WHEN [luopisktunn_2011] = ''BBBBB'' THEN ''''
      WHEN [luopisktunn_2011] = ''99999'' THEN ''''
      WHEN [luopisktunn_2011] = ''00000'' THEN ''''
      ELSE [luopisktunn_2011] END) AS luopisktunn2011,
luopiskjarj_2011 AS luopiskjarj2011, 
(CASE WHEN [luopiskmaak_2011] = ''99'' THEN ''''ELSE [luopiskmaak_2011] END) AS luopiskmaak2011, 
ammopiskkoulk_2011 AS ammopiskkoulk2011, 
(CASE WHEN [ammopisktunn_2011] = ''BBBBBB'' THEN ''''
      WHEN [ammopisktunn_2011] = ''99'' THEN ''''
      WHEN [ammopisktunn_2011] = ''00000'' THEN ''''
      when [ammopisktunn_2011]   = ''90009'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2011]  = ''90015'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2011]  = ''90010'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2011]  = ''90018'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2011]  = ''90008'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2011]  = ''90032'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2011]  = ''90032'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2011]  = ''90018'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2011]  = ''90006'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2011]  = ''90006'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2011]  = ''90006'' AND [tilv] = ''2011'' THEN ''''
        when [ammopisktunn_2011] = ''90018'' AND [tilv] = ''2012'' THEN ''''
      ELSE [ammopisktunn_2011] END)AS ammopisktunn2011,
ammopiskjarj_2011 AS ammopiskjarj2011, 
(CASE WHEN [ammopiskmaak_2011] = ''99'' THEN ''''ELSE [ammopiskmaak_2011] END) as ammopiskmaak2011, 
amkopiskkoulk_2011 AS amkopiskkoulk2011, 
(CASE WHEN [amkopisktunn_2011] = ''BBBBB'' THEN ''''
      WHEN [amkopisktunn_2011] = ''99999'' THEN '''' 
      WHEN [amkopisktunn_2011] = ''00000'' THEN ''''ELSE [amkopisktunn_2011] END) AS amkopisktunn2011,
amkopiskjarj_2011 AS amkopiskjarj2011,
(CASE WHEN [amkopiskmaak_2011] = ''99'' THEN '''' ELSE [amkopiskmaak_2011] END) AS amkopiskmaak2011, 
yoopiskkoulk_2011 AS yoopiskkoulk2011, 
(CASE WHEN [yoopisktunn_2011] = ''BBBBB'' THEN ''''
      WHEN [yoopisktunn_2011] = ''99999'' THEN ''''
      WHEN [yoopisktunn_2011] = ''00000'' THEN '''' ELSE [yoopisktunn_2011] END) AS yoopisktunn2011,
yoopiskjarj_2011 AS yoopiskjarj2011,
(CASE WHEN [yoopiskmaak_2011] = ''99'' THEN '''' ELSE [yoopiskmaak_2011] END) AS yoopiskmaak2011,
monihaku_2011 AS monihaku2011,
ptoim1r4_2011, 
amas_2011, 
luopiskkoulk2012 = '''',
luopisktunn2012 = '''',
luopiskjarj2012 = '''', 
luopiskmaak2012 = '''', 
ammopiskkoulk2012 = '''', 
ammopisktunn2012 = '''',
ammopiskjarj2012 = '''', 
ammopiskmaak2012 = '''', 
amkopiskkoulk2012 = '''', 
amkopisktunn2012 = '''',
amkopiskjarj2012 = '''',
amkopiskmaak2012 = '''', 
yoopiskkoulk2012 = '''', 
yoopisktunn2012 = '''',
yoopiskjarj2012 = '''', 
yoopiskmaak2012 = '''', 
monihaku2012 = '''',
ptoim1r4_2012 = '''', 
amas_2012 = '''',
luopiskkoulk2013 = '''',
luopisktunn2013 = '''',
luopiskjarj2013 = '''', 
luopiskmaak2013 = '''', 
ammopiskkoulk2013 = '''', 
ammopisktunn2013 = '''',
ammopiskjarj2013 = '''', 
ammopiskmaak2013 = '''', 
amkopiskkoulk2013 = '''', 
amkopisktunn2013 = '''',
amkopiskjarj2013 = '''',
amkopiskmaak2013 = '''', 
yoopiskkoulk2013 = '''', 
yoopisktunn2013 = '''',
yoopiskjarj2013 = '''', 
yoopiskmaak2013 = '''', 
monihaku2013 = '''',
ptoim1r4_2013 = '''', 
amas_2013 = '''',
luopiskkoulk2014 = '''',
luopisktunn2014 = '''',
luopiskjarj2014 = '''', 
luopiskmaak2014 = '''', 
ammopiskkoulk2014 = '''', 
ammopisktunn2014= '''',
ammopiskjarj2014 = '''', 
ammopiskmaak2014 = '''', 
amkopiskkoulk2014 = '''', 
amkopisktunn2014 = '''', 
amkopiskjarj2014 = '''',
amkopiskmaak2014 = '''', 
yoopiskkoulk2014 = '''', 
yoopisktunn2014 = '''' ,
yoopiskjarj2014 = '''',
yoopiskmaak2014 = '''',
monihaku2014 = '''', 
ptoim1r4_2014 = '''', 
amas_2014 = '''',
lkm, 
pohjkoul,
 [tietolahde]=''K3_12_sopv_13'',
 [rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_K3_12_sopv_13]
where suorv = ''2010'' and (suorlk = ''1'' or suorlk= ''2'')

UNION ALL
 
SELECT
tilv, 
CAST(tilv + ''0101'' AS date) AS tilv_date,
tutkryh,
suorv,
suorlk,
sp,
(CASE WHEN [syntv]=''19XX'' THEN '''' ELSE [syntv] END) as syntv,
aikielir1,
(CASE WHEN [tutkaskun]=''427'' THEN ''''
 WHEN [tutkaskun]= ''946'' and (tilv= ''2009'' or tilv=''2010'') then ''945''
      WHEN [tutkaskun]= ''198'' THEN ''''
	  WHEN [tutkaskun]=''999'' THEN '''' ELSE [tutkaskun] END) as tutkaskun,
kansalr1,
pohjmaa,
eumaa,
etamaa,
(CASE WHEN [tunn] = ''BBBBB'' THEN ''''
      WHEN [tunn] = ''99999'' THEN ''''
      WHEN [tunn] = ''00000'' THEN '''' 
      when [tunn] = ''90009'' AND [tilv] = ''2009'' THEN ''''
      when [tunn] = ''90015'' AND [tilv] = ''2009'' THEN ''''
      when [tunn] = ''90010'' AND [tilv] = ''2009'' THEN ''''
      when [tunn] = ''90018'' AND [tilv] = ''2009'' THEN ''''
      when [tunn] = ''90008'' AND [tilv] = ''2010'' THEN ''''
      when [tunn] = ''90032'' AND [tilv] = ''2010'' THEN ''''
      when [tunn] = ''90032'' AND [tilv] = ''2011'' THEN ''''
      when [tunn] = ''90018'' AND [tilv] = ''2011'' THEN ''''
      when [tunn] = ''90006'' AND [tilv] = ''2009'' THEN ''''
      when [tunn] = ''90006'' AND [tilv] = ''2010'' THEN ''''
      when [tunn] = ''90006'' AND [tilv] = ''2011'' THEN ''''
        when [tunn] = ''90018'' AND [tilv] = ''2012'' THEN ''''
      ELSE [tunn] END) AS tunn,
jarj,
kkielir1,
tutklaja,
tutktav, 
aikoul, 
(CASE WHEN [tutkmaak] = ''99'' THEN '''' ELSE [tutkmaak] END) as tutkmaak, 
luopiskkoulk2008 = '''', 
luopisktunn2008 = '''',
luopiskjarj2008= '''',
luopiskmaak2008= '''',
ammopiskkoulk2008= '''', 
ammopisktunn2008= '''',
ammopiskjarj2008 = '''',
ammopiskmaak2008= '''', 
amkopiskkoulk2008= '''', 
amkopisktunn2008= '''',
amkopiskjarj2008= '''', 
amkopiskmaak2008= '''',
yoopiskkoulk2008= '''',
yoopisktunn2008= '''',
yoopiskjarj2008= '''', 
yoopiskmaak2008= '''',
monihaku2008= '''', 
ptoim1r4_2008= '''', 
amas_2008= '''', 
luopiskkoulk2009 = '''', 
luopisktunn2009 = '''',
luopiskjarj2009= '''',
luopiskmaak2009= '''',
ammopiskkoulk2009= '''', 
ammopisktunn2009= '''',
ammopiskjarj2009 = '''',
ammopiskmaak2009= '''', 
amkopiskkoulk2009= '''', 
amkopisktunn2009= '''',
amkopiskjarj2009= '''', 
amkopiskmaak2009= '''',
yoopiskkoulk2009= '''',
yoopisktunn2009= '''',
yoopiskjarj2009= '''', 
yoopiskmaak2009= '''',
monihaku2009= '''', 
ptoim1r4_2009= '''', 
amas_2009= '''',  
luopiskkoulk2010 = '''',
luopisktunn2010 = '''',
luopiskjarj2010 = '''', 
luopiskmaak2010 = '''', 
ammopiskkoulk2010 = '''', 
ammopisktunn2010 = '''',
ammopiskjarj2010 = '''', 
ammopiskmaak2010 = '''', 
amkopiskkoulk2010 = '''', 
amkopisktunn2010 = '''', 
amkopiskjarj2010 = '''',
amkopiskmaak2010 = '''', 
yoopiskkoulk2010 = '''', 
yoopisktunn2010 = '''' ,
yoopiskjarj2010 = '''',
yoopiskmaak2010 = '''',
monihaku2010 = '''', 
ptoim1r4_2010 = '''', 
amas_2010 = '''', 
luopiskkoulk_2011,
(CASE WHEN [luopisktunn_2011] = ''BBBBB'' THEN ''''
      WHEN [luopisktunn_2011] = ''99999'' THEN ''''
      WHEN [luopisktunn_2011] = ''00000'' THEN ''''
      ELSE [luopisktunn_2011] END) AS luopisktunn2011,
luopiskjarj_2011, 
(CASE WHEN [luopiskmaak_2011] = ''99'' THEN ''''ELSE [luopiskmaak_2011] END) AS luopiskmaak2011, 
ammopiskkoulk_2011, 
(CASE WHEN [ammopisktunn_2011] = ''BBBBBB'' THEN ''''
 WHEN [ammopisktunn_2011] = ''99'' THEN ''''
      WHEN [ammopisktunn_2011] = ''00000'' THEN ''''
      when [ammopisktunn_2011]   = ''90009'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2011]  = ''90015'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2011]  = ''90010'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2011]  = ''90018'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2011]  = ''90008'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2011]  = ''90032'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2011]  = ''90032'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2011]  = ''90018'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2011]  = ''90006'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2011]  = ''90006'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2011]  = ''90006'' AND [tilv] = ''2011'' THEN ''''
        when [ammopisktunn_2011] = ''90018'' AND [tilv] = ''2012'' THEN ''''
      ELSE [ammopisktunn_2011] END)AS ammopisktunn_2011,
ammopiskjarj_2011 AS ammopiskjarj2011, 
(CASE WHEN [ammopiskmaak_2011] = ''99'' THEN ''''ELSE [ammopiskmaak_2011] END) as ammopiskmaak2011, 
amkopiskkoulk_2011 AS amkopiskkoulk2011, 
(CASE WHEN [amkopisktunn_2011] = ''BBBBB'' THEN ''''
      WHEN [amkopisktunn_2011] = ''99999'' THEN '''' 
      WHEN [amkopisktunn_2011] = ''00000'' THEN ''''ELSE [amkopisktunn_2011] END) AS amkopisktunn2011,
amkopiskjarj_2011 AS amkopiskjarj2011,
(CASE WHEN [amkopiskmaak_2011] = ''99'' THEN '''' ELSE [amkopiskmaak_2011] END) AS amkopiskmaak2011, 
yoopiskkoulk_2011 AS yoopiskkoulk2011, 
(CASE WHEN [yoopisktunn_2011] = ''BBBBB'' THEN ''''
      WHEN [yoopisktunn_2011] = ''99999'' THEN ''''
      WHEN [yoopisktunn_2011] = ''00000'' THEN '''' ELSE [yoopisktunn_2011] END) AS yoopisktunn2011,
yoopiskjarj_2011 AS yoopiskjarj,
(CASE WHEN [yoopiskmaak_2011] = ''99'' THEN '''' ELSE [yoopiskmaak_2011] END) AS yoopiskmaak2011,
monihaku_2011 as monihaku2011, 
ptoim1r4_2011, 
amas_2011, 
luopiskkoulk_2012 as luopiskkoulk2012,
(CASE WHEN [luopisktunn_2012] = ''BBBBB'' THEN ''''
      WHEN [luopisktunn_2012] = ''99999'' THEN ''''
      WHEN [luopisktunn_2012] = ''00000'' THEN ''''
      ELSE [luopisktunn_2012] END) AS luopisktunn2012,
luopiskjarj_2012 as luopiskjarj2012, 
(CASE WHEN [luopiskmaak_2012] = ''99'' THEN ''''ELSE [luopiskmaak_2012] END) AS luopiskmaak2012, 
ammopiskkoulk_2012 as ammopiskkoulk2012, 
(CASE WHEN [ammopisktunn_2012] = ''BBBBBB'' THEN ''''
      WHEN [ammopisktunn_2012] = ''99'' THEN ''''
      WHEN [ammopisktunn_2012] = ''00000'' THEN ''''
      when [ammopisktunn_2012]   = ''90009'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2012]  = ''90015'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2012]  = ''90010'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2012]  = ''90018'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2012]  = ''90008'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2012]  = ''90032'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2012]  = ''90032'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2012]  = ''90018'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2012]  = ''90006'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2012]  = ''90006'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2012]  = ''90006'' AND [tilv] = ''2011'' THEN ''''
        when [ammopisktunn_2012] = ''90018'' AND [tilv] = ''2012'' THEN ''''
      ELSE [ammopisktunn_2012] END)AS ammopisktunn2012,
ammopiskjarj_2012 as ammopisjarj2012, 
(CASE WHEN [ammopiskmaak_2012] = ''99'' THEN ''''ELSE [ammopiskmaak_2012] END) as ammopiskmaak2012, 
amkopiskkoulk_2012 as amkopiskkoulk2012, 
(CASE WHEN [amkopisktunn_2012] = ''BBBBB'' THEN ''''
      WHEN [amkopisktunn_2012] = ''99999'' THEN '''' 
      WHEN [amkopisktunn_2012] = ''00000'' THEN ''''ELSE [amkopisktunn_2012] END) AS amkopisktunn2012,
amkopiskjarj_2012 as amkopiskjarj2012,
(CASE WHEN [amkopiskmaak_2012] = ''99'' THEN '''' ELSE [amkopiskmaak_2012] END) AS amkopiskmaak2012, 
yoopiskkoulk_2012 as yoopiskkoulk2012, 
(CASE WHEN [yoopisktunn_2012] = ''BBBBB'' THEN ''''
      WHEN [yoopisktunn_2012] = ''99999'' THEN ''''
      WHEN [yoopisktunn_2012] = ''00000'' THEN '''' ELSE [yoopisktunn_2012] END) AS yoopisktunn2012,
yoopiskjarj_2012 as yoopiskjarj2012,
(CASE WHEN [yoopiskmaak_2012] = ''99'' THEN '''' ELSE [yoopiskmaak_2012] END) AS yoopiskmaak2012,
monihaku_2012 as monihaku2012, 
ptoim1r4_2012, 
amas_2012, 
luopiskkoulk2013 = '''',
luopisktunn2013 = '''',
luopiskjarj2013 = '''', 
luopiskmaak2013 = '''', 
ammopiskkoulk2013 = '''', 
ammopisktunn2013 = '''',
ammopiskjarj2013 = '''', 
ammopiskmaak2013 = '''', 
amkopiskkoulk2013 = '''', 
amkopisktunn2013 = '''',
amkopiskjarj2013 = '''',
amkopiskmaak2013 = '''', 
yoopiskkoulk2013 = '''', 
yoopisktunn2013 = '''',
yoopiskjarj2013 = '''', 
yoopiskmaak2013 = '''', 
monihaku2013 = '''',
ptoim1r4_2013 = '''', 
amas_2013 = '''',
luopiskkoulk2014 = '''',
luopisktunn2014 = '''',
luopiskjarj2014 = '''', 
luopiskmaak2014 = '''', 
ammopiskkoulk2014 = '''', 
ammopisktunn2014= '''',
ammopiskjarj2014 = '''', 
ammopiskmaak2014 = '''', 
amkopiskkoulk2014 = '''', 
amkopisktunn2014 = '''', 
amkopiskjarj2014 = '''',
amkopiskmaak2014 = '''', 
yoopiskkoulk2014 = '''', 
yoopisktunn2014 = '''' ,
yoopiskjarj2014 = '''',
yoopiskmaak2014 = '''',
monihaku2014 = '''', 
ptoim1r4_2014 = '''', 
amas_2014 = '''',
lkm, 
pohjkoul,
 [tietolahde]=''K3_12_sopv_14'',
 [rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_K3_12_sopv_14]
where suorv = ''2011'' and (suorlk = ''1'' or suorlk= ''2'')

UNION ALL
 
SELECT
tilv, 
CAST(tilv + ''0101'' AS date) AS tilv_date,
(CASE WHEN [tutkryh] is NULL THEN '''' ELSE [tutkryh] END) as tutkryh,
(CASE WHEN [suorv] is NULL THEN '''' ELSE [suorv] END) as suorv,
(CASE WHEN [suorlk] is NULL THEN '''' ELSE [suorlk] END) as suorlk,
(CASE WHEN [sp] is NULL THEN '''' ELSE [sp] END) as sp,
(CASE WHEN [syntv]=''19XX'' THEN '''' 
 WHEN [syntv] is NULL THEN '''' ELSE [syntv] END) as syntv,
aikielir1,
(CASE WHEN [tutkaskun]=''427'' THEN ''''
 WHEN [tutkaskun]= ''946'' and (tilv= ''2009'' or tilv=''2010'') then ''945''
      WHEN [tutkaskun]= ''198'' THEN ''''
	  WHEN [tutkaskun]=''999'' THEN '''' ELSE [tutkaskun] END) as tutkaskun,
	  (CASE WHEN [kansalr1] is NULL THEN '''' ELSE [kansalr1] END) as kansalr1,
  (CASE WHEN [pohjmaa] is NULL THEN '''' ELSE [pohjmaa] END) as pohjmaa,
(CASE WHEN [eumaa] is NULL THEN '''' ELSE [eumaa] END) as eumaa,
(CASE WHEN [etamaa] is NULL THEN '''' ELSE [etamaa] END) as etamaa,
(CASE WHEN [tunn] = ''BBBBB'' THEN ''''
      WHEN [tunn] = ''99999'' THEN ''''
      WHEN [tunn] = ''00000'' THEN '''' 
      when [tunn] = ''90009'' AND [tilv] = ''2009'' THEN ''''
      when [tunn] = ''90015'' AND [tilv] = ''2009'' THEN ''''
      when [tunn] = ''90010'' AND [tilv] = ''2009'' THEN ''''
      when [tunn] = ''90018'' AND [tilv] = ''2009'' THEN ''''
      when [tunn] = ''90008'' AND [tilv] = ''2010'' THEN ''''
      when [tunn] = ''90032'' AND [tilv] = ''2010'' THEN ''''
      when [tunn] = ''90032'' AND [tilv] = ''2011'' THEN ''''
      when [tunn] = ''90018'' AND [tilv] = ''2011'' THEN ''''
      when [tunn] = ''90006'' AND [tilv] = ''2009'' THEN ''''
      when [tunn] = ''90006'' AND [tilv] = ''2010'' THEN ''''
      when [tunn] = ''90006'' AND [tilv] = ''2011'' THEN ''''
        when [tunn] = ''90018'' AND [tilv] = ''2012'' THEN ''''
		when [tunn] is NULL then ''''
      ELSE [tunn] END) AS tunn,
(case when jarj= '''' then '''' 
       when jarj is NULL then '''' else jarj end ),
kkielir1,
 (case when tutklaja= '''' then '''' 
       when tutklaja is NULL then '''' else tutklaja end ),
 (case when tutktav= '''' then '''' 
       when tutktav is NULL then '''' else tutktav end ),
(case when aikoul= '''' then '''' 
       when aikoul is NULL then '''' else aikoul end ),
(CASE WHEN [tutkmaak] = ''99'' THEN '''' ELSE [tutkmaak] END) as tutkmaak,  
luopiskkoulk2008 = '''', 
luopisktunn2008 = '''',
luopiskjarj2008= '''',
luopiskmaak2008= '''',
ammopiskkoulk2008= '''', 
ammopisktunn2008= '''',
ammopiskjarj2008 = '''',
ammopiskmaak2008= '''', 
amkopiskkoulk2008= '''', 
amkopisktunn2008= '''',
amkopiskjarj2008= '''', 
amkopiskmaak2008= '''',
yoopiskkoulk2008= '''',
yoopisktunn2008= '''',
yoopiskjarj2008= '''', 
yoopiskmaak2008= '''',
monihaku2008= '''', 
ptoim1r4_2008= '''', 
amas_2008= '''', 
luopiskkoulk2009 = '''', 
luopisktunn2009 = '''',
luopiskjarj2009= '''',
luopiskmaak2009= '''',
ammopiskkoulk2009= '''', 
ammopisktunn2009= '''',
ammopiskjarj2009 = '''',
ammopiskmaak2009= '''', 
amkopiskkoulk2009= '''', 
amkopisktunn2009= '''',
amkopiskjarj2009= '''', 
amkopiskmaak2009= '''',
yoopiskkoulk2009= '''',
yoopisktunn2009= '''',
yoopiskjarj2009= '''', 
yoopiskmaak2009= '''',
monihaku2009= '''', 
ptoim1r4_2009= '''', 
amas_2009= '''',  
luopiskkoulk2010 = '''',
luopisktunn2010 = '''',
luopiskjarj2010 = '''', 
luopiskmaak2010 = '''', 
ammopiskkoulk2010 = '''', 
ammopisktunn2010 = '''',
ammopiskjarj2010 = '''', 
ammopiskmaak2010 = '''', 
amkopiskkoulk2010 = '''', 
amkopisktunn2010 = '''', 
amkopiskjarj2010 = '''',
amkopiskmaak2010 = '''', 
yoopiskkoulk2010 = '''', 
yoopisktunn2010 = '''' ,
yoopiskjarj2010 = '''',
yoopiskmaak2010 = '''',
monihaku2010 = '''', 
ptoim1r4_2010 = '''', 
amas_2010 = '''', 
luopiskkoulk2011 = '''',
luopisktunn2011 = '''',
luopiskjarj2011 = '''', 
luopiskmaak2011 = '''', 
ammopiskkoulk2011 = '''', 
ammopisktunn2011= '''',
ammopiskjarj2011 = '''', 
ammopiskmaak2011 = '''', 
amkopiskkoulk2011 = '''', 
amkopisktunn2011 = '''', 
amkopiskjarj2011 = '''',
amkopiskmaak2011 = '''', 
yoopiskkoulk2011 = '''', 
yoopisktunn2011 = '''' ,
yoopiskjarj2011 = '''',
yoopiskmaak2011 = '''',
monihaku2011 = '''', 
ptoim1r4_2011 = '''', 
amas_2011 = '''', 
luopiskkoulk_2012,
(CASE WHEN [luopisktunn_2012] = ''BBBBB'' THEN ''''
      WHEN [luopisktunn_2012] = ''99999'' THEN ''''
      WHEN [luopisktunn_2012] = ''00000'' THEN ''''
      ELSE [luopisktunn_2012] END) AS luopisktunn2012,
luopiskjarj_2012, 
(CASE WHEN [luopiskmaak_2012] = ''99'' THEN ''''ELSE [luopiskmaak_2012] END) AS luopiskmaak2012, 
ammopiskkoulk_2012, 
(CASE WHEN [ammopisktunn_2012] = ''BBBBBB'' THEN ''''
      WHEN [ammopisktunn_2012] = ''99'' THEN ''''
      WHEN [ammopisktunn_2012] = ''00000'' THEN ''''
      when [ammopisktunn_2012]   = ''90009'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2012]  = ''90015'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2012]  = ''90010'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2012]  = ''90018'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2012]  = ''90008'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2012]  = ''90032'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2012]  = ''90032'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2012]  = ''90018'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2012]  = ''90006'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2012]  = ''90006'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2012]  = ''90006'' AND [tilv] = ''2011'' THEN ''''
        when [ammopisktunn_2012] = ''90018'' AND [tilv] = ''2012'' THEN ''''
      ELSE [ammopisktunn_2012] END)AS ammopisktunn2012,
ammopiskjarj_2012, 
(CASE WHEN [ammopiskmaak_2012] = ''99'' THEN ''''ELSE [ammopiskmaak_2012] END) as ammopiskmaak2012, 
amkopiskkoulk_2012, 
(CASE WHEN [amkopisktunn_2012] = ''BBBBB'' THEN ''''
      WHEN [amkopisktunn_2012] = ''99999'' THEN '''' 
      WHEN [amkopisktunn_2012] = ''00000'' THEN ''''ELSE [amkopisktunn_2012] END) AS amkopisktunn2012,
amkopiskjarj_2012,
(CASE WHEN [amkopiskmaak_2012] = ''99'' THEN '''' ELSE [amkopiskmaak_2012] END) AS amkopiskmaak2012, 
yoopiskkoulk_2012, 
(CASE WHEN [yoopisktunn_2012] = ''BBBBB'' THEN ''''
      WHEN [yoopisktunn_2012] = ''99999'' THEN ''''
      WHEN [yoopisktunn_2012] = ''00000'' THEN '''' ELSE [yoopisktunn_2012] END) AS yoopisktunn2012,
yoopiskjarj_2012,
(CASE WHEN [yoopiskmaak_2012] = ''99'' THEN '''' ELSE [yoopiskmaak_2012] END) AS yoopiskmaak2012,
(CASE WHEN [monihaku_2012] is NULL THEN '''' ELSE [monihaku_2012] END) as monihaku2012, 
(CASE WHEN [ptoim1r4_2012] is NULL THEN '''' ELSE [ptoim1r4_2012] END) as ptoim1r4_2012, 
(CASE WHEN [amas_2012] is NULL THEN '''' ELSE [amas_2012] END) as amas_2012,  
luopiskkoulk_2013,
(CASE WHEN [luopisktunn_2013] = ''BBBBB'' THEN ''''
      WHEN [luopisktunn_2013] = ''99999'' THEN ''''
      WHEN [luopisktunn_2013] = ''00000'' THEN ''''
      ELSE [luopisktunn_2013] END) AS luopisktunn2013,
luopiskjarj_2013, 
(CASE WHEN [luopiskmaak_2013] = ''99'' THEN ''''ELSE [luopiskmaak_2013] END) AS luopiskmaak2013, 
ammopiskkoulk_2013, 
(CASE WHEN [ammopisktunn_2013] = ''BBBBBB'' THEN ''''
      WHEN [ammopisktunn_2013] = ''99'' THEN ''''
      WHEN [ammopisktunn_2013] = ''00000'' THEN ''''
      when [ammopisktunn_2013]   = ''90009'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2013]  = ''90015'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2013]  = ''90010'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2013]  = ''90018'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2013]  = ''90008'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2013]  = ''90032'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2013]  = ''90032'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2013]  = ''90018'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2013]  = ''90006'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2013]  = ''90006'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2013]  = ''90006'' AND [tilv] = ''2011'' THEN ''''
        when [ammopisktunn_2013] = ''90018'' AND [tilv] = ''2012'' THEN ''''
      ELSE [ammopisktunn_2013] END)AS ammopisktunn2013,
ammopiskjarj_2013, 
(CASE WHEN [ammopiskmaak_2013] = ''99'' THEN ''''ELSE [ammopiskmaak_2013] END) as ammopiskmaak2013, 
amkopiskkoulk_2013, 
(CASE WHEN [amkopisktunn_2013] = ''BBBBB'' THEN ''''
      WHEN [amkopisktunn_2013] = ''99999'' THEN '''' 
      WHEN [amkopisktunn_2013] = ''00000'' THEN ''''ELSE [amkopisktunn_2013] END) AS amkopisktunn2013,
amkopiskjarj_2013,
(CASE WHEN [amkopiskmaak_2013] = ''99'' THEN '''' ELSE [amkopiskmaak_2013] END) AS amkopiskmaak2013, 
yoopiskkoulk_2013, 
(CASE WHEN [yoopisktunn_2013] = ''BBBBB'' THEN ''''
      WHEN [yoopisktunn_2013] = ''99999'' THEN ''''
      WHEN [yoopisktunn_2013] = ''00000'' THEN '''' ELSE [yoopisktunn_2013] END) AS yoopisktunn2013,
yoopiskjarj_2013,
(CASE WHEN [yoopiskmaak_2013] = ''99'' THEN '''' ELSE [yoopiskmaak_2013] END) AS yoopiskmaak2013,
(CASE WHEN [monihaku_2013] is NULL THEN '''' ELSE [monihaku_2013] END) as monihaku2013, 
(CASE WHEN [ptoim1r4_2013] is NULL THEN '''' ELSE [ptoim1r4_2013] END) as ptoim1r4_2013, 
(CASE WHEN [amas_2013] is NULL THEN '''' ELSE [amas_2013] END) as amas_2013,
luopiskkoulk2014 = '''',
luopisktunn2014 = '''',
luopiskjarj2014 = '''', 
luopiskmaak2014 = '''', 
ammopiskkoulk2014 = '''', 
ammopisktunn2014= '''',
ammopiskjarj2014 = '''', 
ammopiskmaak2014 = '''', 
amkopiskkoulk2014 = '''', 
amkopisktunn2014 = '''', 
amkopiskjarj2014 = '''',
amkopiskmaak2014 = '''', 
yoopiskkoulk2014 = '''', 
yoopisktunn2014 = '''' ,
yoopiskjarj2014 = '''',
yoopiskmaak2014 = '''',
monihaku2014 = '''', 
ptoim1r4_2014 = '''', 
amas_2014 = '''',  
lkm, 
pohjkoul,
 [tietolahde]=''K3_12_sopv_15'',
 [rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_K3_12_sopv_15]
where suorv = ''2012'' and (suorlk = ''1'' or suorlk= ''2'')

UNION ALL
 
SELECT
tilv, 
CAST(tilv + ''0101'' AS date) AS tilv_date,
(CASE WHEN [tutkryh] is NULL THEN '''' ELSE [tutkryh] END) as tutkryh,
(CASE WHEN [suorv] is NULL THEN '''' ELSE [suorv] END) as suorv,
(CASE WHEN [suorlk] is NULL THEN '''' ELSE [suorlk] END) as suorlk,
(CASE WHEN [sp] is NULL THEN '''' ELSE [sp] END) as sp,
(CASE WHEN [syntv]=''19XX'' THEN '''' 
 WHEN [syntv] is NULL THEN '''' ELSE [syntv] END) as syntv,
aikielir1,
(CASE WHEN [tutkaskun]=''427'' THEN ''''
 WHEN [tutkaskun]= ''946'' and (tilv= ''2009'' or tilv=''2010'') then ''945''
      WHEN [tutkaskun]= ''198'' THEN ''''
	  WHEN [tutkaskun]=''999'' THEN '''' ELSE [tutkaskun] END) as tutkaskun,
	  (CASE WHEN [kansalr1] is NULL THEN '''' ELSE [kansalr1] END) as kansalr1,
  (CASE WHEN [pohjmaa] is NULL THEN '''' ELSE [pohjmaa] END) as pohjmaa,
(CASE WHEN [eumaa] is NULL THEN '''' ELSE [eumaa] END) as eumaa,
(CASE WHEN [etamaa] is NULL THEN '''' ELSE [etamaa] END) as etamaa,
(CASE WHEN [tunn] = ''BBBBB'' THEN ''''
      WHEN [tunn] = ''99999'' THEN ''''
      WHEN [tunn] = ''00000'' THEN '''' 
      when [tunn] = ''90009'' AND [tilv] = ''2009'' THEN ''''
      when [tunn] = ''90015'' AND [tilv] = ''2009'' THEN ''''
      when [tunn] = ''90010'' AND [tilv] = ''2009'' THEN ''''
      when [tunn] = ''90018'' AND [tilv] = ''2009'' THEN ''''
      when [tunn] = ''90008'' AND [tilv] = ''2010'' THEN ''''
      when [tunn] = ''90032'' AND [tilv] = ''2010'' THEN ''''
      when [tunn] = ''90032'' AND [tilv] = ''2011'' THEN ''''
      when [tunn] = ''90018'' AND [tilv] = ''2011'' THEN ''''
      when [tunn] = ''90006'' AND [tilv] = ''2009'' THEN ''''
      when [tunn] = ''90006'' AND [tilv] = ''2010'' THEN ''''
      when [tunn] = ''90006'' AND [tilv] = ''2011'' THEN ''''
        when [tunn] = ''90018'' AND [tilv] = ''2012'' THEN ''''
		when [tunn] is NULL then ''''
      ELSE [tunn] END) AS tunn,
(case when jarj= '''' then '''' 
       when jarj is NULL then '''' else jarj end ),
kkielir1,
 (case when tutklaja= '''' then '''' 
       when tutklaja is NULL then '''' else tutklaja end ),
 (case when tutktav= '''' then '''' 
       when tutktav is NULL then '''' else tutktav end ),
(case when aikoul= '''' then '''' 
       when aikoul is NULL then '''' else aikoul end ),
(CASE WHEN [tutkmaak] = ''99'' THEN '''' ELSE [tutkmaak] END) as tutkmaak,  
luopiskkoulk2008 = '''', 
luopisktunn2008 = '''',
luopiskjarj2008= '''',
luopiskmaak2008= '''',
ammopiskkoulk2008= '''', 
ammopisktunn2008= '''',
ammopiskjarj2008 = '''',
ammopiskmaak2008= '''', 
amkopiskkoulk2008= '''', 
amkopisktunn2008= '''',
amkopiskjarj2008= '''', 
amkopiskmaak2008= '''',
yoopiskkoulk2008= '''',
yoopisktunn2008= '''',
yoopiskjarj2008= '''', 
yoopiskmaak2008= '''',
monihaku2008= '''', 
ptoim1r4_2008= '''', 
amas_2008= '''', 
luopiskkoulk2009 = '''', 
luopisktunn2009 = '''',
luopiskjarj2009= '''',
luopiskmaak2009= '''',
ammopiskkoulk2009= '''', 
ammopisktunn2009= '''',
ammopiskjarj2009 = '''',
ammopiskmaak2009= '''', 
amkopiskkoulk2009= '''', 
amkopisktunn2009= '''',
amkopiskjarj2009= '''', 
amkopiskmaak2009= '''',
yoopiskkoulk2009= '''',
yoopisktunn2009= '''',
yoopiskjarj2009= '''', 
yoopiskmaak2009= '''',
monihaku2009= '''', 
ptoim1r4_2009= '''', 
amas_2009= '''',  
luopiskkoulk2010 = '''',
luopisktunn2010 = '''',
luopiskjarj2010 = '''', 
luopiskmaak2010 = '''', 
ammopiskkoulk2010 = '''', 
ammopisktunn2010 = '''',
ammopiskjarj2010 = '''', 
ammopiskmaak2010 = '''', 
amkopiskkoulk2010 = '''', 
amkopisktunn2010 = '''', 
amkopiskjarj2010 = '''',
amkopiskmaak2010 = '''', 
yoopiskkoulk2010 = '''', 
yoopisktunn2010 = '''' ,
yoopiskjarj2010 = '''',
yoopiskmaak2010 = '''',
monihaku2010 = '''', 
ptoim1r4_2010 = '''', 
amas_2010 = '''', 
luopiskkoulk2011 = '''',
luopisktunn2011 = '''',
luopiskjarj2011 = '''', 
luopiskmaak2011 = '''', 
ammopiskkoulk2011 = '''', 
ammopisktunn2011= '''',
ammopiskjarj2011 = '''', 
ammopiskmaak2011 = '''', 
amkopiskkoulk2011 = '''', 
amkopisktunn2011 = '''', 
amkopiskjarj2011 = '''',
amkopiskmaak2011 = '''', 
yoopiskkoulk2011 = '''', 
yoopisktunn2011 = '''' ,
yoopiskjarj2011 = '''',
yoopiskmaak2011 = '''',
monihaku2011 = '''', 
ptoim1r4_2011 = '''', 
amas_2011 = '''', 
luopiskkoulk2012 = '''',
luopisktunn2012 = '''',
luopiskjarj2012 = '''', 
luopiskmaak2012 = '''', 
ammopiskkoulk2012 = '''', 
ammopisktunn2012= '''',
ammopiskjarj2012 = '''', 
ammopiskmaak2012 = '''', 
amkopiskkoulk2012 = '''', 
amkopisktunn2012 = '''', 
amkopiskjarj2012 = '''',
amkopiskmaak2012 = '''', 
yoopiskkoulk2012 = '''', 
yoopisktunn2012 = '''' ,
yoopiskjarj2012 = '''',
yoopiskmaak2012 = '''',
monihaku2012 = '''', 
ptoim1r4_2012 = '''', 
amas_2012 = '''', 
luopiskkoulk_2013,
(CASE WHEN [luopisktunn_2013] = ''BBBBB'' THEN ''''
      WHEN [luopisktunn_2013] = ''99999'' THEN ''''
      WHEN [luopisktunn_2013] = ''00000'' THEN ''''
      ELSE [luopisktunn_2013] END) AS luopisktunn2013,
luopiskjarj_2013, 
(CASE WHEN [luopiskmaak_2013] = ''99'' THEN ''''ELSE [luopiskmaak_2013] END) AS luopiskmaak2013, 
ammopiskkoulk_2013, 
(CASE WHEN [ammopisktunn_2013] = ''BBBBBB'' THEN ''''
      WHEN [ammopisktunn_2013] = ''99'' THEN ''''
      WHEN [ammopisktunn_2013] = ''00000'' THEN ''''
      when [ammopisktunn_2013]   = ''90009'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2013]  = ''90015'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2013]  = ''90010'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2013]  = ''90018'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2013]  = ''90008'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2013]  = ''90032'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2013]  = ''90032'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2013]  = ''90018'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2013]  = ''90006'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2013]  = ''90006'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2013]  = ''90006'' AND [tilv] = ''2011'' THEN ''''
        when [ammopisktunn_2013] = ''90018'' AND [tilv] = ''2013'' THEN ''''
      ELSE [ammopisktunn_2013] END)AS ammopisktunn2013,
ammopiskjarj_2013, 
(CASE WHEN [ammopiskmaak_2013] = ''99'' THEN ''''ELSE [ammopiskmaak_2013] END) as ammopiskmaak2013, 
amkopiskkoulk_2013, 
(CASE WHEN [amkopisktunn_2013] = ''BBBBB'' THEN ''''
      WHEN [amkopisktunn_2013] = ''99999'' THEN '''' 
      WHEN [amkopisktunn_2013] = ''00000'' THEN ''''ELSE [amkopisktunn_2013] END) AS amkopisktunn2013,
amkopiskjarj_2013,
(CASE WHEN [amkopiskmaak_2013] = ''99'' THEN '''' ELSE [amkopiskmaak_2013] END) AS amkopiskmaak2013, 
yoopiskkoulk_2013, 
(CASE WHEN [yoopisktunn_2013] = ''BBBBB'' THEN ''''
      WHEN [yoopisktunn_2013] = ''99999'' THEN ''''
      WHEN [yoopisktunn_2013] = ''00000'' THEN '''' ELSE [yoopisktunn_2013] END) AS yoopisktunn2013,
yoopiskjarj_2013,
(CASE WHEN [yoopiskmaak_2013] = ''99'' THEN '''' ELSE [yoopiskmaak_2013] END) AS yoopiskmaak2013,
(CASE WHEN [monihaku_2013] is NULL THEN '''' ELSE [monihaku_2013] END) as monihaku2013, 
(CASE WHEN [ptoim1r4_2013] is NULL THEN '''' ELSE [ptoim1r4_2013] END) as ptoim1r4_2013, 
(CASE WHEN [amas_2013] is NULL THEN '''' ELSE [amas_2013] END) as amas_2013,  
luopiskkoulk_2014,
(CASE WHEN [luopisktunn_2014] = ''BBBBB'' THEN ''''
      WHEN [luopisktunn_2014] = ''99999'' THEN ''''
      WHEN [luopisktunn_2014] = ''00000'' THEN ''''
      ELSE [luopisktunn_2014] END) AS luopisktunn2014,
luopiskjarj_2014, 
(CASE WHEN [luopiskmaak_2014] = ''99'' THEN ''''ELSE [luopiskmaak_2014] END) AS luopiskmaak2014, 
ammopiskkoulk_2014, 
(CASE WHEN [ammopisktunn_2014] = ''BBBBBB'' THEN ''''
      WHEN [ammopisktunn_2014] = ''99'' THEN ''''
      WHEN [ammopisktunn_2014] = ''00000'' THEN ''''
      when [ammopisktunn_2014]   = ''90009'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2014]  = ''90015'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2014]  = ''90010'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2014]  = ''90018'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2014]  = ''90008'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2014]  = ''90032'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2014]  = ''90032'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2014]  = ''90018'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2014]  = ''90006'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2014]  = ''90006'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2014]  = ''90006'' AND [tilv] = ''2011'' THEN ''''
        when [ammopisktunn_2014] = ''90018'' AND [tilv] = ''2012'' THEN ''''
      ELSE [ammopisktunn_2014] END)AS ammopisktunn2014,
ammopiskjarj_2014, 
(CASE WHEN [ammopiskmaak_2014] = ''99'' THEN ''''ELSE [ammopiskmaak_2014] END) as ammopiskmaak2014, 
amkopiskkoulk_2014, 
(CASE WHEN [amkopisktunn_2014] = ''BBBBB'' THEN ''''
      WHEN [amkopisktunn_2014] = ''99999'' THEN '''' 
      WHEN [amkopisktunn_2014] = ''00000'' THEN ''''ELSE [amkopisktunn_2014] END) AS amkopisktunn2014,
amkopiskjarj_2014,
(CASE WHEN [amkopiskmaak_2014] = ''99'' THEN '''' ELSE [amkopiskmaak_2014] END) AS amkopiskmaak2014, 
yoopiskkoulk_2014, 
(CASE WHEN [yoopisktunn_2014] = ''BBBBB'' THEN ''''
      WHEN [yoopisktunn_2014] = ''99999'' THEN ''''
      WHEN [yoopisktunn_2014] = ''00000'' THEN '''' ELSE [yoopisktunn_2014] END) AS yoopisktunn2014,
yoopiskjarj_2014,
(CASE WHEN [yoopiskmaak_2014] = ''99'' THEN '''' ELSE [yoopiskmaak_2014] END) AS yoopiskmaak2014,
(CASE WHEN [monihaku_2014] is NULL THEN '''' ELSE [monihaku_2014] END) as monihaku2014, 
(CASE WHEN [ptoim1r4_2014] is NULL THEN '''' ELSE [ptoim1r4_2014] END) as ptoim1r4_2014, 
(CASE WHEN [amas_2014] is NULL THEN '''' ELSE [amas_2014] END) as amas_2014, 
lkm, 
pohjkoul,
 [tietolahde]=''K3_12_sopv_16'',
 [rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_K3_12_sopv_16] 
 



 ) Aineistot















' 
GO
/****** Object:  View [dbo].[v_K3_13_Perusk_paattaneet_amm_tutk_suorittaneet]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_K3_13_Perusk_paattaneet_amm_tutk_suorittaneet]'))
EXEC dbo.sp_executesql @statement = N'








CREATE VIEW [dbo].[v_K3_13_Perusk_paattaneet_amm_tutk_suorittaneet] AS
SELECT
	   [tilv]
	  ,[tilv_date]
	  ,(case when [tutkryh] is NULL then '''' else [tutkryh] end ) as [tutkryh]
      ,(case when [suorv] is NULL then '''' else [suorv] end ) as [suorv]
	  ,(case when [suorlk] is NULL then '''' else [suorlk] end ) as [suorlk]
	  ,(case when [sp] is NULL then '''' else [sp] end ) as [sp]
      ,(case when [syntv] is NULL then '''' else [syntv] end ) as [syntv]
	  ,(case when [aikielir1] is NULL then '''' else [aikielir1] end ) as [aikielir1]
      ,(case when [tutkaskun] is NULL then '''' else [tutkaskun] end ) as [tutkaskun]
      ,(case when [kansalr1] is NULL then '''' else [kansalr1] end ) as [kansalr1]
      ,(case when [pohjmaa] is NULL then '''' else [pohjmaa] end ) as [pohjmaa]
      ,(case when [eumaa] is NULL then '''' else [eumaa] end ) as [eumaa]
      ,(case when [etamaa] is NULL then '''' else [etamaa] end ) as [etamaa]
      ,(case when [tunn] is NULL then '''' else [tunn] end ) as [tunn]
      ,(case when [jarj] is NULL then '''' else [jarj] end ) as [jarj]
      ,(case when [kkielir1] is NULL then '''' else [kkielir1] end ) as [kkielir1]
      ,(case when [tutklaja] is NULL then '''' else [tutklaja] end ) as [tutklaja]
      ,(case when [tutktav] is NULL then '''' else [tutktav] end ) as [tutktav]
      ,(case when [aikoul] is NULL then '''' else [aikoul] end ) as [aikoul]
      ,(case when [tutkmaak] is NULL then '''' else [tutkmaak] end ) as [tutkmaak]
	   ,(case when [luopiskkoulk2004] is NULL then '''' else [luopiskkoulk2004] end ) as [luopiskkoulk2004]
	    ,(case when [luopisktunn2004] is NULL then '''' else [luopisktunn2004] end ) as [luopisktunn2004]
		,(case when [luopiskjarj2004] is NULL then '''' else [luopiskjarj2004] end ) as [luopiskjarj2004]
		,(case when [luopiskmaak2004] is NULL then '''' else [luopiskmaak2004] end ) as [luopiskmaak2004]
		   ,(case when [ammopiskkoulk2004] is NULL then '''' else [ammopiskkoulk2004] end ) as [ammopiskkoulk2004]
	    ,(case when [ammopisktunn2004] is NULL then '''' else [ammopisktunn2004] end ) as [ammopisktunn2004]
		,(case when [ammopiskjarj2004] is NULL then '''' else [ammopiskjarj2004] end ) as [ammopiskjarj2004]
		,(case when [ammopiskmaak2004] is NULL then '''' else [ammopiskmaak2004] end ) as [ammopiskmaak2004]
		   ,(case when [amkopiskkoulk2004] is NULL then '''' else [amkopiskkoulk2004] end ) as [amkopiskkoulk2004]
	    ,(case when [amkopisktunn2004] is NULL then '''' else [amkopisktunn2004] end ) as [amkopisktunn2004]
		,(case when [amkopiskjarj2004] is NULL then '''' else [amkopiskjarj2004] end ) as [amkopiskjarj2004]
		,(case when [amkopiskmaak2004] is NULL then '''' else [amkopiskmaak2004] end ) as [amkopiskmaak2004]
       ,(case when [yoopiskkoulk2004] is NULL then '''' else [yoopiskkoulk2004] end ) as [yoopiskkoulk2004]
	    ,(case when [yoopisktunn2004] is NULL then '''' else [yoopisktunn2004] end ) as [yoopisktunn2004]
		,(case when [yoopiskjarj2004] is NULL then '''' else [yoopiskjarj2004] end ) as [yoopiskjarj2004]
		,(case when [yoopiskmaak2004] is NULL then '''' else [yoopiskmaak2004] end ) as [yoopiskmaak2004]
    ,(case when [monihaku2004] is NULL then '''' else [monihaku2004] end ) as [monihaku2004]
	  ,(case when [ptoim1r4_2004] is NULL then '''' else [ptoim1r4_2004] end ) as [ptoim1r4_2004]
      ,(case when [amas_2004] is NULL then '''' else [amas_2004] end ) as [amas_2004]
        ,(case when [luopiskkoulk2005] is NULL then '''' else [luopiskkoulk2005] end ) as [luopiskkoulk2005]
	    ,(case when [luopisktunn2005] is NULL then '''' else [luopisktunn2005] end ) as [luopisktunn2005]
		,(case when [luopiskjarj2005] is NULL then '''' else [luopiskjarj2005] end ) as [luopiskjarj2005]
		,(case when [luopiskmaak2005] is NULL then '''' else [luopiskmaak2005] end ) as [luopiskmaak2005]
		   ,(case when [ammopiskkoulk2005] is NULL then '''' else [ammopiskkoulk2005] end ) as [ammopiskkoulk2005]
	    ,(case when [ammopisktunn2005] is NULL then '''' else [ammopisktunn2005] end ) as [ammopisktunn2005]
		,(case when [ammopiskjarj2005] is NULL then '''' else [ammopiskjarj2005] end ) as [ammopiskjarj2005]
		,(case when [ammopiskmaak2005] is NULL then '''' else [ammopiskmaak2005] end ) as [ammopiskmaak2005]
		   ,(case when [amkopiskkoulk2005] is NULL then '''' else [amkopiskkoulk2005] end ) as [amkopiskkoulk2005]
	    ,(case when [amkopisktunn2005] is NULL then '''' else [amkopisktunn2005] end ) as [amkopisktunn2005]
		,(case when [amkopiskjarj2005] is NULL then '''' else [amkopiskjarj2005] end ) as [amkopiskjarj2005]
		,(case when [amkopiskmaak2005] is NULL then '''' else [amkopiskmaak2005] end ) as [amkopiskmaak2005]
       ,(case when [yoopiskkoulk2005] is NULL then '''' else [yoopiskkoulk2005] end ) as [yoopiskkoulk2005]
	    ,(case when [yoopisktunn2005] is NULL then '''' else [yoopisktunn2005] end ) as [yoopisktunn2005]
		,(case when [yoopiskjarj2005] is NULL then '''' else [yoopiskjarj2005] end ) as [yoopiskjarj2005]
		,(case when [yoopiskmaak2005] is NULL then '''' else [yoopiskmaak2005] end ) as [yoopiskmaak2005]
    ,(case when [monihaku2005] is NULL then '''' else [monihaku2005] end ) as [monihaku2005]
	  ,(case when [ptoim1r4_2005] is NULL then '''' else [ptoim1r4_2005] end ) as [ptoim1r4_2005]
      ,(case when [amas_2005] is NULL then '''' else [amas_2005] end ) as [amas_2005]
        ,(case when [luopiskkoulk2006] is NULL then '''' else [luopiskkoulk2006] end ) as [luopiskkoulk2006]
	    ,(case when [luopisktunn2006] is NULL then '''' else [luopisktunn2006] end ) as [luopisktunn2006]
		,(case when [luopiskjarj2006] is NULL then '''' else [luopiskjarj2006] end ) as [luopiskjarj2006]
		,(case when [luopiskmaak2006] is NULL then '''' else [luopiskmaak2006] end ) as [luopiskmaak2006]
		   ,(case when [ammopiskkoulk2006] is NULL then '''' else [ammopiskkoulk2006] end ) as [ammopiskkoulk2006]
	    ,(case when [ammopisktunn2006] is NULL then '''' else [ammopisktunn2006] end ) as [ammopisktunn2006]
		,(case when [ammopiskjarj2006] is NULL then '''' else [ammopiskjarj2006] end ) as [ammopiskjarj2006]
		,(case when [ammopiskmaak2006] is NULL then '''' else [ammopiskmaak2006] end ) as [ammopiskmaak2006]
		   ,(case when [amkopiskkoulk2006] is NULL then '''' else [amkopiskkoulk2006] end ) as [amkopiskkoulk2006]
	    ,(case when [amkopisktunn2006] is NULL then '''' else [amkopisktunn2006] end ) as [amkopisktunn2006]
		,(case when [amkopiskjarj2006] is NULL then '''' else [amkopiskjarj2006] end ) as [amkopiskjarj2006]
		,(case when [amkopiskmaak2006] is NULL then '''' else [amkopiskmaak2006] end ) as [amkopiskmaak2006]
       ,(case when [yoopiskkoulk2006] is NULL then '''' else [yoopiskkoulk2006] end ) as [yoopiskkoulk2006]
	    ,(case when [yoopisktunn2006] is NULL then '''' else [yoopisktunn2006] end ) as [yoopisktunn2006]
		,(case when [yoopiskjarj2006] is NULL then '''' else [yoopiskjarj2006] end ) as [yoopiskjarj2006]
		,(case when [yoopiskmaak2006] is NULL then '''' else [yoopiskmaak2006] end ) as [yoopiskmaak2006]
    ,(case when [monihaku2006] is NULL then '''' else [monihaku2006] end ) as [monihaku2006]
	  ,(case when [ptoim1r4_2006] is NULL then '''' else [ptoim1r4_2006] end ) as [ptoim1r4_2006]
      ,(case when [amas_2006] is NULL then '''' else [amas_2006] end ) as [amas_2006]
        ,(case when [luopiskkoulk2007] is NULL then '''' else [luopiskkoulk2007] end ) as [luopiskkoulk2007]
	    ,(case when [luopisktunn2007] is NULL then '''' else [luopisktunn2007] end ) as [luopisktunn2007]
		,(case when [luopiskjarj2007] is NULL then '''' else [luopiskjarj2007] end ) as [luopiskjarj2007]
		,(case when [luopiskmaak2007] is NULL then '''' else [luopiskmaak2007] end ) as [luopiskmaak2007]
		   ,(case when [ammopiskkoulk2007] is NULL then '''' else [ammopiskkoulk2007] end ) as [ammopiskkoulk2007]
	    ,(case when [ammopisktunn2007] is NULL then '''' else [ammopisktunn2007] end ) as [ammopisktunn2007]
		,(case when [ammopiskjarj2007] is NULL then '''' else [ammopiskjarj2007] end ) as [ammopiskjarj2007]
		,(case when [ammopiskmaak2007] is NULL then '''' else [ammopiskmaak2007] end ) as [ammopiskmaak2007]
		   ,(case when [amkopiskkoulk2007] is NULL then '''' else [amkopiskkoulk2007] end ) as [amkopiskkoulk2007]
	    ,(case when [amkopisktunn2007] is NULL then '''' else [amkopisktunn2007] end ) as [amkopisktunn2007]
		,(case when [amkopiskjarj2007] is NULL then '''' else [amkopiskjarj2007] end ) as [amkopiskjarj2007]
		,(case when [amkopiskmaak2007] is NULL then '''' else [amkopiskmaak2007] end ) as [amkopiskmaak2007]
       ,(case when [yoopiskkoulk2007] is NULL then '''' else [yoopiskkoulk2007] end ) as [yoopiskkoulk2007]
	    ,(case when [yoopisktunn2007] is NULL then '''' else [yoopisktunn2007] end ) as [yoopisktunn2007]
		,(case when [yoopiskjarj2007] is NULL then '''' else [yoopiskjarj2007] end ) as [yoopiskjarj2007]
		,(case when [yoopiskmaak2007] is NULL then '''' else [yoopiskmaak2007] end ) as [yoopiskmaak2007]
    ,(case when [monihaku2007] is NULL then '''' else [monihaku2007] end ) as [monihaku2007]
	  ,(case when [ptoim1r4_2007] is NULL then '''' else [ptoim1r4_2007] end ) as [ptoim1r4_2007]
      ,(case when [amas_2007] is NULL then '''' else [amas_2007] end ) as [amas_2007]
        ,(case when [luopiskkoulk2008] is NULL then '''' else [luopiskkoulk2008] end ) as [luopiskkoulk2008]
	    ,(case when [luopisktunn2008] is NULL then '''' else [luopisktunn2008] end ) as [luopisktunn2008]
		,(case when [luopiskjarj2008] is NULL then '''' else [luopiskjarj2008] end ) as [luopiskjarj2008]
		,(case when [luopiskmaak2008] is NULL then '''' else [luopiskmaak2008] end ) as [luopiskmaak2008]
		   ,(case when [ammopiskkoulk2008] is NULL then '''' else [ammopiskkoulk2008] end ) as [ammopiskkoulk2008]
	    ,(case when [ammopisktunn2008] is NULL then '''' else [ammopisktunn2008] end ) as [ammopisktunn2008]
		,(case when [ammopiskjarj2008] is NULL then '''' else [ammopiskjarj2008] end ) as [ammopiskjarj2008]
		,(case when [ammopiskmaak2008] is NULL then '''' else [ammopiskmaak2008] end ) as [ammopiskmaak2008]
		   ,(case when [amkopiskkoulk2008] is NULL then '''' else [amkopiskkoulk2008] end ) as [amkopiskkoulk2008]
	    ,(case when [amkopisktunn2008] is NULL then '''' else [amkopisktunn2008] end ) as [amkopisktunn2008]
		,(case when [amkopiskjarj2008] is NULL then '''' else [amkopiskjarj2008] end ) as [amkopiskjarj2008]
		,(case when [amkopiskmaak2008] is NULL then '''' else [amkopiskmaak2008] end ) as [amkopiskmaak2008]
       ,(case when [yoopiskkoulk2008] is NULL then '''' else [yoopiskkoulk2008] end ) as [yoopiskkoulk2008]
	    ,(case when [yoopisktunn2008] is NULL then '''' else [yoopisktunn2008] end ) as [yoopisktunn2008]
		,(case when [yoopiskjarj2008] is NULL then '''' else [yoopiskjarj2008] end ) as [yoopiskjarj2008]
		,(case when [yoopiskmaak2008] is NULL then '''' else [yoopiskmaak2008] end ) as [yoopiskmaak2008]
    ,(case when [monihaku2008] is NULL then '''' else [monihaku2008] end ) as [monihaku2008]
	  ,(case when [ptoim1r4_2008] is NULL then '''' else [ptoim1r4_2008] end ) as [ptoim1r4_2008]
      ,(case when [amas_2008] is NULL then '''' else [amas_2008] end ) as [amas_2008]
       ,(case when [luopiskkoulk2009] is NULL then '''' else [luopiskkoulk2009] end ) as [luopiskkoulk2009]
	    ,(case when [luopisktunn2009] is NULL then '''' else [luopisktunn2009] end ) as [luopisktunn2009]
		,(case when [luopiskjarj2009] is NULL then '''' else [luopiskjarj2009] end ) as [luopiskjarj2009]
		,(case when [luopiskmaak2009] is NULL then '''' else [luopiskmaak2009] end ) as [luopiskmaak2009]
		   ,(case when [ammopiskkoulk2009] is NULL then '''' else [ammopiskkoulk2009] end ) as [ammopiskkoulk2009]
	    ,(case when [ammopisktunn2009] is NULL then '''' else [ammopisktunn2009] end ) as [ammopisktunn2009]
		,(case when [ammopiskjarj2009] is NULL then '''' else [ammopiskjarj2009] end ) as [ammopiskjarj2009]
		,(case when [ammopiskmaak2009] is NULL then '''' else [ammopiskmaak2009] end ) as [ammopiskmaak2009]
		   ,(case when [amkopiskkoulk2009] is NULL then '''' else [amkopiskkoulk2009] end ) as [amkopiskkoulk2009]
	    ,(case when [amkopisktunn2009] is NULL then '''' else [amkopisktunn2009] end ) as [amkopisktunn2009]
		,(case when [amkopiskjarj2009] is NULL then '''' else [amkopiskjarj2009] end ) as [amkopiskjarj2009]
		,(case when [amkopiskmaak2009] is NULL then '''' else [amkopiskmaak2009] end ) as [amkopiskmaak2009]
       ,(case when [yoopiskkoulk2009] is NULL then '''' else [yoopiskkoulk2009] end ) as [yoopiskkoulk2009]
	    ,(case when [yoopisktunn2009] is NULL then '''' else [yoopisktunn2009] end ) as [yoopisktunn2009]
		,(case when [yoopiskjarj2009] is NULL then '''' else [yoopiskjarj2009] end ) as [yoopiskjarj2009]
		,(case when [yoopiskmaak2009] is NULL then '''' else [yoopiskmaak2009] end ) as [yoopiskmaak2009]
    ,(case when [monihaku2009] is NULL then '''' else [monihaku2009] end ) as [monihaku2009]
	  ,(case when [ptoim1r4_2009] is NULL then '''' else [ptoim1r4_2009] end ) as [ptoim1r4_2009]
      ,(case when [amas_2009] is NULL then '''' else [amas_2009] end ) as [amas_2009]
	   ,(case when [luopiskkoulk2010] is NULL then '''' else [luopiskkoulk2010] end ) as [luopiskkoulk2010]
	    ,(case when [luopisktunn2010] is NULL then '''' else [luopisktunn2010] end ) as [luopisktunn2010]
		,(case when [luopiskjarj2010] is NULL then '''' else [luopiskjarj2010] end ) as [luopiskjarj2010]
		,(case when [luopiskmaak2010] is NULL then '''' else [luopiskmaak2010] end ) as [luopiskmaak2010]
		   ,(case when [ammopiskkoulk2010] is NULL then '''' else [ammopiskkoulk2010] end ) as [ammopiskkoulk2010]
	    ,(case when [ammopisktunn2010] is NULL then '''' else [ammopisktunn2010] end ) as [ammopisktunn2010]
		,(case when [ammopiskjarj2010] is NULL then '''' else [ammopiskjarj2010] end ) as [ammopiskjarj2010]
		,(case when [ammopiskmaak2010] is NULL then '''' else [ammopiskmaak2010] end ) as [ammopiskmaak2010]
		   ,(case when [amkopiskkoulk2010] is NULL then '''' else [amkopiskkoulk2010] end ) as [amkopiskkoulk2010]
	    ,(case when [amkopisktunn2010] is NULL then '''' else [amkopisktunn2010] end ) as [amkopisktunn2010]
		,(case when [amkopiskjarj2010] is NULL then '''' else [amkopiskjarj2010] end ) as [amkopiskjarj2010]
		,(case when [amkopiskmaak2010] is NULL then '''' else [amkopiskmaak2010] end ) as [amkopiskmaak2010]
       ,(case when [yoopiskkoulk2010] is NULL then '''' else [yoopiskkoulk2010] end ) as [yoopiskkoulk2010]
	    ,(case when [yoopisktunn2010] is NULL then '''' else [yoopisktunn2010] end ) as [yoopisktunn2010]
		,(case when [yoopiskjarj2010] is NULL then '''' else [yoopiskjarj2010] end ) as [yoopiskjarj2010]
		,(case when [yoopiskmaak2010] is NULL then '''' else [yoopiskmaak2010] end ) as [yoopiskmaak2010]
    ,(case when [monihaku2010] is NULL then '''' else [monihaku2010] end ) as [monihaku2010]
	  ,(case when [ptoim1r4_2010] is NULL then '''' else [ptoim1r4_2010] end ) as [ptoim1r4_2010]
      ,(case when [amas_2010] is NULL then '''' else [amas_2010] end ) as [amas_2010]
	   ,(case when [luopiskkoulk2011] is NULL then '''' else [luopiskkoulk2011] end ) as [luopiskkoulk2011]
	    ,(case when [luopisktunn2011] is NULL then '''' else [luopisktunn2011] end ) as [luopisktunn2011]
		,(case when [luopiskjarj2011] is NULL then '''' else [luopiskjarj2011] end ) as [luopiskjarj2011]
		,(case when [luopiskmaak2011] is NULL then '''' else [luopiskmaak2011] end ) as [luopiskmaak2011]
		   ,(case when [ammopiskkoulk2011] is NULL then '''' else [ammopiskkoulk2011] end ) as [ammopiskkoulk2011]
	    ,(case when [ammopisktunn2011] is NULL then '''' else [ammopisktunn2011] end ) as [ammopisktunn2011]
		,(case when [ammopiskjarj2011] is NULL then '''' else [ammopiskjarj2011] end ) as [ammopiskjarj2011]
		,(case when [ammopiskmaak2011] is NULL then '''' else [ammopiskmaak2011] end ) as [ammopiskmaak2011]
		   ,(case when [amkopiskkoulk2011] is NULL then '''' else [amkopiskkoulk2011] end ) as [amkopiskkoulk2011]
	    ,(case when [amkopisktunn2011] is NULL then '''' else [amkopisktunn2011] end ) as [amkopisktunn2011]
		,(case when [amkopiskjarj2011] is NULL then '''' else [amkopiskjarj2011] end ) as [amkopiskjarj2011]
		,(case when [amkopiskmaak2011] is NULL then '''' else [amkopiskmaak2011] end ) as [amkopiskmaak2011]
       ,(case when [yoopiskkoulk2011] is NULL then '''' else [yoopiskkoulk2011] end ) as [yoopiskkoulk2011]
	    ,(case when [yoopisktunn2011] is NULL then '''' else [yoopisktunn2011] end ) as [yoopisktunn2011]
		,(case when [yoopiskjarj2011] is NULL then '''' else [yoopiskjarj2011] end ) as [yoopiskjarj2011]
		,(case when [yoopiskmaak2011] is NULL then '''' else [yoopiskmaak2011] end ) as [yoopiskmaak2011]
    ,(case when [monihaku2011] is NULL then '''' else [monihaku2011] end ) as [monihaku2011]
	  ,(case when [ptoim1r4_2011] is NULL then '''' else [ptoim1r4_2011] end ) as [ptoim1r4_2011]
      ,(case when [amas_2011] is NULL then '''' else [amas_2011] end ) as [amas_2011]
	   ,(case when [luopiskkoulk2012] is NULL then '''' else [luopiskkoulk2012] end ) as [luopiskkoulk2012]
	    ,(case when [luopisktunn2012] is NULL then '''' else [luopisktunn2012] end ) as [luopisktunn2012]
		,(case when [luopiskjarj2012] is NULL then '''' else [luopiskjarj2012] end ) as [luopiskjarj2012]
		,(case when [luopiskmaak2012] is NULL then '''' else [luopiskmaak2012] end ) as [luopiskmaak2012]
		   ,(case when [ammopiskkoulk2012] is NULL then '''' else [ammopiskkoulk2012] end ) as [ammopiskkoulk2012]
	    ,(case when [ammopisktunn2012] is NULL then '''' else [ammopisktunn2012] end ) as [ammopisktunn2012]
		,(case when [ammopiskjarj2012] is NULL then '''' else [ammopiskjarj2012] end ) as [ammopiskjarj2012]
		,(case when [ammopiskmaak2012] is NULL then '''' else [ammopiskmaak2012] end ) as [ammopiskmaak2012]
		   ,(case when [amkopiskkoulk2012] is NULL then '''' else [amkopiskkoulk2012] end ) as [amkopiskkoulk2012]
	    ,(case when [amkopisktunn2012] is NULL then '''' else [amkopisktunn2012] end ) as [amkopisktunn2012]
		,(case when [amkopiskjarj2012] is NULL then '''' else [amkopiskjarj2012] end ) as [amkopiskjarj2012]
		,(case when [amkopiskmaak2012] is NULL then '''' else [amkopiskmaak2012] end ) as [amkopiskmaak2012]
       ,(case when [yoopiskkoulk2012] is NULL then '''' else [yoopiskkoulk2012] end ) as [yoopiskkoulk2012]
	    ,(case when [yoopisktunn2012] is NULL then '''' else [yoopisktunn2012] end ) as [yoopisktunn2012]
		,(case when [yoopiskjarj2012] is NULL then '''' else [yoopiskjarj2012] end ) as [yoopiskjarj2012]
		,(case when [yoopiskmaak2012] is NULL then '''' else [yoopiskmaak2012] end ) as [yoopiskmaak2012]
    ,(case when [monihaku2012] is NULL then '''' else [monihaku2012] end ) as [monihaku2012]
	  ,(case when [ptoim1r4_2012] is NULL then '''' else [ptoim1r4_2012] end ) as [ptoim1r4_2012]
      ,(case when [amas_2012] is NULL then '''' else [amas_2012] end ) as [amas_2012]
	   ,(case when [luopiskkoulk2013] is NULL then '''' else [luopiskkoulk2013] end ) as [luopiskkoulk2013]
	    ,(case when [luopisktunn2013] is NULL then '''' else [luopisktunn2013] end ) as [luopisktunn2013]
		,(case when [luopiskjarj2013] is NULL then '''' else [luopiskjarj2013] end ) as [luopiskjarj2013]
		,(case when [luopiskmaak2013] is NULL then '''' else [luopiskmaak2013] end ) as [luopiskmaak2013]
		   ,(case when [ammopiskkoulk2013] is NULL then '''' else [ammopiskkoulk2013] end ) as [ammopiskkoulk2013]
	    ,(case when [ammopisktunn2013] is NULL then '''' else [ammopisktunn2013] end ) as [ammopisktunn2013]
		,(case when [ammopiskjarj2013] is NULL then '''' else [ammopiskjarj2013] end ) as [ammopiskjarj2013]
		,(case when [ammopiskmaak2013] is NULL then '''' else [ammopiskmaak2013] end ) as [ammopiskmaak2013]
		   ,(case when [amkopiskkoulk2013] is NULL then '''' else [amkopiskkoulk2013] end ) as [amkopiskkoulk2013]
	    ,(case when [amkopisktunn2013] is NULL then '''' else [amkopisktunn2013] end ) as [amkopisktunn2013]
		,(case when [amkopiskjarj2013] is NULL then '''' else [amkopiskjarj2013] end ) as [amkopiskjarj2013]
		,(case when [amkopiskmaak2013] is NULL then '''' else [amkopiskmaak2013] end ) as [amkopiskmaak2013]
       ,(case when [yoopiskkoulk2013] is NULL then '''' else [yoopiskkoulk2013] end ) as [yoopiskkoulk2013]
	    ,(case when [yoopisktunn2013] is NULL then '''' else [yoopisktunn2013] end ) as [yoopisktunn2013]
		,(case when [yoopiskjarj2013] is NULL then '''' else [yoopiskjarj2013] end ) as [yoopiskjarj2013]
		,(case when [yoopiskmaak2013] is NULL then '''' else [yoopiskmaak2013] end ) as [yoopiskmaak2013]
    ,(case when [monihaku2013] is NULL then '''' else [monihaku2013] end ) as [monihaku2013]
	  ,(case when [ptoim1r4_2013] is NULL then '''' else [ptoim1r4_2013] end ) as [ptoim1r4_2013]
      ,(case when [amas_2013] is NULL then '''' else [amas_2013] end ) as [amas_2013]
	  ,(case when [luopiskkoulk2014] is NULL then '''' else [luopiskkoulk2014] end ) as [luopiskkoulk2014]
	    ,(case when [luopisktunn2014] is NULL then '''' else [luopisktunn2014] end ) as [luopisktunn2014]
		,(case when [luopiskjarj2014] is NULL then '''' else [luopiskjarj2014] end ) as [luopiskjarj2014]
		,(case when [luopiskmaak2014] is NULL then '''' else [luopiskmaak2014] end ) as [luopiskmaak2014]
		   ,(case when [ammopiskkoulk2014] is NULL then '''' else [ammopiskkoulk2014] end ) as [ammopiskkoulk2014]
	    ,(case when [ammopisktunn2014] is NULL then '''' else [ammopisktunn2014] end ) as [ammopisktunn2014]
		,(case when [ammopiskjarj2014] is NULL then '''' else [ammopiskjarj2014] end ) as [ammopiskjarj2014]
		,(case when [ammopiskmaak2014] is NULL then '''' else [ammopiskmaak2014] end ) as [ammopiskmaak2014]
		   ,(case when [amkopiskkoulk2014] is NULL then '''' else [amkopiskkoulk2014] end ) as [amkopiskkoulk2014]
	    ,(case when [amkopisktunn2014] is NULL then '''' else [amkopisktunn2014] end ) as [amkopisktunn2014]
		,(case when [amkopiskjarj2014] is NULL then '''' else [amkopiskjarj2014] end ) as [amkopiskjarj2014]
		,(case when [amkopiskmaak2014] is NULL then '''' else [amkopiskmaak2014] end ) as [amkopiskmaak2014]
       ,(case when [yoopiskkoulk2014] is NULL then '''' else [yoopiskkoulk2014] end ) as [yoopiskkoulk2014]
	    ,(case when [yoopisktunn2014] is NULL then '''' else [yoopisktunn2014] end ) as [yoopisktunn2014]
		,(case when [yoopiskjarj2014] is NULL then '''' else [yoopiskjarj2014] end ) as [yoopiskjarj2014]
		,(case when [yoopiskmaak2014] is NULL then '''' else [yoopiskmaak2014] end ) as [yoopiskmaak2014]
    ,(case when [monihaku2014] is NULL then '''' else [monihaku2014] end ) as [monihaku2014]
	  ,(case when [ptoim1r4_2014] is NULL then '''' else [ptoim1r4_2014] end ) as [ptoim1r4_2014]
      ,(case when [amas_2014] is NULL then '''' else [amas_2014] end ) as [amas_2014]
	,[lkm]
	,(case when [pohjkoul] is NULL then '''' else [pohjkoul] end ) as [pohjkoul]
	,[tietolahde]
	,[rivinumero]
FROM (
SELECT
       [tilv]
      ,CAST(tilv + ''0101'' AS date) AS tilv_date
      ,[tutkryh]
      ,[suorv]
      ,[suorlk]
      ,[sp]
      ,(CASE WHEN [syntv] = ''19XX'' THEN '''' ELSE [syntv] END) as syntv
      ,[aikielir1]
     ,(CASE WHEN [tutkaskun]=''427'' THEN ''''
 WHEN [tutkaskun]= ''946'' and (tilv= ''2009'' or tilv=''2010'') then ''945''
      WHEN [tutkaskun]= ''198'' THEN ''''
      WHEN [tutkaskun]= ''168'' THEN '''' 
	  WHEN [tutkaskun]= ''999'' THEN '''' ELSE [tutkaskun] END) as tutkaskun
      ,[kansalr1]
      ,[pohjmaa]
      ,[eumaa]
      ,[etamaa]
     ,(CASE  WHEN [tunn] = ''BBBBB'' THEN ''''
      WHEN [tunn] = ''99999'' THEN ''''
      WHEN [tunn] = ''00000'' THEN '''' 
      when [tunn] = ''90009'' AND [tilv] = ''2009'' THEN ''''
      when [tunn] = ''90015'' AND [tilv] = ''2009'' THEN ''''
      when [tunn] = ''90010'' AND [tilv] = ''2009'' THEN ''''
      when [tunn] = ''90018'' AND [tilv] = ''2009'' THEN ''''
      when [tunn] = ''90008'' AND [tilv] = ''2010'' THEN ''''
      when [tunn] = ''90032'' AND [tilv] = ''2010'' THEN ''''
      when [tunn] = ''90032'' AND [tilv] = ''2011'' THEN ''''
      when [tunn] = ''90018'' AND [tilv] = ''2011'' THEN ''''
      when [tunn] = ''90006'' AND [tilv] = ''2009'' THEN ''''
      when [tunn] = ''90006'' AND [tilv] = ''2010'' THEN ''''
      when [tunn] = ''90006'' AND [tilv] = ''2011'' THEN ''''
      when [tunn] = ''90010'' AND [tilv] = ''2010'' THEN ''''
      when [tunn] = ''90010'' AND [tilv] = ''2011'' THEN ''''
      when [tunn] = ''90008'' AND [tilv] = ''2011'' THEN ''''
      when [tunn] = ''90018'' AND [tilv] = ''2010'' THEN ''''
      when [tunn] = ''90018'' AND [tilv] = ''2011'' THEN ''''
        when [tunn] = ''90018'' AND [tilv] = ''2012'' THEN ''''
      ELSE [tunn] END) AS tunn
      ,[jarj]
      ,[kkielir1]
      ,[tutklaja]
      ,[tutktav]
      ,[aikoul]
      ,(CASE WHEN [tutkmaak] = ''99'' THEN '''' ELSE [tutkmaak] END) AS tutkmaak
      ,[luopiskkoulk_2004] as luopiskkoulk2004
      ,(CASE WHEN [luopisktunn_2004] = ''BBBBB'' THEN ''''
      WHEN [luopisktunn_2004] = ''99999'' THEN '''' ELSE [luopisktunn_2004] END) AS luopisktunn2004
      ,[luopiskjarj_2004] as luopiskjarj2004
      ,(CASE WHEN [luopiskmaak_2004] = ''99'' THEN '''' ELSE [luopiskmaak_2004] END) AS luopiskmaak2004
      ,[ammopiskkoulk_2004] as ammopiskkoulk2004
     
      ,(CASE WHEN [ammopisktunn_2004]  = ''BBBBB'' THEN ''''
      WHEN [ammopisktunn_2004]  = ''99999'' THEN ''''
      WHEN [ammopisktunn_2004]  = ''00000'' THEN ''''
      when [ammopisktunn_2004]   = ''90009'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2004]   = ''90015'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2004]   = ''90010'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2004]  = ''90018'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2004]  = ''90008'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2004]   = ''90032'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2004]   = ''90032'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2004]   = ''90018'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2004]   = ''90006'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2004]   = ''90006'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2004]   = ''90006'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2004] = ''90010'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2004] = ''90010'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2004] = ''90008'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2004]  = ''90018'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2004]  = ''90018'' AND [tilv] = ''2011'' THEN ''''
        when [ammopisktunn_2004] = ''90018'' AND [tilv] = ''2012'' THEN ''''
      ELSE [ammopisktunn_2004]  END) AS ammopisktunn2004
      ,[ammopiskjarj_2004] as ammopiskjarj2004
       ,(CASE WHEN [ammopiskmaak_2004] = ''99'' THEN '''' ELSE [ammopiskmaak_2004] END) AS ammopiskmaak2004
      ,[amkopiskkoulk_2004] as amkopiskkoulk2004
      ,(CASE WHEN [amkopisktunn_2004] = ''BBBBB'' THEN ''''
      WHEN [amkopisktunn_2004] = ''99999'' THEN '''' ELSE [amkopisktunn_2004] END) AS amkopisktunn2004
      ,[amkopiskjarj_2004] as amkopiskjarj2004
       ,(CASE WHEN [amkopiskmaak_2004] = ''99'' THEN '''' ELSE [amkopiskmaak_2004] END) AS amkopiskmaak2004
      ,[yoopiskkoulk_2004] as yoopiskkoulk2004
       ,(CASE WHEN [yoopisktunn_2004] = ''BBBBB'' THEN ''''
      WHEN [yoopisktunn_2004] = ''99999'' THEN '''' ELSE [yoopisktunn_2004] END) AS yoopisktunn2004
      ,[yoopiskjarj_2004] as yoopiskjarj2004
      ,(CASE WHEN [yoopiskmaak_2004] = ''99'' THEN '''' ELSE [yoopiskmaak_2004] END) AS yoopiskmaak2004
      ,[monihaku_2004] as monihaku2004
      ,[ptoim1r4_2004]
      ,[amas_2004]
      ,[luopiskkoulk_2005] as luopiskkoulk2005
      ,(CASE WHEN [luopisktunn_2005] = ''BBBBB'' THEN ''''
      WHEN [luopisktunn_2005] = ''99999'' THEN '''' ELSE [luopisktunn_2005] END) AS luopisktunn2005
      ,[luopiskjarj_2005] as luopiskjarj2005
      ,(CASE WHEN [luopiskmaak_2005] = ''99'' THEN '''' ELSE [luopiskmaak_2005] END) AS luopiskmaak2005
      ,[ammopiskkoulk_2005] as ammopiskkoulk2005
      ,(CASE WHEN [ammopisktunn_2005]  = ''BBBBB'' THEN ''''
      WHEN [ammopisktunn_2005]   = ''99999'' THEN ''''
      WHEN [ammopisktunn_2005]   = ''00000'' THEN ''''
      when [ammopisktunn_2005]    = ''90009'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2005]    = ''90015'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2005]    = ''90010'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2005]   = ''90018'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2005]   = ''90008'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2005]    = ''90032'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2005]    = ''90032'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2005]    = ''90018'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2005]    = ''90006'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2005]    = ''90006'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2005]    = ''90006'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2005]  = ''90010'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2005]  = ''90010'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2005]  = ''90008'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2005]   = ''90018'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2005]   = ''90018'' AND [tilv] = ''2011'' THEN ''''
        when [ammopisktunn_2005] = ''90018'' AND [tilv] = ''2012'' THEN ''''
      ELSE [ammopisktunn_2005]   END) AS ammopisktunn2005
      ,[ammopiskjarj_2005] as ammopiskjarj2005
       ,(CASE WHEN [ammopiskmaak_2005] = ''99'' THEN '''' ELSE [ammopiskmaak_2005] END) AS ammopiskmaak2005
      ,[amkopiskkoulk_2005] as amkopiskkoulk2005
       ,(CASE WHEN [amkopisktunn_2005] = ''BBBBB'' THEN ''''
      WHEN [amkopisktunn_2005] = ''99999'' THEN '''' ELSE [amkopisktunn_2005] END) AS amkopisktunn2005
      ,[amkopiskjarj_2005] as amkopiskjarj2005
      ,(CASE WHEN [amkopiskmaak_2005] = ''99'' THEN '''' ELSE [amkopiskmaak_2005] END) AS amkopiskmaak2005
      ,[yoopiskkoulk_2005] as yoopiskkoulk2005
      ,(CASE WHEN [yoopisktunn_2005] = ''BBBBB'' THEN ''''
      WHEN [yoopisktunn_2005] = ''99999'' THEN '''' ELSE [yoopisktunn_2005] END) AS yoopisktunn2005
      ,[yoopiskjarj_2005] as yoopiskjarj2005
      ,(CASE WHEN [yoopiskmaak_2005] = ''99'' THEN '''' ELSE [yoopiskmaak_2005] END) AS yoopiskmaak2005
      ,[monihaku_2005] as monihaku2005
      ,[ptoim1r4_2005]
      ,[amas_2005]
     ,[luopiskkoulk_2006] as luopiskkoulk2006
      ,(CASE WHEN [luopisktunn_2006] = ''BBBBB'' THEN ''''
      WHEN [luopisktunn_2006] = ''99999'' THEN '''' ELSE [luopisktunn_2006] END) AS luopisktunn2006

      ,[luopiskjarj_2006] as luopiskjarj2006
      ,(CASE WHEN [luopiskmaak_2006] = ''99'' THEN '''' ELSE [luopiskmaak_2006] END) AS luopiskmaak2006
      ,[ammopiskkoulk_2006] as ammopiskkoulk2006    
      ,(CASE WHEN [ammopisktunn_2006]  = ''BBBBB'' THEN ''''
      WHEN [ammopisktunn_2006]  = ''99999'' THEN ''''
      WHEN [ammopisktunn_2006]   = ''00000'' THEN ''''
      when [ammopisktunn_2006]    = ''90009'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2006]    = ''90015'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2006]    = ''90010'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2006]   = ''90018'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2006]   = ''90008'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2006]    = ''90032'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2006]    = ''90032'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2006]    = ''90018'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2006]    = ''90006'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2006]    = ''90006'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2006]    = ''90006'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2006]  = ''90010'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2006]  = ''90010'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2006]  = ''90008'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2006]   = ''90018'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2006]   = ''90018'' AND [tilv] = ''2011'' THEN ''''
        when [ammopisktunn_2006] = ''90018'' AND [tilv] = ''2012'' THEN ''''
      ELSE [ammopisktunn_2006]   END) AS ammopisktunn2006
	  ,[ammopiskjarj_2006] as ammopiskjarj2006
      ,(CASE WHEN [ammopiskmaak_2006] = ''99'' THEN '''' ELSE [ammopiskmaak_2006] END) AS ammopiskmaak2006
      ,[amkopiskkoulk_2006] as amkopiskkoulk2006
      ,(CASE WHEN [amkopisktunn_2006] = ''BBBBB'' THEN ''''
       WHEN [amkopisktunn_2006] = ''99999'' THEN '''' ELSE [amkopisktunn_2006] END) AS amkopisktunn2006
      ,[amkopiskjarj_2006] as amkopiskjarj2006
      ,[amkopiskmaak_2006] as amkopiskmaak2006
      ,[yoopiskkoulk_2006] as yoopiskkoulk2006
      ,(CASE WHEN [yoopisktunn_2006] = ''BBBBB'' THEN ''''
      WHEN [yoopisktunn_2006] = ''99999'' THEN '''' ELSE [yoopisktunn_2006] END) AS yoopisktunn2006
      ,[yoopiskjarj_2006] as yoopiskjarj2006
      ,(CASE WHEN [yoopiskmaak_2006] = ''99'' THEN '''' ELSE [yoopiskmaak_2006] END) AS yoopiskmaak2006
      ,[monihaku_2006] as monihaku2006
      ,[ptoim1r4_2006]
      ,[amas_2006]
      
       ,[luopiskkoulk_2007] as luopiskkoulk2007
       ,(CASE WHEN [luopisktunn_2007] = ''BBBBB'' THEN ''''
      WHEN [luopisktunn_2007]  = ''99999'' THEN '''' ELSE [luopisktunn_2007]  END) AS luopisktunn2007
      ,[luopiskjarj_2007] as luopiskjarj2007
      ,(CASE WHEN [luopiskmaak_2007] = ''99'' THEN '''' ELSE [luopiskmaak_2007] END) AS luopiskmaak2007
      ,[ammopiskkoulk_2007] as ammopiskkoulk2007
      ,(CASE WHEN [ammopisktunn_2007]  = ''BBBBB'' THEN ''''
      WHEN [ammopisktunn_2007]   = ''99999'' THEN ''''
      WHEN [ammopisktunn_2007]   = ''00000'' THEN ''''
      when [ammopisktunn_2007]    = ''90009'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2007]    = ''90015'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2007]    = ''90010'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2007]   = ''90018'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2007]   = ''90008'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2007]    = ''90032'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2007]    = ''90032'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2007]    = ''90018'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2007]    = ''90006'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2007]    = ''90006'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2007]    = ''90006'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2007]  = ''90010'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2007]  = ''90010'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2007]  = ''90008'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2007]   = ''90018'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2007]   = ''90018'' AND [tilv] = ''2011'' THEN ''''
        when [ammopisktunn_2007] = ''90018'' AND [tilv] = ''2012'' THEN ''''
      ELSE [ammopisktunn_2007]   END) AS ammopisktunn2007
      ,[ammopiskjarj_2007] as ammopiskjarj2007
      ,(CASE WHEN [ammopiskmaak_2007] = ''99'' THEN '''' ELSE [ammopiskmaak_2007] END) AS ammopiskmaak2007
      ,[amkopiskkoulk_2007] as amkopiskkoulk2007
     ,(CASE WHEN [amkopisktunn_2007] = ''BBBBB'' THEN ''''
       WHEN [amkopisktunn_2007] = ''99999'' THEN '''' ELSE [amkopisktunn_2007] END) AS amkopisktunn2007
      ,[amkopiskjarj_2007] as amkopiskjarj2007
      ,[amkopiskmaak_2007] as amkopiskmaak2007
      
      ,[yoopiskkoulk_2007] as yoopiskkoulk2007
     ,(CASE WHEN [yoopisktunn_2007] = ''BBBBB'' THEN ''''
      WHEN [yoopisktunn_2007] = ''99999'' THEN '''' ELSE [yoopisktunn_2007] END) AS yoopisktunn2007
      ,[yoopiskjarj_2007] as yoopiskjarj2007
      ,(CASE WHEN [yoopiskmaak_2007] = ''99'' THEN '''' ELSE [yoopiskmaak_2007] END) AS yoopiskmaak2007
      
      ,[monihaku_2007] as monihaku2007
      ,[ptoim1r4_2007]
      ,[amas_2007]
      
     ,[luopiskkoulk_2008] as luopiskkoulk2008
       ,(CASE WHEN [luopisktunn_2008] = ''BBBBB'' THEN ''''
      WHEN [luopisktunn_2008] = ''99999'' THEN '''' ELSE [luopisktunn_2008] END) AS luopisktunn2008
      ,[luopiskjarj_2008] as luopiskjarj2008
      ,(CASE WHEN [luopiskmaak_2008] = ''99'' THEN '''' ELSE [luopiskmaak_2008] END) AS luopiskmaak2008
      ,[ammopiskkoulk_2008] as ammopiskkoulk2008
      ,(CASE WHEN [ammopisktunn_2008]   = ''BBBBB'' THEN ''''
      WHEN [ammopisktunn_2008]    = ''99999'' THEN ''''
      WHEN [ammopisktunn_2008]    = ''00000'' THEN ''''
      when [ammopisktunn_2008]     = ''90009'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2008]     = ''90015'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2008]     = ''90010'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2008]    = ''90018'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2008]    = ''90008'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2008]     = ''90032'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2008]     = ''90032'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2008]     = ''90018'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2008]     = ''90006'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2008]     = ''90006'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2008]     = ''90006'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2008]  = ''90010'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2008]  = ''90010'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2008]  = ''90008'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2008]   = ''90018'' AND [tilv] = ''2010'' THEN ''''
        when [ammopisktunn_2008] = ''90018'' AND [tilv] = ''2012'' THEN ''''
      ELSE [ammopisktunn_2008]    END) AS ammopisktunn2008
      ,[ammopiskjarj_2008] as ammopiskjarj2008
      ,(CASE WHEN [ammopiskmaak_2008] = ''99'' THEN '''' ELSE [ammopiskmaak_2008] END) AS ammopiskmaak2008
      ,[amkopiskkoulk_2008] as amkopiskkoulk2008
      ,(CASE WHEN [amkopisktunn_2008] = ''BBBBB'' THEN ''''
       WHEN [amkopisktunn_2008] = ''99999'' THEN '''' ELSE [amkopisktunn_2008] END) AS amkopisktunn2008
      ,[amkopiskjarj_2008] as amkopiskjarj2008
      ,(CASE WHEN [amkopiskmaak_2008] = ''99'' THEN '''' ELSE [amkopiskmaak_2008] END) AS amkopiskmaak2008
      ,[yoopiskkoulk_2008] as yoopiskkoulk2008
     ,(CASE WHEN [yoopisktunn_2008] = ''BBBBB'' THEN ''''
      WHEN [yoopisktunn_2008] = ''99999'' THEN '''' ELSE [yoopisktunn_2008] END) AS yoopisktunn2008
      ,[yoopiskjarj_2008] as yoopiskjarj2008
      ,(CASE WHEN [yoopiskmaak_2008] = ''99'' THEN '''' ELSE [yoopiskmaak_2008] END) AS yoopiskmaak2008
      ,[monihaku_2008] as monihaku2008
      ,[ptoim1r4_2008]
      ,[amas_2008]
       ,[luopiskkoulk_2009] as luopiskkoulk2009
      ,(CASE WHEN [luopisktunn_2009] = ''BBBBB'' THEN ''''
      WHEN [luopisktunn_2009] = ''99999'' THEN '''' ELSE [luopisktunn_2009] END) AS luopisktunn2009
      ,[luopiskjarj_2009] as luopiskjarj2009
      ,(CASE WHEN [luopiskmaak_2009] = ''99'' THEN '''' ELSE [luopiskmaak_2009] END) AS luopiskmaak2009
      
      ,[ammopiskkoulk_2009] as ammopiskkoulk2009
     ,(CASE WHEN [ammopisktunn_2009]   = ''BBBBB'' THEN ''''
      WHEN [ammopisktunn_2009]    = ''99999'' THEN ''''
      WHEN [ammopisktunn_2009]    = ''00000'' THEN ''''
      when [ammopisktunn_2009]     = ''90009'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2009]     = ''90015'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2009]     = ''90010'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2009]    = ''90018'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2009]    = ''90008'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2009]     = ''90032'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2009]     = ''90032'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2009]     = ''90018'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2009]     = ''90006'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2009]     = ''90006'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2009]     = ''90006'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2009]  = ''90010'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2009]  = ''90010'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2009]  = ''90008'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2009]   = ''90018'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2009]   = ''90018'' AND [tilv] = ''2011'' THEN ''''
        when [ammopisktunn_2009] = ''90018'' AND [tilv] = ''2012'' THEN ''''
      ELSE [ammopisktunn_2009]    END) AS ammopisktunn2009
      ,[ammopiskjarj_2009] as ammopiskjarj2009
      ,(CASE WHEN [ammopiskmaak_2009] = ''99'' THEN '''' ELSE [ammopiskmaak_2009] END) AS ammopiskmaak2009
      ,[amkopiskkoulk_2009] as amkopiskkoulk2009
      ,(CASE WHEN [amkopisktunn_2009] = ''BBBBB'' THEN ''''
       WHEN [amkopisktunn_2009] = ''99999'' THEN '''' ELSE [amkopisktunn_2009] END) AS amkopisktunn2009
      ,[amkopiskjarj_2009] as amkopiskjarj2009
      ,[amkopiskmaak_2009] as amkopiskmaak2009
      ,[yoopiskkoulk_2009] as yoopiskkoulk2009
      ,(CASE WHEN [yoopisktunn_2009] = ''BBBBB'' THEN ''''
      WHEN [yoopisktunn_2009] = ''99999'' THEN '''' ELSE [yoopisktunn_2009] END) AS yoopisktunn2009
      ,[yoopiskjarj_2009] as yoopiskjarj2009
      ,(CASE WHEN [yoopiskmaak_2009] = ''99'' THEN '''' ELSE [yoopiskmaak_2009] END) AS yoopiskmaak2009
      ,[monihaku_2009] as monihaku2009
      ,[ptoim1r4_2009]
      ,[amas_2009]
      ,[luopiskkoulk2010]=''''
      ,[luopisktunn2010] =''''
      ,[luopiskjarj2010]=''''
      ,[luopiskmaak2010] = ''''
      ,[ammopiskkoulk2010]=''''
      ,[ammopisktunn2010] = ''''
      ,[ammopiskjarj2010]=''''
      ,[ammopiskmaak2010]=''''
      ,[amkopiskkoulk2010]=''''
      ,[amkopisktunn2010] = ''''
      ,[amkopiskjarj2010]=''''
      ,[amkopiskmaak2010]=''''
      ,[yoopiskkoulk2010]=''''
      ,[yoopisktunn2010] = ''''
      ,[yoopiskjarj2010]=''''
      ,[yoopiskmaak2010] = ''''
      ,[monihaku2010]=''''
      ,[ptoim1r4_2010]=''''
      ,[amas_2010]=''''
      ,[luopiskkoulk2011]=''''
      ,[luopisktunn2011] = ''''
      ,[luopiskjarj2011]= ''''
      ,[luopiskmaak2011] =''''
      ,[ammopiskkoulk2011]=''''
      ,[ammopisktunn2011] =  ''''
      ,[ammopiskjarj2011]=''''
      , [ammopiskmaak2011]='''' 
      ,[amkopiskkoulk2011]=''''
      ,[amkopisktunn2011] = ''''
      ,[amkopiskjarj2011] = ''''
      ,[amkopiskmaak2011]=''''
      ,[yoopiskkoulk2011]=''''
      ,[yoopisktunn2011] = ''''
      ,[yoopiskjarj2011]=''''
      ,[yoopiskmaak2011] =''''
      ,[monihaku2011]=''''
      ,[ptoim1r4_2011]=''''
      ,[amas_2011]=''''
      ,[luopiskkoulk2012]=''''
      ,[luopisktunn2012] = ''''
      ,[luopiskjarj2012]= ''''
      ,[luopiskmaak2012] =''''
      ,[ammopiskkoulk2012]=''''
      ,[ammopisktunn2012] =  ''''
      ,[ammopiskjarj2012]=''''
      , [ammopiskmaak2012]='''' 
      ,[amkopiskkoulk2012]=''''
      ,[amkopisktunn2012] = ''''
      ,[amkopiskjarj2012] = ''''
      ,[amkopiskmaak2012]=''''
      ,[yoopiskkoulk2012]=''''
      ,[yoopisktunn2012] = ''''
      ,[yoopiskjarj2012]=''''
      ,[yoopiskmaak2012] =''''
      ,[monihaku2012]=''''
      ,[ptoim1r4_2012]=''''
      ,[amas_2012]=''''
	  ,[luopiskkoulk2013] = ''''
	  ,[luopisktunn2013] = '''' 
	  ,[luopiskjarj2013] = ''''
	  ,[luopiskmaak2013] = ''''
	  ,[ammopiskkoulk2013] = ''''
	  ,[ammopisktunn2013] = ''''
	  ,[ammopiskjarj2013] = ''''
	  ,[ammopiskmaak2013] = ''''
	  ,[amkopiskkoulk2013] = ''''
	  ,[amkopisktunn2013] = ''''
	  ,[amkopiskjarj2013]= ''''
      ,[amkopiskmaak2013]= ''''
	  ,[yoopiskkoulk2013]= ''''
	  ,[yoopisktunn2013]= ''''
	  ,[yoopiskjarj2013]= ''''
	  ,[yoopiskmaak2013]= ''''
	  ,[monihaku2013] = ''''
	  ,[ptoim1r4_2013]= ''''
	  ,[amas_2013]= ''''
	  ,[luopiskkoulk2014] = ''''
	  ,[luopisktunn2014] = '''' 
	  ,[luopiskjarj2014] = ''''
	  ,[luopiskmaak2014] = ''''
	  ,[ammopiskkoulk2014] = ''''
	  ,[ammopisktunn2014] = ''''
	  ,[ammopiskjarj2014] = ''''
	  ,[ammopiskmaak2014] = ''''
	  ,[amkopiskkoulk2014] = ''''
	  ,[amkopisktunn2014] = ''''
	  ,[amkopiskjarj2014]= ''''
      ,[amkopiskmaak2014]= ''''
	  ,[yoopiskkoulk2014]= ''''
	  ,[yoopisktunn2014]= ''''
	  ,[yoopiskjarj2014]= ''''
	  ,[yoopiskmaak2014]= ''''
	  ,[monihaku2014] = ''''
	  ,[ptoim1r4_2014]= ''''
	  ,[amas_2014]= ''''
	  ,[lkm]
	  ,[pohjkoul]
      ,[tietolahde]=''K3_13_sopv_11''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_K3_13_sopv_11]
UNION ALL
SELECT
       [tilv]
      ,CAST(tilv + ''0101'' AS date) AS tilv_date
      ,[tutkryh]
      ,[suorv]
      ,[suorlk]
      ,[sp]
      ,(CASE WHEN [syntv] = ''19XX'' THEN '''' ELSE [syntv] END) as syntv
      ,[aikielir1]
      ,(CASE WHEN [tutkaskun]=''427'' THEN ''''
 WHEN [tutkaskun]= ''946'' and (tilv= ''2009'' or tilv=''2010'') then ''945''
      WHEN [tutkaskun]= ''198'' THEN '''' 
      WHEN [tutkaskun]= ''168'' THEN ''''
	  WHEN [tutkaskun]= ''999'' THEN '''' ELSE [tutkaskun] END) as tutkaskun
      ,[kansalr1]
      ,[pohjmaa]
      ,[eumaa]
      ,[etamaa]
       ,(CASE  WHEN [tunn] = ''BBBBB'' THEN ''''
      WHEN [tunn] = ''99999'' THEN ''''
      WHEN [tunn] = ''00000'' THEN '''' 
      when [tunn] = ''90009'' AND [tilv] = ''2009'' THEN ''''
      when [tunn] = ''90015'' AND [tilv] = ''2009'' THEN ''''
      when [tunn] = ''90010'' AND [tilv] = ''2009'' THEN ''''
      when [tunn] = ''90018'' AND [tilv] = ''2009'' THEN ''''
      when [tunn] = ''90008'' AND [tilv] = ''2010'' THEN ''''
      when [tunn] = ''90032'' AND [tilv] = ''2010'' THEN ''''
      when [tunn] = ''90032'' AND [tilv] = ''2011'' THEN ''''
      when [tunn] = ''90018'' AND [tilv] = ''2011'' THEN ''''
      when [tunn] = ''90006'' AND [tilv] = ''2009'' THEN ''''
      when [tunn] = ''90006'' AND [tilv] = ''2010'' THEN ''''
      when [tunn] = ''90006'' AND [tilv] = ''2011'' THEN ''''
      when [tunn] = ''90010'' AND [tilv] = ''2010'' THEN ''''
      when [tunn] = ''90010'' AND [tilv] = ''2011'' THEN ''''
      when [tunn] = ''90008'' AND [tilv] = ''2011'' THEN ''''
      when [tunn] = ''90018'' AND [tilv] = ''2010'' THEN ''''
      when [tunn] = ''90018'' AND [tilv] = ''2011'' THEN ''''
        when [tunn] = ''90018'' AND [tilv] = ''2012'' THEN ''''
      ELSE [tunn] END) AS tunn
      ,[jarj]
      ,[kkielir1]
      ,[tutklaja]
      ,[tutktav]
      ,[aikoul]
      ,(CASE WHEN [tutkmaak] = ''99'' THEN '''' ELSE [tutkmaak] END) AS tutkmaak
      ,[luopiskkoulk2004]=''''
      ,[luopisktunn2004]=''''
      ,[luopiskjarj2004]=''''
      ,[luopiskmaak2004] =''''
      ,[ammopiskkoulk2004]=''''
      ,[ammopisktunn2004]=''''
      ,[ammopiskjarj2004]=''''
      ,[ammopiskmaak2004] =''''
      ,[amkopiskkoulk2004]=''''
      ,[amkopisktunn2004]=''''
      ,[amkopiskjarj2004]=''''
      ,[amkopiskmaak2004]=''''
      ,[yoopiskkoulk2004]=''''
      ,[yoopisktunn2004]=''''
      ,[yoopiskjarj2004]=''''
      ,[yoopiskmaak2004]=''''
      ,[monihaku2004]=''''
      ,[ptoim1r4_2004]=''''
      ,[amas_2004]=''''
       ,[luopiskkoulk_2005] as luopiskkoulk2005
      ,(CASE WHEN [luopisktunn_2005] = ''BBBBB'' THEN ''''
      WHEN [luopisktunn_2005] = ''99999'' THEN '''' ELSE [luopisktunn_2005] END) AS luopisktunn2005
      ,[luopiskjarj_2005] as luopiskjarj2005
      ,(CASE WHEN [luopiskmaak_2005] = ''99'' THEN '''' ELSE [luopiskmaak_2005] END) AS luopiskmaak2005
      ,[ammopiskkoulk_2005] as ammopiskkoulk2005
      ,(CASE WHEN [ammopisktunn_2005]  = ''BBBBB'' THEN ''''
      WHEN [ammopisktunn_2005]   = ''99999'' THEN ''''
      WHEN [ammopisktunn_2005]   = ''00000'' THEN ''''
      when [ammopisktunn_2005]    = ''90009'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2005]    = ''90015'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2005]    = ''90010'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2005]   = ''90018'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2005]   = ''90008'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2005]    = ''90032'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2005]    = ''90032'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2005]    = ''90018'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2005]    = ''90006'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2005]    = ''90006'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2005]    = ''90006'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2005]  = ''90010'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2005]  = ''90010'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2005]  = ''90008'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2005]   = ''90018'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2005]   = ''90018'' AND [tilv] = ''2011'' THEN ''''
        when [ammopisktunn_2005] = ''90018'' AND [tilv] = ''2012'' THEN ''''
      ELSE [ammopisktunn_2005]   END) AS ammopisktunn2005
      ,[ammopiskjarj_2005] as ammopiskjarj2005
       ,(CASE WHEN [ammopiskmaak_2005] = ''99'' THEN '''' ELSE [ammopiskmaak_2005] END) AS ammopiskmaak2005
      ,[amkopiskkoulk_2005] as amkopiskkoulk2005
       ,(CASE WHEN [amkopisktunn_2005] = ''BBBBB'' THEN ''''
      WHEN [amkopisktunn_2005] = ''99999'' THEN '''' ELSE [amkopisktunn_2005] END) AS amkopisktunn2005
      ,[amkopiskjarj_2005] as amkopiskjarj2005
      ,(CASE WHEN [amkopiskmaak_2005] = ''99'' THEN '''' ELSE [amkopiskmaak_2005] END) AS amkopiskmaak2005
      ,[yoopiskkoulk_2005] as yoopiskkoulk2005
      ,(CASE WHEN [yoopisktunn_2005] = ''BBBBB'' THEN ''''
      WHEN [yoopisktunn_2005] = ''99999'' THEN '''' ELSE [yoopisktunn_2005] END) AS yoopisktunn2005
      ,[yoopiskjarj_2005] as yoopiskjarj2005
      ,(CASE WHEN [yoopiskmaak_2005] = ''99'' THEN '''' ELSE [yoopiskmaak_2005] END) AS yoopiskmaak2005
      ,[monihaku_2005] as monihaku2005
      ,[ptoim1r4_2005]
      ,[amas_2005]

     ,[luopiskkoulk_2006] as luopiskkoulk2006
      ,(CASE WHEN [luopisktunn_2006] = ''BBBBB'' THEN ''''
      WHEN [luopisktunn_2006] = ''99999'' THEN '''' ELSE [luopisktunn_2006] END) AS luopisktunn2006
      ,[luopiskjarj_2006] as luopiskjarj2006
      ,(CASE WHEN [luopiskmaak_2006] = ''99'' THEN '''' ELSE [luopiskmaak_2006] END) AS luopiskmaak2006
      ,[ammopiskkoulk_2006] as ammopiskkoulk2006    
      ,(CASE WHEN [ammopisktunn_2006]  = ''BBBBB'' THEN ''''
      WHEN [ammopisktunn_2006]  = ''99999'' THEN ''''
      WHEN [ammopisktunn_2006]   = ''00000'' THEN ''''
      when [ammopisktunn_2006]    = ''90009'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2006]    = ''90015'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2006]    = ''90010'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2006]   = ''90018'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2006]   = ''90008'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2006]    = ''90032'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2006]    = ''90032'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2006]    = ''90018'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2006]    = ''90006'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2006]    = ''90006'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2006]    = ''90006'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2006]  = ''90010'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2006]  = ''90010'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2006]  = ''90008'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2006]   = ''90018'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2006]   = ''90018'' AND [tilv] = ''2011'' THEN ''''
        when [ammopisktunn_2006] = ''90018'' AND [tilv] = ''2012'' THEN ''''
      ELSE [ammopisktunn_2006]   END) AS ammopisktunn2006
	  ,[ammopiskjarj_2006] as ammopiskjarj2006
      ,(CASE WHEN [ammopiskmaak_2006] = ''99'' THEN '''' ELSE [ammopiskmaak_2006] END) AS ammopiskmaak2006
      ,[amkopiskkoulk_2006] as amkopiskkoulk2006
      ,(CASE WHEN [amkopisktunn_2006] = ''BBBBB'' THEN ''''
       WHEN [amkopisktunn_2006] = ''99999'' THEN '''' ELSE [amkopisktunn_2006] END) AS amkopisktunn2006
      ,[amkopiskjarj_2006] as amkopiskjarj2006
      ,[amkopiskmaak_2006] as amkopiskmaak2006
      ,[yoopiskkoulk_2006] as yoopiskkoulk2006
      ,(CASE WHEN [yoopisktunn_2006] = ''BBBBB'' THEN ''''
      WHEN [yoopisktunn_2006] = ''99999'' THEN '''' ELSE [yoopisktunn_2006] END) AS yoopisktunn2006
      ,[yoopiskjarj_2006] as yoopiskjarj2006
      ,(CASE WHEN [yoopiskmaak_2006] = ''99'' THEN '''' ELSE [yoopiskmaak_2006] END) AS yoopiskmaak2006
      ,[monihaku_2006] as monihaku2006
      ,[ptoim1r4_2006]
      ,[amas_2006]
      
       ,[luopiskkoulk_2007] as luopiskkoulk2007
       ,(CASE WHEN [luopisktunn_2007] = ''BBBBB'' THEN ''''
      WHEN [luopisktunn_2007]  = ''99999'' THEN '''' ELSE [luopisktunn_2007]  END) AS luopisktunn2007
      ,[luopiskjarj_2007] as luopiskjarj2007
      ,(CASE WHEN [luopiskmaak_2007] = ''99'' THEN '''' ELSE [luopiskmaak_2007] END) AS luopiskmaak2007
      ,[ammopiskkoulk_2007] as ammopiskkoulk2007
      ,(CASE WHEN [ammopisktunn_2007]  = ''BBBBB'' THEN ''''
      WHEN [ammopisktunn_2007]   = ''99999'' THEN ''''
      WHEN [ammopisktunn_2007]   = ''00000'' THEN ''''
      when [ammopisktunn_2007]    = ''90009'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2007]    = ''90015'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2007]    = ''90010'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2007]   = ''90018'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2007]   = ''90008'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2007]    = ''90032'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2007]    = ''90032'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2007]    = ''90018'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2007]    = ''90006'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2007]    = ''90006'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2007]    = ''90006'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2007]  = ''90010'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2007]  = ''90010'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2007]  = ''90008'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2007]   = ''90018'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2007]   = ''90018'' AND [tilv] = ''2011'' THEN ''''
        when [ammopisktunn_2007] = ''90018'' AND [tilv] = ''2012'' THEN ''''
      ELSE [ammopisktunn_2007]   END) AS ammopisktunn2007
      ,[ammopiskjarj_2007] as ammopiskjarj2007
      ,(CASE WHEN [ammopiskmaak_2007] = ''99'' THEN '''' ELSE [ammopiskmaak_2007] END) AS ammopiskmaak2007
      ,[amkopiskkoulk_2007] as amkopiskkoulk2007
     ,(CASE WHEN [amkopisktunn_2007] = ''BBBBB'' THEN ''''
       WHEN [amkopisktunn_2007] = ''99999'' THEN '''' ELSE [amkopisktunn_2007] END) AS amkopisktunn2007
      ,[amkopiskjarj_2007] as amkopiskjarj2007
      ,[amkopiskmaak_2007] as amkopiskmaak2007
      
      ,[yoopiskkoulk_2007] as yoopiskkoulk2007
     ,(CASE WHEN [yoopisktunn_2007] = ''BBBBB'' THEN ''''
      WHEN [yoopisktunn_2007] = ''99999'' THEN '''' ELSE [yoopisktunn_2007] END) AS yoopisktunn2007
      ,[yoopiskjarj_2007] as yoopiskjarj2007
      ,(CASE WHEN [yoopiskmaak_2007] = ''99'' THEN '''' ELSE [yoopiskmaak_2007] END) AS yoopiskmaak2007
      
      ,[monihaku_2007] as monihaku2007
      ,[ptoim1r4_2007]
      ,[amas_2007]
      
     ,[luopiskkoulk_2008] as luopiskkoulk2008
       ,(CASE WHEN [luopisktunn_2008] = ''BBBBB'' THEN ''''
      WHEN [luopisktunn_2008] = ''99999'' THEN '''' ELSE [luopisktunn_2008] END) AS luopisktunn2008
      ,[luopiskjarj_2008] as luopiskjarj2008
      ,(CASE WHEN [luopiskmaak_2008] = ''99'' THEN '''' ELSE [luopiskmaak_2008] END) AS luopiskmaak2008
      ,[ammopiskkoulk_2008] as ammopiskkoulk2008
      ,(CASE WHEN [ammopisktunn_2008]   = ''BBBBB'' THEN ''''
      WHEN [ammopisktunn_2008]    = ''99999'' THEN ''''
      WHEN [ammopisktunn_2008]    = ''00000'' THEN ''''
      when [ammopisktunn_2008]     = ''90009'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2008]     = ''90015'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2008]     = ''90010'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2008]    = ''90018'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2008]    = ''90008'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2008]     = ''90032'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2008]     = ''90032'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2008]     = ''90018'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2008]     = ''90006'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2008]     = ''90006'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2008]     = ''90006'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2008]  = ''90010'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2008]  = ''90010'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2008]  = ''90008'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2008]   = ''90018'' AND [tilv] = ''2010'' THEN ''''
        when [ammopisktunn_2008] = ''90018'' AND [tilv] = ''2012'' THEN ''''
      ELSE [ammopisktunn_2008]    END) AS ammopisktunn2008
      ,[ammopiskjarj_2008] as ammopiskjarj2008
      ,(CASE WHEN [ammopiskmaak_2008] = ''99'' THEN '''' ELSE [ammopiskmaak_2008] END) AS ammopiskmaak2008
      ,[amkopiskkoulk_2008] as amkopiskkoulk2008
      ,(CASE WHEN [amkopisktunn_2008] = ''BBBBB'' THEN ''''
       WHEN [amkopisktunn_2008] = ''99999'' THEN '''' ELSE [amkopisktunn_2008] END) AS amkopisktunn2008
      ,[amkopiskjarj_2008] as amkopiskjarj2008
      ,(CASE WHEN [amkopiskmaak_2008] = ''99'' THEN '''' ELSE [amkopiskmaak_2008] END) AS amkopiskmaak2008
      ,[yoopiskkoulk_2008] as yoopiskkoulk2008
     ,(CASE WHEN [yoopisktunn_2008] = ''BBBBB'' THEN ''''
      WHEN [yoopisktunn_2008] = ''99999'' THEN '''' ELSE [yoopisktunn_2008] END) AS yoopisktunn2008
      ,[yoopiskjarj_2008] as yoopiskjarj2008
      ,(CASE WHEN [yoopiskmaak_2008] = ''99'' THEN '''' ELSE [yoopiskmaak_2008] END) AS yoopiskmaak2008
      ,[monihaku_2008] as monihaku2008
      ,[ptoim1r4_2008]
      ,[amas_2008]

       ,[luopiskkoulk_2009] as luopiskkoulk2009
      ,(CASE WHEN [luopisktunn_2009] = ''BBBBB'' THEN ''''
      WHEN [luopisktunn_2009] = ''99999'' THEN '''' ELSE [luopisktunn_2009] END) AS luopisktunn2009
      ,[luopiskjarj_2009] as luopiskjarj2009
      ,(CASE WHEN [luopiskmaak_2009] = ''99'' THEN '''' ELSE [luopiskmaak_2009] END) AS luopiskmaak2009
      
      ,[ammopiskkoulk_2009] as ammopiskkoulk2009
     ,(CASE WHEN [ammopisktunn_2009]   = ''BBBBB'' THEN ''''
      WHEN [ammopisktunn_2009]    = ''99999'' THEN ''''
      WHEN [ammopisktunn_2009]    = ''00000'' THEN ''''
      when [ammopisktunn_2009]     = ''90009'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2009]     = ''90015'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2009]     = ''90010'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2009]    = ''90018'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2009]    = ''90008'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2009]     = ''90032'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2009]     = ''90032'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2009]     = ''90018'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2009]     = ''90006'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2009]     = ''90006'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2009]     = ''90006'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2009]  = ''90010'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2009]  = ''90010'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2009]  = ''90008'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2009]   = ''90018'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2009]   = ''90018'' AND [tilv] = ''2011'' THEN ''''
        when [ammopisktunn_2009] = ''90018'' AND [tilv] = ''2012'' THEN ''''
      ELSE [ammopisktunn_2009]    END) AS ammopisktunn2009
      ,[ammopiskjarj_2009] as ammopiskjarj2009
      ,(CASE WHEN [ammopiskmaak_2009] = ''99'' THEN '''' ELSE [ammopiskmaak_2009] END) AS ammopiskmaak2009
      ,[amkopiskkoulk_2009] as amkopiskkoulk2009
      ,(CASE WHEN [amkopisktunn_2009] = ''BBBBB'' THEN ''''
       WHEN [amkopisktunn_2009] = ''99999'' THEN '''' ELSE [amkopisktunn_2009] END) AS amkopisktunn2009
      ,[amkopiskjarj_2009] as amkopiskjarj2009
      ,[amkopiskmaak_2009] as amkopiskmaak2009
      ,[yoopiskkoulk_2009] as yoopiskkoulk2009
      ,(CASE WHEN [yoopisktunn_2009] = ''BBBBB'' THEN ''''
      WHEN [yoopisktunn_2009] = ''99999'' THEN '''' ELSE [yoopisktunn_2009] END) AS yoopisktunn2009
      ,[yoopiskjarj_2009] as yoopiskjarj2009
      ,(CASE WHEN [yoopiskmaak_2009] = ''99'' THEN '''' ELSE [yoopiskmaak_2009] END) AS yoopiskmaak2009
      ,[monihaku_2009] as monihaku2009
      ,[ptoim1r4_2009]
      ,[amas_2009]
      
      ,[luopiskkoulk_2010] as luopiskkoulk2010
      ,(CASE WHEN [luopisktunn_2010] = ''BBBBB'' THEN ''''
      WHEN [luopisktunn_2010] = ''99999'' THEN '''' ELSE [luopisktunn_2010] END) AS luopisktunn2010
      ,[luopiskjarj_2010]
      ,(CASE WHEN [luopiskmaak_2010] = ''99'' THEN '''' ELSE [luopiskmaak_2010] END) AS luopiskmaak2010
      
      ,[ammopiskkoulk_2010] as ammopiskkoulk2010
      ,(CASE WHEN [ammopisktunn_2010]   = ''BBBBB'' THEN ''''
      WHEN [ammopisktunn_2010]    = ''99999'' THEN ''''
      WHEN [ammopisktunn_2010]    = ''00000'' THEN ''''
      when [ammopisktunn_2010]     = ''90009'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2010]     = ''90015'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2010]     = ''90010'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2010]    = ''90018'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2010]    = ''90008'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2010]     = ''90032'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2010]     = ''90032'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2010]     = ''90018'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2010]     = ''90006'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2010]     = ''90006'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2010]     = ''90006'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2010]  = ''90010'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2010]  = ''90010'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2010]  = ''90008'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2010]   = ''90018'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2010]   = ''90018'' AND [tilv] = ''2011'' THEN ''''
        when [ammopisktunn_2010] = ''90018'' AND [tilv] = ''2012'' THEN ''''
      ELSE [ammopisktunn_2010]    END) AS ammopisktunn2010
      ,[ammopiskjarj_2010] as ammopiskjarj2010
      ,(CASE WHEN [ammopiskmaak_2010] = ''99'' THEN '''' ELSE [ammopiskmaak_2010] END) AS ammopiskmaak2010
      
      ,[amkopiskkoulk_2010] as amkopiskkoulk2010
      ,(CASE WHEN [amkopisktunn_2010] = ''BBBBB'' THEN ''''
       WHEN [amkopisktunn_2010] = ''99999'' THEN '''' ELSE [amkopisktunn_2010] END) AS amkopisktunn2010
      ,[amkopiskjarj_2010] as amkopiskjarj2010
      ,[amkopiskmaak_2010] as amkopiskmaak2010
      
      ,[yoopiskkoulk_2010] as yoopiskkoulk2010
      ,(CASE WHEN [yoopisktunn_2010] = ''BBBBB'' THEN ''''
      WHEN [yoopisktunn_2010] = ''99999'' THEN '''' ELSE [yoopisktunn_2010] END) AS yoopisktunn2010
      ,[yoopiskjarj_2010] as yoopiskjarj2010
      ,(CASE WHEN [yoopiskmaak_2010] = ''99'' THEN '''' ELSE [yoopiskmaak_2010] END) AS yoopiskmaak2010
      ,[monihaku_2010] as monihaku2010
      ,[ptoim1r4_2010]
      ,[amas_2010]
      ,[luopiskkoulk2011]=''''
      ,[luopisktunn2011] = ''''
      ,[luopiskjarj2011]= ''''
      ,[luopiskmaak2011] =''''
      ,[ammopiskkoulk2011]=''''
      ,[ammopisktunn2011] =  ''''
      ,[ammopiskjarj2011]=''''
      , [ammopiskmaak2011]='''' 
      ,[amkopiskkoulk2011]=''''
      ,[amkopisktunn2011] = ''''
      ,[amkopiskjarj2011] = ''''
      ,[amkopiskmaak2011]=''''
      ,[yoopiskkoulk2011]=''''
      ,[yoopisktunn2011] = ''''
      ,[yoopiskjarj2011]=''''
      ,[yoopiskmaak2011] =''''
      ,[monihaku2011]=''''
      ,[ptoim1r4_2011]=''''
      ,[amas_2011]=''''
      ,[luopiskkoulk2012]=''''
      ,[luopisktunn2012] = ''''
      ,[luopiskjarj2012]= ''''
      ,[luopiskmaak2012] =''''
      ,[ammopiskkoulk2012]=''''
      ,[ammopisktunn2012] =  ''''
      ,[ammopiskjarj2012]=''''
      , [ammopiskmaak2012]='''' 
      ,[amkopiskkoulk2012]=''''
      ,[amkopisktunn2012] = ''''
      ,[amkopiskjarj2012] = ''''
      ,[amkopiskmaak2012]=''''
      ,[yoopiskkoulk2012]=''''
      ,[yoopisktunn2012] = ''''
      ,[yoopiskjarj2012]=''''
      ,[yoopiskmaak2012] =''''
      ,[monihaku2012]=''''
      ,[ptoim1r4_2012]=''''
      ,[amas_2012]=''''
      ,[luopiskkoulk2013] = ''''
	  ,[luopisktunn2013] = '''' 
	  ,[luopiskjarj2013] = ''''
	  ,[luopiskmaak2013] = ''''
	  ,[ammopiskkoulk2013] = ''''
	  ,[ammopisktunn2013] = ''''
	  ,[ammopiskjarj2013] = ''''
	  ,[ammopiskmaak2013] = ''''
	  ,[amkopiskkoulk2013] = ''''
	  ,[amkopisktunn2013] = ''''
	  ,[amkopiskjarj2013]= ''''
      ,[amkopiskmaak2013]= ''''
	  ,[yoopiskkoulk2013]= ''''
	  ,[yoopisktunn2013]= ''''
	  ,[yoopiskjarj2013]= ''''
	  ,[yoopiskmaak2013]= ''''
	  ,[monihaku2013] = ''''
	  ,[ptoim1r4_2013]= ''''
	  ,[amas_2013]= ''''
	  ,[luopiskkoulk2014] = ''''
	  ,[luopisktunn2014] = '''' 
	  ,[luopiskjarj2014] = ''''
	  ,[luopiskmaak2014] = ''''
	  ,[ammopiskkoulk2014] = ''''
	  ,[ammopisktunn2014] = ''''
	  ,[ammopiskjarj2014] = ''''
	  ,[ammopiskmaak2014] = ''''
	  ,[amkopiskkoulk2014] = ''''
	  ,[amkopisktunn2014] = ''''
	  ,[amkopiskjarj2014]= ''''
      ,[amkopiskmaak2014]= ''''
	  ,[yoopiskkoulk2014]= ''''
	  ,[yoopisktunn2014]= ''''
	  ,[yoopiskjarj2014]= ''''
	  ,[yoopiskmaak2014]= ''''
	  ,[monihaku2014] = ''''
	  ,[ptoim1r4_2014]= ''''
	  ,[amas_2014]= ''''
	  ,[lkm]
	  ,[pohjkoul] 
      ,[tietolahde]=''K3_13_sopv_12''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_K3_13_sopv_12]
  UNION ALL
   SELECT
       [tilv]
      ,CAST(tilv + ''0101'' AS date) AS tilv_date
      ,[tutkryh]
      ,[suorv]
      ,[suorlk]
      ,[sp]
      ,(CASE WHEN [syntv] = ''19XX'' THEN '''' ELSE [syntv] END) as syntv
      ,[aikielir1]
      ,(CASE WHEN [tutkaskun]=''427'' THEN ''''
 WHEN [tutkaskun]= ''946'' and (tilv= ''2009'' or tilv=''2010'') then ''945''
      WHEN [tutkaskun]= ''198'' THEN '''' 
      WHEN [tutkaskun]= ''168'' THEN ''''
	  WHEN [tutkaskun]= ''999'' THEN '''' ELSE [tutkaskun] END) as tutkaskun
      ,[kansalr1]
      ,[pohjmaa]
      ,[eumaa]
      ,[etamaa]
       ,(CASE  WHEN [tunn] = ''BBBBB'' THEN ''''
      WHEN [tunn] = ''99999'' THEN ''''
      WHEN [tunn] = ''00000'' THEN '''' 
      when [tunn] = ''90009'' AND [tilv] = ''2009'' THEN ''''
      when [tunn] = ''90015'' AND [tilv] = ''2009'' THEN ''''
      when [tunn] = ''90010'' AND [tilv] = ''2009'' THEN ''''
      when [tunn] = ''90018'' AND [tilv] = ''2009'' THEN ''''
      when [tunn] = ''90008'' AND [tilv] = ''2010'' THEN ''''
      when [tunn] = ''90032'' AND [tilv] = ''2010'' THEN ''''
      when [tunn] = ''90032'' AND [tilv] = ''2011'' THEN ''''
      when [tunn] = ''90018'' AND [tilv] = ''2011'' THEN ''''
      when [tunn] = ''90006'' AND [tilv] = ''2009'' THEN ''''
      when [tunn] = ''90006'' AND [tilv] = ''2010'' THEN ''''
      when [tunn] = ''90006'' AND [tilv] = ''2011'' THEN ''''
      when [tunn] = ''90010'' AND [tilv] = ''2010'' THEN ''''
      when [tunn] = ''90010'' AND [tilv] = ''2011'' THEN ''''
      when [tunn] = ''90008'' AND [tilv] = ''2011'' THEN ''''
      when [tunn] = ''90018'' AND [tilv] = ''2010'' THEN ''''
      when [tunn] = ''90018'' AND [tilv] = ''2011'' THEN ''''
        when [tunn] = ''90018'' AND [tilv] = ''2012'' THEN ''''
      ELSE [tunn] END) AS tunn
      ,[jarj]
      ,[kkielir1]
      ,[tutklaja]
      ,[tutktav]
      ,[aikoul]
      ,(CASE WHEN [tutkmaak] = ''99'' THEN '''' ELSE [tutkmaak] END) AS tutkmaak
       ,[luopiskkoulk2004]=''''
      ,[luopisktunn2004]=''''
      ,[luopiskjarj2004]=''''
      ,[luopiskmaak2004] =''''
      ,[ammopiskkoulk2004]=''''
      ,[ammopisktunn2004]=''''
      ,[ammopiskjarj2004]=''''
      ,[ammopiskmaak2004] =''''
      ,[amkopiskkoulk2004]=''''
      ,[amkopisktunn2004]=''''
      ,[amkopiskjarj2004]=''''
      ,[amkopiskmaak2004]=''''
      ,[yoopiskkoulk2004]=''''
      ,[yoopisktunn2004]=''''
      ,[yoopiskjarj2004]=''''
      ,[yoopiskmaak2004]=''''
      ,[monihaku2004]=''''
      ,[ptoim1r4_2004]=''''
      ,[amas_2004]=''''
      ,[luopiskkoulk2005]=''''
      ,[luopisktunn2005]=''''
      ,[luopiskjarj2005]=''''
      ,[luopiskmaak2005]=''''
      ,[ammopiskkoulk2005]=''''
      ,[ammopisktunn2005]=''''
      ,[ammopiskjarj2005]=''''
      ,[ammopiskmaak2005]=''''
      ,[amkopiskkoulk2005]=''''
      ,[amkopisktunn2005]=''''
      ,[amkopiskjarj2005]=''''
      ,[amkopiskmaak2005]=''''
      ,[yoopiskkoulk2005]=''''
      ,[yoopisktunn2005]=''''
      ,[yoopiskjarj2005]=''''
      , [yoopiskmaak2005] =''''
      ,[monihaku2005]=''''
      ,[ptoim1r4_2005]=''''
      ,[amas_2005]=''''
      
      ,[luopiskkoulk_2006] as luopiskkoulk2006
      ,(CASE WHEN [luopisktunn_2006] = ''BBBBB'' THEN ''''
      WHEN [luopisktunn_2006] = ''99999'' THEN '''' ELSE [luopisktunn_2006] END) AS luopisktunn2006

      ,[luopiskjarj_2006] as luopiskjarj2006
      ,(CASE WHEN [luopiskmaak_2006] = ''99'' THEN '''' ELSE [luopiskmaak_2006] END) AS luopiskmaak2006
      ,[ammopiskkoulk_2006] as ammopiskkoulk2006    
      ,(CASE WHEN [ammopisktunn_2006]  = ''BBBBB'' THEN ''''
      WHEN [ammopisktunn_2006]  = ''99999'' THEN ''''
      WHEN [ammopisktunn_2006]   = ''00000'' THEN ''''
      when [ammopisktunn_2006]    = ''90009'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2006]    = ''90015'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2006]    = ''90010'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2006]   = ''90018'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2006]   = ''90008'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2006]    = ''90032'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2006]    = ''90032'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2006]    = ''90018'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2006]    = ''90006'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2006]    = ''90006'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2006]    = ''90006'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2006]  = ''90010'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2006]  = ''90010'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2006]  = ''90008'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2006]   = ''90018'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2006]   = ''90018'' AND [tilv] = ''2011'' THEN ''''
        when [ammopisktunn_2006] = ''90018'' AND [tilv] = ''2012'' THEN ''''
      ELSE [ammopisktunn_2006]   END) AS ammopisktunn2006
	  ,[ammopiskjarj_2006] as ammopiskjarj2006
      ,(CASE WHEN [ammopiskmaak_2006] = ''99'' THEN '''' ELSE [ammopiskmaak_2006] END) AS ammopiskmaak2006
      ,[amkopiskkoulk_2006] as amkopiskkoulk2006
      ,(CASE WHEN [amkopisktunn_2006] = ''BBBBB'' THEN ''''
       WHEN [amkopisktunn_2006] = ''99999'' THEN '''' ELSE [amkopisktunn_2006] END) AS amkopisktunn2006
      ,[amkopiskjarj_2006] as amkopiskjarj2006
      ,[amkopiskmaak_2006] as amkopiskmaak2006
      ,[yoopiskkoulk_2006] as yoopiskkoulk2006
      ,(CASE WHEN [yoopisktunn_2006] = ''BBBBB'' THEN ''''
      WHEN [yoopisktunn_2006] = ''99999'' THEN '''' ELSE [yoopisktunn_2006] END) AS yoopisktunn2006
      ,[yoopiskjarj_2006] as yoopiskjarj2006
      ,(CASE WHEN [yoopiskmaak_2006] = ''99'' THEN '''' ELSE [yoopiskmaak_2006] END) AS yoopiskmaak2006
      ,[monihaku_2006] as monihaku2006
      ,[ptoim1r4_2006]
      ,[amas_2006]
      
	  ,[luopiskkoulk_2007] as luopiskkoulk2007
      ,(CASE WHEN [luopisktunn_2007] = ''BBBBB'' THEN ''''
      WHEN [luopisktunn_2007] = ''99999'' THEN '''' ELSE [luopisktunn_2007] END) AS luopisktunn2007
      ,[luopiskjarj_2007] as luopiskjarj2007
      ,(CASE WHEN [luopiskmaak_2007] = ''99'' THEN '''' ELSE [luopiskmaak_2007] END) AS luopiskmaak2007
      
      ,[ammopiskkoulk_2007] as ammopiskkoulk2007
      ,(CASE WHEN [ammopisktunn_2007]  = ''BBBBB'' THEN ''''
      WHEN [ammopisktunn_2007]   = ''99999'' THEN ''''
      WHEN [ammopisktunn_2007]   = ''00000'' THEN ''''
      when [ammopisktunn_2007]    = ''90009'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2007]    = ''90015'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2007]    = ''90010'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2007]   = ''90018'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2007]   = ''90008'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2007]    = ''90032'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2007]    = ''90032'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2007]    = ''90018'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2007]    = ''90006'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2007]    = ''90006'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2007]    = ''90006'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2007]  = ''90010'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2007]  = ''90010'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2007]  = ''90008'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2007]   = ''90018'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2007]   = ''90018'' AND [tilv] = ''2011'' THEN ''''
        when [ammopisktunn_2007] = ''90018'' AND [tilv] = ''2012'' THEN ''''
      ELSE [ammopisktunn_2007]   END) AS ammopisktunn2007
      ,[ammopiskjarj_2007] as ammopiskjarj2007
      ,(CASE WHEN [ammopiskmaak_2007] = ''99'' THEN '''' ELSE [ammopiskmaak_2007] END) AS ammopiskmaak2007
      
      ,[amkopiskkoulk_2007] as amkopiskkoulk2007
     ,(CASE WHEN [amkopisktunn_2007] = ''BBBBB'' THEN ''''
       WHEN [amkopisktunn_2007] = ''99999'' THEN '''' ELSE [amkopisktunn_2007] END) AS amkopisktunn2007
      ,[amkopiskjarj_2007] as amkopiskjarj2007
      ,[amkopiskmaak_2007] as amkopiskmaak2007
      
      ,[yoopiskkoulk_2007] as yoopiskkoulk2007
     ,(CASE WHEN [yoopisktunn_2007] = ''BBBBB'' THEN ''''
      WHEN [yoopisktunn_2007] = ''99999'' THEN '''' ELSE [yoopisktunn_2007] END) AS yoopisktunn2007
      ,[yoopiskjarj_2007] as yoopiskjarj2007
      ,(CASE WHEN [yoopiskmaak_2007] = ''99'' THEN '''' ELSE [yoopiskmaak_2007] END) AS yoopiskmaak2007
      
      ,[monihaku_2007] as monihaku2007
      ,[ptoim1r4_2007]
      ,[amas_2007]

	  ,[luopiskkoulk_2008] as luopiskkoulk2008
       ,(CASE WHEN [luopisktunn_2008] = ''BBBBB'' THEN ''''
      WHEN [luopisktunn_2008] = ''99999'' THEN '''' ELSE [luopisktunn_2008] END) AS luopisktunn2008
      ,[luopiskjarj_2008]as luopiskjarj2008
      ,(CASE WHEN [luopiskmaak_2008] = ''99'' THEN '''' ELSE [luopiskmaak_2008] END) AS luopiskmaak2008
      
      ,[ammopiskkoulk_2008] as ammopiskkoulk2008
       ,(CASE WHEN [ammopisktunn_2008]   = ''BBBBB'' THEN ''''
      WHEN [ammopisktunn_2008]    = ''99999'' THEN ''''
      WHEN [ammopisktunn_2008]    = ''00000'' THEN ''''
      when [ammopisktunn_2008]     = ''90009'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2008]     = ''90015'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2008]     = ''90010'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2008]    = ''90018'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2008]    = ''90008'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2008]     = ''90032'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2008]     = ''90032'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2008]     = ''90018'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2008]     = ''90006'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2008]     = ''90006'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2008]     = ''90006'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2008]  = ''90010'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2008]  = ''90010'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2008]  = ''90008'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2008]   = ''90018'' AND [tilv] = ''2010'' THEN ''''
        when [ammopisktunn_2008] = ''90018'' AND [tilv] = ''2012'' THEN ''''
      ELSE [ammopisktunn_2008]    END) AS ammopisktunn2008
      ,[ammopiskjarj_2008] as ammopiskjarj2008
      ,(CASE WHEN [ammopiskmaak_2008] = ''99'' THEN '''' ELSE [ammopiskmaak_2008] END) AS ammopiskmaak2008
      
      ,[amkopiskkoulk_2008] as amkopiskkoulk2008
      ,(CASE WHEN [amkopisktunn_2008]  = ''BBBBB'' THEN ''''
      WHEN [amkopisktunn_2008] = ''99999'' THEN '''' ELSE [amkopisktunn_2008] END) AS yoopisktunn2008
      ,[amkopiskjarj_2008] as amkopiskjarj2008
      ,(CASE WHEN [amkopiskmaak_2008] = ''99'' THEN '''' ELSE [amkopiskmaak_2008] END) AS amkopiskmaak2008
      
      ,[yoopiskkoulk_2008] as yoopiskkoulk2008
     ,(CASE WHEN [yoopisktunn_2008] = ''BBBBB'' THEN ''''
      WHEN [yoopisktunn_2008] = ''99999'' THEN '''' ELSE [yoopisktunn_2008] END) AS yoopisktunn2008
      ,[yoopiskjarj_2008] as yoopiskjarj2008
      ,(CASE WHEN [yoopiskmaak_2008] = ''99'' THEN '''' ELSE [yoopiskmaak_2008] END) AS yoopiskmaak2008
      ,[monihaku_2008] as monihaku2008
      ,[ptoim1r4_2008]
      ,[amas_2008]

	  ,[luopiskkoulk_2009] as luopiskkoulk2009
      ,(CASE WHEN [luopisktunn_2009] = ''BBBBB'' THEN ''''
      WHEN [luopisktunn_2009] = ''99999'' THEN '''' ELSE [luopisktunn_2009] END) AS luopisktunn2009
      ,[luopiskjarj_2009] as luopiskjarj2009
      ,(CASE WHEN [luopiskmaak_2009] = ''99'' THEN '''' ELSE [luopiskmaak_2009] END) AS luopiskmaak2009
      
      ,[ammopiskkoulk_2009]
       ,(CASE WHEN [ammopisktunn_2009]   = ''BBBBB'' THEN ''''
      WHEN [ammopisktunn_2009]    = ''99999'' THEN ''''
      WHEN [ammopisktunn_2009]    = ''00000'' THEN ''''
      when [ammopisktunn_2009]     = ''90009'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2009]     = ''90015'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2009]     = ''90010'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2009]    = ''90018'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2009]    = ''90008'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2009]     = ''90032'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2009]     = ''90032'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2009]     = ''90018'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2009]     = ''90006'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2009]     = ''90006'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2009]     = ''90006'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2009]  = ''90010'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2009]  = ''90010'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2009]  = ''90008'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2009]    = ''90018'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2009]   = ''90018'' AND [tilv] = ''2011'' THEN ''''
        when [ammopisktunn_2009] = ''90018'' AND [tilv] = ''2012'' THEN ''''
      ELSE [ammopisktunn_2009]    END) AS ammopisktunn2009
      ,[ammopiskjarj_2009] as ammopiskjarj2009
      ,(CASE WHEN [ammopiskmaak_2009] = ''99'' THEN '''' ELSE [ammopiskmaak_2009] END) AS ammopiskmaak2009
      
      ,[amkopiskkoulk_2009] as amkopiskkoulk2009
      ,(CASE WHEN [amkopisktunn_2009] = ''BBBBB'' THEN ''''
       WHEN [amkopisktunn_2009] = ''99999'' THEN '''' ELSE [amkopisktunn_2009] END) AS amkopisktunn2009
      ,[amkopiskjarj_2009] as amkopiskjarj2009
      ,[amkopiskmaak_2009] as amkopiskmaak2009
      
      ,[yoopiskkoulk_2009] as yoopiskkoulk2009
      ,(CASE WHEN [yoopisktunn_2009] = ''BBBBB'' THEN ''''
      WHEN [yoopisktunn_2009] = ''99999'' THEN '''' ELSE [yoopisktunn_2009] END) AS yoopisktunn2009
      ,[yoopiskjarj_2009] as yoopiskjarj2009
      ,(CASE WHEN [yoopiskmaak_2009] = ''99'' THEN '''' ELSE [yoopiskmaak_2009] END) AS yoopiskmaak2009
      
      ,[monihaku_2009] as monihaku2009
      ,[ptoim1r4_2009]
      ,[amas_2009]



      ,[luopiskkoulk_2010] as luopiskkoulk2010
      ,(CASE WHEN [luopisktunn_2010] = ''BBBBB'' THEN ''''
      WHEN [luopisktunn_2010] = ''99999'' THEN '''' ELSE [luopisktunn_2010] END) AS luopisktunn2010
      ,[luopiskjarj_2010]
      ,(CASE WHEN [luopiskmaak_2010] = ''99'' THEN '''' ELSE [luopiskmaak_2010] END) AS luopiskmaak2010
      
      ,[ammopiskkoulk_2010] as ammopiskkoulk2010
      ,(CASE WHEN [ammopisktunn_2010]   = ''BBBBB'' THEN ''''
      WHEN [ammopisktunn_2010]    = ''99999'' THEN ''''
      WHEN [ammopisktunn_2010]    = ''00000'' THEN ''''
      when [ammopisktunn_2010]     = ''90009'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2010]     = ''90015'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2010]     = ''90010'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2010]    = ''90018'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2010]    = ''90008'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2010]     = ''90032'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2010]     = ''90032'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2010]     = ''90018'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2010]     = ''90006'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2010]     = ''90006'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2010]     = ''90006'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2010]  = ''90010'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2010]  = ''90010'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2010]  = ''90008'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2010]   = ''90018'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2010]   = ''90018'' AND [tilv] = ''2011'' THEN ''''
        when [ammopisktunn_2010] = ''90018'' AND [tilv] = ''2012'' THEN ''''
      ELSE [ammopisktunn_2010]    END) AS ammopisktunn2010
      ,[ammopiskjarj_2010] as ammopiskjarj2010
      ,(CASE WHEN [ammopiskmaak_2010] = ''99'' THEN '''' ELSE [ammopiskmaak_2010] END) AS ammopiskmaak2010
      
      ,[amkopiskkoulk_2010] as amkopiskkoulk2010
      ,(CASE WHEN [amkopisktunn_2010] = ''BBBBB'' THEN ''''
       WHEN [amkopisktunn_2010] = ''99999'' THEN '''' ELSE [amkopisktunn_2010] END) AS amkopisktunn2010
      ,[amkopiskjarj_2010] as amkopiskjarj2010
      ,[amkopiskmaak_2010] as amkopiskmaak2010
      
      ,[yoopiskkoulk_2010] as yoopiskkoulk2010
      ,(CASE WHEN [yoopisktunn_2010] = ''BBBBB'' THEN ''''
      WHEN [yoopisktunn_2010] = ''99999'' THEN '''' ELSE [yoopisktunn_2010] END) AS yoopisktunn2010
      ,[yoopiskjarj_2010] as yoopiskjarj2010
      ,(CASE WHEN [yoopiskmaak_2010] = ''99'' THEN '''' ELSE [yoopiskmaak_2010] END) AS yoopiskmaak2010
      ,[monihaku_2010] as monihaku2010
      ,[ptoim1r4_2010] 
      ,[amas_2010]
      
     ,[luopiskkoulk_2011] as luopiskkoulk2011
      ,(CASE WHEN [luopisktunn_2011] = ''BBBBB'' THEN ''''
      WHEN [luopisktunn_2011] = ''99999'' THEN '''' ELSE [luopisktunn_2011] END) AS luopisktunn2011
      ,[luopiskjarj_2011] as luopiskjarj2011
      ,(CASE WHEN [luopiskmaak_2011] = ''99'' THEN '''' ELSE [luopiskmaak_2011] END) AS luopiskmaak2011
      
      ,[ammopiskkoulk_2011] as ammopiskkoulk2011
      ,(CASE WHEN [ammopisktunn_2011]   = ''BBBBB'' THEN '''' 
      WHEN [ammopisktunn_2011]    = ''99999'' THEN '''' 
      WHEN [ammopisktunn_2011]    = ''00000'' THEN '''' 
      when [ammopisktunn_2011]     = ''90009'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2011]     = ''90015'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2011]     = ''90010'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2011]    = ''90018'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2011]    = ''90008'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2011]     = ''90032'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2011]     = ''90032'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2011]     = ''90018'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2011]     = ''90006'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2011]     = ''90006'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2011]     = ''90006'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2011]  = ''90010'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2011]  = ''90010'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2011]  = ''90008'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2011]   = ''90018'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2011]   = ''90018'' AND [tilv] = ''2011'' THEN ''''
        when [ammopisktunn_2011] = ''90018'' AND [tilv] = ''2012'' THEN ''''
      ELSE [ammopisktunn_2011]    END) AS ammopisktunn2011 
      ,[ammopiskjarj_2011] as ammopiskjarj2011
      ,(CASE WHEN [ammopiskmaak_2011] = ''99'' THEN '''' ELSE [ammopiskmaak_2011] END) AS ammopiskmaak2011
      
      ,[amkopiskkoulk_2011] as amkopiskkoulk2011
      ,(CASE WHEN [amkopisktunn_2011] = ''BBBBB'' THEN ''''
       WHEN [amkopisktunn_2011] = ''99999'' THEN '''' ELSE [amkopisktunn_2011] END) AS amkopisktunn2011
      ,[amkopiskjarj_2011] as amkopiskjarj2011
      ,(CASE WHEN [amkopiskmaak_2011] = ''99'' THEN '''' ELSE [amkopiskmaak_2011] END) AS amkopiskmaak2011
      
      ,[yoopiskkoulk_2011] as yoopiskkoulk2011
      ,(CASE WHEN [yoopisktunn_2011] = ''BBBBB'' THEN ''''
      WHEN [yoopisktunn_2011] = ''99999'' THEN '''' ELSE [yoopisktunn_2011] END) AS yoopisktunn2011
      ,[yoopiskjarj_2011] as yoopiskjarj2011
      ,(CASE WHEN [yoopiskmaak_2011] = ''99'' THEN '''' ELSE [yoopiskmaak_2011] END) AS yoopiskmaak2011
      ,[monihaku_2011] as monihaku2011
      ,[ptoim1r4_2011]
      ,[amas_2011]
      ,[luopiskkoulk2012]=''''
      ,[luopisktunn2012]=''''
      ,[luopiskjarj2012]=''''
      ,[luopiskmaak2012]=''''
      ,[ammopiskkoulk2012]=''''
      ,[ammopisktunn2012]=''''
      ,[ammopiskjarj2012]=''''
      ,[ammopiskmaak2012]=''''
      ,[amkopiskkoulk2012]=''''
      ,[amkopisktunn2012]=''''
      ,[amkopiskjarj2012]=''''
      ,[amkopiskmaak2012]=''''
      ,[yoopiskkoulk2012]=''''
      ,[yoopisktunn2012]=''''
      ,[yoopiskjarj2012]=''''
      , [yoopiskmaak2012] =''''
      ,[monihaku2012]=''''
      ,[ptoim1r4_2012]=''''
      ,[amas_2012]=''''
	  ,[luopiskkoulk2013] = ''''
	  ,[luopisktunn2013] = '''' 
	  ,[luopiskjarj2013] = ''''
	  ,[luopiskmaak2013] = ''''
	  ,[ammopiskkoulk2013] = ''''
	  ,[ammopisktunn2013] = ''''
	  ,[ammopiskjarj2013] = ''''
	  ,[ammopiskmaak2013] = ''''
	  ,[amkopiskkoulk2013] = ''''
	  ,[amkopisktunn2013] = ''''
	  ,[amkopiskjarj2013]= ''''
      ,[amkopiskmaak2013]= ''''
	  ,[yoopiskkoulk2013]= ''''
	  ,[yoopisktunn2013]= ''''
	  ,[yoopiskjarj2013]= ''''
	  ,[yoopiskmaak2013]= ''''
	  ,[monihaku2013] = ''''
	  ,[ptoim1r4_2013]= ''''
	  ,[amas_2013]= ''''
	  ,[luopiskkoulk2014] = ''''
	  ,[luopisktunn2014] = '''' 
	  ,[luopiskjarj2014] = ''''
	  ,[luopiskmaak2014] = ''''
	  ,[ammopiskkoulk2014] = ''''
	  ,[ammopisktunn2014] = ''''
	  ,[ammopiskjarj2014] = ''''
	  ,[ammopiskmaak2014] = ''''
	  ,[amkopiskkoulk2014] = ''''
	  ,[amkopisktunn2014] = ''''
	  ,[amkopiskjarj2014]= ''''
      ,[amkopiskmaak2014]= ''''
	  ,[yoopiskkoulk2014]= ''''
	  ,[yoopisktunn2014]= ''''
	  ,[yoopiskjarj2014]= ''''
	  ,[yoopiskmaak2014]= ''''
	  ,[monihaku2014] = ''''
	  ,[ptoim1r4_2014]= ''''
	  ,[amas_2014]= ''''
	  ,[lkm]
	  ,[pohjkoul]
      ,[tietolahde]=''K3_13_sopv_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_K3_13_sopv_13]
    UNION ALL
   SELECT
       [tilv]
      ,CAST(tilv + ''0101'' AS date) AS tilv_date
      ,[tutkryh]
      ,[suorv]
      ,[suorlk]
      ,[sp]
      ,(CASE WHEN [syntv] = ''19XX'' THEN '''' ELSE [syntv] END) as syntv
      ,[aikielir1]
      ,(CASE WHEN [tutkaskun]=''427'' THEN ''''
 WHEN [tutkaskun]= ''946'' and (tilv= ''2009'' or tilv=''2010'') then ''945''
      WHEN [tutkaskun]= ''198'' THEN ''''
      WHEN [tutkaskun]= ''168'' THEN ''''
	  WHEN [tutkaskun]= ''999'' THEN ''''  ELSE [tutkaskun] END) as tutkaskun
      ,[kansalr1]
      ,[pohjmaa]
      ,[eumaa]
      ,[etamaa]
       ,(CASE  WHEN [tunn] = ''BBBBB'' THEN ''''
      WHEN [tunn] = ''99999'' THEN ''''
      WHEN [tunn] = ''00000'' THEN '''' 
      when [tunn] = ''90009'' AND [tilv] = ''2009'' THEN ''''
      when [tunn] = ''90015'' AND [tilv] = ''2009'' THEN ''''
      when [tunn] = ''90010'' AND [tilv] = ''2009'' THEN ''''
      when [tunn] = ''90018'' AND [tilv] = ''2009'' THEN ''''
      when [tunn] = ''90008'' AND [tilv] = ''2010'' THEN ''''
      when [tunn] = ''90032'' AND [tilv] = ''2010'' THEN ''''
      when [tunn] = ''90032'' AND [tilv] = ''2011'' THEN ''''
      when [tunn] = ''90018'' AND [tilv] = ''2011'' THEN ''''
      when [tunn] = ''90006'' AND [tilv] = ''2009'' THEN ''''
      when [tunn] = ''90006'' AND [tilv] = ''2010'' THEN ''''
      when [tunn] = ''90006'' AND [tilv] = ''2011'' THEN ''''
      when [tunn] = ''90010'' AND [tilv] = ''2010'' THEN ''''
      when [tunn] = ''90010'' AND [tilv] = ''2011'' THEN ''''
      when [tunn] = ''90008'' AND [tilv] = ''2011'' THEN ''''
      when [tunn] = ''90018'' AND [tilv] = ''2010'' THEN ''''
      when [tunn] = ''90018'' AND [tilv] = ''2011'' THEN ''''
        when [tunn] = ''90018'' AND [tilv] = ''2012'' THEN ''''
      ELSE [tunn] END) AS tunn
      ,[jarj]
      ,[kkielir1]
      ,[tutklaja]
      ,[tutktav]
      ,[aikoul]
      ,(CASE WHEN [tutkmaak] = ''99'' THEN '''' ELSE [tutkmaak] END) AS tutkmaak
       ,[luopiskkoulk2004]=''''
      ,[luopisktunn2004]=''''
      ,[luopiskjarj2004]=''''
      ,[luopiskmaak2004] =''''
      ,[ammopiskkoulk2004]=''''
      ,[ammopisktunn2004]=''''
      ,[ammopiskjarj2004]=''''
      ,[ammopiskmaak2004] =''''
      ,[amkopiskkoulk2004]=''''
      ,[amkopisktunn2004]=''''
      ,[amkopiskjarj2004]=''''
      ,[amkopiskmaak2004]=''''
      ,[yoopiskkoulk2004]=''''
      ,[yoopisktunn2004]=''''
      ,[yoopiskjarj2004]=''''
      ,[yoopiskmaak2004]=''''
      ,[monihaku2004]=''''
      ,[ptoim1r4_2004]=''''
      ,[amas_2004]=''''
      ,[luopiskkoulk2005]=''''
      ,[luopisktunn2005]=''''
      ,[luopiskjarj2005]=''''
      ,[luopiskmaak2005]=''''
      ,[ammopiskkoulk2005]=''''
      ,[ammopisktunn2005]=''''
      ,[ammopiskjarj2005]=''''
      ,[ammopiskmaak2005]=''''
      ,[amkopiskkoulk2005]=''''
      ,[amkopisktunn2005]=''''
      ,[amkopiskjarj2005]=''''
      ,[amkopiskmaak2005]=''''
      ,[yoopiskkoulk2005]=''''
      ,[yoopisktunn2005]=''''
      ,[yoopiskjarj2005]=''''
      , [yoopiskmaak2005] =''''
      ,[monihaku2005]=''''
      ,[ptoim1r4_2005]=''''
      ,[amas_2005]=''''
      ,[luopiskkoulk2006]=''''
      ,[luopisktunn2006] = '''' 
      ,[luopiskjarj2006]=''''
      ,[luopiskmaak2006] = ''''
      ,[ammopiskkoulk2006]=''''
      ,[ammopisktunn2006]  = ''''
	  ,[ammopiskjarj2006]=''''
      ,[ammopiskmaak2006] ='''' 
      ,[amkopiskkoulk2006]=''''
      ,[amkopisktunn2006] = ''''    
      ,[amkopiskjarj2006] = ''''
      ,[amkopiskmaak2006] = ''''
      ,[yoopiskkoulk2006]= ''''
      ,[yoopisktunn2006] = '''' 
      ,[yoopiskjarj2006]= ''''
      ,[yoopiskmaak2006] = '''' 
      ,[monihaku2006]=''''
      ,[ptoim1r4_2006]=''''
      ,[amas_2006]=''''
    ,[luopiskkoulk_2007] as luopiskkoulk2007
       ,(CASE WHEN [luopisktunn_2007] = ''BBBBB'' THEN ''''
      WHEN [luopisktunn_2007]  = ''99999'' THEN '''' ELSE [luopisktunn_2007]  END) AS luopisktunn2007
      ,[luopiskjarj_2007] as luopiskjarj2007
      ,(CASE WHEN [luopiskmaak_2007] = ''99'' THEN '''' ELSE [luopiskmaak_2007] END) AS luopiskmaak2007
      ,[ammopiskkoulk_2007] as ammopiskkoulk2007
      ,(CASE WHEN [ammopisktunn_2007]  = ''BBBBB'' THEN ''''
      WHEN [ammopisktunn_2007]   = ''99999'' THEN ''''
      WHEN [ammopisktunn_2007]   = ''00000'' THEN ''''
      when [ammopisktunn_2007]    = ''90009'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2007]    = ''90015'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2007]    = ''90010'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2007]   = ''90018'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2007]   = ''90008'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2007]    = ''90032'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2007]    = ''90032'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2007]    = ''90018'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2007]    = ''90006'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2007]    = ''90006'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2007]    = ''90006'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2007]  = ''90010'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2007]  = ''90010'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2007]  = ''90008'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2007]   = ''90018'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2007]   = ''90018'' AND [tilv] = ''2011'' THEN ''''
        when [ammopisktunn_2007] = ''90018'' AND [tilv] = ''2012'' THEN ''''
      ELSE [ammopisktunn_2007]   END) AS ammopisktunn2007
      ,[ammopiskjarj_2007] as ammopiskjarj2007
      ,(CASE WHEN [ammopiskmaak_2007] = ''99'' THEN '''' ELSE [ammopiskmaak_2007] END) AS ammopiskmaak2007
      ,[amkopiskkoulk_2007] as amkopiskkoulk2007
     ,(CASE WHEN [amkopisktunn_2007] = ''BBBBB'' THEN ''''
       WHEN [amkopisktunn_2007] = ''99999'' THEN '''' ELSE [amkopisktunn_2007] END) AS amkopisktunn2007
      ,[amkopiskjarj_2007] as amkopiskjarj2007
      ,[amkopiskmaak_2007] as amkopiskmaak2007
      
      ,[yoopiskkoulk_2007] as yoopiskkoulk2007
     ,(CASE WHEN [yoopisktunn_2007] = ''BBBBB'' THEN ''''
      WHEN [yoopisktunn_2007] = ''99999'' THEN '''' ELSE [yoopisktunn_2007] END) AS yoopisktunn2007
      ,[yoopiskjarj_2007] as yoopiskjarj2007
      ,(CASE WHEN [yoopiskmaak_2007] = ''99'' THEN '''' ELSE [yoopiskmaak_2007] END) AS yoopiskmaak2007
      
      ,[monihaku_2007] as monihaku2007
      ,[ptoim1r4_2007]
      ,[amas_2007]
      
     ,[luopiskkoulk_2008] as luopiskkoulk2008
       ,(CASE WHEN [luopisktunn_2008] = ''BBBBB'' THEN ''''
      WHEN [luopisktunn_2008] = ''99999'' THEN '''' ELSE [luopisktunn_2008] END) AS luopisktunn2008
      ,[luopiskjarj_2008] as luopiskjarj2008
      ,(CASE WHEN [luopiskmaak_2008] = ''99'' THEN '''' ELSE [luopiskmaak_2008] END) AS luopiskmaak2008
      ,[ammopiskkoulk_2008] as ammopiskkoulk2008
      ,(CASE WHEN [ammopisktunn_2008]   = ''BBBBB'' THEN ''''
      WHEN [ammopisktunn_2008]    = ''99999'' THEN ''''
      WHEN [ammopisktunn_2008]    = ''00000'' THEN ''''
      when [ammopisktunn_2008]     = ''90009'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2008]     = ''90015'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2008]     = ''90010'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2008]    = ''90018'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2008]    = ''90008'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2008]     = ''90032'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2008]     = ''90032'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2008]     = ''90018'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2008]     = ''90006'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2008]     = ''90006'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2008]     = ''90006'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2008]  = ''90010'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2008]  = ''90010'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2008]  = ''90008'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2008]   = ''90018'' AND [tilv] = ''2010'' THEN ''''
        when [ammopisktunn_2008] = ''90018'' AND [tilv] = ''2012'' THEN ''''
      ELSE [ammopisktunn_2008]    END) AS ammopisktunn2008
      ,[ammopiskjarj_2008] as ammopiskjarj2008
      ,(CASE WHEN [ammopiskmaak_2008] = ''99'' THEN '''' ELSE [ammopiskmaak_2008] END) AS ammopiskmaak2008
      ,[amkopiskkoulk_2008] as amkopiskkoulk2008
      ,(CASE WHEN [amkopisktunn_2008] = ''BBBBB'' THEN ''''
       WHEN [amkopisktunn_2008] = ''99999'' THEN '''' ELSE [amkopisktunn_2008] END) AS amkopisktunn2008
      ,[amkopiskjarj_2008] as amkopiskjarj2008
      ,(CASE WHEN [amkopiskmaak_2008] = ''99'' THEN '''' ELSE [amkopiskmaak_2008] END) AS amkopiskmaak2008
      ,[yoopiskkoulk_2008] as yoopiskkoulk2008
     ,(CASE WHEN [yoopisktunn_2008] = ''BBBBB'' THEN ''''
      WHEN [yoopisktunn_2008] = ''99999'' THEN '''' ELSE [yoopisktunn_2008] END) AS yoopisktunn2008
      ,[yoopiskjarj_2008] as yoopiskjarj2008
      ,(CASE WHEN [yoopiskmaak_2008] = ''99'' THEN '''' ELSE [yoopiskmaak_2008] END) AS yoopiskmaak2008
      ,[monihaku_2008] as monihaku2008
      ,[ptoim1r4_2008]
      ,[amas_2008]
       ,[luopiskkoulk_2009] as luopiskkoulk2009
      ,(CASE WHEN [luopisktunn_2009] = ''BBBBB'' THEN ''''
      WHEN [luopisktunn_2009] = ''99999'' THEN '''' ELSE [luopisktunn_2009] END) AS luopisktunn2009
      ,[luopiskjarj_2009]
      ,(CASE WHEN [luopiskmaak_2009] = ''99'' THEN '''' ELSE [luopiskmaak_2009] END) AS luopiskmaak2009
      
      ,[ammopiskkoulk_2009] as ammopiskkoulk2009
     ,(CASE WHEN [ammopisktunn_2009]   = ''BBBBB'' THEN ''''
      WHEN [ammopisktunn_2009]    = ''99999'' THEN ''''
      WHEN [ammopisktunn_2009]    = ''00000'' THEN ''''
      when [ammopisktunn_2009]     = ''90009'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2009]     = ''90015'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2009]     = ''90010'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2009]    = ''90018'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2009]    = ''90008'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2009]     = ''90032'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2009]     = ''90032'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2009]     = ''90018'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2009]     = ''90006'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2009]     = ''90006'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2009]     = ''90006'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2009]  = ''90010'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2009]  = ''90010'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2009]  = ''90008'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2009]   = ''90018'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2009]   = ''90018'' AND [tilv] = ''2011'' THEN ''''
        when [ammopisktunn_2009] = ''90018'' AND [tilv] = ''2012'' THEN ''''
      ELSE [ammopisktunn_2009]    END) AS ammopisktunn2009
      ,[ammopiskjarj_2009] as ammopiskjarj2009
      ,(CASE WHEN [ammopiskmaak_2009] = ''99'' THEN '''' ELSE [ammopiskmaak_2009] END) AS ammopiskmaak2009
      ,[amkopiskkoulk_2009] as amkopiskkoulk2009
      ,(CASE WHEN [amkopisktunn_2009] = ''BBBBB'' THEN ''''
       WHEN [amkopisktunn_2009] = ''99999'' THEN '''' ELSE [amkopisktunn_2009] END) AS amkopisktunn2009
      ,[amkopiskjarj_2009] as amkopiskjarj2009
      ,[amkopiskmaak_2009] as amkopiskmaak2009
      ,[yoopiskkoulk_2009] as yoopiskkoulk2009
      ,(CASE WHEN [yoopisktunn_2009] = ''BBBBB'' THEN ''''
      WHEN [yoopisktunn_2009] = ''99999'' THEN '''' ELSE [yoopisktunn_2009] END) AS yoopisktunn2009
      ,[yoopiskjarj_2009] as yoopiskjarj2009
      ,(CASE WHEN [yoopiskmaak_2009] = ''99'' THEN '''' ELSE [yoopiskmaak_2009] END) AS yoopiskmaak2009
      ,[monihaku_2009] as monihaku2009
      ,[ptoim1r4_2009]
      ,[amas_2009]
      
       ,[luopiskkoulk_2010] as luopiskkoulk2010
      ,(CASE WHEN [luopisktunn_2010] = ''BBBBB'' THEN ''''
      WHEN [luopisktunn_2010] = ''99999'' THEN '''' ELSE [luopisktunn_2010] END) AS luopisktunn2010
      ,[luopiskjarj_2010]
      ,(CASE WHEN [luopiskmaak_2010] = ''99'' THEN '''' ELSE [luopiskmaak_2010] END) AS luopiskmaak2010
      
      ,[ammopiskkoulk_2010] as ammopiskkoulk2010
      ,(CASE WHEN [ammopisktunn_2010]   = ''BBBBB'' THEN ''''
      WHEN [ammopisktunn_2010]    = ''99999'' THEN ''''
      WHEN [ammopisktunn_2010]    = ''00000'' THEN ''''
      when [ammopisktunn_2010]     = ''90009'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2010]     = ''90015'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2010]     = ''90010'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2010]    = ''90018'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2010]    = ''90008'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2010]     = ''90032'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2010]     = ''90032'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2010]     = ''90018'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2010]     = ''90006'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2010]     = ''90006'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2010]     = ''90006'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2010]  = ''90010'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2010]  = ''90010'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2010]  = ''90008'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2010]   = ''90018'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2010]   = ''90018'' AND [tilv] = ''2011'' THEN ''''
        when [ammopisktunn_2010] = ''90018'' AND [tilv] = ''2012'' THEN ''''
      ELSE [ammopisktunn_2010]    END) AS ammopisktunn2010
      ,[ammopiskjarj_2010] as ammopiskjarj2010
      ,(CASE WHEN [ammopiskmaak_2010] = ''99'' THEN '''' ELSE [ammopiskmaak_2010] END) AS ammopiskmaak2010
      
      ,[amkopiskkoulk_2010] as amkopiskkoulk2010
      ,(CASE WHEN [amkopisktunn_2010] = ''BBBBB'' THEN ''''
       WHEN [amkopisktunn_2010] = ''99999'' THEN '''' ELSE [amkopisktunn_2010] END) AS amkopisktunn2010
      ,[amkopiskjarj_2010] as amkopiskjarj2010
      ,[amkopiskmaak_2010] as amkopiskmaak2010
      
      ,[yoopiskkoulk_2010] as yoopiskkoulk2010
      ,(CASE WHEN [yoopisktunn_2010] = ''BBBBB'' THEN ''''
      WHEN [yoopisktunn_2010] = ''99999'' THEN '''' ELSE [yoopisktunn_2010] END) AS yoopisktunn2010
      ,[yoopiskjarj_2010] as yoopiskjarj2010
      ,(CASE WHEN [yoopiskmaak_2010] = ''99'' THEN '''' ELSE [yoopiskmaak_2010] END) AS yoopiskmaak2010
      ,[monihaku_2010] as monihaku2010
      ,[ptoim1r4_2010] 
      ,[amas_2010]
      
      ,[luopiskkoulk_2011] as luopiskkoulk2011
      ,(CASE WHEN [luopisktunn_2011] = ''BBBBB'' THEN ''''
      WHEN [luopisktunn_2011] = ''99999'' THEN '''' ELSE [luopisktunn_2011] END) AS luopisktunn2011
      ,[luopiskjarj_2011] as luopiskjarj2011
      ,(CASE WHEN [luopiskmaak_2011] = ''99'' THEN '''' ELSE [luopiskmaak_2011] END) AS luopiskmaak2011
      
      ,[ammopiskkoulk_2011] as ammopiskkoulk2011
      ,(CASE WHEN [ammopisktunn_2011]   = ''BBBBB'' THEN '''' 
      WHEN [ammopisktunn_2011]    = ''99999'' THEN '''' 
      WHEN [ammopisktunn_2011]    = ''00000'' THEN '''' 
      when [ammopisktunn_2011]     = ''90009'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2011]     = ''90015'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2011]     = ''90010'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2011]    = ''90018'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2011]    = ''90008'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2011]     = ''90032'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2011]     = ''90032'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2011]     = ''90018'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2011]     = ''90006'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2011]     = ''90006'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2011]     = ''90006'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2011]  = ''90010'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2011]  = ''90010'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2011]  = ''90008'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2011]   = ''90018'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2011]   = ''90018'' AND [tilv] = ''2011'' THEN ''''
        when [ammopisktunn_2011] = ''90018'' AND [tilv] = ''2012'' THEN ''''
      ELSE [ammopisktunn_2011]    END) AS ammopisktunn2011 
      ,[ammopiskjarj_2011] as ammopiskjarj2011
      ,(CASE WHEN [ammopiskmaak_2011] = ''99'' THEN '''' ELSE [ammopiskmaak_2011] END) AS ammopiskmaak2011
      
      ,[amkopiskkoulk_2011] as amkopiskkoulk2011
      ,(CASE WHEN [amkopisktunn_2011] = ''BBBBB'' THEN ''''
       WHEN [amkopisktunn_2011] = ''99999'' THEN '''' ELSE [amkopisktunn_2011] END) AS amkopisktunn2011
      ,[amkopiskjarj_2011] as amkopiskjarj2011
      ,(CASE WHEN [amkopiskmaak_2011] = ''99'' THEN '''' ELSE [amkopiskmaak_2011] END) AS amkopiskmaak2011
      
      ,[yoopiskkoulk_2011] as yoopiskkoulk2011
      ,(CASE WHEN [yoopisktunn_2011] = ''BBBBB'' THEN ''''
      WHEN [yoopisktunn_2011] = ''99999'' THEN '''' ELSE [yoopisktunn_2011] END) AS yoopisktunn2011
      ,[yoopiskjarj_2011] as yoopiskjarj2011
      ,(CASE WHEN [yoopiskmaak_2011] = ''99'' THEN '''' ELSE [yoopiskmaak_2011] END) AS yoopiskmaak2011
      ,[monihaku_2011] as monihaku2011
      ,[ptoim1r4_2011]
      ,[amas_2011]
      
       ,[luopiskkoulk_2012] as luopiskkoulk2012
      ,(CASE WHEN [luopisktunn_2012] = ''BBBBB'' THEN ''''
      WHEN [luopisktunn_2012] = ''99999'' THEN '''' ELSE [luopisktunn_2012] END) AS luopisktunn2012
      ,[luopiskjarj_2012] as luopiskjarj2012
      ,(CASE WHEN [luopiskmaak_2012] = ''99'' THEN '''' ELSE ([luopiskmaak_2012]) END) AS luopiskmaak2012
      
      ,[ammopiskkoulk_2012] as ammopiskkoulk2012
      ,(CASE WHEN [ammopisktunn_2012]   = ''BBBBB'' THEN '''' 
      WHEN [ammopisktunn_2012]    = ''99999'' THEN '''' 
      WHEN [ammopisktunn_2012]    = ''00000'' THEN '''' 
      when [ammopisktunn_2012]     = ''90009'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2012]     = ''90015'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2012]     = ''90010'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2012]    = ''90018'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2012]    = ''90008'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2012]     = ''90032'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2012]     = ''90032'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2012]     = ''90018'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2012]     = ''90006'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2012]     = ''90006'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2012]     = ''90006'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2012]  = ''90010'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2012]  = ''90010'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2012]  = ''90008'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2012]   = ''90018'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2012]   = ''90018'' AND [tilv] = ''2011'' THEN ''''
        when [ammopisktunn_2012] = ''90018'' AND [tilv] = ''2012'' THEN ''''
      ELSE [ammopisktunn_2012]    END) AS ammopisktunn2012 
      ,[ammopiskjarj_2012] as ammopiskjarj2012
      ,(CASE WHEN [ammopiskmaak_2012] = ''99'' THEN ''''
       ELSE [ammopiskmaak_2012] END) AS ammopiskmaak2012
      ,[amkopiskkoulk_2012] as amkopiskkoulk2012
      ,(CASE WHEN [amkopisktunn_2012] = ''BBBBB'' THEN ''''
       WHEN [amkopisktunn_2012] = ''99999'' THEN '''' ELSE [amkopisktunn_2012] END) AS amkopisktunn2012
      ,[amkopiskjarj_2012] as amkopiskjarj2012
      ,(CASE WHEN [amkopiskmaak_2012] = ''99'' THEN '''' ELSE [amkopiskmaak_2012] END) AS amkopiskmaak2012
      
      ,[yoopiskkoulk_2012] as yoopiskkoulk2012
      ,(CASE WHEN [yoopisktunn_2012] = ''BBBBB'' THEN ''''
      WHEN [yoopisktunn_2012] = ''99999'' THEN '''' ELSE [yoopisktunn_2012] END) AS yoopisktunn2012
      ,[yoopiskjarj_2012] as yoopiskjarj2012
      ,(CASE WHEN [yoopiskmaak_2012] = ''99'' THEN '''' ELSE [yoopiskmaak_2012] END) AS yoopiskmaak2012
      ,[monihaku_2012] as monihaku2012
      ,[ptoim1r4_2012]
      ,[amas_2012]
	  ,[luopiskkoulk2013] = ''''
	  ,[luopisktunn2013] = '''' 
	  ,[luopiskjarj2013] = ''''
	  ,[luopiskmaak2013] = ''''
	  ,[ammopiskkoulk2013] = ''''
	  ,[ammopisktunn2013] = ''''
	  ,[ammopiskjarj2013] = ''''
	  ,[ammopiskmaak2013] = ''''
	  ,[amkopiskkoulk2013] = ''''
	  ,[amkopisktunn2013] = ''''
	  ,[amkopiskjarj2013]= ''''
      ,[amkopiskmaak2013]= ''''
	  ,[yoopiskkoulk2013]= ''''
	  ,[yoopisktunn2013]= ''''
	  ,[yoopiskjarj2013]= ''''
	  ,[yoopiskmaak2013]= ''''
	  ,[monihaku2013] = ''''
	  ,[ptoim1r4_2013]= ''''
	  ,[amas_2013]= ''''
	  ,[luopiskkoulk2014] = ''''
	  ,[luopisktunn2014] = '''' 
	  ,[luopiskjarj2014] = ''''
	  ,[luopiskmaak2014] = ''''
	  ,[ammopiskkoulk2014] = ''''
	  ,[ammopisktunn2014] = ''''
	  ,[ammopiskjarj2014] = ''''
	  ,[ammopiskmaak2014] = ''''
	  ,[amkopiskkoulk2014] = ''''
	  ,[amkopisktunn2014] = ''''
	  ,[amkopiskjarj2014]= ''''
      ,[amkopiskmaak2014]= ''''
	  ,[yoopiskkoulk2014]= ''''
	  ,[yoopisktunn2014]= ''''
	  ,[yoopiskjarj2014]= ''''
	  ,[yoopiskmaak2014]= ''''
	  ,[monihaku2014] = ''''
	  ,[ptoim1r4_2014]= ''''
	  ,[amas_2014]= ''''
	  ,[lkm]
	  ,[pohjkoul]
      ,[tietolahde]=''K3_13_sopv_14''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_K3_13_sopv_14]
  UNION
     SELECT
       [tilv]
      ,CAST(tilv + ''0101'' AS date) AS tilv_date
      ,[tutkryh]
      ,[suorv]
      ,[suorlk]
      ,[sp]
      ,(CASE WHEN [syntv] = ''19XX'' THEN '''' ELSE [syntv] END) as syntv
      ,[aikielir1]
      ,(CASE WHEN [tutkaskun]=''427'' THEN ''''
 WHEN [tutkaskun]= ''946'' and (tilv= ''2009'' or tilv=''2010'') then ''945''
      WHEN [tutkaskun]= ''198'' THEN ''''
      WHEN [tutkaskun]= ''168'' THEN ''''
	  WHEN [tutkaskun]= ''999'' THEN ''''  ELSE [tutkaskun] END) as tutkaskun
      ,[kansalr1]
      ,[pohjmaa]
      ,[eumaa]
      ,[etamaa]
       ,(CASE  WHEN [tunn] = ''BBBBB'' THEN ''''
      WHEN [tunn] = ''99999'' THEN ''''
      WHEN [tunn] = ''00000'' THEN '''' 
      when [tunn] = ''90009'' AND [tilv] = ''2009'' THEN ''''
      when [tunn] = ''90015'' AND [tilv] = ''2009'' THEN ''''
      when [tunn] = ''90010'' AND [tilv] = ''2009'' THEN ''''
      when [tunn] = ''90018'' AND [tilv] = ''2009'' THEN ''''
      when [tunn] = ''90008'' AND [tilv] = ''2010'' THEN ''''
      when [tunn] = ''90032'' AND [tilv] = ''2010'' THEN ''''
      when [tunn] = ''90032'' AND [tilv] = ''2011'' THEN ''''
      when [tunn] = ''90018'' AND [tilv] = ''2011'' THEN ''''
      when [tunn] = ''90006'' AND [tilv] = ''2009'' THEN ''''
      when [tunn] = ''90006'' AND [tilv] = ''2010'' THEN ''''
      when [tunn] = ''90006'' AND [tilv] = ''2011'' THEN ''''
      when [tunn] = ''90010'' AND [tilv] = ''2010'' THEN ''''
      when [tunn] = ''90010'' AND [tilv] = ''2011'' THEN ''''
      when [tunn] = ''90008'' AND [tilv] = ''2011'' THEN ''''
      when [tunn] = ''90018'' AND [tilv] = ''2010'' THEN ''''
      when [tunn] = ''90018'' AND [tilv] = ''2011'' THEN ''''
        when [tunn] = ''90018'' AND [tilv] = ''2012'' THEN ''''
      ELSE [tunn] END) AS tunn
      ,[jarj]
      ,[kkielir1]
      ,[tutklaja]
      ,[tutktav]
      ,[aikoul]
      ,(CASE WHEN [tutkmaak] = ''99'' THEN '''' ELSE [tutkmaak] END) AS tutkmaak
       ,[luopiskkoulk2004]=''''
      ,[luopisktunn2004]=''''
      ,[luopiskjarj2004]=''''
      ,[luopiskmaak2004] =''''
      ,[ammopiskkoulk2004]=''''
      ,[ammopisktunn2004]=''''
      ,[ammopiskjarj2004]=''''
      ,[ammopiskmaak2004] =''''
      ,[amkopiskkoulk2004]=''''
      ,[amkopisktunn2004]=''''
      ,[amkopiskjarj2004]=''''
      ,[amkopiskmaak2004]=''''
      ,[yoopiskkoulk2004]=''''
      ,[yoopisktunn2004]=''''
      ,[yoopiskjarj2004]=''''
      ,[yoopiskmaak2004]=''''
      ,[monihaku2004]=''''
      ,[ptoim1r4_2004]=''''
      ,[amas_2004]=''''
      ,[luopiskkoulk2005]=''''
      ,[luopisktunn2005]=''''
      ,[luopiskjarj2005]=''''
      ,[luopiskmaak2005]=''''
      ,[ammopiskkoulk2005]=''''
      ,[ammopisktunn2005]=''''
      ,[ammopiskjarj2005]=''''
      ,[ammopiskmaak2005]=''''
      ,[amkopiskkoulk2005]=''''
      ,[amkopisktunn2005]=''''
      ,[amkopiskjarj2005]=''''
      ,[amkopiskmaak2005]=''''
      ,[yoopiskkoulk2005]=''''
      ,[yoopisktunn2005]=''''
      ,[yoopiskjarj2005]=''''
      , [yoopiskmaak2005] =''''
      ,[monihaku2005]=''''
      ,[ptoim1r4_2005]=''''
      ,[amas_2005]=''''
      ,[luopiskkoulk2006]=''''
      ,[luopisktunn2006] = '''' 
      ,[luopiskjarj2006]=''''
      ,[luopiskmaak2006] = ''''
      ,[ammopiskkoulk2006]=''''
      ,[ammopisktunn2006]  = ''''
	  ,[ammopiskjarj2006]=''''
      ,[ammopiskmaak2006] ='''' 
      ,[amkopiskkoulk2006]=''''
      ,[amkopisktunn2006] = ''''    
      ,[amkopiskjarj2006] = ''''
      ,[amkopiskmaak2006] = ''''
      ,[yoopiskkoulk2006]= ''''
      ,[yoopisktunn2006] = '''' 
      ,[yoopiskjarj2006]= ''''
      ,[yoopiskmaak2006] = '''' 
      ,[monihaku2006]=''''
      ,[ptoim1r4_2006]=''''
      ,[amas_2006]=''''
	  ,[luopiskkoulk2007]=''''
      ,[luopisktunn2007] = '''' 
      ,[luopiskjarj2007]=''''
      ,[luopiskmaak2007] = ''''
      ,[ammopiskkoulk2007]=''''
      ,[ammopisktunn2007]  = ''''
	  ,[ammopiskjarj2007]=''''
      ,[ammopiskmaak2007] ='''' 
      ,[amkopiskkoulk2007]=''''
      ,[amkopisktunn2007] = ''''    
      ,[amkopiskjarj2007] = ''''
      ,[amkopiskmaak2007] = ''''
      ,[yoopiskkoulk2007]= ''''
      ,[yoopisktunn2007] = '''' 
      ,[yoopiskjarj2007]= ''''
      ,[yoopiskmaak2007] = '''' 
      ,[monihaku2007]=''''
      ,[ptoim1r4_2007]=''''
      ,[amas_2007]=''''
      
     ,[luopiskkoulk_2008] as luopiskkoulk2008
       ,(CASE WHEN [luopisktunn_2008] = ''BBBBB'' THEN ''''
      WHEN [luopisktunn_2008] = ''99999'' THEN '''' ELSE [luopisktunn_2008] END) AS luopisktunn2008
      ,[luopiskjarj_2008] as luopiskjarj2008
      ,(CASE WHEN [luopiskmaak_2008] = ''99'' THEN '''' ELSE [luopiskmaak_2008] END) AS luopiskmaak2008
      ,[ammopiskkoulk_2008] as ammopiskkoulk2008
      ,(CASE WHEN [ammopisktunn_2008]   = ''BBBBB'' THEN ''''
      WHEN [ammopisktunn_2008]    = ''99999'' THEN ''''
      WHEN [ammopisktunn_2008]    = ''00000'' THEN ''''
      when [ammopisktunn_2008]     = ''90009'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2008]     = ''90015'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2008]     = ''90010'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2008]    = ''90018'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2008]    = ''90008'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2008]     = ''90032'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2008]     = ''90032'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2008]     = ''90018'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2008]     = ''90006'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2008]     = ''90006'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2008]     = ''90006'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2008]  = ''90010'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2008]  = ''90010'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2008]  = ''90008'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2008]   = ''90018'' AND [tilv] = ''2010'' THEN ''''
        when [ammopisktunn_2008] = ''90018'' AND [tilv] = ''2012'' THEN ''''
      ELSE [ammopisktunn_2008]    END) AS ammopisktunn2008
      ,[ammopiskjarj_2008] as ammopiskjarj2008
      ,(CASE WHEN [ammopiskmaak_2008] = ''99'' THEN '''' ELSE [ammopiskmaak_2008] END) AS ammopiskmaak2008
      ,[amkopiskkoulk_2008] as amkopiskkoulk2008
      ,(CASE WHEN [amkopisktunn_2008] = ''BBBBB'' THEN ''''
       WHEN [amkopisktunn_2008] = ''99999'' THEN '''' ELSE [amkopisktunn_2008] END) AS amkopisktunn2008
      ,[amkopiskjarj_2008] as amkopiskjarj2008
      ,(CASE WHEN [amkopiskmaak_2008] = ''99'' THEN '''' ELSE [amkopiskmaak_2008] END) AS amkopiskmaak2008
      ,[yoopiskkoulk_2008] as yoopiskkoulk2008
     ,(CASE WHEN [yoopisktunn_2008] = ''BBBBB'' THEN ''''
      WHEN [yoopisktunn_2008] = ''99999'' THEN '''' ELSE [yoopisktunn_2008] END) AS yoopisktunn2008
      ,[yoopiskjarj_2008] as yoopiskjarj2008
      ,(CASE WHEN [yoopiskmaak_2008] = ''99'' THEN '''' ELSE [yoopiskmaak_2008] END) AS yoopiskmaak2008
      ,[monihaku_2008] as monihaku2008
      ,[ptoim1r4_2008]
      ,[amas_2008]
       ,[luopiskkoulk_2009] as luopiskkoulk2009
      ,(CASE WHEN [luopisktunn_2009] = ''BBBBB'' THEN ''''
      WHEN [luopisktunn_2009] = ''99999'' THEN '''' ELSE [luopisktunn_2009] END) AS luopisktunn2009
      ,[luopiskjarj_2009]
      ,(CASE WHEN [luopiskmaak_2009] = ''99'' THEN '''' ELSE [luopiskmaak_2009] END) AS luopiskmaak2009
      
      ,[ammopiskkoulk_2009] as ammopiskkoulk2009
     ,(CASE WHEN [ammopisktunn_2009]   = ''BBBBB'' THEN ''''
      WHEN [ammopisktunn_2009]    = ''99999'' THEN ''''
      WHEN [ammopisktunn_2009]    = ''00000'' THEN ''''
      when [ammopisktunn_2009]     = ''90009'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2009]     = ''90015'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2009]     = ''90010'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2009]    = ''90018'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2009]    = ''90008'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2009]     = ''90032'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2009]     = ''90032'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2009]     = ''90018'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2009]     = ''90006'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2009]     = ''90006'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2009]     = ''90006'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2009]  = ''90010'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2009]  = ''90010'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2009]  = ''90008'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2009]   = ''90018'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2009]   = ''90018'' AND [tilv] = ''2011'' THEN ''''
        when [ammopisktunn_2009] = ''90018'' AND [tilv] = ''2012'' THEN ''''
      ELSE [ammopisktunn_2009]    END) AS ammopisktunn2009
      ,[ammopiskjarj_2009] as ammopiskjarj2009
      ,(CASE WHEN [ammopiskmaak_2009] = ''99'' THEN '''' ELSE [ammopiskmaak_2009] END) AS ammopiskmaak2009
      ,[amkopiskkoulk_2009] as amkopiskkoulk2009
      ,(CASE WHEN [amkopisktunn_2009] = ''BBBBB'' THEN ''''
       WHEN [amkopisktunn_2009] = ''99999'' THEN '''' ELSE [amkopisktunn_2009] END) AS amkopisktunn2009
      ,[amkopiskjarj_2009] as amkopiskjarj2009
      ,[amkopiskmaak_2009] as amkopiskmaak2009
      ,[yoopiskkoulk_2009] as yoopiskkoulk2009
      ,(CASE WHEN [yoopisktunn_2009] = ''BBBBB'' THEN ''''
      WHEN [yoopisktunn_2009] = ''99999'' THEN '''' ELSE [yoopisktunn_2009] END) AS yoopisktunn2009
      ,[yoopiskjarj_2009] as yoopiskjarj2009
      ,(CASE WHEN [yoopiskmaak_2009] = ''99'' THEN '''' ELSE [yoopiskmaak_2009] END) AS yoopiskmaak2009
      ,[monihaku_2009] as monihaku2009
      ,[ptoim1r4_2009]
      ,[amas_2009]
      
       ,[luopiskkoulk_2010] as luopiskkoulk2010
      ,(CASE WHEN [luopisktunn_2010] = ''BBBBB'' THEN ''''
      WHEN [luopisktunn_2010] = ''99999'' THEN '''' ELSE [luopisktunn_2010] END) AS luopisktunn2010
      ,[luopiskjarj_2010]
      ,(CASE WHEN [luopiskmaak_2010] = ''99'' THEN '''' ELSE [luopiskmaak_2010] END) AS luopiskmaak2010
      
      ,[ammopiskkoulk_2010] as ammopiskkoulk2010
      ,(CASE WHEN [ammopisktunn_2010]   = ''BBBBB'' THEN ''''
      WHEN [ammopisktunn_2010]    = ''99999'' THEN ''''
      WHEN [ammopisktunn_2010]    = ''00000'' THEN ''''
      when [ammopisktunn_2010]     = ''90009'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2010]     = ''90015'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2010]     = ''90010'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2010]    = ''90018'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2010]    = ''90008'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2010]     = ''90032'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2010]     = ''90032'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2010]     = ''90018'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2010]     = ''90006'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2010]     = ''90006'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2010]     = ''90006'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2010]  = ''90010'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2010]  = ''90010'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2010]  = ''90008'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2010]   = ''90018'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2010]   = ''90018'' AND [tilv] = ''2011'' THEN ''''
        when [ammopisktunn_2010] = ''90018'' AND [tilv] = ''2012'' THEN ''''
      ELSE [ammopisktunn_2010]    END) AS ammopisktunn2010
      ,[ammopiskjarj_2010] as ammopiskjarj2010
      ,(CASE WHEN [ammopiskmaak_2010] = ''99'' THEN '''' ELSE [ammopiskmaak_2010] END) AS ammopiskmaak2010
      
      ,[amkopiskkoulk_2010] as amkopiskkoulk2010
      ,(CASE WHEN [amkopisktunn_2010] = ''BBBBB'' THEN ''''
       WHEN [amkopisktunn_2010] = ''99999'' THEN '''' ELSE [amkopisktunn_2010] END) AS amkopisktunn2010
      ,[amkopiskjarj_2010] as amkopiskjarj2010
      ,[amkopiskmaak_2010] as amkopiskmaak2010
      
      ,[yoopiskkoulk_2010] as yoopiskkoulk2010
      ,(CASE WHEN [yoopisktunn_2010] = ''BBBBB'' THEN ''''
      WHEN [yoopisktunn_2010] = ''99999'' THEN '''' ELSE [yoopisktunn_2010] END) AS yoopisktunn2010
      ,[yoopiskjarj_2010] as yoopiskjarj2010
      ,(CASE WHEN [yoopiskmaak_2010] = ''99'' THEN '''' ELSE [yoopiskmaak_2010] END) AS yoopiskmaak2010
      ,[monihaku_2010] as monihaku2010
      ,[ptoim1r4_2010] 
      ,[amas_2010]
      
      ,[luopiskkoulk_2011] as luopiskkoulk2011
      ,(CASE WHEN [luopisktunn_2011] = ''BBBBB'' THEN ''''
      WHEN [luopisktunn_2011] = ''99999'' THEN '''' ELSE [luopisktunn_2011] END) AS luopisktunn2011
      ,[luopiskjarj_2011] as luopiskjarj2011
      ,(CASE WHEN [luopiskmaak_2011] = ''99'' THEN '''' ELSE [luopiskmaak_2011] END) AS luopiskmaak2011
      
      ,[ammopiskkoulk_2011] as ammopiskkoulk2011
      ,(CASE WHEN [ammopisktunn_2011]   = ''BBBBB'' THEN '''' 
      WHEN [ammopisktunn_2011]    = ''99999'' THEN '''' 
      WHEN [ammopisktunn_2011]    = ''00000'' THEN '''' 
      when [ammopisktunn_2011]     = ''90009'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2011]     = ''90015'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2011]     = ''90010'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2011]    = ''90018'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2011]    = ''90008'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2011]     = ''90032'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2011]     = ''90032'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2011]     = ''90018'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2011]     = ''90006'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2011]     = ''90006'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2011]     = ''90006'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2011]  = ''90010'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2011]  = ''90010'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2011]  = ''90008'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2011]   = ''90018'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2011]   = ''90018'' AND [tilv] = ''2011'' THEN ''''
        when [ammopisktunn_2011] = ''90018'' AND [tilv] = ''2012'' THEN ''''
      ELSE [ammopisktunn_2011]    END) AS ammopisktunn2011 
      ,[ammopiskjarj_2011] as ammopiskjarj2011
      ,(CASE WHEN [ammopiskmaak_2011] = ''99'' THEN '''' ELSE [ammopiskmaak_2011] END) AS ammopiskmaak2011
      
      ,[amkopiskkoulk_2011] as amkopiskkoulk2011
      ,(CASE WHEN [amkopisktunn_2011] = ''BBBBB'' THEN ''''
       WHEN [amkopisktunn_2011] = ''99999'' THEN '''' ELSE [amkopisktunn_2011] END) AS amkopisktunn2011
      ,[amkopiskjarj_2011] as amkopiskjarj2011
      ,(CASE WHEN [amkopiskmaak_2011] = ''99'' THEN '''' ELSE [amkopiskmaak_2011] END) AS amkopiskmaak2011
      
      ,[yoopiskkoulk_2011] as yoopiskkoulk2011
      ,(CASE WHEN [yoopisktunn_2011] = ''BBBBB'' THEN ''''
      WHEN [yoopisktunn_2011] = ''99999'' THEN '''' ELSE [yoopisktunn_2011] END) AS yoopisktunn2011
      ,[yoopiskjarj_2011] as yoopiskjarj2011
      ,(CASE WHEN [yoopiskmaak_2011] = ''99'' THEN '''' ELSE [yoopiskmaak_2011] END) AS yoopiskmaak2011
      ,[monihaku_2011] as monihaku2011
      ,[ptoim1r4_2011]
      ,[amas_2011]
      
       ,[luopiskkoulk_2012] as luopiskkoulk2012
      ,(CASE WHEN [luopisktunn_2012] = ''BBBBB'' THEN ''''
      WHEN [luopisktunn_2012] = ''99999'' THEN '''' ELSE [luopisktunn_2012] END) AS luopisktunn2012
      ,[luopiskjarj_2012] as luopiskjarj2012
      ,(CASE WHEN [luopiskmaak_2012] = ''99'' THEN '''' ELSE ([luopiskmaak_2012]) END) AS luopiskmaak2012
      
      ,[ammopiskkoulk_2012] as ammopiskkoulk2012
      ,(CASE WHEN [ammopisktunn_2012]   = ''BBBBB'' THEN '''' 
      WHEN [ammopisktunn_2012]    = ''99999'' THEN '''' 
      WHEN [ammopisktunn_2012]    = ''00000'' THEN '''' 
      when [ammopisktunn_2012]     = ''90009'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2012]     = ''90015'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2012]     = ''90010'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2012]    = ''90018'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2012]    = ''90008'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2012]     = ''90032'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2012]     = ''90032'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2012]     = ''90018'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2012]     = ''90006'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2012]     = ''90006'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2012]     = ''90006'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2012]  = ''90010'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2012]  = ''90010'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2012]  = ''90008'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2012]   = ''90018'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2012]   = ''90018'' AND [tilv] = ''2011'' THEN ''''
        when [ammopisktunn_2012] = ''90018'' AND [tilv] = ''2012'' THEN ''''
      ELSE [ammopisktunn_2012]    END) AS ammopisktunn2012 
      ,[ammopiskjarj_2012] as ammopiskjarj2012
      ,(CASE WHEN [ammopiskmaak_2012] = ''99'' THEN ''''
       ELSE [ammopiskmaak_2012] END) AS ammopiskmaak2012
      ,[amkopiskkoulk_2012] as amkopiskkoulk2012
      ,(CASE WHEN [amkopisktunn_2012] = ''BBBBB'' THEN ''''
       WHEN [amkopisktunn_2012] = ''99999'' THEN '''' ELSE [amkopisktunn_2012] END) AS amkopisktunn2012
      ,[amkopiskjarj_2012] as amkopiskjarj2012
      ,(CASE WHEN [amkopiskmaak_2012] = ''99'' THEN '''' ELSE [amkopiskmaak_2012] END) AS amkopiskmaak2012
      
      ,[yoopiskkoulk_2012] as yoopiskkoulk2012
      ,(CASE WHEN [yoopisktunn_2012] = ''BBBBB'' THEN ''''
      WHEN [yoopisktunn_2012] = ''99999'' THEN '''' ELSE [yoopisktunn_2012] END) AS yoopisktunn2012
      ,[yoopiskjarj_2012] as yoopiskjarj2012
      ,(CASE WHEN [yoopiskmaak_2012] = ''99'' THEN '''' ELSE [yoopiskmaak_2012] END) AS yoopiskmaak2012
      ,[monihaku_2012] as monihaku2012
      ,[ptoim1r4_2012]
      ,[amas_2012]
	  
	   ,[luopiskkoulk_2013] as luopiskkoulk2013
      ,(CASE WHEN [luopisktunn_2013] = ''BBBBB'' THEN ''''
      WHEN [luopisktunn_2013] = ''99999'' THEN '''' ELSE [luopisktunn_2013] END) AS luopisktunn2013
      ,[luopiskjarj_2013] as luopiskjarj2013
      ,(CASE WHEN [luopiskmaak_2013] = ''99'' THEN '''' ELSE ([luopiskmaak_2013]) END) AS luopiskmaak2013
      
      ,[ammopiskkoulk_2013] as ammopiskkoulk2013
      ,(CASE WHEN [ammopisktunn_2013]   = ''BBBBB'' THEN '''' 
      WHEN [ammopisktunn_2013]    = ''99999'' THEN '''' 
      WHEN [ammopisktunn_2013]    = ''00000'' THEN '''' 
      when [ammopisktunn_2013]     = ''90009'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2013]     = ''90015'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2013]     = ''90010'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2013]    = ''90018'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2013]    = ''90008'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2013]     = ''90032'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2013]     = ''90032'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2013]     = ''90018'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2013]     = ''90006'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2013]     = ''90006'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2013]     = ''90006'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2013]  = ''90010'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2013]  = ''90010'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2013]  = ''90008'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2013]   = ''90018'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2013]   = ''90018'' AND [tilv] = ''2011'' THEN ''''
        when [ammopisktunn_2013] = ''90018'' AND [tilv] = ''2012'' THEN ''''
      ELSE [ammopisktunn_2013]    END) AS ammopisktunn2013 
      ,[ammopiskjarj_2013] as ammopiskjarj2013
      ,(CASE WHEN [ammopiskmaak_2013] = ''99'' THEN ''''
       ELSE [ammopiskmaak_2013] END) AS ammopiskmaak2013
      ,[amkopiskkoulk_2013] as amkopiskkoulk2013
      ,(CASE WHEN [amkopisktunn_2013] = ''BBBBB'' THEN ''''
       WHEN [amkopisktunn_2013] = ''99999'' THEN '''' ELSE [amkopisktunn_2013] END) AS amkopisktunn2013
      ,[amkopiskjarj_2013] as amkopiskjarj2013
      ,(CASE WHEN [amkopiskmaak_2013] = ''99'' THEN '''' ELSE [amkopiskmaak_2013] END) AS amkopiskmaak2013
      
      ,[yoopiskkoulk_2013] as yoopiskkoulk2013
      ,(CASE WHEN [yoopisktunn_2013] = ''BBBBB'' THEN ''''
      WHEN [yoopisktunn_2013] = ''99999'' THEN '''' ELSE [yoopisktunn_2013] END) AS yoopisktunn2013
      ,[yoopiskjarj_2013] as yoopiskjarj2013
      ,(CASE WHEN [yoopiskmaak_2013] = ''99'' THEN '''' ELSE [yoopiskmaak_2013] END) AS yoopiskmaak2013
      ,[monihaku_2013] as monihaku2013
      ,[ptoim1r4_2013]
      ,[amas_2013]
      ,[luopiskkoulk2014] = ''''
	  ,[luopisktunn2014] = '''' 
	  ,[luopiskjarj2014] = ''''
	  ,[luopiskmaak2014] = ''''
	  ,[ammopiskkoulk2014] = ''''
	  ,[ammopisktunn2014] = ''''
	  ,[ammopiskjarj2014] = ''''
	  ,[ammopiskmaak2014] = ''''
	  ,[amkopiskkoulk2014] = ''''
	  ,[amkopisktunn2014] = ''''
	  ,[amkopiskjarj2014]= ''''
      ,[amkopiskmaak2014]= ''''
	  ,[yoopiskkoulk2014]= ''''
	  ,[yoopisktunn2014]= ''''
	  ,[yoopiskjarj2014]= ''''
	  ,[yoopiskmaak2014]= ''''
	  ,[monihaku2014] = ''''
	  ,[ptoim1r4_2014]= ''''
	  ,[amas_2014]= ''''
	  ,[lkm]
	  ,[pohjkoul]
      ,[tietolahde]=''K3_13_sopv_15''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_K3_13_sopv_15]
    UNION
     SELECT
       [tilv]
      ,CAST(tilv + ''0101'' AS date) AS tilv_date
      ,[tutkryh]
      ,[suorv]
      ,[suorlk]
      ,[sp]
      ,(CASE WHEN [syntv] = ''19XX'' THEN '''' ELSE [syntv] END) as syntv
      ,[aikielir1]
      ,(CASE WHEN [tutkaskun]=''427'' THEN ''''
 WHEN [tutkaskun]= ''946'' and (tilv= ''2009'' or tilv=''2010'') then ''945''
      WHEN [tutkaskun]= ''198'' THEN ''''
      WHEN [tutkaskun]= ''168'' THEN ''''
	  WHEN [tutkaskun]= ''999'' THEN ''''  ELSE [tutkaskun] END) as tutkaskun
      ,[kansalr1]
      ,[pohjmaa]
      ,[eumaa]
      ,[etamaa]
       ,(CASE  WHEN [tunn] = ''BBBBB'' THEN ''''
      WHEN [tunn] = ''99999'' THEN ''''
      WHEN [tunn] = ''00000'' THEN '''' 
      when [tunn] = ''90009'' AND [tilv] = ''2009'' THEN ''''
      when [tunn] = ''90015'' AND [tilv] = ''2009'' THEN ''''
      when [tunn] = ''90010'' AND [tilv] = ''2009'' THEN ''''
      when [tunn] = ''90018'' AND [tilv] = ''2009'' THEN ''''
      when [tunn] = ''90008'' AND [tilv] = ''2010'' THEN ''''
      when [tunn] = ''90032'' AND [tilv] = ''2010'' THEN ''''
      when [tunn] = ''90032'' AND [tilv] = ''2011'' THEN ''''
      when [tunn] = ''90018'' AND [tilv] = ''2011'' THEN ''''
      when [tunn] = ''90006'' AND [tilv] = ''2009'' THEN ''''
      when [tunn] = ''90006'' AND [tilv] = ''2010'' THEN ''''
      when [tunn] = ''90006'' AND [tilv] = ''2011'' THEN ''''
      when [tunn] = ''90010'' AND [tilv] = ''2010'' THEN ''''
      when [tunn] = ''90010'' AND [tilv] = ''2011'' THEN ''''
      when [tunn] = ''90008'' AND [tilv] = ''2011'' THEN ''''
      when [tunn] = ''90018'' AND [tilv] = ''2010'' THEN ''''
      when [tunn] = ''90018'' AND [tilv] = ''2011'' THEN ''''
        when [tunn] = ''90018'' AND [tilv] = ''2012'' THEN ''''
      ELSE [tunn] END) AS tunn
      ,[jarj]
      ,[kkielir1]
      ,[tutklaja]
      ,[tutktav]
      ,[aikoul]
      ,(CASE WHEN [tutkmaak] = ''99'' THEN '''' ELSE [tutkmaak] END) AS tutkmaak
       ,[luopiskkoulk2004]=''''
      ,[luopisktunn2004]=''''
      ,[luopiskjarj2004]=''''
      ,[luopiskmaak2004] =''''
      ,[ammopiskkoulk2004]=''''
      ,[ammopisktunn2004]=''''
      ,[ammopiskjarj2004]=''''
      ,[ammopiskmaak2004] =''''
      ,[amkopiskkoulk2004]=''''
      ,[amkopisktunn2004]=''''
      ,[amkopiskjarj2004]=''''
      ,[amkopiskmaak2004]=''''
      ,[yoopiskkoulk2004]=''''
      ,[yoopisktunn2004]=''''
      ,[yoopiskjarj2004]=''''
      ,[yoopiskmaak2004]=''''
      ,[monihaku2004]=''''
      ,[ptoim1r4_2004]=''''
      ,[amas_2004]=''''
      ,[luopiskkoulk2005]=''''
      ,[luopisktunn2005]=''''
      ,[luopiskjarj2005]=''''
      ,[luopiskmaak2005]=''''
      ,[ammopiskkoulk2005]=''''
      ,[ammopisktunn2005]=''''
      ,[ammopiskjarj2005]=''''
      ,[ammopiskmaak2005]=''''
      ,[amkopiskkoulk2005]=''''
      ,[amkopisktunn2005]=''''
      ,[amkopiskjarj2005]=''''
      ,[amkopiskmaak2005]=''''
      ,[yoopiskkoulk2005]=''''
      ,[yoopisktunn2005]=''''
      ,[yoopiskjarj2005]=''''
      , [yoopiskmaak2005] =''''
      ,[monihaku2005]=''''
      ,[ptoim1r4_2005]=''''
      ,[amas_2005]=''''
      ,[luopiskkoulk2006]=''''
      ,[luopisktunn2006] = '''' 
      ,[luopiskjarj2006]=''''
      ,[luopiskmaak2006] = ''''
      ,[ammopiskkoulk2006]=''''
      ,[ammopisktunn2006]  = ''''
	  ,[ammopiskjarj2006]=''''
      ,[ammopiskmaak2006] ='''' 
      ,[amkopiskkoulk2006]=''''
      ,[amkopisktunn2006] = ''''    
      ,[amkopiskjarj2006] = ''''
      ,[amkopiskmaak2006] = ''''
      ,[yoopiskkoulk2006]= ''''
      ,[yoopisktunn2006] = '''' 
      ,[yoopiskjarj2006]= ''''
      ,[yoopiskmaak2006] = '''' 
      ,[monihaku2006]=''''
      ,[ptoim1r4_2006]=''''
      ,[amas_2006]=''''
	  ,[luopiskkoulk2007]=''''
      ,[luopisktunn2007] = '''' 
      ,[luopiskjarj2007]=''''
      ,[luopiskmaak2007] = ''''
      ,[ammopiskkoulk2007]=''''
      ,[ammopisktunn2007]  = ''''
	  ,[ammopiskjarj2007]=''''
      ,[ammopiskmaak2007] ='''' 
      ,[amkopiskkoulk2007]=''''
      ,[amkopisktunn2007] = ''''    
      ,[amkopiskjarj2007] = ''''
      ,[amkopiskmaak2007] = ''''
      ,[yoopiskkoulk2007]= ''''
      ,[yoopisktunn2007] = '''' 
      ,[yoopiskjarj2007]= ''''
      ,[yoopiskmaak2007] = '''' 
      ,[monihaku2007]=''''
      ,[ptoim1r4_2007]=''''
      ,[amas_2007]=''''
      ,[luopiskkoulk2008]=''''
      ,[luopisktunn2008] = '''' 
      ,[luopiskjarj2008]=''''
      ,[luopiskmaak2008] = ''''
      ,[ammopiskkoulk2008]=''''
      ,[ammopisktunn2008]  = ''''
	  ,[ammopiskjarj2008]=''''
      ,[ammopiskmaak2008] ='''' 
      ,[amkopiskkoulk2008]=''''
      ,[amkopisktunn2008] = ''''    
      ,[amkopiskjarj2008] = ''''
      ,[amkopiskmaak2008] = ''''
      ,[yoopiskkoulk2008]= ''''
      ,[yoopisktunn2008] = '''' 
      ,[yoopiskjarj2008]= ''''
      ,[yoopiskmaak2008] = '''' 
      ,[monihaku2008]=''''
      ,[ptoim1r4_2008]=''''
      ,[amas_2008]=''''
       ,[luopiskkoulk_2009] as luopiskkoulk2009
      ,(CASE WHEN [luopisktunn_2009] = ''BBBBB'' THEN ''''
      WHEN [luopisktunn_2009] = ''99999'' THEN '''' ELSE [luopisktunn_2009] END) AS luopisktunn2009
      ,[luopiskjarj_2009]
      ,(CASE WHEN [luopiskmaak_2009] = ''99'' THEN '''' ELSE [luopiskmaak_2009] END) AS luopiskmaak2009
      
      ,[ammopiskkoulk_2009] as ammopiskkoulk2009
     ,(CASE WHEN [ammopisktunn_2009]   = ''BBBBB'' THEN ''''
      WHEN [ammopisktunn_2009]    = ''99999'' THEN ''''
      WHEN [ammopisktunn_2009]    = ''00000'' THEN ''''
      when [ammopisktunn_2009]     = ''90009'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2009]     = ''90015'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2009]     = ''90010'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2009]    = ''90018'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2009]    = ''90008'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2009]     = ''90032'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2009]     = ''90032'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2009]     = ''90018'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2009]     = ''90006'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2009]     = ''90006'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2009]     = ''90006'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2009]  = ''90010'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2009]  = ''90010'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2009]  = ''90008'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2009]   = ''90018'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2009]   = ''90018'' AND [tilv] = ''2011'' THEN ''''
        when [ammopisktunn_2009] = ''90018'' AND [tilv] = ''2012'' THEN ''''
      ELSE [ammopisktunn_2009]    END) AS ammopisktunn2009
      ,[ammopiskjarj_2009] as ammopiskjarj2009
      ,(CASE WHEN [ammopiskmaak_2009] = ''99'' THEN '''' ELSE [ammopiskmaak_2009] END) AS ammopiskmaak2009
      ,[amkopiskkoulk_2009] as amkopiskkoulk2009
      ,(CASE WHEN [amkopisktunn_2009] = ''BBBBB'' THEN ''''
       WHEN [amkopisktunn_2009] = ''99999'' THEN '''' ELSE [amkopisktunn_2009] END) AS amkopisktunn2009
      ,[amkopiskjarj_2009] as amkopiskjarj2009
      ,[amkopiskmaak_2009] as amkopiskmaak2009
      ,[yoopiskkoulk_2009] as yoopiskkoulk2009
      ,(CASE WHEN [yoopisktunn_2009] = ''BBBBB'' THEN ''''
      WHEN [yoopisktunn_2009] = ''99999'' THEN '''' ELSE [yoopisktunn_2009] END) AS yoopisktunn2009
      ,[yoopiskjarj_2009] as yoopiskjarj2009
      ,(CASE WHEN [yoopiskmaak_2009] = ''99'' THEN '''' ELSE [yoopiskmaak_2009] END) AS yoopiskmaak2009
      ,[monihaku_2009] as monihaku2009
      ,[ptoim1r4_2009]
      ,[amas_2009]
      
       ,[luopiskkoulk_2010] as luopiskkoulk2010
      ,(CASE WHEN [luopisktunn_2010] = ''BBBBB'' THEN ''''
      WHEN [luopisktunn_2010] = ''99999'' THEN '''' ELSE [luopisktunn_2010] END) AS luopisktunn2010
      ,[luopiskjarj_2010]
      ,(CASE WHEN [luopiskmaak_2010] = ''99'' THEN '''' ELSE [luopiskmaak_2010] END) AS luopiskmaak2010
      
      ,[ammopiskkoulk_2010] as ammopiskkoulk2010
      ,(CASE WHEN [ammopisktunn_2010]   = ''BBBBB'' THEN ''''
      WHEN [ammopisktunn_2010]    = ''99999'' THEN ''''
      WHEN [ammopisktunn_2010]    = ''00000'' THEN ''''
      when [ammopisktunn_2010]     = ''90009'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2010]     = ''90015'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2010]     = ''90010'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2010]    = ''90018'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2010]    = ''90008'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2010]     = ''90032'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2010]     = ''90032'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2010]     = ''90018'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2010]     = ''90006'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2010]     = ''90006'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2010]     = ''90006'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2010]  = ''90010'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2010]  = ''90010'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2010]  = ''90008'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2010]   = ''90018'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2010]   = ''90018'' AND [tilv] = ''2011'' THEN ''''
        when [ammopisktunn_2010] = ''90018'' AND [tilv] = ''2012'' THEN ''''
      ELSE [ammopisktunn_2010]    END) AS ammopisktunn2010
      ,[ammopiskjarj_2010] as ammopiskjarj2010
      ,(CASE WHEN [ammopiskmaak_2010] = ''99'' THEN '''' ELSE [ammopiskmaak_2010] END) AS ammopiskmaak2010
      
      ,[amkopiskkoulk_2010] as amkopiskkoulk2010
      ,(CASE WHEN [amkopisktunn_2010] = ''BBBBB'' THEN ''''
       WHEN [amkopisktunn_2010] = ''99999'' THEN '''' ELSE [amkopisktunn_2010] END) AS amkopisktunn2010
      ,[amkopiskjarj_2010] as amkopiskjarj2010
      ,[amkopiskmaak_2010] as amkopiskmaak2010
      
      ,[yoopiskkoulk_2010] as yoopiskkoulk2010
      ,(CASE WHEN [yoopisktunn_2010] = ''BBBBB'' THEN ''''
      WHEN [yoopisktunn_2010] = ''99999'' THEN '''' ELSE [yoopisktunn_2010] END) AS yoopisktunn2010
      ,[yoopiskjarj_2010] as yoopiskjarj2010
      ,(CASE WHEN [yoopiskmaak_2010] = ''99'' THEN '''' ELSE [yoopiskmaak_2010] END) AS yoopiskmaak2010
      ,[monihaku_2010] as monihaku2010
      ,[ptoim1r4_2010] 
      ,[amas_2010]
      
      ,[luopiskkoulk_2011] as luopiskkoulk2011
      ,(CASE WHEN [luopisktunn_2011] = ''BBBBB'' THEN ''''
      WHEN [luopisktunn_2011] = ''99999'' THEN '''' ELSE [luopisktunn_2011] END) AS luopisktunn2011
      ,[luopiskjarj_2011] as luopiskjarj2011
      ,(CASE WHEN [luopiskmaak_2011] = ''99'' THEN '''' ELSE [luopiskmaak_2011] END) AS luopiskmaak2011
      
      ,[ammopiskkoulk_2011] as ammopiskkoulk2011
      ,(CASE WHEN [ammopisktunn_2011]   = ''BBBBB'' THEN '''' 
      WHEN [ammopisktunn_2011]    = ''99999'' THEN '''' 
      WHEN [ammopisktunn_2011]    = ''00000'' THEN '''' 
      when [ammopisktunn_2011]     = ''90009'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2011]     = ''90015'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2011]     = ''90010'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2011]    = ''90018'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2011]    = ''90008'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2011]     = ''90032'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2011]     = ''90032'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2011]     = ''90018'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2011]     = ''90006'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2011]     = ''90006'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2011]     = ''90006'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2011]  = ''90010'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2011]  = ''90010'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2011]  = ''90008'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2011]   = ''90018'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2011]   = ''90018'' AND [tilv] = ''2011'' THEN ''''
        when [ammopisktunn_2011] = ''90018'' AND [tilv] = ''2012'' THEN ''''
      ELSE [ammopisktunn_2011]    END) AS ammopisktunn2011 
      ,[ammopiskjarj_2011] as ammopiskjarj2011
      ,(CASE WHEN [ammopiskmaak_2011] = ''99'' THEN '''' ELSE [ammopiskmaak_2011] END) AS ammopiskmaak2011
      
      ,[amkopiskkoulk_2011] as amkopiskkoulk2011
      ,(CASE WHEN [amkopisktunn_2011] = ''BBBBB'' THEN ''''
       WHEN [amkopisktunn_2011] = ''99999'' THEN '''' ELSE [amkopisktunn_2011] END) AS amkopisktunn2011
      ,[amkopiskjarj_2011] as amkopiskjarj2011
      ,(CASE WHEN [amkopiskmaak_2011] = ''99'' THEN '''' ELSE [amkopiskmaak_2011] END) AS amkopiskmaak2011
      
      ,[yoopiskkoulk_2011] as yoopiskkoulk2011
      ,(CASE WHEN [yoopisktunn_2011] = ''BBBBB'' THEN ''''
      WHEN [yoopisktunn_2011] = ''99999'' THEN '''' ELSE [yoopisktunn_2011] END) AS yoopisktunn2011
      ,[yoopiskjarj_2011] as yoopiskjarj2011
      ,(CASE WHEN [yoopiskmaak_2011] = ''99'' THEN '''' ELSE [yoopiskmaak_2011] END) AS yoopiskmaak2011
      ,[monihaku_2011] as monihaku2011
      ,[ptoim1r4_2011]
      ,[amas_2011]
      
       ,[luopiskkoulk_2012] as luopiskkoulk2012
      ,(CASE WHEN [luopisktunn_2012] = ''BBBBB'' THEN ''''
      WHEN [luopisktunn_2012] = ''99999'' THEN '''' ELSE [luopisktunn_2012] END) AS luopisktunn2012
      ,[luopiskjarj_2012] as luopiskjarj2012
      ,(CASE WHEN [luopiskmaak_2012] = ''99'' THEN '''' ELSE ([luopiskmaak_2012]) END) AS luopiskmaak2012
      
      ,[ammopiskkoulk_2012] as ammopiskkoulk2012
      ,(CASE WHEN [ammopisktunn_2012]   = ''BBBBB'' THEN '''' 
      WHEN [ammopisktunn_2012]    = ''99999'' THEN '''' 
      WHEN [ammopisktunn_2012]    = ''00000'' THEN '''' 
      when [ammopisktunn_2012]     = ''90009'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2012]     = ''90015'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2012]     = ''90010'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2012]    = ''90018'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2012]    = ''90008'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2012]     = ''90032'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2012]     = ''90032'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2012]     = ''90018'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2012]     = ''90006'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2012]     = ''90006'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2012]     = ''90006'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2012]  = ''90010'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2012]  = ''90010'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2012]  = ''90008'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2012]   = ''90018'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2012]   = ''90018'' AND [tilv] = ''2011'' THEN ''''
        when [ammopisktunn_2012] = ''90018'' AND [tilv] = ''2012'' THEN ''''
      ELSE [ammopisktunn_2012]    END) AS ammopisktunn2012 
      ,[ammopiskjarj_2012] as ammopiskjarj2012
      ,(CASE WHEN [ammopiskmaak_2012] = ''99'' THEN ''''
       ELSE [ammopiskmaak_2012] END) AS ammopiskmaak2012
      ,[amkopiskkoulk_2012] as amkopiskkoulk2012
      ,(CASE WHEN [amkopisktunn_2012] = ''BBBBB'' THEN ''''
       WHEN [amkopisktunn_2012] = ''99999'' THEN '''' ELSE [amkopisktunn_2012] END) AS amkopisktunn2012
      ,[amkopiskjarj_2012] as amkopiskjarj2012
      ,(CASE WHEN [amkopiskmaak_2012] = ''99'' THEN '''' ELSE [amkopiskmaak_2012] END) AS amkopiskmaak2012
      
      ,[yoopiskkoulk_2012] as yoopiskkoulk2012
      ,(CASE WHEN [yoopisktunn_2012] = ''BBBBB'' THEN ''''
      WHEN [yoopisktunn_2012] = ''99999'' THEN '''' ELSE [yoopisktunn_2012] END) AS yoopisktunn2012
      ,[yoopiskjarj_2012] as yoopiskjarj2012
      ,(CASE WHEN [yoopiskmaak_2012] = ''99'' THEN '''' ELSE [yoopiskmaak_2012] END) AS yoopiskmaak2012
      ,[monihaku_2012] as monihaku2012
      ,[ptoim1r4_2012]
      ,[amas_2012]
	  
	   ,[luopiskkoulk_2013] as luopiskkoulk2013
      ,(CASE WHEN [luopisktunn_2013] = ''BBBBB'' THEN ''''
      WHEN [luopisktunn_2013] = ''99999'' THEN '''' ELSE [luopisktunn_2013] END) AS luopisktunn2013
      ,[luopiskjarj_2013] as luopiskjarj2013
      ,(CASE WHEN [luopiskmaak_2013] = ''99'' THEN '''' ELSE ([luopiskmaak_2013]) END) AS luopiskmaak2013
      
      ,[ammopiskkoulk_2013] as ammopiskkoulk2013
      ,(CASE WHEN [ammopisktunn_2013]   = ''BBBBB'' THEN '''' 
      WHEN [ammopisktunn_2013]    = ''99999'' THEN '''' 
      WHEN [ammopisktunn_2013]    = ''00000'' THEN '''' 
      when [ammopisktunn_2013]     = ''90009'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2013]     = ''90015'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2013]     = ''90010'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2013]    = ''90018'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2013]    = ''90008'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2013]     = ''90032'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2013]     = ''90032'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2013]     = ''90018'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2013]     = ''90006'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2013]     = ''90006'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2013]     = ''90006'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2013]  = ''90010'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2013]  = ''90010'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2013]  = ''90008'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2013]   = ''90018'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2013]   = ''90018'' AND [tilv] = ''2011'' THEN ''''
        when [ammopisktunn_2013] = ''90018'' AND [tilv] = ''2012'' THEN ''''
      ELSE [ammopisktunn_2013]    END) AS ammopisktunn2013 
      ,[ammopiskjarj_2013] as ammopiskjarj2013
      ,(CASE WHEN [ammopiskmaak_2013] = ''99'' THEN ''''
       ELSE [ammopiskmaak_2013] END) AS ammopiskmaak2013
      ,[amkopiskkoulk_2013] as amkopiskkoulk2013
      ,(CASE WHEN [amkopisktunn_2013] = ''BBBBB'' THEN ''''
       WHEN [amkopisktunn_2013] = ''99999'' THEN '''' ELSE [amkopisktunn_2013] END) AS amkopisktunn2013
      ,[amkopiskjarj_2013] as amkopiskjarj2013
      ,(CASE WHEN [amkopiskmaak_2013] = ''99'' THEN '''' ELSE [amkopiskmaak_2013] END) AS amkopiskmaak2013
      
      ,[yoopiskkoulk_2013] as yoopiskkoulk2013
      ,(CASE WHEN [yoopisktunn_2013] = ''BBBBB'' THEN ''''
      WHEN [yoopisktunn_2013] = ''99999'' THEN '''' ELSE [yoopisktunn_2013] END) AS yoopisktunn2013
      ,[yoopiskjarj_2013] as yoopiskjarj2013
      ,(CASE WHEN [yoopiskmaak_2013] = ''99'' THEN '''' ELSE [yoopiskmaak_2013] END) AS yoopiskmaak2013
      ,[monihaku_2013] as monihaku2013
      ,[ptoim1r4_2013]
      ,[amas_2013]
      ,[luopiskkoulk_2014] as luopiskkoulk2014
      ,(CASE WHEN [luopisktunn_2014] = ''BBBBB'' THEN ''''
      WHEN [luopisktunn_2014] = ''99999'' THEN '''' ELSE [luopisktunn_2014] END) AS luopisktunn2014
      ,[luopiskjarj_2014] as luopiskjarj2014
      ,(CASE WHEN [luopiskmaak_2014] = ''99'' THEN '''' ELSE ([luopiskmaak_2014]) END) AS luopiskmaak2014
      
      ,[ammopiskkoulk_2014] as ammopiskkoulk2014
      ,(CASE WHEN [ammopisktunn_2014]   = ''BBBBB'' THEN '''' 
      WHEN [ammopisktunn_2014]    = ''99999'' THEN '''' 
      WHEN [ammopisktunn_2014]    = ''00000'' THEN '''' 
      when [ammopisktunn_2014]     = ''90009'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2014]     = ''90015'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2014]     = ''90010'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2014]    = ''90018'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2014]    = ''90008'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2014]     = ''90032'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2014]     = ''90032'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2014]     = ''90018'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2014]     = ''90006'' AND [tilv] = ''2009'' THEN ''''
      when [ammopisktunn_2014]     = ''90006'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2014]     = ''90006'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2014]  = ''90010'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2014]  = ''90010'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2014]  = ''90008'' AND [tilv] = ''2011'' THEN ''''
      when [ammopisktunn_2014]   = ''90018'' AND [tilv] = ''2010'' THEN ''''
      when [ammopisktunn_2014]   = ''90018'' AND [tilv] = ''2011'' THEN ''''
        when [ammopisktunn_2014] = ''90018'' AND [tilv] = ''2012'' THEN ''''
      ELSE [ammopisktunn_2014]    END) AS ammopisktunn2014 
      ,[ammopiskjarj_2014] as ammopiskjarj2014
      ,(CASE WHEN [ammopiskmaak_2014] = ''99'' THEN ''''
       ELSE [ammopiskmaak_2014] END) AS ammopiskmaak2014
      ,[amkopiskkoulk_2014] as amkopiskkoulk2014
      ,(CASE WHEN [amkopisktunn_2014] = ''BBBBB'' THEN ''''
       WHEN [amkopisktunn_2014] = ''99999'' THEN '''' ELSE [amkopisktunn_2014] END) AS amkopisktunn2014
      ,[amkopiskjarj_2014] as amkopiskjarj2014
      ,(CASE WHEN [amkopiskmaak_2014] = ''99'' THEN '''' ELSE [amkopiskmaak_2014] END) AS amkopiskmaak2014
      
      ,[yoopiskkoulk_2014] as yoopiskkoulk2014
      ,(CASE WHEN [yoopisktunn_2014] = ''BBBBB'' THEN ''''
      WHEN [yoopisktunn_2014] = ''99999'' THEN '''' ELSE [yoopisktunn_2014] END) AS yoopisktunn2014
      ,[yoopiskjarj_2014] as yoopiskjarj2014
      ,(CASE WHEN [yoopiskmaak_2014] = ''99'' THEN '''' ELSE [yoopiskmaak_2014] END) AS yoopiskmaak2014
      ,[monihaku_2014] as monihaku2014
      ,[ptoim1r4_2014]
      ,[amas_2014]
	  ,[lkm]
	  ,[pohjkoul]
      ,[tietolahde]=''K3_13_sopv_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_K3_13_sopv_16]

   ) Aineistot









' 
GO
/****** Object:  View [dbo].[v_sa_2_1_Peruskoulutiedosto]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_2_1_Peruskoulutiedosto]'))
EXEC dbo.sp_executesql @statement = N'
CREATE VIEW [dbo].[v_sa_2_1_Peruskoulutiedosto] AS
/*
Drop table VipunenTK_DW.[dbo].[f_2_1_Peruskoulutiedosto]

truncate table VipunenTK_DW.[dbo].[f_2_1_Peruskoulutiedosto]
insert into VipunenTK_DW.[dbo].[f_2_1_Peruskoulutiedosto] select * from [v_sa_2_1_Peruskoulutiedosto]

Select * from [v_sa_2_1_Peruskoulutiedosto]
*/

SELECT [tilv] = CAST(tilv as nvarchar(4))
	  ,[tilv_date] = Cast(tilv+''0101'' as date)
      ,[jarj] = CAST(jarj as nvarchar(10))
      ,[tunn] = CAST(tunn as nvarchar(5))

      ,[kev1] = Cast([kev1] as int)
      ,[kev1n] = Cast([kev1n] as int)
      ,[kev2] = Cast([kev2] as int)
      ,[kev2n] = Cast([kev2n] as int)
      ,[kev3] = Cast([kev3] as int)
      ,[kev3n] = Cast([kev3n] as int)
      ,[kev4] = Cast([kev4] as int)
      ,[kev4n] = Cast([kev4n] as int)
      ,[kev5] = Cast([kev5] as int)
      ,[kev5n] = Cast([kev5n] as int)
      ,[kev6] = Cast([kev6] as int)
      ,[kev6n] = Cast([kev6n] as int)
      ,[kev7] = Cast([kev7] as int)
      ,[kev7n] = Cast([kev7n] as int)
      ,[kev8] = Cast([kev8] as int)
      ,[kev8n] = Cast([kev8n] as int)
      ,[kev9] = Cast([kev9] as int)
      ,[kev9n] = Cast([kev9n] as int)
      ,[kev] = Cast([kev] as int)
      ,[kevn] = Cast([kevn] as int)
      ,[luok1] = Cast([luok1] as int)
      ,[luok1n] = Cast([luok1n] as int)
      ,[luok2] = Cast([luok2] as int)
      ,[luok2n] = Cast([luok2n] as int)
      ,[luok3] = Cast([luok3] as int)
      ,[luok3n] = Cast([luok3n] as int)
      ,[luok4] = Cast([luok4] as int)
      ,[luok4n] = Cast([luok4n] as int)
      ,[luok5] = Cast([luok5] as int)
      ,[luok5n] = Cast([luok5n] as int)
      ,[luok6] = Cast([luok6] as int)
      ,[luok6n] = Cast([luok6n] as int)
      ,[luok7] = Cast([luok7] as int)
      ,[luok7n] = Cast([luok7n] as int)
      ,[luok8] = Cast([luok8] as int)
      ,[luok8n] = Cast([luok8n] as int)
      ,[luok9] = Cast([luok9] as int)
      ,[luok9n] = Cast([luok9n] as int)
      ,[luok] = Cast([luok] as int)
      ,[luokn] = Cast([luokn] as int)
      ,[laim] = Cast([laim] as int)
      ,[laimn] = Cast([laimn] as int)
      ,[erotod] = Cast([erotod] as int)
      ,[erotodn] = Cast([erotodn] as int)
      ,[eitod] = Cast([eitod] as int)
      ,[eitodn] = Cast([eitodn] as int)
      ,[tod] = Cast([tod] as int)
      ,[todn] = Cast([todn] as int)
      ,[tutkt] = Cast([tutkt] as int)
      ,[tutktn] = Cast([tutktn] as int)
      ,[suor10] = Cast([suor10] as int)
      ,[suor10n] = Cast([suor10n] as int)
      ,[ove] = Cast([ove] as int)
      ,[oven] = Cast([oven] as int)
      ,[ov1] = Cast([ov1] as int)
      ,[ov1n] = Cast([ov1n] as int)
      ,[ov2] = Cast([ov2] as int)
      ,[ov2n] = Cast([ov2n] as int)
      ,[ov3] = Cast([ov3] as int)
      ,[ov3n] = Cast([ov3n] as int)
      ,[ov4] = Cast([ov4] as int)
      ,[ov4n] = Cast([ov4n] as int)
      ,[ov5] = Cast([ov5] as int)
      ,[ov5n] = Cast([ov5n] as int)
      ,[ov6] = Cast([ov6] as int)
      ,[ov6n] = Cast([ov6n] as int)
      ,[ov7] = Cast([ov7] as int)
      ,[ov7n] = Cast([ov7n] as int)
      ,[ov8] = Cast([ov8] as int)
      ,[ov8n] = Cast([ov8n] as int)
      ,[ov9] = Cast([ov9] as int)
      ,[ov9n] = Cast([ov9n] as int)
      ,[ov10] = Cast([ov10] as int)
      ,[ov10n] = Cast([ov10n] as int)
      ,[ovy] = Cast([ovy] as int)
      ,[ovyn] = Cast([ovyn] as int)
      ,[eroppe] = Cast([eroppe] as int)
      ,[eropp1] = Cast([eropp1] as int)
      ,[eropp2] = Cast([eropp2] as int)
      ,[eropp3] = Cast([eropp3] as int)
      ,[eropp4] = Cast([eropp4] as int)
      ,[eropp5] = Cast([eropp5] as int)
      ,[eropp6] = Cast([eropp6] as int)
      ,[eropp7] = Cast([eropp7] as int)
      ,[eropp8] = Cast([eropp8] as int)
      ,[eropp9] = Cast([eropp9] as int)
      ,[eropp0] = Cast([eropp0] as int)
      ,[eropp] = Cast([eropp] as int)
      ,[vaikvame] = Cast([vaikvame] as int)
      ,[vaikvam1] = Cast([vaikvam1] as int)
      ,[vaikvam2] = Cast([vaikvam2] as int)
      ,[vaikvam3] = Cast([vaikvam3] as int)
      ,[vaikvam4] = Cast([vaikvam4] as int)
      ,[vaikvam5] = Cast([vaikvam5] as int)
      ,[vaikvam6] = Cast([vaikvam6] as int)
      ,[vaikvam7] = Cast([vaikvam7] as int)
      ,[vaikvam8] = Cast([vaikvam8] as int)
      ,[vaikvam9] = Cast([vaikvam9] as int)
      ,[vaikvam0] = Cast([vaikvam0] as int)
      ,[vaikvam] = Cast([vaikvam] as int)
      ,[muuvame] = Cast([muuvame] as int)
      ,[muuvam1] = Cast([muuvam1] as int)
      ,[muuvam2] = Cast([muuvam2] as int)
      ,[muuvam3] = Cast([muuvam3] as int)
      ,[muuvam4] = Cast([muuvam4] as int)
      ,[muuvam5] = Cast([muuvam5] as int)
      ,[muuvam6] = Cast([muuvam6] as int)
      ,[muuvam7] = Cast([muuvam7] as int)
      ,[muuvam8] = Cast([muuvam8] as int)
      ,[muuvam9] = Cast([muuvam9] as int)
      ,[muuvam0] = Cast([muuvam0] as int)
      ,[muuvam] = Cast([muuvam] as int)
      ,[opksu] = Cast([opksu] as int)
      ,[opkru] = Cast([opkru] as int)
      ,[opksaa] = Cast([opksaa] as int)
      ,[opkmuu] = Cast([opkmuu] as int)
      ,[opky] = Cast([opky] as int)
      ,[kiele] = Cast([kiele] as int)
      ,[kiele9] = Cast([kiele9] as int)
      ,[kiele11v] = Cast([kiele11v] as int)
      ,[kiele11m] = Cast([kiele11m] as int)
      ,[kielk] = Cast([kielk] as int)
      ,[kielk9] = Cast([kielk9] as int)
      ,[kielk11v] = Cast([kielk11v] as int)
      ,[kielk11m] = Cast([kielk11m] as int)
      ,[kulje] = Cast([kulje] as int)
      ,[kulje9] = Cast([kulje9] as int)
      ,[kulje11v] = Cast([kulje11v] as int)
      ,[kulje11m] = Cast([kulje11m] as int)
      ,[kuljk] = Cast([kuljk] as int)
      ,[kuljk9] = Cast([kuljk9] as int)
      ,[kuljk11v] = Cast([kuljk11v] as int)
      ,[kuljk11m] = Cast([kuljk11m] as int)
      ,[maje] = Cast([maje] as int)
      ,[maje9] = Cast([maje9] as int)
      ,[maje11v] = Cast([maje11v] as int)
      ,[maje11m] = Cast([maje11m] as int)
      ,[majk] = Cast([majk] as int)
      ,[majk9] = Cast([majk9] as int)
      ,[majk11v] = Cast([majk11v] as int)
      ,[majk11m] = Cast([majk11m] as int)
      ,[lykk] = Cast([lykk] as int)
      ,[lykkn] = Cast([lykkn] as int)
      ,[kotona] = Cast([kotona] as int)
      ,[kotonan] = Cast([kotonan] as int)
      ,[ulkom] = Cast([ulkom] as int)
      ,[ulkomn] = Cast([ulkomn] as int)
      ,[ika5e] = Cast([ika5e] as int)
      ,[ika5en] = Cast([ika5en] as int)
      ,[ika6e] = Cast([ika6e] as int)
      ,[ika6en] = Cast([ika6en] as int)
      ,[ika61] = Cast([ika61] as int)
      ,[ika61n] = Cast([ika61n] as int)
      ,[ika7e] = Cast([ika7e] as int)
      ,[ika7en] = Cast([ika7en] as int)
      ,[ika71] = Cast([ika71] as int)
      ,[ika71n] = Cast([ika71n] as int)
      ,[ika81] = Cast([ika81] as int)
      ,[ika81n] = Cast([ika81n] as int)
      ,[ika91] = Cast([ika91] as int)
      ,[ika91n] = Cast([ika91n] as int)
      ,[ikae] = Cast([ikae] as int)
      ,[ikaen] = Cast([ikaen] as int)
      ,[ika1] = Cast([ika1] as int)
      ,[ika1n] = Cast([ika1n] as int)
      ,[oeriy] = Cast([oeriy] as int)
      ,[kokint0] = Cast([kokint0] as int)
      ,[kokint1] = Cast([kokint1] as int)
      ,[kokint2] = Cast([kokint2] as int)
      ,[kokint3] = Cast([kokint3] as int)
      ,[kokint4] = Cast([kokint4] as int)
      ,[kokint5] = Cast([kokint5] as int)
      ,[kokint6] = Cast([kokint6] as int)
      ,[kokint7] = Cast([kokint7] as int)
      ,[kokint8] = Cast([kokint8] as int)
      ,[kokint9] = Cast([kokint9] as int)
      ,[kokint10] = Cast([kokint10] as int)
      ,[kokint] = Cast([kokint] as int)
      ,[kokintn] = Cast([kokintn] as int)
      ,[osint0] = Cast([osint0] as int)
      ,[osint1] = Cast([osint1] as int)
      ,[osint2] = Cast([osint2] as int)
      ,[osint3] = Cast([osint3] as int)
      ,[osint4] = Cast([osint4] as int)
      ,[osint5] = Cast([osint5] as int)
      ,[osint6] = Cast([osint6] as int)
      ,[osint7] = Cast([osint7] as int)
      ,[osint8] = Cast([osint8] as int)
      ,[osint9] = Cast([osint9] as int)
      ,[osint10] = Cast([osint10] as int)
      ,[osint] = Cast([osint] as int)
      ,[osintn] = Cast([osintn] as int)
      ,[eritlk0] = Cast([eritlk0] as int)
      ,[eritlk1] = Cast([eritlk1] as int)
      ,[eritlk2] = Cast([eritlk2] as int)
      ,[eritlk3] = Cast([eritlk3] as int)
      ,[eritlk4] = Cast([eritlk4] as int)
      ,[eritlk5] = Cast([eritlk5] as int)
      ,[eritlk6] = Cast([eritlk6] as int)
      ,[eritlk7] = Cast([eritlk7] as int)
      ,[eritlk8] = Cast([eritlk8] as int)
      ,[eritlk9] = Cast([eritlk9] as int)
      ,[eritlk10] = Cast([eritlk10] as int)
      ,[eritlk] = Cast([eritlk] as int)
      ,[eritlkn] = Cast([eritlkn] as int)
      ,[int0] = Cast([int0] as int)
      ,[int1] = Cast([int1] as int)
      ,[int2] = Cast([int2] as int)
      ,[int3] = Cast([int3] as int)
      ,[int4] = Cast([int4] as int)
      ,[int5] = Cast([int5] as int)
      ,[int6] = Cast([int6] as int)
      ,[int7] = Cast([int7] as int)
      ,[int8] = Cast([int8] as int)
      ,[int9] = Cast([int9] as int)
      ,[int10] = Cast([int10] as int)
      ,[inty] = Cast([inty] as int)
      ,[intyn] = Cast([intyn] as int)
      ,[int0n] = Cast([int0n] as int)
      ,[int1n] = Cast([int1n] as int)
      ,[int2n] = Cast([int2n] as int)
      ,[int3n] = Cast([int3n] as int)
      ,[int4n] = Cast([int4n] as int)
      ,[int5n] = Cast([int5n] as int)
      ,[int6n] = Cast([int6n] as int)
      ,[int7n] = Cast([int7n] as int)
      ,[int8n] = Cast([int8n] as int)
      ,[int9n] = Cast([int9n] as int)
      ,[int10n] = Cast([int10n] as int)
      ,[intn] = Cast([intn] as int)
      ,[aev] = Cast([aev] as int)
      ,[yev] = Cast([yev] as int)
      ,[ev] = Cast([ev] as int)
      ,[aort] = Cast([aort] as int)
      ,[yort] = Cast([yort] as int)
      ,[ort] = Cast([ort] as int)
      ,[aet] = Cast([aet] as int)
      ,[yet] = Cast([yet] as int)
      ,[et] = Cast([et] as int)
      ,[amu] = Cast([amu] as int)
      ,[ymu] = Cast([ymu] as int)
      ,[mu] = Cast([mu] as int)
      ,[aeos] = Cast([aeos] as int)
      ,[yeos] = Cast([yeos] as int)
      ,[eos] = Cast([eos] as int)
      ,[akay] = Cast([akay] as int)
      ,[ykay] = Cast([ykay] as int)
      ,[kay] = Cast([kay] as int)
      ,[asv] = Cast([asv] as int)
      ,[ysv] = Cast([ysv] as int)
      ,[sv] = Cast([sv] as int)
      ,[arv] = Cast([arv] as int)
      ,[yrv] = Cast([yrv] as int)
      ,[rv] = Cast([rv] as int)
      ,[asvrv] = Cast([asvrv] as int)
      ,[ysvrv] = Cast([ysvrv] as int)
      ,[svrv] = Cast([svrv] as int)
      ,[eng1] = Cast([eng1] as int)
      ,[eng2] = Cast([eng2] as int)
      ,[eng3] = Cast([eng3] as int)
      ,[eng4] = Cast([eng4] as int)
      ,[eng5] = Cast([eng5] as int)
      ,[eng6] = Cast([eng6] as int)
      ,[eny] = Cast([eny] as int)
      ,[enn] = Cast([enn] as int)
      ,[ru1] = Cast([ru1] as int)
      ,[ru2] = Cast([ru2] as int)
      ,[ru3] = Cast([ru3] as int)
      ,[ru4] = Cast([ru4] as int)
      ,[ru5] = Cast([ru5] as int)
      ,[ru6] = Cast([ru6] as int)
      ,[ruy] = Cast([ruy] as int)
      ,[run] = Cast([run] as int)
      ,[su1] = Cast([su1] as int)
      ,[su2] = Cast([su2] as int)
      ,[su3] = Cast([su3] as int)
      ,[su4] = Cast([su4] as int)
      ,[su5] = Cast([su5] as int)
      ,[su6] = Cast([su6] as int)
      ,[suy] = Cast([suy] as int)
      ,[sun] = Cast([sun] as int)
      ,[ra1] = Cast([ra1] as int)
      ,[ra2] = Cast([ra2] as int)
      ,[ra3] = Cast([ra3] as int)
      ,[ra4] = Cast([ra4] as int)
      ,[ra5] = Cast([ra5] as int)
      ,[ra6] = Cast([ra6] as int)
      ,[ray] = Cast([ray] as int)
      ,[ran] = Cast([ran] as int)
      ,[sa1] = Cast([sa1] as int)
      ,[sa2] = Cast([sa2] as int)
      ,[sa3] = Cast([sa3] as int)
      ,[sa4] = Cast([sa4] as int)
      ,[sa5] = Cast([sa5] as int)
      ,[sa6] = Cast([sa6] as int)
      ,[say] = Cast([say] as int)
      ,[san] = Cast([san] as int)
      ,[ve1] = Cast([ve1] as int)
      ,[ve2] = Cast([ve2] as int)
      ,[ve3] = Cast([ve3] as int)
      ,[ve4] = Cast([ve4] as int)
      ,[ve5] = Cast([ve5] as int)
      ,[ve6] = Cast([ve6] as int)
      ,[vey] = Cast([vey] as int)
      ,[ven] = Cast([ven] as int)
      ,[saa1] = Cast([saa1] as int)
      ,[saa2] = Cast([saa2] as int)
      ,[saa3] = Cast([saa3] as int)
      ,[saa4] = Cast([saa4] as int)
      ,[saa5] = Cast([saa5] as int)
      ,[saa6] = Cast([saa6] as int)
      ,[saay] = Cast([saay] as int)
      ,[saan] = Cast([saan] as int)
      ,[mu1] = Cast([mu1] as int)
      ,[mu2] = Cast([mu2] as int)
      ,[mu3] = Cast([mu3] as int)
      ,[mu4] = Cast([mu4] as int)
      ,[mu5] = Cast([mu5] as int)
      ,[mu6] = Cast([mu6] as int)
      ,[muy] = Cast([muy] as int)
      ,[mun] = Cast([mun] as int)
      ,[eopis1] = Cast([eopis1] as int)
      ,[eopis2] = Cast([eopis2] as int)
      ,[eopis3] = Cast([eopis3] as int)
      ,[eopis4] = Cast([eopis4] as int)
      ,[eopis5] = Cast([eopis5] as int)
      ,[eopis6] = Cast([eopis6] as int)
      ,[eopisy] = Cast([eopisy] as int)
      ,[eopisn] = Cast([eopisn] as int)
      ,[yht1] = Cast([yht1] as int)
      ,[yht2] = Cast([yht2] as int)
      ,[yht3] = Cast([yht3] as int)
      ,[yht4] = Cast([yht4] as int)
      ,[yht5] = Cast([yht5] as int)
      ,[yht6] = Cast([yht6] as int)
      ,[yht] = Cast([yht] as int)
      ,[tyt] = Cast([tyt] as int)
      ,[ven1] = Cast([ven1] as int)
      ,[ven2] = Cast([ven2] as int)
      ,[ven3] = Cast([ven3] as int)
      ,[ven4] = Cast([ven4] as int)
      ,[ven5] = Cast([ven5] as int)
      ,[ven6] = Cast([ven6] as int)
      ,[veny] = Cast([veny] as int)
      ,[venn] = Cast([venn] as int)
      ,[vru1] = Cast([vru1] as int)
      ,[vru2] = Cast([vru2] as int)
      ,[vru3] = Cast([vru3] as int)
      ,[vru4] = Cast([vru4] as int)
      ,[vru5] = Cast([vru5] as int)
      ,[vru6] = Cast([vru6] as int)
      ,[vruy] = Cast([vruy] as int)
      ,[vsu1] = Cast([vsu1] as int)
      ,[vsu2] = Cast([vsu2] as int)
      ,[vsu3] = Cast([vsu3] as int)
      ,[vsu4] = Cast([vsu4] as int)
      ,[vsu5] = Cast([vsu5] as int)
      ,[vsu6] = Cast([vsu6] as int)
      ,[vsuy] = Cast([vsuy] as int)
      ,[vsun] = Cast([vsun] as int)
      ,[vrun] = Cast([vrun] as int)
      ,[vra1] = Cast([vra1] as int)
      ,[vra2] = Cast([vra2] as int)
      ,[vra3] = Cast([vra3] as int)
      ,[vra4] = Cast([vra4] as int)
      ,[vra5] = Cast([vra5] as int)
      ,[vra6] = Cast([vra6] as int)
      ,[vray] = Cast([vray] as int)
      ,[vran] = Cast([vran] as int)
      ,[vsa1] = Cast([vsa1] as int)
      ,[vsa2] = Cast([vsa2] as int)
      ,[vsa3] = Cast([vsa3] as int)
      ,[vsa4] = Cast([vsa4] as int)
      ,[vsa5] = Cast([vsa5] as int)
      ,[vsa6] = Cast([vsa6] as int)
      ,[vsay] = Cast([vsay] as int)
      ,[vsan] = Cast([vsan] as int)
      ,[vve1] = Cast([vve1] as int)
      ,[vve2] = Cast([vve2] as int)
      ,[vve3] = Cast([vve3] as int)
      ,[vve4] = Cast([vve4] as int)
      ,[vve5] = Cast([vve5] as int)
      ,[vve6] = Cast([vve6] as int)
      ,[vvey] = Cast([vvey] as int)
      ,[vven] = Cast([vven] as int)
      ,[vsaa1] = Cast([vsaa1] as int)
      ,[vsaa2] = Cast([vsaa2] as int)
      ,[vsaa3] = Cast([vsaa3] as int)
      ,[vsaa4] = Cast([vsaa4] as int)
      ,[vsaa5] = Cast([vsaa5] as int)
      ,[vsaa6] = Cast([vsaa6] as int)
      ,[vsaay] = Cast([vsaay] as int)
      ,[vsaan] = Cast([vsaan] as int)
      ,[vmu1] = Cast([vmu1] as int)
      ,[vmu2] = Cast([vmu2] as int)
      ,[vmu3] = Cast([vmu3] as int)
      ,[vmu4] = Cast([vmu4] as int)
      ,[vmu5] = Cast([vmu5] as int)
      ,[vmu6] = Cast([vmu6] as int)
      ,[vmuy] = Cast([vmuy] as int)
      ,[vmun] = Cast([vmun] as int)
      ,[vyht1] = Cast([vyht1] as int)
      ,[vyht2] = Cast([vyht2] as int)
      ,[vyht3] = Cast([vyht3] as int)
      ,[vyht4] = Cast([vyht4] as int)
      ,[vyht5] = Cast([vyht5] as int)
      ,[vyht6] = Cast([vyht6] as int)
      ,[vyht] = Cast([vyht] as int)
      ,[vtyt] = Cast([vtyt] as int)
      ,[kieli0] = Cast([kieli0] as int)
      ,[kieli1] = Cast([kieli1] as int)
      ,[kieli2] = Cast([kieli2] as int)
      ,[kieli3] = Cast([kieli3] as int)
      ,[kieli4] = Cast([kieli4] as int)
      ,[kieliy] = Cast([kieliy] as int)
      ,[yaen1m] = Cast([yaen1m] as int)
      ,[yyenm] = Cast([yyenm] as int)
      ,[yenm] = Cast([yenm] as int)
      ,[yaen2m] = Cast([yaen2m] as int)
      ,[enmm] = Cast([enmm] as int)
      ,[yaen1n] = Cast([yaen1n] as int)
      ,[yyenn] = Cast([yyenn] as int)
      ,[yenn] = Cast([yenn] as int)
      ,[yaen2n] = Cast([yaen2n] as int)
      ,[ennn] = Cast([ennn] as int)
      ,[yaru1m] = Cast([yaru1m] as int)
      ,[yyrum] = Cast([yyrum] as int)
      ,[yrum] = Cast([yrum] as int)
      ,[yaru2m] = Cast([yaru2m] as int)
      ,[rumm] = Cast([rumm] as int)
      ,[yaru1n] = Cast([yaru1n] as int)
      ,[yyrun] = Cast([yyrun] as int)
      ,[yrun] = Cast([yrun] as int)
      ,[yaru2n] = Cast([yaru2n] as int)
      ,[runn] = Cast([runn] as int)
      ,[yasu1m] = Cast([yasu1m] as int)
      ,[yysum] = Cast([yysum] as int)
      ,[ysum] = Cast([ysum] as int)
      ,[yasu2m] = Cast([yasu2m] as int)
      ,[summ] = Cast([summ] as int)
      ,[yasu1n] = Cast([yasu1n] as int)
      ,[yysun] = Cast([yysun] as int)
      ,[ysun] = Cast([ysun] as int)
      ,[yasu2n] = Cast([yasu2n] as int)
      ,[sunn] = Cast([sunn] as int)
      ,[yara1m] = Cast([yara1m] as int)
      ,[yyram] = Cast([yyram] as int)
      ,[yram] = Cast([yram] as int)
      ,[yara2m] = Cast([yara2m] as int)
      ,[ramm] = Cast([ramm] as int)
      ,[yara1n] = Cast([yara1n] as int)
      ,[yyran] = Cast([yyran] as int)
      ,[yran] = Cast([yran] as int)
      ,[yara2n] = Cast([yara2n] as int)
      ,[rann] = Cast([rann] as int)
      ,[yasa1m] = Cast([yasa1m] as int)
      ,[yysam] = Cast([yysam] as int)
      ,[ysam] = Cast([ysam] as int)
      ,[yasa2m] = Cast([yasa2m] as int)
      ,[samm] = Cast([samm] as int)
      ,[yasa1n] = Cast([yasa1n] as int)
      ,[yysan] = Cast([yysan] as int)
      ,[ysan] = Cast([ysan] as int)
      ,[yasa2n] = Cast([yasa2n] as int)
      ,[sann] = Cast([sann] as int)
      ,[yave1m] = Cast([yave1m] as int)
      ,[yvem] = Cast([yvem] as int)
      ,[yave2m] = Cast([yave2m] as int)
      ,[vemm] = Cast([vemm] as int)
      ,[yave1n] = Cast([yave1n] as int)
      ,[yven] = Cast([yven] as int)
      ,[yave2n] = Cast([yave2n] as int)
      ,[vennn] = Cast([vennn] as int)
      ,[yasaa1m] = Cast([yasaa1m] as int)
      ,[ysaam] = Cast([ysaam] as int)
      ,[yasaa2m] = Cast([yasaa2m] as int)
      ,[saamm] = Cast([saamm] as int)
      ,[yasaa1n] = Cast([yasaa1n] as int)
      ,[ysaan] = Cast([ysaan] as int)
      ,[yasaa2n] = Cast([yasaa2n] as int)
      ,[saann] = Cast([saann] as int)
      ,[yalat1m] = Cast([yalat1m] as int)
      ,[ylatm] = Cast([ylatm] as int)
      ,[yalat2m] = Cast([yalat2m] as int)
      ,[lamm] = Cast([lamm] as int)
      ,[yalat1n] = Cast([yalat1n] as int)
      ,[ylatn] = Cast([ylatn] as int)
      ,[yalat2n] = Cast([yalat2n] as int)
      ,[lann] = Cast([lann] as int)
      ,[yamuu1m] = Cast([yamuu1m] as int)
      ,[ymuum] = Cast([ymuum] as int)
      ,[yamuu2m] = Cast([yamuu2m] as int)
      ,[mumm] = Cast([mumm] as int)
      ,[yamuu1n] = Cast([yamuu1n] as int)
      ,[ymuun] = Cast([ymuun] as int)
      ,[yamuu2n] = Cast([yamuu2n] as int)
      ,[munn] = Cast([munn] as int)
      ,[yaei1m] = Cast([yaei1m] as int)
      ,[yyeim] = Cast([yyeim] as int)
      ,[eimm] = Cast([eimm] as int)
      ,[yaei1n] = Cast([yaei1n] as int)
      ,[yyein] = Cast([yyein] as int)
      ,[einn] = Cast([einn] as int)
      ,[ma14m] = Cast([ma14m] as int)
      ,[ma14n] = Cast([ma14n] as int)
      ,[ma12m] = Cast([ma12m] as int)
      ,[ma12n] = Cast([ma12n] as int)
      ,[ma1m] = Cast([ma1m] as int)
      ,[ma1n] = Cast([ma1n] as int)
      ,[ma2m] = Cast([ma2m] as int)
      ,[ma2n] = Cast([ma2n] as int)
      ,[ma3m] = Cast([ma3m] as int)
      ,[ma3n] = Cast([ma3n] as int)
      ,[fy14m] = Cast([fy14m] as int)
      ,[fy14n] = Cast([fy14n] as int)
      ,[fy12m] = Cast([fy12m] as int)
      ,[fy12n] = Cast([fy12n] as int)
      ,[fy1m] = Cast([fy1m] as int)
      ,[fy1n] = Cast([fy1n] as int)
      ,[fy2m] = Cast([fy2m] as int)
      ,[fy2n] = Cast([fy2n] as int)
      ,[fy3m] = Cast([fy3m] as int)
      ,[fy3n] = Cast([fy3n] as int)
      ,[ke14m] = Cast([ke14m] as int)
      ,[ke14n] = Cast([ke14n] as int)
      ,[ke12m] = Cast([ke12m] as int)
      ,[ke12n] = Cast([ke12n] as int)
      ,[ke1m] = Cast([ke1m] as int)
      ,[ke1n] = Cast([ke1n] as int)
      ,[ke2m] = Cast([ke2m] as int)
      ,[ke2n] = Cast([ke2n] as int)
      ,[ke3m] = Cast([ke3m] as int)
      ,[ke3n] = Cast([ke3n] as int)
      ,[bi14m] = Cast([bi14m] as int)
      ,[bi14n] = Cast([bi14n] as int)
      ,[bi12m] = Cast([bi12m] as int)
      ,[bi12n] = Cast([bi12n] as int)
      ,[bi1m] = Cast([bi1m] as int)
      ,[bi1n] = Cast([bi1n] as int)
      ,[bi2m] = Cast([bi2m] as int)
      ,[bi2n] = Cast([bi2n] as int)
      ,[bi3m] = Cast([bi3m] as int)
      ,[bi3n] = Cast([bi3n] as int)
      ,[mt14m] = Cast([mt14m] as int)
      ,[mt14n] = Cast([mt14n] as int)
      ,[mt12m] = Cast([mt12m] as int)
      ,[mt12n] = Cast([mt12n] as int)
      ,[mt1m] = Cast([mt1m] as int)
      ,[mt1n] = Cast([mt1n] as int)
      ,[mt2m] = Cast([mt2m] as int)
      ,[mt2n] = Cast([mt2n] as int)
      ,[mt3m] = Cast([mt3m] as int)
      ,[mt3n] = Cast([mt3n] as int)
      ,[ttek14m] = Cast([ttek14m] as int)
      ,[ttek14n] = Cast([ttek14n] as int)
      ,[ttek12m] = Cast([ttek12m] as int)
      ,[ttek12n] = Cast([ttek12n] as int)
      ,[ttek1m] = Cast([ttek1m] as int)
      ,[ttek1n] = Cast([ttek1n] as int)
      ,[ttek2m] = Cast([ttek2m] as int)
      ,[ttek2n] = Cast([ttek2n] as int)
      ,[ttek3m] = Cast([ttek3m] as int)
      ,[ttek3n] = Cast([ttek3n] as int)
      ,[tt14m] = Cast([tt14m] as int)
      ,[tt14n] = Cast([tt14n] as int)
      ,[tt12m] = Cast([tt12m] as int)
      ,[tt12n] = Cast([tt12n] as int)
      ,[tt1m] = Cast([tt1m] as int)
      ,[tt1n] = Cast([tt1n] as int)
      ,[tt2m] = Cast([tt2m] as int)
      ,[tt2n] = Cast([tt2n] as int)
      ,[tt3m] = Cast([tt3m] as int)
      ,[tt3n] = Cast([tt3n] as int)
      ,[ts14m] = Cast([ts14m] as int)
      ,[ts14n] = Cast([ts14n] as int)
      ,[ts12m] = Cast([ts12m] as int)
      ,[ts12n] = Cast([ts12n] as int)
      ,[ts1m] = Cast([ts1m] as int)
      ,[ts1n] = Cast([ts1n] as int)
      ,[ts2m] = Cast([ts2m] as int)
      ,[ts2n] = Cast([ts2n] as int)
      ,[ts3m] = Cast([ts3m] as int)
      ,[ts3n] = Cast([ts3n] as int)

      ,[tietolahde]
      ,[rivinumero]
  FROM (
  /*
  SELECT [tilv]
      ,[jarj]
      ,[tiedtype]
      ,[tunn]
      ,[edesi]
      ,[edala]
      ,[edyla]
      ,[edlisa]
      ,[edainep]
      ,[syesi]
      ,[syala]
      ,[syyla]
      ,[sylisa]
      ,[symamu]
      ,[sylukio]
      ,[syamm]
      ,[symuu]
      ,[keve]
      ,[keven]
      ,[kev1]
      ,[kev1n]
      ,[kev2]
      ,[kev2n]
      ,[kev3]
      ,[kev3n]
      ,[kev4]
      ,[kev4n]
      ,[kev5]
      ,[kev5n]
      ,[kev6]
      ,[kev6n]
      ,[kev7]
      ,[kev7n]
      ,[kev8]
      ,[kev8n]
      ,[kev9]
      ,[kev9n]
      ,[kev10]
      ,[kev10n]
      ,[kev]
      ,[kevn]
      ,[luok1]
      ,[luok1n]
      ,[luok2]
      ,[luok2n]
      ,[luok3]
      ,[luok3n]
      ,[luok4]
      ,[luok4n]
      ,[luok5]
      ,[luok5n]
      ,[luok6]
      ,[luok6n]
      ,[luok7]
      ,[luok7n]
      ,[luok8]
      ,[luok8n]
      ,[luok9]
      ,[luok9n]
      ,[luok]
      ,[luokn]
      ,[kelaim]
      ,[kelaimn]
      ,[tod]
      ,[todn]
      ,[tutkt]
      ,[tutktn]
      ,[suor10]
      ,[suor10n]
      ,[oeriy]
      ,[oeriyn]
      ,[ilmtod]
      ,[ilmtodn]
      ,[aku]
      ,[mamukurs]
      ,[oppkurs]
      ,[muukurs]
      ,[akukurs]
      ,[kmamu]
      ,[kmamun]
      ,[syulkom]
      ,[syulkomn]
      ,[sykoti]
      ,[sykotin]
      ,[ika4e]
      ,[ika4en]
      ,[ika5e]
      ,[ika5en]
      ,[pid5v]
      ,[ika6e]
      ,[ika6en]
      ,[ika7e]
      ,[ika7en]
      ,[ikae]
      ,[ikaen]
      ,[ove]
      ,[ov1]
      ,[ov2]
      ,[ov3]
      ,[ov4]
      ,[ov5]
      ,[ov6]
      ,[ov7]
      ,[ov8]
      ,[ov9]
      ,[ov10]
      ,[ovy]
      ,[tehoe]
      ,[teho1]
      ,[teho2]
      ,[teho3]
      ,[teho4]
      ,[teho5]
      ,[teho6]
      ,[teho7]
      ,[teho8]
      ,[teho9]
      ,[teho10]
      ,[tehoy]
      ,[eipide]
      ,[eipid1]
      ,[eipid2]
      ,[eipid3]
      ,[eipid4]
      ,[eipid5]
      ,[eipid6]
      ,[eipid7]
      ,[eipid8]
      ,[eipid9]
      ,[eipid10]
      ,[eipidy]
      ,[ertuve]
      ,[ertuv1]
      ,[ertuv2]
      ,[ertuv3]
      ,[ertuv4]
      ,[ertuv5]
      ,[ertuv6]
      ,[ertuv7]
      ,[ertuv8]
      ,[ertuv9]
      ,[ertuv10]
      ,[ertuvy]
      ,[ertume]
      ,[ertum1]
      ,[ertum2]
      ,[ertum3]
      ,[ertum4]
      ,[ertum5]
      ,[ertum6]
      ,[ertum7]
      ,[ertum8]
      ,[ertum9]
      ,[ertum10]
      ,[ertumy]
      ,[tavove]
      ,[tavov1]
      ,[tavov2]
      ,[tavov3]
      ,[tavov4]
      ,[tavov5]
      ,[tavov6]
      ,[tavov7]
      ,[tavov8]
      ,[tavov9]
      ,[tavov10]
      ,[tavovy]
      ,[oven]
      ,[ov1n]
      ,[ov2n]
      ,[ov3n]
      ,[ov4n]
      ,[ov5n]
      ,[ov6n]
      ,[ov7n]
      ,[ov8n]
      ,[ov9n]
      ,[ov10n]
      ,[ovyn]
      ,[tehoen]
      ,[teho1n]
      ,[teho2n]
      ,[teho3n]
      ,[teho4n]
      ,[teho5n]
      ,[teho6n]
      ,[teho7n]
      ,[teho8n]
      ,[teho9n]
      ,[teho10n]
      ,[tehoyn]
      ,[eipiden]
      ,[eipid1n]
      ,[eipid2n]
      ,[eipid3n]
      ,[eipid4n]
      ,[eipid5n]
      ,[eipid6n]
      ,[eipid7n]
      ,[eipid8n]
      ,[eipid9n]
      ,[eipid10n]
      ,[eipidyn]
      ,[ertuven]
      ,[ertuv1n]
      ,[ertuv2n]
      ,[ertuv3n]
      ,[ertuv4n]
      ,[ertuv5n]
      ,[ertuv6n]
      ,[ertuv7n]
      ,[ertuv8n]
      ,[ertuv9n]
      ,[ertuv10n]
      ,[ertuvyn]
      ,[ertumen]
      ,[ertum1n]
      ,[ertum2n]
      ,[ertum3n]
      ,[ertum4n]
      ,[ertum5n]
      ,[ertum6n]
      ,[ertum7n]
      ,[ertum8n]
      ,[ertum9n]
      ,[ertum10n]
      ,[ertumyn]
      ,[tavoven]
      ,[tavov1n]
      ,[tavov2n]
      ,[tavov3n]
      ,[tavov4n]
      ,[tavov5n]
      ,[tavov6n]
      ,[tavov7n]
      ,[tavov8n]
      ,[tavov9n]
      ,[tavov10n]
      ,[tavovyn]
      ,[eipidec]
      ,[eipidpc]
      ,[eipidlc]
      ,[eipidyc]
      ,[ertuvec]
      ,[ertuvpc]
      ,[ertuvlc]
      ,[ertuvyc]
      ,[ertumec]
      ,[ertumpc]
      ,[ertumlc]
      ,[ertumyc]
      ,[muuec]
      ,[muupc]
      ,[muulc]
      ,[muuyc]
      ,[ovec]
      ,[ovpc]
      ,[ovlc]
      ,[ovyc]
      ,[sisae]
      ,[sisap]
      ,[sisal]
      ,[sisam]
      ,[sisay]
      ,[maeipide]
      ,[maeipidp]
      ,[maeipidl]
      ,[maeipidy]
      ,[maertuve]
      ,[maertuvp]
      ,[maertuvl]
      ,[maertuvy]
      ,[maertume]
      ,[maertump]
      ,[maertuml]
      ,[maertumy]
      ,[mamuue]
      ,[mamuup]
      ,[mamuul]
      ,[mamuuy]
      ,[maove]
      ,[maovp]
      ,[maovl]
      ,[maovy]
      ,[kueipide]
      ,[kueipidp]
      ,[kueipidl]
      ,[kueipidy]
      ,[kuertuve]
      ,[kuertuvp]
      ,[kuertuvl]
      ,[kuertuvy]
      ,[kuertume]
      ,[kuertump]
      ,[kuertuml]
      ,[kuertumy]
      ,[kumuue]
      ,[kumuup]
      ,[kumuul]
      ,[kumuuy]
      ,[kuove]
      ,[kuovp]
      ,[kuovl]
      ,[kuovy]
      ,[vieipide]
      ,[vieipidp]
      ,[vieipidl]
      ,[vieipidy]
      ,[viertuve]
      ,[viertuvp]
      ,[viertuvl]
      ,[viertuvy]
      ,[viertume]
      ,[viertump]
      ,[viertuml]
      ,[viertumy]
      ,[vimuue]
      ,[vimuup]
      ,[vimuul]
      ,[vimuuy]
      ,[viove]
      ,[viovp]
      ,[viovl]
      ,[viovy]
      ,[ika61]
      ,[ika61n]
      ,[ika71]
      ,[ika71n]
      ,[ika81]
      ,[ika81n]
      ,[ika91]
      ,[ika91n]
      ,[ika1]
      ,[ika1n]
      ,[lykk]
      ,[lykkn]
      ,[jopo]
      ,[jopon]
      ,[kan17v]
      ,[muu17v]
      ,[op17v]
      ,[lukoko]
      ,[lukokon]
      ,[luib]
      ,[luibn]
      ,[reife]
      ,[reifen]
      ,[gymn]
      ,[gymnn]
      ,[lueb]
      ,[luebn]
      ,[lukio]
      ,[lukion]
      ,[opsamm]
      ,[opsammn]
      ,[muuamm]
      ,[muuammn]
      ,[amm]
      ,[ammn]
      ,[peain]
      ,[peainn]
      ,[luain]
      ,[luainn]
      ,[vapsiv]
      ,[vapsivn]
      ,[taiop]
      ,[taiopn]
      ,[muukoul]
      ,[muukouln]
      ,[muuop]
      ,[muuopn]
      ,[tehoec]
      ,[teho16c]
      ,[teho79c]
      ,[teholc]
      ,[tehoyc]
      ,[ertuec]
      ,[ertu16c]
      ,[ertu79c]
      ,[ertulc]
      ,[ertuyc]
      ,[eritec]
      ,[erit16c]
      ,[erit79c]
      ,[eritlc]
      ,[erityc]
      ,[inte4]
      ,[int164]
      ,[int794]
      ,[intl4]
      ,[inty4]
      ,[inte3]
      ,[int163]
      ,[int793]
      ,[intl3]
      ,[inty3]
      ,[inte2]
      ,[int162]
      ,[int792]
      ,[intl2]
      ,[inty2]
      ,[inte1]
      ,[int161]
      ,[int791]
      ,[intl1]
      ,[inty1]
      ,[inte0]
      ,[int160]
      ,[int790]
      ,[intl0]
      ,[inty0]
      ,[intey]
      ,[int16y]
      ,[int79y]
      ,[intly]
      ,[intyy]
      ,[yks160]
      ,[yks790]
      ,[yksl0]
      ,[yksy0]
      ,[yks161]
      ,[yks791]
      ,[yksl1]
      ,[yksy1]
      ,[yks162]
      ,[yks792]
      ,[yksl2]
      ,[yksy2]
      ,[yks164]
      ,[yks794]
      ,[yksl4]
      ,[yksy4]
      ,[yks16t]
      ,[yks79t]
      ,[ykslt]
      ,[yksyt]
      ,[yks16y]
      ,[yks79y]
      ,[yksly]
      ,[yksyy]
      ,[tehoosa]
      ,[ertuosa]
      ,[eritosa]
      ,[tehotuki]
      ,[ertutuki]
      ,[erittuki]
      ,[tehoavu]
      ,[ertuavu]
      ,[eritavu]
      ,[tehomuu]
      ,[ertumuu]
      ,[eritmuu]
      ,[alc]
      ,[ylc]
      ,[luc]
      ,[amc]
      ,[alkieli0]
      ,[alkieli1]
      ,[alkieli2]
      ,[alkieli3]
      ,[alkieli4]
      ,[alkieliy]
      ,[ylkieli0]
      ,[ylkieli1]
      ,[ylkieli2]
      ,[ylkieli3]
      ,[ylkieli4]
      ,[ylkieli5]
      ,[ylkieliy]
      ,[lukieli0]
      ,[lukieli1]
      ,[lukieli2]
      ,[lukieli3]
      ,[lukieli4]
      ,[lukieli5]
      ,[lukieli6]
      ,[lukieliy]
      ,[amkieli0]
      ,[amkieli1]
      ,[amkieli2]
      ,[amkieli3]
      ,[amkieli4]
      ,[amkieli5]
      ,[amkieli6]
      ,[amkieliy]
      ,[aleny]
      ,[alruy]
      ,[alsuy]
      ,[alray]
      ,[alsay]
      ,[alvey]
      ,[alesy]
      ,[ality]
      ,[alsaay]
      ,[almuy]
      ,[yleny]
      ,[ylruy]
      ,[ylsuy]
      ,[ylray]
      ,[ylsay]
      ,[ylvey]
      ,[ylesy]
      ,[ylity]
      ,[ylsaay]
      ,[yllaty]
      ,[ylmuy]
      ,[lueny]
      ,[luruy]
      ,[lusuy]
      ,[luray]
      ,[lusay]
      ,[luvey]
      ,[luesy]
      ,[luity]
      ,[lusaay]
      ,[lulaty]
      ,[lumuy]
      ,[ameny]
      ,[amruy]
      ,[amsuy]
      ,[amray]
      ,[amsay]
      ,[amvey]
      ,[amesy]
      ,[amity]
      ,[amsaay]
      ,[amlaty]
      ,[ammuy]
      ,[ov1c]
      ,[ov2c]
      ,[ov3c]
      ,[ov4c]
      ,[ov5c]
      ,[ov6c]
      ,[ov16yc]
      ,[ov16nc]
      ,[eng1]
      ,[ru1]
      ,[su1]
      ,[ra1]
      ,[sa1]
      ,[ve1]
      ,[es1]
      ,[it1]
      ,[saa1]
      ,[mu1]
      ,[eopis1]
      ,[eng2]
      ,[ru2]
      ,[su2]
      ,[ra2]
      ,[sa2]
      ,[ve2]
      ,[es2]
      ,[it2]
      ,[saa2]
      ,[mu2]
      ,[eopis2]
      ,[eng3]
      ,[ru3]
      ,[su3]
      ,[ra3]
      ,[sa3]
      ,[ve3]
      ,[es3]
      ,[it3]
      ,[saa3]
      ,[mu3]
      ,[eopis3]
      ,[eng4]
      ,[ru4]
      ,[su4]
      ,[ra4]
      ,[sa4]
      ,[ve4]
      ,[es4]
      ,[it4]
      ,[saa4]
      ,[mu4]
      ,[eopis4]
      ,[eng5]
      ,[ru5]
      ,[su5]
      ,[ra5]
      ,[sa5]
      ,[ve5]
      ,[es5]
      ,[it5]
      ,[saa5]
      ,[mu5]
      ,[eopis5]
      ,[eng6]
      ,[ru6]
      ,[su6]
      ,[ra6]
      ,[sa6]
      ,[ve6]
      ,[es6]
      ,[it6]
      ,[saa6]
      ,[mu6]
      ,[eopis6]
      ,[eny]
      ,[ruy]
      ,[suy]
      ,[ray]
      ,[say]
      ,[vey]
      ,[esy]
      ,[ity]
      ,[saay]
      ,[muy]
      ,[eopisy]
      ,[enn]
      ,[run]
      ,[sun]
      ,[ran]
      ,[san]
      ,[ven]
      ,[esn]
      ,[itn]
      ,[saan]
      ,[mun]
      ,[eopisn]
      ,[ven1]
      ,[vru1]
      ,[vsu1]
      ,[vra1]
      ,[vsa1]
      ,[vve1]
      ,[ves1]
      ,[vit1]
      ,[vsaa1]
      ,[vmu1]
      ,[vyht1]
      ,[ven2]
      ,[vru2]
      ,[vsu2]
      ,[vra2]
      ,[vsa2]
      ,[vve2]
      ,[ves2]
      ,[vit2]
      ,[vsaa2]
      ,[vmu2]
      ,[vyht2]
      ,[ven3]
      ,[vru3]
      ,[vsu3]
      ,[vra3]
      ,[vsa3]
      ,[vve3]
      ,[ves3]
      ,[vit3]
      ,[vsaa3]
      ,[vmu3]
      ,[vyht3]
      ,[ven4]
      ,[vru4]
      ,[vsu4]
      ,[vra4]
      ,[vsa4]
      ,[vve4]
      ,[ves4]
      ,[vit4]
      ,[vsaa4]
      ,[vmu4]
      ,[vyht4]
      ,[ven5]
      ,[vru5]
      ,[vsu5]
      ,[vra5]
      ,[vsa5]
      ,[vve5]
      ,[ves5]
      ,[vit5]
      ,[vsaa5]
      ,[vmu5]
      ,[vyht5]
      ,[ven6]
      ,[vru6]
      ,[vsu6]
      ,[vra6]
      ,[vsa6]
      ,[vve6]
      ,[ves6]
      ,[vit6]
      ,[vsaa6]
      ,[vmu6]
      ,[vyht6]
      ,[veny]
      ,[vruy]
      ,[vsuy]
      ,[vray]
      ,[vsay]
      ,[vvey]
      ,[vesy]
      ,[vity]
      ,[vsaay]
      ,[vmuy]
      ,[vyht]
      ,[venn]
      ,[vrun]
      ,[vsun]
      ,[vran]
      ,[vsan]
      ,[vven]
      ,[vesn]
      ,[vitn]
      ,[vsaan]
      ,[vmun]
      ,[vtyt]
      ,[ov79yc]
      ,[ov79nc]
      ,[yaen1]
      ,[yaru1]
      ,[yasu1]
      ,[yara1]
      ,[yasa1]
      ,[yave1]
      ,[yaes1]
      ,[yait1]
      ,[yasaa1]
      ,[yalat1]
      ,[yamuu1]
      ,[yaen2]
      ,[yaru2]
      ,[yasu2]
      ,[yara2]
      ,[yasa2]
      ,[yave2]
      ,[yaes2]
      ,[yait2]
      ,[yasaa2]
      ,[yalat2]
      ,[yamuu2]
      ,[yyen]
      ,[yyru]
      ,[yysu]
      ,[yyra]
      ,[yysa]
      ,[yen]
      ,[yru]
      ,[ysu]
      ,[yra]
      ,[ysa]
      ,[yve]
      ,[yes]
      ,[yit]
      ,[ysaa]
      ,[ylat]
      ,[ymuu]
      ,[enyy]
      ,[ruyy]
      ,[suyy]
      ,[rayy]
      ,[sayy]
      ,[veyy]
      ,[esyy]
      ,[ityy]
      ,[saayy]
      ,[layy]
      ,[muyy]
      ,[yaen1n]
      ,[yaru1n]
      ,[yasu1n]
      ,[yara1n]
      ,[yasa1n]
      ,[yave1n]
      ,[yaes1n]
      ,[yait1n]
      ,[yasaa1n]
      ,[yalat1n]
      ,[yamuu1n]
      ,[yaen2n]
      ,[yaru2n]
      ,[yasu2n]
      ,[yara2n]
      ,[yasa2n]
      ,[yave2n]
      ,[yaes2n]
      ,[yait2n]
      ,[yasaa2n]
      ,[yalat2n]
      ,[yamuu2n]
      ,[yyenn]
      ,[yyrun]
      ,[yysun]
      ,[yyran]
      ,[yysan]
      ,[yenn]
      ,[yrun]
      ,[ysun]
      ,[yran]
      ,[ysan]
      ,[yven]
      ,[yesn]
      ,[yitn]
      ,[ysaan]
      ,[ylatn]
      ,[ymuun]
      ,[ennn]
      ,[runn]
      ,[sunn]
      ,[rann]
      ,[sann]
      ,[vennn]
      ,[esnn]
      ,[itnn]
      ,[saann]
      ,[lann]
      ,[munn]
      ,[asv]
      ,[arv]
      ,[asvrv]
      ,[ysv]
      ,[yrv]
      ,[ysvrv]
      ,[sv]
      ,[rv]
      ,[svrv]
      ,[aev]
      ,[aort]
      ,[aisl]
      ,[amu]
      ,[aet]
      ,[aeos]
      ,[akay]
      ,[yev]
      ,[yort]
      ,[yisl]
      ,[ymu]
      ,[yet]
      ,[yeos]
      ,[ykay]
      ,[ev]
      ,[ort]
      ,[isl]
      ,[mu]
      ,[et]
      ,[eos]
      ,[kay]
      ,[ov89yc]
      ,[ov89nc]
      ,[ai]
      ,[rsb]
      ,[ma]
      ,[yl]
      ,[bi]
      ,[ge]
      ,[fy]
      ,[ke]
      ,[ter]
      ,[ue]
      ,[eti]
      ,[hi]
      ,[yh]
      ,[mus]
      ,[ku]
      ,[tt]
      ,[ts]
      ,[li]
      ,[ko]
      ,[yhd]
      ,[ain]
      ,[rsbn]
      ,[man]
      ,[yln]
      ,[bin]
      ,[gen]
      ,[fyn]
      ,[ken]
      ,[tern]
      ,[uen]
      ,[etin]
      ,[hin]
      ,[yhn]
      ,[musn]
      ,[kun]
      ,[ttn]
      ,[tsn]
      ,[lin]
      ,[kon]
      ,[yhdn]
      ,[tietop]
      ,[tietok]
      ,[tietoi]
      ,[verkko]
      ,[kaytto]
      ,[tietolahde]
      ,[rivinumero]
  FROM [VipunenTK_SA].[dbo].[sa_R2_22_Oppilaitostason_oppil_ja_opisk_12]

  UNION ALL 
*/  
SELECT [tilv]
      ,[tunn]
      ,[jarj]
      ,[kev1]
      ,[kev1n]
      ,[kev2]
      ,[kev2n]
      ,[kev3]
      ,[kev3n]
      ,[kev4]
      ,[kev4n]
      ,[kev5]
      ,[kev5n]
      ,[kev6]
      ,[kev6n]
      ,[kev7]
      ,[kev7n]
      ,[kev8]
      ,[kev8n]
      ,[kev9]
      ,[kev9n]
      ,[kev]
      ,[kevn]
      ,[luok1]
      ,[luok1n]
      ,[luok2]
      ,[luok2n]
      ,[luok3]
      ,[luok3n]
      ,[luok4]
      ,[luok4n]
      ,[luok5]
      ,[luok5n]
      ,[luok6]
      ,[luok6n]
      ,[luok7]
      ,[luok7n]
      ,[luok8]
      ,[luok8n]
      ,[luok9]
      ,[luok9n]
      ,[luok]
      ,[luokn]
      ,[laim]
      ,[laimn]
      ,[erotod]
      ,[erotodn]
      ,[eitod]
      ,[eitodn]
      ,[tod]
      ,[todn]
      ,[tutkt]
      ,[tutktn]
      ,[suor10]
      ,[suor10n]
      ,[ove]
      ,[oven]
      ,[ov1]
      ,[ov1n]
      ,[ov2]
      ,[ov2n]
      ,[ov3]
      ,[ov3n]
      ,[ov4]
      ,[ov4n]
      ,[ov5]
      ,[ov5n]
      ,[ov6]
      ,[ov6n]
      ,[ov7]
      ,[ov7n]
      ,[ov8]
      ,[ov8n]
      ,[ov9]
      ,[ov9n]
      ,[ov10]
      ,[ov10n]
      ,[ovy]
      ,[ovyn]
      ,[eroppe]
      ,[eropp1]
      ,[eropp2]
      ,[eropp3]
      ,[eropp4]
      ,[eropp5]
      ,[eropp6]
      ,[eropp7]
      ,[eropp8]
      ,[eropp9]
      ,[eropp0]
      ,[eropp]
      ,[vaikvame]
      ,[vaikvam1]
      ,[vaikvam2]
      ,[vaikvam3]
      ,[vaikvam4]
      ,[vaikvam5]
      ,[vaikvam6]
      ,[vaikvam7]
      ,[vaikvam8]
      ,[vaikvam9]
      ,[vaikvam0]
      ,[vaikvam]
      ,[muuvame]
      ,[muuvam1]
      ,[muuvam2]
      ,[muuvam3]
      ,[muuvam4]
      ,[muuvam5]
      ,[muuvam6]
      ,[muuvam7]
      ,[muuvam8]
      ,[muuvam9]
      ,[muuvam0]
      ,[muuvam]
      ,[opksu]
      ,[opkru]
      ,[opksaa]
      ,[opkmuu]
      ,[opky]
      ,[kiele]
      ,[kiele9]
      ,[kiele11v]
      ,[kiele11m]
      ,[kielk]
      ,[kielk9]
      ,[kielk11v]
      ,[kielk11m]
      ,[kulje]
      ,[kulje9]
      ,[kulje11v]
      ,[kulje11m]
      ,[kuljk]
      ,[kuljk9]
      ,[kuljk11v]
      ,[kuljk11m]
      ,[maje]
      ,[maje9]
      ,[maje11v]
      ,[maje11m]
      ,[majk]
      ,[majk9]
      ,[majk11v]
      ,[majk11m]
      ,[lykk]
      ,[lykkn]
      ,[kotona]
      ,[kotonan]
      ,[ulkom]
      ,[ulkomn]
      ,[ika5e]
      ,[ika5en]
      ,[ika6e]
      ,[ika6en]
      ,[ika61]
      ,[ika61n]
      ,[ika7e]
      ,[ika7en]
      ,[ika71]
      ,[ika71n]
      ,[ika81]
      ,[ika81n]
      ,[ika91]
      ,[ika91n]
      ,[ikae]
      ,[ikaen]
      ,[ika1]
      ,[ika1n]
      ,[oeriy]
      ,[kokint0]
      ,[kokint1]
      ,[kokint2]
      ,[kokint3]
      ,[kokint4]
      ,[kokint5]
      ,[kokint6]
      ,[kokint7]
      ,[kokint8]
      ,[kokint9]
      ,[kokint10]
      ,[kokint]
      ,[kokintn]
      ,[osint0]
      ,[osint1]
      ,[osint2]
      ,[osint3]
      ,[osint4]
      ,[osint5]
      ,[osint6]
      ,[osint7]
      ,[osint8]
      ,[osint9]
      ,[osint10]
      ,[osint]
      ,[osintn]
      ,[eritlk0]
      ,[eritlk1]
      ,[eritlk2]
      ,[eritlk3]
      ,[eritlk4]
      ,[eritlk5]
      ,[eritlk6]
      ,[eritlk7]
      ,[eritlk8]
      ,[eritlk9]
      ,[eritlk10]
      ,[eritlk]
      ,[eritlkn]
      ,[int0]
      ,[int1]
      ,[int2]
      ,[int3]
      ,[int4]
      ,[int5]
      ,[int6]
      ,[int7]
      ,[int8]
      ,[int9]
      ,[int10]
      ,[inty]
      ,[intyn]
      ,[int0n]
      ,[int1n]
      ,[int2n]
      ,[int3n]
      ,[int4n]
      ,[int5n]
      ,[int6n]
      ,[int7n]
      ,[int8n]
      ,[int9n]
      ,[int10n]
      ,[intn]
      ,[aev]
      ,[yev]
      ,[ev]
      ,[aort]
      ,[yort]
      ,[ort]
      ,[aet]
      ,[yet]
      ,[et]
      ,[amu]
      ,[ymu]
      ,[mu]
      ,[aeos]
      ,[yeos]
      ,[eos]
      ,[akay]
      ,[ykay]
      ,[kay]
      ,[asv]
      ,[ysv]
      ,[sv]
      ,[arv]
      ,[yrv]
      ,[rv]
      ,[asvrv]
      ,[ysvrv]
      ,[svrv]
      ,[eng1]
      ,[eng2]
      ,[eng3]
      ,[eng4]
      ,[eng5]
      ,[eng6]
      ,[eny]
      ,[enn]
      ,[ru1]
      ,[ru2]
      ,[ru3]
      ,[ru4]
      ,[ru5]
      ,[ru6]
      ,[ruy]
      ,[run]
      ,[su1]
      ,[su2]
      ,[su3]
      ,[su4]
      ,[su5]
      ,[su6]
      ,[suy]
      ,[sun]
      ,[ra1]
      ,[ra2]
      ,[ra3]
      ,[ra4]
      ,[ra5]
      ,[ra6]
      ,[ray]
      ,[ran]
      ,[sa1]
      ,[sa2]
      ,[sa3]
      ,[sa4]
      ,[sa5]
      ,[sa6]
      ,[say]
      ,[san]
      ,[ve1]
      ,[ve2]
      ,[ve3]
      ,[ve4]
      ,[ve5]
      ,[ve6]
      ,[vey]
      ,[ven]
      ,[saa1]
      ,[saa2]
      ,[saa3]
      ,[saa4]
      ,[saa5]
      ,[saa6]
      ,[saay]
      ,[saan]
      ,[mu1]
      ,[mu2]
      ,[mu3]
      ,[mu4]
      ,[mu5]
      ,[mu6]
      ,[muy]
      ,[mun]
      ,[eopis1]
      ,[eopis2]
      ,[eopis3]
      ,[eopis4]
      ,[eopis5]
      ,[eopis6]
      ,[eopisy]
      ,[eopisn]
      ,[yht1]
      ,[yht2]
      ,[yht3]
      ,[yht4]
      ,[yht5]
      ,[yht6]
      ,[yht]
      ,[tyt]
      ,[ven1]
      ,[ven2]
      ,[ven3]
      ,[ven4]
      ,[ven5]
      ,[ven6]
      ,[veny]
      ,[venn]
      ,[vru1]
      ,[vru2]
      ,[vru3]
      ,[vru4]
      ,[vru5]
      ,[vru6]
      ,[vruy]
      ,[vsu1]
      ,[vsu2]
      ,[vsu3]
      ,[vsu4]
      ,[vsu5]
      ,[vsu6]
      ,[vsuy]
      ,[vsun]
      ,[vrun]
      ,[vra1]
      ,[vra2]
      ,[vra3]
      ,[vra4]
      ,[vra5]
      ,[vra6]
      ,[vray]
      ,[vran]
      ,[vsa1]
      ,[vsa2]
      ,[vsa3]
      ,[vsa4]
      ,[vsa5]
      ,[vsa6]
      ,[vsay]
      ,[vsan]
      ,[vve1]
      ,[vve2]
      ,[vve3]
      ,[vve4]
      ,[vve5]
      ,[vve6]
      ,[vvey]
      ,[vven]
      ,[vsaa1]
      ,[vsaa2]
      ,[vsaa3]
      ,[vsaa4]
      ,[vsaa5]
      ,[vsaa6]
      ,[vsaay]
      ,[vsaan]
      ,[vmu1]
      ,[vmu2]
      ,[vmu3]
      ,[vmu4]
      ,[vmu5]
      ,[vmu6]
      ,[vmuy]
      ,[vmun]
      ,[vyht1]
      ,[vyht2]
      ,[vyht3]
      ,[vyht4]
      ,[vyht5]
      ,[vyht6]
      ,[vyht]
      ,[vtyt]
      ,[kieli0]
      ,[kieli1]
      ,[kieli2]
      ,[kieli3]
      ,[kieli4]
      ,[kieliy]
      ,[yaen1m]
      ,[yyenm]
      ,[yenm]
      ,[yaen2m]
      ,[enmm]
      ,[yaen1n]
      ,[yyenn]
      ,[yenn]
      ,[yaen2n]
      ,[ennn]
      ,[yaru1m]
      ,[yyrum]
      ,[yrum]
      ,[yaru2m]
      ,[rumm]
      ,[yaru1n]
      ,[yyrun]
      ,[yrun]
      ,[yaru2n]
      ,[runn]
      ,[yasu1m]
      ,[yysum]
      ,[ysum]
      ,[yasu2m]
      ,[summ]
      ,[yasu1n]
      ,[yysun]
      ,[ysun]
      ,[yasu2n]
      ,[sunn]
      ,[yara1m]
      ,[yyram]
      ,[yram]
      ,[yara2m]
      ,[ramm]
      ,[yara1n]
      ,[yyran]
      ,[yran]
      ,[yara2n]
      ,[rann]
      ,[yasa1m]
      ,[yysam]
      ,[ysam]
      ,[yasa2m]
      ,[samm]
      ,[yasa1n]
      ,[yysan]
      ,[ysan]
      ,[yasa2n]
      ,[sann]
      ,[yave1m]
      ,[yvem]
      ,[yave2m]
      ,[vemm]
      ,[yave1n]
      ,[yven]
      ,[yave2n]
      ,[vennn]
      ,[yasaa1m]
      ,[ysaam]
      ,[yasaa2m]
      ,[saamm]
      ,[yasaa1n]
      ,[ysaan]
      ,[yasaa2n]
      ,[saann]
      ,[yalat1m]
      ,[ylatm]
      ,[yalat2m]
      ,[lamm]
      ,[yalat1n]
      ,[ylatn]
      ,[yalat2n]
      ,[lann]
      ,[yamuu1m]
      ,[ymuum]
      ,[yamuu2m]
      ,[mumm]
      ,[yamuu1n]
      ,[ymuun]
      ,[yamuu2n]
      ,[munn]
      ,[yaei1m]
      ,[yyeim]
      ,[eimm]
      ,[yaei1n]
      ,[yyein]
      ,[einn]
      ,[ma14m]
      ,[ma14n]
      ,[ma12m]
      ,[ma12n]
      ,[ma1m]
      ,[ma1n]
      ,[ma2m]
      ,[ma2n]
      ,[ma3m]
      ,[ma3n]
      ,[fy14m]
      ,[fy14n]
      ,[fy12m]
      ,[fy12n]
      ,[fy1m]
      ,[fy1n]
      ,[fy2m]
      ,[fy2n]
      ,[fy3m]
      ,[fy3n]
      ,[ke14m]
      ,[ke14n]
      ,[ke12m]
      ,[ke12n]
      ,[ke1m]
      ,[ke1n]
      ,[ke2m]
      ,[ke2n]
      ,[ke3m]
      ,[ke3n]
      ,[bi14m]
      ,[bi14n]
      ,[bi12m]
      ,[bi12n]
      ,[bi1m]
      ,[bi1n]
      ,[bi2m]
      ,[bi2n]
      ,[bi3m]
      ,[bi3n]
      ,[mt14m]
      ,[mt14n]
      ,[mt12m]
      ,[mt12n]
      ,[mt1m]
      ,[mt1n]
      ,[mt2m]
      ,[mt2n]
      ,[mt3m]
      ,[mt3n]
      ,[ttek14m]
      ,[ttek14n]
      ,[ttek12m]
      ,[ttek12n]
      ,[ttek1m]
      ,[ttek1n]
      ,[ttek2m]
      ,[ttek2n]
      ,[ttek3m]
      ,[ttek3n]
      ,[tt14m]
      ,[tt14n]
      ,[tt12m]
      ,[tt12n]
      ,[tt1m]
      ,[tt1n]
      ,[tt2m]
      ,[tt2n]
      ,[tt3m]
      ,[tt3n]
      ,[ts14m]
      ,[ts14n]
      ,[ts12m]
      ,[ts12n]
      ,[ts1m]
      ,[ts1n]
      ,[ts2m]
      ,[ts2n]
      ,[ts3m]
      ,[ts3n]
	  ,[tietolahde]=''2.1_sopv_11''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_1_sopv_11]
  ) Aineistot

' 
GO
/****** Object:  View [dbo].[v_sa_2_10_Korkeakouluopiskelijoiden_aikaisempi_koulutus]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_2_10_Korkeakouluopiskelijoiden_aikaisempi_koulutus]'))
EXEC dbo.sp_executesql @statement = N'


















CREATE VIEW [dbo].[v_sa_2_10_Korkeakouluopiskelijoiden_aikaisempi_koulutus] AS

SELECT
      [tilv]= cast(kaikkivuodet.tilv as nvarchar(4))
	  ,tilv_date = cast(kaikkivuodet.tilv+''0101'' as date)
      ,[lahde] = CAST(kaikkivuodet.lahde as nvarchar (2))
      ,[tunn]= CAST(kaikkivuodet.tunn as nvarchar (5))
      ,[jarj]= CAST(kaikkivuodet.jarj as nvarchar (10))
      ,[koulk]= CAST(kaikkivuodet.koulk as nvarchar (6))
	  ,[koulk_opintoala1995] = CAST(kaikkivuodet.koulk_opintoala1995 as nvarchar (6))
	  ,[koulk_opintoala2002] = CAST(kaikkivuodet.koulk_opintoala2002 as nvarchar (6))
	  ,[koulk_koulutusala2002] = CAST(kaikkivuodet.koulk_koulutusala2002 as nvarchar (6))
	  ,[koulk_koulutusaste2002] = CAST(kaikkivuodet.koulk_koulutusaste2002 as nvarchar (6))
      ,[kkun]= CAST(kaikkivuodet.kkun as nvarchar (3))
      ,[sp]= CAST(kaikkivuodet.sp as nvarchar (1))
      ,[aikielir1]= CAST(kaikkivuodet.aikielir1 as nvarchar (2))
      ,[syntv]= CAST(kaikkivuodet.syntv as nvarchar (4))
      ,[tilvaskun]= CAST(kaikkivuodet.tilvaskun as nvarchar (3))
      ,[kansal]= CAST(kaikkivuodet.kansal as nvarchar (1))
      ,[olotamm]= CAST(kaikkivuodet.olotamm as nvarchar (1))
      ,[olosyys]= CAST(kaikkivuodet.olosyys as nvarchar (1))
      ,[rahlahde]= CAST(kaikkivuodet.rahlahde as nvarchar (1))
      ,[fte]= CAST(kaikkivuodet.fte as nvarchar (1))
      ,[op45]= CAST(kaikkivuodet.op45 as nvarchar (1))
	  ,[op55]= CAST(kaikkivuodet.op55 as nvarchar (1))
      ,[alvv]= CAST(kaikkivuodet.alvv as nvarchar (4))
      ,[allk]= CAST(kaikkivuodet.allk as nvarchar (4))
      ,[alvv_kksek]= CAST(kaikkivuodet.alvv_kksek as nvarchar (4))
      ,[alvv_kksek_lasna]= CAST(kaikkivuodet.alvv_kksek_lasna as nvarchar (4))
      ,[alvv_sek]= CAST(kaikkivuodet.alvv_sek as nvarchar (4))
      ,[alvv_sek_lasna]= CAST(kaikkivuodet.alvv_sek_lasna as nvarchar (4))
      ,[alvv_kk]= CAST(kaikkivuodet.alvv_kk as nvarchar (4))
      ,[alvv_kk_lasna]= CAST(kaikkivuodet.alvv_kk_lasna as nvarchar (4))
      ,[alvv_opa]= CAST(kaikkivuodet.alvv_opa as nvarchar (4))
      ,[alvv_opa_lasna]= CAST(kaikkivuodet.alvv_opa_lasna as nvarchar (4))
      ,[koulutyp]= CAST(kaikkivuodet.koulutyp as nvarchar (1))
      ,[om]= CAST(kaikkivuodet.om as nvarchar (1))
      ,[avo]= CAST(kaikkivuodet.avo as nvarchar (1))
      ,[aikyotutk]= CAST(kaikkivuodet.aikyotutk as nvarchar (1))
      ,[aikyotutkkoulk]= CAST(kaikkivuodet.aikyotutkkoulk as nvarchar (6))
	  ,[aikyotutkkoulk_opintoala1995] = CAST(kaikkivuodet.koulk_opintoala1995 as nvarchar (6))
	  ,[aikyotutkkoulk_opintoala2002] = CAST(kaikkivuodet.koulk_opintoala2002 as nvarchar (6))
	  ,[aikyotutkkoulk_koulutusala2002] = CAST(kaikkivuodet.koulk_koulutusala2002 as nvarchar (6))
	  ,[aikyotutkkoulk_koulutusaste2002] = CAST(kaikkivuodet.koulk_koulutusaste2002 as nvarchar (6))
      ,[suvuosiyotutk]= CAST(kaikkivuodet.suvuosiyotutk as nvarchar (4))
      ,[tunnyotutk]= CAST(kaikkivuodet.tunnyotutk as nvarchar (5))
      ,[aikamm]= CAST(kaikkivuodet.aikamm as nvarchar (1))
      ,[aikammkoulk]= CAST(kaikkivuodet.aikammkoulk as nvarchar (6))
	  ,[aikammkoulk_opintoala1995] = CAST(kaikkivuodet.aikammkoulk_opintoala1995 as nvarchar (6))
	  ,[aikammkoulk_opintoala2002] = CAST(kaikkivuodet.aikammkoulk_opintoala2002 as nvarchar (6))
	  ,[aikammkoulk_koulutusala2002] = CAST(kaikkivuodet.aikammkoulk_koulutusala2002 as nvarchar (6))
	  ,[aikammkoulk_koulutusaste2002] = CAST(kaikkivuodet.aikammkoulk_koulutusaste2002 as nvarchar (6))
      ,[suvuosiamm]= CAST(kaikkivuodet.suvuosiamm as nvarchar (4))
      ,[tunnamm]= CAST(kaikkivuodet.tunnamm as nvarchar (5))
      ,[aikamk]= CAST(kaikkivuodet.aikamk as nvarchar (1))
      ,[aikamkkoulk]= CAST(kaikkivuodet.aikamkkoulk as nvarchar (6))
	  ,[aikamkkoulk_opintoala1995] = CAST(kaikkivuodet.aikamkkoulk_opintoala1995 as nvarchar (6))
	  ,[aikamkkoulk_opintoala2002] = CAST(kaikkivuodet.aikamkkoulk_opintoala2002 as nvarchar (6))
	  ,[aikamkkoulk_koulutusala2002] = CAST(kaikkivuodet.aikamkkoulk_koulutusala2002 as nvarchar (6))
	  ,[aikamkkoulk_koulutusaste2002] = CAST(kaikkivuodet.aikamkkoulk_koulutusaste2002 as nvarchar (6))
      ,[suvuosiamk]= CAST(kaikkivuodet.suvuosiamk as nvarchar (4))
      ,[tunnamk]= CAST(kaikkivuodet.tunnamk as nvarchar (5))
      ,[aikylamk]= CAST(kaikkivuodet.aikylamk as nvarchar (1))
      ,[aikylamkkoulk]= CAST(kaikkivuodet.aikylamkkoulk as nvarchar (6))
	  ,[aikylamkkoulk_opintoala1995] = CAST(kaikkivuodet.aikylamkkoulk_opintoala1995 as nvarchar (6))
	  ,[aikylamkkoulk_opintoala2002] = CAST(kaikkivuodet.aikylamkkoulk_opintoala2002 as nvarchar (6))
	  ,[aikylamkkoulk_koulutusala2002] = CAST(kaikkivuodet.aikylamkkoulk_koulutusala2002 as nvarchar (6))
	  ,[aikylamkkoulk_koulutusaste2002] = CAST(kaikkivuodet.aikylamkkoulk_koulutusaste2002 as nvarchar (6))
      ,[suvuosiylamk]= CAST(kaikkivuodet.suvuosiylamk as nvarchar (4))
      ,[tunnylamk]= CAST(kaikkivuodet.tunnylamk as nvarchar (5))
      ,[aikalkk]= CAST(kaikkivuodet.aikalkk as nvarchar (1))
      ,[aikalkkkoulk]= CAST(kaikkivuodet.aikalkkkoulk as nvarchar (6))
	  ,[aikalkkkoulk_opintoala1995] = CAST(kaikkivuodet.aikalkkkoulk_opintoala1995 as nvarchar (6))
	  ,[aikalkkkoulk_opintoala2002] = CAST(kaikkivuodet.aikalkkkoulk_opintoala2002 as nvarchar (6))
	  ,[aikalkkkoulk_koulutusala2002] = CAST(kaikkivuodet.aikalkkkoulk_koulutusala2002 as nvarchar (6))
	  ,[aikalkkkoulk_koulutusaste2002] = CAST(kaikkivuodet.aikalkkkoulk_koulutusaste2002 as nvarchar (6))
      ,[suvuosialkk]= CAST(kaikkivuodet.suvuosialkk as nvarchar (4))
      ,[tunnalkk]= CAST(kaikkivuodet.tunnalkk as nvarchar (5))
      ,[aikylkk]= CAST(kaikkivuodet.aikylkk as nvarchar (1))
      ,[aikylkkkoulk]= CAST(kaikkivuodet.aikylkkkoulk as nvarchar (6))
	  ,[aikylkkkoulk_opintoala1995] = CAST(kaikkivuodet.aikylkkkoulk_opintoala1995 as nvarchar (6))
	  ,[aikylkkkoulk_opintoala2002] = CAST(kaikkivuodet.aikylkkkoulk_opintoala2002 as nvarchar (6))
	  ,[aikylkkkoulk_koulutusala2002] = CAST(kaikkivuodet.aikylkkkoulk_koulutusala2002 as nvarchar (6))
	  ,[aikylkkkoulk_koulutusaste2002] = CAST(kaikkivuodet.aikylkkkoulk_koulutusaste2002 as nvarchar (6))
      ,[suvuosiylkk]= CAST(kaikkivuodet.suvuosiylkk as nvarchar (4))
      ,[tunnylkk]= CAST(kaikkivuodet.tunnylkk as nvarchar (5))
      ,[koulked]= CAST(kaikkivuodet.koulked as nvarchar (6))
      ,[opm02opaed]= CAST(kaikkivuodet.opm02opaed as nvarchar (3))
      ,[opm95opaed]= CAST(kaikkivuodet.opm95opaed as nvarchar (2))
      ,[lkm]= CAST(kaikkivuodet.lkm as int)
      ,[tietolahde]= CAST(kaikkivuodet.tietolahde as nvarchar(20))
      ,[rivinumero] = CAST(kaikkivuodet.rivinumero as int)
 FROM (
SELECT [tilv]
      ,[lahde]
      ,[tunn]
      ,[jarj]
      ,[koulk]
	  ,[koulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''0101'' between
	  (alkaa) and (paattyy))

      ,[koulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''0101'' between
	  (alkaa) and (paattyy))
	  ,[koulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''0101'' between
	  (alkaa) and (paattyy))
      ,[koulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi    from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''0101'' between
	  (alkaa) and (paattyy))
      ,[kkun]
      ,[sp]
      ,[aikielir1]
      ,(CASE WHEN [syntv] = ''19XX'' THEN ''''
      ELSE [syntv] END) AS syntv
      ,[tilvaskun]
      ,[kansal]
      ,[olotamm]
      ,[olosyys]
      ,[rahlahde]
      ,[fte]
      ,[op45]
	  ,[op55]= ''''
      ,[alvv]
      ,[allk]
      ,[alvv_kksek]
      ,[alvv_kksek_lasna]
      ,[alvv_sek]
      ,[alvv_sek_lasna]
      ,[alvv_kk]
      ,[alvv_kk_lasna]
      ,[alvv_opa]
      ,[alvv_opa_lasna]
      ,[koulutyp]
      ,[om]
      ,[avo]
      ,[aikyotutk]
      ,[aikyotutkkoulk]
	  ,[aikyotutkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikyotutkkoulk] AND tilv+''0101'' between alkaa and paattyy)
      ,[aikyotutkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikyotutkkoulk] AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikyotutkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikyotutkkoulk] AND tilv+''0101'' between alkaa and paattyy)
      ,[aikyotutkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikyotutkkoulk] AND tilv+''0101'' between alkaa and paattyy)
	  ,(CASE WHEN [suvuosiyotutk] = ''19XX'' THEN ''''
      ELSE [suvuosiyotutk] END) AS suvuosiyotutk
      ,[opyotutk] as tunnyotutk
      ,[aikamm]
      ,[aikammkoulk]
	  ,[aikammkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikammkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikammkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikammkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikammkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikammkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikammkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikammkoulk]AND tilv+''0101'' between alkaa and paattyy)
        ,(CASE WHEN [suvuosiamm] = ''19XX'' THEN ''''
      ELSE [suvuosiamm] END) AS suvuosiamm
      ,[opamm]as tunnamm
      ,[aikamk]
      ,[aikamkkoulk]
	  ,[aikamkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikamkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikamkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikamkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,(CASE WHEN [suvuosiamk] = ''19XX'' THEN ''''
      ELSE [suvuosiamk] END) AS suvuosiamk
      ,[kkamk] as tunnamk
      ,[aikylamk]
      ,[aikylamkkoulk]
	  ,[aikylamkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikylamkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikylamkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikylamkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	    ,(CASE WHEN [suvuosiylamk] = ''19XX'' THEN ''''
      ELSE [suvuosiylamk] END) AS suvuosiylamk
      ,[kkylamk] as tunnylamk
      ,[aikalkk]
      ,[aikalkkkoulk]
	  ,[aikalkkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikalkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikalkkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikalkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikalkkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikalkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikalkkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikalkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,(CASE WHEN [suvuosialkk] = ''19XX'' THEN ''''
      ELSE [suvuosialkk] END) AS suvuosialkk
      ,[kkalkk] as tunnalkk
      ,[aikylkk]
      ,[aikylkkkoulk]
	  ,[aikylkkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikylkkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikylkkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikylkkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	   ,(CASE WHEN [suvuosiylkk] = ''19XX'' THEN ''''
      ELSE [suvuosiylkk] END) AS suvuosiylkk
      ,[kkylkk] as tunnylkk
      ,[koulked]
      ,[opm02opaed]
      ,[opm95opaed]
      ,[lkm]
      ,[tietolahde]=''TK_2_10_sopv_11''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_10_sopv_11]	
  UNION ALL
  SELECT [tilv]
      ,[lahde]
      ,[tunn]
      ,[jarj]
      ,[koulk]
      ,[koulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''0101'' between
	  (alkaa) and (paattyy))
      ,[koulk_opintoala2002] = (select distinct opintoala2002_koodi    from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''0101'' between
	  (alkaa) and (paattyy))
	  ,[koulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''0101'' between
	  (alkaa) and (paattyy))
      ,[koulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi    from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''0101'' between
	  (alkaa) and (paattyy))
      ,[kkun]
      ,[sp]
      ,[aikielir1]
       ,(CASE WHEN [syntv] = ''19XX'' THEN ''''
      ELSE [syntv] END) AS syntv
      ,[tilvaskun]
      ,[kansal]
      ,[olotamm]
      ,[olosyys]
      ,[rahlahde]
      ,[fte]
      ,[op45]
	  ,[op55]
      ,[alvv]
      ,[allk]
      ,[alvv_kksek]
      ,[alvv_kksek_lasna]
      ,[alvv_sek]
      ,[alvv_sek_lasna]
      ,[alvv_kk]
      ,[alvv_kk_lasna]
      ,[alvv_opa]
      ,[alvv_opa_lasna]
      ,[koultyp]
      ,[om]
      ,[avo]
      ,[aikyotutk]
      ,[aikyotutkkoulk]
	  ,[aikyotutkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikyotutkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikyotutkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikyotutkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikyotutkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikyotutkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikyotutkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikyotutkkoulk]AND tilv+''0101'' between alkaa and paattyy)
        ,(CASE WHEN [suvuosiyotutk] = ''19XX'' THEN ''''
      ELSE [suvuosiyotutk] END) AS suvuosiyotutk
      ,[tunnyotutk]
      ,[aikamm]
      ,[aikammkoulk]
	  ,[aikammkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikammkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikammkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus]where koulutusluokitus_avain = [aikammkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikammkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikammkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikammkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikammkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,(CASE WHEN [suvuosiamm] = ''19XX'' THEN ''''
      ELSE [suvuosiamm] END) AS suvuosiamm
      ,[tunnamm]
      ,[aikamk]
      ,[aikamkkoulk]
	  ,[aikamkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikamkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikamkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikamkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
     ,(CASE WHEN [suvuosiamk] = ''19XX'' THEN ''''
      ELSE [suvuosiamk] END) AS suvuosiamk
      ,[tunnamk]
      ,[aikylamk]
      ,[aikylamkkoulk]
	  ,[aikylamkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikylamkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikylamkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikylamkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,(CASE WHEN [suvuosiylamk] = ''19XX'' THEN ''''
      ELSE [suvuosiylamk] END) AS suvuosiylamk
      ,[tunnylamk]
      ,[aikalkk]
      ,[aikalkkkoulk]
	  ,[aikalkkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikalkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikalkkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikalkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikalkkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikalkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikalkkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikalkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,(CASE WHEN [suvuosialkk] = ''19XX'' THEN ''''
      ELSE [suvuosialkk] END) AS suvuosialkk
      ,[tunnalkk]
      ,[aikylkk]
      ,[aikylkkkoulk]
	  ,[aikylkkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikylkkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikylkkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikylkkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
       ,(CASE WHEN [suvuosiylkk] = ''19XX'' THEN ''''
      ELSE [suvuosiylkk] END) AS suvuosiylkk
      ,[tunnylkk]
      ,[koulked]
      ,[opm02opaed]
      ,[opm95opaed]
      ,[lkm]
      ,[tietolahde]=''TK_2_10_sopv_12''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_10_sopv_12]	-- vaihda takaisin siirtokantaan, kun TK:lta saadaan korjattu - Lasse 31.10.2016  -- vaihdettu takas 1.2.2017 - Lasse
 UNION ALL
  SELECT [tilv]
      ,[lahde]
      ,[tunn]
      ,[jarj]
      ,[koulk]
	  ,[koulk_opintoala1995] = (select distinct opintoala1995_koodi    from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''0101'' between
	  (alkaa) and (paattyy))
      ,[koulk_opintoala2002] = (select distinct opintoala2002_koodi    from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''0101'' between
	  (alkaa) and (paattyy))
	  ,[koulk_koulutusala2002] = (select distinct koulutusala2002_koodi    from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''0101'' between
	  (alkaa) and (paattyy))
      ,[koulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi    from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''0101'' between
	  (alkaa) and (paattyy))
      ,[kkun]
      ,[sp]
      ,[aikielir1]
       ,(CASE WHEN [syntv] = ''19XX'' THEN ''''
      ELSE [syntv] END) AS syntv
      ,[tilvaskun]
      ,[kansal]
      ,[olotamm]
      ,[olosyys]
      ,[rahlahde]
      ,[fte]
      ,[op45]
	  ,[op55]
      ,[alvv]
      ,[allk]
      ,[alvv_kksek]
      ,[alvv_kksek_lasna]
      ,[alvv_sek]
      ,[alvv_sek_lasna]
      ,[alvv_kk]
      ,[alvv_kk_lasna]
      ,[alvv_opa]
      ,[alvv_opa_lasna]
      ,[koultyp]
      ,[om]
      ,[avo]
      ,[aikyotutk]
      ,[aikyotutkkoulk]
	  ,[aikyotutkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikyotutkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikyotutkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikyotutkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikyotutkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikyotutkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikyotutkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikyotutkkoulk]AND tilv+''0101'' between alkaa and paattyy)
        ,(CASE WHEN [suvuosiyotutk] = ''19XX'' THEN ''''
      ELSE [suvuosiyotutk] END) AS suvuosiyotutk
      ,[tunnyotutk]
      ,[aikamm]
      ,[aikammkoulk]
	  ,[aikammkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikammkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikammkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikammkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikammkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikammkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikammkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikammkoulk]AND tilv+''0101'' between alkaa and paattyy)
       ,(CASE WHEN [suvuosiamm] = ''19XX'' THEN ''''
      ELSE [suvuosiamm] END) AS suvuosiamm
      ,[tunnamm]
      ,[aikamk]
      ,[aikamkkoulk]
	  ,[aikamkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikamkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikamkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikamkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
       ,(CASE WHEN [suvuosiamk] = ''19XX'' THEN ''''
      ELSE [suvuosiamk] END) AS suvuosiamk
      ,[tunnamk]
      ,[aikylamk]
      ,[aikylamkkoulk]
	  ,[aikylamkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikylamkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikylamkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikylamkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,(CASE WHEN [suvuosiylamk] = ''19XX'' THEN ''''
      ELSE [suvuosiylamk] END) AS suvuosiylamk
      ,[tunnylamk]
      ,[aikalkk]
      ,[aikalkkkoulk]
	  ,[aikalkkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikalkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikalkkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikalkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikalkkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikalkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikalkkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikalkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
    ,(CASE WHEN [suvuosialkk] = ''19XX'' THEN ''''
      ELSE [suvuosialkk] END) AS suvuosialkk
      ,[tunnalkk]
      ,[aikylkk]
      ,[aikylkkkoulk]
	  ,[aikylkkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikylkkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikylkkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikylkkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
       ,(CASE WHEN [suvuosiylkk] = ''19XX'' THEN ''''
      ELSE [suvuosiylkk] END) AS suvuosiylkk
      ,[tunnylkk]
      ,[koulked]
      ,[opm02opaed]
      ,[opm95opaed]
      ,[lkm]
      ,[tietolahde]=''TK_2_10_sopv_14''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_10_sopv_14]	

 UNION ALL
  SELECT [tilv]
      ,[lahde]
      ,[tunn]
      ,[jarj]
      ,[koulk]
	  ,[koulk_opintoala1995] = (select distinct opintoala1995_koodi    from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''0101'' between
	  (alkaa) and (paattyy))
      ,[koulk_opintoala2002] = (select distinct opintoala2002_koodi    from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''0101'' between
	  (alkaa) and (paattyy))
	  ,[koulk_koulutusala2002] = (select distinct koulutusala2002_koodi    from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''0101'' between
	  (alkaa) and (paattyy))
      ,[koulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi    from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''0101'' between
	  (alkaa) and (paattyy))
      ,[kkun]
      ,[sp]
      ,[aikielir1]
     ,(CASE WHEN [syntv] = ''19XX'' THEN ''''
      ELSE [syntv] END) AS syntv
      ,[tilvaskun]
      ,[kansal]
      ,[olotamm]
      ,[olosyys]
      ,[rahlahde]
      ,[fte]
      ,[op45]
	  ,[op55]
      ,[alvv]
      ,[allk]
      ,[alvv_kksek]
      ,[alvv_kksek_lasna]
      ,[alvv_sek]
      ,[alvv_sek_lasna]
      ,[alvv_kk]
      ,[alvv_kk_lasna]
      ,[alvv_opa]
      ,[alvv_opa_lasna]
      ,[koultyp]
      ,[om]
      ,[avo]
      ,[aikyotutk]
      ,[aikyotutkkoulk]
	  ,[aikyotutkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikyotutkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikyotutkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikyotutkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikyotutkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikyotutkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikyotutkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikyotutkkoulk]AND tilv+''0101'' between alkaa and paattyy)
        ,(CASE WHEN [suvuosiyotutk] = ''19XX'' THEN ''''
      ELSE [suvuosiyotutk] END) AS suvuosiyotutk
      ,[tunnyotutk]
      ,[aikamm]
      ,[aikammkoulk]
	  ,[aikammkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikammkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikammkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikammkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikammkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikammkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikammkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikammkoulk]AND tilv+''0101'' between alkaa and paattyy)
       ,(CASE WHEN [suvuosiamm] = ''19XX'' THEN ''''
      ELSE [suvuosiamm] END) AS suvuosiamm
      ,[tunnamm]
      ,[aikamk]
      ,[aikamkkoulk]
	  ,[aikamkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikamkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikamkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikamkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
       ,(CASE WHEN [suvuosiamk] = ''19XX'' THEN ''''
      ELSE [suvuosiamk] END) AS suvuosiamk
      ,[tunnamk]
      ,[aikylamk]
      ,[aikylamkkoulk]
	  ,[aikylamkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikylamkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikylamkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikylamkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus]where koulutusluokitus_avain = [aikylamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,(CASE WHEN [suvuosiylamk] = ''19XX'' THEN ''''
      ELSE [suvuosiylamk] END) AS suvuosiylamk
      ,[tunnylamk]
      ,[aikalkk]
      ,[aikalkkkoulk]
	  ,[aikalkkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikalkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikalkkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikalkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikalkkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikalkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikalkkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikalkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
     ,(CASE WHEN [suvuosialkk] = ''19XX'' THEN ''''
      ELSE [suvuosialkk] END) AS suvuosialkk
      ,[tunnalkk]
      ,[aikylkk]
      ,[aikylkkkoulk]
	  ,[aikylkkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikylkkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikylkkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikylkkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
       ,(CASE WHEN [suvuosiylkk] = ''19XX'' THEN ''''
      ELSE [suvuosiylkk] END) AS suvuosiylkk
      ,[tunnylkk]
      ,[koulked]
      ,[opm02opaed]
      ,[opm95opaed]
      ,[lkm]
      ,[tietolahde]=''TK_2_10_sopv_15''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_10_sopv_15]	

 UNION ALL
  SELECT [tilv]
      ,[lahde]
      ,[tunn]
      ,[jarj]
      ,[koulk]
	  ,[koulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''0101'' between
	  (alkaa) and (paattyy))
      ,[koulk_opintoala2002] = (select distinct opintoala2002_koodi    from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''0101'' between
	  (alkaa) and (paattyy))
	  ,[koulk_koulutusala2002] = (select distinct koulutusala2002_koodi    from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''0101'' between
	  (alkaa) and (paattyy))
      ,[koulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi    from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''0101'' between
	  (alkaa) and (paattyy))
      ,[kkun]
      ,[sp]
      ,[aikielir1]
     ,(CASE WHEN [syntv] = ''19XX'' THEN ''''
      ELSE [syntv] END) AS syntv
      ,[tilvaskun]
      ,[kansal]
      ,[olotamm]
      ,[olosyys]
      ,[rahlahde]
      ,[fte]
      ,[op45]
	  ,[op55]
      ,[alvv]
      ,[allk]
      ,[alvv_kksek]
      ,[alvv_kksek_lasna]
      ,[alvv_sek]
      ,[alvv_sek_lasna]
      ,[alvv_kk]
      ,[alvv_kk_lasna]
      ,[alvv_opa]
      ,[alvv_opa_lasna]
      ,[koultyp]
      ,[om]
      ,[avo]
      ,[aikyotutk]
      ,[aikyotutkkoulk]
	  ,[aikyotutkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikyotutkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikyotutkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikyotutkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikyotutkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikyotutkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikyotutkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikyotutkkoulk]AND tilv+''0101'' between alkaa and paattyy)
        ,(CASE WHEN [suvuosiyotutk] = ''19XX'' THEN ''''
      ELSE [suvuosiyotutk] END) AS suvuosiyotutk
      ,[tunnyotutk]
      ,[aikamm]
      ,[aikammkoulk]
	  ,[aikammkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikammkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikammkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikammkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikammkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikammkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikammkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikammkoulk]AND tilv+''0101'' between alkaa and paattyy)
       ,(CASE WHEN [suvuosiamm] = ''19XX'' THEN ''''
      ELSE [suvuosiamm] END) AS suvuosiamm
      ,[tunnamm]
      ,[aikamk]
      ,[aikamkkoulk]
	  ,[aikamkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikamkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikamkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikamkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
       ,(CASE WHEN [suvuosiamk] = ''19XX'' THEN ''''
      ELSE [suvuosiamk] END) AS suvuosiamk
      ,[tunnamk]
      ,[aikylamk]
      ,[aikylamkkoulk]
	  ,[aikylamkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikylamkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikylamkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus]  where koulutusluokitus_avain = [aikylamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikylamkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,(CASE WHEN [suvuosiylamk] = ''19XX'' THEN ''''
      ELSE [suvuosiylamk] END) AS suvuosiylamk
      ,[tunnylamk]
      ,[aikalkk]
      ,[aikalkkkoulk]
	  ,[aikalkkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikalkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikalkkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikalkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikalkkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikalkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikalkkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikalkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
     ,(CASE WHEN [suvuosialkk] = ''19XX'' THEN ''''
      ELSE [suvuosialkk] END) AS suvuosialkk
      ,[tunnalkk]
      ,[aikylkk]
      ,[aikylkkkoulk]
	  ,[aikylkkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikylkkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikylkkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikylkkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
       ,(CASE WHEN [suvuosiylkk] = ''19XX'' THEN ''''
      ELSE [suvuosiylkk] END) AS suvuosiylkk
      ,[tunnylkk]
      ,[koulked]
      ,[opm02opaed]
      ,[opm95opaed]
      ,[lkm]
      ,[tietolahde]=''TK_2_10_sopv_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_10_sopv_16]	


 UNION ALL

  SELECT [tilv]
      ,[lahde]
      ,[tunn]
      ,[jarj]
      ,[koulk]
	  ,[koulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''0101'' between
	  (alkaa) and (paattyy))
      ,[koulk_opintoala2002] = (select distinct opintoala2002_koodi    from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''0101'' between
	  (alkaa) and (paattyy))
	  ,[koulk_koulutusala2002] = (select distinct koulutusala2002_koodi    from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''0101'' between
	  (alkaa) and (paattyy))
      ,[koulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi    from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''0101'' between
	  (alkaa) and (paattyy))
      ,[kkun]
      ,[sp]
      ,[aikielir1]
     ,(CASE WHEN [syntv] = ''19XX'' THEN ''''
      ELSE [syntv] END) AS syntv
      ,[tilvaskun]
      ,[kansal]
      ,[olotamm]
      ,[olosyys]
      ,[rahlahde]
      ,[fte]
      ,[op45]
	  ,[op55]
      ,[alvv]
      ,[allk]
      ,[alvv_kksek]
      ,[alvv_kksek_lasna]
      ,[alvv_sek]
      ,[alvv_sek_lasna]
      ,[alvv_kk]
      ,[alvv_kk_lasna]
      ,[alvv_opa]
      ,[alvv_opa_lasna]
      ,[koultyp]
      ,[om]
      ,[avo]
      ,[aikyotutk]
      ,[aikyotutkkoulk]
	  ,[aikyotutkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikyotutkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikyotutkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikyotutkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikyotutkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikyotutkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikyotutkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikyotutkkoulk]AND tilv+''0101'' between alkaa and paattyy)
        ,(CASE WHEN [suvuosiyotutk] = ''19XX'' THEN ''''
      ELSE [suvuosiyotutk] END) AS suvuosiyotutk
      ,[tunnyotutk]
      ,[aikamm]
      ,[aikammkoulk]
	  ,[aikammkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikammkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikammkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikammkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikammkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikammkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikammkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikammkoulk]AND tilv+''0101'' between alkaa and paattyy)
       ,(CASE WHEN [suvuosiamm] = ''19XX'' THEN ''''
      ELSE [suvuosiamm] END) AS suvuosiamm
      ,[tunnamm]
      ,[aikamk]
      ,[aikamkkoulk]
	  ,[aikamkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikamkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikamkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikamkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
       ,(CASE WHEN [suvuosiamk] = ''19XX'' THEN ''''
      ELSE [suvuosiamk] END) AS suvuosiamk
      ,[tunnamk]
      ,[aikylamk]
      ,[aikylamkkoulk]
	  ,[aikylamkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikylamkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikylamkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus]  where koulutusluokitus_avain = [aikylamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikylamkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,(CASE WHEN [suvuosiylamk] = ''19XX'' THEN ''''
      ELSE [suvuosiylamk] END) AS suvuosiylamk
      ,[tunnylamk]
      ,[aikalkk]
      ,[aikalkkkoulk]
	  ,[aikalkkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikalkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikalkkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikalkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikalkkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikalkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikalkkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikalkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
     ,(CASE WHEN [suvuosialkk] = ''19XX'' THEN ''''
      ELSE [suvuosialkk] END) AS suvuosialkk
      ,[tunnalkk]
      ,[aikylkk]
      ,[aikylkkkoulk]
	  ,[aikylkkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikylkkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikylkkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikylkkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
       ,(CASE WHEN [suvuosiylkk] = ''19XX'' THEN ''''
      ELSE [suvuosiylkk] END) AS suvuosiylkk
      ,[tunnylkk]
      ,[koulked]
      ,[opm02opaed]
      ,[opm95opaed]
      ,[lkm]
      ,[tietolahde]=''TK_2_10_sopv_17''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_10_sopv_17]	



) as kaikkivuodet



















' 
GO
/****** Object:  View [dbo].[v_sa_2_11_Oppilaitosten_tutkintoon_johtamaton]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_2_11_Oppilaitosten_tutkintoon_johtamaton]'))
EXEC dbo.sp_executesql @statement = N'


-- CSC Jarmo Nieminen 8.5.2014
-- Näkymä hakee kaikki Tutkintoon johtamattoman kuution lähdetaulut ja kokoaa ne yhteen 
-- 
-- Select * from VipunenTK_SA.[dbo].v_sa_2_11_Oppilaitosten_tutkintoon_johtamaton
--
-- Drop table VipunenTK_DW.[dbo].sa_2_11_Oppilaitosten_tutkintoon_johtamaton
-- Select * into VipunenTK_DW.[dbo].sa_2_11_Oppilaitosten_tutkintoon_johtamaton from VipunenTK_SA.[dbo].v_sa_2_11_Oppilaitosten_tutkintoon_johtamaton
--
-- Truncate table VipunenTK_DW.[dbo].sa_2_11_Oppilaitosten_tutkintoon_johtamaton
-- Insert into VipunenTK_DW.[dbo].sa_2_11_Oppilaitosten_tutkintoon_johtamaton Select * from VipunenTK_SA.[dbo].v_sa_2_11_Oppilaitosten_tutkintoon_johtamaton



CREATE VIEW [dbo].[v_sa_2_11_Oppilaitosten_tutkintoon_johtamaton] AS

SELECT [tilv] = Cast(tilv as varchar(4))
	  ,tilv_date = Cast(tilv+''0101'' as DATE)
      ,[tunn] = Cast(isnull(nullif(right(''00000''+tunn,5),''00000''),''-1'') as nvarchar(5)) --Täydennetään etunollat. Jos tyhjä niin -1.
      ,[jarj] = Cast(jarj AS nvarchar(10))
      ,[osa1] = Cast([osa1] as int)
      ,[suo1] = Cast([suo1] as int)
      ,[osa2] = Cast([osa2] as int)
      ,[suo2] = Cast([suo2] as int)
      ,[osa3] = Cast([osa3] as int)
      ,[suo3] = Cast([suo3] as int)
      ,[kur4] = Cast([kur4] as int)
      ,[osa4] = Cast([osa4] as int)
      ,[nai4] = Cast([nai4] as int)
      ,[tun4] = Cast([tun4] as int)
      ,[kur5] = Cast([kur5] as int)
      ,[osa5] = Cast([osa5] as int)
      ,[nai5] = Cast([nai5] as int)
      ,[tun5] = Cast([tun5] as int)
      ,[kur6] = Cast([kur6] as int)
      ,[osa6] = Cast([osa6] as int)
      ,[nai6] = Cast([nai6] as int)
      ,[tun6] = Cast([tun6] as int)
      ,[kur7] = Cast([kur7] as int)
      ,[osa7] = Cast([osa7] as int)
      ,[nai7] = Cast([nai7] as int)
      ,[kur8] = Cast([kur8] as int)
      ,[osa8] = Cast([osa8] as int)
      ,[nai8] = Cast([nai8] as int)
      ,[kur9] = Cast([kur9] as int)
      ,[osa9] = Cast([osa9] as int)
      ,[nai9] = Cast([nai9] as int)
      ,[kur10] = Cast([kur10] as int)
      ,[osa10] = Cast([osa10] as int)
      ,[nai10] = Cast([nai10] as int)
      ,[kur11] = Cast([kur11] as int)
      ,[osa11] = Cast([osa11] as int)
      ,[nai11] = Cast([nai11] as int)
      ,[kur12] = Cast([kur12] as int)
      ,[osa12] = Cast([osa12] as int)
      ,[nai12] = Cast([nai12] as int)
      ,[kur13] = Cast([kur13] as int)
      ,[osa13] = Cast([osa13] as int)
      ,[nai13] = Cast([nai13] as int)
      ,[kur14] = Cast([kur14] as int)
      ,[osa14] = Cast([osa14] as int)
      ,[nai14] = Cast([nai14] as int)
      ,[kurd] = Cast([kurd] as int)
      ,[osad] = Cast([osad] as int)
      ,[naid] = Cast([naid] as int)
      ,[E11] = Cast([E11] as int)
      ,[E12] = Cast([E12] as int)
      ,[E13] = Cast([E13] as int)
      ,[E14] = Cast([E14] as int)
      ,[E15] = Cast([E15] as int)
      ,[E16] = Cast([E16] as int)
      ,[E17] = Cast([E17] as int)
      ,[E18] = Cast([E18] as int)
      ,[E19] = Cast([E19] as int)
      ,[E21] = Cast([E21] as int)
      ,[E22] = Cast([E22] as int)
      ,[E23] = Cast([E23] as int)
      ,[E24] = Cast([E24] as int)
      ,[E25] = Cast([E25] as int)
      ,[E26] = Cast([E26] as int)
      ,[E27] = Cast([E27] as int)
      ,[E28] = Cast([E28] as int)
      ,[E29] = Cast([E29] as int)
      ,[E31] = Cast([E31] as int)
      ,[E32] = Cast([E32] as int)
      ,[E33] = Cast([E33] as int)
      ,[E34] = Cast([E34] as int)
      ,[E35] = Cast([E35] as int)
      ,[E36] = Cast([E36] as int)
      ,[E37] = Cast([E37] as int)
      ,[E38] = Cast([E38] as int)
      ,[E39] = Cast([E39] as int)
      ,[E41] = Cast([E41] as int)
      ,[E42] = Cast([E42] as int)
      ,[E43] = Cast([E43] as int)
      ,[E44] = Cast([E44] as int)
      ,[E45] = Cast([E45] as int)
      ,[E46] = Cast([E46] as int)
      ,[E47] = Cast([E47] as int)
      ,[E48] = Cast([E48] as int)
      ,[E49] = Cast([E49] as int)
      ,[E51] = Cast([E51] as int)
      ,[E52] = Cast([E52] as int)
      ,[E53] = Cast([E53] as int)
      ,[E54] = Cast([E54] as int)
      ,[E55] = Cast([E55] as int)
      ,[E56] = Cast([E56] as int)
      ,[E57] = Cast([E57] as int)
      ,[E58] = Cast([E58] as int)
      ,[E59] = Cast([E59] as int)
      ,[E61] = Cast([E61] as int)
      ,[E62] = Cast([E62] as int)
      ,[E63] = Cast([E63] as int)
      ,[E64] = Cast([E64] as int)
      ,[E65] = Cast([E65] as int)
      ,[E66] = Cast([E66] as int)
      ,[E67] = Cast([E67] as int)
      ,[E68] = Cast([E68] as int)
      ,[E69] = Cast([E69] as int)
      ,[E71] = Cast([E71] as int)
      ,[E72] = Cast([E72] as int)
      ,[E73] = Cast([E73] as int)
      ,[E74] = Cast([E74] as int)
      ,[E75] = Cast([E75] as int)
      ,[E76] = Cast([E76] as int)
      ,[E77] = Cast([E77] as int)
      ,[E78] = Cast([E78] as int)
      ,[E79] = Cast([E79] as int)
      ,[E81] = Cast([E81] as int)
      ,[E82] = Cast([E82] as int)
      ,[E83] = Cast([E83] as int)
      ,[E84] = Cast([E84] as int)
      ,[E85] = Cast([E85] as int)
      ,[E86] = Cast([E86] as int)
      ,[E87] = Cast([E87] as int)
      ,[E88] = Cast([E88] as int)
      ,[E89] = Cast([E89] as int)
      ,[E91] = Cast([E91] as int)
      ,[E92] = Cast([E92] as int)
      ,[E93] = Cast([E93] as int)
      ,[E94] = Cast([E94] as int)
      ,[E95] = Cast([E95] as int)
      ,[E96] = Cast([E96] as int)
      ,[E97] = Cast([E97] as int)
      ,[E98] = Cast([E98] as int)
      ,[E99] = Cast([E99] as int)
      ,[E101] = Cast([E101] as int)
      ,[E102] = Cast([E102] as int)
      ,[E103] = Cast([E103] as int)
      ,[E104] = Cast([E104] as int)
      ,[E105] = Cast([E105] as int)
      ,[E106] = Cast([E106] as int)
      ,[E107] = Cast([E107] as int)
      ,[E108] = Cast([E108] as int)
      ,[E109] = Cast([E109] as int)
      ,[E111] = Cast([E111] as int)
      ,[E112] = Cast([E112] as int)
      ,[E113] = Cast([E113] as int)
      ,[E114] = Cast([E114] as int)
      ,[E115] = Cast([E115] as int)
      ,[E116] = Cast([E116] as int)
      ,[E117] = Cast([E117] as int)
      ,[E118] = Cast([E118] as int)
      ,[E119] = Cast([E119] as int)
      ,[E121] = Cast([E121] as int)
      ,[E122] = Cast([E122] as int)
      ,[E123] = Cast([E123] as int)
      ,[E124] = Cast([E124] as int)
      ,[E125] = Cast([E125] as int)
      ,[E126] = Cast([E126] as int)
      ,[E127] = Cast([E127] as int)
      ,[E128] = Cast([E128] as int)
      ,[E129] = Cast([E129] as int)
      ,[E131] = Cast([E131] as int)
      ,[E132] = Cast([E132] as int)
      ,[E133] = Cast([E133] as int)
      ,[E134] = Cast([E134] as int)
      ,[E135] = Cast([E135] as int)
      ,[E136] = Cast([E136] as int)
      ,[E137] = Cast([E137] as int)
      ,[E138] = Cast([E138] as int)
      ,[E139] = Cast([E139] as int)
      ,[E141] = Cast([E141] as int)
      ,[E142] = Cast([E142] as int)
      ,[E143] = Cast([E143] as int)
      ,[E144] = Cast([E144] as int)
      ,[E145] = Cast([E145] as int)
      ,[E146] = Cast([E146] as int)
      ,[E147] = Cast([E147] as int)
      ,[E148] = Cast([E148] as int)
      ,[E149] = Cast([E149] as int)
      ,[E151] = Cast([E151] as int)
      ,[E152] = Cast([E152] as int)
      ,[E153] = Cast([E153] as int)
      ,[E154] = Cast([E154] as int)
      ,[E155] = Cast([E155] as int)
      ,[E156] = Cast([E156] as int)
      ,[E157] = Cast([E157] as int)
      ,[E158] = Cast([E158] as int)
      ,[E159] = Cast([E159] as int)
      ,[E161] = Cast([E161] as int)
      ,[E162] = Cast([E162] as int)
      ,[E163] = Cast([E163] as int)
      ,[E164] = Cast([E164] as int)
      ,[E165] = Cast([E165] as int)
      ,[E166] = Cast([E166] as int)
      ,[E167] = Cast([E167] as int)
      ,[E168] = Cast([E168] as int)
      ,[E169] = Cast([E169] as int)
      ,[E171] = Cast([E171] as int)
      ,[E172] = Cast([E172] as int)
      ,[E173] = Cast([E173] as int)
      ,[E174] = Cast([E174] as int)
      ,[E175] = Cast([E175] as int)
      ,[E176] = Cast([E176] as int)
      ,[E177] = Cast([E177] as int)
      ,[E178] = Cast([E178] as int)
      ,[E179] = Cast([E179] as int)
      ,[E181] = Cast([E181] as int)
      ,[E182] = Cast([E182] as int)
      ,[E183] = Cast([E183] as int)
      ,[E184] = Cast([E184] as int)
      ,[E185] = Cast([E185] as int)
      ,[E186] = Cast([E186] as int)
      ,[E187] = Cast([E187] as int)
      ,[E188] = Cast([E188] as int)
      ,[E189] = Cast([E189] as int)
      ,[E191] = Cast([E191] as int)
      ,[E192] = Cast([E192] as int)
      ,[E193] = Cast([E193] as int)
      ,[E194] = Cast([E194] as int)
      ,[E195] = Cast([E195] as int)
      ,[E196] = Cast([E196] as int)
      ,[E197] = Cast([E197] as int)
      ,[E198] = Cast([E198] as int)
      ,[E199] = Cast([E199] as int)
      ,[E201] = Cast([E201] as int)
      ,[E202] = Cast([E202] as int)
      ,[E203] = Cast([E203] as int)
      ,[E204] = Cast([E204] as int)
      ,[E205] = Cast([E205] as int)
      ,[E206] = Cast([E206] as int)
      ,[E207] = Cast([E207] as int)
      ,[E208] = Cast([E208] as int)
      ,[E209] = Cast([E209] as int)
      ,[E211] = Cast([E211] as int)
      ,[E212] = Cast([E212] as int)
      ,[E213] = Cast([E213] as int)
      ,[E214] = Cast([E214] as int)
      ,[E215] = Cast([E215] as int)
      ,[E216] = Cast([E216] as int)
      ,[E217] = Cast([E217] as int)
      ,[E218] = Cast([E218] as int)
      ,[E219] = Cast([E219] as int)
      ,[E221] = Cast([E221] as int)
      ,[E222] = Cast([E222] as int)
      ,[E223] = Cast([E223] as int)
      ,[E224] = Cast([E224] as int)
      ,[E225] = Cast([E225] as int)
      ,[E226] = Cast([E226] as int)
      ,[E227] = Cast([E227] as int)
      ,[E228] = Cast([E228] as int)
      ,[E229] = Cast([E229] as int)
      ,[E231] = Cast([E231] as int)
      ,[E232] = Cast([E232] as int)
      ,[E233] = Cast([E233] as int)
      ,[E234] = Cast([E234] as int)
      ,[E235] = Cast([E235] as int)
      ,[E236] = Cast([E236] as int)
      ,[E237] = Cast([E237] as int)
      ,[E238] = Cast([E238] as int)
      ,[E239] = Cast([E239] as int)
      ,[E241] = Cast([E241] as int)
      ,[E242] = Cast([E242] as int)
      ,[E243] = Cast([E243] as int)
      ,[E244] = Cast([E244] as int)
      ,[E245] = Cast([E245] as int)
      ,[E246] = Cast([E246] as int)
      ,[E247] = Cast([E247] as int)
      ,[E248] = Cast([E248] as int)
      ,[E249] = Cast([E249] as int)
      ,[E251] = Cast([E251] as int)
      ,[E252] = Cast([E252] as int)
      ,[E253] = Cast([E253] as int)
      ,[E254] = Cast([E254] as int)
      ,[E255] = Cast([E255] as int)
      ,[E256] = Cast([E256] as int)
      ,[E257] = Cast([E257] as int)
      ,[E258] = Cast([E258] as int)
      ,[E259] = Cast([E259] as int)
      ,[E261] = Cast([E261] as int)
      ,[E262] = Cast([E262] as int)
      ,[E263] = Cast([E263] as int)
      ,[E264] = Cast([E264] as int)
      ,[E265] = Cast([E265] as int)
      ,[E266] = Cast([E266] as int)
      ,[E267] = Cast([E267] as int)
      ,[E268] = Cast([E268] as int)
      ,[E269] = Cast([E269] as int)
      ,[E271] = Cast([E271] as int)
      ,[E272] = Cast([E272] as int)
      ,[E273] = Cast([E273] as int)
      ,[E274] = Cast([E274] as int)
      ,[E275] = Cast([E275] as int)
      ,[E276] = Cast([E276] as int)
      ,[E277] = Cast([E277] as int)
      ,[E278] = Cast([E278] as int)
      ,[E279] = Cast([E279] as int)
      ,[E281] = Cast([E281] as int)
      ,[E282] = Cast([E282] as int)
      ,[E283] = Cast([E283] as int)
      ,[E284] = Cast([E284] as int)
      ,[E285] = Cast([E285] as int)
      ,[E286] = Cast([E286] as int)
      ,[E287] = Cast([E287] as int)
      ,[E288] = Cast([E288] as int)
      ,[E289] = Cast([E289] as int)
      ,[E291] = Cast([E291] as int)
      ,[E292] = Cast([E292] as int)
      ,[E293] = Cast([E293] as int)
      ,[E294] = Cast([E294] as int)
      ,[E295] = Cast([E295] as int)
      ,[E296] = Cast([E296] as int)
      ,[E297] = Cast([E297] as int)
      ,[E298] = Cast([E298] as int)
      ,[E299] = Cast([E299] as int)
      ,[E301] = Cast([E301] as int)
      ,[E302] = Cast([E302] as int)
      ,[E303] = Cast([E303] as int)
      ,[E304] = Cast([E304] as int)
      ,[E305] = Cast([E305] as int)
      ,[E306] = Cast([E306] as int)
      ,[E307] = Cast([E307] as int)
      ,[E308] = Cast([E308] as int)
      ,[E309] = Cast([E309] as int)
      ,[E311] = Cast([E311] as int)
      ,[E312] = Cast([E312] as int)
      ,[E313] = Cast([E313] as int)
      ,[E314] = Cast([E314] as int)
      ,[E315] = Cast([E315] as int)
      ,[E316] = Cast([E316] as int)
      ,[E317] = Cast([E317] as int)
      ,[E318] = Cast([E318] as int)
      ,[E319] = Cast([E319] as int)
      ,[E321] = Cast([E321] as int)
      ,[E322] = Cast([E322] as int)
      ,[E323] = Cast([E323] as int)
      ,[E324] = Cast([E324] as int)
      ,[E325] = Cast([E325] as int)
      ,[E326] = Cast([E326] as int)
      ,[E327] = Cast([E327] as int)
      ,[E328] = Cast([E328] as int)
      ,[E329] = Cast([E329] as int)
      ,[E331] = Cast([E331] as int)
      ,[E332] = Cast([E332] as int)
      ,[E333] = Cast([E333] as int)
      ,[E334] = Cast([E334] as int)
      ,[E335] = Cast([E335] as int)
      ,[E336] = Cast([E336] as int)
      ,[E337] = Cast([E337] as int)
      ,[E338] = Cast([E338] as int)
      ,[E339] = Cast([E339] as int)
      ,[E341] = Cast([E341] as int)
      ,[E342] = Cast([E342] as int)
      ,[E343] = Cast([E343] as int)
      ,[E344] = Cast([E344] as int)
      ,[E345] = Cast([E345] as int)
      ,[E346] = Cast([E346] as int)
      ,[E347] = Cast([E347] as int)
      ,[E348] = Cast([E348] as int)
      ,[E349] = Cast([E349] as int)
      ,[E351] = Cast([E351] as int)
      ,[E352] = Cast([E352] as int)
      ,[E353] = Cast([E353] as int)
      ,[E354] = Cast([E354] as int)
      ,[E355] = Cast([E355] as int)
      ,[E356] = Cast([E356] as int)
      ,[E357] = Cast([E357] as int)
      ,[E358] = Cast([E358] as int)
      ,[E359] = Cast([E359] as int)
      ,[E361] = Cast([E361] as int)
      ,[E362] = Cast([E362] as int)
      ,[E363] = Cast([E363] as int)
      ,[E364] = Cast([E364] as int)
      ,[E365] = Cast([E365] as int)
      ,[E366] = Cast([E366] as int)
      ,[E367] = Cast([E367] as int)
      ,[E368] = Cast([E368] as int)
      ,[E369] = Cast([E369] as int)
      ,[E371] = Cast([E371] as int)
      ,[E372] = Cast([E372] as int)
      ,[E373] = Cast([E373] as int)
      ,[E374] = Cast([E374] as int)
      ,[E375] = Cast([E375] as int)
      ,[E376] = Cast([E376] as int)
      ,[E377] = Cast([E377] as int)
      ,[E378] = Cast([E378] as int)
      ,[E379] = Cast([E379] as int)
      ,[E381] = Cast([E381] as int)
      ,[E382] = Cast([E382] as int)
      ,[E383] = Cast([E383] as int)
      ,[E384] = Cast([E384] as int)
      ,[E385] = Cast([E385] as int)
      ,[E386] = Cast([E386] as int)
      ,[E387] = Cast([E387] as int)
      ,[E388] = Cast([E388] as int)
      ,[E389] = Cast([E389] as int)
      ,[E391] = Cast([E391] as int)
      ,[E392] = Cast([E392] as int)
      ,[E393] = Cast([E393] as int)
      ,[E394] = Cast([E394] as int)
      ,[E395] = Cast([E395] as int)
      ,[E396] = Cast([E396] as int)
      ,[E397] = Cast([E397] as int)
      ,[E398] = Cast([E398] as int)
      ,[E399] = Cast([E399] as int)
      ,[E401] = Cast([E401] as int)
      ,[E402] = Cast([E402] as int)
      ,[E403] = Cast([E403] as int)
      ,[E404] = Cast([E404] as int)
      ,[E405] = Cast([E405] as int)
      ,[E406] = Cast([E406] as int)
      ,[E407] = Cast([E407] as int)
      ,[E408] = Cast([E408] as int)
      ,[E409] = Cast([E409] as int)
      ,[E411] = Cast([E411] as int)
      ,[E412] = Cast([E412] as int)
      ,[E413] = Cast([E413] as int)
      ,[E414] = Cast([E414] as int)
      ,[E415] = Cast([E415] as int)
      ,[E416] = Cast([E416] as int)
      ,[E417] = Cast([E417] as int)
      ,[E418] = Cast([E418] as int)
      ,[E419] = Cast([E419] as int)
      ,[E421] = Cast([E421] as int)
      ,[E422] = Cast([E422] as int)
      ,[E423] = Cast([E423] as int)
      ,[E424] = Cast([E424] as int)
      ,[E425] = Cast([E425] as int)
      ,[E426] = Cast([E426] as int)
      ,[E427] = Cast([E427] as int)
      ,[E428] = Cast([E428] as int)
      ,[E429] = Cast([E429] as int)
      ,[E431] = Cast([E431] as int)
      ,[E432] = Cast([E432] as int)
      ,[E433] = Cast([E433] as int)
      ,[E434] = Cast([E434] as int)
      ,[E435] = Cast([E435] as int)
      ,[E436] = Cast([E436] as int)
      ,[E437] = Cast([E437] as int)
      ,[E438] = Cast([E438] as int)
      ,[E439] = Cast([E439] as int)
      ,[E441] = Cast([E441] as int)
      ,[E442] = Cast([E442] as int)
      ,[E443] = Cast([E443] as int)
      ,[E444] = Cast([E444] as int)
      ,[E445] = Cast([E445] as int)
      ,[E446] = Cast([E446] as int)
      ,[E447] = Cast([E447] as int)
      ,[E448] = Cast([E448] as int)
      ,[E449] = Cast([E449] as int)
      ,[E451] = Cast([E451] as int)
      ,[E452] = Cast([E452] as int)
      ,[E453] = Cast([E453] as int)
      ,[E454] = Cast([E454] as int)
      ,[E455] = Cast([E455] as int)
      ,[E456] = Cast([E456] as int)
      ,[E457] = Cast([E457] as int)
      ,[E458] = Cast([E458] as int)
      ,[E459] = Cast([E459] as int)
      ,[E461] = Cast([E461] as int)
      ,[E462] = Cast([E462] as int)
      ,[E463] = Cast([E463] as int)
      ,[E464] = Cast([E464] as int)
      ,[E465] = Cast([E465] as int)
      ,[E466] = Cast([E466] as int)
      ,[E467] = Cast([E467] as int)
      ,[E468] = Cast([E468] as int)
      ,[E469] = Cast([E469] as int)
      ,[E471] = Cast([E471] as int)
      ,[E472] = Cast([E472] as int)
      ,[E473] = Cast([E473] as int)
      ,[E474] = Cast([E474] as int)
      ,[E475] = Cast([E475] as int)
      ,[E476] = Cast([E476] as int)
      ,[E477] = Cast([E477] as int)
      ,[E478] = Cast([E478] as int)
      ,[E479] = Cast([E479] as int)
      ,[E481] = Cast([E481] as int)
      ,[E482] = Cast([E482] as int)
      ,[E483] = Cast([E483] as int)
      ,[E484] = Cast([E484] as int)
      ,[E485] = Cast([E485] as int)
      ,[E486] = Cast([E486] as int)
      ,[E487] = Cast([E487] as int)
      ,[E488] = Cast([E488] as int)
      ,[E489] = Cast([E489] as int)
      ,[E491] = Cast([E491] as int)
      ,[E492] = Cast([E492] as int)
      ,[E493] = Cast([E493] as int)
      ,[E494] = Cast([E494] as int)
      ,[E495] = Cast([E495] as int)
      ,[E496] = Cast([E496] as int)
      ,[E497] = Cast([E497] as int)
      ,[E498] = Cast([E498] as int)
      ,[E499] = Cast([E499] as int)
      ,[E501] = Cast([E501] as int)
      ,[E502] = Cast([E502] as int)
      ,[E503] = Cast([E503] as int)
      ,[E504] = Cast([E504] as int)
      ,[E505] = Cast([E505] as int)
      ,[E506] = Cast([E506] as int)
      ,[E507] = Cast([E507] as int)
      ,[E508] = Cast([E508] as int)
      ,[E509] = Cast([E509] as int)
      ,[E511] = Cast([E511] as int)
      ,[E512] = Cast([E512] as int)
      ,[E513] = Cast([E513] as int)
      ,[E514] = Cast([E514] as int)
      ,[E515] = Cast([E515] as int)
      ,[E516] = Cast([E516] as int)
      ,[E517] = Cast([E517] as int)
      ,[E518] = Cast([E518] as int)
      ,[E519] = Cast([E519] as int)
      ,[E521] = Cast([E521] as int)
      ,[E522] = Cast([E522] as int)
      ,[E523] = Cast([E523] as int)
      ,[E524] = Cast([E524] as int)
      ,[E525] = Cast([E525] as int)
      ,[E526] = Cast([E526] as int)
      ,[E527] = Cast([E527] as int)
      ,[E528] = Cast([E528] as int)
      ,[E529] = Cast([E529] as int)
      ,[E531] = Cast([E531] as int)
      ,[E532] = Cast([E532] as int)
      ,[E533] = Cast([E533] as int)
      ,[E534] = Cast([E534] as int)
      ,[E535] = Cast([E535] as int)
      ,[E536] = Cast([E536] as int)
      ,[E537] = Cast([E537] as int)
      ,[E538] = Cast([E538] as int)
      ,[E539] = Cast([E539] as int)
      ,[E541] = Cast([E541] as int)
      ,[E542] = Cast([E542] as int)
      ,[E543] = Cast([E543] as int)
      ,[E544] = Cast([E544] as int)
      ,[E545] = Cast([E545] as int)
      ,[E546] = Cast([E546] as int)
      ,[E547] = Cast([E547] as int)
      ,[E548] = Cast([E548] as int)
      ,[E549] = Cast([E549] as int)
      ,[E551] = Cast([E551] as int)
      ,[E552] = Cast([E552] as int)
      ,[E553] = Cast([E553] as int)
      ,[E554] = Cast([E554] as int)
      ,[E555] = Cast([E555] as int)
      ,[E556] = Cast([E556] as int)
      ,[E557] = Cast([E557] as int)
      ,[E558] = Cast([E558] as int)
      ,[E559] = Cast([E559] as int)
      ,[E561] = Cast([E561] as int)
      ,[E562] = Cast([E562] as int)
      ,[E563] = Cast([E563] as int)
      ,[E564] = Cast([E564] as int)
      ,[E565] = Cast([E565] as int)
      ,[E566] = Cast([E566] as int)
      ,[E567] = Cast([E567] as int)
      ,[E568] = Cast([E568] as int)
      ,[E569] = Cast([E569] as int)
      ,[E571] = Cast([E571] as int)
      ,[E572] = Cast([E572] as int)
      ,[E573] = Cast([E573] as int)
      ,[E574] = Cast([E574] as int)
      ,[E575] = Cast([E575] as int)
      ,[E576] = Cast([E576] as int)
      ,[E577] = Cast([E577] as int)
      ,[E578] = Cast([E578] as int)
      ,[E579] = Cast([E579] as int)
      ,[E581] = Cast([E581] as int)
      ,[E582] = Cast([E582] as int)
      ,[E583] = Cast([E583] as int)
      ,[E584] = Cast([E584] as int)
      ,[E585] = Cast([E585] as int)
      ,[E586] = Cast([E586] as int)
      ,[E587] = Cast([E587] as int)
      ,[E588] = Cast([E588] as int)
      ,[E589] = Cast([E589] as int)
      ,[E591] = Cast([E591] as int)
      ,[E592] = Cast([E592] as int)
      ,[E593] = Cast([E593] as int)
      ,[E594] = Cast([E594] as int)
      ,[E595] = Cast([E595] as int)
      ,[E596] = Cast([E596] as int)
      ,[E597] = Cast([E597] as int)
      ,[E598] = Cast([E598] as int)
      ,[E599] = Cast([E599] as int)
      ,[E601] = Cast([E601] as int)
      ,[E602] = Cast([E602] as int)
      ,[E603] = Cast([E603] as int)
      ,[E604] = Cast([E604] as int)
      ,[E605] = Cast([E605] as int)
      ,[E606] = Cast([E606] as int)
      ,[E607] = Cast([E607] as int)
      ,[E608] = Cast([E608] as int)
      ,[E609] = Cast([E609] as int)
      ,[E611] = Cast([E611] as int)
      ,[E612] = Cast([E612] as int)
      ,[E613] = Cast([E613] as int)
      ,[E614] = Cast([E614] as int)
      ,[E615] = Cast([E615] as int)
      ,[E616] = Cast([E616] as int)
      ,[E617] = Cast([E617] as int)
      ,[E618] = Cast([E618] as int)
      ,[E619] = Cast([E619] as int)
      ,[E621] = Cast([E621] as int)
      ,[E622] = Cast([E622] as int)
      ,[E623] = Cast([E623] as int)
      ,[E624] = Cast([E624] as int)
      ,[E625] = Cast([E625] as int)
      ,[E626] = Cast([E626] as int)
      ,[E627] = Cast([E627] as int)
      ,[E628] = Cast([E628] as int)
      ,[E629] = Cast([E629] as int)
      ,[E631] = Cast([E631] as int)
      ,[E632] = Cast([E632] as int)
      ,[E633] = Cast([E633] as int)
      ,[E634] = Cast([E634] as int)
      ,[E635] = Cast([E635] as int)
      ,[E636] = Cast([E636] as int)
      ,[E637] = Cast([E637] as int)
      ,[E638] = Cast([E638] as int)
      ,[E639] = Cast([E639] as int)
      ,[E641] = Cast([E641] as int)
      ,[E642] = Cast([E642] as int)
      ,[E643] = Cast([E643] as int)
      ,[E644] = Cast([E644] as int)
      ,[E645] = Cast([E645] as int)
      ,[E646] = Cast([E646] as int)
      ,[E647] = Cast([E647] as int)
      ,[E648] = Cast([E648] as int)
      ,[E649] = Cast([E649] as int)
      ,[E651] = Cast([E651] as int)
      ,[E652] = Cast([E652] as int)
      ,[E653] = Cast([E653] as int)
      ,[E654] = Cast([E654] as int)
      ,[E655] = Cast([E655] as int)
      ,[E656] = Cast([E656] as int)
      ,[E657] = Cast([E657] as int)
      ,[E658] = Cast([E658] as int)
      ,[E659] = Cast([E659] as int)
      ,[E661] = Cast([E661] as int)
      ,[E662] = Cast([E662] as int)
      ,[E663] = Cast([E663] as int)
      ,[E664] = Cast([E664] as int)
      ,[E665] = Cast([E665] as int)
      ,[E666] = Cast([E666] as int)
      ,[E667] = Cast([E667] as int)
      ,[E668] = Cast([E668] as int)
      ,[E669] = Cast([E669] as int)
      ,[E671] = Cast([E671] as int)
      ,[E672] = Cast([E672] as int)
      ,[E673] = Cast([E673] as int)
      ,[E674] = Cast([E674] as int)
      ,[E675] = Cast([E675] as int)
      ,[E676] = Cast([E676] as int)
      ,[E677] = Cast([E677] as int)
      ,[E678] = Cast([E678] as int)
      ,[E679] = Cast([E679] as int)
      ,[E681] = Cast([E681] as int)
      ,[E682] = Cast([E682] as int)
      ,[E683] = Cast([E683] as int)
      ,[E684] = Cast([E684] as int)
      ,[E685] = Cast([E685] as int)
      ,[E686] = Cast([E686] as int)
      ,[E687] = Cast([E687] as int)
      ,[E688] = Cast([E688] as int)
      ,[E689] = Cast([E689] as int)
      ,[E691] = Cast([E691] as int)
      ,[E692] = Cast([E692] as int)
      ,[E693] = Cast([E693] as int)
      ,[E694] = Cast([E694] as int)
      ,[E695] = Cast([E695] as int)
      ,[E696] = Cast([E696] as int)
      ,[E697] = Cast([E697] as int)
      ,[E698] = Cast([E698] as int)
      ,[E699] = Cast([E699] as int)
      ,[E701] = Cast([E701] as int)
      ,[E702] = Cast([E702] as int)
      ,[E703] = Cast([E703] as int)
      ,[E704] = Cast([E704] as int)
      ,[E705] = Cast([E705] as int)
      ,[E706] = Cast([E706] as int)
      ,[E707] = Cast([E707] as int)
      ,[E708] = Cast([E708] as int)
      ,[E709] = Cast([E709] as int)
      ,[E711] = Cast([E711] as int)
      ,[E712] = Cast([E712] as int)
      ,[E713] = Cast([E713] as int)
      ,[E714] = Cast([E714] as int)
      ,[E715] = Cast([E715] as int)
      ,[E716] = Cast([E716] as int)
      ,[E717] = Cast([E717] as int)
      ,[E718] = Cast([E718] as int)
      ,[E719] = Cast([E719] as int)
      ,[E721] = Cast([E721] as int)
      ,[E722] = Cast([E722] as int)
      ,[E723] = Cast([E723] as int)
      ,[E724] = Cast([E724] as int)
      ,[E725] = Cast([E725] as int)
      ,[E726] = Cast([E726] as int)
      ,[E727] = Cast([E727] as int)
      ,[E728] = Cast([E728] as int)
      ,[E729] = Cast([E729] as int)
      ,[E731] = Cast([E731] as int)
      ,[E732] = Cast([E732] as int)
      ,[E733] = Cast([E733] as int)
      ,[E734] = Cast([E734] as int)
      ,[E735] = Cast([E735] as int)
      ,[E736] = Cast([E736] as int)
      ,[E737] = Cast([E737] as int)
      ,[E738] = Cast([E738] as int)
      ,[E739] = Cast([E739] as int)
      ,[E741] = Cast([E741] as int)
      ,[E742] = Cast([E742] as int)
      ,[E743] = Cast([E743] as int)
      ,[E744] = Cast([E744] as int)
      ,[E745] = Cast([E745] as int)
      ,[E746] = Cast([E746] as int)
      ,[E747] = Cast([E747] as int)
      ,[E748] = Cast([E748] as int)
      ,[E749] = Cast([E749] as int)
      ,[E751] = Cast([E751] as int)
      ,[E752] = Cast([E752] as int)
      ,[E753] = Cast([E753] as int)
      ,[E754] = Cast([E754] as int)
      ,[E755] = Cast([E755] as int)
      ,[E756] = Cast([E756] as int)
      ,[E757] = Cast([E757] as int)
      ,[E758] = Cast([E758] as int)
      ,[E759] = Cast([E759] as int)
      ,[E1] = Cast([E1] as int)
      ,[E2] = Cast([E2] as int)
      ,[E3] = Cast([E3] as int)
      ,[E4] = Cast([E4] as int)
      ,[E5] = Cast([E5] as int)
      ,[E6] = Cast([E6] as int)
      ,[E7] = Cast([E7] as int)
      ,[E8] = Cast([E8] as int)
      ,[E9] = Cast([E9] as int)
      ,[osa15] = Cast([osa15] as int)
      ,[nai15] = Cast([nai15] as int)
      ,[osa16] = Cast([osa16] as int)
      ,[nai16] = Cast([nai16] as int)
      ,[tietolahde] = CAST(tietolahde as nvarchar(50))
      ,aineisto = CAST(''2.11'' as varchar(5))
      ,[rivinumero] = CAST(rivinumero as int)
FROM (
SELECT [tilv]
      ,[tunn]
      ,[jarj]
      ,[osa1]
      ,[suo1]
      ,[osa2]
      ,[suo2]
      ,[osa3]
      ,[suo3]
      ,[kur4]
      ,[osa4]
      ,[nai4]
      ,[tun4]
      ,[kur5]
      ,[osa5]
      ,[nai5]
      ,[tun5]
      ,[kur6]
      ,[osa6]
      ,[nai6]
      ,[tun6]
      ,[kur7]
      ,[osa7]
      ,[nai7]
      ,[kur8]
      ,[osa8]
      ,[nai8]
      ,[kur9]
      ,[osa9]
      ,[nai9]
      ,[kur10]
      ,[osa10]
      ,[nai10]
      ,[kur11]
      ,[osa11]
      ,[nai11]
      ,[kur12]
      ,[osa12]
      ,[nai12]
      ,[kur13]
      ,[osa13]
      ,[nai13]
      ,[kur14]
      ,[osa14]
      ,[nai14]
      ,[kurd]
      ,[osad]
      ,[naid]
      ,[E11]
      ,[E12]
      ,[E13]
      ,[E14]
      ,[E15]
      ,[E16]
      ,[E17]
      ,[E18]
      ,[E19]
      ,[E21]
      ,[E22]
      ,[E23]
      ,[E24]
      ,[E25]
      ,[E26]
      ,[E27]
      ,[E28]
      ,[E29]
      ,[E31]
      ,[E32]
      ,[E33]
      ,[E34]
      ,[E35]
      ,[E36]
      ,[E37]
      ,[E38]
      ,[E39]
      ,[E41]
      ,[E42]
      ,[E43]
      ,[E44]
      ,[E45]
      ,[E46]
      ,[E47]
      ,[E48]
      ,[E49]
      ,[E51]
      ,[E52]
      ,[E53]
      ,[E54]
      ,[E55]
      ,[E56]
      ,[E57]
      ,[E58]
      ,[E59]
      ,[E61]
      ,[E62]
      ,[E63]
      ,[E64]
      ,[E65]
      ,[E66]
      ,[E67]
      ,[E68]
      ,[E69]
      ,[E71]
      ,[E72]
      ,[E73]
      ,[E74]
      ,[E75]
      ,[E76]
      ,[E77]
      ,[E78]
      ,[E79]
      ,[E81]
      ,[E82]
      ,[E83]
      ,[E84]
      ,[E85]
      ,[E86]
      ,[E87]
      ,[E88]
      ,[E89]
      ,[E91]
      ,[E92]
      ,[E93]
      ,[E94]
      ,[E95]
      ,[E96]
      ,[E97]
      ,[E98]
      ,[E99]
      ,[E101]
      ,[E102]
      ,[E103]
      ,[E104]
      ,[E105]
      ,[E106]
      ,[E107]
      ,[E108]
      ,[E109]
      ,[E111]
      ,[E112]
      ,[E113]
      ,[E114]
      ,[E115]
      ,[E116]
      ,[E117]
      ,[E118]
      ,[E119]
      ,[E121]
      ,[E122]
      ,[E123]
      ,[E124]
      ,[E125]
      ,[E126]
      ,[E127]
      ,[E128]
      ,[E129]
      ,[E131]
      ,[E132]
      ,[E133]
      ,[E134]
      ,[E135]
      ,[E136]
      ,[E137]
      ,[E138]
      ,[E139]
      ,[E141]
      ,[E142]
      ,[E143]
      ,[E144]
      ,[E145]
      ,[E146]
      ,[E147]
      ,[E148]
      ,[E149]
      ,[E151]
      ,[E152]
      ,[E153]
      ,[E154]
      ,[E155]
      ,[E156]
      ,[E157]
      ,[E158]
      ,[E159]
      ,[E161]
      ,[E162]
      ,[E163]
      ,[E164]
      ,[E165]
      ,[E166]
      ,[E167]
      ,[E168]
      ,[E169]
      ,[E171]
      ,[E172]
      ,[E173]
      ,[E174]
      ,[E175]
      ,[E176]
      ,[E177]
      ,[E178]
      ,[E179]
      ,[E181]
      ,[E182]
      ,[E183]
      ,[E184]
      ,[E185]
      ,[E186]
      ,[E187]
      ,[E188]
      ,[E189]
      ,[E191]
      ,[E192]
      ,[E193]
      ,[E194]
      ,[E195]
      ,[E196]
      ,[E197]
      ,[E198]
      ,[E199]
      ,[E201]
      ,[E202]
      ,[E203]
      ,[E204]
      ,[E205]
      ,[E206]
      ,[E207]
      ,[E208]
      ,[E209]
      ,[E211]
      ,[E212]
      ,[E213]
      ,[E214]
      ,[E215]
      ,[E216]
      ,[E217]
      ,[E218]
      ,[E219]
      ,[E221]
      ,[E222]
      ,[E223]
      ,[E224]
      ,[E225]
      ,[E226]
      ,[E227]
      ,[E228]
      ,[E229]
      ,[E231]
      ,[E232]
      ,[E233]
      ,[E234]
      ,[E235]
      ,[E236]
      ,[E237]
      ,[E238]
      ,[E239]
      ,[E241]
      ,[E242]
      ,[E243]
      ,[E244]
      ,[E245]
      ,[E246]
      ,[E247]
      ,[E248]
      ,[E249]
      ,[E251]
      ,[E252]
      ,[E253]
      ,[E254]
      ,[E255]
      ,[E256]
      ,[E257]
      ,[E258]
      ,[E259]
      ,[E261]
      ,[E262]
      ,[E263]
      ,[E264]
      ,[E265]
      ,[E266]
      ,[E267]
      ,[E268]
      ,[E269]
      ,[E271]
      ,[E272]
      ,[E273]
      ,[E274]
      ,[E275]
      ,[E276]
      ,[E277]
      ,[E278]
      ,[E279]
      ,[E281]
      ,[E282]
      ,[E283]
      ,[E284]
      ,[E285]
      ,[E286]
      ,[E287]
      ,[E288]
      ,[E289]
      ,[E291]
      ,[E292]
      ,[E293]
      ,[E294]
      ,[E295]
      ,[E296]
      ,[E297]
      ,[E298]
      ,[E299]
      ,[E301]
      ,[E302]
      ,[E303]
      ,[E304]
      ,[E305]
      ,[E306]
      ,[E307]
      ,[E308]
      ,[E309]
      ,[E311]
      ,[E312]
      ,[E313]
      ,[E314]
      ,[E315]
      ,[E316]
      ,[E317]
      ,[E318]
      ,[E319]
      ,[E321]
      ,[E322]
      ,[E323]
      ,[E324]
      ,[E325]
      ,[E326]
      ,[E327]
      ,[E328]
      ,[E329]
      ,[E331]
      ,[E332]
      ,[E333]
      ,[E334]
      ,[E335]
      ,[E336]
      ,[E337]
      ,[E338]
      ,[E339]
      ,[E341]
      ,[E342]
      ,[E343]
      ,[E344]
      ,[E345]
      ,[E346]
      ,[E347]
      ,[E348]
      ,[E349]
      ,[E351]
      ,[E352]
      ,[E353]
      ,[E354]
      ,[E355]
      ,[E356]
      ,[E357]
      ,[E358]
      ,[E359]
      ,[E361]
      ,[E362]
      ,[E363]
      ,[E364]
      ,[E365]
      ,[E366]
      ,[E367]
      ,[E368]
      ,[E369]
      ,[E371]
      ,[E372]
      ,[E373]
      ,[E374]
      ,[E375]
      ,[E376]
      ,[E377]
      ,[E378]
      ,[E379]
      ,[E381]
      ,[E382]
      ,[E383]
      ,[E384]
      ,[E385]
      ,[E386]
      ,[E387]
      ,[E388]
      ,[E389]
      ,[E391]
      ,[E392]
      ,[E393]
      ,[E394]
      ,[E395]
      ,[E396]
      ,[E397]
      ,[E398]
      ,[E399]
      ,[E401]
      ,[E402]
      ,[E403]
      ,[E404]
      ,[E405]
      ,[E406]
      ,[E407]
      ,[E408]
      ,[E409]
      ,[E411]
      ,[E412]
      ,[E413]
      ,[E414]
      ,[E415]
      ,[E416]
      ,[E417]
      ,[E418]
      ,[E419]
      ,[E421]
      ,[E422]
      ,[E423]
      ,[E424]
      ,[E425]
      ,[E426]
      ,[E427]
      ,[E428]
      ,[E429]
      ,[E431]
      ,[E432]
      ,[E433]
      ,[E434]
      ,[E435]
      ,[E436]
      ,[E437]
      ,[E438]
      ,[E439]
      ,[E441]
      ,[E442]
      ,[E443]
      ,[E444]
      ,[E445]
      ,[E446]
      ,[E447]
      ,[E448]
      ,[E449]
      ,[E451]
      ,[E452]
      ,[E453]
      ,[E454]
      ,[E455]
      ,[E456]
      ,[E457]
      ,[E458]
      ,[E459]
      ,[E461]
      ,[E462]
      ,[E463]
      ,[E464]
      ,[E465]
      ,[E466]
      ,[E467]
      ,[E468]
      ,[E469]
      ,[E471]
      ,[E472]
      ,[E473]
      ,[E474]
      ,[E475]
      ,[E476]
      ,[E477]
      ,[E478]
      ,[E479]
      ,[E481]
      ,[E482]
      ,[E483]
      ,[E484]
      ,[E485]
      ,[E486]
      ,[E487]
      ,[E488]
      ,[E489]
      ,[E491]
      ,[E492]
      ,[E493]
      ,[E494]
      ,[E495]
      ,[E496]
      ,[E497]
      ,[E498]
      ,[E499]
      ,[E501]
      ,[E502]
      ,[E503]
      ,[E504]
      ,[E505]
      ,[E506]
      ,[E507]
      ,[E508]
      ,[E509]
      ,[E511]
      ,[E512]
      ,[E513]
      ,[E514]
      ,[E515]
      ,[E516]
      ,[E517]
      ,[E518]
      ,[E519]
      ,[E521]
      ,[E522]
      ,[E523]
      ,[E524]
      ,[E525]
      ,[E526]
      ,[E527]
      ,[E528]
      ,[E529]
      ,[E531]
      ,[E532]
      ,[E533]
      ,[E534]
      ,[E535]
      ,[E536]
      ,[E537]
      ,[E538]
      ,[E539]
      ,[E541]
      ,[E542]
      ,[E543]
      ,[E544]
      ,[E545]
      ,[E546]
      ,[E547]
      ,[E548]
      ,[E549]
      ,[E551]
      ,[E552]
      ,[E553]
      ,[E554]
      ,[E555]
      ,[E556]
      ,[E557]
      ,[E558]
      ,[E559]
      ,[E561]
      ,[E562]
      ,[E563]
      ,[E564]
      ,[E565]
      ,[E566]
      ,[E567]
      ,[E568]
      ,[E569]
      ,[E571]
      ,[E572]
      ,[E573]
      ,[E574]
      ,[E575]
      ,[E576]
      ,[E577]
      ,[E578]
      ,[E579]
      ,[E581]
      ,[E582]
      ,[E583]
      ,[E584]
      ,[E585]
      ,[E586]
      ,[E587]
      ,[E588]
      ,[E589]
      ,[E591]
      ,[E592]
      ,[E593]
      ,[E594]
      ,[E595]
      ,[E596]
      ,[E597]
      ,[E598]
      ,[E599]
      ,[E601]
      ,[E602]
      ,[E603]
      ,[E604]
      ,[E605]
      ,[E606]
      ,[E607]
      ,[E608]
      ,[E609]
      ,[E611]
      ,[E612]
      ,[E613]
      ,[E614]
      ,[E615]
      ,[E616]
      ,[E617]
      ,[E618]
      ,[E619]
      ,[E621]
      ,[E622]
      ,[E623]
      ,[E624]
      ,[E625]
      ,[E626]
      ,[E627]
      ,[E628]
      ,[E629]
      ,[E631]
      ,[E632]
      ,[E633]
      ,[E634]
      ,[E635]
      ,[E636]
      ,[E637]
      ,[E638]
      ,[E639]
      ,[E641]
      ,[E642]
      ,[E643]
      ,[E644]
      ,[E645]
      ,[E646]
      ,[E647]
      ,[E648]
      ,[E649]
      ,[E651]
      ,[E652]
      ,[E653]
      ,[E654]
      ,[E655]
      ,[E656]
      ,[E657]
      ,[E658]
      ,[E659]
      ,[E661]
      ,[E662]
      ,[E663]
      ,[E664]
      ,[E665]
      ,[E666]
      ,[E667]
      ,[E668]
      ,[E669]
      ,[E671]
      ,[E672]
      ,[E673]
      ,[E674]
      ,[E675]
      ,[E676]
      ,[E677]
      ,[E678]
      ,[E679]
      ,[E681]
      ,[E682]
      ,[E683]
      ,[E684]
      ,[E685]
      ,[E686]
      ,[E687]
      ,[E688]
      ,[E689]
      ,[E691]
      ,[E692]
      ,[E693]
      ,[E694]
      ,[E695]
      ,[E696]
      ,[E697]
      ,[E698]
      ,[E699]
      ,[E701]
      ,[E702]
      ,[E703]
      ,[E704]
      ,[E705]
      ,[E706]
      ,[E707]
      ,[E708]
      ,[E709]
      ,[E711]
      ,[E712]
      ,[E713]
      ,[E714]
      ,[E715]
      ,[E716]
      ,[E717]
      ,[E718]
      ,[E719]
      ,[E721]
      ,[E722]
      ,[E723]
      ,[E724]
      ,[E725]
      ,[E726]
      ,[E727]
      ,[E728]
      ,[E729]
      ,[E731]
      ,[E732]
      ,[E733]
      ,[E734]
      ,[E735]
      ,[E736]
      ,[E737]
      ,[E738]
      ,[E739]
      ,[E741]
      ,[E742]
      ,[E743]
      ,[E744]
      ,[E745]
      ,[E746]
      ,[E747]
      ,[E748]
      ,[E749]
      ,[E751]
      ,[E752]
      ,[E753]
      ,[E754]
      ,[E755]
      ,[E756]
      ,[E757]
      ,[E758]
      ,[E759]
      ,[E1]
      ,[E2]
      ,[E3]
      ,[E4]
      ,[E5]
      ,[E6]
      ,[E7]
      ,[E8]
      ,[E9]
      ,[osa15]
      ,[nai15]
      ,[osa16]
      ,[nai16]
      ,[tietolahde] = ''2_11_sopv_11''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv, tunn)
  FROM [TK_H9098_CSC].[dbo].[TK_2_11_sopv_11]
 -- FROM okm.okm_ktpo_tiedontuotanto_in.[sa_2.11_Oppilaitosten_tutkintoon_johtamaton_11]

UNION ALL

SELECT [tilv]
      ,[tunn]
      ,[jarj]
      ,[osa1]
      ,[suo1]
      ,[osa2]
      ,[suo2]
      ,[osa3]
      ,[suo3]
      ,[kur4]
      ,[osa4]
      ,[nai4]
      ,[tun4]
      ,[kur5]
      ,[osa5]
      ,[nai5]
      ,[tun5]
      ,[kur6]
      ,[osa6]
      ,[nai6]
      ,[tun6]
      ,[kur7]
      ,[osa7]
      ,[nai7]
      ,[kur8]
      ,[osa8]
      ,[nai8]
      ,[kur9]
      ,[osa9]
      ,[nai9]
      ,[kur10]
      ,[osa10]
      ,[nai10]
      ,[kur11]
      ,[osa11]
      ,[nai11]
      ,[kur12]
      ,[osa12]
      ,[nai12]
      ,[kur13]
      ,[osa13]
      ,[nai13]
      ,[kur14]
      ,[osa14]
      ,[nai14]
      ,[kurd]
      ,[osad]
      ,[naid]
      ,[E11]
      ,[E12]
      ,[E13]
      ,[E14]
      ,[E15]
      ,[E16]
      ,[E17]
      ,[E18]
      ,[E19]
      ,[E21]
      ,[E22]
      ,[E23]
      ,[E24]
      ,[E25]
      ,[E26]
      ,[E27]
      ,[E28]
      ,[E29]
      ,[E31]
      ,[E32]
      ,[E33]
      ,[E34]
      ,[E35]
      ,[E36]
      ,[E37]
      ,[E38]
      ,[E39]
      ,[E41]
      ,[E42]
      ,[E43]
      ,[E44]
      ,[E45]
      ,[E46]
      ,[E47]
      ,[E48]
      ,[E49]
      ,[E51]
      ,[E52]
      ,[E53]
      ,[E54]
      ,[E55]
      ,[E56]
      ,[E57]
      ,[E58]
      ,[E59]
      ,[E61]
      ,[E62]
      ,[E63]
      ,[E64]
      ,[E65]
      ,[E66]
      ,[E67]
      ,[E68]
      ,[E69]
      ,[E71]
      ,[E72]
      ,[E73]
      ,[E74]
      ,[E75]
      ,[E76]
      ,[E77]
      ,[E78]
      ,[E79]
      ,[E81]
      ,[E82]
      ,[E83]
      ,[E84]
      ,[E85]
      ,[E86]
      ,[E87]
      ,[E88]
      ,[E89]
      ,[E91]
      ,[E92]
      ,[E93]
      ,[E94]
      ,[E95]
      ,[E96]
      ,[E97]
      ,[E98]
      ,[E99]
      ,[E101]
      ,[E102]
      ,[E103]
      ,[E104]
      ,[E105]
      ,[E106]
      ,[E107]
      ,[E108]
      ,[E109]
      ,[E111]
      ,[E112]
      ,[E113]
      ,[E114]
      ,[E115]
      ,[E116]
      ,[E117]
      ,[E118]
      ,[E119]
      ,[E121]
      ,[E122]
      ,[E123]
      ,[E124]
      ,[E125]
      ,[E126]
      ,[E127]
      ,[E128]
      ,[E129]
      ,[E131]
      ,[E132]
      ,[E133]
      ,[E134]
      ,[E135]
      ,[E136]
      ,[E137]
      ,[E138]
      ,[E139]
      ,[E141]
      ,[E142]
      ,[E143]
      ,[E144]
      ,[E145]
      ,[E146]
      ,[E147]
      ,[E148]
      ,[E149]
      ,[E151]
      ,[E152]
      ,[E153]
      ,[E154]
      ,[E155]
      ,[E156]
      ,[E157]
      ,[E158]
      ,[E159]
      ,[E161]
      ,[E162]
      ,[E163]
      ,[E164]
      ,[E165]
      ,[E166]
      ,[E167]
      ,[E168]
      ,[E169]
      ,[E171]
      ,[E172]
      ,[E173]
      ,[E174]
      ,[E175]
      ,[E176]
      ,[E177]
      ,[E178]
      ,[E179]
      ,[E181]
      ,[E182]
      ,[E183]
      ,[E184]
      ,[E185]
      ,[E186]
      ,[E187]
      ,[E188]
      ,[E189]
      ,[E191]
      ,[E192]
      ,[E193]
      ,[E194]
      ,[E195]
      ,[E196]
      ,[E197]
      ,[E198]
      ,[E199]
      ,[E201]
      ,[E202]
      ,[E203]
      ,[E204]
      ,[E205]
      ,[E206]
      ,[E207]
      ,[E208]
      ,[E209]
      ,[E211]
      ,[E212]
      ,[E213]
      ,[E214]
      ,[E215]
      ,[E216]
      ,[E217]
      ,[E218]
      ,[E219]
      ,[E221]
      ,[E222]
      ,[E223]
      ,[E224]
      ,[E225]
      ,[E226]
      ,[E227]
      ,[E228]
      ,[E229]
      ,[E231]
      ,[E232]
      ,[E233]
      ,[E234]
      ,[E235]
      ,[E236]
      ,[E237]
      ,[E238]
      ,[E239]
      ,[E241]
      ,[E242]
      ,[E243]
      ,[E244]
      ,[E245]
      ,[E246]
      ,[E247]
      ,[E248]
      ,[E249]
      ,[E251]
      ,[E252]
      ,[E253]
      ,[E254]
      ,[E255]
      ,[E256]
      ,[E257]
      ,[E258]
      ,[E259]
      ,[E261]
      ,[E262]
      ,[E263]
      ,[E264]
      ,[E265]
      ,[E266]
      ,[E267]
      ,[E268]
      ,[E269]
      ,[E271]
      ,[E272]
      ,[E273]
      ,[E274]
      ,[E275]
      ,[E276]
      ,[E277]
      ,[E278]
      ,[E279]
      ,[E281]
      ,[E282]
      ,[E283]
      ,[E284]
      ,[E285]
      ,[E286]
      ,[E287]
      ,[E288]
      ,[E289]
      ,[E291]
      ,[E292]
      ,[E293]
      ,[E294]
      ,[E295]
      ,[E296]
      ,[E297]
      ,[E298]
      ,[E299]
      ,[E301]
      ,[E302]
      ,[E303]
      ,[E304]
      ,[E305]
      ,[E306]
      ,[E307]
      ,[E308]
      ,[E309]
      ,[E311]
      ,[E312]
      ,[E313]
      ,[E314]
      ,[E315]
      ,[E316]
      ,[E317]
      ,[E318]
      ,[E319]
      ,[E321]
      ,[E322]
      ,[E323]
      ,[E324]
      ,[E325]
      ,[E326]
      ,[E327]
      ,[E328]
      ,[E329]
      ,[E331]
      ,[E332]
      ,[E333]
      ,[E334]
      ,[E335]
      ,[E336]
      ,[E337]
      ,[E338]
      ,[E339]
      ,[E341]
      ,[E342]
      ,[E343]
      ,[E344]
      ,[E345]
      ,[E346]
      ,[E347]
      ,[E348]
      ,[E349]
      ,[E351]
      ,[E352]
      ,[E353]
      ,[E354]
      ,[E355]
      ,[E356]
      ,[E357]
      ,[E358]
      ,[E359]
      ,[E361]
      ,[E362]
      ,[E363]
      ,[E364]
      ,[E365]
      ,[E366]
      ,[E367]
      ,[E368]
      ,[E369]
      ,[E371]
      ,[E372]
      ,[E373]
      ,[E374]
      ,[E375]
      ,[E376]
      ,[E377]
      ,[E378]
      ,[E379]
      ,[E381]
      ,[E382]
      ,[E383]
      ,[E384]
      ,[E385]
      ,[E386]
      ,[E387]
      ,[E388]
      ,[E389]
      ,[E391]
      ,[E392]
      ,[E393]
      ,[E394]
      ,[E395]
      ,[E396]
      ,[E397]
      ,[E398]
      ,[E399]
      ,[E401]
      ,[E402]
      ,[E403]
      ,[E404]
      ,[E405]
      ,[E406]
      ,[E407]
      ,[E408]
      ,[E409]
      ,[E411]
      ,[E412]
      ,[E413]
      ,[E414]
      ,[E415]
      ,[E416]
      ,[E417]
      ,[E418]
      ,[E419]
      ,[E421]
      ,[E422]
      ,[E423]
      ,[E424]
      ,[E425]
      ,[E426]
      ,[E427]
      ,[E428]
      ,[E429]
      ,[E431]
      ,[E432]
      ,[E433]
      ,[E434]
      ,[E435]
      ,[E436]
      ,[E437]
      ,[E438]
      ,[E439]
      ,[E441]
      ,[E442]
      ,[E443]
      ,[E444]
      ,[E445]
      ,[E446]
      ,[E447]
      ,[E448]
      ,[E449]
      ,[E451]
      ,[E452]
      ,[E453]
      ,[E454]
      ,[E455]
      ,[E456]
      ,[E457]
      ,[E458]
      ,[E459]
      ,[E461]
      ,[E462]
      ,[E463]
      ,[E464]
      ,[E465]
      ,[E466]
      ,[E467]
      ,[E468]
      ,[E469]
      ,[E471]
      ,[E472]
      ,[E473]
      ,[E474]
      ,[E475]
      ,[E476]
      ,[E477]
      ,[E478]
      ,[E479]
      ,[E481]
      ,[E482]
      ,[E483]
      ,[E484]
      ,[E485]
      ,[E486]
      ,[E487]
      ,[E488]
      ,[E489]
      ,[E491]
      ,[E492]
      ,[E493]
      ,[E494]
      ,[E495]
      ,[E496]
      ,[E497]
      ,[E498]
      ,[E499]
      ,[E501]
      ,[E502]
      ,[E503]
      ,[E504]
      ,[E505]
      ,[E506]
      ,[E507]
      ,[E508]
      ,[E509]
      ,[E511]
      ,[E512]
      ,[E513]
      ,[E514]
      ,[E515]
      ,[E516]
      ,[E517]
      ,[E518]
      ,[E519]
      ,[E521]
      ,[E522]
      ,[E523]
      ,[E524]
      ,[E525]
      ,[E526]
      ,[E527]
      ,[E528]
      ,[E529]
      ,[E531]
      ,[E532]
      ,[E533]
      ,[E534]
      ,[E535]
      ,[E536]
      ,[E537]
      ,[E538]
      ,[E539]
      ,[E541]
      ,[E542]
      ,[E543]
      ,[E544]
      ,[E545]
      ,[E546]
      ,[E547]
      ,[E548]
      ,[E549]
      ,[E551]
      ,[E552]
      ,[E553]
      ,[E554]
      ,[E555]
      ,[E556]
      ,[E557]
      ,[E558]
      ,[E559]
      ,[E561]
      ,[E562]
      ,[E563]
      ,[E564]
      ,[E565]
      ,[E566]
      ,[E567]
      ,[E568]
      ,[E569]
      ,[E571]
      ,[E572]
      ,[E573]
      ,[E574]
      ,[E575]
      ,[E576]
      ,[E577]
      ,[E578]
      ,[E579]
      ,[E581]
      ,[E582]
      ,[E583]
      ,[E584]
      ,[E585]
      ,[E586]
      ,[E587]
      ,[E588]
      ,[E589]
      ,[E591]
      ,[E592]
      ,[E593]
      ,[E594]
      ,[E595]
      ,[E596]
      ,[E597]
      ,[E598]
      ,[E599]
      ,[E601]
      ,[E602]
      ,[E603]
      ,[E604]
      ,[E605]
      ,[E606]
      ,[E607]
      ,[E608]
      ,[E609]
      ,[E611]
      ,[E612]
      ,[E613]
      ,[E614]
      ,[E615]
      ,[E616]
      ,[E617]
      ,[E618]
      ,[E619]
      ,[E621]
      ,[E622]
      ,[E623]
      ,[E624]
      ,[E625]
      ,[E626]
      ,[E627]
      ,[E628]
      ,[E629]
      ,[E631]
      ,[E632]
      ,[E633]
      ,[E634]
      ,[E635]
      ,[E636]
      ,[E637]
      ,[E638]
      ,[E639]
      ,[E641]
      ,[E642]
      ,[E643]
      ,[E644]
      ,[E645]
      ,[E646]
      ,[E647]
      ,[E648]
      ,[E649]
      ,[E651]
      ,[E652]
      ,[E653]
      ,[E654]
      ,[E655]
      ,[E656]
      ,[E657]
      ,[E658]
      ,[E659]
      ,[E661]
      ,[E662]
      ,[E663]
      ,[E664]
      ,[E665]
      ,[E666]
      ,[E667]
      ,[E668]
      ,[E669]
      ,[E671]
      ,[E672]
      ,[E673]
      ,[E674]
      ,[E675]
      ,[E676]
      ,[E677]
      ,[E678]
      ,[E679]
      ,[E681]
      ,[E682]
      ,[E683]
      ,[E684]
      ,[E685]
      ,[E686]
      ,[E687]
      ,[E688]
      ,[E689]
      ,[E691]
      ,[E692]
      ,[E693]
      ,[E694]
      ,[E695]
      ,[E696]
      ,[E697]
      ,[E698]
      ,[E699]
      ,[E701]
      ,[E702]
      ,[E703]
      ,[E704]
      ,[E705]
      ,[E706]
      ,[E707]
      ,[E708]
      ,[E709]
      ,[E711]
      ,[E712]
      ,[E713]
      ,[E714]
      ,[E715]
      ,[E716]
      ,[E717]
      ,[E718]
      ,[E719]
      ,[E721]
      ,[E722]
      ,[E723]
      ,[E724]
      ,[E725]
      ,[E726]
      ,[E727]
      ,[E728]
      ,[E729]
      ,[E731]
      ,[E732]
      ,[E733]
      ,[E734]
      ,[E735]
      ,[E736]
      ,[E737]
      ,[E738]
      ,[E739]
      ,[E741]
      ,[E742]
      ,[E743]
      ,[E744]
      ,[E745]
      ,[E746]
      ,[E747]
      ,[E748]
      ,[E749]
      ,[E751]
      ,[E752]
      ,[E753]
      ,[E754]
      ,[E755]
      ,[E756]
      ,[E757]
      ,[E758]
      ,[E759]
      ,[E1]
      ,[E2]
      ,[E3]
      ,[E4]
      ,[E5]
      ,[E6]
      ,[E7]
      ,[E8]
      ,[E9]
      ,[osa15]
      ,[nai15]
      ,[osa16]
      ,[nai16]
      ,[tietolahde] = ''2_11_sopv_12''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv, tunn)
  FROM [TK_H9098_CSC].[dbo].[TK_2_11_sopv_12]
  --FROM okm.okm_ktpo_tiedontuotanto_in.[sa_2.11_Oppilaitosten_tutkintoon_johtamaton_12]

UNION ALL

SELECT [tilv]
      ,[tunn]
      ,[jarj]
      ,[osa1]
      ,[suo1]
      ,[osa2]
      ,[suo2]
      ,[osa3]
      ,[suo3]
      ,[kur4]
      ,[osa4]
      ,[nai4]
      ,[tun4]
      ,[kur5]
      ,[osa5]
      ,[nai5]
      ,[tun5]
      ,[kur6]
      ,[osa6]
      ,[nai6]
      ,[tun6]
      ,[kur7]
      ,[osa7]
      ,[nai7]
      ,[kur8]
      ,[osa8]
      ,[nai8]
      ,[kur9]
      ,[osa9]
      ,[nai9]
      ,[kur10]
      ,[osa10]
      ,[nai10]
      ,[kur11]
      ,[osa11]
      ,[nai11]
      ,[kur12]
      ,[osa12]
      ,[nai12]
      ,[kur13]
      ,[osa13]
      ,[nai13]
      ,[kur14]
      ,[osa14]
      ,[nai14]
      ,[kurd]
      ,[osad]
      ,[naid]
      ,[E11]
      ,[E12]
      ,[E13]
      ,[E14]
      ,[E15]
      ,[E16]
      ,[E17]
      ,[E18]
      ,[E19]
      ,[E21]
      ,[E22]
      ,[E23]
      ,[E24]
      ,[E25]
      ,[E26]
      ,[E27]
      ,[E28]
      ,[E29]
      ,[E31]
      ,[E32]
      ,[E33]
      ,[E34]
      ,[E35]
      ,[E36]
      ,[E37]
      ,[E38]
      ,[E39]
      ,[E41]
      ,[E42]
      ,[E43]
      ,[E44]
      ,[E45]
      ,[E46]
      ,[E47]
      ,[E48]
      ,[E49]
      ,[E51]
      ,[E52]
      ,[E53]
      ,[E54]
      ,[E55]
      ,[E56]
      ,[E57]
      ,[E58]
      ,[E59]
      ,[E61]
      ,[E62]
      ,[E63]
      ,[E64]
      ,[E65]
      ,[E66]
      ,[E67]
      ,[E68]
      ,[E69]
      ,[E71]
      ,[E72]
      ,[E73]
      ,[E74]
      ,[E75]
      ,[E76]
      ,[E77]
      ,[E78]
      ,[E79]
      ,[E81]
      ,[E82]
      ,[E83]
      ,[E84]
      ,[E85]
      ,[E86]
      ,[E87]
      ,[E88]
      ,[E89]
      ,[E91]
      ,[E92]
      ,[E93]
      ,[E94]
      ,[E95]
      ,[E96]
      ,[E97]
      ,[E98]
      ,[E99]
      ,[E101]
      ,[E102]
      ,[E103]
      ,[E104]
      ,[E105]
      ,[E106]
      ,[E107]
      ,[E108]
      ,[E109]
      ,[E111]
      ,[E112]
      ,[E113]
      ,[E114]
      ,[E115]
      ,[E116]
      ,[E117]
      ,[E118]
      ,[E119]
      ,[E121]
      ,[E122]
      ,[E123]
      ,[E124]
      ,[E125]
      ,[E126]
      ,[E127]
      ,[E128]
      ,[E129]
      ,[E131]
      ,[E132]
      ,[E133]
      ,[E134]
      ,[E135]
      ,[E136]
      ,[E137]
      ,[E138]
      ,[E139]
      ,[E141]
      ,[E142]
      ,[E143]
      ,[E144]
      ,[E145]
      ,[E146]
      ,[E147]
      ,[E148]
      ,[E149]
      ,[E151]
      ,[E152]
      ,[E153]
      ,[E154]
      ,[E155]
      ,[E156]
      ,[E157]
      ,[E158]
      ,[E159]
      ,[E161]
      ,[E162]
      ,[E163]
      ,[E164]
      ,[E165]
      ,[E166]
      ,[E167]
      ,[E168]
      ,[E169]
      ,[E171]
      ,[E172]
      ,[E173]
      ,[E174]
      ,[E175]
      ,[E176]
      ,[E177]
      ,[E178]
      ,[E179]
      ,[E181]
      ,[E182]
      ,[E183]
      ,[E184]
      ,[E185]
      ,[E186]
      ,[E187]
      ,[E188]
      ,[E189]
      ,[E191]
      ,[E192]
      ,[E193]
      ,[E194]
      ,[E195]
      ,[E196]
      ,[E197]
      ,[E198]
      ,[E199]
      ,[E201]
      ,[E202]
      ,[E203]
      ,[E204]
      ,[E205]
      ,[E206]
      ,[E207]
      ,[E208]
      ,[E209]
      ,[E211]
      ,[E212]
      ,[E213]
      ,[E214]
      ,[E215]
      ,[E216]
      ,[E217]
      ,[E218]
      ,[E219]
      ,[E221]
      ,[E222]
      ,[E223]
      ,[E224]
      ,[E225]
      ,[E226]
      ,[E227]
      ,[E228]
      ,[E229]
      ,[E231]
      ,[E232]
      ,[E233]
      ,[E234]
      ,[E235]
      ,[E236]
      ,[E237]
      ,[E238]
      ,[E239]
      ,[E241]
      ,[E242]
      ,[E243]
      ,[E244]
      ,[E245]
      ,[E246]
      ,[E247]
      ,[E248]
      ,[E249]
      ,[E251]
      ,[E252]
      ,[E253]
      ,[E254]
      ,[E255]
      ,[E256]
      ,[E257]
      ,[E258]
      ,[E259]
      ,[E261]
      ,[E262]
      ,[E263]
      ,[E264]
      ,[E265]
      ,[E266]
      ,[E267]
      ,[E268]
      ,[E269]
      ,[E271]
      ,[E272]
      ,[E273]
      ,[E274]
      ,[E275]
      ,[E276]
      ,[E277]
      ,[E278]
      ,[E279]
      ,[E281]
      ,[E282]
      ,[E283]
      ,[E284]
      ,[E285]
      ,[E286]
      ,[E287]
      ,[E288]
      ,[E289]
      ,[E291]
      ,[E292]
      ,[E293]
      ,[E294]
      ,[E295]
      ,[E296]
      ,[E297]
      ,[E298]
      ,[E299]
      ,[E301]
      ,[E302]
      ,[E303]
      ,[E304]
      ,[E305]
      ,[E306]
      ,[E307]
      ,[E308]
      ,[E309]
      ,[E311]
      ,[E312]
      ,[E313]
      ,[E314]
      ,[E315]
      ,[E316]
      ,[E317]
      ,[E318]
      ,[E319]
      ,[E321]
      ,[E322]
      ,[E323]
      ,[E324]
      ,[E325]
      ,[E326]
      ,[E327]
      ,[E328]
      ,[E329]
      ,[E331]
      ,[E332]
      ,[E333]
      ,[E334]
      ,[E335]
      ,[E336]
      ,[E337]
      ,[E338]
      ,[E339]
      ,[E341]
      ,[E342]
      ,[E343]
      ,[E344]
      ,[E345]
      ,[E346]
      ,[E347]
      ,[E348]
      ,[E349]
      ,[E351]
      ,[E352]
      ,[E353]
      ,[E354]
      ,[E355]
      ,[E356]
      ,[E357]
      ,[E358]
      ,[E359]
      ,[E361]
      ,[E362]
      ,[E363]
      ,[E364]
      ,[E365]
      ,[E366]
      ,[E367]
      ,[E368]
      ,[E369]
      ,[E371]
      ,[E372]
      ,[E373]
      ,[E374]
      ,[E375]
      ,[E376]
      ,[E377]
      ,[E378]
      ,[E379]
      ,[E381]
      ,[E382]
      ,[E383]
      ,[E384]
      ,[E385]
      ,[E386]
      ,[E387]
      ,[E388]
      ,[E389]
      ,[E391]
      ,[E392]
      ,[E393]
      ,[E394]
      ,[E395]
      ,[E396]
      ,[E397]
      ,[E398]
      ,[E399]
      ,[E401]
      ,[E402]
      ,[E403]
      ,[E404]
      ,[E405]
      ,[E406]
      ,[E407]
      ,[E408]
      ,[E409]
      ,[E411]
      ,[E412]
      ,[E413]
      ,[E414]
      ,[E415]
      ,[E416]
      ,[E417]
      ,[E418]
      ,[E419]
      ,[E421]
      ,[E422]
      ,[E423]
      ,[E424]
      ,[E425]
      ,[E426]
      ,[E427]
      ,[E428]
      ,[E429]
      ,[E431]
      ,[E432]
      ,[E433]
      ,[E434]
      ,[E435]
      ,[E436]
      ,[E437]
      ,[E438]
      ,[E439]
      ,[E441]
      ,[E442]
      ,[E443]
      ,[E444]
      ,[E445]
      ,[E446]
      ,[E447]
      ,[E448]
      ,[E449]
      ,[E451]
      ,[E452]
      ,[E453]
      ,[E454]
      ,[E455]
      ,[E456]
      ,[E457]
      ,[E458]
      ,[E459]
      ,[E461]
      ,[E462]
      ,[E463]
      ,[E464]
      ,[E465]
      ,[E466]
      ,[E467]
      ,[E468]
      ,[E469]
      ,[E471]
      ,[E472]
      ,[E473]
      ,[E474]
      ,[E475]
      ,[E476]
      ,[E477]
      ,[E478]
      ,[E479]
      ,[E481]
      ,[E482]
      ,[E483]
      ,[E484]
      ,[E485]
      ,[E486]
      ,[E487]
      ,[E488]
      ,[E489]
      ,[E491]
      ,[E492]
      ,[E493]
      ,[E494]
      ,[E495]
      ,[E496]
      ,[E497]
      ,[E498]
      ,[E499]
      ,[E501]
      ,[E502]
      ,[E503]
      ,[E504]
      ,[E505]
      ,[E506]
      ,[E507]
      ,[E508]
      ,[E509]
      ,[E511]
      ,[E512]
      ,[E513]
      ,[E514]
      ,[E515]
      ,[E516]
      ,[E517]
      ,[E518]
      ,[E519]
      ,[E521]
      ,[E522]
      ,[E523]
      ,[E524]
      ,[E525]
      ,[E526]
      ,[E527]
      ,[E528]
      ,[E529]
      ,[E531]
      ,[E532]
      ,[E533]
      ,[E534]
      ,[E535]
      ,[E536]
      ,[E537]
      ,[E538]
      ,[E539]
      ,[E541]
      ,[E542]
      ,[E543]
      ,[E544]
      ,[E545]
      ,[E546]
      ,[E547]
      ,[E548]
      ,[E549]
      ,[E551]
      ,[E552]
      ,[E553]
      ,[E554]
      ,[E555]
      ,[E556]
      ,[E557]
      ,[E558]
      ,[E559]
      ,[E561]
      ,[E562]
      ,[E563]
      ,[E564]
      ,[E565]
      ,[E566]
      ,[E567]
      ,[E568]
      ,[E569]
      ,[E571]
      ,[E572]
      ,[E573]
      ,[E574]
      ,[E575]
      ,[E576]
      ,[E577]
      ,[E578]
      ,[E579]
      ,[E581]
      ,[E582]
      ,[E583]
      ,[E584]
      ,[E585]
      ,[E586]
      ,[E587]
      ,[E588]
      ,[E589]
      ,[E591]
      ,[E592]
      ,[E593]
      ,[E594]
      ,[E595]
      ,[E596]
      ,[E597]
      ,[E598]
      ,[E599]
      ,[E601]
      ,[E602]
      ,[E603]
      ,[E604]
      ,[E605]
      ,[E606]
      ,[E607]
      ,[E608]
      ,[E609]
      ,[E611]
      ,[E612]
      ,[E613]
      ,[E614]
      ,[E615]
      ,[E616]
      ,[E617]
      ,[E618]
      ,[E619]
      ,[E621]
      ,[E622]
      ,[E623]
      ,[E624]
      ,[E625]
      ,[E626]
      ,[E627]
      ,[E628]
      ,[E629]
      ,[E631]
      ,[E632]
      ,[E633]
      ,[E634]
      ,[E635]
      ,[E636]
      ,[E637]
      ,[E638]
      ,[E639]
      ,[E641]
      ,[E642]
      ,[E643]
      ,[E644]
      ,[E645]
      ,[E646]
      ,[E647]
      ,[E648]
      ,[E649]
      ,[E651]
      ,[E652]
      ,[E653]
      ,[E654]
      ,[E655]
      ,[E656]
      ,[E657]
      ,[E658]
      ,[E659]
      ,[E661]
      ,[E662]
      ,[E663]
      ,[E664]
      ,[E665]
      ,[E666]
      ,[E667]
      ,[E668]
      ,[E669]
      ,[E671]
      ,[E672]
      ,[E673]
      ,[E674]
      ,[E675]
      ,[E676]
      ,[E677]
      ,[E678]
      ,[E679]
      ,[E681]
      ,[E682]
      ,[E683]
      ,[E684]
      ,[E685]
      ,[E686]
      ,[E687]
      ,[E688]
      ,[E689]
      ,[E691]
      ,[E692]
      ,[E693]
      ,[E694]
      ,[E695]
      ,[E696]
      ,[E697]
      ,[E698]
      ,[E699]
      ,[E701]
      ,[E702]
      ,[E703]
      ,[E704]
      ,[E705]
      ,[E706]
      ,[E707]
      ,[E708]
      ,[E709]
      ,[E711]
      ,[E712]
      ,[E713]
      ,[E714]
      ,[E715]
      ,[E716]
      ,[E717]
      ,[E718]
      ,[E719]
      ,[E721]
      ,[E722]
      ,[E723]
      ,[E724]
      ,[E725]
      ,[E726]
      ,[E727]
      ,[E728]
      ,[E729]
      ,[E731]
      ,[E732]
      ,[E733]
      ,[E734]
      ,[E735]
      ,[E736]
      ,[E737]
      ,[E738]
      ,[E739]
      ,[E741]
      ,[E742]
      ,[E743]
      ,[E744]
      ,[E745]
      ,[E746]
      ,[E747]
      ,[E748]
      ,[E749]
      ,[E751]
      ,[E752]
      ,[E753]
      ,[E754]
      ,[E755]
      ,[E756]
      ,[E757]
      ,[E758]
      ,[E759]
      ,[E1]
      ,[E2]
      ,[E3]
      ,[E4]
      ,[E5]
      ,[E6]
      ,[E7]
      ,[E8]
      ,[E9]
      ,[osa15]
      ,[nai15]
      ,[osa16]
      ,[nai16]
      ,[tietolahde] = ''2_11_sopv_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv, tunn)
  FROM [TK_H9098_CSC].[dbo].[TK_2_11_sopv_13]
  
UNION ALL

SELECT [tilv]
      ,[tunn]
      ,[jarj]
      ,[osa1]
      ,[suo1]
      ,[osa2]
      ,[suo2]
      ,[osa3]
      ,[suo3]
      ,[kur4]
      ,[osa4]
      ,[nai4]
      ,[tun4]
      ,[kur5]
      ,[osa5]
      ,[nai5]
      ,[tun5]
      ,[kur6]
      ,[osa6]
      ,[nai6]
      ,[tun6]
      ,[kur7]
      ,[osa7]
      ,[nai7]
      ,[kur8]
      ,[osa8]
      ,[nai8]
      ,[kur9]
      ,[osa9]
      ,[nai9]
      ,[kur10]
      ,[osa10]
      ,[nai10]
      ,[kur11]
      ,[osa11]
      ,[nai11]
      ,[kur12]
      ,[osa12]
      ,[nai12]
      ,[kur13]
      ,[osa13]
      ,[nai13]
      ,[kur14]
      ,[osa14]
      ,[nai14]
      ,[kurd]
      ,[osad]
      ,[naid]
      ,[E11]
      ,[E12]
      ,[E13]
      ,[E14]
      ,[E15]
      ,[E16]
      ,[E17]
      ,[E18]
      ,[E19]
      ,[E21]
      ,[E22]
      ,[E23]
      ,[E24]
      ,[E25]
      ,[E26]
      ,[E27]
      ,[E28]
      ,[E29]
      ,[E31]
      ,[E32]
      ,[E33]
      ,[E34]
      ,[E35]
      ,[E36]
      ,[E37]
      ,[E38]
      ,[E39]
      ,[E41]
      ,[E42]
      ,[E43]
      ,[E44]
      ,[E45]
      ,[E46]
      ,[E47]
      ,[E48]
      ,[E49]
      ,[E51]
      ,[E52]
      ,[E53]
      ,[E54]
      ,[E55]
      ,[E56]
      ,[E57]
      ,[E58]
      ,[E59]
      ,[E61]
      ,[E62]
      ,[E63]
      ,[E64]
      ,[E65]
      ,[E66]
      ,[E67]
      ,[E68]
      ,[E69]
      ,[E71]
      ,[E72]
      ,[E73]
      ,[E74]
      ,[E75]
      ,[E76]
      ,[E77]
      ,[E78]
      ,[E79]
      ,[E81]
      ,[E82]
      ,[E83]
      ,[E84]
      ,[E85]
      ,[E86]
      ,[E87]
      ,[E88]
      ,[E89]
      ,[E91]
      ,[E92]
      ,[E93]
      ,[E94]
      ,[E95]
      ,[E96]
      ,[E97]
      ,[E98]
      ,[E99]
      ,[E101]
      ,[E102]
      ,[E103]
      ,[E104]
      ,[E105]
      ,[E106]
      ,[E107]
      ,[E108]
      ,[E109]
      ,[E111]
      ,[E112]
      ,[E113]
      ,[E114]
      ,[E115]
      ,[E116]
      ,[E117]
      ,[E118]
      ,[E119]
      ,[E121]
      ,[E122]
      ,[E123]
      ,[E124]
      ,[E125]
      ,[E126]
      ,[E127]
      ,[E128]
      ,[E129]
      ,[E131]
      ,[E132]
      ,[E133]
      ,[E134]
      ,[E135]
      ,[E136]
      ,[E137]
      ,[E138]
      ,[E139]
      ,[E141]
      ,[E142]
      ,[E143]
      ,[E144]
      ,[E145]
      ,[E146]
      ,[E147]
      ,[E148]
      ,[E149]
      ,[E151]
      ,[E152]
      ,[E153]
      ,[E154]
      ,[E155]
      ,[E156]
      ,[E157]
      ,[E158]
      ,[E159]
      ,[E161]
      ,[E162]
      ,[E163]
      ,[E164]
      ,[E165]
      ,[E166]
      ,[E167]
      ,[E168]
      ,[E169]
      ,[E171]
      ,[E172]
      ,[E173]
      ,[E174]
      ,[E175]
      ,[E176]
      ,[E177]
      ,[E178]
      ,[E179]
      ,[E181]
      ,[E182]
      ,[E183]
      ,[E184]
      ,[E185]
      ,[E186]
      ,[E187]
      ,[E188]
      ,[E189]
      ,[E191]
      ,[E192]
      ,[E193]
      ,[E194]
      ,[E195]
      ,[E196]
      ,[E197]
      ,[E198]
      ,[E199]
      ,[E201]
      ,[E202]
      ,[E203]
      ,[E204]
      ,[E205]
      ,[E206]
      ,[E207]
      ,[E208]
      ,[E209]
      ,[E211]
      ,[E212]
      ,[E213]
      ,[E214]
      ,[E215]
      ,[E216]
      ,[E217]
      ,[E218]
      ,[E219]
      ,[E221]
      ,[E222]
      ,[E223]
      ,[E224]
      ,[E225]
      ,[E226]
      ,[E227]
      ,[E228]
      ,[E229]
      ,[E231]
      ,[E232]
      ,[E233]
      ,[E234]
      ,[E235]
      ,[E236]
      ,[E237]
      ,[E238]
      ,[E239]
      ,[E241]
      ,[E242]
      ,[E243]
      ,[E244]
      ,[E245]
      ,[E246]
      ,[E247]
      ,[E248]
      ,[E249]
      ,[E251]
      ,[E252]
      ,[E253]
      ,[E254]
      ,[E255]
      ,[E256]
      ,[E257]
      ,[E258]
      ,[E259]
      ,[E261]
      ,[E262]
      ,[E263]
      ,[E264]
      ,[E265]
      ,[E266]
      ,[E267]
      ,[E268]
      ,[E269]
      ,[E271]
      ,[E272]
      ,[E273]
      ,[E274]
      ,[E275]
      ,[E276]
      ,[E277]
      ,[E278]
      ,[E279]
      ,[E281]
      ,[E282]
      ,[E283]
      ,[E284]
      ,[E285]
      ,[E286]
      ,[E287]
      ,[E288]
      ,[E289]
      ,[E291]
      ,[E292]
      ,[E293]
      ,[E294]
      ,[E295]
      ,[E296]
      ,[E297]
      ,[E298]
      ,[E299]
      ,[E301]
      ,[E302]
      ,[E303]
      ,[E304]
      ,[E305]
      ,[E306]
      ,[E307]
      ,[E308]
      ,[E309]
      ,[E311]
      ,[E312]
      ,[E313]
      ,[E314]
      ,[E315]
      ,[E316]
      ,[E317]
      ,[E318]
      ,[E319]
      ,[E321]
      ,[E322]
      ,[E323]
      ,[E324]
      ,[E325]
      ,[E326]
      ,[E327]
      ,[E328]
      ,[E329]
      ,[E331]
      ,[E332]
      ,[E333]
      ,[E334]
      ,[E335]
      ,[E336]
      ,[E337]
      ,[E338]
      ,[E339]
      ,[E341]
      ,[E342]
      ,[E343]
      ,[E344]
      ,[E345]
      ,[E346]
      ,[E347]
      ,[E348]
      ,[E349]
      ,[E351]
      ,[E352]
      ,[E353]
      ,[E354]
      ,[E355]
      ,[E356]
      ,[E357]
      ,[E358]
      ,[E359]
      ,[E361]
      ,[E362]
      ,[E363]
      ,[E364]
      ,[E365]
      ,[E366]
      ,[E367]
      ,[E368]
      ,[E369]
      ,[E371]
      ,[E372]
      ,[E373]
      ,[E374]
      ,[E375]
      ,[E376]
      ,[E377]
      ,[E378]
      ,[E379]
      ,[E381]
      ,[E382]
      ,[E383]
      ,[E384]
      ,[E385]
      ,[E386]
      ,[E387]
      ,[E388]
      ,[E389]
      ,[E391]
      ,[E392]
      ,[E393]
      ,[E394]
      ,[E395]
      ,[E396]
      ,[E397]
      ,[E398]
      ,[E399]
      ,[E401]
      ,[E402]
      ,[E403]
      ,[E404]
      ,[E405]
      ,[E406]
      ,[E407]
      ,[E408]
      ,[E409]
      ,[E411]
      ,[E412]
      ,[E413]
      ,[E414]
      ,[E415]
      ,[E416]
      ,[E417]
      ,[E418]
      ,[E419]
      ,[E421]
      ,[E422]
      ,[E423]
      ,[E424]
      ,[E425]
      ,[E426]
      ,[E427]
      ,[E428]
      ,[E429]
      ,[E431]
      ,[E432]
      ,[E433]
      ,[E434]
      ,[E435]
      ,[E436]
      ,[E437]
      ,[E438]
      ,[E439]
      ,[E441]
      ,[E442]
      ,[E443]
      ,[E444]
      ,[E445]
      ,[E446]
      ,[E447]
      ,[E448]
      ,[E449]
      ,[E451]
      ,[E452]
      ,[E453]
      ,[E454]
      ,[E455]
      ,[E456]
      ,[E457]
      ,[E458]
      ,[E459]
      ,[E461]
      ,[E462]
      ,[E463]
      ,[E464]
      ,[E465]
      ,[E466]
      ,[E467]
      ,[E468]
      ,[E469]
      ,[E471]
      ,[E472]
      ,[E473]
      ,[E474]
      ,[E475]
      ,[E476]
      ,[E477]
      ,[E478]
      ,[E479]
      ,[E481]
      ,[E482]
      ,[E483]
      ,[E484]
      ,[E485]
      ,[E486]
      ,[E487]
      ,[E488]
      ,[E489]
      ,[E491]
      ,[E492]
      ,[E493]
      ,[E494]
      ,[E495]
      ,[E496]
      ,[E497]
      ,[E498]
      ,[E499]
      ,[E501]
      ,[E502]
      ,[E503]
      ,[E504]
      ,[E505]
      ,[E506]
      ,[E507]
      ,[E508]
      ,[E509]
      ,[E511]
      ,[E512]
      ,[E513]
      ,[E514]
      ,[E515]
      ,[E516]
      ,[E517]
      ,[E518]
      ,[E519]
      ,[E521]
      ,[E522]
      ,[E523]
      ,[E524]
      ,[E525]
      ,[E526]
      ,[E527]
      ,[E528]
      ,[E529]
      ,[E531]
      ,[E532]
      ,[E533]
      ,[E534]
      ,[E535]
      ,[E536]
      ,[E537]
      ,[E538]
      ,[E539]
      ,[E541]
      ,[E542]
      ,[E543]
      ,[E544]
      ,[E545]
      ,[E546]
      ,[E547]
      ,[E548]
      ,[E549]
      ,[E551]
      ,[E552]
      ,[E553]
      ,[E554]
      ,[E555]
      ,[E556]
      ,[E557]
      ,[E558]
      ,[E559]
      ,[E561]
      ,[E562]
      ,[E563]
      ,[E564]
      ,[E565]
      ,[E566]
      ,[E567]
      ,[E568]
      ,[E569]
      ,[E571]
      ,[E572]
      ,[E573]
      ,[E574]
      ,[E575]
      ,[E576]
      ,[E577]
      ,[E578]
      ,[E579]
      ,[E581]
      ,[E582]
      ,[E583]
      ,[E584]
      ,[E585]
      ,[E586]
      ,[E587]
      ,[E588]
      ,[E589]
      ,[E591]
      ,[E592]
      ,[E593]
      ,[E594]
      ,[E595]
      ,[E596]
      ,[E597]
      ,[E598]
      ,[E599]
      ,[E601]
      ,[E602]
      ,[E603]
      ,[E604]
      ,[E605]
      ,[E606]
      ,[E607]
      ,[E608]
      ,[E609]
      ,[E611]
      ,[E612]
      ,[E613]
      ,[E614]
      ,[E615]
      ,[E616]
      ,[E617]
      ,[E618]
      ,[E619]
      ,[E621]
      ,[E622]
      ,[E623]
      ,[E624]
      ,[E625]
      ,[E626]
      ,[E627]
      ,[E628]
      ,[E629]
      ,[E631]
      ,[E632]
      ,[E633]
      ,[E634]
      ,[E635]
      ,[E636]
      ,[E637]
      ,[E638]
      ,[E639]
      ,[E641]
      ,[E642]
      ,[E643]
      ,[E644]
      ,[E645]
      ,[E646]
      ,[E647]
      ,[E648]
      ,[E649]
      ,[E651]
      ,[E652]
      ,[E653]
      ,[E654]
      ,[E655]
      ,[E656]
      ,[E657]
      ,[E658]
      ,[E659]
      ,[E661]
      ,[E662]
      ,[E663]
      ,[E664]
      ,[E665]
      ,[E666]
      ,[E667]
      ,[E668]
      ,[E669]
      ,[E671]
      ,[E672]
      ,[E673]
      ,[E674]
      ,[E675]
      ,[E676]
      ,[E677]
      ,[E678]
      ,[E679]
      ,[E681]
      ,[E682]
      ,[E683]
      ,[E684]
      ,[E685]
      ,[E686]
      ,[E687]
      ,[E688]
      ,[E689]
      ,[E691]
      ,[E692]
      ,[E693]
      ,[E694]
      ,[E695]
      ,[E696]
      ,[E697]
      ,[E698]
      ,[E699]
      ,[E701]
      ,[E702]
      ,[E703]
      ,[E704]
      ,[E705]
      ,[E706]
      ,[E707]
      ,[E708]
      ,[E709]
      ,[E711]
      ,[E712]
      ,[E713]
      ,[E714]
      ,[E715]
      ,[E716]
      ,[E717]
      ,[E718]
      ,[E719]
      ,[E721]
      ,[E722]
      ,[E723]
      ,[E724]
      ,[E725]
      ,[E726]
      ,[E727]
      ,[E728]
      ,[E729]
      ,[E731]
      ,[E732]
      ,[E733]
      ,[E734]
      ,[E735]
      ,[E736]
      ,[E737]
      ,[E738]
      ,[E739]
      ,[E741]
      ,[E742]
      ,[E743]
      ,[E744]
      ,[E745]
      ,[E746]
      ,[E747]
      ,[E748]
      ,[E749]
      ,[E751]
      ,[E752]
      ,[E753]
      ,[E754]
      ,[E755]
      ,[E756]
      ,[E757]
      ,[E758]
      ,[E759]
      ,[E1]
      ,[E2]
      ,[E3]
      ,[E4]
      ,[E5]
      ,[E6]
      ,[E7]
      ,[E8]
      ,[E9]
      ,[osa15]
      ,[nai15]
      ,[osa16]
      ,[nai16]
      ,[tietolahde] = ''2_11_sopv_14''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv, tunn)
  FROM [TK_H9098_CSC].[dbo].[TK_2_11_sopv_14]

UNION ALL

SELECT [tilv]
      ,[tunn]
      ,[jarj]
      ,[osa1]
      ,[suo1]
      ,[osa2]
      ,[suo2]
      ,[osa3]
      ,[suo3]
      ,[kur4]
      ,[osa4]
      ,[nai4]
      ,[tun4]
      ,[kur5]
      ,[osa5]
      ,[nai5]
      ,[tun5]
      ,[kur6]
      ,[osa6]
      ,[nai6]
      ,[tun6]
      ,[kur7]
      ,[osa7]
      ,[nai7]
      ,[kur8]
      ,[osa8]
      ,[nai8]
      ,[kur9]
      ,[osa9]
      ,[nai9]
      ,[kur10]
      ,[osa10]
      ,[nai10]
      ,[kur11]
      ,[osa11]
      ,[nai11]
      ,[kur12]
      ,[osa12]
      ,[nai12]
      ,[kur13]
      ,[osa13]
      ,[nai13]
      ,[kur14]
      ,[osa14]
      ,[nai14]
      ,[kurd]
      ,[osad]
      ,[naid]
      ,[E11]
      ,[E12]
      ,[E13]
      ,[E14]
      ,[E15]
      ,[E16]
      ,[E17]
      ,[E18]
      ,[E19]
      ,[E21]
      ,[E22]
      ,[E23]
      ,[E24]
      ,[E25]
      ,[E26]
      ,[E27]
      ,[E28]
      ,[E29]
      ,[E31]
      ,[E32]
      ,[E33]
      ,[E34]
      ,[E35]
      ,[E36]
      ,[E37]
      ,[E38]
      ,[E39]
      ,[E41]
      ,[E42]
      ,[E43]
      ,[E44]
      ,[E45]
      ,[E46]
      ,[E47]
      ,[E48]
      ,[E49]
      ,[E51]
      ,[E52]
      ,[E53]
      ,[E54]
      ,[E55]
      ,[E56]
      ,[E57]
      ,[E58]
      ,[E59]
      ,[E61]
      ,[E62]
      ,[E63]
      ,[E64]
      ,[E65]
      ,[E66]
      ,[E67]
      ,[E68]
      ,[E69]
      ,[E71]
      ,[E72]
      ,[E73]
      ,[E74]
      ,[E75]
      ,[E76]
      ,[E77]
      ,[E78]
      ,[E79]
      ,[E81]
      ,[E82]
      ,[E83]
      ,[E84]
      ,[E85]
      ,[E86]
      ,[E87]
      ,[E88]
      ,[E89]
      ,[E91]
      ,[E92]
      ,[E93]
      ,[E94]
      ,[E95]
      ,[E96]
      ,[E97]
      ,[E98]
      ,[E99]
      ,[E101]
      ,[E102]
      ,[E103]
      ,[E104]
      ,[E105]
      ,[E106]
      ,[E107]
      ,[E108]
      ,[E109]
      ,[E111]
      ,[E112]
      ,[E113]
      ,[E114]
      ,[E115]
      ,[E116]
      ,[E117]
      ,[E118]
      ,[E119]
      ,[E121]
      ,[E122]
      ,[E123]
      ,[E124]
      ,[E125]
      ,[E126]
      ,[E127]
      ,[E128]
      ,[E129]
      ,[E131]
      ,[E132]
      ,[E133]
      ,[E134]
      ,[E135]
      ,[E136]
      ,[E137]
      ,[E138]
      ,[E139]
      ,[E141]
      ,[E142]
      ,[E143]
      ,[E144]
      ,[E145]
      ,[E146]
      ,[E147]
      ,[E148]
      ,[E149]
      ,[E151]
      ,[E152]
      ,[E153]
      ,[E154]
      ,[E155]
      ,[E156]
      ,[E157]
      ,[E158]
      ,[E159]
      ,[E161]
      ,[E162]
      ,[E163]
      ,[E164]
      ,[E165]
      ,[E166]
      ,[E167]
      ,[E168]
      ,[E169]
      ,[E171]
      ,[E172]
      ,[E173]
      ,[E174]
      ,[E175]
      ,[E176]
      ,[E177]
      ,[E178]
      ,[E179]
      ,[E181]
      ,[E182]
      ,[E183]
      ,[E184]
      ,[E185]
      ,[E186]
      ,[E187]
      ,[E188]
      ,[E189]
      ,[E191]
      ,[E192]
      ,[E193]
      ,[E194]
      ,[E195]
      ,[E196]
      ,[E197]
      ,[E198]
      ,[E199]
      ,[E201]
      ,[E202]
      ,[E203]
      ,[E204]
      ,[E205]
      ,[E206]
      ,[E207]
      ,[E208]
      ,[E209]
      ,[E211]
      ,[E212]
      ,[E213]
      ,[E214]
      ,[E215]
      ,[E216]
      ,[E217]
      ,[E218]
      ,[E219]
      ,[E221]
      ,[E222]
      ,[E223]
      ,[E224]
      ,[E225]
      ,[E226]
      ,[E227]
      ,[E228]
      ,[E229]
      ,[E231]
      ,[E232]
      ,[E233]
      ,[E234]
      ,[E235]
      ,[E236]
      ,[E237]
      ,[E238]
      ,[E239]
      ,[E241]
      ,[E242]
      ,[E243]
      ,[E244]
      ,[E245]
      ,[E246]
      ,[E247]
      ,[E248]
      ,[E249]
      ,[E251]
      ,[E252]
      ,[E253]
      ,[E254]
      ,[E255]
      ,[E256]
      ,[E257]
      ,[E258]
      ,[E259]
      ,[E261]
      ,[E262]
      ,[E263]
      ,[E264]
      ,[E265]
      ,[E266]
      ,[E267]
      ,[E268]
      ,[E269]
      ,[E271]
      ,[E272]
      ,[E273]
      ,[E274]
      ,[E275]
      ,[E276]
      ,[E277]
      ,[E278]
      ,[E279]
      ,[E281]
      ,[E282]
      ,[E283]
      ,[E284]
      ,[E285]
      ,[E286]
      ,[E287]
      ,[E288]
      ,[E289]
      ,[E291]
      ,[E292]
      ,[E293]
      ,[E294]
      ,[E295]
      ,[E296]
      ,[E297]
      ,[E298]
      ,[E299]
      ,[E301]
      ,[E302]
      ,[E303]
      ,[E304]
      ,[E305]
      ,[E306]
      ,[E307]
      ,[E308]
      ,[E309]
      ,[E311]
      ,[E312]
      ,[E313]
      ,[E314]
      ,[E315]
      ,[E316]
      ,[E317]
      ,[E318]
      ,[E319]
      ,[E321]
      ,[E322]
      ,[E323]
      ,[E324]
      ,[E325]
      ,[E326]
      ,[E327]
      ,[E328]
      ,[E329]
      ,[E331]
      ,[E332]
      ,[E333]
      ,[E334]
      ,[E335]
      ,[E336]
      ,[E337]
      ,[E338]
      ,[E339]
      ,[E341]
      ,[E342]
      ,[E343]
      ,[E344]
      ,[E345]
      ,[E346]
      ,[E347]
      ,[E348]
      ,[E349]
      ,[E351]
      ,[E352]
      ,[E353]
      ,[E354]
      ,[E355]
      ,[E356]
      ,[E357]
      ,[E358]
      ,[E359]
      ,[E361]
      ,[E362]
      ,[E363]
      ,[E364]
      ,[E365]
      ,[E366]
      ,[E367]
      ,[E368]
      ,[E369]
      ,[E371]
      ,[E372]
      ,[E373]
      ,[E374]
      ,[E375]
      ,[E376]
      ,[E377]
      ,[E378]
      ,[E379]
      ,[E381]
      ,[E382]
      ,[E383]
      ,[E384]
      ,[E385]
      ,[E386]
      ,[E387]
      ,[E388]
      ,[E389]
      ,[E391]
      ,[E392]
      ,[E393]
      ,[E394]
      ,[E395]
      ,[E396]
      ,[E397]
      ,[E398]
      ,[E399]
      ,[E401]
      ,[E402]
      ,[E403]
      ,[E404]
      ,[E405]
      ,[E406]
      ,[E407]
      ,[E408]
      ,[E409]
      ,[E411]
      ,[E412]
      ,[E413]
      ,[E414]
      ,[E415]
      ,[E416]
      ,[E417]
      ,[E418]
      ,[E419]
      ,[E421]
      ,[E422]
      ,[E423]
      ,[E424]
      ,[E425]
      ,[E426]
      ,[E427]
      ,[E428]
      ,[E429]
      ,[E431]
      ,[E432]
      ,[E433]
      ,[E434]
      ,[E435]
      ,[E436]
      ,[E437]
      ,[E438]
      ,[E439]
      ,[E441]
      ,[E442]
      ,[E443]
      ,[E444]
      ,[E445]
      ,[E446]
      ,[E447]
      ,[E448]
      ,[E449]
      ,[E451]
      ,[E452]
      ,[E453]
      ,[E454]
      ,[E455]
      ,[E456]
      ,[E457]
      ,[E458]
      ,[E459]
      ,[E461]
      ,[E462]
      ,[E463]
      ,[E464]
      ,[E465]
      ,[E466]
      ,[E467]
      ,[E468]
      ,[E469]
      ,[E471]
      ,[E472]
      ,[E473]
      ,[E474]
      ,[E475]
      ,[E476]
      ,[E477]
      ,[E478]
      ,[E479]
      ,[E481]
      ,[E482]
      ,[E483]
      ,[E484]
      ,[E485]
      ,[E486]
      ,[E487]
      ,[E488]
      ,[E489]
      ,[E491]
      ,[E492]
      ,[E493]
      ,[E494]
      ,[E495]
      ,[E496]
      ,[E497]
      ,[E498]
      ,[E499]
      ,[E501]
      ,[E502]
      ,[E503]
      ,[E504]
      ,[E505]
      ,[E506]
      ,[E507]
      ,[E508]
      ,[E509]
      ,[E511]
      ,[E512]
      ,[E513]
      ,[E514]
      ,[E515]
      ,[E516]
      ,[E517]
      ,[E518]
      ,[E519]
      ,[E521]
      ,[E522]
      ,[E523]
      ,[E524]
      ,[E525]
      ,[E526]
      ,[E527]
      ,[E528]
      ,[E529]
      ,[E531]
      ,[E532]
      ,[E533]
      ,[E534]
      ,[E535]
      ,[E536]
      ,[E537]
      ,[E538]
      ,[E539]
      ,[E541]
      ,[E542]
      ,[E543]
      ,[E544]
      ,[E545]
      ,[E546]
      ,[E547]
      ,[E548]
      ,[E549]
      ,[E551]
      ,[E552]
      ,[E553]
      ,[E554]
      ,[E555]
      ,[E556]
      ,[E557]
      ,[E558]
      ,[E559]
      ,[E561]
      ,[E562]
      ,[E563]
      ,[E564]
      ,[E565]
      ,[E566]
      ,[E567]
      ,[E568]
      ,[E569]
      ,[E571]
      ,[E572]
      ,[E573]
      ,[E574]
      ,[E575]
      ,[E576]
      ,[E577]
      ,[E578]
      ,[E579]
      ,[E581]
      ,[E582]
      ,[E583]
      ,[E584]
      ,[E585]
      ,[E586]
      ,[E587]
      ,[E588]
      ,[E589]
      ,[E591]
      ,[E592]
      ,[E593]
      ,[E594]
      ,[E595]
      ,[E596]
      ,[E597]
      ,[E598]
      ,[E599]
      ,[E601]
      ,[E602]
      ,[E603]
      ,[E604]
      ,[E605]
      ,[E606]
      ,[E607]
      ,[E608]
      ,[E609]
      ,[E611]
      ,[E612]
      ,[E613]
      ,[E614]
      ,[E615]
      ,[E616]
      ,[E617]
      ,[E618]
      ,[E619]
      ,[E621]
      ,[E622]
      ,[E623]
      ,[E624]
      ,[E625]
      ,[E626]
      ,[E627]
      ,[E628]
      ,[E629]
      ,[E631]
      ,[E632]
      ,[E633]
      ,[E634]
      ,[E635]
      ,[E636]
      ,[E637]
      ,[E638]
      ,[E639]
      ,[E641]
      ,[E642]
      ,[E643]
      ,[E644]
      ,[E645]
      ,[E646]
      ,[E647]
      ,[E648]
      ,[E649]
      ,[E651]
      ,[E652]
      ,[E653]
      ,[E654]
      ,[E655]
      ,[E656]
      ,[E657]
      ,[E658]
      ,[E659]
      ,[E661]
      ,[E662]
      ,[E663]
      ,[E664]
      ,[E665]
      ,[E666]
      ,[E667]
      ,[E668]
      ,[E669]
      ,[E671]
      ,[E672]
      ,[E673]
      ,[E674]
      ,[E675]
      ,[E676]
      ,[E677]
      ,[E678]
      ,[E679]
      ,[E681]
      ,[E682]
      ,[E683]
      ,[E684]
      ,[E685]
      ,[E686]
      ,[E687]
      ,[E688]
      ,[E689]
      ,[E691]
      ,[E692]
      ,[E693]
      ,[E694]
      ,[E695]
      ,[E696]
      ,[E697]
      ,[E698]
      ,[E699]
      ,[E701]
      ,[E702]
      ,[E703]
      ,[E704]
      ,[E705]
      ,[E706]
      ,[E707]
      ,[E708]
      ,[E709]
      ,[E711]
      ,[E712]
      ,[E713]
      ,[E714]
      ,[E715]
      ,[E716]
      ,[E717]
      ,[E718]
      ,[E719]
      ,[E721]
      ,[E722]
      ,[E723]
      ,[E724]
      ,[E725]
      ,[E726]
      ,[E727]
      ,[E728]
      ,[E729]
      ,[E731]
      ,[E732]
      ,[E733]
      ,[E734]
      ,[E735]
      ,[E736]
      ,[E737]
      ,[E738]
      ,[E739]
      ,[E741]
      ,[E742]
      ,[E743]
      ,[E744]
      ,[E745]
      ,[E746]
      ,[E747]
      ,[E748]
      ,[E749]
      ,[E751]
      ,[E752]
      ,[E753]
      ,[E754]
      ,[E755]
      ,[E756]
      ,[E757]
      ,[E758]
      ,[E759]
      ,[E1]
      ,[E2]
      ,[E3]
      ,[E4]
      ,[E5]
      ,[E6]
      ,[E7]
      ,[E8]
      ,[E9]
      ,[osa15]
      ,[nai15]
      ,[osa16]
      ,[nai16]
      ,[tietolahde] = ''2_11_sopv_15''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv, tunn)
  FROM [TK_H9098_CSC].[dbo].[TK_2_11_sopv_15]

UNION ALL

SELECT [tilv]
      ,[tunn]
      ,[jarj]
      ,[osa1]
      ,[suo1]
      ,[osa2]
      ,[suo2]
      ,[osa3]
      ,[suo3]
      ,[kur4]
      ,[osa4]
      ,[nai4]
      ,[tun4]
      ,[kur5]
      ,[osa5]
      ,[nai5]
      ,[tun5]
      ,[kur6]
      ,[osa6]
      ,[nai6]
      ,[tun6]
      ,[kur7]
      ,[osa7]
      ,[nai7]
      ,[kur8]
      ,[osa8]
      ,[nai8]
      ,[kur9]
      ,[osa9]
      ,[nai9]
      ,[kur10]
      ,[osa10]
      ,[nai10]
      ,[kur11]
      ,[osa11]
      ,[nai11]
      ,[kur12]
      ,[osa12]
      ,[nai12]
      ,[kur13]
      ,[osa13]
      ,[nai13]
      ,[kur14]
      ,[osa14]
      ,[nai14]
      ,[kurd]
      ,[osad]
      ,[naid]
      ,[E11]
      ,[E12]
      ,[E13]
      ,[E14]
      ,[E15]
      ,[E16]
      ,[E17]
      ,[E18]
      ,[E19]
      ,[E21]
      ,[E22]
      ,[E23]
      ,[E24]
      ,[E25]
      ,[E26]
      ,[E27]
      ,[E28]
      ,[E29]
      ,[E31]
      ,[E32]
      ,[E33]
      ,[E34]
      ,[E35]
      ,[E36]
      ,[E37]
      ,[E38]
      ,[E39]
      ,[E41]
      ,[E42]
      ,[E43]
      ,[E44]
      ,[E45]
      ,[E46]
      ,[E47]
      ,[E48]
      ,[E49]
      ,[E51]
      ,[E52]
      ,[E53]
      ,[E54]
      ,[E55]
      ,[E56]
      ,[E57]
      ,[E58]
      ,[E59]
      ,[E61]
      ,[E62]
      ,[E63]
      ,[E64]
      ,[E65]
      ,[E66]
      ,[E67]
      ,[E68]
      ,[E69]
      ,[E71]
      ,[E72]
      ,[E73]
      ,[E74]
      ,[E75]
      ,[E76]
      ,[E77]
      ,[E78]
      ,[E79]
      ,[E81]
      ,[E82]
      ,[E83]
      ,[E84]
      ,[E85]
      ,[E86]
      ,[E87]
      ,[E88]
      ,[E89]
      ,[E91]
      ,[E92]
      ,[E93]
      ,[E94]
      ,[E95]
      ,[E96]
      ,[E97]
      ,[E98]
      ,[E99]
      ,[E101]
      ,[E102]
      ,[E103]
      ,[E104]
      ,[E105]
      ,[E106]
      ,[E107]
      ,[E108]
      ,[E109]
      ,[E111]
      ,[E112]
      ,[E113]
      ,[E114]
      ,[E115]
      ,[E116]
      ,[E117]
      ,[E118]
      ,[E119]
      ,[E121]
      ,[E122]
      ,[E123]
      ,[E124]
      ,[E125]
      ,[E126]
      ,[E127]
      ,[E128]
      ,[E129]
      ,[E131]
      ,[E132]
      ,[E133]
      ,[E134]
      ,[E135]
      ,[E136]
      ,[E137]
      ,[E138]
      ,[E139]
      ,[E141]
      ,[E142]
      ,[E143]
      ,[E144]
      ,[E145]
      ,[E146]
      ,[E147]
      ,[E148]
      ,[E149]
      ,[E151]
      ,[E152]
      ,[E153]
      ,[E154]
      ,[E155]
      ,[E156]
      ,[E157]
      ,[E158]
      ,[E159]
      ,[E161]
      ,[E162]
      ,[E163]
      ,[E164]
      ,[E165]
      ,[E166]
      ,[E167]
      ,[E168]
      ,[E169]
      ,[E171]
      ,[E172]
      ,[E173]
      ,[E174]
      ,[E175]
      ,[E176]
      ,[E177]
      ,[E178]
      ,[E179]
      ,[E181]
      ,[E182]
      ,[E183]
      ,[E184]
      ,[E185]
      ,[E186]
      ,[E187]
      ,[E188]
      ,[E189]
      ,[E191]
      ,[E192]
      ,[E193]
      ,[E194]
      ,[E195]
      ,[E196]
      ,[E197]
      ,[E198]
      ,[E199]
      ,[E201]
      ,[E202]
      ,[E203]
      ,[E204]
      ,[E205]
      ,[E206]
      ,[E207]
      ,[E208]
      ,[E209]
      ,[E211]
      ,[E212]
      ,[E213]
      ,[E214]
      ,[E215]
      ,[E216]
      ,[E217]
      ,[E218]
      ,[E219]
      ,[E221]
      ,[E222]
      ,[E223]
      ,[E224]
      ,[E225]
      ,[E226]
      ,[E227]
      ,[E228]
      ,[E229]
      ,[E231]
      ,[E232]
      ,[E233]
      ,[E234]
      ,[E235]
      ,[E236]
      ,[E237]
      ,[E238]
      ,[E239]
      ,[E241]
      ,[E242]
      ,[E243]
      ,[E244]
      ,[E245]
      ,[E246]
      ,[E247]
      ,[E248]
      ,[E249]
      ,[E251]
      ,[E252]
      ,[E253]
      ,[E254]
      ,[E255]
      ,[E256]
      ,[E257]
      ,[E258]
      ,[E259]
      ,[E261]
      ,[E262]
      ,[E263]
      ,[E264]
      ,[E265]
      ,[E266]
      ,[E267]
      ,[E268]
      ,[E269]
      ,[E271]
      ,[E272]
      ,[E273]
      ,[E274]
      ,[E275]
      ,[E276]
      ,[E277]
      ,[E278]
      ,[E279]
      ,[E281]
      ,[E282]
      ,[E283]
      ,[E284]
      ,[E285]
      ,[E286]
      ,[E287]
      ,[E288]
      ,[E289]
      ,[E291]
      ,[E292]
      ,[E293]
      ,[E294]
      ,[E295]
      ,[E296]
      ,[E297]
      ,[E298]
      ,[E299]
      ,[E301]
      ,[E302]
      ,[E303]
      ,[E304]
      ,[E305]
      ,[E306]
      ,[E307]
      ,[E308]
      ,[E309]
      ,[E311]
      ,[E312]
      ,[E313]
      ,[E314]
      ,[E315]
      ,[E316]
      ,[E317]
      ,[E318]
      ,[E319]
      ,[E321]
      ,[E322]
      ,[E323]
      ,[E324]
      ,[E325]
      ,[E326]
      ,[E327]
      ,[E328]
      ,[E329]
      ,[E331]
      ,[E332]
      ,[E333]
      ,[E334]
      ,[E335]
      ,[E336]
      ,[E337]
      ,[E338]
      ,[E339]
      ,[E341]
      ,[E342]
      ,[E343]
      ,[E344]
      ,[E345]
      ,[E346]
      ,[E347]
      ,[E348]
      ,[E349]
      ,[E351]
      ,[E352]
      ,[E353]
      ,[E354]
      ,[E355]
      ,[E356]
      ,[E357]
      ,[E358]
      ,[E359]
      ,[E361]
      ,[E362]
      ,[E363]
      ,[E364]
      ,[E365]
      ,[E366]
      ,[E367]
      ,[E368]
      ,[E369]
      ,[E371]
      ,[E372]
      ,[E373]
      ,[E374]
      ,[E375]
      ,[E376]
      ,[E377]
      ,[E378]
      ,[E379]
      ,[E381]
      ,[E382]
      ,[E383]
      ,[E384]
      ,[E385]
      ,[E386]
      ,[E387]
      ,[E388]
      ,[E389]
      ,[E391]
      ,[E392]
      ,[E393]
      ,[E394]
      ,[E395]
      ,[E396]
      ,[E397]
      ,[E398]
      ,[E399]
      ,[E401]
      ,[E402]
      ,[E403]
      ,[E404]
      ,[E405]
      ,[E406]
      ,[E407]
      ,[E408]
      ,[E409]
      ,[E411]
      ,[E412]
      ,[E413]
      ,[E414]
      ,[E415]
      ,[E416]
      ,[E417]
      ,[E418]
      ,[E419]
      ,[E421]
      ,[E422]
      ,[E423]
      ,[E424]
      ,[E425]
      ,[E426]
      ,[E427]
      ,[E428]
      ,[E429]
      ,[E431]
      ,[E432]
      ,[E433]
      ,[E434]
      ,[E435]
      ,[E436]
      ,[E437]
      ,[E438]
      ,[E439]
      ,[E441]
      ,[E442]
      ,[E443]
      ,[E444]
      ,[E445]
      ,[E446]
      ,[E447]
      ,[E448]
      ,[E449]
      ,[E451]
      ,[E452]
      ,[E453]
      ,[E454]
      ,[E455]
      ,[E456]
      ,[E457]
      ,[E458]
      ,[E459]
      ,[E461]
      ,[E462]
      ,[E463]
      ,[E464]
      ,[E465]
      ,[E466]
      ,[E467]
      ,[E468]
      ,[E469]
      ,[E471]
      ,[E472]
      ,[E473]
      ,[E474]
      ,[E475]
      ,[E476]
      ,[E477]
      ,[E478]
      ,[E479]
      ,[E481]
      ,[E482]
      ,[E483]
      ,[E484]
      ,[E485]
      ,[E486]
      ,[E487]
      ,[E488]
      ,[E489]
      ,[E491]
      ,[E492]
      ,[E493]
      ,[E494]
      ,[E495]
      ,[E496]
      ,[E497]
      ,[E498]
      ,[E499]
      ,[E501]
      ,[E502]
      ,[E503]
      ,[E504]
      ,[E505]
      ,[E506]
      ,[E507]
      ,[E508]
      ,[E509]
      ,[E511]
      ,[E512]
      ,[E513]
      ,[E514]
      ,[E515]
      ,[E516]
      ,[E517]
      ,[E518]
      ,[E519]
      ,[E521]
      ,[E522]
      ,[E523]
      ,[E524]
      ,[E525]
      ,[E526]
      ,[E527]
      ,[E528]
      ,[E529]
      ,[E531]
      ,[E532]
      ,[E533]
      ,[E534]
      ,[E535]
      ,[E536]
      ,[E537]
      ,[E538]
      ,[E539]
      ,[E541]
      ,[E542]
      ,[E543]
      ,[E544]
      ,[E545]
      ,[E546]
      ,[E547]
      ,[E548]
      ,[E549]
      ,[E551]
      ,[E552]
      ,[E553]
      ,[E554]
      ,[E555]
      ,[E556]
      ,[E557]
      ,[E558]
      ,[E559]
      ,[E561]
      ,[E562]
      ,[E563]
      ,[E564]
      ,[E565]
      ,[E566]
      ,[E567]
      ,[E568]
      ,[E569]
      ,[E571]
      ,[E572]
      ,[E573]
      ,[E574]
      ,[E575]
      ,[E576]
      ,[E577]
      ,[E578]
      ,[E579]
      ,[E581]
      ,[E582]
      ,[E583]
      ,[E584]
      ,[E585]
      ,[E586]
      ,[E587]
      ,[E588]
      ,[E589]
      ,[E591]
      ,[E592]
      ,[E593]
      ,[E594]
      ,[E595]
      ,[E596]
      ,[E597]
      ,[E598]
      ,[E599]
      ,[E601]
      ,[E602]
      ,[E603]
      ,[E604]
      ,[E605]
      ,[E606]
      ,[E607]
      ,[E608]
      ,[E609]
      ,[E611]
      ,[E612]
      ,[E613]
      ,[E614]
      ,[E615]
      ,[E616]
      ,[E617]
      ,[E618]
      ,[E619]
      ,[E621]
      ,[E622]
      ,[E623]
      ,[E624]
      ,[E625]
      ,[E626]
      ,[E627]
      ,[E628]
      ,[E629]
      ,[E631]
      ,[E632]
      ,[E633]
      ,[E634]
      ,[E635]
      ,[E636]
      ,[E637]
      ,[E638]
      ,[E639]
      ,[E641]
      ,[E642]
      ,[E643]
      ,[E644]
      ,[E645]
      ,[E646]
      ,[E647]
      ,[E648]
      ,[E649]
      ,[E651]
      ,[E652]
      ,[E653]
      ,[E654]
      ,[E655]
      ,[E656]
      ,[E657]
      ,[E658]
      ,[E659]
      ,[E661]
      ,[E662]
      ,[E663]
      ,[E664]
      ,[E665]
      ,[E666]
      ,[E667]
      ,[E668]
      ,[E669]
      ,[E671]
      ,[E672]
      ,[E673]
      ,[E674]
      ,[E675]
      ,[E676]
      ,[E677]
      ,[E678]
      ,[E679]
      ,[E681]
      ,[E682]
      ,[E683]
      ,[E684]
      ,[E685]
      ,[E686]
      ,[E687]
      ,[E688]
      ,[E689]
      ,[E691]
      ,[E692]
      ,[E693]
      ,[E694]
      ,[E695]
      ,[E696]
      ,[E697]
      ,[E698]
      ,[E699]
      ,[E701]
      ,[E702]
      ,[E703]
      ,[E704]
      ,[E705]
      ,[E706]
      ,[E707]
      ,[E708]
      ,[E709]
      ,[E711]
      ,[E712]
      ,[E713]
      ,[E714]
      ,[E715]
      ,[E716]
      ,[E717]
      ,[E718]
      ,[E719]
      ,[E721]
      ,[E722]
      ,[E723]
      ,[E724]
      ,[E725]
      ,[E726]
      ,[E727]
      ,[E728]
      ,[E729]
      ,[E731]
      ,[E732]
      ,[E733]
      ,[E734]
      ,[E735]
      ,[E736]
      ,[E737]
      ,[E738]
      ,[E739]
      ,[E741]
      ,[E742]
      ,[E743]
      ,[E744]
      ,[E745]
      ,[E746]
      ,[E747]
      ,[E748]
      ,[E749]
      ,[E751]
      ,[E752]
      ,[E753]
      ,[E754]
      ,[E755]
      ,[E756]
      ,[E757]
      ,[E758]
      ,[E759]
      ,[E1]
      ,[E2]
      ,[E3]
      ,[E4]
      ,[E5]
      ,[E6]
      ,[E7]
      ,[E8]
      ,[E9]
      ,osa15u AS [osa15]
      ,nai15u AS [nai15]
      ,osa16u AS [osa16]
      ,nai16u AS [nai16]
      ,[tietolahde] = ''2_11_sopv_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv, tunn)
  FROM [TK_H9098_CSC].[dbo].[TK_2_11_sopv_16]
) kaikkivuodet



' 
GO
/****** Object:  View [dbo].[v_sa_2_13_Tutkintoon_johtavan_koulutuksen_opiskelijat_kansalaisuuden_mukaan]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_2_13_Tutkintoon_johtavan_koulutuksen_opiskelijat_kansalaisuuden_mukaan]'))
EXEC dbo.sp_executesql @statement = N'








CREATE VIEW [dbo].[v_sa_2_13_Tutkintoon_johtavan_koulutuksen_opiskelijat_kansalaisuuden_mukaan] AS
/*
Drop table [VipunenTK_DW].[dbo].[sa_2_13_Tutkintoon_johtavan_koulutuksen_opiskelijat_kansalaisuuden_mukaan]
Select * into [VipunenTK_DW].[dbo].[sa_2_13_Tutkintoon_johtavan_koulutuksen_opiskelijat_kansalaisuuden_mukaan] FROM VipunenTK_SA.[dbo].[v_sa_2_13_Tutkintoon_johtavan_koulutuksen_opiskelijat_kansalaisuuden_mukaan]

Truncate table [VipunenTK_DW].[dbo].[sa_2_13_Tutkintoon_johtavan_koulutuksen_opiskelijat_kansalaisuuden_mukaan]
Insert into [VipunenTK_DW].[dbo].[sa_2_13_Tutkintoon_johtavan_koulutuksen_opiskelijat_kansalaisuuden_mukaan]
  Select * FROM VipunenTK_SA.[dbo].[v_sa_2_13_Tutkintoon_johtavan_koulutuksen_opiskelijat_kansalaisuuden_mukaan]
*/

SELECT [tilv] = CAST(kaikkivuodet.tilv as nvarchar(4))
	  ,[tilv_date] = Cast(kaikkivuodet.tilv+''0101'' as date)
      ,[lahde]
      ,[koulk]
      ,[tutktav]
      ,[tutklaja]
      ,[ophal] = Case when ophal in ('''', ''9'') then ''1'' else ophal end
      ,[kkieli]
      ,[aikoul]
      ,[kmaak]
      ,[sp]
      ,[aiopis]
      ,[alvv]
      ,[allk]
      ,[olotamm]
      ,[olosyys]
      ,[tilvaskunryh]
      ,[klajir2]
      ,[kansal]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde] = CAST(kaikkivuodet.tietolahde as nvarchar(50))
      ,[rivinumero] = CAST(kaikkivuodet.rivinumero as int)

FROM ( --kaikkivuodet

SELECT [tilv]
      ,[lahde]
      ,[koulk]
      ,[tutktav]
      ,[tutklaja]
      ,[ophal]
      ,[kkieli]
      ,[aikoul]
      ,[kmaak] = case kmaak when ''20'' then ''01'' else kmaak end
      ,[sp]
      ,[aiopis]
      ,[alvv]
      ,[allk]
      ,[olotamm]
      ,[olosyys]
      ,[tilvaskunryh]
      ,[klajir2]
      ,[kansal]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde]=''TK_2_13_sopv_11''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY kansal, koulk, alvv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_13_sopv_11]

UNION ALL

SELECT [tilv]
      ,[lahde]
      ,[koulk]
      ,[tutktav]
      ,[tutklaja]
      ,[ophal]
      ,[kkieli]
      ,[aikoul]
      ,[kmaak]
      ,[sp]
      ,[aiopis]
      ,[alvv]
      ,[allk]
      ,[olotamm]
      ,[olosyys]
      ,[tilvaskunryh]
      ,[klajir2]
      ,[kansal]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde]=''TK_2_13_sopv_12''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY kansal, koulk, alvv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_13_sopv_12]

UNION ALL

SELECT [tilv]
      ,[lahde]
      ,[koulk]
      ,[tutktav]
      ,[tutklaja]
      ,[ophal]
      ,[kkieli]
      ,[aikoul]
      ,[kmaak]
      ,[sp]
      ,[aiopis]
      ,[alvv]
      ,[allk]
      ,[olotamm]
      ,[olosyys]
      ,[tilvaskunryh]
      ,[klajir2]
      ,[kansal]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde]=''TK_2_13_sopv_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY kansal, koulk, alvv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_13_sopv_13]
  
UNION ALL

SELECT [tilv]
      ,[lahde]
      ,[koulk]
      ,[tutktav]
      ,[tutklaja]
      ,[ophal]
      ,[kkieli]
      ,[aikoul]
      ,[kmaak]
      ,[sp]
      ,[aiopis]
      ,[alvv]
      ,[allk]
      ,[olotamm]
      ,[olosyys]
      ,[tilvaskunryh]
      ,[klajir2]
      ,[kansal]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde]=''TK_2_13_sopv_14''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY kansal, koulk, alvv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_13_sopv_14]
  
UNION ALL

SELECT [tilv]
      ,[lahde]
      ,[koulk]
      ,[tutktav]
      ,[tutklaja]
      ,[ophal]
      ,[kkieli]
      ,[aikoul]
      ,[kmaak]
      ,[sp]
      ,[aiopis]
      ,[alvv]
      ,[allk]
      ,[olotamm]
      ,[olosyys]
      ,[tilvaskunryh]
      ,[klajir2]
      ,[kansal]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde]=''TK_2_13_sopv_15''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY kansal, koulk, alvv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_13_sopv_15]
  
UNION ALL

SELECT [tilv]
      ,[lahde]
      ,[koulk]
      ,[tutktav]
      ,[tutklaja]
      ,[ophal]
      ,[kkieli]
      ,[aikoul]
      ,[kmaak]
      ,[sp]
      ,[aiopis]
      ,[alvv]
      ,[allk]
      ,[olotamm]
      ,[olosyys]
      ,[tilvaskunryh]
      ,[klajir2]
      ,[kansal]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde]=''TK_2_13_sopv_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY kansal, koulk, alvv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_13_sopv_16]
) kaikkivuodet





' 
GO
/****** Object:  View [dbo].[v_sa_2_14_Tutkintoon_johtavan_koulutuksen_opiskelijat_syntymamaan_mukaan]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_2_14_Tutkintoon_johtavan_koulutuksen_opiskelijat_syntymamaan_mukaan]'))
EXEC dbo.sp_executesql @statement = N'









CREATE VIEW [dbo].[v_sa_2_14_Tutkintoon_johtavan_koulutuksen_opiskelijat_syntymamaan_mukaan] AS
/*
Drop table [VipunenTK_DW].[dbo].[sa_2_14_Tutkintoon_johtavan_koulutuksen_opiskelijat_syntymamaan_mukaan]
Select * into [VipunenTK_DW].[dbo].[sa_2_14_Tutkintoon_johtavan_koulutuksen_opiskelijat_syntymamaan_mukaan] FROM VipunenTK_SA.[dbo].[v_sa_2_14_Tutkintoon_johtavan_koulutuksen_opiskelijat_syntymamaan_mukaan]

Truncate table [VipunenTK_DW].[dbo].[sa_2_14_Tutkintoon_johtavan_koulutuksen_opiskelijat_syntymamaan_mukaan]
Insert into [VipunenTK_DW].[dbo].[sa_2_14_Tutkintoon_johtavan_koulutuksen_opiskelijat_syntymamaan_mukaan]
  Select * FROM VipunenTK_SA.[dbo].[v_sa_2_14_Tutkintoon_johtavan_koulutuksen_opiskelijat_syntymamaan_mukaan]
*/

SELECT [tilv] = CAST(kaikkivuodet.tilv as nvarchar(4))
	  ,[tilv_date] = Cast(kaikkivuodet.tilv+''0101'' as date)
      ,[lahde]
      ,[koulk]
      ,[tutktav]
      ,[tutklaja]
      ,[ophal] = Case when ophal in ('''', ''9'') then ''1'' else ophal end
      ,[kkieli]
      ,[aikoul]
      ,[kmaak]
      ,[sp]
      ,[aiopis]
      ,[alvv]
      ,[allk]
      ,[olotamm]
      ,[olosyys]
      ,[tilvaskunryh]
      ,[klajir2]
      ,[svalt]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde] = CAST(kaikkivuodet.tietolahde as nvarchar(50))
      ,[rivinumero] = CAST(kaikkivuodet.rivinumero as int)

FROM ( --kaikkivuodet

SELECT [tilv]
      ,[lahde]
      ,[koulk]
      ,[tutktav]
      ,[tutklaja]
      ,[ophal]
      ,[kkieli]
      ,[aikoul]
      ,[kmaak] = case kmaak when ''20'' then ''01'' else kmaak end
      ,[sp]
      ,[aiopis]
      ,[alvv]
      ,[allk]
      ,[olotamm]
      ,[olosyys]
      ,[tilvaskunryh]
      ,[klajir2]
      ,[svalt]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde]=''TK_2_14_sopv_11''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY svalt, koulk, alvv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_14_sopv_11]

UNION ALL

SELECT [tilv]
      ,[lahde]
      ,[koulk]
      ,[tutktav]
      ,[tutklaja]
      ,[ophal]
      ,[kkieli]
      ,[aikoul]
      ,[kmaak]
      ,[sp]
      ,[aiopis]
      ,[alvv]
      ,[allk]
      ,[olotamm]
      ,[olosyys]
      ,[tilvaskunryh]
      ,[klajir2]
      ,[svalt]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde]=''TK_2_14_sopv_12''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY svalt, koulk, alvv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_14_sopv_12]

UNION ALL

SELECT [tilv]
      ,[lahde]
      ,[koulk]
      ,[tutktav]
      ,[tutklaja]
      ,[ophal]
      ,[kkieli]
      ,[aikoul]
      ,[kmaak]
      ,[sp]
      ,[aiopis]
      ,[alvv]
      ,[allk]
      ,[olotamm]
      ,[olosyys]
      ,[tilvaskunryh]
      ,[klajir2]
      ,[svalt]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde]=''TK_2_14_sopv_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY svalt, koulk, alvv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_14_sopv_13]
  
UNION ALL

SELECT [tilv]
      ,[lahde]
      ,[koulk]
      ,[tutktav]
      ,[tutklaja]
      ,[ophal]
      ,[kkieli]
      ,[aikoul]
      ,[kmaak]
      ,[sp]
      ,[aiopis]
      ,[alvv]
      ,[allk]
      ,[olotamm]
      ,[olosyys]
      ,[tilvaskunryh]
      ,[klajir2]
      ,[svalt]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde]=''TK_2_14_sopv_14''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY svalt, koulk, alvv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_14_sopv_14]
  
UNION ALL

SELECT [tilv]
      ,[lahde]
      ,[koulk]
      ,[tutktav]
      ,[tutklaja]
      ,[ophal]
      ,[kkieli]
      ,[aikoul]
      ,[kmaak]
      ,[sp]
      ,[aiopis]
      ,[alvv]
      ,[allk]
      ,[olotamm]
      ,[olosyys]
      ,[tilvaskunryh]
      ,[klajir2]
      ,[svalt]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde]=''TK_2_14_sopv_15''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY svalt, koulk, alvv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_14_sopv_15]
  
UNION ALL

SELECT [tilv]
      ,[lahde]
      ,[koulk]
      ,[tutktav]
      ,[tutklaja]
      ,[ophal]
      ,[kkieli]
      ,[aikoul]
      ,[kmaak]
      ,[sp]
      ,[aiopis]
      ,[alvv]
      ,[allk]
      ,[olotamm]
      ,[olosyys]
      ,[tilvaskunryh]
      ,[klajir2]
      ,[svalt]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde]=''TK_2_14_sopv_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY svalt, koulk, alvv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_14_sopv_16]
) kaikkivuodet






' 
GO
/****** Object:  View [dbo].[v_sa_2_15_Tutkintoon_johtavan_koulutuksen_opiskelijat_aidinkielen_mukaan]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_2_15_Tutkintoon_johtavan_koulutuksen_opiskelijat_aidinkielen_mukaan]'))
EXEC dbo.sp_executesql @statement = N'









CREATE VIEW [dbo].[v_sa_2_15_Tutkintoon_johtavan_koulutuksen_opiskelijat_aidinkielen_mukaan] AS
/*
Drop table [VipunenTK_DW].[dbo].[sa_2_15_Tutkintoon_johtavan_koulutuksen_opiskelijat_aidinkielen_mukaan]
Select * into [VipunenTK_DW].[dbo].[sa_2_15_Tutkintoon_johtavan_koulutuksen_opiskelijat_aidinkielen_mukaan] FROM VipunenTK_SA.[dbo].[v_sa_2_15_Tutkintoon_johtavan_koulutuksen_opiskelijat_aidinkielen_mukaan]

Truncate table [VipunenTK_DW].[dbo].[sa_2_15_Tutkintoon_johtavan_koulutuksen_opiskelijat_aidinkielen_mukaan]
Insert into [VipunenTK_DW].[dbo].[sa_2_15_Tutkintoon_johtavan_koulutuksen_opiskelijat_aidinkielen_mukaan]
  Select * FROM VipunenTK_SA.[dbo].[v_sa_2_15_Tutkintoon_johtavan_koulutuksen_opiskelijat_aidinkielen_mukaan]
*/

SELECT [tilv] = CAST(kaikkivuodet.tilv as nvarchar(4))
	  ,[tilv_date] = Cast(kaikkivuodet.tilv+''0101'' as date)
      ,[lahde]
      ,[koulk]
      ,[tutktav]
      ,[tutklaja]
      ,[ophal] = Case when ophal in ('''', ''9'') then ''1'' else ophal end
      ,[kkieli]
      ,[aikoul]
      ,[kmaak]
      ,[sp]
      ,[aiopis]
      ,[alvv]
      ,[allk]
      ,[olotamm]
      ,[olosyys]
      ,[tilvaskunryh]
      ,[klajir2]
      ,[aikieli]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde] = CAST(kaikkivuodet.tietolahde as nvarchar(50))
      ,[rivinumero] = CAST(kaikkivuodet.rivinumero as int)

FROM ( --kaikkivuodet

SELECT [tilv]
      ,[lahde]
      ,[koulk]
      ,[tutktav]
      ,[tutklaja]
      ,[ophal]
      ,[kkieli]
      ,[aikoul]
      ,[kmaak] = case kmaak when ''20'' then ''01'' else kmaak end
      ,[sp]
      ,[aiopis]
      ,[alvv]
      ,[allk]
      ,[olotamm]
      ,[olosyys]
      ,[tilvaskunryh]
      ,[klajir2]
      ,[aikieli]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde]=''TK_2_15_sopv_11''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY aikieli, koulk, alvv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_15_sopv_11]

UNION ALL

SELECT [tilv]
      ,[lahde]
      ,[koulk]
      ,[tutktav]
      ,[tutklaja]
      ,[ophal]
      ,[kkieli]
      ,[aikoul]
      ,[kmaak]
      ,[sp]
      ,[aiopis]
      ,[alvv]
      ,[allk]
      ,[olotamm]
      ,[olosyys]
      ,[tilvaskunryh]
      ,[klajir2]
      ,[aikieli]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde]=''TK_2_15_sopv_12''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY aikieli, koulk, alvv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_15_sopv_12]

UNION ALL

SELECT [tilv]
      ,[lahde]
      ,[koulk]
      ,[tutktav]
      ,[tutklaja]
      ,[ophal]
      ,[kkieli]
      ,[aikoul]
      ,[kmaak]
      ,[sp]
      ,[aiopis]
      ,[alvv]
      ,[allk]
      ,[olotamm]
      ,[olosyys]
      ,[tilvaskunryh]
      ,[klajir2]
      ,[aikieli]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde]=''TK_2_15_sopv_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY aikieli, koulk, alvv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_15_sopv_13]
  
UNION ALL

SELECT [tilv]
      ,[lahde]
      ,[koulk]
      ,[tutktav]
      ,[tutklaja]
      ,[ophal]
      ,[kkieli]
      ,[aikoul]
      ,[kmaak]
      ,[sp]
      ,[aiopis]
      ,[alvv]
      ,[allk]
      ,[olotamm]
      ,[olosyys]
      ,[tilvaskunryh]
      ,[klajir2]
      ,[aikieli]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde]=''TK_2_15_sopv_14''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY aikieli, koulk, alvv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_15_sopv_14]
  
UNION ALL

SELECT [tilv]
      ,[lahde]
      ,[koulk]
      ,[tutktav]
      ,[tutklaja]
      ,[ophal]
      ,[kkieli]
      ,[aikoul]
      ,[kmaak]
      ,[sp]
      ,[aiopis]
      ,[alvv]
      ,[allk]
      ,[olotamm]
      ,[olosyys]
      ,[tilvaskunryh]
      ,[klajir2]
      ,[aikieli]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde]=''TK_2_15_sopv_15''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY aikieli, koulk, alvv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_15_sopv_15]
  
UNION ALL

SELECT [tilv]
      ,[lahde]
      ,[koulk]
      ,[tutktav]
      ,[tutklaja]
      ,[ophal]
      ,[kkieli]
      ,[aikoul]
      ,[kmaak]
      ,[sp]
      ,[aiopis]
      ,[alvv]
      ,[allk]
      ,[olotamm]
      ,[olosyys]
      ,[tilvaskunryh]
      ,[klajir2]
      ,[aikieli]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde]=''TK_2_15_sopv_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY aikieli, koulk, alvv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_15_sopv_16]
) kaikkivuodet






' 
GO
/****** Object:  View [dbo].[v_sa_2_18_Paivahoidossa_jarjestettava_esiopetus]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_2_18_Paivahoidossa_jarjestettava_esiopetus]'))
EXEC dbo.sp_executesql @statement = N'


CREATE VIEW [dbo].[v_sa_2_18_Paivahoidossa_jarjestettava_esiopetus] AS
SELECT *
	  ,NULL AS [jmamun]
      ,NULL AS [jmamuy]
      ,NULL AS [jmamuyn]
      ,NULL AS [jmamusisay]
      ,NULL AS [jmamueo8]
      ,NULL AS [jmamueo8n]
      ,NULL AS [jmamueo4]
      ,NULL AS [jmamueo4n]
      ,NULL AS [popyn] FROM [TK_H9098_CSC]..[TK_2_18_sopv_12]
UNION ALL
SELECT *
	  ,NULL AS [jmamun]
      ,NULL AS [jmamuy]
      ,NULL AS [jmamuyn]
      ,NULL AS [jmamusisay]
      ,NULL AS [jmamueo8]
      ,NULL AS [jmamueo8n]
      ,NULL AS [jmamueo4]
      ,NULL AS [jmamueo4n]
      ,NULL AS [popyn] FROM [TK_H9098_CSC]..[TK_2_18_sopv_13]
UNION ALL
SELECT *
	  ,NULL AS [jmamun]
      ,NULL AS [jmamuy]
      ,NULL AS [jmamuyn]
      ,NULL AS [jmamusisay]
      ,NULL AS [jmamueo8]
      ,NULL AS [jmamueo8n]
      ,NULL AS [jmamueo4]
      ,NULL AS [jmamueo4n]
      ,NULL AS [popyn] FROM [TK_H9098_CSC]..[TK_2_18_sopv_14]
UNION ALL
SELECT *
	  ,NULL AS [jmamun]
      ,NULL AS [jmamuy]
      ,NULL AS [jmamuyn]
      ,NULL AS [jmamusisay]
      ,NULL AS [jmamueo8]
      ,NULL AS [jmamueo8n]
      ,NULL AS [jmamueo4]
      ,NULL AS [jmamueo4n]
      ,NULL AS [popyn] FROM [TK_H9098_CSC]..[TK_2_18_sopv_15]
UNION ALL
SELECT * FROM [TK_H9098_CSC]..[TK_2_18_sopv_16]

' 
GO
/****** Object:  View [dbo].[v_sa_2_20_Lukio_amm_oppis_opisk_ian_ja_aik_koul_mukaan]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_2_20_Lukio_amm_oppis_opisk_ian_ja_aik_koul_mukaan]'))
EXEC dbo.sp_executesql @statement = N'





CREATE VIEW [dbo].[v_sa_2_20_Lukio_amm_oppis_opisk_ian_ja_aik_koul_mukaan] AS

SELECT
	   [tilv]= cast(kaikkivuodet.tilv as nvarchar(4))
	  ,tilv_date = cast(kaikkivuodet.tilv+''0101'' as date)
	  ,[lahde] = CAST(kaikkivuodet.lahde as nvarchar (2))
	  ,[oltyp] = CAST(kaikkivuodet.oltyp as nvarchar (2))
	  ,[koulk] = CAST(kaikkivuodet.koulk as nvarchar (6))
	  ,[koulk_opintoala] = CAST(kaikkivuodet.koulk_opintoala as nvarchar (6))
	  ,[koulk_koulutusala] = CAST(kaikkivuodet.koulk_koulutusala as nvarchar (6))
	  ,[koulk_koulutusaste] = CAST(kaikkivuodet.koulk_koulutusaste as nvarchar (6))
      ,[aikoul] = CAST(kaikkivuodet.aikoul as nvarchar (1))
      ,[tutktav]= CAST(kaikkivuodet.tutktav as nvarchar (1))
      ,[tutklaja]= CAST(kaikkivuodet.tutklaja as nvarchar (1))
      ,[ophal]= CAST(kaikkivuodet.ophal as nvarchar (1))
      ,[kkun]= CAST(kaikkivuodet.kkun as nvarchar (3))
      ,[rahoitus]= CAST(kaikkivuodet.rahoitus as nvarchar (1))
      ,[sp]= CAST(kaikkivuodet.sp as nvarchar (1))
      ,[aikielir1]= CAST(kaikkivuodet.aikielir1 as nvarchar (2))
      ,[alvv]= CAST(kaikkivuodet.alvv as nvarchar (4))
      ,[allk]= CAST(kaikkivuodet.allk as nvarchar (1))
      ,[olosyys]= CAST(kaikkivuodet.olosyys as nvarchar (1))
      ,[ylsivx]= CAST(kaikkivuodet.ylsivx as nvarchar (1))
      ,[peruskx]= CAST(kaikkivuodet.peruskx as nvarchar (1))
      ,[oalapex]= CAST(kaikkivuodet.oalapex as nvarchar (2))
      ,[oastepex]= CAST(kaikkivuodet.oastepex as nvarchar (1))
      ,[oalapeux]= CAST(kaikkivuodet.oalapeux as nvarchar (3))
      ,[oalapeux_koulutusala]= CAST(kaikkivuodet.oalapeux_koulutusala as nvarchar (3))
      ,[oastpeux]= CAST(kaikkivuodet.oastpeux  as nvarchar (2))
      ,[ammvupe]= CAST(kaikkivuodet.ammvupe as nvarchar (4))
      ,[nayttox]= CAST(kaikkivuodet.nayttox as nvarchar (1))
      ,[oppispex]= CAST(kaikkivuodet.oppispex as nvarchar (1))
      ,[lisakx]= CAST(kaikkivuodet.lisakx as nvarchar (1))
      ,[oalalix]= CAST(kaikkivuodet.oalalix as nvarchar (2))
      ,[oastelix]= CAST(kaikkivuodet.oastelix as nvarchar (1))
      ,[oalaliux]= CAST(kaikkivuodet.oalaliux as nvarchar (3))
      ,[oalaliux_koulutusala]= CAST(kaikkivuodet.oalaliux_koulutusala as nvarchar (3))
      ,[oastliux]= CAST(kaikkivuodet.oastliux as nvarchar (2))
      ,[ammvuli]= CAST(kaikkivuodet.ammvuli as nvarchar (4))
      ,[oppislix]= CAST(kaikkivuodet.oppislix as nvarchar (1))
      ,[alempikax]= CAST(kaikkivuodet.alempikax as nvarchar (1))
      ,[oalaakx]= CAST(kaikkivuodet.oalaakx as nvarchar (2))
      ,[oasteakx]= CAST(kaikkivuodet.oasteakx as nvarchar (1))
      ,[oalauakx]= CAST(kaikkivuodet.oalauakx as nvarchar (3))
      ,[oalauakx_koulutusala]= CAST(kaikkivuodet.oalauakx_koulutusala as nvarchar (3))
      ,[oasteuakx]= CAST(kaikkivuodet.oasteuakx as nvarchar (2))
      ,[svuosiak]= CAST(kaikkivuodet.svuosiak as nvarchar (4))
      ,[ylempikax]= CAST(kaikkivuodet.ylempikax as nvarchar (1))
      ,[oalaykx]= CAST(kaikkivuodet.oalaykx as nvarchar (2))
      ,[oasteykx]= CAST(kaikkivuodet.oasteykx as nvarchar (1))
      ,[oalauykx]= CAST(kaikkivuodet.oalauykx as nvarchar (3))
      ,[oalauykx_koulutusala]= CAST(kaikkivuodet.oalauykx_koulutusala as nvarchar (3))
      ,[oasteuykx]= CAST(kaikkivuodet.oasteuykx as nvarchar (2))
      ,[svuosiyk]= CAST(kaikkivuodet.svuosiyk as nvarchar (4))
      ,[askun]= CAST(kaikkivuodet.askun as nvarchar (3))
      ,[syntv]= CAST(kaikkivuodet.syntv as nvarchar (4))
      ,[lkm]
   	  ,tietolahde = cast(kaikkivuodet.tietolahde as nvarchar(50))
	  ,rivinumero = cast(kaikkivuodet.rivinumero as int)
FROM (

  SELECT [tilv]
      ,[lahde]
      ,[oltyp]
      ,[koulk]
      ,[koulk_opintoala] = (select distinct opintoala2002_koodi   from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
      ,[koulk_koulutusala] = (select distinct koulutusala2002_koodi   from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
      ,[koulk_koulutusaste] = (select distinct koulutusaste2002_koodi   from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
      ,[aikoul]
      ,[tutktav]
      ,[tutklaja]
      ,[ophal]
      ,[kkun]
      ,[rahoitus]
      ,[sp]
      ,[aikielir1]
      ,[alvv]
      ,[allk]
      ,[olosyys]
      ,[ylsivx]
      ,[peruskx]
      ,[oalapex]
      ,[oastepex]
      ,[oalapeux]
      ,[oalapeux_koulutusala] = LEFT ([oalapeux],1)
      ,[oastpeux]
      ,[ammvupe]
      ,[nayttox]
      ,[oppispex]
      ,[lisakx]
      ,[oalalix]
      ,[oastelix]
      ,[oalaliux]
      ,[oalaliux_koulutusala] = LEFT([oalaliux],1)
      ,[oastliux]
      ,[ammvuli]
      ,[oppislix]
      ,[alempikax]
      ,[oalaakx]
      ,[oasteakx]
      ,[oalauakx]
       ,[oalauakx_koulutusala] = left([oalauakx],1)
      ,[oasteuakx]
      ,[svuosiak]
      ,[ylempikax]
      ,[oalaykx]
      ,[oasteykx]
      ,[oalauykx]
      ,[oalauykx_koulutusala] = left([oalauykx],1)
      ,[oasteuykx]
      ,[svuosiyk]
      ,[askun]
      ,[syntv]
      ,[lkm]
      ,[tietolahde]=''TK_2_20_sopv_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_20_sopv_13]
  UNION ALL
  SELECT [tilv]
      ,[lahde]
      ,[oltyp]
      ,[koulk]
      ,[koulk_opintoala] = (select distinct opintoala2002_koodi   from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
      ,[koulk_koulutusala] = (select distinct koulutusala2002_koodi   from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
      ,[koulk_koulutusaste] = (select distinct koulutusaste2002_koodi   from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
      ,[aikoul]
      ,[tutktav]
      ,[tutklaja]
      ,[ophal]
      ,[kkun]
      ,[rahoitus]
      ,[sp]
      ,[aikielir1]
      ,[alvv]
      ,[allk]
      ,[olosyys]
      ,[ylsivx]
      ,[peruskx]
      ,[oalapex]
      ,[oastepex]
      ,[oalapeux]
      ,[oalapeux_koulutusala] = LEFT ([oalapeux],1)
      ,[oastpeux]
      ,[ammvupe]
      ,[nayttox]
      ,[oppispex]
      ,[lisakx]
      ,[oalalix]
      ,[oastelix]
      ,[oalaliux]
      ,[oalaliux_koulutusala] = LEFT([oalaliux],1)
      ,[oastliux]
      ,[ammvuli]
      ,[oppislix]
      ,[alempikax]
      ,[oalaakx]
      ,[oasteakx]
      ,[oalauakx]
       ,[oalauakx_koulutusala] = left([oalauakx],1)
      ,[oasteuakx]
      ,[svuosiak]
      ,[ylempikax]
      ,[oalaykx]
      ,[oasteykx]
      ,[oalauykx]
      ,[oalauykx_koulutusala] = left([oalauykx],1)
      ,[oasteuykx]
      ,[svuosiyk]
      ,[askun]
      ,[syntv]
      ,[lkm]
      ,[tietolahde]=''TK_2_20_sopv_14''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_20_sopv_14]
   UNION ALL
  SELECT [tilv]
      ,[lahde]
      ,[oltyp]
      ,[koulk]
      ,[koulk_opintoala] = (select distinct opintoala2002_koodi   from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
      ,[koulk_koulutusala] = (select distinct koulutusala2002_koodi   from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
      ,[koulk_koulutusaste] = (select distinct koulutusaste2002_koodi   from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
      ,[aikoul]
      ,[tutktav]
      ,[tutklaja]
      ,[ophal]
      ,[kkun]
      ,[rahoitus]
      ,[sp]
      ,[aikielir1]
      ,[alvv]
      ,[allk]
      ,[olosyys]
      ,[ylsivx]
      ,[peruskx]
      ,[oalapex]
      ,[oastepex]
      ,[oalapeux]
      ,[oalapeux_koulutusala] = LEFT ([oalapeux],1)
      ,[oastpeux]
      ,[ammvupe]
      ,[nayttox]
      ,[oppispex]
      ,[lisakx]
      ,[oalalix]
      ,[oastelix]
      ,[oalaliux]
      ,[oalaliux_koulutusala] = LEFT([oalaliux],1)
      ,[oastliux]
      ,[ammvuli]
      ,[oppislix]
      ,[alempikax]
      ,[oalaakx]
      ,[oasteakx]
      ,[oalauakx]
       ,[oalauakx_koulutusala] = left([oalauakx],1)
      ,[oasteuakx]
      ,[svuosiak]
      ,[ylempikax]
      ,[oalaykx]
      ,[oasteykx]
      ,[oalauykx]
      ,[oalauykx_koulutusala] = left([oalauykx],1)
      ,[oasteuykx]
      ,[svuosiyk]
      ,[askun]
      ,[syntv]
      ,[lkm]
      ,[tietolahde]=''TK_2_20_sopv_15''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_20_sopv_15]
   UNION ALL
  SELECT [tilv]
      ,[lahde]
      ,[oltyp]
      ,[koulk]
      ,[koulk_opintoala] = (select distinct opintoala2002_koodi   from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
      ,[koulk_koulutusala] = (select distinct koulutusala2002_koodi   from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
      ,[koulk_koulutusaste] = (select distinct koulutusaste2002_koodi   from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
      ,[aikoul]
      ,[tutktav]
      ,[tutklaja]
      ,[ophal]
      ,[kkun]
      ,[rahoitus]
      ,[sp]
      ,[aikielir1]
      ,[alvv]
      ,[allk]
      ,[olosyys]
      ,[ylsivx]
      ,[peruskx]
      ,[oalapex]
      ,[oastepex]
      ,[oalapeux]
      ,[oalapeux_koulutusala] = LEFT ([oalapeux],1)
      ,[oastpeux]
      ,[ammvupe]
      ,[nayttox]
      ,[oppispex]
      ,[lisakx]
      ,[oalalix]
      ,[oastelix]
      ,[oalaliux]
      ,[oalaliux_koulutusala] = LEFT([oalaliux],1)
      ,[oastliux]
      ,[ammvuli]
      ,[oppislix]
      ,[alempikax]
      ,[oalaakx]
      ,[oasteakx]
      ,[oalauakx]
       ,[oalauakx_koulutusala] = left([oalauakx],1)
      ,[oasteuakx]
      ,[svuosiak]
      ,[ylempikax]
      ,[oalaykx]
      ,[oasteykx]
      ,[oalauykx]
      ,[oalauykx_koulutusala] = left([oalauykx],1)
      ,[oasteuykx]
      ,[svuosiyk]
      ,[askun]
      ,[syntv]
      ,[lkm]
      ,[tietolahde]=''TK_2_20_sopv_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_20_sopv_16]
   UNION ALL
  SELECT [tilv]
      ,[lahde]
      ,[oltyp]
      ,[koulk]
      ,[koulk_opintoala] = (select distinct opintoala2002_koodi   from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
      ,[koulk_koulutusala] = (select distinct koulutusala2002_koodi   from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
      ,[koulk_koulutusaste] = (select distinct koulutusaste2002_koodi   from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
      ,[aikoul]
      ,[tutktav]
      ,[tutklaja]
      ,[ophal]
      ,[kkun]
      ,[rahoitus]
      ,[sp]
      ,[aikielir1]
      ,[alvv]
      ,[allk]
      ,[olosyys]
      ,[ylsivx]
      ,[peruskx]
      ,[oalapex]
      ,[oastepex]
      ,[oalapeux]
      ,[oalapeux_koulutusala] = LEFT ([oalapeux],1)
      ,[oastpeux]
      ,[ammvupe]
      ,[nayttox]
      ,[oppispex]
      ,[lisakx]
      ,[oalalix]
      ,[oastelix]
      ,[oalaliux]
      ,[oalaliux_koulutusala] = LEFT([oalaliux],1)
      ,[oastliux]
      ,[ammvuli]
      ,[oppislix]
      ,[alempikax]
      ,[oalaakx]
      ,[oasteakx]
      ,[oalauakx]
       ,[oalauakx_koulutusala] = left([oalauakx],1)
      ,[oasteuakx]
      ,[svuosiak]
      ,[ylempikax]
      ,[oalaykx]
      ,[oasteykx]
      ,[oalauykx]
      ,[oalauykx_koulutusala] = left([oalauykx],1)
      ,[oasteuykx]
      ,[svuosiyk]
      ,[askun]
      ,[syntv]
      ,[lkm]
      ,[tietolahde]=''TK_2_20_sopv_17''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_20_sopv_17]
  ) as kaikkivuodet






' 
GO
/****** Object:  View [dbo].[v_sa_2_20_Lukio_amm_oppis_opisk_ian_ja_aik_koul_mukaan_talteen]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_2_20_Lukio_amm_oppis_opisk_ian_ja_aik_koul_mukaan_talteen]'))
EXEC dbo.sp_executesql @statement = N'
CREATE VIEW [dbo].[v_sa_2_20_Lukio_amm_oppis_opisk_ian_ja_aik_koul_mukaan_talteen] AS

SELECT
	   [tilv]= cast(kaikkivuodet.tilv as nvarchar(4))
	  ,tilv_date = cast(kaikkivuodet.tilv+''0101'' as date)
	  ,[lahde] = CAST(kaikkivuodet.lahde as nvarchar (2))
	  ,[oltyp] = CAST(kaikkivuodet.oltyp as nvarchar (2))
	  ,[koulk] = CAST(kaikkivuodet.koulk as nvarchar (6))
	  ,[koulk_opintoala] = CAST(kaikkivuodet.koulk_opintoala as nvarchar (6))
	  ,[koulk_koulutusala] = CAST(kaikkivuodet.koulk_koulutusala as nvarchar (6))
	  ,[koulk_koulutusaste] = CAST(kaikkivuodet.koulk_koulutusaste as nvarchar (6))
      ,[aikoul] = CAST(kaikkivuodet.aikoul as nvarchar (1))
      ,[tutktav]= CAST(kaikkivuodet.tutktav as nvarchar (1))
      ,[tutklaja]= CAST(kaikkivuodet.tutklaja as nvarchar (1))
      ,[ophal]= CAST(kaikkivuodet.ophal as nvarchar (1))
      ,[kkun]= CAST(kaikkivuodet.kkun as nvarchar (3))
      ,[rahoitus]= CAST(kaikkivuodet.rahoitus as nvarchar (1))
      ,[sp]= CAST(kaikkivuodet.sp as nvarchar (1))
      ,[aikielir1]= CAST(kaikkivuodet.aikielir1 as nvarchar (2))
      ,[alvv]= CAST(kaikkivuodet.alvv as nvarchar (4))
      ,[allk]= CAST(kaikkivuodet.allk as nvarchar (1))
      ,[olosyys]= CAST(kaikkivuodet.olosyys as nvarchar (1))
      ,[ylsivx]= CAST(kaikkivuodet.ylsivx as nvarchar (1))
      ,[peruskx]= CAST(kaikkivuodet.peruskx as nvarchar (1))
      ,[oalapex]= CAST(kaikkivuodet.oalapex as nvarchar (2))
      ,[oastepex]= CAST(kaikkivuodet.oastepex as nvarchar (1))
      ,[oalapeux]= CAST(kaikkivuodet.oalapeux as nvarchar (3))
      ,[oalapeux_koulutusala]= CAST(kaikkivuodet.oalapeux_koulutusala as nvarchar (3))
      ,[oastpeux]= CAST(kaikkivuodet.oastpeux  as nvarchar (2))
      ,[ammvupe]= CAST(kaikkivuodet.ammvupe as nvarchar (4))
      ,[nayttox]= CAST(kaikkivuodet.nayttox as nvarchar (1))
      ,[oppispex]= CAST(kaikkivuodet.oppispex as nvarchar (1))
      ,[lisakx]= CAST(kaikkivuodet.lisakx as nvarchar (1))
      ,[oalalix]= CAST(kaikkivuodet.oalalix as nvarchar (2))
      ,[oastelix]= CAST(kaikkivuodet.oastelix as nvarchar (1))
      ,[oalaliux]= CAST(kaikkivuodet.oalaliux as nvarchar (3))
      ,[oalaliux_koulutusala]= CAST(kaikkivuodet.oalaliux_koulutusala as nvarchar (3))
      ,[oastliux]= CAST(kaikkivuodet.oastliux as nvarchar (2))
      ,[ammvuli]= CAST(kaikkivuodet.ammvuli as nvarchar (4))
      ,[oppislix]= CAST(kaikkivuodet.oppislix as nvarchar (1))
      ,[alempikax]= CAST(kaikkivuodet.alempikax as nvarchar (1))
      ,[oalaakx]= CAST(kaikkivuodet.oalaakx as nvarchar (2))
      ,[oasteakx]= CAST(kaikkivuodet.oasteakx as nvarchar (1))
      ,[oalauakx]= CAST(kaikkivuodet.oalauakx as nvarchar (3))
      ,[oalauakx_koulutusala]= CAST(kaikkivuodet.oalauakx_koulutusala as nvarchar (3))
      ,[oasteuakx]= CAST(kaikkivuodet.oasteuakx as nvarchar (2))
      ,[svuosiak]= CAST(kaikkivuodet.svuosiak as nvarchar (4))
      ,[ylempikax]= CAST(kaikkivuodet.ylempikax as nvarchar (1))
      ,[oalaykx]= CAST(kaikkivuodet.oalaykx as nvarchar (2))
      ,[oasteykx]= CAST(kaikkivuodet.oasteykx as nvarchar (1))
      ,[oalauykx]= CAST(kaikkivuodet.oalauykx as nvarchar (3))
      ,[oalauykx_koulutusala]= CAST(kaikkivuodet.oalauykx_koulutusala as nvarchar (3))
      ,[oasteuykx]= CAST(kaikkivuodet.oasteuykx as nvarchar (2))
      ,[svuosiyk]= CAST(kaikkivuodet.svuosiyk as nvarchar (4))
      ,[askun]= CAST(kaikkivuodet.askun as nvarchar (3))
      ,[syntv]= CAST(kaikkivuodet.syntv as nvarchar (4))
      ,[lkm]
   	  ,tietolahde = cast(kaikkivuodet.tietolahde as nvarchar(50))
	  ,rivinumero = cast(kaikkivuodet.rivinumero as int)
FROM (


SELECT[tilv]
      ,[lahde]
      ,[oltyp]
      ,[koulk]
      ,[koulk_opintoala] = (select distinct opintoala2002_koodi   from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
      ,[koulk_koulutusala] = (select distinct koulutusala2002_koodi   from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
      ,[koulk_koulutusaste] = (select distinct koulutusaste2002_koodi   from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
      ,[aikoul]
      ,[tutktav]
      ,[tutklaja]
      ,[ophal]
      ,[kkun]
      ,[rahoitus]
      ,[sp]
      ,[aikielir1]
      ,[alvv]
      ,[allk]
      ,[olosyys]
      ,[ylsivx]
      ,[peruskx]
      ,[oalapex]
      ,[oastepex]
      ,[oalapeux]
      ,[oalapeux_koulutusala] = LEFT ([oalapeux],1)
      ,[oastpeux]
      ,[ammvupe]
      ,[nayttox]
      ,[oppispex]
      ,[lisakx]
      ,[oalalix]
      ,[oastelix]
      ,[oalaliux]
      ,[oalaliux_koulutusala] = LEFT([oalaliux],1)
      ,[oastliux]
      ,[ammvuli]
      ,[oppislix]
      ,[alempikax] = ''''
      ,[oalaakx] = ''''
      ,[oasteakx]= ''''
      ,[oalauakx]= ''''
      ,[oalauakx_koulutusala] = ''''
      ,[oasteuakx]= ''''
      ,[svuosiak]= ''''
      ,[ylempikax] = ''''
      ,[oalaykx]= ''''
      ,[oasteykx]= ''''
      ,[oalauykx] = ''''
      ,[oalauykx_koulutusala] = ''''
      ,[oasteuykx]= ''''
      ,[svuosiyk] = ''''
      ,[askun]
      ,[syntv]
      ,[lkm]
      ,[tietolahde]=''TK_2_20_sopv_12''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_20_sopv_12]
  UNION ALL
  SELECT [tilv]
      ,[lahde]
      ,[oltyp]
      ,[koulk]
      ,[koulk_opintoala] = (select distinct opintoala2002_koodi   from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
      ,[koulk_koulutusala] = (select distinct koulutusala2002_koodi   from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
      ,[koulk_koulutusaste] = (select distinct koulutusaste2002_koodi   from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
      ,[aikoul]
      ,[tutktav]
      ,[tutklaja]
      ,[ophal]
      ,[kkun]
      ,[rahoitus]
      ,[sp]
      ,[aikielir1]
      ,[alvv]
      ,[allk]
      ,[olosyys]
      ,[ylsivx]
      ,[peruskx]
      ,[oalapex]
      ,[oastepex]
      ,[oalapeux]
      ,[oalapeux_koulutusala] = LEFT ([oalapeux],1)
      ,[oastpeux]
      ,[ammvupe]
      ,[nayttox]
      ,[oppispex]
      ,[lisakx]
      ,[oalalix]
      ,[oastelix]
      ,[oalaliux]
      ,[oalaliux_koulutusala] = LEFT([oalaliux],1)
      ,[oastliux]
      ,[ammvuli]
      ,[oppislix]
      ,[alempikax]
      ,[oalaakx]
      ,[oasteakx]
      ,[oalauakx]
       ,[oalauakx_koulutusala] = left([oalauakx],1)
      ,[oasteuakx]
      ,[svuosiak]
      ,[ylempikax]
      ,[oalaykx]
      ,[oasteykx]
      ,[oalauykx]
      ,[oalauykx_koulutusala] = left([oalauykx],1)
      ,[oasteuykx]
      ,[svuosiyk]
      ,[askun]
      ,[syntv]
      ,[lkm]
      ,[tietolahde]=''TK_2_20_sopv_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_20_sopv_13]
  UNION ALL
  SELECT [tilv]
      ,[lahde]
      ,[oltyp]
      ,[koulk]
      ,[koulk_opintoala] = (select distinct opintoala2002_koodi   from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
      ,[koulk_koulutusala] = (select distinct koulutusala2002_koodi   from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
      ,[koulk_koulutusaste] = (select distinct koulutusaste2002_koodi   from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
      ,[aikoul]
      ,[tutktav]
      ,[tutklaja]
      ,[ophal]
      ,[kkun]
      ,[rahoitus]
      ,[sp]
      ,[aikielir1]
      ,[alvv]
      ,[allk]
      ,[olosyys]
      ,[ylsivx]
      ,[peruskx]
      ,[oalapex]
      ,[oastepex]
      ,[oalapeux]
      ,[oalapeux_koulutusala] = LEFT ([oalapeux],1)
      ,[oastpeux]
      ,[ammvupe]
      ,[nayttox]
      ,[oppispex]
      ,[lisakx]
      ,[oalalix]
      ,[oastelix]
      ,[oalaliux]
      ,[oalaliux_koulutusala] = LEFT([oalaliux],1)
      ,[oastliux]
      ,[ammvuli]
      ,[oppislix]
      ,[alempikax]
      ,[oalaakx]
      ,[oasteakx]
      ,[oalauakx]
       ,[oalauakx_koulutusala] = left([oalauakx],1)
      ,[oasteuakx]
      ,[svuosiak]
      ,[ylempikax]
      ,[oalaykx]
      ,[oasteykx]
      ,[oalauykx]
      ,[oalauykx_koulutusala] = left([oalauykx],1)
      ,[oasteuykx]
      ,[svuosiyk]
      ,[askun]
      ,[syntv]
      ,[lkm]
      ,[tietolahde]=''TK_2_20_sopv_14''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_20_sopv_14]
  
  ) as kaikkivuodet

' 
GO
/****** Object:  View [dbo].[v_sa_2_21_Lukio_ammpk_opisk_tutk]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_2_21_Lukio_ammpk_opisk_tutk]'))
EXEC dbo.sp_executesql @statement = N'



/*
select * into vipunentk_dw..sa_2_21_Lukio_ammpk_opisk_tutk from [dbo].[v_sa_2_21_Lukio_ammpk_opisk_tutk]

*/

CREATE VIEW [dbo].[v_sa_2_21_Lukio_ammpk_opisk_tutk] AS

SELECT
	   [tilv]= cast(kaikkivuodet.tilv as nvarchar(4))
	  ,tilv_date = cast(kaikkivuodet.tilv+''0101'' as date)
      ,[perusjoukko] = cast(kaikkivuodet.perusjoukko as nvarchar(2))
      ,[aikielir1] = cast(kaikkivuodet.aikielir1 as nvarchar(2))
      ,[koulk] = cast(kaikkivuodet.koulk as nvarchar(6))
      ,[kmaak] = cast(kaikkivuodet.kmaak as nvarchar(2))
      ,[lkm] = cast(kaikkivuodet.lkm as int)
   	  ,tietolahde = cast(kaikkivuodet.tietolahde as nvarchar(20))
	  ,rivinumero = cast(kaikkivuodet.rivinumero as int)
FROM (
  SELECT [tilv]
      ,[perusjoukko]
      ,[aikielir1]
      ,[koulk]
      ,[kmaak]
      ,[lkm]
	  ,[tietolahde] = ''TK_2_21_sopv_17''
	  ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_21_sopv_17]
  UNION ALL
  SELECT [tilv]
      ,[perusjoukko]
      ,[aikielir1]
      ,[koulk]
      ,[kmaak]
      ,[lkm]
	  ,[tietolahde] = ''TK_2_21_sopv_16''
	  ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_21_sopv_16]
  UNION ALL
  SELECT [tilv]
      ,[perusjoukko]
      ,[aikielir1]
      ,[koulk]
      ,[kmaak]
      ,[lkm]
	  ,[tietolahde] = ''TK_2_21_sopv_15''
	  ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_21_sopv_15]
  UNION ALL
  SELECT [tilv]
      ,[perusjoukko]
      ,[aikielir1]
      ,[koulk]
      ,[kmaak]
      ,[lkm]
	  ,[tietolahde] = ''TK_2_21_sopv_14''
	  ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_21_sopv_14]
   UNION ALL
  SELECT [tilv]
      ,[perusjoukko]
      ,[aikielir1]
      ,[koulk]
      ,[kmaak] = case 
					  when kmaak=''20'' then ''01''
					  when left(kmaak,1)<>0 and len(kmaak)=1 then ''0''+kmaak	
					  else kmaak
				 end
      ,[lkm]
	  ,[tietolahde] = ''TK_2_21_sopv_13''
	  ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_21_sopv_13]
  UNION ALL
  SELECT [tilv]
      ,[perusjoukko]
      ,[aikielir1]
      ,[koulk]
      ,[kmaak] = case 
					  when kmaak=''20'' then ''01''
					  when left(kmaak,1)<>0 and len(kmaak)=1 then ''0''+kmaak	
					  else kmaak
				 end
      ,[lkm]
	  ,[tietolahde] = ''TK_2_21_sopv_12''
	  ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_21_sopv_12]
  
  ) as kaikkivuodet








' 
GO
/****** Object:  View [dbo].[v_sa_2_23_Opisk_ja_tutksuor_vanh_aseman_muk]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_2_23_Opisk_ja_tutksuor_vanh_aseman_muk]'))
EXEC dbo.sp_executesql @statement = N'


CREATE VIEW [dbo].[v_sa_2_23_Opisk_ja_tutksuor_vanh_aseman_muk] AS
SELECT
	   [tilv]= cast(kaikkivuodet.tilv as nvarchar(4))
	  ,tilv_date = cast(kaikkivuodet.tilv+''0101'' as date)
	  ,[sp]= CAST(kaikkivuodet.sp as nvarchar (1))
      ,[syntv]= cast(kaikkivuodet.syntv as nvarchar(4))
      ,[aikielir1x]= cast (kaikkivuodet.aikielir1x as nvarchar(2))
      ,[tilvaskun]= cast (kaikkivuodet.tilvaskun as nvarchar(3))
      ,[tilvaskunx]= cast (kaikkivuodet.tilvaskunx as nvarchar(3))
      ,[sose_isa1]= cast (kaikkivuodet.sose_isa1 as nvarchar(1))
      ,[sose_aiti1]= cast (kaikkivuodet.sose_aiti1 as nvarchar(1))
      ,[sose_isa2]= cast (kaikkivuodet.sose_isa2 as nvarchar(2))
      ,[sose_aiti2]= cast (kaikkivuodet.sose_aiti2 as nvarchar(2))
      ,[koulk_isa]= cast (kaikkivuodet.koulk_isa as nvarchar(6))
      ,[koulk_aiti]= cast (kaikkivuodet.koulk_aiti as nvarchar(6))
      ,[tulo_isa]= cast (kaikkivuodet.tulo_isa as nvarchar(2))
      ,[tulo_aiti]= cast (kaikkivuodet.tulo_aiti as nvarchar(2))
      ,[klaji]= cast (kaikkivuodet.klaji as nvarchar(2))
      ,[ophal]= cast (kaikkivuodet.ophal as nvarchar(1))
      ,[koulk]= cast (kaikkivuodet.koulk as nvarchar(6))
      ,[kkieli]= cast (kaikkivuodet.kkieli as nvarchar(2))
      ,[kmaak]= cast (kaikkivuodet.kmaak as nvarchar(2))
      ,[alvv]= cast (kaikkivuodet.alvv as nvarchar(4))
      ,[olosyys]= cast (kaikkivuodet.olosyys as nvarchar(1))
      ,[uusi]= cast(kaikkivuodet.uusi as int)
      ,[opisk]= cast(kaikkivuodet.opisk as int)
      ,[tutk]= cast(kaikkivuodet.tutk as int)
   	  ,tietolahde = cast(kaikkivuodet.tietolahde as nvarchar(50))
	  ,rivinumero = cast(kaikkivuodet.rivinumero as int)
FROM (

SELECT [tilv]
      ,[sp]
      ,(CASE WHEN [syntv] = ''XXXX'' THEN '''' else [syntv] end )as syntv
      ,[aikielir1x]
      ,[tilvaskun]
      ,[tilvaskunx]
      ,[sose_isa1]
      ,[sose_aiti1]
      ,[sose_isa2]
      ,[sose_aiti2]
      ,[koulk_isa]
      ,[koulk_aiti]
      ,[tulo_isa]
      ,[tulo_aiti]
      ,[klaji]
      ,[ophal]
      ,[koulk]
      ,[kkieli]
      ,[kmaak]
      ,[alvv]
      ,[olosyys]
      ,(CASE WHEN [uusi]= ''''THEN NULL else [uusi] end )as uusi
      ,(CASE WHEN [opisk] = '''' THEN NULL else [opisk] end )as opisk
      ,(CASE WHEN [tutk] = '''' THEN NULL else [tutk] end )as tutk
      ,[tietolahde]=''2_23_sopv_12''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_23_sopv_12]
union all
SELECT [tilv]
      ,[sp]
      ,(CASE WHEN [syntv] = ''XXXX'' THEN '''' else [syntv] end )as syntv
      ,[aikielir1x]
      ,[tilvaskun]
      ,[tilvaskunx]
      ,[sose_isa1]
      ,[sose_aiti1]
      ,[sose_isa2]
      ,[sose_aiti2]
      ,[koulk_isa]
      ,[koulk_aiti]
      ,[tulo_isa]
      ,[tulo_aiti]
      ,[klaji]
      ,[ophal]
      ,[koulk]
      ,[kkieli]
      ,[kmaak]
      ,[alvv]
      ,[olosyys]
      ,(CASE WHEN [uusi] = '''' THEN NULL else [uusi] end )as uusi
      ,(CASE WHEN [opisk] = '''' THEN NULL else [opisk] end )as opisk
      ,(CASE WHEN [tutk] = '''' THEN NULL else [tutk] end )as tutk
      ,[tietolahde]=''2_23_sopv_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_23_sopv_13]
union all
SELECT [tilv]
      ,[sp]
      ,(CASE WHEN [syntv] = ''XXXX'' THEN '''' else [syntv] end )as syntv
      ,[aikielir1x]
      ,[tilvaskun]
      ,[tilvaskunx]
      ,[sose_isa1]
      ,[sose_aiti1]
      ,[sose_isa2]
      ,[sose_aiti2]
      ,[koulk_isa]
      ,[koulk_aiti]
      ,[tulo_isa]
      ,[tulo_aiti]
      ,[klaji]
      ,[ophal]
      ,[koulk]
      ,[kkieli]
      ,[kmaak]
      ,[alvv]
      ,[olosyys]
       ,(CASE WHEN [uusi] = '''' THEN NULL else [uusi] end )as uusi
      ,(CASE WHEN [opisk] = '''' THEN NULL else [opisk] end )as opisk
      ,(CASE WHEN [tutk] = '''' THEN NULL else [tutk] end )as tutk
      ,[tietolahde]=''2_23_sopv_14''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_23_sopv_14]
  union all
 SELECT [tilv]
      ,[sp]
      ,(CASE WHEN [syntv] = ''XXXX'' THEN '''' else [syntv] end )as syntv
      ,[aikielir1x]
      ,[tilvaskun]
      ,[tilvaskunx]
      ,[sose_isa1]
      ,[sose_aiti1]
      ,[sose_isa2]
      ,[sose_aiti2]
      ,[koulk_isa]
      ,[koulk_aiti]
      ,[tulo_isa]
      ,[tulo_aiti]
      ,[klaji]
      ,[ophal]
      ,[koulk]
      ,[kkieli]
      ,[kmaak]
      ,[alvv]
      ,[olosyys]
       ,(CASE WHEN [uusi] = '''' THEN NULL else [uusi] end )as uusi
      ,(CASE WHEN [opisk] = '''' THEN NULL else [opisk] end )as opisk
      ,(CASE WHEN [tutk] = '''' THEN NULL else [tutk] end )as tutk
      ,[tietolahde]=''2_23_sopv_15''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_23_sopv_15]

   union all
 SELECT [tilv]
      ,[sp]
      ,(CASE WHEN [syntv] = ''XXXX'' THEN '''' else [syntv] end )as syntv
      ,[aikielir1x]
      ,[tilvaskun]
      ,[tilvaskunx]
      ,[sose_isa1]
      ,[sose_aiti1]
      ,[sose_isa2]
      ,[sose_aiti2]
      ,[koulk_isa]
      ,[koulk_aiti]
      ,[tulo_isa]
      ,[tulo_aiti]
      ,[klaji]
      ,[ophal]
      ,[koulk]
      ,[kkieli]
      ,[kmaak]
      ,[alvv]
      ,[olosyys]
       ,(CASE WHEN [uusi] = '''' THEN NULL else [uusi] end )as uusi
      ,(CASE WHEN [opisk] = '''' THEN NULL else [opisk] end )as opisk
      ,(CASE WHEN [tutk] = '''' THEN NULL else [tutk] end )as tutk
      ,[tietolahde]=''2_23_sopv_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_23_sopv_16]

   union all
 SELECT [tilv]
      ,[sp]
      ,(CASE WHEN [syntv] = ''XXXX'' THEN '''' else [syntv] end )as syntv
      ,[aikielir1x]
      ,[tilvaskun]
      ,[tilvaskunx]
      ,[sose_isa1]
      ,[sose_aiti1]
      ,[sose_isa2]
      ,[sose_aiti2]
      ,[koulk_isa]
      ,[koulk_aiti]
      ,[tulo_isa]
      ,[tulo_aiti]
      ,[klaji]
      ,[ophal]
      ,[koulk]
      ,[kkieli]
      ,[kmaak]
      ,[alvv]
      ,[olosyys]
       ,(CASE WHEN [uusi] = '''' THEN NULL else [uusi] end )as uusi
      ,(CASE WHEN [opisk] = '''' THEN NULL else [opisk] end )as opisk
      ,(CASE WHEN [tutk] = '''' THEN NULL else [tutk] end )as tutk
      ,[tietolahde]=''2_23_sopv_17''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_23_sopv_17]
  
) as kaikkivuodet



' 
GO
/****** Object:  View [dbo].[v_sa_2_3_Lukio_ja_amm_koulutuksen_opiskelijat]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_2_3_Lukio_ja_amm_koulutuksen_opiskelijat]'))
EXEC dbo.sp_executesql @statement = N'





















CREATE VIEW [dbo].[v_sa_2_3_Lukio_ja_amm_koulutuksen_opiskelijat] AS


-- truncate table vipunentk_dw..sa_2_3_Lukio_ja_amm_koulutuksen_opiskelijat
-- insert into vipunentk_dw..sa_2_3_Lukio_ja_amm_koulutuksen_opiskelijat select * from v_sa_2_3_Lukio_ja_amm_koulutuksen_opiskelijat


SELECT
	tilv = CAST(kaikkivuodet.tilv as nvarchar(4))
	,tilv_date = Cast(kaikkivuodet.tilv+''0101'' as date)
	,lahde = cast(coalesce(nullif(kaikkivuodet.lahde , ''''), ''-1'') as nvarchar(2))
	,tunn = cast(coalesce(nullif(kaikkivuodet.tunn , ''''), ''-1'') as nvarchar(5))
	/* vanha
	CASE WHEN lahde = 34 and tunn = '''' THEN cast(coalesce(nullif(kaikkivuodet.opjarj, ''''), ''-1'')  as nvarchar(10))
			ELSE cast(coalesce(nullif(kaikkivuodet.tunn , ''''), ''-1'') as nvarchar(5))
			END   -- Ohjataan oppisopimuskoulutuksen lähteellä opjarj-muuttujan avain tyhjien arvojen tilalle - Lasse 26.5.2014

	*/
	,jarj = cast(coalesce(nullif(kaikkivuodet.jarj, ''''), ''-1'') as nvarchar(10))
	,opjarj = cast(coalesce(nullif(kaikkivuodet.opjarj, ''''), ''-1'')  as nvarchar(10))
	,koulk = cast(coalesce(nullif(kaikkivuodet.koulk , ''''), ''-1'') as nvarchar(6))
	,kkieli = cast(coalesce(nullif(kaikkivuodet.kkieli , ''''), ''-1'') as nvarchar(2))
	,kkun = cast(coalesce(nullif(kaikkivuodet.kkun , ''''), ''-1'') as nvarchar(3))
	,ophal = cast(coalesce(nullif(kaikkivuodet.ophal , ''''), ''-1'') as nvarchar(2))
	,sp = cast(coalesce(nullif(kaikkivuodet.sp , ''''), ''-1'') as nvarchar(2))
	,aikielir1 = cast(coalesce(nullif(kaikkivuodet.aikielir1 , ''''), ''-1'') as nvarchar(2))
	,alvv = cast(kaikkivuodet.alvv as nvarchar(4))
	,allk = cast(kaikkivuodet.allk as nvarchar(1))
	,olotamm = cast(kaikkivuodet.olotamm as nvarchar(1))
	,olosyys = cast(kaikkivuodet.olosyys as nvarchar(1))
	,aiopis = cast(coalesce(nullif(kaikkivuodet.aiopis , ''''), ''-1'') as nvarchar(2))
	,kirikar1 = cast(coalesce(nullif(nullif(kaikkivuodet.kirikar1 , '''') , ''XX''), ''-1'') as nvarchar(2))
	,lkm = cast(kaikkivuodet.lkm as int)
	,tutklajl = cast(coalesce(nullif(kaikkivuodet.tutklajl , ''''), ''-1'') as nvarchar(2))
	,aikoul = cast(coalesce(nullif(kaikkivuodet.aikoul , ''''), ''-1'') as nvarchar(2))
	,tutalv = cast(coalesce(nullif(kaikkivuodet.tutalv , ''''), ''-1'') as nvarchar(4))
	,tutalk = cast(coalesce(nullif(kaikkivuodet.tutalk , ''''), ''-1'') as nvarchar(2))
	,tutklaja = cast(coalesce(nullif(kaikkivuodet.tutklaja , ''''), ''-1'') as nvarchar(2))
	,tunim = cast(coalesce(nullif(kaikkivuodet.tunim , ''''), ''-1'') as nvarchar(5))
	,sutunim = cast(coalesce(nullif(kaikkivuodet.sutunim , ''''), ''-1'') as nvarchar(30))
	,rutunim = cast(coalesce(nullif(kaikkivuodet.rutunim , ''''), ''-1'') as nvarchar(30))
	,koohj = cast(coalesce(nullif(kaikkivuodet.koohj , ''''), ''-1'') as nvarchar(4))
	,sukoohj = cast(coalesce(nullif(kaikkivuodet.sukoohj , ''''), ''-1'') as nvarchar(60))
	,rukoohj = cast(coalesce(nullif(kaikkivuodet.rukoohj , ''''), ''-1'') as nvarchar(60))
	,tutktav = cast(coalesce(nullif(kaikkivuodet.tutktav , ''''), ''-1'') as nvarchar(2))
	,tyov = cast(coalesce(nullif(kaikkivuodet.tyov , ''''), ''-1'') as nvarchar(2))
	,rahoitus = cast(coalesce(nullif(kaikkivuodet.rahoitus , ''''), ''-1'') as nvarchar(2))
	,alaika = cast(VipunenTK_SA.[dbo].RefineDateBegin(kaikkivuodet.alaika) as nvarchar(8))
	,loaika = cast(VipunenTK_SA.[dbo].RefineDateEnd(kaikkivuodet.loaika) as nvarchar(8))
	,tavoite =  cast(coalesce(nullif(kaikkivuodet.tavoite,''''),''1'')  as nvarchar(2))   -- HUOM! tässä aineistossa tulkitaan tyhjät tutkinnon tavoitteet tarkoituksella arvoon "1 - koko tutkinnon suorittaminen" kuutiomääritelmän mukaan -- Lasse
	,yrit = cast(coalesce(nullif(kaikkivuodet.yrit , ''''), ''-1'') as nvarchar(2))
	,purku = cast(coalesce(nullif(kaikkivuodet.purku , ''''), ''-1'') as nvarchar(2))
	,todis = cast(coalesce(nullif(kaikkivuodet.todis , ''''), ''-1'') as nvarchar(2))
	,tol2008 = cast(coalesce(nullif(kaikkivuodet.tol2008 , ''''), ''-1'') as nvarchar(5))
	,koko = cast(coalesce(nullif(kaikkivuodet.koko , ''''), ''-1'') as nvarchar(2))
	,tyansek = cast(coalesce(nullif(kaikkivuodet.tyansek , ''''), ''-1'') as nvarchar(2))
	,tilvasmaak = case	when len(tilvasmaak) = 1 then ''0'' + cast(kaikkivuodet.tilvasmaak as nvarchar(2))
						else cast(coalesce(nullif(kaikkivuodet.tilvasmaak , ''''), ''-1'') as nvarchar(2))
				  end

	,tietolahde = cast(kaikkivuodet.tietolahde as nvarchar(250))
	,rivinumero = cast(kaikkivuodet.rivinumero as nvarchar(10))
FROM (

--Historia-aineisto
SELECT
	tilv
	, lahde = 
		case 
			when lahde=1 then ''21''
			when lahde=2 and oppis=2 then ''35''
			when lahde=2 and oppis=1 then ''34''
			else ''-1''
		end
	, tunn
	, jarj = op.koulutuksen_jarjestajakoodi
	, opjarj
	, koulk
	, kkieli = case kkielir1 when ''fs'' then ''fi'' else kkielir1 end
	, kkun
	, ophal
	, sp
	, aikielir1
	, alvv
	, allk
	, olotamm
	, olosyys
	, aiopis = 
		case 
			when ltrim(ika)=''.'' or alvv=''9999'' then ''9''
			else
				case
					when cast(ika as int)-(cast(tilv as int)-cast(alvv as int))<25 then ''1''
					else ''2''
				end
		end
	, kirikar1 = 
		case 
			when ltrim(ika)=''.'' then ''-1''
			else 
				case
					when cast(ika as int) between 15 and 19 then ''15''
					when cast(ika as int) between 20 and 24 then ''20''
					when cast(ika as int) between 25 and 29 then ''25''
					when cast(ika as int) between 30 and 34 then ''30''
					when cast(ika as int) between 35 and 39 then ''35''
					when cast(ika as int) between 40 and 44 then ''40''
					when cast(ika as int) between 45 and 49 then ''45''
					when cast(ika as int) between 50 and 54 then ''50''
					when cast(ika as int) between 55 and 59 then ''55''
					when cast(ika as int) > 60 then ''60''
					else ''-1''
				end
		end
	, lkm
	, tutklajl = 
		case 
			when koulk = ''301101'' then ''1''
			when koulk = ''301102'' then ''2''--IB
			when koulk = ''301103'' then ''3''--Reifeprüfung
			when koulk = ''309901'' then ''4''--Gymnasieexamen
			when koulk = ''301104'' then ''5''--EB
			else ''-1''
		end
	, aikoul
	, tutalv
	, tutalk
	, tutklaja
	, tunim = null
	, sutunim = null
	, rutunim = null
	, koohj = null
	, sukoohj = null
	, rukoohj = null
	, tutktav
	, tyov
	, rahoitus
	, alaika = null
	, loaika = null
	, tavoite
	, yrit = null
	, purku = null
	, todis = null
	, tol2008 = null
	, koko = null
	, tyansek = null
	, tilvasmaak = asmaak
	,[tietolahde]=''8_2_Historia_aineisto_opiskelijat''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_8_2_sopv_16] tk
left join VipunenTK.dbo.d_oppilaitoksen_taustatiedot op on op.oppilaitos_avain=tk.tunn
where lahde in (1,2) and tilv<2010

UNION ALL

SELECT
	tilv
	, lahde
	, tunn
	, jarj
	, opjarj
	, koulk
	, kkieli
	, kkun
	, ophal
	, sp
	, aikielir1
	, alvv
	, allk
	, olotamm
	, olosyys
	, aiopis
	, kirikar1
	, lkm
	, tutklajl
	, aikoul
	, tutalv
	, tutalk
	, tutklaja
	, tunim
	, sutunim
	, rutunim
	, koohj
	, sukoohj
	, rukoohj
	, tutktav
	, tyov
	, rahoitus
	, alaika 
	, loaika 
	, tavoite
	, yrit
	, purku
	, todis
	, tol2008
	, koko
	, tyansek
	, tilvasmaak
	,[tietolahde]=''2_3a_Lukio_ja_amm_koulutuksen_opiskelijat_11''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3a_sopv_11]
union all
SELECT
	tilv
	, lahde
	, tunn
	, jarj
	, opjarj
	, koulk
	, kkieli
	, kkun =
		CASE 
			WHEN len(kkun) = 1 THEN ''00'' + kkun
			WHEN len(kkun) = 2 THEN ''0'' + kkun
			ELSE kkun
		END
	, ophal
	, sp
	, aikielir1
	, alvv
	, allk
	, olotamm
	, olosyys
	, aiopis
	, kirikar1
	, lkm
	, tutklajl
	, aikoul
	, tutalv
	, tutalk
	, tutklaja
	, tunim
	, sutunim
	, rutunim
	, koohj
	, sukoohj
	, rukoohj
	, tutktav
	, tyov
	, rahoitus
	, alaika
	, loaika
	, tavoite
	, yrit
	, purku
	, todis
	, tol2008
	, koko
	, tyansek
	, tilvasmaak
	,[tietolahde]=''2_3b_Lukio_ja_amm_koulutuksen_opiskelijat_11''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3b_sopv_11]
union all
SELECT
	tilv
	, lahde
	, tunn
	, jarj
	, opjarj
	, koulk
	, kkieli
	, kkun
	, ophal
	, sp
	, aikielir1
	, alvv
	, allk
	, olotamm
	, olosyys
	, aiopis
	, kirikar1
	, lkm
	, tutklajl
	, aikoul
	, tutalv
	, tutalk
	, tutklaja
	, tunim
	, sutunim
	, rutunim
	, koohj
	, sukoohj
	, rukoohj
	, tutktav
	, tyov
	, rahoitus
	, alaika
	, loaika
	, tavoite
	, yrit
	, purku
	, todis
	, tol2008
	, koko
	, tyansek
	, tilvasmaak
	,[tietolahde]=''2_3c_Lukio_ja_amm_koulutuksen_opiskelijat_11''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3c_sopv_11]
union all
SELECT
	tilv
	, lahde
	, tunn
	, jarj
	, opjarj
	, koulk
	, kkieli
	, kkun
	, ophal
	, sp
	, aikielir1
	, alvv
	, allk
	, olotamm
	, olosyys
	, aiopis
	, kirikar1
	, lkm
	, tutklajl
	, aikoul
	, tutalv
	, tutalk
	, tutklaja
	, tunim
	, sutunim
	, rutunim
	, koohj
	, sukoohj
	, rukoohj
	, tutktav
	, tyov
	, rahoitus
	, alaika
	, loaika
	, tavoite
	, yrit
	, purku
	, todis
	, tol2008
	, koko
	, tyansek
	, tilvasmaak
	,[tietolahde]=''2_3d_Lukio_ja_amm_koulutuksen_opiskelijat_11''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3d_sopv_11]
union all
SELECT
	tilv
	, lahde
	, tunn
	, jarj
	, opjarj
	, koulk
	, kkieli
	, kkun
	, ophal
	, sp
	, aikielir1
	, alvv
	, allk
	, olotamm
	, olosyys
	, aiopis
	, kirikar1
	, lkm
	, tutklajl
	, aikoul
	, tutalv
	, tutalk
	, tutklaja
	, tunim
	, sutunim
	, rutunim
	, koohj
	, sukoohj
	, rukoohj
	, tutktav
	, tyov
	, rahoitus
	, alaika
	, loaika
	, tavoite
	, yrit
	, purku
	, todis
	, tol2008
	, koko
	, tyansek
	, tilvasmaak
	,[tietolahde]=''2_3a_Lukio_ja_amm_koulutuksen_opiskelijat_12''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3a_sopv_12]
union all
SELECT
	tilv
	, lahde
	, tunn
	, jarj
	, opjarj
	, koulk
	, kkieli
	, kkun
	, ophal
	, sp
	, aikielir1
	, alvv
	, allk
	, olotamm
	, olosyys
	, aiopis
	, kirikar1
	, lkm
	, tutklajl
	, aikoul
	, tutalv
	, tutalk
	, tutklaja
	, tunim
	, sutunim
	, rutunim
	, koohj
	, sukoohj
	, rukoohj
	, tutktav
	, tyov
	, rahoitus
	, alaika
	, loaika
	, tavoite
	, yrit
	, purku
	, todis
	, tol2008
	, koko
	, tyansek
	, tilvasmaak
	,[tietolahde]=''2_3b_Lukio_ja_amm_koulutuksen_opiskelijat_12''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3b_sopv_12]
union all
SELECT
	tilv
	, lahde
	, tunn
	, jarj
	, opjarj
	, koulk
	, kkieli
	, kkun
	, ophal
	, sp
	, aikielir1
	, alvv
	, allk
	, olotamm
	, olosyys
	, aiopis
	, kirikar1
	, lkm
	, tutklajl
	, aikoul
	, tutalv
	, tutalk
	, tutklaja
	, tunim
	, sutunim
	, rutunim
	, koohj
	, sukoohj
	, rukoohj
	, tutktav
	, tyov
	, rahoitus
	, alaika
	, loaika
	, tavoite
	, yrit
	, purku
	, todis
	, tol2008
	, koko
	, tyansek
	, tilvasmaak
	,[tietolahde]=''2_3c_Lukio_ja_amm_koulutuksen_opiskelijat_12''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3c_sopv_12]
union all
SELECT
	tilv
	, lahde
	, tunn
	, jarj
	, opjarj
	, koulk
	, kkieli
	, kkun
	, ophal
	, sp
	, aikielir1
	, alvv
	, allk
	, olotamm
	, olosyys
	, aiopis
	, kirikar1
	, lkm
	, tutklajl
	, aikoul
	, tutalv
	, tutalk
	, tutklaja
	, tunim
	, sutunim
	, rutunim
	, koohj
	, sukoohj
	, rukoohj
	, tutktav
	, tyov
	, rahoitus
	, alaika
	, loaika
	, tavoite
	, yrit
	, purku
	, todis
	, tol2008
	, koko
	, tyansek
	, tilvasmaak
	,[tietolahde]=''2_3d_Lukio_ja_amm_koulutuksen_opiskelijat_12''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3d_sopv_12]
union all
SELECT
	tilv
	, lahde
	, tunn
	, jarj
	, opjarj
	, koulk
	, kkieli
	, kkun
	, ophal
	, sp
	, aikielir1
	, alvv
	, allk
	, olotamm
	, olosyys
	, aiopis
	, kirikar1
	, lkm
	, tutklajl
	, aikoul
	, tutalv
	, tutalk
	, tutklaja
	, tunim
	, sutunim
	, rutunim
	, koohj
	, sukoohj
	, rukoohj
	, tutktav
	, tyov
	, rahoitus
	, alaika
	, loaika
	, tavoite
	, yrit
	, purku
	, todis
	, tol2008
	, koko
	, tyansek
	, tilvasmaak
	,[tietolahde]=''2_3a_Lukio_ja_amm_koulutuksen_opiskelijat_113''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3a_sopv_13]
union all
SELECT
	tilv
	, lahde
	, tunn
	, jarj
	, opjarj
	, koulk
	, kkieli
	, kkun
	, ophal
	, sp
	, aikielir1
	, alvv
	, allk
	, olotamm
	, olosyys
	, aiopis
	, kirikar1
	, lkm
	, tutklajl
	, aikoul
	, tutalv
	, tutalk
	, tutklaja
	, tunim
	, sutunim
	, rutunim
	, koohj
	, sukoohj
	, rukoohj
	, tutktav
	, tyov
	, rahoitus
	, alaika
	, loaika
	, tavoite
	, yrit
	, purku
	, todis
	, tol2008
	, koko
	, tyansek
	, tilvasmaak
	,[tietolahde]=''2_3b_Lukio_ja_amm_koulutuksen_opiskelijat_13''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3b_sopv_13]

union all
SELECT
	tilv
	, lahde
	, tunn
	, jarj
	, opjarj
	, koulk
	, kkieli
	, kkun
	, ophal
	, sp
	, aikielir1
	, alvv
	, allk
	, olotamm
	, olosyys
	, aiopis
	, kirikar1
	, lkm
	, tutklajl
	, aikoul
	, tutalv
	, tutalk
	, tutklaja
	, tunim
	, sutunim
	, rutunim
	, koohj
	, sukoohj
	, rukoohj
	, tutktav
	, tyov
	, rahoitus
	, alaika
	, loaika
	, tavoite
	, yrit
	, purku
	, todis
	, tol2008
	, koko
	, tyansek
	, tilvasmaak
	,[tietolahde]=''2_3c_Lukio_ja_amm_koulutuksen_opiskelijat_13''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3c_sopv_13]

union all
SELECT
	tilv
	, lahde
	, tunn
	, jarj
	, opjarj
	, koulk
	, kkieli
	, kkun
	, ophal
	, sp
	, aikielir1
	, alvv
	, allk
	, olotamm
	, olosyys
	, aiopis
	, kirikar1
	, lkm
	, tutklajl
	, aikoul
	, tutalv
	, tutalk
	, tutklaja
	, tunim
	, sutunim
	, rutunim
	, koohj
	, sukoohj
	, rukoohj
	, tutktav
	, tyov
	, rahoitus
	, alaika
	, loaika
	, tavoite
	, yrit
	, purku
	, todis
	, tol2008
	, koko
	, tyansek
	, tilvasmaak
	,[tietolahde]=''2_3d_Lukio_ja_amm_koulutuksen_opiskelijat_13''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3d_sopv_13]

union all
SELECT
	tilv
	, lahde
	, tunn
	, jarj
	, opjarj
	, koulk
	, kkieli
	, kkun
	, ophal
	, sp
	, aikielir1
	, alvv
	, allk
	, olotamm
	, olosyys
	, aiopis
	, kirikar1
	, lkm
	, tutklajl
	, aikoul
	, tutalv
	, tutalk
	, tutklaja
	, tunim
	, sutunim
	, rutunim
	, koohj
	, sukoohj
	, rukoohj
	, tutktav
	, tyov
	, rahoitus
	, alaika
	, loaika
	, tavoite
	, yrit
	, purku
	, todis
	, tol2008
	, koko
	, tyansek
	, tilvasmaak
	,[tietolahde]=''2_3a_Lukio_ja_amm_koulutuksen_opiskelijat_14''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3a_sopv_14]

/* aineistot 14b, 14c rikki vielä -- Lasse 27.11.2014 
Otettu mukaan 20.1.2015 / Jarmo */
union all
SELECT
	tilv
	, lahde
	, tunn
	, jarj
	, opjarj
	, koulk
	, kkieli
	, kkun
	, ophal
	, sp
	, aikielir1
	, alvv
	, allk
	, olotamm
	, olosyys
	, aiopis
	, kirikar1
	, lkm
	, tutklajl
	, aikoul
	, tutalv
	, tutalk
	, tutklaja
	, tunim
	, sutunim
	, rutunim
	, koohj
	, sukoohj
	, rukoohj
	, tutktav
	, tyov
	, rahoitus
	, alaika
	, loaika
	, tavoite
	, yrit
	, purku
	, todis
	, tol2008
	, koko
	, tyansek
	, tilvasmaak
	,[tietolahde]=''2_3b_Lukio_ja_amm_koulutuksen_opiskelijat_14''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3b_sopv_14]

union all
SELECT
	tilv
	, lahde
	, tunn
	, jarj
	, opjarj
	, koulk
	, kkieli
	, kkun
	, ophal
	, sp
	, aikielir1
	, alvv
	, allk
	, olotamm
	, olosyys
	, aiopis
	, kirikar1
	, lkm
	, tutklajl
	, aikoul
	, tutalv
	, tutalk
	, tutklaja
	, tunim
	, sutunim
	, rutunim
	, koohj
	, sukoohj
	, rukoohj
	, tutktav
	, tyov
	, rahoitus
	, alaika
	, loaika
	, tavoite
	, yrit
	, purku
	, todis
	, tol2008
	, koko
	, tyansek
	, tilvasmaak
	,[tietolahde]=''2_3c_Lukio_ja_amm_koulutuksen_opiskelijat_14''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3c_sopv_14]
/* Otettu mukaan 20.1.2015 / Jarmo 
*/

union all
SELECT
	tilv
	, lahde
	, tunn
	, jarj
	, opjarj
	, koulk
	, kkieli
	, kkun
	, ophal
	, sp
	, aikielir1
	, alvv
	, allk
	, olotamm
	, olosyys
	, aiopis
	, kirikar1
	, lkm
	, tutklajl
	, aikoul
	, tutalv
	, tutalk
	, tutklaja
	, tunim
	, sutunim
	, rutunim
	, koohj
	, sukoohj
	, rukoohj
	, tutktav
	, tyov
	, rahoitus
	, alaika
	, loaika
	, tavoite
	, yrit
	, purku
	, todis
	, tol2008
	, koko
	, tyansek
	, tilvasmaak
	,[tietolahde]=''2_3a_Lukio_ja_amm_koulutuksen_opiskelijat_15''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3a_sopv_15]
union all
SELECT
	tilv
	, lahde
	, tunn
	, jarj
	, opjarj
	, koulk
	, kkieli
	, kkun
	, ophal
	, sp
	, aikielir1
	, alvv
	, allk
	, olotamm
	, olosyys
	, aiopis
	, kirikar1
	, lkm
	, tutklajl
	, aikoul
	, tutalv
	, tutalk
	, tutklaja
	, tunim
	, sutunim
	, rutunim
	, koohj
	, sukoohj
	, rukoohj
	, tutktav
	, tyov
	, rahoitus
	, alaika
	, loaika
	, tavoite
	, yrit
	, purku
	, todis
	, tol2008
	, koko
	, tyansek
	, tilvasmaak
	,[tietolahde]=''2_3b_Lukio_ja_amm_koulutuksen_opiskelijat_15''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3b_sopv_15]

union all
SELECT
	tilv
	, lahde
	, tunn
	, jarj
	, opjarj
	, koulk
	, kkieli
	, kkun
	, ophal
	, sp
	, aikielir1
	, alvv
	, allk
	, olotamm
	, olosyys
	, aiopis
	, kirikar1
	, lkm
	, tutklajl
	, aikoul
	, tutalv
	, tutalk
	, tutklaja
	, tunim
	, sutunim
	, rutunim
	, koohj
	, sukoohj
	, rukoohj
	, tutktav
	, tyov
	, rahoitus
	, alaika
	, loaika
	, tavoite
	, yrit
	, purku
	, todis
	, tol2008
	, koko
	, tyansek
	, tilvasmaak
	,[tietolahde]=''2_3c_Lukio_ja_amm_koulutuksen_opiskelijat_15''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3c_sopv_15]
union all
SELECT
	tilv
	, lahde
	, tunn
	, jarj
	, opjarj
	, koulk
	, kkieli
	, kkun
	, ophal
	, sp
	, aikielir1
	, alvv
	, allk
	, olotamm
	, olosyys
	, aiopis
	, kirikar1
	, lkm
	, tutklajl
	, aikoul
	, tutalv
	, tutalk
	, tutklaja
	, tunim
	, sutunim
	, rutunim
	, koohj
	, sukoohj
	, rukoohj
	, tutktav
	, tyov
	, rahoitus
	, alaika
	, loaika
	, tavoite
	, yrit
	, purku
	, todis
	, tol2008
	, koko
	, tyansek
	, tilvasmaak
	,[tietolahde]=''2_3a_Lukio_ja_amm_koulutuksen_opiskelijat_16''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3a_sopv_16]
-- Tarjolla on myös TK_2_3e_sopv_15 mutta e-aineistoja ei ole aiempiakaan, joten sitä ei oteta mukaan. / CSC Jarmo 3.8.2015



union all
SELECT
	tilv
	, lahde
	, tunn
	, jarj
	, opjarj
	, koulk
	, kkieli
	, kkun
	, ophal
	, sp
	, aikielir1
	, alvv
	, allk
	, olotamm
	, olosyys
	, aiopis
	, kirikar1
	, lkm
	, tutklajl
	, aikoul
	, tutalv
	, tutalk
	, tutklaja
	, tunim
	, sutunim
	, rutunim
	, koohj
	, sukoohj
	, rukoohj
	, tutktav
	, tyov
	, rahoitus
	, alaika
	, loaika
	, tavoite
	, yrit
	, purku
	, todis
	, tol2008
	, koko
	, tyansek
	, tilvasmaak
	,[tietolahde]=''2_3b_Lukio_ja_amm_koulutuksen_opiskelijat_16''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3b_sopv_16]


union all
SELECT
	tilv
	, lahde
	, tunn
	, jarj
	, opjarj
	, koulk
	, kkieli
	, kkun
	, ophal
	, sp
	, aikielir1
	, alvv
	, allk
	, olotamm
	, olosyys
	, aiopis
	, kirikar1
	, lkm
	, tutklajl
	, aikoul
	, tutalv
	, tutalk
	, tutklaja
	, tunim
	, sutunim
	, rutunim
	, koohj
	, sukoohj
	, rukoohj
	, tutktav
	, tyov
	, rahoitus
	, alaika
	, loaika
	, tavoite
	, yrit
	, purku
	, todis
	, tol2008
	, koko
	, tyansek
	, tilvasmaak
	,[tietolahde]=''2_3c_Lukio_ja_amm_koulutuksen_opiskelijat_16''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3c_sopv_16]


) kaikkivuodet






















' 
GO
/****** Object:  View [dbo].[v_sa_2_3efg_Lukio_ja_amm_koulutuksen_opiskelijat]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_2_3efg_Lukio_ja_amm_koulutuksen_opiskelijat]'))
EXEC dbo.sp_executesql @statement = N'










CREATE VIEW [dbo].[v_sa_2_3efg_Lukio_ja_amm_koulutuksen_opiskelijat] AS


-- truncate table vipunentk_dw..sa_2_3efg_Lukio_ja_amm_koulutuksen_opiskelijat
-- insert into vipunentk_dw..sa_2_3efg_Lukio_ja_amm_koulutuksen_opiskelijat select * from v_sa_2_3efg_Lukio_ja_amm_koulutuksen_opiskelijat




SELECT
	tilv = CAST(kaikkivuodet.tilv as nvarchar(4))
	,tilv_date = Cast(kaikkivuodet.tilv+''0101'' as date)
	,lahde = cast(coalesce(nullif(kaikkivuodet.lahde , ''''), ''-1'') as nvarchar(2))
	,jarj = cast(coalesce(nullif(kaikkivuodet.jarj, ''''), ''-1'') as nvarchar(10))
	,opjarj = cast(coalesce(nullif(kaikkivuodet.opjarj, ''''), ''-1'')  as nvarchar(10))
	,kkieli = cast(coalesce(nullif(kaikkivuodet.kkieli , ''''), ''-1'') as nvarchar(2))
	,koulk = cast(coalesce(nullif(kaikkivuodet.koulk , ''''), ''-1'') as nvarchar(6))
	,kkun = cast(coalesce(nullif(kaikkivuodet.kkun , ''''), ''-1'') as nvarchar(3))
	,ophal = cast(coalesce(nullif(kaikkivuodet.ophal , ''''), ''-1'') as nvarchar(2))
	,sp = cast(coalesce(nullif(kaikkivuodet.sp , ''''), ''-1'') as nvarchar(2))
	,aikielir1 = cast(coalesce(nullif(kaikkivuodet.aikielir1 , ''''), ''-1'') as nvarchar(2))
	,tilvasmaak = cast(coalesce(nullif(kaikkivuodet.tilvasmaak , ''''), ''-1'') as nvarchar(2))
	,alvv = cast(kaikkivuodet.alvv as nvarchar(4))	
	,aiopis = cast(coalesce(nullif(kaikkivuodet.aiopis , ''''), ''-1'') as nvarchar(2))
	,ika2 = cast(coalesce(nullif(kaikkivuodet.ika2, ''''), ''-1'') as nvarchar(2))
	,lkm = cast(kaikkivuodet.lkm as int)
	,aikoul = cast(coalesce(nullif(kaikkivuodet.aikoul , ''''), ''-1'') as nvarchar(2))
	,tutalv = cast(coalesce(nullif(kaikkivuodet.tutalv , ''''), ''-1'') as nvarchar(4))
	,tutklaja = cast(coalesce(nullif(kaikkivuodet.tutklaja , ''''), ''-1'') as nvarchar(2))
	,tunim = cast(coalesce(nullif(kaikkivuodet.tunim , ''''), ''-1'') as nvarchar(255))
	,sutunim = cast(coalesce(nullif(kaikkivuodet.sutunim , ''''), ''-1'') as nvarchar(255))
	,rutunim = cast(coalesce(nullif(kaikkivuodet.rutunim , ''''), ''-1'') as nvarchar(255))
	,koohj = cast(coalesce(nullif(kaikkivuodet.koohj , ''''), ''-1'') as nvarchar(100))
	,sukoohj = cast(coalesce(nullif(kaikkivuodet.sukoohj , ''''), ''-1'') as nvarchar(100))
	,rukoohj = cast(coalesce(nullif(kaikkivuodet.rukoohj , ''''), ''-1'') as nvarchar(100))
	,tutktav = cast(coalesce(nullif(kaikkivuodet.tutktav , ''''), ''-1'') as nvarchar(2))
	,rahoitus = cast(coalesce(nullif(kaikkivuodet.rahoitus , ''''), ''-1'') as nvarchar(2))
	,tavoite =  cast(coalesce(nullif(kaikkivuodet.tavoite,''''),''-1'')  as nvarchar(2))   -- HUOM! tässä aineistossa tulkitaan tyhjät tutkinnon tavoitteet tarkoituksella arvoon "1 - koko tutkinnon suorittaminen" kuutiomääritelmän mukaan -- Lasse
	,olosyys = cast(kaikkivuodet.olosyys as nvarchar(1))
	,tietolahde = cast(kaikkivuodet.tietolahde as nvarchar(250))
	,rivinumero = cast(kaikkivuodet.rivinumero as nvarchar(10))
FROM (
/* Ei oteta historiatietoja mukaan koska vuosilta 2011-2012 ei ole dataa
--Historia-aineisto
SELECT
	  [tilv]
      ,[lahde] = 
		case
			when lahde = ''1'' then ''21''
			when lahde = ''2'' and oppis = ''2'' then ''35''
			when lahde = ''2'' and oppis = ''1'' then ''34''
			else ''-1''
		end
      ,[jarj] = ot.koulutuksen_jarjestajakoodi
      ,[opjarj]
      ,[koulk]
      ,kkieli = case [kkielir1] when ''fs'' then ''fi'' else kkielir1 end
      ,[kkun]
      ,[ophal]
      ,[sp]
      ,[aikielir1]
      ,[tilvasmaak] = asmaak
      ,[alvv]
      ,[aiopis] = null
      ,ika2 = --ikä kirjoihintulovuonna
		case  
			when ltrim([ika])=''.'' or alvv=''9999'' then ''XX'' 
			else 
				case 
					when cast(ltrim([ika]) as int)-(cast(tilv as int)-cast(alvv as int))>=60 then ''60''
					else cast(cast(ltrim([ika]) as int)-(cast(tilv as int)-cast(alvv as int)) as varchar)
				end
		end
      ,[lkm]
      ,[aikoul]
      ,[tutalv]
      ,[tutklaja]
      ,[tunim] = null
      ,[sutunim] = null
      ,[rutunim] = null
      ,[koohj] = null
      ,[sukoohj] = null
      ,[rukoohj] = null
      ,[tutktav]
      ,[rahoitus]
      ,[tavoite]
      ,[olosyys]
	  ,[tietolahde]=''8_2_Historia_opiskelijat''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_8_2_sopv_16] tk
left join VipunenTK.dbo.d_oppilaitoksen_taustatiedot ot on ot.oppilaitos_avain=tk.tunn
where lahde in (1,2) and tilv<2013

UNION ALL
*/
SELECT
	  [tilv]
      ,[lahde]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[kkieli]
      ,[kkun]
      ,[ophal]
      ,[sp]
      ,[aikielir1]
      ,[tilvasmaak]
      ,[alvv]
      ,[aiopis]
      ,[ika2]
      ,[lkm]
      ,[aikoul]
      ,[tutalv]
      ,[tutklaja]
      ,[tunim]
      ,[sutunim]
      ,[rutunim]
      ,[koohj]
      ,[sukoohj]
      ,[rukoohj]
      ,[tutktav]
      ,[rahoitus]
      ,[tavoite]
      ,[olosyys]
	  ,[tietolahde]=''2_3e_Lukio_ja_amm_koulutuksen_opiskelijat_14''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3e_sopv_14]

union all

SELECT
	   [tilv]
      ,[lahde]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[kkieli]
      ,[kkun]
      ,[ophal]
      ,[sp]
      ,[aikielir1]
      ,[tilvasmaak]
      ,[alvv]
      ,[aiopis]
      ,[ika2]
      ,[lkm]
      ,[aikoul]
      ,[tutalv]
      ,[tutklaja]
      ,[tunim]
      ,[sutunim]
      ,[rutunim]
      ,[koohj]
      ,[sukoohj]
      ,[rukoohj]
      ,[tutktav]
      ,[rahoitus]
      ,[tavoite]
      ,[olosyys]
	  ,[tietolahde]=''2_3f_Lukio_ja_amm_koulutuksen_opiskelijat_14''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3f_sopv_14]

union all

SELECT
	   [tilv]
      ,[lahde]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[kkieli]
      ,[kkun]
      ,[ophal]
      ,[sp]
      ,[aikielir1]
      ,[tilvasmaak]
      ,[alvv]
      ,[aiopis]
      ,[ika2]
      ,[lkm]
      ,[aikoul]
      ,[tutalv]
      ,[tutklaja]
      ,[tunim]
      ,[sutunim]
      ,[rutunim]
      ,[koohj]
      ,[sukoohj]
      ,[rukoohj]
      ,[tutktav]
      ,[rahoitus]
      ,[tavoite]
      ,[olosyys]
	  ,[tietolahde]=''2_3g_Lukio_ja_amm_koulutuksen_opiskelijat_14''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3g_sopv_14]

union all

SELECT
	   [tilv]
      ,[lahde]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[kkieli]
      ,[kkun]
      ,[ophal]
      ,[sp]
      ,[aikielir1]
      ,[tilvasmaak]
      ,[alvv]
      ,[aiopis]
      ,[ika2]
      ,[lkm]
      ,[aikoul]
      ,[tutalv]
      ,[tutklaja]
      ,[tunim]
      ,[sutunim]
      ,[rutunim]
      ,[koohj]
      ,[sukoohj]
      ,[rukoohj]
      ,[tutktav]
      ,[rahoitus]
      ,[tavoite]
      ,[olosyys]
	  ,[tietolahde]=''2_3e_Lukio_ja_amm_koulutuksen_opiskelijat_15''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3e_sopv_15]

union all

SELECT
	   [tilv]
      ,[lahde]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[kkieli]
      ,[kkun]
      ,[ophal]
      ,[sp]
      ,[aikielir1]
      ,[tilvasmaak]
      ,[alvv]
      ,[aiopis]
      ,[ika2]
      ,[lkm]
      ,[aikoul]
      ,[tutalv]
      ,[tutklaja]
      ,[tunim]
      ,[sutunim]
      ,[rutunim]
      ,[koohj]
      ,[sukoohj]
      ,[rukoohj]
      ,[tutktav]
      ,[rahoitus]
      ,[tavoite]
      ,[olosyys]
	  ,[tietolahde]=''2_3f_Lukio_ja_amm_koulutuksen_opiskelijat_15''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3f_sopv_15]

union all

SELECT
	   [tilv]
      ,[lahde]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[kkieli]
      ,[kkun]
      ,[ophal]
      ,[sp]
      ,[aikielir1]
      ,[tilvasmaak]
      ,[alvv]
      ,[aiopis]
      ,[ika2]
      ,[lkm]
      ,[aikoul]
      ,[tutalv]
      ,[tutklaja]
      ,[tunim]
      ,[sutunim]
      ,[rutunim]
      ,[koohj]
      ,[sukoohj]
      ,[rukoohj]
      ,[tutktav]
      ,[rahoitus]
      ,[tavoite]
      ,[olosyys]
	  ,[tietolahde]=''2_3g_Lukio_ja_amm_koulutuksen_opiskelijat_15''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3g_sopv_15]

union all

SELECT
	   [tilv]
      ,[lahde]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[kkieli]
      ,[kkun]
      ,[ophal]
      ,[sp]
      ,[aikielir1]
      ,[tilvasmaak]
      ,[alvv]
      ,[aiopis]
      ,[ika2]
      ,[lkm]
      ,[aikoul]
      ,[tutalv]
      ,[tutklaja]
      ,[tunim]
      ,[sutunim]
      ,[rutunim]
      ,[koohj]
      ,[sukoohj]
      ,[rukoohj]
      ,[tutktav]
      ,[rahoitus]
      ,[tavoite]
      ,[olosyys]
	  ,[tietolahde]=''2_3e_Lukio_ja_amm_koulutuksen_opiskelijat_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3e_sopv_16]

union all

SELECT
	   [tilv]
      ,[lahde]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[kkieli]
      ,[kkun]
      ,[ophal]
      ,[sp]
      ,[aikielir1]
      ,[tilvasmaak]
      ,[alvv]
      ,[aiopis]
      ,[ika2]
      ,[lkm]
      ,[aikoul]
      ,[tutalv]
      ,[tutklaja]
      ,[tunim]
      ,[sutunim]
      ,[rutunim]
      ,[koohj]
      ,[sukoohj]
      ,[rukoohj]
      ,[tutktav]
      ,[rahoitus]
      ,[tavoite]
      ,[olosyys]
	  ,[tietolahde]=''2_3f_Lukio_ja_amm_koulutuksen_opiskelijat_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3f_sopv_16]

union all

SELECT
	   [tilv]
      ,[lahde]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[kkieli]
      ,[kkun]
      ,[ophal]
      ,[sp]
      ,[aikielir1]
      ,[tilvasmaak]
      ,[alvv]
      ,[aiopis]
      ,[ika2]
      ,[lkm]
      ,[aikoul]
      ,[tutalv]
      ,[tutklaja]
      ,[tunim]
      ,[sutunim]
      ,[rutunim]
      ,[koohj]
      ,[sukoohj]
      ,[rukoohj]
      ,[tutktav]
      ,[rahoitus]
      ,[tavoite]
      ,[olosyys]
	  ,[tietolahde]=''2_3g_Lukio_ja_amm_koulutuksen_opiskelijat_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3g_sopv_16]

) kaikkivuodet



























' 
GO
/****** Object:  View [dbo].[v_sa_2_3h_Lukio_ja_amm_koulutuksen_opiskelijat]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_2_3h_Lukio_ja_amm_koulutuksen_opiskelijat]'))
EXEC dbo.sp_executesql @statement = N'



CREATE VIEW [dbo].[v_sa_2_3h_Lukio_ja_amm_koulutuksen_opiskelijat] AS


-- truncate table vipunentk_dw..sa_2_3h_Lukio_ja_amm_koulutuksen_opiskelijat
-- insert into vipunentk_dw..sa_2_3h_Lukio_ja_amm_koulutuksen_opiskelijat select * from v_sa_2_3h_Lukio_ja_amm_koulutuksen_opiskelijat


SELECT
	tilv = CAST(kaikkivuodet.tilv as nvarchar(4))
	,tilv_date = Cast(kaikkivuodet.tilv+''0101'' as date)
	,lahde = cast(coalesce(nullif(kaikkivuodet.lahde , ''''), ''-1'') as nvarchar(2))
	,tunn = cast(coalesce(nullif(kaikkivuodet.tunn , ''''), ''-1'') as nvarchar(5))
	,jarj = cast(coalesce(nullif(kaikkivuodet.jarj, ''''), ''-1'') as nvarchar(10))
	,opjarj = cast(coalesce(nullif(kaikkivuodet.opjarj, ''''), ''-1'')  as nvarchar(10))
	,opmast = cast(coalesce(nullif(kaikkivuodet.opmast , ''''), ''-1'') as nvarchar(6))
	,opmala = cast(coalesce(nullif(kaikkivuodet.opmala , ''''), ''-1'') as nvarchar(6))
	,kkieli = cast(coalesce(nullif(kaikkivuodet.kkieli , ''''), ''-1'') as nvarchar(2))
	,kkun = cast(coalesce(nullif(kaikkivuodet.kkun , ''''), ''-1'') as nvarchar(3))
	,ophal = cast(coalesce(nullif(kaikkivuodet.ophal , ''''), ''-1'') as nvarchar(2))
	,tilvaskun = cast(coalesce(nullif(kaikkivuodet.tilvaskun , ''''), ''-1'') as nvarchar(3))
	,tilvaskunx = cast(coalesce(nullif(kaikkivuodet.tilvaskunx , ''''), ''-1'') as nvarchar(3))
	,alvv = cast(kaikkivuodet.alvv as nvarchar(4))	
	,kirikar1 = cast(coalesce(nullif(kaikkivuodet.kirikar1 , ''''), ''-1'') as nvarchar(2))
	,lkm = cast(kaikkivuodet.lkm as int)
	,tutklajl = cast(coalesce(nullif(kaikkivuodet.tutklajl , ''''), ''-1'') as nvarchar(2))
	,aikoul = cast(coalesce(nullif(kaikkivuodet.aikoul , ''''), ''-1'') as nvarchar(2))
	,tutklaja = cast(coalesce(nullif(kaikkivuodet.tutklaja , ''''), ''-1'') as nvarchar(2))
	,tutktav = cast(coalesce(nullif(kaikkivuodet.tutktav , ''''), ''-1'') as nvarchar(2))
	,tyov = cast(coalesce(nullif(kaikkivuodet.tyov , ''''), ''-1'') as nvarchar(2))
	,rahoitus = cast(coalesce(nullif(kaikkivuodet.rahoitus , ''''), ''-1'') as nvarchar(2))
	,tavoite =  cast(coalesce(nullif(kaikkivuodet.tavoite,''''),''1'')  as nvarchar(2))   -- HUOM! tässä aineistossa tulkitaan tyhjät tutkinnon tavoitteet tarkoituksella arvoon "1 - koko tutkinnon suorittaminen" kuutiomääritelmän mukaan -- Lasse
	,yrit = cast(coalesce(nullif(kaikkivuodet.yrit , ''''), ''-1'') as nvarchar(2))
	,olosyys = cast(kaikkivuodet.olosyys as nvarchar(1))
	,tietolahde = cast(kaikkivuodet.tietolahde as nvarchar(250))
	,rivinumero = cast(kaikkivuodet.rivinumero as nvarchar(10))
FROM (
SELECT
	   [tilv]
      ,[lahde]
      ,[tunn]
      ,[jarj]
      ,[opjarj]
      ,[opmast]
      ,[opmala]
      ,[kkieli]
      ,[kkun]
      ,[ophal]
      ,[tilvaskun]
      ,[tilvaskunx]
      ,[alvv]
      ,[kirikar1]
      ,[lkm]
      ,[tutklajl]
      ,[aikoul]
      ,[tutklaja]
      ,[tutktav]
      ,[tyov]
      ,[rahoitus]
      ,[tavoite]
      ,[yrit]
      ,[olosyys]
	  ,[tietolahde]=''2_3h_Lukio_ja_amm_koulutuksen_opiskelijat_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3h_2013_sopv_15]

union all

SELECT
	   [tilv]
      ,[lahde]
      ,[tunn]
      ,[jarj]
      ,[opjarj]
      ,[opmast]
      ,[opmala]
      ,[kkieli]
      ,[kkun]
      ,[ophal]
      ,[tilvaskun]
      ,[tilvaskunx]
      ,[alvv]
      ,[kirikar1]
      ,[lkm]
      ,[tutklajl]
      ,[aikoul]
      ,[tutklaja]
      ,[tutktav]
      ,[tyov]
      ,[rahoitus]
      ,[tavoite]
      ,[yrit]
      ,[olosyys]
	  ,[tietolahde]=''2_3h_Lukio_ja_amm_koulutuksen_opiskelijat_14''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3h_2014_sopv_15]

union all

SELECT
	   [tilv]
      ,[lahde]
      ,[tunn]
      ,[jarj]
      ,[opjarj]
      ,[opmast]
      ,[opmala]
      ,[kkieli]
      ,[kkun]
      ,[ophal]
      ,[tilvaskun]
      ,[tilvaskunx]
      ,[alvv]
      ,[kirikar1]
      ,[lkm]
      ,[tutklajl]
      ,[aikoul]
      ,[tutklaja]
      ,[tutktav]
      ,[tyov]
      ,[rahoitus]
      ,[tavoite]
      ,[yrit]
      ,[olosyys]
	  ,[tietolahde]=''2_3h_Lukio_ja_amm_koulutuksen_opiskelijat_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3h_sopv_16]

) kaikkivuodet









' 
GO
/****** Object:  View [dbo].[v_sa_2_4_Amm_koulutuksen_tutkinnot]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_2_4_Amm_koulutuksen_tutkinnot]'))
EXEC dbo.sp_executesql @statement = N'

















CREATE VIEW [dbo].[v_sa_2_4_Amm_koulutuksen_tutkinnot] AS

-- truncate table vipunentk_dw..sa_2_4_Amm_koulutuksen_tutkinnot
-- insert into vipunentk_dw..sa_2_4_Amm_koulutuksen_tutkinnot select * from v_sa_2_4_Amm_koulutuksen_tutkinnot

SELECT
	 tilv = CAST(kaikkivuodet.tilv as nvarchar(4))
	,tilv_date = Cast(kaikkivuodet.tilv+''0101'' as date)
	,lahde = CAST(kaikkivuodet.lahde as nvarchar(2))
	,tunn = cast(coalesce(nullif(kaikkivuodet.tunn , ''''), ''-1'') as nvarchar(5))
	
	/* vanha
	CASE WHEN lahde = 34 and tunn = '''' THEN cast(coalesce(nullif(kaikkivuodet.opjarj, ''''), ''-1'')  as nvarchar(10))
			ELSE cast(coalesce(nullif(kaikkivuodet.tunn , ''''), ''-1'') as nvarchar(5))
			END   -- Ohjataan oppisopimuskoulutuksen lähteellä opjarj-muuttujan avain tyhjien arvojen tilalle - Lasse 26.5.2014
			*/
--	,tunn = CAST(kaikkivuodet.tunn as nvarchar(5))
	,jarj = CAST(kaikkivuodet.jarj as nvarchar(10))
	,opjarj = CAST(kaikkivuodet.opjarj as nvarchar(10))
	,koulk = CAST(kaikkivuodet.koulk as nvarchar(6))
	,tunim = CAST(kaikkivuodet.tunim as nvarchar(5))
	,sutunim = CAST(kaikkivuodet.sutunim as nvarchar(30))
	,rutunim = CAST(kaikkivuodet.rutunim as nvarchar(30))
	,koohj = CAST(kaikkivuodet.koohj as nvarchar(4))
	,sukoohj = CAST(kaikkivuodet.sukoohj as nvarchar(60))
	,rukoohj = CAST(kaikkivuodet.rukoohj as nvarchar(60))
	,tutklaja = CAST(kaikkivuodet.tutklaja as nvarchar(1))
	,tutktav = CAST(kaikkivuodet.tutktav as nvarchar(1))
	,kkieli = CAST(kaikkivuodet.kkieli as nvarchar(2))
	,kkun = CAST(kaikkivuodet.kkun as nvarchar(3))
	,ophal = CAST(coalesce(nullif(kaikkivuodet.ophal,''''),''1'') as nvarchar(2))
	,sp = CAST(kaikkivuodet.sp as nvarchar(1))
	,aikielir1 = CAST(kaikkivuodet.aikielir1 as nvarchar(2))
	,alvv = CAST(kaikkivuodet.alvv as nvarchar(4))
	,allk = CAST(kaikkivuodet.allk as nvarchar(1))
	,aiopis = CAST(kaikkivuodet.aiopis as nvarchar(1))
	,aikoul = CAST(kaikkivuodet.aikoul as nvarchar(1)) -- uusi sarake 2012

	--,kirikar1 = CAST(kaikkivuodet.kirikar1 as nvarchar(2))
	,kirikar1 = cast(coalesce(nullif(nullif(kaikkivuodet.kirikar1 , '''') , ''XX''), ''-1'') as nvarchar(2))

	,suorpvm = CAST(kaikkivuodet.suorpvm as nvarchar(8))
	,lkm = CAST(kaikkivuodet.lkm as int)
	,tutalv = CAST(kaikkivuodet.tutalv as nvarchar(4))
	,tutalk = CAST(kaikkivuodet.tutalk as nvarchar(1))
	,hyvennen = CAST(kaikkivuodet.hyvennen as int)
	,hyvaik = CAST(kaikkivuodet.hyvaik as int)
	,suorkouaik = CAST(kaikkivuodet.suorkouaik as int) -- nimi muuttunut 2012
	,ovyht = CAST(kaikkivuodet.ovyht as int)
	,tyop = CAST(kaikkivuodet.tyop as int)
	,ammos = CAST(kaikkivuodet.ammos as int)
	,opintokok = CAST(kaikkivuodet.opintokok as int)
	,tyov = CAST(kaikkivuodet.tyov as nvarchar(1))
	,rahoitus = CAST(kaikkivuodet.rahoitus as nvarchar(1))
	,vayla = CAST(kaikkivuodet.vayla as nvarchar(1))
	,alaika = CAST(VipunenTK_SA.[dbo].RefineDateBegin(kaikkivuodet.alaika) as nvarchar(8))
	,loaika = CAST(VipunenTK_SA.[dbo].RefineDateEnd(kaikkivuodet.loaika) as nvarchar(8))
	,tavoite =  cast(coalesce(nullif(kaikkivuodet.tavoite,''''),''1'')  as nvarchar(2))   -- HUOM! tässä aineistossa tulkitaan tyhjät tutkinnon tavoitteet tarkoituksella arvoon "1 - koko tutkinnon suorittaminen" kuutiomääritelmän mukaan -- Lasse	

	--,toteuma_tutk  = CAST(kaikkivuodet.toteuma_tutk as nvarchar(1)) -- nimi muuttunut 2012
	
	,toteuma_tutk = 
	CASE 
		WHEN lahde = 32 THEN 1
		ELSE CAST(kaikkivuodet.toteuma_tutk as nvarchar(1))
	END        -- Opetussuunnitelmaperusteisen ammatillisen tutkinnon suorittaneet tulkitaan "suorittanut koko tutkinnon" -- 26.6.2014 Lasse

	,yrit = CAST(kaikkivuodet.yrit as nvarchar(1))
	,purku = CAST(kaikkivuodet.purku as nvarchar(1))
	,todis = CAST(kaikkivuodet.todis as nvarchar(1))
	,tol2008 = CAST(kaikkivuodet.tol2008 as nvarchar(5))
	,koko = CAST(kaikkivuodet.koko as nvarchar(1))
	,tyansek = CAST(kaikkivuodet.tyansek as nvarchar(1))
	,suorosat   = CAST(kaikkivuodet.suorosat as int)
	,tunn_opisk = cast(coalesce(nullif(kaikkivuodet.tunn_opisk , ''''), ''-1'') as nvarchar(5))
	,jarj_opisk = cast(coalesce(nullif(kaikkivuodet.jarj_opisk , ''''), ''-1'') as nvarchar(10))
	,kkun_opisk = cast(coalesce(nullif(kaikkivuodet.kkun_opisk , ''''), ''-1'') as nvarchar(3))
	,tietolahde = CAST(kaikkivuodet.tietolahde as nvarchar(250))
	,rivinumero = CAST(kaikkivuodet.rivinumero as nvarchar(10))


  FROM (
  
--Historia-aineisto
select
	tilv = left(suoraika,4)
	,lahde = 
		case 
			when lahde=1 then ''22''
			when lahde=2 and oppis=2 then ''35''
			when lahde=2 and oppis=1 then ''34''
			else ''-1''
		end
	,tunn = oltunnus
	,jarj = op.koulutuksen_jarjestajakoodi
	,opjarj
	,koulk
	,tunim = null
	,sutunim = null
	,rutunim = null
	,koohj = null
	,sukoohj = null
	,rukoohj = null
	,tutklaja
	,tutktav = case when kouljat=1 and lahde=2 then ''1'' when kouljat=8 and lahde=2 then ''2'' when kouljat not in (1,8) and lahde=2 then ''9'' else ''-1'' end
	,kkieli = case kkielir1 when ''fs'' then ''fi'' else kkielir1 end
	,kkun
	,ophal = -1
	,sp
	,aikielir1
	,alvv = case alvv when ''BBBB'' then ''9999'' else alvv end
	,allk
	,aiopis = 
		case 
			when syntv=''19XX'' or alvv=''BBBB'' then ''9''
			else
				case
					when cast(cast(left(suoraika,4) as int)-syntv as int)-(cast(left(suoraika,4) as int)-cast(alvv as int))<25 then ''1''
					else ''2''
				end
		end
	,aikoul = case when kouljat=1 and lahde=1 then ''1'' when kouljat=3 and lahde=1 then ''2'' else ''-1'' end
	,kirikar1 =
		case 
			when syntv=''19XX'' then ''-1''
			else 
				case
					when cast(left(suoraika,4) as int)-syntv between 15 and 19 then ''15''
					when cast(left(suoraika,4) as int)-syntv between 20 and 24 then ''20''
					when cast(left(suoraika,4) as int)-syntv between 25 and 29 then ''25''
					when cast(left(suoraika,4) as int)-syntv between 30 and 34 then ''30''
					when cast(left(suoraika,4) as int)-syntv between 35 and 39 then ''35''
					when cast(left(suoraika,4) as int)-syntv between 40 and 44 then ''40''
					when cast(left(suoraika,4) as int)-syntv between 45 and 49 then ''45''
					when cast(left(suoraika,4) as int)-syntv between 50 and 54 then ''50''
					when cast(left(suoraika,4) as int)-syntv between 55 and 59 then ''55''
					when cast(left(suoraika,4) as int)-syntv > 60 then ''60''
					else ''-1''
				end
		end
	,suorpvm = CONVERT (VARCHAR(8), suoraika, 112)
	,lkm
	,tutalv = null
	,tutalk = null
	,hyvennen = null
	,hyvaik = null
	,suorkouaik = null
	,ovyht = null
	,tyop = null
	,ammos = null
	,opintokok = null
	,tyov = null
	,rahoitus = null
	,vayla = null
	,alaika = null
	,loaika = null
	,tavoite = null
	,toteuma_tutk = 1 --aineistossa vain koko tutkinnon suorittaneet
	,yrit = null
	,purku = null
	,todis = null
	,tol2008 = null
	,koko = null
	,tyansek = null
	,NULL AS suorosat
	,''-1'' AS tunn_opisk
	,''-1'' AS jarj_opisk
	,''-1'' AS kkun_opisk
	,[tietolahde]=''8_1_Historia_aineisto_tutkinnot''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_8_1_sopv_16] tk
left join VipunenTK.dbo.d_oppilaitoksen_taustatiedot op on op.oppilaitos_avain=tk.oltunnus
WHERE lahde IN (1,2)

UNION ALL

select
	tilv
	,lahde
	,tunn
	,jarj
	,opjarj
	,koulk
	,tunim
	,sutunim
	,rutunim
	,koohj
	,sukoohj
	,rukoohj
	,tutklaja
	,tutktav
	,kkieli
	,kkun
	,ophal
	,sp
	,aikielir1
	,alvv
	,allk
	,aiopis
	,null as aikoul -- uusi sarake 2012
	,kirikar1
	,suorpvm = CONVERT (VARCHAR(8), suorpvm, 112)
	,lkm
	,tutalv
	,tutalk
	,hyvennen
	,hyvaik
	,suorkouaik -- nimi muuttunut 2012
	,ovyht
	,tyop
	,ammos
	,opintokok
	,tyov
	,rahoitus
	,vayla
	,alaika
	,loaika
	,tavoite
	,toteuma_tutk -- nimi muuttunut 2012
	,yrit
	,purku
	,todis
	,tol2008
	,koko
	,tyansek
	,NULL AS suorosat
	,''-1'' AS tunn_opisk
	,''-1'' AS jarj_opisk
	,''-1'' AS kkun_opisk
	,[tietolahde]=''2_4a_sopv_11''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4a_sopv_11]
union all
select
	tilv
	,lahde
	,tunn
	,jarj
	,opjarj
	,koulk
	,tunim
	,sutunim
	,rutunim
	,koohj
	,sukoohj
	,rukoohj
	,tutklaja
	,tutktav
	,kkieli
	,kkun
	,ophal
	,sp
	,aikielir1
	,alvv
	,allk
	,aiopis
	,null as aikoul -- uusi sarake 2012
	,kirikar1
	,suorpvm = CONVERT (VARCHAR(8), suorpvm, 112)
	,lkm
	,tutalv
	,tutalk
	,hyvennen
	,hyvaik
	,suorkouaik -- nimi muuttunut 2012
	,ovyht
	,tyop
	,ammos
	,opintokok
	,tyov
	,rahoitus
	,vayla
	,alaika
	,loaika
	,tavoite
	,toteuma_tutk -- nimi muuttunut 2012
	,yrit
	,purku
	,todis
	,tol2008
	,koko
	,tyansek
	,NULL AS suorosat
	,''-1'' AS tunn_opisk
	,''-1'' AS jarj_opisk
	,''-1'' AS kkun_opisk
	,[tietolahde]=''2_4b_sopv_11''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4b_sopv_11]
union all
select
	tilv
	,lahde
	,tunn
	,jarj
	,opjarj
	,koulk
	,tunim
	,sutunim
	,rutunim
	,koohj
	,sukoohj
	,rukoohj
	,tutklaja
	,tutktav
	,kkieli
	,kkun
	,ophal
	,sp
	,aikielir1
	,alvv
	,allk
	,aiopis
	,null as aikoul -- uusi sarake 2012
	,kirikar1
	,suorpvm = CONVERT (VARCHAR(8), suorpvm, 112)
	,lkm
	,tutalv
	,tutalk
	,hyvennen
	,hyvaik
	,suorkouaik -- nimi muuttunut 2012
	,ovyht
	,tyop
	,ammos
	,opintokok
	,tyov
	,rahoitus
	,vayla
	,alaika
	,loaika
	,tavoite
	,toteuma_tutk -- nimi muuttunut 2012
	,yrit
	,purku
	,todis
	,tol2008
	,koko
	,tyansek
	,NULL AS suorosat
	,''-1'' AS tunn_opisk
	,''-1'' AS jarj_opisk
	,''-1'' AS kkun_opisk
	,[tietolahde]=''2_4c_sopv_11''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4c_sopv_11]
union all
select
	tilv
	,lahde
	,tunn
	,jarj
	,opjarj
	,koulk
	,tunim
	,sutunim
	,rutunim
	,koohj
	,sukoohj
	,rukoohj
	,tutklaja
	,tutktav
	,kkieli
	,kkun
	,ophal
	,sp
	,aikielir1
	,alvv
	,allk
	,aiopis
	, aikoul -- uusi sarake 2012
	,kirikar1
	,suorpvm = CONVERT (VARCHAR(8), suorpvm, 112)
	,lkm
	,tutalv
	,tutalk
	,hyvennen
	,hyvaik
	,suorkouaik -- nimi muuttunut 2012
	,ovyht
	,tyop
	,ammos
	,opintokok
	,tyov
	,rahoitus
	,vayla
	,alaika
	,loaika
	,tavoite
	,toteuma_tutk -- nimi muuttunut 2012
	,yrit
	,purku
	,todis
	,tol2008
	,koko
	,tyansek
	,NULL AS suorosat
	,''-1'' AS tunn_opisk
	,''-1'' AS jarj_opisk
	,''-1'' AS kkun_opisk
	,[tietolahde]=''2_4a_sopv_12''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4a_sopv_12]
union all
select
	tilv
	,lahde
	,tunn
	,jarj
	,opjarj
	,koulk
	,tunim
	,sutunim
	,rutunim
	,koohj
	,sukoohj
	,rukoohj
	,tutklaja
	,tutktav
	,kkieli
	,kkun
	,ophal
	,sp
	,aikielir1
	,alvv
	,allk
	,aiopis
	, aikoul -- uusi sarake 2012
	,kirikar1
	,suorpvm = CONVERT (VARCHAR(8), suorpvm, 112)
	,lkm
	,tutalv
	,tutalk
	,hyvennen
	,hyvaik
	,suorkouaik -- nimi muuttunut 2012
	,ovyht
	,tyop
	,ammos
	,opintokok
	,tyov
	,rahoitus
	,vayla
	,alaika
	,loaika
	,tavoite
	,toteuma_tutk -- nimi muuttunut 2012
	,yrit
	,purku
	,todis
	,tol2008
	,koko
	,tyansek
	,NULL AS suorosat
	,''-1'' AS tunn_opisk
	,''-1'' AS jarj_opisk
	,''-1'' AS kkun_opisk
	,[tietolahde]=''2_4b_sopv_12''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4b_sopv_12]
union all
select
	tilv
	,lahde
	,tunn
	,jarj
	,opjarj
	,koulk
	,tunim
	,sutunim
	,rutunim
	,koohj
	,sukoohj
	,rukoohj
	,tutklaja
	,tutktav
	,kkieli
	,kkun
	,ophal
	,sp
	,aikielir1
	,alvv
	,allk
	,aiopis
	, aikoul -- uusi sarake 2012
	,kirikar1
	,suorpvm = CONVERT (VARCHAR(8), suorpvm, 112)
	,lkm
	,tutalv
	,tutalk
	,hyvennen
	,hyvaik
	,suorkouaik -- nimi muuttunut 2012
	,ovyht
	,tyop
	,ammos
	,opintokok
	,tyov
	,rahoitus
	,vayla
	,alaika
	,loaika
	,tavoite
	,toteuma_tutk -- nimi muuttunut 2012
	,yrit
	,purku
	,todis
	,tol2008
	,koko
	,tyansek
	,NULL AS suorosat
	,''-1'' AS tunn_opisk
	,''-1'' AS jarj_opisk
	,''-1'' AS kkun_opisk
	,[tietolahde]=''2_4c_sopv_12''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4c_sopv_12]
union all
select
	tilv
	,lahde
	,tunn
	,jarj
	,opjarj
	,koulk
	,tunim
	,sutunim
	,rutunim
	,koohj
	,sukoohj
	,rukoohj
	,tutklaja
	,tutktav
	,kkieli
	,kkun
	,ophal
	,sp
	,aikielir1
	,alvv
	,allk
	,aiopis
	, aikoul -- uusi sarake 2012
	,kirikar1
	,suorpvm = CONVERT (VARCHAR(8), suorpvm, 112)
	,lkm
	,tutalv
	,tutalk
	,hyvennen
	,hyvaik
	, suorkouaik -- nimi muuttunut 2012
	,ovyht
	,tyop
	,ammos
	,opintokok
	,tyov
	,rahoitus
	,vayla
	,alaika
	,loaika
	,tavoite
	, toteuma_tutk -- nimi muuttunut 2012
	,yrit
	,purku
	,todis
	,tol2008
	,koko
	,tyansek
	,NULL AS suorosat
	,''-1'' AS tunn_opisk
	,''-1'' AS jarj_opisk
	,''-1'' AS kkun_opisk
	,[tietolahde]=''2_4d_sopv_12''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4d_sopv_12]
union all
select
	tilv
	,lahde
	,tunn
	,jarj
	,opjarj
	,koulk
	,tunim
	,sutunim
	,rutunim
	,koohj
	,sukoohj
	,rukoohj
	,tutklaja
	,tutktav
	,kkieli
	,kkun
	,ophal
	,sp
	,aikielir1
	,alvv
	,allk
	,aiopis
	, aikoul = NULL -- uusi sarake 2012
	,kirikar1
	,suorpvm = CONVERT (VARCHAR(8), suorpvm, 112)
	,lkm
	,tutalv
	,tutalk
	,hyvennen
	,hyvaik
	,suorkouaik -- nimi muuttunut 2012
	,ovyht
	,tyop
	,ammos
	,opintokok
	,tyov
	,rahoitus
	,vayla
	,alaika
	,loaika
	,tavoite
	,toteuma_tutk -- nimi muuttunut 2012
	,yrit
	,purku
	,todis
	,tol2008
	,koko
	,tyansek
	,NULL AS suorosat
	,''-1'' AS tunn_opisk
	,''-1'' AS jarj_opisk
	,''-1'' AS kkun_opisk
	,[tietolahde]=''2_4a_sopv_13''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4a_sopv_13]
union all
select
	tilv
	,lahde
	,tunn
	,jarj
	,opjarj
	,koulk
	,tunim
	,sutunim
	,rutunim
	,koohj
	,sukoohj
	,rukoohj
	,tutklaja
	,tutktav
	,kkieli
	,kkun
	,ophal
	,sp
	,aikielir1
	,alvv
	,allk
	,aiopis
	, aikoul -- uusi sarake 2012
	,kirikar1
	,suorpvm = CONVERT (VARCHAR(8), suorpvm, 112)
	,lkm
	,tutalv
	,tutalk
	,hyvennen
	,hyvaik
	,suorkouaik -- nimi muuttunut 2012
	,ovyht
	,tyop
	,ammos
	,opintokok
	,tyov
	,rahoitus
	,vayla
    ,[alaika]-- = CONVERT (VARCHAR(8), cast([alaika]+''01'' as date), 112)
    ,[loaika]-- = CONVERT (VARCHAR(8), cast([loaika]+''01'' as date), 112)
	,tavoite
	,toteuma_tutk -- nimi muuttunut 2012
	,yrit
	,purku
	,todis
	,tol2008
	,koko
	,tyansek
	,NULL AS suorosat
	,''-1'' AS tunn_opisk
	,''-1'' AS jarj_opisk
	,''-1'' AS kkun_opisk
	,[tietolahde]=''2_4b_sopv_13''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4b_sopv_13]
union all
select
	tilv
	,lahde
	,tunn
	,jarj
	,opjarj
	,koulk
	,tunim
	,sutunim
	,rutunim
	,koohj
	,sukoohj
	,rukoohj
	,tutklaja
	,tutktav
	,kkieli
	,kkun
	,ophal
	,sp
	,aikielir1
	,alvv
	,allk
	,aiopis
	, aikoul -- uusi sarake 2012
	,kirikar1
	,suorpvm = CONVERT (VARCHAR(8), suorpvm, 112)
	,lkm
	,tutalv
	,tutalk
	,hyvennen
	,hyvaik
	,suorkouaik -- nimi muuttunut 2012
	,ovyht
	,tyop
	,ammos
	,opintokok
	,tyov
	,rahoitus
	,vayla
	,alaika
	,loaika
	,tavoite
	,toteuma_tutk -- nimi muuttunut 2012
	,yrit
	,purku
	,todis
	,tol2008
	,koko
	,tyansek
	,NULL AS suorosat
	,''-1'' AS tunn_opisk
	,''-1'' AS jarj_opisk
	,''-1'' AS kkun_opisk
	,[tietolahde]=''2_4c_sopv_13''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4c_sopv_13]
union all
select
	tilv
	,lahde
	,tunn
	,jarj
	,opjarj
	,koulk
	,tunim
	,sutunim
	,rutunim
	,koohj
	,sukoohj
	,rukoohj
	,tutklaja
	,tutktav
	,kkieli
	,kkun
	,ophal
	,sp
	,aikielir1
	,alvv
	,allk
	,aiopis
	, aikoul -- uusi sarake 2012
	,kirikar1
	,suorpvm = CONVERT (VARCHAR(8), suorpvm, 112)
	,lkm
	,tutalv
	,tutalk
	,hyvennen
	,hyvaik
	, suorkouaik -- nimi muuttunut 2012
	,ovyht
	,tyop
	,ammos
	,opintokok
	,tyov
	,rahoitus
	,vayla
	,alaika-- = CONVERT(VARCHAR(8), alaika, 112)
	,loaika-- = CONVERT(VARCHAR(8), loaika, 112)
	,tavoite
	, toteuma_tutk -- nimi muuttunut 2012
	,yrit
	,purku
	,todis
	,tol2008
	,koko
	,tyansek
	,NULL AS suorosat
	,''-1'' AS tunn_opisk
	,''-1'' AS jarj_opisk
	,''-1'' AS kkun_opisk
	,[tietolahde]=''2_4d_sopv_13''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4d_sopv_13]

/* 14a, 14b ja 14c aineistot vielä rikki -- Lasse 27.11.2014
Otettu mukaan 20.1.2015 / Jarmo */

union all
select
	tilv
	,lahde
	,tunn
	,jarj
	,opjarj
	,koulk
	,tunim
	,sutunim
	,rutunim
	,koohj
	,sukoohj
	,rukoohj
	,tutklaja
	,tutktav
	,kkieli
	,kkun
	,ophal
	,sp
	,aikielir1
	,alvv
	,allk
	,aiopis
	, aikoul = NULL -- uusi sarake 2012
	,kirikar1
	,suorpvm
	,lkm
	,tutalv
	,tutalk
	,hyvennen
	,hyvaik
	,suorkouaik -- nimi muuttunut 2012
	,ovyht
	,tyop
	,ammos
	,opintokok
	,tyov
	,rahoitus
	,vayla
	,alaika
	,loaika
	,tavoite
	,toteuma_tutk -- nimi muuttunut 2012
	,yrit
	,purku
	,todis
	,tol2008
	,koko
	,tyansek
	,suorosat
	,tunn_opisk
	,jarj_opisk
	,kkun_opisk
	,[tietolahde]=''2_4a_sopv_14''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4a_sopv_14]

union all
select
	tilv
	,lahde
	,tunn
	,jarj
	,opjarj
	,koulk
	,tunim
	,sutunim
	,rutunim
	,koohj
	,sukoohj
	,rukoohj
	,tutklaja
	,tutktav
	,kkieli
	,kkun
	,ophal
	,sp
	,aikielir1
	,alvv
	,allk
	,aiopis
	, aikoul -- uusi sarake 2012
	,kirikar1
	,suorpvm
	,lkm
	,tutalv
	,tutalk
	,hyvennen
	,hyvaik
	,suorkouaik -- nimi muuttunut 2012
	,ovyht
	,tyop
	,ammos
	,opintokok
	,tyov
	,rahoitus
	,vayla
    ,[alaika]-- = CONVERT (VARCHAR(10), [alaika], 112)
    ,[loaika]-- = CONVERT (VARCHAR(10), [loaika], 112)
	,tavoite
	,toteuma_tutk -- nimi muuttunut 2012
	,yrit
	,purku
	,todis
	,tol2008
	,koko
	,tyansek
	,suorosat
	,tunn_opisk
	,jarj_opisk
	,kkun_opisk
	,[tietolahde]=''2_4b_sopv_14''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4b_sopv_14]
union all
select
	tilv
	,lahde
	,tunn
	,jarj
	,opjarj
	,koulk
	,tunim
	,sutunim
	,rutunim
	,koohj
	,sukoohj
	,rukoohj
	,tutklaja
	,tutktav
	,kkieli
	,kkun
	,ophal
	,sp
	,aikielir1
	,alvv
	,allk
	,aiopis
	, aikoul -- uusi sarake 2012
	,kirikar1
	,suorpvm
	,lkm
	,tutalv
	,tutalk
	,hyvennen
	,hyvaik
	,suorkouaik -- nimi muuttunut 2012
	,ovyht
	,tyop
	,ammos
	,opintokok
	,tyov
	,rahoitus
	,vayla
	,alaika
	,loaika
	,tavoite
	,toteuma_tutk -- nimi muuttunut 2012
	,yrit
	,purku
	,todis
	,tol2008
	,koko
	,tyansek
	,suorosat
	,tunn_opisk
	,jarj_opisk
	,kkun_opisk
	,[tietolahde]=''2_4c_sopv_14''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4c_sopv_14]
/* Otettu mukaan 20.1.2015 / Jarmo 
*/

union all
select
	tilv
	,lahde
	,tunn
	,jarj
	,opjarj
	,koulk
	,tunim
	,sutunim
	,rutunim
	,koohj
	,sukoohj
	,rukoohj
	,tutklaja
	,tutktav
	,kkieli
	,kkun
	,ophal
	,sp
	,aikielir1
	,alvv
	,allk
	,aiopis
	, aikoul = NULL -- uusi sarake 2012
	,kirikar1
	,suorpvm
	,lkm
	,tutalv
	,tutalk
	,hyvennen
	,hyvaik
	,suorkouaik -- nimi muuttunut 2012
	,ovyht
	,tyop
	,ammos
	,opintokok
	,tyov
	,rahoitus
	,vayla
	,alaika
	,loaika
	,tavoite
	,toteuma_tutk -- nimi muuttunut 2012
	,yrit
	,purku
	,todis
	,tol2008
	,koko
	,tyansek
	,suorosat
	,tunn_opisk
	,jarj_opisk
	,kkun_opisk
	,[tietolahde]=''2_4a_sopv_15''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4a_sopv_15]

union all
select
	tilv
	,lahde
	,tunn
	,jarj
	,opjarj
	,koulk
	,tunim
	,sutunim
	,rutunim
	,koohj
	,sukoohj
	,rukoohj
	,tutklaja
	,tutktav
	,kkieli
	,kkun
	,ophal
	,sp
	,aikielir1
	,alvv
	,allk
	,aiopis
	, aikoul -- uusi sarake 2012
	,kirikar1
	,suorpvm
	,lkm
	,tutalv
	,tutalk
	,hyvennen
	,hyvaik
	,suorkouaik -- nimi muuttunut 2012
	,ovyht
	,tyop
	,ammos
	,opintokok
	,tyov
	,rahoitus
	,vayla
    ,[alaika]-- = CONVERT (VARCHAR(10), [alaika], 112)
    ,[loaika]-- = CONVERT (VARCHAR(10), [loaika], 112)
	,tavoite
	,toteuma_tutk -- nimi muuttunut 2012
	,yrit
	,purku
	,todis
	,tol2008
	,koko
	,tyansek
	,suorosat
	,tunn_opisk
	,jarj_opisk
	,kkun_opisk
	,[tietolahde]=''2_4b_sopv_15''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4b_sopv_15]
union all
select
	tilv
	,lahde
	,tunn
	,jarj
	,opjarj
	,koulk
	,tunim
	,sutunim
	,rutunim
	,koohj
	,sukoohj
	,rukoohj
	,tutklaja
	,tutktav
	,kkieli
	,kkun
	,ophal
	,sp
	,aikielir1
	,alvv
	,allk
	,aiopis
	, aikoul -- uusi sarake 2012
	,kirikar1
	,suorpvm
	,lkm
	,tutalv
	,tutalk
	,hyvennen
	,hyvaik
	,suorkouaik -- nimi muuttunut 2012
	,ovyht
	,tyop
	,ammos
	,opintokok
	,tyov
	,rahoitus
	,vayla
	,alaika
	,loaika
	,tavoite
	,toteuma_tutk -- nimi muuttunut 2012
	,yrit
	,purku
	,todis
	,tol2008
	,koko
	,tyansek
	,suorosat
	,tunn_opisk
	,jarj_opisk
	,kkun_opisk
	,[tietolahde]=''2_4c_sopv_15''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4c_sopv_15]

union all
select
	tilv
	,lahde
	,tunn
	,jarj
	,opjarj
	,koulk
	,tunim
	,sutunim
	,rutunim
	,koohj
	,sukoohj
	,rukoohj
	,tutklaja
	,tutktav
	,kkieli
	,kkun
	,ophal
	,sp
	,aikielir1
	,alvv
	,allk
	,aiopis
	, aikoul = NULL -- uusi sarake 2012
	,kirikar1
	,suorpvm
	,lkm
	,tutalv
	,tutalk
	,hyvennen
	,hyvaik
	,suorkouaik -- nimi muuttunut 2012
	,ovyht
	,tyop
	,ammos
	,opintokok
	,tyov
	,rahoitus
	,vayla
	,alaika
	,loaika
	,tavoite
	,toteuma_tutk -- nimi muuttunut 2012
	,yrit
	,purku
	,todis
	,tol2008
	,koko
	,tyansek
	,suorosat
	,tunn_opisk
	,jarj_opisk
	,kkun_opisk
	,[tietolahde]=''2_4a_sopv_16''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4a_sopv_16]

union all
select
	tilv
	,lahde
	,tunn
	,jarj
	,opjarj
	,koulk
	,tunim
	,sutunim
	,rutunim
	,koohj
	,sukoohj
	,rukoohj
	,tutklaja
	,tutktav
	,kkieli
	,kkun
	,ophal
	,sp
	,aikielir1
	,alvv
	,allk
	,aiopis
	, aikoul -- uusi sarake 2012
	,kirikar1
	,suorpvm
	,lkm
	,tutalv
	,tutalk
	,hyvennen
	,hyvaik
	,suorkouaik -- nimi muuttunut 2012
	,ovyht
	,tyop
	,ammos
	,opintokok
	,tyov
	,rahoitus
	,vayla
    ,[alaika]-- = CONVERT (VARCHAR(10), [alaika], 112)
    ,[loaika]-- = CONVERT (VARCHAR(10), [loaika], 112)
	,tavoite
	,toteuma_tutk -- nimi muuttunut 2012
	,yrit
	,purku
	,todis
	,tol2008
	,koko
	,tyansek
	,suorosat
	,tunn_opisk
	,jarj_opisk
	,kkun_opisk
	,[tietolahde]=''2_4b_sopv_16''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4b_sopv_16]
union all
select
	tilv
	,lahde
	,tunn
	,jarj
	,opjarj
	,koulk
	,tunim
	,sutunim
	,rutunim
	,koohj
	,sukoohj
	,rukoohj
	,tutklaja
	,tutktav
	,kkieli
	,kkun
	,ophal
	,sp
	,aikielir1
	,alvv
	,allk
	,aiopis
	, aikoul -- uusi sarake 2012
	,kirikar1
	,suorpvm
	,lkm
	,tutalv
	,tutalk
	,hyvennen
	,hyvaik
	,suorkouaik -- nimi muuttunut 2012
	,ovyht
	,tyop
	,ammos
	,opintokok
	,tyov
	,rahoitus
	,vayla
	,alaika
	,loaika
	,tavoite
	,toteuma_tutk -- nimi muuttunut 2012
	,yrit
	,purku
	,todis
	,tol2008
	,koko
	,tyansek
	,suorosat
	,tunn_opisk
	,jarj_opisk
	,kkun_opisk
	,[tietolahde]=''2_4c_sopv_16''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4c_sopv_16]

) kaikkivuodet


















' 
GO
/****** Object:  View [dbo].[v_sa_2_4efg_Lukio_ja_amm_koulutuksen_tutkinnot]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_2_4efg_Lukio_ja_amm_koulutuksen_tutkinnot]'))
EXEC dbo.sp_executesql @statement = N'








CREATE VIEW [dbo].[v_sa_2_4efg_Lukio_ja_amm_koulutuksen_tutkinnot] AS


-- truncate table vipunentk_dw.dbo.sa_2_4efg_Lukio_ja_amm_koulutuksen_tutkinnot
-- insert into vipunentk_dw.dbo.sa_2_4efg_Lukio_ja_amm_koulutuksen_tutkinnot select * from vipunentk_sa.[dbo].[v_sa_2_4efg_Lukio_ja_amm_koulutuksen_tutkinnot]
-- select * into vipunentk_dw.dbo.sa_2_4efg_Lukio_ja_amm_koulutuksen_tutkinnot from vipunentk_sa.[dbo].[v_sa_2_4efg_Lukio_ja_amm_koulutuksen_tutkinnot]



SELECT
	tilv = CAST(kaikkivuodet.tilv as nvarchar(4))
	,tilv_date = Cast(kaikkivuodet.tilv+''0101'' as date)
	,lahde = cast(coalesce(nullif(kaikkivuodet.lahde , ''''), ''-1'') as nvarchar(2))
	,jarj = cast(coalesce(nullif(kaikkivuodet.jarj, ''''), ''-1'') as nvarchar(10))
	,opjarj = cast(coalesce(nullif(kaikkivuodet.opjarj, ''''), ''-1'')  as nvarchar(10))
	,kkieli = cast(coalesce(nullif(kaikkivuodet.kkieli , ''''), ''-1'') as nvarchar(2))
	,koulk = cast(coalesce(nullif(kaikkivuodet.koulk , ''''), ''-1'') as nvarchar(6))
	,kkun = cast(coalesce(nullif(kaikkivuodet.kkun , ''''), ''-1'') as nvarchar(3))
	,ophal = cast(coalesce(nullif(kaikkivuodet.ophal , ''''), ''-1'') as nvarchar(2))
	,sp = cast(coalesce(nullif(kaikkivuodet.sp , ''''), ''-1'') as nvarchar(2))
	,aikielir1 = cast(coalesce(nullif(kaikkivuodet.aikielir1 , ''''), ''-1'') as nvarchar(2))
	,aiopis = cast(coalesce(nullif(kaikkivuodet.aiopis , ''''), ''-1'') as nvarchar(2))
	,ika2 = cast(coalesce(nullif(kaikkivuodet.ika2, ''''), ''-1'') as nvarchar(15))
	,lkm = cast(kaikkivuodet.lkm as int)
	,aikoul = cast(coalesce(nullif(kaikkivuodet.aikoul , ''''), ''-1'') as nvarchar(2))
	,tutalv = cast(coalesce(nullif(kaikkivuodet.tutalv , ''''), ''-1'') as nvarchar(4))
	,tutklaja = cast(coalesce(nullif(kaikkivuodet.tutklaja , ''''), ''-1'') as nvarchar(2))
	,tunim = cast(coalesce(nullif(kaikkivuodet.tunim , ''''), ''-1'') as nvarchar(255))
	,sutunim = cast(coalesce(nullif(kaikkivuodet.sutunim , ''''), ''-1'') as nvarchar(255))
	,rutunim = cast(coalesce(nullif(kaikkivuodet.rutunim , ''''), ''-1'') as nvarchar(255))
	,koohj = cast(coalesce(nullif(kaikkivuodet.koohj , ''''), ''-1'') as nvarchar(100))
	,sukoohj = cast(coalesce(nullif(kaikkivuodet.sukoohj , ''''), ''-1'') as nvarchar(100))
	,rukoohj = cast(coalesce(nullif(kaikkivuodet.rukoohj , ''''), ''-1'') as nvarchar(100))
	,tutktav = cast(coalesce(nullif(kaikkivuodet.tutktav , ''''), ''-1'') as nvarchar(2))
	,rahoitus = cast(coalesce(nullif(kaikkivuodet.rahoitus , ''''), ''-1'') as nvarchar(2))
	,tavoite =  cast(coalesce(nullif(kaikkivuodet.tavoite,''''),''-1'')  as nvarchar(2))   -- HUOM! tässä aineistossa tulkitaan tyhjät tutkinnon tavoitteet tarkoituksella arvoon "1 - koko tutkinnon suorittaminen" kuutiomääritelmän mukaan -- Lasse
	,tutalk =  cast(coalesce(nullif(kaikkivuodet.tutalk,''''),''-1'')  as nvarchar(2))
	,hyvennen =  cast(kaikkivuodet.hyvennen AS int)
	,hyvaik =  cast(kaikkivuodet.hyvaik AS int)
	,suorkouaik =  cast(kaikkivuodet.suorkouaik AS int)
	,ovyht =  cast(kaikkivuodet.ovyht AS int)
	,tyop =  cast(kaikkivuodet.tyop AS int)
	,ammos =  cast(kaikkivuodet.ammos AS int)
	,opintokok =  cast(kaikkivuodet.opintokok AS int)
	,vayla =  cast(coalesce(nullif(kaikkivuodet.vayla,''''),''-1'')  as nvarchar(2))
	,toteuma_tutk =  cast(coalesce(nullif(kaikkivuodet.toteuma_tutk,''''),''-1'')  as nvarchar(2))
	,suorosat =  cast(kaikkivuodet.suorosat AS int)
	,jarj_opisk =  cast(coalesce(nullif(kaikkivuodet.jarj_opisk,''''),''-1'')  as nvarchar(10))
	,kkun_opisk =  cast(coalesce(nullif(kaikkivuodet.kkun_opisk,''''),''-1'')  as nvarchar(3))
	,tietolahde = cast(kaikkivuodet.tietolahde as nvarchar(250))
	,rivinumero = cast(kaikkivuodet.rivinumero as nvarchar(10))
FROM (
/*
--Historia-aineisto
SELECT
	  [tilv]
      ,[lahde]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[kkieli]
      ,[kkun]
      ,[ophal]
      ,[sp]
      ,[aikielir1]
      ,[aiopis]
      ,[ika2]
      ,[lkm]
      ,[aikoul]
      ,[tutalv]
      ,[tutklaja]
      ,[tunim]
      ,[sutunim]
      ,[rutunim]
      ,[koohj]
      ,[sukoohj]
      ,[rukoohj]
      ,[tutktav]
      ,[rahoitus]
      ,[tavoite]
	  ,[tutalk]
	  ,[hyvennen]
	  ,[hyvaik]
	  ,[suorkouaik]
	  ,[ovyht]
	  ,[tyop]
	  ,[ammos]
	  ,[opintokok]
	  ,[vayla]
	  ,[toteuma_tutk]
	  ,[suorosat]
	  ,[jarj_opisk]
	  ,[kkun_opisk]
	  ,[tietolahde]=''8_1_Historia_tutkinnot''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].TK_8_1_sopv_16

UNION ALL
*/
SELECT
	  [tilv]
      ,[lahde]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[kkieli]
      ,[kkun]
      ,[ophal]
      ,[sp]
      ,[aikielir1]
      ,[aiopis]
      ,[ika2]
      ,[lkm]
      ,[aikoul]
      ,[tutalv]
      ,[tutklaja]
      ,[tunim]
      ,[sutunim]
      ,[rutunim]
      ,[koohj]
      ,[sukoohj]
      ,[rukoohj]
      ,[tutktav]
      ,[rahoitus]
      ,[tavoite]
	  ,[tutalk]
	  ,[hyvennen]
	  ,[hyvaik]
	  ,[suorkouaik]
	  ,[ovyht]
	  ,[tyop]
	  ,[ammos]
	  ,[opintokok]
	  ,[vayla]
	  ,[toteuma_tutk]
	  ,[suorosat]
	  ,[jarj_opisk]
	  ,[kkun_opisk]
	  ,[tietolahde]=''2_4e_Lukio_ja_amm_koulutuksen_opiskelijat_14''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4e_sopv_14]

union all

SELECT
	   [tilv]
      ,[lahde]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[kkieli]
      ,[kkun]
      ,[ophal]
      ,[sp]
      ,[aikielir1]
      ,[aiopis]
      ,[ika2]
      ,[lkm]
      ,[aikoul]
      ,[tutalv]
      ,[tutklaja]
      ,[tunim]
      ,[sutunim]
      ,[rutunim]
      ,[koohj]
      ,[sukoohj]
      ,[rukoohj]
      ,[tutktav]
      ,[rahoitus]
      ,[tavoite]
	  ,[tutalk]
	  ,[hyvennen]
	  ,[hyvaik]
	  ,[suorkouaik]
	  ,[ovyht]
	  ,[tyop]
	  ,[ammos]
	  ,[opintokok]
	  ,[vayla]
	  ,[toteuma_tutk]
	  ,[suorosat]
	  ,[jarj_opisk]
	  ,[kkun_opisk]
	  ,[tietolahde]=''2_4f_Lukio_ja_amm_koulutuksen_opiskelijat_14''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4f_sopv_14]

union all

SELECT
	   [tilv]
      ,[lahde]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[kkieli]
      ,[kkun]
      ,[ophal]
      ,[sp]
      ,[aikielir1]
      ,[aiopis]
      ,[ika2]
      ,[lkm]
      ,[aikoul]
      ,[tutalv]
      ,[tutklaja]
      ,[tunim]
      ,[sutunim]
      ,[rutunim]
      ,[koohj]
      ,[sukoohj]
      ,[rukoohj]
      ,[tutktav]
      ,[rahoitus]
      ,[tavoite]
	  ,[tutalk]
	  ,[hyvennen]
	  ,[hyvaik]
	  ,[suorkouaik]
	  ,[ovyht]
	  ,[tyop]
	  ,[ammos]
	  ,[opintokok]
	  ,[vayla]
	  ,[toteuma_tutk]
	  ,[suorosat]
	  ,[jarj_opisk]
	  ,[kkun_opisk]
	  ,[tietolahde]=''2_4g_Lukio_ja_amm_koulutuksen_opiskelijat_14''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4g_sopv_14]

union all

SELECT
	   [tilv]
      ,[lahde]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[kkieli]
      ,[kkun]
      ,[ophal]
      ,[sp]
      ,[aikielir1]
      ,[aiopis]
      ,[ika2]
      ,[lkm]
      ,[aikoul]
      ,[tutalv]
      ,[tutklaja]
      ,[tunim]
      ,[sutunim]
      ,[rutunim]
      ,[koohj]
      ,[sukoohj]
      ,[rukoohj]
      ,[tutktav]
      ,[rahoitus]
      ,[tavoite]
	  ,[tutalk]
	  ,[hyvennen]
	  ,[hyvaik]
	  ,[suorkouaik]
	  ,[ovyht]
	  ,[tyop]
	  ,[ammos]
	  ,[opintokok]
	  ,[vayla]
	  ,[toteuma_tutk]
	  ,[suorosat]
	  ,[jarj_opisk]
	  ,[kkun_opisk]
	  ,[tietolahde]=''2_4e_Lukio_ja_amm_koulutuksen_opiskelijat_15''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4e_sopv_15]

union all

SELECT
	   [tilv]
      ,[lahde]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[kkieli]
      ,[kkun]
      ,[ophal]
      ,[sp]
      ,[aikielir1]
      ,[aiopis]
      ,[ika2]
      ,[lkm]
      ,[aikoul]
      ,[tutalv]
      ,[tutklaja]
      ,[tunim]
      ,[sutunim]
      ,[rutunim]
      ,[koohj]
      ,[sukoohj]
      ,[rukoohj]
      ,[tutktav]
      ,[rahoitus]
      ,[tavoite]
	  ,[tutalk]
	  ,[hyvennen]
	  ,[hyvaik]
	  ,[suorkouaik]
	  ,[ovyht]
	  ,[tyop]
	  ,[ammos]
	  ,[opintokok]
	  ,[vayla]
	  ,[toteuma_tutk]
	  ,[suorosat]
	  ,[jarj_opisk]
	  ,[kkun_opisk]
	  ,[tietolahde]=''2_4f_Lukio_ja_amm_koulutuksen_opiskelijat_15''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4f_sopv_15]

union all

SELECT
	   [tilv]
      ,[lahde]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[kkieli]
      ,[kkun]
      ,[ophal]
      ,[sp]
      ,[aikielir1]
      ,[aiopis]
      ,[ika2]
      ,[lkm]
      ,[aikoul]
      ,[tutalv]
      ,[tutklaja]
      ,[tunim]
      ,[sutunim]
      ,[rutunim]
      ,[koohj]
      ,[sukoohj]
      ,[rukoohj]
      ,[tutktav]
      ,[rahoitus]
      ,[tavoite]
	  ,[tutalk]
	  ,[hyvennen]
	  ,[hyvaik]
	  ,[suorkouaik]
	  ,[ovyht]
	  ,[tyop]
	  ,[ammos]
	  ,[opintokok]
	  ,[vayla]
	  ,[toteuma_tutk]
	  ,[suorosat]
	  ,[jarj_opisk]
	  ,[kkun_opisk]
	  ,[tietolahde]=''2_4g_Lukio_ja_amm_koulutuksen_opiskelijat_15''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4g_sopv_15]

union all

SELECT
	   [tilv]
      ,[lahde]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[kkieli]
      ,[kkun]
      ,[ophal]
      ,[sp]
      ,[aikielir1]
      ,[aiopis]
      ,[ika2]
      ,[lkm]
      ,[aikoul]
      ,[tutalv]
      ,[tutklaja]
      ,[tunim]
      ,[sutunim]
      ,[rutunim]
      ,[koohj]
      ,[sukoohj]
      ,[rukoohj]
      ,[tutktav]
      ,[rahoitus]
      ,[tavoite]
	  ,[tutalk]
	  ,[hyvennen]
	  ,[hyvaik]
	  ,[suorkouaik]
	  ,[ovyht]
	  ,[tyop]
	  ,[ammos]
	  ,[opintokok]
	  ,[vayla]
	  ,[toteuma_tutk]
	  ,[suorosat]
	  ,[jarj_opisk]
	  ,[kkun_opisk]
	  ,[tietolahde]=''2_4e_Lukio_ja_amm_koulutuksen_opiskelijat_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4e_sopv_16]

union all

SELECT
	   [tilv]
      ,[lahde]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[kkieli]
      ,[kkun]
      ,[ophal]
      ,[sp]
      ,[aikielir1]
      ,[aiopis]
      ,[ika2]
      ,[lkm]
      ,[aikoul]
      ,[tutalv]
      ,[tutklaja]
      ,[tunim]
      ,[sutunim]
      ,[rutunim]
      ,[koohj]
      ,[sukoohj]
      ,[rukoohj]
      ,[tutktav]
      ,[rahoitus]
      ,[tavoite]
	  ,[tutalk]
	  ,[hyvennen]
	  ,[hyvaik]
	  ,[suorkouaik]
	  ,[ovyht]
	  ,[tyop]
	  ,[ammos]
	  ,[opintokok]
	  ,[vayla]
	  ,[toteuma_tutk]
	  ,[suorosat]
	  ,[jarj_opisk]
	  ,[kkun_opisk]
	  ,[tietolahde]=''2_4f_Lukio_ja_amm_koulutuksen_opiskelijat_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4f_sopv_16]

union all

SELECT
	   [tilv]
      ,[lahde]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[kkieli]
      ,[kkun]
      ,[ophal]
      ,[sp]
      ,[aikielir1]
      ,[aiopis]
      ,[ika2]
      ,[lkm]
      ,[aikoul]
      ,[tutalv]
      ,[tutklaja]
      ,[tunim]
      ,[sutunim]
      ,[rutunim]
      ,[koohj]
      ,[sukoohj]
      ,[rukoohj]
      ,[tutktav]
      ,[rahoitus]
      ,[tavoite]
	  ,[tutalk]
	  ,[hyvennen]
	  ,[hyvaik]
	  ,[suorkouaik]
	  ,[ovyht]
	  ,[tyop]
	  ,[ammos]
	  ,[opintokok]
	  ,[vayla]
	  ,[toteuma_tutk]
	  ,[suorosat]
	  ,[jarj_opisk]
	  ,[kkun_opisk]
	  ,[tietolahde]=''2_4g_Lukio_ja_amm_koulutuksen_opiskelijat_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4g_sopv_16]

) kaikkivuodet














' 
GO
/****** Object:  View [dbo].[v_sa_2_5_Lukiokoulutuksen_ainevalinnat]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_2_5_Lukiokoulutuksen_ainevalinnat]'))
EXEC dbo.sp_executesql @statement = N'
CREATE VIEW [dbo].[v_sa_2_5_Lukiokoulutuksen_ainevalinnat] AS
--Select * from v_sa_2_5_Lukiokoulutuksen_ainevalinnat
/*
Drop table VipunenTK_DW.[dbo].sa_2_5_Lukiokoulutuksen_ainevalinnat
Select * into VipunenTK_DW.[dbo].sa_2_5_Lukiokoulutuksen_ainevalinnat from v_sa_2_5_Lukiokoulutuksen_ainevalinnat

truncate table VipunenTK_DW.[dbo].sa_2_5_Lukiokoulutuksen_ainevalinnat
insert into VipunenTK_DW.[dbo].sa_2_5_Lukiokoulutuksen_ainevalinnat select * from v_sa_2_5_Lukiokoulutuksen_ainevalinnat
*/

SELECT
       [tilv] = Cast(tilv as nvarchar(4))
      ,[tunn] = Cast(tunn as nvarchar(5))
      ,[jarj] = Cast(jarj as nvarchar(10))
      ,[nukevy] = Nullif(Cast(nukevy as int), 0)
      ,[aikevy] = Nullif(Cast(aikevy as int), 0)
      ,[kev] = Nullif(Cast(kev as int), 0)
      ,[nukevyn] = Nullif(Cast(nukevyn as int), 0)
      ,[aikevyn] = Nullif(Cast(aikevyn as int), 0)
      ,[kevn] = Nullif(Cast(kevn as int), 0)
      ,[nukev1] = Nullif(Cast(nukev1 as int), 0)
      ,[nukev2] = Nullif(Cast(nukev2 as int), 0)
      ,[nukev3] = Nullif(Cast(nukev3 as int), 0)
      ,[nukev4] = Nullif(Cast(nukev4 as int), 0)
      ,[nukev] = Nullif(Cast(nukev as int), 0)
      ,[nukev1n] = Nullif(Cast(nukev1n as int), 0)
      ,[nukev2n] = Nullif(Cast(nukev2n as int), 0)
      ,[nukev3n] = Nullif(Cast(nukev3n as int), 0)
      ,[nukev4n] = Nullif(Cast(nukev4n as int), 0)
      ,[nukevn] = Nullif(Cast(nukevn as int), 0)
      ,[aikev1] = Nullif(Cast(aikev1 as int), 0)
      ,[aikev2] = Nullif(Cast(aikev2 as int), 0)
      ,[aikev3] = Nullif(Cast(aikev3 as int), 0)
      ,[aikev4] = Nullif(Cast(aikev4 as int), 0)
      ,[aikev] = Nullif(Cast(aikev as int), 0)
      ,[aikev1n] = Nullif(Cast(aikev1n as int), 0)
      ,[aikev2n] = Nullif(Cast(aikev2n as int), 0)
      ,[aikev3n] = Nullif(Cast(aikev3n as int), 0)
      ,[aikev4n] = Nullif(Cast(aikev4n as int), 0)
      ,[aikevn] = Nullif(Cast(aikevn as int), 0)
      ,[nuvary] = Nullif(Cast(nuvary as int), 0)
      ,[aivary] = Nullif(Cast(aivary as int), 0)
      ,[var] = Nullif(Cast(var as int), 0)
      ,[nuvaryn] = Nullif(Cast(nuvaryn as int), 0)
      ,[aivaryn] = Nullif(Cast(aivaryn as int), 0)
      ,[varn] = Nullif(Cast(varn as int), 0)
      ,[nuyks] = Nullif(Cast(nuyks as int), 0)
      ,[aiyks] = Nullif(Cast(aiyks as int), 0)
      ,[yksy] = Nullif(Cast(yksy as int), 0)
      ,[nuvar2] = Nullif(Cast(nuvar2 as int), 0)
      ,[nuvar25] = Nullif(Cast(nuvar25 as int), 0)
      ,[nuvar3] = Nullif(Cast(nuvar3 as int), 0)
      ,[nuvar35] = Nullif(Cast(nuvar35 as int), 0)
      ,[nuvar4] = Nullif(Cast(nuvar4 as int), 0)
      ,[nuvar45] = Nullif(Cast(nuvar45 as int), 0)
      ,[nuvar5] = Nullif(Cast(nuvar5 as int), 0)
      ,[nuvar] = Nullif(Cast(nuvar as int), 0)
      ,[nuvar2n] = Nullif(Cast(nuvar2n as int), 0)
      ,[nuvar25n] = Nullif(Cast(nuvar25n as int), 0)
      ,[nuvar3n] = Nullif(Cast(nuvar3n as int), 0)
      ,[nuvar35n] = Nullif(Cast(nuvar35n as int), 0)
      ,[nuvar4n] = Nullif(Cast(nuvar4n as int), 0)
      ,[nuvar45n] = Nullif(Cast(nuvar45n as int), 0)
      ,[nuvar5n] = Nullif(Cast(nuvar5n as int), 0)
      ,[nuvarn] = Nullif(Cast(nuvarn as int), 0)
      ,[aivar2] = Nullif(Cast(aivar2 as int), 0)
      ,[aivar25] = Nullif(Cast(aivar25 as int), 0)
      ,[aivar3] = Nullif(Cast(aivar3 as int), 0)
      ,[aivar35] = Nullif(Cast(aivar35 as int), 0)
      ,[aivar4] = Nullif(Cast(aivar4 as int), 0)
      ,[aivar45] = Nullif(Cast(aivar45 as int), 0)
      ,[aivar5] = Nullif(Cast(aivar5 as int), 0)
      ,[aivar] = Nullif(Cast(aivar as int), 0)
      ,[aivar2n] = Nullif(Cast(aivar2n as int), 0)
      ,[aivar25n] = Nullif(Cast(aivar25n as int), 0)
      ,[aivar3n] = Nullif(Cast(aivar3n as int), 0)
      ,[aivar35n] = Nullif(Cast(aivar35n as int), 0)
      ,[aivar4n] = Nullif(Cast(aivar4n as int), 0)
      ,[aivar45n] = Nullif(Cast(aivar45n as int), 0)
      ,[aivar5n] = Nullif(Cast(aivar5n as int), 0)
      ,[aivarn] = Nullif(Cast(aivarn as int), 0)
      ,[ev] = Nullif(Cast(ev as int), 0)
      ,[ort] = Nullif(Cast(ort as int), 0)
      ,[et] = Nullif(Cast(et as int), 0)
      ,[mu] = Nullif(Cast(mu as int), 0)
      ,[eos] = Nullif(Cast(eos as int), 0)
      ,[kay] = Nullif(Cast(kay as int), 0)
      ,[kieli1] = Nullif(Cast(kieli1 as int), 0)
      ,[kieli2] = Nullif(Cast(kieli2 as int), 0)
      ,[kieli3] = Nullif(Cast(kieli3 as int), 0)
      ,[kieli4] = Nullif(Cast(kieli4 as int), 0)
      ,[kieli5] = Nullif(Cast(kieli5 as int), 0)
      ,[kieli6] = Nullif(Cast(kieli6 as int), 0)
      ,[kieliy] = Nullif(Cast(kieliy as int), 0)
      ,[sv] = Nullif(Cast(sv as int), 0)
      ,[rv] = Nullif(Cast(rv as int), 0)
      ,[svrv] = Nullif(Cast(svrv as int), 0)
      ,[svnn] = Nullif(Cast(svnn as int), 0)
      ,[rvnn] = Nullif(Cast(rvnn as int), 0)
      ,[svrvn] = Nullif(Cast(svrvn as int), 0)
      ,[yaenm] = Nullif(Cast(yaenm as int), 0)
      ,[yyenm] = Nullif(Cast(yyenm as int), 0)
      ,[yen6m] = Nullif(Cast(yen6m as int), 0)
      ,[len6m] = Nullif(Cast(len6m as int), 0)
      ,[alen6m] = Nullif(Cast(alen6m as int), 0)
      ,[enmm] = Nullif(Cast(enmm as int), 0)
      ,[yaenn] = Nullif(Cast(yaenn as int), 0)
      ,[yyenn] = Nullif(Cast(yyenn as int), 0)
      ,[yen6n] = Nullif(Cast(yen6n as int), 0)
      ,[len6n] = Nullif(Cast(len6n as int), 0)
      ,[alen6n] = Nullif(Cast(alen6n as int), 0)
      ,[ennn] = Nullif(Cast(ennn as int), 0)
      ,[yarum] = Nullif(Cast(yarum as int), 0)
      ,[yyrum] = Nullif(Cast(yyrum as int), 0)
      ,[yru6m] = Nullif(Cast(yru6m as int), 0)
      ,[lru6m] = Nullif(Cast(lru6m as int), 0)
      ,[alru6m] = Nullif(Cast(alru6m as int), 0)
      ,[rumm] = Nullif(Cast(rumm as int), 0)
      ,[yarun] = Nullif(Cast(yarun as int), 0)
      ,[yyrun] = Nullif(Cast(yyrun as int), 0)
      ,[yru6n] = Nullif(Cast(yru6n as int), 0)
      ,[lru6n] = Nullif(Cast(lru6n as int), 0)
      ,[alru6n] = Nullif(Cast(alru6n as int), 0)
      ,[runn] = Nullif(Cast(runn as int), 0)
      ,[yasum] = Nullif(Cast(yasum as int), 0)
      ,[yysum] = Nullif(Cast(yysum as int), 0)
      ,[ysu6m] = Nullif(Cast(ysu6m as int), 0)
      ,[lsu6m] = Nullif(Cast(lsu6m as int), 0)
      ,[alsu6m] = Nullif(Cast(alsu6m as int), 0)
      ,[summ] = Nullif(Cast(summ as int), 0)
      ,[yasun] = Nullif(Cast(yasun as int), 0)
      ,[yysun] = Nullif(Cast(yysun as int), 0)
      ,[ysu6n] = Nullif(Cast(ysu6n as int), 0)
      ,[lsu6n] = Nullif(Cast(lsu6n as int), 0)
      ,[alsu6n] = Nullif(Cast(alsu6n as int), 0)
      ,[sunn] = Nullif(Cast(sunn as int), 0)
      ,[yaram] = Nullif(Cast(yaram as int), 0)
      ,[yyram] = Nullif(Cast(yyram as int), 0)
      ,[yra6m] = Nullif(Cast(yra6m as int), 0)
      ,[lra6m] = Nullif(Cast(lra6m as int), 0)
      ,[alra6m] = Nullif(Cast(alra6m as int), 0)
      ,[ramm] = Nullif(Cast(ramm as int), 0)
      ,[yaran] = Nullif(Cast(yaran as int), 0)
      ,[yyran] = Nullif(Cast(yyran as int), 0)
      ,[yra6n] = Nullif(Cast(yra6n as int), 0)
      ,[lra6n] = Nullif(Cast(lra6n as int), 0)
      ,[alra6n] = Nullif(Cast(alra6n as int), 0)
      ,[rann] = Nullif(Cast(rann as int), 0)
      ,[yasam] = Nullif(Cast(yasam as int), 0)
      ,[yysam] = Nullif(Cast(yysam as int), 0)
      ,[ysa6m] = Nullif(Cast(ysa6m as int), 0)
      ,[lsa6m] = Nullif(Cast(lsa6m as int), 0)
      ,[alsa6m] = Nullif(Cast(alsa6m as int), 0)
      ,[samm] = Nullif(Cast(samm as int), 0)
      ,[yasan] = Nullif(Cast(yasan as int), 0)
      ,[yysan] = Nullif(Cast(yysan as int), 0)
      ,[ysa6n] = Nullif(Cast(ysa6n as int), 0)
      ,[lsa6n] = Nullif(Cast(lsa6n as int), 0)
      ,[alsa6n] = Nullif(Cast(alsa6n as int), 0)
      ,[sann] = Nullif(Cast(sann as int), 0)
      ,[yavem] = Nullif(Cast(yavem as int), 0)
      ,[yyvem] = Nullif(Cast(yyvem as int), 0)
      ,[yve6m] = Nullif(Cast(yve6m as int), 0)
      ,[lve6m] = Nullif(Cast(lve6m as int), 0)
      ,[alve6m] = Nullif(Cast(alve6m as int), 0)
      ,[vemm] = Nullif(Cast(vemm as int), 0)
      ,[yaven] = Nullif(Cast(yaven as int), 0)
      ,[yyven] = Nullif(Cast(yyven as int), 0)
      ,[yve6n] = Nullif(Cast(yve6n as int), 0)
      ,[lve6n] = Nullif(Cast(lve6n as int), 0)
      ,[alve6n] = Nullif(Cast(alve6n as int), 0)
      ,[vennn] = Nullif(Cast(vennn as int), 0)
      ,[yasaam] = Nullif(Cast(yasaam as int), 0)
      ,[ysaa6m] = Nullif(Cast(ysaa6m as int), 0)
      ,[lsaa6m] = Nullif(Cast(lsaa6m as int), 0)
      ,[alsaa6m] = Nullif(Cast(alsaa6m as int), 0)
      ,[saamm] = Nullif(Cast(saamm as int), 0)
      ,[yasaan] = Nullif(Cast(yasaan as int), 0)
      ,[ysaa6n] = Nullif(Cast(ysaa6n as int), 0)
      ,[lsaa6n] = Nullif(Cast(lsaa6n as int), 0)
      ,[alsaa6n] = Nullif(Cast(alsaa6n as int), 0)
      ,[saann] = Nullif(Cast(saann as int), 0)
      ,[yalatm] = Nullif(Cast(yalatm as int), 0)
      ,[ylat6m] = Nullif(Cast(ylat6m as int), 0)
      ,[lla6m] = Nullif(Cast(lla6m as int), 0)
      ,[alla6m] = Nullif(Cast(alla6m as int), 0)
      ,[lamm] = Nullif(Cast(lamm as int), 0)
      ,[yalan] = Nullif(Cast(yalan as int), 0)
      ,[ylat6n] = Nullif(Cast(ylat6n as int), 0)
      ,[lla6n] = Nullif(Cast(lla6n as int), 0)
      ,[alla6n] = Nullif(Cast(alla6n as int), 0)
      ,[lann] = Nullif(Cast(lann as int), 0)
      ,[yaesm] = Nullif(Cast(yaesm as int), 0)
      ,[yes6m] = Nullif(Cast(yes6m as int), 0)
      ,[les6m] = Nullif(Cast(les6m as int), 0)
      ,[ales6m] = Nullif(Cast(ales6m as int), 0)
      ,[esmm] = Nullif(Cast(esmm as int), 0)
      ,[yaesn] = Nullif(Cast(yaesn as int), 0)
      ,[yes6n] = Nullif(Cast(yes6n as int), 0)
      ,[les6n] = Nullif(Cast(les6n as int), 0)
      ,[ales6n] = Nullif(Cast(ales6n as int), 0)
      ,[esnn] = Nullif(Cast(esnn as int), 0)
      ,[yaitm] = Nullif(Cast(yaitm as int), 0)
      ,[yit6m] = Nullif(Cast(yit6m as int), 0)
      ,[lit6m] = Nullif(Cast(lit6m as int), 0)
      ,[alit6m] = Nullif(Cast(alit6m as int), 0)
      ,[itmm] = Nullif(Cast(itmm as int), 0)
      ,[yaitn] = Nullif(Cast(yaitn as int), 0)
      ,[yit6n] = Nullif(Cast(yit6n as int), 0)
      ,[lit6n] = Nullif(Cast(lit6n as int), 0)
      ,[alit6n] = Nullif(Cast(alit6n as int), 0)
      ,[itnn] = Nullif(Cast(itnn as int), 0)
      ,[yamum] = Nullif(Cast(yamum as int), 0)
      ,[yymum] = Nullif(Cast(yymum as int), 0)
      ,[ymu6m] = Nullif(Cast(ymu6m as int), 0)
      ,[lmu6m] = Nullif(Cast(lmu6m as int), 0)
      ,[almu6m] = Nullif(Cast(almu6m as int), 0)
      ,[mumm] = Nullif(Cast(mumm as int), 0)
      ,[yamun] = Nullif(Cast(yamun as int), 0)
      ,[yymun] = Nullif(Cast(yymun as int), 0)
      ,[ymu6n] = Nullif(Cast(ymu6n as int), 0)
      ,[lmu6n] = Nullif(Cast(lmu6n as int), 0)
      ,[almu6n] = Nullif(Cast(almu6n as int), 0)
      ,[munn] = Nullif(Cast(munn as int), 0)
      ,[yyvam] = Nullif(Cast(yyvam as int), 0)
      ,[vamm] = Nullif(Cast(vamm as int), 0)
      ,[yyvan] = Nullif(Cast(yyvan as int), 0)
      ,[vann] = Nullif(Cast(vann as int), 0)
      ,[pmatm] = Nullif(Cast(pmatm as int), 0)
      ,[pmatn] = Nullif(Cast(pmatn as int), 0)
      ,[pmaty] = Nullif(Cast(pmaty as int), 0)
      ,[lmatm] = Nullif(Cast(lmatm as int), 0)
      ,[lmatn] = Nullif(Cast(lmatn as int), 0)
      ,[lmaty] = Nullif(Cast(lmaty as int), 0)
      ,[matm] = Nullif(Cast(matm as int), 0)
      ,[matn] = Nullif(Cast(matn as int), 0)
      ,[maty] = Nullif(Cast(maty as int), 0)
      ,[pma1m] = Nullif(Cast(pma1m as int), 0)
      ,[pma1n] = Nullif(Cast(pma1n as int), 0)
      ,[pma2m] = Nullif(Cast(pma2m as int), 0)
      ,[pma2n] = Nullif(Cast(pma2n as int), 0)
      ,[pma3m] = Nullif(Cast(pma3m as int), 0)
      ,[pma3n] = Nullif(Cast(pma3n as int), 0)
      ,[pma45m] = Nullif(Cast(pma45m as int), 0)
      ,[pma45n] = Nullif(Cast(pma45n as int), 0)
      ,[pma6m] = Nullif(Cast(pma6m as int), 0)
      ,[pma6n] = Nullif(Cast(pma6n as int), 0)
      ,[pma7m] = Nullif(Cast(pma7m as int), 0)
      ,[pma7n] = Nullif(Cast(pma7n as int), 0)
      ,[lma1m] = Nullif(Cast(lma1m as int), 0)
      ,[lma1n] = Nullif(Cast(lma1n as int), 0)
      ,[lma2m] = Nullif(Cast(lma2m as int), 0)
      ,[lma2n] = Nullif(Cast(lma2n as int), 0)
      ,[lma3m] = Nullif(Cast(lma3m as int), 0)
      ,[lma3n] = Nullif(Cast(lma3n as int), 0)
      ,[lma45m] = Nullif(Cast(lma45m as int), 0)
      ,[lma45n] = Nullif(Cast(lma45n as int), 0)
      ,[lma6m] = Nullif(Cast(lma6m as int), 0)
      ,[lma6n] = Nullif(Cast(lma6n as int), 0)
      ,[lma7m] = Nullif(Cast(lma7m as int), 0)
      ,[lma7n] = Nullif(Cast(lma7n as int), 0)
      ,[fy1m] = Nullif(Cast(fy1m as int), 0)
      ,[fy1n] = Nullif(Cast(fy1n as int), 0)
      ,[fy2m] = Nullif(Cast(fy2m as int), 0)
      ,[fy2n] = Nullif(Cast(fy2n as int), 0)
      ,[fy3m] = Nullif(Cast(fy3m as int), 0)
      ,[fy3n] = Nullif(Cast(fy3n as int), 0)
      ,[fy45m] = Nullif(Cast(fy45m as int), 0)
      ,[fy45n] = Nullif(Cast(fy45n as int), 0)
      ,[fy6m] = Nullif(Cast(fy6m as int), 0)
      ,[fy6n] = Nullif(Cast(fy6n as int), 0)
      ,[fy7m] = Nullif(Cast(fy7m as int), 0)
      ,[fy7n] = Nullif(Cast(fy7n as int), 0)
      ,[ke1m] = Nullif(Cast(ke1m as int), 0)
      ,[ke1n] = Nullif(Cast(ke1n as int), 0)
      ,[ke2m] = Nullif(Cast(ke2m as int), 0)
      ,[ke2n] = Nullif(Cast(ke2n as int), 0)
      ,[ke3m] = Nullif(Cast(ke3m as int), 0)
      ,[ke3n] = Nullif(Cast(ke3n as int), 0)
      ,[ke45m] = Nullif(Cast(ke45m as int), 0)
      ,[ke45n] = Nullif(Cast(ke45n as int), 0)
      ,[ke6m] = Nullif(Cast(ke6m as int), 0)
      ,[ke6n] = Nullif(Cast(ke6n as int), 0)
      ,[ke7m] = Nullif(Cast(ke7m as int), 0)
      ,[ke7n] = Nullif(Cast(ke7n as int), 0)
      ,[bi1m] = Nullif(Cast(bi1m as int), 0)
      ,[bi1n] = Nullif(Cast(bi1n as int), 0)
      ,[bi2m] = Nullif(Cast(bi2m as int), 0)
      ,[bi2n] = Nullif(Cast(bi2n as int), 0)
      ,[bi3m] = Nullif(Cast(bi3m as int), 0)
      ,[bi3n] = Nullif(Cast(bi3n as int), 0)
      ,[bi45m] = Nullif(Cast(bi45m as int), 0)
      ,[bi45n] = Nullif(Cast(bi45n as int), 0)
      ,[bi6m] = Nullif(Cast(bi6m as int), 0)
      ,[bi6n] = Nullif(Cast(bi6n as int), 0)
      ,[bi7m] = Nullif(Cast(bi7m as int), 0)
      ,[bi7n] = Nullif(Cast(bi7n as int), 0)
      ,[mt1m] = Nullif(Cast(mt1m as int), 0)
      ,[mt1n] = Nullif(Cast(mt1n as int), 0)
      ,[mt2m] = Nullif(Cast(mt2m as int), 0)
      ,[mt2n] = Nullif(Cast(mt2n as int), 0)
      ,[mt3m] = Nullif(Cast(mt3m as int), 0)
      ,[mt3n] = Nullif(Cast(mt3n as int), 0)
      ,[mt45m] = Nullif(Cast(mt45m as int), 0)
      ,[mt45n] = Nullif(Cast(mt45n as int), 0)
      ,[mt6m] = Nullif(Cast(mt6m as int), 0)
      ,[mt6n] = Nullif(Cast(mt6n as int), 0)
      ,[mt7m] = Nullif(Cast(mt7m as int), 0)
      ,[mt7n] = Nullif(Cast(mt7n as int), 0)
      ,[soma2m] = Nullif(Cast(soma2m as int), 0)
      ,[soma2n] = Nullif(Cast(soma2n as int), 0)
      ,[soma3m] = Nullif(Cast(soma3m as int), 0)
      ,[soma3n] = Nullif(Cast(soma3n as int), 0)
      ,[sofy2m] = Nullif(Cast(sofy2m as int), 0)
      ,[sofy2n] = Nullif(Cast(sofy2n as int), 0)
      ,[sofy3m] = Nullif(Cast(sofy3m as int), 0)
      ,[sofy3n] = Nullif(Cast(sofy3n as int), 0)
      ,[soke2m] = Nullif(Cast(soke2m as int), 0)
      ,[soke2n] = Nullif(Cast(soke2n as int), 0)
      ,[soke3m] = Nullif(Cast(soke3m as int), 0)
      ,[soke3n] = Nullif(Cast(soke3n as int), 0)
      ,[sobi2m] = Nullif(Cast(sobi2m as int), 0)
      ,[sobi2n] = Nullif(Cast(sobi2n as int), 0)
      ,[sobi3m] = Nullif(Cast(sobi3m as int), 0)
      ,[sobi3n] = Nullif(Cast(sobi3n as int), 0)
      ,[somt2m] = Nullif(Cast(somt2m as int), 0)
      ,[somt2n] = Nullif(Cast(somt2n as int), 0)
      ,[somt3m] = Nullif(Cast(somt3m as int), 0)
      ,[somt3n] = Nullif(Cast(somt3n as int), 0)
      ,[sotek2m] = Nullif(Cast(sotek2m as int), 0)
      ,[sotek2n] = Nullif(Cast(sotek2n as int), 0)
      ,[sotek3m] = Nullif(Cast(sotek3m as int), 0)
      ,[sotek3n] = Nullif(Cast(sotek3n as int), 0)
      ,[tietolahde] = Cast(tietolahde as nvarchar(250))
      ,[rivinumero] = Cast(rivinumero as int)
FROM (
SELECT [tilv]
      ,[tunn]
      ,[jarj]
      ,[nukevy]
      ,[aikevy]
      ,[kev]
      ,[nukevyn]
      ,[aikevyn]
      ,[kevn]
      ,[nukev1]
      ,[nukev2]
      ,[nukev3]
      ,[nukev4]
      ,[nukev]
      ,[nukev1n]
      ,[nukev2n]
      ,[nukev3n]
      ,[nukev4n]
      ,[nukevn]
      ,[aikev1]
      ,[aikev2]
      ,[aikev3]
      ,[aikev4]
      ,[aikev]
      ,[aikev1n]
      ,[aikev2n]
      ,[aikev3n]
      ,[aikev4n]
      ,[aikevn]
      ,[nuvary]
      ,[aivary]
      ,[var]
      ,[nuvaryn]
      ,[aivaryn]
      ,[varn]
      ,[nuyks]
      ,[aiyks]
      ,[yksy]
      ,[nuvar2]
      ,[nuvar25]
      ,[nuvar3]
      ,[nuvar35]
      ,[nuvar4]
      ,[nuvar45]
      ,[nuvar5]
      ,[nuvar]
      ,[nuvar2n]
      ,[nuvar25n]
      ,[nuvar3n]
      ,[nuvar35n]
      ,[nuvar4n]
      ,[nuvar45n]
      ,[nuvar5n]
      ,[nuvarn]
      ,[aivar2]
      ,[aivar25]
      ,[aivar3]
      ,[aivar35]
      ,[aivar4]
      ,[aivar45]
      ,[aivar5]
      ,[aivar]
      ,[aivar2n]
      ,[aivar25n]
      ,[aivar3n]
      ,[aivar35n]
      ,[aivar4n]
      ,[aivar45n]
      ,[aivar5n]
      ,[aivarn]
      ,[ev]
      ,[ort]
      ,[et]
      ,[mu]
      ,[eos]
      ,[kay]
      ,[kieli1]
      ,[kieli2]
      ,[kieli3]
      ,[kieli4]
      ,[kieli5]
      ,[kieli6]
      ,[kieliy]
      ,[sv]
      ,[rv]
      ,[svrv]
      ,[svnn]
      ,[rvnn]
      ,[svrvn]
      ,[yaenm]
      ,[yyenm]
      ,[yen6m]
      ,[len6m]
      ,[alen6m]
      ,[enmm]
      ,[yaenn]
      ,[yyenn]
      ,[yen6n]
      ,[len6n]
      ,[alen6n]
      ,[ennn]
      ,[yarum]
      ,[yyrum]
      ,[yru6m]
      ,[lru6m]
      ,[alru6m]
      ,[rumm]
      ,[yarun]
      ,[yyrun]
      ,[yru6n]
      ,[lru6n]
      ,[alru6n]
      ,[runn]
      ,[yasum]
      ,[yysum]
      ,[ysu6m]
      ,[lsu6m]
      ,[alsu6m]
      ,[summ]
      ,[yasun]
      ,[yysun]
      ,[ysu6n]
      ,[lsu6n]
      ,[alsu6n]
      ,[sunn]
      ,[yaram]
      ,[yyram]
      ,[yra6m]
      ,[lra6m]
      ,[alra6m]
      ,[ramm]
      ,[yaran]
      ,[yyran]
      ,[yra6n]
      ,[lra6n]
      ,[alra6n]
      ,[rann]
      ,[yasam]
      ,[yysam]
      ,[ysa6m]
      ,[lsa6m]
      ,[alsa6m]
      ,[samm]
      ,[yasan]
      ,[yysan]
      ,[ysa6n]
      ,[lsa6n]
      ,[alsa6n]
      ,[sann]
      ,[yavem]
      ,[yyvem]
      ,[yve6m]
      ,[lve6m]
      ,[alve6m]
      ,[vemm]
      ,[yaven]
      ,[yyven]
      ,[yve6n]
      ,[lve6n]
      ,[alve6n]
      ,[vennn]
      ,[yasaam]
      ,[ysaa6m]
      ,[lsaa6m]
      ,[alsaa6m]
      ,[saamm]
      ,[yasaan]
      ,[ysaa6n]
      ,[lsaa6n]
      ,[alsaa6n]
      ,[saann]
      ,[yalatm]
      ,[ylat6m]
      ,[lla6m]
      ,[alla6m]
      ,[lamm]
      ,[yalan]
      ,[ylat6n]
      ,[lla6n]
      ,[alla6n]
      ,[lann]
      ,[yaesm]
      ,[yes6m]
      ,[les6m]
      ,[ales6m]
      ,[esmm]
      ,[yaesn]
      ,[yes6n]
      ,[les6n]
      ,[ales6n]
      ,[esnn]
      ,[yaitm]
      ,[yit6m]
      ,[lit6m]
      ,[alit6m]
      ,[itmm]
      ,[yaitn]
      ,[yit6n]
      ,[lit6n]
      ,[alit6n]
      ,[itnn]
      ,[yamum]
      ,[yymum]
      ,[ymu6m]
      ,[lmu6m]
      ,[almu6m]
      ,[mumm]
      ,[yamun]
      ,[yymun]
      ,[ymu6n]
      ,[lmu6n]
      ,[almu6n]
      ,[munn]
      ,[yyvam]
      ,[vamm]
      ,[yyvan]
      ,[vann]
      ,[pmatm]
      ,[pmatn]
      ,[pmaty]
      ,[lmatm]
      ,[lmatn]
      ,[lmaty]
      ,[matm]
      ,[matn]
      ,[maty]
      ,[pma1m]
      ,[pma1n]
      ,[pma2m]
      ,[pma2n]
      ,[pma3m]
      ,[pma3n]
      ,[pma45m]
      ,[pma45n]
      ,[pma6m]
      ,[pma6n]
      ,[pma7m]
      ,[pma7n]
      ,[lma1m]
      ,[lma1n]
      ,[lma2m]
      ,[lma2n]
      ,[lma3m]
      ,[lma3n]
      ,[lma45m]
      ,[lma45n]
      ,[lma6m]
      ,[lma6n]
      ,[lma7m]
      ,[lma7n]
      ,[fy1m]
      ,[fy1n]
      ,[fy2m]
      ,[fy2n]
      ,[fy3m]
      ,[fy3n]
      ,[fy45m]
      ,[fy45n]
      ,[fy6m]
      ,[fy6n]
      ,[fy7m]
      ,[fy7n]
      ,[ke1m]
      ,[ke1n]
      ,[ke2m]
      ,[ke2n]
      ,[ke3m]
      ,[ke3n]
      ,[ke45m]
      ,[ke45n]
      ,[ke6m]
      ,[ke6n]
      ,[ke7m]
      ,[ke7n]
      ,[bi1m]
      ,[bi1n]
      ,[bi2m]
      ,[bi2n]
      ,[bi3m]
      ,[bi3n]
      ,[bi45m]
      ,[bi45n]
      ,[bi6m]
      ,[bi6n]
      ,[bi7m]
      ,[bi7n]
      ,[mt1m]
      ,[mt1n]
      ,[mt2m]
      ,[mt2n]
      ,[mt3m]
      ,[mt3n]
      ,[mt45m]
      ,[mt45n]
      ,[mt6m]
      ,[mt6n]
      ,[mt7m]
      ,[mt7n]
      ,[soma2m]
      ,[soma2n]
      ,[soma3m]
      ,[soma3n]
      ,[sofy2m]
      ,[sofy2n]
      ,[sofy3m]
      ,[sofy3n]
      ,[soke2m]
      ,[soke2n]
      ,[soke3m]
      ,[soke3n]
      ,[sobi2m]
      ,[sobi2n]
      ,[sobi3m]
      ,[sobi3n]
      ,[somt2m]
      ,[somt2n]
      ,[somt3m]
      ,[somt3n]
      ,[sotek2m]
      ,[sotek2n]
      ,[sotek3m]
      ,[sotek3n]
      ,[tietolahde]=''2_5_sopv_11''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv, tunn)
      --,[rivinumero]
  FROM [TK_H9098_CSC].[dbo].[TK_2_5_sopv_11]

  UNION ALL

SELECT
	   [tilv]
      ,[tunn]
      ,[jarj]
      ,[nukevy]
      ,[aikevy]
      ,[kev]
      ,[nukevyn]
      ,[aikevyn]
      ,[kevn]
      ,[nukev1]
      ,[nukev2]
      ,[nukev3]
      ,[nukev4]
      ,[nukev]
      ,[nukev1n]
      ,[nukev2n]
      ,[nukev3n]
      ,[nukev4n]
      ,[nukevn]
      ,[aikev1]
      ,[aikev2]
      ,[aikev3]
      ,[aikev4]
      ,[aikev]
      ,[aikev1n]
      ,[aikev2n]
      ,[aikev3n]
      ,[aikev4n]
      ,[aikevn]
      ,[nuvary]
      ,[aivary]
      ,[var]
      ,[nuvaryn]
      ,[aivaryn]
      ,[varn]
      ,[nuyks]
      ,[aiyks]
      ,[yksy]
      ,[nuvar2]
      ,[nuvar25]
      ,[nuvar3]
      ,[nuvar35]
      ,[nuvar4]
      ,[nuvar45]
      ,[nuvar5]
      ,[nuvar]
      ,[nuvar2n]
      ,[nuvar25n]
      ,[nuvar3n]
      ,[nuvar35n]
      ,[nuvar4n]
      ,[nuvar45n]
      ,[nuvar5n]
      ,[nuvarn]
      ,[aivar2]
      ,[aivar25]
      ,[aivar3]
      ,[aivar35]
      ,[aivar4]
      ,[aivar45]
      ,[aivar5]
      ,[aivar]
      ,[aivar2n]
      ,[aivar25n]
      ,[aivar3n]
      ,[aivar35n]
      ,[aivar4n]
      ,[aivar45n]
      ,[aivar5n]
      ,[aivarn]
      ,[ev]
      ,[ort]
      ,[et]
      ,[mu]
      ,[eos]
      ,[kay]
      ,[kieli1]
      ,[kieli2]
      ,[kieli3]
      ,[kieli4]
      ,[kieli5]
      ,[kieli6]
      ,[kieliy]
      ,[sv]
      ,[rv]
      ,[svrv]
      ,[svnn]
      ,[rvnn]
      ,[svrvn]
      ,[yaenm]
      ,[yyenm]
      ,[yen6m]
      ,[len6m]
      ,[alen6m]
      ,[enmm]
      ,[yaenn]
      ,[yyenn]
      ,[yen6n]
      ,[len6n]
      ,[alen6n]
      ,[ennn]
      ,[yarum]
      ,[yyrum]
      ,[yru6m]
      ,[lru6m]
      ,[alru6m]
      ,[rumm]
      ,[yarun]
      ,[yyrun]
      ,[yru6n]
      ,[lru6n]
      ,[alru6n]
      ,[runn]
      ,[yasum]
      ,[yysum]
      ,[ysu6m]
      ,[lsu6m]
      ,[alsu6m]
      ,[summ]
      ,[yasun]
      ,[yysun]
      ,[ysu6n]
      ,[lsu6n]
      ,[alsu6n]
      ,[sunn]
      ,[yaram]
      ,[yyram]
      ,[yra6m]
      ,[lra6m]
      ,[alra6m]
      ,[ramm]
      ,[yaran]
      ,[yyran]
      ,[yra6n]
      ,[lra6n]
      ,[alra6n]
      ,[rann]
      ,[yasam]
      ,[yysam]
      ,[ysa6m]
      ,[lsa6m]
      ,[alsa6m]
      ,[samm]
      ,[yasan]
      ,[yysan]
      ,[ysa6n]
      ,[lsa6n]
      ,[alsa6n]
      ,[sann]
      ,[yavem]
      ,[yyvem]
      ,[yve6m]
      ,[lve6m]
      ,[alve6m]
      ,[vemm]
      ,[yaven]
      ,[yyven]
      ,[yve6n]
      ,[lve6n]
      ,[alve6n]
      ,[vennn]
      ,[yasaam]
      ,[ysaa6m]
      ,[lsaa6m]
      ,[alsaa6m]
      ,[saamm]
      ,[yasaan]
      ,[ysaa6n]
      ,[lsaa6n]
      ,[alsaa6n]
      ,[saann]
      ,[yalatm]
      ,[ylat6m]
      ,[lla6m]
      ,[alla6m]
      ,[lamm]
      ,[yalan]
      ,[ylat6n]
      ,[lla6n]
      ,[alla6n]
      ,[lann]
      ,[yaesm]
      ,[yes6m]
      ,[les6m]
      ,[ales6m]
      ,[esmm]
      ,[yaesn]
      ,[yes6n]
      ,[les6n]
      ,[ales6n]
      ,[esnn]
      ,[yaitm]
      ,[yit6m]
      ,[lit6m]
      ,[alit6m]
      ,[itmm]
      ,[yaitn]
      ,[yit6n]
      ,[lit6n]
      ,[alit6n]
      ,[itnn]
      ,[yamum]
      ,[yymum]
      ,[ymu6m]
      ,[lmu6m]
      ,[almu6m]
      ,[mumm]
      ,[yamun]
      ,[yymun]
      ,[ymu6n]
      ,[lmu6n]
      ,[almu6n]
      ,[munn]
      ,[yyvam]
      ,[vamm]
      ,[yyvan]
      ,[vann]
      ,[pmatm]
      ,[pmatn]
      ,[pmaty]
      ,[lmatm]
      ,[lmatn]
      ,[lmaty]
      ,[matm]
      ,[matn]
      ,[maty]
      ,[pma1m]
      ,[pma1n]
      ,[pma2m]
      ,[pma2n]
      ,[pma3m]
      ,[pma3n]
      ,[pma45m]
      ,[pma45n]
      ,[pma6m]
      ,[pma6n]
      ,[pma7m]
      ,[pma7n]
      ,[lma1m]
      ,[lma1n]
      ,[lma2m]
      ,[lma2n]
      ,[lma3m]
      ,[lma3n]
      ,[lma45m]
      ,[lma45n]
      ,[lma6m]
      ,[lma6n]
      ,[lma7m]
      ,[lma7n]
      ,[fy1m]
      ,[fy1n]
      ,[fy2m]
      ,[fy2n]
      ,[fy3m]
      ,[fy3n]
      ,[fy45m]
      ,[fy45n]
      ,[fy6m]
      ,[fy6n]
      ,[fy7m]
      ,[fy7n]
      ,[ke1m]
      ,[ke1n]
      ,[ke2m]
      ,[ke2n]
      ,[ke3m]
      ,[ke3n]
      ,[ke45m]
      ,[ke45n]
      ,[ke6m]
      ,[ke6n]
      ,[ke7m]
      ,[ke7n]
      ,[bi1m]
      ,[bi1n]
      ,[bi2m]
      ,[bi2n]
      ,[bi3m]
      ,[bi3n]
      ,[bi45m]
      ,[bi45n]
      ,[bi6m]
      ,[bi6n]
      ,[bi7m]
      ,[bi7n]
      ,[mt1m]
      ,[mt1n]
      ,[mt2m]
      ,[mt2n]
      ,[mt3m]
      ,[mt3n]
      ,[mt45m]
      ,[mt45n]
      ,[mt6m]
      ,[mt6n]
      ,[mt7m]
      ,[mt7n]
      ,[soma2m]
      ,[soma2n]
      ,[soma3m]
      ,[soma3n]
      ,[sofy2m]
      ,[sofy2n]
      ,[sofy3m]
      ,[sofy3n]
      ,[soke2m]
      ,[soke2n]
      ,[soke3m]
      ,[soke3n]
      ,[sobi2m]
      ,[sobi2n]
      ,[sobi3m]
      ,[sobi3n]
      ,[somt2m]
      ,[somt2n]
      ,[somt3m]
      ,[somt3n]
      ,[sotek2m]
      ,[sotek2n]
      ,[sotek3m]
      ,[sotek3n]
      ,[tietolahde]=''2_5_sopv_12''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv, tunn)
      --,[rivinumero]
  FROM [TK_H9098_CSC].[dbo].[TK_2_5_sopv_12]
  
  UNION ALL

SELECT
	   [tilv]
      ,[tunn]
      ,[jarj]
      ,[nukevy]
      ,[aikevy]
      ,[kev]
      ,[nukevyn]
      ,[aikevyn]
      ,[kevn]
      ,[nukev1]
      ,[nukev2]
      ,[nukev3]
      ,[nukev4]
      ,[nukev]
      ,[nukev1n]
      ,[nukev2n]
      ,[nukev3n]
      ,[nukev4n]
      ,[nukevn]
      ,[aikev1]
      ,[aikev2]
      ,[aikev3]
      ,[aikev4]
      ,[aikev]
      ,[aikev1n]
      ,[aikev2n]
      ,[aikev3n]
      ,[aikev4n]
      ,[aikevn]
      ,[nuvary]
      ,[aivary]
      ,[var]
      ,[nuvaryn]
      ,[aivaryn]
      ,[varn]
      ,[nuyks]
      ,[aiyks]
      ,[yksy]
      ,[nuvar2]
      ,[nuvar25]
      ,[nuvar3]
      ,[nuvar35]
      ,[nuvar4]
      ,[nuvar45]
      ,[nuvar5]
      ,[nuvar]
      ,[nuvar2n]
      ,[nuvar25n]
      ,[nuvar3n]
      ,[nuvar35n]
      ,[nuvar4n]
      ,[nuvar45n]
      ,[nuvar5n]
      ,[nuvarn]
      ,[aivar2]
      ,[aivar25]
      ,[aivar3]
      ,[aivar35]
      ,[aivar4]
      ,[aivar45]
      ,[aivar5]
      ,[aivar]
      ,[aivar2n]
      ,[aivar25n]
      ,[aivar3n]
      ,[aivar35n]
      ,[aivar4n]
      ,[aivar45n]
      ,[aivar5n]
      ,[aivarn]
      ,[ev]
      ,[ort]
      ,[et]
      ,[mu]
      ,[eos]
      ,[kay]
      ,[kieli1]
      ,[kieli2]
      ,[kieli3]
      ,[kieli4]
      ,[kieli5]
      ,[kieli6]
      ,[kieliy]
      ,[sv]
      ,[rv]
      ,[svrv]
      ,[svnn]
      ,[rvnn]
      ,[svrvn]
      ,[yaenm]
      ,[yyenm]
      ,[yen6m]
      ,[len6m]
      ,[alen6m]
      ,[enmm]
      ,[yaenn]
      ,[yyenn]
      ,[yen6n]
      ,[len6n]
      ,[alen6n]
      ,[ennn]
      ,[yarum]
      ,[yyrum]
      ,[yru6m]
      ,[lru6m]
      ,[alru6m]
      ,[rumm]
      ,[yarun]
      ,[yyrun]
      ,[yru6n]
      ,[lru6n]
      ,[alru6n]
      ,[runn]
      ,[yasum]
      ,[yysum]
      ,[ysu6m]
      ,[lsu6m]
      ,[alsu6m]
      ,[summ]
      ,[yasun]
      ,[yysun]
      ,[ysu6n]
      ,[lsu6n]
      ,[alsu6n]
      ,[sunn]
      ,[yaram]
      ,[yyram]
      ,[yra6m]
      ,[lra6m]
      ,[alra6m]
      ,[ramm]
      ,[yaran]
      ,[yyran]
      ,[yra6n]
      ,[lra6n]
      ,[alra6n]
      ,[rann]
      ,[yasam]
      ,[yysam]
      ,[ysa6m]
      ,[lsa6m]
      ,[alsa6m]
      ,[samm]
      ,[yasan]
      ,[yysan]
      ,[ysa6n]
      ,[lsa6n]
      ,[alsa6n]
      ,[sann]
      ,[yavem]
      ,[yyvem]
      ,[yve6m]
      ,[lve6m]
      ,[alve6m]
      ,[vemm]
      ,[yaven]
      ,[yyven]
      ,[yve6n]
      ,[lve6n]
      ,[alve6n]
      ,[vennn]
      ,[yasaam]
      ,[ysaa6m]
      ,[lsaa6m]
      ,[alsaa6m]
      ,[saamm]
      ,[yasaan]
      ,[ysaa6n]
      ,[lsaa6n]
      ,[alsaa6n]
      ,[saann]
      ,[yalatm]
      ,[ylat6m]
      ,[lla6m]
      ,[alla6m]
      ,[lamm]
      ,[yalan]
      ,[ylat6n]
      ,[lla6n]
      ,[alla6n]
      ,[lann]
      ,[yaesm]
      ,[yes6m]
      ,[les6m]
      ,[ales6m]
      ,[esmm]
      ,[yaesn]
      ,[yes6n]
      ,[les6n]
      ,[ales6n]
      ,[esnn]
      ,[yaitm]
      ,[yit6m]
      ,[lit6m]
      ,[alit6m]
      ,[itmm]
      ,[yaitn]
      ,[yit6n]
      ,[lit6n]
      ,[alit6n]
      ,[itnn]
      ,[yamum]
      ,[yymum]
      ,[ymu6m]
      ,[lmu6m]
      ,[almu6m]
      ,[mumm]
      ,[yamun]
      ,[yymun]
      ,[ymu6n]
      ,[lmu6n]
      ,[almu6n]
      ,[munn]
      ,[yyvam]
      ,[vamm]
      ,[yyvan]
      ,[vann]
      ,[pmatm]
      ,[pmatn]
      ,[pmaty]
      ,[lmatm]
      ,[lmatn]
      ,[lmaty]
      ,[matm]
      ,[matn]
      ,[maty]
      ,[pma1m]
      ,[pma1n]
      ,[pma2m]
      ,[pma2n]
      ,[pma3m]
      ,[pma3n]
      ,[pma45m]
      ,[pma45n]
      ,[pma6m]
      ,[pma6n]
      ,[pma7m]
      ,[pma7n]
      ,[lma1m]
      ,[lma1n]
      ,[lma2m]
      ,[lma2n]
      ,[lma3m]
      ,[lma3n]
      ,[lma45m]
      ,[lma45n]
      ,[lma6m]
      ,[lma6n]
      ,[lma7m]
      ,[lma7n]
      ,[fy1m]
      ,[fy1n]
      ,[fy2m]
      ,[fy2n]
      ,[fy3m]
      ,[fy3n]
      ,[fy45m]
      ,[fy45n]
      ,[fy6m]
      ,[fy6n]
      ,[fy7m]
      ,[fy7n]
      ,[ke1m]
      ,[ke1n]
      ,[ke2m]
      ,[ke2n]
      ,[ke3m]
      ,[ke3n]
      ,[ke45m]
      ,[ke45n]
      ,[ke6m]
      ,[ke6n]
      ,[ke7m]
      ,[ke7n]
      ,[bi1m]
      ,[bi1n]
      ,[bi2m]
      ,[bi2n]
      ,[bi3m]
      ,[bi3n]
      ,[bi45m]
      ,[bi45n]
      ,[bi6m]
      ,[bi6n]
      ,[bi7m]
      ,[bi7n]
      ,[mt1m]
      ,[mt1n]
      ,[mt2m]
      ,[mt2n]
      ,[mt3m]
      ,[mt3n]
      ,[mt45m]
      ,[mt45n]
      ,[mt6m]
      ,[mt6n]
      ,[mt7m]
      ,[mt7n]
      ,[soma2m]
      ,[soma2n]
      ,[soma3m]
      ,[soma3n]
      ,[sofy2m]
      ,[sofy2n]
      ,[sofy3m]
      ,[sofy3n]
      ,[soke2m]
      ,[soke2n]
      ,[soke3m]
      ,[soke3n]
      ,[sobi2m]
      ,[sobi2n]
      ,[sobi3m]
      ,[sobi3n]
      ,[somt2m]
      ,[somt2n]
      ,[somt3m]
      ,[somt3n]
      ,[sotek2m]
      ,[sotek2n]
      ,[sotek3m]
      ,[sotek3n]
      ,[tietolahde]=''2_5_sopv_14''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv, tunn)
      --,[rivinumero]
  FROM [TK_H9098_CSC].[dbo].[TK_2_5_sopv_14]
  
  UNION ALL

SELECT
	   [tilv]
      ,[tunn]
      ,[jarj]
      ,[nukevy]
      ,[aikevy]
      ,[kev]
      ,[nukevyn]
      ,[aikevyn]
      ,[kevn]
      ,[nukev1]
      ,[nukev2]
      ,[nukev3]
      ,[nukev4]
      ,[nukev]
      ,[nukev1n]
      ,[nukev2n]
      ,[nukev3n]
      ,[nukev4n]
      ,[nukevn]
      ,[aikev1]
      ,[aikev2]
      ,[aikev3]
      ,[aikev4]
      ,[aikev]
      ,[aikev1n]
      ,[aikev2n]
      ,[aikev3n]
      ,[aikev4n]
      ,[aikevn]
      ,[nuvary]
      ,[aivary]
      ,[var]
      ,[nuvaryn]
      ,[aivaryn]
      ,[varn]
      ,[nuyks]
      ,[aiyks]
      ,[yksy]
      ,[nuvar2]
      ,[nuvar25]
      ,[nuvar3]
      ,[nuvar35]
      ,[nuvar4]
      ,[nuvar45]
      ,[nuvar5]
      ,[nuvar]
      ,[nuvar2n]
      ,[nuvar25n]
      ,[nuvar3n]
      ,[nuvar35n]
      ,[nuvar4n]
      ,[nuvar45n]
      ,[nuvar5n]
      ,[nuvarn]
      ,[aivar2]
      ,[aivar25]
      ,[aivar3]
      ,[aivar35]
      ,[aivar4]
      ,[aivar45]
      ,[aivar5]
      ,[aivar]
      ,[aivar2n]
      ,[aivar25n]
      ,[aivar3n]
      ,[aivar35n]
      ,[aivar4n]
      ,[aivar45n]
      ,[aivar5n]
      ,[aivarn]
      ,[ev]
      ,[ort]
      ,[et]
      ,[mu]
      ,[eos]
      ,[kay]
      ,[kieli1]
      ,[kieli2]
      ,[kieli3]
      ,[kieli4]
      ,[kieli5]
      ,[kieli6]
      ,[kieliy]
      ,[sv]
      ,[rv]
      ,[svrv]
      ,[svnn]
      ,[rvnn]
      ,[svrvn]
      ,[yaenm]
      ,[yyenm]
      ,[yen6m]
      ,[len6m]
      ,[alen6m]
      ,[enmm]
      ,[yaenn]
      ,[yyenn]
      ,[yen6n]
      ,[len6n]
      ,[alen6n]
      ,[ennn]
      ,[yarum]
      ,[yyrum]
      ,[yru6m]
      ,[lru6m]
      ,[alru6m]
      ,[rumm]
      ,[yarun]
      ,[yyrun]
      ,[yru6n]
      ,[lru6n]
      ,[alru6n]
      ,[runn]
      ,[yasum]
      ,[yysum]
      ,[ysu6m]
      ,[lsu6m]
      ,[alsu6m]
      ,[summ]
      ,[yasun]
      ,[yysun]
      ,[ysu6n]
      ,[lsu6n]
      ,[alsu6n]
      ,[sunn]
      ,[yaram]
      ,[yyram]
      ,[yra6m]
      ,[lra6m]
      ,[alra6m]
      ,[ramm]
      ,[yaran]
      ,[yyran]
      ,[yra6n]
      ,[lra6n]
      ,[alra6n]
      ,[rann]
      ,[yasam]
      ,[yysam]
      ,[ysa6m]
      ,[lsa6m]
      ,[alsa6m]
      ,[samm]
      ,[yasan]
      ,[yysan]
      ,[ysa6n]
      ,[lsa6n]
      ,[alsa6n]
      ,[sann]
      ,[yavem]
      ,[yyvem]
      ,[yve6m]
      ,[lve6m]
      ,[alve6m]
      ,[vemm]
      ,[yaven]
      ,[yyven]
      ,[yve6n]
      ,[lve6n]
      ,[alve6n]
      ,[vennn]
      ,[yasaam]
      ,[ysaa6m]
      ,[lsaa6m]
      ,[alsaa6m]
      ,[saamm]
      ,[yasaan]
      ,[ysaa6n]
      ,[lsaa6n]
      ,[alsaa6n]
      ,[saann]
      ,[yalatm]
      ,[ylat6m]
      ,[lla6m]
      ,[alla6m]
      ,[lamm]
      ,[yalan]
      ,[ylat6n]
      ,[lla6n]
      ,[alla6n]
      ,[lann]
      ,[yaesm]
      ,[yes6m]
      ,[les6m]
      ,[ales6m]
      ,[esmm]
      ,[yaesn]
      ,[yes6n]
      ,[les6n]
      ,[ales6n]
      ,[esnn]
      ,[yaitm]
      ,[yit6m]
      ,[lit6m]
      ,[alit6m]
      ,[itmm]
      ,[yaitn]
      ,[yit6n]
      ,[lit6n]
      ,[alit6n]
      ,[itnn]
      ,[yamum]
      ,[yymum]
      ,[ymu6m]
      ,[lmu6m]
      ,[almu6m]
      ,[mumm]
      ,[yamun]
      ,[yymun]
      ,[ymu6n]
      ,[lmu6n]
      ,[almu6n]
      ,[munn]
      ,[yyvam]
      ,[vamm]
      ,[yyvan]
      ,[vann]
      ,[pmatm]
      ,[pmatn]
      ,[pmaty]
      ,[lmatm]
      ,[lmatn]
      ,[lmaty]
      ,[matm]
      ,[matn]
      ,[maty]
      ,[pma1m]
      ,[pma1n]
      ,[pma2m]
      ,[pma2n]
      ,[pma3m]
      ,[pma3n]
      ,[pma45m]
      ,[pma45n]
      ,[pma6m]
      ,[pma6n]
      ,[pma7m]
      ,[pma7n]
      ,[lma1m]
      ,[lma1n]
      ,[lma2m]
      ,[lma2n]
      ,[lma3m]
      ,[lma3n]
      ,[lma45m]
      ,[lma45n]
      ,[lma6m]
      ,[lma6n]
      ,[lma7m]
      ,[lma7n]
      ,[fy1m]
      ,[fy1n]
      ,[fy2m]
      ,[fy2n]
      ,[fy3m]
      ,[fy3n]
      ,[fy45m]
      ,[fy45n]
      ,[fy6m]
      ,[fy6n]
      ,[fy7m]
      ,[fy7n]
      ,[ke1m]
      ,[ke1n]
      ,[ke2m]
      ,[ke2n]
      ,[ke3m]
      ,[ke3n]
      ,[ke45m]
      ,[ke45n]
      ,[ke6m]
      ,[ke6n]
      ,[ke7m]
      ,[ke7n]
      ,[bi1m]
      ,[bi1n]
      ,[bi2m]
      ,[bi2n]
      ,[bi3m]
      ,[bi3n]
      ,[bi45m]
      ,[bi45n]
      ,[bi6m]
      ,[bi6n]
      ,[bi7m]
      ,[bi7n]
      ,[mt1m]
      ,[mt1n]
      ,[mt2m]
      ,[mt2n]
      ,[mt3m]
      ,[mt3n]
      ,[mt45m]
      ,[mt45n]
      ,[mt6m]
      ,[mt6n]
      ,[mt7m]
      ,[mt7n]
      ,[soma2m]
      ,[soma2n]
      ,[soma3m]
      ,[soma3n]
      ,[sofy2m]
      ,[sofy2n]
      ,[sofy3m]
      ,[sofy3n]
      ,[soke2m]
      ,[soke2n]
      ,[soke3m]
      ,[soke3n]
      ,[sobi2m]
      ,[sobi2n]
      ,[sobi3m]
      ,[sobi3n]
      ,[somt2m]
      ,[somt2n]
      ,[somt3m]
      ,[somt3n]
      ,[sotek2m]
      ,[sotek2n]
      ,[sotek3m]
      ,[sotek3n]
      ,[tietolahde]=''2_5_sopv_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv, tunn)
      --,[rivinumero]
  FROM [TK_H9098_CSC].[dbo].[TK_2_5_sopv_16]
  ) Aineistot

' 
GO
/****** Object:  View [dbo].[v_sa_2_6_ammatillisen_koulutuksen_erityisopetuksen_opiskelijat_ja_tutkinnon_suorittaneet]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_2_6_ammatillisen_koulutuksen_erityisopetuksen_opiskelijat_ja_tutkinnon_suorittaneet]'))
EXEC dbo.sp_executesql @statement = N'




CREATE VIEW [dbo].[v_sa_2_6_ammatillisen_koulutuksen_erityisopetuksen_opiskelijat_ja_tutkinnon_suorittaneet] AS
SELECT [tilv] = CAST(tilv as nvarchar(4))
      ,[lahde] = CAST(COALESCE(NULLIF(lahde , ''''), ''-1'') as nvarchar(2))
      ,[perusjoukko] = CAST(COALESCE(NULLIF(perusjoukko, ''''), ''-1'') as nvarchar(2))
      ,[koulk] = CAST(COALESCE(NULLIF(koulk, ''''), ''-1'') as nvarchar(6))
      ,[tutklaja] = CAST(COALESCE(NULLIF(tutklaja , ''''), ''-1'') as nvarchar(2))
      ,[tutktav] = CAST(COALESCE(NULLIF(tutktav , ''''), ''-1'') as nvarchar(2))
      ,[kkieli] = CAST(COALESCE(NULLIF(kkieli , ''''), ''-1'') as nvarchar(2))
      ,[kmaak] = CAST(COALESCE(NULLIF((SELECT [maakunta_koodi_nykytila] FROM [VipunenTK_lisatiedot].[dbo].[alueluokitus_maakunta_korjaus] WHERE [maakunta_koodi] = kmaak), ''''), NULLIF(kmaak , ''''), ''-1'') as nvarchar(2))
      ,[knuts2u] = CAST(COALESCE(NULLIF(knuts2u , ''''), ''-1'') as nvarchar(2))
      ,[kkunryh] = CAST(COALESCE(NULLIF(kkunryh , ''''), ''-1'') as nvarchar(2))
      ,[kely] = CAST(COALESCE(NULLIF(kely , ''''), ''-1'') as nvarchar(2))
      ,[kavi] = CAST(COALESCE(NULLIF(kavi , ''''), ''-1'') as nvarchar(2))
      ,[sp] = CAST(COALESCE(NULLIF(sp , ''''), ''-1'') as nvarchar(2))
      ,[aikielir1] = CAST(COALESCE(NULLIF(aikielir1 , ''''), ''-1'') as nvarchar(2))
      ,[kansalr2] = CAST(COALESCE(NULLIF(kansalr2 , ''''), ''-1'') as nvarchar(2))
      ,[alvv] = CAST(alvv as nvarchar(4))
      ,[allk] = CAST(allk as nvarchar(1))
      ,[olotamm] = CAST(olotamm as nvarchar(1))
      ,[olosyys] = CAST(olosyys as nvarchar(1))
      ,[aiopis] = CAST(COALESCE(NULLIF(aiopis , ''''), ''-1'') as nvarchar(2))
      ,[erper] = CAST(COALESCE(NULLIF(erper , ''''), ''-1'') as nvarchar(2))
      ,[erryh] = CAST(COALESCE(NULLIF(erryh , ''''), ''-1'') as nvarchar(2))
      ,[ammos] = CAST(ammos as int)
      ,[opintokok] = CAST(opintokok as int)
      ,[lkm] = CAST(lkm as int)
	  ,tietolahde
FROM
(SELECT [tilv]
      ,[lahde]
      ,[perusjoukko]
      ,[koulk]
      ,[tutklaja]
      ,[tutktav]
      ,[kkieli]
      ,[kmaak]
      ,[knuts2u]
      ,[kkunryh]
      ,[kely]
      ,[kavi]
      ,[sp]
      ,[aikielir1]
      ,[kansalr2]
      ,[alvv]
      ,[allk]
      ,[olotamm]
      ,[olosyys]
      ,[aiopis]
      ,[erper]
      ,[erryh]
      ,[ammos]
      ,[opintokok]
      ,[lkm]
	  ,tietolahde = ''2_6_sopv_11''
FROM [TK_H9098_CSC].[dbo].[TK_2_6_sopv_11]
UNION ALL
SELECT [tilv]
      ,[lahde]
      ,[perusjoukko]
      ,[koulk]
      ,[tutklaja]
      ,[tutktav]
      ,[kkieli]
      ,[kmaak]
      ,[knuts2u]
      ,[kkunryh]
      ,[kely]
      ,[kavi]
      ,[sp]
      ,[aikielir1]
      ,[kansalr2]
      ,[alvv]
      ,[allk]
      ,[olotamm]
      ,[olosyys]
      ,[aiopis]
      ,[erper]
      ,[erryh]
      ,[ammos]
      ,[opintokok]
      ,[lkm]
	  ,tietolahde = ''2_6_sopv_12''
FROM [TK_H9098_CSC].[dbo].[TK_2_6_sopv_12]
UNION ALL
SELECT [tilv]
      ,[lahde]
      ,[perusjoukko]
      ,[koulk]
      ,[tutklaja]
      ,[tutktav]
      ,[kkieli]
      ,[kmaak]
      ,[knuts2u]
      ,[kkunryh]
      ,[kely]
      ,[kavi]
      ,[sp]
      ,[aikielir1]
      ,[kansalr2]
      ,[alvv]
      ,[allk]
      ,[olotamm]
      ,[olosyys]
      ,[aiopis]
      ,[erper]
      ,[erryh]
      ,[ammos]
      ,[opintokok]
      ,[lkm]
	  ,tietolahde = ''2_6_sopv_13''
FROM [TK_H9098_CSC].[dbo].[TK_2_6_sopv_13]
UNION ALL
SELECT [tilv]
      ,[lahde]
      ,[perusjoukko]
      ,[koulk]
      ,[tutklaja]
      ,[tutktav]
      ,[kkieli]
      ,[kmaak]
      ,[knuts2u]
      ,[kkunryh]
      ,[kely]
      ,[kavi]
      ,[sp]
      ,[aikielir1]
      ,[kansalr2]
      ,[alvv]
      ,[allk]
      ,[olotamm]
      ,[olosyys]
      ,[aiopis]
      ,[erper]
      ,[erryh]
      ,[ammos]
      ,[opintokok]
      ,[lkm]
	  ,tietolahde = ''2_6_sopv_14''
FROM [TK_H9098_CSC].[dbo].[TK_2_6_sopv_14]
UNION ALL
SELECT [tilv]
      ,[lahde]
      ,[perusjoukko]
      ,[koulk]
      ,[tutklaja]
      ,[tutktav]
      ,[kkieli]
      ,[kmaak]
      ,[knuts2u]
      ,[kkunryh]
      ,[kely]
      ,[kavi]
      ,[sp]
      ,[aikielir1]
      ,[kansalr2]
      ,[alvv]
      ,[allk]
      ,[olotamm]
      ,[olosyys]
      ,[aiopis]
      ,[erper]
      ,[erryh]
      ,[ammos]
      ,[opintokok]
      ,[lkm]
	  ,tietolahde = ''2_6_sopv_15''
FROM [TK_H9098_CSC].[dbo].[TK_2_6_sopv_15]
UNION ALL
SELECT [tilv]
      ,[lahde]
      ,[perusjoukko]
      ,[koulk]
      ,[tutklaja]
      ,[tutktav]
      ,[kkieli]
      ,[kmaak]
      ,[knuts2u]
      ,[kkunryh]
      ,[kely]
      ,[kavi]
      ,[sp]
      ,[aikielir1]
      ,[kansalr2]
      ,[alvv]
      ,[allk]
      ,[olotamm]
      ,[olosyys]
      ,[aiopis]
      ,[erper]
      ,[erryh]
      ,[ammos]
      ,[opintokok]
      ,[lkm]
	  ,tietolahde = ''2_6_sopv_16''
FROM [TK_H9098_CSC].[dbo].[TK_2_6_sopv_16]) kaikkivuodet



' 
GO
/****** Object:  View [dbo].[v_sa_2_7_ammatillisen_koulutuksen_erityisopetuksen_opiskelijat_ja_tutkinnon_suorittaneet_jarjestajittain]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_2_7_ammatillisen_koulutuksen_erityisopetuksen_opiskelijat_ja_tutkinnon_suorittaneet_jarjestajittain]'))
EXEC dbo.sp_executesql @statement = N'






CREATE VIEW [dbo].[v_sa_2_7_ammatillisen_koulutuksen_erityisopetuksen_opiskelijat_ja_tutkinnon_suorittaneet_jarjestajittain] AS
SELECT [tilv] = CAST(tilv as nvarchar(4))
      ,[lahde] = CAST(COALESCE(NULLIF(lahde , ''''), ''-1'') as nvarchar(2))
      ,[perusjoukko] = CAST(COALESCE(NULLIF(perusjoukko, ''''), ''-1'') as nvarchar(2))
      ,[tunn] = CAST(COALESCE(NULLIF(tunn, ''''), ''-1'') as nvarchar(5))
      ,[jarj] = CAST(COALESCE(NULLIF(jarj, ''''), ''-1'') as nvarchar(10))
      ,[opjarj] = CAST(COALESCE(NULLIF(opjarj, ''''), ''-1'') as nvarchar(10))
      ,[koulk] = CAST(COALESCE(NULLIF(koulk, ''''), ''-1'') as nvarchar(6))
      ,[tutklaja] = CAST(COALESCE(NULLIF(tutklaja, ''''), ''-1'') as nvarchar(2))
      ,[tutktav] = CAST(COALESCE(NULLIF(tutktav, ''''), ''-1'') as nvarchar(2))
      ,[kkieli] = CAST(COALESCE(NULLIF(kkieli, ''''), ''-1'') as nvarchar(2))
      ,[kmaak] = CAST(COALESCE(NULLIF((SELECT [maakunta_koodi_nykytila] FROM [VipunenTK_lisatiedot].[dbo].[alueluokitus_maakunta_korjaus] WHERE [maakunta_koodi] = kmaak), ''''), NULLIF(kmaak , ''''), ''-1'') as nvarchar(2))
      ,[lkm] = CAST(lkm as int)
      ,[tunn_opisk] = CAST(COALESCE(NULLIF(tunn_opisk, ''''), ''-1'') as nvarchar(5))
      ,[jarj_opisk] = CAST(COALESCE(NULLIF(jarj_opisk, ''''), ''-1'') as nvarchar(10))
      ,[olosyys] = CAST(olosyys as nvarchar(1))
	  ,tietolahde
FROM
(SELECT [tilv]
      ,[lahde]
      ,[perusjoukko]
      ,[tunn]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[tutklaja]
      ,[tutktav]
      ,[kkieli]
      ,[kmaak]
      ,[lkm]
      ,NULL AS [tunn_opisk]
      ,NULL AS [jarj_opisk]
      ,9 AS [olosyys]
      ,[luontipvm]
	  ,tietolahde = ''2_7_sopv_12''
  FROM [TK_H9098_CSC].[dbo].[TK_2_7_sopv_12]
UNION ALL
SELECT [tilv]
      ,[lahde]
      ,[perusjoukko]
      ,[tunn]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[tutklaja]
      ,[tutktav]
      ,[kkieli]
      ,[kmaak]
      ,[lkm]
      ,NULL AS [tunn_opisk]
      ,NULL AS [jarj_opisk]
      ,9 AS [olosyys]
      ,[luontipvm]
	  ,tietolahde = ''2_7_sopv_13''
  FROM [TK_H9098_CSC].[dbo].[TK_2_7_sopv_13]
UNION ALL
SELECT [tilv]
      ,[lahde]
      ,[perusjoukko]
      ,[tunn]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[tutklaja]
      ,[tutktav]
      ,[kkieli]
      ,[kmaak]
      ,[lkm]
      ,NULL AS [tunn_opisk]
      ,NULL AS [jarj_opisk]
      ,9 AS [olosyys]
      ,NULL AS [luontipvm]
	  ,tietolahde = ''2_7_2012_sopv_14''
  FROM [VipunenTK_SA].[dbo].[TK_2_7_2012_sopv_14]
UNION ALL
SELECT [tilv]
      ,[lahde]
      ,[perusjoukko]
      ,[tunn]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[tutklaja]
      ,[tutktav]
      ,[kkieli]
      ,[kmaak]
      ,[lkm]
      ,[tunn_opisk]
      ,[jarj_opisk]
      ,[olosyys]
      ,[luontipvm]
	  ,tietolahde = ''2_7_sopv_14''
  FROM [TK_H9098_CSC].[dbo].[TK_2_7_sopv_14]
UNION ALL
SELECT [tilv]
      ,[lahde]
      ,[perusjoukko]
      ,[tunn]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[tutklaja]
      ,[tutktav]
      ,[kkieli]
      ,[kmaak]
      ,[lkm]
      ,[tunn_opisk]
      ,[jarj_opisk]
      ,[olosyys]
      ,[luontipvm]
	  ,tietolahde = ''2_7_sopv_15''
  FROM [TK_H9098_CSC].[dbo].[TK_2_7_sopv_15]
UNION ALL
SELECT [tilv]
      ,[lahde]
      ,[perusjoukko]
      ,[tunn]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[tutklaja]
      ,[tutktav]
      ,[kkieli]
      ,[kmaak]
      ,[lkm]
      ,[tunn_opisk]
      ,[jarj_opisk]
      ,[olosyys]
      ,[luontipvm]
	  ,tietolahde = ''2_7_sopv_16''
  FROM [TK_H9098_CSC].[dbo].[TK_2_7_sopv_16]) kaikkivuodet





' 
GO
/****** Object:  View [dbo].[v_sa_2_8_Korkeakoulut_opiskelijat]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_2_8_Korkeakoulut_opiskelijat]'))
EXEC dbo.sp_executesql @statement = N'

















CREATE VIEW [dbo].[v_sa_2_8_Korkeakoulut_opiskelijat] AS

-- truncate table vipunentk_dw..sa_2_8_Korkeakoulut_opiskelijat
-- insert into vipunentk_dw..sa_2_8_Korkeakoulut_opiskelijat select * from v_sa_2_8_Korkeakoulut_opiskelijat


select
	tilv = cast(kaikkivuodet.tilv as varchar(4))
	,tilv_date = cast(kaikkivuodet.tilv+''0101'' as date)
	,aineisto = cast(kaikkivuodet.aineisto as varchar(1))
	,lahde = cast(kaikkivuodet.lahde as varchar(2))
	,tunn = cast(kaikkivuodet.tunn as varchar(5))
	,jarj = cast(kaikkivuodet.jarj as varchar(10))
	,koulk = cast(kaikkivuodet.koulk as varchar(6))
	,kkun = cast(kaikkivuodet.kkun as varchar(3))
	,sp = cast(kaikkivuodet.sp as varchar(1))
	,aikielir1x = cast(kaikkivuodet.aikielir1x as varchar(2))
	,syntv = cast(kaikkivuodet.syntv as varchar(4))
	,tilvaskun = cast(kaikkivuodet.tilvaskun as varchar(6))
	,tilvaskunx = cast(kaikkivuodet.tilvaskunx as varchar(3))
	,tilvaskun2x = cast(kaikkivuodet.tilvaskun2x as varchar(3))
	,kansalr2 = cast(kaikkivuodet.kansalr2 as varchar(1))
	,alvv = cast(kaikkivuodet.alvv as varchar(4))
	,allk = cast(kaikkivuodet.allk as varchar(1))
	,olotamm = cast(kaikkivuodet.olotamm as varchar(1))
	,olosyys = cast(kaikkivuodet.olosyys as varchar(1))
	,rahlahde = cast(kaikkivuodet.rahlahde as varchar(1))
	,fte = cast(kaikkivuodet.fte as varchar(1))
	,alvv_kksek = cast(kaikkivuodet.alvv_kksek as varchar(4))
	,alvv_kksek_lasna = cast(kaikkivuodet.alvv_kksek_lasna as varchar(4))
	,alvv_sek = cast(kaikkivuodet.alvv_sek as varchar(4))
	,alvv_sek_lasna = cast(kaikkivuodet.alvv_sek_lasna as varchar(4))
	,alvv_kk = cast(kaikkivuodet.alvv_kk as varchar(4))
	,alvv_kk_lasna = cast(kaikkivuodet.alvv_kk_lasna as varchar(4))
	,alvv_opa = cast(kaikkivuodet.alvv_opa as varchar(4))
	,alvv_opa_lasna = cast(kaikkivuodet.alvv_opa_lasna as varchar(4))
	,lkm = cast(kaikkivuodet.lkm as int)
	,opyht0 = cast(kaikkivuodet.opyht0 as int)
	,opyht14 = cast(kaikkivuodet.opyht14 as int)
	,opyht29 = cast(kaikkivuodet.opyht29 as int)
	,opyht44 = cast(kaikkivuodet.opyht44 as int)
	,opyht59 = cast(kaikkivuodet.opyht59 as int)
	,opyht74 = cast(kaikkivuodet.opyht74 as int)
	,opyht89 = cast(kaikkivuodet.opyht89 as int)
	,opyht104 = cast(kaikkivuodet.opyht104 as int)
	,opyht119 = cast(kaikkivuodet.opyht119 as int)
	,opyht120 = cast(kaikkivuodet.opyht120 as int)
	,op55 = cast(kaikkivuodet.op55 as varchar(1))
	,opes = cast(kaikkivuodet.opes as int)
	,opek = cast(kaikkivuodet.opek as int)
	,opker = cast(kaikkivuodet.opker as int)
	,tutkamk = cast(kaikkivuodet.tutkamk as varchar(3))
	,tunimamk = cast(kaikkivuodet.tunimamk as nvarchar(60))
	,koamk = cast(kaikkivuodet.koamk as varchar(4))
	,konimamk = cast(kaikkivuodet.konimamk as nvarchar(60))
	,suun_v = cast(kaikkivuodet.suun_v as varchar(5))
	,svnim = cast(kaikkivuodet.svnim as nvarchar(40))
	,koultyp = cast(kaikkivuodet.koultyp as varchar(1))
	,kkieli = cast(kaikkivuodet.kkieli as varchar(2))
	,lasnalk = cast(kaikkivuodet.lasnalk as int)
	,poissalk = cast(kaikkivuodet.poissalk as int)
	,oplaaj = cast(kaikkivuodet.oplaaj as int)
	,kirtu1v = cast(kaikkivuodet.kirtu1v as varchar(4))
	,kirtu1k = cast(kaikkivuodet.kirtu1k as varchar(1))
	,ensisop = cast(kaikkivuodet.ensisop as varchar(1))
	,tilmaa = cast(kaikkivuodet.tilmaa as varchar(1))
	,tutkyo = cast(kaikkivuodet.tutkyo as varchar(3))
	,tunimyo = cast(kaikkivuodet.tunimyo as nvarchar(40))
	,koyo = cast(kaikkivuodet.koyo as varchar(4))
	,konimyo = cast(kaikkivuodet.konimyo as nvarchar(50))
	,paine = cast(kaikkivuodet.paine as varchar(4))
	,painenim = cast(kaikkivuodet.painenim as nvarchar(60))
	,kk = cast(kaikkivuodet.kk as varchar(2))
	,tdk = cast(kaikkivuodet.tdk as varchar(2))
	,fuksi = cast(kaikkivuodet.fuksi as varchar(1))
	,opoikv = cast(kaikkivuodet.opoikv as varchar(4))
	,om = cast(kaikkivuodet.om as varchar(1))
	,opkelp = cast(kaikkivuodet.opkelp as varchar(1))
	,avo = cast(kaikkivuodet.avo as varchar(1))
	,tietolahde = cast(kaikkivuodet.tietolahde as nvarchar(250))
	,rivinumero = cast(kaikkivuodet.rivinumero as varchar(10))
FROM (

--Historia-aineisto
SELECT
	tilv
	, aineisto = ''L''
	, lahde =
		case 
			when lahde = 3 then 41
			when lahde = 4 then 51
			else -1
		end
	, tunn
	, jarj = op.koulutuksen_jarjestajakoodi
	, koulk
	, kkun
	, sp
	, aikielir1x = aikielir1
	, syntv = CASE WHEN LTRIM(ika) in (''.'','''') then null else cast(tilv as int)-cast(LTRIM(ika) as int) end
	, tilvaskun = case when asmaak is null or asmaak=99 then null else ''MAAK''+asmaak end
	, tilvaskunx = null
	, tilvaskun2x = null
	, kansalr2
	, alvv
	, allk
	, olotamm
	, olosyys
	, rahlahde = null
	, fte
	, alvv_kksek = null
	, alvv_kksek_lasna = null
	, alvv_sek = null
	, alvv_sek_lasna = null
	, alvv_kk = null
	, alvv_kk_lasna = null
	, alvv_opa = null
	, alvv_opa_lasna = null
	, lkm
	, opyht0 = null
	, opyht14 = null
	, opyht29 = null
	, opyht44 = null
	, opyht59 = null
	, opyht74 = null
	, opyht89 = null
	, opyht104 = null
	, opyht119 = null
	, opyht120 = null
	, null as op55 -- uusi 2012
	, opes
	, opek
	, opker
	, tutkamk = null
	, tunimamk = null
	, koamk = null
	, konimamk = null
	, suun_v = null
	, svnim = null
	, koultyp
	, kkieli = case kkielir1 when ''fs'' then ''fi'' else kkielir1 end
	, lasnalk = null
	, poissalk = null
	, oplaaj = null
	, kirtu1v = null
	, kirtu1k = null
	, ensisop = null
	, tilmaa = null
	, tutkyo = null
	, tunimyo = null
	, koyo = null
	, konimyo = null
	, paine = null
	, painenim = null
	, kk = null
	, tdk = null
	, fuksi = null
	, opoikv = null
	, om = null
	, opkelp = null
	, avo = null
	,[tietolahde]=''8_2_Historia''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_8_2_sopv_16] tk
LEFT JOIN VipunenTK.dbo.d_oppilaitoksen_taustatiedot op on op.oppilaitos_avain=tk.tunn
WHERE lahde in (3,4) and tilv<2010

UNION ALL

SELECT
	tilv
	, aineisto
	, lahde
	, tunn
	, jarj
	, koulk
	, kkun
	, sp
	, aikielir1x
	, syntv
	, tilvaskun
	, tilvaskunx
	, tilvaskun2x
	, kansalr2
	, alvv
	, allk
	, olotamm
	, olosyys
	, rahlahde
	, fte
	, alvv_kksek
	, alvv_kksek_lasna
	, alvv_sek
	, alvv_sek_lasna
	, alvv_kk
	, alvv_kk_lasna
	, alvv_opa
	, alvv_opa_lasna
	, lkm
	, opyht0
	, opyht14
	, opyht29
	, opyht44
	, opyht59
	, opyht74
	, opyht89
	, opyht104
	, opyht119
	, opyht120
	, null as op55 -- uusi 2012
	, opes
	, opek
	, opker
	, tutkamk
	, tunimamk
	, koamk
	, konimamk
	, suun_v
	, svnim
	, koultyp
	, kkieli
	, lasnalk
	, poissalk
	, oplaaj
	, kirtu1v
	, kirtu1k
	, ensisop
	, tilmaa
	, tutkyo
	, tunimyo
	, koyo
	, konimyo
	, paine
	, painenim
	, kk
	, tdk
	, fuksi
	, opoikv
	, om
	, opkelp
	, avo
	,[tietolahde]=''2_8a_sopv_11''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_2_8a_sopv_11]
UNION ALL
SELECT
	tilv
	, aineisto
	, lahde
	, tunn
	, jarj
	, koulk
	, kkun
	, sp
	, aikielir1x
	, syntv
	, tilvaskun
	, tilvaskunx
	, tilvaskun2x
	, kansalr2
	, alvv
	, allk
	, olotamm
	, olosyys
	, rahlahde
	, fte
	, alvv_kksek
	, alvv_kksek_lasna
	, alvv_sek
	, alvv_sek_lasna
	, alvv_kk
	, alvv_kk_lasna
	, alvv_opa
	, alvv_opa_lasna
	, lkm
	, opyht0
	, opyht14
	, opyht29
	, opyht44
	, opyht59
	, opyht74
	, opyht89
	, opyht104
	, opyht119
	, opyht120
	, null as op55 -- uusi 2012
	, opes
	, opek
	, opker
	, tutkamk
	, tunimamk
	, koamk
	, konimamk
	, suun_v
	, svnim
	, koultyp
	, kkieli
	, lasnalk
	, poissalk
	, oplaaj
	, kirtu1v
	, kirtu1k
	, ensisop
	, tilmaa
	, tutkyo
	, tunimyo
	, koyo
	, konimyo
	, paine
	, painenim
	, kk
	, tdk
	, fuksi
	, opoikv
	, om
	, opkelp
	, avo
	,[tietolahde]=''2_8b_sopv_11''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_2_8b_sopv_11]
UNION ALL
SELECT
	tilv
	, aineisto
	, lahde
	, tunn
	, jarj
	, koulk
	, kkun
	, sp
	, aikielir1x
	, syntv
	, tilvaskun
	, tilvaskunx
	, tilvaskun2x
	, kansalr2
	, alvv
	, allk
	, olotamm
	, olosyys
	, rahlahde
	, fte
	, alvv_kksek
	, alvv_kksek_lasna
	, alvv_sek
	, alvv_sek_lasna
	, alvv_kk
	, alvv_kk_lasna
	, alvv_opa
	, alvv_opa_lasna
	, lkm
	, opyht0
	, opyht14
	, opyht29
	, opyht44
	, opyht59
	, opyht74
	, opyht89
	, opyht104
	, opyht119
	, opyht120
	, null as op55 -- uusi 2012
	, opes
	, opek
	, opker
	, tutkamk
	, tunimamk
	, koamk
	, konimamk
	, suun_v
	, svnim
	, koultyp
	, kkieli
	, lasnalk
	, poissalk
	, oplaaj
	, kirtu1v
	, kirtu1k
	, ensisop
	, tilmaa
	, tutkyo
	, tunimyo
	, koyo
	, konimyo
	, paine
	, painenim
	, kk
	, tdk
	, fuksi
	, opoikv
	, om
	, opkelp
	, avo
	,[tietolahde]=''2_8c_sopv_11''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_2_8c_sopv_11]
/* 2.8d v2011? */
/* 2.8a v2012? */
UNION ALL
SELECT
	tilv
	, aineisto
	, lahde
	, tunn
	, jarj
	, koulk
	, kkun
	, sp
	, aikielir1x
	, syntv
	, tilvaskun
	, tilvaskunx
	, tilvaskun2x
	, kansalr2
	, alvv
	, allk
	, olotamm
	, olosyys
	, rahlahde
	, fte
	, alvv_kksek
	, alvv_kksek_lasna
	, alvv_sek
	, alvv_sek_lasna
	, alvv_kk
	, alvv_kk_lasna
	, alvv_opa
	, alvv_opa_lasna
	, lkm
	, opyht0
	, opyht14
	, opyht29
	, opyht44
	, opyht59
	, opyht74
	, opyht89
	, opyht104
	, opyht119
	, opyht120
	, op55 -- uusi 2012
	, opes
	, opek
	, opker
	, tutkamk
	, tunimamk
	, koamk
	, konimamk
	, suun_v
	, svnim
	, koultyp
	, kkieli
	, lasnalk
	, poissalk
	, oplaaj
	, kirtu1v
	, kirtu1k
	, ensisop
	, tilmaa
	, tutkyo
	, tunimyo
	, koyo
	, konimyo
	, paine
	, painenim
	, kk
	, tdk
	, fuksi
	, opoikv
	, om
	, opkelp
	, avo
	,[tietolahde]=''2_8b_sopv_12''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_2_8b_sopv_12]
UNION ALL
SELECT
	tilv
	, aineisto
	, lahde
	, tunn
	, jarj
	, koulk
	, kkun
	, sp
	, aikielir1x
	, syntv
	, tilvaskun
	, tilvaskunx
	, tilvaskun2x
	, kansalr2
	, alvv
	, allk
	, olotamm
	, olosyys
	, rahlahde
	, fte
	, alvv_kksek
	, alvv_kksek_lasna
	, alvv_sek
	, alvv_sek_lasna
	, alvv_kk
	, alvv_kk_lasna
	, alvv_opa
	, alvv_opa_lasna
	, lkm
	, opyht0
	, opyht14
	, opyht29
	, opyht44
	, opyht59
	, opyht74
	, opyht89
	, opyht104
	, opyht119
	, opyht120
	, op55 -- uusi 2012
	, opes
	, opek
	, opker
	, tutkamk
	, tunimamk
	, koamk
	, konimamk
	, suun_v
	, svnim
	, koultyp
	, kkieli
	, lasnalk
	, poissalk
	, oplaaj
	, kirtu1v
	, kirtu1k
	, ensisop
	, tilmaa
	, tutkyo
	, tunimyo
	, koyo
	, konimyo
	, paine
	, painenim
	, kk
	, tdk
	, fuksi
	, opoikv
	, om
	, opkelp
	, avo
	,[tietolahde]=''2_8c_sopv_12''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_2_8c_sopv_12]
UNION ALL
SELECT
	tilv
	, aineisto
	, lahde
	, tunn
	, jarj
	, koulk
	, kkun
	, sp
	, aikielir1x
	, syntv
	, tilvaskun
	, tilvaskunx
	, tilvaskun2x
	, kansalr2
	, alvv
	, allk
	, olotamm
	, olosyys
	, rahlahde
	, fte
	, alvv_kksek
	, alvv_kksek_lasna
	, alvv_sek
	, alvv_sek_lasna
	, alvv_kk
	, alvv_kk_lasna
	, alvv_opa
	, alvv_opa_lasna
	, lkm
	, opyht0
	, opyht14
	, opyht29
	, opyht44
	, opyht59
	, opyht74
	, opyht89
	, opyht104
	, opyht119
	, opyht120
	, op55 -- uusi 2012
	, opes
	, opek
	, opker
	, tutkamk
	, tunimamk
	, koamk
	, konimamk
	, suun_v
	, svnim
	, koultyp
	, kkieli
	, lasnalk
	, poissalk
	, oplaaj
	, kirtu1v
	, kirtu1k
	, ensisop
	, tilmaa
	, tutkyo
	, tunimyo
	, koyo
	, konimyo
	, paine
	, painenim
	, kk
	, tdk
	, fuksi
	, opoikv
	, om
	, opkelp
	, avo
	,[tietolahde]=''2_8d_sopv_12''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_2_8d_sopv_12]
/* 2.8a v2013? */
UNION ALL
SELECT
	tilv
	, aineisto
	, lahde
	, tunn
	, jarj
	, koulk
	, kkun
	, sp
	, aikielir1x
	, syntv
	, tilvaskun
	, tilvaskunx
	, tilvaskun2x
	, kansalr2
	, alvv
	, allk
	, olotamm
	, olosyys
	, rahlahde
	, fte
	, alvv_kksek
	, alvv_kksek_lasna
	, alvv_sek
	, alvv_sek_lasna
	, alvv_kk
	, alvv_kk_lasna
	, alvv_opa
	, alvv_opa_lasna
	, lkm
	, opyht0
	, opyht14
	, opyht29
	, opyht44
	, opyht59
	, opyht74
	, opyht89
	, opyht104
	, opyht119
	, opyht120
	, op55
	, opes
	, opek
	, opker
	, tutkamk
	, tunimamk
	, koamk
	, konimamk
	, suun_v
	, svnim
	, koultyp
	, kkieli
	, lasnalk
	, poissalk
	, oplaaj
	, kirtu1v
	, kirtu1k
	, ensisop
	, tilmaa
	, tutkyo
	, tunimyo
	, koyo
	, konimyo
	, paine
	, painenim
	, kk
	, tdk
	, fuksi
	, opoikv
	, om
	, opkelp
	, avo
	,[tietolahde]=''2_8b_sopv_13''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_2_8b_sopv_13]
UNION ALL
SELECT
	tilv
	, aineisto
	, lahde
	, tunn
	, jarj
	, koulk
	, kkun
	, sp
	, aikielir1x
	, syntv
	, tilvaskun
	, tilvaskunx
	, tilvaskun2x
	, kansalr2
	, alvv
	, allk
	, olotamm
	, olosyys
	, rahlahde
	, fte
	, alvv_kksek
	, alvv_kksek_lasna
	, alvv_sek
	, alvv_sek_lasna
	, alvv_kk
	, alvv_kk_lasna
	, alvv_opa
	, alvv_opa_lasna
	, lkm
	, opyht0
	, opyht14
	, opyht29
	, opyht44
	, opyht59
	, opyht74
	, opyht89
	, opyht104
	, opyht119
	, opyht120
	, op55
	, opes
	, opek
	, opker
	, tutkamk
	, tunimamk
	, koamk
	, konimamk
	, suun_v
	, svnim
	, koultyp
	, kkieli
	, lasnalk
	, poissalk
	, oplaaj
	, kirtu1v
	, kirtu1k
	, ensisop
	, tilmaa
	, tutkyo
	, tunimyo
	, koyo
	, konimyo
	, paine
	, painenim
	, kk
	, tdk
	, fuksi
	, opoikv
	, om
	, opkelp
	, avo
	,[tietolahde]=''2_8c_sopv_13''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_2_8c_sopv_13]
/* 2.8d v2013? */

UNION ALL
SELECT
	tilv
	, aineisto
	, lahde
	, tunn
	, jarj
	, koulk
	, kkun
	, sp
	, aikielir1x
	, syntv
	, tilvaskun
	, tilvaskunx
	, tilvaskun2x
	, kansalr2
	, alvv
	, allk
	, olotamm
	, olosyys
	, rahlahde
	, fte
	, alvv_kksek
	, alvv_kksek_lasna
	, alvv_sek
	, alvv_sek_lasna
	, alvv_kk
	, alvv_kk_lasna
	, alvv_opa
	, alvv_opa_lasna
	, lkm
	, opyht0
	, opyht14
	, opyht29
	, opyht44
	, opyht59
	, opyht74
	, opyht89
	, opyht104
	, opyht119
	, opyht120
	, op55
	, opes
	, opek
	, opker
	, tutkamk
	, tunimamk
	, koamk
	, konimamk
	, suun_v
	, svnim
	, koultyp
	, kkieli
	, lasnalk
	, poissalk
	, oplaaj
	, kirtu1v
	, kirtu1k
	, ensisop
	, tilmaa
	, tutkyo
	, tunimyo
	, koyo
	, konimyo
	, paine
	, painenim
	, kk
	, tdk
	, fuksi
	, opoikv
	, om
	, opkelp
	, avo
	,[tietolahde]=''2_8d_sopv_13''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_2_8d_sopv_13]

UNION ALL
SELECT
	tilv
	, aineisto
	, lahde
	, tunn
	, jarj
	, koulk
	, kkun
	, sp
	, aikielir1x
	, syntv
	, tilvaskun
	, tilvaskunx
	, tilvaskun2x
	, kansalr2
	, alvv
	, allk
	, olotamm
	, olosyys
	, rahlahde
	, fte
	, alvv_kksek
	, alvv_kksek_lasna
	, alvv_sek
	, alvv_sek_lasna
	, alvv_kk
	, alvv_kk_lasna
	, alvv_opa
	, alvv_opa_lasna
	, lkm
	, opyht0
	, opyht14
	, opyht29
	, opyht44
	, opyht59
	, opyht74
	, opyht89
	, opyht104
	, opyht119
	, opyht120
	, op55
	, opes
	, opek
	, opker
	, tutkamk
	, tunimamk
	, koamk
	, konimamk
	, suun_v
	, svnim
	, koultyp
	, kkieli
	, lasnalk
	, poissalk
	, oplaaj
	, kirtu1v
	, kirtu1k
	, ensisop
	, tilmaa
	, tutkyo
	, tunimyo
	, koyo
	, konimyo
	, paine
	, painenim
	, kk
	, tdk
	, fuksi
	, opoikv
	, om
	, opkelp
	, avo
	,[tietolahde]=''2_8b_sopv_14''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_2_8b_sopv_14]

UNION ALL
SELECT
	tilv
	, aineisto
	, lahde
	, tunn
	, jarj
	, koulk
	, kkun
	, sp
	, aikielir1x
	, syntv
	, tilvaskun
	, tilvaskunx
	, tilvaskun2x
	, kansalr2
	, alvv
	, allk
	, olotamm
	, olosyys
	, rahlahde
	, fte
	, alvv_kksek
	, alvv_kksek_lasna
	, alvv_sek
	, alvv_sek_lasna
	, alvv_kk
	, alvv_kk_lasna
	, alvv_opa
	, alvv_opa_lasna
	, lkm
	, opyht0
	, opyht14
	, opyht29
	, opyht44
	, opyht59
	, opyht74
	, opyht89
	, opyht104
	, opyht119
	, opyht120
	, op55
	, opes
	, opek
	, opker
	, tutkamk
	, tunimamk
	, koamk
	, konimamk
	, suun_v
	, svnim
	, koultyp
	, kkieli
	, lasnalk
	, poissalk
	, oplaaj
	, kirtu1v
	, kirtu1k
	, ensisop
	, tilmaa
	, tutkyo
	, tunimyo
	, koyo
	, konimyo
	, paine
	, painenim
	, kk
	, tdk
	, fuksi
	, opoikv
	, om
	, opkelp
	, avo
	,[tietolahde]=''2_8d_sopv_14''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_2_8d_sopv_14]


UNION ALL
SELECT
	tilv
	, aineisto
	, lahde
	, tunn
	, jarj
	, koulk
	, kkun
	, sp
	, aikielir1x
	, syntv
	, tilvaskun
	, tilvaskunx
	, tilvaskun2x
	, kansalr2
	, alvv
	, allk
	, olotamm
	, olosyys
	, rahlahde
	, fte
	, alvv_kksek
	, alvv_kksek_lasna
	, alvv_sek
	, alvv_sek_lasna
	, alvv_kk
	, alvv_kk_lasna
	, alvv_opa
	, alvv_opa_lasna
	, lkm
	, opyht0
	, opyht14
	, opyht29
	, opyht44
	, opyht59
	, opyht74
	, opyht89
	, opyht104
	, opyht119
	, opyht120
	, op55
	, opes
	, opek
	, opker
	, tutkamk
	, tunimamk
	, koamk
	, konimamk
	, suun_v
	, svnim
	, koultyp
	, kkieli
	, lasnalk
	, poissalk
	, oplaaj
	, kirtu1v
	, kirtu1k
	, ensisop
	, tilmaa
	, tutkyo
	, tunimyo
	, koyo
	, konimyo
	, paine
	, painenim
	, kk
	, tdk
	, fuksi
	, opoikv
	, om
	, opkelp
	, avo
	,[tietolahde]=''2_8b_sopv_15''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM TK_H9098_CSC.[dbo].[TK_2_8b_sopv_15]

UNION ALL

SELECT
	tilv
	, aineisto
	, lahde
	, tunn
	, jarj
	, koulk
	, kkun
	, sp
	, aikielir1x
	, syntv
	, tilvaskun
	, tilvaskunx
	, tilvaskun2x
	, kansalr2
	, alvv
	, allk
	, olotamm
	, olosyys
	, rahlahde
	, fte
	, alvv_kksek
	, alvv_kksek_lasna
	, alvv_sek
	, alvv_sek_lasna
	, alvv_kk
	, alvv_kk_lasna
	, alvv_opa
	, alvv_opa_lasna
	, lkm
	, opyht0
	, opyht14
	, opyht29
	, opyht44
	, opyht59
	, opyht74
	, opyht89
	, opyht104
	, opyht119
	, opyht120
	, op55
	, opes
	, opek
	, opker
	, tutkamk
	, tunimamk
	, koamk
	, konimamk
	, suun_v
	, svnim
	, koultyp
	, kkieli
	, lasnalk
	, poissalk
	, oplaaj
	, kirtu1v
	, kirtu1k
	, ensisop
	, NULL AS tilmaa
	, tutkyo
	, tunimyo
	, koyo
	, konimyo
	, paine
	, painenim
	, kk
	, tdk
	, fuksi
	, opoikv
	, om
	, opkelp
	, avo
	,[tietolahde]=''2_8b_sopv_16''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM TK_H9098_CSC.[dbo].[TK_2_8b_sopv_16]

UNION ALL

SELECT
	tilv
	, aineisto
	, lahde
	, tunn
	, jarj
	, koulk
	, kkun
	, sp
	, aikielir1x
	, syntv
	, tilvaskun
	, tilvaskunx
	, tilvaskun2x
	, kansalr2
	, alvv
	, allk
	, olotamm
	, olosyys
	, rahlahde
	, fte
	, alvv_kksek
	, alvv_kksek_lasna
	, alvv_sek
	, alvv_sek_lasna
	, alvv_kk
	, alvv_kk_lasna
	, alvv_opa
	, alvv_opa_lasna
	, lkm
	, opyht0
	, opyht14
	, opyht29
	, opyht44
	, opyht59
	, opyht74
	, opyht89
	, opyht104
	, opyht119
	, opyht120
	, op55
	, opes
	, opek
	, opker
	, tutkamk = null
	, tunimamk = null
	, koamk = null
	, konimamk = null
	, suun_v = null
	, svnim = null
	, koultyp
	, kkieli
	, lasnalk
	, poissalk
	, oplaaj
	, kirtu1v
	, kirtu1k
	, ensisop
	, NULL AS tilmaa
	, tutkyo = null
	, tunimyo = null
	, koyo = null
	, konimyo = null
	, paine = null
	, painenim = null
	, kk
	, tdk = null
	, fuksi
	, opoikv
	, om
	, opkelp
	, avo
	,[tietolahde]=''virta_csv''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM VipunenTK_SA.[dbo].[tkOPISK2016OKMEnnakko_AMK]

UNION ALL

SELECT
	tilv
	, aineisto
	, lahde
	, tunn
	, jarj
	, koulk
	, kkun
	, sp
	, aikielir1x
	, syntv
	, tilvaskun
	, tilvaskunx
	, tilvaskun2x
	, kansalr2
	, alvv
	, allk
	, olotamm
	, olosyys
	, rahlahde
	, fte
	, alvv_kksek
	, alvv_kksek_lasna
	, alvv_sek
	, alvv_sek_lasna
	, alvv_kk
	, alvv_kk_lasna
	, alvv_opa
	, alvv_opa_lasna
	, lkm
	, opyht0
	, opyht14
	, opyht29
	, opyht44
	, opyht59
	, opyht74
	, opyht89
	, opyht104
	, opyht119
	, opyht120
	, op55
	, opes
	, opek
	, opker
	, tutkamk = null 
	, tunimamk = null 
	, koamk = null 
	, konimamk = null 
	, suun_v = null 
	, svnim = null
	, koultyp
	, kkieli
	, lasnalk
	, poissalk
	, oplaaj
	, kirtu1v
	, kirtu1k
	, ensisop
	, NULL AS tilmaa
	, tutkyo = null 
	, tunimyo = null 
	, koyo = null 
	, konimyo = null 
	, paine = null
	, painenim = null 
	, kk
	, tdk = null
	, fuksi
	, opoikv
	, om
	, opkelp
	, avo
	,[tietolahde]=''virta_csv''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM VipunenTK_SA.[dbo].[tkOPISK2016OKMEnnakko_YO]

) kaikkivuodet


















' 
GO
/****** Object:  View [dbo].[v_sa_2_9_Korkeakoulut_tutkinnot]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_2_9_Korkeakoulut_tutkinnot]'))
EXEC dbo.sp_executesql @statement = N'




















CREATE VIEW [dbo].[v_sa_2_9_Korkeakoulut_tutkinnot] AS

-- truncate table vipunentk_dw sa_2_9_Korkeakoulut_tutkinnot
-- insert into vipunentk_dw sa_2_9_Korkeakoulut_tutkinnot select * from v_sa_2_9_Korkeakoulut_tutkinnot


SELECT
	 tilv = cast(kaikkivuodet.tilv as varchar(4))
	,tilv_date = cast(kaikkivuodet.tilv+''0101'' as date)
	,aineisto = cast(kaikkivuodet.aineisto as varchar(1))
	,lahde = cast(kaikkivuodet.lahde as varchar(2))
	,tunn = cast(kaikkivuodet.tunn as varchar(5))
	,jarj = cast(kaikkivuodet.jarj as varchar(10))
	,koulk = cast(kaikkivuodet.koulk as varchar(6))
	,opm95opa = cast(kaikkivuodet.opm95opa as varchar(2))
	,kkun = cast(kaikkivuodet.kkun as varchar(3))
	,sp = cast(kaikkivuodet.sp as varchar(1))
	,aikielir1x = cast(kaikkivuodet.aikielir1x as varchar(2))
	,syntv = cast(coalesce(nullif(kaikkivuodet.syntv,''''),''9999'') as varchar(4))
	,tilvaskun = cast(kaikkivuodet.tilvaskun as varchar(3))
	,tilvaskunx = cast(kaikkivuodet.tilvaskunx as varchar(3))
	,kansalr2 = cast(kaikkivuodet.kansalr2 as varchar(1))
	,alvv = cast(kaikkivuodet.alvv as varchar(4))
	,allk = cast(kaikkivuodet.allk as varchar(1))
	,suorv = cast(kaikkivuodet.suorv as varchar(4))
	,suorlk = cast(kaikkivuodet.suorlk as varchar(1))
	,rahlahde = cast(kaikkivuodet.rahlahde as varchar(1))
	,alvv_kksek = cast(kaikkivuodet.alvv_kksek as varchar(4))
	,alvv_kksek_lasna = cast(kaikkivuodet.alvv_kksek_lasna as varchar(4))
	,alvv_sek = cast(kaikkivuodet.alvv_sek as varchar(4))
	,alvv_sek_lasna = cast(kaikkivuodet.alvv_sek_lasna as varchar(4))
	,alvv_kk = cast(kaikkivuodet.alvv_kk as varchar(4))
	,alvv_kk_lasna = cast(kaikkivuodet.alvv_kk_lasna as varchar(4))
	,alvv_opa = cast(kaikkivuodet.alvv_opa as varchar(4))
	,alvv_opa_lasna = cast(kaikkivuodet.alvv_opa_lasna as varchar(4))
	,lkm = cast(kaikkivuodet.lkm as int)
	,tutkamk = cast(kaikkivuodet.tutkamk as varchar(3))
	,tunimamk = cast(kaikkivuodet.tunimamk as varchar(60))
	,koamk = cast(kaikkivuodet.koamk as varchar(4))
	,konimamk = cast(kaikkivuodet.konimamk as varchar(60))
	,suun_v = cast(kaikkivuodet.suun_v as varchar(5))
	,svnim = cast(kaikkivuodet.svnim as varchar(60))
	,koultyp = cast(kaikkivuodet.koultyp as varchar(1))
	,kkieli = cast(kaikkivuodet.kkieli as varchar(2))
	,lasnalk = cast(kaikkivuodet.lasnalk as int)
	,poissalk = cast(kaikkivuodet.poissalk as int)
	,oplaaj = cast(kaikkivuodet.oplaaj as int)
	,kirtu1v = cast(kaikkivuodet.kirtu1v as varchar(4))
	,kirtu1k = cast(kaikkivuodet.kirtu1k as varchar(1))
	,opyhtamk = cast(kaikkivuodet.opyhtamk as int)
	,opylamamk = cast(kaikkivuodet.opylamamk as int)
	,opmuuamk = cast(kaikkivuodet.opmuuamk as int)
	,opoamk = cast(kaikkivuodet.opoamk as int)
	,opmamk = cast(kaikkivuodet.opmamk as int)
	,opyliopamk = cast(kaikkivuodet.opyliopamk as int)
	,opulkomamk = cast(kaikkivuodet.opulkomamk as int)
	,tilmaa = cast(kaikkivuodet.tilmaa as varchar(1))
	,tutkyo = cast(kaikkivuodet.tutkyo as varchar(3))
	,tunimyo = cast(kaikkivuodet.tunimyo as varchar(60))
	,koyo = cast(kaikkivuodet.koyo as varchar(4))
	,konim = cast(kaikkivuodet.konimyo as varchar(60))
	,paine = cast(kaikkivuodet.paine as varchar(4))
	,painenim = cast(kaikkivuodet.painenim as varchar(60))
	,tdk = cast(kaikkivuodet.tdk as varchar(2))
	,om = cast(kaikkivuodet.om as varchar(1))
	,opkelp = cast(kaikkivuodet.opkelp as varchar(1))
	,opyhtyo = cast(kaikkivuodet.opyhtyo as int)
	,opulkyo = cast(kaikkivuodet.opulkyo as int)
	,opmuuyo = cast(kaikkivuodet.opmuuyo as int)
	,opoylio = cast(kaikkivuodet.opoylio as int)
	,opaylio = cast(kaikkivuodet.opaylio as int)
	,opmylio = cast(kaikkivuodet.opmylio as int)
	,opamkyo = cast(kaikkivuodet.opamkyo as int)
	,ltop = cast(kaikkivuodet.opamkyo as int)
	,tietolahde = cast(kaikkivuodet.tietolahde as nvarchar(50))
	,rivinumero = cast(kaikkivuodet.rivinumero as int)
FROM (

--Historia-aineisto
	SELECT
	 tilv = left(suoraika,4)
	,aineisto = ''L''
	,lahde =
	case 
			when lahde = 3 then 42
			when lahde = 4 then 52
			else -1
		end
	,tunn = oltunnus
	,jarj = op.koulutuksen_jarjestajakoodi
	,koulk
	,opm95opa = null
	,kkun
	,sp
	,aikielir1x = aikielir1
	,syntv = case syntv when ''19XX'' then null else syntv end
	,tilvaskun = askun
	,tilvaskunx = null
	,kansalr2
	,alvv = case alvv when ''BBBB'' then null else alvv end
	,allk
	,suorv = left(suoraika,4)
	,suorlk = null
	,rahlahde = null
	,alvv_kksek = null
	,alvv_kksek_lasna = null
	,alvv_sek = null
	,alvv_sek_lasna = null
	,alvv_kk = null
	,alvv_kk_lasna = null
	,alvv_opa = null
	,alvv_opa_lasna = null
	,lkm
	,tutkamk = null
	,tunimamk = null
	,koamk = null
	,konimamk = null
	,suun_v = null
	,svnim = null
	,koultyp = null
	,kkieli = case kkielir1 when ''fs'' then ''fi'' else kkielir1 end
	,lasnalk = null
	,poissalk = null
	,oplaaj = null
	,kirtu1v = null
	,kirtu1k = null
	,opyhtamk = null
	,opylamamk = null
	,opmuuamk = null
	,opoamk = null
	,opmamk = null
	,opyliopamk = null
	,opulkomamk = null
	,tilmaa = null
	,tutkyo = null
	,tunimyo = null
	,koyo = null
	,konimyo = null
	,paine = null
	,painenim = null
	,tdk = null
	,om = null
	,opkelp = null
	,opyhtyo = null
	,opulkyo = null
	,opmuuyo = null
	,opoylio = null
	,opaylio = null
	,opmylio = null
	,opamkyo = null
	,ltop = NULL
	,[tietolahde]=''8_1_historia''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_8_1_sopv_16] tk
LEFT JOIN VipunenTK.dbo.d_oppilaitoksen_taustatiedot op on op.oppilaitos_avain=tk.oltunnus
where lahde in (3,4) and left(suoraika,4)<2010

UNION ALL

SELECT
	 tilv
	,aineisto
	,lahde
	,tunn
	,jarj
	,koulk
	,opm95opa
	,kkun
	,sp
	,aikielir1x
	,syntv
	,tilvaskun
	,tilvaskunx
	,kansalr2
	,alvv
	,allk
	,suorv
	,suorlk
	,rahlahde
	,alvv_kksek
	,alvv_kksek_lasna
	,alvv_sek
	,alvv_sek_lasna
	,alvv_kk
	,alvv_kk_lasna
	,alvv_opa
	,alvv_opa_lasna
	,lkm
	,tutkamk
	,tunimamk
	,koamk
	,konimamk
	,suun_v
	,svnim
	,koultyp
	,kkieli
	,lasnalk
	,poissalk
	,oplaaj
	,kirtu1v
	,kirtu1k
	,opyhtamk
	,opylamamk
	,opmuuamk
	,opoamk
	,opmamk
	,opyliopamk
	,opulkomamk
	,tilmaa
	,tutkyo
	,tunimyo
	,koyo
	,konimyo
	,paine
	,painenim
	,tdk
	,om
	,opkelp
	,opyhtyo
	,opulkyo
	,opmuuyo
	,opoylio
	,opaylio
	,opmylio
	,opamkyo
	,ltop = NULL
	,[tietolahde]=''2_9a_sopv_11''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_2_9a_sopv_11]
UNION ALL SELECT
	 tilv
	,aineisto
	,lahde
	,tunn
	,jarj
	,koulk
	,opm95opa
	,kkun
	,sp
	,aikielir1x
	,syntv
	,tilvaskun
	,tilvaskunx
	,kansalr2
	,alvv
	,allk
	,suorv
	,suorlk
	,rahlahde
	,alvv_kksek
	,alvv_kksek_lasna
	,alvv_sek
	,alvv_sek_lasna
	,alvv_kk
	,alvv_kk_lasna
	,alvv_opa
	,alvv_opa_lasna
	,lkm
	,tutkamk
	,tunimamk
	,koamk
	,konimamk
	,suun_v
	,svnim
	,koultyp
	,kkieli
	,lasnalk
	,poissalk
	,oplaaj
	,kirtu1v
	,kirtu1k
	,opyhtamk
	,opylamamk
	,opmuuamk
	,opoamk
	,opmamk
	,opyliopamk
	,opulkomamk
	,tilmaa
	,tutkyo
	,tunimyo
	,koyo
	,konimyo
	,paine
	,painenim
	,tdk
	,om
	,opkelp
	,opyhtyo
	,opulkyo
	,opmuuyo
	,opoylio
	,opaylio
	,opmylio
	,opamkyo
	,ltop = NULL
	,[tietolahde]=''2_9b_sopv_11''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_2_9b_sopv_11]
UNION ALL SELECT
	 tilv
	,aineisto
	,lahde
	,tunn
	,jarj
	,koulk
	,opm95opa
	,kkun
	,sp
	,aikielir1x
	,syntv
	,tilvaskun
	,tilvaskunx
	,kansalr2
	,alvv
	,allk
	,suorv
	,suorlk
	,rahlahde
	,alvv_kksek
	,alvv_kksek_lasna
	,alvv_sek
	,alvv_sek_lasna
	,alvv_kk
	,alvv_kk_lasna
	,alvv_opa
	,alvv_opa_lasna
	,lkm
	,tutkamk
	,tunimamk
	,koamk
	,konimamk
	,suun_v
	,svnim
	,koultyp
	,kkieli
	,lasnalk
	,poissalk
	,oplaaj
	,kirtu1v
	,kirtu1k
	,opyhtamk
	,opylamamk
	,opmuuamk
	,opoamk
	,opmamk
	,opyliopamk
	,opulkomamk
	,tilmaa
	,tutkyo
	,tunimyo
	,koyo
	,konimyo
	,paine
	,painenim
	,tdk
	,om
	,opkelp
	,opyhtyo
	,opulkyo
	,opmuuyo
	,opoylio
	,opaylio
	,opmylio
	,opamkyo
	,ltop = NULL
	,[tietolahde]=''2_9c_sopv_11''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_2_9c_sopv_11]
UNION ALL SELECT
	 tilv
	,aineisto
	,lahde
	,tunn
	,jarj
	,koulk
	,opm95opa
	,kkun
	,sp
	,aikielir1x
	,syntv
	,tilvaskun
	,tilvaskunx
	,kansalr2
	,alvv
	,allk
	,suorv
	,suorlk
	,rahlahde
	,alvv_kksek
	,alvv_kksek_lasna
	,alvv_sek
	,alvv_sek_lasna
	,alvv_kk
	,alvv_kk_lasna
	,alvv_opa
	,alvv_opa_lasna
	,lkm
	,tutkamk
	,tunimamk
	,koamk
	,konimamk
	,suun_v
	,svnim
	,koultyp
	,kkieli
	,lasnalk
	,poissalk
	,oplaaj
	,kirtu1v
	,kirtu1k
	,opyhtamk
	,opylamamk
	,opmuuamk
	,opoamk
	,opmamk
	,opyliopamk
	,opulkomamk
	,tilmaa
	,tutkyo
	,tunimyo
	,koyo
	,konimyo
	,paine
	,painenim
	,tdk
	,om
	,opkelp
	,opyhtyo
	,opulkyo
	,opmuuyo
	,opoylio
	,opaylio
	,opmylio
	,opamkyo
	,ltop = NULL
	,[tietolahde]=''2_9a_sopv_12''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_2_9a_sopv_12]
UNION ALL SELECT
	 tilv
	,aineisto
	,lahde
	,tunn
	,jarj
	,koulk
	,opm95opa
	,kkun
	,sp
	,aikielir1x
	,syntv
	,tilvaskun
	,tilvaskunx
	,kansalr2
	,alvv
	,allk
	,suorv
	,suorlk
	,rahlahde
	,alvv_kksek
	,alvv_kksek_lasna
	,alvv_sek
	,alvv_sek_lasna
	,alvv_kk
	,alvv_kk_lasna
	,alvv_opa
	,alvv_opa_lasna
	,lkm
	,tutkamk
	,tunimamk
	,koamk
	,konimamk
	,suun_v
	,svnim
	,koultyp
	,kkieli
	,lasnalk
	,poissalk
	,oplaaj
	,kirtu1v
	,kirtu1k
	,opyhtamk
	,opylamamk
	,opmuuamk
	,opoamk
	,opmamk
	,opyliopamk
	,opulkomamk
	,tilmaa
	,tutkyo
	,tunimyo
	,koyo
	,konimyo
	,paine
	,painenim
	,tdk
	,om
	,opkelp
	,opyhtyo
	,opulkyo
	,opmuuyo
	,opoylio
	,opaylio
	,opmylio
	,opamkyo
	,ltop = NULL
	,[tietolahde]=''2_9b_sopv_12''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_2_9b_sopv_12]
UNION ALL SELECT
	 tilv
	,aineisto
	,lahde
	,tunn
	,jarj
	,koulk
	,opm95opa
	,kkun
	,sp
	,aikielir1x
	,syntv
	,tilvaskun
	,tilvaskunx
	,kansalr2
	,alvv
	,allk
	,suorv
	,suorlk
	,rahlahde
	,alvv_kksek
	,alvv_kksek_lasna
	,alvv_sek
	,alvv_sek_lasna
	,alvv_kk
	,alvv_kk_lasna
	,alvv_opa
	,alvv_opa_lasna
	,lkm
	,tutkamk
	,tunimamk
	,koamk
	,konimamk
	,suun_v
	,svnim
	,koultyp
	,kkieli
	,lasnalk
	,poissalk
	,oplaaj
	,kirtu1v
	,kirtu1k
	,opyhtamk
	,opylamamk
	,opmuuamk
	,opoamk
	,opmamk
	,opyliopamk
	,opulkomamk
	,tilmaa
	,tutkyo
	,tunimyo
	,koyo
	,konimyo
	,paine
	,painenim
	,tdk
	,om
	,opkelp
	,opyhtyo
	,opulkyo
	,opmuuyo
	,opoylio
	,opaylio
	,opmylio
	,opamkyo
	,ltop = NULL
	,[tietolahde]=''2_9c_sopv_12''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_2_9c_sopv_12]
UNION ALL SELECT
	 tilv
	,aineisto
	,lahde
	,tunn
	,jarj
	,koulk
	,opm95opa
	,kkun
	,sp
	,aikielir1x
	,syntv
	,tilvaskun
	,tilvaskunx
	,kansalr2
	,alvv
	,allk
	,suorv
	,suorlk
	,rahlahde
	,alvv_kksek
	,alvv_kksek_lasna
	,alvv_sek
	,alvv_sek_lasna
	,alvv_kk
	,alvv_kk_lasna
	,alvv_opa
	,alvv_opa_lasna
	,lkm
	,tutkamk
	,tunimamk
	,koamk
	,konimamk
	,suun_v
	,svnim
	,koultyp
	,kkieli
	,lasnalk
	,poissalk
	,oplaaj
	,kirtu1v
	,kirtu1k
	,opyhtamk
	,opylamamk
	,opmuuamk
	,opoamk
	,opmamk
	,opyliopamk
	,opulkomamk
	,tilmaa
	,tutkyo
	,tunimyo
	,koyo
	,konimyo
	,paine
	,painenim
	,tdk
	,om
	,opkelp
	,opyhtyo
	,opulkyo
	,opmuuyo
	,opoylio
	,opaylio
	,opmylio
	,opamkyo
	,ltop = NULL
	,[tietolahde]=''2_9a_sopv_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_2_9a_sopv_13]
UNION ALL SELECT
	 tilv
	,aineisto
	,lahde
	,tunn
	,jarj
	,koulk
	,opm95opa
	,kkun
	,sp
	,aikielir1x
	,syntv
	,tilvaskun
	,tilvaskunx
	,kansalr2
	,alvv
	,allk
	,suorv
	,suorlk
	,rahlahde
	,alvv_kksek
	,alvv_kksek_lasna
	,alvv_sek
	,alvv_sek_lasna
	,alvv_kk
	,alvv_kk_lasna
	,alvv_opa
	,alvv_opa_lasna
	,lkm
	,tutkamk
	,tunimamk
	,koamk
	,konimamk
	,suun_v
	,svnim
	,koultyp
	,kkieli
	,lasnalk
	,poissalk
	,oplaaj
	,kirtu1v
	,kirtu1k
	,opyhtamk
	,opylamamk
	,opmuuamk
	,opoamk
	,opmamk
	,opyliopamk
	,opulkomamk
	,tilmaa
	,tutkyo
	,tunimyo
	,koyo
	,konimyo
	,paine
	,painenim
	,tdk
	,om
	,opkelp
	,opyhtyo
	,opulkyo
	,opmuuyo
	,opoylio
	,opaylio
	,opmylio
	,opamkyo
	,ltop = NULL
	,[tietolahde]=''2_9b_sopv_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_2_9b_sopv_13]
UNION ALL SELECT
	 tilv
	,aineisto
	,lahde
	,tunn
	,jarj
	,koulk
	,opm95opa
	,kkun
	,sp
	,aikielir1x
	,syntv
	,tilvaskun
	,tilvaskunx
	,kansalr2
	,alvv
	,allk
	,suorv
	,suorlk
	,rahlahde
	,alvv_kksek
	,alvv_kksek_lasna
	,alvv_sek
	,alvv_sek_lasna
	,alvv_kk
	,alvv_kk_lasna
	,alvv_opa
	,alvv_opa_lasna
	,lkm
	,tutkamk
	,tunimamk
	,koamk
	,konimamk
	,suun_v
	,svnim
	,koultyp
	,kkieli
	,lasnalk
	,poissalk
	,oplaaj
	,kirtu1v
	,kirtu1k
	,opyhtamk
	,opylamamk
	,opmuuamk
	,opoamk
	,opmamk
	,opyliopamk
	,opulkomamk
	,tilmaa
	,tutkyo
	,tunimyo
	,koyo
	,konimyo
	,paine
	,painenim
	,tdk
	,om
	,opkelp
	,opyhtyo
	,opulkyo
	,opmuuyo
	,opoylio
	,opaylio
	,opmylio
	,opamkyo
	,ltop = NULL
	,[tietolahde]=''2_9c_sopv_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_2_9c_sopv_13]
UNION ALL SELECT
	 tilv
	,aineisto
	,lahde
	,tunn
	,jarj
	,koulk
	,opm95opa
	,kkun
	,sp
	,aikielir1x
	,syntv
	,tilvaskun
	,tilvaskunx
	,kansalr2
	,alvv
	,allk
	,suorv
	,suorlk
	,rahlahde
	,alvv_kksek
	,alvv_kksek_lasna
	,alvv_sek
	,alvv_sek_lasna
	,alvv_kk
	,alvv_kk_lasna
	,alvv_opa
	,alvv_opa_lasna
	,lkm
	,tutkamk
	,tunimamk
	,koamk
	,konimamk
	,suun_v
	,svnim
	,koultyp
	,kkieli
	,lasnalk
	,poissalk
	,oplaaj
	,kirtu1v
	,kirtu1k
	,opyhtamk
	,opylamamk
	,opmuuamk
	,opoamk
	,opmamk
	,opyliopamk
	,opulkomamk
	,tilmaa
	,tutkyo
	,tunimyo
	,koyo
	,konimyo
	,paine
	,painenim
	,tdk
	,om
	,opkelp
	,opyhtyo
	,opulkyo
	,opmuuyo
	,opoylio
	,opaylio
	,opmylio
	,opamkyo
	,ltop
	,[tietolahde]=''2_9a_sopv_14''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_2_9a_sopv_14]
UNION ALL SELECT
	 tilv
	,aineisto
	,lahde
	,tunn
	,jarj
	,koulk
	,opm95opa
	,kkun
	,sp
	,aikielir1x
	,syntv
	,tilvaskun
	,tilvaskunx
	,kansalr2
	,alvv
	,allk
	,suorv
	,suorlk
	,rahlahde
	,alvv_kksek
	,alvv_kksek_lasna
	,alvv_sek
	,alvv_sek_lasna
	,alvv_kk
	,alvv_kk_lasna
	,alvv_opa
	,alvv_opa_lasna
	,lkm
	,tutkamk
	,tunimamk
	,koamk
	,konimamk
	,suun_v
	,svnim
	,koultyp
	,kkieli
	,lasnalk
	,poissalk
	,oplaaj
	,kirtu1v
	,kirtu1k
	,opyhtamk
	,opylamamk
	,opmuuamk
	,opoamk
	,opmamk
	,opyliopamk
	,opulkomamk
	,tilmaa
	,tutkyo
	,tunimyo
	,koyo
	,konimyo
	,paine
	,painenim
	,tdk
	,om
	,opkelp
	,opyhtyo
	,opulkyo
	,opmuuyo
	,opoylio
	,opaylio
	,opmylio
	,opamkyo
	,ltop
	,[tietolahde]=''2_9b_sopv_14''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_2_9b_sopv_14]

UNION ALL SELECT
	 tilv
	,aineisto
	,lahde
	,tunn
	,jarj
	,koulk
	,opm95opa
	,kkun
	,sp
	,aikielir1x
	,syntv
	,tilvaskun
	,tilvaskunx
	,kansalr2
	,alvv
	,allk
	,suorv
	,suorlk
	,rahlahde
	,alvv_kksek
	,alvv_kksek_lasna
	,alvv_sek
	,alvv_sek_lasna
	,alvv_kk
	,alvv_kk_lasna
	,alvv_opa
	,alvv_opa_lasna
	,lkm
	,tutkamk
	,tunimamk
	,koamk
	,konimamk
	,suun_v
	,svnim
	,koultyp
	,kkieli
	,lasnalk
	,poissalk
	,oplaaj
	,kirtu1v
	,kirtu1k
	,opyhtamk
	,opylamamk
	,opmuuamk
	,opoamk
	,opmamk
	,opyliopamk
	,opulkomamk
	,tilmaa
	,tutkyo
	,tunimyo
	,koyo
	,konimyo
	,paine
	,painenim
	,tdk
	,om
	,opkelp
	,opyhtyo
	,opulkyo
	,opmuuyo
	,opoylio
	,opaylio
	,opmylio
	,opamkyo
	,ltop
	,[tietolahde]=''2_9c_sopv_14''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_2_9c_sopv_14] -- siirtokannan taulusta puuttuu 20k riviä

UNION ALL SELECT
	 tilv
	,aineisto
	,lahde
	,tunn
	,jarj
	,koulk
	,opm95opa
	,kkun
	,sp
	,aikielir1x
	,syntv
	,tilvaskun
	,tilvaskunx
	,kansalr2
	,alvv
	,allk
	,suorv
	,suorlk
	,rahlahde
	,alvv_kksek
	,alvv_kksek_lasna
	,alvv_sek
	,alvv_sek_lasna
	,alvv_kk
	,alvv_kk_lasna
	,alvv_opa
	,alvv_opa_lasna
	,lkm
	,tutkamk
	,tunimamk
	,koamk
	,konimamk
	,suun_v
	,svnim
	,koultyp
	,kkieli
	,lasnalk
	,poissalk
	,oplaaj
	,kirtu1v
	,kirtu1k
	,opyhtamk
	,opylamamk
	,opmuuamk
	,opoamk
	,opmamk
	,opyliopamk
	,opulkomamk
	,tilmaa
	,tutkyo
	,tunimyo
	,koyo
	,konimyo
	,paine
	,painenim
	,tdk
	,om
	,opkelp
	,opyhtyo
	,opulkyo
	,opmuuyo
	,opoylio
	,opaylio
	,opmylio
	,opamkyo
	,ltop
	,[tietolahde]=''2_9c_sopv_15''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_2_9c_sopv_15] 

UNION ALL 

SELECT
	 tilv
	,aineisto
	,lahde
	,tunn
	,jarj
	,koulk
	,NULL AS opm95opa
	,kkun
	,sp
	,aikielir1x
	,syntv
	,tilvaskun
	,tilvaskunx
	,kansalr2
	,alvv
	,allk
	,suorv
	,suorlk
	,rahlahde
	,alvv_kksek
	,alvv_kksek_lasna
	,alvv_sek
	,alvv_sek_lasna
	,alvv_kk
	,alvv_kk_lasna
	,alvv_opa
	,alvv_opa_lasna
	,lkm
	,NULL AS tutkamk
	,NULL AS tunimamk
	,NULL AS koamk
	,NULL AS konimamk
	,NULL AS suun_v
	,NULL AS svnim
	,koultyp
	,kkieli
	,lasnalk
	,poissalk
	,oplaaj
	,kirtu1v
	,kirtu1k
	,opyhtamk
	,opylamamk
	,opmuuamk
	,opoamk
	,opmamk
	,opyliopamk
	,opulkomamk
	,NULL AS tilmaa
	,NULL AS tutkyo
	,NULL AS tunimyo
	,NULL AS koyo
	,NULL AS konimyo
	,NULL AS paine
	,NULL AS painenim
	,NULL AS tdk
	,om
	,opkelp
	,opyhtyo
	,opulkyo
	,opmuuyo
	,opoylio
	,opaylio
	,opmylio
	,opamkyo
	,ltop
	,[tietolahde]=''2_9c_sopv_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_2_9c_sopv_16]

UNION ALL 

SELECT
	 tilv
	,aineisto
	,lahde
	,tunn
	,jarj
	,koulk
	,NULL AS opm95opa
	,kkun
	,sp
	,aikielir1x
	,syntv
	,tilvaskun
	,tilvaskunx
	,kansalr2
	,alvv
	,allk
	,suorv
	,suorlk
	,rahlahde
	,alvv_kksek
	,alvv_kksek_lasna
	,alvv_sek
	,alvv_sek_lasna
	,alvv_kk
	,alvv_kk_lasna
	,alvv_opa
	,alvv_opa_lasna
	,lkm
	,NULL AS tutkamk
	,NULL AS tunimamk
	,NULL AS koamk
	,NULL AS konimamk
	,NULL AS suun_v
	,NULL AS svnim
	,koultyp
	,kkieli
	,lasnalk
	,poissalk
	,oplaaj
	,kirtu1v
	,kirtu1k
	,opyhtamk
	,opylamamk
	,opmuuamk
	,opoamk
	,opmamk
	,opyliopamk
	,opulkomamk
	,NULL AS tilmaa
	,NULL AS tutkyo
	,NULL AS tunimyo
	,NULL AS koyo
	,NULL AS konimyo
	,NULL AS paine
	,NULL AS painenim
	,NULL AS tdk
	,om
	,opkelp
	,opyhtyo
	,opulkyo
	,opmuuyo
	,opoylio
	,opaylio
	,opmylio
	,opamkyo
	,ltop
	,[tietolahde]=''2_9c_sopv_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM VipunenTK_SA.[dbo].[tktutk2016OKMEnnakko_AMK]

UNION ALL 

SELECT
	 tilv
	,aineisto
	,lahde
	,tunn
	,jarj
	,koulk
	,NULL AS opm95opa
	,kkun
	,sp
	,aikielir1x
	,syntv
	,tilvaskun
	,tilvaskunx
	,kansalr2
	,alvv
	,allk
	,suorv
	,suorlk
	,rahlahde
	,alvv_kksek
	,alvv_kksek_lasna
	,alvv_sek
	,alvv_sek_lasna
	,alvv_kk
	,alvv_kk_lasna
	,alvv_opa
	,alvv_opa_lasna
	,lkm
	,NULL AS tutkamk
	,NULL AS tunimamk
	,NULL AS koamk
	,NULL AS konimamk
	,NULL AS suun_v
	,NULL AS svnim
	,koultyp
	,kkieli
	,lasnalk
	,poissalk
	,oplaaj
	,kirtu1v
	,kirtu1k
	,opyhtamk
	,opylamamk
	,opmuuamk
	,opoamk
	,opmamk
	,opyliopamk
	,opulkomamk
	,NULL AS tilmaa
	,NULL AS tutkyo
	,NULL AS tunimyo
	,NULL AS koyo
	,NULL AS konimyo
	,NULL AS paine
	,NULL AS painenim
	,NULL AS tdk
	,om
	,opkelp
	,opyhtyo
	,opulkyo
	,opmuuyo
	,opoylio
	,opaylio
	,opmylio
	,opamkyo
	,ltop
	,[tietolahde]=''2_9c_sopv_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM VipunenTK_SA.[dbo].[tktutk2016OKMEnnakko_YO]

) as kaikkivuodet





















' 
GO
/****** Object:  View [dbo].[v_sa_3_14_Lukio_ja_amm_opisk_mediaani_iat]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_3_14_Lukio_ja_amm_opisk_mediaani_iat]'))
EXEC dbo.sp_executesql @statement = N'






CREATE VIEW [dbo].[v_sa_3_14_Lukio_ja_amm_opisk_mediaani_iat] AS

-- truncate table vipunentk_dw..sa_3_14_Lukio_ja_amm_opisk_mediaani_iat
-- insert into vipunentk_dw..sa_3_14_Lukio_ja_amm_opisk_mediaani_iat select * from v_sa_3_14_Lukio_ja_amm_opisk_mediaani_iat

SELECT
	 tilv = cast(kaikkivuodet.tilv as nvarchar(4))
	,tilv_date = cast(kaikkivuodet.tilv+''0101'' as date)
	,lahde = cast(kaikkivuodet.lahde as nvarchar(2))
	,tunn = CASE WHEN lahde = 34 and tunn = '''' THEN cast(coalesce(nullif(kaikkivuodet.opjarj, ''''), ''-1'')  as nvarchar(10))
			ELSE cast(coalesce(nullif(kaikkivuodet.tunn , ''''), ''-1'') as nvarchar(5))
			END   -- Ohjataan oppisopimuskoulutuksen lähteellä opjarj-muuttujan avain tyhjien arvojen tilalle - Lasse 26.5.2014	
	--,tunn = cast(kaikkivuodet.tunn as nvarchar(5))
	,jarj = cast(kaikkivuodet.jarj as nvarchar(10))
	,opjarj = cast(kaikkivuodet.opjarj as nvarchar(10))
	,koulk = cast(kaikkivuodet.koulk as nvarchar(6))
	,sp = cast(kaikkivuodet.sp as nvarchar(1))
	,aikielir1 = cast(kaikkivuodet.aikielir1 as nvarchar(2))
	,syntv = cast(kaikkivuodet.syntv as nvarchar(4))
	,synkk = cast(kaikkivuodet.synkk as nvarchar(2))
	,alvv = cast(kaikkivuodet.alvv as nvarchar(4))
	,allk = cast(kaikkivuodet.allk as nvarchar(1))
	,lkm = cast(kaikkivuodet.lkm as int)
	,aikoul = cast(kaikkivuodet.aikoul as nvarchar(1))
	,tutklaja = cast(kaikkivuodet.tutklaja as nvarchar(1))
	,tutktav = cast(kaikkivuodet.tutktav as nvarchar(1))
	,ophal = coalesce(nullif(cast(kaikkivuodet.ophal as nvarchar(1)),''''), 1)
	,tietolahde = cast(kaikkivuodet.tietolahde as nvarchar(250))
	,rivinumero = cast(kaikkivuodet.rivinumero as int)
FROM (
/*
--Historia-aineisto
SELECT
	 tilv
	,lahde = 
		case
			when lahde = ''1'' then ''21''
			when lahde = ''2'' and oppis = ''2'' then ''35''
			when lahde = ''2'' and oppis = ''1'' then ''34''
			else ''-1''
		end 
	,tunn
	,jarj = null
	,opjarj
	,koulk
	,sp
	,aikielir1
	,syntv = null
	,synkk = null
	,alvv
	,allk
	,lkm
	,aikoul
	,tutklaja
	,tutktav
	,ophal
	,[tietolahde]=''8_2_Historia_opiskelijat''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_8_2_sopv_16]
where tilv<2010 and lahde in (1,2)

UNION ALL
*/
SELECT
	 tilv
	,lahde
	,tunn
	,jarj
	,opjarj
	,koulk
	,sp
	,aikielir1
	,syntv
	,synkk
	,alvv
	,allk
	,lkm
	,aikoul
	,tutklaja
	,tutktav
	,ophal
	,[tietolahde]=''3_14_sopv_12''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_3_14_sopv_12]
UNION ALL SELECT
	 tilv
	,lahde
	,tunn
	,jarj
	,opjarj
	,koulk
	,sp
	,aikielir1
	,syntv
	,synkk
	,alvv
	,allk
	,lkm
	,aikoul
	,tutklaja
	,tutktav
	,ophal
	,[tietolahde]=''3_14_sopv_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_3_14_sopv_13]
UNION ALL SELECT
	 tilv
	,lahde
	,tunn
	,jarj
	,opjarj
	,koulk
	,sp
	,aikielir1
	,syntv
	,synkk
	,alvv
	,allk
	,lkm
	,aikoul
	,tutklaja
	,tutktav
	,ophal
	,[tietolahde]=''3_14_2012_sopv_14''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_3_14_2012_sopv_14]
UNION ALL SELECT
	 tilv
	,lahde
	,tunn
	,jarj
	,opjarj
	,koulk
	,sp
	,aikielir1
	,syntv
	,synkk
	,alvv
	,allk
	,lkm
	,aikoul
	,tutklaja
	,tutktav
	,ophal
	,[tietolahde]=''3_14_2013_sopv_14''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_3_14_2013_sopv_14]

UNION ALL SELECT
	 tilv
	,lahde
	,tunn
	,jarj
	,opjarj
	,koulk
	,sp
	,aikielir1
	,syntv
	,synkk
	,alvv
	,allk
	,lkm
	,aikoul
	,tutklaja
	,tutktav
	,ophal
	,[tietolahde]=''3_14_sopv_15''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_3_14_sopv_15]

UNION ALL SELECT
	 tilv
	,lahde
	,tunn
	,jarj
	,opjarj
	,koulk
	,sp
	,aikielir1
	,syntv
	,synkk
	,alvv
	,allk
	,lkm
	,aikoul
	,tutklaja
	,tutktav
	,ophal
	,[tietolahde]=''3_14_sopv_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_3_14_sopv_16]

) as kaikkivuodet







' 
GO
/****** Object:  View [dbo].[v_sa_3_15_Lukio_ja_amm_tutk_mediaani_iat]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_3_15_Lukio_ja_amm_tutk_mediaani_iat]'))
EXEC dbo.sp_executesql @statement = N'





CREATE VIEW [dbo].[v_sa_3_15_Lukio_ja_amm_tutk_mediaani_iat] AS

-- truncate table vipunentk_dw..sa_3_15_Lukio_ja_amm_tutk_mediaani_iat
-- insert into vipunentk_dw..sa_3_15_Lukio_ja_amm_tutk_mediaani_iat select * from v_sa_3_15_Lukio_ja_amm_tutk_mediaani_iat


SELECT
	 tilv = cast(kaikkivuodet.tilv as nvarchar(4))
	,tilv_date = cast(kaikkivuodet.tilv+''0101'' as date)
	,lahde = cast(kaikkivuodet.lahde as nvarchar(2))
	,tunn = CASE WHEN lahde = 34 and tunn = '''' THEN cast(coalesce(nullif(kaikkivuodet.opjarj, ''''), ''-1'')  as nvarchar(10))
			ELSE cast(coalesce(nullif(kaikkivuodet.tunn , ''''), ''-1'') as nvarchar(5))
			END   -- Ohjataan oppisopimuskoulutuksen lähteellä opjarj-muuttujan avain tyhjien arvojen tilalle - Lasse 26.5.2014

--	,tunn = cast(kaikkivuodet.tunn as nvarchar(5))
	,jarj = cast(kaikkivuodet.jarj as nvarchar(10))
	,opjarj = cast(kaikkivuodet.opjarj as nvarchar(10))
	,koulk = cast(kaikkivuodet.koulk as nvarchar(6))
	,sp = cast(kaikkivuodet.sp as nvarchar(1))
	,aikielir1 = cast(kaikkivuodet.aikielir1 as nvarchar(2))
	,syntv = cast(kaikkivuodet.syntv as nvarchar(4))
	,synkk = cast(kaikkivuodet.synkk as nvarchar(2))
	,alvv = cast(kaikkivuodet.alvv as nvarchar(4))
	,allk = cast(kaikkivuodet.allk as nvarchar(1))
	,suorv = cast(kaikkivuodet.suorv as nvarchar(4))
	,suorkk = cast(kaikkivuodet.suorkk as nvarchar(2))
	,lkm = cast(kaikkivuodet.lkm as int)
	,tutk = cast(kaikkivuodet.tutk as int)
	,tutklaja = cast(kaikkivuodet.tutklaja as nvarchar(1))
	,tutktav = cast(kaikkivuodet.tutktav as nvarchar(1))
	,ophal = 
		CASE
			WHEN lahde = 22 THEN ''1''
			WHEN lahde = 23 THEN ''1''    -- 13.5.2015 LR, Kansainväliset ylioppilastutkinnot ja gymnasieexamen, ohjattu opetushallinnon alaiseksi koulutukseksi
			ELSE cast(kaikkivuodet.ophal as nvarchar(1))
		END
	,aikoul = cast(kaikkivuodet.aikoul as nvarchar(1))
	,tietolahde = cast(kaikkivuodet.tietolahde as nvarchar(250))
	,rivinumero = cast(kaikkivuodet.rivinumero as int)
FROM (

	SELECT
	 tilv
	,lahde
	,tunn
	,jarj
	,opjarj
	,koulk
	,sp
	,aikielir1
	,syntv
	,synkk
	,alvv
	,allk
	,suorv
	,suorkk
	,lkm
	,tutk
	,tutklaja
	,tutktav
	,ophal
	,aikoul
	,[tietolahde]=''3_15_sopv_12''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_3_15_sopv_12]
UNION ALL SELECT
	 tilv
	,lahde
	,tunn
	,jarj
	,opjarj
	,koulk
	,sp
	,aikielir1
	,syntv
	,synkk
	,alvv
	,allk
	,suorv
	,suorkk
	,lkm
	,tutk
	,tutklaja
	,tutktav
	,ophal
	,aikoul
	,[tietolahde]=''3_15_sopv_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_3_15_sopv_13]
UNION ALL SELECT
	 tilv
	,lahde
	,tunn
	,jarj
	,opjarj
	,koulk
	,sp
	,aikielir1
	,syntv
	,synkk
	,alvv
	,allk
	,suorv
	,suorkk
	,lkm
	,tutk
	,tutklaja
	,tutktav
	,ophal
	,aikoul
	,[tietolahde]=''3_15_2012_sopv_14''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_3_15_2012_sopv_14]

UNION ALL SELECT
	 tilv
	,lahde
	,tunn
	,jarj
	,opjarj
	,koulk
	,sp
	,aikielir1
	,syntv
	,synkk
	,alvv
	,allk
	,suorv
	,suorkk
	,lkm
	,tutk
	,tutklaja
	,tutktav
	,ophal
	,aikoul
	,[tietolahde]=''3_15_2013_sopv_14''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_3_15_2013_sopv_14]

UNION ALL SELECT
	 tilv
	,lahde
	,tunn
	,jarj
	,opjarj
	,koulk
	,sp
	,aikielir1
	,syntv
	,synkk
	,alvv
	,allk
	,suorv
	,suorkk
	,lkm
	,tutk
	,tutklaja
	,tutktav
	,ophal
	,aikoul
	,[tietolahde]=''3_15_sopv_15''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_3_15_sopv_15]

UNION ALL SELECT
	 tilv
	,lahde
	,tunn
	,jarj
	,opjarj
	,koulk
	,sp
	,aikielir1
	,syntv
	,synkk
	,alvv
	,allk
	,suorv
	,suorkk
	,lkm
	,tutk
	,tutklaja
	,tutktav
	,ophal
	,aikoul
	,[tietolahde]=''3_15_sopv_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_3_15_sopv_16]

) as kaikkivuodet






' 
GO
/****** Object:  View [dbo].[v_sa_3_1a_Oppisopimuskoulutus]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_3_1a_Oppisopimuskoulutus]'))
EXEC dbo.sp_executesql @statement = N'











/****** Script for SelectTopNRows command from SSMS  ******/
CREATE VIEW [dbo].[v_sa_3_1a_Oppisopimuskoulutus] AS

SELECT tilv = cast(kaikkivuodet.tilv as nvarchar(4))
	,tilv_date = cast(kaikkivuodet.tilv+''0101'' as date)
	,oppisryh = cast(kaikkivuodet.oppisryh as nvarchar(8))
	,sp =  cast(kaikkivuodet.sp as nvarchar(1))
	,aikielir1 = cast(kaikkivuodet.aikielir1 as nvarchar(2))
	,ikar2 = cast(kaikkivuodet.ikar2 as nvarchar(2))
	,opmala = cast(kaikkivuodet.opmala as nvarchar(1))
	,opmast = cast(kaikkivuodet.opmast as nvarchar(2))
	,tutklaja = cast(kaikkivuodet.tutklaja as nvarchar(1))
	,kmaak = cast(kaikkivuodet.kmaak as nvarchar(2))
	,ptoim1r3 = cast(kaikkivuodet.ptoim1r3 as nvarchar(2))
	,amas = cast(kaikkivuodet.amas as nvarchar(1))
	,tyansek= cast(kaikkivuodet.tyansek as nvarchar(1))
	,tol2002 = cast(kaikkivuodet.tol2002 as nvarchar(1))
	,tol2008 = cast(kaikkivuodet.tol2008 as nvarchar(1))
	,koko = cast(kaikkivuodet.koko as nvarchar(1))
	,lkm = cast(kaikkivuodet.lkm as int)
	,tietolahde = cast(kaikkivuodet.tietolahde as nvarchar(250))
	,rivinumero = cast(kaikkivuodet.rivinumero as int)

  FROM (
	SELECT
	[tilv]
      ,[tutkryh] as oppisryh
      ,[sp]
      ,[aikielir1]
      ,[ikar2]
      ,[opmala]
      ,[opmast]
      ,[tutklaja]
      ,[kmaak]
      ,[ptoim1r3]
      ,[amas]
      ,[tyansek]
      ,[tol2002]
	  ,[tol2008] = ''-1''
      ,[koko]
      ,[lkm]

	,[tietolahde]=''3_1a_sopv_11''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_3_1a_sopv_11]

union all

SELECT
	[tilv]
      ,[oppisryh]
      ,[sp]
      ,[aikielir1]
      ,[ikar2]
      ,[opmala]
      ,[opmast]
      ,[tutklaja]
      ,[kmaak]
      ,[ptoim1r3]
      ,[amas]
      ,[tyansek]
      ,[tol2002]= ''-1''
	  ,[tol2008]
      ,[koko]
      ,[lkm] 

	,[tietolahde]=''3_1a_sopv_12''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_3_1a_sopv_12]

union all

SELECT
	[tilv]
      ,[oppisryh]
      ,[sp]
      ,[aikielir1]
      ,[ikar2]
      ,[opmala]
      ,[opmast]
      ,[tutklaja]
      ,[kmaak]
      ,[ptoim1r3]
      ,[amas]
      ,[tyansek]
      ,[tol2002]= ''-1''
	  ,[tol2008]
      ,[koko]
      ,[lkm] 

	,[tietolahde]=''3_1a_sopv_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_3_1a_sopv_13]

union all

SELECT
	[tilv]
      ,[oppisryh]
      ,[sp]
      ,[aikielir1]
      ,[ikar2]
      ,[opmala]
      ,[opmast]
      ,[tutklaja]
      ,[kmaak]
      ,[ptoim1r3]
      ,[amas]
      ,[tyansek]
      ,[tol2002]= ''-1''
	  ,[tol2008]
      ,[koko]
      ,[lkm] 

	,[tietolahde]=''3_1a_sopv_14''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_3_1a_sopv_14]

union all

SELECT
	[tilv]
      ,[oppisryh]
      ,[sp]
      ,[aikielir1]
      ,[ikar2]
      ,[opmala]
      ,[opmast]
      ,[tutklaja]
      ,[kmaak]
      ,[ptoim1r3]
      ,[amas]
      ,[tyansek]
      ,[tol2002]= ''-1''
	  ,[tol2008]
      ,[koko]
      ,[lkm] 

	,[tietolahde]=''3_1a_sopv_15''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_3_1a_sopv_15]


union all

SELECT
	[tilv]
      ,[oppisryh]
      ,[sp]
      ,[aikielir1]
      ,[ikar2]
      ,[opmala]
      ,[opmast]
      ,[tutklaja]
      ,[kmaak]
      ,[ptoim1r3]
      ,[amas]
      ,[tyansek]
      ,[tol2002]= ''-1''
	  ,[tol2008]
      ,[koko]
      ,[lkm] 

	,[tietolahde]=''3_1a_sopv_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_3_1a_sopv_16]


) as kaikkivuodet



' 
GO
/****** Object:  View [dbo].[v_sa_3_1b_Oppisopimuskoulutus]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_3_1b_Oppisopimuskoulutus]'))
EXEC dbo.sp_executesql @statement = N'













/****** Script for SelectTopNRows command from SSMS  ******/
CREATE VIEW [dbo].[v_sa_3_1b_Oppisopimuskoulutus] AS

SELECT tilv = cast(kaikkivuodet.tilv as nvarchar(4))
	,tilv_date = cast(kaikkivuodet.tilv+''0101'' as date)
	,oppisryh = cast(kaikkivuodet.oppisryh as nvarchar(8))
	,sp =  cast(kaikkivuodet.sp as nvarchar(1))
	,aikielir1 = cast(kaikkivuodet.aikielir1 as nvarchar(2))
	,ikar2 = cast(kaikkivuodet.ikar2 as nvarchar(2))
	,opmala = cast(kaikkivuodet.opmala as nvarchar(1))
	,opmast = cast(kaikkivuodet.opmast as nvarchar(2))
	,tutklaja = cast(kaikkivuodet.tutklaja as nvarchar(1))
	,kmaak = cast(kaikkivuodet.kmaak as nvarchar(2))
	,kesto = cast(kaikkivuodet.kesto as nvarchar(2))
	,kestotot = cast(kaikkivuodet.kestotot as nvarchar(2))
	,lkm = cast(kaikkivuodet.lkm as int)
	,tietolahde = cast(kaikkivuodet.tietolahde as nvarchar(250))
	,rivinumero = cast(kaikkivuodet.rivinumero as int)

  FROM (
	SELECT
	[tilv]
      ,[tutkryh] as oppisryh
      ,[sp]
      ,[aikielir1]
      ,[ikar2]
      ,[opmala]
      ,[opmast]
      ,[tutklaja]
      ,[kmaak]
      ,[kesto]
      ,[kestotot]
      ,[lkm]
      	,[tietolahde]=''3_1b_sopv_11''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_3_1b_sopv_11]
union all

SELECT
	[tilv]
      ,[oppisryh] 
      ,[sp]
      ,[aikielir1]
      ,[ikar2]
      ,[opmala]
      ,[opmast]
      ,[tutklaja]
      ,[kmaak]
      ,[kesto]
      ,[kestotot]
      ,[lkm]
      	,[tietolahde]=''3_1b_sopv_12''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_3_1b_sopv_12]

union all

SELECT
	[tilv]
      ,[oppisryh] 
      ,[sp]
      ,[aikielir1]
      ,[ikar2]
      ,[opmala]
      ,[opmast]
      ,[tutklaja]
      ,[kmaak]
      ,[kesto]
      ,[kestotot]
      ,[lkm]
      	,[tietolahde]=''3_1b_sopv_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_3_1b_sopv_13]

union all

SELECT
	[tilv]
      ,[oppisryh] 
      ,[sp]
      ,[aikielir1]
      ,[ikar2]
      ,[opmala]
      ,[opmast]
      ,[tutklaja]
      ,[kmaak]
      ,[kesto]
      ,[kestotot]
      ,[lkm]
      	,[tietolahde]=''3_1b_sopv_14''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_3_1b_sopv_14]

union all

SELECT
	[tilv]
      ,[oppisryh] 
      ,[sp]
      ,[aikielir1]
      ,[ikar2]
      ,[opmala]
      ,[opmast]
      ,[tutklaja]
      ,[kmaak]
      ,[kesto]
      ,[kestotot]
      ,[lkm]
      	,[tietolahde]=''3_1b_sopv_15''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_3_1b_sopv_15]

union all

SELECT
	[tilv]
      ,[oppisryh] 
      ,[sp]
      ,[aikielir1]
      ,[ikar2]
      ,[opmala]
      ,[opmast]
      ,[tutklaja]
      ,[kmaak]
      ,[kesto]
      ,[kestotot]
      ,[lkm]
      	,[tietolahde]=''3_1b_sopv_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_3_1b_sopv_16]

union all

SELECT
	[tilv]
      ,[oppisryh] 
      ,[sp]
      ,[aikielir1]
      ,[ikar2]
      ,[opmala]
      ,[opmast]
      ,[tutklaja]
      ,[kmaak]
      ,[kesto]
      ,[kestotot]
      ,[lkm]
      	,[tietolahde]=''3_1b_sopv_17''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_3_1b_sopv_17]



) as kaikkivuodet





' 
GO
/****** Object:  View [dbo].[v_sa_3_2_Oppisopimuskoulutus_jatko_opinnot]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_3_2_Oppisopimuskoulutus_jatko_opinnot]'))
EXEC dbo.sp_executesql @statement = N'














/****** Script for SelectTopNRows command from SSMS  ******/
CREATE VIEW [dbo].[v_sa_3_2_Oppisopimuskoulutus_jatko_opinnot] AS

SELECT tilv = cast(kaikkivuodet.tilv as nvarchar(4))
	,tilv_date = cast(kaikkivuodet.tilv+''0101'' as date)
	,oppisryh = cast(kaikkivuodet.oppisryh as nvarchar(8))
	,sp =  cast(kaikkivuodet.sp as nvarchar(1))
	,aikielir1 = cast(kaikkivuodet.aikielir1 as nvarchar(2))
	,ikar2 = cast(kaikkivuodet.ikar2 as nvarchar(2))
	,opmala = cast(kaikkivuodet.opmala as nvarchar(1))
	,tutklaja = cast(kaikkivuodet.tutklaja as nvarchar(1))
	,kmaak = cast(kaikkivuodet.kmaak as nvarchar(2))
	,jopmast = cast(kaikkivuodet.jopmast as nvarchar(2))
	,lkm = cast(kaikkivuodet.lkm as int)
	,tietolahde = cast(kaikkivuodet.tietolahde as nvarchar(250))
	,rivinumero = cast(kaikkivuodet.rivinumero as int)
	,opmast = cast(kaikkivuodet.opmast as nvarchar(2))
	,jopmala = cast(kaikkivuodet.jopmala as nvarchar(1))

  FROM (
	SELECT
	[tilv]
      ,[oppisryh] 
      ,[sp]
      ,[aikielir1]
      ,[ikar2]
      ,[opmala]
      ,[tutklaja]
      ,[kmaak]
      ,[jopmast]
      ,[lkm]
	  ,[tietolahde]=''3_2_sopv_11''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
	  ,[opmast] 
	  ,[jopmala]
FROM [TK_H9098_CSC].[dbo].[TK_3_2_sopv_11]

union all

	SELECT
	   [tilv]
      ,[oppisryh]
      ,[sp]
      ,[aikielir1]
      ,[ikar2]
      ,[opmala]
      ,[tutklaja]
      ,[kmaak]
      ,[jopmast]
      ,[lkm]
	  ,[tietolahde]=''3_2_sopv_12''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
	  ,[opmast] 
	  ,[jopmala]
FROM [TK_H9098_CSC].[dbo].[TK_3_2_sopv_12]


union all

SELECT
	[tilv]
      ,[oppisryh]
      ,[sp]
      ,[aikielir1]
      ,[ikar2]
      ,[opmala]
      ,[tutklaja]
      ,[kmaak]
      ,[jopmast]
      ,[lkm]
	   ,[tietolahde]=''3_2_sopv_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
	  ,[opmast] 
	  ,[jopmala]
FROM [TK_H9098_CSC].[dbo].[TK_3_2_sopv_13]

union all

SELECT
	[tilv]
      ,[oppisryh] 
      ,[sp]
      ,[aikielir1]
      ,[ikar2]
      ,[opmala]
      ,[tutklaja]
      ,[kmaak]
      ,[jopmast]
      ,[lkm]
	  ,[tietolahde]=''3_2_sopv_14''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
	  ,[opmast] 
	  ,[jopmala]
FROM [TK_H9098_CSC].[dbo].[TK_3_2_sopv_14]

union all

SELECT
	[tilv]
      ,[oppisryh]
      ,[sp]
      ,[aikielir1]
      ,[ikar2]
      ,[opmala]
      ,[tutklaja]
      ,[kmaak]
      ,[jopmast]
      ,[lkm]
	  ,[tietolahde]=''3_2_sopv_15''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
	  ,[opmast] 
	  ,[jopmala]
FROM [TK_H9098_CSC].[dbo].[TK_3_2_sopv_15]
union all

SELECT
	[tilv]
      ,[oppisryh]
      ,[sp]
      ,[aikielir1]
      ,[ikar2]
      ,[opmala]
      ,[tutklaja]
      ,[kmaak]
      ,[jopmast]
      ,[lkm]
	  ,[tietolahde]=''3_2_sopv_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
	  ,[opmast] 
	  ,[jopmala]
FROM [TK_H9098_CSC].[dbo].[TK_3_2_sopv_16]
union all

SELECT
	[tilv]
      ,[oppisryh]
      ,[sp]
      ,[aikielir1]
      ,[ikar2]
      ,[opmala]
      ,[tutklaja]
      ,[kmaak]
      ,[jopmast]
      ,[lkm]
	  ,[tietolahde]=''3_2_sopv_17''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
	  ,[opmast] 
	  ,[jopmala]
FROM [TK_H9098_CSC].[dbo].[TK_3_2_sopv_17]



) as kaikkivuodet






' 
GO
/****** Object:  View [dbo].[v_sa_3_4_Kk_tutk_suor_mediaani_iat_ja_tutk_mediaani_ajat]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_3_4_Kk_tutk_suor_mediaani_iat_ja_tutk_mediaani_ajat]'))
EXEC dbo.sp_executesql @statement = N'




CREATE VIEW [dbo].[v_sa_3_4_Kk_tutk_suor_mediaani_iat_ja_tutk_mediaani_ajat] AS

-- truncate table vipunentk_dw..sa_3_4_Kk_tutk_suor_mediaani_iat_ja_tutk_mediaani_ajat
-- insert into vipunentk_dw..sa_3_4_Kk_tutk_suor_mediaani_iat_ja_tutk_mediaani_ajat select * from v_sa_3_4_Kk_tutk_suor_mediaani_iat_ja_tutk_mediaani_ajat


SELECT
	 tilv = cast(kaikkivuodet.tilv as nvarchar(4))
	,tilv_date = cast(kaikkivuodet.tilv+''0101'' as date)
	,lahde = cast(kaikkivuodet.lahde as nvarchar(2))
	,tunn = cast(kaikkivuodet.tunn as nvarchar(5))
	,jarj = cast(kaikkivuodet.jarj as nvarchar(10))
	,koulk = cast(kaikkivuodet.koulk as nvarchar(6))
	,koultyp = cast(kaikkivuodet.koultyp as nvarchar(1))
	,sp = cast(kaikkivuodet.sp as nvarchar(1))
	,aikielir1 = cast(kaikkivuodet.aikielir1 as nvarchar(2))
	,syntv = cast(kaikkivuodet.syntv as nvarchar(4))
	,synkk = cast(kaikkivuodet.synkk as nvarchar(2))
	,alvv = cast(kaikkivuodet.alvv as nvarchar(4))
	,allk = cast(kaikkivuodet.allk as nvarchar(1))
	,alvv_kk = cast(kaikkivuodet.alvv_kk as nvarchar(4))
	,allk_kk = cast(kaikkivuodet.allk_kk as nvarchar(1))
	,suorv = cast(kaikkivuodet.suorv as nvarchar(4))
	,suorkk = cast(kaikkivuodet.suorkk as nvarchar(2))
	,lkm = cast(kaikkivuodet.lkm as int)
	,tietolahde = cast(kaikkivuodet.tietolahde as nvarchar(250))
	,rivinumero = cast(kaikkivuodet.rivinumero as int)
FROM (

	SELECT
	 tilv
	,lahde
	,tunn
	,jarj
	,koulk
	,koultyp
	,sp
	,aikielir1
	,syntv
	,synkk
	,alvv
	,allk
	,alvv_kk
	,allk_kk
	,suorv
	,suorkk
	,lkm
	,[tietolahde]=''3_4_sopv_11''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_3_4_sopv_11]
UNION ALL 	SELECT
	 tilv
	,lahde
	,tunn
	,jarj
	,koulk
	,koultyp
	,sp
	,aikielir1
	,syntv
	,synkk
	,alvv
	,allk
	,alvv_kk
	,allk_kk
	,suorv
	,suorkk
	,lkm
	,[tietolahde]=''3_4_sopv_12''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_3_4_sopv_12]
UNION ALL 	SELECT
	 tilv
	,lahde
	,tunn
	,jarj
	,koulk
	,koultyp
	,sp
	,aikielir1
	,syntv
	,synkk
	,alvv
	,allk
	,alvv_kk
	,allk_kk
	,suorv
	,suorkk
	,lkm
	,[tietolahde]=''3_4_sopv_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)

FROM [TK_H9098_CSC].[dbo].[TK_3_4_sopv_13]

UNION ALL 	SELECT
	 tilv
	,lahde
	,tunn
	,jarj
	,koulk
	,koultyp
	,sp
	,aikielir1
	,syntv
	,synkk
	,alvv
	,allk
	,alvv_kk
	,allk_kk
	,suorv
	,suorkk
	,lkm
	,[tietolahde]=''3_4_sopv_14''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_3_4_sopv_14]

UNION ALL 	SELECT
	 tilv
	,lahde
	,tunn
	,jarj
	,koulk
	,koultyp
	,sp
	,aikielir1
	,syntv
	,synkk
	,alvv
	,allk
	,alvv_kk
	,allk_kk
	,suorv
	,suorkk
	,lkm
	,[tietolahde]=''3_4_sopv_15''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_3_4_sopv_15]


UNION ALL 	SELECT
	 tilv
	,lahde
	,tunn
	,jarj
	,koulk
	,koultyp
	,sp
	,aikielir1
	,syntv
	,synkk
	,alvv
	,allk
	,alvv_kk
	,allk_kk
	,suorv
	,suorkk
	,lkm
	,[tietolahde]=''3_4_sopv_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_3_4_sopv_16]

) as kaikkivuodet





' 
GO
/****** Object:  View [dbo].[v_sa_3_7_tutkinnon_suorittaneiden_osuus_poistumasta_erityisopiskelijat]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_3_7_tutkinnon_suorittaneiden_osuus_poistumasta_erityisopiskelijat]'))
EXEC dbo.sp_executesql @statement = N'






CREATE VIEW [dbo].[v_sa_3_7_tutkinnon_suorittaneiden_osuus_poistumasta_erityisopiskelijat] AS
SELECT [tilv] = CAST(tilv as nvarchar(4))
      ,[lahde] = CAST(COALESCE(NULLIF(lahde , ''''), ''-1'') as nvarchar(2))
      ,[kmaak] = CAST(COALESCE(NULLIF((SELECT [maakunta_koodi_nykytila] FROM [VipunenTK_lisatiedot].[dbo].[alueluokitus_maakunta_korjaus] WHERE [maakunta_koodi] = kmaak), ''''), NULLIF(kmaak , ''''), ''-1'') as nvarchar(2))
      ,[jarj] = CAST(COALESCE(NULLIF(jarj, ''''), ''-1'') as nvarchar(10))
      ,[koulk] = CAST(COALESCE(NULLIF(koulk, ''''), ''-1'') as nvarchar(6))
      ,[ophal] = CAST(COALESCE(NULLIF(ophal, ''''), ''-1'') as nvarchar(2))
      ,[tutkmaak] = CAST(COALESCE(NULLIF((SELECT [maakunta_koodi_nykytila] FROM [VipunenTK_lisatiedot].[dbo].[alueluokitus_maakunta_korjaus] WHERE [maakunta_koodi] = tutkmaak), ''''), NULLIF(tutkmaak , ''''), ''-1'') as nvarchar(2))
      ,[tutkjarj] = CAST(COALESCE(NULLIF(tutkjarj, ''''), ''-1'') as nvarchar(10))
      ,[tutkkoulk] = CAST(COALESCE(NULLIF(tutkkoulk, ''''), ''-1'') as nvarchar(6))
      ,[seurvkmaak] = CAST(COALESCE(NULLIF((SELECT [maakunta_koodi_nykytila] FROM [VipunenTK_lisatiedot].[dbo].[alueluokitus_maakunta_korjaus] WHERE [maakunta_koodi] = seurvkmaak), ''''), NULLIF(seurvkmaak , ''''), ''-1'') as nvarchar(3))
      ,[seurvjarj] = CAST(COALESCE(NULLIF(seurvjarj, ''''), ''-1'') as nvarchar(10))
      ,[seurvkoulk] = CAST(COALESCE(NULLIF(seurvkoulk, ''''), ''-1'') as nvarchar(6))
      ,[lkm] = CAST(lkm as int)
	  ,tietolahde
FROM
(SELECT [tilv]
      ,[lahde]
      ,[kmaak]
      ,[jarj]
      ,[koulk]
      ,[ophal]
      ,[tutkmaak]
      ,[tutkjarj]
      ,[tutkkoulk]
      ,[seurvkmaak]
      ,[seurvjarj]
      ,[seurvkoulk]
      ,[lkm]
      ,[luontipvm]
	  ,tietolahde = ''3_7_sopv_11''
  FROM [TK_H9098_CSC].[dbo].[TK_3_7_sopv_11]
UNION ALL
SELECT [tilv]
      ,[lahde]
      ,[kmaak]
      ,[jarj]
      ,[koulk]
      ,[ophal]
      ,[tutkmaak]
      ,[tutkjarj]
      ,[tutkkoulk]
      ,[seurvkmaak]
      ,[seurvjarj]
      ,[seurvkoulk]
      ,[lkm]
      ,[luontipvm]
	  ,tietolahde = ''3_7_sopv_12''
  FROM [TK_H9098_CSC].[dbo].[TK_3_7_sopv_12]
UNION ALL
SELECT [tilv]
      ,[lahde]
      ,[kmaak]
      ,[jarj]
      ,[koulk]
      ,[ophal]
      ,[tutkmaak]
      ,[tutkjarj]
      ,[tutkkoulk]
      ,[seurvkmaak]
      ,[seurvjarj]
      ,[seurvkoulk]
      ,[lkm]
      ,[luontipvm]
	  ,tietolahde = ''3_7_sopv_13''
  FROM [TK_H9098_CSC].[dbo].[TK_3_7_sopv_13]
UNION ALL
SELECT [tilv]
      ,[lahde]
      ,[kmaak]
      ,[jarj]
      ,[koulk]
      ,[ophal]
      ,[tutkmaak]
      ,[tutkjarj]
      ,[tutkkoulk]
      ,[seurvkmaak]
      ,[seurvjarj]
      ,[seurvkoulk]
      ,[lkm]
      ,[luontipvm]
	  ,tietolahde = ''3_7_sopv_14''
  FROM [TK_H9098_CSC].[dbo].[TK_3_7_sopv_14]
UNION ALL
SELECT [tilv]
      ,[lahde]
      ,[kmaak]
      ,[jarj]
      ,[koulk]
      ,[ophal]
      ,[tutkmaak]
      ,[tutkjarj]
      ,[tutkkoulk]
      ,[seurvkmaak]
      ,[seurvjarj]
      ,[seurvkoulk]
      ,[lkm]
      ,[luontipvm]
	  ,tietolahde = ''3_7_sopv_15''
  FROM [TK_H9098_CSC].[dbo].[TK_3_7_sopv_15]
UNION ALL
SELECT [tilv]
      ,[lahde]
      ,[kmaak]
      ,[jarj]
      ,[koulk]
      ,[ophal]
      ,[tutkmaak]
      ,[tutkjarj]
      ,[tutkkoulk]
      ,[seurvkmaak]
      ,[seurvjarj]
      ,[seurvkoulk]
      ,[lkm]
      ,[luontipvm]
	  ,tietolahde = ''3_7_sopv_16''
  FROM [TK_H9098_CSC].[dbo].[TK_3_7_sopv_16]) kaikkivuodet





' 
GO
/****** Object:  View [dbo].[v_sa_3_8_tutkinnon_suorittaneiden_osuus_aloittaneista_erityisopiskelijat]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_3_8_tutkinnon_suorittaneiden_osuus_aloittaneista_erityisopiskelijat]'))
EXEC dbo.sp_executesql @statement = N'








CREATE VIEW [dbo].[v_sa_3_8_tutkinnon_suorittaneiden_osuus_aloittaneista_erityisopiskelijat] AS
SELECT [tilv] = CAST(tilv as nvarchar(4))
      ,[lahde] = CAST(COALESCE(NULLIF(lahde , ''''), ''-1'') as nvarchar(2))
      ,[alvv] = CAST(COALESCE(NULLIF(alvv , ''''), ''-1'') as int)
      ,[jarj] = CAST(COALESCE(NULLIF(jarj, ''''), ''-1'') as nvarchar(10))
      ,[opmala] = CAST(COALESCE(NULLIF(opmala, ''''), ''-1'') as nvarchar(2))
      ,[kmaak] = CAST(COALESCE(NULLIF((SELECT [maakunta_koodi_nykytila] FROM [VipunenTK_lisatiedot].[dbo].[alueluokitus_maakunta_korjaus] WHERE [maakunta_koodi] = kmaak), ''''), NULLIF(kmaak , ''''), ''-1'') as nvarchar(2))
      ,[suorv] = CAST(COALESCE(NULLIF(suorv , ''''), ''-1'') as int)
      ,[suoropmala] = CAST(COALESCE(NULLIF(suoropmala, ''''), ''-1'') as nvarchar(2))
      ,[suortutk] = CAST(COALESCE(NULLIF(suortutk, ''''), ''-1'') as nvarchar(2))
      ,[lkm] = CAST(lkm as int)
	  ,tietolahde
FROM
(SELECT [tilv]
      ,[lahde]
      ,[alvv]
      ,[jarj]
      ,[opmala]
      ,[kmaak]
      ,[suorv]
      ,[suoropmala]
      ,[suortutk]
      ,[lkm]
      ,[luontipvm]
	  ,tietolahde = ''3_8_2011_sopv_13''
  FROM [TK_H9098_CSC].[dbo].[TK_3_8_2011_sopv_13]
UNION ALL
SELECT [tilv]
      ,[lahde]
      ,[alvv]
      ,[jarj]
      ,[opmala]
      ,[kmaak]
      ,[suorv]
      ,[suoropmala]
      ,[suortutk]
      ,[lkm]
      ,[luontipvm]
	  ,tietolahde = ''3_8_2012_sopv_13''
  FROM [TK_H9098_CSC].[dbo].[TK_3_8_2012_sopv_13]
UNION ALL
SELECT [tilv]
      ,[lahde]
      ,[alvv]
      ,[jarj]
      ,[opmala]
      ,[kmaak]
      ,[suorv]
      ,[suoropmala]
      ,[suortutk]
      ,[lkm]
      ,[luontipvm]
	  ,tietolahde = ''3_8_sopv_12''
  FROM [TK_H9098_CSC].[dbo].[TK_3_8_sopv_12]
UNION ALL
SELECT [tilv]
      ,[lahde]
      ,[alvv]
      ,[jarj]
      ,[opmala]
      ,[kmaak]
      ,[suorv]
      ,[suoropmala]
      ,[suortutk]
      ,[lkm]
      ,[luontipvm]
	  ,tietolahde = ''3_8_sopv_15''
  FROM [TK_H9098_CSC].[dbo].[TK_3_8_sopv_15]
UNION ALL
SELECT [tilv]
      ,[lahde]
      ,[alvv]
      ,[jarj]
      ,[opmala]
      ,[kmaak]
      ,[suorv]
      ,[suoropmala]
      ,[suortutk]
      ,[lkm]
      ,[luontipvm]
	  ,tietolahde = ''3_8_sopv_16''
  FROM [TK_H9098_CSC].[dbo].[TK_3_8_sopv_16]) kaikkivuodet







' 
GO
/****** Object:  View [dbo].[v_sa_4_1_Perusopetuksen_lisäopetuksen_päättäneiden_sijoittuminen]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_4_1_Perusopetuksen_lisäopetuksen_päättäneiden_sijoittuminen]'))
EXEC dbo.sp_executesql @statement = N'






CREATE VIEW [dbo].[v_sa_4_1_Perusopetuksen_lisäopetuksen_päättäneiden_sijoittuminen] AS

/*
Drop table [VipunenTK_DW].[dbo].[sa_4_1_Perusopetuksen_lisäopetuksen_päättäneiden_sijoittuminen]
Select * into [VipunenTK_DW].[dbo].[sa_4_1_Perusopetuksen_lisäopetuksen_päättäneiden_sijoittuminen] FROM VipunenTK_SA.[dbo].[v_sa_4_1_Perusopetuksen_lisäopetuksen_päättäneiden_sijoittuminen]

Truncate table [VipunenTK_DW].[dbo].[sa_4_1_Perusopetuksen_lisäopetuksen_päättäneiden_sijoittuminen]
Insert into [VipunenTK_DW].[dbo].[sa_4_1_Perusopetuksen_lisäopetuksen_päättäneiden_sijoittuminen]
  Select * FROM VipunenTK_SA.[dbo].[v_sa_4_1_Perusopetuksen_lisäopetuksen_päättäneiden_sijoittuminen]
*/

SELECT [tilv] = CAST(kaikkivuodet.tilv as nvarchar(4))
	  ,[tilv_date] = Cast(kaikkivuodet.tilv+''0101'' as date)
      ,[sp] = CAST(kaikkivuodet.sp as nvarchar(10))
      ,[aikielir1] = CAST(kaikkivuodet.aikielir1 as nvarchar(2))
      ,[asmaak] = CAST(kaikkivuodet.asmaak as nvarchar(2))
      ,[asema] = CAST( CASE
		WHEN kaikkivuodet.asema = '''' THEN ''99'' 
		WHEN kaikkivuodet.asema = '' '' THEN ''99'' 
		WHEN kaikkivuodet.asema = ''bl'' THEN ''99'' 
		ELSE kaikkivuodet.asema
		END as nvarchar(10))
      ,[lkm] = CAST(kaikkivuodet.lkm as int)
      ,[tietolahde] = CAST(kaikkivuodet.tietolahde as nvarchar(50))
      ,[rivinumero] = CAST(kaikkivuodet.rivinumero as int)
  FROM (

SELECT [tilv]
      ,[sp]
      ,[aikielir1]
      ,[asmaak]
      ,[asema]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde]=''TK_4_1_sopv_11''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_4_1_sopv_11]

UNION ALL
SELECT [tilv]
      ,[sp]
      ,[aikielir1]
      ,[asmaak]
      ,[asema]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde]=''TK_4_1_sopv_12''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_4_1_sopv_12]

UNION ALL
SELECT [tilv]
      ,[sp]
      ,[aikielir1]
      ,[asmaak]
      ,[asema]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde]=''TK_4_1_sopv_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_4_1_sopv_13]

UNION ALL
SELECT [tilv]
      ,[sp]
      ,[aikielir1]
      ,[asmaak]
      ,[asema]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde]=''TK_4_1_sopv_14''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_4_1_sopv_14]

UNION ALL
SELECT [tilv]
      ,[sp]
      ,[aikielir1]
      ,[asmaak]
      ,[asema]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde]=''TK_4_1_sopv_15''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_4_1_sopv_15]

UNION ALL
SELECT [tilv]
      ,[sp]
      ,[aikielir1]
      ,[asmaak]
      ,[asema]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde]=''TK_4_1_sopv_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_4_1_sopv_16]

) kaikkivuodet







' 
GO
/****** Object:  View [dbo].[v_sa_4_10_Väestörakenne_äidinkielen_mukaan_maakunnittain]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_4_10_Väestörakenne_äidinkielen_mukaan_maakunnittain]'))
EXEC dbo.sp_executesql @statement = N'







CREATE VIEW [dbo].[v_sa_4_10_Väestörakenne_äidinkielen_mukaan_maakunnittain] AS

/*
Drop table [VipunenTK_DW].[dbo].[sa_4_10_Vaestorakenne_aidinkielen_mukaan_maakunnittain]
Select * into [VipunenTK_DW].[dbo].[sa_4_10_Vaestorakenne_aidinkielen_mukaan_maakunnittain] FROM VipunenTK_SA.[dbo].[v_sa_4_10_Väestörakenne_äidinkielen_mukaan_maakunnittain]

Truncate table [VipunenTK_DW].[dbo].[sa_4_10_Vaestorakenne_aidinkielen_mukaan_maakunnittain]
Insert into [VipunenTK_DW].[dbo].[sa_4_10_Vaestorakenne_aidinkielen_mukaan_maakunnittain]
  Select * FROM VipunenTK_SA.[dbo].[v_sa_4_10_Väestörakenne_äidinkielen_mukaan_maakunnittain]
*/

SELECT [tilv] = CAST(kaikkivuodet.tilv as nvarchar(4))
	  ,[tilv_date] = Cast(kaikkivuodet.tilv+''0101'' as date)
      ,[asmaak] = CAST(kaikkivuodet.asmaak as nvarchar(2))
      ,[aikielir3] = CAST(kaikkivuodet.aikielir3 as nvarchar(2))
      ,[kansalr1] = CAST(kaikkivuodet.kansalr1 as nvarchar(10))
      ,[eumaa] = CAST(kaikkivuodet.eumaa as nvarchar(2))
      ,[etamaa] = CAST(kaikkivuodet.etamaa as nvarchar(2))
      ,[ika0]
      ,[ika1]
      ,[ika2]
      ,[ika3]
      ,[ika4]
      ,[ika5]
      ,[ika6]
      ,[ika7]
      ,[ika8]
      ,[ika9]
      ,[ika10]
      ,[ika11]
      ,[ika12]
      ,[ika13]
      ,[ika14]
      ,[ika15]
      ,[ika16]
      ,[ika17]
      ,[ika18]
      ,[ika19]
      ,[ika20]
      ,[ika21]
      ,[ika22]
      ,[ika23]
      ,[ika24]
      ,[ika25]
      ,[ika26]
      ,[ika27]
      ,[ika28]
      ,[ika29]
      ,[ika30]
      ,[ika31]
      ,[ika32]
      ,[ika33]
      ,[ika34]
      ,[ika35]
      ,[ika36]
      ,[ika37]
      ,[ika38]
      ,[ika39]
      ,[ika40]
      ,[ika41]
      ,[ika42]
      ,[ika43]
      ,[ika44]
      ,[ika45]
      ,[ika46]
      ,[ika47]
      ,[ika48]
      ,[ika49]
      ,[ika50]
      ,[ika51]
      ,[ika52]
      ,[ika53]
      ,[ika54]
      ,[ika55]
      ,[ika56]
      ,[ika57]
      ,[ika58]
      ,[ika59]
      ,[ika60]
      ,[ika61]
      ,[ika62]
      ,[ika63]
      ,[ika64]
      ,[ika65]
      ,[ika66]
      ,[ika67]
      ,[ika68]
      ,[ika69]
      ,[ika70]
      ,[ika71]
      ,[ika72]
      ,[ika73]
      ,[ika74]
      ,[ika75]
      ,[ika76]
      ,[ika77]
      ,[ika78]
      ,[ika79]
      ,[ika80]
      ,[ika81]
      ,[ika82]
      ,[ika83]
      ,[ika84]
      ,[ika85]
      ,[ika86]
      ,[ika87]
      ,[ika88]
      ,[ika89]
      ,[ika90]
      ,[ika91]
      ,[ika92]
      ,[ika93]
      ,[ika94]
      ,[ika95]
      ,[ika96]
      ,[ika97]
      ,[ika98]
      ,[ika99]
      ,[ika100_]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde] = CAST(kaikkivuodet.tietolahde as nvarchar(50))
      ,[rivinumero] = CAST(kaikkivuodet.rivinumero as int)
  FROM (

SELECT [tilv]
      ,[asmaak]
      ,[aikielir3]
      ,[kansalr1]
      ,[eumaa]
      ,[etamaa]
      ,[ika0]
      ,[ika1]
      ,[ika2]
      ,[ika3]
      ,[ika4]
      ,[ika5]
      ,[ika6]
      ,[ika7]
      ,[ika8]
      ,[ika9]
      ,[ika10]
      ,[ika11]
      ,[ika12]
      ,[ika13]
      ,[ika14]
      ,[ika15]
      ,[ika16]
      ,[ika17]
      ,[ika18]
      ,[ika19]
      ,[ika20]
      ,[ika21]
      ,[ika22]
      ,[ika23]
      ,[ika24]
      ,[ika25]
      ,[ika26]
      ,[ika27]
      ,[ika28]
      ,[ika29]
      ,[ika30]
      ,[ika31]
      ,[ika32]
      ,[ika33]
      ,[ika34]
      ,[ika35]
      ,[ika36]
      ,[ika37]
      ,[ika38]
      ,[ika39]
      ,[ika40]
      ,[ika41]
      ,[ika42]
      ,[ika43]
      ,[ika44]
      ,[ika45]
      ,[ika46]
      ,[ika47]
      ,[ika48]
      ,[ika49]
      ,[ika50]
      ,[ika51]
      ,[ika52]
      ,[ika53]
      ,[ika54]
      ,[ika55]
      ,[ika56]
      ,[ika57]
      ,[ika58]
      ,[ika59]
      ,[ika60]
      ,[ika61]
      ,[ika62]
      ,[ika63]
      ,[ika64]
      ,[ika65]
      ,[ika66]
      ,[ika67]
      ,[ika68]
      ,[ika69]
      ,[ika70]
      ,[ika71]
      ,[ika72]
      ,[ika73]
      ,[ika74]
      ,[ika75]
      ,[ika76]
      ,[ika77]
      ,[ika78]
      ,[ika79]
      ,[ika80]
      ,[ika81]
      ,[ika82]
      ,[ika83]
      ,[ika84]
      ,[ika85]
      ,[ika86]
      ,[ika87]
      ,[ika88]
      ,[ika89]
      ,[ika90]
      ,[ika91]
      ,[ika92]
      ,[ika93]
      ,[ika94]
      ,[ika95]
      ,[ika96]
      ,[ika97]
      ,[ika98]
      ,[ika99]
      ,[ika100_]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde]=''TK_4_10_sopv_11''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv, asmaak, aikielir3)
  FROM [TK_H9098_CSC].[dbo].[TK_4_10_sopv_11]

UNION ALL
SELECT [tilv]
      ,[asmaak]
      ,[aikielir3]
      ,[kansalr1]
      ,[eumaa]
      ,[etamaa]
      ,[ika0]
      ,[ika1]
      ,[ika2]
      ,[ika3]
      ,[ika4]
      ,[ika5]
      ,[ika6]
      ,[ika7]
      ,[ika8]
      ,[ika9]
      ,[ika10]
      ,[ika11]
      ,[ika12]
      ,[ika13]
      ,[ika14]
      ,[ika15]
      ,[ika16]
      ,[ika17]
      ,[ika18]
      ,[ika19]
      ,[ika20]
      ,[ika21]
      ,[ika22]
      ,[ika23]
      ,[ika24]
      ,[ika25]
      ,[ika26]
      ,[ika27]
      ,[ika28]
      ,[ika29]
      ,[ika30]
      ,[ika31]
      ,[ika32]
      ,[ika33]
      ,[ika34]
      ,[ika35]
      ,[ika36]
      ,[ika37]
      ,[ika38]
      ,[ika39]
      ,[ika40]
      ,[ika41]
      ,[ika42]
      ,[ika43]
      ,[ika44]
      ,[ika45]
      ,[ika46]
      ,[ika47]
      ,[ika48]
      ,[ika49]
      ,[ika50]
      ,[ika51]
      ,[ika52]
      ,[ika53]
      ,[ika54]
      ,[ika55]
      ,[ika56]
      ,[ika57]
      ,[ika58]
      ,[ika59]
      ,[ika60]
      ,[ika61]
      ,[ika62]
      ,[ika63]
      ,[ika64]
      ,[ika65]
      ,[ika66]
      ,[ika67]
      ,[ika68]
      ,[ika69]
      ,[ika70]
      ,[ika71]
      ,[ika72]
      ,[ika73]
      ,[ika74]
      ,[ika75]
      ,[ika76]
      ,[ika77]
      ,[ika78]
      ,[ika79]
      ,[ika80]
      ,[ika81]
      ,[ika82]
      ,[ika83]
      ,[ika84]
      ,[ika85]
      ,[ika86]
      ,[ika87]
      ,[ika88]
      ,[ika89]
      ,[ika90]
      ,[ika91]
      ,[ika92]
      ,[ika93]
      ,[ika94]
      ,[ika95]
      ,[ika96]
      ,[ika97]
      ,[ika98]
      ,[ika99]
      ,[ika100_]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde]=''TK_4_10_sopv_12''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv, asmaak, aikielir3)
  FROM [TK_H9098_CSC].[dbo].[TK_4_10_sopv_12]

UNION ALL
SELECT [tilv]
      ,[asmaak]
      ,[aikielir3]
      ,[kansalr1]
      ,[eumaa]
      ,[etamaa]
      ,[ika0]
      ,[ika1]
      ,[ika2]
      ,[ika3]
      ,[ika4]
      ,[ika5]
      ,[ika6]
      ,[ika7]
      ,[ika8]
      ,[ika9]
      ,[ika10]
      ,[ika11]
      ,[ika12]
      ,[ika13]
      ,[ika14]
      ,[ika15]
      ,[ika16]
      ,[ika17]
      ,[ika18]
      ,[ika19]
      ,[ika20]
      ,[ika21]
      ,[ika22]
      ,[ika23]
      ,[ika24]
      ,[ika25]
      ,[ika26]
      ,[ika27]
      ,[ika28]
      ,[ika29]
      ,[ika30]
      ,[ika31]
      ,[ika32]
      ,[ika33]
      ,[ika34]
      ,[ika35]
      ,[ika36]
      ,[ika37]
      ,[ika38]
      ,[ika39]
      ,[ika40]
      ,[ika41]
      ,[ika42]
      ,[ika43]
      ,[ika44]
      ,[ika45]
      ,[ika46]
      ,[ika47]
      ,[ika48]
      ,[ika49]
      ,[ika50]
      ,[ika51]
      ,[ika52]
      ,[ika53]
      ,[ika54]
      ,[ika55]
      ,[ika56]
      ,[ika57]
      ,[ika58]
      ,[ika59]
      ,[ika60]
      ,[ika61]
      ,[ika62]
      ,[ika63]
      ,[ika64]
      ,[ika65]
      ,[ika66]
      ,[ika67]
      ,[ika68]
      ,[ika69]
      ,[ika70]
      ,[ika71]
      ,[ika72]
      ,[ika73]
      ,[ika74]
      ,[ika75]
      ,[ika76]
      ,[ika77]
      ,[ika78]
      ,[ika79]
      ,[ika80]
      ,[ika81]
      ,[ika82]
      ,[ika83]
      ,[ika84]
      ,[ika85]
      ,[ika86]
      ,[ika87]
      ,[ika88]
      ,[ika89]
      ,[ika90]
      ,[ika91]
      ,[ika92]
      ,[ika93]
      ,[ika94]
      ,[ika95]
      ,[ika96]
      ,[ika97]
      ,[ika98]
      ,[ika99]
      ,[ika100_]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde]=''TK_4_10_sopv_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv, asmaak, aikielir3)
  FROM [TK_H9098_CSC].[dbo].[TK_4_10_sopv_13]

UNION ALL
SELECT [tilv]
      ,[asmaak]
      ,[aikielir3]
      ,[kansalr1]
      ,[eumaa]
      ,[etamaa]
      ,[ika0]
      ,[ika1]
      ,[ika2]
      ,[ika3]
      ,[ika4]
      ,[ika5]
      ,[ika6]
      ,[ika7]
      ,[ika8]
      ,[ika9]
      ,[ika10]
      ,[ika11]
      ,[ika12]
      ,[ika13]
      ,[ika14]
      ,[ika15]
      ,[ika16]
      ,[ika17]
      ,[ika18]
      ,[ika19]
      ,[ika20]
      ,[ika21]
      ,[ika22]
      ,[ika23]
      ,[ika24]
      ,[ika25]
      ,[ika26]
      ,[ika27]
      ,[ika28]
      ,[ika29]
      ,[ika30]
      ,[ika31]
      ,[ika32]
      ,[ika33]
      ,[ika34]
      ,[ika35]
      ,[ika36]
      ,[ika37]
      ,[ika38]
      ,[ika39]
      ,[ika40]
      ,[ika41]
      ,[ika42]
      ,[ika43]
      ,[ika44]
      ,[ika45]
      ,[ika46]
      ,[ika47]
      ,[ika48]
      ,[ika49]
      ,[ika50]
      ,[ika51]
      ,[ika52]
      ,[ika53]
      ,[ika54]
      ,[ika55]
      ,[ika56]
      ,[ika57]
      ,[ika58]
      ,[ika59]
      ,[ika60]
      ,[ika61]
      ,[ika62]
      ,[ika63]
      ,[ika64]
      ,[ika65]
      ,[ika66]
      ,[ika67]
      ,[ika68]
      ,[ika69]
      ,[ika70]
      ,[ika71]
      ,[ika72]
      ,[ika73]
      ,[ika74]
      ,[ika75]
      ,[ika76]
      ,[ika77]
      ,[ika78]
      ,[ika79]
      ,[ika80]
      ,[ika81]
      ,[ika82]
      ,[ika83]
      ,[ika84]
      ,[ika85]
      ,[ika86]
      ,[ika87]
      ,[ika88]
      ,[ika89]
      ,[ika90]
      ,[ika91]
      ,[ika92]
      ,[ika93]
      ,[ika94]
      ,[ika95]
      ,[ika96]
      ,[ika97]
      ,[ika98]
      ,[ika99]
      ,[ika100_]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde]=''TK_4_10_sopv_14''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv, asmaak, aikielir3)
  FROM [TK_H9098_CSC].[dbo].[TK_4_10_sopv_14]

UNION ALL
SELECT [tilv]
      ,[asmaak]
      ,[aikielir3]
      ,[kansalr1]
      ,[eumaa]
      ,[etamaa]
      ,[ika0]
      ,[ika1]
      ,[ika2]
      ,[ika3]
      ,[ika4]
      ,[ika5]
      ,[ika6]
      ,[ika7]
      ,[ika8]
      ,[ika9]
      ,[ika10]
      ,[ika11]
      ,[ika12]
      ,[ika13]
      ,[ika14]
      ,[ika15]
      ,[ika16]
      ,[ika17]
      ,[ika18]
      ,[ika19]
      ,[ika20]
      ,[ika21]
      ,[ika22]
      ,[ika23]
      ,[ika24]
      ,[ika25]
      ,[ika26]
      ,[ika27]
      ,[ika28]
      ,[ika29]
      ,[ika30]
      ,[ika31]
      ,[ika32]
      ,[ika33]
      ,[ika34]
      ,[ika35]
      ,[ika36]
      ,[ika37]
      ,[ika38]
      ,[ika39]
      ,[ika40]
      ,[ika41]
      ,[ika42]
      ,[ika43]
      ,[ika44]
      ,[ika45]
      ,[ika46]
      ,[ika47]
      ,[ika48]
      ,[ika49]
      ,[ika50]
      ,[ika51]
      ,[ika52]
      ,[ika53]
      ,[ika54]
      ,[ika55]
      ,[ika56]
      ,[ika57]
      ,[ika58]
      ,[ika59]
      ,[ika60]
      ,[ika61]
      ,[ika62]
      ,[ika63]
      ,[ika64]
      ,[ika65]
      ,[ika66]
      ,[ika67]
      ,[ika68]
      ,[ika69]
      ,[ika70]
      ,[ika71]
      ,[ika72]
      ,[ika73]
      ,[ika74]
      ,[ika75]
      ,[ika76]
      ,[ika77]
      ,[ika78]
      ,[ika79]
      ,[ika80]
      ,[ika81]
      ,[ika82]
      ,[ika83]
      ,[ika84]
      ,[ika85]
      ,[ika86]
      ,[ika87]
      ,[ika88]
      ,[ika89]
      ,[ika90]
      ,[ika91]
      ,[ika92]
      ,[ika93]
      ,[ika94]
      ,[ika95]
      ,[ika96]
      ,[ika97]
      ,[ika98]
      ,[ika99]
      ,[ika100_]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde]=''TK_4_10_sopv_15''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv, asmaak, aikielir3)
  FROM [TK_H9098_CSC].[dbo].[TK_4_10_sopv_15]

UNION ALL
SELECT [tilv]
      ,[asmaak]
      ,[aikielir3]
      ,[kansalr1]
      ,[eumaa]
      ,[etamaa]
      ,[ika0]
      ,[ika1]
      ,[ika2]
      ,[ika3]
      ,[ika4]
      ,[ika5]
      ,[ika6]
      ,[ika7]
      ,[ika8]
      ,[ika9]
      ,[ika10]
      ,[ika11]
      ,[ika12]
      ,[ika13]
      ,[ika14]
      ,[ika15]
      ,[ika16]
      ,[ika17]
      ,[ika18]
      ,[ika19]
      ,[ika20]
      ,[ika21]
      ,[ika22]
      ,[ika23]
      ,[ika24]
      ,[ika25]
      ,[ika26]
      ,[ika27]
      ,[ika28]
      ,[ika29]
      ,[ika30]
      ,[ika31]
      ,[ika32]
      ,[ika33]
      ,[ika34]
      ,[ika35]
      ,[ika36]
      ,[ika37]
      ,[ika38]
      ,[ika39]
      ,[ika40]
      ,[ika41]
      ,[ika42]
      ,[ika43]
      ,[ika44]
      ,[ika45]
      ,[ika46]
      ,[ika47]
      ,[ika48]
      ,[ika49]
      ,[ika50]
      ,[ika51]
      ,[ika52]
      ,[ika53]
      ,[ika54]
      ,[ika55]
      ,[ika56]
      ,[ika57]
      ,[ika58]
      ,[ika59]
      ,[ika60]
      ,[ika61]
      ,[ika62]
      ,[ika63]
      ,[ika64]
      ,[ika65]
      ,[ika66]
      ,[ika67]
      ,[ika68]
      ,[ika69]
      ,[ika70]
      ,[ika71]
      ,[ika72]
      ,[ika73]
      ,[ika74]
      ,[ika75]
      ,[ika76]
      ,[ika77]
      ,[ika78]
      ,[ika79]
      ,[ika80]
      ,[ika81]
      ,[ika82]
      ,[ika83]
      ,[ika84]
      ,[ika85]
      ,[ika86]
      ,[ika87]
      ,[ika88]
      ,[ika89]
      ,[ika90]
      ,[ika91]
      ,[ika92]
      ,[ika93]
      ,[ika94]
      ,[ika95]
      ,[ika96]
      ,[ika97]
      ,[ika98]
      ,[ika99]
      ,[ika100_]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde]=''TK_4_10_sopv_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv, asmaak, aikielir3)
  FROM [TK_H9098_CSC].[dbo].[TK_4_10_sopv_16]

) kaikkivuodet

' 
GO
/****** Object:  View [dbo].[v_sa_4_11_Vaeston_maassamuutto_asuinmaakunnan_ja_koulutuksen_mukaan]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_4_11_Vaeston_maassamuutto_asuinmaakunnan_ja_koulutuksen_mukaan]'))
EXEC dbo.sp_executesql @statement = N'







CREATE VIEW [dbo].[v_sa_4_11_Vaeston_maassamuutto_asuinmaakunnan_ja_koulutuksen_mukaan] AS

/*
Drop table [VipunenTK_DW].[dbo].[sa_4_11_Vaeston_maassamuutto_asuinmaakunnan_ja_koulutuksen_mukaan]
Select * into [VipunenTK_DW].[dbo].[sa_4_11_Vaeston_maassamuutto_asuinmaakunnan_ja_koulutuksen_mukaan] FROM VipunenTK_SA.[dbo].[v_sa_4_11_Vaeston_maassamuutto_asuinmaakunnan_ja_koulutuksen_mukaan]

Truncate table [VipunenTK_DW].[dbo].[sa_4_11_Vaeston_maassamuutto_asuinmaakunnan_ja_koulutuksen_mukaan]
Insert into [VipunenTK_DW].[dbo].[sa_4_11_Vaeston_maassamuutto_asuinmaakunnan_ja_koulutuksen_mukaan]
  Select * FROM VipunenTK_SA.[dbo].[v_sa_4_11_Vaeston_maassamuutto_asuinmaakunnan_ja_koulutuksen_mukaan]
*/

SELECT [tilv] = CAST(kaikkivuodet.tilv as nvarchar(4))
	  ,[tilv_date] = Cast(kaikkivuodet.tilv+''0101'' as date)
      ,[asmaak] = CAST(kaikkivuodet.asmaak as nvarchar(2))
      ,[koulk] = CAST(kaikkivuodet.koulk as nvarchar(6))
      ,[ulosmuutto] = CAST(kaikkivuodet.ulosmuutto as int)
      ,[sisaanmuutto] = CAST(kaikkivuodet.sisaanmuutto as int)
      ,[tietolahde] = CAST(kaikkivuodet.tietolahde as nvarchar(50))
      ,[rivinumero] = CAST(kaikkivuodet.rivinumero as int)
  FROM (

SELECT [tilv]
      ,[asmaak]
      ,[koulk]
      ,[sisaanmuutto]
      ,[ulosmuutto]
      ,[luontipvm]
      ,[tietolahde]=''TK_4_11_sopv_11''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv, asmaak, koulk)
FROM [TK_H9098_CSC].[dbo].[TK_4_11_sopv_11]

UNION ALL
SELECT [tilv]
      ,[asmaak]
      ,[koulk]
      ,[sisaanmuutto]
      ,[ulosmuutto]
      ,[luontipvm]
      ,[tietolahde]=''TK_4_11_sopv_12''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv, asmaak, koulk)
FROM [TK_H9098_CSC].[dbo].[TK_4_11_sopv_12]

UNION ALL
SELECT [tilv]
      ,[asmaak]
      ,[koulk]
      ,[sisaanmuutto]
      ,[ulosmuutto]
      ,[luontipvm]
      ,[tietolahde]=''TK_4_11_sopv_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv, asmaak, koulk)
FROM [TK_H9098_CSC].[dbo].[TK_4_11_sopv_13]

--UNION ALL
--SELECT [tilv]
--      ,[asmaak]
--      ,[koulk]
--      ,[sisaanmuutto]
--      ,[ulosmuutto]
--      ,[luontipvm]
--      ,[tietolahde]=''TK_4_11_sopv_14''
--      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv, asmaak, koulk)
--FROM [TK_H9098_CSC].[dbo].[TK_4_11_sopv_14]

UNION ALL
SELECT [tilv]
      ,[asmaak]
      ,[koulk]
      ,[sisaanmuutto]
      ,[ulosmuutto]
      ,[luontipvm]
      ,[tietolahde]=''TK_4_11_sopv_15''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv, asmaak, koulk)
FROM [TK_H9098_CSC].[dbo].[TK_4_11_sopv_15]

UNION ALL
SELECT [tilv]
      ,[asmaak]
      ,[koulk]
      ,[sisaanmuutto]
      ,[ulosmuutto]
      ,[luontipvm]
      ,[tietolahde]=''TK_4_11_sopv_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv, asmaak, koulk)
FROM [TK_H9098_CSC].[dbo].[TK_4_11_sopv_16]

) kaikkivuodet

' 
GO
/****** Object:  View [dbo].[v_sa_4_2_Vaeston_koulutusrakenne_ja_paaasiallinen_toiminta]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_4_2_Vaeston_koulutusrakenne_ja_paaasiallinen_toiminta]'))
EXEC dbo.sp_executesql @statement = N'






CREATE VIEW [dbo].[v_sa_4_2_Vaeston_koulutusrakenne_ja_paaasiallinen_toiminta] AS
SELECT
	tilv= cast(kaikkivuodet.tilv as nvarchar(4))
	,tilv_date = cast(kaikkivuodet.tilv+''0101'' as date)
    ,aineisto = cast(kaikkivuodet.aineisto as nvarchar(2))
    ,sp= cast(kaikkivuodet.sp as nvarchar(1))
    ,aikielir1 = cast(kaikkivuodet.aikielir1 as nvarchar(2))
    ,syntv= cast(kaikkivuodet.syntv as nvarchar(4))
    ,tilvasmaak= cast(kaikkivuodet.tilvasmaak as nvarchar(3))
    ,kansalr1= cast(kaikkivuodet.kansalr1 as nvarchar(1))
    ,pohjmaa = cast(kaikkivuodet.pohjmaa as nvarchar(1))
    ,eumaa= cast(kaikkivuodet.eumaa as nvarchar(1))
    ,etamaa = cast(kaikkivuodet.etamaa as nvarchar(1))
    ,suorv = cast(kaikkivuodet.suorv as nvarchar(4))
    ,suormaak = cast(kaikkivuodet.suormaak as nvarchar(2))
    ,koulk = cast(kaikkivuodet.koulk as nvarchar(6))
    ,kouljat = cast(kaikkivuodet.kouljat as nvarchar(1))
    ,oppis = cast(kaikkivuodet.oppis as nvarchar(1))
    ,tutklaja_tr = cast(kaikkivuodet.tutklaja_tr as nvarchar(1))
    ,[ptoim1r6]= cast(kaikkivuodet.ptoim1r6 as nvarchar(2))
    ,[amm2001]= cast(kaikkivuodet.amm2001 as nvarchar(2))
    ,[amm2010]= cast(kaikkivuodet.amm2010 as nvarchar(2))
    ,[tsekt]= cast(kaikkivuodet.tsekt as nvarchar(2))
    ,[lkm]= cast(kaikkivuodet.lkm as int)
    ,tietolahde = cast(kaikkivuodet.tietolahde as nvarchar(50))
    ,rivinumero = cast(kaikkivuodet.rivinumero as int)
FROM (

SELECT [tilv]
      ,[aineisto]
      ,[sp]
      ,[aikielir1]
	  ,(CASE WHEN [syntv] = ''BBBB'' THEN ''''
      ELSE [syntv] END) AS syntv
      ,[tilvasmaak]
      ,[kansalr1]
      ,[pohjmaa]
      ,[eumaa]
      ,[etamaa]
	  ,(CASE WHEN [suorv] = ''BBBB'' THEN ''''
      ELSE [suorv] END) AS suorv
      ,[suormaak]
      ,[koulk]
      ,[kouljat]
      ,[oppis]
      ,[tutklaja_tr]
      ,[ptoim1r6]
      ,[amm2001] 
      ,[amm2010]= NULL
      ,[tsekt]
      ,[lkm]
      ,[tietolahde]=''4_2a_sopv_11''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_4_2a_sopv_11]
union all
SELECT [tilv]
      ,[aineisto]
      ,[sp]
      ,[aikielir1]
	   ,(CASE WHEN [syntv] = ''BBBB'' THEN ''''
      ELSE [syntv] END) AS syntv
      ,[tilvasmaak]
      ,[kansalr1]
      ,[pohjmaa]
      ,[eumaa]
      ,[etamaa]
	  , (CASE WHEN [suorv] = ''BBBB'' THEN ''''
      ELSE [suorv] END) AS suorv
      ,[suormaak]
      ,[koulk]
      ,[kouljat]
      ,[oppis]
      ,[tutklaja_tr]
      ,[ptoim1r6]
      ,[amm2001]= NULL
      ,[amm2010]
      ,[tsekt]
      ,[lkm]
      ,[tietolahde]=''4_2a_sopv_12''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_4_2a_sopv_12]
  union all
  SELECT [tilv]
      ,[aineisto]
      ,[sp]
      ,[aikielir1]
	  , (CASE WHEN [syntv] = ''BBBB'' THEN ''''
      ELSE [syntv] END) AS syntv
      ,[tilvasmaak]
      ,[kansalr1]
      ,[pohjmaa]
      ,[eumaa]
      ,[etamaa]
	  , (CASE WHEN [suorv] = ''BBBB'' THEN ''''
      ELSE [suorv] END) AS suorv
      ,[suormaak]
      ,[koulk]
      ,[kouljat]
      ,[oppis]
      ,[tutklaja_tr]
      ,[ptoim1r6]
      ,[amm2001] = NULL
      ,[amm2010]
      ,[tsekt]
      ,[lkm]
      ,[tietolahde]=''4_2a_sopv_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_4_2a_sopv_13]
  union all
  SELECT [tilv]
      ,[aineisto]
      ,[sp]
      ,[aikielir1]
	   ,(CASE WHEN [syntv] = ''BBBB'' THEN ''''
      ELSE [syntv] END) AS syntv
      ,[tilvasmaak]
      ,[kansalr1]
      ,[pohjmaa]
      ,[eumaa]
      ,[etamaa]
	   ,(CASE WHEN [suorv] = ''BBBB'' THEN ''''
      ELSE [suorv] END) AS suorv
      ,[suormaak]
      ,[koulk]
      ,[kouljat]
      ,[oppis]
      ,[tutklaja_tr]
      ,[ptoim1r6]
      ,[amm2001] = NULL
      ,[amm2010]
      ,[tsekt]
      ,[lkm]
      ,[tietolahde]=''4_2a_sopv_14''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_4_2a_sopv_14]
  union all
  SELECT [tilv]
      ,[aineisto]
      ,[sp]
      ,[aikielir1]
	   ,(CASE WHEN [syntv] = ''BBBB'' THEN ''''
      ELSE [syntv] END) AS syntv
      ,[tilvasmaak]
      ,[kansalr1]
      ,[pohjmaa]
      ,[eumaa]
      ,[etamaa]
	   ,(CASE WHEN [suorv] = ''BBBB'' THEN ''''
      ELSE [suorv] END) AS suorv
      ,[suormaak]
      ,[koulk]
      ,[kouljat]
      ,[oppis]
      ,[tutklaja_tr]
      ,[ptoim1r6]
      ,[amm2001] = NULL
      ,[amm2010]
      ,[tsekt]
      ,[lkm]
      ,[tietolahde]=''4_2a_sopv_15''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_4_2a_sopv_15]
  union all
  SELECT [tilv]
      ,[aineisto]
      ,[sp]
      ,[aikielir1]
	   ,(CASE WHEN [syntv] = ''BBBB'' THEN ''''
      ELSE [syntv] END) AS syntv
      ,[tilvasmaak]
      ,[kansalr1]
      ,[pohjmaa]
      ,[eumaa]
      ,[etamaa]
	   ,(CASE WHEN [suorv] = ''BBBB'' THEN ''''
      ELSE [suorv] END) AS suorv
      ,[suormaak]
      ,[koulk]
      ,[kouljat]
      ,[oppis]
      ,[tutklaja_tr]
      ,[ptoim1r6]
      ,[amm2001] = NULL
      ,[amm2010]
      ,[tsekt]
      ,[lkm]
      ,[tietolahde]=''4_2a_sopv_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_4_2a_sopv_16]
  union all
  SELECT [tilv]
      ,[aineisto]
      ,[sp]
      ,[aikielir1]
	   ,(CASE WHEN [syntv] = ''BBBB'' THEN ''''
      ELSE [syntv] END) AS syntv
      ,[tilvasmaak]
      ,[kansalr1]
      ,[pohjmaa]
      ,[eumaa]
      ,[etamaa]
	  , (CASE WHEN [suorv] = ''BBBB'' THEN ''''
      ELSE [suorv] END) AS suorv
      ,[suormaak]
      ,[koulk]
      ,[kouljat]
      ,[oppis]
      ,[tutklaja_tr]
      ,[ptoim1r6]=NULL
      ,[amm2001] = NULL
      ,[amm2010]= NULL
      ,[tsekt]= NULL
      ,[lkm]
      ,[tietolahde]=''4_2b_sopv_11''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_4_2b_sopv_11]
  union all
  SELECT [tilv]
      ,[aineisto]
      ,[sp]
      ,[aikielir1]
	   ,(CASE WHEN [syntv] = ''BBBB'' THEN ''''
      ELSE [syntv] END) AS syntv
      ,[tilvasmaak]
      ,[kansalr1]
      ,[pohjmaa]
      ,[eumaa]
      ,[etamaa]
	   ,(CASE WHEN [suorv] = ''BBBB'' THEN ''''
      ELSE [suorv] END) AS suorv
      ,[suormaak]
      ,[koulk]
      ,[kouljat]
      ,[oppis]
      ,[tutklaja_tr]
      ,[ptoim1r6]= NULL
      ,[amm2001] = NULL
      ,[amm2010]= NULL
      ,[tsekt]= NULL
      ,[lkm]
      ,[tietolahde]=''4_2b_sopv_12''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_4_2b_sopv_12]
  union all
  SELECT [tilv]
      ,[aineisto]
      ,[sp]
      ,[aikielir1]
	   ,(CASE WHEN [syntv] = ''BBBB'' THEN ''''
      ELSE [syntv] END) AS syntv
      ,[tilvasmaak]
      ,[kansalr1]
      ,[pohjmaa]
      ,[eumaa]
      ,[etamaa]
	  , (CASE WHEN [suorv] = ''BBBB'' THEN ''''
      ELSE [suorv] END) AS suorv
      ,[suormaak]
      ,[koulk]
      ,[kouljat]
      ,[oppis]
      ,[tutklaja_tr]
      ,[ptoim1r6]= NULL
      ,[amm2001] = NULL
      ,[amm2010]= NULL
      ,[tsekt]= NULL
      ,[lkm]
      ,[tietolahde]=''4_2b_sopv_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_4_2b_sopv_13]
   union all
  SELECT [tilv]
      ,[aineisto]
      ,[sp]
      ,[aikielir1]
	  , (CASE WHEN [syntv] = ''BBBB'' THEN ''''
      ELSE [syntv] END) AS syntv
      ,[tilvasmaak]
      ,[kansalr1]
      ,[pohjmaa]
      ,[eumaa]
      ,[etamaa]
	  , (CASE WHEN [suorv] = ''BBBB'' THEN ''''
      ELSE [suorv] END) AS suorv
      ,[suormaak]
      ,[koulk]
      ,[kouljat]
      ,[oppis]
      ,[tutklaja_tr]
      ,[ptoim1r6]= NULL
      ,[amm2001] = NULL
      ,[amm2010]= NULL
      ,[tsekt]= NULL
      ,[lkm]
      ,[tietolahde]=''4_2b_sopv_14''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_4_2b_sopv_14]
   union all
  SELECT [tilv]
      ,[aineisto]
      ,[sp]
      ,[aikielir1]
	  , (CASE WHEN [syntv] = ''BBBB'' THEN ''''
      ELSE [syntv] END) AS syntv
      ,[tilvasmaak]
      ,[kansalr1]
      ,[pohjmaa]
      ,[eumaa]
      ,[etamaa]
	  , (CASE WHEN [suorv] = ''BBBB'' THEN ''''
      ELSE [suorv] END) AS suorv
      ,[suormaak]
      ,[koulk]
      ,[kouljat]
      ,[oppis]
      ,[tutklaja_tr]
      ,[ptoim1r6]= NULL
      ,[amm2001] = NULL
      ,[amm2010]= NULL
      ,[tsekt]= NULL
      ,[lkm]
      ,[tietolahde]=''4_2b_sopv_15''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_4_2b_sopv_15]
   union all
  SELECT [tilv]
      ,[aineisto]
      ,[sp]
      ,[aikielir1]
	  , (CASE WHEN [syntv] = ''BBBB'' THEN ''''
      ELSE [syntv] END) AS syntv
      ,[tilvasmaak]
      ,[kansalr1]
      ,[pohjmaa]
      ,[eumaa]
      ,[etamaa]
	  , (CASE WHEN [suorv] = ''BBBB'' THEN ''''
      ELSE [suorv] END) AS suorv
      ,[suormaak]
      ,[koulk]
      ,[kouljat]
      ,[oppis]
      ,[tutklaja_tr]
      ,[ptoim1r6]= NULL
      ,[amm2001] = NULL
      ,[amm2010]= NULL
      ,[tsekt]= NULL
      ,[lkm]
      ,[tietolahde]=''4_2b_sopv_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_4_2b_sopv_16]
  union all
  SELECT [tilv]
      ,[aineisto]
      ,[sp]
      ,[aikielir1]
	  , (CASE WHEN [syntv] = ''BBBB'' THEN ''''
      ELSE [syntv] END) AS syntv
      ,[tilvasmaak]
      ,[kansalr1]
      ,[pohjmaa]
      ,[eumaa]
      ,[etamaa]
	  , (CASE WHEN [suorv] = ''BBBB'' THEN ''''
      ELSE [suorv] END) AS suorv
      ,[suormaak]
      ,[koulk]
      ,[kouljat]
      ,[oppis]
      ,[tutklaja_tr]
      ,[ptoim1r6]
      ,[amm2001] = NULL
      ,[amm2010]= NULL
      ,[tsekt]= NULL
      ,[lkm]
      ,[tietolahde]=''4_2c_sopv_12''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_4_2c_sopv_12]
  union all
  /****** Script for SelectTopNRows command from SSMS  ******/
SELECT [tilv]
      ,[aineisto]
      ,[sp]
      ,[aikielir1]
	  , (CASE WHEN [syntv] = ''BBBB'' THEN ''''
      ELSE [syntv] END) AS syntv
      ,[tilvasmaak]
      ,[kansalr1]
      ,[pohjmaa]
      ,[eumaa]
      ,[etamaa]
	  , (CASE WHEN [suorv] = ''BBBB'' THEN ''''
      ELSE [suorv] END) AS suorv
      ,[suormaak]
      ,[koulk]
      ,[kouljat]
      ,[oppis]
      ,[tutklaja_tr]
      ,[ptoim1r6]
      ,[amm2001] = NULL
      ,[amm2010]= NULL
      ,[tsekt]= NULL
      ,[lkm]
      ,[tietolahde]=''4_2c_sopv_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_4_2c_sopv_13]
  union all
  SELECT [tilv]
      ,[aineisto]
      ,[sp]
      ,[aikielir1]
	  , (CASE WHEN [syntv] = ''BBBB'' THEN ''''
      ELSE [syntv] END) AS syntv
      ,[tilvasmaak]
      ,[kansalr1]
      ,[pohjmaa]
      ,[eumaa]
      ,[etamaa]
	  , (CASE WHEN [suorv] = ''BBBB'' THEN ''''
      ELSE [suorv] END) AS suorv
      ,[suormaak]
      ,[koulk]
      ,[kouljat]
      ,[oppis]
      ,[tutklaja_tr]
      ,[ptoim1r6]
      ,[amm2001] = NULL
      ,[amm2010]= NULL
      ,[tsekt]= NULL
      ,[lkm]
      ,[tietolahde]=''4_2c_sopv_14''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_4_2c_sopv_14]
  union all
  SELECT [tilv]
      ,[aineisto]
      ,[sp]
      ,[aikielir1]
	  , (CASE WHEN [syntv] = ''BBBB'' THEN ''''
      ELSE [syntv] END) AS syntv
      ,[tilvasmaak]
      ,[kansalr1]
      ,[pohjmaa]
      ,[eumaa]
      ,[etamaa]
	  , (CASE WHEN [suorv] = ''BBBB'' THEN ''''
      ELSE [suorv] END) AS suorv
      ,[suormaak]
      ,[koulk]
      ,[kouljat]
      ,[oppis]
      ,[tutklaja_tr]
      ,[ptoim1r6]
      ,[amm2001] = NULL
      ,[amm2010]= NULL
      ,[tsekt]= NULL
      ,[lkm]
      ,[tietolahde]=''4_2c_sopv_15''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_4_2c_sopv_15]
  union all
  SELECT [tilv]
      ,[aineisto]
      ,[sp]
      ,[aikielir1]
	  , (CASE WHEN [syntv] = ''BBBB'' THEN ''''
      ELSE [syntv] END) AS syntv
      ,[tilvasmaak]
      ,[kansalr1]
      ,[pohjmaa]
      ,[eumaa]
      ,[etamaa]
	  , (CASE WHEN [suorv] = ''BBBB'' THEN ''''
      ELSE [suorv] END) AS suorv
      ,[suormaak]
      ,[koulk]
      ,[kouljat]
      ,[oppis]
      ,[tutklaja_tr]
      ,[ptoim1r6]
      ,[amm2001] = NULL
      ,[amm2010]= NULL
      ,[tsekt]= NULL
      ,[lkm]
      ,[tietolahde]=''4_2c_sopv_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_4_2c_sopv_16]
  ) as kaikkivuodet







' 
GO
/****** Object:  View [dbo].[v_sa_4_21_Vaestoennuste]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_4_21_Vaestoennuste]'))
EXEC dbo.sp_executesql @statement = N'









/*
select * into VipunenTK_DW.dbo.f_4_21_Vaestoennuste from VipunenTK_SA.dbo.[v_sa_4_21_Vaestoennuste]
*/



CREATE VIEW [dbo].[v_sa_4_21_Vaestoennuste] AS


SELECT [ennv]
      ,[tilvaskun]
      ,[sp]
      ,[ika2] = 
				case 
					when ltrim([ika2]) between 95 and 99 then ltrim([ika2])+''v2''
					else ltrim([ika2])
				end
      ,[lkm]
      
  FROM [TK_H9098_CSC].[dbo].[TK_4_21_sopv_15]

  










' 
GO
/****** Object:  View [dbo].[v_sa_4_3_Tutkinnon_suorittaneiden_paaasiallinen_toiminta]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_4_3_Tutkinnon_suorittaneiden_paaasiallinen_toiminta]'))
EXEC dbo.sp_executesql @statement = N'







CREATE VIEW [dbo].[v_sa_4_3_Tutkinnon_suorittaneiden_paaasiallinen_toiminta] AS
SELECT
	 tilv = cast(kaikkivuodet.tilv as nvarchar(4))
	,tilv_date = cast(kaikkivuodet.tilv+''0101'' as date)
	,aineisto = cast(kaikkivuodet.aineisto as nvarchar(2))
	,tilvasmaak = cast(coalesce(nullif(kaikkivuodet.tilvasmaak,''''),''-1'') as nvarchar(2))
	,aiopis = cast(coalesce(nullif(kaikkivuodet.aiopis,''9''),''-1'') as nvarchar(2))
	,suorv = cast(kaikkivuodet.suorv as nvarchar(4))
	,tutkmaak = cast(coalesce(nullif(kaikkivuodet.tutkmaak,''''),''-1'') as nvarchar(2))
	,jarj = cast(coalesce(nullif(kaikkivuodet.jarj,''''),''-1'') as nvarchar(10))
	,tunn = cast(coalesce(nullif(kaikkivuodet.tunn,''''),''-1'') as nvarchar(5))
	,akk = cast(coalesce(nullif(left(kaikkivuodet.akk,2),''''),''-1'') as nvarchar(2))
	,koulk = cast(coalesce(nullif(kaikkivuodet.koulk,''''),''-1'') as nvarchar(6))
	,kouljat = cast(coalesce(nullif(kaikkivuodet.kouljat,''''),''-1'') as nvarchar(2))
	,oppis = cast(coalesce(nullif(kaikkivuodet.oppis,''''),''-1'') as nvarchar(2))
	,tutklaja_tr = cast(coalesce(nullif(kaikkivuodet.tutklaja_tr,''''),''-1'') as nvarchar(2))
	,ptoim1r2 = cast(coalesce(nullif(kaikkivuodet.ptoim1r2,''''),''-1'') as nvarchar(2))
	,maassaolo = cast(coalesce(nullif(kaikkivuodet.maassaolo,''''),''-1'') as nvarchar(2))
	,amas = cast(coalesce(nullif(kaikkivuodet.amas,''''),''-1'') as nvarchar(2))
	,amm2010 = cast(coalesce(nullif(kaikkivuodet.amm2010,''''),''-1'') as nvarchar(5))
	,lkm = cast(kaikkivuodet.lkm as int)
	,eu_etamaat = cast(coalesce(nullif(kaikkivuodet.eu_etamaat,''''),''-1'') as nvarchar(2))
	,aikielir1 = cast(coalesce(nullif(kaikkivuodet.aikielir1,''''),''-1'') as nvarchar(2))
	,mosa = cast(coalesce(nullif(kaikkivuodet.mosa,''''),''-1'') as nvarchar(2))

	,tietolahde = cast(kaikkivuodet.tietolahde as nvarchar(50))
	,rivinumero = cast(kaikkivuodet.rivinumero as int)
FROM (

SELECT [tilv]
      ,[aineisto]
      ,[tilvasmaak]
      ,[aiopis]
      ,[suorv]
      ,[tutkmaak]
      ,[jarj]
      ,[tunn]
      ,[akk]
      ,[koulk]
      ,[kouljat]
      ,[oppis]
      ,[tutklaja_tr]
      ,[ptoim1r2] = coalesce(nullif([ptoim1r2],''''),99)
      ,[maassaolo]
      ,[amas]
      ,[amm2010] = NULL
      ,[lkm]
	  ,''-1'' AS eu_etamaat
	  ,''-1'' AS aikielir1
	  ,''-1'' AS mosa
      ,[tietolahde]=''4_3_sopv_11''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_4_3_sopv_11]
union all
SELECT [tilv]
      ,[aineisto]
      ,[tilvasmaak]
      ,[aiopis]
      ,[suorv]
      ,[tutkmaak]
      ,[jarj]
      ,[tunn]
      ,[akk]
      ,[koulk]
      ,[kouljat]
      ,[oppis]
      ,[tutklaja_tr]
      ,[ptoim1r2] = coalesce(nullif([ptoim1r2],''''),99)
      ,[maassaolo]
      ,[amas]
      ,[amm2010] = NULL
      ,[lkm]
	  ,''-1'' AS eu_etamaat
	  ,''-1'' AS aikielir1
	  ,''-1'' AS mosa
      ,[tietolahde]=''K4_3_sopv_12''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_K4_3_sopv_12]
union all
SELECT [tilv]
      ,[aineisto]
      ,[tilvasmaak]
      ,[aiopis]
      ,[suorv]
      ,[tutkmaak]
      ,[jarj]
      ,[tunn]
      ,[akk]
      ,[koulk]
      ,[kouljat]
      ,[oppis]
      ,[tutklaja_tr]
      ,[ptoim1r2] = coalesce(nullif([ptoim1r2],''''),99)
      ,[maassaolo]
      ,[amas]
      ,[amm2010]
      ,[lkm]
	  ,''-1'' AS eu_etamaat
	  ,''-1'' AS aikielir1
	  ,''-1'' AS mosa
      ,[tietolahde]=''K4_3_sopv_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_K4_3_sopv_13]
  union all
SELECT [tilv]
      ,[aineisto]
      ,[tilvasmaak]
      ,[aiopis]
      ,[suorv]
      ,[tutkmaak]
      ,[jarj]
      ,[tunn]
      ,[akk]
      ,[koulk]
      ,[kouljat]
      ,[oppis]
      ,[tutklaja_tr]
      ,[ptoim1r2] = coalesce(nullif([ptoim1r2],''''),99)
      ,[maassaolo]
      ,[amas]
      ,[amm2010]
      ,[lkm]
	  ,''-1'' AS eu_etamaat
	  ,''-1'' AS aikielir1
	  ,''-1'' AS mosa
      ,[tietolahde]=''K4_3_sopv_14''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_K4_3_sopv_14]

union all

SELECT [tilv]
      ,[aineisto]
      ,[tilvasmaak]
      ,[aiopis]
      ,[suorv]
      ,[tutkmaak]
      ,[jarj]
      ,[tunn]
      ,[akk]
      ,[koulk]
      ,[kouljat]
      ,[oppis]
      ,[tutklaja_tr]
      ,[ptoim1r2] =     /* sopv_15 sisältää virheellisesti pääasiallisen toiminnan arvoja maasta muuttaneille, sovittu työjaostossa että korjataan vain näkymään arvoon muu tai tuntematon - Lasse R. 18.10.2016 */
		CASE
			WHEN maassaolo = 2 THEN 99
			ELSE coalesce(nullif([ptoim1r2],''''),99)
		END
      ,[maassaolo]
      ,[amas]
      ,[amm2010]
      ,[lkm]
	  ,eu_etamaat
	  ,aikielir1
	  ,mosa = CAST(mosa as varchar(2))
      ,[tietolahde]=''K4_3_sopv_15''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_K4_3_sopv_15]

union all
SELECT [tilv]
      ,[aineisto]
      ,[tilvasmaak]
      ,[aiopis]
      ,[suorv]
      ,[tutkmaak]
      ,[jarj]
      ,[tunn]
      ,[akk]
      ,[koulk]
      ,[kouljat]
      ,[oppis]
      ,[tutklaja_tr]
      ,[ptoim1r2]
      ,[maassaolo]
      ,[amas]
      ,[amm2010]
      ,[lkm]
	  ,eu_etamaat
	  ,aikielir1
	  ,mosa = CAST(mosa as varchar(2))
      ,[tietolahde]=''K4_3_sopv_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_K4_3_sopv_16]

) as kaikkivuodet








' 
GO
/****** Object:  View [dbo].[v_sa_4_3_Tutkinnon_suorittaneiden_paaasiallinen_toiminta_testaus]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_4_3_Tutkinnon_suorittaneiden_paaasiallinen_toiminta_testaus]'))
EXEC dbo.sp_executesql @statement = N'



CREATE VIEW [dbo].[v_sa_4_3_Tutkinnon_suorittaneiden_paaasiallinen_toiminta_testaus] AS
SELECT
	 tilv = cast(kaikkivuodet.tilv as nvarchar(4))
	,tilv_date = cast(kaikkivuodet.tilv+''0101'' as date)
	,aineisto = cast(kaikkivuodet.aineisto as nvarchar(2))
	,tilvasmaak = cast(kaikkivuodet.tilvasmaak as nvarchar(2))
	,aiopis = cast(kaikkivuodet.aiopis as nvarchar(2))
	,suorv = cast(kaikkivuodet.suorv as nvarchar(4))
	,tutkmaak = cast(kaikkivuodet.tutkmaak as nvarchar(2))
	,jarj = cast(kaikkivuodet.jarj as nvarchar(10))
	,tunn = cast(kaikkivuodet.tunn as nvarchar(5))
	,akk = cast(left(kaikkivuodet.akk,2) as nvarchar(2))
	,koulk = cast(kaikkivuodet.koulk as nvarchar(6))
	,kouljat = cast(kaikkivuodet.kouljat as nvarchar(2))
	,oppis = cast(kaikkivuodet.oppis as nvarchar(2))
	,tutklaja_tr = cast(kaikkivuodet.tutklaja_tr as nvarchar(2))
	,ptoim1r2 = cast(kaikkivuodet.ptoim1r2 as nvarchar(2))
	,maassaolo = cast(kaikkivuodet.maassaolo as nvarchar(2))
	,amas = cast(kaikkivuodet.amas as nvarchar(2))
	,amm2010 = cast(kaikkivuodet.amm2010 as nvarchar(5))
	,lkm = cast(kaikkivuodet.lkm as int)
	,tietolahde = cast(kaikkivuodet.tietolahde as nvarchar(50))
	,rivinumero = cast(kaikkivuodet.rivinumero as int)
FROM (

SELECT [tilv]
      ,[aineisto]
      ,[tilvasmaak]
      ,[aiopis]
      ,[suorv]
      ,[tutkmaak]
      ,[jarj]
      ,[tunn]
      ,[akk]
      ,[koulk]
      ,[kouljat]
      ,[oppis]
      ,[tutklaja_tr]
      ,[ptoim1r2]
      ,[maassaolo]
      ,[amas]
      ,[amm2010] = NULL
      ,[lkm]
      ,[tietolahde]=''4_3_sopv_11''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_4_3_sopv_11]
union all
SELECT [tilv]
      ,[aineisto]
      ,[tilvasmaak]
      ,[aiopis]
      ,[suorv]
      ,[tutkmaak]
      ,[jarj]
      ,[tunn]
      ,[akk]
      ,[koulk]
      ,[kouljat]
      ,[oppis]
      ,[tutklaja_tr]
      ,[ptoim1r2]
      ,[maassaolo]
      ,[amas]
      ,[amm2010] = NULL
      ,[lkm]
      ,[tietolahde]=''K4_3_sopv_12''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_K4_3_sopv_12]
union all
SELECT [tilv]
      ,[aineisto]
      ,[tilvasmaak]
      ,[aiopis]
      ,[suorv]
      ,[tutkmaak]
      ,[jarj]
      ,[tunn]
      ,[akk]
      ,[koulk]
      ,[kouljat]
      ,[oppis]
      ,[tutklaja_tr]
      ,[ptoim1r2]
      ,[maassaolo]
      ,[amas]
      ,[amm2010]
      ,[lkm]
      ,[tietolahde]=''K4_3_sopv_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_K4_3_sopv_13]
  union all
SELECT [tilv]
      ,[aineisto]
      ,[tilvasmaak]
      ,[aiopis]
      ,[suorv]
      ,[tutkmaak]
      ,[jarj]
      ,[tunn]
      ,[akk]
      ,[koulk]
      ,[kouljat]
      ,[oppis]
      ,[tutklaja_tr]
      ,[ptoim1r2]
      ,[maassaolo]
      ,[amas]
      ,[amm2010]
      ,[lkm]
      ,[tietolahde]=''K4_3_sopv_14''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_K4_3_sopv_14]



) as kaikkivuodet




' 
GO
/****** Object:  View [dbo].[v_sa_4_7_Tutkinnon_suorittaneiden_aiempi_koulutus]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_4_7_Tutkinnon_suorittaneiden_aiempi_koulutus]'))
EXEC dbo.sp_executesql @statement = N'








CREATE VIEW [dbo].[v_sa_4_7_Tutkinnon_suorittaneiden_aiempi_koulutus] AS

/*
Drop table [VipunenTK_DW].[dbo].[sa_4_7_Tutkinnon_suorittaneiden_aiempi_koulutus]
Select * into [VipunenTK_DW].[dbo].[sa_4_7_Tutkinnon_suorittaneiden_aiempi_koulutus] FROM VipunenTK_SA.[dbo].[v_sa_4_7_Tutkinnon_suorittaneiden_aiempi_koulutus]
Truncate table [VipunenTK_DW].[dbo].[sa_4_7_Tutkinnon_suorittaneiden_aiempi_koulutus]
Insert into [VipunenTK_DW].[dbo].[sa_4_7_Tutkinnon_suorittaneiden_aiempi_koulutus]
  Select * FROM VipunenTK_SA.[dbo].[v_sa_4_7_Tutkinnon_suorittaneiden_aiempi_koulutus]
*/

SELECT [tilv] = CAST(kaikkivuodet.suorv as nvarchar(4))
	  ,[tilv_date] = Cast(kaikkivuodet.suorv+''0101'' as date)
      ,[suorv]
      ,[suorlk]
      ,[suorituskausikoodi] = Cast([suorv]+Case when [suorlk] in (''1'', ''2'') then suorlk else ''2'' end as varchar(8))
      ,[koulk] = Cast(koulk as nvarchar(6))
      ,[alvv]
      ,[allk]
      ,[aloituskausikoodi] = Cast(case when len(alvv)<4 then ''-1'' else alvv+Case when allk in (''1'', ''2'') then allk else ''2'' end end as varchar(8))
      ,[oppis] = cast([oppis] as nvarchar(2))
      ,[tutklaja] = cast([tutklaja] as nvarchar(2))
      ,[tutktav] = cast([tutktav] as nvarchar(2))
      ,[aikoul] = Cast([aikoul] as nvarchar(2))
      ,[sp] = Cast(sp as nvarchar(10))
      ,[aikielir1] = cast([aikielir1] as nvarchar(2))
      ,[syntv]
	  ,ika = cast(case when len(replace(syntv,''x'',''''))<4 then -1 else cast(suorv as int) - cast(syntv as int) end as nvarchar(10))
	  --syntv sai myös arvon 19XX, jolloin iäksi asetetaan tuntematon
      ,[lulkm]
      ,[lukoulk]
      ,[lusuorv]
      ,[luaikoul]
      ,[ammlkm]
      ,[ammkoulk]
      ,[ammsuorv]
      ,[ammoppis]
      ,[ammtutklaja]
      ,[ammtutktav]
      ,[opistlkm]
      ,[opistkoulk]
      ,[opistsuorv]
      ,[ammkalkm]
      ,[ammkakoulk]
      ,[ammkasuorv]
      ,[amklkm]
      ,[amkkoulk]
      ,[amksuorv]
      ,[amkaikoul]
      ,[akklkm]
      ,[akkkoulk]
      ,[akksuorv]
      ,[ylamklkm]
      ,[ylamkkoulk]
      ,[ylamksuorv]
      ,[ykklkm]
      ,[ykkkoulk]
      ,[ykksuorv]
      ,[laakerlkm]
      ,[laakerkoulk]
      ,[laakersuorv]
      ,[lislkm]
      ,[liskoulk]
      ,[lissuorv]
      ,[tohtlkm]
      ,[tohtkoulk]
      ,[tohtsuorv]
      ,[lkm]
      --,[luontipvm]
      ,[tietolahde] = CAST(kaikkivuodet.tietolahde as nvarchar(50))
      ,[rivinumero] = CAST(kaikkivuodet.rivinumero as int)
  FROM ( --kaikkivuodet
/* Aineistoissa pahoja virheitä. Koulutusastekohtaiset lkm-mittarit, esim. ammlkm, ovart virheellisiä. Vain 2014 aineisto on oikea.
CSC Jarmo 11.9.2015
Aineistot korjattu 8.1.2016 
*/

  SELECT [suorv]
      ,[suorlk]
      ,[koulk]
      ,[alvv]
      ,[allk]
      ,[oppis]
      ,[tutklaja]
      ,[tutktav]
      ,[aikoul]
      ,[sp]
      ,[aikielir1]
      ,[syntv]
      ,[lulkm]
      ,[lukoulk]
      ,[lusuorv]
      ,[luaikoul]
      ,[ammlkm]
      ,[ammkoulk]
      ,[ammsuorv]
      ,[ammoppis]
      ,[ammtutklaja]
      ,[ammtutktav]
      ,[opistlkm]
      ,[opistkoulk]
      ,[opistsuorv]
      ,[ammkalkm]
      ,[ammkakoulk]
      ,[ammkasuorv]
      ,[amklkm]
      ,[amkkoulk]
      ,[amksuorv]
      ,[amkaikoul]
      ,[akklkm]
      ,[akkkoulk]
      ,[akksuorv]
      ,[ylamklkm]
      ,[ylamkkoulk]
      ,[ylamksuorv]
      ,[ykklkm]
      ,[ykkkoulk]
      ,[ykksuorv]
      ,[laakerlkm]
      ,[laakerkoulk]
      ,[laakersuorv]
      ,[lislkm]
      ,[liskoulk]
      ,[lissuorv]
      ,[tohtlkm]
      ,[tohtkoulk]
      ,[tohtsuorv]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde]=''TK_4_7_sopv_11''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY koulk)
  FROM [TK_H9098_CSC].[dbo].[TK_4_7_sopv_11]

UNION ALL
SELECT [suorv]
      ,[suorlk]
      ,[koulk]
      ,[alvv]
      ,[allk]
      ,[oppis]
      ,[tutklaja]
      ,[tutktav]
      ,[aikoul]
      ,[sp]
      ,[aikielir1]
      ,[syntv]
      ,[lulkm]
      ,[lukoulk]
      ,[lusuorv]
      ,[luaikoul]
      ,[ammlkm]
      ,[ammkoulk]
      ,[ammsuorv]
      ,[ammoppis]
      ,[ammtutklaja]
      ,[ammtutktav]
      ,[opistlkm]
      ,[opistkoulk]
      ,[opistsuorv]
      ,[ammkalkm]
      ,[ammkakoulk]
      ,[ammkasuorv]
      ,[amklkm]
      ,[amkkoulk]
      ,[amksuorv]
      ,[amkaikoul]
      ,[akklkm]
      ,[akkkoulk]
      ,[akksuorv]
      ,[ylamklkm]
      ,[ylamkkoulk]
      ,[ylamksuorv]
      ,[ykklkm]
      ,[ykkkoulk]
      ,[ykksuorv]
      ,[laakerlkm]
      ,[laakerkoulk]
      ,[laakersuorv]
      ,[lislkm]
      ,[liskoulk]
      ,[lissuorv]
      ,[tohtlkm]
      ,[tohtkoulk]
      ,[tohtsuorv]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde]=''TK_4_7_sopv_12''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY koulk)
  FROM [TK_H9098_CSC].[dbo].[TK_4_7_sopv_12]

UNION ALL
SELECT [suorv]
      ,[suorlk]
      ,[koulk]
      ,[alvv]
      ,[allk]
      ,[oppis]
      ,[tutklaja]
      ,[tutktav]
      ,[aikoul]
      ,[sp]
      ,[aikielir1]
      ,[syntv]
      ,[lulkm]
      ,[lukoulk]
      ,[lusuorv]
      ,[luaikoul]
      ,[ammlkm]
      ,[ammkoulk]
      ,[ammsuorv]
      ,[ammoppis]
      ,[ammtutklaja]
      ,[ammtutktav]
      ,[opistlkm]
      ,[opistkoulk]
      ,[opistsuorv]
      ,[ammkalkm]
      ,[ammkakoulk]
      ,[ammkasuorv]
      ,[amklkm]
      ,[amkkoulk]
      ,[amksuorv]
      ,[amkaikoul]
      ,[akklkm]
      ,[akkkoulk]
      ,[akksuorv]
      ,[ylamklkm]
      ,[ylamkkoulk]
      ,[ylamksuorv]
      ,[ykklkm]
      ,[ykkkoulk]
      ,[ykksuorv]
      ,[laakerlkm]
      ,[laakerkoulk]
      ,[laakersuorv]
      ,[lislkm]
      ,[liskoulk]
      ,[lissuorv]
      ,[tohtlkm]
      ,[tohtkoulk]
      ,[tohtsuorv]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde]=''TK_4_7_sopv_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY koulk)
  FROM [TK_H9098_CSC].[dbo].[TK_4_7_sopv_13]

UNION ALL

SELECT [suorv]
      ,[suorlk]
      ,[koulk]
      ,[alvv]
      ,[allk]
      ,[oppis]
      ,[tutklaja]
      ,[tutktav]
      ,[aikoul]
      ,[sp]
      ,[aikielir1]
      ,[syntv]
      ,[lulkm]
      ,[lukoulk]
      ,[lusuorv]
      ,[luaikoul]
      ,[ammlkm]
      ,[ammkoulk]
      ,[ammsuorv]
      ,[ammoppis]
      ,[ammtutklaja]
      ,[ammtutktav]
      ,[opistlkm]
      ,[opistkoulk]
      ,[opistsuorv]
      ,[ammkalkm]
      ,[ammkakoulk]
      ,[ammkasuorv]
      ,[amklkm]
      ,[amkkoulk]
      ,[amksuorv]
      ,[amkaikoul]
      ,[akklkm]
      ,[akkkoulk]
      ,[akksuorv]
      ,[ylamklkm]
      ,[ylamkkoulk]
      ,[ylamksuorv]
      ,[ykklkm]
      ,[ykkkoulk]
      ,[ykksuorv]
      ,[laakerlkm]
      ,[laakerkoulk]
      ,[laakersuorv]
      ,[lislkm]
      ,[liskoulk]
      ,[lissuorv]
      ,[tohtlkm]
      ,[tohtkoulk]
      ,[tohtsuorv]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde]=''TK_4_7_sopv_14''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY koulk)
  FROM [TK_H9098_CSC].[dbo].[TK_4_7_sopv_14]

UNION ALL
SELECT [suorv]
      ,[suorlk]
      ,[koulk]
      ,[alvv]
      ,[allk]
      ,[oppis]
      ,[tutklaja]
      ,[tutktav]
      ,[aikoul]
      ,[sp]
      ,[aikielir1]
      ,[syntv]
      ,[lulkm]
      ,[lukoulk]
      ,[lusuorv]
      ,[luaikoul]
      ,[ammlkm]
      ,[ammkoulk]
      ,[ammsuorv]
      ,[ammoppis]
      ,[ammtutklaja]
      ,[ammtutktav]
      ,[opistlkm]
      ,[opistkoulk]
      ,[opistsuorv]
      ,[ammkalkm]
      ,[ammkakoulk]
      ,[ammkasuorv]
      ,[amklkm]
      ,[amkkoulk]
      ,[amksuorv]
      ,[amkaikoul]
      ,[akklkm]
      ,[akkkoulk]
      ,[akksuorv]
      ,[ylamklkm]
      ,[ylamkkoulk]
      ,[ylamksuorv]
      ,[ykklkm]
      ,[ykkkoulk]
      ,[ykksuorv]
      ,[laakerlkm]
      ,[laakerkoulk]
      ,[laakersuorv]
      ,[lislkm]
      ,[liskoulk]
      ,[lissuorv]
      ,[tohtlkm]
      ,[tohtkoulk]
      ,[tohtsuorv]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde]=''TK_4_7_sopv_15''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY koulk)
  FROM [TK_H9098_CSC].[dbo].[TK_4_7_sopv_15]

UNION ALL

SELECT [suorv]
      ,[suorlk]
      ,[koulk]
      ,[alvv]
      ,[allk]
      ,[oppis]
      ,[tutklaja]
      ,[tutktav]
      ,[aikoul]
      ,[sp]
      ,[aikielir1]
      ,[syntv] = case when syntv = ''193.'' or syntv = ''197.'' then ''-1'' else syntv end
      ,[lulkm]
      ,[lukoulk]
      ,[lusuorv]
      ,[luaikoul]
      ,[ammlkm]
      ,[ammkoulk]
      ,[ammsuorv]
      ,[ammoppis]
      ,[ammtutklaja]
      ,[ammtutktav]
      ,[opistlkm]
      ,[opistkoulk]
      ,[opistsuorv]
      ,[ammkalkm]
      ,[ammkakoulk]
      ,[ammkasuorv]
      ,[amklkm]
      ,[amkkoulk]
      ,[amksuorv]
      ,[amkaikoul]
      ,[akklkm]
      ,[akkkoulk]
      ,[akksuorv]
      ,[ylamklkm]
      ,[ylamkkoulk]
      ,[ylamksuorv]
      ,[ykklkm]
      ,[ykkkoulk]
      ,[ykksuorv]
      ,[laakerlkm]
      ,[laakerkoulk]
      ,[laakersuorv]
      ,[lislkm]
      ,[liskoulk]
      ,[lissuorv]
      ,[tohtlkm]
      ,[tohtkoulk]
      ,[tohtsuorv]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde]=''TK_4_7_sopv_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY koulk)
  FROM [TK_H9098_CSC].[dbo].[TK_4_7_sopv_16]


 ) kaikkivuodet
 where syntv not in (''193.'', ''197.'')









' 
GO
/****** Object:  View [dbo].[v_sa_4_8_Tutkinnon_suorittaneiden_myohempi_koulutus]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_4_8_Tutkinnon_suorittaneiden_myohempi_koulutus]'))
EXEC dbo.sp_executesql @statement = N'








CREATE VIEW [dbo].[v_sa_4_8_Tutkinnon_suorittaneiden_myohempi_koulutus] AS

/*
Drop table [VipunenTK_DW].[dbo].[sa_4_8_Tutkinnon_suorittaneiden_myohempi_koulutus]
Select * into [VipunenTK_DW].[dbo].[sa_4_8_Tutkinnon_suorittaneiden_myohempi_koulutus] FROM VipunenTK_SA.[dbo].[v_sa_4_8_Tutkinnon_suorittaneiden_myohempi_koulutus]
Truncate table [VipunenTK_DW].[dbo].[sa_4_8_Tutkinnon_suorittaneiden_myohempi_koulutus]
Insert into [VipunenTK_DW].[dbo].[sa_4_8_Tutkinnon_suorittaneiden_myohempi_koulutus]
  Select * FROM VipunenTK_SA.[dbo].[v_sa_4_8_Tutkinnon_suorittaneiden_myohempi_koulutus]
*/

SELECT [tilv] = CAST(kaikkivuodet.tilv as nvarchar(4))
	  ,[tilv_date] = Cast(kaikkivuodet.tilv+''0101'' as date)
      ,[suorv]
      ,[suorlk]
      ,[suorituskausikoodi] = Cast([suorv]+Case when [suorlk] in (''1'', ''2'') then suorlk else ''2'' end as varchar(8))
      ,[koulk] = Cast(koulk as nvarchar(6))
      ,[alvv]
      ,[allk]
      ,[aloituskausikoodi] = Cast(case when len(alvv)<4 then ''-1'' else alvv+Case when allk in (''1'', ''2'') then allk else ''2'' end end as varchar(8))
      ,[oppis] = cast([oppis] as nvarchar(2))
      ,[tutklaja] = cast([tutklaja] as nvarchar(2))
      ,[tutktav] = cast([tutktav] as nvarchar(2))
      ,[aikoul] = Cast([aikoul] as nvarchar(2))
      ,[sp] = Cast(sp as nvarchar(10))
      ,[aikielir1] = cast([aikielir1] as nvarchar(2))
      ,[syntv]
	  ,ika = cast(case 
					when len(replace(syntv,''x'',''''))<4 then -1 
					when len(replace(suorv,''x'',''''))<4 then -1 
					else cast(suorv as int) - cast(syntv as int) end as nvarchar(10))
	  --syntv sai myös arvon 19XX, jolloin iäksi asetetaan tuntematon
      ,[lulkm]
      ,[lukoulk]
      ,[lusuorv]
      ,[luaikoul]
      ,[ammlkm]
      ,[ammkoulk]
      ,[ammsuorv]
      ,[ammoppis]
      ,[ammtutklaja]
      ,[ammtutktav]
      ,[opistlkm]
      ,[opistkoulk]
      ,[opistsuorv]
      ,[ammkalkm]
      ,[ammkakoulk]
      ,[ammkasuorv]
      ,[amklkm]
      ,[amkkoulk]
      ,[amksuorv]
      ,[amkaikoul]
      ,[akklkm]
      ,[akkkoulk]
      ,[akksuorv]
      ,[ylamklkm]
      ,[ylamkkoulk]
      ,[ylamksuorv]
      ,[ykklkm]
      ,[ykkkoulk]
      ,[ykksuorv]
      ,[laakerlkm]
      ,[laakerkoulk]
      ,[laakersuorv]
      ,[lislkm]
      ,[liskoulk]
      ,[lissuorv]
      ,[tohtlkm]
      ,[tohtkoulk]
      ,[tohtsuorv]
      ,[lkm]
      --,[luontipvm]
      ,[tietolahde] = CAST(kaikkivuodet.tietolahde as nvarchar(50))
      ,[rivinumero] = CAST(kaikkivuodet.rivinumero as int)
  FROM ( --kaikkivuodet
--Aineistot ovat kumulatiivisia. Vain viimeinen riittää.
SELECT [suorv]
      ,[suorlk]
      ,[koulk]
      ,[alvv]
      ,[allk]
      ,[oppis]
      ,[tutklaja]
      ,[tutktav]
      ,[aikoul]
      ,[sp]
      ,[aikielir1]
      ,[syntv]
      ,[lulkm]
      ,[lukoulk]
      ,[lusuorv]
      ,[luaikoul]
      ,[ammlkm]
      ,[ammkoulk]
      ,[ammsuorv]
      ,[ammoppis]
      ,[ammtutklaja]
      ,[ammtutktav]
      ,[opistlkm]
      ,[opistkoulk]
      ,[opistsuorv]
      ,[ammkalkm]
      ,[ammkakoulk]
      ,[ammkasuorv]
      ,[amklkm]
      ,[amkkoulk]
      ,[amksuorv]
      ,[amkaikoul]
      ,[akklkm]
      ,[akkkoulk]
      ,[akksuorv]
      ,[ylamklkm]
      ,[ylamkkoulk]
      ,[ylamksuorv]
      ,[ykklkm]
      ,[ykkkoulk]
      ,[ykksuorv]
      ,[laakerlkm]
      ,[laakerkoulk]
      ,[laakersuorv]
      ,[lislkm]
      ,[liskoulk]
      ,[lissuorv]
      ,[tohtlkm]
      ,[tohtkoulk]
      ,[tohtsuorv]
      ,[lkm]
      ,[luontipvm]
	  ,tilv = (select max(lusuorv) FROM [TK_H9098_CSC].[dbo].[TK_4_8_sopv_16])
      ,[tietolahde]=''TK_4_8_sopv_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY koulk)
  FROM [TK_H9098_CSC].[dbo].[TK_4_8_sopv_17]

 ) kaikkivuodet








' 
GO
/****** Object:  View [dbo].[v_sa_4_9_Vaestorakenne_kunnittain]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_4_9_Vaestorakenne_kunnittain]'))
EXEC dbo.sp_executesql @statement = N'



CREATE VIEW [dbo].[v_sa_4_9_Vaestorakenne_kunnittain] AS

-- truncate table vipunentk_dw..sa_4_9_Vaestorakenne_kunnittain
-- insert into vipunentk_dw..sa_4_9_Vaestorakenne_kunnittain select * from v_sa_4_9_Vaestorakenne_kunnittain

SELECT
	 tilv = cast(kaikkivuodet.tilv as varchar(4))
	,tilv_date = cast(kaikkivuodet.tilv+''0101'' as date)
	,sp = cast(kaikkivuodet.sp as varchar(1))
	,tilvaskun = cast(kaikkivuodet.tilvaskun as varchar(3))
	,aikielir2 = cast(kaikkivuodet.aikielir2 as varchar(2))
	,kansalr1 = cast(kaikkivuodet.kansalr1 as varchar(1))
	,mosa = cast(kaikkivuodet.mosa as varchar(1))
	,pohjmaa = cast(kaikkivuodet.pohjmaa as varchar(1))
	,eumaa = cast(kaikkivuodet.eumaa as varchar(1))
	,etamaa = cast(kaikkivuodet.etamaa as varchar(1))
	,ika0 = cast(kaikkivuodet.ika0 as int)
	,ika1 = cast(kaikkivuodet.ika1 as int)
	,ika2 = cast(kaikkivuodet.ika2 as int)
	,ika3 = cast(kaikkivuodet.ika3 as int)
	,ika4 = cast(kaikkivuodet.ika4 as int)
	,ika5 = cast(kaikkivuodet.ika5 as int)
	,ika6 = cast(kaikkivuodet.ika6 as int)
	,ika7 = cast(kaikkivuodet.ika7 as int)
	,ika8 = cast(kaikkivuodet.ika8 as int)
	,ika9 = cast(kaikkivuodet.ika9 as int)
	,ika10 = cast(kaikkivuodet.ika10 as int)
	,ika11 = cast(kaikkivuodet.ika11 as int)
	,ika12 = cast(kaikkivuodet.ika12 as int)
	,ika13 = cast(kaikkivuodet.ika13 as int)
	,ika14 = cast(kaikkivuodet.ika14 as int)
	,ika15 = cast(kaikkivuodet.ika15 as int)
	,ika16 = cast(kaikkivuodet.ika16 as int)
	,ika17 = cast(kaikkivuodet.ika17 as int)
	,ika18 = cast(kaikkivuodet.ika18 as int)
	,ika19 = cast(kaikkivuodet.ika19 as int)
	,ika20 = cast(kaikkivuodet.ika20 as int)
	,ika21 = cast(kaikkivuodet.ika21 as int)
	,ika22 = cast(kaikkivuodet.ika22 as int)
	,ika23 = cast(kaikkivuodet.ika23 as int)
	,ika24 = cast(kaikkivuodet.ika24 as int)
	,ika25 = cast(kaikkivuodet.ika25 as int)
	,ika26 = cast(kaikkivuodet.ika26 as int)
	,ika27 = cast(kaikkivuodet.ika27 as int)
	,ika28 = cast(kaikkivuodet.ika28 as int)
	,ika29 = cast(kaikkivuodet.ika29 as int)
	,ika30 = cast(kaikkivuodet.ika30 as int)
	,ika31 = cast(kaikkivuodet.ika31 as int)
	,ika32 = cast(kaikkivuodet.ika32 as int)
	,ika33 = cast(kaikkivuodet.ika33 as int)
	,ika34 = cast(kaikkivuodet.ika34 as int)
	,ika35 = cast(kaikkivuodet.ika35 as int)
	,ika36 = cast(kaikkivuodet.ika36 as int)
	,ika37 = cast(kaikkivuodet.ika37 as int)
	,ika38 = cast(kaikkivuodet.ika38 as int)
	,ika39 = cast(kaikkivuodet.ika39 as int)
	,ika40 = cast(kaikkivuodet.ika40 as int)
	,ika41 = cast(kaikkivuodet.ika41 as int)
	,ika42 = cast(kaikkivuodet.ika42 as int)
	,ika43 = cast(kaikkivuodet.ika43 as int)
	,ika44 = cast(kaikkivuodet.ika44 as int)
	,ika45 = cast(kaikkivuodet.ika45 as int)
	,ika46 = cast(kaikkivuodet.ika46 as int)
	,ika47 = cast(kaikkivuodet.ika47 as int)
	,ika48 = cast(kaikkivuodet.ika48 as int)
	,ika49 = cast(kaikkivuodet.ika49 as int)
	,ika50 = cast(kaikkivuodet.ika50 as int)
	,ika51 = cast(kaikkivuodet.ika51 as int)
	,ika52 = cast(kaikkivuodet.ika52 as int)
	,ika53 = cast(kaikkivuodet.ika53 as int)
	,ika54 = cast(kaikkivuodet.ika54 as int)
	,ika55 = cast(kaikkivuodet.ika55 as int)
	,ika56 = cast(kaikkivuodet.ika56 as int)
	,ika57 = cast(kaikkivuodet.ika57 as int)
	,ika58 = cast(kaikkivuodet.ika58 as int)
	,ika59 = cast(kaikkivuodet.ika59 as int)
	,ika60 = cast(kaikkivuodet.ika60 as int)
	,ika61 = cast(kaikkivuodet.ika61 as int)
	,ika62 = cast(kaikkivuodet.ika62 as int)
	,ika63 = cast(kaikkivuodet.ika63 as int)
	,ika64 = cast(kaikkivuodet.ika64 as int)
	,ika65 = cast(kaikkivuodet.ika65 as int)
	,ika66 = cast(kaikkivuodet.ika66 as int)
	,ika67 = cast(kaikkivuodet.ika67 as int)
	,ika68 = cast(kaikkivuodet.ika68 as int)
	,ika69 = cast(kaikkivuodet.ika69 as int)
	,ika70 = cast(kaikkivuodet.ika70 as int)
	,ika71 = cast(kaikkivuodet.ika71 as int)
	,ika72 = cast(kaikkivuodet.ika72 as int)
	,ika73 = cast(kaikkivuodet.ika73 as int)
	,ika74 = cast(kaikkivuodet.ika74 as int)
	,ika75 = cast(kaikkivuodet.ika75 as int)
	,ika76 = cast(kaikkivuodet.ika76 as int)
	,ika77 = cast(kaikkivuodet.ika77 as int)
	,ika78 = cast(kaikkivuodet.ika78 as int)
	,ika79 = cast(kaikkivuodet.ika79 as int)
	,ika80 = cast(kaikkivuodet.ika80 as int)
	,ika81 = cast(kaikkivuodet.ika81 as int)
	,ika82 = cast(kaikkivuodet.ika82 as int)
	,ika83 = cast(kaikkivuodet.ika83 as int)
	,ika84 = cast(kaikkivuodet.ika84 as int)
	,ika85 = cast(kaikkivuodet.ika85 as int)
	,ika86 = cast(kaikkivuodet.ika86 as int)
	,ika87 = cast(kaikkivuodet.ika87 as int)
	,ika88 = cast(kaikkivuodet.ika88 as int)
	,ika89 = cast(kaikkivuodet.ika89 as int)
	,ika90 = cast(kaikkivuodet.ika90 as int)
	,ika91 = cast(kaikkivuodet.ika91 as int)
	,ika92 = cast(kaikkivuodet.ika92 as int)
	,ika93 = cast(kaikkivuodet.ika93 as int)
	,ika94 = cast(kaikkivuodet.ika94 as int)
	,ika95 = cast(kaikkivuodet.ika95 as int)
	,ika96 = cast(kaikkivuodet.ika96 as int)
	,ika97 = cast(kaikkivuodet.ika97 as int)
	,ika98 = cast(kaikkivuodet.ika98 as int)
	,ika99 = cast(kaikkivuodet.ika99 as int)
	,ika100_ = cast(kaikkivuodet.ika100_ as int)
	,lkm = cast(kaikkivuodet.lkm as int)
	,tietolahde = cast(kaikkivuodet.tietolahde as nvarchar(50))
	,rivinumero = cast(kaikkivuodet.rivinumero as int)
FROM (

	SELECT
	 tilv
	,sp
	,tilvaskun
	,aikielir2
	,kansalr1
	,mosa
	,pohjmaa
	,eumaa
	,etamaa
	,ika0
	,ika1
	,ika2
	,ika3
	,ika4
	,ika5
	,ika6
	,ika7
	,ika8
	,ika9
	,ika10
	,ika11
	,ika12
	,ika13
	,ika14
	,ika15
	,ika16
	,ika17
	,ika18
	,ika19
	,ika20
	,ika21
	,ika22
	,ika23
	,ika24
	,ika25
	,ika26
	,ika27
	,ika28
	,ika29
	,ika30
	,ika31
	,ika32
	,ika33
	,ika34
	,ika35
	,ika36
	,ika37
	,ika38
	,ika39
	,ika40
	,ika41
	,ika42
	,ika43
	,ika44
	,ika45
	,ika46
	,ika47
	,ika48
	,ika49
	,ika50
	,ika51
	,ika52
	,ika53
	,ika54
	,ika55
	,ika56
	,ika57
	,ika58
	,ika59
	,ika60
	,ika61
	,ika62
	,ika63
	,ika64
	,ika65
	,ika66
	,ika67
	,ika68
	,ika69
	,ika70
	,ika71
	,ika72
	,ika73
	,ika74
	,ika75
	,ika76
	,ika77
	,ika78
	,ika79
	,ika80
	,ika81
	,ika82
	,ika83
	,ika84
	,ika85
	,ika86
	,ika87
	,ika88
	,ika89
	,ika90
	,ika91
	,ika92
	,ika93
	,ika94
	,ika95
	,ika96
	,ika97
	,ika98
	,ika99
	,ika100_
	,lkm
	,[tietolahde]=''4_9_sopv_11''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_4_9_sopv_11]
UNION ALL
	SELECT
	 tilv
	,sp
	,tilvaskun
	,aikielir2
	,kansalr1
	,mosa
	,pohjmaa
	,eumaa
	,etamaa
	,ika0
	,ika1
	,ika2
	,ika3
	,ika4
	,ika5
	,ika6
	,ika7
	,ika8
	,ika9
	,ika10
	,ika11
	,ika12
	,ika13
	,ika14
	,ika15
	,ika16
	,ika17
	,ika18
	,ika19
	,ika20
	,ika21
	,ika22
	,ika23
	,ika24
	,ika25
	,ika26
	,ika27
	,ika28
	,ika29
	,ika30
	,ika31
	,ika32
	,ika33
	,ika34
	,ika35
	,ika36
	,ika37
	,ika38
	,ika39
	,ika40
	,ika41
	,ika42
	,ika43
	,ika44
	,ika45
	,ika46
	,ika47
	,ika48
	,ika49
	,ika50
	,ika51
	,ika52
	,ika53
	,ika54
	,ika55
	,ika56
	,ika57
	,ika58
	,ika59
	,ika60
	,ika61
	,ika62
	,ika63
	,ika64
	,ika65
	,ika66
	,ika67
	,ika68
	,ika69
	,ika70
	,ika71
	,ika72
	,ika73
	,ika74
	,ika75
	,ika76
	,ika77
	,ika78
	,ika79
	,ika80
	,ika81
	,ika82
	,ika83
	,ika84
	,ika85
	,ika86
	,ika87
	,ika88
	,ika89
	,ika90
	,ika91
	,ika92
	,ika93
	,ika94
	,ika95
	,ika96
	,ika97
	,ika98
	,ika99
	,ika100_
	,lkm
	,[tietolahde]=''4_9_sopv_12''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_4_9_sopv_12]

UNION ALL
	SELECT
	 tilv
	,sp
	,tilvaskun
	,aikielir2
	,kansalr1
	,mosa
	,pohjmaa
	,eumaa
	,etamaa
	,ika0
	,ika1
	,ika2
	,ika3
	,ika4
	,ika5
	,ika6
	,ika7
	,ika8
	,ika9
	,ika10
	,ika11
	,ika12
	,ika13
	,ika14
	,ika15
	,ika16
	,ika17
	,ika18
	,ika19
	,ika20
	,ika21
	,ika22
	,ika23
	,ika24
	,ika25
	,ika26
	,ika27
	,ika28
	,ika29
	,ika30
	,ika31
	,ika32
	,ika33
	,ika34
	,ika35
	,ika36
	,ika37
	,ika38
	,ika39
	,ika40
	,ika41
	,ika42
	,ika43
	,ika44
	,ika45
	,ika46
	,ika47
	,ika48
	,ika49
	,ika50
	,ika51
	,ika52
	,ika53
	,ika54
	,ika55
	,ika56
	,ika57
	,ika58
	,ika59
	,ika60
	,ika61
	,ika62
	,ika63
	,ika64
	,ika65
	,ika66
	,ika67
	,ika68
	,ika69
	,ika70
	,ika71
	,ika72
	,ika73
	,ika74
	,ika75
	,ika76
	,ika77
	,ika78
	,ika79
	,ika80
	,ika81
	,ika82
	,ika83
	,ika84
	,ika85
	,ika86
	,ika87
	,ika88
	,ika89
	,ika90
	,ika91
	,ika92
	,ika93
	,ika94
	,ika95
	,ika96
	,ika97
	,ika98
	,ika99
	,ika100_
	,lkm
	,[tietolahde]=''4_9_sopv_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_4_9_sopv_13]

UNION ALL
	SELECT
	 tilv
	,sp
	,tilvaskun
	,aikielir2
	,kansalr1
	,mosa
	,pohjmaa
	,eumaa
	,etamaa
	,ika0
	,ika1
	,ika2
	,ika3
	,ika4
	,ika5
	,ika6
	,ika7
	,ika8
	,ika9
	,ika10
	,ika11
	,ika12
	,ika13
	,ika14
	,ika15
	,ika16
	,ika17
	,ika18
	,ika19
	,ika20
	,ika21
	,ika22
	,ika23
	,ika24
	,ika25
	,ika26
	,ika27
	,ika28
	,ika29
	,ika30
	,ika31
	,ika32
	,ika33
	,ika34
	,ika35
	,ika36
	,ika37
	,ika38
	,ika39
	,ika40
	,ika41
	,ika42
	,ika43
	,ika44
	,ika45
	,ika46
	,ika47
	,ika48
	,ika49
	,ika50
	,ika51
	,ika52
	,ika53
	,ika54
	,ika55
	,ika56
	,ika57
	,ika58
	,ika59
	,ika60
	,ika61
	,ika62
	,ika63
	,ika64
	,ika65
	,ika66
	,ika67
	,ika68
	,ika69
	,ika70
	,ika71
	,ika72
	,ika73
	,ika74
	,ika75
	,ika76
	,ika77
	,ika78
	,ika79
	,ika80
	,ika81
	,ika82
	,ika83
	,ika84
	,ika85
	,ika86
	,ika87
	,ika88
	,ika89
	,ika90
	,ika91
	,ika92
	,ika93
	,ika94
	,ika95
	,ika96
	,ika97
	,ika98
	,ika99
	,ika100_
	,lkm
	,[tietolahde]=''4_9_sopv_14''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_4_9_sopv_14]

UNION ALL
	SELECT
	 tilv
	,sp
	,tilvaskun
	,aikielir2
	,kansalr1
	,mosa
	,pohjmaa
	,eumaa
	,etamaa
	,ika0
	,ika1
	,ika2
	,ika3
	,ika4
	,ika5
	,ika6
	,ika7
	,ika8
	,ika9
	,ika10
	,ika11
	,ika12
	,ika13
	,ika14
	,ika15
	,ika16
	,ika17
	,ika18
	,ika19
	,ika20
	,ika21
	,ika22
	,ika23
	,ika24
	,ika25
	,ika26
	,ika27
	,ika28
	,ika29
	,ika30
	,ika31
	,ika32
	,ika33
	,ika34
	,ika35
	,ika36
	,ika37
	,ika38
	,ika39
	,ika40
	,ika41
	,ika42
	,ika43
	,ika44
	,ika45
	,ika46
	,ika47
	,ika48
	,ika49
	,ika50
	,ika51
	,ika52
	,ika53
	,ika54
	,ika55
	,ika56
	,ika57
	,ika58
	,ika59
	,ika60
	,ika61
	,ika62
	,ika63
	,ika64
	,ika65
	,ika66
	,ika67
	,ika68
	,ika69
	,ika70
	,ika71
	,ika72
	,ika73
	,ika74
	,ika75
	,ika76
	,ika77
	,ika78
	,ika79
	,ika80
	,ika81
	,ika82
	,ika83
	,ika84
	,ika85
	,ika86
	,ika87
	,ika88
	,ika89
	,ika90
	,ika91
	,ika92
	,ika93
	,ika94
	,ika95
	,ika96
	,ika97
	,ika98
	,ika99
	,ika100_
	,lkm
	,[tietolahde]=''4_9_sopv_15''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_4_9_sopv_15]

UNION ALL
	SELECT
	 tilv
	,sp
	,tilvaskun
	,aikielir2
	,kansalr1
	,mosa
	,pohjmaa
	,eumaa
	,etamaa
	,ika0
	,ika1
	,ika2
	,ika3
	,ika4
	,ika5
	,ika6
	,ika7
	,ika8
	,ika9
	,ika10
	,ika11
	,ika12
	,ika13
	,ika14
	,ika15
	,ika16
	,ika17
	,ika18
	,ika19
	,ika20
	,ika21
	,ika22
	,ika23
	,ika24
	,ika25
	,ika26
	,ika27
	,ika28
	,ika29
	,ika30
	,ika31
	,ika32
	,ika33
	,ika34
	,ika35
	,ika36
	,ika37
	,ika38
	,ika39
	,ika40
	,ika41
	,ika42
	,ika43
	,ika44
	,ika45
	,ika46
	,ika47
	,ika48
	,ika49
	,ika50
	,ika51
	,ika52
	,ika53
	,ika54
	,ika55
	,ika56
	,ika57
	,ika58
	,ika59
	,ika60
	,ika61
	,ika62
	,ika63
	,ika64
	,ika65
	,ika66
	,ika67
	,ika68
	,ika69
	,ika70
	,ika71
	,ika72
	,ika73
	,ika74
	,ika75
	,ika76
	,ika77
	,ika78
	,ika79
	,ika80
	,ika81
	,ika82
	,ika83
	,ika84
	,ika85
	,ika86
	,ika87
	,ika88
	,ika89
	,ika90
	,ika91
	,ika92
	,ika93
	,ika94
	,ika95
	,ika96
	,ika97
	,ika98
	,ika99
	,ika100_
	,lkm
	,[tietolahde]=''4_9_sopv_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_4_9_sopv_16]

UNION ALL
	SELECT
	 tilv
	,sp
	,tilvaskun
	,aikielir2
	,kansalr1
	,mosa
	,pohjmaa
	,eumaa
	,etamaa
	,ika0
	,ika1
	,ika2
	,ika3
	,ika4
	,ika5
	,ika6
	,ika7
	,ika8
	,ika9
	,ika10
	,ika11
	,ika12
	,ika13
	,ika14
	,ika15
	,ika16
	,ika17
	,ika18
	,ika19
	,ika20
	,ika21
	,ika22
	,ika23
	,ika24
	,ika25
	,ika26
	,ika27
	,ika28
	,ika29
	,ika30
	,ika31
	,ika32
	,ika33
	,ika34
	,ika35
	,ika36
	,ika37
	,ika38
	,ika39
	,ika40
	,ika41
	,ika42
	,ika43
	,ika44
	,ika45
	,ika46
	,ika47
	,ika48
	,ika49
	,ika50
	,ika51
	,ika52
	,ika53
	,ika54
	,ika55
	,ika56
	,ika57
	,ika58
	,ika59
	,ika60
	,ika61
	,ika62
	,ika63
	,ika64
	,ika65
	,ika66
	,ika67
	,ika68
	,ika69
	,ika70
	,ika71
	,ika72
	,ika73
	,ika74
	,ika75
	,ika76
	,ika77
	,ika78
	,ika79
	,ika80
	,ika81
	,ika82
	,ika83
	,ika84
	,ika85
	,ika86
	,ika87
	,ika88
	,ika89
	,ika90
	,ika91
	,ika92
	,ika93
	,ika94
	,ika95
	,ika96
	,ika97
	,ika98
	,ika99
	,ika100_
	,lkm
	,[tietolahde]=''4_9_sopv_17''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_4_9_sopv_17]

) as kaikkivuodet




' 
GO
/****** Object:  View [dbo].[v_sa_5_1_Yliopistojen_tutkimushenkilökunta_yliopistoittain]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_5_1_Yliopistojen_tutkimushenkilökunta_yliopistoittain]'))
EXEC dbo.sp_executesql @statement = N'





CREATE VIEW [dbo].[v_sa_5_1_Yliopistojen_tutkimushenkilökunta_yliopistoittain] AS

/*
Aineisto muuttui K-aineistoksi 2016. K-koodia ei lisätty näkymän nimeen. /18.1.2016 CSC Jarmo

Drop table [VipunenTK_DW].[dbo].[sa_5_1_Yliopistojen_tutkimushenkilökunta_yliopistoittain]
Select * into [VipunenTK_DW].[dbo].[sa_5_1_Yliopistojen_tutkimushenkilökunta_yliopistoittain] FROM VipunenTK_SA.[dbo].[v_sa_5_1_Yliopistojen_tutkimushenkilökunta_yliopistoittain]
Truncate table [VipunenTK_DW].[dbo].[sa_5_1_Yliopistojen_tutkimushenkilökunta_yliopistoittain]
Insert into [VipunenTK_DW].[dbo].[sa_5_1_Yliopistojen_tutkimushenkilökunta_yliopistoittain]
  Select * FROM VipunenTK_SA.[dbo].[v_sa_5_1_Yliopistojen_tutkimushenkilökunta_yliopistoittain]
*/

SELECT [tilv] = CAST(kaikkivuodet.tilv as nvarchar(4))
	  ,[tilv_date] = Cast(kaikkivuodet.tilv+''0101'' as date)
      ,[tunn] = CAST(kaikkivuodet.tunn as nvarchar(10))
      ,[tiede] = CAST(kaikkivuodet.tiede as nvarchar(10))
      ,[vryhma] = CAST(kaikkivuodet.vryhma as nvarchar(10))
      ,[ikar4] = CAST(ltrim(rtrim(kaikkivuodet.ikar4)) as nvarchar(10))
      ,[sp] = CAST(kaikkivuodet.sp as nvarchar(10))
      ,[tutktaso] = CAST(Case when kaikkivuodet.tutktaso=''90'' then ''-1'' else kaikkivuodet.tutktaso end as nvarchar(10))
      ,[lkm_tutkimushenkilokunta] = CAST(kaikkivuodet.tutk_lkm as int)
      ,[tietolahde] = CAST(kaikkivuodet.tietolahde as nvarchar(50))
      ,[rivinumero] = CAST(kaikkivuodet.rivinumero as int)
  FROM (
SELECT [tilv]
      ,[tunn]
      ,[tiede] = ''TA07_''+tiede
      ,[vryhma]
      ,[ikar4]
      ,[sp]
      ,[tutktaso]
      ,[tutk_lkm]
      ,[tietolahde]=''TK_K5_1_sopv_12''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_K5_1_sopv_12]

UNION ALL

SELECT [tilv]
      ,[tunn]
      ,[tiede] = ''TA10_''+tiede
      ,[vryhma]
      ,[ikar4]
      ,[sp]
      ,[tutktaso]
      ,[tutk_lkm]
      ,[tietolahde]=''TK_K5_1_sopv_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_K5_1_sopv_13]

UNION ALL

SELECT [tilv]
      ,[tunn]
      ,[tiede] = ''TA10_''+tiede
      ,[vryhma]
      ,[ikar4]
      ,[sp]
      ,[tutktaso]
      ,[tutk_lkm]
      ,[tietolahde]=''TK_K5_1_sopv_14''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_K5_1_sopv_14]

UNION ALL

SELECT [tilv]
      ,[tunn]
      ,[tiede] = ''TA10_''+tiede
      ,[vryhma]
      ,[ikar4]
      ,[sp]
      ,[tutktaso]
      ,[tutk_lkm]
      ,[tietolahde]=''TK_K5_1_sopv_15''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_K5_1_sopv_15]

UNION ALL

SELECT [tilv]
      ,[tunn]
      ,[tiede] = ''TA10_''+tiede
      ,[vryhma]
      ,[ikar4]
      ,[sp]
      ,[tutktaso]
      ,[tutk_lkm]
      ,[tietolahde]=''TK_K5_1_sopv_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_K5_1_sopv_16]

) kaikkivuodet






' 
GO
/****** Object:  View [dbo].[v_sa_5_2_Yliopistojen_tutkimustyovuodet_yliopistoittain]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_5_2_Yliopistojen_tutkimustyovuodet_yliopistoittain]'))
EXEC dbo.sp_executesql @statement = N'







CREATE VIEW [dbo].[v_sa_5_2_Yliopistojen_tutkimustyovuodet_yliopistoittain] AS

/*
Aineisto muuttui K-aineistoksi 2016. K-koodia ei lisätty näkymän nimeen. /18.1.2016 CSC Jarmo

Drop table [VipunenTK_DW].[dbo].[sa_5_2_Yliopistojen_tutkimustyovuodet_yliopistoittain]
Select * into [VipunenTK_DW].[dbo].[sa_5_2_Yliopistojen_tutkimustyovuodet_yliopistoittain] FROM VipunenTK_SA.[dbo].[v_sa_5_2_Yliopistojen_tutkimustyovuodet_yliopistoittain]
Truncate table [VipunenTK_DW].[dbo].[sa_5_2_Yliopistojen_tutkimustyovuodet_yliopistoittain]
Insert into [VipunenTK_DW].[dbo].[sa_5_2_Yliopistojen_tutkimustyovuodet_yliopistoittain]
  Select * FROM VipunenTK_SA.[dbo].[v_sa_5_2_Yliopistojen_tutkimustyovuodet_yliopistoittain]
*/

SELECT [tilv] = CAST(kaikkivuodet.tilv as nvarchar(4))
	  ,[tilv_date] = Cast(kaikkivuodet.tilv+''0101'' as date)
      ,[tunn] = CAST(kaikkivuodet.tunn as nvarchar(10))
      ,[tiede] = CAST(kaikkivuodet.tiede as nvarchar(10))
      ,[vryhma] = CAST(kaikkivuodet.vryhma as nvarchar(10))
      ,[ikar4] = CAST(ltrim(rtrim(kaikkivuodet.ikar4)) as nvarchar(10))
      ,[sp] = CAST(kaikkivuodet.sp as nvarchar(10))
      ,[tutktaso] = CAST(Case when kaikkivuodet.tutktaso=''90'' then ''-1'' else kaikkivuodet.tutktaso end as nvarchar(10))
      ,[lkm_tutkimustyovuodet] = CAST(kaikkivuodet.ttv_lkm as decimal(8,4))
      ,[tietolahde] = CAST(kaikkivuodet.tietolahde as nvarchar(50))
      ,[rivinumero] = CAST(kaikkivuodet.rivinumero as int)
  FROM (
SELECT [tilv]
      ,[tunn]
      ,[tiede] = ''TA07_''+tiede
      ,[vryhma]
      ,[ikar4]
      ,[sp]
      ,[tutktaso]
      ,[ttv_lkm]
      ,[tietolahde]=''TK_K5_2_sopv_12''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_K5_2_sopv_12]

UNION ALL

SELECT [tilv]
      ,[tunn]
      ,[tiede] = ''TA10_''+tiede
      ,[vryhma]
      ,[ikar4]
      ,[sp]
      ,[tutktaso]
      ,[ttv_lkm]
      ,[tietolahde]=''TK_K5_2_sopv_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_K5_2_sopv_13]

UNION ALL

SELECT [tilv]
      ,[tunn]
      ,[tiede] = ''TA10_''+tiede
      ,[vryhma]
      ,[ikar4]
      ,[sp]
      ,[tutktaso]
      ,[ttv_lkm]
      ,[tietolahde]=''TK_K5_2_sopv_14''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_K5_2_sopv_14]

UNION ALL

SELECT [tilv]
      ,[tunn]
      ,[tiede] = ''TA10_''+tiede
      ,[vryhma]
      ,[ikar4]
      ,[sp]
      ,[tutktaso]
      ,[ttv_lkm]
      ,[tietolahde]=''TK_K5_2_sopv_15''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_K5_2_sopv_15]

UNION ALL

SELECT [tilv]
      ,[tunn]
      ,[tiede] = ''TA10_''+tiede
      ,[vryhma]
      ,[ikar4]
      ,[sp]
      ,[tutktaso]
      ,[ttv_lkm]
      ,[tietolahde]=''TK_K5_2_sopv_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_K5_2_sopv_16]
) kaikkivuodet








' 
GO
/****** Object:  View [dbo].[v_sa_5_3_Yliopistojen_tutkimustyovuodet_ja_tutkimusmenot_rahoituslahteittain_menolajeittain_yliopistoittain]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_5_3_Yliopistojen_tutkimustyovuodet_ja_tutkimusmenot_rahoituslahteittain_menolajeittain_yliopistoittain]'))
EXEC dbo.sp_executesql @statement = N'












CREATE VIEW [dbo].[v_sa_5_3_Yliopistojen_tutkimustyovuodet_ja_tutkimusmenot_rahoituslahteittain_menolajeittain_yliopistoittain] AS

--HUOM! Tilastovuodet 2012 ja 2013 haetaan VipunenTK_SA-kannasta. /Jarmo 11.3.2015
--Syynä on, että siirtokannan latauksessa tiede on vain kolmella merkillä

/*
Aineisto muuttui K-aineistoksi 2016. K-koodia ei lisätty näkymän nimeen. /18.1.2016 CSC Jarmo
K poistettu /16.2.2016 CSC Jarmo

Drop table [VipunenTK_DW].[dbo].[sa_5_3_Yliopistojen_tutkimustyovuodet_ja_tutkimusmenot_rahoituslahteittain_menolajeittain_yliopistoittain]
Select * into [VipunenTK_DW].[dbo].[sa_5_3_Yliopistojen_tutkimustyovuodet_ja_tutkimusmenot_rahoituslahteittain_menolajeittain_yliopistoittain] FROM VipunenTK_SA.[dbo].[v_sa_5_3_Yliopistojen_tutkimustyovuodet_ja_tutkimusmenot_rahoituslahteittain_menolajeittain_yliopistoittain]
Truncate table [VipunenTK_DW].[dbo].[sa_5_3_Yliopistojen_tutkimustyovuodet_ja_tutkimusmenot_rahoituslahteittain_menolajeittain_yliopistoittain]
Insert into [VipunenTK_DW].[dbo].[sa_5_3_Yliopistojen_tutkimustyovuodet_ja_tutkimusmenot_rahoituslahteittain_menolajeittain_yliopistoittain]
  Select * FROM VipunenTK_SA.[dbo].[v_sa_5_3_Yliopistojen_tutkimustyovuodet_ja_tutkimusmenot_rahoituslahteittain_menolajeittain_yliopistoittain]
*/

SELECT [tilv] = CAST(kaikkivuodet.tilv as nvarchar(4))
	  ,[tilv_date] = Cast(kaikkivuodet.tilv+''0101'' as date)
      ,[tunn] = CAST(kaikkivuodet.tunn as nvarchar(10))
      ,[tiede] = CAST(kaikkivuodet.tiede as nvarchar(10))

      ,[yhme]
      ,[kmeno]
      ,[palme]
      ,[apuraha]
      ,[mkmeno]
      ,[ptmeno]
      ,[sakat]
      ,[mokm]
      ,[tekes]
      ,[mtem]
      ,[um]
      ,[om]
      ,[sm]
      ,[pm]
      ,[vm]
      ,[mmm]
      ,[lvm]
      ,[stm]
      ,[ym]
      ,[kunnat]
      ,[mjulk]
      ,[krahas]
      ,[kyrit]
      ,[uyrit]
      ,[eu]
      ,[eupuite]
      ,[eakr]
      ,[esr]
      ,[muueu]
      ,[urahas]
      ,[kv_jarj]
      ,[mulko]
      ,[ot_menot]

      ,[tietolahde] = CAST(kaikkivuodet.tietolahde as nvarchar(50))
      ,[rivinumero] = CAST(kaikkivuodet.rivinumero as int)
  FROM ( --kaikkivuodet

SELECT [tilv]
      ,[tunn]
      ,[tiede] = ''TA07_''+tiede
      ,[yhme]
      ,[kmeno]
      ,[palme]
      ,[apuraha]
      ,[mkmeno]
      ,[ptmeno]
      ,[sakat]
      ,[mokm]
      ,[tekes]
      ,[mtem]
      ,[um]
      ,[om]
      ,[sm]
      ,[pm]
      ,[vm]
      ,[mmm]
      ,[lvm]
      ,[stm]
      ,[ym]
      ,[kunnat]
      ,[mjulk]
      ,[krahas]
      ,[kyrit]
      ,[uyrit]
      ,[eu]
      ,[eupuite]
      ,[eakr]
      ,[esr]
      ,[muueu]
      ,[urahas]
      ,[kv_jarj]
      ,[mulko]
      ,[ot_menot]
      ,[luontipvm]
      ,[tietolahde]=''TK_5_3_sopv_12''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_5_3_sopv_12]
--FROM [VipunenTK_SA].[dbo].[TK_5_3_sopv_12]

UNION ALL

SELECT [tilv]
      ,[tunn]
      ,[tiede] = ''TA10_''+tiede
      ,[yhme]
      ,[kmeno]
      ,[palme]
      ,[apuraha]
      ,[mkmeno]
      ,[ptmeno]
      ,[sakat]
      ,[mokm]
      ,[tekes]
      ,[mtem]
      ,[um]
      ,[om]
      ,[sm]
      ,[pm]
      ,[vm]
      ,[mmm]
      ,[lvm]
      ,[stm]
      ,[ym]
      ,[kunnat]
      ,[mjulk]
      ,[krahas]
      ,[kyrit]
      ,[uyrit]
      ,[eu]
      ,[eupuite]
      ,[eakr]
      ,[esr]
      ,[muueu]
      ,[urahas]
      ,[kv_jarj]
      ,[mulko]
      ,[ot_menot]
      ,[luontipvm]
      ,[tietolahde]=''TK_5_3_sopv_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_5_3_sopv_13]
--FROM [VipunenTK_SA].[dbo].[TK_5_3_sopv_13]

UNION ALL

SELECT [tilv]
      ,[tunn]
      ,[tiede] = ''TA10_''+tiede
      ,[yhme]
      ,[kmeno]
      ,[palme]
      ,[apuraha]
      ,[mkmeno]
      ,[ptmeno]
      ,[sakat]
      ,[mokm]
      ,[tekes]
      ,[mtem]
      ,[um]
      ,[om]
      ,[sm]
      ,[pm]
      ,[vm]
      ,[mmm]
      ,[lvm]
      ,[stm]
      ,[ym]
      ,[kunnat]
      ,[mjulk]
      ,[krahas]
      ,[kyrit]
      ,[uyrit]
      ,[eu]
      ,[eupuite]
      ,[eakr]
      ,[esr]
      ,[muueu]
      ,[urahas]
      ,[kv_jarj]
      ,[mulko]
      ,[ot_menot]
      ,[luontipvm]
      ,[tietolahde]=''TK_5_3_sopv_14''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_5_3_sopv_14]
--FROM [VipunenTK_SA].[dbo].[TK_5_3_sopv_14]

UNION ALL

SELECT [tilv]
      ,[tunn]
      ,[tiede] = ''TA10_''+tiede
      ,[yhme]
      ,[kmeno]
      ,[palme]
      ,[apuraha]
      ,[mkmeno]
      ,[ptmeno]
      ,[sakat]
      ,[mokm]
      ,[tekes]
      ,[mtem]
      ,[um]
      ,[om]
      ,[sm]
      ,[pm]
      ,[vm]
      ,[mmm]
      ,[lvm]
      ,[stm]
      ,[ym]
      ,[kunnat]
      ,[mjulk]
      ,[krahas]
      ,[kyrit]
      ,[uyrit]
      ,[eu]
      ,[eupuite]
      ,[eakr]
      ,[esr]
      ,[muueu]
      ,[urahas]
      ,[kv_jarj]
      ,[mulko]
      ,[ot_menot] = otmenot
      ,[luontipvm]
      ,[tietolahde]=''TK_5_3_sopv_15''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_5_3_sopv_15]

UNION ALL

SELECT [tilv]
      ,[tunn]
      ,[tiede] = ''TA10_''+tiede
      ,[yhme]
      ,[kmeno]
      ,[palme]
      ,[apuraha]
      ,[mkmeno]
      ,[ptmeno]
      ,[sakat]
      ,[mokm]
      ,[tekes]
      ,[mtem]
      ,[um]
      ,[om]
      ,[sm]
      ,[pm]
      ,[vm]
      ,[mmm]
      ,[lvm]
      ,[stm]
      ,[ym]
      ,[kunnat]
      ,[mjulk]
      ,[krahas]
      ,[kyrit]
      ,[uyrit]
      ,[eu]
      ,[eupuite]
      ,[eakr]
      ,[esr]
      ,[muueu]
      ,[urahas]
      ,[kv_jarj]
      ,[mulko]
      ,[ot_menot] = otmenot
      ,[luontipvm]
      ,[tietolahde]=''TK_5_3_sopv_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_5_3_sopv_16]


) kaikkivuodet











' 
GO
/****** Object:  View [dbo].[v_sa_5_4_Ammattikorkeakoulujen_tutkimus_ja_kehitys]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_5_4_Ammattikorkeakoulujen_tutkimus_ja_kehitys]'))
EXEC dbo.sp_executesql @statement = N'











CREATE VIEW [dbo].[v_sa_5_4_Ammattikorkeakoulujen_tutkimus_ja_kehitys] AS
/*
Aineisto muuttui K-aineistoksi 2016. K-koodia ei lisätty näkymän nimeen. /18.1.2016 CSC Jarmo
K poistettu /16.2.2016 CSC Jarmo

Drop table [VipunenTK_DW].[dbo].[sa_5_4_Ammattikorkeakoulujen_tutkimus_ja_kehitys]
Select * into [VipunenTK_DW].[dbo].[sa_5_4_Ammattikorkeakoulujen_tutkimus_ja_kehitys] FROM VipunenTK_SA.[dbo].[v_sa_5_4_Ammattikorkeakoulujen_tutkimus_ja_kehitys]

Truncate table [VipunenTK_DW].[dbo].[sa_5_4_Ammattikorkeakoulujen_tutkimus_ja_kehitys]
Insert into [VipunenTK_DW].[dbo].[sa_5_4_Ammattikorkeakoulujen_tutkimus_ja_kehitys]
  Select * FROM VipunenTK_SA.[dbo].[v_sa_5_4_Ammattikorkeakoulujen_tutkimus_ja_kehitys]
*/

SELECT [tilv] = CAST(kaikkivuodet.tilv as nvarchar(4))
	  ,[tilv_date] = Cast(kaikkivuodet.tilv+''0101'' as date)
      ,[NIMI]
      ,[NIMI2]
      ,[TK_koodi]
      ,[TOLKM]
      ,[NTOLKM]
      ,[TOTTV]
      ,[LISLKM]
      ,[NLISLKM]
      ,[LISTTV]
      ,[DILKM]
      ,[NDIPLKM]
      ,[DIPTTV]
      ,[INSLKM]
      ,[NOPINS]
      ,[OPINSTTV]
      ,[YHTE]
      ,[NYHTE]
      ,[YHTTTV]
      ,[PAME]
      ,[OSTPAL]
      ,[YHME]
      ,[TEKES]
      ,[MTEM]
      ,[AKATEMIA]
      ,[GRAD]
      ,[MOPEM]
      ,[LIIKM]
      ,[MAAM]
      ,[OM]
      ,[PM]
      ,[SISAM]
      ,[SOSM]
      ,[UM]
      ,[VN]
      ,[VM]
      ,[YMP]
      ,[MUUJU]
      ,[RAHAS]
      ,[KOTIM]
      ,[ULKOY]
      ,[UEU]
	  ,[EUPUITE]
	  ,[EAKR]
	  ,[ESR]
	  ,[MUUEU]
      ,[MULKO]
      ,[UYHTE]
      ,[KUNTA1] = Cast(Nullif(Right(''000''+Cast(KUNTA1 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA2] = Cast(Nullif(Right(''000''+Cast(KUNTA2 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA3] = Cast(Nullif(Right(''000''+Cast(KUNTA3 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA4] = Cast(Nullif(Right(''000''+Cast(KUNTA4 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA5] = Cast(Nullif(Right(''000''+Cast(KUNTA5 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA6] = Cast(Nullif(Right(''000''+Cast(KUNTA6 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA7] = Cast(Nullif(Right(''000''+Cast(KUNTA7 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA8] = Cast(Nullif(Right(''000''+Cast(KUNTA8 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA9] = Cast(Nullif(Right(''000''+Cast(KUNTA9 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA10] = Cast(Nullif(Right(''000''+Cast(KUNTA10 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA11] = Cast(Nullif(Right(''000''+Cast(KUNTA11 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA12] = Cast(Nullif(Right(''000''+Cast(KUNTA12 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA13] = Cast(Nullif(Right(''000''+Cast(KUNTA13 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA14] = Cast(Nullif(Right(''000''+Cast(KUNTA14 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA15] = Cast(Nullif(Right(''000''+Cast(KUNTA15 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA16] = Cast(Nullif(Right(''000''+Cast(KUNTA16 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA17] = Cast(Nullif(Right(''000''+Cast(KUNTA17 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA18] = Cast(Nullif(Right(''000''+Cast(KUNTA18 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA19] = Cast(Nullif(Right(''000''+Cast(KUNTA19 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA20] = Cast(Nullif(Right(''000''+Cast(KUNTA20 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA21] = Cast(Nullif(Right(''000''+Cast(KUNTA21 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA22] = Cast(Nullif(Right(''000''+Cast(KUNTA22 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA23] = Cast(Nullif(Right(''000''+Cast(KUNTA23 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA24] = Cast(Nullif(Right(''000''+Cast(KUNTA24 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA25] = Cast(Nullif(Right(''000''+Cast(KUNTA25 as varchar(3)),3),''000'') as varchar(3))
      ,[HENLKMY]
      ,[TYOVY]
      ,[TKMENOY]
      ,[HENLKM1]
      ,[HENLKM2]
      ,[HENLKM3]
      ,[HENLKM4]
      ,[HENLKM5]
      ,[HENLKM6]
      ,[HENLKM7]
      ,[HENLKM8]
      ,[HENLKM9]
      ,[HENLKM10]
      ,[HENLKM11]
      ,[HENLKM12]
      ,[HENLKM13]
      ,[HENLKM14]
      ,[HENLKM15]
      ,[HENLKM16]
      ,[HENLKM17]
      ,[HENLKM18]
      ,[HENLKM19]
      ,[HENLKM20]
      ,[HENLKM21]
      ,[HENLKM22]
      ,[HENLKM23]
      ,[HENLKM24]
      ,[HENLKM25]
      ,[TYOV1]
      ,[TYOV2]
      ,[TYOV3]
      ,[TYOV4]
      ,[TYOV5]
      ,[TYOV6]
      ,[TYOV7]
      ,[TYOV8]
      ,[TYOV9]
      ,[TYOV10]
      ,[TYOV11]
      ,[TYOV12]
      ,[TYOV13]
      ,[TYOV14]
      ,[TYOV15]
      ,[TYOV16]
      ,[TYOV17]
      ,[TYOV18]
      ,[TYOV19]
      ,[TYOV20]
      ,[TYOV21]
      ,[TYOV22]
      ,[TYOV23]
      ,[TYOV24]
      ,[TYOV25]
      ,[TKMENO1]
      ,[TKMENO2]
      ,[TKMENO3]
      ,[TKMENO4]
      ,[TKMENO5]
      ,[TKMENO6]
      ,[TKMENO7]
      ,[TKMENO8]
      ,[TKMENO9]
      ,[TKMENO10]
      ,[TKMENO11]
      ,[TKMENO12]
      ,[TKMENO13]
      ,[TKMENO14]
      ,[TKMENO15]
      ,[TKMENO16]
      ,[TKMENO17]
      ,[TKMENO18]
      ,[TKMENO19]
      ,[TKMENO20]
      ,[TKMENO21]
      ,[TKMENO22]
      ,[TKMENO23]
      ,[TKMENO24]
      ,[TKMENO25]
      ,[TA1] = Cast(tieteenalakoodisto + ''_'' + Nullif(Cast(TA1 as varchar(4)), ''0'') as varchar(10))
      ,[TA2] = Cast(tieteenalakoodisto + ''_'' + Nullif(Cast(TA2 as varchar(4)), ''0'') as varchar(10))
      ,[TA3] = Cast(tieteenalakoodisto + ''_'' + Nullif(Cast(TA3 as varchar(4)), ''0'') as varchar(10))
      ,[TA4] = Cast(tieteenalakoodisto + ''_'' + Nullif(Cast(TA4 as varchar(4)), ''0'') as varchar(10))
      ,[TA5] = Cast(tieteenalakoodisto + ''_'' + Nullif(Cast(TA5 as varchar(4)), ''0'') as varchar(10))
      ,[TA6] = Cast(tieteenalakoodisto + ''_'' + Nullif(Cast(TA6 as varchar(4)), ''0'') as varchar(10))
      ,[TA7] = Cast(tieteenalakoodisto + ''_'' + Nullif(Cast(TA7 as varchar(4)), ''0'') as varchar(10))
      ,[TA8] = Cast(tieteenalakoodisto + ''_'' + Nullif(Cast(TA8 as varchar(4)), ''0'') as varchar(10))
      ,[TA9] = Cast(tieteenalakoodisto + ''_'' + Nullif(Cast(TA9 as varchar(4)), ''0'') as varchar(10))
      ,[TA10] = Cast(tieteenalakoodisto + ''_'' + Nullif(Cast(TA10 as varchar(4)), ''0'') as varchar(10))
      ,[TA11] = Cast(tieteenalakoodisto + ''_'' + Nullif(Cast(TA11 as varchar(4)), ''0'') as varchar(10))
      ,[TA12] = Cast(tieteenalakoodisto + ''_'' + Nullif(Cast(TA12 as varchar(4)), ''0'') as varchar(10))
      ,[TA13] = Cast(tieteenalakoodisto + ''_'' + Nullif(Cast(TA13 as varchar(4)), ''0'') as varchar(10))
      ,[TA14] = Cast(tieteenalakoodisto + ''_'' + Nullif(Cast(TA14 as varchar(4)), ''0'') as varchar(10))
      ,[TA15] = Cast(tieteenalakoodisto + ''_'' + Nullif(Cast(TA15 as varchar(4)), ''0'') as varchar(10))
      ,[TA16] = Cast(tieteenalakoodisto + ''_'' + Nullif(Cast(TA16 as varchar(4)), ''0'') as varchar(10))
      ,[TA17] = Cast(tieteenalakoodisto + ''_'' + Nullif(Cast(TA17 as varchar(4)), ''0'') as varchar(10))
      ,[TA18] = Cast(tieteenalakoodisto + ''_'' + Nullif(Cast(TA18 as varchar(4)), ''0'') as varchar(10))
      ,[TA1P]
      ,[TA2P]
      ,[TA3P]
      ,[TA4P]
      ,[TA5P]
      ,[TA6P]
      ,[TA7P]
      ,[TA8P]
      ,[TA9P]
      ,[TA10P]
      ,[TA11P]
      ,[TA12P]
      ,[TA13P]
      ,[TA14P]
      ,[TA15P]
      ,[TA16P]
      ,[TA17P]
      ,[TA18P]
      ,[tk_arvio]
      ,[tk_arvioe]
      ,[KMENO]
      ,[HMENO]
      ,[TUTLKM]
      ,[NTUTLKM]
      ,[TUTTTV]
      ,[MTKLKM]
      ,[NMTKLKM]
      ,[MTKTTV]
      ,[YHTE2]
      ,[NYHTE2]
      ,[MKOULKM]
      ,[NMKOULKM]
      ,[MKOUTTV]
      ,[OPISTLKM]
      ,[NOPISTLKM]
      ,[OPISTTTV]
      ,[KUNNAT]
      ,[MKVJ]
      ,[ORAHAS]
      ,[phy1]
      ,[phy2]
      ,[phy3]
      ,[phy4]
      ,[phy5]
      ,[phy6]
      ,[phyy]
      ,[phn1]
      ,[phn2]
      ,[phn3]
      ,[phn4]
      ,[phn5]
      ,[phn6]
      ,[phny]
      ,[pty1]
      ,[pty2]
      ,[pty3]
      ,[pty4]
      ,[pty5]
      ,[pty6]
      ,[ptyy]
      ,[ptn1]
      ,[ptn2]
      ,[ptn3]
      ,[ptn4]
      ,[ptn5]
      ,[ptn6]
      ,[ptny]
      ,[tietolahde] = CAST(kaikkivuodet.tietolahde as nvarchar(50))
      ,[rivinumero] = CAST(kaikkivuodet.rivinumero as int)

FROM ( --kaikkivuodet

SELECT [tilv]
      ,[NIMI]
      ,[NIMI2]
      ,[TK_koodi]
      ,[TOLKM]
      ,[NTOLKM]
      ,[TOTTV]
      ,[LISLKM]
      ,[NLISLKM]
      ,[LISTTV]
      ,[DILKM]
      ,[NDIPLKM]
      ,[DIPTTV]
      ,[INSLKM]
      ,[NOPINS]
      ,[OPINSTTV]
      ,[YHTE]
      ,[NYHTE]
      ,[YHTTTV]
      ,[PAME]
      ,[OSTPAL]
      ,[YHME]
      ,[TEKES]
      ,[MTEM]
      ,[AKATEMIA]
      ,[GRAD]
      ,[MOPEM]
      ,[LIIKM]
      ,[MAAM]
      ,[OM]
      ,[PM]
      ,[SISAM]
      ,[SOSM]
      ,[UM]
      ,[VN]
      ,[VM]
      ,[YMP]
      ,[MUUJU]
      ,[RAHAS]
      ,[KOTIM]
      ,[ULKOY]
      ,[UEU]
	  ,[EUPUITE] = NULL
	  ,[EAKR] = NULL
	  ,[ESR] = NULL
	  ,[MUUEU] = NULL
      ,[MULKO]
      ,[UYHTE]
      ,[KUNTA1]
      ,[KUNTA2]
      ,[KUNTA3]
      ,[KUNTA4]
      ,[KUNTA5]
      ,[KUNTA6]
      ,[KUNTA7]
      ,[KUNTA8]
      ,[KUNTA9]
      ,[KUNTA10]
      ,[KUNTA11]
      ,[KUNTA12]
      ,[KUNTA13]
      ,[KUNTA14]
      ,[KUNTA15]
      ,[KUNTA16]
      ,[KUNTA17]
      ,[KUNTA18]
      ,[KUNTA19]
      ,[KUNTA20]
      ,[KUNTA21]
      ,[KUNTA22]
      ,[KUNTA23]
      ,[KUNTA24]
      ,[KUNTA25]
      ,[HENLKMY]
      ,[TYOVY]
      ,[TKMENOY]
      ,[HENLKM1]
      ,[HENLKM2]
      ,[HENLKM3]
      ,[HENLKM4]
      ,[HENLKM5]
      ,[HENLKM6]
      ,[HENLKM7]
      ,[HENLKM8]
      ,[HENLKM9]
      ,[HENLKM10]
      ,[HENLKM11]
      ,[HENLKM12]
      ,[HENLKM13]
      ,[HENLKM14]
      ,[HENLKM15]
      ,[HENLKM16]
      ,[HENLKM17]
      ,[HENLKM18]
      ,[HENLKM19]
      ,[HENLKM20]
      ,[HENLKM21]
      ,[HENLKM22]
      ,[HENLKM23]
      ,[HENLKM24]
      ,[HENLKM25]
      ,[TYOV1]
      ,[TYOV2]
      ,[TYOV3]
      ,[TYOV4]
      ,[TYOV5]
      ,[TYOV6]
      ,[TYOV7]
      ,[TYOV8]
      ,[TYOV9]
      ,[TYOV10]
      ,[TYOV11]
      ,[TYOV12]
      ,[TYOV13]
      ,[TYOV14]
      ,[TYOV15]
      ,[TYOV16]
      ,[TYOV17]
      ,[TYOV18]
      ,[TYOV19]
      ,[TYOV20]
      ,[TYOV21]
      ,[TYOV22]
      ,[TYOV23]
      ,[TYOV24]
      ,[TYOV25]
      ,[TKMENO1]
      ,[TKMENO2]
      ,[TKMENO3]
      ,[TKMENO4]
      ,[TKMENO5]
      ,[TKMENO6]
      ,[TKMENO7]
      ,[TKMENO8]
      ,[TKMENO9]
      ,[TKMENO10]
      ,[TKMENO11]
      ,[TKMENO12]
      ,[TKMENO13]
      ,[TKMENO14]
      ,[TKMENO15]
      ,[TKMENO16]
      ,[TKMENO17]
      ,[TKMENO18]
      ,[TKMENO19]
      ,[TKMENO20]
      ,[TKMENO21]
      ,[TKMENO22]
      ,[TKMENO23]
      ,[TKMENO24]
      ,[TKMENO25]
      ,[TA1]
      ,[TA2]
      ,[TA3]
      ,[TA4]
      ,[TA5]
      ,[TA6]
      ,[TA7]
      ,[TA8]
      ,[TA9]
      ,[TA10]
      ,[TA11]
      ,[TA12]
      ,[TA13]
      ,[TA14]
      ,[TA15]
      ,[TA16]
      ,[TA17]
      ,[TA18]
      ,[TA1P]
      ,[TA2P]
      ,[TA3P]
      ,[TA4P]
      ,[TA5P]
      ,[TA6P]
      ,[TA7P]
      ,[TA8P]
      ,[TA9P]
      ,[TA10P]
      ,[TA11P]
      ,[TA12P]
      ,[TA13P]
      ,[TA14P]
      ,[TA15P]
      ,[TA16P]
      ,[TA17P]
      ,[TA18P]
      ,[tk_arvio]
      ,[tk_arvioe]
      ,[KMENO]
      ,[HMENO]
      ,[TUTLKM]
      ,[NTUTLKM]
      ,[TUTTTV]
      ,[MTKLKM]
      ,[NMTKLKM]
      ,[MTKTTV]
      ,[YHTE2]
      ,[NYHTE2]
      ,[MKOULKM]
      ,[NMKOULKM]
      ,[MKOUTTV]
      ,[OPISTLKM]
      ,[NOPISTLKM]
      ,[OPISTTTV]
      ,[KUNNAT]
      ,[MKVJ]
      ,[ORAHAS]
      ,[phy1]
      ,[phy2]
      ,[phy3]
      ,[phy4]
      ,[phy5]
      ,[phy6]
      ,[phyy]
      ,[phn1]
      ,[phn2]
      ,[phn3]
      ,[phn4]
      ,[phn5]
      ,[phn6]
      ,[phny]
      ,[pty1]
      ,[pty2]
      ,[pty3]
      ,[pty4]
      ,[pty5]
      ,[pty6]
      ,[ptyy]
      ,[ptn1]
      ,[ptn2]
      ,[ptn3]
      ,[ptn4]
      ,[ptn5]
      ,[ptn6]
      ,[ptny]
      ,[luontipvm]
	  ,tieteenalakoodisto=''TA07''
      ,[tietolahde]=''TK_5_4_sopv_12_amk''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY TK_Koodi)
FROM [TK_H9098_CSC].[dbo].[TK_5_4_sopv_12_amk]

UNION ALL

SELECT [tilv]
      ,[NIMI]
      ,[NIMI2]
      ,[TK_koodi]
      ,[TOLKM]
      ,[NTOLKM]
      ,[TOTTV]
      ,[LISLKM]
      ,[NLISLKM]
      ,[LISTTV]
      ,[DILKM]
      ,[NDIPLKM]
      ,[DIPTTV]
      ,[INSLKM]
      ,[NOPINS]
      ,[OPINSTTV]
      ,[YHTE]
      ,[NYHTE]
      ,[YHTTTV]
      ,[PAME]
      ,[OSTPAL]
      ,[YHME]
      ,[TEKES]
      ,[MTEM]
      ,[AKATEMIA]
      ,[GRAD]
      ,[MOPEM]
      ,[LIIKM]
      ,[MAAM]
      ,[OM]
      ,[PM]
      ,[SISAM]
      ,[SOSM]
      ,[UM]
      ,[VN]
      ,[VM]
      ,[YMP]
      ,[MUUJU]
      ,[RAHAS]
      ,[KOTIM]
      ,[ULKOY]
      ,[UEU]
	  ,[EUPUITE]
	  ,[EAKR]
	  ,[ESR]
	  ,[MUUEU]
      ,[MULKO]
      ,[UYHTE]
      ,[KUNTA1]
      ,[KUNTA2]
      ,[KUNTA3]
      ,[KUNTA4]
      ,[KUNTA5]
      ,[KUNTA6]
      ,[KUNTA7]
      ,[KUNTA8]
      ,[KUNTA9]
      ,[KUNTA10]
      ,[KUNTA11]
      ,[KUNTA12]
      ,[KUNTA13]
      ,[KUNTA14]
      ,[KUNTA15]
      ,[KUNTA16]
      ,[KUNTA17]
      ,[KUNTA18]
      ,[KUNTA19]
      ,[KUNTA20]
      ,[KUNTA21]
      ,[KUNTA22]
      ,[KUNTA23]
      ,[KUNTA24]
      ,[KUNTA25]
      ,[HENLKMY]
      ,[TYOVY]
      ,[TKMENOY]
      ,[HENLKM1]
      ,[HENLKM2]
      ,[HENLKM3]
      ,[HENLKM4]
      ,[HENLKM5]
      ,[HENLKM6]
      ,[HENLKM7]
      ,[HENLKM8]
      ,[HENLKM9]
      ,[HENLKM10]
      ,[HENLKM11]
      ,[HENLKM12]
      ,[HENLKM13]
      ,[HENLKM14]
      ,[HENLKM15]
      ,[HENLKM16]
      ,[HENLKM17]
      ,[HENLKM18]
      ,[HENLKM19]
      ,[HENLKM20]
      ,[HENLKM21]
      ,[HENLKM22]
      ,[HENLKM23]
      ,[HENLKM24]
      ,[HENLKM25]
      ,[TYOV1]
      ,[TYOV2]
      ,[TYOV3]
      ,[TYOV4]
      ,[TYOV5]
      ,[TYOV6]
      ,[TYOV7]
      ,[TYOV8]
      ,[TYOV9]
      ,[TYOV10]
      ,[TYOV11]
      ,[TYOV12]
      ,[TYOV13]
      ,[TYOV14]
      ,[TYOV15]
      ,[TYOV16]
      ,[TYOV17]
      ,[TYOV18]
      ,[TYOV19]
      ,[TYOV20]
      ,[TYOV21]
      ,[TYOV22]
      ,[TYOV23]
      ,[TYOV24]
      ,[TYOV25]
      ,[TKMENO1]
      ,[TKMENO2]
      ,[TKMENO3]
      ,[TKMENO4]
      ,[TKMENO5]
      ,[TKMENO6]
      ,[TKMENO7]
      ,[TKMENO8]
      ,[TKMENO9]
      ,[TKMENO10]
      ,[TKMENO11]
      ,[TKMENO12]
      ,[TKMENO13]
      ,[TKMENO14]
      ,[TKMENO15]
      ,[TKMENO16]
      ,[TKMENO17]
      ,[TKMENO18]
      ,[TKMENO19]
      ,[TKMENO20]
      ,[TKMENO21]
      ,[TKMENO22]
      ,[TKMENO23]
      ,[TKMENO24]
      ,[TKMENO25]
      ,[TA1]
      ,[TA2]
      ,[TA3]
      ,[TA4]
      ,[TA5]
      ,[TA6]
      ,[TA7]
      ,[TA8]
      ,[TA9]
      ,[TA10]
      ,[TA11]
      ,[TA12]
      ,[TA13]
      ,[TA14]
      ,[TA15]
      ,[TA16]
      ,[TA17]
      ,[TA18]
      ,[TA1P]
      ,[TA2P]
      ,[TA3P]
      ,[TA4P]
      ,[TA5P]
      ,[TA6P]
      ,[TA7P]
      ,[TA8P]
      ,[TA9P]
      ,[TA10P]
      ,[TA11P]
      ,[TA12P]
      ,[TA13P]
      ,[TA14P]
      ,[TA15P]
      ,[TA16P]
      ,[TA17P]
      ,[TA18P]
      ,[tk_arvio]
      ,[tk_arvioe]
      ,[KMENO]
      ,[HMENO]
      ,[TUTLKM]
      ,[NTUTLKM]
      ,[TUTTTV]
      ,[MTKLKM]
      ,[NMTKLKM]
      ,[MTKTTV]
      ,[YHTE2]
      ,[NYHTE2]
      ,[MKOULKM]
      ,[NMKOULKM]
      ,[MKOUTTV]
      ,[OPISTLKM]
      ,[NOPISTLKM]
      ,[OPISTTTV]
      ,[KUNNAT]
      ,[MKVJ]
      ,[ORAHAS]
      ,[phy1]
      ,[phy2]
      ,[phy3]
      ,[phy4]
      ,[phy5]
      ,[phy6]
      ,[phyy]
      ,[phn1]
      ,[phn2]
      ,[phn3]
      ,[phn4]
      ,[phn5]
      ,[phn6]
      ,[phny]
      ,[pty1]
      ,[pty2]
      ,[pty3]
      ,[pty4]
      ,[pty5]
      ,[pty6]
      ,[ptyy]
      ,[ptn1]
      ,[ptn2]
      ,[ptn3]
      ,[ptn4]
      ,[ptn5]
      ,[ptn6]
      ,[ptny]
      ,[luontipvm]
	  ,tieteenalakoodisto=''TA10''
      ,[tietolahde]=''TK_5_4_sopv_13_amk''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY TK_Koodi)
FROM [TK_H9098_CSC].[dbo].[TK_5_4_sopv_13_amk]

UNION ALL

SELECT [tilv]
      ,[NIMI]
      ,[NIMI2]
      ,[TK_koodi]
      ,[TOLKM]
      ,[NTOLKM]
      ,[TOTTV]
      ,[LISLKM]
      ,[NLISLKM]
      ,[LISTTV]
      ,[DILKM]
      ,[NDIPLKM]
      ,[DIPTTV]
      ,[INSLKM]
      ,[NOPINS]
      ,[OPINSTTV]
      ,[YHTE]
      ,[NYHTE]
      ,[YHTTTV]
      ,[PAME]
      ,[OSTPAL]
      ,[YHME]
      ,[TEKES]
      ,[MTEM]
      ,[AKATEMIA]
      ,[GRAD]
      ,[MOPEM]
      ,[LIIKM]
      ,[MAAM]
      ,[OM]
      ,[PM]
      ,[SISAM]
      ,[SOSM]
      ,[UM]
      ,[VN]
      ,[VM]
      ,[YMP]
      ,[MUUJU]
      ,[RAHAS]
      ,[KOTIM]
      ,[ULKOY]
      ,[UEU]
	  ,[EUPUITE]
	  ,[EAKR]
	  ,[ESR]
	  ,[MUUEU]
      ,[MULKO]
      ,[UYHTE]
      ,[KUNTA1]
      ,[KUNTA2]
      ,[KUNTA3]
      ,[KUNTA4]
      ,[KUNTA5]
      ,[KUNTA6]
      ,[KUNTA7]
      ,[KUNTA8]
      ,[KUNTA9]
      ,[KUNTA10]
      ,[KUNTA11]
      ,[KUNTA12]
      ,[KUNTA13]
      ,[KUNTA14]
      ,[KUNTA15]
      ,[KUNTA16]
      ,[KUNTA17]
      ,[KUNTA18]
      ,[KUNTA19]
      ,[KUNTA20]
      ,[KUNTA21]
      ,[KUNTA22]
      ,[KUNTA23]
      ,[KUNTA24]
      ,[KUNTA25]
      ,[HENLKMY]
      ,[TYOVY]
      ,[TKMENOY]
      ,[HENLKM1]
      ,[HENLKM2]
      ,[HENLKM3]
      ,[HENLKM4]
      ,[HENLKM5]
      ,[HENLKM6]
      ,[HENLKM7]
      ,[HENLKM8]
      ,[HENLKM9]
      ,[HENLKM10]
      ,[HENLKM11]
      ,[HENLKM12]
      ,[HENLKM13]
      ,[HENLKM14]
      ,[HENLKM15]
      ,[HENLKM16]
      ,[HENLKM17]
      ,[HENLKM18]
      ,[HENLKM19]
      ,[HENLKM20]
      ,[HENLKM21]
      ,[HENLKM22]
      ,[HENLKM23]
      ,[HENLKM24]
      ,[HENLKM25]
      ,[TYOV1]
      ,[TYOV2]
      ,[TYOV3]
      ,[TYOV4]
      ,[TYOV5]
      ,[TYOV6]
      ,[TYOV7]
      ,[TYOV8]
      ,[TYOV9]
      ,[TYOV10]
      ,[TYOV11]
      ,[TYOV12]
      ,[TYOV13]
      ,[TYOV14]
      ,[TYOV15]
      ,[TYOV16]
      ,[TYOV17]
      ,[TYOV18]
      ,[TYOV19]
      ,[TYOV20]
      ,[TYOV21]
      ,[TYOV22]
      ,[TYOV23]
      ,[TYOV24]
      ,[TYOV25]
      ,[TKMENO1]
      ,[TKMENO2]
      ,[TKMENO3]
      ,[TKMENO4]
      ,[TKMENO5]
      ,[TKMENO6]
      ,[TKMENO7]
      ,[TKMENO8]
      ,[TKMENO9]
      ,[TKMENO10]
      ,[TKMENO11]
      ,[TKMENO12]
      ,[TKMENO13]
      ,[TKMENO14]
      ,[TKMENO15]
      ,[TKMENO16]
      ,[TKMENO17]
      ,[TKMENO18]
      ,[TKMENO19]
      ,[TKMENO20]
      ,[TKMENO21]
      ,[TKMENO22]
      ,[TKMENO23]
      ,[TKMENO24]
      ,[TKMENO25]
      ,[TA1]
      ,[TA2]
      ,[TA3]
      ,[TA4]
      ,[TA5]
      ,[TA6]
      ,[TA7]
      ,[TA8]
      ,[TA9]
      ,[TA10]
      ,[TA11]
      ,[TA12]
      ,[TA13]
      ,[TA14]
      ,[TA15]
      ,[TA16]
      ,[TA17]
      ,[TA18]
      ,[TA1P]
      ,[TA2P]
      ,[TA3P]
      ,[TA4P]
      ,[TA5P]
      ,[TA6P]
      ,[TA7P]
      ,[TA8P]
      ,[TA9P]
      ,[TA10P]
      ,[TA11P]
      ,[TA12P]
      ,[TA13P]
      ,[TA14P]
      ,[TA15P]
      ,[TA16P]
      ,[TA17P]
      ,[TA18P]
      ,[tk_arvio]
      ,[tk_arvioe]
      ,[KMENO]
      ,[HMENO]
      ,[TUTLKM]
      ,[NTUTLKM]
      ,[TUTTTV]
      ,[MTKLKM]
      ,[NMTKLKM]
      ,[MTKTTV]
      ,[YHTE2]
      ,[NYHTE2]
      ,[MKOULKM]
      ,[NMKOULKM]
      ,[MKOUTTV]
      ,[OPISTLKM]
      ,[NOPISTLKM]
      ,[OPISTTTV]
      ,[KUNNAT]
      ,[MKVJ]
      ,[ORAHAS]
      ,[phy1]
      ,[phy2]
      ,[phy3]
      ,[phy4]
      ,[phy5]
      ,[phy6]
      ,[phyy]
      ,[phn1]
      ,[phn2]
      ,[phn3]
      ,[phn4]
      ,[phn5]
      ,[phn6]
      ,[phny]
      ,[pty1]
      ,[pty2]
      ,[pty3]
      ,[pty4]
      ,[pty5]
      ,[pty6]
      ,[ptyy]
      ,[ptn1]
      ,[ptn2]
      ,[ptn3]
      ,[ptn4]
      ,[ptn5]
      ,[ptn6]
      ,[ptny]
      ,[luontipvm]
	  ,tieteenalakoodisto=''TA10''
      ,[tietolahde]=''TK_5_4_sopv_14_amk''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY TK_Koodi)
FROM [TK_H9098_CSC].[dbo].[TK_5_4_sopv_14_amk]

UNION ALL

SELECT [tilv]
      ,[NIMI]
      ,[NIMI2]
      ,[TK_koodi]
      ,[TOLKM]
      ,[NTOLKM]
      ,[TOTTV]
      ,[LISLKM]
      ,[NLISLKM]
      ,[LISTTV]
      ,[DILKM]
      ,[NDIPLKM]
      ,[DIPTTV]
      ,[INSLKM]
      ,[NOPINS]
      ,[OPINSTTV]
      ,[YHTE]
      ,[NYHTE]
      ,[YHTTTV]
      ,[PAME]
      ,[OSTPAL]
      ,[YHME]
      ,[TEKES]
      ,[MTEM]
      ,[AKATEMIA]
      ,[GRAD]
      ,[MOPEM]
      ,[LIIKM]
      ,[MAAM]
      ,[OM]
      ,[PM]
      ,[SISAM]
      ,[SOSM]
      ,[UM]
      ,[VN]
      ,[VM]
      ,[YMP]
      ,[MUUJU]
      ,[RAHAS]
      ,[KOTIM]
      ,[ULKOY]
      ,[UEU]
	  ,[EUPUITE] 
	  ,[EAKR] 
	  ,[ESR] 
	  ,[MUUEU] 
      ,[MULKO]
      ,[UYHTE]
      ,[KUNTA1]
      ,[KUNTA2]
      ,[KUNTA3]
      ,[KUNTA4]
      ,[KUNTA5]
      ,[KUNTA6]
      ,[KUNTA7]
      ,[KUNTA8]
      ,[KUNTA9]
      ,[KUNTA10]
      ,[KUNTA11]
      ,[KUNTA12]
      ,[KUNTA13]
      ,[KUNTA14]
      ,[KUNTA15]
      ,[KUNTA16]
      ,[KUNTA17]
      ,[KUNTA18]
      ,[KUNTA19]
      ,[KUNTA20]
      ,[KUNTA21]
      ,[KUNTA22]
      ,[KUNTA23]
      ,[KUNTA24]
      ,[KUNTA25]
      ,[HENLKMY]
      ,[TYOVY]
      ,[TKMENOY]
      ,[HENLKM1]
      ,[HENLKM2]
      ,[HENLKM3]
      ,[HENLKM4]
      ,[HENLKM5]
      ,[HENLKM6]
      ,[HENLKM7]
      ,[HENLKM8]
      ,[HENLKM9]
      ,[HENLKM10]
      ,[HENLKM11]
      ,[HENLKM12]
      ,[HENLKM13]
      ,[HENLKM14]
      ,[HENLKM15]
      ,[HENLKM16]
      ,[HENLKM17]
      ,[HENLKM18]
      ,[HENLKM19]
      ,[HENLKM20]
      ,[HENLKM21]
      ,[HENLKM22]
      ,[HENLKM23]
      ,[HENLKM24]
      ,[HENLKM25]
      ,[TYOV1]
      ,[TYOV2]
      ,[TYOV3]
      ,[TYOV4]
      ,[TYOV5]
      ,[TYOV6]
      ,[TYOV7]
      ,[TYOV8]
      ,[TYOV9]
      ,[TYOV10]
      ,[TYOV11]
      ,[TYOV12]
      ,[TYOV13]
      ,[TYOV14]
      ,[TYOV15]
      ,[TYOV16]
      ,[TYOV17]
      ,[TYOV18]
      ,[TYOV19]
      ,[TYOV20]
      ,[TYOV21]
      ,[TYOV22]
      ,[TYOV23]
      ,[TYOV24]
      ,[TYOV25]
      ,[TKMENO1]
      ,[TKMENO2]
      ,[TKMENO3]
      ,[TKMENO4]
      ,[TKMENO5]
      ,[TKMENO6]
      ,[TKMENO7]
      ,[TKMENO8]
      ,[TKMENO9]
      ,[TKMENO10]
      ,[TKMENO11]
      ,[TKMENO12]
      ,[TKMENO13]
      ,[TKMENO14]
      ,[TKMENO15]
      ,[TKMENO16]
      ,[TKMENO17]
      ,[TKMENO18]
      ,[TKMENO19]
      ,[TKMENO20]
      ,[TKMENO21]
      ,[TKMENO22]
      ,[TKMENO23]
      ,[TKMENO24]
      ,[TKMENO25]
      ,[TA1]
      ,[TA2]
      ,[TA3]
      ,[TA4]
      ,[TA5]
      ,[TA6]
      ,[TA7]
      ,[TA8]
      ,[TA9]
      ,[TA10]
      ,[TA11]
      ,[TA12]
      ,[TA13]
      ,[TA14]
      ,[TA15]
      ,[TA16]
      ,[TA17]
      ,[TA18]
      ,[TA1P]
      ,[TA2P]
      ,[TA3P]
      ,[TA4P]
      ,[TA5P]
      ,[TA6P]
      ,[TA7P]
      ,[TA8P]
      ,[TA9P]
      ,[TA10P]
      ,[TA11P]
      ,[TA12P]
      ,[TA13P]
      ,[TA14P]
      ,[TA15P]
      ,[TA16P]
      ,[TA17P]
      ,[TA18P]
      ,[tk_arvio]
      ,[tk_arvioe]
      ,[KMENO]
      ,[HMENO]
      ,[TUTLKM]
      ,[NTUTLKM]
      ,[TUTTTV]
      ,[MTKLKM]
      ,[NMTKLKM]
      ,[MTKTTV]
      ,[YHTE2]
      ,[NYHTE2]
      ,[MKOULKM]
      ,[NMKOULKM]
      ,[MKOUTTV]
      ,[OPISTLKM]
      ,[NOPISTLKM]
      ,[OPISTTTV]
      ,[KUNNAT]
      ,[MKVJ]
      ,[ORAHAS]
      ,[phy1]
      ,[phy2]
      ,[phy3]
      ,[phy4]
      ,[phy5]
      ,[phy6]
      ,[phyy]
      ,[phn1]
      ,[phn2]
      ,[phn3]
      ,[phn4]
      ,[phn5]
      ,[phn6]
      ,[phny]
      ,[pty1]
      ,[pty2]
      ,[pty3]
      ,[pty4]
      ,[pty5]
      ,[pty6]
      ,[ptyy]
      ,[ptn1]
      ,[ptn2]
      ,[ptn3]
      ,[ptn4]
      ,[ptn5]
      ,[ptn6]
      ,[ptny]
      ,[luontipvm]
	  ,tieteenalakoodisto=''TA10''
      ,[tietolahde]=''TK_5_4_sopv_15_amk''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY TK_Koodi)
  FROM [TK_H9098_CSC].[dbo].[TK_5_4_sopv_15_amk]

UNION ALL

SELECT [tilv]
      ,[NIMI]
      ,[NIMI2]
      ,[TK_koodi]
      ,[TOLKM]
      ,[NTOLKM]
      ,[TOTTV]
      ,[LISLKM]
      ,[NLISLKM]
      ,[LISTTV]
      ,[DILKM]
      ,[NDIPLKM]
      ,[DIPTTV]
      ,[INSLKM]
      ,[NOPINS]
      ,[OPINSTTV]
      ,[YHTE]
      ,[NYHTE]
      ,[YHTTTV]
      ,[PAME]
      ,[OSTPAL]
      ,[YHME]
      ,[TEKES]
      ,[MTEM]
      ,[AKATEMIA]
      ,NULL AS [GRAD]
      ,[MOPEM]
      ,[LIIKM]
      ,[MAAM]
      ,[OM]
      ,[PM]
      ,[SISAM]
      ,[SOSM]
      ,[UM]
      ,[VN]
      ,[VM]
      ,[YMP]
      ,[MUUJU]
      ,[RAHAS]
      ,[KOTIM]
      ,[ULKOY]
      ,[UEU]
	  ,[EUPUITE]
	  ,[EAKR]
	  ,[ESR]
	  ,[MUUEU]
      ,[MULKO]
      ,[UYHTE]
      ,[KUNTA1]
      ,[KUNTA2]
      ,[KUNTA3]
      ,[KUNTA4]
      ,[KUNTA5]
      ,[KUNTA6]
      ,[KUNTA7]
      ,[KUNTA8]
      ,[KUNTA9]
      ,[KUNTA10]
      ,[KUNTA11]
      ,[KUNTA12]
      ,[KUNTA13]
      ,[KUNTA14]
      ,[KUNTA15]
      ,[KUNTA16]
      ,[KUNTA17]
      ,[KUNTA18]
      ,[KUNTA19]
      ,[KUNTA20]
      ,[KUNTA21]
      ,[KUNTA22]
      ,[KUNTA23]
      ,[KUNTA24]
      ,[KUNTA25]
      ,[HENLKMY]
      ,[TYOVY]
      ,[TKMENOY]
      ,[HENLKM1]
      ,[HENLKM2]
      ,[HENLKM3]
      ,[HENLKM4]
      ,[HENLKM5]
      ,[HENLKM6]
      ,[HENLKM7]
      ,[HENLKM8]
      ,[HENLKM9]
      ,[HENLKM10]
      ,[HENLKM11]
      ,[HENLKM12]
      ,[HENLKM13]
      ,[HENLKM14]
      ,[HENLKM15]
      ,[HENLKM16]
      ,[HENLKM17]
      ,[HENLKM18]
      ,[HENLKM19]
      ,[HENLKM20]
      ,[HENLKM21]
      ,[HENLKM22]
      ,[HENLKM23]
      ,[HENLKM24]
      ,[HENLKM25]
      ,[TYOV1]
      ,[TYOV2]
      ,[TYOV3]
      ,[TYOV4]
      ,[TYOV5]
      ,[TYOV6]
      ,[TYOV7]
      ,[TYOV8]
      ,[TYOV9]
      ,[TYOV10]
      ,[TYOV11]
      ,[TYOV12]
      ,[TYOV13]
      ,[TYOV14]
      ,[TYOV15]
      ,[TYOV16]
      ,[TYOV17]
      ,[TYOV18]
      ,[TYOV19]
      ,[TYOV20]
      ,[TYOV21]
      ,[TYOV22]
      ,[TYOV23]
      ,[TYOV24]
      ,[TYOV25]
      ,[TKMENO1]
      ,[TKMENO2]
      ,[TKMENO3]
      ,[TKMENO4]
      ,[TKMENO5]
      ,[TKMENO6]
      ,[TKMENO7]
      ,[TKMENO8]
      ,[TKMENO9]
      ,[TKMENO10]
      ,[TKMENO11]
      ,[TKMENO12]
      ,[TKMENO13]
      ,[TKMENO14]
      ,[TKMENO15]
      ,[TKMENO16]
      ,[TKMENO17]
      ,[TKMENO18]
      ,[TKMENO19]
      ,[TKMENO20]
      ,[TKMENO21]
      ,[TKMENO22]
      ,[TKMENO23]
      ,[TKMENO24]
      ,[TKMENO25]
      ,[TA1]
      ,[TA2]
      ,[TA3]
      ,[TA4]
      ,[TA5]
      ,[TA6]
      ,[TA7]
      ,[TA8]
      ,[TA9]
      ,[TA10]
      ,[TA11]
      ,[TA12]
      ,[TA13]
      ,[TA14]
      ,[TA15]
      ,[TA16]
      ,[TA17]
      ,[TA18]
      ,[TA1P]
      ,[TA2P]
      ,[TA3P]
      ,[TA4P]
      ,[TA5P]
      ,[TA6P]
      ,[TA7P]
      ,[TA8P]
      ,[TA9P]
      ,[TA10P]
      ,[TA11P]
      ,[TA12P]
      ,[TA13P]
      ,[TA14P]
      ,[TA15P]
      ,[TA16P]
      ,[TA17P]
      ,[TA18P]
      ,[tk_arvio]
      ,[tk_arvioe]
      ,[KMENO]
      ,[HMENO]
      ,[TUTLKM]
      ,[NTUTLKM]
      ,[TUTTTV]
      ,[MTKLKM]
      ,NULL AS [NMTKLKM]
      ,NULL AS [MTKTTV]
      ,NULL AS [YHTE2]
      ,NULL AS [NYHTE2]
      ,[MKOULKM]
      ,[NMKOULKM]
      ,[MKOUTTV]
      ,NULL AS [OPISTLKM]
      ,NULL AS [NOPISTLKM]
      ,NULL AS [OPISTTTV]
      ,[KUNNAT]
      ,[MKVJ]
      ,[ORAHAS]
      ,[phy1]
      ,[phy2]
      ,[phy3]
      ,[phy4]
      ,[phy5]
      ,[phy6]
      ,[phyy]
      ,[phn1]
      ,[phn2]
      ,[phn3]
      ,[phn4]
      ,[phn5]
      ,[phn6]
      ,[phny]
      ,[pty1]
      ,[pty2]
      ,[pty3]
      ,[pty4]
      ,[pty5]
      ,[pty6]
      ,[ptyy]
      ,[ptn1]
      ,[ptn2]
      ,[ptn3]
      ,[ptn4]
      ,[ptn5]
      ,[ptn6]
      ,[ptny]
      ,[luontipvm]
	  ,tieteenalakoodisto=''TA10''
      ,[tietolahde]=''TK_5_4_sopv_16_amk''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY TK_Koodi)
  FROM [TK_H9098_CSC].[dbo].[TK_5_4_sopv_16_amk]
) kaikkivuodet








' 
GO
/****** Object:  View [dbo].[v_sa_5_4_Sektoritutkimuslaitosten_tutkimus_ja_kehitys]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_5_4_Sektoritutkimuslaitosten_tutkimus_ja_kehitys]'))
EXEC dbo.sp_executesql @statement = N'











CREATE VIEW [dbo].[v_sa_5_4_Sektoritutkimuslaitosten_tutkimus_ja_kehitys] AS
/*
Aineisto muuttui K-aineistoksi 2016. K-koodia ei lisätty näkymän nimeen. /18.1.2016 CSC Jarmo
K poistettu /16.2.2016 CSC Jarmo

Drop table [VipunenTK_DW].[dbo].[sa_5_4_Sektoritutkimuslaitosten_tutkimus_ja_kehitys]
Select * into [VipunenTK_DW].[dbo].[sa_5_4_Sektoritutkimuslaitosten_tutkimus_ja_kehitys] FROM VipunenTK_SA.[dbo].[v_sa_5_4_Sektoritutkimuslaitosten_tutkimus_ja_kehitys]

Truncate table [VipunenTK_DW].[dbo].[sa_5_4_Sektoritutkimuslaitosten_tutkimus_ja_kehitys]
Insert into [VipunenTK_DW].[dbo].[sa_5_4_Sektoritutkimuslaitosten_tutkimus_ja_kehitys]
  Select * FROM VipunenTK_SA.[dbo].[v_sa_5_4_Sektoritutkimuslaitosten_tutkimus_ja_kehitys]
*/

SELECT [tilv] = CAST(kaikkivuodet.tilv as nvarchar(4))
	  ,[tilv_date] = Cast(kaikkivuodet.tilv+''0101'' as date)
      ,[NIMI]
      ,[NIMI2]
      ,[TK_koodi] = Cast(Right(''00000'' + kaikkivuodet.TK_koodi, 5) as varchar(5))
      ,[TOLKM]
      ,[NTOLKM]
      ,[TOTTV]
      ,[LISLKM]
      ,[NLISLKM]
      ,[LISTTV]
      ,[DILKM]
      ,[NDIPLKM]
      ,[DIPTTV]
      ,[INSLKM]
      ,[NOPINS]
      ,[OPINSTTV]
      ,[YHTE]
      ,[NYHTE]
      ,[YHTTTV]
      ,[PAME]
      ,[OSTPAL]
      ,[YHME]
      ,[TEKES]
      ,[MTEM]
      ,[AKATEMIA]
      ,[GRAD]
      ,[MOPEM]
      ,[LIIKM]
      ,[MAAM]
      ,[OM]
      ,[PM]
      ,[SISAM]
      ,[SOSM]
      ,[UM]
      ,[VN]
      ,[VM]
      ,[YMP]
      ,[MUUJU]
      ,[RAHAS]
      ,[KOTIM]
      ,[ULKOY]
      ,[UEU]
	  ,[EUPUITE]
	  ,[EAKR]
	  ,[ESR]
	  ,[MUUEU]
      ,[MULKO]
      ,[UYHTE]
      ,[KUNTA1] = Cast(Nullif(Right(''000''+Cast(KUNTA1 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA2] = Cast(Nullif(Right(''000''+Cast(KUNTA2 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA3] = Cast(Nullif(Right(''000''+Cast(KUNTA3 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA4] = Cast(Nullif(Right(''000''+Cast(KUNTA4 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA5] = Cast(Nullif(Right(''000''+Cast(KUNTA5 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA6] = Cast(Nullif(Right(''000''+Cast(KUNTA6 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA7] = Cast(Nullif(Right(''000''+Cast(KUNTA7 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA8] = Cast(Nullif(Right(''000''+Cast(KUNTA8 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA9] = Cast(Nullif(Right(''000''+Cast(KUNTA9 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA10] = Cast(Nullif(Right(''000''+Cast(KUNTA10 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA11] = Cast(Nullif(Right(''000''+Cast(KUNTA11 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA12] = Cast(Nullif(Right(''000''+Cast(KUNTA12 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA13] = Cast(Nullif(Right(''000''+Cast(KUNTA13 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA14] = Cast(Nullif(Right(''000''+Cast(KUNTA14 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA15] = Cast(Nullif(Right(''000''+Cast(KUNTA15 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA16] = Cast(Nullif(Right(''000''+Cast(KUNTA16 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA17] = Cast(Nullif(Right(''000''+Cast(KUNTA17 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA18] = Cast(Nullif(Right(''000''+Cast(KUNTA18 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA19] = Cast(Nullif(Right(''000''+Cast(KUNTA19 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA20] = Cast(Nullif(Right(''000''+Cast(KUNTA20 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA21] = Cast(Nullif(Right(''000''+Cast(KUNTA21 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA22] = Cast(Nullif(Right(''000''+Cast(KUNTA22 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA23] = Cast(Nullif(Right(''000''+Cast(KUNTA23 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA24] = Cast(Nullif(Right(''000''+Cast(KUNTA24 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA25] = Cast(Nullif(Right(''000''+Cast(KUNTA25 as varchar(3)),3),''000'') as varchar(3))
      ,[HENLKMY]
      ,[TYOVY]
      ,[TKMENOY]
      ,[HENLKM1]
      ,[HENLKM2]
      ,[HENLKM3]
      ,[HENLKM4]
      ,[HENLKM5]
      ,[HENLKM6]
      ,[HENLKM7]
      ,[HENLKM8]
      ,[HENLKM9]
      ,[HENLKM10]
      ,[HENLKM11]
      ,[HENLKM12]
      ,[HENLKM13]
      ,[HENLKM14]
      ,[HENLKM15]
      ,[HENLKM16]
      ,[HENLKM17]
      ,[HENLKM18]
      ,[HENLKM19]
      ,[HENLKM20]
      ,[HENLKM21]
      ,[HENLKM22]
      ,[HENLKM23]
      ,[HENLKM24]
      ,[HENLKM25]
      ,[TYOV1]
      ,[TYOV2]
      ,[TYOV3]
      ,[TYOV4]
      ,[TYOV5]
      ,[TYOV6]
      ,[TYOV7]
      ,[TYOV8]
      ,[TYOV9]
      ,[TYOV10]
      ,[TYOV11]
      ,[TYOV12]
      ,[TYOV13]
      ,[TYOV14]
      ,[TYOV15]
      ,[TYOV16]
      ,[TYOV17]
      ,[TYOV18]
      ,[TYOV19]
      ,[TYOV20]
      ,[TYOV21]
      ,[TYOV22]
      ,[TYOV23]
      ,[TYOV24]
      ,[TYOV25]
      ,[TKMENO1]
      ,[TKMENO2]
      ,[TKMENO3]
      ,[TKMENO4]
      ,[TKMENO5]
      ,[TKMENO6]
      ,[TKMENO7]
      ,[TKMENO8]
      ,[TKMENO9]
      ,[TKMENO10]
      ,[TKMENO11]
      ,[TKMENO12]
      ,[TKMENO13]
      ,[TKMENO14]
      ,[TKMENO15]
      ,[TKMENO16]
      ,[TKMENO17]
      ,[TKMENO18]
      ,[TKMENO19]
      ,[TKMENO20]
      ,[TKMENO21]
      ,[TKMENO22]
      ,[TKMENO23]
      ,[TKMENO24]
      ,[TKMENO25]
      ,[TA1] = Cast(tieteenalakoodisto + ''_'' + Nullif(Cast(TA1 as varchar(4)), ''0'') as varchar(10))
      ,[TA2] = Cast(tieteenalakoodisto + ''_'' + Nullif(Cast(TA2 as varchar(4)), ''0'') as varchar(10))
      ,[TA3] = Cast(tieteenalakoodisto + ''_'' + Nullif(Cast(TA3 as varchar(4)), ''0'') as varchar(10))
      ,[TA4] = Cast(tieteenalakoodisto + ''_'' + Nullif(Cast(TA4 as varchar(4)), ''0'') as varchar(10))
      ,[TA5] = Cast(tieteenalakoodisto + ''_'' + Nullif(Cast(TA5 as varchar(4)), ''0'') as varchar(10))
      ,[TA6] = Cast(tieteenalakoodisto + ''_'' + Nullif(Cast(TA6 as varchar(4)), ''0'') as varchar(10))
      ,[TA7] = Cast(tieteenalakoodisto + ''_'' + Nullif(Cast(TA7 as varchar(4)), ''0'') as varchar(10))
      ,[TA8] = Cast(tieteenalakoodisto + ''_'' + Nullif(Cast(TA8 as varchar(4)), ''0'') as varchar(10))
      ,[TA9] = Cast(tieteenalakoodisto + ''_'' + Nullif(Cast(TA9 as varchar(4)), ''0'') as varchar(10))
      ,[TA10] = Cast(tieteenalakoodisto + ''_'' + Nullif(Cast(TA10 as varchar(4)), ''0'') as varchar(10))
      ,[TA11] = Cast(tieteenalakoodisto + ''_'' + Nullif(Cast(TA11 as varchar(4)), ''0'') as varchar(10))
      ,[TA12] = Cast(tieteenalakoodisto + ''_'' + Nullif(Cast(TA12 as varchar(4)), ''0'') as varchar(10))
      ,[TA13] = Cast(tieteenalakoodisto + ''_'' + Nullif(Cast(TA13 as varchar(4)), ''0'') as varchar(10))
      ,[TA14] = Cast(tieteenalakoodisto + ''_'' + Nullif(Cast(TA14 as varchar(4)), ''0'') as varchar(10))
      ,[TA15] = Cast(tieteenalakoodisto + ''_'' + Nullif(Cast(TA15 as varchar(4)), ''0'') as varchar(10))
      ,[TA16] = Cast(tieteenalakoodisto + ''_'' + Nullif(Cast(TA16 as varchar(4)), ''0'') as varchar(10))
      ,[TA17] = Cast(tieteenalakoodisto + ''_'' + Nullif(Cast(TA17 as varchar(4)), ''0'') as varchar(10))
      ,[TA18] = Cast(tieteenalakoodisto + ''_'' + Nullif(Cast(TA18 as varchar(4)), ''0'') as varchar(10))
      ,[TA1P]
      ,[TA2P]
      ,[TA3P]
      ,[TA4P]
      ,[TA5P]
      ,[TA6P]
      ,[TA7P]
      ,[TA8P]
      ,[TA9P]
      ,[TA10P]
      ,[TA11P]
      ,[TA12P]
      ,[TA13P]
      ,[TA14P]
      ,[TA15P]
      ,[TA16P]
      ,[TA17P]
      ,[TA18P]
      ,[tk_arvio]
      ,[tk_arvioe]
      ,[KMENO]
      ,[HMENO]
      ,[TUTLKM]
      ,[NTUTLKM]
      ,[TUTTTV]
      ,[MTKLKM]
      ,[NMTKLKM]
      ,[MTKTTV]
      ,[YHTE2]
      ,[NYHTE2]
      ,[MKOULKM]
      ,[NMKOULKM]
      ,[MKOUTTV]
      ,[OPISTLKM]
      ,[NOPISTLKM]
      ,[OPISTTTV]
      ,[KUNNAT]
      ,[MKVJ]
      ,[ORAHAS]
      ,[phy1]
      ,[phy2]
      ,[phy3]
      ,[phy4]
      ,[phy5]
      ,[phy6]
      ,[phyy]
      ,[phn1]
      ,[phn2]
      ,[phn3]
      ,[phn4]
      ,[phn5]
      ,[phn6]
      ,[phny]
      ,[pty1]
      ,[pty2]
      ,[pty3]
      ,[pty4]
      ,[pty5]
      ,[pty6]
      ,[ptyy]
      ,[ptn1]
      ,[ptn2]
      ,[ptn3]
      ,[ptn4]
      ,[ptn5]
      ,[ptn6]
      ,[ptny]
      ,[tietolahde] = CAST(kaikkivuodet.tietolahde as nvarchar(50))
      ,[rivinumero] = CAST(kaikkivuodet.rivinumero as int)

FROM ( --kaikkivuodet

SELECT [tilv]
      ,[NIMI]
      ,[NIMI2]
      ,[TK_koodi]
      ,[TOLKM]
      ,[NTOLKM]
      ,[TOTTV]
      ,[LISLKM]
      ,[NLISLKM]
      ,[LISTTV]
      ,[DILKM]
      ,[NDIPLKM]
      ,[DIPTTV]
      ,[INSLKM]
      ,[NOPINS]
      ,[OPINSTTV]
      ,[YHTE]
      ,[NYHTE]
      ,[YHTTTV]
      ,[PAME]
      ,[OSTPAL]
      ,[YHME]
      ,[TEKES]
      ,[MTEM]
      ,[AKATEMIA]
      ,[GRAD]
      ,[MOPEM]
      ,[LIIKM]
      ,[MAAM]
      ,[OM]
      ,[PM]
      ,[SISAM]
      ,[SOSM]
      ,[UM]
      ,[VN]
      ,[VM]
      ,[YMP]
      ,[MUUJU]
      ,[RAHAS]
      ,[KOTIM]
      ,[ULKOY]
      ,[UEU]
	  ,[EUPUITE] = NULL
	  ,[EAKR] = NULL
	  ,[ESR] = NULL
	  ,[MUUEU] = NULL
      ,[MULKO]
      ,[UYHTE]
      ,[KUNTA1]
      ,[KUNTA2]
      ,[KUNTA3]
      ,[KUNTA4]
      ,[KUNTA5]
      ,[KUNTA6]
      ,[KUNTA7]
      ,[KUNTA8]
      ,[KUNTA9]
      ,[KUNTA10]
      ,[KUNTA11]
      ,[KUNTA12]
      ,[KUNTA13]
      ,[KUNTA14]
      ,[KUNTA15]
      ,[KUNTA16]
      ,[KUNTA17]
      ,[KUNTA18]
      ,[KUNTA19]
      ,[KUNTA20]
      ,[KUNTA21]
      ,[KUNTA22]
      ,[KUNTA23]
      ,[KUNTA24]
      ,[KUNTA25]
      ,[HENLKMY]
      ,[TYOVY]
      ,[TKMENOY]
      ,[HENLKM1]
      ,[HENLKM2]
      ,[HENLKM3]
      ,[HENLKM4]
      ,[HENLKM5]
      ,[HENLKM6]
      ,[HENLKM7]
      ,[HENLKM8]
      ,[HENLKM9]
      ,[HENLKM10]
      ,[HENLKM11]
      ,[HENLKM12]
      ,[HENLKM13]
      ,[HENLKM14]
      ,[HENLKM15]
      ,[HENLKM16]
      ,[HENLKM17]
      ,[HENLKM18]
      ,[HENLKM19]
      ,[HENLKM20]
      ,[HENLKM21]
      ,[HENLKM22]
      ,[HENLKM23]
      ,[HENLKM24]
      ,[HENLKM25]
      ,[TYOV1]
      ,[TYOV2]
      ,[TYOV3]
      ,[TYOV4]
      ,[TYOV5]
      ,[TYOV6]
      ,[TYOV7]
      ,[TYOV8]
      ,[TYOV9]
      ,[TYOV10]
      ,[TYOV11]
      ,[TYOV12]
      ,[TYOV13]
      ,[TYOV14]
      ,[TYOV15]
      ,[TYOV16]
      ,[TYOV17]
      ,[TYOV18]
      ,[TYOV19]
      ,[TYOV20]
      ,[TYOV21]
      ,[TYOV22]
      ,[TYOV23]
      ,[TYOV24]
      ,[TYOV25]
      ,[TKMENO1]
      ,[TKMENO2]
      ,[TKMENO3]
      ,[TKMENO4]
      ,[TKMENO5]
      ,[TKMENO6]
      ,[TKMENO7]
      ,[TKMENO8]
      ,[TKMENO9]
      ,[TKMENO10]
      ,[TKMENO11]
      ,[TKMENO12]
      ,[TKMENO13]
      ,[TKMENO14]
      ,[TKMENO15]
      ,[TKMENO16]
      ,[TKMENO17]
      ,[TKMENO18]
      ,[TKMENO19]
      ,[TKMENO20]
      ,[TKMENO21]
      ,[TKMENO22]
      ,[TKMENO23]
      ,[TKMENO24]
      ,[TKMENO25]
      ,[TA1]
      ,[TA2]
      ,[TA3]
      ,[TA4]
      ,[TA5]
      ,[TA6]
      ,[TA7]
      ,[TA8]
      ,[TA9]
      ,[TA10]
      ,[TA11]
      ,[TA12]
      ,[TA13]
      ,[TA14]
      ,[TA15]
      ,[TA16]
      ,[TA17]
      ,[TA18]
      ,[TA1P]
      ,[TA2P]
      ,[TA3P]
      ,[TA4P]
      ,[TA5P]
      ,[TA6P]
      ,[TA7P]
      ,[TA8P]
      ,[TA9P]
      ,[TA10P]
      ,[TA11P]
      ,[TA12P]
      ,[TA13P]
      ,[TA14P]
      ,[TA15P]
      ,[TA16P]
      ,[TA17P]
      ,[TA18P]
      ,[tk_arvio]
      ,[tk_arvioe]
      ,[KMENO]
      ,[HMENO]
      ,[TUTLKM]
      ,[NTUTLKM]
      ,[TUTTTV]
      ,[MTKLKM]
      ,[NMTKLKM]
      ,[MTKTTV]
      ,[YHTE2]
      ,[NYHTE2]
      ,[MKOULKM]
      ,[NMKOULKM]
      ,[MKOUTTV]
      ,[OPISTLKM]
      ,[NOPISTLKM]
      ,[OPISTTTV]
      ,[KUNNAT]
      ,[MKVJ]
      ,[ORAHAS]
      ,[phy1]
      ,[phy2]
      ,[phy3]
      ,[phy4]
      ,[phy5]
      ,[phy6]
      ,[phyy]
      ,[phn1]
      ,[phn2]
      ,[phn3]
      ,[phn4]
      ,[phn5]
      ,[phn6]
      ,[phny]
      ,[pty1]
      ,[pty2]
      ,[pty3]
      ,[pty4]
      ,[pty5]
      ,[pty6]
      ,[ptyy]
      ,[ptn1]
      ,[ptn2]
      ,[ptn3]
      ,[ptn4]
      ,[ptn5]
      ,[ptn6]
      ,[ptny]
      ,[luontipvm]
	  ,tieteenalakoodisto=''TA07''
      ,[tietolahde]=''TK_5_4_sopv_12_sekt''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY TK_Koodi)
FROM [TK_H9098_CSC].[dbo].[TK_5_4_sopv_12_sekt]

UNION ALL

SELECT [tilv]
      ,[NIMI]
      ,[NIMI2]
      ,[TK_koodi]
      ,[TOLKM]
      ,[NTOLKM]
      ,[TOTTV]
      ,[LISLKM]
      ,[NLISLKM]
      ,[LISTTV]
      ,[DILKM]
      ,[NDIPLKM]
      ,[DIPTTV]
      ,[INSLKM]
      ,[NOPINS]
      ,[OPINSTTV]
      ,[YHTE]
      ,[NYHTE]
      ,[YHTTTV]
      ,[PAME]
      ,[OSTPAL]
      ,[YHME]
      ,[TEKES]
      ,[MTEM]
      ,[AKATEMIA]
      ,[GRAD]
      ,[MOPEM]
      ,[LIIKM]
      ,[MAAM]
      ,[OM]
      ,[PM]
      ,[SISAM]
      ,[SOSM]
      ,[UM]
      ,[VN]
      ,[VM]
      ,[YMP]
      ,[MUUJU]
      ,[RAHAS]
      ,[KOTIM]
      ,[ULKOY]
      ,[UEU]
	  ,[EUPUITE]=0.0
	  ,[EAKR]=0.0
	  ,[ESR]=0.0
	  ,[MUUEU]=0.0
      ,[MULKO]
      ,[UYHTE]
      ,[KUNTA1]
      ,[KUNTA2]
      ,[KUNTA3]
      ,[KUNTA4]
      ,[KUNTA5]
      ,[KUNTA6]
      ,[KUNTA7]
      ,[KUNTA8]
      ,[KUNTA9]
      ,[KUNTA10]
      ,[KUNTA11]
      ,[KUNTA12]
      ,[KUNTA13]
      ,[KUNTA14]
      ,[KUNTA15]
      ,[KUNTA16]
      ,[KUNTA17]
      ,[KUNTA18]
      ,[KUNTA19]
      ,[KUNTA20]
      ,[KUNTA21]
      ,[KUNTA22]
      ,[KUNTA23]
      ,[KUNTA24]
      ,[KUNTA25]
      ,[HENLKMY]
      ,[TYOVY]
      ,[TKMENOY]
      ,[HENLKM1]
      ,[HENLKM2]
      ,[HENLKM3]
      ,[HENLKM4]
      ,[HENLKM5]
      ,[HENLKM6]
      ,[HENLKM7]
      ,[HENLKM8]
      ,[HENLKM9]
      ,[HENLKM10]
      ,[HENLKM11]
      ,[HENLKM12]
      ,[HENLKM13]
      ,[HENLKM14]
      ,[HENLKM15]
      ,[HENLKM16]
      ,[HENLKM17]
      ,[HENLKM18]
      ,[HENLKM19]
      ,[HENLKM20]
      ,[HENLKM21]
      ,[HENLKM22]
      ,[HENLKM23]
      ,[HENLKM24]
      ,[HENLKM25]
      ,[TYOV1]
      ,[TYOV2]
      ,[TYOV3]
      ,[TYOV4]
      ,[TYOV5]
      ,[TYOV6]
      ,[TYOV7]
      ,[TYOV8]
      ,[TYOV9]
      ,[TYOV10]
      ,[TYOV11]
      ,[TYOV12]
      ,[TYOV13]
      ,[TYOV14]
      ,[TYOV15]
      ,[TYOV16]
      ,[TYOV17]
      ,[TYOV18]
      ,[TYOV19]
      ,[TYOV20]
      ,[TYOV21]
      ,[TYOV22]
      ,[TYOV23]
      ,[TYOV24]
      ,[TYOV25]
      ,[TKMENO1]
      ,[TKMENO2]
      ,[TKMENO3]
      ,[TKMENO4]
      ,[TKMENO5]
      ,[TKMENO6]
      ,[TKMENO7]
      ,[TKMENO8]
      ,[TKMENO9]
      ,[TKMENO10]
      ,[TKMENO11]
      ,[TKMENO12]
      ,[TKMENO13]
      ,[TKMENO14]
      ,[TKMENO15]
      ,[TKMENO16]
      ,[TKMENO17]
      ,[TKMENO18]
      ,[TKMENO19]
      ,[TKMENO20]
      ,[TKMENO21]
      ,[TKMENO22]
      ,[TKMENO23]
      ,[TKMENO24]
      ,[TKMENO25]
      ,[TA1]
      ,[TA2]
      ,[TA3]
      ,[TA4]
      ,[TA5]
      ,[TA6]
      ,[TA7]
      ,[TA8]
      ,[TA9]
      ,[TA10]
      ,[TA11]
      ,[TA12]
      ,[TA13]
      ,[TA14]
      ,[TA15]
      ,[TA16]
      ,[TA17]
      ,[TA18]
      ,[TA1P]
      ,[TA2P]
      ,[TA3P]
      ,[TA4P]
      ,[TA5P]
      ,[TA6P]
      ,[TA7P]
      ,[TA8P]
      ,[TA9P]
      ,[TA10P]
      ,[TA11P]
      ,[TA12P]
      ,[TA13P]
      ,[TA14P]
      ,[TA15P]
      ,[TA16P]
      ,[TA17P]
      ,[TA18P]
      ,[tk_arvio]
      ,[tk_arvioe]
      ,[KMENO]
      ,[HMENO]
      ,[TUTLKM]
      ,[NTUTLKM]
      ,[TUTTTV]
      ,[MTKLKM]
      ,[NMTKLKM]
      ,[MTKTTV]
      ,[YHTE2]
      ,[NYHTE2]
      ,[MKOULKM]
      ,[NMKOULKM]
      ,[MKOUTTV]
      ,[OPISTLKM]
      ,[NOPISTLKM]
      ,[OPISTTTV]
      ,[KUNNAT]
      ,[MKVJ]
      ,[ORAHAS]
      ,[phy1]
      ,[phy2]
      ,[phy3]
      ,[phy4]
      ,[phy5]
      ,[phy6]
      ,[phyy]
      ,[phn1]
      ,[phn2]
      ,[phn3]
      ,[phn4]
      ,[phn5]
      ,[phn6]
      ,[phny]
      ,[pty1]
      ,[pty2]
      ,[pty3]
      ,[pty4]
      ,[pty5]
      ,[pty6]
      ,[ptyy]
      ,[ptn1]
      ,[ptn2]
      ,[ptn3]
      ,[ptn4]
      ,[ptn5]
      ,[ptn6]
      ,[ptny]
      ,[luontipvm]
	  ,tieteenalakoodisto=''TA10''
      ,[tietolahde]=''TK_5_4_sopv_13_sekt''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY TK_Koodi)
FROM [TK_H9098_CSC].[dbo].[TK_5_4_sopv_13_sekt]

UNION ALL

SELECT [tilv]
      ,[NIMI]
      ,[NIMI2]
      ,[TK_koodi]
      ,[TOLKM]
      ,[NTOLKM]
      ,[TOTTV]
      ,[LISLKM]
      ,[NLISLKM]
      ,[LISTTV]
      ,[DILKM]
      ,[NDIPLKM]
      ,[DIPTTV]
      ,[INSLKM]
      ,[NOPINS]
      ,[OPINSTTV]
      ,[YHTE]
      ,[NYHTE]
      ,[YHTTTV]
      ,[PAME]
      ,[OSTPAL]
      ,[YHME]
      ,[TEKES]
      ,[MTEM]
      ,[AKATEMIA]
      ,[GRAD]
      ,[MOPEM]
      ,[LIIKM]
      ,[MAAM]
      ,[OM]
      ,[PM]
      ,[SISAM]
      ,[SOSM]
      ,[UM]
      ,[VN]
      ,[VM]
      ,[YMP]
      ,[MUUJU]
      ,[RAHAS]
      ,[KOTIM]
      ,[ULKOY]
      ,[UEU]
	  ,[EUPUITE]=0.0
	  ,[EAKR]=0.0
	  ,[ESR]=0.0
	  ,[MUUEU]=0.0
      ,[MULKO]
      ,[UYHTE]
      ,[KUNTA1]
      ,[KUNTA2]
      ,[KUNTA3]
      ,[KUNTA4]
      ,[KUNTA5]
      ,[KUNTA6]
      ,[KUNTA7]
      ,[KUNTA8]
      ,[KUNTA9]
      ,[KUNTA10]
      ,[KUNTA11]
      ,[KUNTA12]
      ,[KUNTA13]
      ,[KUNTA14]
      ,[KUNTA15]
      ,[KUNTA16]
      ,[KUNTA17]
      ,[KUNTA18]
      ,[KUNTA19]
      ,[KUNTA20]
      ,[KUNTA21]
      ,[KUNTA22]
      ,[KUNTA23]
      ,[KUNTA24]
      ,[KUNTA25]
      ,[HENLKMY]
      ,[TYOVY]
      ,[TKMENOY]
      ,[HENLKM1]
      ,[HENLKM2]
      ,[HENLKM3]
      ,[HENLKM4]
      ,[HENLKM5]
      ,[HENLKM6]
      ,[HENLKM7]
      ,[HENLKM8]
      ,[HENLKM9]
      ,[HENLKM10]
      ,[HENLKM11]
      ,[HENLKM12]
      ,[HENLKM13]
      ,[HENLKM14]
      ,[HENLKM15]
      ,[HENLKM16]
      ,[HENLKM17]
      ,[HENLKM18]
      ,[HENLKM19]
      ,[HENLKM20]
      ,[HENLKM21]
      ,[HENLKM22]
      ,[HENLKM23]
      ,[HENLKM24]
      ,[HENLKM25]
      ,[TYOV1]
      ,[TYOV2]
      ,[TYOV3]
      ,[TYOV4]
      ,[TYOV5]
      ,[TYOV6]
      ,[TYOV7]
      ,[TYOV8]
      ,[TYOV9]
      ,[TYOV10]
      ,[TYOV11]
      ,[TYOV12]
      ,[TYOV13]
      ,[TYOV14]
      ,[TYOV15]
      ,[TYOV16]
      ,[TYOV17]
      ,[TYOV18]
      ,[TYOV19]
      ,[TYOV20]
      ,[TYOV21]
      ,[TYOV22]
      ,[TYOV23]
      ,[TYOV24]
      ,[TYOV25]
      ,[TKMENO1]
      ,[TKMENO2]
      ,[TKMENO3]
      ,[TKMENO4]
      ,[TKMENO5]
      ,[TKMENO6]
      ,[TKMENO7]
      ,[TKMENO8]
      ,[TKMENO9]
      ,[TKMENO10]
      ,[TKMENO11]
      ,[TKMENO12]
      ,[TKMENO13]
      ,[TKMENO14]
      ,[TKMENO15]
      ,[TKMENO16]
      ,[TKMENO17]
      ,[TKMENO18]
      ,[TKMENO19]
      ,[TKMENO20]
      ,[TKMENO21]
      ,[TKMENO22]
      ,[TKMENO23]
      ,[TKMENO24]
      ,[TKMENO25]
      ,[TA1]
      ,[TA2]
      ,[TA3]
      ,[TA4]
      ,[TA5]
      ,[TA6]
      ,[TA7]
      ,[TA8]
      ,[TA9]
      ,[TA10]
      ,[TA11]
      ,[TA12]
      ,[TA13]
      ,[TA14]
      ,[TA15]
      ,[TA16]
      ,[TA17]
      ,[TA18]
      ,[TA1P]
      ,[TA2P]
      ,[TA3P]
      ,[TA4P]
      ,[TA5P]
      ,[TA6P]
      ,[TA7P]
      ,[TA8P]
      ,[TA9P]
      ,[TA10P]
      ,[TA11P]
      ,[TA12P]
      ,[TA13P]
      ,[TA14P]
      ,[TA15P]
      ,[TA16P]
      ,[TA17P]
      ,[TA18P]
      ,[tk_arvio]
      ,[tk_arvioe]
      ,[KMENO]
      ,[HMENO]
      ,[TUTLKM]
      ,[NTUTLKM]
      ,[TUTTTV]
      ,[MTKLKM]
      ,[NMTKLKM]
      ,[MTKTTV]
      ,[YHTE2]
      ,[NYHTE2]
      ,[MKOULKM]
      ,[NMKOULKM]
      ,[MKOUTTV]
      ,[OPISTLKM]
      ,[NOPISTLKM]
      ,[OPISTTTV]
      ,[KUNNAT]
      ,[MKVJ]
      ,[ORAHAS]
      ,[phy1]
      ,[phy2]
      ,[phy3]
      ,[phy4]
      ,[phy5]
      ,[phy6]
      ,[phyy]
      ,[phn1]
      ,[phn2]
      ,[phn3]
      ,[phn4]
      ,[phn5]
      ,[phn6]
      ,[phny]
      ,[pty1]
      ,[pty2]
      ,[pty3]
      ,[pty4]
      ,[pty5]
      ,[pty6]
      ,[ptyy]
      ,[ptn1]
      ,[ptn2]
      ,[ptn3]
      ,[ptn4]
      ,[ptn5]
      ,[ptn6]
      ,[ptny]
      ,[luontipvm]
	  ,tieteenalakoodisto=''TA10''
      ,[tietolahde]=''TK_5_4_sopv_14_sekt''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY TK_Koodi)
FROM [TK_H9098_CSC].[dbo].[TK_5_4_sopv_14_sekt]

UNION ALL

SELECT [tilv]
      ,[NIMI]
      ,[NIMI2]
      ,[TK_koodi]
      ,[TOLKM]
      ,[NTOLKM]
      ,[TOTTV]
      ,[LISLKM]
      ,[NLISLKM]
      ,[LISTTV]
      ,[DILKM]
      ,[NDIPLKM]
      ,[DIPTTV]
      ,[INSLKM]
      ,[NOPINS]
      ,[OPINSTTV]
      ,[YHTE]
      ,[NYHTE]
      ,[YHTTTV]
      ,[PAME]
      ,[OSTPAL]
      ,[YHME]
      ,[TEKES]
      ,[MTEM]
      ,[AKATEMIA]
      ,[GRAD]
      ,[MOPEM]
      ,[LIIKM]
      ,[MAAM]
      ,[OM]
      ,[PM]
      ,[SISAM]
      ,[SOSM]
      ,[UM]
      ,[VN]
      ,[VM]
      ,[YMP]
      ,[MUUJU]
      ,[RAHAS]
      ,[KOTIM]
      ,[ULKOY]
      ,[UEU]
	  ,[EUPUITE] = NULL
	  ,[EAKR] = NULL
	  ,[ESR] = NULL
	  ,[MUUEU] = NULL
      ,[MULKO]
      ,[UYHTE]
      ,[KUNTA1]
      ,[KUNTA2]
      ,[KUNTA3]
      ,[KUNTA4]
      ,[KUNTA5]
      ,[KUNTA6]
      ,[KUNTA7]
      ,[KUNTA8]
      ,[KUNTA9]
      ,[KUNTA10]
      ,[KUNTA11]
      ,[KUNTA12]
      ,[KUNTA13]
      ,[KUNTA14]
      ,[KUNTA15]
      ,[KUNTA16]
      ,[KUNTA17]
      ,[KUNTA18]
      ,[KUNTA19]
      ,[KUNTA20]
      ,[KUNTA21]
      ,[KUNTA22]
      ,[KUNTA23]
      ,[KUNTA24]
      ,[KUNTA25]
      ,[HENLKMY]
      ,[TYOVY]
      ,[TKMENOY]
      ,[HENLKM1]
      ,[HENLKM2]
      ,[HENLKM3]
      ,[HENLKM4]
      ,[HENLKM5]
      ,[HENLKM6]
      ,[HENLKM7]
      ,[HENLKM8]
      ,[HENLKM9]
      ,[HENLKM10]
      ,[HENLKM11]
      ,[HENLKM12]
      ,[HENLKM13]
      ,[HENLKM14]
      ,[HENLKM15]
      ,[HENLKM16]
      ,[HENLKM17]
      ,[HENLKM18]
      ,[HENLKM19]
      ,[HENLKM20]
      ,[HENLKM21]
      ,[HENLKM22]
      ,[HENLKM23]
      ,[HENLKM24]
      ,[HENLKM25]
      ,[TYOV1]
      ,[TYOV2]
      ,[TYOV3]
      ,[TYOV4]
      ,[TYOV5]
      ,[TYOV6]
      ,[TYOV7]
      ,[TYOV8]
      ,[TYOV9]
      ,[TYOV10]
      ,[TYOV11]
      ,[TYOV12]
      ,[TYOV13]
      ,[TYOV14]
      ,[TYOV15]
      ,[TYOV16]
      ,[TYOV17]
      ,[TYOV18]
      ,[TYOV19]
      ,[TYOV20]
      ,[TYOV21]
      ,[TYOV22]
      ,[TYOV23]
      ,[TYOV24]
      ,[TYOV25]
      ,[TKMENO1]
      ,[TKMENO2]
      ,[TKMENO3]
      ,[TKMENO4]
      ,[TKMENO5]
      ,[TKMENO6]
      ,[TKMENO7]
      ,[TKMENO8]
      ,[TKMENO9]
      ,[TKMENO10]
      ,[TKMENO11]
      ,[TKMENO12]
      ,[TKMENO13]
      ,[TKMENO14]
      ,[TKMENO15]
      ,[TKMENO16]
      ,[TKMENO17]
      ,[TKMENO18]
      ,[TKMENO19]
      ,[TKMENO20]
      ,[TKMENO21]
      ,[TKMENO22]
      ,[TKMENO23]
      ,[TKMENO24]
      ,[TKMENO25]
      ,[TA1]
      ,[TA2]
      ,[TA3]
      ,[TA4]
      ,[TA5]
      ,[TA6]
      ,[TA7]
      ,[TA8]
      ,[TA9]
      ,[TA10]
      ,[TA11]
      ,[TA12]
      ,[TA13]
      ,[TA14]
      ,[TA15]
      ,[TA16]
      ,[TA17]
      ,[TA18]
      ,[TA1P]
      ,[TA2P]
      ,[TA3P]
      ,[TA4P]
      ,[TA5P]
      ,[TA6P]
      ,[TA7P]
      ,[TA8P]
      ,[TA9P]
      ,[TA10P]
      ,[TA11P]
      ,[TA12P]
      ,[TA13P]
      ,[TA14P]
      ,[TA15P]
      ,[TA16P]
      ,[TA17P]
      ,[TA18P]
      ,[tk_arvio]
      ,[tk_arvioe]
      ,[KMENO]
      ,[HMENO]
      ,[TUTLKM]
      ,[NTUTLKM]
      ,[TUTTTV]
      ,[MTKLKM]
      ,[NMTKLKM]
      ,[MTKTTV]
      ,[YHTE2]
      ,[NYHTE2]
      ,[MKOULKM]
      ,[NMKOULKM]
      ,[MKOUTTV]
      ,[OPISTLKM]
      ,[NOPISTLKM]
      ,[OPISTTTV]
      ,[KUNNAT]
      ,[MKVJ]
      ,[ORAHAS]
      ,[phy1]
      ,[phy2]
      ,[phy3]
      ,[phy4]
      ,[phy5]
      ,[phy6]
      ,[phyy]
      ,[phn1]
      ,[phn2]
      ,[phn3]
      ,[phn4]
      ,[phn5]
      ,[phn6]
      ,[phny]
      ,[pty1]
      ,[pty2]
      ,[pty3]
      ,[pty4]
      ,[pty5]
      ,[pty6]
      ,[ptyy]
      ,[ptn1]
      ,[ptn2]
      ,[ptn3]
      ,[ptn4]
      ,[ptn5]
      ,[ptn6]
      ,[ptny]
      ,[luontipvm]
	  ,tieteenalakoodisto=''TA10''
      ,[tietolahde]=''TK_5_4_sopv_15_sekt''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY TK_Koodi)
  FROM [TK_H9098_CSC].[dbo].[TK_5_4_sopv_15_sekt]

UNION ALL

SELECT [tilv]
      ,[NIMI]
      ,[NIMI2]
      ,[TK_koodi]
      ,[TOLKM]
      ,[NTOLKM]
      ,[TOTTV]
      ,[LISLKM]
      ,[NLISLKM]
      ,[LISTTV]
      ,[DILKM]
      ,[NDIPLKM]
      ,[DIPTTV]
      ,[INSLKM]
      ,[NOPINS]
      ,[OPINSTTV]
      ,[YHTE]
      ,[NYHTE]
      ,[YHTTTV]
      ,[PAME]
      ,[OSTPAL]
      ,[YHME]
      ,[TEKES]
      ,[MTEM]
      ,[AKATEMIA]
      ,NULL AS [GRAD]
      ,[MOPEM]
      ,[LIIKM]
      ,[MAAM]
      ,[OM]
      ,[PM]
      ,[SISAM]
      ,[SOSM]
      ,[UM]
      ,[VN]
      ,[VM]
      ,[YMP]
      ,[MUUJU]
      ,[RAHAS]
      ,[KOTIM]
      ,[ULKOY]
      ,[UEU]
	  ,[EUPUITE] = NULL
	  ,[EAKR] = NULL
	  ,[ESR] = NULL
	  ,[MUUEU] = NULL
      ,[MULKO]
      ,[UYHTE]
      ,[KUNTA1]
      ,[KUNTA2]
      ,[KUNTA3]
      ,[KUNTA4]
      ,[KUNTA5]
      ,[KUNTA6]
      ,[KUNTA7]
      ,[KUNTA8]
      ,[KUNTA9]
      ,[KUNTA10]
      ,[KUNTA11]
      ,[KUNTA12]
      ,[KUNTA13]
      ,[KUNTA14]
      ,[KUNTA15]
      ,[KUNTA16]
      ,[KUNTA17]
      ,[KUNTA18]
      ,[KUNTA19]
      ,[KUNTA20]
      ,[KUNTA21]
      ,[KUNTA22]
      ,[KUNTA23]
      ,[KUNTA24]
      ,[KUNTA25]
      ,[HENLKMY]
      ,[TYOVY]
      ,[TKMENOY]
      ,[HENLKM1]
      ,[HENLKM2]
      ,[HENLKM3]
      ,[HENLKM4]
      ,[HENLKM5]
      ,[HENLKM6]
      ,[HENLKM7]
      ,[HENLKM8]
      ,[HENLKM9]
      ,[HENLKM10]
      ,[HENLKM11]
      ,[HENLKM12]
      ,[HENLKM13]
      ,[HENLKM14]
      ,[HENLKM15]
      ,[HENLKM16]
      ,[HENLKM17]
      ,[HENLKM18]
      ,[HENLKM19]
      ,[HENLKM20]
      ,[HENLKM21]
      ,[HENLKM22]
      ,[HENLKM23]
      ,[HENLKM24]
      ,[HENLKM25]
      ,[TYOV1]
      ,[TYOV2]
      ,[TYOV3]
      ,[TYOV4]
      ,[TYOV5]
      ,[TYOV6]
      ,[TYOV7]
      ,[TYOV8]
      ,[TYOV9]
      ,[TYOV10]
      ,[TYOV11]
      ,[TYOV12]
      ,[TYOV13]
      ,[TYOV14]
      ,[TYOV15]
      ,[TYOV16]
      ,[TYOV17]
      ,[TYOV18]
      ,[TYOV19]
      ,[TYOV20]
      ,[TYOV21]
      ,[TYOV22]
      ,[TYOV23]
      ,[TYOV24]
      ,[TYOV25]
      ,[TKMENO1]
      ,[TKMENO2]
      ,[TKMENO3]
      ,[TKMENO4]
      ,[TKMENO5]
      ,[TKMENO6]
      ,[TKMENO7]
      ,[TKMENO8]
      ,[TKMENO9]
      ,[TKMENO10]
      ,[TKMENO11]
      ,[TKMENO12]
      ,[TKMENO13]
      ,[TKMENO14]
      ,[TKMENO15]
      ,[TKMENO16]
      ,[TKMENO17]
      ,[TKMENO18]
      ,[TKMENO19]
      ,[TKMENO20]
      ,[TKMENO21]
      ,[TKMENO22]
      ,[TKMENO23]
      ,[TKMENO24]
      ,[TKMENO25]
      ,[TA1]
      ,[TA2]
      ,[TA3]
      ,[TA4]
      ,[TA5]
      ,[TA6]
      ,[TA7]
      ,[TA8]
      ,[TA9]
      ,[TA10]
      ,[TA11]
      ,[TA12]
      ,[TA13]
      ,[TA14]
      ,[TA15]
      ,[TA16]
      ,[TA17]
      ,[TA18]
      ,[TA1P]
      ,[TA2P]
      ,[TA3P]
      ,[TA4P]
      ,[TA5P]
      ,[TA6P]
      ,[TA7P]
      ,[TA8P]
      ,[TA9P]
      ,[TA10P]
      ,[TA11P]
      ,[TA12P]
      ,[TA13P]
      ,[TA14P]
      ,[TA15P]
      ,[TA16P]
      ,[TA17P]
      ,[TA18P]
      ,[tk_arvio]
      ,[tk_arvioe]
      ,[KMENO]
      ,[HMENO]
      ,[TUTLKM]
      ,[NTUTLKM]
      ,[TUTTTV]
      ,[MTKLKM]
      ,NULL AS [NMTKLKM]
      ,NULL AS [MTKTTV]
      ,NULL AS [YHTE2]
      ,NULL AS [NYHTE2]
      ,[MKOULKM]
      ,[NMKOULKM]
      ,[MKOUTTV]
      ,NULL AS [OPISTLKM]
      ,NULL AS [NOPISTLKM]
      ,NULL AS [OPISTTTV]
      ,[KUNNAT]
      ,[MKVJ]
      ,[ORAHAS]
      ,[phy1]
      ,[phy2]
      ,[phy3]
      ,[phy4]
      ,[phy5]
      ,[phy6]
      ,[phyy]
      ,[phn1]
      ,[phn2]
      ,[phn3]
      ,[phn4]
      ,[phn5]
      ,[phn6]
      ,[phny]
      ,[pty1]
      ,[pty2]
      ,[pty3]
      ,[pty4]
      ,[pty5]
      ,[pty6]
      ,[ptyy]
      ,[ptn1]
      ,[ptn2]
      ,[ptn3]
      ,[ptn4]
      ,[ptn5]
      ,[ptn6]
      ,[ptny]
      ,[luontipvm]
	  ,tieteenalakoodisto=''TA10''
      ,[tietolahde]=''TK_5_4_sopv_16_sekt''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY TK_Koodi)
  FROM [TK_H9098_CSC].[dbo].[TK_5_4_sopv_16_sekt]
) kaikkivuodet








' 
GO
/****** Object:  View [dbo].[v_sa_5_4_Yosairaaloiden_tutkimus_ja_kehitys]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_5_4_Yosairaaloiden_tutkimus_ja_kehitys]'))
EXEC dbo.sp_executesql @statement = N'












CREATE VIEW [dbo].[v_sa_5_4_Yosairaaloiden_tutkimus_ja_kehitys] AS
/*
Aineisto muuttui K-aineistoksi 2016. K-koodia ei lisätty näkymän nimeen. /18.1.2016 CSC Jarmo
K poistettu /16.2.2016 CSC Jarmo

Drop table [VipunenTK_DW].[dbo].[sa_5_4_Yosairaaloiden_tutkimus_ja_kehitys]
Select * into [VipunenTK_DW].[dbo].[sa_5_4_Yosairaaloiden_tutkimus_ja_kehitys] FROM VipunenTK_SA.[dbo].[v_sa_5_4_Yosairaaloiden_tutkimus_ja_kehitys]

Truncate table [VipunenTK_DW].[dbo].[sa_5_4_Yosairaaloiden_tutkimus_ja_kehitys]
Insert into [VipunenTK_DW].[dbo].[sa_5_4_Yosairaaloiden_tutkimus_ja_kehitys]
  Select * FROM VipunenTK_SA.[dbo].[v_sa_5_4_Yosairaaloiden_tutkimus_ja_kehitys]
*/

SELECT [tilv] = CAST(kaikkivuodet.tilv as nvarchar(4))
	  ,[tilv_date] = Cast(kaikkivuodet.tilv+''0101'' as date)
      ,[NIMI]
      ,[NIMI2]
      ,[TK_koodi] = Cast(Right(''00000'' + kaikkivuodet.TK_koodi, 5) as varchar(5))
      ,[TOLKM]
      ,[NTOLKM]
      ,[TOTTV]
      ,[LISLKM]
      ,[NLISLKM]
      ,[LISTTV]
      ,[DILKM]
      ,[NDIPLKM]
      ,[DIPTTV]
      ,[INSLKM]
      ,[NOPINS]
      ,[OPINSTTV]
      ,[YHTE]
      ,[NYHTE]
      ,[YHTTTV]
      ,[PAME]
      ,[OSTPAL]
      ,[YHME]
      ,[TEKES]
      ,[MTEM]
      ,[AKATEMIA]
      ,[GRAD]
      ,[MOPEM]
      ,[LIIKM]
      ,[MAAM]
      ,[OM]
      ,[PM]
      ,[SISAM]
      ,[SOSM]
      ,[UM]
      ,[VN]
      ,[VM]
      ,[YMP]
      ,[MUUJU]
      ,[RAHAS]
      ,[KOTIM]
      ,[ULKOY]
      ,[UEU]
	  ,[EUPUITE]
	  ,[EAKR]
	  ,[ESR]
	  ,[MUUEU]
      ,[MULKO]
      ,[UYHTE]
      ,[KUNTA1] = Cast(Nullif(Right(''000''+Cast(KUNTA1 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA2] = Cast(Nullif(Right(''000''+Cast(KUNTA2 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA3] = Cast(Nullif(Right(''000''+Cast(KUNTA3 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA4] = Cast(Nullif(Right(''000''+Cast(KUNTA4 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA5] = Cast(Nullif(Right(''000''+Cast(KUNTA5 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA6] = Cast(Nullif(Right(''000''+Cast(KUNTA6 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA7] = Cast(Nullif(Right(''000''+Cast(KUNTA7 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA8] = Cast(Nullif(Right(''000''+Cast(KUNTA8 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA9] = Cast(Nullif(Right(''000''+Cast(KUNTA9 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA10] = Cast(Nullif(Right(''000''+Cast(KUNTA10 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA11] = Cast(Nullif(Right(''000''+Cast(KUNTA11 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA12] = Cast(Nullif(Right(''000''+Cast(KUNTA12 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA13] = Cast(Nullif(Right(''000''+Cast(KUNTA13 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA14] = Cast(Nullif(Right(''000''+Cast(KUNTA14 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA15] = Cast(Nullif(Right(''000''+Cast(KUNTA15 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA16] = Cast(Nullif(Right(''000''+Cast(KUNTA16 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA17] = Cast(Nullif(Right(''000''+Cast(KUNTA17 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA18] = Cast(Nullif(Right(''000''+Cast(KUNTA18 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA19] = Cast(Nullif(Right(''000''+Cast(KUNTA19 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA20] = Cast(Nullif(Right(''000''+Cast(KUNTA20 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA21] = Cast(Nullif(Right(''000''+Cast(KUNTA21 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA22] = Cast(Nullif(Right(''000''+Cast(KUNTA22 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA23] = Cast(Nullif(Right(''000''+Cast(KUNTA23 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA24] = Cast(Nullif(Right(''000''+Cast(KUNTA24 as varchar(3)),3),''000'') as varchar(3))
      ,[KUNTA25] = Cast(Nullif(Right(''000''+Cast(KUNTA25 as varchar(3)),3),''000'') as varchar(3))
      ,[HENLKMY]
      ,[TYOVY]
      ,[TKMENOY]
      ,[HENLKM1]
      ,[HENLKM2]
      ,[HENLKM3]
      ,[HENLKM4]
      ,[HENLKM5]
      ,[HENLKM6]
      ,[HENLKM7]
      ,[HENLKM8]
      ,[HENLKM9]
      ,[HENLKM10]
      ,[HENLKM11]
      ,[HENLKM12]
      ,[HENLKM13]
      ,[HENLKM14]
      ,[HENLKM15]
      ,[HENLKM16]
      ,[HENLKM17]
      ,[HENLKM18]
      ,[HENLKM19]
      ,[HENLKM20]
      ,[HENLKM21]
      ,[HENLKM22]
      ,[HENLKM23]
      ,[HENLKM24]
      ,[HENLKM25]
      ,[TYOV1]
      ,[TYOV2]
      ,[TYOV3]
      ,[TYOV4]
      ,[TYOV5]
      ,[TYOV6]
      ,[TYOV7]
      ,[TYOV8]
      ,[TYOV9]
      ,[TYOV10]
      ,[TYOV11]
      ,[TYOV12]
      ,[TYOV13]
      ,[TYOV14]
      ,[TYOV15]
      ,[TYOV16]
      ,[TYOV17]
      ,[TYOV18]
      ,[TYOV19]
      ,[TYOV20]
      ,[TYOV21]
      ,[TYOV22]
      ,[TYOV23]
      ,[TYOV24]
      ,[TYOV25]
      ,[TKMENO1]
      ,[TKMENO2]
      ,[TKMENO3]
      ,[TKMENO4]
      ,[TKMENO5]
      ,[TKMENO6]
      ,[TKMENO7]
      ,[TKMENO8]
      ,[TKMENO9]
      ,[TKMENO10]
      ,[TKMENO11]
      ,[TKMENO12]
      ,[TKMENO13]
      ,[TKMENO14]
      ,[TKMENO15]
      ,[TKMENO16]
      ,[TKMENO17]
      ,[TKMENO18]
      ,[TKMENO19]
      ,[TKMENO20]
      ,[TKMENO21]
      ,[TKMENO22]
      ,[TKMENO23]
      ,[TKMENO24]
      ,[TKMENO25]
      ,[TA1] = Cast(tieteenalakoodisto + ''_'' + Nullif(Cast(TA1 as varchar(4)), ''0'') as varchar(10))
      ,[TA2] = Cast(tieteenalakoodisto + ''_'' + Nullif(Cast(TA2 as varchar(4)), ''0'') as varchar(10))
      ,[TA3] = Cast(tieteenalakoodisto + ''_'' + Nullif(Cast(TA3 as varchar(4)), ''0'') as varchar(10))
      ,[TA4] = Cast(tieteenalakoodisto + ''_'' + Nullif(Cast(TA4 as varchar(4)), ''0'') as varchar(10))
      ,[TA5] = Cast(tieteenalakoodisto + ''_'' + Nullif(Cast(TA5 as varchar(4)), ''0'') as varchar(10))
      ,[TA6] = Cast(tieteenalakoodisto + ''_'' + Nullif(Cast(TA6 as varchar(4)), ''0'') as varchar(10))
      ,[TA7] = Cast(tieteenalakoodisto + ''_'' + Nullif(Cast(TA7 as varchar(4)), ''0'') as varchar(10))
      ,[TA8] = Cast(tieteenalakoodisto + ''_'' + Nullif(Cast(TA8 as varchar(4)), ''0'') as varchar(10))
      ,[TA9] = Cast(tieteenalakoodisto + ''_'' + Nullif(Cast(TA9 as varchar(4)), ''0'') as varchar(10))
      ,[TA10] = Cast(tieteenalakoodisto + ''_'' + Nullif(Cast(TA10 as varchar(4)), ''0'') as varchar(10))
      ,[TA11] = Cast(tieteenalakoodisto + ''_'' + Nullif(Cast(TA11 as varchar(4)), ''0'') as varchar(10))
      ,[TA12] = Cast(tieteenalakoodisto + ''_'' + Nullif(Cast(TA12 as varchar(4)), ''0'') as varchar(10))
      ,[TA13] = Cast(tieteenalakoodisto + ''_'' + Nullif(Cast(TA13 as varchar(4)), ''0'') as varchar(10))
      ,[TA14] = Cast(tieteenalakoodisto + ''_'' + Nullif(Cast(TA14 as varchar(4)), ''0'') as varchar(10))
      ,[TA15] = Cast(tieteenalakoodisto + ''_'' + Nullif(Cast(TA15 as varchar(4)), ''0'') as varchar(10))
      ,[TA16] = Cast(tieteenalakoodisto + ''_'' + Nullif(Cast(TA16 as varchar(4)), ''0'') as varchar(10))
      ,[TA17] = Cast(tieteenalakoodisto + ''_'' + Nullif(Cast(TA17 as varchar(4)), ''0'') as varchar(10))
      ,[TA18] = Cast(tieteenalakoodisto + ''_'' + Nullif(Cast(TA18 as varchar(4)), ''0'') as varchar(10))
      ,[TA1P]
      ,[TA2P]
      ,[TA3P]
      ,[TA4P]
      ,[TA5P]
      ,[TA6P]
      ,[TA7P]
      ,[TA8P]
      ,[TA9P]
      ,[TA10P]
      ,[TA11P]
      ,[TA12P]
      ,[TA13P]
      ,[TA14P]
      ,[TA15P]
      ,[TA16P]
      ,[TA17P]
      ,[TA18P]
      ,[tk_arvio]
      ,[tk_arvioe]
      ,[KMENO]
      ,[HMENO]
      ,[TUTLKM]
      ,[NTUTLKM]
      ,[TUTTTV]
      ,[MTKLKM]
      ,[NMTKLKM]
      ,[MTKTTV]
      ,[YHTE2]
      ,[NYHTE2]
      ,[MKOULKM]
      ,[NMKOULKM]
      ,[MKOUTTV]
      ,[OPISTLKM]
      ,[NOPISTLKM]
      ,[OPISTTTV]
      ,[KUNNAT]
      ,[MKVJ]
      ,[ORAHAS]
      ,[phy1]
      ,[phy2]
      ,[phy3]
      ,[phy4]
      ,[phy5]
      ,[phy6]
      ,[phyy]
      ,[phn1]
      ,[phn2]
      ,[phn3]
      ,[phn4]
      ,[phn5]
      ,[phn6]
      ,[phny]
      ,[pty1]
      ,[pty2]
      ,[pty3]
      ,[pty4]
      ,[pty5]
      ,[pty6]
      ,[ptyy]
      ,[ptn1]
      ,[ptn2]
      ,[ptn3]
      ,[ptn4]
      ,[ptn5]
      ,[ptn6]
      ,[ptny]
      ,[tietolahde] = CAST(kaikkivuodet.tietolahde as nvarchar(50))
      ,[rivinumero] = CAST(kaikkivuodet.rivinumero as int)

FROM ( --kaikkivuodet

SELECT [tilv]
      ,[NIMI]
      ,[NIMI2]
      ,[TK_koodi]
      ,[TOLKM]
      ,[NTOLKM]
      ,[TOTTV]
      ,[LISLKM]
      ,[NLISLKM]
      ,[LISTTV]
      ,[DILKM]
      ,[NDIPLKM]
      ,[DIPTTV]
      ,[INSLKM]
      ,[NOPINS]
      ,[OPINSTTV]
      ,[YHTE]
      ,[NYHTE]
      ,[YHTTTV]
      ,[PAME]
      ,[OSTPAL]
      ,[YHME]
      ,[TEKES]
      ,[MTEM]
      ,[AKATEMIA]
      ,[GRAD]
      ,[MOPEM]
      ,[LIIKM]
      ,[MAAM]
      ,[OM]
      ,[PM]
      ,[SISAM]
      ,[SOSM]
      ,[UM]
      ,[VN]
      ,[VM]
      ,[YMP]
      ,[MUUJU]
      ,[RAHAS]
      ,[KOTIM]
      ,[ULKOY]
      ,[UEU]
	  ,[EUPUITE] = NULL
	  ,[EAKR] = NULL
	  ,[ESR] = NULL
	  ,[MUUEU] = NULL
      ,[MULKO]
      ,[UYHTE]
      ,[KUNTA1]
      ,[KUNTA2]
      ,[KUNTA3]
      ,[KUNTA4]
      ,[KUNTA5]
      ,[KUNTA6]
      ,[KUNTA7]
      ,[KUNTA8]
      ,[KUNTA9]
      ,[KUNTA10]
      ,[KUNTA11]
      ,[KUNTA12]
      ,[KUNTA13]
      ,[KUNTA14]
      ,[KUNTA15]
      ,[KUNTA16]
      ,[KUNTA17]
      ,[KUNTA18]
      ,[KUNTA19]
      ,[KUNTA20]
      ,[KUNTA21]
      ,[KUNTA22]
      ,[KUNTA23]
      ,[KUNTA24]
      ,[KUNTA25]
      ,[HENLKMY]
      ,[TYOVY]
      ,[TKMENOY]
      ,[HENLKM1]
      ,[HENLKM2]
      ,[HENLKM3]
      ,[HENLKM4]
      ,[HENLKM5]
      ,[HENLKM6]
      ,[HENLKM7]
      ,[HENLKM8]
      ,[HENLKM9]
      ,[HENLKM10]
      ,[HENLKM11]
      ,[HENLKM12]
      ,[HENLKM13]
      ,[HENLKM14]
      ,[HENLKM15]
      ,[HENLKM16]
      ,[HENLKM17]
      ,[HENLKM18]
      ,[HENLKM19]
      ,[HENLKM20]
      ,[HENLKM21]
      ,[HENLKM22]
      ,[HENLKM23]
      ,[HENLKM24]
      ,[HENLKM25]
      ,[TYOV1]
      ,[TYOV2]
      ,[TYOV3]
      ,[TYOV4]
      ,[TYOV5]
      ,[TYOV6]
      ,[TYOV7]
      ,[TYOV8]
      ,[TYOV9]
      ,[TYOV10]
      ,[TYOV11]
      ,[TYOV12]
      ,[TYOV13]
      ,[TYOV14]
      ,[TYOV15]
      ,[TYOV16]
      ,[TYOV17]
      ,[TYOV18]
      ,[TYOV19]
      ,[TYOV20]
      ,[TYOV21]
      ,[TYOV22]
      ,[TYOV23]
      ,[TYOV24]
      ,[TYOV25]
      ,[TKMENO1]
      ,[TKMENO2]
      ,[TKMENO3]
      ,[TKMENO4]
      ,[TKMENO5]
      ,[TKMENO6]
      ,[TKMENO7]
      ,[TKMENO8]
      ,[TKMENO9]
      ,[TKMENO10]
      ,[TKMENO11]
      ,[TKMENO12]
      ,[TKMENO13]
      ,[TKMENO14]
      ,[TKMENO15]
      ,[TKMENO16]
      ,[TKMENO17]
      ,[TKMENO18]
      ,[TKMENO19]
      ,[TKMENO20]
      ,[TKMENO21]
      ,[TKMENO22]
      ,[TKMENO23]
      ,[TKMENO24]
      ,[TKMENO25]
      ,[TA1]
      ,[TA2]
      ,[TA3]
      ,[TA4]
      ,[TA5]
      ,[TA6]
      ,[TA7]
      ,[TA8]
      ,[TA9]
      ,[TA10]
      ,[TA11]
      ,[TA12]
      ,[TA13]
      ,[TA14]
      ,[TA15]
      ,[TA16]
      ,[TA17]
      ,[TA18]
      ,[TA1P]
      ,[TA2P]
      ,[TA3P]
      ,[TA4P]
      ,[TA5P]
      ,[TA6P]
      ,[TA7P]
      ,[TA8P]
      ,[TA9P]
      ,[TA10P]
      ,[TA11P]
      ,[TA12P]
      ,[TA13P]
      ,[TA14P]
      ,[TA15P]
      ,[TA16P]
      ,[TA17P]
      ,[TA18P]
      ,[tk_arvio]
      ,[tk_arvioe]
      ,[KMENO]
      ,[HMENO]
      ,[TUTLKM]
      ,[NTUTLKM]
      ,[TUTTTV]
      ,[MTKLKM]
      ,[NMTKLKM]
      ,[MTKTTV]
      ,[YHTE2]
      ,[NYHTE2]
      ,[MKOULKM]
      ,[NMKOULKM]
      ,[MKOUTTV]
      ,[OPISTLKM]
      ,[NOPISTLKM]
      ,[OPISTTTV]
      ,[KUNNAT]
      ,[MKVJ]
      ,[ORAHAS]
      ,[phy1]
      ,[phy2]
      ,[phy3]
      ,[phy4]
      ,[phy5]
      ,[phy6]
      ,[phyy]
      ,[phn1]
      ,[phn2]
      ,[phn3]
      ,[phn4]
      ,[phn5]
      ,[phn6]
      ,[phny]
      ,[pty1]
      ,[pty2]
      ,[pty3]
      ,[pty4]
      ,[pty5]
      ,[pty6]
      ,[ptyy]
      ,[ptn1]
      ,[ptn2]
      ,[ptn3]
      ,[ptn4]
      ,[ptn5]
      ,[ptn6]
      ,[ptny]
      ,[luontipvm]
	  ,tieteenalakoodisto=''TA07''
      ,[tietolahde]=''TK_5_4_sopv_12_yosair''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY TK_Koodi)
FROM [TK_H9098_CSC].[dbo].[TK_5_4_sopv_12_yosair]

UNION ALL

SELECT [tilv]
      ,[NIMI]
      ,[NIMI2]
      ,[TK_koodi]
      ,[TOLKM]
      ,[NTOLKM]
      ,[TOTTV]
      ,[LISLKM]
      ,[NLISLKM]
      ,[LISTTV]
      ,[DILKM]
      ,[NDIPLKM]
      ,[DIPTTV]
      ,[INSLKM]
      ,[NOPINS]
      ,[OPINSTTV]
      ,[YHTE]
      ,[NYHTE]
      ,[YHTTTV]
      ,[PAME]
      ,[OSTPAL]
      ,[YHME]
      ,[TEKES]
      ,[MTEM]
      ,[AKATEMIA]
      ,[GRAD]
      ,[MOPEM]
      ,[LIIKM]
      ,[MAAM]
      ,[OM]
      ,[PM]
      ,[SISAM]
      ,[SOSM]
      ,[UM]
      ,[VN]
      ,[VM]
      ,[YMP]
      ,[MUUJU]
      ,[RAHAS]
      ,[KOTIM]
      ,[ULKOY]
      ,[UEU]
	  ,[EUPUITE]=0.0
	  ,[EAKR]=0.0
	  ,[ESR]=0.0
	  ,[MUUEU]=0.0
      ,[MULKO]
      ,[UYHTE]
      ,[KUNTA1]
      ,[KUNTA2]
      ,[KUNTA3]
      ,[KUNTA4]
      ,[KUNTA5]
      ,[KUNTA6]
      ,[KUNTA7]
      ,[KUNTA8]
      ,[KUNTA9]
      ,[KUNTA10]
      ,[KUNTA11]
      ,[KUNTA12]
      ,[KUNTA13]
      ,[KUNTA14]
      ,[KUNTA15]
      ,[KUNTA16]
      ,[KUNTA17]
      ,[KUNTA18]
      ,[KUNTA19]
      ,[KUNTA20]
      ,[KUNTA21]
      ,[KUNTA22]
      ,[KUNTA23]
      ,[KUNTA24]
      ,[KUNTA25]
      ,[HENLKMY]
      ,[TYOVY]
      ,[TKMENOY]
      ,[HENLKM1]
      ,[HENLKM2]
      ,[HENLKM3]
      ,[HENLKM4]
      ,[HENLKM5]
      ,[HENLKM6]
      ,[HENLKM7]
      ,[HENLKM8]
      ,[HENLKM9]
      ,[HENLKM10]
      ,[HENLKM11]
      ,[HENLKM12]
      ,[HENLKM13]
      ,[HENLKM14]
      ,[HENLKM15]
      ,[HENLKM16]
      ,[HENLKM17]
      ,[HENLKM18]
      ,[HENLKM19]
      ,[HENLKM20]
      ,[HENLKM21]
      ,[HENLKM22]
      ,[HENLKM23]
      ,[HENLKM24]
      ,[HENLKM25]
      ,[TYOV1]
      ,[TYOV2]
      ,[TYOV3]
      ,[TYOV4]
      ,[TYOV5]
      ,[TYOV6]
      ,[TYOV7]
      ,[TYOV8]
      ,[TYOV9]
      ,[TYOV10]
      ,[TYOV11]
      ,[TYOV12]
      ,[TYOV13]
      ,[TYOV14]
      ,[TYOV15]
      ,[TYOV16]
      ,[TYOV17]
      ,[TYOV18]
      ,[TYOV19]
      ,[TYOV20]
      ,[TYOV21]
      ,[TYOV22]
      ,[TYOV23]
      ,[TYOV24]
      ,[TYOV25]
      ,[TKMENO1]
      ,[TKMENO2]
      ,[TKMENO3]
      ,[TKMENO4]
      ,[TKMENO5]
      ,[TKMENO6]
      ,[TKMENO7]
      ,[TKMENO8]
      ,[TKMENO9]
      ,[TKMENO10]
      ,[TKMENO11]
      ,[TKMENO12]
      ,[TKMENO13]
      ,[TKMENO14]
      ,[TKMENO15]
      ,[TKMENO16]
      ,[TKMENO17]
      ,[TKMENO18]
      ,[TKMENO19]
      ,[TKMENO20]
      ,[TKMENO21]
      ,[TKMENO22]
      ,[TKMENO23]
      ,[TKMENO24]
      ,[TKMENO25]
      ,[TA1]
      ,[TA2]
      ,[TA3]
      ,[TA4]
      ,[TA5]
      ,[TA6]
      ,[TA7]
      ,[TA8]
      ,[TA9]
      ,[TA10]
      ,[TA11]
      ,[TA12]
      ,[TA13]
      ,[TA14]
      ,[TA15]
      ,[TA16]
      ,[TA17]
      ,[TA18]
      ,[TA1P]
      ,[TA2P]
      ,[TA3P]
      ,[TA4P]
      ,[TA5P]
      ,[TA6P]
      ,[TA7P]
      ,[TA8P]
      ,[TA9P]
      ,[TA10P]
      ,[TA11P]
      ,[TA12P]
      ,[TA13P]
      ,[TA14P]
      ,[TA15P]
      ,[TA16P]
      ,[TA17P]
      ,[TA18P]
      ,[tk_arvio]
      ,[tk_arvioe]
      ,[KMENO]
      ,[HMENO]
      ,[TUTLKM]
      ,[NTUTLKM]
      ,[TUTTTV]
      ,[MTKLKM]
      ,[NMTKLKM]
      ,[MTKTTV]
      ,[YHTE2]
      ,[NYHTE2]
      ,[MKOULKM]
      ,[NMKOULKM]
      ,[MKOUTTV]
      ,[OPISTLKM]
      ,[NOPISTLKM]
      ,[OPISTTTV]
      ,[KUNNAT]
      ,[MKVJ]
      ,[ORAHAS]
      ,[phy1]
      ,[phy2]
      ,[phy3]
      ,[phy4]
      ,[phy5]
      ,[phy6]
      ,[phyy]
      ,[phn1]
      ,[phn2]
      ,[phn3]
      ,[phn4]
      ,[phn5]
      ,[phn6]
      ,[phny]
      ,[pty1]
      ,[pty2]
      ,[pty3]
      ,[pty4]
      ,[pty5]
      ,[pty6]
      ,[ptyy]
      ,[ptn1]
      ,[ptn2]
      ,[ptn3]
      ,[ptn4]
      ,[ptn5]
      ,[ptn6]
      ,[ptny]
      ,[luontipvm]
	  ,tieteenalakoodisto=''TA10''
      ,[tietolahde]=''TK_5_4_sopv_13_yosair''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY TK_Koodi)
FROM [TK_H9098_CSC].[dbo].[TK_5_4_sopv_13_yosair]

UNION ALL

SELECT [tilv]
      ,[NIMI]
      ,[NIMI2]
      ,[TK_koodi]
      ,[TOLKM]
      ,[NTOLKM]
      ,[TOTTV]
      ,[LISLKM]
      ,[NLISLKM]
      ,[LISTTV]
      ,[DILKM]
      ,[NDIPLKM]
      ,[DIPTTV]
      ,[INSLKM]
      ,[NOPINS]
      ,[OPINSTTV]
      ,[YHTE]
      ,[NYHTE]
      ,[YHTTTV]
      ,[PAME]
      ,[OSTPAL]
      ,[YHME]
      ,[TEKES]
      ,[MTEM]
      ,[AKATEMIA]
      ,[GRAD]
      ,[MOPEM]
      ,[LIIKM]
      ,[MAAM]
      ,[OM]
      ,[PM]
      ,[SISAM]
      ,[SOSM]
      ,[UM]
      ,[VN]
      ,[VM]
      ,[YMP]
      ,[MUUJU]
      ,[RAHAS]
      ,[KOTIM]
      ,[ULKOY]
      ,[UEU]
	  ,[EUPUITE]=0.0
	  ,[EAKR]=0.0
	  ,[ESR]=0.0
	  ,[MUUEU]=0.0
      ,[MULKO]
      ,[UYHTE]
      ,[KUNTA1]
      ,[KUNTA2]
      ,[KUNTA3]
      ,[KUNTA4]
      ,[KUNTA5]
      ,[KUNTA6]
      ,[KUNTA7]
      ,[KUNTA8]
      ,[KUNTA9]
      ,[KUNTA10]
      ,[KUNTA11]
      ,[KUNTA12]
      ,[KUNTA13]
      ,[KUNTA14]
      ,[KUNTA15]
      ,[KUNTA16]
      ,[KUNTA17]
      ,[KUNTA18]
      ,[KUNTA19]
      ,[KUNTA20]
      ,[KUNTA21]
      ,[KUNTA22]
      ,[KUNTA23]
      ,[KUNTA24]
      ,[KUNTA25]
      ,[HENLKMY]
      ,[TYOVY]
      ,[TKMENOY]
      ,[HENLKM1]
      ,[HENLKM2]
      ,[HENLKM3]
      ,[HENLKM4]
      ,[HENLKM5]
      ,[HENLKM6]
      ,[HENLKM7]
      ,[HENLKM8]
      ,[HENLKM9]
      ,[HENLKM10]
      ,[HENLKM11]
      ,[HENLKM12]
      ,[HENLKM13]
      ,[HENLKM14]
      ,[HENLKM15]
      ,[HENLKM16]
      ,[HENLKM17]
      ,[HENLKM18]
      ,[HENLKM19]
      ,[HENLKM20]
      ,[HENLKM21]
      ,[HENLKM22]
      ,[HENLKM23]
      ,[HENLKM24]
      ,[HENLKM25]
      ,[TYOV1]
      ,[TYOV2]
      ,[TYOV3]
      ,[TYOV4]
      ,[TYOV5]
      ,[TYOV6]
      ,[TYOV7]
      ,[TYOV8]
      ,[TYOV9]
      ,[TYOV10]
      ,[TYOV11]
      ,[TYOV12]
      ,[TYOV13]
      ,[TYOV14]
      ,[TYOV15]
      ,[TYOV16]
      ,[TYOV17]
      ,[TYOV18]
      ,[TYOV19]
      ,[TYOV20]
      ,[TYOV21]
      ,[TYOV22]
      ,[TYOV23]
      ,[TYOV24]
      ,[TYOV25]
      ,[TKMENO1]
      ,[TKMENO2]
      ,[TKMENO3]
      ,[TKMENO4]
      ,[TKMENO5]
      ,[TKMENO6]
      ,[TKMENO7]
      ,[TKMENO8]
      ,[TKMENO9]
      ,[TKMENO10]
      ,[TKMENO11]
      ,[TKMENO12]
      ,[TKMENO13]
      ,[TKMENO14]
      ,[TKMENO15]
      ,[TKMENO16]
      ,[TKMENO17]
      ,[TKMENO18]
      ,[TKMENO19]
      ,[TKMENO20]
      ,[TKMENO21]
      ,[TKMENO22]
      ,[TKMENO23]
      ,[TKMENO24]
      ,[TKMENO25]
      ,[TA1]
      ,[TA2]
      ,[TA3]
      ,[TA4]
      ,[TA5]
      ,[TA6]
      ,[TA7]
      ,[TA8]
      ,[TA9]
      ,[TA10]
      ,[TA11]
      ,[TA12]
      ,[TA13]
      ,[TA14]
      ,[TA15]
      ,[TA16]
      ,[TA17]
      ,[TA18]
      ,[TA1P]
      ,[TA2P]
      ,[TA3P]
      ,[TA4P]
      ,[TA5P]
      ,[TA6P]
      ,[TA7P]
      ,[TA8P]
      ,[TA9P]
      ,[TA10P]
      ,[TA11P]
      ,[TA12P]
      ,[TA13P]
      ,[TA14P]
      ,[TA15P]
      ,[TA16P]
      ,[TA17P]
      ,[TA18P]
      ,[tk_arvio]
      ,[tk_arvioe]
      ,[KMENO]
      ,[HMENO]
      ,[TUTLKM]
      ,[NTUTLKM]
      ,[TUTTTV]
      ,[MTKLKM]
      ,[NMTKLKM]
      ,[MTKTTV]
      ,[YHTE2]
      ,[NYHTE2]
      ,[MKOULKM]
      ,[NMKOULKM]
      ,[MKOUTTV]
      ,[OPISTLKM]
      ,[NOPISTLKM]
      ,[OPISTTTV]
      ,[KUNNAT]
      ,[MKVJ]
      ,[ORAHAS]
      ,[phy1]
      ,[phy2]
      ,[phy3]
      ,[phy4]
      ,[phy5]
      ,[phy6]
      ,[phyy]
      ,[phn1]
      ,[phn2]
      ,[phn3]
      ,[phn4]
      ,[phn5]
      ,[phn6]
      ,[phny]
      ,[pty1]
      ,[pty2]
      ,[pty3]
      ,[pty4]
      ,[pty5]
      ,[pty6]
      ,[ptyy]
      ,[ptn1]
      ,[ptn2]
      ,[ptn3]
      ,[ptn4]
      ,[ptn5]
      ,[ptn6]
      ,[ptny]
      ,[luontipvm]
	  ,tieteenalakoodisto=''TA10''
      ,[tietolahde]=''TK_5_4_sopv_14_yosair''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY TK_Koodi)
FROM [TK_H9098_CSC].[dbo].[TK_5_4_sopv_14_yosair]

UNION ALL

SELECT [tilv]
      ,[NIMI]
      ,[NIMI2]
      ,[TK_koodi]
      ,[TOLKM]
      ,[NTOLKM]
      ,[TOTTV]
      ,[LISLKM]
      ,[NLISLKM]
      ,[LISTTV]
      ,[DILKM]
      ,[NDIPLKM]
      ,[DIPTTV]
      ,[INSLKM]
      ,[NOPINS]
      ,[OPINSTTV]
      ,[YHTE]
      ,[NYHTE]
      ,[YHTTTV]
      ,[PAME]
      ,[OSTPAL]
      ,[YHME]
      ,[TEKES]
      ,[MTEM]
      ,[AKATEMIA]
      ,[GRAD]
      ,[MOPEM]
      ,[LIIKM]
      ,[MAAM]
      ,[OM]
      ,[PM]
      ,[SISAM]
      ,[SOSM]
      ,[UM]
      ,[VN]
      ,[VM]
      ,[YMP]
      ,[MUUJU]
      ,[RAHAS]
      ,[KOTIM]
      ,[ULKOY]
      ,[UEU]
	  ,[EUPUITE] = NULL
	  ,[EAKR] = NULL
	  ,[ESR] = NULL
	  ,[MUUEU] = NULL
      ,[MULKO]
      ,[UYHTE]
      ,[KUNTA1]
      ,[KUNTA2]
      ,[KUNTA3]
      ,[KUNTA4]
      ,[KUNTA5]
      ,[KUNTA6]
      ,[KUNTA7]
      ,[KUNTA8]
      ,[KUNTA9]
      ,[KUNTA10]
      ,[KUNTA11]
      ,[KUNTA12]
      ,[KUNTA13]
      ,[KUNTA14]
      ,[KUNTA15]
      ,[KUNTA16]
      ,[KUNTA17]
      ,[KUNTA18]
      ,[KUNTA19]
      ,[KUNTA20]
      ,[KUNTA21]
      ,[KUNTA22]
      ,[KUNTA23]
      ,[KUNTA24]
      ,[KUNTA25]
      ,[HENLKMY]
      ,[TYOVY]
      ,[TKMENOY]
      ,[HENLKM1]
      ,[HENLKM2]
      ,[HENLKM3]
      ,[HENLKM4]
      ,[HENLKM5]
      ,[HENLKM6]
      ,[HENLKM7]
      ,[HENLKM8]
      ,[HENLKM9]
      ,[HENLKM10]
      ,[HENLKM11]
      ,[HENLKM12]
      ,[HENLKM13]
      ,[HENLKM14]
      ,[HENLKM15]
      ,[HENLKM16]
      ,[HENLKM17]
      ,[HENLKM18]
      ,[HENLKM19]
      ,[HENLKM20]
      ,[HENLKM21]
      ,[HENLKM22]
      ,[HENLKM23]
      ,[HENLKM24]
      ,[HENLKM25]
      ,[TYOV1]
      ,[TYOV2]
      ,[TYOV3]
      ,[TYOV4]
      ,[TYOV5]
      ,[TYOV6]
      ,[TYOV7]
      ,[TYOV8]
      ,[TYOV9]
      ,[TYOV10]
      ,[TYOV11]
      ,[TYOV12]
      ,[TYOV13]
      ,[TYOV14]
      ,[TYOV15]
      ,[TYOV16]
      ,[TYOV17]
      ,[TYOV18]
      ,[TYOV19]
      ,[TYOV20]
      ,[TYOV21]
      ,[TYOV22]
      ,[TYOV23]
      ,[TYOV24]
      ,[TYOV25]
      ,[TKMENO1]
      ,[TKMENO2]
      ,[TKMENO3]
      ,[TKMENO4]
      ,[TKMENO5]
      ,[TKMENO6]
      ,[TKMENO7]
      ,[TKMENO8]
      ,[TKMENO9]
      ,[TKMENO10]
      ,[TKMENO11]
      ,[TKMENO12]
      ,[TKMENO13]
      ,[TKMENO14]
      ,[TKMENO15]
      ,[TKMENO16]
      ,[TKMENO17]
      ,[TKMENO18]
      ,[TKMENO19]
      ,[TKMENO20]
      ,[TKMENO21]
      ,[TKMENO22]
      ,[TKMENO23]
      ,[TKMENO24]
      ,[TKMENO25]
      ,[TA1]
      ,[TA2]
      ,[TA3]
      ,[TA4]
      ,[TA5]
      ,[TA6]
      ,[TA7]
      ,[TA8]
      ,[TA9]
      ,[TA10]
      ,[TA11]
      ,[TA12]
      ,[TA13]
      ,[TA14]
      ,[TA15]
      ,[TA16]
      ,[TA17]
      ,[TA18]
      ,[TA1P]
      ,[TA2P]
      ,[TA3P]
      ,[TA4P]
      ,[TA5P]
      ,[TA6P]
      ,[TA7P]
      ,[TA8P]
      ,[TA9P]
      ,[TA10P]
      ,[TA11P]
      ,[TA12P]
      ,[TA13P]
      ,[TA14P]
      ,[TA15P]
      ,[TA16P]
      ,[TA17P]
      ,[TA18P]
      ,[tk_arvio]
      ,[tk_arvioe]
      ,[KMENO]
      ,[HMENO]
      ,[TUTLKM]
      ,[NTUTLKM]
      ,[TUTTTV]
      ,[MTKLKM]
      ,[NMTKLKM]
      ,[MTKTTV]
      ,[YHTE2]
      ,[NYHTE2]
      ,[MKOULKM]
      ,[NMKOULKM]
      ,[MKOUTTV]
      ,[OPISTLKM]
      ,[NOPISTLKM]
      ,[OPISTTTV]
      ,[KUNNAT]
      ,[MKVJ]
      ,[ORAHAS]
      ,[phy1]
      ,[phy2]
      ,[phy3]
      ,[phy4]
      ,[phy5]
      ,[phy6]
      ,[phyy]
      ,[phn1]
      ,[phn2]
      ,[phn3]
      ,[phn4]
      ,[phn5]
      ,[phn6]
      ,[phny]
      ,[pty1]
      ,[pty2]
      ,[pty3]
      ,[pty4]
      ,[pty5]
      ,[pty6]
      ,[ptyy]
      ,[ptn1]
      ,[ptn2]
      ,[ptn3]
      ,[ptn4]
      ,[ptn5]
      ,[ptn6]
      ,[ptny]
      ,[luontipvm]
	  ,tieteenalakoodisto=''TA10''
      ,[tietolahde]=''TK_5_4_sopv_15_yosair''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY TK_Koodi)
  FROM [TK_H9098_CSC].[dbo].[TK_5_4_sopv_15_yosair]

UNION ALL

SELECT [tilv]
      ,[NIMI]
      ,[NIMI2]
      ,[TK_koodi]
      ,[TOLKM]
      ,[NTOLKM]
      ,[TOTTV]
      ,[LISLKM]
      ,[NLISLKM]
      ,[LISTTV]
      ,[DILKM]
      ,[NDIPLKM]
      ,[DIPTTV]
      ,[INSLKM]
      ,[NOPINS]
      ,[OPINSTTV]
      ,[YHTE]
      ,[NYHTE]
      ,[YHTTTV]
      ,[PAME]
      ,[OSTPAL]
      ,[YHME]
      ,[TEKES]
      ,[MTEM]
      ,[AKATEMIA]
      ,NULL AS [GRAD]
      ,[MOPEM]
      ,[LIIKM]
      ,[MAAM]
      ,[OM]
      ,[PM]
      ,[SISAM]
      ,[SOSM]
      ,[UM]
      ,[VN]
      ,[VM]
      ,[YMP]
      ,[MUUJU]
      ,[RAHAS]
      ,[KOTIM]
      ,[ULKOY]
      ,[UEU]
	  ,[EUPUITE] = NULL
	  ,[EAKR] = NULL
	  ,[ESR] = NULL
	  ,[MUUEU] = NULL
      ,[MULKO]
      ,[UYHTE]
      ,[KUNTA1]
      ,[KUNTA2]
      ,[KUNTA3]
      ,[KUNTA4]
      ,[KUNTA5]
      ,[KUNTA6]
      ,[KUNTA7]
      ,[KUNTA8]
      ,[KUNTA9]
      ,[KUNTA10]
      ,[KUNTA11]
      ,[KUNTA12]
      ,[KUNTA13]
      ,[KUNTA14]
      ,[KUNTA15]
      ,[KUNTA16]
      ,[KUNTA17]
      ,[KUNTA18]
      ,[KUNTA19]
      ,[KUNTA20]
      ,[KUNTA21]
      ,[KUNTA22]
      ,[KUNTA23]
      ,[KUNTA24]
      ,[KUNTA25]
      ,[HENLKMY]
      ,[TYOVY]
      ,[TKMENOY]
      ,[HENLKM1]
      ,[HENLKM2]
      ,[HENLKM3]
      ,[HENLKM4]
      ,[HENLKM5]
      ,[HENLKM6]
      ,[HENLKM7]
      ,[HENLKM8]
      ,[HENLKM9]
      ,[HENLKM10]
      ,[HENLKM11]
      ,[HENLKM12]
      ,[HENLKM13]
      ,[HENLKM14]
      ,[HENLKM15]
      ,[HENLKM16]
      ,[HENLKM17]
      ,[HENLKM18]
      ,[HENLKM19]
      ,[HENLKM20]
      ,[HENLKM21]
      ,[HENLKM22]
      ,[HENLKM23]
      ,[HENLKM24]
      ,[HENLKM25]
      ,[TYOV1]
      ,[TYOV2]
      ,[TYOV3]
      ,[TYOV4]
      ,[TYOV5]
      ,[TYOV6]
      ,[TYOV7]
      ,[TYOV8]
      ,[TYOV9]
      ,[TYOV10]
      ,[TYOV11]
      ,[TYOV12]
      ,[TYOV13]
      ,[TYOV14]
      ,[TYOV15]
      ,[TYOV16]
      ,[TYOV17]
      ,[TYOV18]
      ,[TYOV19]
      ,[TYOV20]
      ,[TYOV21]
      ,[TYOV22]
      ,[TYOV23]
      ,[TYOV24]
      ,[TYOV25]
      ,[TKMENO1]
      ,[TKMENO2]
      ,[TKMENO3]
      ,[TKMENO4]
      ,[TKMENO5]
      ,[TKMENO6]
      ,[TKMENO7]
      ,[TKMENO8]
      ,[TKMENO9]
      ,[TKMENO10]
      ,[TKMENO11]
      ,[TKMENO12]
      ,[TKMENO13]
      ,[TKMENO14]
      ,[TKMENO15]
      ,[TKMENO16]
      ,[TKMENO17]
      ,[TKMENO18]
      ,[TKMENO19]
      ,[TKMENO20]
      ,[TKMENO21]
      ,[TKMENO22]
      ,[TKMENO23]
      ,[TKMENO24]
      ,[TKMENO25]
      ,[TA1]
      ,[TA2]
      ,[TA3]
      ,[TA4]
      ,[TA5]
      ,[TA6]
      ,[TA7]
      ,[TA8]
      ,[TA9]
      ,[TA10]
      ,[TA11]
      ,[TA12]
      ,[TA13]
      ,[TA14]
      ,[TA15]
      ,[TA16]
      ,[TA17]
      ,[TA18]
      ,[TA1P]
      ,[TA2P]
      ,[TA3P]
      ,[TA4P]
      ,[TA5P]
      ,[TA6P]
      ,[TA7P]
      ,[TA8P]
      ,[TA9P]
      ,[TA10P]
      ,[TA11P]
      ,[TA12P]
      ,[TA13P]
      ,[TA14P]
      ,[TA15P]
      ,[TA16P]
      ,[TA17P]
      ,[TA18P]
      ,[tk_arvio]
      ,[tk_arvioe]
      ,NULL AS [KMENO]
      ,NULL AS [HMENO]
      ,NULL AS [TUTLKM]
      ,NULL AS [NTUTLKM]
      ,NULL AS [TUTTTV]
      ,NULL AS [MTKLKM]
      ,NULL AS [NMTKLKM]
      ,NULL AS [MTKTTV]
      ,NULL AS [YHTE2]
      ,NULL AS [NYHTE2]
      ,NULL AS [MKOULKM]
      ,NULL AS [NMKOULKM]
      ,NULL AS [MKOUTTV]
      ,NULL AS [OPISTLKM]
      ,NULL AS [NOPISTLKM]
      ,NULL AS [OPISTTTV]
      ,NULL AS [KUNNAT]
      ,NULL AS [MKVJ]
      ,NULL AS [ORAHAS]
      ,[phy1]
      ,[phy2]
      ,[phy3]
      ,[phy4]
      ,[phy5]
      ,[phy6]
      ,[phyy]
      ,[phn1]
      ,[phn2]
      ,[phn3]
      ,[phn4]
      ,[phn5]
      ,[phn6]
      ,[phny]
      ,[pty1]
      ,[pty2]
      ,[pty3]
      ,[pty4]
      ,[pty5]
      ,[pty6]
      ,[ptyy]
      ,[ptn1]
      ,[ptn2]
      ,[ptn3]
      ,[ptn4]
      ,[ptn5]
      ,[ptn6]
      ,[ptny]
      ,[luontipvm]
	  ,tieteenalakoodisto=''TA10''
      ,[tietolahde]=''TK_5_4_sopv_16_yosair''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY TK_Koodi)
  FROM [TK_H9098_CSC].[dbo].[TK_5_4_sopv_16_yosair]
) kaikkivuodet









' 
GO
/****** Object:  View [dbo].[v_sa_6_1_Oppilaitosrekisteri_13]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_6_1_Oppilaitosrekisteri_13]'))
EXEC dbo.sp_executesql @statement = N'CREATE VIEW [dbo].[v_sa_6_1_Oppilaitosrekisteri_13] AS
SELECT [tilv]
      ,[tunn]
      ,[onimi]
      ,[syntv]
      ,[syntkk]
      ,[lakkv]
      ,[lakkkk]
      ,[utunn]
      ,[olo]
      ,[sair]
      ,[oltyp]
      ,[pkryhma]
      ,[vuosilks]
      ,[omist]
      ,[okieli]
      ,[jarj]
      ,[okun]
      ,[oikoord]
      ,[opkoord]
      ,[psnro]
      ,[tietolahde]=''6_1_sopv_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_6_1_sopv_13]
' 
GO
/****** Object:  View [dbo].[v_sa_6_4_Nayttotutkintoja_jarj_koulutusalan_yritykset_13]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_6_4_Nayttotutkintoja_jarj_koulutusalan_yritykset_13]'))
EXEC dbo.sp_executesql @statement = N'/****** Script for SelectTopNRows command from SSMS  ******/
CREATE VIEW [dbo].[v_sa_6_4_Nayttotutkintoja_jarj_koulutusalan_yritykset_13] AS
SELECT [tilv]
      ,[tunn]
      ,[onimi]
      ,[okun]
      ,[okieli]
      ,[tietolahde]=''6_4_sopv_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_6_4_sopv_13]
' 
GO
/****** Object:  View [dbo].[v_sa_6_5_Koulutusluokitus_13]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_6_5_Koulutusluokitus_13]'))
EXEC dbo.sp_executesql @statement = N'/****** Script for SelectTopNRows command from SSMS  ******/
CREATE VIEW [dbo].[v_sa_6_5_Koulutusluokitus_13] AS
SELECT [tilv]
      ,[koulk]
      ,[taso]
      ,[snimi]
      ,[slnimi]
      ,[rnimi]
      ,[rlnimi]
      ,[enimi]
      ,[elnimi]
      ,[olokoodi]
      ,[lakkv]
      ,[korvkoulk]
      ,[nmuutosv]
      ,[kala]
      ,[kalanimi]
      ,[kalalnimi]
      ,[kalanimi_r]
      ,[kalalnimi_r]
      ,[kaste]
      ,[kastenimi]
      ,[kastenimi_r]
      ,[opmala]
      ,[opmalani]
      ,[opmalalni]
      ,[opmopa]
      ,[opmopani]
      ,[opmopalni]
      ,[opmast]
      ,[opmastni]
      ,[opmastlni]
      ,[opm95ala]
      ,[opm95alani]
      ,[opm95alalni]
      ,[opm95opa]
      ,[opm95opani]
      ,[opm95opalni]
      ,[opm95ast]
      ,[opm95astni]
      ,[opm95astlni]
      ,[isclek]
      ,[iscle]
      ,[iscleknim]
      ,[iscfik]
      ,[iscfiknim]
      ,[iscde]
      ,[iscor]
      ,[iscst]
      ,[iscdu]
      ,[tietolahde]=''6_5_sopv_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_6_5_sopv_13]
' 
GO
/****** Object:  View [dbo].[v_sa_6_7_Alueluokitus_12]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_6_7_Alueluokitus_12]'))
EXEC dbo.sp_executesql @statement = N'/****** Script for SelectTopNRows command from SSMS  ******/
CREATE VIEW [dbo].[v_sa_6_7_Alueluokitus_12] AS
SELECT [tilv]
      ,[kunta]
      ,[alkaa]= ''1900-01-01 00:00:00.0000000''
      ,[paattyy] = ''9999-01-01 00:00:00.0000000''
      ,[olo]
      ,[lakkv]
      ,[liitoskunta]
      ,[nimi_suom]
      ,[nimi_ruot]
      ,[maakunta]
      ,[maakuntanim_s]
      ,[maakuntanim_r]
      ,[maakuntanim_e]
      ,[avi]
      ,[avinimi_s]
      ,[avinimi_r]
      ,[avinimi_e]
      ,[ely]
      ,[elynimi_s]
      ,[elynimi_r]
      ,[elynimi_e]
      ,[seutukunta]
      ,[seutukuntanim_s]
      ,[seutukuntanim_r]
      ,[suuralue]
      ,[suuraluenim_s]
      ,[suuraluenim_r]
      ,[suuraluenim_e]
      ,[kuntaryh]
      ,[kuntaryhnim_s]
      ,[kuntaryhnim_r]
      ,[kuntaryhnim_e]
      ,[kielisuhde]
      ,[kielisuhdenim_s]
      ,[kielisuhdenim_r]
      ,[kielisuhdenim_e]
      ,[tietolahde]=''6_7_sopv_12''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_6_7_sopv_12]
   WHERE olo = ''0''
' 
GO
/****** Object:  View [dbo].[v_sa_6_7_Alueluokitus_13]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_6_7_Alueluokitus_13]'))
EXEC dbo.sp_executesql @statement = N'/****** Script for SelectTopNRows command from SSMS  ******/
CREATE VIEW [dbo].[v_sa_6_7_Alueluokitus_13] AS
SELECT [tilv]
      ,[kunta]
      ,[alkaa]= ''1900-01-01 00:00:00.0000000''
      ,[paattyy] = ''9999-01-01 00:00:00.0000000''
      ,[olo]
      ,[lakkv]
      ,[liitoskunta]
      ,[nimi_suom]
      ,[nimi_ruot]
      ,[maakunta]
      ,[maakuntanim_s]
      ,[maakuntanim_r]
      ,[maakuntanim_e]
      ,[avi]
      ,[avinimi_s]
      ,[avinimi_r]
      ,[avinimi_e]
      ,[ely]
      ,[elynimi_s]
      ,[elynimi_r]
      ,[elynimi_e]
      ,[seutukunta]
      ,[seutukuntanim_s]
      ,[seutukuntanim_r]
      ,[suuralue]
      ,[suuraluenim_s]
      ,[suuraluenim_r]
      ,[suuraluenim_e]
      ,[kuntaryh]
      ,[kuntaryhnim_s]
      ,[kuntaryhnim_r]
      ,[kuntaryhnim_e]
      ,[kielisuhde] = NULL
      ,[kielisuhdenim_s]
      ,[kielisuhdenim_r]
      ,[kielisuhdenim_e]
      ,[tietolahde]=''6_7_sopv_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_6_7_sopv_13]
  WHERE olo = ''0''
' 
GO
/****** Object:  View [dbo].[v_sa_6_9_Valtiot]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_6_9_Valtiot]'))
EXEC dbo.sp_executesql @statement = N'

CREATE VIEW [dbo].[v_sa_6_9_Valtiot] AS
SELECT
	 tilv
	,tilv_date = cast(tilv as date)
    ,maa
    ,maanimi_s
    ,maanimi_r
    ,maanimi_e
    ,mosa
    ,mosanim
    ,eumaa = Case when maa=''248'' then ''1'' else eumaa end
    ,etamaa = Case when maa=''248'' then ''1'' else etamaa end
    ,mosa_2
    ,mosanim_2
    ,mosa_3
    ,mosanim_3
    ,tietolahde = cast(kaikkivuodet.tietolahde as nvarchar(50))
	,rivinumero = cast(kaikkivuodet.rivinumero as int)
	,luontipvm
FROM (

	SELECT
	 tilv
    ,maa
    ,maanimi_s
    ,maanimi_r
    ,maanimi_e
    ,mosa
    ,mosanim
    ,eumaa
    ,etamaa
    ,null as mosa_2
    ,null as mosanim_2
    ,null as mosa_3
    ,null as mosanim_3
    ,tietolahde = ''6_9_sopv_11''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY maanimi_s)
	,luontipvm
FROM [TK_H9098_CSC].[dbo].[TK_6_9_sopv_11]
UNION ALL 
	SELECT
	 tilv
    ,maa
    ,maanimi_s
    ,maanimi_r
    ,maanimi_e
    ,mosa
    ,mosanim
    ,eumaa
    ,etamaa
    ,mosa_2
    ,mosanim_2
    ,mosa_3
    ,mosanim_3
    ,tietolahde = ''6_9_sopv_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY maanimi_s)
	,luontipvm
FROM [TK_H9098_CSC].[dbo].[TK_6_9_sopv_13]
UNION ALL 
	SELECT
	 tilv
    ,maa
    ,maanimi_s
    ,maanimi_r
    ,maanimi_e
    ,mosa
    ,mosanim
    ,eumaa
    ,etamaa
    ,mosa_2
    ,mosanim_2
    ,mosa_3
    ,mosanim_3
    ,tietolahde = ''TK_6_9_sopv_14''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY maanimi_s)
	,luontipvm
FROM [TK_H9098_CSC].[dbo].[TK_6_9_sopv_14]
UNION ALL 
	SELECT
	 tilv
    ,maa
    ,maanimi_s
    ,maanimi_r
    ,maanimi_e
    ,mosa
    ,mosanim
    ,eumaa
    ,etamaa
    ,mosa_2
    ,mosanim_2
    ,mosa_3
    ,mosanim_3
    ,tietolahde = ''TK_6_9_sopv_15''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY maanimi_s)
	,luontipvm
FROM [TK_H9098_CSC].[dbo].[TK_6_9_sopv_15]
) as kaikkivuodet



' 
GO
/****** Object:  View [dbo].[v_sa_7_1_Perusopetuksen_opettajat_kelpoisuus_opetusryhmakoot]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_7_1_Perusopetuksen_opettajat_kelpoisuus_opetusryhmakoot]'))
EXEC dbo.sp_executesql @statement = N'


























CREATE VIEW [dbo].[v_sa_7_1_Perusopetuksen_opettajat_kelpoisuus_opetusryhmakoot] AS

/*
Drop table [VipunenTK_DW].[dbo].[f_7_1_Perusopetuksen_opettajat_kelpoisuus_opetusryhmakoot]
Select * into [VipunenTK_DW].[dbo].[f_7_1_Perusopetuksen_opettajat_kelpoisuus_opetusryhmakoot] FROM [VipunenTK_SA].[dbo].[v_sa_7_1_Perusopetuksen_opettajat_kelpoisuus_opetusryhmakoot]
Truncate table [VipunenTK_DW].[dbo].[f_7_1_Perusopetuksen_opettajat_kelpoisuus_opetusryhmakoot]
Insert into [VipunenTK_DW].[dbo].[f_7_1_Perusopetuksen_opettajat_kelpoisuus_opetusryhmakoot]
  Select * FROM [VipunenTK_SA].[dbo].[v_sa_7_1_Perusopetuksen_opettajat_kelpoisuus_opetusryhmakoot]
*/

SELECT [tilv] = CAST(kaikkivuodet.tilv as nvarchar(4))
      ,[tilv_date] = Cast(kaikkivuodet.tilv+''0101'' as date)
	  ,[p_okieli] = Cast(kaikkivuodet.p_okieli as nvarchar(2))
      ,[p_oltyp] = Cast(kaikkivuodet.p_oltyp as nvarchar(2))
      ,[p_tyos1] = Cast(kaikkivuodet.p_tyos1 as nvarchar(2))
      ,[p_tyos2] = Cast(kaikkivuodet.p_tyos2 as nvarchar(2))
      ,[p_tyos3] = Cast(kaikkivuodet.p_tyos3 as nvarchar(2))
	  ,[p_tyos4] = Cast(kaikkivuodet.p_tyos4 as nvarchar(2))
      ,[p_tyos5] = Cast(kaikkivuodet.p_tyos5 as nvarchar(2))
	  ,[p_tyos] = Cast(kaikkivuodet.p_tyos as nvarchar(2))
      ,[p_virka] = Cast(kaikkivuodet.p_virka as nvarchar(2))
      ,[p_aste] = Cast(kaikkivuodet.p_aste as nvarchar(2))
      ,[p_k1] = Cast(kaikkivuodet.p_k1 as nvarchar(2))
      ,[p_k2] = Cast(kaikkivuodet.p_k2 as nvarchar(2))
      ,[p_k3] = Cast(kaikkivuodet.p_k3 as nvarchar(2))
      ,[p_k4] = Cast(kaikkivuodet.p_k4 as nvarchar(2))
      ,[p_k5] = Cast(kaikkivuodet.p_k5 as nvarchar(2))
      ,[p_k6] = Cast(kaikkivuodet.p_k6 as nvarchar(2))
      ,[p_k7] = Cast(kaikkivuodet.p_k7 as nvarchar(2))
      ,[p_k8] = Cast(kaikkivuodet.p_k8 as nvarchar(2))
      ,[p_k9] = Cast(kaikkivuodet.p_k9 as nvarchar(2))
      ,[p_k10] = Cast(kaikkivuodet.p_k10 as nvarchar(2))
      ,[p_k11] = Cast(kaikkivuodet.p_k11 as nvarchar(2))
      ,[p_olaste] = Cast(kaikkivuodet.p_olaste as nvarchar(2))
      ,[p_oluom] = Cast(kaikkivuodet.p_oluom as int)
      ,[p_aine] = Cast(kaikkivuodet.p_aine108 as nvarchar(2))
      ,[p_sp] = CAST(kaikkivuodet.p_sp as nvarchar(10))
      ,[p_maakunta] = CAST(kaikkivuodet.p_maakunta as varchar(2))
      ,[p_okunryh] = CAST(kaikkivuodet.p_okunryh as nvarchar(10))
      ,[p_ika] = CAST(kaikkivuodet.p_ika as nvarchar(10))
	  ,[p_kelpu] = CAST(kaikkivuodet.p_kelpu as nvarchar(10))
	  --,[p_kelp2] = CAST(kaikkivuodet.p_kelp2 as nvarchar(10))
	  ,[p_osa1] = CAST(kaikkivuodet.p_osa1 as nvarchar(10))
	  ,[p_osa2] = CAST(kaikkivuodet.p_osa2 as nvarchar(10))
      ,[tietolahde] = CAST(kaikkivuodet.tietolahde as nvarchar(50))
      ,[rivinumero] = CAST(kaikkivuodet.rivinumero as int)
  FROM (
  
  SELECT [tilv]
      ,[p_okieli]
      ,[p_oltyp]
      ,[p_tyos1] = NULL
      ,[p_tyos2] = NULL
      ,[p_tyos3] = NULL
	  ,[p_tyos4] = NULL
      ,[p_tyos5] = NULL
	  ,[p_tyos]
      ,[p_virka]
      ,[p_aste]
      ,[p_k1] = NULL
      ,[p_k2] = NULL
      ,[p_k3] = NULL
      ,[p_k4] = NULL
      ,[p_k5] = NULL
      ,[p_k6] = NULL
      ,[p_k7] = NULL
      ,[p_k8] = NULL
      ,[p_k9] = p_kelp2
      ,[p_k10] = NULL
      ,[p_k11] = NULL
      ,[p_olaste] = right(''0''+p_olaste,2)
      ,[p_oluom]
      ,[p_aine108] = case 
						when p_aine1 = ''00'' then ''99'' 
						else right(''0''+p_aine1,2)
					 end
      ,[p_sp]
      ,[p_maakunta] = case p_maakunta
						when ''99'' then ''-1'' 
						when ''20'' then ''01''
						else right(''0''+p_maakunta,2)
					  end
      ,[p_okunryh] = case p_okunryh when ''9'' then ''-1'' else p_okunryh end
      ,[p_ika] = case [p_ika]
	   when ''01'' then ''30655v30''
	   when ''02'' then ''19655v30''
	   when ''03'' then ''19655v35''
	   when ''04'' then ''19655v40''
	   when ''05'' then ''19655v45''
	   when ''06'' then ''19655v50''
	   when ''07'' then ''55''
	   when ''08'' then ''56''
	   when ''09'' then ''57''
	   when ''10'' then ''58''
	   when ''11'' then ''59''
	   when ''12'' then ''60''
	   when ''13'' then ''61''
	   when ''14'' then ''62''
	   when ''15'' then ''63''
	   when ''16'' then ''64''
	   when ''17'' then ''19655v65''
	   else ''-1''
	   end
	  ,[p_kelpu] = p_kelp1
	  --,[p_kelp2]
	  ,[p_osa1]
	  ,[p_osa2]
      ,[tietolahde]=''7_1_sopv_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_7_1_sopv_16]

  UNION ALL
  
  SELECT [tilv]
      ,[p_okieli]
      ,[p_oltyp]
      ,[p_tyos1]
      ,[p_tyos2]
      ,[p_tyos3]
	  ,[p_tyos4] = NULL
      ,[p_tyos5]
	  ,[p_tyos] = case 
					when p_tyos1 = 1 then 1
					when p_tyos1 = 0 and p_tyos2 = 0 and p_tyos3 = 1 then 2
					when p_tyos1 = 0 and p_tyos2 = 1 and p_tyos3 = 0 then 3
					else -1
				  end
      ,[p_virka]
      ,[p_aste]
      ,[p_k1]
      ,[p_k2]
      ,[p_k3]
      ,[p_k4]
      ,[p_k5]
      ,[p_k6]
      ,[p_k7]
      ,[p_k8]
      ,[p_k9] = null
      ,[p_k10]
      ,[p_k11]
      ,[p_olaste] = right(''0''+p_olaste,2)
      ,[p_oluom]
      ,[p_aine108] = case 
						when p_aine108 = ''00'' then ''99'' 
						else right(''0''+p_aine108,2) 
					 end
      ,[p_sp]
      ,[p_maakunta] = case 
						when p_maakunta=''99'' then ''-1'' 
						else right(''0''+p_maakunta,2)
					  end
      ,[p_okunryh] = case p_okunryh when ''9'' then ''-1'' else p_okunryh end
      ,[p_ika] = case [p_ika]
	   when ''01'' then ''30655v30''
	   when ''02'' then ''19655v30''
	   when ''03'' then ''19655v35''
	   when ''04'' then ''19655v40''
	   when ''05'' then ''19655v45''
	   when ''06'' then ''19655v50''
	   when ''07'' then ''55''
	   when ''08'' then ''56''
	   when ''09'' then ''57''
	   when ''10'' then ''58''
	   when ''11'' then ''59''
	   when ''12'' then ''60''
	   when ''13'' then ''61''
	   when ''14'' then ''62''
	   when ''15'' then ''63''
	   when ''16'' then ''64''
	   when ''17'' then ''19655v65''
	   else ''-1''
	   end
	  ,[p_kelpu]
	  --,[p_kelp2] = null
	  ,[p_osa1] = null
	  ,[p_osa2] = case when p_tyos5=1 then 1 else null end
      ,[tietolahde]=''7_1_sopv_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_7_1_sopv_13]

  UNION ALL

  SELECT [tilv]
      ,[p_okieli]
      ,[p_oltyp]
      ,[p_tyos1]
      ,[p_tyos2]
      ,[p_tyos3]
      ,[p_tyos4]
      ,[p_tyos5]
	  ,[p_tyos] = case 
					when p_tyos1 = 1 then 1
					when p_tyos1 = 0 and p_tyos2 = 0 and p_tyos3 = 1 then 2
					when p_tyos1 = 0 and p_tyos2 = 1 and p_tyos3 = 0 then 3
					else -1
				  end
      ,[p_virka]
      ,[p_aste]
      ,[p_k1]
      ,[p_k2]
      ,[p_k3]
      ,[p_k4]
      ,[p_k5]
      ,[p_k6]
      ,[p_k7]
      ,[p_k8]
      ,[p_k9] = null
      ,[p_k10]
      ,[p_k11]
      ,[p_olaste] = right(''0''+p_olaste,2)
      ,[p_oluom]
      ,[p_aine108] = case 
						when p_aine108 = ''00'' then ''99'' 
						else right(''0''+p_aine108,2) 
					 end
      ,[p_sp]
      ,[p_maakunta] = case p_maakunta
						when ''99'' then ''-1'' 
						when ''20'' then ''01''
						else right(''0''+p_maakunta,2)
					  end
      ,[p_okunryh] = case p_okunryh when ''9'' then ''-1'' else p_okunryh end
      ,[p_ika]=case [p_ika]
	   when ''01'' then ''30655v30''
	   when ''02'' then ''19655v30''
	   when ''03'' then ''19655v35''
	   when ''04'' then ''19655v40''
	   when ''05'' then ''19655v45''
	   when ''06'' then ''19655v50''
	   when ''07'' then ''55''
	   when ''08'' then ''56''
	   when ''09'' then ''57''
	   when ''10'' then ''58''
	   when ''11'' then ''59''
	   when ''12'' then ''60''
	   when ''13'' then ''61''
	   when ''14'' then ''62''
	   when ''15'' then ''63''
	   when ''16'' then ''64''
	   when ''17'' then ''19655v65''
	   else ''-1''
	   end
	  ,[p_kelpu] 
	  --,[p_kelp2] = null
	  ,[p_osa1] = null
	  ,[p_osa2] = case when p_tyos5=1 then 1 else null end
	  ,[tietolahde]=''7_1_sopv_12''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_7_1_sopv_12]


) kaikkivuodet



























' 
GO
/****** Object:  View [dbo].[v_sa_7_10_Ammatillisen_koulutuksen_opettajat_kelpoisuus_koulutus]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_7_10_Ammatillisen_koulutuksen_opettajat_kelpoisuus_koulutus]'))
EXEC dbo.sp_executesql @statement = N'























CREATE VIEW [dbo].[v_sa_7_10_Ammatillisen_koulutuksen_opettajat_kelpoisuus_koulutus] AS

/*
Drop table [VipunenTK_DW].[dbo].[f_7_10_Ammatillisen_koulutuksen_opettajat_kelpoisuus_koulutus]
Select * into [VipunenTK_DW].[dbo].[f_7_10_Ammatillisen_koulutuksen_opettajat_kelpoisuus_koulutus] FROM [VipunenTK_SA].[dbo].[v_sa_7_10_Ammatillisen_koulutuksen_opettajat_kelpoisuus_koulutus]
Truncate table [VipunenTK_DW].[dbo].[f_7_10_Ammatillisen_koulutuksen_opettajat_kelpoisuus_koulutus]
Insert into [VipunenTK_DW].[dbo].[f_7_10_Ammatillisen_koulutuksen_opettajat_kelpoisuus_koulutus]
  Select * FROM [VipunenTK_SA].[dbo].[v_sa_7_10_Ammatillisen_koulutuksen_opettajat_kelpoisuus_koulutus]
*/

SELECT [tilv] = CAST(kaikkivuodet.tilv as nvarchar(4))
      ,[tilv_date] = Cast(kaikkivuodet.tilv+''0101'' as date)
	  ,[a_okieli] = Cast(kaikkivuodet.a_okieli as nvarchar(2))
	  ,[a_virka] = Cast(kaikkivuodet.a_virka as nvarchar(2))
      ,[a_aste] = Cast(kaikkivuodet.a_aste as nvarchar(2))
	  ,[a_tyos] = Cast(kaikkivuodet.a_tyos as nvarchar(2))
      ,[a_g16] = Cast(kaikkivuodet.a_g16 as nvarchar(2))
      ,[a_g17] = Cast(kaikkivuodet.a_g17 as nvarchar(2))
      ,[a_g18] = Cast(kaikkivuodet.a_g18 as nvarchar(2))
      ,[a_g19] = Cast(kaikkivuodet.a_g19 as nvarchar(2))
      ,[a_g20] = Cast(kaikkivuodet.a_g20 as nvarchar(2))
      ,[a_g21] = Cast(kaikkivuodet.a_g21 as nvarchar(2))
      ,[a_g22] = Cast(kaikkivuodet.a_g22 as nvarchar(2))
      ,[a_h6] = Cast(kaikkivuodet.a_h6 as nvarchar(2))
      ,[a_h7] = Cast(kaikkivuodet.a_h7 as nvarchar(2))
      ,[a_h8] = Cast(kaikkivuodet.a_h8 as nvarchar(2))
      ,[a_h9] = Cast(kaikkivuodet.a_h9 as nvarchar(2))
      ,[a_h10] = Cast(kaikkivuodet.a_h10 as nvarchar(2))
      ,[a_h11] = Cast(kaikkivuodet.a_h11 as nvarchar(2))
      ,[a_h1] = Cast(kaikkivuodet.a_h1 as nvarchar(2))
      ,[a_h2] = Cast(kaikkivuodet.a_h2 as nvarchar(2))
      ,[a_h3] = Cast(kaikkivuodet.a_h3 as nvarchar(2))
      ,[a_h4] = Cast(kaikkivuodet.a_h4 as nvarchar(2))
	  ,[a_h5] = Cast(kaikkivuodet.a_h4 as nvarchar(2))
	  ,[a_ala] = Cast(kaikkivuodet.a_ala108 as nvarchar(2))
      ,[a_aine] = Cast(kaikkivuodet.a_aine108 as nvarchar(3))
	  ,[a_ala2] = Cast(kaikkivuodet.a_ala208 as nvarchar(2))
      ,[a_aine2] = Cast(kaikkivuodet.a_aine208 as nvarchar(3))
	  ,[a_ala3] = Cast(kaikkivuodet.a_ala308 as nvarchar(2))
      ,[a_aine3] = Cast(kaikkivuodet.a_aine308 as nvarchar(3))
	  ,[a_sp] = Cast(kaikkivuodet.a_sp as nvarchar(3))
	  ,[a_ika] = Cast(kaikkivuodet.a_ika as nvarchar(10))
      --,[a_koulk] = Cast(kaikkivuodet.a_koulk as nvarchar(6))
      --,[a_oppil] = Cast(kaikkivuodet.a_oppil as nvarchar(2))
      --,[a_eioppilkm] = Cast(kaikkivuodet.a_eioppilkm as nvarchar(2))
      --,[a_oppilkm] = Cast(kaikkivuodet.a_oppilkm as nvarchar(2))
      --,[a_ykieli] = Cast(kaikkivuodet.a_ykieli as nvarchar(2))
      --,[a_ymkunta] = CAST(kaikkivuodet.a_ymkunta as varchar(2))
      ,[a_maakunta] = CAST(kaikkivuodet.a_maakunta as nvarchar(2))
	  ,[a_osa1] = CAST(kaikkivuodet.a_osa1 as nvarchar(2))
	  ,[a_osa2] = CAST(kaikkivuodet.a_osa2 as nvarchar(2))
      ,[tietolahde] = CAST(kaikkivuodet.tietolahde as nvarchar(20))
      ,[rivinumero] = CAST(kaikkivuodet.rivinumero as int)
  FROM (
  
  SELECT [tilv]
      ,[a_okieli]
	  ,[a_virka] = case a_virka when ''7'' then ''8'' when ''8'' then ''9'' when ''9'' then ''0'' else a_virka end --väliaikainen
      ,[a_aste] = case a_aste when ''13'' then ''14'' when ''14'' then ''13'' else a_aste end --väliaikainen
	  ,[a_tyos]
      ,[a_g16] = a_erit
      ,[a_g17] = null
      ,[a_g18] = case when a_valm2 = 1 then 1 else 0 end
      ,[a_g19] = case when a_valm2 = 2 then 1 else 0 end
      ,[a_g20] = null
      ,[a_g21] = null
      ,[a_g22] = null
      ,[a_h6] = a_k1
      ,[a_h7] = a_k2
      ,[a_h8] = a_k3
      ,[a_h9] = a_k4
      ,[a_h10] = a_kelp2
      ,[a_h11] = case a_kelp1 when 1 then 0 when 0 then 1 end
      ,[a_h1] = a_p1
      ,[a_h2] = a_p2
      ,[a_h3] = a_p3
      ,[a_h4] = null
	  ,[a_h5] = NULL
      ,[a_ala108] = a_ala1
      ,[a_aine108] = case a_aine1 when ''00'' then ''99'' else a_aine1 end
	  ,[a_ala208] = a_ala2
	  ,[a_aine208] = a_aine2
	  ,[a_ala308] = a_ala3
	  ,[a_aine308] = a_aine3
	  ,[a_sp]
	  ,[a_ika] = case [a_ika]
	   when ''01'' then ''30655v30''
	   when ''02'' then ''19655v30''
	   when ''03'' then ''19655v35''
	   when ''04'' then ''19655v40''
	   when ''05'' then ''19655v45''
	   when ''06'' then ''19655v50''
	   when ''07'' then ''55''
	   when ''08'' then ''56''
	   when ''09'' then ''57''
	   when ''10'' then ''58''
	   when ''11'' then ''59''
	   when ''12'' then ''60''
	   when ''13'' then ''61''
	   when ''14'' then ''62''
	   when ''15'' then ''63''
	   when ''16'' then ''64''
	   when ''17'' then ''19655v65''
	   else ''-1''
	   end
      --,[a_koulk]
      --,[a_oppil]
      --,[a_eioppilkm]
      --,[a_oppilkm]
      --,[a_ykieli]
      --,[a_ymkunta] = case a_ymkunta when ''99'' then ''-1'' when ''20'' then ''01'' else a_ymkunta end
      ,[a_maakunta] = case a_maakunta when ''99'' then ''-1'' when ''20'' then ''01'' else a_maakunta end
	  ,a_osa1
	  ,a_osa2
      ,[tietolahde]=''7_10_sopv_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_K7_10_sopv_16]

  UNION ALL
  
  SELECT [tilv]
      ,[a_okieli]
	  ,[a_virka]
      ,[a_aste]
	  ,[a_tyos] = case 
					when a_tyos1 = 1 then 1
					when a_tyos1 = 0 and a_tyos2 = 0 and a_tyos3 = 1 then 2
					when a_tyos1 = 0 and a_tyos2 = 1 and a_tyos3 = 0 then 3
					else -1
				  end
      ,[a_g16]
      ,[a_g17]
      ,[a_g18] = case when a_g18=1 or a_g20=1 or a_g21=1 or a_g22=1 then 1 else 0 end
      ,[a_g19]
      ,[a_g20]
      ,[a_g21]
      ,[a_g22]
      ,[a_h6]
      ,[a_h7]
      ,[a_h8]
      ,[a_h9]
      ,[a_h10]
      ,[a_h11]
      ,[a_h1]
      ,[a_h2]
      ,[a_h3]
      ,[a_h4]
	  ,[a_h5] = NULL
      ,[a_ala108]
      ,[a_aine108] = case a_aine108 when ''00'' then ''99'' else a_aine108 end
	  ,a_ala208
	  ,a_aine208
	  ,a_ala308
	  ,a_aine308
	  ,[a_sp]
	  ,[a_ika] = case [a_ika]
	   when ''01'' then ''30655v30''
	   when ''02'' then ''19655v30''
	   when ''03'' then ''19655v35''
	   when ''04'' then ''19655v40''
	   when ''05'' then ''19655v45''
	   when ''06'' then ''19655v50''
	   when ''07'' then ''55''
	   when ''08'' then ''56''
	   when ''09'' then ''57''
	   when ''10'' then ''58''
	   when ''11'' then ''59''
	   when ''12'' then ''60''
	   when ''13'' then ''61''
	   when ''14'' then ''62''
	   when ''15'' then ''63''
	   when ''16'' then ''64''
	   when ''17'' then ''19655v65''
	   else ''-1''
	   end
      --,[a_koulk]
      --,[a_oppil]
      --,[a_eioppilkm]
      --,[a_oppilkm]
      --,[a_ykieli]
      --,[a_ymkunta] = case a_ymkunta when ''99'' then ''-1'' when ''20'' then ''01'' else a_ymkunta end
      ,[a_maakunta] = case a_maakunta when ''99'' then ''-1'' when ''20'' then ''01'' else a_maakunta end
	  ,a_osa1 = null
	  ,a_osa2 = case when a_tyos5=1 then 1 else null end
      ,[tietolahde]=''7_10_sopv_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_K7_10_sopv_13]

  UNION ALL

  SELECT [tilv]
      ,[a_okieli]
	  ,[a_virka]
      ,[a_aste]
	  ,[a_tyos] = case 
					when a_tyos1 = 1 then 1
					when a_tyos1 = 0 and a_tyos2 = 0 and a_tyos3 = 1 then 2
					when a_tyos1 = 0 and a_tyos2 = 1 and a_tyos3 = 0 then 3
					else -1
				  end
      ,[a_g16]
      ,[a_g17]
      ,[a_g18] = case when a_g18=1 or a_g20=1 or a_g21=1 or a_g22=1 then 1 else 0 end
      ,[a_g19]
      ,[a_g20]
      ,[a_g21]
      ,[a_g22]
      ,[a_h6] = NULL
      ,[a_h7] = NULL
      ,[a_h8] = NULL
      ,[a_h9] = NULL
      ,[a_h10] = NULL
      ,[a_h11] = NULL
      ,[a_h1]
      ,[a_h2]
      ,[a_h3]
      ,[a_h4]
	  ,[a_h5]
      ,[a_ala108]
      ,[a_aine108] = case a_aine108 when ''00'' then ''99'' else a_aine108 end
	  ,a_ala208
	  ,a_aine208
	  ,a_ala308
	  ,a_aine308
	  ,[a_sp]
	  ,[a_ika]= case [a_ika]
	   when ''01'' then ''30655v30''
	   when ''02'' then ''19655v30''
	   when ''03'' then ''19655v35''
	   when ''04'' then ''19655v40''
	   when ''05'' then ''19655v45''
	   when ''06'' then ''19655v50''
	   when ''07'' then ''55''
	   when ''08'' then ''56''
	   when ''09'' then ''57''
	   when ''10'' then ''58''
	   when ''11'' then ''59''
	   when ''12'' then ''60''
	   when ''13'' then ''61''
	   when ''14'' then ''62''
	   when ''15'' then ''63''
	   when ''16'' then ''64''
	   when ''17'' then ''19655v65''
	   else ''-1''
	   end
      --,[a_koulk]
      --,[a_oppil] = NULL
      --,[a_koulk_jarj_eioppilkm]
      --,[a_koulk_jarj_oppilkm]
      --,[a_ykieli]
      --,[a_ymkunta] = case a_ymkunta when ''99'' then ''-1'' when ''20'' then ''01'' else a_ymkunta end
      ,[a_maakunta] = case a_maakunta when ''99'' then ''-1'' when ''20'' then ''01'' else a_maakunta end
	  ,a_osa1 = null
	  ,a_osa2 = case when a_tyos5=1 then 1 else null end
      ,[tietolahde]=''7_10_sopv_12''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_K7_10_sopv_12]


) kaikkivuodet
























' 
GO
/****** Object:  View [dbo].[v_sa_7_12_Vapaan_sivistystyön_opettajat_kelpoisuus_aine]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_7_12_Vapaan_sivistystyön_opettajat_kelpoisuus_aine]'))
EXEC dbo.sp_executesql @statement = N'























CREATE VIEW [dbo].[v_sa_7_12_Vapaan_sivistystyön_opettajat_kelpoisuus_aine] AS

/*
Drop table [VipunenTK_DW].[dbo].[f_7_12_Vapaan_sivistystyön_opettajat_kelpoisuus_aine]
Select * into [VipunenTK_DW].[dbo].[f_7_12_Vapaan_sivistystyön_opettajat_kelpoisuus_aine] FROM [VipunenTK_SA].[dbo].[v_sa_7_12_Vapaan_sivistystyön_opettajat_kelpoisuus_aine]
Truncate table [VipunenTK_DW].[dbo].[f_7_12_Vapaan_sivistystyön_opettajat_kelpoisuus_aine]
Insert into [VipunenTK_DW].[dbo].[f_7_12_Vapaan_sivistystyön_opettajat_kelpoisuus_aine]
Select *  FROM [VipunenTK_SA].[dbo].[v_sa_7_12_Vapaan_sivistystyön_opettajat_kelpoisuus_aine]
*/

SELECT [tilv] = CAST(kaikkivuodet.tilv as nvarchar(4))
      ,[tilv_date] = Cast(kaikkivuodet.tilv+''0101'' as date)
	  ,[v_okieli] = Cast(kaikkivuodet.v_okieli as nvarchar(4))
      ,[v_oltyp] = Cast(kaikkivuodet.v_oltyp as nvarchar(4))
      ,[v_tyos1] = Cast(kaikkivuodet.v_tyos1 as nvarchar(4))
      ,[v_tyos2] = Cast(kaikkivuodet.v_tyos2 as nvarchar(4))
      ,[v_tyos3] = Cast(kaikkivuodet.v_tyos3 as nvarchar(4))
      ,[v_tyos4] = Cast(kaikkivuodet.v_tyos4 as nvarchar(3))
      ,[v_tyos5] = Cast(kaikkivuodet.v_tyos5 as nvarchar(3))
	  ,[v_tyos] = Cast(kaikkivuodet.v_tyos as nvarchar(3))
      ,[v_virka] = Cast(kaikkivuodet.v_virka as nvarchar(3))
      ,[v_h1] = Cast(kaikkivuodet.v_h1 as nvarchar(3))
      ,[v_h2] = Cast(kaikkivuodet.v_h2 as nvarchar(3))
      ,[v_h3] = Cast(kaikkivuodet.v_h3 as nvarchar(3))
      ,[v_h4] = Cast(kaikkivuodet.v_h4 as nvarchar(3))
      ,[v_ala1] = Cast(kaikkivuodet.v_ala1 as nvarchar(3))
	  ,[v_aine1] = Cast(kaikkivuodet.v_aine1 as nvarchar(3)) 
      ,[v_sp] = Cast(kaikkivuodet.v_sp as nvarchar(2))
      ,[v_maakunta] = Cast(kaikkivuodet.v_maakunta as nvarchar(2))
	  ,[v_okunryh] =  Cast(kaikkivuodet.v_okunryh as nvarchar(2))
	  ,[v_ika] = Cast(kaikkivuodet.v_ika as nvarchar(10))
	  ,[v_osa1] = Cast(kaikkivuodet.v_osa1 as nvarchar(10))
	  ,[v_osa2] = Cast(kaikkivuodet.v_osa2 as nvarchar(10))
      ,[tietolahde] = CAST(kaikkivuodet.tietolahde as nvarchar(50))
      ,[rivinumero] = CAST(kaikkivuodet.rivinumero as int)
  FROM (
  
  SELECT [tilv]
      ,[v_okieli]
      ,[v_oltyp]
      ,NULL AS [v_tyos1]
      ,NULL AS [v_tyos2]
      ,NULL AS [v_tyos3]
      ,NULL AS [v_tyos4]
      ,NULL AS [v_tyos5]
	  ,v_tyos
      ,[v_virka]
      ,v_kelp1 AS [v_h1]
      ,[v_h2] = v_p2
      ,[v_h3] = v_p1
      ,NULL AS [v_h4]
      ,[v_ala1]
      ,[v_aine1]
      ,[v_sp]
      ,[v_maakunta]= case v_maakunta when ''99'' then ''-1'' else v_maakunta end
      ,[v_okunryh]
      ,[v_ika] = case [v_ika]
	   when ''01'' then ''30655v30''
	   when ''02'' then ''19655v30''
	   when ''03'' then ''19655v35''
	   when ''04'' then ''19655v40''
	   when ''05'' then ''19655v45''
	   when ''06'' then ''19655v50''
	   when ''07'' then ''55''
	   when ''08'' then ''56''
	   when ''09'' then ''57''
	   when ''10'' then ''58''
	   when ''11'' then ''59''
	   when ''12'' then ''60''
	   when ''13'' then ''61''
	   when ''14'' then ''62''
	   when ''15'' then ''63''
	   when ''16'' then ''64''
	   when ''17'' then ''19655v65''
	   else ''-1''
	   end
	   ,v_osa1
	   ,v_osa2
      ,[tietolahde]=''7_12_sopv_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_K7_12_sopv_16]

  UNION ALL
  
  SELECT [tilv]
      ,[v_okieli]
      ,[v_oltyp]
      ,[v_tyos1]
      ,[v_tyos2]
      ,[v_tyos3]
      ,[v_tyos4]
      ,[v_tyos5]
	  ,[v_tyos] = case 
					when v_tyos1 = 1 then 1
					when v_tyos1 = 0 and v_tyos2 = 0 and v_tyos3 = 1 then 2
					when v_tyos1 = 0 and v_tyos2 = 1 and v_tyos3 = 0 then 3
					else -1
				  end
      ,[v_virka]
      ,[v_h1]
      ,[v_h2]
      ,[v_h3]
      ,[v_h4]
      ,[v_ala1]
      ,[v_aine1]
      ,[v_sp]
      ,[v_maakunta]= case v_maakunta when ''99'' then ''-1'' else v_maakunta end
      ,[v_okunryh]
      ,[v_ika] = case [v_ika]
	   when ''01'' then ''30655v30''
	   when ''02'' then ''19655v30''
	   when ''03'' then ''19655v35''
	   when ''04'' then ''19655v40''
	   when ''05'' then ''19655v45''
	   when ''06'' then ''19655v50''
	   when ''07'' then ''55''
	   when ''08'' then ''56''
	   when ''09'' then ''57''
	   when ''10'' then ''58''
	   when ''11'' then ''59''
	   when ''12'' then ''60''
	   when ''13'' then ''61''
	   when ''14'' then ''62''
	   when ''15'' then ''63''
	   when ''16'' then ''64''
	   when ''17'' then ''19655v65''
	   else ''-1''
	   end
	   ,v_osa1 = null
	   ,v_osa2 = case when v_tyos5=1 then 1 else null end
      ,[tietolahde]=''7_12_sopv_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_K7_12_sopv_13]

  UNION ALL

  SELECT [tilv]
      ,[v_okieli]
      ,[v_oltyp]
      ,[v_tyos1]
      ,[v_tyos2]
      ,[v_tyos3]
      ,[v_tyos4]
      ,[v_tyos5]
	  ,[v_tyos] = case 
					when v_tyos1 = 1 then 1
					when v_tyos1 = 0 and v_tyos2 = 0 and v_tyos3 = 1 then 2
					when v_tyos1 = 0 and v_tyos2 = 1 and v_tyos3 = 0 then 3
					else -1
				  end
      ,[v_virka]
      ,[v_h1]
      ,[v_h2]
      ,[v_h3]
      ,[v_h4]
      ,[v_ala1]
      ,[v_aine1]
      ,[v_sp]
      ,[v_maakunta]= case v_maakunta when ''99'' then ''-1'' when ''20'' then ''01'' else v_maakunta end
      ,[v_okunryh]
      ,[v_ika] = case [v_ika]
	   when ''01'' then ''30655v30''
	   when ''02'' then ''19655v30''
	   when ''03'' then ''19655v35''
	   when ''04'' then ''19655v40''
	   when ''05'' then ''19655v45''
	   when ''06'' then ''19655v50''
	   when ''07'' then ''55''
	   when ''08'' then ''56''
	   when ''09'' then ''57''
	   when ''10'' then ''58''
	   when ''11'' then ''59''
	   when ''12'' then ''60''
	   when ''13'' then ''61''
	   when ''14'' then ''62''
	   when ''15'' then ''63''
	   when ''16'' then ''64''
	   when ''17'' then ''19655v65''
	   else ''-1''
	   end
	   ,v_osa1 = null
	   ,v_osa2 = case when v_tyos5=1 then 1 else null end
      ,[tietolahde]=''7_12_sopv_12''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_K7_12_sopv_12]


) kaikkivuodet
























' 
GO
/****** Object:  View [dbo].[v_sa_7_13_Vapaan_sivistystyön_opettajat_kelpoisuus_kouljarj]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_7_13_Vapaan_sivistystyön_opettajat_kelpoisuus_kouljarj]'))
EXEC dbo.sp_executesql @statement = N'


















CREATE VIEW [dbo].[v_sa_7_13_Vapaan_sivistystyön_opettajat_kelpoisuus_kouljarj] AS

/*
Drop table [VipunenTK_DW].[dbo].[f_7_13_Vapaan_sivistystyön_opettajat_kelpoisuus_kouljarj]
Select * into [VipunenTK_DW].[dbo].[f_7_13_Vapaan_sivistystyön_opettajat_kelpoisuus_kouljarj] FROM [VipunenTK_SA].[dbo].[v_sa_7_13_Vapaan_sivistystyön_opettajat_kelpoisuus_kouljarj]
Truncate table [VipunenTK_DW].[dbo].[f_7_13_Vapaan_sivistystyön_opettajat_kelpoisuus_kouljarj]
Insert into [VipunenTK_DW].[dbo].[f_7_13_Vapaan_sivistystyön_opettajat_kelpoisuus_kouljarj]
Select *  FROM [VipunenTK_SA].[dbo].[v_sa_7_13_Vapaan_sivistystyön_opettajat_kelpoisuus_kouljarj]
*/

SELECT [tilv] = CAST(kaikkivuodet.tilv as nvarchar(4))
      ,[tilv_date] = Cast(kaikkivuodet.tilv+''0101'' as date)
	  ,[v_okieli] = Cast(kaikkivuodet.v_okieli as nvarchar(4))
      ,[v_h1] = Cast(kaikkivuodet.v_h1 as nvarchar(4))
      ,[v_h2] = Cast(kaikkivuodet.v_h2 as nvarchar(4))
      ,[v_h3] = Cast(kaikkivuodet.v_h3 as nvarchar(4))
      ,[v_h4] = Cast(kaikkivuodet.v_h4 as nvarchar(4))
      ,[v_ykieli] = Cast(kaikkivuodet.v_ykieli as nvarchar(4))
      ,[v_yomist] = Cast(kaikkivuodet.v_yomist as nvarchar(4))
      ,[v_ymkunta] = Cast(kaikkivuodet.v_ymkunta as nvarchar(4))
      ,[v_ykunryh] = Cast(kaikkivuodet.v_ykunryh as nvarchar(4))
      ,[tietolahde] = CAST(kaikkivuodet.tietolahde as nvarchar(50))
      ,[rivinumero] = CAST(kaikkivuodet.rivinumero as int)
  FROM (
  
  SELECT [tilv]
      ,[v_okieli]
      ,NULL AS [v_h1]
      ,NULL AS [v_h2]
      ,NULL AS [v_h3]
      ,NULL AS [v_h4]
      ,[v_ykieli]
      ,[v_yomist]
      ,[v_ymkunta] = case v_ymkunta when ''99'' then ''-1'' else v_ymkunta end
      ,[v_ykunryh]
      ,[tietolahde]=''7_12_sopv_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_K7_13_sopv_16]

  UNION ALL
  
  SELECT [tilv]
      ,[v_okieli]
      ,[v_h1]
      ,[v_h2]
      ,[v_h3]
      ,[v_h4]
      ,[v_ykieli]
      ,[v_yomist]
      ,[v_ymkunta] = case v_ymkunta when ''99'' then ''-1'' else v_ymkunta end
      ,[v_ykunryh]
      ,[tietolahde]=''7_12_sopv_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_K7_13_sopv_13]

  UNION ALL

  SELECT [tilv]
      ,[v_okieli]
      ,[v_h1]
      ,[v_h2]
      ,[v_h3]
      ,[v_h4]
      ,[v_ykieli]
      ,[v_omist]
      ,[v_ymkunta] = case v_ymkunta when ''99'' then ''-1'' when ''20'' then ''01'' else v_ymkunta end
      ,[v_ykunryh]
      ,[tietolahde]=''7_12_sopv_12''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_K7_13_sopv_12]


) kaikkivuodet



















' 
GO
/****** Object:  View [dbo].[v_sa_7_2_Perusopetuksen_opettajat_koulutuksen_jarjestaja_opetusryhmakoot]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_7_2_Perusopetuksen_opettajat_koulutuksen_jarjestaja_opetusryhmakoot]'))
EXEC dbo.sp_executesql @statement = N'










CREATE VIEW [dbo].[v_sa_7_2_Perusopetuksen_opettajat_koulutuksen_jarjestaja_opetusryhmakoot] AS

/*
Drop table [VipunenTK_DW].[dbo].[f_7_2_Perusopetuksen_opettajat_koulutuksen_jarjestaja_opetusryhmakoot]
Select * into [VipunenTK_DW].[dbo].[f_7_2_Perusopetuksen_opettajat_koulutuksen_jarjestaja_opetusryhmakoot] FROM [VipunenTK_SA].[dbo].[v_sa_7_2_Perusopetuksen_opettajat_koulutuksen_jarjestaja_opetusryhmakoot]
Truncate table [VipunenTK_DW].[dbo].[f_7_2_Perusopetuksen_opettajat_koulutuksen_jarjestaja_opetusryhmakoot]
Insert into [VipunenTK_DW].[dbo].[f_7_2_Perusopetuksen_opettajat_koulutuksen_jarjestaja_opetusryhmakoot]
Select *  FROM [VipunenTK_SA].[dbo].[v_sa_7_2_Perusopetuksen_opettajat_koulutuksen_jarjestaja_opetusryhmakoot]
*/

SELECT [tilv] = CAST(kaikkivuodet.tilv as nvarchar(4))
      ,[tilv_date] = Cast(kaikkivuodet.tilv+''0101'' as date)
	  ,[p_okieli] = Cast(kaikkivuodet.p_okieli as nvarchar(2))
      ,[p_olaste] = Cast(kaikkivuodet.p_olaste as nvarchar(2))
      ,[p_oluom] = Cast(kaikkivuodet.p_oluom as int)
      ,[p_yopp19] = Cast(kaikkivuodet.p_yopp19 as nvarchar(2))
      ,[p_ykieli] = CAST(kaikkivuodet.p_ykieli as nvarchar(10))
	  ,[p_yomist] = CAST(kaikkivuodet.p_yomist as nvarchar(10)) 
      ,[p_ymkunta] = CAST(kaikkivuodet.p_ymkunta as varchar(2))
      ,[p_ykunryh] = CAST(kaikkivuodet.p_ykunryh as nvarchar(10))
      ,[tietolahde] = CAST(kaikkivuodet.tietolahde as nvarchar(50))
      ,[rivinumero] = CAST(kaikkivuodet.rivinumero as int)
  FROM (
  
  SELECT [tilv]
      ,[p_okieli]
      ,[p_olaste]
      ,[p_oluom]
      ,[p_yopp19]
      ,[p_ykieli]
      ,[p_yomist]
      ,[p_ymkunta] = case p_ymkunta when ''99'' then ''-1'' else p_ymkunta end
      ,[p_ykunryh] = case p_ykunryh when ''9'' then ''-1'' else p_ykunryh end
      ,[tietolahde]=''7_2_sopv_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_7_2_sopv_16]

  UNION ALL
  
  SELECT [tilv]
      ,[p_okieli]
      ,[p_olaste]
      ,[p_oluom]
      ,[p_yopp19]
      ,[p_ykieli]
      ,[p_yomist]
      ,[p_ymkunta] = case p_ymkunta when ''99'' then ''-1'' else p_ymkunta end
      ,[p_ykunryh] = case p_ykunryh when ''9'' then ''-1'' else p_ykunryh end
      ,[tietolahde]=''7_2_sopv_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_7_2_sopv_13]

  UNION ALL

  SELECT [tilv]
      ,[p_okieli]
      ,[p_olaste]
      ,[p_oluom]
      ,[p_yopp19]
      ,[p_ykieli]
      ,[p_yomist]
      ,[p_ymkunta] = case p_ymkunta when ''99'' then ''-1'' when ''20'' then ''01'' else p_ymkunta end
      ,[p_ykunryh] = case p_ykunryh when ''9'' then ''-1'' else p_ykunryh end
	  ,[tietolahde]=''7_2_sopv_12''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_7_2_sopv_12]


) kaikkivuodet











' 
GO
/****** Object:  View [dbo].[v_sa_7_3_Perusopetuksen_opettajat_osallistuminen_täydennyskoulutukseen]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_7_3_Perusopetuksen_opettajat_osallistuminen_täydennyskoulutukseen]'))
EXEC dbo.sp_executesql @statement = N'














CREATE VIEW [dbo].[v_sa_7_3_Perusopetuksen_opettajat_osallistuminen_täydennyskoulutukseen] AS

/*
Drop table [VipunenTK_DW].[dbo].[f_7_3_Perusopetuksen_opettajat_osallistuminen_taydennyskoulutukseen]
Select * into [VipunenTK_DW].[dbo].[f_7_3_Perusopetuksen_opettajat_osallistuminen_taydennyskoulutukseen] FROM [VipunenTK_SA].[dbo].[v_sa_7_3_Perusopetuksen_opettajat_osallistuminen_täydennyskoulutukseen]
Truncate table [VipunenTK_DW].[dbo].[f_7_3_Perusopetuksen_opettajat_osallistuminen_taydennyskoulutukseen]
Select * into [VipunenTK_DW].[dbo].[f_7_3_Perusopetuksen_opettajat_osallistuminen_taydennyskoulutukseen]
  FROM [VipunenTK_SA].[dbo].[v_sa_7_3_Perusopetuksen_opettajat_osallistuminen_täydennyskoulutukseen]
*/

SELECT [tilv] = CAST(kaikkivuodet.tilv as nvarchar(4))
      ,[tilv_date] = Cast(kaikkivuodet.tilv+''0101'' as date)
	  ,[p_okieli] = Cast(kaikkivuodet.p_okieli as nvarchar(2))
      ,[p_virka] = Cast(kaikkivuodet.p_virka as nvarchar(2))
      ,[p_taydjo] = Cast(kaikkivuodet.p_taydjo as nvarchar(2))
      ,[p_taydeit] = Cast(kaikkivuodet.p_taydeit as nvarchar(2))
      ,[p_eitayd] = Cast(kaikkivuodet.p_eitayd as nvarchar(2))
      ,[p_tutktyo] = Cast(kaikkivuodet.p_tutktyo as nvarchar(4))
      ,[p_tutkoma] = Cast(kaikkivuodet.p_tutkoma as nvarchar(4))
      ,[p_pattyo] = Cast(kaikkivuodet.p_pattyo as nvarchar(4))
      ,[p_patoma] = Cast(kaikkivuodet.p_patoma as nvarchar(4))
      ,[p_henktyo] = Cast(kaikkivuodet.p_henktyo as nvarchar(4))
      ,[p_henkoma] = Cast(kaikkivuodet.p_henkoma as nvarchar(4))
      ,[p_muutyo] = Cast(kaikkivuodet.p_muutyo as nvarchar(4))
      ,[p_muuoma] = Cast(kaikkivuodet.p_muuoma as nvarchar(4))
      ,[p_kanstyo] = Cast(kaikkivuodet.p_kanstyo as nvarchar(4))
      ,[p_kansoma] = Cast(kaikkivuodet.p_kansoma as nvarchar(4))
      ,[p_kehsuu] = Cast(kaikkivuodet.p_kehsuu as nvarchar(2))
      ,[p_sp] = Cast(kaikkivuodet.p_sp as nvarchar(2))
      ,[p_maakunta]  = Cast(kaikkivuodet.p_maakunta as nvarchar(3))
      ,[p_ika] = Cast(kaikkivuodet.p_ika as nvarchar(10))
	  ,[p_mento1] = Cast(kaikkivuodet.p_mento1 as nvarchar(2))
	  ,[p_mento2] = Cast(kaikkivuodet.p_mento2 as nvarchar(2))
	  ,[p_mento3] = Cast(kaikkivuodet.p_mento3 as nvarchar(2))
	  ,[p_mento4] = Cast(kaikkivuodet.p_mento4 as nvarchar(2))
	  ,[p_tyonoh1] = Cast(kaikkivuodet.p_tyonoh1 as nvarchar(2))
	  ,[p_tyonoh2] = Cast(kaikkivuodet.p_tyonoh2 as nvarchar(2))
	  ,[p_tyonoh3] = Cast(kaikkivuodet.p_tyonoh3 as nvarchar(2))
      ,[tietolahde] = CAST(kaikkivuodet.tietolahde as nvarchar(50))
      ,[rivinumero] = CAST(kaikkivuodet.rivinumero as int)
  FROM (
  
  SELECT [tilv]
      ,[p_okieli]
      ,[p_virka]
      ,[p_taydjo] = null
      ,[p_taydeit] = null
      ,[p_eitayd] = case p_tayd when 1 then 0 when 0 then 1 else -1 end
      ,[p_tutktyo]
      ,[p_tutkoma]
      ,[p_pattyo]
      ,[p_patoma]
      ,[p_henktyo]
      ,[p_henkoma]
      ,[p_muutyo]
      ,[p_muuoma]
      ,[p_kanstyo]
      ,[p_kansoma]
      ,[p_kehsuu]
      ,[p_sp]
      ,[p_maakunta] = case p_maakunta when ''99'' then ''-1'' else p_maakunta end
      ,[p_ika] = case [p_ika]
	   when ''01'' then ''30655v30''
	   when ''02'' then ''19655v30''
	   when ''03'' then ''19655v35''
	   when ''04'' then ''19655v40''
	   when ''05'' then ''19655v45''
	   when ''06'' then ''19655v50''
	   when ''07'' then ''55''
	   when ''08'' then ''56''
	   when ''09'' then ''57''
	   when ''10'' then ''58''
	   when ''11'' then ''59''
	   when ''12'' then ''60''
	   when ''13'' then ''61''
	   when ''14'' then ''62''
	   when ''15'' then ''63''
	   when ''16'' then ''64''
	   when ''17'' then ''19655v65''
	   else ''-1''
	   end
	  ,p_mento1
	  ,p_mento2
	  ,p_mento3
	  ,p_mento4
	  ,p_tyonoh1
	  ,p_tyonoh2
	  ,p_tyonoh3
      ,[tietolahde]=''7_3_sopv_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_7_3_sopv_16]

  UNION ALL
  
  SELECT [tilv]
      ,[p_okieli]
      ,[p_virka]
      ,[p_taydjo]
      ,[p_taydeit]
      ,[p_eitayd]
      ,[p_tutktyo]
      ,[p_tutkoma]
      ,[p_pattyo]
      ,[p_patoma]
      ,[p_henktyo]
      ,[p_henkoma]
      ,[p_muutyo]
      ,[p_muuoma]
      ,[p_kanstyo]
      ,[p_kansoma]
      ,[p_kehsuu]
      ,[p_sp]
      ,[p_maakunta] = case p_maakunta when ''99'' then ''-1'' else p_maakunta end
      ,[p_ika] = case [p_ika]
	   when ''01'' then ''30655v30''
	   when ''02'' then ''19655v30''
	   when ''03'' then ''19655v35''
	   when ''04'' then ''19655v40''
	   when ''05'' then ''19655v45''
	   when ''06'' then ''19655v50''
	   when ''07'' then ''55''
	   when ''08'' then ''56''
	   when ''09'' then ''57''
	   when ''10'' then ''58''
	   when ''11'' then ''59''
	   when ''12'' then ''60''
	   when ''13'' then ''61''
	   when ''14'' then ''62''
	   when ''15'' then ''63''
	   when ''16'' then ''64''
	   when ''17'' then ''19655v65''
	   else ''-1''
	   end
	  ,p_mento1 = null
	  ,p_mento2 = null
	  ,p_mento3 = null
	  ,p_mento4 = null
	  ,p_tyonoh1 = null
	  ,p_tyonoh2 = null
	  ,p_tyonoh3 = null
      ,[tietolahde]=''7_3_sopv_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_7_3_sopv_13]

  UNION ALL

  SELECT [tilv]
      ,[p_okieli]
      ,[p_virka]
      ,[p_taydjo]
      ,[p_taydeit]
      ,[p_eitayd]
      ,[p_tutktyo]
      ,[p_tutkoma]
      ,[p_pattyo]
      ,[p_patoma]
      ,[p_henktyo]
      ,[p_henkoma]
      ,[p_muutyo]
      ,[p_muuoma]
      ,[p_kanstyo]
      ,[p_kansoma]
      ,[p_kehsuu]
      ,[p_sp]
      ,[p_maakunta] = case p_maakunta when ''99'' then ''-1'' when ''20'' then ''01'' else p_maakunta end
      ,[p_ika] = case [p_ika]
	   when ''01'' then ''30655v30''
	   when ''02'' then ''19655v30''
	   when ''03'' then ''19655v35''
	   when ''04'' then ''19655v40''
	   when ''05'' then ''19655v45''
	   when ''06'' then ''19655v50''
	   when ''07'' then ''55''
	   when ''08'' then ''56''
	   when ''09'' then ''57''
	   when ''10'' then ''58''
	   when ''11'' then ''59''
	   when ''12'' then ''60''
	   when ''13'' then ''61''
	   when ''14'' then ''62''
	   when ''15'' then ''63''
	   when ''16'' then ''64''
	   when ''17'' then ''19655v65''
	   else ''-1''
	   end
	  ,p_mento1 = null
	  ,p_mento2 = null
	  ,p_mento3 = null
	  ,p_mento4 = null
	  ,p_tyonoh1 = null
	  ,p_tyonoh2 = null
	  ,p_tyonoh3 = null
      ,[tietolahde]=''7_3_sopv_12''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_7_3_sopv_12]


) kaikkivuodet















' 
GO
/****** Object:  View [dbo].[v_sa_7_4_Lukiokoulutuksen_opettajat_kelpoisuus_aine]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_7_4_Lukiokoulutuksen_opettajat_kelpoisuus_aine]'))
EXEC dbo.sp_executesql @statement = N'







CREATE VIEW [dbo].[v_sa_7_4_Lukiokoulutuksen_opettajat_kelpoisuus_aine] AS

/*
Drop table [VipunenTK_DW].[dbo].[f_7_4_Lukiokoulutuksen_opettajat_kelpoisuus_aine]
Select * into [VipunenTK_DW].[dbo].[f_7_4_Lukiokoulutuksen_opettajat_kelpoisuus_aine] FROM [VipunenTK_SA].[dbo].[v_sa_7_4_Lukiokoulutuksen_opettajat_kelpoisuus_aine]
Truncate table [VipunenTK_DW].[dbo].[f_7_4_Lukiokoulutuksen_opettajat_kelpoisuus_aine]
Insert into [VipunenTK_DW].[dbo].[f_7_4_Lukiokoulutuksen_opettajat_kelpoisuus_aine]
  Select * FROM [VipunenTK_SA].[dbo].[v_sa_7_4_Lukiokoulutuksen_opettajat_kelpoisuus_aine]
*/

SELECT [tilv] = CAST(kaikkivuodet.tilv as nvarchar(4))
      ,[tilv_date] = Cast(kaikkivuodet.tilv+''0101'' as date)
	  ,[l_okieli] = Cast(kaikkivuodet.l_okieli as nvarchar(2))
      ,[l_tyos1] = Cast(kaikkivuodet.l_tyos1 as nvarchar(2))
      ,[l_tyos2] = Cast(kaikkivuodet.l_tyos2 as nvarchar(2))
      ,[l_tyos3] = Cast(kaikkivuodet.l_tyos3 as nvarchar(2))
	  ,[l_tyos4] = Cast(kaikkivuodet.l_tyos4 as nvarchar(2))
      ,[l_tyos5] = Cast(kaikkivuodet.l_tyos5 as nvarchar(2))
	  ,[l_tyos] = Cast(kaikkivuodet.l_tyos as nvarchar(2))
      ,[l_virka] = Cast(kaikkivuodet.l_virka as nvarchar(2))
      ,[l_aste] = Cast(kaikkivuodet.l_aste as nvarchar(2))
      ,[l_k1] = Cast(kaikkivuodet.l_k1 as nvarchar(2))
      ,[l_k2] = Cast(kaikkivuodet.l_k2 as nvarchar(2))
      ,[l_k3] = Cast(kaikkivuodet.l_k3 as nvarchar(2))
      ,[l_k4] = Cast(kaikkivuodet.l_k4 as nvarchar(2))
      ,[l_k5] = Cast(kaikkivuodet.l_k5 as nvarchar(2))
      ,[l_k6] = Cast(kaikkivuodet.l_k6 as nvarchar(2))
      ,[l_k7] = Cast(kaikkivuodet.l_k7 as nvarchar(2))
      ,[l_k8] = Cast(kaikkivuodet.l_k8 as nvarchar(2))
      ,[l_k9] = Cast(kaikkivuodet.l_k9 as nvarchar(2))
      ,[l_k10] = Cast(kaikkivuodet.l_k10 as nvarchar(2))
      ,[l_k11] = Cast(kaikkivuodet.l_k11 as nvarchar(2))
      ,[l_aine] = Cast(kaikkivuodet.l_aine108 as nvarchar(2))
      ,[l_sp] = CAST(kaikkivuodet.l_sp as nvarchar(10))
      ,[l_maakunta] = CAST(kaikkivuodet.l_maakunta as varchar(2))
      ,[l_okunryh] = CAST(kaikkivuodet.l_okunryh as nvarchar(10))
      ,[l_ika] = CAST(kaikkivuodet.l_ika as nvarchar(10))
	  ,[l_kelpu] = CAST(kaikkivuodet.l_kelpu as nvarchar(10))
	  --,[l_kelp2] = CAST(kaikkivuodet.l_kelp2 as nvarchar(10))
	  ,[l_osa1] = CAST(kaikkivuodet.l_osa1 as nvarchar(10))
	  ,[l_osa2] = CAST(kaikkivuodet.l_osa2 as nvarchar(10))
      ,[tietolahde] = CAST(kaikkivuodet.tietolahde as nvarchar(50))
      ,[rivinumero] = CAST(kaikkivuodet.rivinumero as int)
  FROM (
  
  SELECT [tilv]
      ,[l_okieli]
      ,[l_tyos1] = NULL
      ,[l_tyos2] = NULL
      ,[l_tyos3] = NULL
	  ,[l_tyos4] = NULL
      ,[l_tyos5] = NULL
	  ,[l_tyos]
      ,[l_virka]
      ,[l_aste]
      ,[l_k1] = NULL
      ,[l_k2] = NULL
      ,[l_k3] = NULL
      ,[l_k4] = NULL
      ,[l_k5] = NULL
      ,[l_k6] = NULL
      ,[l_k7] = NULL
      ,[l_k8] = NULL
      ,[l_k9] = l_kelp2
      ,[l_k10] = NULL
      ,[l_k11] = NULL
      ,[l_aine108] = 
				case 
					when l_aine1 = ''00'' then ''99'' 
					else right(''0''+l_aine1,2)
				end
      ,[l_sp]
      ,[l_maakunta] = 
				case 
					when l_maakunta=''99'' then ''-1'' 
					else right(''0''+l_maakunta,2)
				end
      ,[l_okunryh] = case l_okunryh when ''9'' then ''-1'' else l_okunryh end
      ,[l_ika] = case [l_ika]
	   when ''01'' then ''30655v30''
	   when ''02'' then ''19655v30''
	   when ''03'' then ''19655v35''
	   when ''04'' then ''19655v40''
	   when ''05'' then ''19655v45''
	   when ''06'' then ''19655v50''
	   when ''07'' then ''55''
	   when ''08'' then ''56''
	   when ''09'' then ''57''
	   when ''10'' then ''58''
	   when ''11'' then ''59''
	   when ''12'' then ''60''
	   when ''13'' then ''61''
	   when ''14'' then ''62''
	   when ''15'' then ''63''
	   when ''16'' then ''64''
	   when ''17'' then ''19655v65''
	   else ''-1''
	   end
	  ,[l_kelpu] = l_kelp1
	  --,[l_kelp2]
	  ,l_osa1
	  ,l_osa2
      ,[tietolahde]=''7_4_sopv_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_7_4_sopv_16]

  UNION ALL
  
  SELECT [tilv]
      ,[l_okieli]
      ,[l_tyos1]
      ,[l_tyos2]
      ,[l_tyos3]
	  ,[l_tyos4] = NULL
      ,[l_tyos5]
	  ,[l_tyos] = case 
					when l_tyos1 = 1 then 1
					when l_tyos1 = 0 and l_tyos2 = 0 and l_tyos3 = 1 then 2
					when l_tyos1 = 0 and l_tyos2 = 1 and l_tyos3 = 0 then 3
					else -1
				  end
      ,[l_virka]
      ,[l_aste]
      ,[l_k1]
      ,[l_k2]
      ,[l_k3]
      ,[l_k4]
      ,[l_k5]
      ,[l_k6]
      ,[l_k7]
      ,[l_k8]
      ,[l_k9] = null
      ,[l_k10]
      ,[l_k11]
      ,[l_aine108] = case when l_aine108 = ''00'' then ''99'' 
					when left(l_aine108,1)<>0 and len(l_aine108)=1 then ''0''+l_aine108
					else l_aine108 end
      ,[l_sp]
      ,[l_maakunta] = 
				case 
					when l_maakunta=''99'' then ''-1'' 
					else right(''0''+l_maakunta,2)
				end
      ,[l_okunryh] = case l_okunryh when ''9'' then ''-1'' else l_okunryh end
      ,[l_ika] = case [l_ika]
	   when ''01'' then ''30655v30''
	   when ''02'' then ''19655v30''
	   when ''03'' then ''19655v35''
	   when ''04'' then ''19655v40''
	   when ''05'' then ''19655v45''
	   when ''06'' then ''19655v50''
	   when ''07'' then ''55''
	   when ''08'' then ''56''
	   when ''09'' then ''57''
	   when ''10'' then ''58''
	   when ''11'' then ''59''
	   when ''12'' then ''60''
	   when ''13'' then ''61''
	   when ''14'' then ''62''
	   when ''15'' then ''63''
	   when ''16'' then ''64''
	   when ''17'' then ''19655v65''
	   else ''-1''
	   end
	  ,[l_kelpu]
	  --,[l_kelp2] = null
	  ,l_osa1 = null
	  ,l_osa2 = case when l_tyos5=1 then 1 else null end
      ,[tietolahde]=''7_4_sopv_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_7_4_sopv_13]

  UNION ALL

  SELECT [tilv]
      ,[l_okieli]
      ,[l_tyos1]
      ,[l_tyos2]
      ,[l_tyos3]
      ,[l_tyos4]
      ,[l_tyos5]
	  ,[l_tyos] = case 
					when l_tyos1 = 1 then 1
					when l_tyos1 = 0 and l_tyos2 = 0 and l_tyos3 = 1 then 2
					when l_tyos1 = 0 and l_tyos2 = 1 and l_tyos3 = 0 then 3
					else -1
				  end
      ,[l_virka]
      ,[l_aste]
      ,[l_k1]
      ,[l_k2]
      ,[l_k3]
      ,[l_k4]
      ,[l_k5]
      ,[l_k6]
      ,[l_k7]
      ,[l_k8]
      ,[l_k9] = null
      ,[l_k10]
      ,[l_k11]
      ,[l_aine108] = case when l_aine108 = ''00'' then ''99'' 
					when left(l_aine108,1)<>0 and len(l_aine108)=1 then ''0''+l_aine108
					else l_aine108 end
      ,[l_sp]
      ,[l_maakunta] = 
				case l_maakunta
					when ''99'' then ''-1'' 
					when ''20'' then ''01''
					else right(''0''+l_maakunta,2)
				end
      ,[l_okunryh] = case l_okunryh when ''9'' then ''-1'' else l_okunryh end
      ,[l_ika]=case [l_ika]
	   when ''01'' then ''30655v30''
	   when ''02'' then ''19655v30''
	   when ''03'' then ''19655v35''
	   when ''04'' then ''19655v40''
	   when ''05'' then ''19655v45''
	   when ''06'' then ''19655v50''
	   when ''07'' then ''55''
	   when ''08'' then ''56''
	   when ''09'' then ''57''
	   when ''10'' then ''58''
	   when ''11'' then ''59''
	   when ''12'' then ''60''
	   when ''13'' then ''61''
	   when ''14'' then ''62''
	   when ''15'' then ''63''
	   when ''16'' then ''64''
	   when ''17'' then ''19655v65''
	   else ''-1''
	   end
	  ,[l_kelpu] 
	  --,[l_kelp2] = null
	  ,l_osa1 = null
	  ,l_osa2 = case when l_tyos5=1 then 1 else null end
	  ,[tietolahde]=''7_4_sopv_12''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_7_4_sopv_12]


) kaikkivuodet

























' 
GO
/****** Object:  View [dbo].[v_sa_7_5_Lukiokoulutuksen_opettajat_koulutuksen_jarjestaja]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_7_5_Lukiokoulutuksen_opettajat_koulutuksen_jarjestaja]'))
EXEC dbo.sp_executesql @statement = N'












CREATE VIEW [dbo].[v_sa_7_5_Lukiokoulutuksen_opettajat_koulutuksen_jarjestaja] AS

/*
Drop table [VipunenTK_DW].[dbo].[f_7_5_Lukiokoulutuksen_opettajat_koulutuksen_jarjestaja]
Select * into [VipunenTK_DW].[dbo].[f_7_5_Lukiokoulutuksen_opettajat_koulutuksen_jarjestaja] FROM [VipunenTK_SA].[dbo].[v_sa_7_5_Lukiokoulutuksen_opettajat_koulutuksen_jarjestaja]
Truncate table [VipunenTK_DW].[dbo].[f_7_5_Lukiokoulutuksen_opettajat_koulutuksen_jarjestaja]
Insert into [VipunenTK_DW].[dbo].[f_7_5_Lukiokoulutuksen_opettajat_koulutuksen_jarjestaja]
Select *  FROM [VipunenTK_SA].[dbo].[v_sa_7_5_Lukiokoulutuksen_opettajat_koulutuksen_jarjestaja]
*/

SELECT [tilv] = CAST(kaikkivuodet.tilv as nvarchar(4))
      ,[tilv_date] = Cast(kaikkivuodet.tilv+''0101'' as date)
	  ,[l_okieli] = Cast(kaikkivuodet.l_okieli as nvarchar(2))
      ,[l_yopp21_22] = Cast(kaikkivuodet.l_yopp21_22 as nvarchar(2))
      ,[l_ykieli] = CAST(kaikkivuodet.l_ykieli as nvarchar(10))
	  ,[l_yomist] = CAST(kaikkivuodet.l_yomist as nvarchar(10)) 
      ,[l_ymkunta] = CAST(kaikkivuodet.l_ymkunta as varchar(2))
      ,[l_ykunryh] = CAST(kaikkivuodet.l_ykunryh as nvarchar(10))
      ,[tietolahde] = CAST(kaikkivuodet.tietolahde as nvarchar(50))
      ,[rivinumero] = CAST(kaikkivuodet.rivinumero as int)
  FROM (
  
  SELECT [tilv]
      ,[l_okieli]
      ,[l_yopp21_22]
      ,[l_ykieli]
      ,[l_yomist]
      ,[l_ymkunta] = case l_ymkunta when ''99'' then ''-1'' else l_ymkunta end
      ,[l_ykunryh] = case l_ykunryh when ''9'' then ''-1'' else l_ykunryh end
      ,[tietolahde]=''7_5_sopv_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_7_5_sopv_16]

  UNION ALL
  
  SELECT [tilv]
      ,[l_okieli]
      ,[l_yopp21_22]
      ,[l_ykieli]
      ,[l_yomist]
      ,[l_ymkunta] = case l_ymkunta when ''99'' then ''-1'' else l_ymkunta end
      ,[l_ykunryh] = case l_ykunryh when ''9'' then ''-1'' else l_ykunryh end
      ,[tietolahde]=''7_5_sopv_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_7_5_sopv_13]

  UNION ALL

  SELECT [tilv]
      ,[l_okieli]
      ,[l_yopp21_22]
      ,[l_ykieli]
      ,[l_yomist]
      ,[l_ymkunta] = case l_ymkunta when ''99'' then ''-1'' when ''20'' then ''01'' else l_ymkunta end
      ,[l_ykunryh] = case l_ykunryh when ''9'' then ''-1'' else l_ykunryh end
	  ,[tietolahde]=''7_5_sopv_12''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_7_5_sopv_12]


) kaikkivuodet













' 
GO
/****** Object:  View [dbo].[v_sa_7_6_Lukiokoulutuksen_opettajat_osallistuminen_täydennyskoulutukseen]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_7_6_Lukiokoulutuksen_opettajat_osallistuminen_täydennyskoulutukseen]'))
EXEC dbo.sp_executesql @statement = N'














CREATE VIEW [dbo].[v_sa_7_6_Lukiokoulutuksen_opettajat_osallistuminen_täydennyskoulutukseen] AS

/*
Drop table [VipunenTK_DW].[dbo].[f_7_6_Lukiokoulutuksen_opettajat_osallistuminen_taydennyskoulutukseen]
Select * into [VipunenTK_DW].[dbo].[f_7_6_Lukiokoulutuksen_opettajat_osallistuminen_taydennyskoulutukseen] FROM [VipunenTK_SA].[dbo].[v_sa_7_6_Lukiokoulutuksen_opettajat_osallistuminen_täydennyskoulutukseen]
Truncate table [VipunenTK_DW].[dbo].[f_7_6_Lukiokoulutuksen_opettajat_osallistuminen_taydennyskoulutukseen]
Select * into [VipunenTK_DW].[dbo].[f_7_6_Lukiokoulutuksen_opettajat_osallistuminen_taydennyskoulutukseen]
  FROM [VipunenTK_SA].[dbo].[v_sa_7_6_Lukiokoulutuksen_opettajat_osallistuminen_täydennyskoulutukseen]
*/

SELECT [tilv] = CAST(kaikkivuodet.tilv as nvarchar(4))
      ,[tilv_date] = Cast(kaikkivuodet.tilv+''0101'' as date)
	  ,[l_okieli] = Cast(kaikkivuodet.l_okieli as nvarchar(2))
      ,[l_virka] = Cast(kaikkivuodet.l_virka as nvarchar(2))
      ,[l_taydjo] = Cast(kaikkivuodet.l_taydjo as nvarchar(2))
      ,[l_taydeit] = Cast(kaikkivuodet.l_taydeit as nvarchar(2))
      ,[l_eitayd] = Cast(kaikkivuodet.l_eitayd as nvarchar(2))
      ,[l_tutktyo] = Cast(kaikkivuodet.l_tutktyo as nvarchar(4))
      ,[l_tutkoma] = Cast(kaikkivuodet.l_tutkoma as nvarchar(4))
      ,[l_pattyo] = Cast(kaikkivuodet.l_pattyo as nvarchar(4))
      ,[l_patoma] = Cast(kaikkivuodet.l_patoma as nvarchar(4))
      ,[l_henktyo] = Cast(kaikkivuodet.l_henktyo as nvarchar(4))
      ,[l_henkoma] = Cast(kaikkivuodet.l_henkoma as nvarchar(4))
      ,[l_muutyo] = Cast(kaikkivuodet.l_muutyo as nvarchar(4))
      ,[l_muuoma] = Cast(kaikkivuodet.l_muuoma as nvarchar(4))
      ,[l_kanstyo] = Cast(kaikkivuodet.l_kanstyo as nvarchar(4))
      ,[l_kansoma] = Cast(kaikkivuodet.l_kansoma as nvarchar(4))
      ,[l_kehsuu] = Cast(kaikkivuodet.l_kehsuu as nvarchar(2))
      ,[l_sp] = Cast(kaikkivuodet.l_sp as nvarchar(2))
      ,[l_maakunta]  = Cast(kaikkivuodet.l_maakunta as nvarchar(3))
      ,[l_ika] = Cast(kaikkivuodet.l_ika as nvarchar(10))
	  ,[l_mento1] = Cast(kaikkivuodet.l_mento1 as nvarchar(2))
	  ,[l_mento2] = Cast(kaikkivuodet.l_mento2 as nvarchar(2))
	  ,[l_mento3] = Cast(kaikkivuodet.l_mento3 as nvarchar(2))
	  ,[l_mento4] = Cast(kaikkivuodet.l_mento4 as nvarchar(2))
	  ,[l_tyonoh1] = Cast(kaikkivuodet.l_tyonoh1 as nvarchar(2))
	  ,[l_tyonoh2] = Cast(kaikkivuodet.l_tyonoh2 as nvarchar(2))
	  ,[l_tyonoh3] = Cast(kaikkivuodet.l_tyonoh3 as nvarchar(2))
      ,[tietolahde] = CAST(kaikkivuodet.tietolahde as nvarchar(50))
      ,[rivinumero] = CAST(kaikkivuodet.rivinumero as int)
  FROM (
  
  SELECT [tilv]
      ,[l_okieli]
      ,[l_virka]
      ,[l_taydjo] = null
      ,[l_taydeit] = null
      ,[l_eitayd] = case l_tayd when 1 then 0 when 0 then 1 else -1 end
      ,[l_tutktyo]
      ,[l_tutkoma]
      ,[l_pattyo]
      ,[l_patoma]
      ,[l_henktyo]
      ,[l_henkoma]
      ,[l_muutyo]
      ,[l_muuoma]
      ,[l_kanstyo]
      ,[l_kansoma]
      ,[l_kehsuu]
      ,[l_sp]
      ,[l_maakunta] = case l_maakunta when ''99'' then ''-1'' else l_maakunta end
      ,[l_ika] = case [l_ika]
	   when ''01'' then ''30655v30''
	   when ''02'' then ''19655v30''
	   when ''03'' then ''19655v35''
	   when ''04'' then ''19655v40''
	   when ''05'' then ''19655v45''
	   when ''06'' then ''19655v50''
	   when ''07'' then ''55''
	   when ''08'' then ''56''
	   when ''09'' then ''57''
	   when ''10'' then ''58''
	   when ''11'' then ''59''
	   when ''12'' then ''60''
	   when ''13'' then ''61''
	   when ''14'' then ''62''
	   when ''15'' then ''63''
	   when ''16'' then ''64''
	   when ''17'' then ''19655v65''
	   else ''-1''
	   end
	  ,l_mento1
	  ,l_mento2
	  ,l_mento3
	  ,l_mento4
	  ,l_tyonoh1
	  ,l_tyonoh2
	  ,l_tyonoh3
      ,[tietolahde]=''7_6_sopv_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_7_6_sopv_16]

  UNION ALL
  
  SELECT [tilv]
      ,[l_okieli]
      ,[l_virka]
      ,[l_taydjo]
      ,[l_taydeit]
      ,[l_eitayd]
      ,[l_tutktyo]
      ,[l_tutkoma]
      ,[l_pattyo]
      ,[l_patoma]
      ,[l_henktyo]
      ,[l_henkoma]
      ,[l_muutyo]
      ,[l_muuoma]
      ,[l_kanstyo]
      ,[l_kansoma]
      ,[l_kehsuu]
      ,[l_sp]
      ,[l_maakunta] = case l_maakunta when ''99'' then ''-1'' else l_maakunta end
      ,[l_ika] = case [l_ika]
	   when ''01'' then ''30655v30''
	   when ''02'' then ''19655v30''
	   when ''03'' then ''19655v35''
	   when ''04'' then ''19655v40''
	   when ''05'' then ''19655v45''
	   when ''06'' then ''19655v50''
	   when ''07'' then ''55''
	   when ''08'' then ''56''
	   when ''09'' then ''57''
	   when ''10'' then ''58''
	   when ''11'' then ''59''
	   when ''12'' then ''60''
	   when ''13'' then ''61''
	   when ''14'' then ''62''
	   when ''15'' then ''63''
	   when ''16'' then ''64''
	   when ''17'' then ''19655v65''
	   else ''-1''
	   end
	  ,l_mento1 = null
	  ,l_mento2 = null
	  ,l_mento3 = null
	  ,l_mento4 = null
	  ,l_tyonoh1 = null
	  ,l_tyonoh2 = null
	  ,l_tyonoh3 = null
      ,[tietolahde]=''7_6_sopv_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_7_6_sopv_13]

  UNION ALL

  SELECT [tilv]
      ,[l_okieli]
      ,[l_virka]
      ,[l_taydjo]
      ,[l_taydeit]
      ,[l_eitayd]
      ,[l_tutktyo]
      ,[l_tutkoma]
      ,[l_pattyo]
      ,[l_patoma]
      ,[l_henktyo]
      ,[l_henkoma]
      ,[l_muutyo]
      ,[l_muuoma]
      ,[l_kanstyo]
      ,[l_kansoma]
      ,[l_kehsuu]
      ,[l_sp]
      ,[l_maakunta] = case l_maakunta when ''99'' then ''-1'' when ''20'' then ''01'' else l_maakunta end
      ,[l_ika] = case [l_ika]
	   when ''01'' then ''30655v30''
	   when ''02'' then ''19655v30''
	   when ''03'' then ''19655v35''
	   when ''04'' then ''19655v40''
	   when ''05'' then ''19655v45''
	   when ''06'' then ''19655v50''
	   when ''07'' then ''55''
	   when ''08'' then ''56''
	   when ''09'' then ''57''
	   when ''10'' then ''58''
	   when ''11'' then ''59''
	   when ''12'' then ''60''
	   when ''13'' then ''61''
	   when ''14'' then ''62''
	   when ''15'' then ''63''
	   when ''16'' then ''64''
	   when ''17'' then ''19655v65''
	   else ''-1''
	   end
	  ,l_mento1 = null
	  ,l_mento2 = null
	  ,l_mento3 = null
	  ,l_mento4 = null
	  ,l_tyonoh1 = null
	  ,l_tyonoh2 = null
	  ,l_tyonoh3 = null
      ,[tietolahde]=''7_6_sopv_12''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_7_6_sopv_12]


) kaikkivuodet















' 
GO
/****** Object:  View [dbo].[v_sa_7_7_Ammatillisen_koulutuksen_opettajat_kelpoisuus_koulutus]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_7_7_Ammatillisen_koulutuksen_opettajat_kelpoisuus_koulutus]'))
EXEC dbo.sp_executesql @statement = N'
























CREATE VIEW [dbo].[v_sa_7_7_Ammatillisen_koulutuksen_opettajat_kelpoisuus_koulutus] AS

/*
Drop table [VipunenTK_DW].[dbo].[f_7_7_Ammatillisen_koulutuksen_opettajat_kelpoisuus_koulutus]
Select * into [VipunenTK_DW].[dbo].[f_7_7_Ammatillisen_koulutuksen_opettajat_kelpoisuus_koulutus] FROM [VipunenTK_SA].[dbo].[v_sa_7_7_Ammatillisen_koulutuksen_opettajat_kelpoisuus_koulutus]
Truncate table [VipunenTK_DW].[dbo].[f_7_7_Ammatillisen_koulutuksen_opettajat_kelpoisuus_koulutus]
Insert into [VipunenTK_DW].[dbo].[f_7_7_Ammatillisen_koulutuksen_opettajat_kelpoisuus_koulutus]
  Select * FROM [VipunenTK_SA].[dbo].[v_sa_7_7_Ammatillisen_koulutuksen_opettajat_kelpoisuus_koulutus]
*/

SELECT [tilv] = CAST(kaikkivuodet.tilv as nvarchar(4))
      ,[tilv_date] = Cast(kaikkivuodet.tilv+''0101'' as date)
	  ,[a_okieli] = Cast(kaikkivuodet.a_okieli as nvarchar(2))

      ,[a_aste] = Cast(kaikkivuodet.a_aste as nvarchar(2))

      ,[a_g16] = Cast(kaikkivuodet.a_g16 as nvarchar(2))
      ,[a_g17] = Cast(kaikkivuodet.a_g17 as nvarchar(2))
      ,[a_g18] = Cast(kaikkivuodet.a_g18 as nvarchar(2))
      ,[a_g19] = Cast(kaikkivuodet.a_g19 as nvarchar(2))
      ,[a_g20] = Cast(kaikkivuodet.a_g20 as nvarchar(2))
      ,[a_g21] = Cast(kaikkivuodet.a_g21 as nvarchar(2))
      ,[a_g22] = Cast(kaikkivuodet.a_g22 as nvarchar(2))
      ,[a_h6] = Cast(kaikkivuodet.a_h6 as nvarchar(2))
      ,[a_h7] = Cast(kaikkivuodet.a_h7 as nvarchar(2))
      ,[a_h8] = Cast(kaikkivuodet.a_h8 as nvarchar(2))
      ,[a_h9] = Cast(kaikkivuodet.a_h9 as nvarchar(2))
      ,[a_h10] = Cast(kaikkivuodet.a_h10 as nvarchar(2))
      ,[a_h11] = Cast(kaikkivuodet.a_h11 as nvarchar(2))
      ,[a_h1] = Cast(kaikkivuodet.a_h1 as nvarchar(2))
      ,[a_h2] = Cast(kaikkivuodet.a_h2 as nvarchar(2))
      ,[a_h3] = Cast(kaikkivuodet.a_h3 as nvarchar(2))
      ,[a_h4] = Cast(kaikkivuodet.a_h4 as nvarchar(2))
	  ,[a_h5] = Cast(kaikkivuodet.a_h4 as nvarchar(2))
	  ,[a_ala] = Cast(kaikkivuodet.a_ala108 as nvarchar(2))
      ,[a_aine] = Cast(kaikkivuodet.a_aine108 as nvarchar(3))
	 
      ,[a_koulk] = Cast(kaikkivuodet.a_koulk as nvarchar(6))
      ,[a_oppil] = Cast(kaikkivuodet.a_oppil as nvarchar(2))
      ,[a_eioppilkm] = Cast(kaikkivuodet.a_eioppilkm as nvarchar(2))
      ,[a_oppilkm] = Cast(kaikkivuodet.a_oppilkm as nvarchar(2))
      ,[a_ykieli] = Cast(kaikkivuodet.a_ykieli as nvarchar(2))
      ,[a_ymkunta] = CAST(kaikkivuodet.a_ymkunta as varchar(2))
      ,[a_maakunta] = CAST(kaikkivuodet.a_maakunta as nvarchar(2))
	  
      ,[tietolahde] = CAST(kaikkivuodet.tietolahde as nvarchar(20))
      ,[rivinumero] = CAST(kaikkivuodet.rivinumero as int)
  FROM (
  
  SELECT [tilv]
      ,[a_okieli]
	  ,[a_aste] = case a_aste when ''13'' then ''14'' when ''14'' then ''13'' else a_aste end --väliaikainen
	  ,[a_g16] = a_erit
      ,[a_g17] = null
      ,[a_g18] = case when a_valm2 = 1 then 1 else 0 end
      ,[a_g19] = case when a_valm2 = 2 then 1 else 0 end
      ,[a_g20] = null
      ,[a_g21] = null
      ,[a_g22] = null
      ,[a_h6] = a_k1
      ,[a_h7] = a_k2
      ,[a_h8] = a_k3
      ,[a_h9] = a_k4
      ,[a_h10] = a_kelp2
      ,[a_h11] = case a_kelp1 when 1 then 0 when 0 then 1 end
      ,[a_h1] = a_p1
      ,[a_h2] = a_p2
      ,[a_h3] = a_p3
      ,[a_h4] = null
	  ,[a_h5] = NULL
      ,[a_ala108] = a_ala1
      ,[a_aine108] = case a_aine1 when ''00'' then ''99'' else a_aine1 end
	  ,[a_koulk]
      ,[a_oppil]
      ,[a_eioppilkm]
      ,[a_oppilkm]
      ,[a_ykieli]
      ,[a_ymkunta] = case a_ymkunta when ''99'' then ''-1'' when ''20'' then ''01'' else a_ymkunta end
      ,[a_maakunta] = case a_maakunta when ''99'' then ''-1'' when ''20'' then ''01'' else a_maakunta end
	  ,[tietolahde]=''7_7_sopv_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_7_7_sopv_16]

  UNION ALL
  
  SELECT [tilv]
      ,[a_okieli]
      ,[a_aste]
	  ,[a_g16]
      ,[a_g17]
      ,[a_g18] = case when a_g18=1 or a_g20=1 or a_g21=1 or a_g22=1 then 1 else 0 end
      ,[a_g19]
      ,[a_g20]
      ,[a_g21]
      ,[a_g22]
      ,[a_h6]
      ,[a_h7]
      ,[a_h8]
      ,[a_h9]
      ,[a_h10]
      ,[a_h11]
      ,[a_h1]
      ,[a_h2]
      ,[a_h3]
      ,[a_h4]
	  ,[a_h5] = NULL
      ,[a_ala108]
      ,[a_aine108] = case a_aine108 when ''00'' then ''99'' else a_aine108 end
	  ,[a_koulk]
      ,[a_oppil]
      ,[a_eioppilkm]
      ,[a_oppilkm]
      ,[a_ykieli]
      ,[a_ymkunta] = case a_ymkunta when ''99'' then ''-1'' when ''20'' then ''01'' else a_ymkunta end
      ,[a_maakunta] = case a_maakunta when ''99'' then ''-1'' when ''20'' then ''01'' else a_maakunta end
      ,[tietolahde]=''7_7_sopv_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_7_7_sopv_13]

  UNION ALL

  SELECT [tilv]
      ,[a_okieli]
	  ,[a_aste]
	  ,[a_g16]
      ,[a_g17]
      ,[a_g18] = case when a_g18=1 or a_g20=1 or a_g21=1 or a_g22=1 then 1 else 0 end
      ,[a_g19]
      ,[a_g20]
      ,[a_g21]
      ,[a_g22]
      ,[a_h6] = NULL
      ,[a_h7] = NULL
      ,[a_h8] = NULL
      ,[a_h9] = NULL
      ,[a_h10] = NULL
      ,[a_h11] = NULL
      ,[a_h1]
      ,[a_h2]
      ,[a_h3]
      ,[a_h4]
	  ,[a_h5]
      ,[a_ala108]
      ,[a_aine108] = case a_aine108 when ''00'' then ''99'' else a_aine108 end
	  
      ,[a_koulk]
      ,[a_oppil] = NULL
      ,[a_koulk_jarj_eioppilkm]
      ,[a_koulk_jarj_oppilkm]
      ,[a_ykieli]
      ,[a_ymkunta] = case a_ymkunta when ''99'' then ''-1'' when ''20'' then ''01'' else a_ymkunta end
      ,[a_maakunta] = case a_maakunta when ''99'' then ''-1'' when ''20'' then ''01'' else a_maakunta end
	  ,[tietolahde]=''7_7_sopv_12''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_7_7_sopv_12]


) kaikkivuodet

























' 
GO
/****** Object:  View [dbo].[v_sa_7_8_Ammatillisen_koulutuksen_opettajat_osallistuminen_täydennyskoulutukseen]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_7_8_Ammatillisen_koulutuksen_opettajat_osallistuminen_täydennyskoulutukseen]'))
EXEC dbo.sp_executesql @statement = N'

















CREATE VIEW [dbo].[v_sa_7_8_Ammatillisen_koulutuksen_opettajat_osallistuminen_täydennyskoulutukseen] AS

/*
Drop table [VipunenTK_DW].[dbo].[f_7_8_Ammatillisen_koulutuksen_opettajat_osallistuminen_täydennyskoulutukseen]
Select * into [VipunenTK_DW].[dbo].[f_7_8_Ammatillisen_koulutuksen_opettajat_osallistuminen_täydennyskoulutukseen] FROM [VipunenTK_SA].[dbo].[v_sa_7_8_Ammatillisen_koulutuksen_opettajat_osallistuminen_täydennyskoulutukseen]
Truncate table [VipunenTK_DW].[dbo].[f_7_8_Ammatillisen_koulutuksen_opettajat_osallistuminen_täydennyskoulutukseen]
Insert into [VipunenTK_DW].[dbo].[f_7_8_Ammatillisen_koulutuksen_opettajat_osallistuminen_täydennyskoulutukseen]
Select *  FROM [VipunenTK_SA].[dbo].[v_sa_7_8_Ammatillisen_koulutuksen_opettajat_osallistuminen_täydennyskoulutukseen]
*/

SELECT [tilv] = CAST(kaikkivuodet.tilv as nvarchar(4))
      ,[tilv_date] = Cast(kaikkivuodet.tilv+''0101'' as date)
	  ,[a_okieli] = Cast(kaikkivuodet.a_okieli as nvarchar(2))
      ,[a_virka] = Cast(kaikkivuodet.a_virka as nvarchar(2))
      ,[a_aste] = Cast(kaikkivuodet.a_aste as nvarchar(2))
      ,[a_ala108] = Cast(kaikkivuodet.a_ala108 as nvarchar(2))
      ,[a_taydjo] = Cast(kaikkivuodet.a_taydjo as nvarchar(2))
      ,[a_taydeit] = Cast(kaikkivuodet.a_taydeit as nvarchar(2))
      ,[a_eitayd] = Cast(kaikkivuodet.a_eitayd as nvarchar(2))
      ,[a_tutktyo] = Cast(kaikkivuodet.a_tutktyo as nvarchar(3))
      ,[a_tutkoma] = Cast(kaikkivuodet.a_tutkoma as nvarchar(3))
      ,[a_pattyo] = Cast(kaikkivuodet.a_pattyo as nvarchar(3))
      ,[a_patoma] = Cast(kaikkivuodet.a_patoma as nvarchar(3))
      ,[a_henktyo] = Cast(kaikkivuodet.a_henktyo as nvarchar(3))
      ,[a_henkoma] = Cast(kaikkivuodet.a_henkoma as nvarchar(3))
      ,[a_muutyo] = Cast(kaikkivuodet.a_muutyo as nvarchar(3))
      ,[a_muuoma] = Cast(kaikkivuodet.a_muuoma as nvarchar(3))
      ,[a_kanstyo] = Cast(kaikkivuodet.a_kanstyo as nvarchar(3))
      ,[a_kansoma] = Cast(kaikkivuodet.a_kansoma as nvarchar(3))
      ,[a_kehsuu] = Cast(kaikkivuodet.a_kehsuu as nvarchar(2))
      ,[tyojakp] = Cast(kaikkivuodet.tyojakp as nvarchar(3))
      ,[eityojak] = Cast(kaikkivuodet.eityojak as nvarchar(2))
      ,[tyojakeit] = Cast(kaikkivuodet.tyojakeit as nvarchar(2))
      ,[a_sp] = Cast(kaikkivuodet.a_sp as nvarchar(2))
      ,[a_maakunta] = Cast(kaikkivuodet.a_maakunta as nvarchar(2))
	  ,[a_ika] = Cast(kaikkivuodet.a_ika as nvarchar(10))
	  ,[a_mento1] = Cast(kaikkivuodet.a_mento1 as nvarchar(2))
	  ,[a_mento2] = Cast(kaikkivuodet.a_mento2 as nvarchar(2))
	  ,[a_mento3] = Cast(kaikkivuodet.a_mento3 as nvarchar(2))
	  ,[a_mento4] = Cast(kaikkivuodet.a_mento4 as nvarchar(2))
	  ,[a_tyonoh1] = Cast(kaikkivuodet.a_tyonoh1 as nvarchar(2))
	  ,[a_tyonoh2] = Cast(kaikkivuodet.a_tyonoh2 as nvarchar(2))
	  ,[a_tyonoh3] = Cast(kaikkivuodet.a_tyonoh3 as nvarchar(2))
	  ,a_tyojak = Cast(kaikkivuodet.a_tyojak as nvarchar(2))
	  ,a_tyojak1 = Cast(kaikkivuodet.a_tyojak1 as nvarchar(2))
	  ,a_tyojak2 = Cast(kaikkivuodet.a_tyojak2 as nvarchar(2))
	  ,a_tyojak3 = Cast(kaikkivuodet.a_tyojak3 as nvarchar(2))
	  ,a_tyojak4 = Cast(kaikkivuodet.a_tyojak4 as nvarchar(2))
	  ,a_tyopk = Cast(kaikkivuodet.a_tyopk as nvarchar(2))
	  ,a_tyopk1 = Cast(kaikkivuodet.a_tyopk1 as nvarchar(2))
	  ,a_tyopk2 = Cast(kaikkivuodet.a_tyopk2 as nvarchar(2))
	  ,a_tyopk3 = Cast(kaikkivuodet.a_tyopk3 as nvarchar(2))
	  ,a_tyopk4 = Cast(kaikkivuodet.a_tyopk4 as nvarchar(2))
      ,[tietolahde] = CAST(kaikkivuodet.tietolahde as nvarchar(50))
      ,[rivinumero] = CAST(kaikkivuodet.rivinumero as int)
  FROM (
  
  SELECT [tilv]
      ,[a_okieli]
      ,[a_virka] = case a_virka when ''7'' then ''8'' when ''8'' then ''9'' when ''9'' then ''0'' else a_virka end --väliaikainen
      ,[a_aste] = case a_aste when ''13'' then ''14'' when ''14'' then ''13'' else a_aste end --väliaikainen
      ,[a_ala108] = a_ala1
      ,[a_taydjo] = null
      ,[a_taydeit] = null
      ,[a_eitayd] = case a_tayd when 1 then 0 when 0 then 1 else -1 end
      ,[a_tutktyo]
      ,[a_tutkoma]
      ,[a_pattyo]
      ,[a_patoma]
      ,[a_henktyo]
      ,[a_henkoma]
      ,[a_muutyo]
      ,[a_muuoma]
      ,[a_kanstyo]
      ,[a_kansoma]
      ,[a_kehsuu]
      ,[tyojakp] = null
      ,[eityojak] = null
      ,[tyojakeit] = null
      ,[a_sp]
      ,[a_maakunta] = case a_maakunta when ''99'' then ''-1'' else a_maakunta end
      ,[a_ika] = case [a_ika]
	   when ''01'' then ''30655v30''
	   when ''02'' then ''19655v30''
	   when ''03'' then ''19655v35''
	   when ''04'' then ''19655v40''
	   when ''05'' then ''19655v45''
	   when ''06'' then ''19655v50''
	   when ''07'' then ''55''
	   when ''08'' then ''56''
	   when ''09'' then ''57''
	   when ''10'' then ''58''
	   when ''11'' then ''59''
	   when ''12'' then ''60''
	   when ''13'' then ''61''
	   when ''14'' then ''62''
	   when ''15'' then ''63''
	   when ''16'' then ''64''
	   when ''17'' then ''19655v65''
	   else ''-1''
	   end
	  ,a_mento1
	  ,a_mento2
	  ,a_mento3
	  ,a_mento4
	  ,a_tyonoh1
	  ,a_tyonoh2
	  ,a_tyonoh3
	  ,a_tyojak
	  ,a_tyojak1
	  ,a_tyojak2
	  ,a_tyojak3
	  ,a_tyojak4
	  ,a_tyopk
	  ,a_tyopk1
	  ,a_tyopk2
	  ,a_tyopk3
	  ,a_tyopk4
	  ,[tietolahde]=''7_8_sopv_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_7_8_sopv_16]

  UNION ALL
  
  SELECT [tilv]
      ,[a_okieli]
      ,[a_virka]
      ,[a_aste]
      ,[a_ala108]
      ,[a_taydjo]
      ,[a_taydeit]
      ,[a_eitayd]
      ,[a_tutktyo]
      ,[a_tutkoma]
      ,[a_pattyo]
      ,[a_patoma]
      ,[a_henktyo]
      ,[a_henkoma]
      ,[a_muutyo]
      ,[a_muuoma]
      ,[a_kanstyo]
      ,[a_kansoma]
      ,[a_kehsuu]
      ,[tyojakp]
      ,[eityojak]
      ,[tyojakeit]
      ,[a_sp]
      ,[a_maakunta] = case a_maakunta when ''99'' then ''-1'' else a_maakunta end
      ,[a_ika] = case [a_ika]
	   when ''01'' then ''30655v30''
	   when ''02'' then ''19655v30''
	   when ''03'' then ''19655v35''
	   when ''04'' then ''19655v40''
	   when ''05'' then ''19655v45''
	   when ''06'' then ''19655v50''
	   when ''07'' then ''55''
	   when ''08'' then ''56''
	   when ''09'' then ''57''
	   when ''10'' then ''58''
	   when ''11'' then ''59''
	   when ''12'' then ''60''
	   when ''13'' then ''61''
	   when ''14'' then ''62''
	   when ''15'' then ''63''
	   when ''16'' then ''64''
	   when ''17'' then ''19655v65''
	   else ''-1''
	   end
	  ,a_mento1 = null
	  ,a_mento2 = null
	  ,a_mento3 = null
	  ,a_mento4 = null
	  ,a_tyonoh1 = null
	  ,a_tyonoh2 = null
	  ,a_tyonoh3 = null
	  ,a_tyojak = null
	  ,a_tyojak1 = null
	  ,a_tyojak2 = null
	  ,a_tyojak3 = null
	  ,a_tyojak4 = null
	  ,a_tyopk = null
	  ,a_tyopk1 = null
	  ,a_tyopk2 = null
	  ,a_tyopk3 = null
	  ,a_tyopk4 = null
      ,[tietolahde]=''7_8_sopv_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_7_8_sopv_13]

  UNION ALL

  SELECT [tilv]
      ,[a_okieli]
      ,[a_virka]
      ,[a_aste]
      ,[a_ala108]
      ,[a_taydjo]
      ,[a_taydeit]
      ,[a_eitayd]
      ,[a_tutktyo]
      ,[a_tutkoma]
      ,[a_pattyo]
      ,[a_patoma]
      ,[a_henktyo]
      ,[a_henkoma]
      ,[a_muutyo]
      ,[a_muuoma]
      ,[a_kanstyo] = NULL
      ,[a_kansoma] = NULL
      ,[a_kehsuu]
      ,[tyojakp]
      ,[eityojak]
      ,[tyojakeit]
      ,[a_sp]
      ,[a_maakunta] = case a_maakunta when ''99'' then ''-1'' when ''20'' then ''01'' else a_maakunta end
      ,[a_ika] = case [a_ika]
	   when ''01'' then ''30655v30''
	   when ''02'' then ''19655v30''
	   when ''03'' then ''19655v35''
	   when ''04'' then ''19655v40''
	   when ''05'' then ''19655v45''
	   when ''06'' then ''19655v50''
	   when ''07'' then ''55''
	   when ''08'' then ''56''
	   when ''09'' then ''57''
	   when ''10'' then ''58''
	   when ''11'' then ''59''
	   when ''12'' then ''60''
	   when ''13'' then ''61''
	   when ''14'' then ''62''
	   when ''15'' then ''63''
	   when ''16'' then ''64''
	   when ''17'' then ''19655v65''
	   else ''-1''
	   end
	  ,a_mento1 = null
	  ,a_mento2 = null
	  ,a_mento3 = null
	  ,a_mento4 = null
	  ,a_tyonoh1 = null
	  ,a_tyonoh2 = null
	  ,a_tyonoh3 = null
	  ,a_tyojak = null
	  ,a_tyojak1 = null
	  ,a_tyojak2 = null
	  ,a_tyojak3 = null
	  ,a_tyojak4 = null
	  ,a_tyopk = null
	  ,a_tyopk1 = null
	  ,a_tyopk2 = null
	  ,a_tyopk3 = null
	  ,a_tyopk4 = null
	  ,[tietolahde]=''7_8_sopv_12''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_7_8_sopv_12]


) kaikkivuodet


















' 
GO
/****** Object:  View [dbo].[v_sa_7_9_Vapaan_sivistystyön_opettajat_osallistuminen_täydennyskoulutukseen]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_7_9_Vapaan_sivistystyön_opettajat_osallistuminen_täydennyskoulutukseen]'))
EXEC dbo.sp_executesql @statement = N'



















CREATE VIEW [dbo].[v_sa_7_9_Vapaan_sivistystyön_opettajat_osallistuminen_täydennyskoulutukseen] AS

/*
Drop table [VipunenTK_DW].[dbo].[f_7_9_Vapaan_sivistystyön_opettajat_osallistuminen_täydennyskoulutukseen]
Select * into [VipunenTK_DW].[dbo].[f_7_9_Vapaan_sivistystyön_opettajat_osallistuminen_täydennyskoulutukseen] FROM [VipunenTK_SA].[dbo].[v_sa_7_9_Vapaan_sivistystyön_opettajat_osallistuminen_täydennyskoulutukseen]
Truncate table [VipunenTK_DW].[dbo].[f_7_9_Vapaan_sivistystyön_opettajat_osallistuminen_täydennyskoulutukseen]
Insert into [VipunenTK_DW].[dbo].[f_7_9_Vapaan_sivistystyön_opettajat_osallistuminen_täydennyskoulutukseen]
Select *  FROM [VipunenTK_SA].[dbo].[v_sa_7_9_Vapaan_sivistystyön_opettajat_osallistuminen_täydennyskoulutukseen]
*/

SELECT [tilv] = CAST(kaikkivuodet.tilv as nvarchar(4))
      ,[tilv_date] = Cast(kaikkivuodet.tilv+''0101'' as date)
	  ,[v_okieli] = Cast(kaikkivuodet.v_okieli as nvarchar(4))
      ,[v_virka] = Cast(kaikkivuodet.v_virka as nvarchar(4))
      ,[v_taydjo] = Cast(kaikkivuodet.v_taydjo as nvarchar(4))
      ,[v_taydeit] = Cast(kaikkivuodet.v_taydeit as nvarchar(4))
      ,[v_eitayd] = Cast(kaikkivuodet.v_eitayd as nvarchar(4))
      ,[v_tutktyo] = Cast(kaikkivuodet.v_tutktyo as nvarchar(3))
      ,[v_tutkoma] = Cast(kaikkivuodet.v_tutkoma as nvarchar(3))
      ,[v_pattyo] = Cast(kaikkivuodet.v_pattyo as nvarchar(3))
      ,[v_patoma] = Cast(kaikkivuodet.v_patoma as nvarchar(3))
      ,[v_henktyo] = Cast(kaikkivuodet.v_henktyo as nvarchar(3))
      ,[v_henkoma] = Cast(kaikkivuodet.v_henkoma as nvarchar(3))
      ,[v_muutyo] = Cast(kaikkivuodet.v_muutyo as nvarchar(3))
      ,[v_muuoma] = Cast(kaikkivuodet.v_muuoma as nvarchar(3))
	  ,[v_kanstyo] = Cast(kaikkivuodet.v_kanstyo as nvarchar(3))
      ,[v_kansoma] = Cast(kaikkivuodet.v_kansoma as nvarchar(3))
	  ,[v_kehsuu] = Cast(kaikkivuodet.v_kehsuu as nvarchar(3)) 
      ,[v_sp] = Cast(kaikkivuodet.v_sp as nvarchar(2))
      ,[v_maakunta] = Cast(kaikkivuodet.v_maakunta as nvarchar(2))
	  ,[v_ika] = Cast(kaikkivuodet.v_ika as nvarchar(10))
	  ,[v_mento1] = Cast(kaikkivuodet.v_mento1 as nvarchar(2))
	  ,[v_mento2] = Cast(kaikkivuodet.v_mento2 as nvarchar(2))
	  ,[v_mento3] = Cast(kaikkivuodet.v_mento3 as nvarchar(2))
	  ,[v_mento4] = Cast(kaikkivuodet.v_mento4 as nvarchar(2))
	  ,[v_tyonoh1] = Cast(kaikkivuodet.v_tyonoh1 as nvarchar(2))
	  ,[v_tyonoh2] = Cast(kaikkivuodet.v_tyonoh2 as nvarchar(2))
	  ,[v_tyonoh3] = Cast(kaikkivuodet.v_tyonoh3 as nvarchar(2))
      ,[tietolahde] = CAST(kaikkivuodet.tietolahde as nvarchar(50))
      ,[rivinumero] = CAST(kaikkivuodet.rivinumero as int)
  FROM (
  
  SELECT [tilv]
      ,[v_okieli]
      ,[v_virka]
      ,NULL AS [v_taydjo]
      ,NULL AS [v_taydeit]
      ,case v_tayd when 1 then 0 when 0 then 1 end AS [v_eitayd]
      ,[v_tutktyo]
      ,[v_tutkoma]
      ,[v_pattyo]
      ,[v_patoma]
      ,[v_henktyo]
      ,[v_henkoma]
      ,[v_muutyo]
      ,[v_muuoma]
	  ,[v_kanstyo]
	  ,[v_kansoma]
	  ,[v_kehsuu]
      ,[v_sp]
      ,[v_maakunta] = case v_maakunta when ''99'' then ''-1'' else v_maakunta end
      ,[v_ika] = case [v_ika]
	   when ''01'' then ''30655v30''
	   when ''02'' then ''19655v30''
	   when ''03'' then ''19655v35''
	   when ''04'' then ''19655v40''
	   when ''05'' then ''19655v45''
	   when ''06'' then ''19655v50''
	   when ''07'' then ''55''
	   when ''08'' then ''56''
	   when ''09'' then ''57''
	   when ''10'' then ''58''
	   when ''11'' then ''59''
	   when ''12'' then ''60''
	   when ''13'' then ''61''
	   when ''14'' then ''62''
	   when ''15'' then ''63''
	   when ''16'' then ''64''
	   when ''17'' then ''19655v65''
	   else ''-1''
	   end
	  ,v_mento1
	  ,v_mento2
	  ,v_mento3
	  ,v_mento4
	  ,v_tyonoh1
	  ,v_tyonoh2
	  ,v_tyonoh3
      ,[tietolahde]=''7_9_sopv_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_7_9_sopv_16]

  UNION ALL
  
  SELECT [tilv]
      ,[v_okieli]
      ,[v_virka]
      ,[v_taydjo]
      ,[v_taydeit]
      ,[v_eitayd]
      ,[v_tutktyo]
      ,[v_tutkoma]
      ,[v_pattyo]
      ,[v_patoma]
      ,[v_henktyo]
      ,[v_henkoma]
      ,[v_muutyo]
      ,[v_muuoma]
	  ,[v_kanstyo]
	  ,[v_kansoma]
	  ,[v_kehsuu]
      ,[v_sp]
      ,[v_maakunta] = case v_maakunta when ''99'' then ''-1'' else v_maakunta end
      ,[v_ika] = case [v_ika]
	   when ''01'' then ''30655v30''
	   when ''02'' then ''19655v30''
	   when ''03'' then ''19655v35''
	   when ''04'' then ''19655v40''
	   when ''05'' then ''19655v45''
	   when ''06'' then ''19655v50''
	   when ''07'' then ''55''
	   when ''08'' then ''56''
	   when ''09'' then ''57''
	   when ''10'' then ''58''
	   when ''11'' then ''59''
	   when ''12'' then ''60''
	   when ''13'' then ''61''
	   when ''14'' then ''62''
	   when ''15'' then ''63''
	   when ''16'' then ''64''
	   when ''17'' then ''19655v65''
	   else ''-1''
	   end
	  ,v_mento1 = null
	  ,v_mento2 = null
	  ,v_mento3 = null
	  ,v_mento4 = null
	  ,v_tyonoh1 = null
	  ,v_tyonoh2 = null
	  ,v_tyonoh3 = null
      ,[tietolahde]=''7_9_sopv_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_7_9_sopv_13]

  UNION ALL

  SELECT [tilv]
      ,[v_okieli]
      ,[v_virka]
      ,[v_taydjo]
      ,[v_taydeit]
      ,[v_eitayd]
      ,[v_tutktyo]
      ,[v_tutkoma]
      ,[v_pattyo]
      ,[v_patoma]
      ,[v_henktyo]
      ,[v_henkoma]
      ,[v_muutyo]
      ,[v_muuoma]
	  ,[v_kanstyo] = NULL
	  ,[v_kansoma] = NULL
	  ,[v_kehsuu]
      ,[v_sp]
      ,[v_maakunta] = case v_maakunta when ''99'' then ''-1'' else v_maakunta end
      ,[v_ika] = case [v_ika]
	   when ''01'' then ''30655v30''
	   when ''02'' then ''19655v30''
	   when ''03'' then ''19655v35''
	   when ''04'' then ''19655v40''
	   when ''05'' then ''19655v45''
	   when ''06'' then ''19655v50''
	   when ''07'' then ''55''
	   when ''08'' then ''56''
	   when ''09'' then ''57''
	   when ''10'' then ''58''
	   when ''11'' then ''59''
	   when ''12'' then ''60''
	   when ''13'' then ''61''
	   when ''14'' then ''62''
	   when ''15'' then ''63''
	   when ''16'' then ''64''
	   when ''17'' then ''19655v65''
	   else ''-1''
	   end
	  ,v_mento1 = null
	  ,v_mento2 = null
	  ,v_mento3 = null
	  ,v_mento4 = null
	  ,v_tyonoh1 = null
	  ,v_tyonoh2 = null
	  ,v_tyonoh3 = null
	  ,[tietolahde]=''7_9_sopv_12''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_7_9_sopv_12]


) kaikkivuodet




















' 
GO
/****** Object:  View [dbo].[v_sa_K2_17a_Ulkomaalaistaustaiset_opisk_ja_tutk]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_K2_17a_Ulkomaalaistaustaiset_opisk_ja_tutk]'))
EXEC dbo.sp_executesql @statement = N'













/****** Script for SelectTopNRows command from SSMS  ******/
CREATE VIEW [dbo].[v_sa_K2_17a_Ulkomaalaistaustaiset_opisk_ja_tutk] AS

/** HUOM! ophal-muuttuja ei toimi tilastovuosille 2009-2012, ohjattu tuntemattomaksi niiden osalta. Sen jälkeen ohjataan vain arvo 9 tuntemattomaksi **/

SELECT [tilv]
      ,[sp]
      ,[syntv]
      ,[tilvaskun]  =
			CASE
				WHEN len(tilvaskun) = 2 THEN ''0'' + tilvaskun
				WHEN len(tilvaskun) = 1 THEN ''00'' + tilvaskun
				ELSE tilvaskun
			END
      ,[tilvaskunsama]
      ,[oleskelux]
      ,[muuttov] = nullif(muuttov,'''')
      ,[aikielir4]
      ,[kansalr3] = Right(''000''+[kansalr3],3)
      ,[svaltr3] = Right(''000''+[svaltr3],3)
      ,[svaltr3_aiti] = Right(''000''+[svaltr3_aiti],3)
      ,[svaltr3_isa] = Right(''000''+[svaltr3_isa],3)
      ,[htok]
      ,[klajir1]
      ,[ophal] = ''-1''
      ,[opmopa] =
			CASE
				WHEN len(opmopa) = 2 THEN ''0'' + opmopa
				WHEN len(opmopa) = 1 THEN ''00'' + opmopa
				ELSE opmopa
			END

      ,[kkieli]
      ,[kkun] =
			CASE
				WHEN len(kkun) = 2 THEN ''0'' + kkun
				WHEN len(kkun) = 1 THEN ''00'' + kkun
				ELSE kkun
			END

      ,[alvv]
      ,[olosyys]
      ,[maassaolo]
      ,[osatutk]
      ,uusi = NULLIF([uusi], 0)
      ,opisk = NULLIF([opisk], 0)
      ,tutk = NULLIF([tutk], 0)

  FROM [TK_H9098_CSC].[dbo].[TK_K2_17a_sopv_11]
  
UNION ALL

SELECT [tilv]
      ,[sp]
      ,[syntv]
      ,[tilvaskun]  =
			CASE
				WHEN len(tilvaskun) = 2 THEN ''0'' + tilvaskun
				WHEN len(tilvaskun) = 1 THEN ''00'' + tilvaskun
				ELSE tilvaskun
			END
      ,[tilvaskunsama]
      ,[oleskelux]
      ,[muuttov] = nullif(muuttov,'''')
      ,[aikielir4]
      ,[kansalr3] = Right(''000''+[kansalr3],3)
      ,[svaltr3] = Right(''000''+[svaltr3],3)
      ,[svaltr3_aiti] = Right(''000''+[svaltr3_aiti],3)
      ,[svaltr3_isa] = Right(''000''+[svaltr3_isa],3)
      ,[htok]
      ,[klajir1]
      ,[ophal] = ''-1''
      ,[opmopa] =
			CASE
				WHEN len(opmopa) = 2 THEN ''0'' + opmopa
				WHEN len(opmopa) = 1 THEN ''00'' + opmopa
				ELSE opmopa
			END

	  ,[kkieli]
      ,[kkun] =
			CASE
				WHEN len(kkun) = 2 THEN ''0'' + kkun
				WHEN len(kkun) = 1 THEN ''00'' + kkun
				ELSE kkun
			END

      ,[alvv]
      ,[olosyys]
      ,[maassaolo]
      ,[osatutk]
      ,uusi = NULLIF([uusi], 0)
      ,opisk = NULLIF([opisk], 0)
      ,tutk = NULLIF([tutk], 0)

  FROM [TK_H9098_CSC].[dbo].[TK_K2_17a_sopv_12]  
  
UNION ALL

SELECT [tilv]
      ,[sp]
      ,[syntv]
      ,[tilvaskun]  =
			CASE
				WHEN len(tilvaskun) = 2 THEN ''0'' + tilvaskun
				WHEN len(tilvaskun) = 1 THEN ''00'' + tilvaskun
				ELSE tilvaskun
			END
      ,[tilvaskunsama]
      ,[oleskelux]
      ,[muuttov] = nullif(muuttov,'''')      
      ,[aikielir4]
      ,[kansalr3] = Right(''000''+[kansalr3],3)
      ,[svaltr3] = Right(''000''+[svaltr3],3)
      ,[svaltr3_aiti] = Right(''000''+[svaltr3_aiti],3)
      ,[svaltr3_isa] = Right(''000''+[svaltr3_isa],3)
      ,[htok]
      ,[klajir1]
      ,[ophal] = ''-1''
      ,[opmopa] =
			CASE
				WHEN len(opmopa) = 2 THEN ''0'' + opmopa
				WHEN len(opmopa) = 1 THEN ''00'' + opmopa
				ELSE opmopa
			END

      ,[kkieli]
      ,[kkun] =
			CASE
				WHEN len(kkun) = 2 THEN ''0'' + kkun
				WHEN len(kkun) = 1 THEN ''00'' + kkun
				ELSE kkun
			END

      ,[alvv]
      ,[olosyys]
      ,[maassaolo]
      ,[osatutk]
      ,uusi = NULLIF([uusi], 0)
      ,opisk = NULLIF([opisk], 0)
      ,tutk = NULLIF([tutk], 0)
      
  FROM [TK_H9098_CSC].[dbo].[TK_K2_17a_sopv_13]  
  
UNION ALL  

SELECT [tilv]
      ,[sp]
      ,[syntv]
      ,[tilvaskun]  =
			CASE
				WHEN len(tilvaskun) = 2 THEN ''0'' + tilvaskun
				WHEN len(tilvaskun) = 1 THEN ''00'' + tilvaskun
				ELSE tilvaskun
			END
      ,[tilvaskunsama]
      ,[oleskelux]
      ,[muuttov] = nullif(muuttov,'''')
      ,[aikielir4]
      ,[kansalr3] = Right(''000''+[kansalr3],3)
      ,[svaltr3] = Right(''000''+[svaltr3],3)
      ,[svaltr3_aiti] = Right(''000''+[svaltr3_aiti],3)
      ,[svaltr3_isa] = Right(''000''+[svaltr3_isa],3)
      ,[htok]
      ,[klajir1]
      ,[ophal] = ''-1''
      ,[opmopa] =
			CASE
				WHEN len(opmopa) = 2 THEN ''0'' + opmopa
				WHEN len(opmopa) = 1 THEN ''00'' + opmopa
				ELSE opmopa
			END

      ,[kkieli]
      ,[kkun] =
			CASE
				WHEN len(kkun) = 2 THEN ''0'' + kkun
				WHEN len(kkun) = 1 THEN ''00'' + kkun
				ELSE kkun
			END

      ,[alvv]
      ,[olosyys]
      ,[maassaolo]
      ,[osatutk]
      ,uusi = NULLIF([uusi], 0)
      ,opisk = NULLIF([opisk], 0)
      ,tutk = NULLIF([tutk], 0)

  FROM [TK_H9098_CSC].[dbo].[TK_K2_17a_sopv_14]  
  
UNION ALL  

SELECT [tilv]
      ,[sp]
      ,[syntv]
      ,[tilvaskun]  =
			CASE
				WHEN len(tilvaskun) = 2 THEN ''0'' + tilvaskun
				WHEN len(tilvaskun) = 1 THEN ''00'' + tilvaskun
				ELSE tilvaskun
			END
      ,[tilvaskunsama]
      ,[oleskelux]
      ,[muuttov] = nullif(muuttov,'''')
      ,[aikielir4]
      ,[kansalr3] = Right(''000''+[kansalr3],3)
      ,[svaltr3] = Right(''000''+[svaltr3],3)
      ,[svaltr3_aiti] = Right(''000''+[svaltr3_aiti],3)
      ,[svaltr3_isa] = Right(''000''+[svaltr3_isa],3)
      ,[htok]
      ,[klajir1]
      ,[ophal] =
			CASE 
				WHEN ophal = ''9'' THEN ''-1''
				ELSE ophal
			END

      ,[opmopa] =
			CASE
				WHEN len(opmopa) = 2 THEN ''0'' + opmopa
				WHEN len(opmopa) = 1 THEN ''00'' + opmopa
				ELSE opmopa
			END

      ,[kkieli]
      ,[kkun] =
			CASE
				WHEN len(kkun) = 2 THEN ''0'' + kkun
				WHEN len(kkun) = 1 THEN ''00'' + kkun
				ELSE kkun
			END

      ,[alvv]
      ,[olosyys]
      ,[maassaolo]
      ,[osatutk]
      ,uusi = NULLIF([uusi], 0)
      ,opisk = NULLIF([opisk], 0)
      ,tutk = NULLIF([tutk], 0)

  FROM [TK_H9098_CSC].[dbo].[TK_K2_17a_sopv_15]  
  

UNION ALL  

SELECT [tilv]
      ,[sp]
      ,[syntv]
      ,[tilvaskun]  =
			CASE
				WHEN len(tilvaskun) = 2 THEN ''0'' + tilvaskun
				WHEN len(tilvaskun) = 1 THEN ''00'' + tilvaskun
				ELSE tilvaskun
			END
      ,[tilvaskunsama]
      ,[oleskelux]
      ,[muuttov] = nullif(muuttov,'''')
      ,[aikielir4]
      ,[kansalr3] = Right(''000''+[kansalr3],3)
      ,[svaltr3] = Right(''000''+[svaltr3],3)
      ,[svaltr3_aiti] = Right(''000''+[svaltr3_aiti],3)
      ,[svaltr3_isa] = Right(''000''+[svaltr3_isa],3)
      ,[htok]
      ,[klajir1]
      ,[ophal] =
			CASE 
				WHEN ophal = ''9'' THEN ''-1''
				ELSE ophal
			END

      ,[opmopa] =
			CASE
				WHEN len(opmopa) = 2 THEN ''0'' + opmopa
				WHEN len(opmopa) = 1 THEN ''00'' + opmopa
				ELSE opmopa
			END

      ,[kkieli]
      ,[kkun] =
			CASE
				WHEN len(kkun) = 2 THEN ''0'' + kkun
				WHEN len(kkun) = 1 THEN ''00'' + kkun
				ELSE kkun
			END

      ,[alvv]
      ,[olosyys]
      ,[maassaolo]
      ,[osatutk]
      ,uusi = NULLIF([uusi], 0)
      ,opisk = NULLIF([opisk], 0)
      ,tutk = NULLIF([tutk], 0)

  FROM [TK_H9098_CSC].[dbo].[TK_K2_17a_sopv_16]  
  












' 
GO
/****** Object:  View [dbo].[v_sa_K2_17b_Ulkomaalaistaustaiset_opisk_ja_tutk]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_K2_17b_Ulkomaalaistaustaiset_opisk_ja_tutk]'))
EXEC dbo.sp_executesql @statement = N'











/****** Script for SelectTopNRows command from SSMS  ******/
CREATE VIEW [dbo].[v_sa_K2_17b_Ulkomaalaistaustaiset_opisk_ja_tutk] AS

SELECT [tilv]
      ,[sp]
      ,[syntv]
      ,[tilvaskun]  =
			CASE
				WHEN len(tilvaskun) = 2 THEN ''0'' + tilvaskun
				WHEN len(tilvaskun) = 1 THEN ''00'' + tilvaskun
				WHEN tilvaskun = ''BBB'' THEN ''999''
				ELSE tilvaskun
			END
      ,[tilvaskunsama]
      ,[oleskelux]
      ,[muuttov] = nullif(muuttov,'''')
      ,[aikielir4]
      ,[kansalr3] = Right(''000''+[kansalr3],3)
      ,[svaltr3] = Right(''000''+[svaltr3],3)
      ,[svaltr3_aiti] = Right(''000''+[svaltr3_aiti],3)
      ,[svaltr3_isa] = Right(''000''+[svaltr3_isa],3)
      ,[htok]
      ,[klajir1]
      ,[ophal] =
			CASE 
				WHEN ophal = ''9'' THEN ''-1''
				ELSE ophal
			END
      ,[opmopa]
      ,[kkieli]
      ,[kkun] =
			CASE
				WHEN len(kkun) = 2 THEN ''0'' + kkun
				WHEN len(kkun) = 1 THEN ''00'' + kkun
				ELSE kkun
			END


      ,alvv = nullif([alvv], ''BBBB'')
      ,[olosyys]
      ,[maassaolo]
      ,[osatutk]
      ,uusi = NULLIF([uusi], 0)
      ,opisk = NULLIF([opisk], 0)
      ,tutk = NULLIF([tutk], 0)

  FROM [TK_H9098_CSC].[dbo].[TK_K2_17b_sopv_11]
  
UNION ALL

SELECT [tilv]
      ,[sp]
      ,[syntv]
      ,[tilvaskun]  =
			CASE
				WHEN len(tilvaskun) = 2 THEN ''0'' + tilvaskun
				WHEN len(tilvaskun) = 1 THEN ''00'' + tilvaskun
				WHEN tilvaskun = ''BBB'' THEN ''999''
				ELSE tilvaskun
			END
      ,[tilvaskunsama]
      ,[oleskelux]
      ,[muuttov] = nullif(muuttov,'''')
      ,[aikielir4]
      ,[kansalr3] = Right(''000''+[kansalr3],3)
      ,[svaltr3] = Right(''000''+[svaltr3],3)
      ,[svaltr3_aiti] = Right(''000''+[svaltr3_aiti],3)
      ,[svaltr3_isa] = Right(''000''+[svaltr3_isa],3)
      ,[htok]
      ,[klajir1]
      ,[ophal]
      ,[opmopa]
      ,[kkieli]
      ,[kkun] =
			CASE
				WHEN len(kkun) = 2 THEN ''0'' + kkun
				WHEN len(kkun) = 1 THEN ''00'' + kkun
				ELSE kkun
			END

      ,alvv = nullif([alvv], ''BBBB'')
	  ,[olosyys]
      ,[maassaolo]
      ,[osatutk]
      ,uusi = NULLIF([uusi], 0)
      ,opisk = NULLIF([opisk], 0)
      ,tutk = NULLIF([tutk], 0)

  FROM [TK_H9098_CSC].[dbo].[TK_K2_17b_sopv_12]  
  
UNION ALL

SELECT [tilv]
      ,[sp]
      ,[syntv]
      ,[tilvaskun]  =
			CASE
				WHEN len(tilvaskun) = 2 THEN ''0'' + tilvaskun
				WHEN len(tilvaskun) = 1 THEN ''00'' + tilvaskun
				WHEN tilvaskun = ''BBB'' THEN ''999''
				ELSE tilvaskun
			END
      ,[tilvaskunsama]
      ,[oleskelux]
      ,[muuttov] = nullif(muuttov,'''')
      ,[aikielir4]
      ,[kansalr3] = Right(''000''+[kansalr3],3)
      ,[svaltr3] = Right(''000''+[svaltr3],3)
      ,[svaltr3_aiti] = Right(''000''+[svaltr3_aiti],3)
      ,[svaltr3_isa] = Right(''000''+[svaltr3_isa],3)
      ,[htok]
      ,[klajir1]
      ,[ophal]
      ,[opmopa]
      ,[kkieli]
      ,[kkun] =
			CASE
				WHEN len(kkun) = 2 THEN ''0'' + kkun
				WHEN len(kkun) = 1 THEN ''00'' + kkun
				ELSE kkun
			END

      ,alvv = nullif([alvv], ''BBBB'')
      ,[olosyys]
      ,[maassaolo]
      ,[osatutk]
      ,uusi = NULLIF([uusi], 0)
      ,opisk = NULLIF([opisk], 0)
      ,tutk = NULLIF([tutk], 0)

  FROM [TK_H9098_CSC].[dbo].[TK_K2_17b_sopv_13]  
  
UNION ALL  

SELECT [tilv]
      ,[sp]
      ,[syntv]
      ,[tilvaskun]  =
			CASE
				WHEN len(tilvaskun) = 2 THEN ''0'' + tilvaskun
				WHEN len(tilvaskun) = 1 THEN ''00'' + tilvaskun
				WHEN tilvaskun = ''BBB'' THEN ''999''
				ELSE tilvaskun
			END
      ,[tilvaskunsama]
      ,[oleskelux]
      ,[muuttov] = nullif(muuttov,'''')
      ,[aikielir4]
      ,[kansalr3] = Right(''000''+[kansalr3],3)
      ,[svaltr3] = Right(''000''+[svaltr3],3)
      ,[svaltr3_aiti] = Right(''000''+[svaltr3_aiti],3)
      ,[svaltr3_isa] = Right(''000''+[svaltr3_isa],3)
      ,[htok]
      ,[klajir1]
      ,[ophal]
      ,[opmopa]
      ,[kkieli]
      ,[kkun] =
			CASE
				WHEN len(kkun) = 2 THEN ''0'' + kkun
				WHEN len(kkun) = 1 THEN ''00'' + kkun
				ELSE kkun
			END

      ,alvv = nullif([alvv], ''BBBB'')
      ,[olosyys]
      ,[maassaolo]
      ,[osatutk]
      ,uusi = NULLIF([uusi], 0)
      ,opisk = NULLIF([opisk], 0)
      ,tutk = NULLIF([tutk], 0)

  FROM [TK_H9098_CSC].[dbo].[TK_K2_17b_sopv_14]  
  
UNION ALL  

SELECT [tilv]
      ,[sp]
      ,[syntv]
      ,[tilvaskun]  =
			CASE
				WHEN len(tilvaskun) = 2 THEN ''0'' + tilvaskun
				WHEN len(tilvaskun) = 1 THEN ''00'' + tilvaskun
				WHEN tilvaskun = ''BBB'' THEN ''999''
				ELSE tilvaskun
			END
      ,[tilvaskunsama]
      ,[oleskelux]
      ,[muuttov] = nullif(muuttov,'''')
      ,[aikielir4]
      ,[kansalr3] = Right(''000''+[kansalr3],3)
      ,[svaltr3] = Right(''000''+[svaltr3],3)
      ,[svaltr3_aiti] = Right(''000''+[svaltr3_aiti],3)
      ,[svaltr3_isa] = Right(''000''+[svaltr3_isa],3)
      ,[htok]
      ,[klajir1]
      ,[ophal]
      ,[opmopa]
      ,[kkieli]
      ,[kkun] =
			CASE
				WHEN len(kkun) = 2 THEN ''0'' + kkun
				WHEN len(kkun) = 1 THEN ''00'' + kkun
				ELSE kkun
			END

      ,alvv = nullif([alvv], ''BBBB'')
      ,[olosyys]
      ,[maassaolo]
      ,[osatutk]
      ,uusi = NULLIF([uusi], 0)
      ,opisk = NULLIF([opisk], 0)
      ,tutk = NULLIF([tutk], 0)

  FROM [TK_H9098_CSC].[dbo].[TK_K2_17b_sopv_15]  
  
UNION ALL  

SELECT [tilv]
      ,[sp]
      ,[syntv]
      ,[tilvaskun]  =
			CASE
				WHEN len(tilvaskun) = 2 THEN ''0'' + tilvaskun
				WHEN len(tilvaskun) = 1 THEN ''00'' + tilvaskun
				WHEN tilvaskun = ''BBB'' THEN ''999''
				ELSE tilvaskun
			END
      ,[tilvaskunsama]
      ,[oleskelux]
      ,[muuttov] = nullif(nullif(muuttov,''''), ''BBBB'')
      ,[aikielir4]
      ,[kansalr3] = Right(''000''+[kansalr3],3)
      ,[svaltr3] = Right(''000''+[svaltr3],3)
      ,[svaltr3_aiti] = Right(''000''+[svaltr3_aiti],3)
      ,[svaltr3_isa] = Right(''000''+[svaltr3_isa],3)
      ,[htok]
      ,[klajir1]
      ,[ophal]
      ,[opmopa]
      ,[kkieli]
      ,[kkun] =
			CASE
				WHEN len(kkun) = 2 THEN ''0'' + kkun
				WHEN len(kkun) = 1 THEN ''00'' + kkun
				ELSE kkun
			END

      ,alvv = nullif([alvv], ''BBBB'')
      ,[olosyys]
      ,[maassaolo]
      ,[osatutk]
      ,uusi = NULLIF([uusi], 0)
      ,opisk = NULLIF([opisk], 0)
      ,tutk = NULLIF([tutk], 0)

  FROM [TK_H9098_CSC].[dbo].[TK_K2_17b_sopv_16]  
  







' 
GO
/****** Object:  View [dbo].[v_sa_K3_10_Tutk_suor_osuus_aloittaneista_korkeakoulut]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_K3_10_Tutk_suor_osuus_aloittaneista_korkeakoulut]'))
EXEC dbo.sp_executesql @statement = N'



CREATE VIEW [dbo].[v_sa_K3_10_Tutk_suor_osuus_aloittaneista_korkeakoulut] AS
SELECT [tilv]
      ,[lahde]
      ,[sp]
      ,[syntv]
      ,[aikielir1]
      ,[alvv]
      ,[allk] = 
      -- Tampereen teknisen yliopiston kevään ja syksyn opiskelijamäärät ovat väärin päin aloitusvuosilla 2004 ja 2006.
      -- Korjataan virhe kääntämällä aloituskaudet toisin päin.
      -- CSC Jarmo 21.3.2014
		CASE 
			WHEN jarj=''624001-8'' AND alvv = ''2004'' and (alkkopiskjarj_2004<>'''' or ylkkopiskjarj_2004<>'''' or alkkopiskjarj_2005<>'''' or ylkkopiskjarj_2005<>'''')
				THEN CASE WHEN allk=''1'' THEN ''2'' WHEN allk=''2'' THEN ''1'' ELSE allk END
			WHEN jarj=''624001-8'' AND alvv = ''2006'' and (alkkopiskjarj_2006<>'''' or ylkkopiskjarj_2006<>'''' or alkkopiskjarj_2007<>'''' or ylkkopiskjarj_2007<>'''')
				THEN CASE WHEN allk=''1'' THEN ''2'' WHEN allk=''2'' THEN ''1'' ELSE allk END
			ELSE allk
		END
      ,[alvv_kk]
      ,[allk_kk] =
      -- Tampereen teknisen yliopiston kevään ja syksyn opiskelijamäärät ovat väärin päin aloitusvuosilla 2004 ja 2006.
      -- Korjataan virhe kääntämällä aloituskaudet toisin päin.
      -- CSC Jarmo 21.3.2014
		CASE 
			WHEN jarj=''624001-8'' AND alvv_kk = ''2004'' and (alkkopiskjarj_2004<>'''' or ylkkopiskjarj_2004<>'''' or alkkopiskjarj_2005<>'''' or ylkkopiskjarj_2005<>'''')
				THEN CASE WHEN allk_kk=''1'' THEN ''2'' WHEN allk_kk=''2'' THEN ''1'' ELSE allk_kk END
			WHEN jarj=''624001-8'' AND alvv_kk = ''2006'' and (alkkopiskjarj_2006<>'''' or ylkkopiskjarj_2006<>'''' or alkkopiskjarj_2007<>'''' or ylkkopiskjarj_2007<>'''')
				THEN CASE WHEN allk_kk=''1'' THEN ''2'' WHEN allk_kk=''2'' THEN ''1'' ELSE allk_kk END
			ELSE allk_kk
		END
      ,[ololk]
      ,[klaji]
      ,[jarj]
      ,[kkun]
      ,[koulk]
      ,[pohjkoulk]
      ,[rahlahde]
      ,[amksuorv_2000]
      ,[amksuorlk_2000]
      ,[amktutkkmaak_2000]
      ,[amktutkjarj_2000]
      ,[amktutkkoulk_2000]
      ,[ylamksuorv_2000]
      ,[ylamksuorlk_2000]
      ,[ylamktutkkmaak_2000]
      ,[ylamktutkjarj_2000]
      ,[ylamktutkkoulk_2000]
      ,[alkksuorv_2000]
      ,[alkksuorlk_2000]
      ,[alkktutkkmaak_2000]
      ,[alkktutkjarj_2000]
      ,[alkktutkkoulk_2000]
      ,[ylkksuorv_2000]
      ,[ylkksuorlk_2000]
      ,[ylkktutkkmaak_2000]
      ,[ylkktutkjarj_2000]
      ,[ylkktutkkoulk_2000]
      ,[tksuorv_2000]
      ,[tksuorlk_2000]
      ,[tktutkkmaak_2000]
      ,[tktutkjarj_2000]
      ,[tktutkkoulk_2000]
      ,[muutasuorv_2000]
      ,[muutasuorlk_2000]
      ,[muutatutkkmaak_2000]
      ,[muutatutkjarj_2000]
      ,[muutatutkkoulk_2000]
      ,[amksuorv_2001]
      ,[amksuorlk_2001]
      ,[amktutkkmaak_2001]
      ,[amktutkjarj_2001]
      ,[amktutkkoulk_2001]
      ,[ylamksuorv_2001]
      ,[ylamksuorlk_2001]
      ,[ylamktutkkmaak_2001]
      ,[ylamktutkjarj_2001]
      ,[ylamktutkkoulk_2001]
      ,[alkksuorv_2001]
      ,[alkksuorlk_2001]
      ,[alkktutkkmaak_2001]
      ,[alkktutkjarj_2001]
      ,[alkktutkkoulk_2001]
      ,[ylkksuorv_2001]
      ,[ylkksuorlk_2001]
      ,[ylkktutkkmaak_2001]
      ,[ylkktutkjarj_2001]
      ,[ylkktutkkoulk_2001]
      ,[tksuorv_2001]
      ,[tksuorlk_2001]
      ,[tktutkkmaak_2001]
      ,[tktutkjarj_2001]
      ,[tktutkkoulk_2001]
      ,[muutasuorv_2001]
      ,[muutasuorlk_2001]
      ,[muutatutkkmaak_2001]
      ,[muutatutkjarj_2001]
      ,[muutatutkkoulk_2001]
      ,[amksuorv_2002]
      ,[amksuorlk_2002]
      ,[amktutkkmaak_2002]
      ,[amktutkjarj_2002]
      ,[amktutkkoulk_2002]
      ,[ylamksuorv_2002]
      ,[ylamksuorlk_2002]
      ,[ylamktutkkmaak_2002]
      ,[ylamktutkjarj_2002]
      ,[ylamktutkkoulk_2002]
      ,[alkksuorv_2002]
      ,[alkksuorlk_2002]
      ,[alkktutkkmaak_2002]
      ,[alkktutkjarj_2002]
      ,[alkktutkkoulk_2002]
      ,[ylkksuorv_2002]
      ,[ylkksuorlk_2002]
      ,[ylkktutkkmaak_2002]
      ,[ylkktutkjarj_2002]
      ,[ylkktutkkoulk_2002]
      ,[tksuorv_2002]
      ,[tksuorlk_2002]
      ,[tktutkkmaak_2002]
      ,[tktutkjarj_2002]
      ,[tktutkkoulk_2002]
      ,[muutasuorv_2002]
      ,[muutasuorlk_2002]
      ,[muutatutkkmaak_2002]
      ,[muutatutkjarj_2002]
      ,[muutatutkkoulk_2002]
      ,[amksuorv_2003]
      ,[amksuorlk_2003]
      ,[amktutkkmaak_2003]
      ,[amktutkjarj_2003]
      ,[amktutkkoulk_2003]
      ,[ylamksuorv_2003]
      ,[ylamksuorlk_2003]
      ,[ylamktutkkmaak_2003]
      ,[ylamktutkjarj_2003]
      ,[ylamktutkkoulk_2003]
      ,[alkksuorv_2003]
      ,[alkksuorlk_2003]
      ,[alkktutkkmaak_2003]
      ,[alkktutkjarj_2003]
      ,[alkktutkkoulk_2003]
      ,[ylkksuorv_2003]
      ,[ylkksuorlk_2003]
      ,[ylkktutkkmaak_2003]
      ,[ylkktutkjarj_2003]
      ,[ylkktutkkoulk_2003]
      ,[tksuorv_2003]
      ,[tksuorlk_2003]
      ,[tktutkkmaak_2003]
      ,[tktutkjarj_2003]
      ,[tktutkkoulk_2003]
      ,[muutasuorv_2003]
      ,[muutasuorlk_2003]
      ,[muutatutkkmaak_2003]
      ,[muutatutkjarj_2003]
      ,[muutatutkkoulk_2003]
      ,[amksuorv_2004]
      ,[amksuorlk_2004]
      ,[amktutkkmaak_2004]
      ,[amktutkjarj_2004]
      ,[amktutkkoulk_2004]
      ,[ylamksuorv_2004]
      ,[ylamksuorlk_2004]
      ,[ylamktutkkmaak_2004]
      ,[ylamktutkjarj_2004]
      ,[ylamktutkkoulk_2004]
      ,[alkksuorv_2004]
      ,[alkksuorlk_2004]
      ,[alkktutkkmaak_2004]
      ,[alkktutkjarj_2004]
      ,[alkktutkkoulk_2004]
      ,[ylkksuorv_2004]
      ,[ylkksuorlk_2004]
      ,[ylkktutkkmaak_2004]
      ,[ylkktutkjarj_2004]
      ,[ylkktutkkoulk_2004]
      ,[tksuorv_2004]
      ,[tksuorlk_2004]
      ,[tktutkkmaak_2004]
      ,[tktutkjarj_2004]
      ,[tktutkkoulk_2004]
      ,[muutasuorv_2004]
      ,[muutasuorlk_2004]
      ,[muutatutkkmaak_2004]
      ,[muutatutkjarj_2004]
      ,[muutatutkkoulk_2004]
      ,[amksuorv_2005]
      ,[amksuorlk_2005]
      ,[amktutkkmaak_2005]
      ,[amktutkjarj_2005]
      ,[amktutkkoulk_2005]
      ,[ylamksuorv_2005]
      ,[ylamksuorlk_2005]
      ,[ylamktutkkmaak_2005]
      ,[ylamktutkjarj_2005]
      ,[ylamktutkkoulk_2005]
      ,[alkksuorv_2005]
      ,[alkksuorlk_2005]
      ,[alkktutkkmaak_2005]
      ,[alkktutkjarj_2005]
      ,[alkktutkkoulk_2005]
      ,[ylkksuorv_2005]
      ,[ylkksuorlk_2005]
      ,[ylkktutkkmaak_2005]
      ,[ylkktutkjarj_2005]
      ,[ylkktutkkoulk_2005]
      ,[tksuorv_2005]
      ,[tksuorlk_2005]
      ,[tktutkkmaak_2005]
      ,[tktutkjarj_2005]
      ,[tktutkkoulk_2005]
      ,[muutasuorv_2005]
      ,[muutasuorlk_2005]
      ,[muutatutkkmaak_2005]
      ,[muutatutkjarj_2005]
      ,[muutatutkkoulk_2005]
      ,[amksuorv_2006]
      ,[amksuorlk_2006]
      ,[amktutkkmaak_2006]
      ,[amktutkjarj_2006]
      ,[amktutkkoulk_2006]
      ,[ylamksuorv_2006]
      ,[ylamksuorlk_2006]
      ,[ylamktutkkmaak_2006]
      ,[ylamktutkjarj_2006]
      ,[ylamktutkkoulk_2006]
      ,[alkksuorv_2006]
      ,[alkksuorlk_2006]
      ,[alkktutkkmaak_2006]
      ,[alkktutkjarj_2006]
      ,[alkktutkkoulk_2006]
      ,[ylkksuorv_2006]
      ,[ylkksuorlk_2006]
      ,[ylkktutkkmaak_2006]
      ,[ylkktutkjarj_2006]
      ,[ylkktutkkoulk_2006]
      ,[tksuorv_2006]
      ,[tksuorlk_2006]
      ,[tktutkkmaak_2006]
      ,[tktutkjarj_2006]
      ,[tktutkkoulk_2006]
      ,[muutasuorv_2006]
      ,[muutasuorlk_2006]
      ,[muutatutkkmaak_2006]
      ,[muutatutkjarj_2006]
      ,[muutatutkkoulk_2006]
      ,[amksuorv_2007]
      ,[amksuorlk_2007]
      ,[amktutkkmaak_2007]
      ,[amktutkjarj_2007]
      ,[amktutkkoulk_2007]
      ,[ylamksuorv_2007]
      ,[ylamksuorlk_2007]
      ,[ylamktutkkmaak_2007]
      ,[ylamktutkjarj_2007]
      ,[ylamktutkkoulk_2007]
      ,[alkksuorv_2007]
      ,[alkksuorlk_2007]
      ,[alkktutkkmaak_2007]
      ,[alkktutkjarj_2007]
      ,[alkktutkkoulk_2007]
      ,[ylkksuorv_2007]
      ,[ylkksuorlk_2007]
      ,[ylkktutkkmaak_2007]
      ,[ylkktutkjarj_2007]
      ,[ylkktutkkoulk_2007]
      ,[tksuorv_2007]
      ,[tksuorlk_2007]
      ,[tktutkkmaak_2007]
      ,[tktutkjarj_2007]
      ,[tktutkkoulk_2007]
      ,[muutasuorv_2007]
      ,[muutasuorlk_2007]
      ,[muutatutkkmaak_2007]
      ,[muutatutkjarj_2007]
      ,[muutatutkkoulk_2007]
      ,[amksuorv_2008]
      ,[amksuorlk_2008]
      ,[amktutkkmaak_2008]
      ,[amktutkjarj_2008]
      ,[amktutkkoulk_2008]
      ,[ylamksuorv_2008]
      ,[ylamksuorlk_2008]
      ,[ylamktutkkmaak_2008]
      ,[ylamktutkjarj_2008]
      ,[ylamktutkkoulk_2008]
      ,[alkksuorv_2008]
      ,[alkksuorlk_2008]
      ,[alkktutkkmaak_2008]
      ,[alkktutkjarj_2008]
      ,[alkktutkkoulk_2008]
      ,[ylkksuorv_2008]
      ,[ylkksuorlk_2008]
      ,[ylkktutkkmaak_2008]
      ,[ylkktutkjarj_2008]
      ,[ylkktutkkoulk_2008]
      ,[tksuorv_2008]
      ,[tksuorlk_2008]
      ,[tktutkkmaak_2008]
      ,[tktutkjarj_2008]
      ,[tktutkkoulk_2008]
      ,[muutasuorv_2008]
      ,[muutasuorlk_2008]
      ,[muutatutkkmaak_2008]
      ,[muutatutkjarj_2008]
      ,[muutatutkkoulk_2008]
      ,[amksuorv_2009]
      ,[amksuorlk_2009]
      ,[amktutkkmaak_2009]
      ,[amktutkjarj_2009]
      ,[amktutkkoulk_2009]
      ,[ylamksuorv_2009]
      ,[ylamksuorlk_2009]
      ,[ylamktutkkmaak_2009]
      ,[ylamktutkjarj_2009]
      ,[ylamktutkkoulk_2009]
      ,[alkksuorv_2009]
      ,[alkksuorlk_2009]
      ,[alkktutkkmaak_2009]
      ,[alkktutkjarj_2009]
      ,[alkktutkkoulk_2009]
      ,[ylkksuorv_2009]
      ,[ylkksuorlk_2009]
      ,[ylkktutkkmaak_2009]
      ,[ylkktutkjarj_2009]
      ,[ylkktutkkoulk_2009]
      ,[tksuorv_2009]
      ,[tksuorlk_2009]
      ,[tktutkkmaak_2009]
      ,[tktutkjarj_2009]
      ,[tktutkkoulk_2009]
      ,[muutasuorv_2009]
      ,[muutasuorlk_2009]
      ,[muutatutkkmaak_2009]
      ,[muutatutkjarj_2009]
      ,[muutatutkkoulk_2009]
      ,[amkopiskkoulk_2000]
      ,[amkopiskjarj_2000]
      ,[amkkmaak_2000]
      ,[amkolotamm_2000]
      ,[amkolosyys_2000]
      ,[ylamkopiskkoulk_2000]
      ,[ylamkopiskjarj_2000]
      ,[ylamkkmaak_2000]
      ,[ylamkolotamm_2000]
      ,[ylamkolosyys_2000]
      ,[alkkopiskkoulk_2000]
      ,[alkkopiskjarj_2000]
      ,[alkkkmaak_2000]
      ,[alkkolotamm_2000]
      ,[alkkolosyys_2000]
      ,[ylkkopiskkoulk_2000]
      ,[ylkkopiskjarj_2000]
      ,[ylkkkmaak_2000]
      ,[ylkkolotamm_2000]
      ,[ylkkolosyys_2000]
      ,[tkopiskkoulk_2000]
      ,[tkopiskjarj_2000]
      ,[tkkmaak_2000]
      ,[tkolotamm_2000]
      ,[tkolosyys_2000]
      ,[muutaopiskkoulk_2000]
      ,[muutaopiskjarj_2000]
      ,[muutakmaak_2000]
      ,[muutaolotamm_2000]
      ,[muutaolosyys_2000]
      ,[amkopiskkoulk_2001]
      ,[amkopiskjarj_2001]
      ,[amkkmaak_2001]
      ,[amkolotamm_2001]
      ,[amkolosyys_2001]
      ,[ylamkopiskkoulk_2001]
      ,[ylamkopiskjarj_2001]
      ,[ylamkkmaak_2001]
      ,[ylamkolotamm_2001]
      ,[ylamkolosyys_2001]
      ,[alkkopiskkoulk_2001]
      ,[alkkopiskjarj_2001]
      ,[alkkkmaak_2001]
      ,[alkkolotamm_2001]
      ,[alkkolosyys_2001]
      ,[ylkkopiskkoulk_2001]
      ,[ylkkopiskjarj_2001]
      ,[ylkkkmaak_2001]
      ,[ylkkolotamm_2001]
      ,[ylkkolosyys_2001]
      ,[tkopiskkoulk_2001]
      ,[tkopiskjarj_2001]
      ,[tkkmaak_2001]
      ,[tkolotamm_2001]
      ,[tkolosyys_2001]
      ,[muutaopiskkoulk_2001]
      ,[muutaopiskjarj_2001]
      ,[muutakmaak_2001]
      ,[muutaolotamm_2001]
      ,[muutaolosyys_2001]
      ,[amkopiskkoulk_2002]
      ,[amkopiskjarj_2002]
      ,[amkkmaak_2002]
      ,[amkolotamm_2002]
      ,[amkolosyys_2002]
      ,[ylamkopiskkoulk_2002]
      ,[ylamkopiskjarj_2002]
      ,[ylamkkmaak_2002]
      ,[ylamkolotamm_2002]
      ,[ylamkolosyys_2002]
      ,[alkkopiskkoulk_2002]
      ,[alkkopiskjarj_2002]
      ,[alkkkmaak_2002]
      ,[alkkolotamm_2002]
      ,[alkkolosyys_2002]
      ,[ylkkopiskkoulk_2002]
      ,[ylkkopiskjarj_2002]
      ,[ylkkkmaak_2002]
      ,[ylkkolotamm_2002]
      ,[ylkkolosyys_2002]
      ,[tkopiskkoulk_2002]
      ,[tkopiskjarj_2002]
      ,[tkkmaak_2002]
      ,[tkolotamm_2002]
      ,[tkolosyys_2002]
      ,[muutaopiskkoulk_2002]
      ,[muutaopiskjarj_2002]
      ,[muutakmaak_2002]
      ,[muutaolotamm_2002]
      ,[muutaolosyys_2002]
      ,[amkopiskkoulk_2003]
      ,[amkopiskjarj_2003]
      ,[amkkmaak_2003]
      ,[amkolotamm_2003]
      ,[amkolosyys_2003]
      ,[ylamkopiskkoulk_2003]
      ,[ylamkopiskjarj_2003]
      ,[ylamkkmaak_2003]
      ,[ylamkolotamm_2003]
      ,[ylamkolosyys_2003]
      ,[alkkopiskkoulk_2003]
      ,[alkkopiskjarj_2003]
      ,[alkkkmaak_2003]
      ,[alkkolotamm_2003]
      ,[alkkolosyys_2003]
      ,[ylkkopiskkoulk_2003]
      ,[ylkkopiskjarj_2003]
      ,[ylkkkmaak_2003]
      ,[ylkkolotamm_2003]
      ,[ylkkolosyys_2003]
      ,[tkopiskkoulk_2003]
      ,[tkopiskjarj_2003]
      ,[tkkmaak_2003]
      ,[tkolotamm_2003]
      ,[tkolosyys_2003]
      ,[muutaopiskkoulk_2003]
      ,[muutaopiskjarj_2003]
      ,[muutakmaak_2003]
      ,[muutaolotamm_2003]
      ,[muutaolosyys_2003]
      ,[amkopiskkoulk_2004]
      ,[amkopiskjarj_2004]
      ,[amkkmaak_2004]
      ,[amkolotamm_2004]
      ,[amkolosyys_2004]
      ,[ylamkopiskkoulk_2004]
      ,[ylamkopiskjarj_2004]
      ,[ylamkkmaak_2004]
      ,[ylamkolotamm_2004]
      ,[ylamkolosyys_2004]
      ,[alkkopiskkoulk_2004]
      ,[alkkopiskjarj_2004]
      ,[alkkkmaak_2004]
      ,[alkkolotamm_2004]
      ,[alkkolosyys_2004]
      ,[ylkkopiskkoulk_2004]
      ,[ylkkopiskjarj_2004]
      ,[ylkkkmaak_2004]
      ,[ylkkolotamm_2004]
      ,[ylkkolosyys_2004]
      ,[tkopiskkoulk_2004]
      ,[tkopiskjarj_2004]
      ,[tkkmaak_2004]
      ,[tkolotamm_2004]
      ,[tkolosyys_2004]
      ,[muutaopiskkoulk_2004]
      ,[muutaopiskjarj_2004]
      ,[muutakmaak_2004]
      ,[muutaolotamm_2004]
      ,[muutaolosyys_2004]
      ,[amkopiskkoulk_2005]
      ,[amkopiskjarj_2005]
      ,[amkkmaak_2005]
      ,[amkolotamm_2005]
      ,[amkolosyys_2005]
      ,[ylamkopiskkoulk_2005]
      ,[ylamkopiskjarj_2005]
      ,[ylamkkmaak_2005]
      ,[ylamkolotamm_2005]
      ,[ylamkolosyys_2005]
      ,[alkkopiskkoulk_2005]
      ,[alkkopiskjarj_2005]
      ,[alkkkmaak_2005]
      ,[alkkolotamm_2005]
      ,[alkkolosyys_2005]
      ,[ylkkopiskkoulk_2005]
      ,[ylkkopiskjarj_2005]
      ,[ylkkkmaak_2005]
      ,[ylkkolotamm_2005]
      ,[ylkkolosyys_2005]
      ,[tkopiskkoulk_2005]
      ,[tkopiskjarj_2005]
      ,[tkkmaak_2005]
      ,[tkolotamm_2005]
      ,[tkolosyys_2005]
      ,[muutaopiskkoulk_2005]
      ,[muutaopiskjarj_2005]
      ,[muutakmaak_2005]
      ,[muutaolotamm_2005]
      ,[muutaolosyys_2005]
      ,[amkopiskkoulk_2006]
      ,[amkopiskjarj_2006]
      ,[amkkmaak_2006]
      ,[amkolotamm_2006]
      ,[amkolosyys_2006]
      ,[ylamkopiskkoulk_2006]
      ,[ylamkopiskjarj_2006]
      ,[ylamkkmaak_2006]
      ,[ylamkolotamm_2006]
      ,[ylamkolosyys_2006]
      ,[alkkopiskkoulk_2006]
      ,[alkkopiskjarj_2006]
      ,[alkkkmaak_2006]
      ,[alkkolotamm_2006]
      ,[alkkolosyys_2006]
      ,[ylkkopiskkoulk_2006]
      ,[ylkkopiskjarj_2006]
      ,[ylkkkmaak_2006]
      ,[ylkkolotamm_2006]
      ,[ylkkolosyys_2006]
      ,[tkopiskkoulk_2006]
      ,[tkopiskjarj_2006]
      ,[tkkmaak_2006]
      ,[tkolotamm_2006]
      ,[tkolosyys_2006]
      ,[muutaopiskkoulk_2006]
      ,[muutaopiskjarj_2006]
      ,[muutakmaak_2006]
      ,[muutaolotamm_2006]
      ,[muutaolosyys_2006]
      ,[amkopiskkoulk_2007]
      ,[amkopiskjarj_2007]
      ,[amkkmaak_2007]
      ,[amkolotamm_2007]
      ,[amkolosyys_2007]
      ,[ylamkopiskkoulk_2007]
      ,[ylamkopiskjarj_2007]
      ,[ylamkkmaak_2007]
      ,[ylamkolotamm_2007]
      ,[ylamkolosyys_2007]
      ,[alkkopiskkoulk_2007]
      ,[alkkopiskjarj_2007]
      ,[alkkkmaak_2007]
      ,[alkkolotamm_2007]
      ,[alkkolosyys_2007]
      ,[ylkkopiskkoulk_2007]
      ,[ylkkopiskjarj_2007]
      ,[ylkkkmaak_2007]
      ,[ylkkolotamm_2007]
      ,[ylkkolosyys_2007]
      ,[tkopiskkoulk_2007]
      ,[tkopiskjarj_2007]
      ,[tkkmaak_2007]
      ,[tkolotamm_2007]
      ,[tkolosyys_2007]
      ,[muutaopiskkoulk_2007]
      ,[muutaopiskjarj_2007]
      ,[muutakmaak_2007]
      ,[muutaolotamm_2007]
      ,[muutaolosyys_2007]
      ,[amkopiskkoulk_2008]
      ,[amkopiskjarj_2008]
      ,[amkkmaak_2008]
      ,[amkolotamm_2008]
      ,[amkolosyys_2008]
      ,[ylamkopiskkoulk_2008]
      ,[ylamkopiskjarj_2008]
      ,[ylamkkmaak_2008]
      ,[ylamkolotamm_2008]
      ,[ylamkolosyys_2008]
      ,[alkkopiskkoulk_2008]
      ,[alkkopiskjarj_2008]
      ,[alkkkmaak_2008]
      ,[alkkolotamm_2008]
      ,[alkkolosyys_2008]
      ,[ylkkopiskkoulk_2008]
      ,[ylkkopiskjarj_2008]
      ,[ylkkkmaak_2008]
      ,[ylkkolotamm_2008]
      ,[ylkkolosyys_2008]
      ,[tkopiskkoulk_2008]
      ,[tkopiskjarj_2008]
      ,[tkkmaak_2008]
      ,[tkolotamm_2008]
      ,[tkolosyys_2008]
      ,[muutaopiskkoulk_2008]
      ,[muutaopiskjarj_2008]
      ,[muutakmaak_2008]
      ,[muutaolotamm_2008]
      ,[muutaolosyys_2008]
      ,[amkopiskkoulk_2009]
      ,[amkopiskjarj_2009]
      ,[amkkmaak_2009]
      ,[amkolotamm_2009]
      ,[amkolosyys_2009]
      ,[ylamkopiskkoulk_2009]
      ,[ylamkopiskjarj_2009]
      ,[ylamkkmaak_2009]
      ,[ylamkolotamm_2009]
      ,[ylamkolosyys_2009]
      ,[alkkopiskkoulk_2009]
      ,[alkkopiskjarj_2009]
      ,[alkkkmaak_2009]
      ,[alkkolotamm_2009]
      ,[alkkolosyys_2009]
      ,[ylkkopiskkoulk_2009]
      ,[ylkkopiskjarj_2009]
      ,[ylkkkmaak_2009]
      ,[ylkkolotamm_2009]
      ,[ylkkolosyys_2009]
      ,[tkopiskkoulk_2009]
      ,[tkopiskjarj_2009]
      ,[tkkmaak_2009]
      ,[tkolotamm_2009]
      ,[tkolosyys_2009]
      ,[muutaopiskkoulk_2009]
      ,[muutaopiskjarj_2009]
      ,[muutakmaak_2009]
      ,[muutaolotamm_2009]
      ,[muutaolosyys_2009]
      ,[ptoim1r5_2000]
      ,[amas_2000]
      ,[ptoim1r5_2001]
      ,[amas_2001]
      ,[ptoim1r5_2002]
      ,[amas_2002]
      ,[ptoim1r5_2003]
      ,[amas_2003]
      ,[ptoim1r5_2004]
      ,[amas_2004]
      ,[ptoim1r5_2005]
      ,[amas_2005]
      ,[ptoim1r5_2006]
      ,[amas_2006]
      ,[ptoim1r5_2007]
      ,[amas_2007]
      ,[ptoim1r5_2008]
      ,[amas_2008]
      ,[ptoim1r5_2009]
      ,[amas_2009]

--UUSIVUOSI
--2010
      ,[amksuorv_2010]
      ,[amksuorlk_2010]
      ,[amktutkkmaak_2010]
      ,[amktutkjarj_2010]
      ,[amktutkkoulk_2010]
      ,[ylamksuorv_2010]
      ,[ylamksuorlk_2010]
      ,[ylamktutkkmaak_2010]
      ,[ylamktutkjarj_2010]
      ,[ylamktutkkoulk_2010]
      ,[alkksuorv_2010]
      ,[alkksuorlk_2010]
      ,[alkktutkkmaak_2010]
      ,[alkktutkjarj_2010]
      ,[alkktutkkoulk_2010]
      ,[ylkksuorv_2010]
      ,[ylkksuorlk_2010]
      ,[ylkktutkkmaak_2010]
      ,[ylkktutkjarj_2010]
      ,[ylkktutkkoulk_2010]
      ,[tksuorv_2010]
      ,[tksuorlk_2010]
      ,[tktutkkmaak_2010]
      ,[tktutkjarj_2010]
      ,[tktutkkoulk_2010]
      ,[muutasuorv_2010]
      ,[muutasuorlk_2010]
      ,[muutatutkkmaak_2010]
      ,[muutatutkjarj_2010]
      ,[muutatutkkoulk_2010]
      ,[amkopiskkoulk_2010]
      ,[amkopiskjarj_2010]
      ,[amkkmaak_2010]
      ,[amkolotamm_2010]
      ,[amkolosyys_2010]
      ,[ylamkopiskkoulk_2010]
      ,[ylamkopiskjarj_2010]
      ,[ylamkkmaak_2010]
      ,[ylamkolotamm_2010]
      ,[ylamkolosyys_2010]
      ,[alkkopiskkoulk_2010]
      ,[alkkopiskjarj_2010]
      ,[alkkkmaak_2010]
      ,[alkkolotamm_2010]
      ,[alkkolosyys_2010]
      ,[ylkkopiskkoulk_2010]
      ,[ylkkopiskjarj_2010]
      ,[ylkkkmaak_2010]
      ,[ylkkolotamm_2010]
      ,[ylkkolosyys_2010]
      ,[tkopiskkoulk_2010]
      ,[tkopiskjarj_2010]
      ,[tkkmaak_2010]
      ,[tkolotamm_2010]
      ,[tkolosyys_2010]
      ,[muutaopiskkoulk_2010]
      ,[muutaopiskjarj_2010]
      ,[muutakmaak_2010]
      ,[muutaolotamm_2010]
      ,[muutaolosyys_2010]
      ,[ptoim1r5_2010]
      ,[amas_2010]

--UUSIVUOSI
--2011
      ,[amksuorv_2011]
      ,[amksuorlk_2011]
      ,[amktutkkmaak_2011]
      ,[amktutkjarj_2011]
      ,[amktutkkoulk_2011]
      ,[ylamksuorv_2011]
      ,[ylamksuorlk_2011]
      ,[ylamktutkkmaak_2011]
      ,[ylamktutkjarj_2011]
      ,[ylamktutkkoulk_2011]
      ,[alkksuorv_2011]
      ,[alkksuorlk_2011]
      ,[alkktutkkmaak_2011]
      ,[alkktutkjarj_2011]
      ,[alkktutkkoulk_2011]
      ,[ylkksuorv_2011]
      ,[ylkksuorlk_2011]
      ,[ylkktutkkmaak_2011]
      ,[ylkktutkjarj_2011]
      ,[ylkktutkkoulk_2011]
      ,[tksuorv_2011]
      ,[tksuorlk_2011]
      ,[tktutkkmaak_2011]
      ,[tktutkjarj_2011]
      ,[tktutkkoulk_2011]
      ,[muutasuorv_2011]
      ,[muutasuorlk_2011]
      ,[muutatutkkmaak_2011]
      ,[muutatutkjarj_2011]
      ,[muutatutkkoulk_2011]
      ,[amkopiskkoulk_2011]
      ,[amkopiskjarj_2011]
      ,[amkkmaak_2011]
      ,[amkolotamm_2011]
      ,[amkolosyys_2011]
      ,[ylamkopiskkoulk_2011]
      ,[ylamkopiskjarj_2011]
      ,[ylamkkmaak_2011]
      ,[ylamkolotamm_2011]
      ,[ylamkolosyys_2011]
      ,[alkkopiskkoulk_2011]
      ,[alkkopiskjarj_2011]
      ,[alkkkmaak_2011]
      ,[alkkolotamm_2011]
      ,[alkkolosyys_2011]
      ,[ylkkopiskkoulk_2011]
      ,[ylkkopiskjarj_2011]
      ,[ylkkkmaak_2011]
      ,[ylkkolotamm_2011]
      ,[ylkkolosyys_2011]
      ,[tkopiskkoulk_2011]
      ,[tkopiskjarj_2011]
      ,[tkkmaak_2011]
      ,[tkolotamm_2011]
      ,[tkolosyys_2011]
      ,[muutaopiskkoulk_2011]
      ,[muutaopiskjarj_2011]
      ,[muutakmaak_2011]
      ,[muutaolotamm_2011]
      ,[muutaolosyys_2011]
      ,[ptoim1r5_2011]
      ,[amas_2011]
      
--UUSIVUOSI
--2012
      ,[amksuorv_2012]
      ,[amksuorlk_2012]
      ,[amktutkkmaak_2012]
      ,[amktutkjarj_2012]
      ,[amktutkkoulk_2012]
      ,[ylamksuorv_2012]
      ,[ylamksuorlk_2012]
      ,[ylamktutkkmaak_2012]
      ,[ylamktutkjarj_2012]
      ,[ylamktutkkoulk_2012]
      ,[alkksuorv_2012]
      ,[alkksuorlk_2012]
      ,[alkktutkkmaak_2012]
      ,[alkktutkjarj_2012]
      ,[alkktutkkoulk_2012]
      ,[ylkksuorv_2012]
      ,[ylkksuorlk_2012]
      ,[ylkktutkkmaak_2012]
      ,[ylkktutkjarj_2012]
      ,[ylkktutkkoulk_2012]
      ,[tksuorv_2012]
      ,[tksuorlk_2012]
      ,[tktutkkmaak_2012]
      ,[tktutkjarj_2012]
      ,[tktutkkoulk_2012]
      ,[muutasuorv_2012]
      ,[muutasuorlk_2012]
      ,[muutatutkkmaak_2012]
      ,[muutatutkjarj_2012]
      ,[muutatutkkoulk_2012]
      ,[amkopiskkoulk_2012]
      ,[amkopiskjarj_2012]
      ,[amkkmaak_2012]
      ,[amkolotamm_2012]
      ,[amkolosyys_2012]
      ,[ylamkopiskkoulk_2012]
      ,[ylamkopiskjarj_2012]
      ,[ylamkkmaak_2012]
      ,[ylamkolotamm_2012]
      ,[ylamkolosyys_2012]
      ,[alkkopiskkoulk_2012]
      ,[alkkopiskjarj_2012]
      ,[alkkkmaak_2012]
      ,[alkkolotamm_2012]
      ,[alkkolosyys_2012]
      ,[ylkkopiskkoulk_2012]
      ,[ylkkopiskjarj_2012]
      ,[ylkkkmaak_2012]
      ,[ylkkolotamm_2012]
      ,[ylkkolosyys_2012]
      ,[tkopiskkoulk_2012]
      ,[tkopiskjarj_2012]
      ,[tkkmaak_2012]
      ,[tkolotamm_2012]
      ,[tkolosyys_2012]
      ,[muutaopiskkoulk_2012]
      ,[muutaopiskjarj_2012]
      ,[muutakmaak_2012]
      ,[muutaolotamm_2012]
      ,[muutaolosyys_2012]
      ,[ptoim1r5_2012]
      ,[amas_2012]
--2013
      ,[amksuorv_2013]
      ,[amksuorlk_2013]
      ,[amktutkkmaak_2013]
      ,[amktutkjarj_2013]
      ,[amktutkkoulk_2013]
      ,[ylamksuorv_2013]
      ,[ylamksuorlk_2013]
      ,[ylamktutkkmaak_2013]
      ,[ylamktutkjarj_2013]
      ,[ylamktutkkoulk_2013]
      ,[alkksuorv_2013]
      ,[alkksuorlk_2013]
      ,[alkktutkkmaak_2013]
      ,[alkktutkjarj_2013]
      ,[alkktutkkoulk_2013]
      ,[ylkksuorv_2013]
      ,[ylkksuorlk_2013]
      ,[ylkktutkkmaak_2013]
      ,[ylkktutkjarj_2013]
      ,[ylkktutkkoulk_2013]
      ,[tksuorv_2013]
      ,[tksuorlk_2013]
      ,[tktutkkmaak_2013]
      ,[tktutkjarj_2013]
      ,[tktutkkoulk_2013]
      ,[muutasuorv_2013]
      ,[muutasuorlk_2013]
      ,[muutatutkkmaak_2013]
      ,[muutatutkjarj_2013]
      ,[muutatutkkoulk_2013]
      ,[amkopiskkoulk_2013]
      ,[amkopiskjarj_2013]
      ,[amkkmaak_2013]
      ,[amkolotamm_2013]
      ,[amkolosyys_2013]
      ,[ylamkopiskkoulk_2013]
      ,[ylamkopiskjarj_2013]
      ,[ylamkkmaak_2013]
      ,[ylamkolotamm_2013]
      ,[ylamkolosyys_2013]
      ,[alkkopiskkoulk_2013]
      ,[alkkopiskjarj_2013]
      ,[alkkkmaak_2013]
      ,[alkkolotamm_2013]
      ,[alkkolosyys_2013]
      ,[ylkkopiskkoulk_2013]
      ,[ylkkopiskjarj_2013]
      ,[ylkkkmaak_2013]
      ,[ylkkolotamm_2013]
      ,[ylkkolosyys_2013]
      ,[tkopiskkoulk_2013]
      ,[tkopiskjarj_2013]
      ,[tkkmaak_2013]
      ,[tkolotamm_2013]
      ,[tkolosyys_2013]
      ,[muutaopiskkoulk_2013]
      ,[muutaopiskjarj_2013]
      ,[muutakmaak_2013]
      ,[muutaolotamm_2013]
      ,[muutaolosyys_2013]
      ,[ptoim1r5_2013]
      ,[amas_2013]

-- 2014

      ,[amksuorv_2014]
      ,[amksuorlk_2014]
      ,[amktutkkmaak_2014]
      ,[amktutkjarj_2014]
      ,[amktutkkoulk_2014]
      ,[ylamksuorv_2014]
      ,[ylamksuorlk_2014]
      ,[ylamktutkkmaak_2014]
      ,[ylamktutkjarj_2014]
      ,[ylamktutkkoulk_2014]
      ,[alkksuorv_2014]
      ,[alkksuorlk_2014]
      ,[alkktutkkmaak_2014]
      ,[alkktutkjarj_2014]
      ,[alkktutkkoulk_2014]
      ,[ylkksuorv_2014]
      ,[ylkksuorlk_2014]
      ,[ylkktutkkmaak_2014]
      ,[ylkktutkjarj_2014]
      ,[ylkktutkkoulk_2014]
      ,[tksuorv_2014]
      ,[tksuorlk_2014]
      ,[tktutkkmaak_2014]
      ,[tktutkjarj_2014]
      ,[tktutkkoulk_2014]
      ,[muutasuorv_2014]
      ,[muutasuorlk_2014]
      ,[muutatutkkmaak_2014]
      ,[muutatutkjarj_2014]
      ,[muutatutkkoulk_2014]
      ,[amkopiskkoulk_2014]
      ,[amkopiskjarj_2014]
      ,[amkkmaak_2014]
      ,[amkolotamm_2014]
      ,[amkolosyys_2014]
      ,[ylamkopiskkoulk_2014]
      ,[ylamkopiskjarj_2014]
      ,[ylamkkmaak_2014]
      ,[ylamkolotamm_2014]
      ,[ylamkolosyys_2014]
      ,[alkkopiskkoulk_2014]
      ,[alkkopiskjarj_2014]
      ,[alkkkmaak_2014]
      ,[alkkolotamm_2014]
      ,[alkkolosyys_2014]
      ,[ylkkopiskkoulk_2014]
      ,[ylkkopiskjarj_2014]
      ,[ylkkkmaak_2014]
      ,[ylkkolotamm_2014]
      ,[ylkkolosyys_2014]
      ,[tkopiskkoulk_2014]
      ,[tkopiskjarj_2014]
      ,[tkkmaak_2014]
      ,[tkolotamm_2014]
      ,[tkolosyys_2014]
      ,[muutaopiskkoulk_2014]
      ,[muutaopiskjarj_2014]
      ,[muutakmaak_2014]
      ,[muutaolotamm_2014]
      ,[muutaolosyys_2014]
      ,[ptoim1r5_2014]
      ,[amas_2014]


-- UUSI VUOSI

      ,[lkm]
      ,[tietolahde]=''K3_10_sopv_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv, alvv, allk)
      ,[aineistorivinumero] = ROW_NUMBER() OVER(ORDER BY tilv, alvv, allk)
  FROM [TK_H9098_CSC].[dbo].[TK_K3_10_sopv_16]
 
 --28.8.2013 Poistetaan maanpuolustuskoulutus jamuut 999999-alkuiset
WHERE left(jarj,6) <> ''999999''
--testausta /Jarmo
--and   alvv=''2008'' and allk=''2''




' 
GO
/****** Object:  View [dbo].[v_sa_K3_10_Tutk_suor_osuus_aloittaneista_korkeakoulut_nykytila]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_K3_10_Tutk_suor_osuus_aloittaneista_korkeakoulut_nykytila]'))
EXEC dbo.sp_executesql @statement = N'


CREATE VIEW [dbo].[v_sa_K3_10_Tutk_suor_osuus_aloittaneista_korkeakoulut_nykytila] AS
SELECT
    [tilv]
   ,[lahde]
   ,[sp]
   ,[syntv]
   ,[aikielir1]
   ,[alvv]
   ,[allk] = 
   -- Tampereen teknisen yliopiston kevään ja syksyn opiskelijamäärät ovat väärin päin aloitusvuosilla 2004 ja 2006.
   -- Korjataan virhe kääntämällä aloituskaudet toisin päin.
   -- CSC Jarmo 21.3.2014
    CASE 
      WHEN jarj=''624001-8'' AND alvv = ''2004'' and (alkkopiskjarj_2004<>'''' or ylkkopiskjarj_2004<>'''' or alkkopiskjarj_2005<>'''' or ylkkopiskjarj_2005<>'''')
        THEN CASE WHEN allk=''1'' THEN ''2'' WHEN allk=''2'' THEN ''1'' ELSE allk END
      WHEN jarj=''624001-8'' AND alvv = ''2006'' and (alkkopiskjarj_2006<>'''' or ylkkopiskjarj_2006<>'''' or alkkopiskjarj_2007<>'''' or ylkkopiskjarj_2007<>'''')
        THEN CASE WHEN allk=''1'' THEN ''2'' WHEN allk=''2'' THEN ''1'' ELSE allk END
      ELSE allk
    END
   ,[alvv_kk]
   ,[allk_kk] =
   -- Tampereen teknisen yliopiston kevään ja syksyn opiskelijamäärät ovat väärin päin aloitusvuosilla 2004 ja 2006.
   -- Korjataan virhe kääntämällä aloituskaudet toisin päin.
   -- CSC Jarmo 21.3.2014
    CASE 
      WHEN jarj=''624001-8'' AND alvv_kk = ''2004'' and (alkkopiskjarj_2004<>'''' or ylkkopiskjarj_2004<>'''' or alkkopiskjarj_2005<>'''' or ylkkopiskjarj_2005<>'''')
        THEN CASE WHEN allk_kk=''1'' THEN ''2'' WHEN allk_kk=''2'' THEN ''1'' ELSE allk_kk END
      WHEN jarj=''624001-8'' AND alvv_kk = ''2006'' and (alkkopiskjarj_2006<>'''' or ylkkopiskjarj_2006<>'''' or alkkopiskjarj_2007<>'''' or ylkkopiskjarj_2007<>'''')
        THEN CASE WHEN allk_kk=''1'' THEN ''2'' WHEN allk_kk=''2'' THEN ''1'' ELSE allk_kk END
      ELSE allk_kk
    END
   ,[ololk]
   ,[klaji]
   ,[jarj] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[jarj]), [jarj])
   ,[kkun] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_kunta_nykytila] WHERE alueluokitus_koodi=[kkun]), [kkun])
   ,[koulk] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[koulk]), [koulk])
   ,[pohjkoulk] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[pohjkoulk]), [pohjkoulk])
   ,[rahlahde]
   ,[amksuorv_2000]
   ,[amksuorlk_2000]
   ,[amktutkkmaak_2000] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[amktutkkmaak_2000]), [amktutkkmaak_2000])
   ,[amktutkjarj_2000] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[amktutkjarj_2000]), [amktutkjarj_2000])
   ,[amktutkkoulk_2000] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[amktutkkoulk_2000]), [amktutkkoulk_2000])
   ,[ylamksuorv_2000]
   ,[ylamksuorlk_2000]
   ,[ylamktutkkmaak_2000] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ylamktutkkmaak_2000]), [ylamktutkkmaak_2000])
   ,[ylamktutkjarj_2000] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ylamktutkjarj_2000]), [ylamktutkjarj_2000])
   ,[ylamktutkkoulk_2000] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ylamktutkkoulk_2000]), [ylamktutkkoulk_2000])
   ,[alkksuorv_2000]
   ,[alkksuorlk_2000]
   ,[alkktutkkmaak_2000] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[alkktutkkmaak_2000]), [alkktutkkmaak_2000])
   ,[alkktutkjarj_2000] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[alkktutkjarj_2000]), [alkktutkjarj_2000])
   ,[alkktutkkoulk_2000] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[alkktutkkoulk_2000]), [alkktutkkoulk_2000])
   ,[ylkksuorv_2000]
   ,[ylkksuorlk_2000]
   ,[ylkktutkkmaak_2000] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ylkktutkkmaak_2000]), [ylkktutkkmaak_2000])
   ,[ylkktutkjarj_2000] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ylkktutkjarj_2000]), [ylkktutkjarj_2000])
   ,[ylkktutkkoulk_2000] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ylkktutkkoulk_2000]), [ylkktutkkoulk_2000])
   ,[tksuorv_2000]
   ,[tksuorlk_2000]
   ,[tktutkkmaak_2000] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[tktutkkmaak_2000]), [tktutkkmaak_2000])
   ,[tktutkjarj_2000] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[tktutkjarj_2000]), [tktutkjarj_2000])
   ,[tktutkkoulk_2000] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[tktutkkoulk_2000]), [tktutkkoulk_2000])
   ,[muutasuorv_2000]
   ,[muutasuorlk_2000]
   ,[muutatutkkmaak_2000] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[muutatutkkmaak_2000]), [muutatutkkmaak_2000])
   ,[muutatutkjarj_2000] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[muutatutkjarj_2000]), [muutatutkjarj_2000])
   ,[muutatutkkoulk_2000] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[muutatutkkoulk_2000]), [muutatutkkoulk_2000])
   ,[amksuorv_2001]
   ,[amksuorlk_2001]
   ,[amktutkkmaak_2001] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[amktutkkmaak_2001]), [amktutkkmaak_2001])
   ,[amktutkjarj_2001] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[amktutkjarj_2001]), [amktutkjarj_2001])
   ,[amktutkkoulk_2001] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[amktutkkoulk_2001]), [amktutkkoulk_2001])
   ,[ylamksuorv_2001]
   ,[ylamksuorlk_2001]
   ,[ylamktutkkmaak_2001] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ylamktutkkmaak_2001]), [ylamktutkkmaak_2001])
   ,[ylamktutkjarj_2001] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ylamktutkjarj_2001]), [ylamktutkjarj_2001])
   ,[ylamktutkkoulk_2001] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ylamktutkkoulk_2001]), [ylamktutkkoulk_2001])
   ,[alkksuorv_2001]
   ,[alkksuorlk_2001]
   ,[alkktutkkmaak_2001] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[alkktutkkmaak_2001]), [alkktutkkmaak_2001])
   ,[alkktutkjarj_2001] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[alkktutkjarj_2001]), [alkktutkjarj_2001])
   ,[alkktutkkoulk_2001] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[alkktutkkoulk_2001]), [alkktutkkoulk_2001])
   ,[ylkksuorv_2001]
   ,[ylkksuorlk_2001]
   ,[ylkktutkkmaak_2001] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ylkktutkkmaak_2001]), [ylkktutkkmaak_2001])
   ,[ylkktutkjarj_2001] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ylkktutkjarj_2001]), [ylkktutkjarj_2001])
   ,[ylkktutkkoulk_2001] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ylkktutkkoulk_2001]), [ylkktutkkoulk_2001])
   ,[tksuorv_2001]
   ,[tksuorlk_2001]
   ,[tktutkkmaak_2001] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[tktutkkmaak_2001]), [tktutkkmaak_2001])
   ,[tktutkjarj_2001] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[tktutkjarj_2001]), [tktutkjarj_2001])
   ,[tktutkkoulk_2001] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[tktutkkoulk_2001]), [tktutkkoulk_2001])
   ,[muutasuorv_2001]
   ,[muutasuorlk_2001]
   ,[muutatutkkmaak_2001] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[muutatutkkmaak_2001]), [muutatutkkmaak_2001])
   ,[muutatutkjarj_2001] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[muutatutkjarj_2001]), [muutatutkjarj_2001])
   ,[muutatutkkoulk_2001] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[muutatutkkoulk_2001]), [muutatutkkoulk_2001])
   ,[amksuorv_2002]
   ,[amksuorlk_2002]
   ,[amktutkkmaak_2002] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[amktutkkmaak_2002]), [amktutkkmaak_2002])
   ,[amktutkjarj_2002] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[amktutkjarj_2002]), [amktutkjarj_2002])
   ,[amktutkkoulk_2002] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[amktutkkoulk_2002]), [amktutkkoulk_2002])
   ,[ylamksuorv_2002]
   ,[ylamksuorlk_2002]
   ,[ylamktutkkmaak_2002] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ylamktutkkmaak_2002]), [ylamktutkkmaak_2002])
   ,[ylamktutkjarj_2002] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ylamktutkjarj_2002]), [ylamktutkjarj_2002])
   ,[ylamktutkkoulk_2002] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ylamktutkkoulk_2002]), [ylamktutkkoulk_2002])
   ,[alkksuorv_2002]
   ,[alkksuorlk_2002]
   ,[alkktutkkmaak_2002] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[alkktutkkmaak_2002]), [alkktutkkmaak_2002])
   ,[alkktutkjarj_2002] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[alkktutkjarj_2002]), [alkktutkjarj_2002])
   ,[alkktutkkoulk_2002] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[alkktutkkoulk_2002]), [alkktutkkoulk_2002])
   ,[ylkksuorv_2002]
   ,[ylkksuorlk_2002]
   ,[ylkktutkkmaak_2002] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ylkktutkkmaak_2002]), [ylkktutkkmaak_2002])
   ,[ylkktutkjarj_2002] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ylkktutkjarj_2002]), [ylkktutkjarj_2002])
   ,[ylkktutkkoulk_2002] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ylkktutkkoulk_2002]), [ylkktutkkoulk_2002])
   ,[tksuorv_2002]
   ,[tksuorlk_2002]
   ,[tktutkkmaak_2002] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[tktutkkmaak_2002]), [tktutkkmaak_2002])
   ,[tktutkjarj_2002] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[tktutkjarj_2002]), [tktutkjarj_2002])
   ,[tktutkkoulk_2002] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[tktutkkoulk_2002]), [tktutkkoulk_2002])
   ,[muutasuorv_2002]
   ,[muutasuorlk_2002]
   ,[muutatutkkmaak_2002] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[muutatutkkmaak_2002]), [muutatutkkmaak_2002])
   ,[muutatutkjarj_2002] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[muutatutkjarj_2002]), [muutatutkjarj_2002])
   ,[muutatutkkoulk_2002] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[muutatutkkoulk_2002]), [muutatutkkoulk_2002])
   ,[amksuorv_2003]
   ,[amksuorlk_2003]
   ,[amktutkkmaak_2003] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[amktutkkmaak_2003]), [amktutkkmaak_2003])
   ,[amktutkjarj_2003] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[amktutkjarj_2003]), [amktutkjarj_2003])
   ,[amktutkkoulk_2003] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[amktutkkoulk_2003]), [amktutkkoulk_2003])
   ,[ylamksuorv_2003]
   ,[ylamksuorlk_2003]
   ,[ylamktutkkmaak_2003] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ylamktutkkmaak_2003]), [ylamktutkkmaak_2003])
   ,[ylamktutkjarj_2003] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ylamktutkjarj_2003]), [ylamktutkjarj_2003])
   ,[ylamktutkkoulk_2003] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ylamktutkkoulk_2003]), [ylamktutkkoulk_2003])
   ,[alkksuorv_2003]
   ,[alkksuorlk_2003]
   ,[alkktutkkmaak_2003] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[alkktutkkmaak_2003]), [alkktutkkmaak_2003])
   ,[alkktutkjarj_2003] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[alkktutkjarj_2003]), [alkktutkjarj_2003])
   ,[alkktutkkoulk_2003] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[alkktutkkoulk_2003]), [alkktutkkoulk_2003])
   ,[ylkksuorv_2003]
   ,[ylkksuorlk_2003]
   ,[ylkktutkkmaak_2003] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ylkktutkkmaak_2003]), [ylkktutkkmaak_2003])
   ,[ylkktutkjarj_2003] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ylkktutkjarj_2003]), [ylkktutkjarj_2003])
   ,[ylkktutkkoulk_2003] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ylkktutkkoulk_2003]), [ylkktutkkoulk_2003])
   ,[tksuorv_2003]
   ,[tksuorlk_2003]
   ,[tktutkkmaak_2003] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[tktutkkmaak_2003]), [tktutkkmaak_2003])
   ,[tktutkjarj_2003] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[tktutkjarj_2003]), [tktutkjarj_2003])
   ,[tktutkkoulk_2003] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[tktutkkoulk_2003]), [tktutkkoulk_2003])
   ,[muutasuorv_2003]
   ,[muutasuorlk_2003]
   ,[muutatutkkmaak_2003] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[muutatutkkmaak_2003]), [muutatutkkmaak_2003])
   ,[muutatutkjarj_2003] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[muutatutkjarj_2003]), [muutatutkjarj_2003])
   ,[muutatutkkoulk_2003] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[muutatutkkoulk_2003]), [muutatutkkoulk_2003])
   ,[amksuorv_2004]
   ,[amksuorlk_2004]
   ,[amktutkkmaak_2004] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[amktutkkmaak_2004]), [amktutkkmaak_2004])
   ,[amktutkjarj_2004] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[amktutkjarj_2004]), [amktutkjarj_2004])
   ,[amktutkkoulk_2004] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[amktutkkoulk_2004]), [amktutkkoulk_2004])
   ,[ylamksuorv_2004]
   ,[ylamksuorlk_2004]
   ,[ylamktutkkmaak_2004] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ylamktutkkmaak_2004]), [ylamktutkkmaak_2004])
   ,[ylamktutkjarj_2004] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ylamktutkjarj_2004]), [ylamktutkjarj_2004])
   ,[ylamktutkkoulk_2004] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ylamktutkkoulk_2004]), [ylamktutkkoulk_2004])
   ,[alkksuorv_2004]
   ,[alkksuorlk_2004]
   ,[alkktutkkmaak_2004] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[alkktutkkmaak_2004]), [alkktutkkmaak_2004])
   ,[alkktutkjarj_2004] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[alkktutkjarj_2004]), [alkktutkjarj_2004])
   ,[alkktutkkoulk_2004] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[alkktutkkoulk_2004]), [alkktutkkoulk_2004])
   ,[ylkksuorv_2004]
   ,[ylkksuorlk_2004]
   ,[ylkktutkkmaak_2004] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ylkktutkkmaak_2004]), [ylkktutkkmaak_2004])
   ,[ylkktutkjarj_2004] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ylkktutkjarj_2004]), [ylkktutkjarj_2004])
   ,[ylkktutkkoulk_2004] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ylkktutkkoulk_2004]), [ylkktutkkoulk_2004])
   ,[tksuorv_2004]
   ,[tksuorlk_2004]
   ,[tktutkkmaak_2004] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[tktutkkmaak_2004]), [tktutkkmaak_2004])
   ,[tktutkjarj_2004] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[tktutkjarj_2004]), [tktutkjarj_2004])
   ,[tktutkkoulk_2004] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[tktutkkoulk_2004]), [tktutkkoulk_2004])
   ,[muutasuorv_2004]
   ,[muutasuorlk_2004]
   ,[muutatutkkmaak_2004] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[muutatutkkmaak_2004]), [muutatutkkmaak_2004])
   ,[muutatutkjarj_2004] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[muutatutkjarj_2004]), [muutatutkjarj_2004])
   ,[muutatutkkoulk_2004] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[muutatutkkoulk_2004]), [muutatutkkoulk_2004])
   ,[amksuorv_2005]
   ,[amksuorlk_2005]
   ,[amktutkkmaak_2005] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[amktutkkmaak_2005]), [amktutkkmaak_2005])
   ,[amktutkjarj_2005] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[amktutkjarj_2005]), [amktutkjarj_2005])
   ,[amktutkkoulk_2005] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[amktutkkoulk_2005]), [amktutkkoulk_2005])
   ,[ylamksuorv_2005]
   ,[ylamksuorlk_2005]
   ,[ylamktutkkmaak_2005] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ylamktutkkmaak_2005]), [ylamktutkkmaak_2005])
   ,[ylamktutkjarj_2005] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ylamktutkjarj_2005]), [ylamktutkjarj_2005])
   ,[ylamktutkkoulk_2005] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ylamktutkkoulk_2005]), [ylamktutkkoulk_2005])
   ,[alkksuorv_2005]
   ,[alkksuorlk_2005]
   ,[alkktutkkmaak_2005] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[alkktutkkmaak_2005]), [alkktutkkmaak_2005])
   ,[alkktutkjarj_2005] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[alkktutkjarj_2005]), [alkktutkjarj_2005])
   ,[alkktutkkoulk_2005] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[alkktutkkoulk_2005]), [alkktutkkoulk_2005])
   ,[ylkksuorv_2005]
   ,[ylkksuorlk_2005]
   ,[ylkktutkkmaak_2005] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ylkktutkkmaak_2005]), [ylkktutkkmaak_2005])
   ,[ylkktutkjarj_2005] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ylkktutkjarj_2005]), [ylkktutkjarj_2005])
   ,[ylkktutkkoulk_2005] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ylkktutkkoulk_2005]), [ylkktutkkoulk_2005])
   ,[tksuorv_2005]
   ,[tksuorlk_2005]
   ,[tktutkkmaak_2005] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[tktutkkmaak_2005]), [tktutkkmaak_2005])
   ,[tktutkjarj_2005] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[tktutkjarj_2005]), [tktutkjarj_2005])
   ,[tktutkkoulk_2005] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[tktutkkoulk_2005]), [tktutkkoulk_2005])
   ,[muutasuorv_2005]
   ,[muutasuorlk_2005]
   ,[muutatutkkmaak_2005] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[muutatutkkmaak_2005]), [muutatutkkmaak_2005])
   ,[muutatutkjarj_2005] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[muutatutkjarj_2005]), [muutatutkjarj_2005])
   ,[muutatutkkoulk_2005] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[muutatutkkoulk_2005]), [muutatutkkoulk_2005])
   ,[amksuorv_2006]
   ,[amksuorlk_2006]
   ,[amktutkkmaak_2006] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[amktutkkmaak_2006]), [amktutkkmaak_2006])
   ,[amktutkjarj_2006] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[amktutkjarj_2006]), [amktutkjarj_2006])
   ,[amktutkkoulk_2006] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[amktutkkoulk_2006]), [amktutkkoulk_2006])
   ,[ylamksuorv_2006]
   ,[ylamksuorlk_2006]
   ,[ylamktutkkmaak_2006] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ylamktutkkmaak_2006]), [ylamktutkkmaak_2006])
   ,[ylamktutkjarj_2006] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ylamktutkjarj_2006]), [ylamktutkjarj_2006])
   ,[ylamktutkkoulk_2006] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ylamktutkkoulk_2006]), [ylamktutkkoulk_2006])
   ,[alkksuorv_2006]
   ,[alkksuorlk_2006]
   ,[alkktutkkmaak_2006] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[alkktutkkmaak_2006]), [alkktutkkmaak_2006])
   ,[alkktutkjarj_2006] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[alkktutkjarj_2006]), [alkktutkjarj_2006])
   ,[alkktutkkoulk_2006] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[alkktutkkoulk_2006]), [alkktutkkoulk_2006])
   ,[ylkksuorv_2006]
   ,[ylkksuorlk_2006]
   ,[ylkktutkkmaak_2006] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ylkktutkkmaak_2006]), [ylkktutkkmaak_2006])
   ,[ylkktutkjarj_2006] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ylkktutkjarj_2006]), [ylkktutkjarj_2006])
   ,[ylkktutkkoulk_2006] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ylkktutkkoulk_2006]), [ylkktutkkoulk_2006])
   ,[tksuorv_2006]
   ,[tksuorlk_2006]
   ,[tktutkkmaak_2006] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[tktutkkmaak_2006]), [tktutkkmaak_2006])
   ,[tktutkjarj_2006] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[tktutkjarj_2006]), [tktutkjarj_2006])
   ,[tktutkkoulk_2006] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[tktutkkoulk_2006]), [tktutkkoulk_2006])
   ,[muutasuorv_2006]
   ,[muutasuorlk_2006]
   ,[muutatutkkmaak_2006] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[muutatutkkmaak_2006]), [muutatutkkmaak_2006])
   ,[muutatutkjarj_2006] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[muutatutkjarj_2006]), [muutatutkjarj_2006])
   ,[muutatutkkoulk_2006] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[muutatutkkoulk_2006]), [muutatutkkoulk_2006])
   ,[amksuorv_2007]
   ,[amksuorlk_2007]
   ,[amktutkkmaak_2007] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[amktutkkmaak_2007]), [amktutkkmaak_2007])
   ,[amktutkjarj_2007] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[amktutkjarj_2007]), [amktutkjarj_2007])
   ,[amktutkkoulk_2007] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[amktutkkoulk_2007]), [amktutkkoulk_2007])
   ,[ylamksuorv_2007]
   ,[ylamksuorlk_2007]
   ,[ylamktutkkmaak_2007] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ylamktutkkmaak_2007]), [ylamktutkkmaak_2007])
   ,[ylamktutkjarj_2007] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ylamktutkjarj_2007]), [ylamktutkjarj_2007])
   ,[ylamktutkkoulk_2007] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ylamktutkkoulk_2007]), [ylamktutkkoulk_2007])
   ,[alkksuorv_2007]
   ,[alkksuorlk_2007]
   ,[alkktutkkmaak_2007] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[alkktutkkmaak_2007]), [alkktutkkmaak_2007])
   ,[alkktutkjarj_2007] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[alkktutkjarj_2007]), [alkktutkjarj_2007])
   ,[alkktutkkoulk_2007] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[alkktutkkoulk_2007]), [alkktutkkoulk_2007])
   ,[ylkksuorv_2007]
   ,[ylkksuorlk_2007]
   ,[ylkktutkkmaak_2007] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ylkktutkkmaak_2007]), [ylkktutkkmaak_2007])
   ,[ylkktutkjarj_2007] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ylkktutkjarj_2007]), [ylkktutkjarj_2007])
   ,[ylkktutkkoulk_2007] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ylkktutkkoulk_2007]), [ylkktutkkoulk_2007])
   ,[tksuorv_2007]
   ,[tksuorlk_2007]
   ,[tktutkkmaak_2007] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[tktutkkmaak_2007]), [tktutkkmaak_2007])
   ,[tktutkjarj_2007] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[tktutkjarj_2007]), [tktutkjarj_2007])
   ,[tktutkkoulk_2007] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[tktutkkoulk_2007]), [tktutkkoulk_2007])
   ,[muutasuorv_2007]
   ,[muutasuorlk_2007]
   ,[muutatutkkmaak_2007] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[muutatutkkmaak_2007]), [muutatutkkmaak_2007])
   ,[muutatutkjarj_2007] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[muutatutkjarj_2007]), [muutatutkjarj_2007])
   ,[muutatutkkoulk_2007] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[muutatutkkoulk_2007]), [muutatutkkoulk_2007])
   ,[amksuorv_2008]
   ,[amksuorlk_2008]
   ,[amktutkkmaak_2008] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[amktutkkmaak_2008]), [amktutkkmaak_2008])
   ,[amktutkjarj_2008] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[amktutkjarj_2008]), [amktutkjarj_2008])
   ,[amktutkkoulk_2008] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[amktutkkoulk_2008]), [amktutkkoulk_2008])
   ,[ylamksuorv_2008]
   ,[ylamksuorlk_2008]
   ,[ylamktutkkmaak_2008] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ylamktutkkmaak_2008]), [ylamktutkkmaak_2008])
   ,[ylamktutkjarj_2008] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ylamktutkjarj_2008]), [ylamktutkjarj_2008])
   ,[ylamktutkkoulk_2008] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ylamktutkkoulk_2008]), [ylamktutkkoulk_2008])
   ,[alkksuorv_2008]
   ,[alkksuorlk_2008]
   ,[alkktutkkmaak_2008] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[alkktutkkmaak_2008]), [alkktutkkmaak_2008])
   ,[alkktutkjarj_2008] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[alkktutkjarj_2008]), [alkktutkjarj_2008])
   ,[alkktutkkoulk_2008] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[alkktutkkoulk_2008]), [alkktutkkoulk_2008])
   ,[ylkksuorv_2008]
   ,[ylkksuorlk_2008]
   ,[ylkktutkkmaak_2008] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ylkktutkkmaak_2008]), [ylkktutkkmaak_2008])
   ,[ylkktutkjarj_2008] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ylkktutkjarj_2008]), [ylkktutkjarj_2008])
   ,[ylkktutkkoulk_2008] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ylkktutkkoulk_2008]), [ylkktutkkoulk_2008])
   ,[tksuorv_2008]
   ,[tksuorlk_2008]
   ,[tktutkkmaak_2008] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[tktutkkmaak_2008]), [tktutkkmaak_2008])
   ,[tktutkjarj_2008] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[tktutkjarj_2008]), [tktutkjarj_2008])
   ,[tktutkkoulk_2008] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[tktutkkoulk_2008]), [tktutkkoulk_2008])
   ,[muutasuorv_2008]
   ,[muutasuorlk_2008]
   ,[muutatutkkmaak_2008] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[muutatutkkmaak_2008]), [muutatutkkmaak_2008])
   ,[muutatutkjarj_2008] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[muutatutkjarj_2008]), [muutatutkjarj_2008])
   ,[muutatutkkoulk_2008] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[muutatutkkoulk_2008]), [muutatutkkoulk_2008])
   ,[amksuorv_2009]
   ,[amksuorlk_2009]
   ,[amktutkkmaak_2009] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[amktutkkmaak_2009]), [amktutkkmaak_2009])
   ,[amktutkjarj_2009] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[amktutkjarj_2009]), [amktutkjarj_2009])
   ,[amktutkkoulk_2009] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[amktutkkoulk_2009]), [amktutkkoulk_2009])
   ,[ylamksuorv_2009]
   ,[ylamksuorlk_2009]
   ,[ylamktutkkmaak_2009] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ylamktutkkmaak_2009]), [ylamktutkkmaak_2009])
   ,[ylamktutkjarj_2009] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ylamktutkjarj_2009]), [ylamktutkjarj_2009])
   ,[ylamktutkkoulk_2009] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ylamktutkkoulk_2009]), [ylamktutkkoulk_2009])
   ,[alkksuorv_2009]
   ,[alkksuorlk_2009]
   ,[alkktutkkmaak_2009] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[alkktutkkmaak_2009]), [alkktutkkmaak_2009])
   ,[alkktutkjarj_2009] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[alkktutkjarj_2009]), [alkktutkjarj_2009])
   ,[alkktutkkoulk_2009] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[alkktutkkoulk_2009]), [alkktutkkoulk_2009])
   ,[ylkksuorv_2009]
   ,[ylkksuorlk_2009]
   ,[ylkktutkkmaak_2009] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ylkktutkkmaak_2009]), [ylkktutkkmaak_2009])
   ,[ylkktutkjarj_2009] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ylkktutkjarj_2009]), [ylkktutkjarj_2009])
   ,[ylkktutkkoulk_2009] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ylkktutkkoulk_2009]), [ylkktutkkoulk_2009])
   ,[tksuorv_2009]
   ,[tksuorlk_2009]
   ,[tktutkkmaak_2009] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[tktutkkmaak_2009]), [tktutkkmaak_2009])
   ,[tktutkjarj_2009] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[tktutkjarj_2009]), [tktutkjarj_2009])
   ,[tktutkkoulk_2009] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[tktutkkoulk_2009]), [tktutkkoulk_2009])
   ,[muutasuorv_2009]
   ,[muutasuorlk_2009]
   ,[muutatutkkmaak_2009] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[muutatutkkmaak_2009]), [muutatutkkmaak_2009])
   ,[muutatutkjarj_2009] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[muutatutkjarj_2009]), [muutatutkjarj_2009])
   ,[muutatutkkoulk_2009] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[muutatutkkoulk_2009]), [muutatutkkoulk_2009])
   ,[amkopiskkoulk_2000] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[amkopiskkoulk_2000]), [amkopiskkoulk_2000])
   ,[amkopiskjarj_2000] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[amkopiskjarj_2000]), [amkopiskjarj_2000])
   ,[amkkmaak_2000] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[amkkmaak_2000]), [amkkmaak_2000])
   ,[amkolotamm_2000]
   ,[amkolosyys_2000]
   ,[ylamkopiskkoulk_2000] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ylamkopiskkoulk_2000]), [ylamkopiskkoulk_2000])
   ,[ylamkopiskjarj_2000] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ylamkopiskjarj_2000]), [ylamkopiskjarj_2000])
   ,[ylamkkmaak_2000] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ylamkkmaak_2000]), [ylamkkmaak_2000])
   ,[ylamkolotamm_2000]
   ,[ylamkolosyys_2000]
   ,[alkkopiskkoulk_2000] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[alkkopiskkoulk_2000]), [alkkopiskkoulk_2000])
   ,[alkkopiskjarj_2000] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[alkkopiskjarj_2000]), [alkkopiskjarj_2000])
   ,[alkkkmaak_2000] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[alkkkmaak_2000]), [alkkkmaak_2000])
   ,[alkkolotamm_2000]
   ,[alkkolosyys_2000]
   ,[ylkkopiskkoulk_2000] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ylkkopiskkoulk_2000]), [ylkkopiskkoulk_2000])
   ,[ylkkopiskjarj_2000] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ylkkopiskjarj_2000]), [ylkkopiskjarj_2000])
   ,[ylkkkmaak_2000] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ylkkkmaak_2000]), [ylkkkmaak_2000])
   ,[ylkkolotamm_2000]
   ,[ylkkolosyys_2000]
   ,[tkopiskkoulk_2000] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[tkopiskkoulk_2000]), [tkopiskkoulk_2000])
   ,[tkopiskjarj_2000] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[tkopiskjarj_2000]), [tkopiskjarj_2000])
   ,[tkkmaak_2000] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[tkkmaak_2000]), [tkkmaak_2000])
   ,[tkolotamm_2000]
   ,[tkolosyys_2000]
   ,[muutaopiskkoulk_2000] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[muutaopiskkoulk_2000]), [muutaopiskkoulk_2000])
   ,[muutaopiskjarj_2000] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[muutaopiskjarj_2000]), [muutaopiskjarj_2000])
   ,[muutakmaak_2000] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[muutakmaak_2000]), [muutakmaak_2000])
   ,[muutaolotamm_2000]
   ,[muutaolosyys_2000]
   ,[amkopiskkoulk_2001] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[amkopiskkoulk_2001]), [amkopiskkoulk_2001])
   ,[amkopiskjarj_2001] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[amkopiskjarj_2001]), [amkopiskjarj_2001])
   ,[amkkmaak_2001] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[amkkmaak_2001]), [amkkmaak_2001])
   ,[amkolotamm_2001]
   ,[amkolosyys_2001]
   ,[ylamkopiskkoulk_2001] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ylamkopiskkoulk_2001]), [ylamkopiskkoulk_2001])
   ,[ylamkopiskjarj_2001] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ylamkopiskjarj_2001]), [ylamkopiskjarj_2001])
   ,[ylamkkmaak_2001] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ylamkkmaak_2001]), [ylamkkmaak_2001])
   ,[ylamkolotamm_2001]
   ,[ylamkolosyys_2001]
   ,[alkkopiskkoulk_2001] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[alkkopiskkoulk_2001]), [alkkopiskkoulk_2001])
   ,[alkkopiskjarj_2001] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[alkkopiskjarj_2001]), [alkkopiskjarj_2001])
   ,[alkkkmaak_2001] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[alkkkmaak_2001]), [alkkkmaak_2001])
   ,[alkkolotamm_2001]
   ,[alkkolosyys_2001]
   ,[ylkkopiskkoulk_2001] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ylkkopiskkoulk_2001]), [ylkkopiskkoulk_2001])
   ,[ylkkopiskjarj_2001] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ylkkopiskjarj_2001]), [ylkkopiskjarj_2001])
   ,[ylkkkmaak_2001] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ylkkkmaak_2001]), [ylkkkmaak_2001])
   ,[ylkkolotamm_2001]
   ,[ylkkolosyys_2001]
   ,[tkopiskkoulk_2001] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[tkopiskkoulk_2001]), [tkopiskkoulk_2001])
   ,[tkopiskjarj_2001] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[tkopiskjarj_2001]), [tkopiskjarj_2001])
   ,[tkkmaak_2001] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[tkkmaak_2001]), [tkkmaak_2001])
   ,[tkolotamm_2001]
   ,[tkolosyys_2001]
   ,[muutaopiskkoulk_2001] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[muutaopiskkoulk_2001]), [muutaopiskkoulk_2001])
   ,[muutaopiskjarj_2001] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[muutaopiskjarj_2001]), [muutaopiskjarj_2001])
   ,[muutakmaak_2001] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[muutakmaak_2001]), [muutakmaak_2001])
   ,[muutaolotamm_2001]
   ,[muutaolosyys_2001]
   ,[amkopiskkoulk_2002] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[amkopiskkoulk_2002]), [amkopiskkoulk_2002])
   ,[amkopiskjarj_2002] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[amkopiskjarj_2002]), [amkopiskjarj_2002])
   ,[amkkmaak_2002] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[amkkmaak_2002]), [amkkmaak_2002])
   ,[amkolotamm_2002]
   ,[amkolosyys_2002]
   ,[ylamkopiskkoulk_2002] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ylamkopiskkoulk_2002]), [ylamkopiskkoulk_2002])
   ,[ylamkopiskjarj_2002] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ylamkopiskjarj_2002]), [ylamkopiskjarj_2002])
   ,[ylamkkmaak_2002] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ylamkkmaak_2002]), [ylamkkmaak_2002])
   ,[ylamkolotamm_2002]
   ,[ylamkolosyys_2002]
   ,[alkkopiskkoulk_2002] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[alkkopiskkoulk_2002]), [alkkopiskkoulk_2002])
   ,[alkkopiskjarj_2002] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[alkkopiskjarj_2002]), [alkkopiskjarj_2002])
   ,[alkkkmaak_2002] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[alkkkmaak_2002]), [alkkkmaak_2002])
   ,[alkkolotamm_2002]
   ,[alkkolosyys_2002]
   ,[ylkkopiskkoulk_2002] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ylkkopiskkoulk_2002]), [ylkkopiskkoulk_2002])
   ,[ylkkopiskjarj_2002] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ylkkopiskjarj_2002]), [ylkkopiskjarj_2002])
   ,[ylkkkmaak_2002] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ylkkkmaak_2002]), [ylkkkmaak_2002])
   ,[ylkkolotamm_2002]
   ,[ylkkolosyys_2002]
   ,[tkopiskkoulk_2002] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[tkopiskkoulk_2002]), [tkopiskkoulk_2002])
   ,[tkopiskjarj_2002] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[tkopiskjarj_2002]), [tkopiskjarj_2002])
   ,[tkkmaak_2002] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[tkkmaak_2002]), [tkkmaak_2002])
   ,[tkolotamm_2002]
   ,[tkolosyys_2002]
   ,[muutaopiskkoulk_2002] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[muutaopiskkoulk_2002]), [muutaopiskkoulk_2002])
   ,[muutaopiskjarj_2002] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[muutaopiskjarj_2002]), [muutaopiskjarj_2002])
   ,[muutakmaak_2002] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[muutakmaak_2002]), [muutakmaak_2002])
   ,[muutaolotamm_2002]
   ,[muutaolosyys_2002]
   ,[amkopiskkoulk_2003] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[amkopiskkoulk_2003]), [amkopiskkoulk_2003])
   ,[amkopiskjarj_2003] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[amkopiskjarj_2003]), [amkopiskjarj_2003])
   ,[amkkmaak_2003] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[amkkmaak_2003]), [amkkmaak_2003])
   ,[amkolotamm_2003]
   ,[amkolosyys_2003]
   ,[ylamkopiskkoulk_2003] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ylamkopiskkoulk_2003]), [ylamkopiskkoulk_2003])
   ,[ylamkopiskjarj_2003] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ylamkopiskjarj_2003]), [ylamkopiskjarj_2003])
   ,[ylamkkmaak_2003] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ylamkkmaak_2003]), [ylamkkmaak_2003])
   ,[ylamkolotamm_2003]
   ,[ylamkolosyys_2003]
   ,[alkkopiskkoulk_2003] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[alkkopiskkoulk_2003]), [alkkopiskkoulk_2003])
   ,[alkkopiskjarj_2003] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[alkkopiskjarj_2003]), [alkkopiskjarj_2003])
   ,[alkkkmaak_2003] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[alkkkmaak_2003]), [alkkkmaak_2003])
   ,[alkkolotamm_2003]
   ,[alkkolosyys_2003]
   ,[ylkkopiskkoulk_2003] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ylkkopiskkoulk_2003]), [ylkkopiskkoulk_2003])
   ,[ylkkopiskjarj_2003] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ylkkopiskjarj_2003]), [ylkkopiskjarj_2003])
   ,[ylkkkmaak_2003] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ylkkkmaak_2003]), [ylkkkmaak_2003])
   ,[ylkkolotamm_2003]
   ,[ylkkolosyys_2003]
   ,[tkopiskkoulk_2003] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[tkopiskkoulk_2003]), [tkopiskkoulk_2003])
   ,[tkopiskjarj_2003] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[tkopiskjarj_2003]), [tkopiskjarj_2003])
   ,[tkkmaak_2003] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[tkkmaak_2003]), [tkkmaak_2003])
   ,[tkolotamm_2003]
   ,[tkolosyys_2003]
   ,[muutaopiskkoulk_2003] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[muutaopiskkoulk_2003]), [muutaopiskkoulk_2003])
   ,[muutaopiskjarj_2003] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[muutaopiskjarj_2003]), [muutaopiskjarj_2003])
   ,[muutakmaak_2003] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[muutakmaak_2003]), [muutakmaak_2003])
   ,[muutaolotamm_2003]
   ,[muutaolosyys_2003]
   ,[amkopiskkoulk_2004] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[amkopiskkoulk_2004]), [amkopiskkoulk_2004])
   ,[amkopiskjarj_2004] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[amkopiskjarj_2004]), [amkopiskjarj_2004])
   ,[amkkmaak_2004] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[amkkmaak_2004]), [amkkmaak_2004])
   ,[amkolotamm_2004]
   ,[amkolosyys_2004]
   ,[ylamkopiskkoulk_2004] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ylamkopiskkoulk_2004]), [ylamkopiskkoulk_2004])
   ,[ylamkopiskjarj_2004] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ylamkopiskjarj_2004]), [ylamkopiskjarj_2004])
   ,[ylamkkmaak_2004] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ylamkkmaak_2004]), [ylamkkmaak_2004])
   ,[ylamkolotamm_2004]
   ,[ylamkolosyys_2004]
   ,[alkkopiskkoulk_2004] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[alkkopiskkoulk_2004]), [alkkopiskkoulk_2004])
   ,[alkkopiskjarj_2004] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[alkkopiskjarj_2004]), [alkkopiskjarj_2004])
   ,[alkkkmaak_2004] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[alkkkmaak_2004]), [alkkkmaak_2004])
   ,[alkkolotamm_2004]
   ,[alkkolosyys_2004]
   ,[ylkkopiskkoulk_2004] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ylkkopiskkoulk_2004]), [ylkkopiskkoulk_2004])
   ,[ylkkopiskjarj_2004] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ylkkopiskjarj_2004]), [ylkkopiskjarj_2004])
   ,[ylkkkmaak_2004] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ylkkkmaak_2004]), [ylkkkmaak_2004])
   ,[ylkkolotamm_2004]
   ,[ylkkolosyys_2004]
   ,[tkopiskkoulk_2004] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[tkopiskkoulk_2004]), [tkopiskkoulk_2004])
   ,[tkopiskjarj_2004] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[tkopiskjarj_2004]), [tkopiskjarj_2004])
   ,[tkkmaak_2004] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[tkkmaak_2004]), [tkkmaak_2004])
   ,[tkolotamm_2004]
   ,[tkolosyys_2004]
   ,[muutaopiskkoulk_2004] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[muutaopiskkoulk_2004]), [muutaopiskkoulk_2004])
   ,[muutaopiskjarj_2004] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[muutaopiskjarj_2004]), [muutaopiskjarj_2004])
   ,[muutakmaak_2004] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[muutakmaak_2004]), [muutakmaak_2004])
   ,[muutaolotamm_2004]
   ,[muutaolosyys_2004]
   ,[amkopiskkoulk_2005] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[amkopiskkoulk_2005]), [amkopiskkoulk_2005])
   ,[amkopiskjarj_2005] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[amkopiskjarj_2005]), [amkopiskjarj_2005])
   ,[amkkmaak_2005] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[amkkmaak_2005]), [amkkmaak_2005])
   ,[amkolotamm_2005]
   ,[amkolosyys_2005]
   ,[ylamkopiskkoulk_2005] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ylamkopiskkoulk_2005]), [ylamkopiskkoulk_2005])
   ,[ylamkopiskjarj_2005] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ylamkopiskjarj_2005]), [ylamkopiskjarj_2005])
   ,[ylamkkmaak_2005] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ylamkkmaak_2005]), [ylamkkmaak_2005])
   ,[ylamkolotamm_2005]
   ,[ylamkolosyys_2005]
   ,[alkkopiskkoulk_2005] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[alkkopiskkoulk_2005]), [alkkopiskkoulk_2005])
   ,[alkkopiskjarj_2005] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[alkkopiskjarj_2005]), [alkkopiskjarj_2005])
   ,[alkkkmaak_2005] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[alkkkmaak_2005]), [alkkkmaak_2005])
   ,[alkkolotamm_2005]
   ,[alkkolosyys_2005]
   ,[ylkkopiskkoulk_2005] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ylkkopiskkoulk_2005]), [ylkkopiskkoulk_2005])
   ,[ylkkopiskjarj_2005] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ylkkopiskjarj_2005]), [ylkkopiskjarj_2005])
   ,[ylkkkmaak_2005] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ylkkkmaak_2005]), [ylkkkmaak_2005])
   ,[ylkkolotamm_2005]
   ,[ylkkolosyys_2005]
   ,[tkopiskkoulk_2005] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[tkopiskkoulk_2005]), [tkopiskkoulk_2005])
   ,[tkopiskjarj_2005] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[tkopiskjarj_2005]), [tkopiskjarj_2005])
   ,[tkkmaak_2005] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[tkkmaak_2005]), [tkkmaak_2005])
   ,[tkolotamm_2005]
   ,[tkolosyys_2005]
   ,[muutaopiskkoulk_2005] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[muutaopiskkoulk_2005]), [muutaopiskkoulk_2005])
   ,[muutaopiskjarj_2005] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[muutaopiskjarj_2005]), [muutaopiskjarj_2005])
   ,[muutakmaak_2005] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[muutakmaak_2005]), [muutakmaak_2005])
   ,[muutaolotamm_2005]
   ,[muutaolosyys_2005]
   ,[amkopiskkoulk_2006] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[amkopiskkoulk_2006]), [amkopiskkoulk_2006])
   ,[amkopiskjarj_2006] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[amkopiskjarj_2006]), [amkopiskjarj_2006])
   ,[amkkmaak_2006] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[amkkmaak_2006]), [amkkmaak_2006])
   ,[amkolotamm_2006]
   ,[amkolosyys_2006]
   ,[ylamkopiskkoulk_2006] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ylamkopiskkoulk_2006]), [ylamkopiskkoulk_2006])
   ,[ylamkopiskjarj_2006] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ylamkopiskjarj_2006]), [ylamkopiskjarj_2006])
   ,[ylamkkmaak_2006] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ylamkkmaak_2006]), [ylamkkmaak_2006])
   ,[ylamkolotamm_2006]
   ,[ylamkolosyys_2006]
   ,[alkkopiskkoulk_2006] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[alkkopiskkoulk_2006]), [alkkopiskkoulk_2006])
   ,[alkkopiskjarj_2006] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[alkkopiskjarj_2006]), [alkkopiskjarj_2006])
   ,[alkkkmaak_2006] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[alkkkmaak_2006]), [alkkkmaak_2006])
   ,[alkkolotamm_2006]
   ,[alkkolosyys_2006]
   ,[ylkkopiskkoulk_2006] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ylkkopiskkoulk_2006]), [ylkkopiskkoulk_2006])
   ,[ylkkopiskjarj_2006] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ylkkopiskjarj_2006]), [ylkkopiskjarj_2006])
   ,[ylkkkmaak_2006] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ylkkkmaak_2006]), [ylkkkmaak_2006])
   ,[ylkkolotamm_2006]
   ,[ylkkolosyys_2006]
   ,[tkopiskkoulk_2006] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[tkopiskkoulk_2006]), [tkopiskkoulk_2006])
   ,[tkopiskjarj_2006] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[tkopiskjarj_2006]), [tkopiskjarj_2006])
   ,[tkkmaak_2006] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[tkkmaak_2006]), [tkkmaak_2006])
   ,[tkolotamm_2006]
   ,[tkolosyys_2006]
   ,[muutaopiskkoulk_2006] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[muutaopiskkoulk_2006]), [muutaopiskkoulk_2006])
   ,[muutaopiskjarj_2006] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[muutaopiskjarj_2006]), [muutaopiskjarj_2006])
   ,[muutakmaak_2006] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[muutakmaak_2006]), [muutakmaak_2006])
   ,[muutaolotamm_2006]
   ,[muutaolosyys_2006]
   ,[amkopiskkoulk_2007] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[amkopiskkoulk_2007]), [amkopiskkoulk_2007])
   ,[amkopiskjarj_2007] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[amkopiskjarj_2007]), [amkopiskjarj_2007])
   ,[amkkmaak_2007] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[amkkmaak_2007]), [amkkmaak_2007])
   ,[amkolotamm_2007]
   ,[amkolosyys_2007]
   ,[ylamkopiskkoulk_2007] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ylamkopiskkoulk_2007]), [ylamkopiskkoulk_2007])
   ,[ylamkopiskjarj_2007] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ylamkopiskjarj_2007]), [ylamkopiskjarj_2007])
   ,[ylamkkmaak_2007] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ylamkkmaak_2007]), [ylamkkmaak_2007])
   ,[ylamkolotamm_2007]
   ,[ylamkolosyys_2007]
   ,[alkkopiskkoulk_2007] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[alkkopiskkoulk_2007]), [alkkopiskkoulk_2007])
   ,[alkkopiskjarj_2007] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[alkkopiskjarj_2007]), [alkkopiskjarj_2007])
   ,[alkkkmaak_2007] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[alkkkmaak_2007]), [alkkkmaak_2007])
   ,[alkkolotamm_2007]
   ,[alkkolosyys_2007]
   ,[ylkkopiskkoulk_2007] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ylkkopiskkoulk_2007]), [ylkkopiskkoulk_2007])
   ,[ylkkopiskjarj_2007] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ylkkopiskjarj_2007]), [ylkkopiskjarj_2007])
   ,[ylkkkmaak_2007] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ylkkkmaak_2007]), [ylkkkmaak_2007])
   ,[ylkkolotamm_2007]
   ,[ylkkolosyys_2007]
   ,[tkopiskkoulk_2007] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[tkopiskkoulk_2007]), [tkopiskkoulk_2007])
   ,[tkopiskjarj_2007] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[tkopiskjarj_2007]), [tkopiskjarj_2007])
   ,[tkkmaak_2007] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[tkkmaak_2007]), [tkkmaak_2007])
   ,[tkolotamm_2007]
   ,[tkolosyys_2007]
   ,[muutaopiskkoulk_2007] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[muutaopiskkoulk_2007]), [muutaopiskkoulk_2007])
   ,[muutaopiskjarj_2007] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[muutaopiskjarj_2007]), [muutaopiskjarj_2007])
   ,[muutakmaak_2007] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[muutakmaak_2007]), [muutakmaak_2007])
   ,[muutaolotamm_2007]
   ,[muutaolosyys_2007]
   ,[amkopiskkoulk_2008] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[amkopiskkoulk_2008]), [amkopiskkoulk_2008])
   ,[amkopiskjarj_2008] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[amkopiskjarj_2008]), [amkopiskjarj_2008])
   ,[amkkmaak_2008] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[amkkmaak_2008]), [amkkmaak_2008])
   ,[amkolotamm_2008]
   ,[amkolosyys_2008]
   ,[ylamkopiskkoulk_2008] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ylamkopiskkoulk_2008]), [ylamkopiskkoulk_2008])
   ,[ylamkopiskjarj_2008] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ylamkopiskjarj_2008]), [ylamkopiskjarj_2008])
   ,[ylamkkmaak_2008] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ylamkkmaak_2008]), [ylamkkmaak_2008])
   ,[ylamkolotamm_2008]
   ,[ylamkolosyys_2008]
   ,[alkkopiskkoulk_2008] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[alkkopiskkoulk_2008]), [alkkopiskkoulk_2008])
   ,[alkkopiskjarj_2008] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[alkkopiskjarj_2008]), [alkkopiskjarj_2008])
   ,[alkkkmaak_2008] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[alkkkmaak_2008]), [alkkkmaak_2008])
   ,[alkkolotamm_2008]
   ,[alkkolosyys_2008]
   ,[ylkkopiskkoulk_2008] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ylkkopiskkoulk_2008]), [ylkkopiskkoulk_2008])
   ,[ylkkopiskjarj_2008] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ylkkopiskjarj_2008]), [ylkkopiskjarj_2008])
   ,[ylkkkmaak_2008] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ylkkkmaak_2008]), [ylkkkmaak_2008])
   ,[ylkkolotamm_2008]
   ,[ylkkolosyys_2008]
   ,[tkopiskkoulk_2008] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[tkopiskkoulk_2008]), [tkopiskkoulk_2008])
   ,[tkopiskjarj_2008] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[tkopiskjarj_2008]), [tkopiskjarj_2008])
   ,[tkkmaak_2008] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[tkkmaak_2008]), [tkkmaak_2008])
   ,[tkolotamm_2008]
   ,[tkolosyys_2008]
   ,[muutaopiskkoulk_2008] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[muutaopiskkoulk_2008]), [muutaopiskkoulk_2008])
   ,[muutaopiskjarj_2008] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[muutaopiskjarj_2008]), [muutaopiskjarj_2008])
   ,[muutakmaak_2008] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[muutakmaak_2008]), [muutakmaak_2008])
   ,[muutaolotamm_2008]
   ,[muutaolosyys_2008]
   ,[amkopiskkoulk_2009] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[amkopiskkoulk_2009]), [amkopiskkoulk_2009])
   ,[amkopiskjarj_2009] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[amkopiskjarj_2009]), [amkopiskjarj_2009])
   ,[amkkmaak_2009] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[amkkmaak_2009]), [amkkmaak_2009])
   ,[amkolotamm_2009]
   ,[amkolosyys_2009]
   ,[ylamkopiskkoulk_2009] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ylamkopiskkoulk_2009]), [ylamkopiskkoulk_2009])
   ,[ylamkopiskjarj_2009] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ylamkopiskjarj_2009]), [ylamkopiskjarj_2009])
   ,[ylamkkmaak_2009] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ylamkkmaak_2009]), [ylamkkmaak_2009])
   ,[ylamkolotamm_2009]
   ,[ylamkolosyys_2009]
   ,[alkkopiskkoulk_2009] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[alkkopiskkoulk_2009]), [alkkopiskkoulk_2009])
   ,[alkkopiskjarj_2009] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[alkkopiskjarj_2009]), [alkkopiskjarj_2009])
   ,[alkkkmaak_2009] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[alkkkmaak_2009]), [alkkkmaak_2009])
   ,[alkkolotamm_2009]
   ,[alkkolosyys_2009]
   ,[ylkkopiskkoulk_2009] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ylkkopiskkoulk_2009]), [ylkkopiskkoulk_2009])
   ,[ylkkopiskjarj_2009] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ylkkopiskjarj_2009]), [ylkkopiskjarj_2009])
   ,[ylkkkmaak_2009] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ylkkkmaak_2009]), [ylkkkmaak_2009])
   ,[ylkkolotamm_2009]
   ,[ylkkolosyys_2009]
   ,[tkopiskkoulk_2009] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[tkopiskkoulk_2009]), [tkopiskkoulk_2009])
   ,[tkopiskjarj_2009] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[tkopiskjarj_2009]), [tkopiskjarj_2009])
   ,[tkkmaak_2009] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[tkkmaak_2009]), [tkkmaak_2009])
   ,[tkolotamm_2009]
   ,[tkolosyys_2009]
   ,[muutaopiskkoulk_2009] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[muutaopiskkoulk_2009]), [muutaopiskkoulk_2009])
   ,[muutaopiskjarj_2009] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[muutaopiskjarj_2009]), [muutaopiskjarj_2009])
   ,[muutakmaak_2009] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[muutakmaak_2009]), [muutakmaak_2009])
   ,[muutaolotamm_2009]
   ,[muutaolosyys_2009]
   ,[ptoim1r5_2000]
   ,[amas_2000]
   ,[ptoim1r5_2001]
   ,[amas_2001]
   ,[ptoim1r5_2002]
   ,[amas_2002]
   ,[ptoim1r5_2003]
   ,[amas_2003]
   ,[ptoim1r5_2004]
   ,[amas_2004]
   ,[ptoim1r5_2005]
   ,[amas_2005]
   ,[ptoim1r5_2006]
   ,[amas_2006]
   ,[ptoim1r5_2007]
   ,[amas_2007]
   ,[ptoim1r5_2008]
   ,[amas_2008]
   ,[ptoim1r5_2009]
   ,[amas_2009]

--UUSIVUOSI
--2010
   ,[amksuorv_2010]
   ,[amksuorlk_2010]
   ,[amktutkkmaak_2010] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[amktutkkmaak_2010]), [amktutkkmaak_2010])
   ,[amktutkjarj_2010] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[amktutkjarj_2010]), [amktutkjarj_2010])
   ,[amktutkkoulk_2010] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[amktutkkoulk_2010]), [amktutkkoulk_2010])
   ,[ylamksuorv_2010]
   ,[ylamksuorlk_2010]
   ,[ylamktutkkmaak_2010] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ylamktutkkmaak_2010]), [ylamktutkkmaak_2010])
   ,[ylamktutkjarj_2010] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ylamktutkjarj_2010]), [ylamktutkjarj_2010])
   ,[ylamktutkkoulk_2010] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ylamktutkkoulk_2010]), [ylamktutkkoulk_2010])
   ,[alkksuorv_2010]
   ,[alkksuorlk_2010]
   ,[alkktutkkmaak_2010] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[alkktutkkmaak_2010]), [alkktutkkmaak_2010])
   ,[alkktutkjarj_2010] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[alkktutkjarj_2010]), [alkktutkjarj_2010])
   ,[alkktutkkoulk_2010] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[alkktutkkoulk_2010]), [alkktutkkoulk_2010])
   ,[ylkksuorv_2010]
   ,[ylkksuorlk_2010]
   ,[ylkktutkkmaak_2010] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ylkktutkkmaak_2010]), [ylkktutkkmaak_2010])
   ,[ylkktutkjarj_2010] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ylkktutkjarj_2010]), [ylkktutkjarj_2010])
   ,[ylkktutkkoulk_2010] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ylkktutkkoulk_2010]), [ylkktutkkoulk_2010])
   ,[tksuorv_2010]
   ,[tksuorlk_2010]
   ,[tktutkkmaak_2010] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[tktutkkmaak_2010]), [tktutkkmaak_2010])
   ,[tktutkjarj_2010] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[tktutkjarj_2010]), [tktutkjarj_2010])
   ,[tktutkkoulk_2010] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[tktutkkoulk_2010]), [tktutkkoulk_2010])
   ,[muutasuorv_2010]
   ,[muutasuorlk_2010]
   ,[muutatutkkmaak_2010] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[muutatutkkmaak_2010]), [muutatutkkmaak_2010])
   ,[muutatutkjarj_2010] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[muutatutkjarj_2010]), [muutatutkjarj_2010])
   ,[muutatutkkoulk_2010] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[muutatutkkoulk_2010]), [muutatutkkoulk_2010])
   ,[amkopiskkoulk_2010] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[amkopiskkoulk_2010]), [amkopiskkoulk_2010])
   ,[amkopiskjarj_2010] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[amkopiskjarj_2010]), [amkopiskjarj_2010])
   ,[amkkmaak_2010] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[amkkmaak_2010]), [amkkmaak_2010])
   ,[amkolotamm_2010]
   ,[amkolosyys_2010]
   ,[ylamkopiskkoulk_2010] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ylamkopiskkoulk_2010]), [ylamkopiskkoulk_2010])
   ,[ylamkopiskjarj_2010] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ylamkopiskjarj_2010]), [ylamkopiskjarj_2010])
   ,[ylamkkmaak_2010] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ylamkkmaak_2010]), [ylamkkmaak_2010])
   ,[ylamkolotamm_2010]
   ,[ylamkolosyys_2010]
   ,[alkkopiskkoulk_2010] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[alkkopiskkoulk_2010]), [alkkopiskkoulk_2010])
   ,[alkkopiskjarj_2010] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[alkkopiskjarj_2010]), [alkkopiskjarj_2010])
   ,[alkkkmaak_2010] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[alkkkmaak_2010]), [alkkkmaak_2010])
   ,[alkkolotamm_2010]
   ,[alkkolosyys_2010]
   ,[ylkkopiskkoulk_2010] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ylkkopiskkoulk_2010]), [ylkkopiskkoulk_2010])
   ,[ylkkopiskjarj_2010] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ylkkopiskjarj_2010]), [ylkkopiskjarj_2010])
   ,[ylkkkmaak_2010] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ylkkkmaak_2010]), [ylkkkmaak_2010])
   ,[ylkkolotamm_2010]
   ,[ylkkolosyys_2010]
   ,[tkopiskkoulk_2010] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[tkopiskkoulk_2010]), [tkopiskkoulk_2010])
   ,[tkopiskjarj_2010] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[tkopiskjarj_2010]), [tkopiskjarj_2010])
   ,[tkkmaak_2010] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[tkkmaak_2010]), [tkkmaak_2010])
   ,[tkolotamm_2010]
   ,[tkolosyys_2010]
   ,[muutaopiskkoulk_2010] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[muutaopiskkoulk_2010]), [muutaopiskkoulk_2010])
   ,[muutaopiskjarj_2010] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[muutaopiskjarj_2010]), [muutaopiskjarj_2010])
   ,[muutakmaak_2010] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[muutakmaak_2010]), [muutakmaak_2010])
   ,[muutaolotamm_2010]
   ,[muutaolosyys_2010]
   ,[ptoim1r5_2010]
   ,[amas_2010]

--UUSIVUOSI
--2011
   ,[amksuorv_2011]
   ,[amksuorlk_2011]
   ,[amktutkkmaak_2011] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[amktutkkmaak_2011]), [amktutkkmaak_2011])
   ,[amktutkjarj_2011] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[amktutkjarj_2011]), [amktutkjarj_2011])
   ,[amktutkkoulk_2011] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[amktutkkoulk_2011]), [amktutkkoulk_2011])
   ,[ylamksuorv_2011]
   ,[ylamksuorlk_2011]
   ,[ylamktutkkmaak_2011] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ylamktutkkmaak_2011]), [ylamktutkkmaak_2011])
   ,[ylamktutkjarj_2011] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ylamktutkjarj_2011]), [ylamktutkjarj_2011])
   ,[ylamktutkkoulk_2011] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ylamktutkkoulk_2011]), [ylamktutkkoulk_2011])
   ,[alkksuorv_2011]
   ,[alkksuorlk_2011]
   ,[alkktutkkmaak_2011] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[alkktutkkmaak_2011]), [alkktutkkmaak_2011])
   ,[alkktutkjarj_2011] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[alkktutkjarj_2011]), [alkktutkjarj_2011])
   ,[alkktutkkoulk_2011] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[alkktutkkoulk_2011]), [alkktutkkoulk_2011])
   ,[ylkksuorv_2011]
   ,[ylkksuorlk_2011]
   ,[ylkktutkkmaak_2011] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ylkktutkkmaak_2011]), [ylkktutkkmaak_2011])
   ,[ylkktutkjarj_2011] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ylkktutkjarj_2011]), [ylkktutkjarj_2011])
   ,[ylkktutkkoulk_2011] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ylkktutkkoulk_2011]), [ylkktutkkoulk_2011])
   ,[tksuorv_2011]
   ,[tksuorlk_2011]
   ,[tktutkkmaak_2011] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[tktutkkmaak_2011]), [tktutkkmaak_2011])
   ,[tktutkjarj_2011] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[tktutkjarj_2011]), [tktutkjarj_2011])
   ,[tktutkkoulk_2011] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[tktutkkoulk_2011]), [tktutkkoulk_2011])
   ,[muutasuorv_2011]
   ,[muutasuorlk_2011]
   ,[muutatutkkmaak_2011] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[muutatutkkmaak_2011]), [muutatutkkmaak_2011])
   ,[muutatutkjarj_2011] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[muutatutkjarj_2011]), [muutatutkjarj_2011])
   ,[muutatutkkoulk_2011] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[muutatutkkoulk_2011]), [muutatutkkoulk_2011])
   ,[amkopiskkoulk_2011] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[amkopiskkoulk_2011]), [amkopiskkoulk_2011])
   ,[amkopiskjarj_2011] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[amkopiskjarj_2011]), [amkopiskjarj_2011])
   ,[amkkmaak_2011] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[amkkmaak_2011]), [amkkmaak_2011])
   ,[amkolotamm_2011]
   ,[amkolosyys_2011]
   ,[ylamkopiskkoulk_2011] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ylamkopiskkoulk_2011]), [ylamkopiskkoulk_2011])
   ,[ylamkopiskjarj_2011] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ylamkopiskjarj_2011]), [ylamkopiskjarj_2011])
   ,[ylamkkmaak_2011] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ylamkkmaak_2011]), [ylamkkmaak_2011])
   ,[ylamkolotamm_2011]
   ,[ylamkolosyys_2011]
   ,[alkkopiskkoulk_2011] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[alkkopiskkoulk_2011]), [alkkopiskkoulk_2011])
   ,[alkkopiskjarj_2011] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[alkkopiskjarj_2011]), [alkkopiskjarj_2011])
   ,[alkkkmaak_2011] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[alkkkmaak_2011]), [alkkkmaak_2011])
   ,[alkkolotamm_2011]
   ,[alkkolosyys_2011]
   ,[ylkkopiskkoulk_2011] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ylkkopiskkoulk_2011]), [ylkkopiskkoulk_2011])
   ,[ylkkopiskjarj_2011] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ylkkopiskjarj_2011]), [ylkkopiskjarj_2011])
   ,[ylkkkmaak_2011] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ylkkkmaak_2011]), [ylkkkmaak_2011])
   ,[ylkkolotamm_2011]
   ,[ylkkolosyys_2011]
   ,[tkopiskkoulk_2011] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[tkopiskkoulk_2011]), [tkopiskkoulk_2011])
   ,[tkopiskjarj_2011] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[tkopiskjarj_2011]), [tkopiskjarj_2011])
   ,[tkkmaak_2011] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[tkkmaak_2011]), [tkkmaak_2011])
   ,[tkolotamm_2011]
   ,[tkolosyys_2011]
   ,[muutaopiskkoulk_2011] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[muutaopiskkoulk_2011]), [muutaopiskkoulk_2011])
   ,[muutaopiskjarj_2011] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[muutaopiskjarj_2011]), [muutaopiskjarj_2011])
   ,[muutakmaak_2011] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[muutakmaak_2011]), [muutakmaak_2011])
   ,[muutaolotamm_2011]
   ,[muutaolosyys_2011]
   ,[ptoim1r5_2011]
   ,[amas_2011]
   
--UUSIVUOSI
--2012
   ,[amksuorv_2012]
   ,[amksuorlk_2012]
   ,[amktutkkmaak_2012] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[amktutkkmaak_2012]), [amktutkkmaak_2012])
   ,[amktutkjarj_2012] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[amktutkjarj_2012]), [amktutkjarj_2012])
   ,[amktutkkoulk_2012] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[amktutkkoulk_2012]), [amktutkkoulk_2012])
   ,[ylamksuorv_2012]
   ,[ylamksuorlk_2012]
   ,[ylamktutkkmaak_2012] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ylamktutkkmaak_2012]), [ylamktutkkmaak_2012])
   ,[ylamktutkjarj_2012] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ylamktutkjarj_2012]), [ylamktutkjarj_2012])
   ,[ylamktutkkoulk_2012] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ylamktutkkoulk_2012]), [ylamktutkkoulk_2012])
   ,[alkksuorv_2012]
   ,[alkksuorlk_2012]
   ,[alkktutkkmaak_2012] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[alkktutkkmaak_2012]), [alkktutkkmaak_2012])
   ,[alkktutkjarj_2012] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[alkktutkjarj_2012]), [alkktutkjarj_2012])
   ,[alkktutkkoulk_2012] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[alkktutkkoulk_2012]), [alkktutkkoulk_2012])
   ,[ylkksuorv_2012]
   ,[ylkksuorlk_2012]
   ,[ylkktutkkmaak_2012] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ylkktutkkmaak_2012]), [ylkktutkkmaak_2012])
   ,[ylkktutkjarj_2012] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ylkktutkjarj_2012]), [ylkktutkjarj_2012])
   ,[ylkktutkkoulk_2012] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ylkktutkkoulk_2012]), [ylkktutkkoulk_2012])
   ,[tksuorv_2012]
   ,[tksuorlk_2012]
   ,[tktutkkmaak_2012] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[tktutkkmaak_2012]), [tktutkkmaak_2012])
   ,[tktutkjarj_2012] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[tktutkjarj_2012]), [tktutkjarj_2012])
   ,[tktutkkoulk_2012] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[tktutkkoulk_2012]), [tktutkkoulk_2012])
   ,[muutasuorv_2012]
   ,[muutasuorlk_2012]
   ,[muutatutkkmaak_2012] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[muutatutkkmaak_2012]), [muutatutkkmaak_2012])
   ,[muutatutkjarj_2012] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[muutatutkjarj_2012]), [muutatutkjarj_2012])
   ,[muutatutkkoulk_2012] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[muutatutkkoulk_2012]), [muutatutkkoulk_2012])
   ,[amkopiskkoulk_2012] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[amkopiskkoulk_2012]), [amkopiskkoulk_2012])
   ,[amkopiskjarj_2012] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[amkopiskjarj_2012]), [amkopiskjarj_2012])
   ,[amkkmaak_2012] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[amkkmaak_2012]), [amkkmaak_2012])
   ,[amkolotamm_2012]
   ,[amkolosyys_2012]
   ,[ylamkopiskkoulk_2012] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ylamkopiskkoulk_2012]), [ylamkopiskkoulk_2012])
   ,[ylamkopiskjarj_2012] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ylamkopiskjarj_2012]), [ylamkopiskjarj_2012])
   ,[ylamkkmaak_2012] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ylamkkmaak_2012]), [ylamkkmaak_2012])
   ,[ylamkolotamm_2012]
   ,[ylamkolosyys_2012]
   ,[alkkopiskkoulk_2012] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[alkkopiskkoulk_2012]), [alkkopiskkoulk_2012])
   ,[alkkopiskjarj_2012] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[alkkopiskjarj_2012]), [alkkopiskjarj_2012])
   ,[alkkkmaak_2012] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[alkkkmaak_2012]), [alkkkmaak_2012])
   ,[alkkolotamm_2012]
   ,[alkkolosyys_2012]
   ,[ylkkopiskkoulk_2012] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ylkkopiskkoulk_2012]), [ylkkopiskkoulk_2012])
   ,[ylkkopiskjarj_2012] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ylkkopiskjarj_2012]), [ylkkopiskjarj_2012])
   ,[ylkkkmaak_2012] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ylkkkmaak_2012]), [ylkkkmaak_2012])
   ,[ylkkolotamm_2012]
   ,[ylkkolosyys_2012]
   ,[tkopiskkoulk_2012] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[tkopiskkoulk_2012]), [tkopiskkoulk_2012])
   ,[tkopiskjarj_2012] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[tkopiskjarj_2012]), [tkopiskjarj_2012])
   ,[tkkmaak_2012] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[tkkmaak_2012]), [tkkmaak_2012])
   ,[tkolotamm_2012]
   ,[tkolosyys_2012]
   ,[muutaopiskkoulk_2012] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[muutaopiskkoulk_2012]), [muutaopiskkoulk_2012])
   ,[muutaopiskjarj_2012] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[muutaopiskjarj_2012]), [muutaopiskjarj_2012])
   ,[muutakmaak_2012] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[muutakmaak_2012]), [muutakmaak_2012])
   ,[muutaolotamm_2012]
   ,[muutaolosyys_2012]
   ,[ptoim1r5_2012]
   ,[amas_2012]
--2013
   ,[amksuorv_2013]
   ,[amksuorlk_2013]
   ,[amktutkkmaak_2013] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[amktutkkmaak_2013]), [amktutkkmaak_2013])
   ,[amktutkjarj_2013] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[amktutkjarj_2013]), [amktutkjarj_2013])
   ,[amktutkkoulk_2013] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[amktutkkoulk_2013]), [amktutkkoulk_2013])
   ,[ylamksuorv_2013]
   ,[ylamksuorlk_2013]
   ,[ylamktutkkmaak_2013] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ylamktutkkmaak_2013]), [ylamktutkkmaak_2013])
   ,[ylamktutkjarj_2013] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ylamktutkjarj_2013]), [ylamktutkjarj_2013])
   ,[ylamktutkkoulk_2013] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ylamktutkkoulk_2013]), [ylamktutkkoulk_2013])
   ,[alkksuorv_2013]
   ,[alkksuorlk_2013]
   ,[alkktutkkmaak_2013] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[alkktutkkmaak_2013]), [alkktutkkmaak_2013])
   ,[alkktutkjarj_2013] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[alkktutkjarj_2013]), [alkktutkjarj_2013])
   ,[alkktutkkoulk_2013] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[alkktutkkoulk_2013]), [alkktutkkoulk_2013])
   ,[ylkksuorv_2013]
   ,[ylkksuorlk_2013]
   ,[ylkktutkkmaak_2013] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ylkktutkkmaak_2013]), [ylkktutkkmaak_2013])
   ,[ylkktutkjarj_2013] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ylkktutkjarj_2013]), [ylkktutkjarj_2013])
   ,[ylkktutkkoulk_2013] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ylkktutkkoulk_2013]), [ylkktutkkoulk_2013])
   ,[tksuorv_2013]
   ,[tksuorlk_2013]
   ,[tktutkkmaak_2013] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[tktutkkmaak_2013]), [tktutkkmaak_2013])
   ,[tktutkjarj_2013] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[tktutkjarj_2013]), [tktutkjarj_2013])
   ,[tktutkkoulk_2013] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[tktutkkoulk_2013]), [tktutkkoulk_2013])
   ,[muutasuorv_2013]
   ,[muutasuorlk_2013]
   ,[muutatutkkmaak_2013] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[muutatutkkmaak_2013]), [muutatutkkmaak_2013])
   ,[muutatutkjarj_2013] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[muutatutkjarj_2013]), [muutatutkjarj_2013])
   ,[muutatutkkoulk_2013] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[muutatutkkoulk_2013]), [muutatutkkoulk_2013])
   ,[amkopiskkoulk_2013] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[amkopiskkoulk_2013]), [amkopiskkoulk_2013])
   ,[amkopiskjarj_2013] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[amkopiskjarj_2013]), [amkopiskjarj_2013])
   ,[amkkmaak_2013] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[amkkmaak_2013]), [amkkmaak_2013])
   ,[amkolotamm_2013]
   ,[amkolosyys_2013]
   ,[ylamkopiskkoulk_2013] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ylamkopiskkoulk_2013]), [ylamkopiskkoulk_2013])
   ,[ylamkopiskjarj_2013] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ylamkopiskjarj_2013]), [ylamkopiskjarj_2013])
   ,[ylamkkmaak_2013] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ylamkkmaak_2013]), [ylamkkmaak_2013])
   ,[ylamkolotamm_2013]
   ,[ylamkolosyys_2013]
   ,[alkkopiskkoulk_2013] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[alkkopiskkoulk_2013]), [alkkopiskkoulk_2013])
   ,[alkkopiskjarj_2013] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[alkkopiskjarj_2013]), [alkkopiskjarj_2013])
   ,[alkkkmaak_2013] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[alkkkmaak_2013]), [alkkkmaak_2013])
   ,[alkkolotamm_2013]
   ,[alkkolosyys_2013]
   ,[ylkkopiskkoulk_2013] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ylkkopiskkoulk_2013]), [ylkkopiskkoulk_2013])
   ,[ylkkopiskjarj_2013] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ylkkopiskjarj_2013]), [ylkkopiskjarj_2013])
   ,[ylkkkmaak_2013] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ylkkkmaak_2013]), [ylkkkmaak_2013])
   ,[ylkkolotamm_2013]
   ,[ylkkolosyys_2013]
   ,[tkopiskkoulk_2013] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[tkopiskkoulk_2013]), [tkopiskkoulk_2013])
   ,[tkopiskjarj_2013] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[tkopiskjarj_2013]), [tkopiskjarj_2013])
   ,[tkkmaak_2013] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[tkkmaak_2013]), [tkkmaak_2013])
   ,[tkolotamm_2013]
   ,[tkolosyys_2013]
   ,[muutaopiskkoulk_2013] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[muutaopiskkoulk_2013]), [muutaopiskkoulk_2013])
   ,[muutaopiskjarj_2013] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[muutaopiskjarj_2013]), [muutaopiskjarj_2013])
   ,[muutakmaak_2013] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[muutakmaak_2013]), [muutakmaak_2013])
   ,[muutaolotamm_2013]
   ,[muutaolosyys_2013]
   ,[ptoim1r5_2013]
   ,[amas_2013]

-- 2014

   ,[amksuorv_2014]
   ,[amksuorlk_2014]
   ,[amktutkkmaak_2014] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[amktutkkmaak_2014]), [amktutkkmaak_2014])
   ,[amktutkjarj_2014] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[amktutkjarj_2014]), [amktutkjarj_2014])
   ,[amktutkkoulk_2014] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[amktutkkoulk_2014]), [amktutkkoulk_2014])
   ,[ylamksuorv_2014]
   ,[ylamksuorlk_2014]
   ,[ylamktutkkmaak_2014] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ylamktutkkmaak_2014]), [ylamktutkkmaak_2014])
   ,[ylamktutkjarj_2014] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ylamktutkjarj_2014]), [ylamktutkjarj_2014])
   ,[ylamktutkkoulk_2014] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ylamktutkkoulk_2014]), [ylamktutkkoulk_2014])
   ,[alkksuorv_2014]
   ,[alkksuorlk_2014]
   ,[alkktutkkmaak_2014] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[alkktutkkmaak_2014]), [alkktutkkmaak_2014])
   ,[alkktutkjarj_2014] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[alkktutkjarj_2014]), [alkktutkjarj_2014])
   ,[alkktutkkoulk_2014] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[alkktutkkoulk_2014]), [alkktutkkoulk_2014])
   ,[ylkksuorv_2014]
   ,[ylkksuorlk_2014]
   ,[ylkktutkkmaak_2014] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ylkktutkkmaak_2014]), [ylkktutkkmaak_2014])
   ,[ylkktutkjarj_2014] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ylkktutkjarj_2014]), [ylkktutkjarj_2014])
   ,[ylkktutkkoulk_2014] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ylkktutkkoulk_2014]), [ylkktutkkoulk_2014])
   ,[tksuorv_2014]
   ,[tksuorlk_2014]
   ,[tktutkkmaak_2014] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[tktutkkmaak_2014]), [tktutkkmaak_2014])
   ,[tktutkjarj_2014] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[tktutkjarj_2014]), [tktutkjarj_2014])
   ,[tktutkkoulk_2014] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[tktutkkoulk_2014]), [tktutkkoulk_2014])
   ,[muutasuorv_2014]
   ,[muutasuorlk_2014]
   ,[muutatutkkmaak_2014] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[muutatutkkmaak_2014]), [muutatutkkmaak_2014])
   ,[muutatutkjarj_2014] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[muutatutkjarj_2014]), [muutatutkjarj_2014])
   ,[muutatutkkoulk_2014] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[muutatutkkoulk_2014]), [muutatutkkoulk_2014])
   ,[amkopiskkoulk_2014] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[amkopiskkoulk_2014]), [amkopiskkoulk_2014])
   ,[amkopiskjarj_2014] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[amkopiskjarj_2014]), [amkopiskjarj_2014])
   ,[amkkmaak_2014] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[amkkmaak_2014]), [amkkmaak_2014])
   ,[amkolotamm_2014]
   ,[amkolosyys_2014]
   ,[ylamkopiskkoulk_2014] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ylamkopiskkoulk_2014]), [ylamkopiskkoulk_2014])
   ,[ylamkopiskjarj_2014] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ylamkopiskjarj_2014]), [ylamkopiskjarj_2014])
   ,[ylamkkmaak_2014] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ylamkkmaak_2014]), [ylamkkmaak_2014])
   ,[ylamkolotamm_2014]
   ,[ylamkolosyys_2014]
   ,[alkkopiskkoulk_2014] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[alkkopiskkoulk_2014]), [alkkopiskkoulk_2014])
   ,[alkkopiskjarj_2014] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[alkkopiskjarj_2014]), [alkkopiskjarj_2014])
   ,[alkkkmaak_2014] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[alkkkmaak_2014]), [alkkkmaak_2014])
   ,[alkkolotamm_2014]
   ,[alkkolosyys_2014]
   ,[ylkkopiskkoulk_2014] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ylkkopiskkoulk_2014]), [ylkkopiskkoulk_2014])
   ,[ylkkopiskjarj_2014] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ylkkopiskjarj_2014]), [ylkkopiskjarj_2014])
   ,[ylkkkmaak_2014] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ylkkkmaak_2014]), [ylkkkmaak_2014])
   ,[ylkkolotamm_2014]
   ,[ylkkolosyys_2014]
   ,[tkopiskkoulk_2014] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[tkopiskkoulk_2014]), [tkopiskkoulk_2014])
   ,[tkopiskjarj_2014] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[tkopiskjarj_2014]), [tkopiskjarj_2014])
   ,[tkkmaak_2014] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[tkkmaak_2014]), [tkkmaak_2014])
   ,[tkolotamm_2014]
   ,[tkolosyys_2014]
   ,[muutaopiskkoulk_2014] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutusluokitus_nykytila] WHERE koulutus_koodi=[muutaopiskkoulk_2014]), [muutaopiskkoulk_2014])
   ,[muutaopiskjarj_2014] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[muutaopiskjarj_2014]), [muutaopiskjarj_2014])
   ,[muutakmaak_2014] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_10_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[muutakmaak_2014]), [muutakmaak_2014])
   ,[muutaolotamm_2014]
   ,[muutaolosyys_2014]
   ,[ptoim1r5_2014]
   ,[amas_2014]






-- UUSI VUOSI



   
   ,[lkm]
      ,[tietolahde]=''K3_10_sopv_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv, alvv, allk)
      ,[aineistorivinumero] = ROW_NUMBER() OVER(ORDER BY tilv, alvv, allk)
  FROM [TK_H9098_CSC].[dbo].[TK_K3_10_sopv_16] 
 --28.8.2013 Poistetaan maanpuolustuskoulutus
WHERE jarj <> ''999999-9''
--testausta /Jarmo
--and   alvv=''2008'' and allk=''2''



' 
GO
/****** Object:  View [dbo].[v_sa_K3_11_ Tutkinnon suorittaneiden osuus poistumasta]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_K3_11_ Tutkinnon suorittaneiden osuus poistumasta]'))
EXEC dbo.sp_executesql @statement = N'








CREATE VIEW [dbo].[v_sa_K3_11_ Tutkinnon suorittaneiden osuus poistumasta] AS

SELECT
      [tilv]= cast(kaikkivuodet.tilv as nvarchar(4))
	  ,tilv_date = cast(kaikkivuodet.tilv+''-01-01'' as date)
      ,[aineisto]= cast(kaikkivuodet.aineisto as nvarchar(1))
      ,[lahde]= cast(kaikkivuodet.lahde as nvarchar(2))
      ,[sp]= cast(kaikkivuodet.sp as nvarchar(1))
      ,[aikielir1]= cast(kaikkivuodet.aikielir1 as nvarchar(2))
      ,[syntv]= cast(kaikkivuodet.syntv as nvarchar(4))
      ,[tilvaskun]= cast(kaikkivuodet.tilvaskun as nvarchar(3))
      ,[kansalr1]= cast(kaikkivuodet.kansalr1 as nvarchar(1))
      ,[eumaa]= cast(kaikkivuodet.eumaa as nvarchar(1))
      ,[etamaa]= cast(kaikkivuodet.etamaa as nvarchar(1))
      ,[pohjmaa]= cast(kaikkivuodet.pohjmaa as nvarchar(1))
      ,[alvv]= cast(kaikkivuodet.alvv as nvarchar(4))
      ,[allk]= cast(kaikkivuodet.allk as nvarchar(1))
      ,[ololk]= cast(kaikkivuodet.ololk as nvarchar(1))
      ,[jarj]= cast(kaikkivuodet.jarj as nvarchar(10))
      ,[tunn]= cast(kaikkivuodet.tunn as nvarchar(5))
      ,[koulk]= cast(kaikkivuodet.koulk as nvarchar(6))
	  ,[koulk_opintoala] = CAST(kaikkivuodet.koulk_opintoala as nvarchar (6))
	  ,[koulk_koulutusala] = CAST(kaikkivuodet.koulk_koulutusala as nvarchar (6))
	  ,[koulk_koulutusaste] = CAST(kaikkivuodet.koulk_koulutusaste as nvarchar (6))
      ,[kkielir1]= cast(kaikkivuodet.kkielir1 as nvarchar(2))
      ,[kkun]= cast(kaikkivuodet.kkun as nvarchar(3))
	  ,[kkun_kmaak]= cast(kaikkivuodet.kkun_kmaak as nvarchar(2))
	  ,[ophal]= cast(kaikkivuodet.ophal as nvarchar(1))
      ,[koultyp]= cast(kaikkivuodet.koultyp	 as nvarchar(1))
      ,[tutkmaak]= cast(kaikkivuodet.tutkmaak as nvarchar(2))
      ,[tutkjarj]= cast(kaikkivuodet.tutkjarj as nvarchar(10))
      ,[tutktunn]= cast(kaikkivuodet.tutktunn as nvarchar(5))
      ,[tutkkoulk]= cast(kaikkivuodet.tutkkoulk as nvarchar(6))
	  ,[tutk_opintoala] = CAST(kaikkivuodet.tutk_opintoala as nvarchar (6))
	  ,[tutk_koulutusala] = CAST(kaikkivuodet.tutk_koulutusala as nvarchar (6))
	  ,[tutk_koulutusaste] = CAST(kaikkivuodet.tutk_koulutusaste as nvarchar (6))
      ,[tutkkoultyp]= cast(kaikkivuodet.tutkkoultyp as nvarchar(1))
      ,[seurvkmaak]= cast(kaikkivuodet.seurvkmaak as nvarchar(2))
      ,[seurvjarj]= cast(kaikkivuodet.seurvjarj as nvarchar(10))
      ,[seurvtunn]= cast(kaikkivuodet.seurvtunn as nvarchar(5))
      ,[seurvkoulk]= cast(kaikkivuodet.seurvkoulk as nvarchar(6))
	  ,[seurv_opintoala] = CAST(kaikkivuodet.seurv_opintoala as nvarchar (6))
	  ,[seurv_koulutusala] = CAST(kaikkivuodet.seurv_koulutusala as nvarchar (6))
	  ,[seurv_koulutusaste] = CAST(kaikkivuodet.seurv_koulutusaste as nvarchar (6))
      ,[seurvkoulutyp]= cast(kaikkivuodet.seurvkoulutyp as nvarchar(1))
      ,[ptoim1r2]= cast(kaikkivuodet.ptoim1r2 as nvarchar(2))
      ,[amas1]= cast(kaikkivuodet.amas1 as nvarchar(1))
      ,[lkm]= CAST(kaikkivuodet.lkm as int)
 FROM (
SELECT [tilv]
      ,[aineisto]
      ,[lahde]
      ,[sp]
      ,[aikielir1]
      ,[syntv]
      ,[tilvaskun]
      ,[kansalr1]
      ,[eumaa]
      ,[etamaa]
      ,[pohjmaa]
      ,[alvv]
      ,[allk]
      ,[ololk]
      ,[jarj]
      ,[tunn]
      ,[koulk]
	  ,[koulk_opintoala] = cast(coalesce(nullif(kl1.opintoala2002_koodi, ''''), ''-1'') as nvarchar(6))
	  --,[koulk_opintoala] = (select distinct  opintoala2002_koodi  from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
	  ,[koulk_koulutusala] = cast(coalesce(nullif(kl1.koulutusala2002_koodi , ''''), ''-1'') as nvarchar(6))
      --,[koulk_koulutusala] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
	  ,[koulk_koulutusaste] = cast(coalesce(nullif(kl1.koulutusaste2002_koodi , ''''), ''-1'') as nvarchar(6))
      --,[koulk_koulutusaste] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
      ,[kkielir1]
      ,[kkun]
	  ,[kkun_kmaak]= (select distinct maakunta_koodi   from [VipunenTK_DW].[dbo].[d_alueluokitus] where alueluokitus_avain = [kkun] and tilv+''-01-01'' between
	  (alkaa) and (paattyy) )
      ,[ophal]
      ,[koultyp]
      ,[tutkmaak]
      ,[tutkjarj]
      ,[tutktunn]
      ,[tutkkoulk]
	  ,[tutk_opintoala] = kl2.opintoala2002_koodi
      ,[tutk_koulutusala] = kl2.koulutusala2002_koodi
      ,[tutk_koulutusaste] = kl2.koulutusaste2002_koodi
      ,[tutkkoultyp]
      ,[seurvkmaak]
      ,[seurvjarj]
      ,[seurvtunn]
      ,[seurvkoulk]
	  ,[seurv_opintoala] = kl3.opintoala2002_koodi
      ,[seurv_koulutusala] = kl3.koulutusala2002_koodi
      ,[seurv_koulutusaste] = kl3.koulutusaste2002_koodi
      ,[seurvkoulutyp]
      ,[ptoim1r2]
      ,[amas1]
      ,[lkm]
  FROM [TK_H9098_CSC].[dbo].[TK_K3_11a_sopv_11] tk
  left join [VipunenTK_DW].[dbo].[d_koulutusluokitus] kl1 on kl1.koulutusluokitus_avain=tk.koulk and tilv+''-01-01'' between kl1.alkaa and kl1.paattyy
  left join [VipunenTK_DW].[dbo].[d_koulutusluokitus] kl2 on kl2.koulutusluokitus_avain=tk.tutkkoulk and tilv+''-01-01'' between kl2.alkaa and kl2.paattyy
  left join [VipunenTK_DW].[dbo].[d_koulutusluokitus] kl3 on kl3.koulutusluokitus_avain=tk.seurvkoulk and tilv+''-01-01'' between kl3.alkaa and kl3.paattyy
  where [aineisto] = ''L''
  UNION ALL
  SELECT [tilv]
      ,[aineisto]
      ,[lahde]
      ,[sp]
      ,[aikielir1]
      ,[syntv]
      ,[tilvaskun]
      ,[kansalr1]
      ,[eumaa]
      ,[etamaa]
      ,[pohjmaa]
      ,[alvv]
      ,[allk]
      ,[ololk]
      ,[jarj]
      ,[tunn]
      ,[koulk]
	  ,[koulk_opintoala] = cast(coalesce(nullif(kl1.opintoala2002_koodi, ''''), ''-1'') as nvarchar(6))
	  --,[koulk_opintoala] = (select distinct  opintoala2002_koodi  from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
	  ,[koulk_koulutusala] = cast(coalesce(nullif(kl1.koulutusala2002_koodi , ''''), ''-1'') as nvarchar(6))
      --,[koulk_koulutusala] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
	  ,[koulk_koulutusaste] = cast(coalesce(nullif(kl1.koulutusaste2002_koodi , ''''), ''-1'') as nvarchar(6))
      --,[koulk_koulutusaste] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
      ,[kkielir1]
      ,[kkun]
	  ,[kkun_kmaak]= (select distinct maakunta_koodi   from [VipunenTK_DW].[dbo].[d_alueluokitus] where alueluokitus_avain = [kkun] and tilv+''-01-01'' between
	  (alkaa) and (paattyy) )
      ,[ophal]
      ,[koultyp]
      ,[tutkmaak]
      ,[tutkjarj]
      ,[tutktunn]
      ,[tutkkoulk]
	  ,[tutk_opintoala] = kl2.opintoala2002_koodi
      ,[tutk_koulutusala] = kl2.koulutusala2002_koodi
      ,[tutk_koulutusaste] = kl2.koulutusaste2002_koodi
      ,[tutkkoultyp]
      ,[seurvkmaak]
      ,[seurvjarj]
      ,[seurvtunn]
      ,[seurvkoulk]
	  ,[seurv_opintoala] = kl3.opintoala2002_koodi
      ,[seurv_koulutusala] = kl3.koulutusala2002_koodi
      ,[seurv_koulutusaste] = kl3.koulutusaste2002_koodi
      ,[seurvkoulutyp]
      ,[ptoim1r2]
      ,[amas1]
      ,[lkm]
  FROM [TK_H9098_CSC].[dbo].[TK_K3_11a_sopv_12] tk
  left join [VipunenTK_DW].[dbo].[d_koulutusluokitus] kl1 on kl1.koulutusluokitus_avain=tk.koulk and tilv+''-01-01'' between kl1.alkaa and kl1.paattyy
  left join [VipunenTK_DW].[dbo].[d_koulutusluokitus] kl2 on kl2.koulutusluokitus_avain=tk.tutkkoulk and tilv+''-01-01'' between kl2.alkaa and kl2.paattyy
  left join [VipunenTK_DW].[dbo].[d_koulutusluokitus] kl3 on kl3.koulutusluokitus_avain=tk.seurvkoulk and tilv+''-01-01'' between kl3.alkaa and kl3.paattyy
  where [aineisto] = ''L''
 UNION ALL
  SELECT [tilv]
      ,[aineisto]
      ,[lahde]
      ,[sp]
      ,[aikielir1]
      ,[syntv]
      ,[tilvaskun]
      ,[kansalr1]
      ,[eumaa]
      ,[etamaa]
      ,[pohjmaa]
      ,[alvv]
      ,[allk]
      ,[ololk]
      ,[jarj]
      ,[tunn]
      ,[koulk]
	  ,[koulk_opintoala] = cast(coalesce(nullif(kl1.opintoala2002_koodi, ''''), ''-1'') as nvarchar(6))
	  --,[koulk_opintoala] = (select distinct  opintoala2002_koodi  from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
	  ,[koulk_koulutusala] = cast(coalesce(nullif(kl1.koulutusala2002_koodi , ''''), ''-1'') as nvarchar(6))
      --,[koulk_koulutusala] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
	  ,[koulk_koulutusaste] = cast(coalesce(nullif(kl1.koulutusaste2002_koodi , ''''), ''-1'') as nvarchar(6))
      --,[koulk_koulutusaste] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
      ,[kkielir1]
      ,[kkun]
	  ,[kkun_kmaak]= (select distinct maakunta_koodi   from [VipunenTK_DW].[dbo].[d_alueluokitus] where alueluokitus_avain = [kkun] and tilv+''-01-01'' between
	  (alkaa) and (paattyy) )
      ,[ophal]
      ,[koultyp]
      ,[tutkmaak]
      ,[tutkjarj]
      ,[tutktunn]
      ,[tutkkoulk]
	  ,[tutk_opintoala] = kl2.opintoala2002_koodi
      ,[tutk_koulutusala] = kl2.koulutusala2002_koodi
      ,[tutk_koulutusaste] = kl2.koulutusaste2002_koodi
      ,[tutkkoultyp]
      ,[seurvkmaak]
      ,[seurvjarj]
      ,[seurvtunn]
      ,[seurvkoulk]
	  ,[seurv_opintoala] = kl3.opintoala2002_koodi
      ,[seurv_koulutusala] = kl3.koulutusala2002_koodi
      ,[seurv_koulutusaste] = kl3.koulutusaste2002_koodi
      ,[seurvkoulutyp]
      ,[ptoim1r2]
      ,[amas1]
      ,[lkm]
  FROM [TK_H9098_CSC].[dbo].[TK_K3_11a_sopv_13] tk
  left join [VipunenTK_DW].[dbo].[d_koulutusluokitus] kl1 on kl1.koulutusluokitus_avain=tk.koulk and tilv+''-01-01'' between kl1.alkaa and kl1.paattyy
  left join [VipunenTK_DW].[dbo].[d_koulutusluokitus] kl2 on kl2.koulutusluokitus_avain=tk.tutkkoulk and tilv+''-01-01'' between kl2.alkaa and kl2.paattyy
  left join [VipunenTK_DW].[dbo].[d_koulutusluokitus] kl3 on kl3.koulutusluokitus_avain=tk.seurvkoulk and tilv+''-01-01'' between kl3.alkaa and kl3.paattyy
  where [aineisto] = ''L''
 UNION ALL
  SELECT [tilv]
      ,[aineisto]
      ,[lahde]
      ,[sp]
      ,[aikielir1]
      ,[syntv]
      ,[tilvaskun]
      ,[kansalr1]
      ,[eumaa]
      ,[etamaa]
      ,[pohjmaa]
      ,[alvv]
      ,[allk]
      ,[ololk]
      ,[jarj]
      ,[tunn]
      ,[koulk]
	  ,[koulk_opintoala] = cast(coalesce(nullif(kl1.opintoala2002_koodi, ''''), ''-1'') as nvarchar(6))
	  --,[koulk_opintoala] = (select distinct  opintoala2002_koodi  from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
	  ,[koulk_koulutusala] = cast(coalesce(nullif(kl1.koulutusala2002_koodi , ''''), ''-1'') as nvarchar(6))
      --,[koulk_koulutusala] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
	  ,[koulk_koulutusaste] = cast(coalesce(nullif(kl1.koulutusaste2002_koodi , ''''), ''-1'') as nvarchar(6))
      --,[koulk_koulutusaste] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
      ,[kkielir1]
      ,[kkun]
	  ,[kkun_kmaak]= (select distinct maakunta_koodi   from [VipunenTK_DW].[dbo].[d_alueluokitus] where alueluokitus_avain = [kkun] and tilv+''-01-01'' between
	  (alkaa) and (paattyy) )
      ,[ophal]
      ,[koultyp]
      ,[tutkmaak]
      ,[tutkjarj]
      ,[tutktunn]
      ,[tutkkoulk]
	  ,[tutk_opintoala] = kl2.opintoala2002_koodi
      ,[tutk_koulutusala] = kl2.koulutusala2002_koodi
      ,[tutk_koulutusaste] = kl2.koulutusaste2002_koodi
      ,[tutkkoultyp]
      ,[seurvkmaak]
      ,[seurvjarj]
      ,[seurvtunn]
      ,[seurvkoulk]
	  ,[seurv_opintoala] = kl3.opintoala2002_koodi
      ,[seurv_koulutusala] = kl3.koulutusala2002_koodi
      ,[seurv_koulutusaste] = kl3.koulutusaste2002_koodi
      ,[seurvkoulutyp]
      ,[ptoim1r2]
      ,[amas1]
      ,[lkm]
  FROM [TK_H9098_CSC].[dbo].[TK_K3_11a_sopv_14] tk
  left join [VipunenTK_DW].[dbo].[d_koulutusluokitus] kl1 on kl1.koulutusluokitus_avain=tk.koulk and tilv+''-01-01'' between kl1.alkaa and kl1.paattyy
  left join [VipunenTK_DW].[dbo].[d_koulutusluokitus] kl2 on kl2.koulutusluokitus_avain=tk.tutkkoulk and tilv+''-01-01'' between kl2.alkaa and kl2.paattyy
  left join [VipunenTK_DW].[dbo].[d_koulutusluokitus] kl3 on kl3.koulutusluokitus_avain=tk.seurvkoulk and tilv+''-01-01'' between kl3.alkaa and kl3.paattyy
  where [aineisto] = ''L''
UNION ALL
  SELECT [tilv]
      ,[aineisto]
      ,[lahde]
      ,[sp]
      ,[aikielir1]
      ,[syntv]
      ,[tilvaskun]
      ,[kansalr1]
      ,[eumaa]
      ,[etamaa]
      ,[pohjmaa]
      ,[alvv]
      ,[allk]
      ,[ololk]
      ,[jarj]
      ,[tunn]
      ,[koulk]
	  ,[koulk_opintoala] = cast(coalesce(nullif(kl1.opintoala2002_koodi, ''''), ''-1'') as nvarchar(6))
	  --,[koulk_opintoala] = (select distinct  opintoala2002_koodi  from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
	  ,[koulk_koulutusala] = cast(coalesce(nullif(kl1.koulutusala2002_koodi , ''''), ''-1'') as nvarchar(6))
      --,[koulk_koulutusala] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
	  ,[koulk_koulutusaste] = cast(coalesce(nullif(kl1.koulutusaste2002_koodi , ''''), ''-1'') as nvarchar(6))
      --,[koulk_koulutusaste] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
      ,[kkielir1]
      ,[kkun]
	  ,[kkun_kmaak]= (select distinct maakunta_koodi   from [VipunenTK_DW].[dbo].[d_alueluokitus] where alueluokitus_avain = [kkun] and tilv+''-01-01'' between
	  (alkaa) and (paattyy) )
      ,[ophal]
      ,[koultyp]
      ,[tutkmaak]
      ,[tutkjarj]
      ,[tutktunn]
      ,[tutkkoulk]
	  ,[tutk_opintoala] = kl2.opintoala2002_koodi
      ,[tutk_koulutusala] = kl2.koulutusala2002_koodi
      ,[tutk_koulutusaste] = kl2.koulutusaste2002_koodi
      ,[tutkkoultyp]
      ,[seurvkmaak]
      ,[seurvjarj]
      ,[seurvtunn]
      ,[seurvkoulk]
	  ,[seurv_opintoala] = kl3.opintoala2002_koodi
      ,[seurv_koulutusala] = kl3.koulutusala2002_koodi
      ,[seurv_koulutusaste] = kl3.koulutusaste2002_koodi
      ,[seurvkoulutyp]
      ,[ptoim1r2]
      ,[amas1]
      ,[lkm]
  FROM [TK_H9098_CSC].[dbo].[TK_K3_11a_sopv_15] tk
  left join [VipunenTK_DW].[dbo].[d_koulutusluokitus] kl1 on kl1.koulutusluokitus_avain=tk.koulk and tilv+''-01-01'' between kl1.alkaa and kl1.paattyy
  left join [VipunenTK_DW].[dbo].[d_koulutusluokitus] kl2 on kl2.koulutusluokitus_avain=tk.tutkkoulk and tilv+''-01-01'' between kl2.alkaa and kl2.paattyy
  left join [VipunenTK_DW].[dbo].[d_koulutusluokitus] kl3 on kl3.koulutusluokitus_avain=tk.seurvkoulk and tilv+''-01-01'' between kl3.alkaa and kl3.paattyy
  where [aineisto] = ''L''
UNION ALL
  SELECT [tilv]
      ,[aineisto]
      ,[lahde]
      ,[sp]
      ,[aikielir1]
      ,[syntv]
      ,[tilvaskun]
      ,[kansalr1]
      ,[eumaa]
      ,[etamaa]
      ,[pohjmaa]
      ,[alvv]
      ,[allk]
      ,[ololk]
      ,[jarj]
      ,[tunn]
      ,[koulk]
	  ,[koulk_opintoala] = cast(coalesce(nullif(kl1.opintoala2002_koodi, ''''), ''-1'') as nvarchar(6))
	  --,[koulk_opintoala] = (select distinct  opintoala2002_koodi  from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
	  ,[koulk_koulutusala] = cast(coalesce(nullif(kl1.koulutusala2002_koodi , ''''), ''-1'') as nvarchar(6))
      --,[koulk_koulutusala] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
	  ,[koulk_koulutusaste] = cast(coalesce(nullif(kl1.koulutusaste2002_koodi , ''''), ''-1'') as nvarchar(6))
      --,[koulk_koulutusaste] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
      ,[kkielir1]
      ,[kkun]
	  ,[kkun_kmaak]= (select distinct maakunta_koodi   from [VipunenTK_DW].[dbo].[d_alueluokitus] where alueluokitus_avain = [kkun] and tilv+''-01-01'' between
	  (alkaa) and (paattyy) )
      ,[ophal]
      ,[koultyp]
      ,[tutkmaak]
      ,[tutkjarj]
      ,[tutktunn]
      ,[tutkkoulk]
	  ,[tutk_opintoala] = kl2.opintoala2002_koodi
      ,[tutk_koulutusala] = kl2.koulutusala2002_koodi
      ,[tutk_koulutusaste] = kl2.koulutusaste2002_koodi
      ,[tutkkoultyp]
      ,[seurvkmaak]
      ,[seurvjarj]
      ,[seurvtunn]
      ,[seurvkoulk]
	  ,[seurv_opintoala] = kl3.opintoala2002_koodi
      ,[seurv_koulutusala] = kl3.koulutusala2002_koodi
      ,[seurv_koulutusaste] = kl3.koulutusaste2002_koodi
      ,[seurvkoulutyp]
      ,[ptoim1r2]
      ,[amas1]
      ,[lkm]
  FROM [TK_H9098_CSC].[dbo].[TK_K3_11a_sopv_16] tk
  left join [VipunenTK_DW].[dbo].[d_koulutusluokitus] kl1 on kl1.koulutusluokitus_avain=tk.koulk and tilv+''-01-01'' between kl1.alkaa and kl1.paattyy
  left join [VipunenTK_DW].[dbo].[d_koulutusluokitus] kl2 on kl2.koulutusluokitus_avain=tk.tutkkoulk and tilv+''-01-01'' between kl2.alkaa and kl2.paattyy
  left join [VipunenTK_DW].[dbo].[d_koulutusluokitus] kl3 on kl3.koulutusluokitus_avain=tk.seurvkoulk and tilv+''-01-01'' between kl3.alkaa and kl3.paattyy
  where [aineisto] = ''L''
UNION ALL
  SELECT [tilv]
      ,[aineisto]
      ,[lahde]
      ,[sp]
      ,[aikielir1]
      ,[syntv]
      ,[tilvaskun]
      ,[kansalr1]
      ,[eumaa]
      ,[etamaa]
      ,[pohjmaa]
      ,[alvv]
      ,[allk]
      ,[ololk]
      ,[jarj]
      ,[tunn]
      ,[koulk]
	  ,[koulk_opintoala] = cast(coalesce(nullif(kl1.opintoala2002_koodi, ''''), ''-1'') as nvarchar(6))
	  --,[koulk_opintoala] = (select distinct  opintoala2002_koodi  from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
	  ,[koulk_koulutusala] = cast(coalesce(nullif(kl1.koulutusala2002_koodi , ''''), ''-1'') as nvarchar(6))
      --,[koulk_koulutusala] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
	  ,[koulk_koulutusaste] = cast(coalesce(nullif(kl1.koulutusaste2002_koodi , ''''), ''-1'') as nvarchar(6))
      --,[koulk_koulutusaste] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
      ,[kkielir1]
      ,[kkun]
	  ,[kkun_kmaak]= (select distinct maakunta_koodi   from [VipunenTK_DW].[dbo].[d_alueluokitus] where alueluokitus_avain = [kkun] and tilv+''-01-01'' between
	  (alkaa) and (paattyy) )
      ,[ophal]
      ,[koultyp]
      ,[tutkmaak]
      ,[tutkjarj]
      ,[tutktunn]
      ,[tutkkoulk]
	  ,[tutk_opintoala] = kl2.opintoala2002_koodi
      ,[tutk_koulutusala] = kl2.koulutusala2002_koodi
      ,[tutk_koulutusaste] = kl2.koulutusaste2002_koodi
      ,[tutkkoultyp]
      ,[seurvkmaak]
      ,[seurvjarj]
      ,[seurvtunn]
      ,[seurvkoulk]
	  ,[seurv_opintoala] = kl3.opintoala2002_koodi
      ,[seurv_koulutusala] = kl3.koulutusala2002_koodi
      ,[seurv_koulutusaste] = kl3.koulutusaste2002_koodi
      ,[seurvkoulutyp]
      ,[ptoim1r2]
      ,[amas1]
      ,[lkm]
  FROM [TK_H9098_CSC].[dbo].[TK_K3_11a_sopv_17] tk
  left join [VipunenTK_DW].[dbo].[d_koulutusluokitus] kl1 on kl1.koulutusluokitus_avain=tk.koulk and tilv+''-01-01'' between kl1.alkaa and kl1.paattyy
  left join [VipunenTK_DW].[dbo].[d_koulutusluokitus] kl2 on kl2.koulutusluokitus_avain=tk.tutkkoulk and tilv+''-01-01'' between kl2.alkaa and kl2.paattyy
  left join [VipunenTK_DW].[dbo].[d_koulutusluokitus] kl3 on kl3.koulutusluokitus_avain=tk.seurvkoulk and tilv+''-01-01'' between kl3.alkaa and kl3.paattyy
  where [aineisto] = ''L''
/*
UNION ALL
  SELECT  
       [tilv]
      ,[aineisto]
      ,[lahde]
      ,[sp]
      ,[aikielir1]
      ,[syntv]
      ,[tilvaskun]
      ,[kansalr1]
      ,[eumaa]
      ,[etamaa]
      ,[pohjmaa]
      ,[alvv]
      ,[allk]
      ,[ololk]
      ,[jarj]
      ,[tunn]
      ,[koulk]
	  ,[koulk_opintoala] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''-01-01'' between
	  (alkaa) and (paattyy))
      ,[koulk_koulutusala] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''-01-01'' between
	  (alkaa) and (paattyy))
      ,[koulk_koulutusaste] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''-01-01'' between
	  (alkaa) and (paattyy))
      ,[kkielir1]
      ,[kkun]
	  ,[kkun_kmaak]= (select distinct maakunta_koodi   from [VipunenTK_DW].[dbo].[d_alueluokitus] where alueluokitus_avain = [kkun] and tilv+''-01-01'' between
	  (alkaa) and (paattyy))
      ,[ophal]
      ,[koultyp]
      ,[tutkmaak]
      ,[tutkjarj]
      ,[tutktunn]
      ,[tutkkoulk]
	  ,[tutk_opintoala] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [tutkkoulk] and tilv+''-01-01'' between
	  (alkaa) and (paattyy))
      ,[tutk_koulutusala] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [tutkkoulk] and tilv+''-01-01'' between
	  (alkaa) and (paattyy))
      ,[tutk_koulutusaste] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [tutkkoulk] and tilv+''-01-01'' between
	  (alkaa) and (paattyy))
      ,[tutkkoultyp]
      ,[seurvkmaak]
      ,[seurvjarj]
      ,[seurvtunn]
      ,[seurvkoulk]
	  ,[seurv_opintoala] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [seurvkoulk] and tilv+''-01-01'' between
	  (alkaa) and (paattyy))
      ,[seurv_koulutusala] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [seurvkoulk] and tilv+''-01-01'' between
	  (alkaa) and (paattyy))
      ,[seurv_koulutusaste] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [seurvkoulk] and tilv+''-01-01'' between
	  (alkaa) and (paattyy))
      ,[seurvkoulutyp]
	  ,[ptoim1r2]=NULL
      ,[amas1]= NULL
      ,[lkm]
  FROM [TK_H9098_CSC].[dbo].[TK_K3_11b_sopv_11]
  where [aineisto] = ''L''
  UNION ALL
  SELECT [tilv]
      ,[aineisto]
      ,[lahde]
      ,[sp]
      ,[aikielir1]
      ,[syntv]
      ,[tilvaskun]
      ,[kansalr1]
      ,[eumaa]
      ,[etamaa]
      ,[pohjmaa]
      ,[alvv]
      ,[allk]
      ,[ololk]
      ,[jarj]
      ,[tunn]
      ,[koulk]
	  ,[koulk_opintoala] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''-01-01'' between
	  (alkaa) and (paattyy))
      ,[koulk_koulutusala] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''-01-01'' between
	  (alkaa) and (paattyy))
      ,[koulk_koulutusaste] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''-01-01'' between
	  (alkaa) and (paattyy))
      ,[kkielir1]
      ,[kkun]
	  ,[kkun_kmaak]= (select distinct maakunta_koodi   from [VipunenTK_DW].[dbo].[d_alueluokitus] where alueluokitus_avain = [kkun] and tilv+''-01-01'' between
	  (alkaa) and (paattyy))
      ,[ophal]
      ,[koultyp]
      ,[tutkmaak]
      ,[tutkjarj]
      ,[tutktunn]
      ,[tutkkoulk]
	  ,[tutk_opintoala] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [tutkkoulk] and tilv+''-01-01'' between
	  (alkaa) and (paattyy))
      ,[tutk_koulutusala] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [tutkkoulk] and tilv+''-01-01'' between
	  (alkaa) and (paattyy))
      ,[tutk_koulutusaste] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [tutkkoulk] and tilv+''-01-01'' between
	  (alkaa) and (paattyy))
      ,[tutkkoultyp]
      ,[seurvkmaak]
      ,[seurvjarj]
      ,[seurvtunn]
      ,[seurvkoulk]
	  ,[seurv_opintoala] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [seurvkoulk] and tilv+''-01-01'' between
	  (alkaa) and (paattyy))
      ,[seurv_koulutusala] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [seurvkoulk] and tilv+''-01-01'' between
	  (alkaa) and (paattyy))
      ,[seurv_koulutusaste] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [seurvkoulk] and tilv+''-01-01'' between
	  (alkaa) and (paattyy))
      ,[seurvkoulutyp]
	  ,[ptoim1r2]=NULL
      ,[amas1]= NULL
      ,[lkm]
  FROM [TK_H9098_CSC].[dbo].[TK_K3_11b_sopv_12]
  where [aineisto] = ''L''
  UNION ALL
  SELECT [tilv]
      ,[aineisto]
      ,[lahde]
      ,[sp]
      ,[aikielir1]
      ,[syntv]
      ,[tilvaskun]
      ,[kansalr1]
      ,[eumaa]
      ,[etamaa]
      ,[pohjmaa]
      ,[alvv]
      ,[allk]
      ,[ololk]
      ,[jarj]
      ,[tunn]
      ,[koulk]
	  ,[koulk_opintoala] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''-01-01'' between
	  (alkaa) and (paattyy))
      ,[koulk_koulutusala] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''-01-01'' between
	  (alkaa) and (paattyy))
      ,[koulk_koulutusaste] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''-01-01'' between
	  (alkaa) and (paattyy))
      ,[kkielir1]
      ,[kkun]
	  ,[kkun_kmaak]= (select distinct maakunta_koodi   from [VipunenTK_DW].[dbo].[d_alueluokitus] where alueluokitus_avain = [kkun] and tilv+''-01-01'' between
	  (alkaa) and (paattyy))
      ,[ophal]
      ,[koultyp]
      ,[tutkmaak]
      ,[tutkjarj]
      ,[tutktunn]
      ,[tutkkoulk]
	  ,[tutk_opintoala] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [tutkkoulk] and tilv+''-01-01'' between
	  (alkaa) and (paattyy))
      ,[tutk_koulutusala] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [tutkkoulk] and tilv+''-01-01'' between
	  (alkaa) and (paattyy))
      ,[tutk_koulutusaste] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [tutkkoulk] and tilv+''-01-01'' between
	  (alkaa) and (paattyy))
      ,[tutkkoultyp]
      ,[seurvkmaak]
      ,[seurvjarj]
      ,[seurvtunn]
      ,[seurvkoulk]
	  ,[seurv_opintoala] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [seurvkoulk] and tilv+''-01-01'' between
	  (alkaa) and (paattyy))
      ,[seurv_koulutusala] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [seurvkoulk] and tilv+''-01-01'' between
	  (alkaa) and (paattyy))
      ,[seurv_koulutusaste] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [seurvkoulk] and tilv+''-01-01'' between
	  (alkaa) and (paattyy))
      ,[seurvkoulutyp]
      ,[lkm]
	  ,[ptoim1r2]=NULL
      ,[amas1]= NULL
  FROM [TK_H9098_CSC].[dbo].[TK_K3_11b_sopv_13]
  where [aineisto] = ''L''
  UNION ALL
  SELECT [tilv]
      ,[aineisto]
      ,[lahde]
      ,[sp]
      ,[aikielir1]
      ,[syntv]
      ,[tilvaskun]
      ,[kansalr1]
      ,[eumaa]
      ,[etamaa]
      ,[pohjmaa]
      ,[alvv]
      ,[allk]
      ,[ololk]
      ,[jarj]
      ,[tunn]
      ,[koulk]
	  ,[koulk_opintoala] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''-01-01'' between
	  (alkaa) and (paattyy))
      ,[koulk_koulutusala] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''-01-01'' between
	  (alkaa) and (paattyy))
      ,[koulk_koulutusaste] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''-01-01'' between
	  (alkaa) and (paattyy))
      ,[kkielir1]
      ,[kkun]
	  ,[kkun_kmaak]= (select distinct maakunta_koodi   from [VipunenTK_DW].[dbo].[d_alueluokitus] where alueluokitus_avain = [kkun] and tilv+''-01-01'' between
	  (alkaa) and (paattyy))
      ,[ophal]
      ,[koultyp]
      ,[tutkmaak]
      ,[tutkjarj]
      ,[tutktunn]
      ,[tutkkoulk]
	  ,[tutk_opintoala] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [tutkkoulk] and tilv+''-01-01'' between
	  (alkaa) and (paattyy))
      ,[tutk_koulutusala] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [tutkkoulk] and tilv+''-01-01'' between
	  (alkaa) and (paattyy))
      ,[tutk_koulutusaste] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [tutkkoulk] and tilv+''-01-01'' between
	  (alkaa) and (paattyy))
      ,[tutkkoultyp]
      ,[seurvkmaak]
      ,[seurvjarj]
      ,[seurvtunn]
      ,[seurvkoulk]
	  ,[seurv_opintoala] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [seurvkoulk] and tilv+''-01-01'' between
	  (alkaa) and (paattyy))
      ,[seurv_koulutusala] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [seurvkoulk] and tilv+''-01-01'' between
	  (alkaa) and (paattyy))
      ,[seurv_koulutusaste] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [seurvkoulk] and tilv+''-01-01'' between
	  (alkaa) and (paattyy))
      ,[seurvkoulutyp]
      ,[lkm]
	  ,[ptoim1r2]=NULL
      ,[amas1]= NULL
  FROM [TK_H9098_CSC].[dbo].[TK_K3_11b_sopv_14]
  where [aineisto] = ''L''
  UNION ALL
  SELECT [tilv]
      ,[aineisto]
      ,[lahde]
      ,[sp]
      ,[aikielir1]
      ,[syntv]
      ,[tilvaskun]
      ,[kansalr1]
      ,[eumaa]
      ,[etamaa]
      ,[pohjmaa]
      ,[alvv]
      ,[allk]
      ,[ololk]
      ,[jarj]
      ,[tunn]
      ,[koulk]
	  ,[koulk_opintoala] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''-01-01'' between
	  (alkaa) and (paattyy))
      ,[koulk_koulutusala] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''-01-01'' between
	  (alkaa) and (paattyy))
      ,[koulk_koulutusaste] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''-01-01'' between
	  (alkaa) and (paattyy))
      ,[kkielir1]
      ,[kkun]
	  ,[kkun_kmaak]= (select distinct maakunta_koodi   from [VipunenTK_DW].[dbo].[d_alueluokitus] where alueluokitus_avain = [kkun] and tilv+''-01-01'' between
	  (alkaa) and (paattyy))
      ,[ophal]
      ,[koultyp]
      ,[tutkmaak]
      ,[tutkjarj]
      ,[tutktunn]
      ,[tutkkoulk]
	  ,[tutk_opintoala] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [tutkkoulk] and tilv+''-01-01'' between
	  (alkaa) and (paattyy))
      ,[tutk_koulutusala] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [tutkkoulk] and tilv+''-01-01'' between
	  (alkaa) and (paattyy))
      ,[tutk_koulutusaste] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [tutkkoulk] and tilv+''-01-01'' between
	  (alkaa) and (paattyy))
      ,[tutkkoultyp]
      ,[seurvkmaak]
      ,[seurvjarj]
      ,[seurvtunn]
      ,[seurvkoulk]
	  ,[seurv_opintoala] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [seurvkoulk] and tilv+''-01-01'' between
	  (alkaa) and (paattyy))
      ,[seurv_koulutusala] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [seurvkoulk] and tilv+''-01-01'' between
	  (alkaa) and (paattyy))
      ,[seurv_koulutusaste] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [seurvkoulk] and tilv+''-01-01'' between
	  (alkaa) and (paattyy))
      ,[seurvkoulutyp]
      ,[lkm]
	  ,[ptoim1r2]=NULL
      ,[amas1]= NULL
  FROM [TK_H9098_CSC].[dbo].[TK_K3_11b_sopv_15]
  where [aineisto] = ''L''
  UNION ALL
  SELECT [tilv]
      ,[aineisto]
      ,[lahde]
      ,[sp]
      ,[aikielir1]
      ,[syntv]
      ,[tilvaskun]
      ,[kansalr1]
      ,[eumaa]
      ,[etamaa]
      ,[pohjmaa]
      ,[alvv]
      ,[allk]
      ,[ololk]
      ,[jarj]
      ,[tunn]
      ,[koulk]
	  ,[koulk_opintoala] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''-01-01'' between
	  (alkaa) and (paattyy))
      ,[koulk_koulutusala] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''-01-01'' between
	  (alkaa) and (paattyy))
      ,[koulk_koulutusaste] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''-01-01'' between
	  (alkaa) and (paattyy))
      ,[kkielir1]
      ,[kkun]
	  ,[kkun_kmaak]= (select distinct maakunta_koodi   from [VipunenTK_DW].[dbo].[d_alueluokitus] where alueluokitus_avain = [kkun] and tilv+''-01-01'' between
	  (alkaa) and (paattyy))
      ,[ophal]
      ,[koultyp]
      ,[tutkmaak]
      ,[tutkjarj]
      ,[tutktunn]
      ,[tutkkoulk]
	  ,[tutk_opintoala] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [tutkkoulk] and tilv+''-01-01'' between
	  (alkaa) and (paattyy))
      ,[tutk_koulutusala] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [tutkkoulk] and tilv+''-01-01'' between
	  (alkaa) and (paattyy))
      ,[tutk_koulutusaste] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [tutkkoulk] and tilv+''-01-01'' between
	  (alkaa) and (paattyy))
      ,[tutkkoultyp]
      ,[seurvkmaak]
      ,[seurvjarj]
      ,[seurvtunn]
      ,[seurvkoulk]
	  ,[seurv_opintoala] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [seurvkoulk] and tilv+''-01-01'' between
	  (alkaa) and (paattyy))
      ,[seurv_koulutusala] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [seurvkoulk] and tilv+''-01-01'' between
	  (alkaa) and (paattyy))
      ,[seurv_koulutusaste] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [seurvkoulk] and tilv+''-01-01'' between
	  (alkaa) and (paattyy))
      ,[seurvkoulutyp]
      ,[lkm]
	  ,[ptoim1r2]=NULL
      ,[amas1]= NULL
  FROM [TK_H9098_CSC].[dbo].[TK_K3_11b_sopv_16]
  where [aineisto] = ''L''
  */

) as kaikkivuodet





























' 
GO
/****** Object:  View [dbo].[v_sa_K3_16_Moninkertainen_haku]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_K3_16_Moninkertainen_haku]'))
EXEC dbo.sp_executesql @statement = N'



CREATE VIEW [dbo].[v_sa_K3_16_Moninkertainen_haku] AS

-- truncate table vipunentk_dw.dbo.sa_K3_16_Moninkertainen_haku
-- insert into vipunentk_dw.dbo.sa_K3_16_Moninkertainen_haku select * from [VipunenTK_SA].dbo.v_sa_K3_16_Moninkertainen_haku

-- Drop table vipunentk_dw.dbo.sa_K3_16_Moninkertainen_haku
-- Select * into vipunentk_dw.dbo.sa_K3_16_Moninkertainen_haku from [VipunenTK_SA].dbo.v_sa_K3_16_Moninkertainen_haku

SELECT [tilv]
	  ,tilv_date = Cast(kaikkivuodet.tilv+''0101'' as date)
      ,[allk]
      ,[luammhaku1_tunn]
      ,[luammhaku2_tunn]
      ,[luammhaku3_tunn]
      ,[luammhaku4_tunn]
      ,[luammhaku5_tunn]
      ,[luammhaku1_opmast]
      ,[luammhaku2_opmast]
      ,[luammhaku3_opmast]
      ,[luammhaku4_opmast]
      ,[luammhaku5_opmast]
      ,[luammhaku1_opmopa]
      ,[luammhaku2_opmopa]
      ,[luammhaku3_opmopa]
      ,[luammhaku4_opmopa]
      ,[luammhaku5_opmopa]
      ,[luammhaku1_opm95opa]
      ,[luammhaku2_opm95opa]
      ,[luammhaku3_opm95opa]
      ,[luammhaku4_opm95opa]
      ,[luammhaku5_opm95opa]
      ,[luammhaku1_okieli]
      ,[luammhaku2_okieli]
      ,[luammhaku3_okieli]
      ,[luammhaku4_okieli]
      ,[luammhaku5_okieli]
      ,[luammhaku1_hyv] = Case when luammhaku1_hyv=''1'' then ''K'' when luammhaku1_hyv=''2'' then ''E'' else NULL end
      ,[luammhaku2_hyv] = Case when luammhaku2_hyv=''1'' then ''K'' when luammhaku2_hyv=''2'' then ''E'' else NULL end
      ,[luammhaku3_hyv] = Case when luammhaku3_hyv=''1'' then ''K'' when luammhaku3_hyv=''2'' then ''E'' else NULL end
      ,[luammhaku4_hyv] = Case when luammhaku4_hyv=''1'' then ''K'' when luammhaku4_hyv=''2'' then ''E'' else NULL end
      ,[luammhaku5_hyv] = Case when luammhaku5_hyv=''1'' then ''K'' when luammhaku5_hyv=''2'' then ''E'' else NULL end
      ,[luammhaku1_vastotto] = Case when luammhaku1_vastotto=''1'' then ''K'' when luammhaku1_vastotto=''2'' then ''E'' else NULL end
      ,[luammhaku2_vastotto] = Case when luammhaku2_vastotto=''1'' then ''K'' when luammhaku2_vastotto=''2'' then ''E'' else NULL end
      ,[luammhaku3_vastotto] = Case when luammhaku3_vastotto=''1'' then ''K'' when luammhaku3_vastotto=''2'' then ''E'' else NULL end
      ,[luammhaku4_vastotto] = Case when luammhaku4_vastotto=''1'' then ''K'' when luammhaku4_vastotto=''2'' then ''E'' else NULL end
      ,[luammhaku5_vastotto] = Case when luammhaku5_vastotto=''1'' then ''K'' when luammhaku5_vastotto=''2'' then ''E'' else NULL end
      ,[amkhaku1_tunn]
      ,[amkhaku2_tunn]
      ,[amkhaku3_tunn]
      ,[amkhaku4_tunn]
      ,[amkhakum_tunn]
      ,[amkhaku1_opmast]
      ,[amkhaku2_opmast]
      ,[amkhaku3_opmast]
      ,[amkhaku4_opmast]
      ,[amkhakum_opmast]
      ,[amkhaku1_opmopa]
      ,[amkhaku2_opmopa]
      ,[amkhaku3_opmopa]
      ,[amkhaku4_opmopa]
      ,[amkhakum_opmopa]
      ,[amkhaku1_opm95opa]
      ,[amkhaku2_opm95opa]
      ,[amkhaku3_opm95opa]
      ,[amkhaku4_opm95opa]
      ,[amkhakum_opm95opa]
      ,[amkhaku1_koultyp]
      ,[amkhaku2_koultyp]
      ,[amkhaku3_koultyp]
      ,[amkhaku4_koultyp]
      ,[amkhakum_koultyp]
      ,[amkhaku1_okieli]
      ,[amkhaku2_okieli]
      ,[amkhaku3_okieli]
      ,[amkhaku4_okieli]
      ,[amkhakum_okieli]
      ,[amkhaku1_hyv] = Case when amkhaku1_hyv=''1'' then ''K'' when amkhaku1_hyv=''2'' then ''E'' else NULL end
      ,[amkhaku2_hyv] = Case when amkhaku2_hyv=''1'' then ''K'' when amkhaku2_hyv=''2'' then ''E'' else NULL end
      ,[amkhaku3_hyv] = Case when amkhaku3_hyv=''1'' then ''K'' when amkhaku3_hyv=''2'' then ''E'' else NULL end
      ,[amkhaku4_hyv] = Case when amkhaku4_hyv=''1'' then ''K'' when amkhaku4_hyv=''2'' then ''E'' else NULL end
      ,[amkhakum_hyv] = Case when amkhakum_hyv=''1'' then ''K'' when amkhakum_hyv=''2'' then ''E'' else NULL end
      ,[amkhaku1_vastotto] = Case when amkhaku1_vastotto=''1'' then ''K'' when amkhaku1_vastotto=''2'' then ''E'' else NULL end
      ,[amkhaku2_vastotto] = Case when amkhaku2_vastotto=''1'' then ''K'' when amkhaku2_vastotto=''2'' then ''E'' else NULL end
      ,[amkhaku3_vastotto] = Case when amkhaku3_vastotto=''1'' then ''K'' when amkhaku3_vastotto=''2'' then ''E'' else NULL end
      ,[amkhaku4_vastotto] = Case when amkhaku4_vastotto=''1'' then ''K'' when amkhaku4_vastotto=''2'' then ''E'' else NULL end
      ,[amkhakum_vastotto] = Case when amkhakum_vastotto=''1'' then ''K'' when amkhakum_vastotto=''2'' then ''E'' else NULL end
      ,[yohakua_tunn]
      ,[yohakub_tunn]
      ,[yohakuc_tunn]
      ,[yohakud_tunn]
      ,[yohakue_tunn]
      ,[yohakuf_tunn]
      ,[yohakug_tunn]
      ,[yohakuh_tunn]
      ,[yohakui_tunn]
      ,[yohakua_opmast]
      ,[yohakub_opmast]
      ,[yohakuc_opmast]
      ,[yohakud_opmast]
      ,[yohakue_opmast]
      ,[yohakuf_opmast]
      ,[yohakug_opmast]
      ,[yohakuh_opmast]
      ,[yohakui_opmast]
      ,[yohakua_opmopa]
      ,[yohakub_opmopa]
      ,[yohakuc_opmopa]
      ,[yohakud_opmopa]
      ,[yohakue_opmopa]
      ,[yohakuf_opmopa]
      ,[yohakug_opmopa]
      ,[yohakuh_opmopa]
      ,[yohakui_opmopa]
      ,[yohakua_opm95opa]
      ,[yohakub_opm95opa]
      ,[yohakuc_opm95opa]
      ,[yohakud_opm95opa]
      ,[yohakue_opm95opa]
      ,[yohakuf_opm95opa]
      ,[yohakug_opm95opa]
      ,[yohakuh_opm95opa]
      ,[yohakui_opm95opa]
      ,[yohakua_hyv] = Case when yohakua_hyv=''1'' then ''K'' when yohakua_hyv=''2'' then ''E'' else NULL end
      ,[yohakub_hyv] = Case when yohakub_hyv=''1'' then ''K'' when yohakub_hyv=''2'' then ''E'' else NULL end
      ,[yohakuc_hyv] = Case when yohakuc_hyv=''1'' then ''K'' when yohakuc_hyv=''2'' then ''E'' else NULL end
      ,[yohakud_hyv] = Case when yohakud_hyv=''1'' then ''K'' when yohakud_hyv=''2'' then ''E'' else NULL end
      ,[yohakue_hyv] = Case when yohakue_hyv=''1'' then ''K'' when yohakue_hyv=''2'' then ''E'' else NULL end
      ,[yohakuf_hyv] = Case when yohakuf_hyv=''1'' then ''K'' when yohakuf_hyv=''2'' then ''E'' else NULL end
      ,[yohakug_hyv] = Case when yohakug_hyv=''1'' then ''K'' when yohakug_hyv=''2'' then ''E'' else NULL end
      ,[yohakuh_hyv] = Case when yohakuh_hyv=''1'' then ''K'' when yohakuh_hyv=''2'' then ''E'' else NULL end
      ,[yohakui_hyv] = Case when yohakui_hyv=''1'' then ''K'' when yohakui_hyv=''2'' then ''E'' else NULL end
      ,[yohakua_vastotto] = Case when yohakua_vastotto=''1'' then ''K'' when yohakua_vastotto=''2'' then ''E'' else NULL end
      ,[yohakub_vastotto] = Case when yohakub_vastotto=''1'' then ''K'' when yohakub_vastotto=''2'' then ''E'' else NULL end
      ,[yohakuc_vastotto] = Case when yohakuc_vastotto=''1'' then ''K'' when yohakuc_vastotto=''2'' then ''E'' else NULL end
      ,[yohakud_vastotto] = Case when yohakud_vastotto=''1'' then ''K'' when yohakud_vastotto=''2'' then ''E'' else NULL end
      ,[yohakue_vastotto] = Case when yohakue_vastotto=''1'' then ''K'' when yohakue_vastotto=''2'' then ''E'' else NULL end
      ,[yohakuf_vastotto] = Case when yohakuf_vastotto=''1'' then ''K'' when yohakuf_vastotto=''2'' then ''E'' else NULL end
      ,[yohakug_vastotto] = Case when yohakug_vastotto=''1'' then ''K'' when yohakug_vastotto=''2'' then ''E'' else NULL end
      ,[yohakuh_vastotto] = Case when yohakuh_vastotto=''1'' then ''K'' when yohakuh_vastotto=''2'' then ''E'' else NULL end
      ,[yohakui_vastotto] = Case when yohakui_vastotto=''1'' then ''K'' when yohakui_vastotto=''2'' then ''E'' else NULL end
      ,[yohakua_harekast]
      ,[yohakub_harekast]
      ,[yohakuc_harekast]
      ,[yohakud_harekast]
      ,[yohakue_harekast]
      ,[yohakuf_harekast]
      ,[yohakug_harekast]
      ,[yohakuh_harekast]
      ,[yohakui_harekast]
      ,[yohakua_ylempi]
      ,[yohakub_ylempi]
      ,[yohakuc_ylempi]
      ,[yohakud_ylempi]
      ,[yohakue_ylempi]
      ,[yohakuf_ylempi]
      ,[yohakug_ylempi]
      ,[yohakuh_ylempi]
      ,[yohakui_ylempi]
      ,[yohakua_erval]
      ,[yohakub_erval]
      ,[yohakuc_erval]
      ,[yohakud_erval]
      ,[yohakue_erval]
      ,[yohakuf_erval]
      ,[yohakug_erval]
      ,[yohakuh_erval]
      ,[yohakui_erval]
      ,[luhakux] = Case when luhakux=''1'' then ''K'' when luhakux=''2'' then ''E'' else NULL end
      ,[luhaku2x] = Case when luhaku2x=''1'' then ''K'' when luhaku2x=''2'' then ''E'' else NULL end
      ,[luhaku3x] = Case when luhaku3x=''1'' then ''K'' when luhaku3x=''2'' then ''E'' else NULL end
      ,[ammhakux] = Case when ammhakux=''1'' then ''K'' when ammhakux=''2'' then ''E'' else NULL end
      ,[ammhaku2x] = Case when ammhaku2x=''1'' then ''K'' when ammhaku2x=''2'' then ''E'' else NULL end
      ,[ammhaku3x] = Case when ammhaku3x=''1'' then ''K'' when ammhaku3x=''2'' then ''E'' else NULL end
      ,[amkhakux] = Case when amkhakux=''1'' then ''K'' when amkhakux=''2'' then ''E'' else NULL end
      ,[amkhaku2x] = Case when amkhaku2x=''1'' then ''K'' when amkhaku2x=''2'' then ''E'' else NULL end
      ,[amkhaku3x] = Case when amkhaku3x=''1'' then ''K'' when amkhaku3x=''2'' then ''E'' else NULL end
      ,[yohakux] = Case when yohakux=''1'' then ''K'' when yohakux=''2'' then ''E'' else NULL end
      ,[yohaku2x] = Case when yohaku2x=''1'' then ''K'' when yohaku2x=''2'' then ''E'' else NULL end
      ,[yohaku3x] = Case when yohaku3x=''1'' then ''K'' when yohaku3x=''2'' then ''E'' else NULL end
      ,[sp]
      ,[aikielir1]
      ,[syntv] = Case when syntv=''9999'' then '''' else syntv end
      ,[tilvaskunx]
      ,[kansalr1]
      ,[aikyotutk] = Case when aikyotutk=''1'' then ''K'' when aikyotutk=''0'' then ''E'' else ''E'' end
      ,[aikyotutkkoulk]
      ,[suvuosiyotutk]
      ,[tunnyotutk]
      ,[aikamm] = Case when aikamm=''1'' then ''K'' when aikamm=''0'' then ''E'' else ''E'' end
      ,[aikammkoulk]
      ,[suvuosiamm]
      ,[tunnamm]
      ,[aikamk] = Case when aikamk=''1'' then ''K'' when aikamk=''0'' then ''E'' else ''E'' end
      ,[aikamkkoulk]
      ,[suvuosiamk]
      ,[tunnamk]
      ,[aikylamk] = Case when aikylamk=''1'' then ''K'' when aikylamk=''0'' then ''E'' else ''E'' end
      ,[aikylamkkoulk]
      ,[suvuosiylamk]
      ,[tunnylamk]
      ,[aikalkk] = Case when aikalkk=''1'' then ''K'' when aikalkk=''0'' then ''E'' else ''E'' end
      ,[aikalkkkoulk]
      ,[suvuosialkk]
      ,[tunnalkk]
      ,[aikylkk] = Case when aikylkk=''1'' then ''K'' when aikylkk=''0'' then ''E'' else ''E'' end
      ,[aikylkkkoulk]
      ,[suvuosiylkk]
      ,[tunnylkk]
      ,[aiklistri] = Case when aiklistri=''1'' then ''K'' when aiklistri=''0'' then ''E'' else ''E'' end
      ,[aiklistrikoulk]
      ,[suvuosilistri]
      ,[tunnlistri]
      ,[yotutkopisx] = Case when [yotutkopisx]=''1'' then ''K'' when [yotutkopisx]=''0'' then ''E'' else ''E'' end
      ,[yotutkopisxkoulk]
      ,[yotutkopisxtunn]
      ,[ammopisx] = Case when [ammopisx]=''1'' then ''K'' when [ammopisx]=''0'' then ''E'' else ''E'' end
      ,[ammopisxkoulk]
      ,[ammopisxtunn]
      ,[amkopisx1] = Case when [amkopisx1]=''1'' then ''K'' when [amkopisx1]=''0'' then ''E'' else ''E'' end
      ,[amkopisxkoulk1]
      ,[amkopisxtunn1]
      ,[amkopisx2] = Case when [amkopisx2]=''1'' then ''K'' when [amkopisx2]=''0'' then ''E'' else ''E'' end
      ,[amkopisxkoulk2]
      ,[amkopisxtunn2]
      ,[amkopisx3] = Case when [amkopisx3]=''1'' then ''K'' when [amkopisx3]=''0'' then ''E'' else ''E'' end
      ,[amkopisxkoulk3]
      ,[amkopisxtunn3]
      ,[yoopisx1] = Case when [yoopisx1]=''1'' then ''K'' when [yoopisx1]=''0'' then ''E'' else ''E'' end
      ,[yoopisxkoulk1]
      ,[yoopisxtunn1]
      ,[yoopisx2] = Case when [yoopisx2]=''1'' then ''K'' when [yoopisx2]=''0'' then ''E'' else ''E'' end
      ,[yoopisxkoulk2]
      ,[yoopisxtunn2]
      ,[yoopisx3] = Case when [yoopisx3]=''1'' then ''K'' when [yoopisx3]=''0'' then ''E'' else ''E'' end
      ,[yoopisxkoulk3]
      ,[yoopisxtunn3]
      ,[ptoim1r3x]
      ,[htok] = Case when [htok]=''1'' then ''K'' when [htok]=''2'' then ''E'' else NULL end
      ,[lkm]
      ,[tietolahde]
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM (
  
SELECT [tilv]
      ,[allk]
      ,[luammhaku1_tunn]
      ,[luammhaku2_tunn]
      ,[luammhaku3_tunn]
      ,[luammhaku4_tunn]
      ,[luammhaku5_tunn]
      ,[luammhaku1_opmast]
      ,[luammhaku2_opmast]
      ,[luammhaku3_opmast]
      ,[luammhaku4_opmast]
      ,[luammhaku5_opmast]
      ,[luammhaku1_opmopa]
      ,[luammhaku2_opmopa]
      ,[luammhaku3_opmopa]
      ,[luammhaku4_opmopa]
      ,[luammhaku5_opmopa]
      ,[luammhaku1_opm95opa]
      ,[luammhaku2_opm95opa]
      ,[luammhaku3_opm95opa]
      ,[luammhaku4_opm95opa]
      ,[luammhaku5_opm95opa]
      ,[luammhaku1_okieli]
      ,[luammhaku2_okieli]
      ,[luammhaku3_okieli]
      ,[luammhaku4_okieli]
      ,[luammhaku5_okieli]
      ,[luammhaku1_hyv]
      ,[luammhaku2_hyv]
      ,[luammhaku3_hyv]
      ,[luammhaku4_hyv]
      ,[luammhaku5_hyv]
      ,[luammhaku1_vastotto]
      ,[luammhaku2_vastotto]
      ,[luammhaku3_vastotto]
      ,[luammhaku4_vastotto]
      ,[luammhaku5_vastotto]
      ,[amkhaku1_tunn]
      ,[amkhaku2_tunn]
      ,[amkhaku3_tunn]
      ,[amkhaku4_tunn]
      ,[amkhakum_tunn]
      ,[amkhaku1_opmast]
      ,[amkhaku2_opmast]
      ,[amkhaku3_opmast]
      ,[amkhaku4_opmast]
      ,[amkhakum_opmast]
      ,[amkhaku1_opmopa]
      ,[amkhaku2_opmopa]
      ,[amkhaku3_opmopa]
      ,[amkhaku4_opmopa]
      ,[amkhakum_opmopa]
      ,[amkhaku1_opm95opa]
      ,[amkhaku2_opm95opa]
      ,[amkhaku3_opm95opa]
      ,[amkhaku4_opm95opa]
      ,[amkhakum_opm95opa]
      ,[amkhaku1_koultyp]
      ,[amkhaku2_koultyp]
      ,[amkhaku3_koultyp]
      ,[amkhaku4_koultyp]
      ,[amkhakum_koultyp]
      ,[amkhaku1_okieli]
      ,[amkhaku2_okieli]
      ,[amkhaku3_okieli]
      ,[amkhaku4_okieli]
      ,[amkhakum_okieli]
      ,[amkhaku1_hyv]
      ,[amkhaku2_hyv]
      ,[amkhaku3_hyv]
      ,[amkhaku4_hyv]
      ,[amkhakum_hyv]
      ,[amkhaku1_vastotto]
      ,[amkhaku2_vastotto]
      ,[amkhaku3_vastotto]
      ,[amkhaku4_vastotto]
      ,[amkhakum_vastotto]
      ,[yohakua_tunn]
      ,[yohakub_tunn]
      ,[yohakuc_tunn]
      ,[yohakud_tunn]
      ,[yohakue_tunn]
      ,[yohakuf_tunn]
      ,[yohakug_tunn]
      ,[yohakuh_tunn]
      ,[yohakui_tunn]
      ,[yohakua_opmast]
      ,[yohakub_opmast]
      ,[yohakuc_opmast]
      ,[yohakud_opmast]
      ,[yohakue_opmast]
      ,[yohakuf_opmast]
      ,[yohakug_opmast]
      ,[yohakuh_opmast]
      ,[yohakui_opmast]
      ,[yohakua_opmopa]
      ,[yohakub_opmopa]
      ,[yohakuc_opmopa]
      ,[yohakud_opmopa]
      ,[yohakue_opmopa]
      ,[yohakuf_opmopa]
      ,[yohakug_opmopa]
      ,[yohakuh_opmopa]
      ,[yohakui_opmopa]
      ,[yohakua_opm95opa]
      ,[yohakub_opm95opa]
      ,[yohakuc_opm95opa]
      ,[yohakud_opm95opa]
      ,[yohakue_opm95opa]
      ,[yohakuf_opm95opa]
      ,[yohakug_opm95opa]
      ,[yohakuh_opm95opa]
      ,[yohakui_opm95opa]
      ,[yohakua_hyv]
      ,[yohakub_hyv]
      ,[yohakuc_hyv]
      ,[yohakud_hyv]
      ,[yohakue_hyv]
      ,[yohakuf_hyv]
      ,[yohakug_hyv]
      ,[yohakuh_hyv]
      ,[yohakui_hyv]
      ,[yohakua_vastotto]
      ,[yohakub_vastotto]
      ,[yohakuc_vastotto]
      ,[yohakud_vastotto]
      ,[yohakue_vastotto]
      ,[yohakuf_vastotto]
      ,[yohakug_vastotto]
      ,[yohakuh_vastotto]
      ,[yohakui_vastotto]
      ,[yohakua_harekast]
      ,[yohakub_harekast]
      ,[yohakuc_harekast]
      ,[yohakud_harekast]
      ,[yohakue_harekast]
      ,[yohakuf_harekast]
      ,[yohakug_harekast]
      ,[yohakuh_harekast]
      ,[yohakui_harekast]
      ,[yohakua_ylempi]
      ,[yohakub_ylempi]
      ,[yohakuc_ylempi]
      ,[yohakud_ylempi]
      ,[yohakue_ylempi]
      ,[yohakuf_ylempi]
      ,[yohakug_ylempi]
      ,[yohakuh_ylempi]
      ,[yohakui_ylempi]
      ,[yohakua_erval]
      ,[yohakub_erval]
      ,[yohakuc_erval]
      ,[yohakud_erval]
      ,[yohakue_erval]
      ,[yohakuf_erval]
      ,[yohakug_erval]
      ,[yohakuh_erval]
      ,[yohakui_erval]
      ,[luhakux]
      ,[luhaku2x]
      ,[luhaku3x]
      ,[ammhakux]
      ,[ammhaku2x]
      ,[ammhaku3x]
      ,[amkhakux]
      ,[amkhaku2x]
      ,[amkhaku3x]
      ,[yohakux]
      ,[yohaku2x]
      ,[yohaku3x]
      ,[sp]
      ,[aikielir1]
      ,[syntv]
      ,[tilvaskunx]
      ,[kansalr1]
      ,[aikyotutk]
      ,[aikyotutkkoulk]
      ,[suvuosiyotutk]
      ,[tunnyotutk]
      ,[aikamm]
      ,[aikammkoulk]
      ,[suvuosiamm]
      ,[tunnamm]
      ,[aikamk]
      ,[aikamkkoulk]
      ,[suvuosiamk]
      ,[tunnamk]
      ,[aikylamk]
      ,[aikylamkkoulk]
      ,[suvuosiylamk]
      ,[tunnylamk]
      ,[aikalkk]
      ,[aikalkkkoulk]
      ,[suvuosialkk]
      ,[tunnalkk]
      ,[aikylkk]
      ,[aikylkkkoulk]
      ,[suvuosiylkk]
      ,[tunnylkk]
      ,[aiklistri]
      ,[aiklistrikoulk]
      ,[suvuosilistri]
      ,[tunnlistri]
      ,[yotutkopisx]
      ,[yotutkopisxkoulk]
      ,[yotutkopisxtunn]
      ,[ammopisx]
      ,[ammopisxkoulk]
      ,[ammopisxtunn]
      ,[amkopisx1]
      ,[amkopisxkoulk1]
      ,[amkopisxtunn1]
      ,[amkopisx2]
      ,[amkopisxkoulk2]
      ,[amkopisxtunn2]
      ,[amkopisx3]
      ,[amkopisxkoulk3]
      ,[amkopisxtunn3]
      ,[yoopisx1]
      ,[yoopisxkoulk1]
      ,[yoopisxtunn1]
      ,[yoopisx2]
      ,[yoopisxkoulk2]
      ,[yoopisxtunn2]
      ,[yoopisx3]
      ,[yoopisxkoulk3]
      ,[yoopisxtunn3]
      ,[ptoim1r3x]
      ,[htok]
      ,[lkm]
      ,[tietolahde]=''TK_K3_16_sopv_12''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_K3_16_sopv_12]

UNION ALL

SELECT [tilv]
      ,[allk]
      ,[luammhaku1_tunn]
      ,[luammhaku2_tunn]
      ,[luammhaku3_tunn]
      ,[luammhaku4_tunn]
      ,[luammhaku5_tunn]
      ,[luammhaku1_opmast]
      ,[luammhaku2_opmast]
      ,[luammhaku3_opmast]
      ,[luammhaku4_opmast]
      ,[luammhaku5_opmast]
      ,[luammhaku1_opmopa]
      ,[luammhaku2_opmopa]
      ,[luammhaku3_opmopa]
      ,[luammhaku4_opmopa]
      ,[luammhaku5_opmopa]
      ,[luammhaku1_opm95opa]
      ,[luammhaku2_opm95opa]
      ,[luammhaku3_opm95opa]
      ,[luammhaku4_opm95opa]
      ,[luammhaku5_opm95opa]
      ,[luammhaku1_okieli]
      ,[luammhaku2_okieli]
      ,[luammhaku3_okieli]
      ,[luammhaku4_okieli]
      ,[luammhaku5_okieli]
      ,[luammhaku1_hyv]
      ,[luammhaku2_hyv]
      ,[luammhaku3_hyv]
      ,[luammhaku4_hyv]
      ,[luammhaku5_hyv]
      ,[luammhaku1_vastotto]
      ,[luammhaku2_vastotto]
      ,[luammhaku3_vastotto]
      ,[luammhaku4_vastotto]
      ,[luammhaku5_vastotto]
      ,[amkhaku1_tunn]
      ,[amkhaku2_tunn]
      ,[amkhaku3_tunn]
      ,[amkhaku4_tunn]
      ,[amkhakum_tunn]
      ,[amkhaku1_opmast]
      ,[amkhaku2_opmast]
      ,[amkhaku3_opmast]
      ,[amkhaku4_opmast]
      ,[amkhakum_opmast]
      ,[amkhaku1_opmopa]
      ,[amkhaku2_opmopa]
      ,[amkhaku3_opmopa]
      ,[amkhaku4_opmopa]
      ,[amkhakum_opmopa]
      ,[amkhaku1_opm95opa]
      ,[amkhaku2_opm95opa]
      ,[amkhaku3_opm95opa]
      ,[amkhaku4_opm95opa]
      ,[amkhakum_opm95opa]
      ,[amkhaku1_koultyp]
      ,[amkhaku2_koultyp]
      ,[amkhaku3_koultyp]
      ,[amkhaku4_koultyp]
      ,[amkhakum_koultyp]
      ,[amkhaku1_okieli]
      ,[amkhaku2_okieli]
      ,[amkhaku3_okieli]
      ,[amkhaku4_okieli]
      ,[amkhakum_okieli]
      ,[amkhaku1_hyv]
      ,[amkhaku2_hyv]
      ,[amkhaku3_hyv]
      ,[amkhaku4_hyv]
      ,[amkhakum_hyv]
      ,[amkhaku1_vastotto]
      ,[amkhaku2_vastotto]
      ,[amkhaku3_vastotto]
      ,[amkhaku4_vastotto]
      ,[amkhakum_vastotto]
      ,[yohakua_tunn]
      ,[yohakub_tunn]
      ,[yohakuc_tunn]
      ,[yohakud_tunn]
      ,[yohakue_tunn]
      ,[yohakuf_tunn]
      ,[yohakug_tunn]
      ,[yohakuh_tunn]
      ,[yohakui_tunn]
      ,[yohakua_opmast]
      ,[yohakub_opmast]
      ,[yohakuc_opmast]
      ,[yohakud_opmast]
      ,[yohakue_opmast]
      ,[yohakuf_opmast]
      ,[yohakug_opmast]
      ,[yohakuh_opmast]
      ,[yohakui_opmast]
      ,[yohakua_opmopa]
      ,[yohakub_opmopa]
      ,[yohakuc_opmopa]
      ,[yohakud_opmopa]
      ,[yohakue_opmopa]
      ,[yohakuf_opmopa]
      ,[yohakug_opmopa]
      ,[yohakuh_opmopa]
      ,[yohakui_opmopa]
      ,[yohakua_opm95opa]
      ,[yohakub_opm95opa]
      ,[yohakuc_opm95opa]
      ,[yohakud_opm95opa]
      ,[yohakue_opm95opa]
      ,[yohakuf_opm95opa]
      ,[yohakug_opm95opa]
      ,[yohakuh_opm95opa]
      ,[yohakui_opm95opa]
      ,[yohakua_hyv]
      ,[yohakub_hyv]
      ,[yohakuc_hyv]
      ,[yohakud_hyv]
      ,[yohakue_hyv]
      ,[yohakuf_hyv]
      ,[yohakug_hyv]
      ,[yohakuh_hyv]
      ,[yohakui_hyv]
      ,[yohakua_vastotto]
      ,[yohakub_vastotto]
      ,[yohakuc_vastotto]
      ,[yohakud_vastotto]
      ,[yohakue_vastotto]
      ,[yohakuf_vastotto]
      ,[yohakug_vastotto]
      ,[yohakuh_vastotto]
      ,[yohakui_vastotto]
      ,[yohakua_harekast]
      ,[yohakub_harekast]
      ,[yohakuc_harekast]
      ,[yohakud_harekast]
      ,[yohakue_harekast]
      ,[yohakuf_harekast]
      ,[yohakug_harekast]
      ,[yohakuh_harekast]
      ,[yohakui_harekast]
      ,[yohakua_ylempi]
      ,[yohakub_ylempi]
      ,[yohakuc_ylempi]
      ,[yohakud_ylempi]
      ,[yohakue_ylempi]
      ,[yohakuf_ylempi]
      ,[yohakug_ylempi]
      ,[yohakuh_ylempi]
      ,[yohakui_ylempi]
      ,[yohakua_erval]
      ,[yohakub_erval]
      ,[yohakuc_erval]
      ,[yohakud_erval]
      ,[yohakue_erval]
      ,[yohakuf_erval]
      ,[yohakug_erval]
      ,[yohakuh_erval]
      ,[yohakui_erval]
      ,[luhakux]
      ,[luhaku2x]
      ,[luhaku3x]
      ,[ammhakux]
      ,[ammhaku2x]
      ,[ammhaku3x]
      ,[amkhakux]
      ,[amkhaku2x]
      ,[amkhaku3x]
      ,[yohakux]
      ,[yohaku2x]
      ,[yohaku3x]
      ,[sp]
      ,[aikielir1]
      ,[syntv]
      ,[tilvaskunx]
      ,[kansalr1]
      ,[aikyotutk]
      ,[aikyotutkkoulk]
      ,[suvuosiyotutk]
      ,[tunnyotutk]
      ,[aikamm]
      ,[aikammkoulk]
      ,[suvuosiamm]
      ,[tunnamm]
      ,[aikamk]
      ,[aikamkkoulk]
      ,[suvuosiamk]
      ,[tunnamk]
      ,[aikylamk]
      ,[aikylamkkoulk]
      ,[suvuosiylamk]
      ,[tunnylamk]
      ,[aikalkk]
      ,[aikalkkkoulk]
      ,[suvuosialkk]
      ,[tunnalkk]
      ,[aikylkk]
      ,[aikylkkkoulk]
      ,[suvuosiylkk]
      ,[tunnylkk]
      ,[aiklistri]
      ,[aiklistrikoulk]
      ,[suvuosilistri]
      ,[tunnlistri]
      ,[yotutkopisx]
      ,[yotutkopisxkoulk]
      ,[yotutkopisxtunn]
      ,[ammopisx]
      ,[ammopisxkoulk]
      ,[ammopisxtunn]
      ,[amkopisx1]
      ,[amkopisxkoulk1]
      ,[amkopisxtunn1]
      ,[amkopisx2]
      ,[amkopisxkoulk2]
      ,[amkopisxtunn2]
      ,[amkopisx3]
      ,[amkopisxkoulk3]
      ,[amkopisxtunn3]
      ,[yoopisx1]
      ,[yoopisxkoulk1]
      ,[yoopisxtunn1]
      ,[yoopisx2]
      ,[yoopisxkoulk2]
      ,[yoopisxtunn2]
      ,[yoopisx3]
      ,[yoopisxkoulk3]
      ,[yoopisxtunn3]
      ,[ptoim1r3x]
      ,[htok]
      ,[lkm]
      ,[tietolahde]=''TK_K3_16_sopv_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_K3_16_sopv_13]

UNION ALL

SELECT [tilv]
      ,[allk]
      ,[luammhaku1_tunn]
      ,[luammhaku2_tunn]
      ,[luammhaku3_tunn]
      ,[luammhaku4_tunn]
      ,[luammhaku5_tunn]
      ,[luammhaku1_opmast]
      ,[luammhaku2_opmast]
      ,[luammhaku3_opmast]
      ,[luammhaku4_opmast]
      ,[luammhaku5_opmast]
      ,[luammhaku1_opmopa]
      ,[luammhaku2_opmopa]
      ,[luammhaku3_opmopa]
      ,[luammhaku4_opmopa]
      ,[luammhaku5_opmopa]
      ,[luammhaku1_opm95opa]
      ,[luammhaku2_opm95opa]
      ,[luammhaku3_opm95opa]
      ,[luammhaku4_opm95opa]
      ,[luammhaku5_opm95opa]
      ,[luammhaku1_okieli]
      ,[luammhaku2_okieli]
      ,[luammhaku3_okieli]
      ,[luammhaku4_okieli]
      ,[luammhaku5_okieli]
      ,[luammhaku1_hyv]
      ,[luammhaku2_hyv]
      ,[luammhaku3_hyv]
      ,[luammhaku4_hyv]
      ,[luammhaku5_hyv]
      ,[luammhaku1_vastotto]
      ,[luammhaku2_vastotto]
      ,[luammhaku3_vastotto]
      ,[luammhaku4_vastotto]
      ,[luammhaku5_vastotto]
      ,[amkhaku1_tunn]
      ,[amkhaku2_tunn]
      ,[amkhaku3_tunn]
      ,[amkhaku4_tunn]
      ,[amkhakum_tunn]
      ,[amkhaku1_opmast]
      ,[amkhaku2_opmast]
      ,[amkhaku3_opmast]
      ,[amkhaku4_opmast]
      ,[amkhakum_opmast]
      ,[amkhaku1_opmopa]
      ,[amkhaku2_opmopa]
      ,[amkhaku3_opmopa]
      ,[amkhaku4_opmopa]
      ,[amkhakum_opmopa]
      ,[amkhaku1_opm95opa]
      ,[amkhaku2_opm95opa]
      ,[amkhaku3_opm95opa]
      ,[amkhaku4_opm95opa]
      ,[amkhakum_opm95opa]
      ,[amkhaku1_koultyp]
      ,[amkhaku2_koultyp]
      ,[amkhaku3_koultyp]
      ,[amkhaku4_koultyp]
      ,[amkhakum_koultyp]
      ,[amkhaku1_okieli]
      ,[amkhaku2_okieli]
      ,[amkhaku3_okieli]
      ,[amkhaku4_okieli]
      ,[amkhakum_okieli]
      ,[amkhaku1_hyv]
      ,[amkhaku2_hyv]
      ,[amkhaku3_hyv]
      ,[amkhaku4_hyv]
      ,[amkhakum_hyv]
      ,[amkhaku1_vastotto]
      ,[amkhaku2_vastotto]
      ,[amkhaku3_vastotto]
      ,[amkhaku4_vastotto]
      ,[amkhakum_vastotto]
      ,[yohakua_tunn]
      ,[yohakub_tunn]
      ,[yohakuc_tunn]
      ,[yohakud_tunn]
      ,[yohakue_tunn]
      ,[yohakuf_tunn]
      ,[yohakug_tunn]
      ,[yohakuh_tunn]
      ,[yohakui_tunn]
      ,[yohakua_opmast]
      ,[yohakub_opmast]
      ,[yohakuc_opmast]
      ,[yohakud_opmast]
      ,[yohakue_opmast]
      ,[yohakuf_opmast]
      ,[yohakug_opmast]
      ,[yohakuh_opmast]
      ,[yohakui_opmast]
      ,[yohakua_opmopa]
      ,[yohakub_opmopa]
      ,[yohakuc_opmopa]
      ,[yohakud_opmopa]
      ,[yohakue_opmopa]
      ,[yohakuf_opmopa]
      ,[yohakug_opmopa]
      ,[yohakuh_opmopa]
      ,[yohakui_opmopa]
      ,[yohakua_opm95opa]
      ,[yohakub_opm95opa]
      ,[yohakuc_opm95opa]
      ,[yohakud_opm95opa]
      ,[yohakue_opm95opa]
      ,[yohakuf_opm95opa]
      ,[yohakug_opm95opa]
      ,[yohakuh_opm95opa]
      ,[yohakui_opm95opa]
      ,[yohakua_hyv]
      ,[yohakub_hyv]
      ,[yohakuc_hyv]
      ,[yohakud_hyv]
      ,[yohakue_hyv]
      ,[yohakuf_hyv]
      ,[yohakug_hyv]
      ,[yohakuh_hyv]
      ,[yohakui_hyv]
      ,[yohakua_vastotto]
      ,[yohakub_vastotto]
      ,[yohakuc_vastotto]
      ,[yohakud_vastotto]
      ,[yohakue_vastotto]
      ,[yohakuf_vastotto]
      ,[yohakug_vastotto]
      ,[yohakuh_vastotto]
      ,[yohakui_vastotto]
      ,[yohakua_harekast]
      ,[yohakub_harekast]
      ,[yohakuc_harekast]
      ,[yohakud_harekast]
      ,[yohakue_harekast]
      ,[yohakuf_harekast]
      ,[yohakug_harekast]
      ,[yohakuh_harekast]
      ,[yohakui_harekast]
      ,[yohakua_ylempi]
      ,[yohakub_ylempi]
      ,[yohakuc_ylempi]
      ,[yohakud_ylempi]
      ,[yohakue_ylempi]
      ,[yohakuf_ylempi]
      ,[yohakug_ylempi]
      ,[yohakuh_ylempi]
      ,[yohakui_ylempi]
      ,[yohakua_erval]
      ,[yohakub_erval]
      ,[yohakuc_erval]
      ,[yohakud_erval]
      ,[yohakue_erval]
      ,[yohakuf_erval]
      ,[yohakug_erval]
      ,[yohakuh_erval]
      ,[yohakui_erval]
      ,[luhakux]
      ,[luhaku2x]
      ,[luhaku3x]
      ,[ammhakux]
      ,[ammhaku2x]
      ,[ammhaku3x]
      ,[amkhakux]
      ,[amkhaku2x]
      ,[amkhaku3x]
      ,[yohakux]
      ,[yohaku2x]
      ,[yohaku3x]
      ,[sp]
      ,[aikielir1]
      ,[syntv]
      ,[tilvaskunx]
      ,[kansalr1]
      ,[aikyotutk]
      ,[aikyotutkkoulk]
      ,[suvuosiyotutk]
      ,[tunnyotutk]
      ,[aikamm]
      ,[aikammkoulk]
      ,[suvuosiamm]
      ,[tunnamm]
      ,[aikamk]
      ,[aikamkkoulk]
      ,[suvuosiamk]
      ,[tunnamk]
      ,[aikylamk]
      ,[aikylamkkoulk]
      ,[suvuosiylamk]
      ,[tunnylamk]
      ,[aikalkk]
      ,[aikalkkkoulk]
      ,[suvuosialkk]
      ,[tunnalkk]
      ,[aikylkk]
      ,[aikylkkkoulk]
      ,[suvuosiylkk]
      ,[tunnylkk]
      ,[aiklistri]
      ,[aiklistrikoulk]
      ,[suvuosilistri]
      ,[tunnlistri]
      ,[yotutkopisx]
      ,[yotutkopisxkoulk]
      ,[yotutkopisxtunn]
      ,[ammopisx]
      ,[ammopisxkoulk]
      ,[ammopisxtunn]
      ,[amkopisx1]
      ,[amkopisxkoulk1]
      ,[amkopisxtunn1]
      ,[amkopisx2]
      ,[amkopisxkoulk2]
      ,[amkopisxtunn2]
      ,[amkopisx3]
      ,[amkopisxkoulk3]
      ,[amkopisxtunn3]
      ,[yoopisx1]
      ,[yoopisxkoulk1]
      ,[yoopisxtunn1]
      ,[yoopisx2]
      ,[yoopisxkoulk2]
      ,[yoopisxtunn2]
      ,[yoopisx3]
      ,[yoopisxkoulk3]
      ,[yoopisxtunn3]
      ,[ptoim1r3x]
      ,[htok]
      ,[lkm]
      ,[tietolahde]=''TK_K3_16_sopv_14''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [VipunenTK_SA].[dbo].[TK_K3_16_sopv_14]

UNION ALL

SELECT [tilv]
      ,[allk]
      ,[luammhaku1_tunn]
      ,[luammhaku2_tunn]
      ,[luammhaku3_tunn]
      ,[luammhaku4_tunn]
      ,[luammhaku5_tunn]
      ,[luammhaku1_opmast]
      ,[luammhaku2_opmast]
      ,[luammhaku3_opmast]
      ,[luammhaku4_opmast]
      ,[luammhaku5_opmast]
      ,[luammhaku1_opmopa]
      ,[luammhaku2_opmopa]
      ,[luammhaku3_opmopa]
      ,[luammhaku4_opmopa]
      ,[luammhaku5_opmopa]
      ,[luammhaku1_opm95opa]
      ,[luammhaku2_opm95opa]
      ,[luammhaku3_opm95opa]
      ,[luammhaku4_opm95opa]
      ,[luammhaku5_opm95opa]
      ,[luammhaku1_okieli]
      ,[luammhaku2_okieli]
      ,[luammhaku3_okieli]
      ,[luammhaku4_okieli]
      ,[luammhaku5_okieli]
      ,[luammhaku1_hyv]
      ,[luammhaku2_hyv]
      ,[luammhaku3_hyv]
      ,[luammhaku4_hyv]
      ,[luammhaku5_hyv]
      ,[luammhaku1_vastotto]
      ,[luammhaku2_vastotto]
      ,[luammhaku3_vastotto]
      ,[luammhaku4_vastotto]
      ,[luammhaku5_vastotto]
      ,[amkhaku1_tunn]
      ,[amkhaku2_tunn]
      ,[amkhaku3_tunn]
      ,[amkhaku4_tunn]
      ,[amkhakum_tunn]
      ,[amkhaku1_opmast]
      ,[amkhaku2_opmast]
      ,[amkhaku3_opmast]
      ,[amkhaku4_opmast]
      ,[amkhakum_opmast]
      ,[amkhaku1_opmopa]
      ,[amkhaku2_opmopa]
      ,[amkhaku3_opmopa]
      ,[amkhaku4_opmopa]
      ,[amkhakum_opmopa]
      ,[amkhaku1_opm95opa]
      ,[amkhaku2_opm95opa]
      ,[amkhaku3_opm95opa]
      ,[amkhaku4_opm95opa]
      ,[amkhakum_opm95opa]
      ,[amkhaku1_koultyp]
      ,[amkhaku2_koultyp]
      ,[amkhaku3_koultyp]
      ,[amkhaku4_koultyp]
      ,[amkhakum_koultyp]
      ,[amkhaku1_okieli]
      ,[amkhaku2_okieli]
      ,[amkhaku3_okieli]
      ,[amkhaku4_okieli]
      ,[amkhakum_okieli]
      ,[amkhaku1_hyv]
      ,[amkhaku2_hyv]
      ,[amkhaku3_hyv]
      ,[amkhaku4_hyv]
      ,[amkhakum_hyv]
      ,[amkhaku1_vastotto]
      ,[amkhaku2_vastotto]
      ,[amkhaku3_vastotto]
      ,[amkhaku4_vastotto]
      ,[amkhakum_vastotto]
      ,[yohakua_tunn]
      ,[yohakub_tunn]
      ,[yohakuc_tunn]
      ,[yohakud_tunn]
      ,[yohakue_tunn]
      ,[yohakuf_tunn]
      ,[yohakug_tunn]
      ,[yohakuh_tunn]
      ,[yohakui_tunn]
      ,[yohakua_opmast]
      ,[yohakub_opmast]
      ,[yohakuc_opmast]
      ,[yohakud_opmast]
      ,[yohakue_opmast]
      ,[yohakuf_opmast]
      ,[yohakug_opmast]
      ,[yohakuh_opmast]
      ,[yohakui_opmast]
      ,[yohakua_opmopa]
      ,[yohakub_opmopa]
      ,[yohakuc_opmopa]
      ,[yohakud_opmopa]
      ,[yohakue_opmopa]
      ,[yohakuf_opmopa]
      ,[yohakug_opmopa]
      ,[yohakuh_opmopa]
      ,[yohakui_opmopa]
      ,[yohakua_opm95opa]
      ,[yohakub_opm95opa]
      ,[yohakuc_opm95opa]
      ,[yohakud_opm95opa]
      ,[yohakue_opm95opa]
      ,[yohakuf_opm95opa]
      ,[yohakug_opm95opa]
      ,[yohakuh_opm95opa]
      ,[yohakui_opm95opa]
      ,[yohakua_hyv]
      ,[yohakub_hyv]
      ,[yohakuc_hyv]
      ,[yohakud_hyv]
      ,[yohakue_hyv]
      ,[yohakuf_hyv]
      ,[yohakug_hyv]
      ,[yohakuh_hyv]
      ,[yohakui_hyv]
      ,[yohakua_vastotto]
      ,[yohakub_vastotto]
      ,[yohakuc_vastotto]
      ,[yohakud_vastotto]
      ,[yohakue_vastotto]
      ,[yohakuf_vastotto]
      ,[yohakug_vastotto]
      ,[yohakuh_vastotto]
      ,[yohakui_vastotto]
      ,[yohakua_harekast]
      ,[yohakub_harekast]
      ,[yohakuc_harekast]
      ,[yohakud_harekast]
      ,[yohakue_harekast]
      ,[yohakuf_harekast]
      ,[yohakug_harekast]
      ,[yohakuh_harekast]
      ,[yohakui_harekast]
      ,[yohakua_ylempi]
      ,[yohakub_ylempi]
      ,[yohakuc_ylempi]
      ,[yohakud_ylempi]
      ,[yohakue_ylempi]
      ,[yohakuf_ylempi]
      ,[yohakug_ylempi]
      ,[yohakuh_ylempi]
      ,[yohakui_ylempi]
      ,[yohakua_erval]
      ,[yohakub_erval]
      ,[yohakuc_erval]
      ,[yohakud_erval]
      ,[yohakue_erval]
      ,[yohakuf_erval]
      ,[yohakug_erval]
      ,[yohakuh_erval]
      ,[yohakui_erval]
      ,[luhakux]
      ,[luhaku2x]
      ,[luhaku3x]
      ,[ammhakux]
      ,[ammhaku2x]
      ,[ammhaku3x]
      ,[amkhakux]
      ,[amkhaku2x]
      ,[amkhaku3x]
      ,[yohakux]
      ,[yohaku2x]
      ,[yohaku3x]
      ,[sp]
      ,[aikielir1]
      ,[syntv]
      ,[tilvaskunx]
      ,[kansalr1]
      ,[aikyotutk]
      ,[aikyotutkkoulk]
      ,[suvuosiyotutk]
      ,[tunnyotutk]
      ,[aikamm]
      ,[aikammkoulk]
      ,[suvuosiamm]
      ,[tunnamm]
      ,[aikamk]
      ,[aikamkkoulk]
      ,[suvuosiamk]
      ,[tunnamk]
      ,[aikylamk]
      ,[aikylamkkoulk]
      ,[suvuosiylamk]
      ,[tunnylamk]
      ,[aikalkk]
      ,[aikalkkkoulk]
      ,[suvuosialkk]
      ,[tunnalkk]
      ,[aikylkk]
      ,[aikylkkkoulk]
      ,[suvuosiylkk]
      ,[tunnylkk]
      ,[aiklistri]
      ,[aiklistrikoulk]
      ,[suvuosilistri]
      ,[tunnlistri]
      ,[yotutkopisx]
      ,[yotutkopisxkoulk]
      ,[yotutkopisxtunn]
      ,[ammopisx]
      ,[ammopisxkoulk]
      ,[ammopisxtunn]
      ,[amkopisx1]
      ,[amkopisxkoulk1]
      ,[amkopisxtunn1]
      ,[amkopisx2]
      ,[amkopisxkoulk2]
      ,[amkopisxtunn2]
      ,[amkopisx3]
      ,[amkopisxkoulk3]
      ,[amkopisxtunn3]
      ,[yoopisx1]
      ,[yoopisxkoulk1]
      ,[yoopisxtunn1]
      ,[yoopisx2]
      ,[yoopisxkoulk2]
      ,[yoopisxtunn2]
      ,[yoopisx3]
      ,[yoopisxkoulk3]
      ,[yoopisxtunn3]
      ,[ptoim1r3x]
      ,[htok]
      ,[lkm]
      ,[tietolahde]=''TK_K3_16_sopv_15''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_K3_16_sopv_15]

UNION ALL

SELECT [tilv]
      ,[allk]
      ,[luammhaku1_tunn]
      ,[luammhaku2_tunn]
      ,[luammhaku3_tunn]
      ,[luammhaku4_tunn]
      ,[luammhaku5_tunn]
      ,[luammhaku1_opmast]
      ,[luammhaku2_opmast]
      ,[luammhaku3_opmast]
      ,[luammhaku4_opmast]
      ,[luammhaku5_opmast]
      ,[luammhaku1_opmopa]
      ,[luammhaku2_opmopa]
      ,[luammhaku3_opmopa]
      ,[luammhaku4_opmopa]
      ,[luammhaku5_opmopa]
      ,[luammhaku1_opm95opa]
      ,[luammhaku2_opm95opa]
      ,[luammhaku3_opm95opa]
      ,[luammhaku4_opm95opa]
      ,[luammhaku5_opm95opa]
      ,[luammhaku1_okieli]
      ,[luammhaku2_okieli]
      ,[luammhaku3_okieli]
      ,[luammhaku4_okieli]
      ,[luammhaku5_okieli]
      ,[luammhaku1_hyv]
      ,[luammhaku2_hyv]
      ,[luammhaku3_hyv]
      ,[luammhaku4_hyv]
      ,[luammhaku5_hyv]
      ,[luammhaku1_vastotto]
      ,[luammhaku2_vastotto]
      ,[luammhaku3_vastotto]
      ,[luammhaku4_vastotto]
      ,[luammhaku5_vastotto]
      ,[amkhaku1_tunn]
      ,[amkhaku2_tunn]
      ,[amkhaku3_tunn]
      ,[amkhaku4_tunn]
      ,[amkhakum_tunn]
      ,[amkhaku1_opmast]
      ,[amkhaku2_opmast]
      ,[amkhaku3_opmast]
      ,[amkhaku4_opmast]
      ,[amkhakum_opmast]
      ,[amkhaku1_opmopa]
      ,[amkhaku2_opmopa]
      ,[amkhaku3_opmopa]
      ,[amkhaku4_opmopa]
      ,[amkhakum_opmopa]
      ,[amkhaku1_opm95opa]
      ,[amkhaku2_opm95opa]
      ,[amkhaku3_opm95opa]
      ,[amkhaku4_opm95opa]
      ,[amkhakum_opm95opa]
      ,[amkhaku1_koultyp]
      ,[amkhaku2_koultyp]
      ,[amkhaku3_koultyp]
      ,[amkhaku4_koultyp]
      ,[amkhakum_koultyp]
      ,[amkhaku1_okieli]
      ,[amkhaku2_okieli]
      ,[amkhaku3_okieli]
      ,[amkhaku4_okieli]
      ,[amkhakum_okieli]
      ,[amkhaku1_hyv]
      ,[amkhaku2_hyv]
      ,[amkhaku3_hyv]
      ,[amkhaku4_hyv]
      ,[amkhakum_hyv]
      ,[amkhaku1_vastotto]
      ,[amkhaku2_vastotto]
      ,[amkhaku3_vastotto]
      ,[amkhaku4_vastotto]
      ,[amkhakum_vastotto]
      ,[yohakua_tunn]
      ,[yohakub_tunn]
      ,[yohakuc_tunn]
      ,[yohakud_tunn]
      ,[yohakue_tunn]
      ,[yohakuf_tunn]
      ,[yohakug_tunn]
      ,[yohakuh_tunn]
      ,[yohakui_tunn]
      ,[yohakua_opmast]
      ,[yohakub_opmast]
      ,[yohakuc_opmast]
      ,[yohakud_opmast]
      ,[yohakue_opmast]
      ,[yohakuf_opmast]
      ,[yohakug_opmast]
      ,[yohakuh_opmast]
      ,[yohakui_opmast]
      ,[yohakua_opmopa]
      ,[yohakub_opmopa]
      ,[yohakuc_opmopa]
      ,[yohakud_opmopa]
      ,[yohakue_opmopa]
      ,[yohakuf_opmopa]
      ,[yohakug_opmopa]
      ,[yohakuh_opmopa]
      ,[yohakui_opmopa]
      ,[yohakua_opm95opa]
      ,[yohakub_opm95opa]
      ,[yohakuc_opm95opa]
      ,[yohakud_opm95opa]
      ,[yohakue_opm95opa]
      ,[yohakuf_opm95opa]
      ,[yohakug_opm95opa]
      ,[yohakuh_opm95opa]
      ,[yohakui_opm95opa]
      ,[yohakua_hyv]
      ,[yohakub_hyv]
      ,[yohakuc_hyv]
      ,[yohakud_hyv]
      ,[yohakue_hyv]
      ,[yohakuf_hyv]
      ,[yohakug_hyv]
      ,[yohakuh_hyv]
      ,[yohakui_hyv]
      ,[yohakua_vastotto]
      ,[yohakub_vastotto]
      ,[yohakuc_vastotto]
      ,[yohakud_vastotto]
      ,[yohakue_vastotto]
      ,[yohakuf_vastotto]
      ,[yohakug_vastotto]
      ,[yohakuh_vastotto]
      ,[yohakui_vastotto]
      ,[yohakua_harekast]
      ,[yohakub_harekast]
      ,[yohakuc_harekast]
      ,[yohakud_harekast]
      ,[yohakue_harekast]
      ,[yohakuf_harekast]
      ,[yohakug_harekast]
      ,[yohakuh_harekast]
      ,[yohakui_harekast]
      ,[yohakua_ylempi]
      ,[yohakub_ylempi]
      ,[yohakuc_ylempi]
      ,[yohakud_ylempi]
      ,[yohakue_ylempi]
      ,[yohakuf_ylempi]
      ,[yohakug_ylempi]
      ,[yohakuh_ylempi]
      ,[yohakui_ylempi]
      ,[yohakua_erval]
      ,[yohakub_erval]
      ,[yohakuc_erval]
      ,[yohakud_erval]
      ,[yohakue_erval]
      ,[yohakuf_erval]
      ,[yohakug_erval]
      ,[yohakuh_erval]
      ,[yohakui_erval]
      ,[luhakux]
      ,[luhaku2x]
      ,[luhaku3x]
      ,[ammhakux]
      ,[ammhaku2x]
      ,[ammhaku3x]
      ,[amkhakux]
      ,[amkhaku2x]
      ,[amkhaku3x]
      ,[yohakux]
      ,[yohaku2x]
      ,[yohaku3x]
      ,[sp]
      ,[aikielir1]
      ,[syntv]
      ,[tilvaskunx]
      ,[kansalr1]
      ,[aikyotutk]
      ,[aikyotutkkoulk]
      ,[suvuosiyotutk]
      ,[tunnyotutk]
      ,[aikamm]
      ,[aikammkoulk]
      ,[suvuosiamm]
      ,[tunnamm]
      ,[aikamk]
      ,[aikamkkoulk]
      ,[suvuosiamk]
      ,[tunnamk]
      ,[aikylamk]
      ,[aikylamkkoulk]
      ,[suvuosiylamk]
      ,[tunnylamk]
      ,[aikalkk]
      ,[aikalkkkoulk]
      ,[suvuosialkk]
      ,[tunnalkk]
      ,[aikylkk]
      ,[aikylkkkoulk]
      ,[suvuosiylkk]
      ,[tunnylkk]
      ,[aiklistri]
      ,[aiklistrikoulk]
      ,[suvuosilistri]
      ,[tunnlistri]
      ,[yotutkopisx]
      ,[yotutkopisxkoulk]
      ,[yotutkopisxtunn]
      ,[ammopisx]
      ,[ammopisxkoulk]
      ,[ammopisxtunn]
      ,[amkopisx1]
      ,[amkopisxkoulk1]
      ,[amkopisxtunn1]
      ,[amkopisx2]
      ,[amkopisxkoulk2]
      ,[amkopisxtunn2]
      ,[amkopisx3]
      ,[amkopisxkoulk3]
      ,[amkopisxtunn3]
      ,[yoopisx1]
      ,[yoopisxkoulk1]
      ,[yoopisxtunn1]
      ,[yoopisx2]
      ,[yoopisxkoulk2]
      ,[yoopisxtunn2]
      ,[yoopisx3]
      ,[yoopisxkoulk3]
      ,[yoopisxtunn3]
      ,[ptoim1r3x]
      ,[htok]
      ,[lkm]
      ,[tietolahde]=''TK_K3_16_sopv_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_K3_16_sopv_16]
  ) kaikkivuodet




' 
GO
/****** Object:  View [dbo].[v_sa_K3_9_Tutk_suor_osuus_aloittaneista_toinen_aste]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_K3_9_Tutk_suor_osuus_aloittaneista_toinen_aste]'))
EXEC dbo.sp_executesql @statement = N'


CREATE VIEW [dbo].[v_sa_K3_9_Tutk_suor_osuus_aloittaneista_toinen_aste] AS
SELECT [tilv]
      ,[lahde]
      ,[sp]
      ,[syntv]
      ,[aikielir1]
      ,[alvv]
      ,[allk]
      ,[klaji]
      ,[ophal] = Case when lahde=''21'' then ''1'' else ophal end
      ,[jarj]
      ,[kkun]
      ,[koulk]
      ,[pohjkoulk]
      ,[lusuorv_2004]
      ,[lusuorlk_2004]
      ,[lututkmaak_2004]
      ,[lututkjarj_2004]
      ,[lututkkoulk_2004]
      ,[amptsuorv_2004]
      ,[amptsuorlk_2004]
      ,[ampttutkmaak_2004]
      ,[ampttutkjarj_2004]
      ,[ampttutkkoulk_2004]
      ,[amlksuorv_2004]
      ,[amlksuorlk_2004]
      ,[amlktutkmaak_2004]
      ,[amlktutkjarj_2004]
      ,[amlktutkkoulk_2004]
      ,[muukksuorv_2004]
      ,[muukksuorlk_2004]
      ,[muukktutkmaak_2004]
      ,[muukktutkjarj_2004]
      ,[muukktutkkoulk_2004]
      ,[lusuorv_2005]
      ,[lusuorlk_2005]
      ,[lututkmaak_2005]
      ,[lututkjarj_2005]
      ,[lututkkoulk_2005]
      ,[amptsuorv_2005]
      ,[amptsuorlk_2005]
      ,[ampttutkmaak_2005]
      ,[ampttutkjarj_2005]
      ,[ampttutkkoulk_2005]
      ,[amlksuorv_2005]
      ,[amlksuorlk_2005]
      ,[amlktutkmaak_2005]
      ,[amlktutkjarj_2005]
      ,[amlktutkkoulk_2005]
      ,[muukksuorv_2005]
      ,[muukksuorlk_2005]
      ,[muukktutkmaak_2005]
      ,[muukktutkjarj_2005]
      ,[muukktutkkoulk_2005]
      ,[lusuorv_2006]
      ,[lusuorlk_2006]
      ,[lututkmaak_2006]
      ,[lututkjarj_2006]
      ,[lututkkoulk_2006]
      ,[amptsuorv_2006]
      ,[amptsuorlk_2006]
      ,[ampttutkmaak_2006]
      ,[ampttutkjarj_2006]
      ,[ampttutkkoulk_2006]
      ,[amlksuorv_2006]
      ,[amlksuorlk_2006]
      ,[amlktutkmaak_2006]
      ,[amlktutkjarj_2006]
      ,[amlktutkkoulk_2006]
      ,[muukksuorv_2006]
      ,[muukksuorlk_2006]
      ,[muukktutkmaak_2006]
      ,[muukktutkjarj_2006]
      ,[muukktutkkoulk_2006]
      ,[lusuorv_2007]
      ,[lusuorlk_2007]
      ,[lututkmaak_2007]
      ,[lututkjarj_2007]
      ,[lututkkoulk_2007]
      ,[amptsuorv_2007]
      ,[amptsuorlk_2007]
      ,[ampttutkmaak_2007]
      ,[ampttutkjarj_2007]
      ,[ampttutkkoulk_2007]
      ,[amlksuorv_2007]
      ,[amlksuorlk_2007]
      ,[amlktutkmaak_2007]
      ,[amlktutkjarj_2007]
      ,[amlktutkkoulk_2007]
      ,[muukksuorv_2007]
      ,[muukksuorlk_2007]
      ,[muukktutkmaak_2007]
      ,[muukktutkjarj_2007]
      ,[muukktutkkoulk_2007]
      ,[lusuorv_2008]
      ,[lusuorlk_2008]
      ,[lututkmaak_2008]
      ,[lututkjarj_2008]
      ,[lututkkoulk_2008]
      ,[amptsuorv_2008]
      ,[amptsuorlk_2008]
      ,[ampttutkmaak_2008]
      ,[ampttutkjarj_2008]
      ,[ampttutkkoulk_2008]
      ,[amlksuorv_2008]
      ,[amlksuorlk_2008]
      ,[amlktutkmaak_2008]
      ,[amlktutkjarj_2008]
      ,[amlktutkkoulk_2008]
      ,[muukksuorv_2008]
      ,[muukksuorlk_2008]
      ,[muukktutkmaak_2008]
      ,[muukktutkjarj_2008]
      ,[muukktutkkoulk_2008]
      ,[lusuorv_2009]
      ,[lusuorlk_2009]
      ,[lututkmaak_2009]
      ,[lututkjarj_2009]
      ,[lututkkoulk_2009]
      ,[amptsuorv_2009]
      ,[amptsuorlk_2009]
      ,[ampttutkmaak_2009]
      ,[ampttutkjarj_2009]
      ,[ampttutkkoulk_2009]
      ,[amlksuorv_2009]
      ,[amlksuorlk_2009]
      ,[amlktutkmaak_2009]
      ,[amlktutkjarj_2009]
      ,[amlktutkkoulk_2009]
      ,[muukksuorv_2009]
      ,[muukksuorlk_2009]
      ,[muukktutkmaak_2009]
      ,[muukktutkjarj_2009]
      ,[muukktutkkoulk_2009]
      ,[luopiskkoulk_2004]
      ,[luopiskjarj_2004]
      ,[lukmaak_2004]
      ,[amptopiskkoulk_2004]
      ,[amptopiskjarj_2004]
      ,[amptkmaak_2004]
      ,[amlkopiskkoulk_2004]
      ,[amlkopiskjarj_2004]
      ,[amlkkmaak_2004]
      ,[muukkopiskkoulk_2004]
      ,[muukkopiskjarj_2004]
      ,[muukkkmaak_2004]
      ,[luopiskkoulk_2005]
      ,[luopiskjarj_2005]
      ,[lukmaak_2005]
      ,[amptopiskkoulk_2005]
      ,[amptopiskjarj_2005]
      ,[amptkmaak_2005]
      ,[amlkopiskkoulk_2005]
      ,[amlkopiskjarj_2005]
      ,[amlkkmaak_2005]
      ,[muukkopiskkoulk_2005]
      ,[muukkopiskjarj_2005]
      ,[muukkkmaak_2005]
      ,[luopiskkoulk_2006]
      ,[luopiskjarj_2006]
      ,[lukmaak_2006]
      ,[amptopiskkoulk_2006]
      ,[amptopiskjarj_2006]
      ,[amptkmaak_2006]
      ,[amlkopiskkoulk_2006]
      ,[amlkopiskjarj_2006]
      ,[amlkkmaak_2006]
      ,[muukkopiskkoulk_2006]
      ,[muukkopiskjarj_2006]
      ,[muukkkmaak_2006]
      ,[luopiskkoulk_2007]
      ,[luopiskjarj_2007]
      ,[lukmaak_2007]
      ,[amptopiskkoulk_2007]
      ,[amptopiskjarj_2007]
      ,[amptkmaak_2007]
      ,[amlkopiskkoulk_2007]
      ,[amlkopiskjarj_2007]
      ,[amlkkmaak_2007]
      ,[muukkopiskkoulk_2007]
      ,[muukkopiskjarj_2007]
      ,[muukkkmaak_2007]
      ,[luopiskkoulk_2008]
      ,[luopiskjarj_2008]
      ,[lukmaak_2008]
      ,[amptopiskkoulk_2008]
      ,[amptopiskjarj_2008]
      ,[amptkmaak_2008]
      ,[amlkopiskkoulk_2008]
      ,[amlkopiskjarj_2008]
      ,[amlkkmaak_2008]
      ,[muukkopiskkoulk_2008]
      ,[muukkopiskjarj_2008]
      ,[muukkkmaak_2008]
      ,[luopiskkoulk_2009]
      ,[luopiskjarj_2009]
      ,[lukmaak_2009]
      ,[amptopiskkoulk_2009]
      ,[amptopiskjarj_2009]
      ,[amptkmaak_2009]
      ,[amlkopiskkoulk_2009]
      ,[amlkopiskjarj_2009]
      ,[amlkkmaak_2009]
      ,[muukkopiskkoulk_2009]
      ,[muukkopiskjarj_2009]
      ,[muukkkmaak_2009]
      ,[ptoim1r5_2004]
      ,[amas_2004]
      ,[ptoim1r5_2005]
      ,[amas_2005]
      ,[ptoim1r5_2006]
      ,[amas_2006]
      ,[ptoim1r5_2007]
      ,[amas_2007]
      ,[ptoim1r5_2008]
      ,[amas_2008]
      ,[ptoim1r5_2009]
      ,[amas_2009]

--2010
      ,[lusuorv_2010]
      ,[lusuorlk_2010]
      ,[lututkmaak_2010]
      ,[lututkjarj_2010]
      ,[lututkkoulk_2010]
      ,[amptsuorv_2010]
      ,[amptsuorlk_2010]
      ,[ampttutkmaak_2010]
      ,[ampttutkjarj_2010]
      ,[ampttutkkoulk_2010]
      ,[amlksuorv_2010]
      ,[amlksuorlk_2010]
      ,[amlktutkmaak_2010]
      ,[amlktutkjarj_2010]
      ,[amlktutkkoulk_2010]
      ,[muukksuorv_2010]
      ,[muukksuorlk_2010]
      ,[muukktutkmaak_2010]
      ,[muukktutkjarj_2010]
      ,[muukktutkkoulk_2010]
      ,[luopiskkoulk_2010]
      ,[luopiskjarj_2010]
      ,[lukmaak_2010]
      ,[amptopiskkoulk_2010]
      ,[amptopiskjarj_2010]
      ,[amptkmaak_2010]
      ,[amlkopiskkoulk_2010]
      ,[amlkopiskjarj_2010]
      ,[amlkkmaak_2010]
      ,[muukkopiskkoulk_2010]
      ,[muukkopiskjarj_2010]
      ,[muukkkmaak_2010]
      ,[ptoim1r5_2010]
      ,[amas_2010]

--2011
      ,[lusuorv_2011]
      ,[lusuorlk_2011]
      ,[lututkmaak_2011]
      ,[lututkjarj_2011]
      ,[lututkkoulk_2011]
      ,[amptsuorv_2011]
      ,[amptsuorlk_2011]
      ,[ampttutkmaak_2011]
      ,[ampttutkjarj_2011]
      ,[ampttutkkoulk_2011]
      ,[amlksuorv_2011]
      ,[amlksuorlk_2011]
      ,[amlktutkmaak_2011]
      ,[amlktutkjarj_2011]
      ,[amlktutkkoulk_2011]
      ,[muukksuorv_2011]
      ,[muukksuorlk_2011]
      ,[muukktutkmaak_2011]
      ,[muukktutkjarj_2011]
      ,[muukktutkkoulk_2011]
      ,[luopiskkoulk_2011]
      ,[luopiskjarj_2011]
      ,[lukmaak_2011]
      ,[amptopiskkoulk_2011]
      ,[amptopiskjarj_2011]
      ,[amptkmaak_2011]
      ,[amlkopiskkoulk_2011]
      ,[amlkopiskjarj_2011]
      ,[amlkkmaak_2011]
      ,[muukkopiskkoulk_2011]
      ,[muukkopiskjarj_2011]
      ,[muukkkmaak_2011]
      ,[ptoim1r5_2011]
      ,[amas_2011]


--2012
      ,[lusuorv_2012]
      ,[lusuorlk_2012]
      ,[lututkmaak_2012]
      ,[lututkjarj_2012]
      ,[lututkkoulk_2012]
      ,[amptsuorv_2012]
      ,[amptsuorlk_2012]
      ,[ampttutkmaak_2012]
      ,[ampttutkjarj_2012]
      ,[ampttutkkoulk_2012]
      ,[amlksuorv_2012]
      ,[amlksuorlk_2012]
      ,[amlktutkmaak_2012]
      ,[amlktutkjarj_2012]
      ,[amlktutkkoulk_2012]
      ,[muukksuorv_2012]
      ,[muukksuorlk_2012]
      ,[muukktutkmaak_2012]
      ,[muukktutkjarj_2012]
      ,[muukktutkkoulk_2012]
      ,[luopiskkoulk_2012]
      ,[luopiskjarj_2012]
      ,[lukmaak_2012]
      ,[amptopiskkoulk_2012]
      ,[amptopiskjarj_2012]
      ,[amptkmaak_2012]
      ,[amlkopiskkoulk_2012]
      ,[amlkopiskjarj_2012]
      ,[amlkkmaak_2012]
      ,[muukkopiskkoulk_2012]
      ,[muukkopiskjarj_2012]
      ,[muukkkmaak_2012]
      ,[ptoim1r5_2012]
      ,[amas_2012]
--2013
      ,[lusuorv_2013]
      ,[lusuorlk_2013]
      ,[lututkmaak_2013]
      ,[lututkjarj_2013]
      ,[lututkkoulk_2013]
      ,[amptsuorv_2013]
      ,[amptsuorlk_2013]
      ,[ampttutkmaak_2013]
      ,[ampttutkjarj_2013]
      ,[ampttutkkoulk_2013]
      ,[amlksuorv_2013]
      ,[amlksuorlk_2013]
      ,[amlktutkmaak_2013]
      ,[amlktutkjarj_2013]
      ,[amlktutkkoulk_2013]
      ,[muukksuorv_2013]
      ,[muukksuorlk_2013]
      ,[muukktutkmaak_2013]
      ,[muukktutkjarj_2013]
      ,[muukktutkkoulk_2013]
      ,[luopiskkoulk_2013]
      ,[luopiskjarj_2013]
      ,[lukmaak_2013]
      ,[amptopiskkoulk_2013]
      ,[amptopiskjarj_2013]
      ,[amptkmaak_2013]
      ,[amlkopiskkoulk_2013]
      ,[amlkopiskjarj_2013]
      ,[amlkkmaak_2013]
      ,[muukkopiskkoulk_2013]
      ,[muukkopiskjarj_2013]
      ,[muukkkmaak_2013]
      ,[ptoim1r5_2013]
      ,[amas_2013]

-- 2014

      ,[lusuorv_2014]
      ,[lusuorlk_2014]
      ,[lututkmaak_2014]
      ,[lututkjarj_2014]
      ,[lututkkoulk_2014]
      ,[amptsuorv_2014]
      ,[amptsuorlk_2014]
      ,[ampttutkmaak_2014]
      ,[ampttutkjarj_2014]
      ,[ampttutkkoulk_2014]
      ,[amlksuorv_2014]
      ,[amlksuorlk_2014]
      ,[amlktutkmaak_2014]
      ,[amlktutkjarj_2014]
      ,[amlktutkkoulk_2014]
      ,[muukksuorv_2014]
      ,[muukksuorlk_2014]
      ,[muukktutkmaak_2014]
      ,[muukktutkjarj_2014]
      ,[muukktutkkoulk_2014]
      ,[luopiskkoulk_2014]
      ,[luopiskjarj_2014]
      ,[lukmaak_2014]
      ,[amptopiskkoulk_2014]
      ,[amptopiskjarj_2014]
      ,[amptkmaak_2014]
      ,[amlkopiskkoulk_2014]
      ,[amlkopiskjarj_2014]
      ,[amlkkmaak_2014]
      ,[muukkopiskkoulk_2014]
      ,[muukkopiskjarj_2014]
      ,[muukkkmaak_2014]
      ,[ptoim1r5_2014]
      ,[amas_2014]

--UUSI VUOSI

      ,[lkm]
      ,[tietolahde]=''K3_9_sopv_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv, alvv, allk)
      ,[aineistorivinumero] = ROW_NUMBER() OVER(ORDER BY tilv, alvv, allk)
  FROM [TK_H9098_CSC].[dbo].[TK_K3_9_sopv_16] 
--where alvv=''2008'' and allk=''2''



' 
GO
/****** Object:  View [dbo].[v_sa_K3_9_Tutk_suor_osuus_aloittaneista_toinen_aste_nykytila]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_K3_9_Tutk_suor_osuus_aloittaneista_toinen_aste_nykytila]'))
EXEC dbo.sp_executesql @statement = N'



CREATE VIEW [dbo].[v_sa_K3_9_Tutk_suor_osuus_aloittaneista_toinen_aste_nykytila] AS
-- Palauta lähtöaineisto järjestäjien ja koulutusten osalta nykytilaan päivitettynä
-- VipunenTK-kannan dimensiotaulujen pitää olla päivitettynä
-- Päivitetty aineistoon _14 /Jarmo 9.10.2014 

-- perusaineisto [VipunenTK_SA].[dbo].[v_sa_K3_9_Tutk_suor_osuus_aloittaneista_toinen_aste] => (943933 row(s) affected)

-- Select * from [VipunenTK_SA].[dbo].v_sa_K3_9_Tutk_suor_osuus_aloittaneista_toinen_aste_nykytila


SELECT
       [tilv]
      ,[lahde]
      ,[sp]
      ,[syntv]
      ,[aikielir1]
      ,[alvv]
      ,[allk]
      ,[klaji]
      ,[ophal] = Case when lahde=''21'' then ''1'' else ophal end
      ,[jarj] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[jarj]), [jarj])
   ,[kkun] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_kunta_nykytila] WHERE alueluokitus_koodi=[kkun]), [kkun])
   ,[koulk] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[koulk]), [koulk])
   ,[pohjkoulk] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[pohjkoulk]), [pohjkoulk])
      ,[lusuorv_2004]
      ,[lusuorlk_2004]
   ,[lututkmaak_2004] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[lututkmaak_2004]), [lututkmaak_2004])
      ,[lututkjarj_2004] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[lututkjarj_2004]), [lututkjarj_2004])
   ,[lututkkoulk_2004] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[lututkkoulk_2004]), [lututkkoulk_2004])
      ,[amptsuorv_2004]
      ,[amptsuorlk_2004]
   ,[ampttutkmaak_2004] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ampttutkmaak_2004]), [ampttutkmaak_2004])
      ,[ampttutkjarj_2004] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ampttutkjarj_2004]), [ampttutkjarj_2004])
   ,[ampttutkkoulk_2004] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ampttutkkoulk_2004]), [ampttutkkoulk_2004])
      ,[amlksuorv_2004]
      ,[amlksuorlk_2004]
   ,[amlktutkmaak_2004] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[amlktutkmaak_2004]), [amlktutkmaak_2004])
      ,[amlktutkjarj_2004] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[amlktutkjarj_2004]), [amlktutkjarj_2004])
   ,[amlktutkkoulk_2004] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[amlktutkkoulk_2004]), [amlktutkkoulk_2004])
      ,[muukksuorv_2004]
      ,[muukksuorlk_2004]
   ,[muukktutkmaak_2004] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[muukktutkmaak_2004]), [muukktutkmaak_2004])
      ,[muukktutkjarj_2004] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[muukktutkjarj_2004]), [muukktutkjarj_2004])
   ,[muukktutkkoulk_2004] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[muukktutkkoulk_2004]), [muukktutkkoulk_2004])
      ,[lusuorv_2005]
      ,[lusuorlk_2005]
   ,[lututkmaak_2005] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[lututkmaak_2005]), [lututkmaak_2005])
      ,[lututkjarj_2005] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[lututkjarj_2005]), [lututkjarj_2005])
   ,[lututkkoulk_2005] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[lututkkoulk_2005]), [lututkkoulk_2005])
      ,[amptsuorv_2005]
      ,[amptsuorlk_2005]
   ,[ampttutkmaak_2005] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ampttutkmaak_2005]), [ampttutkmaak_2005])
      ,[ampttutkjarj_2005] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ampttutkjarj_2005]), [ampttutkjarj_2005])
   ,[ampttutkkoulk_2005] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ampttutkkoulk_2005]), [ampttutkkoulk_2005])
      ,[amlksuorv_2005]
      ,[amlksuorlk_2005]
   ,[amlktutkmaak_2005] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[amlktutkmaak_2005]), [amlktutkmaak_2005])
      ,[amlktutkjarj_2005] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[amlktutkjarj_2005]), [amlktutkjarj_2005])
   ,[amlktutkkoulk_2005] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[amlktutkkoulk_2005]), [amlktutkkoulk_2005])
      ,[muukksuorv_2005]
      ,[muukksuorlk_2005]
   ,[muukktutkmaak_2005] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[muukktutkmaak_2005]), [muukktutkmaak_2005])
      ,[muukktutkjarj_2005] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[muukktutkjarj_2005]), [muukktutkjarj_2005])
   ,[muukktutkkoulk_2005] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[muukktutkkoulk_2005]), [muukktutkkoulk_2005])
      ,[lusuorv_2006]
      ,[lusuorlk_2006]
   ,[lututkmaak_2006] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[lututkmaak_2006]), [lututkmaak_2006])
      ,[lututkjarj_2006] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[lututkjarj_2006]), [lututkjarj_2006])
   ,[lututkkoulk_2006] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[lututkkoulk_2006]), [lututkkoulk_2006])
      ,[amptsuorv_2006]
      ,[amptsuorlk_2006]
   ,[ampttutkmaak_2006] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ampttutkmaak_2006]), [ampttutkmaak_2006])
      ,[ampttutkjarj_2006] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ampttutkjarj_2006]), [ampttutkjarj_2006])
   ,[ampttutkkoulk_2006] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ampttutkkoulk_2006]), [ampttutkkoulk_2006])
      ,[amlksuorv_2006]
      ,[amlksuorlk_2006]
   ,[amlktutkmaak_2006] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[amlktutkmaak_2006]), [amlktutkmaak_2006])
      ,[amlktutkjarj_2006] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[amlktutkjarj_2006]), [amlktutkjarj_2006])
   ,[amlktutkkoulk_2006] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[amlktutkkoulk_2006]), [amlktutkkoulk_2006])
      ,[muukksuorv_2006]
      ,[muukksuorlk_2006]
   ,[muukktutkmaak_2006] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[muukktutkmaak_2006]), [muukktutkmaak_2006])
      ,[muukktutkjarj_2006] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[muukktutkjarj_2006]), [muukktutkjarj_2006])
   ,[muukktutkkoulk_2006] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[muukktutkkoulk_2006]), [muukktutkkoulk_2006])
      ,[lusuorv_2007]
      ,[lusuorlk_2007]
   ,[lututkmaak_2007] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[lututkmaak_2007]), [lututkmaak_2007])
      ,[lututkjarj_2007] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[lututkjarj_2007]), [lututkjarj_2007])
   ,[lututkkoulk_2007] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[lututkkoulk_2007]), [lututkkoulk_2007])
      ,[amptsuorv_2007]
      ,[amptsuorlk_2007]
   ,[ampttutkmaak_2007] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ampttutkmaak_2007]), [ampttutkmaak_2007])
      ,[ampttutkjarj_2007] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ampttutkjarj_2007]), [ampttutkjarj_2007])
   ,[ampttutkkoulk_2007] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ampttutkkoulk_2007]), [ampttutkkoulk_2007])
      ,[amlksuorv_2007]
      ,[amlksuorlk_2007]
   ,[amlktutkmaak_2007] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[amlktutkmaak_2007]), [amlktutkmaak_2007])
      ,[amlktutkjarj_2007] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[amlktutkjarj_2007]), [amlktutkjarj_2007])
   ,[amlktutkkoulk_2007] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[amlktutkkoulk_2007]), [amlktutkkoulk_2007])
      ,[muukksuorv_2007]
      ,[muukksuorlk_2007]
   ,[muukktutkmaak_2007] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[muukktutkmaak_2007]), [muukktutkmaak_2007])
      ,[muukktutkjarj_2007] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[muukktutkjarj_2007]), [muukktutkjarj_2007])
   ,[muukktutkkoulk_2007] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[muukktutkkoulk_2007]), [muukktutkkoulk_2007])
      ,[lusuorv_2008]
      ,[lusuorlk_2008]
   ,[lututkmaak_2008] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[lututkmaak_2008]), [lututkmaak_2008])
      ,[lututkjarj_2008] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[lututkjarj_2008]), [lututkjarj_2008])
   ,[lututkkoulk_2008] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[lututkkoulk_2008]), [lututkkoulk_2008])
      ,[amptsuorv_2008]
      ,[amptsuorlk_2008]
   ,[ampttutkmaak_2008] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ampttutkmaak_2008]), [ampttutkmaak_2008])
      ,[ampttutkjarj_2008] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ampttutkjarj_2008]), [ampttutkjarj_2008])
   ,[ampttutkkoulk_2008] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ampttutkkoulk_2008]), [ampttutkkoulk_2008])
      ,[amlksuorv_2008]
      ,[amlksuorlk_2008]
   ,[amlktutkmaak_2008] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[amlktutkmaak_2008]), [amlktutkmaak_2008])
      ,[amlktutkjarj_2008] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[amlktutkjarj_2008]), [amlktutkjarj_2008])
   ,[amlktutkkoulk_2008] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[amlktutkkoulk_2008]), [amlktutkkoulk_2008])
      ,[muukksuorv_2008]
      ,[muukksuorlk_2008]
   ,[muukktutkmaak_2008] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[muukktutkmaak_2008]), [muukktutkmaak_2008])
      ,[muukktutkjarj_2008] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[muukktutkjarj_2008]), [muukktutkjarj_2008])
   ,[muukktutkkoulk_2008] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[muukktutkkoulk_2008]), [muukktutkkoulk_2008])
      ,[lusuorv_2009]
      ,[lusuorlk_2009]
   ,[lututkmaak_2009] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[lututkmaak_2009]), [lututkmaak_2009])
      ,[lututkjarj_2009] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[lututkjarj_2009]), [lututkjarj_2009])
   ,[lututkkoulk_2009] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[lututkkoulk_2009]), [lututkkoulk_2009])
      ,[amptsuorv_2009]
      ,[amptsuorlk_2009]
   ,[ampttutkmaak_2009] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ampttutkmaak_2009]), [ampttutkmaak_2009])
      ,[ampttutkjarj_2009] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ampttutkjarj_2009]), [ampttutkjarj_2009])
   ,[ampttutkkoulk_2009] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ampttutkkoulk_2009]), [ampttutkkoulk_2009])
      ,[amlksuorv_2009]
      ,[amlksuorlk_2009]
   ,[amlktutkmaak_2009] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[amlktutkmaak_2009]), [amlktutkmaak_2009])
      ,[amlktutkjarj_2009] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[amlktutkjarj_2009]), [amlktutkjarj_2009])
   ,[amlktutkkoulk_2009] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[amlktutkkoulk_2009]), [amlktutkkoulk_2009])
      ,[muukksuorv_2009]
      ,[muukksuorlk_2009]
   ,[muukktutkmaak_2009] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[muukktutkmaak_2009]), [muukktutkmaak_2009])
      ,[muukktutkjarj_2009] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[muukktutkjarj_2009]), [muukktutkjarj_2009])
   ,[muukktutkkoulk_2009] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[muukktutkkoulk_2009]), [muukktutkkoulk_2009])

   ,[luopiskkoulk_2004] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[luopiskkoulk_2004]), [luopiskkoulk_2004])
      ,[luopiskjarj_2004] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[luopiskjarj_2004]), [luopiskjarj_2004])
   ,[lukmaak_2004] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[lukmaak_2004]), [lukmaak_2004])
   ,[amptopiskkoulk_2004] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[amptopiskkoulk_2004]), [amptopiskkoulk_2004])
      ,[amptopiskjarj_2004] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[amptopiskjarj_2004]), [amptopiskjarj_2004])
   ,[amptkmaak_2004] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[amptkmaak_2004]), [amptkmaak_2004])
   ,[amlkopiskkoulk_2004] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[amlkopiskkoulk_2004]), [amlkopiskkoulk_2004])
      ,[amlkopiskjarj_2004] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[amlkopiskjarj_2004]), [amlkopiskjarj_2004])
   ,[amlkkmaak_2004] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[amlkkmaak_2004]), [amlkkmaak_2004])
   ,[muukkopiskkoulk_2004] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[muukkopiskkoulk_2004]), [muukkopiskkoulk_2004])
      ,[muukkopiskjarj_2004] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[muukkopiskjarj_2004]), [muukkopiskjarj_2004])
   ,[muukkkmaak_2004] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[muukkkmaak_2004]), [muukkkmaak_2004])
   ,[luopiskkoulk_2005] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[luopiskkoulk_2005]), [luopiskkoulk_2005])
      ,[luopiskjarj_2005] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[luopiskjarj_2005]), [luopiskjarj_2005])
   ,[lukmaak_2005] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[lukmaak_2005]), [lukmaak_2005])
   ,[amptopiskkoulk_2005] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[amptopiskkoulk_2005]), [amptopiskkoulk_2005])
      ,[amptopiskjarj_2005] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[amptopiskjarj_2005]), [amptopiskjarj_2005])
   ,[amptkmaak_2005] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[amptkmaak_2005]), [amptkmaak_2005])
   ,[amlkopiskkoulk_2005] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[amlkopiskkoulk_2005]), [amlkopiskkoulk_2005])
      ,[amlkopiskjarj_2005] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[amlkopiskjarj_2005]), [amlkopiskjarj_2005])
   ,[amlkkmaak_2005] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[amlkkmaak_2005]), [amlkkmaak_2005])
   ,[muukkopiskkoulk_2005] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[muukkopiskkoulk_2005]), [muukkopiskkoulk_2005])
      ,[muukkopiskjarj_2005] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[muukkopiskjarj_2005]), [muukkopiskjarj_2005])
   ,[muukkkmaak_2005] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[muukkkmaak_2005]), [muukkkmaak_2005])

   ,[luopiskkoulk_2006] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[luopiskkoulk_2006]), [luopiskkoulk_2006])
      ,[luopiskjarj_2006] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[luopiskjarj_2006]), [luopiskjarj_2006])
   ,[lukmaak_2006] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[lukmaak_2006]), [lukmaak_2006])
   ,[amptopiskkoulk_2006] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[amptopiskkoulk_2006]), [amptopiskkoulk_2006])
      ,[amptopiskjarj_2006] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[amptopiskjarj_2006]), [amptopiskjarj_2006])
   ,[amptkmaak_2006] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[amptkmaak_2006]), [amptkmaak_2006])
   ,[amlkopiskkoulk_2006] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[amlkopiskkoulk_2006]), [amlkopiskkoulk_2006])
      ,[amlkopiskjarj_2006] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[amlkopiskjarj_2006]), [amlkopiskjarj_2006])
   ,[amlkkmaak_2006] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[amlkkmaak_2006]), [amlkkmaak_2006])
   ,[muukkopiskkoulk_2006] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[muukkopiskkoulk_2006]), [muukkopiskkoulk_2006])
      ,[muukkopiskjarj_2006] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[muukkopiskjarj_2006]), [muukkopiskjarj_2006])
   ,[muukkkmaak_2006] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[muukkkmaak_2006]), [muukkkmaak_2006])

   ,[luopiskkoulk_2007] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[luopiskkoulk_2007]), [luopiskkoulk_2007])
      ,[luopiskjarj_2007] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[luopiskjarj_2007]), [luopiskjarj_2007])
   ,[lukmaak_2007] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[lukmaak_2007]), [lukmaak_2007])
   ,[amptopiskkoulk_2007] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[amptopiskkoulk_2007]), [amptopiskkoulk_2007])
      ,[amptopiskjarj_2007] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[amptopiskjarj_2007]), [amptopiskjarj_2007])
   ,[amptkmaak_2007] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[amptkmaak_2007]), [amptkmaak_2007])
   ,[amlkopiskkoulk_2007] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[amlkopiskkoulk_2007]), [amlkopiskkoulk_2007])
      ,[amlkopiskjarj_2007] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[amlkopiskjarj_2007]), [amlkopiskjarj_2007])
   ,[amlkkmaak_2007] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[amlkkmaak_2007]), [amlkkmaak_2007])
   ,[muukkopiskkoulk_2007] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[muukkopiskkoulk_2007]), [muukkopiskkoulk_2007])
      ,[muukkopiskjarj_2007] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[muukkopiskjarj_2007]), [muukkopiskjarj_2007])
   ,[muukkkmaak_2007] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[muukkkmaak_2007]), [muukkkmaak_2007])

   ,[luopiskkoulk_2008] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[luopiskkoulk_2008]), [luopiskkoulk_2008])
      ,[luopiskjarj_2008] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[luopiskjarj_2008]), [luopiskjarj_2008])
   ,[lukmaak_2008] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[lukmaak_2008]), [lukmaak_2008])
   ,[amptopiskkoulk_2008] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[amptopiskkoulk_2008]), [amptopiskkoulk_2008])
      ,[amptopiskjarj_2008] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[amptopiskjarj_2008]), [amptopiskjarj_2008])
   ,[amptkmaak_2008] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[amptkmaak_2008]), [amptkmaak_2008])
   ,[amlkopiskkoulk_2008] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[amlkopiskkoulk_2008]), [amlkopiskkoulk_2008])
      ,[amlkopiskjarj_2008] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[amlkopiskjarj_2008]), [amlkopiskjarj_2008])
   ,[amlkkmaak_2008] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[amlkkmaak_2008]), [amlkkmaak_2008])
   ,[muukkopiskkoulk_2008] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[muukkopiskkoulk_2008]), [muukkopiskkoulk_2008])
      ,[muukkopiskjarj_2008] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[muukkopiskjarj_2008]), [muukkopiskjarj_2008])
   ,[muukkkmaak_2008] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[muukkkmaak_2008]), [muukkkmaak_2008])

   ,[luopiskkoulk_2009] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[luopiskkoulk_2009]), [luopiskkoulk_2009])
      ,[luopiskjarj_2009] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[luopiskjarj_2009]), [luopiskjarj_2009])
   ,[lukmaak_2009] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[lukmaak_2009]), [lukmaak_2009])
   ,[amptopiskkoulk_2009] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[amptopiskkoulk_2009]), [amptopiskkoulk_2009])
      ,[amptopiskjarj_2009] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[amptopiskjarj_2009]), [amptopiskjarj_2009])
   ,[amptkmaak_2009] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[amptkmaak_2009]), [amptkmaak_2009])
   ,[amlkopiskkoulk_2009] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[amlkopiskkoulk_2009]), [amlkopiskkoulk_2009])
      ,[amlkopiskjarj_2009] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[amlkopiskjarj_2009]), [amlkopiskjarj_2009])
   ,[amlkkmaak_2009] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[amlkkmaak_2009]), [amlkkmaak_2009])
   ,[muukkopiskkoulk_2009] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[muukkopiskkoulk_2009]), [muukkopiskkoulk_2009])
      ,[muukkopiskjarj_2009] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[muukkopiskjarj_2009]), [muukkopiskjarj_2009])
   ,[muukkkmaak_2009] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[muukkkmaak_2009]), [muukkkmaak_2009])

      ,[ptoim1r5_2004]
      ,[amas_2004]
      ,[ptoim1r5_2005]
      ,[amas_2005]
      ,[ptoim1r5_2006]
      ,[amas_2006]
      ,[ptoim1r5_2007]
      ,[amas_2007]
      ,[ptoim1r5_2008]
      ,[amas_2008]
      ,[ptoim1r5_2009]
      ,[amas_2009]
      ,[lusuorv_2010]
      ,[lusuorlk_2010]
   ,[lututkmaak_2010] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[lututkmaak_2010]), [lututkmaak_2010])
      ,[lututkjarj_2010] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[lututkjarj_2010]), [lututkjarj_2010])
   ,[lututkkoulk_2010] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[lututkkoulk_2010]), [lututkkoulk_2010])
      ,[amptsuorv_2010]
      ,[amptsuorlk_2010]
   ,[ampttutkmaak_2010] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ampttutkmaak_2010]), [ampttutkmaak_2010])
      ,[ampttutkjarj_2010] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ampttutkjarj_2010]), [ampttutkjarj_2010])
   ,[ampttutkkoulk_2010] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ampttutkkoulk_2010]), [ampttutkkoulk_2010])
      ,[amlksuorv_2010]
      ,[amlksuorlk_2010]
   ,[amlktutkmaak_2010] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[amlktutkmaak_2010]), [amlktutkmaak_2010])
      ,[amlktutkjarj_2010] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[amlktutkjarj_2010]), [amlktutkjarj_2010])
   ,[amlktutkkoulk_2010] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[amlktutkkoulk_2010]), [amlktutkkoulk_2010])
      ,[muukksuorv_2010]
      ,[muukksuorlk_2010]
   ,[muukktutkmaak_2010] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[muukktutkmaak_2010]), [muukktutkmaak_2010])
      ,[muukktutkjarj_2010] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[muukktutkjarj_2010]), [muukktutkjarj_2010])
   ,[muukktutkkoulk_2010] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[muukktutkkoulk_2010]), [muukktutkkoulk_2010])
   ,[luopiskkoulk_2010] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[luopiskkoulk_2010]), [luopiskkoulk_2010])
      ,[luopiskjarj_2010] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[luopiskjarj_2010]), [luopiskjarj_2010])
   ,[lukmaak_2010] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[lukmaak_2010]), [lukmaak_2010])
   ,[amptopiskkoulk_2010] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[amptopiskkoulk_2010]), [amptopiskkoulk_2010])
      ,[amptopiskjarj_2010] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[amptopiskjarj_2010]), [amptopiskjarj_2010])
   ,[amptkmaak_2010] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[amptkmaak_2010]), [amptkmaak_2010])
   ,[amlkopiskkoulk_2010] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[amlkopiskkoulk_2010]), [amlkopiskkoulk_2010])
      ,[amlkopiskjarj_2010] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[amlkopiskjarj_2010]), [amlkopiskjarj_2010])
   ,[amlkkmaak_2010] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[amlkkmaak_2010]), [amlkkmaak_2010])
   ,[muukkopiskkoulk_2010] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[muukkopiskkoulk_2010]), [muukkopiskkoulk_2010])
      ,[muukkopiskjarj_2010] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[muukkopiskjarj_2010]), [muukkopiskjarj_2010])
   ,[muukkkmaak_2010] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[muukkkmaak_2010]), [muukkkmaak_2010])
      ,[ptoim1r5_2010]
      ,[amas_2010]
      ,[lusuorv_2011]
      ,[lusuorlk_2011]
   ,[lututkmaak_2011] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[lututkmaak_2011]), [lututkmaak_2011])
      ,[lututkjarj_2011] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[lututkjarj_2011]), [lututkjarj_2011])
   ,[lututkkoulk_2011] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[lututkkoulk_2011]), [lututkkoulk_2011])
      ,[amptsuorv_2011]
      ,[amptsuorlk_2011]
   ,[ampttutkmaak_2011] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ampttutkmaak_2011]), [ampttutkmaak_2011])
      ,[ampttutkjarj_2011] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ampttutkjarj_2011]), [ampttutkjarj_2011])
   ,[ampttutkkoulk_2011] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ampttutkkoulk_2011]), [ampttutkkoulk_2011])
      ,[amlksuorv_2011]
      ,[amlksuorlk_2011]
   ,[amlktutkmaak_2011] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[amlktutkmaak_2011]), [amlktutkmaak_2011])
      ,[amlktutkjarj_2011] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[amlktutkjarj_2011]), [amlktutkjarj_2011])
   ,[amlktutkkoulk_2011] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[amlktutkkoulk_2011]), [amlktutkkoulk_2011])
      ,[muukksuorv_2011]
      ,[muukksuorlk_2011]
   ,[muukktutkmaak_2011] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[muukktutkmaak_2011]), [muukktutkmaak_2011])
      ,[muukktutkjarj_2011] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[muukktutkjarj_2011]), [muukktutkjarj_2011])
   ,[muukktutkkoulk_2011] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[muukktutkkoulk_2011]), [muukktutkkoulk_2011])
   ,[luopiskkoulk_2011] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[luopiskkoulk_2011]), [luopiskkoulk_2011])
      ,[luopiskjarj_2011] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[luopiskjarj_2011]), [luopiskjarj_2011])
   ,[lukmaak_2011] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[lukmaak_2011]), [lukmaak_2011])
   ,[amptopiskkoulk_2011] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[amptopiskkoulk_2011]), [amptopiskkoulk_2011])
      ,[amptopiskjarj_2011] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[amptopiskjarj_2011]), [amptopiskjarj_2011])
   ,[amptkmaak_2011] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[amptkmaak_2011]), [amptkmaak_2011])
   ,[amlkopiskkoulk_2011] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[amlkopiskkoulk_2011]), [amlkopiskkoulk_2011])
      ,[amlkopiskjarj_2011] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[amlkopiskjarj_2011]), [amlkopiskjarj_2011])
   ,[amlkkmaak_2011] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[amlkkmaak_2011]), [amlkkmaak_2011])
   ,[muukkopiskkoulk_2011] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[muukkopiskkoulk_2011]), [muukkopiskkoulk_2011])
      ,[muukkopiskjarj_2011] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[muukkopiskjarj_2011]), [muukkopiskjarj_2011])
   ,[muukkkmaak_2011] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[muukkkmaak_2011]), [muukkkmaak_2011])
      ,[ptoim1r5_2011]
      ,[amas_2011]
--2012     
      ,[lusuorv_2012]
      ,[lusuorlk_2012]
   ,[lututkmaak_2012] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[lututkmaak_2012]), [lututkmaak_2012])
      ,[lututkjarj_2012] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[lututkjarj_2012]), [lututkjarj_2012])
   ,[lututkkoulk_2012] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[lututkkoulk_2012]), [lututkkoulk_2012])
      ,[amptsuorv_2012]
      ,[amptsuorlk_2012]
   ,[ampttutkmaak_2012] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ampttutkmaak_2012]), [ampttutkmaak_2012])
      ,[ampttutkjarj_2012] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ampttutkjarj_2012]), [ampttutkjarj_2012])
   ,[ampttutkkoulk_2012] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ampttutkkoulk_2012]), [ampttutkkoulk_2012])
      ,[amlksuorv_2012]
      ,[amlksuorlk_2012]
   ,[amlktutkmaak_2012] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[amlktutkmaak_2012]), [amlktutkmaak_2012])
      ,[amlktutkjarj_2012] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[amlktutkjarj_2012]), [amlktutkjarj_2012])
   ,[amlktutkkoulk_2012] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[amlktutkkoulk_2012]), [amlktutkkoulk_2012])
      ,[muukksuorv_2012]
      ,[muukksuorlk_2012]
   ,[muukktutkmaak_2012] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[muukktutkmaak_2012]), [muukktutkmaak_2012])
      ,[muukktutkjarj_2012] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[muukktutkjarj_2012]), [muukktutkjarj_2012])
   ,[muukktutkkoulk_2012] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[muukktutkkoulk_2012]), [muukktutkkoulk_2012])
   ,[luopiskkoulk_2012] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[luopiskkoulk_2012]), [luopiskkoulk_2012])
      ,[luopiskjarj_2012] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[luopiskjarj_2012]), [luopiskjarj_2012])
   ,[lukmaak_2012] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[lukmaak_2012]), [lukmaak_2012])
   ,[amptopiskkoulk_2012] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[amptopiskkoulk_2012]), [amptopiskkoulk_2012])
      ,[amptopiskjarj_2012] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[amptopiskjarj_2012]), [amptopiskjarj_2012])
   ,[amptkmaak_2012] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[amptkmaak_2012]), [amptkmaak_2012])
   ,[amlkopiskkoulk_2012] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[amlkopiskkoulk_2012]), [amlkopiskkoulk_2012])
      ,[amlkopiskjarj_2012] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[amlkopiskjarj_2012]), [amlkopiskjarj_2012])
   ,[amlkkmaak_2012] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[amlkkmaak_2012]), [amlkkmaak_2012])
   ,[muukkopiskkoulk_2012] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[muukkopiskkoulk_2012]), [muukkopiskkoulk_2012])
      ,[muukkopiskjarj_2012] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[muukkopiskjarj_2012]), [muukkopiskjarj_2012])
   ,[muukkkmaak_2012] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[muukkkmaak_2012]), [muukkkmaak_2012])
      ,[ptoim1r5_2012]
      ,[amas_2012]
--2013     
      ,[lusuorv_2013]
      ,[lusuorlk_2013]
   ,[lututkmaak_2013] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[lututkmaak_2013]), [lututkmaak_2013])
      ,[lututkjarj_2013] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[lututkjarj_2013]), [lututkjarj_2013])
   ,[lututkkoulk_2013] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[lututkkoulk_2013]), [lututkkoulk_2013])
      ,[amptsuorv_2013]
      ,[amptsuorlk_2013]
   ,[ampttutkmaak_2013] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ampttutkmaak_2013]), [ampttutkmaak_2013])
      ,[ampttutkjarj_2013] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ampttutkjarj_2013]), [ampttutkjarj_2013])
   ,[ampttutkkoulk_2013] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ampttutkkoulk_2013]), [ampttutkkoulk_2013])
      ,[amlksuorv_2013]
      ,[amlksuorlk_2013]
   ,[amlktutkmaak_2013] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[amlktutkmaak_2013]), [amlktutkmaak_2013])
      ,[amlktutkjarj_2013] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[amlktutkjarj_2013]), [amlktutkjarj_2013])
   ,[amlktutkkoulk_2013] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[amlktutkkoulk_2013]), [amlktutkkoulk_2013])
      ,[muukksuorv_2013]
      ,[muukksuorlk_2013]
   ,[muukktutkmaak_2013] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[muukktutkmaak_2013]), [muukktutkmaak_2013])
      ,[muukktutkjarj_2013] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[muukktutkjarj_2013]), [muukktutkjarj_2013])
   ,[muukktutkkoulk_2013] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[muukktutkkoulk_2013]), [muukktutkkoulk_2013])
   ,[luopiskkoulk_2013] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[luopiskkoulk_2013]), [luopiskkoulk_2013])
      ,[luopiskjarj_2013] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[luopiskjarj_2013]), [luopiskjarj_2013])
   ,[lukmaak_2013] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[lukmaak_2013]), [lukmaak_2013])
   ,[amptopiskkoulk_2013] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[amptopiskkoulk_2013]), [amptopiskkoulk_2013])
      ,[amptopiskjarj_2013] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[amptopiskjarj_2013]), [amptopiskjarj_2013])
   ,[amptkmaak_2013] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[amptkmaak_2013]), [amptkmaak_2013])
   ,[amlkopiskkoulk_2013] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[amlkopiskkoulk_2013]), [amlkopiskkoulk_2013])
      ,[amlkopiskjarj_2013] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[amlkopiskjarj_2013]), [amlkopiskjarj_2013])
   ,[amlkkmaak_2013] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[amlkkmaak_2013]), [amlkkmaak_2013])
   ,[muukkopiskkoulk_2013] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[muukkopiskkoulk_2013]), [muukkopiskkoulk_2013])
      ,[muukkopiskjarj_2013] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[muukkopiskjarj_2013]), [muukkopiskjarj_2013])
   ,[muukkkmaak_2013] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[muukkkmaak_2013]), [muukkkmaak_2013])
      ,[ptoim1r5_2013]
      ,[amas_2013]

-- 2014

      ,[lusuorv_2014]
      ,[lusuorlk_2014]
   ,[lututkmaak_2014] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[lututkmaak_2014]), [lututkmaak_2014])
      ,[lututkjarj_2014] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[lututkjarj_2014]), [lututkjarj_2014])
   ,[lututkkoulk_2014] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[lututkkoulk_2014]), [lututkkoulk_2014])
      ,[amptsuorv_2014]
      ,[amptsuorlk_2014]
   ,[ampttutkmaak_2014] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[ampttutkmaak_2014]), [ampttutkmaak_2014])
      ,[ampttutkjarj_2014] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[ampttutkjarj_2014]), [ampttutkjarj_2014])
   ,[ampttutkkoulk_2014] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[ampttutkkoulk_2014]), [ampttutkkoulk_2014])
      ,[amlksuorv_2014]
      ,[amlksuorlk_2014]
   ,[amlktutkmaak_2014] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[amlktutkmaak_2014]), [amlktutkmaak_2014])
      ,[amlktutkjarj_2014] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[amlktutkjarj_2014]), [amlktutkjarj_2014])
   ,[amlktutkkoulk_2014] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[amlktutkkoulk_2014]), [amlktutkkoulk_2014])
      ,[muukksuorv_2014]
      ,[muukksuorlk_2014]
   ,[muukktutkmaak_2014] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[muukktutkmaak_2014]), [muukktutkmaak_2014])
      ,[muukktutkjarj_2014] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[muukktutkjarj_2014]), [muukktutkjarj_2014])
   ,[muukktutkkoulk_2014] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[muukktutkkoulk_2014]), [muukktutkkoulk_2014])
   ,[luopiskkoulk_2014] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[luopiskkoulk_2014]), [luopiskkoulk_2014])
      ,[luopiskjarj_2014] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[luopiskjarj_2014]), [luopiskjarj_2014])
   ,[lukmaak_2014] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[lukmaak_2014]), [lukmaak_2014])
   ,[amptopiskkoulk_2014] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[amptopiskkoulk_2014]), [amptopiskkoulk_2014])
      ,[amptopiskjarj_2014] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[amptopiskjarj_2014]), [amptopiskjarj_2014])
   ,[amptkmaak_2014] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[amptkmaak_2014]), [amptkmaak_2014])
   ,[amlkopiskkoulk_2014] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[amlkopiskkoulk_2014]), [amlkopiskkoulk_2014])
      ,[amlkopiskjarj_2014] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[amlkopiskjarj_2014]), [amlkopiskjarj_2014])
   ,[amlkkmaak_2014] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[amlkkmaak_2014]), [amlkkmaak_2014])
   ,[muukkopiskkoulk_2014] = coalesce((Select koulutus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutusluokitus_nykytila] WHERE koulutus_koodi=[muukkopiskkoulk_2014]), [muukkopiskkoulk_2014])
      ,[muukkopiskjarj_2014] = coalesce((Select koulutuksen_jarjestajakoodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_koulutuksen_jarjestaja_nykytila] WHERE koulutuksen_jarjestajakoodi=[muukkopiskjarj_2014]), [muukkopiskjarj_2014])
   ,[muukkkmaak_2014] = coalesce((Select alueluokitus_koodi_nykytila FROM [VipunenTK_lisatiedot].[dbo].[v_AL_K3_9_alueluokitus_maakunta_nykytila] WHERE alueluokitus_koodi=[muukkkmaak_2014]), [muukkkmaak_2014])
      ,[ptoim1r5_2014]
      ,[amas_2014]




--UUSI VUOSI 
      
      ,[lkm]
      ,[tietolahde]=''K3_9_sopv_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv, alvv, allk)
      ,[aineistorivinumero] = ROW_NUMBER() OVER(ORDER BY tilv, alvv, allk)
  FROM [TK_H9098_CSC].[dbo].[TK_K3_9_sopv_16]




' 
GO
/****** Object:  View [dbo].[v_sa_K4_22_Yli_15-vuotiaat_koulutuksen_kielen_ja_asuinkunnan_mukaan]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_K4_22_Yli_15-vuotiaat_koulutuksen_kielen_ja_asuinkunnan_mukaan]'))
EXEC dbo.sp_executesql @statement = N'














CREATE VIEW [dbo].[v_sa_K4_22_Yli_15-vuotiaat_koulutuksen_kielen_ja_asuinkunnan_mukaan] AS

SELECT [tilv]
      ,[aikieli]
      ,[tilvaskun]
      ,[ikar5]
      ,[opmala]
      ,[opmast]
      ,[lkm]
      ,[luontipvm]
	  ,tietolahde = ''K4_22_sopv_14''
  FROM [TK_H9098_CSC].[dbo].[TK_K4_22_sopv_14]
UNION ALL
SELECT [tilv]
      ,[aikieli]
      ,[tilvaskun]
      ,[ikar5]
      ,[opmala]
      ,[opmast]
      ,[lkm]
      ,[luontipvm]
	  ,tietolahde = ''K4_22_sopv_15''
  FROM [TK_H9098_CSC].[dbo].[TK_K4_22_sopv_15]
UNION ALL
SELECT [tilv]
      ,[aikieli]
      ,[tilvaskun]
      ,[ikar5]
      ,[opmala]
      ,[opmast]
      ,[lkm]
      ,[luontipvm]
	  ,tietolahde = ''K4_22_sopv_16''
  FROM [TK_H9098_CSC].[dbo].[TK_K4_22_sopv_16]
UNION ALL
SELECT [tilv]
      ,[aikieli]
      ,[tilvaskun]
      ,[ikar5]
      ,[opmala]
      ,[opmast]
      ,[lkm]
      ,[luontipvm]
	  ,tietolahde = ''K4_22_sopv_17''
  FROM [TK_H9098_CSC].[dbo].[TK_K4_22_sopv_17]













' 
GO
/****** Object:  View [dbo].[v_sa_K5_5_Tieteen_ja_teknologian_henkilovoimavarat]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_K5_5_Tieteen_ja_teknologian_henkilovoimavarat]'))
EXEC dbo.sp_executesql @statement = N'
















CREATE VIEW [dbo].[v_sa_K5_5_Tieteen_ja_teknologian_henkilovoimavarat] AS 
/*
drop table  [VipunenTK_DW].[dbo].[sa_K5_5_Tieteen_ja_teknologian_henkilovoimavarat]
select * into [VipunenTK_DW].[dbo].[sa_K5_5_Tieteen_ja_teknologian_henkilovoimavarat] from [VipunenTK_SA].[dbo].[v_sa_K5_5_Tieteen_ja_teknologian_henkilovoimavarat]

truncate table  [VipunenTK_DW].[dbo].[sa_K5_5_Tieteen_ja_teknologian_henkilovoimavarat]
insert into [VipunenTK_DW].[dbo].[sa_K5_5_Tieteen_ja_teknologian_henkilovoimavarat]
 select * from   [VipunenTK_SA].[dbo].[v_sa_K5_5_Tieteen_ja_teknologian_henkilovoimavarat]
*/

SELECT [tilv]
      ,[svalt] = Case when svalt in (''991'', ''997'', ''998'') then ''-1'' else svalt end --Dimensiossa ei ole etunollia
      ,[kansal] = Case when kansal in (''991'', ''997'', ''998'') then ''-1'' else kansal end --Dimensiossa ei ole etunollia
      ,[sp]
      ,ikar5 = ltrim([ikar])
      ,[maakunta]
      ,[ptoim1]
      ,[koulk] = ISNULL(koulk, ''-1'')
      ,[suorv]
      ,[suormaak] = ISNULL(NULLIF(suormaak, ''99''), ''-1'')
      ,[amm2010_2] = CASE WHEN left(amm2010_2, 1) = ''X'' then -1 when amm2010_2 is null then -1 else amm2010_2 end
      ,[tmaak] = ISNULL(NULLIF(tmaak, ''99''), ''-1'')
      ,[tol2008_akatemia] = ISNULL(NULLIF([tol2008_akatemia], ''99''), ''-1'')
      ,[tsekt_2] = ISNULL([tsekt_2], ''0'')
	  ,[ta_vaihdos] = ISNULL([ta_vaihdos],''-1'')
	  ,[sl] = ISNULL([sl],''-1'')
	  ,[tol2008_tthv_ed] = ISNULL(NULLIF([tol2008_tthv_ed], ''99''), ''-1'')
	  ,[tsekt_ed] = ISNULL([tsekt_ed],''0'')
      ,[lkm]
      ,[tietolahde] = CAST(kaikkivuodet.tietolahde as nvarchar(50))
      ,[rivinumero] = CAST(kaikkivuodet.rivinumero as int)
FROM ( --kaikkivuodet

SELECT [tilv]
      ,[svalt]
      ,[kansal]
      ,[sp]
      ,[ikar]
      ,[maakunta]
      ,[ptoim1] = ''-1''
      ,[koulk]
      ,[suorv]
      ,[suormaak]
      ,[amm2010_2]
      ,[tmaak]
      ,[tol2008_akatemia]
      ,[tsekt_2]
	  ,[ta_vaihdos] = null
	  ,[sl] = null
	  ,[tol2008_tthv_ed] = null
	  ,[tsekt_ed] = null
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde]=''TK_K5_5_sopv_15''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv, svalt, sp, koulk)
  FROM [TK_H9098_CSC].[dbo].[TK_K5_5_sopv_15]
  WHERE tilv in (''2008'', ''2009'', ''2010'')

UNION ALL

SELECT [tilv]
      ,[svalt]
      ,[kansal]
      ,[sp]
      ,[ikar5]
      ,[maakunta]
      ,[ptoim1]
      ,[koulk]
      ,[suorv]
      ,[suormaak]
      ,[amm2010_2]
      ,[tmaak]
      ,[tol2008_tthv]
      ,[tsekt_2]
	  ,[ta_vaihdos] = null
	  ,[sl] = null
	  ,[tol2008_tthv_ed] = null
	  ,[tsekt_ed] = null
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde]=''TK_K5_5_sopv_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv, svalt, sp, koulk)
  FROM [TK_H9098_CSC].[dbo].[TK_K5_5_sopv_16]
  WHERE tilv in (''2011'', ''2012'', ''2013'')

UNION ALL

SELECT [tilv]
      ,[svalt]
      ,[kansal]
      ,[sp]
      ,[ikar5]
      ,[maakunta]
      ,[ptoim1]
      ,[koulk]
      ,[suorv]
      ,[suormaak]
      ,[amm2010_2]
      ,[tmaak]
      ,[tol2008_tthv]
      ,[tsekt_2]
	  ,[ta_vaihdos]
	  ,[sl]
	  ,[tol2008_tthv_ed]
	  ,[tsekt_ed]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde]=''TK_K5_5_sopv_17''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv, svalt, sp, koulk)
  FROM [TK_H9098_CSC].[dbo].[TK_K5_5_sopv_17]
  WHERE tilv in (''2014'', ''2015'', ''2016'')

 ) kaikkivuodet














' 
GO
/****** Object:  View [dbo].[v_sa_R2_22_Oppilaitostason_oppil_ja_opisk]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_R2_22_Oppilaitostason_oppil_ja_opisk]'))
EXEC dbo.sp_executesql @statement = N'




CREATE VIEW [dbo].[v_sa_R2_22_Oppilaitostason_oppil_ja_opisk] AS
--Select * from [v_sa_R2_22_Oppilaitostason_oppil_ja_opisk]
/*
Drop table VipunenTK_DW.[dbo].f_R2_22_Oppilaitostason_oppil_ja_opisk

truncate table VipunenTK_DW.[dbo].f_R2_22_Oppilaitostason_oppil_ja_opisk
insert into VipunenTK_DW.[dbo].f_R2_22_Oppilaitostason_oppil_ja_opisk select * from v_sa_R2_22_Oppilaitostason_oppil_ja_opisk

Select * from [v_sa_R2_22_Peruskoulutiedosto]
*/

SELECT [tilv] = CAST(tilv as nvarchar(4))
	  ,[tilv_date] = Cast(tilv+''0101'' as date)
      ,[jarj] = CAST(jarj as nvarchar(10))
      ,[tiedtype] = CAST(tiedtype as nchar(1))
      ,[tunn] = CAST(tunn as nvarchar(5))
      ,[edesi] = CAST([edesi] as nchar(1))
      ,[edala] = CAST([edala] as nchar(1))
      ,[edyla] = CAST([edyla] as nchar(1))
      ,[edlisa] = CAST([edlisa] as nchar(1))
      ,[edainep] = CAST([edainep] as nchar(1))
      ,[syesi] = CAST([syesi] as nchar(1))
      ,[syala] = CAST([syala] as nchar(1))
      ,[syyla] = CAST([syyla] as nchar(1))
      ,[sylisa] = CAST([sylisa] as nchar(1))
      ,[symamu] = CAST([symamu] as nchar(1))
      ,[sylukio] = CAST([sylukio] as nchar(1))
      ,[syamm] = CAST([syamm] as nchar(1))
      ,[symuu] = CAST([symuu] as nchar(1))

      ,[keven]=  Cast([keven] as int)
      ,[kev1]=  Cast([kev1] as int)
      ,[kev1n]=  Cast([kev1n] as int)
      ,[kev2]=  Cast([kev2] as int)
      ,[kev2n]=  Cast([kev2n] as int)
      ,[kev3]=  Cast([kev3] as int)
      ,[kev3n]=  Cast([kev3n] as int)
      ,[kev4]=  Cast([kev4] as int)
      ,[kev4n]=  Cast([kev4n] as int)
      ,[kev5]=  Cast([kev5] as int)
      ,[kev5n]=  Cast([kev5n] as int)
      ,[kev6]=  Cast([kev6] as int)
      ,[kev6n]=  Cast([kev6n] as int)
      ,[kev7]=  Cast([kev7] as int)
      ,[kev7n]=  Cast([kev7n] as int)
      ,[kev8]=  Cast([kev8] as int)
      ,[kev8n]=  Cast([kev8n] as int)
      ,[kev9]=  Cast([kev9] as int)
      ,[kev9n]=  Cast([kev9n] as int)
      ,[kev10]=  Cast([kev10] as int)
      ,[kev10n]=  Cast([kev10n] as int)
      ,[kev]=  Cast([kev] as int)
      ,[kevn]=  Cast([kevn] as int)
      ,[luok1]=  Cast([luok1] as int)
      ,[luok1n]=  Cast([luok1n] as int)
      ,[luok2]=  Cast([luok2] as int)
      ,[luok2n]=  Cast([luok2n] as int)
      ,[luok3]=  Cast([luok3] as int)
      ,[luok3n]=  Cast([luok3n] as int)
      ,[luok4]=  Cast([luok4] as int)
      ,[luok4n]=  Cast([luok4n] as int)
      ,[luok5]=  Cast([luok5] as int)
      ,[luok5n]=  Cast([luok5n] as int)
      ,[luok6]=  Cast([luok6] as int)
      ,[luok6n]=  Cast([luok6n] as int)
      ,[luok7]=  Cast([luok7] as int)
      ,[luok7n]=  Cast([luok7n] as int)
      ,[luok8]=  Cast([luok8] as int)
      ,[luok8n]=  Cast([luok8n] as int)
      ,[luok9]=  Cast([luok9] as int)
      ,[luok9n]=  Cast([luok9n] as int)
      ,[luok]=  Cast([luok] as int)
      ,[luokn]=  Cast([luokn] as int)
      ,[kelaim]=  Cast([kelaim] as int)
      ,[kelaimn]=  Cast([kelaimn] as int)
      ,[tod]=  Cast([tod] as int)
      ,[todn]=  Cast([todn] as int)
      ,[tutkt]=  Cast([tutkt] as int)
      ,[tutktn]=  Cast([tutktn] as int)
      ,[suor10]=  Cast([suor10] as int)
      ,[suor10n]=  Cast([suor10n] as int)
      ,[oeriy]=  Cast([oeriy] as int)
      ,[oeriyn]=  Cast([oeriyn] as int)
      ,[ilmtod]=  Cast([ilmtod] as int)
      ,[ilmtodn]=  Cast([ilmtodn] as int)

      ,[aku] = CAST(aku as nchar(1))

      ,[mamukurs]=  Cast([mamukurs] as int)
      ,[oppkurs]=  Cast([oppkurs] as int)
      ,[muukurs]=  Cast([muukurs] as int)
      ,[akukurs]=  Cast([akukurs] as int)
      ,[kmamu]=  Cast([kmamu] as int)
      ,[kmamun]=  Cast([kmamun] as int)
      ,[syulkom]=  Cast([syulkom] as int)
      ,[syulkomn]=  Cast([syulkomn] as int)
      ,[sykoti]=  Cast([sykoti] as int)
      ,[sykotin]=  Cast([sykotin] as int)
      ,[ika4e]=  Cast([ika4e] as int)
      ,[ika4en]=  Cast([ika4en] as int)
      ,[ika5e]=  Cast([ika5e] as int)
      ,[ika5en]=  Cast([ika5en] as int)
      ,[pid5v]=  Cast([pid5v] as int)
      ,[ika6e]=  Cast([ika6e] as int)
      ,[ika6en]=  Cast([ika6en] as int)
      ,[ika7e]=  Cast([ika7e] as int)
      ,[ika7en]=  Cast([ika7en] as int)
      ,[ikae]=  Cast([ikae] as int)
      ,[ikaen]=  Cast([ikaen] as int)
      ,[ove]=  Cast([ove] as int)
      ,[ov1]=  Cast([ov1] as int)
      ,[ov2]=  Cast([ov2] as int)
      ,[ov3]=  Cast([ov3] as int)
      ,[ov4]=  Cast([ov4] as int)
      ,[ov5]=  Cast([ov5] as int)
      ,[ov6]=  Cast([ov6] as int)
      ,[ov7]=  Cast([ov7] as int)
      ,[ov8]=  Cast([ov8] as int)
      ,[ov9]=  Cast([ov9] as int)
      ,[ov10]=  Cast([ov10] as int)
      ,[ovy]=  Cast([ovy] as int)
      ,[tehoe]=  Cast([tehoe] as int)
      ,[teho1]=  Cast([teho1] as int)
      ,[teho2]=  Cast([teho2] as int)
      ,[teho3]=  Cast([teho3] as int)
      ,[teho4]=  Cast([teho4] as int)
      ,[teho5]=  Cast([teho5] as int)
      ,[teho6]=  Cast([teho6] as int)
      ,[teho7]=  Cast([teho7] as int)
      ,[teho8]=  Cast([teho8] as int)
      ,[teho9]=  Cast([teho9] as int)
      ,[teho10]=  Cast([teho10] as int)
      ,[tehoy]=  Cast([tehoy] as int)
      ,[eipide]=  Cast([eipide] as int)
      ,[eipid1]=  Cast([eipid1] as int)
      ,[eipid2]=  Cast([eipid2] as int)
      ,[eipid3]=  Cast([eipid3] as int)
      ,[eipid4]=  Cast([eipid4] as int)
      ,[eipid5]=  Cast([eipid5] as int)
      ,[eipid6]=  Cast([eipid6] as int)
      ,[eipid7]=  Cast([eipid7] as int)
      ,[eipid8]=  Cast([eipid8] as int)
      ,[eipid9]=  Cast([eipid9] as int)
      ,[eipid10]=  Cast([eipid10] as int)
      ,[eipidy]=  Cast([eipidy] as int)
      ,[ertuve]=  Cast([ertuve] as int)
      ,[ertuv1]=  Cast([ertuv1] as int)
      ,[ertuv2]=  Cast([ertuv2] as int)
      ,[ertuv3]=  Cast([ertuv3] as int)
      ,[ertuv4]=  Cast([ertuv4] as int)
      ,[ertuv5]=  Cast([ertuv5] as int)
      ,[ertuv6]=  Cast([ertuv6] as int)
      ,[ertuv7]=  Cast([ertuv7] as int)
      ,[ertuv8]=  Cast([ertuv8] as int)
      ,[ertuv9]=  Cast([ertuv9] as int)
      ,[ertuv10]=  Cast([ertuv10] as int)
      ,[ertuvy]=  Cast([ertuvy] as int)
      ,[ertume]=  Cast([ertume] as int)
      ,[ertum1]=  Cast([ertum1] as int)
      ,[ertum2]=  Cast([ertum2] as int)
      ,[ertum3]=  Cast([ertum3] as int)
      ,[ertum4]=  Cast([ertum4] as int)
      ,[ertum5]=  Cast([ertum5] as int)
      ,[ertum6]=  Cast([ertum6] as int)
      ,[ertum7]=  Cast([ertum7] as int)
      ,[ertum8]=  Cast([ertum8] as int)
      ,[ertum9]=  Cast([ertum9] as int)
      ,[ertum10]=  Cast([ertum10] as int)
      ,[ertumy]=  Cast([ertumy] as int)
      ,[tavove]=  Cast([tavove] as int)
      ,[tavov1]=  Cast([tavov1] as int)
      ,[tavov2]=  Cast([tavov2] as int)
      ,[tavov3]=  Cast([tavov3] as int)
      ,[tavov4]=  Cast([tavov4] as int)
      ,[tavov5]=  Cast([tavov5] as int)
      ,[tavov6]=  Cast([tavov6] as int)
      ,[tavov7]=  Cast([tavov7] as int)
      ,[tavov8]=  Cast([tavov8] as int)
      ,[tavov9]=  Cast([tavov9] as int)
      ,[tavov10]=  Cast([tavov10] as int)
      ,[tavovy]=  Cast([tavovy] as int)
      ,[oven]=  Cast([oven] as int)
      ,[ov1n]=  Cast([ov1n] as int)
      ,[ov2n]=  Cast([ov2n] as int)
      ,[ov3n]=  Cast([ov3n] as int)
      ,[ov4n]=  Cast([ov4n] as int)
      ,[ov5n]=  Cast([ov5n] as int)
      ,[ov6n]=  Cast([ov6n] as int)
      ,[ov7n]=  Cast([ov7n] as int)
      ,[ov8n]=  Cast([ov8n] as int)
      ,[ov9n]=  Cast([ov9n] as int)
      ,[ov10n]=  Cast([ov10n] as int)
      ,[ovyn]=  Cast([ovyn] as int)
      ,[tehoen]=  Cast([tehoen] as int)
      ,[teho1n]=  Cast([teho1n] as int)
      ,[teho2n]=  Cast([teho2n] as int)
      ,[teho3n]=  Cast([teho3n] as int)
      ,[teho4n]=  Cast([teho4n] as int)
      ,[teho5n]=  Cast([teho5n] as int)
      ,[teho6n]=  Cast([teho6n] as int)
      ,[teho7n]=  Cast([teho7n] as int)
      ,[teho8n]=  Cast([teho8n] as int)
      ,[teho9n]=  Cast([teho9n] as int)
      ,[teho10n]=  Cast([teho10n] as int)
      ,[tehoyn]=  Cast([tehoyn] as int)
      ,[eipiden]=  Cast([eipiden] as int)
      ,[eipid1n]=  Cast([eipid1n] as int)
      ,[eipid2n]=  Cast([eipid2n] as int)
      ,[eipid3n]=  Cast([eipid3n] as int)
      ,[eipid4n]=  Cast([eipid4n] as int)
      ,[eipid5n]=  Cast([eipid5n] as int)
      ,[eipid6n]=  Cast([eipid6n] as int)
      ,[eipid7n]=  Cast([eipid7n] as int)
      ,[eipid8n]=  Cast([eipid8n] as int)
      ,[eipid9n]=  Cast([eipid9n] as int)
      ,[eipid10n]=  Cast([eipid10n] as int)
      ,[eipidyn]=  Cast([eipidyn] as int)
      ,[ertuven]=  Cast([ertuven] as int)
      ,[ertuv1n]=  Cast([ertuv1n] as int)
      ,[ertuv2n]=  Cast([ertuv2n] as int)
      ,[ertuv3n]=  Cast([ertuv3n] as int)
      ,[ertuv4n]=  Cast([ertuv4n] as int)
      ,[ertuv5n]=  Cast([ertuv5n] as int)
      ,[ertuv6n]=  Cast([ertuv6n] as int)
      ,[ertuv7n]=  Cast([ertuv7n] as int)
      ,[ertuv8n]=  Cast([ertuv8n] as int)
      ,[ertuv9n]=  Cast([ertuv9n] as int)
      ,[ertuv10n]=  Cast([ertuv10n] as int)
      ,[ertuvyn]=  Cast([ertuvyn] as int)
      ,[ertumen]=  Cast([ertumen] as int)
      ,[ertum1n]=  Cast([ertum1n] as int)
      ,[ertum2n]=  Cast([ertum2n] as int)
      ,[ertum3n]=  Cast([ertum3n] as int)
      ,[ertum4n]=  Cast([ertum4n] as int)
      ,[ertum5n]=  Cast([ertum5n] as int)
      ,[ertum6n]=  Cast([ertum6n] as int)
      ,[ertum7n]=  Cast([ertum7n] as int)
      ,[ertum8n]=  Cast([ertum8n] as int)
      ,[ertum9n]=  Cast([ertum9n] as int)
      ,[ertum10n]=  Cast([ertum10n] as int)
      ,[ertumyn]=  Cast([ertumyn] as int)
      ,[tavoven]=  Cast([tavoven] as int)
      ,[tavov1n]=  Cast([tavov1n] as int)
      ,[tavov2n]=  Cast([tavov2n] as int)
      ,[tavov3n]=  Cast([tavov3n] as int)
      ,[tavov4n]=  Cast([tavov4n] as int)
      ,[tavov5n]=  Cast([tavov5n] as int)
      ,[tavov6n]=  Cast([tavov6n] as int)
      ,[tavov7n]=  Cast([tavov7n] as int)
      ,[tavov8n]=  Cast([tavov8n] as int)
      ,[tavov9n]=  Cast([tavov9n] as int)
      ,[tavov10n]=  Cast([tavov10n] as int)
      ,[tavovyn]=  Cast([tavovyn] as int)
      ,[eipidec]=  Cast([eipidec] as int)
      ,[eipidpc]=  Cast([eipidpc] as int)
      ,[eipidlc]=  Cast([eipidlc] as int)
      ,[eipidyc]=  Cast([eipidyc] as int)
      ,[ertuvec]=  Cast([ertuvec] as int)
      ,[ertuvpc]=  Cast([ertuvpc] as int)
      ,[ertuvlc]=  Cast([ertuvlc] as int)
      ,[ertuvyc]=  Cast([ertuvyc] as int)
      ,[ertumec]=  Cast([ertumec] as int)
      ,[ertumpc]=  Cast([ertumpc] as int)
      ,[ertumlc]=  Cast([ertumlc] as int)
      ,[ertumyc]=  Cast([ertumyc] as int)
      ,[muuec]=  Cast([muuec] as int)
      ,[muupc]=  Cast([muupc] as int)
      ,[muulc]=  Cast([muulc] as int)
      ,[muuyc]=  Cast([muuyc] as int)
      ,[ovec]=  Cast([ovec] as int)
      ,[ovpc]=  Cast([ovpc] as int)
      ,[ovlc]=  Cast([ovlc] as int)
      ,[ovyc]=  Cast([ovyc] as int)
      ,[sisae]=  Cast([sisae] as int)
      ,[sisap]=  Cast([sisap] as int)
      ,[sisal]=  Cast([sisal] as int)
      ,[sisam]=  Cast([sisam] as int)
      ,[sisay]=  Cast([sisay] as int)
      ,[maeipide]=  Cast([maeipide] as int)
      ,[maeipidp]=  Cast([maeipidp] as int)
      ,[maeipidl]=  Cast([maeipidl] as int)
      ,[maeipidy]=  Cast([maeipidy] as int)
      ,[maertuve]=  Cast([maertuve] as int)
      ,[maertuvp]=  Cast([maertuvp] as int)
      ,[maertuvl]=  Cast([maertuvl] as int)
      ,[maertuvy]=  Cast([maertuvy] as int)
      ,[maertume]=  Cast([maertume] as int)
      ,[maertump]=  Cast([maertump] as int)
      ,[maertuml]=  Cast([maertuml] as int)
      ,[maertumy]=  Cast([maertumy] as int)
      ,[mamuue]=  Cast([mamuue] as int)
      ,[mamuup]=  Cast([mamuup] as int)
      ,[mamuul]=  Cast([mamuul] as int)
      ,[mamuuy]=  Cast([mamuuy] as int)
      ,[maove]=  Cast([maove] as int)
      ,[maovp]=  Cast([maovp] as int)
      ,[maovl]=  Cast([maovl] as int)
      ,[maovy]=  Cast([maovy] as int)
      ,[kueipide]=  Cast([kueipide] as int)
      ,[kueipidp]=  Cast([kueipidp] as int)
      ,[kueipidl]=  Cast([kueipidl] as int)
      ,[kueipidy]=  Cast([kueipidy] as int)
      ,[kuertuve]=  Cast([kuertuve] as int)
      ,[kuertuvp]=  Cast([kuertuvp] as int)
      ,[kuertuvl]=  Cast([kuertuvl] as int)
      ,[kuertuvy]=  Cast([kuertuvy] as int)
      ,[kuertume]=  Cast([kuertume] as int)
      ,[kuertump]=  Cast([kuertump] as int)
      ,[kuertuml]=  Cast([kuertuml] as int)
      ,[kuertumy]=  Cast([kuertumy] as int)
      ,[kumuue]=  Cast([kumuue] as int)
      ,[kumuup]=  Cast([kumuup] as int)
      ,[kumuul]=  Cast([kumuul] as int)
      ,[kumuuy]=  Cast([kumuuy] as int)
      ,[kuove]=  Cast([kuove] as int)
      ,[kuovp]=  Cast([kuovp] as int)
      ,[kuovl]=  Cast([kuovl] as int)
      ,[kuovy]=  Cast([kuovy] as int)
      ,[vieipide]=  Cast([vieipide] as int)
      ,[vieipidp]=  Cast([vieipidp] as int)
      ,[vieipidl]=  Cast([vieipidl] as int)
      ,[vieipidy]=  Cast([vieipidy] as int)
      ,[viertuve]=  Cast([viertuve] as int)
      ,[viertuvp]=  Cast([viertuvp] as int)
      ,[viertuvl]=  Cast([viertuvl] as int)
      ,[viertuvy]=  Cast([viertuvy] as int)
      ,[viertume]=  Cast([viertume] as int)
      ,[viertump]=  Cast([viertump] as int)
      ,[viertuml]=  Cast([viertuml] as int)
      ,[viertumy]=  Cast([viertumy] as int)
      ,[vimuue]=  Cast([vimuue] as int)
      ,[vimuup]=  Cast([vimuup] as int)
      ,[vimuul]=  Cast([vimuul] as int)
      ,[vimuuy]=  Cast([vimuuy] as int)
      ,[viove]=  Cast([viove] as int)
      ,[viovp]=  Cast([viovp] as int)
      ,[viovl]=  Cast([viovl] as int)
      ,[viovy]=  Cast([viovy] as int)
      ,[ika61]=  Cast([ika61] as int)
      ,[ika61n]=  Cast([ika61n] as int)
      ,[ika71]=  Cast([ika71] as int)
      ,[ika71n]=  Cast([ika71n] as int)
      ,[ika81]=  Cast([ika81] as int)
      ,[ika81n]=  Cast([ika81n] as int)
      ,[ika91]=  Cast([ika91] as int)
      ,[ika91n]=  Cast([ika91n] as int)
      ,[ika1]=  Cast([ika1] as int)
      ,[ika1n]=  Cast([ika1n] as int)
      ,[lykk]=  Cast([lykk] as int)
      ,[lykkn]=  Cast([lykkn] as int)
      ,[jopo]=  Cast([jopo] as int)
      ,[jopon]=  Cast([jopon] as int)
      ,[kan17v]=  Cast([kan17v] as int)
      ,[muu17v]=  Cast([muu17v] as int)
      ,[op17v]=  Cast([op17v] as int)
      ,[lukoko]=  Cast([lukoko] as int)
      ,[lukokon]=  Cast([lukokon] as int)
      ,[luib]=  Cast([luib] as int)
      ,[luibn]=  Cast([luibn] as int)
      ,[reife]=  Cast([reife] as int)
      ,[reifen]=  Cast([reifen] as int)
      ,[gymn]=  Cast([gymn] as int)
      ,[gymnn]=  Cast([gymnn] as int)
      ,[lueb]=  Cast([lueb] as int)
      ,[luebn]=  Cast([luebn] as int)
      ,[lukio]=  Cast([lukio] as int)
      ,[lukion]=  Cast([lukion] as int)
      ,[opsamm]=  Cast([opsamm] as int)
      ,[opsammn]=  Cast([opsammn] as int)
      ,[muuamm]=  Cast([muuamm] as int)
      ,[muuammn]=  Cast([muuammn] as int)
      ,[amm]=  Cast([amm] as int)
      ,[ammn]=  Cast([ammn] as int)
      ,[peain]=  Cast([peain] as int)
      ,[peainn]=  Cast([peainn] as int)
      ,[luain]=  Cast([luain] as int)
      ,[luainn]=  Cast([luainn] as int)
      ,[vapsiv]=  Cast([vapsiv] as int)
      ,[vapsivn]=  Cast([vapsivn] as int)
      ,[taiop]=  Cast([taiop] as int)
      ,[taiopn]=  Cast([taiopn] as int)
      ,[muukoul]=  Cast([muukoul] as int)
      ,[muukouln]=  Cast([muukouln] as int)
      ,[muuop]=  Cast([muuop] as int)
      ,[muuopn]=  Cast([muuopn] as int)
      ,[tehoec]=  Cast([tehoec] as int)
      ,[teho16c]=  Cast([teho16c] as int)
      ,[teho79c]=  Cast([teho79c] as int)
      ,[teholc]=  Cast([teholc] as int)
      ,[tehoyc]=  Cast([tehoyc] as int)
      ,[ertuec]=  Cast([ertuec] as int)
      ,[ertu16c]=  Cast([ertu16c] as int)
      ,[ertu79c]=  Cast([ertu79c] as int)
      ,[ertulc]=  Cast([ertulc] as int)
      ,[ertuyc]=  Cast([ertuyc] as int)
      ,[eritec]=  Cast([eritec] as int)
      ,[erit16c]=  Cast([erit16c] as int)
      ,[erit79c]=  Cast([erit79c] as int)
      ,[eritlc]=  Cast([eritlc] as int)
      ,[erityc]=  Cast([erityc] as int)
      ,[inte4]=  Cast([inte4] as int)
      ,[int164]=  Cast([int164] as int)
      ,[int794]=  Cast([int794] as int)
      ,[intl4]=  Cast([intl4] as int)
      ,[inty4]=  Cast([inty4] as int)
      ,[inte3]=  Cast([inte3] as int)
      ,[int163]=  Cast([int163] as int)
      ,[int793]=  Cast([int793] as int)
      ,[intl3]=  Cast([intl3] as int)
      ,[inty3]=  Cast([inty3] as int)
      ,[inte2]=  Cast([inte2] as int)
      ,[int162]=  Cast([int162] as int)
      ,[int792]=  Cast([int792] as int)
      ,[intl2]=  Cast([intl2] as int)
      ,[inty2]=  Cast([inty2] as int)
      ,[inte1]=  Cast([inte1] as int)
      ,[int161]=  Cast([int161] as int)
      ,[int791]=  Cast([int791] as int)
      ,[intl1]=  Cast([intl1] as int)
      ,[inty1]=  Cast([inty1] as int)
      ,[inte0]=  Cast([inte0] as int)
      ,[int160]=  Cast([int160] as int)
      ,[int790]=  Cast([int790] as int)
      ,[intl0]=  Cast([intl0] as int)
      ,[inty0]=  Cast([inty0] as int)
      ,[intey]=  Cast([intey] as int)
      ,[int16y]=  Cast([int16y] as int)
      ,[int79y]=  Cast([int79y] as int)
      ,[intly]=  Cast([intly] as int)
      ,[intyy]=  Cast([intyy] as int)
      ,[yks160]=  Cast([yks160] as int)
      ,[yks790]=  Cast([yks790] as int)
      ,[yksl0]=  Cast([yksl0] as int)
      ,[yksy0]=  Cast([yksy0] as int)
      ,[yks161]=  Cast([yks161] as int)
      ,[yks791]=  Cast([yks791] as int)
      ,[yksl1]=  Cast([yksl1] as int)
      ,[yksy1]=  Cast([yksy1] as int)
      ,[yks162]=  Cast([yks162] as int)
      ,[yks792]=  Cast([yks792] as int)
      ,[yksl2]=  Cast([yksl2] as int)
      ,[yksy2]=  Cast([yksy2] as int)
      ,[yks164]=  Cast([yks164] as int)
      ,[yks794]=  Cast([yks794] as int)
      ,[yksl4]=  Cast([yksl4] as int)
      ,[yksy4]=  Cast([yksy4] as int)
      ,[yks16t]=  Cast([yks16t] as int)
      ,[yks79t]=  Cast([yks79t] as int)
      ,[ykslt]=  Cast([ykslt] as int)
      ,[yksyt]=  Cast([yksyt] as int)
      ,[yks16y]=  Cast([yks16y] as int)
      ,[yks79y]=  Cast([yks79y] as int)
      ,[yksly]=  Cast([yksly] as int)
      ,[yksyy]=  Cast([yksyy] as int)
      ,[tehoosa]=  Cast([tehoosa] as int)
      ,[ertuosa]=  Cast([ertuosa] as int)
      ,[eritosa]=  Cast([eritosa] as int)
      ,[tehotuki]=  Cast([tehotuki] as int)
      ,[ertutuki]=  Cast([ertutuki] as int)
      ,[erittuki]=  Cast([erittuki] as int)
      ,[tehoavu]=  Cast([tehoavu] as int)
      ,[ertuavu]=  Cast([ertuavu] as int)
      ,[eritavu]=  Cast([eritavu] as int)
      ,[tehomuu]=  Cast([tehomuu] as int)
      ,[ertumuu]=  Cast([ertumuu] as int)
      ,[eritmuu]=  Cast([eritmuu] as int)
      ,[alc]=  Cast([alc] as int)
      ,[ylc]=  Cast([ylc] as int)
      ,[luc]=  Cast([luc] as int)
      ,[amc]=  Cast([amc] as int)
      ,[alkieli0]=  Cast([alkieli0] as int)
      ,[alkieli1]=  Cast([alkieli1] as int)
      ,[alkieli2]=  Cast([alkieli2] as int)
      ,[alkieli3]=  Cast([alkieli3] as int)
      ,[alkieli4]=  Cast([alkieli4] as int)
      ,[alkieliy]=  Cast([alkieliy] as int)
      ,[ylkieli0]=  Cast([ylkieli0] as int)
      ,[ylkieli1]=  Cast([ylkieli1] as int)
      ,[ylkieli2]=  Cast([ylkieli2] as int)
      ,[ylkieli3]=  Cast([ylkieli3] as int)
      ,[ylkieli4]=  Cast([ylkieli4] as int)
      ,[ylkieli5]=  Cast([ylkieli5] as int)
      ,[ylkieliy]=  Cast([ylkieliy] as int)
      ,[lukieli0]=  Cast([lukieli0] as int)
      ,[lukieli1]=  Cast([lukieli1] as int)
      ,[lukieli2]=  Cast([lukieli2] as int)
      ,[lukieli3]=  Cast([lukieli3] as int)
      ,[lukieli4]=  Cast([lukieli4] as int)
      ,[lukieli5]=  Cast([lukieli5] as int)
      ,[lukieli6]=  Cast([lukieli6] as int)
      ,[lukieliy]=  Cast([lukieliy] as int)
      ,[amkieli0]=  Cast([amkieli0] as int)
      ,[amkieli1]=  Cast([amkieli1] as int)
      ,[amkieli2]=  Cast([amkieli2] as int)
      ,[amkieli3]=  Cast([amkieli3] as int)
      ,[amkieli4]=  Cast([amkieli4] as int)
      ,[amkieli5]=  Cast([amkieli5] as int)
      ,[amkieli6]=  Cast([amkieli6] as int)
      ,[amkieliy]=  Cast([amkieliy] as int)
      ,[aleny]=  Cast([aleny] as int)
      ,[alruy]=  Cast([alruy] as int)
      ,[alsuy]=  Cast([alsuy] as int)
      ,[alray]=  Cast([alray] as int)
      ,[alsay]=  Cast([alsay] as int)
      ,[alvey]=  Cast([alvey] as int)
      ,[alesy]=  Cast([alesy] as int)
      ,[ality]=  Cast([ality] as int)
      ,[alsaay]=  Cast([alsaay] as int)
      ,[almuy]=  Cast([almuy] as int)
      ,[yleny]=  Cast([yleny] as int)
      ,[ylruy]=  Cast([ylruy] as int)
      ,[ylsuy]=  Cast([ylsuy] as int)
      ,[ylray]=  Cast([ylray] as int)
      ,[ylsay]=  Cast([ylsay] as int)
      ,[ylvey]=  Cast([ylvey] as int)
      ,[ylesy]=  Cast([ylesy] as int)
      ,[ylity]=  Cast([ylity] as int)
      ,[ylsaay]=  Cast([ylsaay] as int)
      ,[yllaty]=  Cast([yllaty] as int)
      ,[ylmuy]=  Cast([ylmuy] as int)
      ,[lueny]=  Cast([lueny] as int)
      ,[luruy]=  Cast([luruy] as int)
      ,[lusuy]=  Cast([lusuy] as int)
      ,[luray]=  Cast([luray] as int)
      ,[lusay]=  Cast([lusay] as int)
      ,[luvey]=  Cast([luvey] as int)
      ,[luesy]=  Cast([luesy] as int)
      ,[luity]=  Cast([luity] as int)
      ,[lusaay]=  Cast([lusaay] as int)
      ,[lulaty]=  Cast([lulaty] as int)
      ,[lumuy]=  Cast([lumuy] as int)
      ,[ameny]=  Cast([ameny] as int)
      ,[amruy]=  Cast([amruy] as int)
      ,[amsuy]=  Cast([amsuy] as int)
      ,[amray]=  Cast([amray] as int)
      ,[amsay]=  Cast([amsay] as int)
      ,[amvey]=  Cast([amvey] as int)
      ,[amesy]=  Cast([amesy] as int)
      ,[amity]=  Cast([amity] as int)
      ,[amsaay]=  Cast([amsaay] as int)
      ,[amlaty]=  Cast([amlaty] as int)
      ,[ammuy]=  Cast([ammuy] as int)
      ,[ov1c]=  Cast([ov1c] as int)
      ,[ov2c]=  Cast([ov2c] as int)
      ,[ov3c]=  Cast([ov3c] as int)
      ,[ov4c]=  Cast([ov4c] as int)
      ,[ov5c]=  Cast([ov5c] as int)
      ,[ov6c]=  Cast([ov6c] as int)
      ,[ov16yc]=  Cast([ov16yc] as int)
      ,[ov16nc]=  Cast([ov16nc] as int)
      ,[eng1]=  Cast([eng1] as int)
      ,[ru1]=  Cast([ru1] as int)
      ,[su1]=  Cast([su1] as int)
      ,[ra1]=  Cast([ra1] as int)
      ,[sa1]=  Cast([sa1] as int)
      ,[ve1]=  Cast([ve1] as int)
      ,[es1]=  Cast([es1] as int)
      ,[it1]=  Cast([it1] as int)
      ,[saa1]=  Cast([saa1] as int)
      ,[mu1]=  Cast([mu1] as int)
      ,[eopis1]=  Cast([eopis1] as int)
      ,[eng2]=  Cast([eng2] as int)
      ,[ru2]=  Cast([ru2] as int)
      ,[su2]=  Cast([su2] as int)
      ,[ra2]=  Cast([ra2] as int)
      ,[sa2]=  Cast([sa2] as int)
      ,[ve2]=  Cast([ve2] as int)
      ,[es2]=  Cast([es2] as int)
      ,[it2]=  Cast([it2] as int)
      ,[saa2]=  Cast([saa2] as int)
      ,[mu2]=  Cast([mu2] as int)
      ,[eopis2]=  Cast([eopis2] as int)
      ,[eng3]=  Cast([eng3] as int)
      ,[ru3]=  Cast([ru3] as int)
      ,[su3]=  Cast([su3] as int)
      ,[ra3]=  Cast([ra3] as int)
      ,[sa3]=  Cast([sa3] as int)
      ,[ve3]=  Cast([ve3] as int)
      ,[es3]=  Cast([es3] as int)
      ,[it3]=  Cast([it3] as int)
      ,[saa3]=  Cast([saa3] as int)
      ,[mu3]=  Cast([mu3] as int)
      ,[eopis3]=  Cast([eopis3] as int)
      ,[eng4]=  Cast([eng4] as int)
      ,[ru4]=  Cast([ru4] as int)
      ,[su4]=  Cast([su4] as int)
      ,[ra4]=  Cast([ra4] as int)
      ,[sa4]=  Cast([sa4] as int)
      ,[ve4]=  Cast([ve4] as int)
      ,[es4]=  Cast([es4] as int)
      ,[it4]=  Cast([it4] as int)
      ,[saa4]=  Cast([saa4] as int)
      ,[mu4]=  Cast([mu4] as int)
      ,[eopis4]=  Cast([eopis4] as int)
      ,[eng5]=  Cast([eng5] as int)
      ,[ru5]=  Cast([ru5] as int)
      ,[su5]=  Cast([su5] as int)
      ,[ra5]=  Cast([ra5] as int)
      ,[sa5]=  Cast([sa5] as int)
      ,[ve5]=  Cast([ve5] as int)
      ,[es5]=  Cast([es5] as int)
      ,[it5]=  Cast([it5] as int)
      ,[saa5]=  Cast([saa5] as int)
      ,[mu5]=  Cast([mu5] as int)
      ,[eopis5]=  Cast([eopis5] as int)
      ,[eng6]=  Cast([eng6] as int)
      ,[ru6]=  Cast([ru6] as int)
      ,[su6]=  Cast([su6] as int)
      ,[ra6]=  Cast([ra6] as int)
      ,[sa6]=  Cast([sa6] as int)
      ,[ve6]=  Cast([ve6] as int)
      ,[es6]=  Cast([es6] as int)
      ,[it6]=  Cast([it6] as int)
      ,[saa6]=  Cast([saa6] as int)
      ,[mu6]=  Cast([mu6] as int)
      ,[eopis6]=  Cast([eopis6] as int)
      ,[eny]=  Cast([eny] as int)
      ,[ruy]=  Cast([ruy] as int)
      ,[suy]=  Cast([suy] as int)
      ,[ray]=  Cast([ray] as int)
      ,[say]=  Cast([say] as int)
      ,[vey]=  Cast([vey] as int)
      ,[esy]=  Cast([esy] as int)
      ,[ity]=  Cast([ity] as int)
      ,[saay]=  Cast([saay] as int)
      ,[muy]=  Cast([muy] as int)
      ,[eopisy]=  Cast([eopisy] as int)
      ,[enn]=  Cast([enn] as int)
      ,[run]=  Cast([run] as int)
      ,[sun]=  Cast([sun] as int)
      ,[ran]=  Cast([ran] as int)
      ,[san]=  Cast([san] as int)
      ,[ven]=  Cast([ven] as int)
      ,[esn]=  Cast([esn] as int)
      ,[itn]=  Cast([itn] as int)
      ,[saan]=  Cast([saan] as int)
      ,[mun]=  Cast([mun] as int)
      ,[eopisn]=  Cast([eopisn] as int)
      ,[ven1]=  Cast([ven1] as int)
      ,[vru1]=  Cast([vru1] as int)
      ,[vsu1]=  Cast([vsu1] as int)
      ,[vra1]=  Cast([vra1] as int)
      ,[vsa1]=  Cast([vsa1] as int)
      ,[vve1]=  Cast([vve1] as int)
      ,[ves1]=  Cast([ves1] as int)
      ,[vit1]=  Cast([vit1] as int)
      ,[vsaa1]=  Cast([vsaa1] as int)
      ,[vmu1]=  Cast([vmu1] as int)
      ,[vyht1]=  Cast([vyht1] as int)
      ,[ven2]=  Cast([ven2] as int)
      ,[vru2]=  Cast([vru2] as int)
      ,[vsu2]=  Cast([vsu2] as int)
      ,[vra2]=  Cast([vra2] as int)
      ,[vsa2]=  Cast([vsa2] as int)
      ,[vve2]=  Cast([vve2] as int)
      ,[ves2]=  Cast([ves2] as int)
      ,[vit2]=  Cast([vit2] as int)
      ,[vsaa2]=  Cast([vsaa2] as int)
      ,[vmu2]=  Cast([vmu2] as int)
      ,[vyht2]=  Cast([vyht2] as int)
      ,[ven3]=  Cast([ven3] as int)
      ,[vru3]=  Cast([vru3] as int)
      ,[vsu3]=  Cast([vsu3] as int)
      ,[vra3]=  Cast([vra3] as int)
      ,[vsa3]=  Cast([vsa3] as int)
      ,[vve3]=  Cast([vve3] as int)
      ,[ves3]=  Cast([ves3] as int)
      ,[vit3]=  Cast([vit3] as int)
      ,[vsaa3]=  Cast([vsaa3] as int)
      ,[vmu3]=  Cast([vmu3] as int)
      ,[vyht3]=  Cast([vyht3] as int)
      ,[ven4]=  Cast([ven4] as int)
      ,[vru4]=  Cast([vru4] as int)
      ,[vsu4]=  Cast([vsu4] as int)
      ,[vra4]=  Cast([vra4] as int)
      ,[vsa4]=  Cast([vsa4] as int)
      ,[vve4]=  Cast([vve4] as int)
      ,[ves4]=  Cast([ves4] as int)
      ,[vit4]=  Cast([vit4] as int)
      ,[vsaa4]=  Cast([vsaa4] as int)
      ,[vmu4]=  Cast([vmu4] as int)
      ,[vyht4]=  Cast([vyht4] as int)
      ,[ven5]=  Cast([ven5] as int)
      ,[vru5]=  Cast([vru5] as int)
      ,[vsu5]=  Cast([vsu5] as int)
      ,[vra5]=  Cast([vra5] as int)
      ,[vsa5]=  Cast([vsa5] as int)
      ,[vve5]=  Cast([vve5] as int)
      ,[ves5]=  Cast([ves5] as int)
      ,[vit5]=  Cast([vit5] as int)
      ,[vsaa5]=  Cast([vsaa5] as int)
      ,[vmu5]=  Cast([vmu5] as int)
      ,[vyht5]=  Cast([vyht5] as int)
      ,[ven6]=  Cast([ven6] as int)
      ,[vru6]=  Cast([vru6] as int)
      ,[vsu6]=  Cast([vsu6] as int)
      ,[vra6]=  Cast([vra6] as int)
      ,[vsa6]=  Cast([vsa6] as int)
      ,[vve6]=  Cast([vve6] as int)
      ,[ves6]=  Cast([ves6] as int)
      ,[vit6]=  Cast([vit6] as int)
      ,[vsaa6]=  Cast([vsaa6] as int)
      ,[vmu6]=  Cast([vmu6] as int)
      ,[vyht6]=  Cast([vyht6] as int)
      ,[veny]=  Cast([veny] as int)
      ,[vruy]=  Cast([vruy] as int)
      ,[vsuy]=  Cast([vsuy] as int)
      ,[vray]=  Cast([vray] as int)
      ,[vsay]=  Cast([vsay] as int)
      ,[vvey]=  Cast([vvey] as int)
      ,[vesy]=  Cast([vesy] as int)
      ,[vity]=  Cast([vity] as int)
      ,[vsaay]=  Cast([vsaay] as int)
      ,[vmuy]=  Cast([vmuy] as int)
      ,[vyht]=  Cast([vyht] as int)
      ,[venn]=  Cast([venn] as int)
      ,[vrun]=  Cast([vrun] as int)
      ,[vsun]=  Cast([vsun] as int)
      ,[vran]=  Cast([vran] as int)
      ,[vsan]=  Cast([vsan] as int)
      ,[vven]=  Cast([vven] as int)
      ,[vesn]=  Cast([vesn] as int)
      ,[vitn]=  Cast([vitn] as int)
      ,[vsaan]=  Cast([vsaan] as int)
      ,[vmun]=  Cast([vmun] as int)
      ,[vtyt]=  Cast([vtyt] as int)
      ,[ov79yc]=  Cast([ov79yc] as int)
      ,[ov79nc]=  Cast([ov79nc] as int)
      ,[yaen1]=  Cast([yaen1] as int)
      ,[yaru1]=  Cast([yaru1] as int)
      ,[yasu1]=  Cast([yasu1] as int)
      ,[yara1]=  Cast([yara1] as int)
      ,[yasa1]=  Cast([yasa1] as int)
      ,[yave1]=  Cast([yave1] as int)
      ,[yaes1]=  Cast([yaes1] as int)
      ,[yait1]=  Cast([yait1] as int)
      ,[yasaa1]=  Cast([yasaa1] as int)
      ,[yalat1]=  Cast([yalat1] as int)
      ,[yamuu1]=  Cast([yamuu1] as int)
      ,[yaen2]=  Cast([yaen2] as int)
      ,[yaru2]=  Cast([yaru2] as int)
      ,[yasu2]=  Cast([yasu2] as int)
      ,[yara2]=  Cast([yara2] as int)
      ,[yasa2]=  Cast([yasa2] as int)
      ,[yave2]=  Cast([yave2] as int)
      ,[yaes2]=  Cast([yaes2] as int)
      ,[yait2]=  Cast([yait2] as int)
      ,[yasaa2]=  Cast([yasaa2] as int)
      ,[yalat2]=  Cast([yalat2] as int)
      ,[yamuu2]=  Cast([yamuu2] as int)
      ,[yyen]=  Cast([yyen] as int)
      ,[yyru]=  Cast([yyru] as int)
      ,[yysu]=  Cast([yysu] as int)
      ,[yyra]=  Cast([yyra] as int)
      ,[yysa]=  Cast([yysa] as int)
      ,[yen]=  Cast([yen] as int)
      ,[yru]=  Cast([yru] as int)
      ,[ysu]=  Cast([ysu] as int)
      ,[yra]=  Cast([yra] as int)
      ,[ysa]=  Cast([ysa] as int)
      ,[yve]=  Cast([yve] as int)
      ,[yes]=  Cast([yes] as int)
      ,[yit]=  Cast([yit] as int)
      ,[ysaa]=  Cast([ysaa] as int)
      ,[ylat]=  Cast([ylat] as int)
      ,[ymuu]=  Cast([ymuu] as int)
      ,[enyy]=  Cast([enyy] as int)
      ,[ruyy]=  Cast([ruyy] as int)
      ,[suyy]=  Cast([suyy] as int)
      ,[rayy]=  Cast([rayy] as int)
      ,[sayy]=  Cast([sayy] as int)
      ,[veyy]=  Cast([veyy] as int)
      ,[esyy]=  Cast([esyy] as int)
      ,[ityy]=  Cast([ityy] as int)
      ,[saayy]=  Cast([saayy] as int)
      ,[layy]=  Cast([layy] as int)
      ,[muyy]=  Cast([muyy] as int)
      ,[yaen1n]=  Cast([yaen1n] as int)
      ,[yaru1n]=  Cast([yaru1n] as int)
      ,[yasu1n]=  Cast([yasu1n] as int)
      ,[yara1n]=  Cast([yara1n] as int)
      ,[yasa1n]=  Cast([yasa1n] as int)
      ,[yave1n]=  Cast([yave1n] as int)
      ,[yaes1n]=  Cast([yaes1n] as int)
      ,[yait1n]=  Cast([yait1n] as int)
      ,[yasaa1n]=  Cast([yasaa1n] as int)
      ,[yalat1n]=  Cast([yalat1n] as int)
      ,[yamuu1n]=  Cast([yamuu1n] as int)
      ,[yaen2n]=  Cast([yaen2n] as int)
      ,[yaru2n]=  Cast([yaru2n] as int)
      ,[yasu2n]=  Cast([yasu2n] as int)
      ,[yara2n]=  Cast([yara2n] as int)
      ,[yasa2n]=  Cast([yasa2n] as int)
      ,[yave2n]=  Cast([yave2n] as int)
      ,[yaes2n]=  Cast([yaes2n] as int)
      ,[yait2n]=  Cast([yait2n] as int)
      ,[yasaa2n]=  Cast([yasaa2n] as int)
      ,[yalat2n]=  Cast([yalat2n] as int)
      ,[yamuu2n]=  Cast([yamuu2n] as int)
      ,[yyenn]=  Cast([yyenn] as int)
      ,[yyrun]=  Cast([yyrun] as int)
      ,[yysun]=  Cast([yysun] as int)
      ,[yyran]=  Cast([yyran] as int)
      ,[yysan]=  Cast([yysan] as int)
      ,[yenn]=  Cast([yenn] as int)
      ,[yrun]=  Cast([yrun] as int)
      ,[ysun]=  Cast([ysun] as int)
      ,[yran]=  Cast([yran] as int)
      ,[ysan]=  Cast([ysan] as int)
      ,[yven]=  Cast([yven] as int)
      ,[yesn]=  Cast([yesn] as int)
      ,[yitn]=  Cast([yitn] as int)
      ,[ysaan]=  Cast([ysaan] as int)
      ,[ylatn]=  Cast([ylatn] as int)
      ,[ymuun]=  Cast([ymuun] as int)
      ,[ennn]=  Cast([ennn] as int)
      ,[runn]=  Cast([runn] as int)
      ,[sunn]=  Cast([sunn] as int)
      ,[rann]=  Cast([rann] as int)
      ,[sann]=  Cast([sann] as int)
      ,[vennn]=  Cast([vennn] as int)
      ,[esnn]=  Cast([esnn] as int)
      ,[itnn]=  Cast([itnn] as int)
      ,[saann]=  Cast([saann] as int)
      ,[lann]=  Cast([lann] as int)
      ,[munn]=  Cast([munn] as int)
      ,[asv]=  Cast([asv] as int)
      ,[arv]=  Cast([arv] as int)
      ,[asvrv]=  Cast([asvrv] as int)
      ,[ysv]=  Cast([ysv] as int)
      ,[yrv]=  Cast([yrv] as int)
      ,[ysvrv]=  Cast([ysvrv] as int)
      ,[sv]=  Cast([sv] as int)
      ,[rv]=  Cast([rv] as int)
      ,[svrv]=  Cast([svrv] as int)
      ,[aev]=  Cast([aev] as int)
      ,[aort]=  Cast([aort] as int)
      ,[aisl]=  Cast([aisl] as int)
      ,[amu]=  Cast([amu] as int)
      ,[aet]=  Cast([aet] as int)
      ,[aeos]=  Cast([aeos] as int)
      ,[akay]=  Cast([akay] as int)
      ,[yev]=  Cast([yev] as int)
      ,[yort]=  Cast([yort] as int)
      ,[yisl]=  Cast([yisl] as int)
      ,[ymu]=  Cast([ymu] as int)
      ,[yet]=  Cast([yet] as int)
      ,[yeos]=  Cast([yeos] as int)
      ,[ykay]=  Cast([ykay] as int)
      ,[ev]=  Cast([ev] as int)
      ,[ort]=  Cast([ort] as int)
      ,[isl]=  Cast([isl] as int)
      ,[mu]=  Cast([mu] as int)
      ,[et]=  Cast([et] as int)
      ,[eos]=  Cast([eos] as int)
      ,[kay]=  Cast([kay] as int)
      ,[ov89yc]=  Cast([ov89yc] as int)
      ,[ov89nc]=  Cast([ov89nc] as int)
      ,[ai]=  Cast([ai] as int)
      ,[rsb]=  Cast([rsb] as int)
      ,[ma]=  Cast([ma] as int)
      ,[yl]=  Cast([yl] as int)
      ,[bi]=  Cast([bi] as int)
      ,[ge]=  Cast([ge] as int)
      ,[fy]=  Cast([fy] as int)
      ,[ke]=  Cast([ke] as int)
      ,[ter]=  Cast([ter] as int)
      ,[ue]=  Cast([ue] as int)
      ,[eti]=  Cast([eti] as int)
      ,[hi]=  Cast([hi] as int)
      ,[yh]=  Cast([yh] as int)
      ,[mus]=  Cast([mus] as int)
      ,[ku]=  Cast([ku] as int)
      ,[tt]=  Cast([tt] as int)
      ,[ts]=  Cast([ts] as int)
      ,[li]=  Cast([li] as int)
      ,[ko]=  Cast([ko] as int)
      ,[yhd]=  Cast([yhd] as int)
      ,[ain]=  Cast([ain] as int)
      ,[rsbn]=  Cast([rsbn] as int)
      ,[man]=  Cast([man] as int)
      ,[yln]=  Cast([yln] as int)
      ,[bin]=  Cast([bin] as int)
      ,[gen]=  Cast([gen] as int)
      ,[fyn]=  Cast([fyn] as int)
      ,[ken]=  Cast([ken] as int)
      ,[tern]=  Cast([tern] as int)
      ,[uen]=  Cast([uen] as int)
      ,[etin]=  Cast([etin] as int)
      ,[hin]=  Cast([hin] as int)
      ,[yhn]=  Cast([yhn] as int)
      ,[musn]=  Cast([musn] as int)
      ,[kun]=  Cast([kun] as int)
      ,[ttn]=  Cast([ttn] as int)
      ,[tsn]=  Cast([tsn] as int)
      ,[lin]=  Cast([lin] as int)
      ,[kon]=  Cast([kon] as int)
      ,[yhdn]=  Cast([yhdn] as int)
      ,[tietop]=  Cast([tietop] as int)
      ,[tietok]=  Cast([tietok] as int)
      ,[tietoi]=  Cast([tietoi] as int)
      ,[verkko]=  Cast([verkko] as int)

      ,[kaytto] = CAST([kaytto] as nchar(1))
      ,[tietolahde]
      ,[rivinumero]
  FROM (

--Historia-aineisto 8.3
--Historia-aineistossa 7-9 luokkien A1 ja A2 kielivalinnat on summattu, tässä näkymässä ne merkitään A1-kieliksi
    SELECT [tilv]
      ,[jarj] = null
      ,[tiedtype] = null
      ,[tunn]
      ,[edesi] = null
      ,[edala] = null
      ,[edyla] = null
      ,[edlisa] = null
      ,[edainep] = null
      ,[syesi] = null
      ,[syala] = null
      ,[syyla] = null
      ,[sylisa] = null
      ,[symamu] = null
      ,[sylukio] = null
      ,[syamm] = null
      ,[symuu] = null
      ,[keve] = null
      ,[keven] = null
      ,[kev1]
      ,[kev1n]
      ,[kev2]
      ,[kev2n]
      ,[kev3]
      ,[kev3n]
      ,[kev4]
      ,[kev4n]
      ,[kev5]
      ,[kev5n]
      ,[kev6]
      ,[kev6n]
      ,[kev7]
      ,[kev7n]
      ,[kev8]
      ,[kev8n]
      ,[kev9]
      ,[kev9n]
      ,[kev10] = null
      ,[kev10n] = null
      ,[kev] = null
      ,[kevn] = null
      ,[luok1]
      ,[luok1n]
      ,[luok2]
      ,[luok2n]
      ,[luok3]
      ,[luok3n]
      ,[luok4]
      ,[luok4n]
      ,[luok5]
      ,[luok5n]
      ,[luok6]
      ,[luok6n]
      ,[luok7]
      ,[luok7n]
      ,[luok8]
      ,[luok8n]
      ,[luok9]
      ,[luok9n]
      ,[luok]
      ,[luokn]
      ,[kelaim] = null
      ,[kelaimn] = null
      ,[tod]
      ,[todn]
      ,[tutkt]
      ,[tutktn]
      ,[suor10]
      ,[suor10n]
      ,[oeriy] = null
      ,[oeriyn] = null
      ,[ilmtod] = null --eitod?
      ,[ilmtodn] = null --eitodn?
      ,[aku] = null
      ,[mamukurs] = null
      ,[oppkurs] = null
      ,[muukurs] = null
      ,[akukurs] = null
      ,[kmamu] = null
      ,[kmamun] = null
      ,[syulkom] = null
      ,[syulkomn] = null
      ,[sykoti] = null
      ,[sykotin] = null
      ,[ika4e] = null
      ,[ika4en] = null
      ,[ika5e] = null
      ,[ika5en] = null
      ,[pid5v] = null
      ,[ika6e] = null
      ,[ika6en] = null
      ,[ika7e] = null
      ,[ika7en] = null
      ,[ikae] = null
      ,[ikaen] = null
      ,[ove]
      ,[ov1]
      ,[ov2]
      ,[ov3]
      ,[ov4]
      ,[ov5]
      ,[ov6]
      ,[ov7]
      ,[ov8]
      ,[ov9]
      ,[ov10]
      ,[ovy]
      ,[tehoe] = null
      ,[teho1] = null
      ,[teho2] = null
      ,[teho3] = null
      ,[teho4] = null
      ,[teho5] = null
      ,[teho6] = null
      ,[teho7] = null
      ,[teho8] = null
      ,[teho9] = null
      ,[teho10] = null
      ,[tehoy] = null
      ,[eipide] = null
      ,[eipid1] = null
      ,[eipid2] = null
      ,[eipid3] = null
      ,[eipid4] = null
      ,[eipid5] = null
      ,[eipid6] = null
      ,[eipid7] = null
      ,[eipid8] = null
      ,[eipid9] = null
      ,[eipid10] = null
      ,[eipidy] = null
      ,[ertuve] = null
      ,[ertuv1] = null
      ,[ertuv2] = null
      ,[ertuv3] = null
      ,[ertuv4] = null
      ,[ertuv5] = null
      ,[ertuv6] = null
      ,[ertuv7] = null
      ,[ertuv8] = null
      ,[ertuv9] = null
      ,[ertuv10] = null
      ,[ertuvy] = null
      ,[ertume] = null
      ,[ertum1] = null
      ,[ertum2] = null
      ,[ertum3] = null
      ,[ertum4] = null
      ,[ertum5] = null
      ,[ertum6] = null
      ,[ertum7] = null
      ,[ertum8] = null
      ,[ertum9] = null
      ,[ertum10] = null
      ,[ertumy] = null 
      ,[tavove] = null
      ,[tavov1] = null
      ,[tavov2] = null
      ,[tavov3] = null
      ,[tavov4] = null
      ,[tavov5] = null
      ,[tavov6] = null
      ,[tavov7] = null
      ,[tavov8] = null
      ,[tavov9] = null
      ,[tavov10] = null
      ,[tavovy] = null
      ,[oven]
      ,[ov1n]
      ,[ov2n]
      ,[ov3n]
      ,[ov4n]
      ,[ov5n]
      ,[ov6n]
      ,[ov7n]
      ,[ov8n]
      ,[ov9n]
      ,[ov10n]
      ,[ovyn]
      ,[tehoen] = null
      ,[teho1n] = null
      ,[teho2n] = null
      ,[teho3n] = null
      ,[teho4n] = null
      ,[teho5n] = null
      ,[teho6n] = null
      ,[teho7n] = null
      ,[teho8n] = null
      ,[teho9n] = null
      ,[teho10n] = null
      ,[tehoyn] = null
      ,[eipiden] = null
      ,[eipid1n] = null
      ,[eipid2n] = null
      ,[eipid3n] = null
      ,[eipid4n] = null
      ,[eipid5n] = null
      ,[eipid6n] = null
      ,[eipid7n] = null
      ,[eipid8n] = null
      ,[eipid9n] = null
      ,[eipid10n] = null
      ,[eipidyn] = null
      ,[ertuven] = null
      ,[ertuv1n] = null
      ,[ertuv2n] = null
      ,[ertuv3n] = null
      ,[ertuv4n] = null
      ,[ertuv5n] = null
      ,[ertuv6n] = null
      ,[ertuv7n] = null
      ,[ertuv8n] = null
      ,[ertuv9n] = null
      ,[ertuv10n] = null
      ,[ertuvyn] = null
      ,[ertumen] = null
      ,[ertum1n] = null
      ,[ertum2n] = null
      ,[ertum3n] = null
      ,[ertum4n] = null
      ,[ertum5n] = null
      ,[ertum6n] = null
      ,[ertum7n] = null
      ,[ertum8n] = null
      ,[ertum9n] = null
      ,[ertum10n] = null
      ,[ertumyn] = null
      ,[tavoven] = null
      ,[tavov1n] = null
      ,[tavov2n] = null
      ,[tavov3n] = null
      ,[tavov4n] = null
      ,[tavov5n] = null
      ,[tavov6n] = null
      ,[tavov7n] = null
      ,[tavov8n] = null
      ,[tavov9n] = null
      ,[tavov10n] = null
      ,[tavovyn] = null
      ,[eipidec] = null
      ,[eipidpc] = null
      ,[eipidlc] = null
      ,[eipidyc] = null
      ,[ertuvec] = null
      ,[ertuvpc] = null
      ,[ertuvlc] = null
      ,[ertuvyc] = null
      ,[ertumec] = null
      ,[ertumpc] = null
      ,[ertumlc] = null
      ,[ertumyc] = null
      ,[muuec] = null
      ,[muupc] = null
      ,[muulc] = null
      ,[muuyc] = null
      ,[ovec] = null
      ,[ovpc] = null
      ,[ovlc] = null
      ,[ovyc] = null
      ,[sisae] = null
      ,[sisap] = null
      ,[sisal] = null
      ,[sisam] = null
      ,[sisay] = null
      ,[maeipide] = null
      ,[maeipidp] = null
      ,[maeipidl] = null
      ,[maeipidy] = null
      ,[maertuve] = null
      ,[maertuvp] = null
      ,[maertuvl] = null
      ,[maertuvy] = null
      ,[maertume] = null
      ,[maertump] = null
      ,[maertuml] = null
      ,[maertumy] = null
      ,[mamuue] = null
      ,[mamuup] = null
      ,[mamuul] = null
      ,[mamuuy] = null
      ,[maove] = null
      ,[maovp] = null
      ,[maovl] = null
      ,[maovy] = null
      ,[kueipide] = null
      ,[kueipidp] = null
      ,[kueipidl] = null
      ,[kueipidy] = null
      ,[kuertuve] = null
      ,[kuertuvp] = null
      ,[kuertuvl] = null
      ,[kuertuvy] = null
      ,[kuertume] = null
      ,[kuertump] = null
      ,[kuertuml] = null
      ,[kuertumy] = null
      ,[kumuue] = null
      ,[kumuup] = null
      ,[kumuul] = null
      ,[kumuuy] = null
      ,[kuove] = null
      ,[kuovp] = null
      ,[kuovl] = null
      ,[kuovy] = null
      ,[vieipide] = null
      ,[vieipidp] = null
      ,[vieipidl] = null
      ,[vieipidy] = null
      ,[viertuve] = null
      ,[viertuvp] = null
      ,[viertuvl] = null
      ,[viertuvy] = null
      ,[viertume] = null
      ,[viertump] = null
      ,[viertuml] = null
      ,[viertumy] = null
      ,[vimuue] = null
      ,[vimuup] = null
      ,[vimuul] = null
      ,[vimuuy] = null
      ,[viove] = null
      ,[viovp] = null
      ,[viovl] = null
      ,[viovy] = null
      ,[ika61] = null
      ,[ika61n] = null
      ,[ika71] = null
      ,[ika71n] = null
      ,[ika81] = null
      ,[ika81n] = null
      ,[ika91] = null
      ,[ika91n] = null
      ,[ika1] = null
      ,[ika1n] = null
      ,[lykk]
      ,[lykkn]
      ,[jopo] = null
      ,[jopon] = null
      ,[kan17v] = null
      ,[muu17v] = null
      ,[op17v] = null
      ,[lukoko] = null
      ,[lukokon] = null
      ,[luib] = null
      ,[luibn] = null
      ,[reife] = null
      ,[reifen] = null
      ,[gymn] = null
      ,[gymnn] = null
      ,[lueb] = null
      ,[luebn] = null
      ,[lukio] = null
      ,[lukion] = null
      ,[opsamm] = null
      ,[opsammn] = null
      ,[muuamm] = null
      ,[muuammn] = null
      ,[amm] = null
      ,[ammn] = null
      ,[peain] = null
      ,[peainn] = null
      ,[luain] = null
      ,[luainn] = null
      ,[vapsiv] = null
      ,[vapsivn] = null
      ,[taiop] = null
      ,[taiopn] = null
      ,[muukoul] = null
      ,[muukouln] = null
      ,[muuop] = null
      ,[muuopn] = null
      ,[tehoec] = null
      ,[teho16c] = null
      ,[teho79c] = null
      ,[teholc] = null
      ,[tehoyc] = null
      ,[ertuec] = null
      ,[ertu16c] = null
      ,[ertu79c] = null
      ,[ertulc] = null
      ,[ertuyc] = null
      ,[eritec] = null
      ,[erit16c] = null
      ,[erit79c] = null
      ,[eritlc] = null
      ,[erityc] = null
      ,[inte4] = null
      ,[int164] = null
      ,[int794] = null
      ,[intl4] = null
      ,[inty4] = null
      ,[inte3] = null
      ,[int163] = null
      ,[int793] = null
      ,[intl3] = null
      ,[inty3] = null
      ,[inte2] = null
      ,[int162] = null
      ,[int792] = null
      ,[intl2] = null
      ,[inty2] = null
      ,[inte1] = null
      ,[int161] = null
      ,[int791] = null
      ,[intl1] = null
      ,[inty1] = null
      ,[inte0] = null
      ,[int160] = null
      ,[int790] = null
      ,[intl0] = null
      ,[inty0] = null
      ,[intey] = null
      ,[int16y] = null
      ,[int79y] = null
      ,[intly] = null
      ,[intyy] = null
      ,[yks160] = null
      ,[yks790] = null
      ,[yksl0] = null
      ,[yksy0] = null
      ,[yks161] = null
      ,[yks791] = null
      ,[yksl1] = null
      ,[yksy1] = null
      ,[yks162] = null
      ,[yks792] = null
      ,[yksl2] = null
      ,[yksy2] = null
      ,[yks164] = null
      ,[yks794] = null
      ,[yksl4] = null
      ,[yksy4] = null
      ,[yks16t] = null
      ,[yks79t] = null
      ,[ykslt] = null
      ,[yksyt] = null
      ,[yks16y] = null
      ,[yks79y] = null
      ,[yksly] = null
      ,[yksyy] = null
      ,[tehoosa] = null
      ,[ertuosa] = null
      ,[eritosa] = null
      ,[tehotuki] = null
      ,[ertutuki] = null
      ,[erittuki] = null
      ,[tehoavu] = null
      ,[ertuavu] = null
      ,[eritavu] = null
      ,[tehomuu] = null
      ,[ertumuu] = null
      ,[eritmuu] = null
      ,[alc] = null
      ,[ylc] = null
      ,[luc] = null
      ,[amc] = null
      ,[alkieli0] = null
      ,[alkieli1] = null
      ,[alkieli2] = null
      ,[alkieli3] = null
      ,[alkieli4] = null
      ,[alkieliy] = null
      ,[ylkieli0] = null
      ,[ylkieli1] = null
      ,[ylkieli2] = null
      ,[ylkieli3] = null
      ,[ylkieli4] = null
      ,[ylkieli5] = null
      ,[ylkieliy] = null
      ,[lukieli0] = null
      ,[lukieli1] = null
      ,[lukieli2] = null
      ,[lukieli3] = null
      ,[lukieli4] = null
      ,[lukieli5] = null
      ,[lukieli6] = null
      ,[lukieliy] = null
      ,[amkieli0] = null
      ,[amkieli1] = null
      ,[amkieli2] = null
      ,[amkieli3] = null
      ,[amkieli4] = null
      ,[amkieli5] = null
      ,[amkieli6] = null
      ,[amkieliy] = null
      ,[aleny] = null
      ,[alruy] = null
      ,[alsuy] = null
      ,[alray] = null
      ,[alsay] = null
      ,[alvey] = null
      ,[alesy] = null
      ,[ality] = null
      ,[alsaay] = null
      ,[almuy] = null
      ,[yleny] = null
      ,[ylruy] = null
      ,[ylsuy] = null
      ,[ylray] = null
      ,[ylsay] = null
      ,[ylvey] = null
      ,[ylesy] = null
      ,[ylity] = null
      ,[ylsaay] = null
      ,[yllaty] = null
      ,[ylmuy] = null
      ,[lueny] = null
      ,[luruy] = null
      ,[lusuy] = null
      ,[luray] = null
      ,[lusay] = null
      ,[luvey] = null
      ,[luesy] = null
      ,[luity] = null
      ,[lusaay] = null
      ,[lulaty] = null
      ,[lumuy] = null
      ,[ameny] = null
      ,[amruy] = null
      ,[amsuy] = null
      ,[amray] = null
      ,[amsay] = null
      ,[amvey] = null
      ,[amesy] = null
      ,[amity] = null
      ,[amsaay] = null
      ,[amlaty] = null
      ,[ammuy] = null
      ,[ov1c] = null
      ,[ov2c] = null
      ,[ov3c] = null
      ,[ov4c] = null
      ,[ov5c] = null
      ,[ov6c] = null
      ,[ov16yc] = null
      ,[ov16nc] = null
      ,[eng1]
      ,[ru1]
      ,[su1]
      ,[ra1]
      ,[sa1]
      ,[ve1]
      ,[es1] = null
      ,[it1] = null
      ,[saa1]
      ,[mu1]
      ,[eopis1] = null
      ,[eng2]
      ,[ru2]
      ,[su2]
      ,[ra2]
      ,[sa2]
      ,[ve2]
      ,[es2] = null
      ,[it2] = null
      ,[saa2]
      ,[mu2]
      ,[eopis2] = null
      ,[eng3]
      ,[ru3]
      ,[su3]
      ,[ra3]
      ,[sa3]
      ,[ve3]
      ,[es3] = null
      ,[it3] = null
      ,[saa3]
      ,[mu3]
      ,[eopis3] = null
      ,[eng4]
      ,[ru4]
      ,[su4]
      ,[ra4]
      ,[sa4]
      ,[ve4]
      ,[es4] = null
      ,[it4] = null
      ,[saa4]
      ,[mu4]
      ,[eopis4] = null
      ,[eng5]
      ,[ru5]
      ,[su5]
      ,[ra5]
      ,[sa5]
      ,[ve5]
      ,[es5] = null
      ,[it5] = null
      ,[saa5]
      ,[mu5]
      ,[eopis5] = null
      ,[eng6]
      ,[ru6]
      ,[su6]
      ,[ra6]
      ,[sa6]
      ,[ve6]
      ,[es6] = null
      ,[it6] = null
      ,[saa6]
      ,[mu6]
      ,[eopis6] = null
      ,[eny]
      ,[ruy]
      ,[suy]
      ,[ray]
      ,[say]
      ,[vey]
      ,[esy] = null
      ,[ity] = null
      ,[saay]
      ,[muy]
      ,[eopisy] = null
      ,[enn]
      ,[run]
      ,[sun]
      ,[ran]
      ,[san]
      ,[ven]
      ,[esn] = null
      ,[itn] = null
      ,[saan]
      ,[mun]
      ,[eopisn] = null
      ,[ven1]
      ,[vru1]
      ,[vsu1]
      ,[vra1]
      ,[vsa1]
      ,[vve1]
      ,[ves1] = null
      ,[vit1] = null
      ,[vsaa1]
      ,[vmu1]
      ,[vyht1]
      ,[ven2]
      ,[vru2]
      ,[vsu2]
      ,[vra2]
      ,[vsa2]
      ,[vve2]
      ,[ves2] = null
      ,[vit2] = null
      ,[vsaa2]
      ,[vmu2]
      ,[vyht2]
      ,[ven3]
      ,[vru3]
      ,[vsu3]
      ,[vra3]
      ,[vsa3]
      ,[vve3]
      ,[ves3] = null
      ,[vit3] = null
      ,[vsaa3]
      ,[vmu3]
      ,[vyht3]
      ,[ven4]
      ,[vru4]
      ,[vsu4]
      ,[vra4]
      ,[vsa4]
      ,[vve4]
      ,[ves4] = null
      ,[vit4] = null
      ,[vsaa4]
      ,[vmu4]
      ,[vyht4]
      ,[ven5]
      ,[vru5]
      ,[vsu5]
      ,[vra5]
      ,[vsa5]
      ,[vve5]
      ,[ves5] = null
      ,[vit5] = null
      ,[vsaa5]
      ,[vmu5]
      ,[vyht5]
      ,[ven6]
      ,[vru6]
      ,[vsu6]
      ,[vra6]
      ,[vsa6]
      ,[vve6]
      ,[ves6] = null
      ,[vit6] = null
      ,[vsaa6]
      ,[vmu6]
      ,[vyht6]
      ,[veny]
      ,[vruy]
      ,[vsuy]
      ,[vray]
      ,[vsay]
      ,[vvey]
      ,[vesy] = null
      ,[vity] = null
      ,[vsaay]
      ,[vmuy]
      ,[vyht]
      ,[venn]
      ,[vrun]
      ,[vsun]
      ,[vran]
      ,[vsan]
      ,[vven]
      ,[vesn] = null
      ,[vitn] = null
      ,[vsaan]
      ,[vmun]
      ,[vtyt]
      ,[ov79yc] = null
      ,[ov79nc] = null
      ,[yaen1] = yaen
      ,[yaru1] = yaru
      ,[yasu1] = yasu
      ,[yara1] = yara
      ,[yasa1] = yasa
      ,[yave1] = yave
      ,[yaes1] = null
      ,[yait1] = null
      ,[yasaa1] = yasaa
      ,[yalat1] = yalat
      ,[yamuu1] = yamu
      ,[yaen2] = null
      ,[yaru2] = null
      ,[yasu2] = null
      ,[yara2] = null
      ,[yasa2] = null
      ,[yave2] = null
      ,[yaes2] = null
      ,[yait2] = null
      ,[yasaa2] = null
      ,[yalat2] = null
      ,[yamuu2] = null
      ,[yyen]
      ,[yyru]
      ,[yysu]
      ,[yyra]
      ,[yysa]
      ,[yen]
      ,[yru]
      ,[ysu]
      ,[yra]
      ,[ysa]
      ,[yve]
      ,[yes] = null
      ,[yit] = null
      ,[ysaa]
      ,[ylat]
      ,[ymuu]
      ,[enyy]
      ,[ruyy]
      ,[suyy]
      ,[rayy]
      ,[sayy]
      ,[veyy]
      ,[esyy] = null
      ,[ityy] = null
      ,[saayy]
      ,[layy]
      ,[muyy]
      ,[yaen1n] = yaenn
      ,[yaru1n] = yarun
      ,[yasu1n] = yasun
      ,[yara1n] = yaran
      ,[yasa1n] = yasan
      ,[yave1n] = yaven
      ,[yaes1n] = null
      ,[yait1n] = null
      ,[yasaa1n] = yasaan
      ,[yalat1n] = yalatn
      ,[yamuu1n] = yamun
      ,[yaen2n] = null
      ,[yaru2n] = null
      ,[yasu2n] = null
      ,[yara2n] = null
      ,[yasa2n] = null
      ,[yave2n] = null
      ,[yaes2n] = null
      ,[yait2n] = null
      ,[yasaa2n] = null
      ,[yalat2n] = null
      ,[yamuu2n] = null
      ,[yyenn]
      ,[yyrun]
      ,[yysun]
      ,[yyran]
      ,[yysan]
      ,[yenn]
      ,[yrun]
      ,[ysun]
      ,[yran]
      ,[ysan]
      ,[yven]
      ,[yesn] = null
      ,[yitn] = null
      ,[ysaan]
      ,[ylatn]
      ,[ymuun]
      ,[ennn]
      ,[runn]
      ,[sunn]
      ,[rann]
      ,[sann]
      ,[vennn]
      ,[esnn] = null
      ,[itnn] = null
      ,[saann]
      ,[lann]
      ,[munn]
      ,[asv] = null
      ,[arv] = null
      ,[asvrv] = null
      ,[ysv] = null
      ,[yrv] = null
      ,[ysvrv] = null
      ,[sv] = null
      ,[rv] = null
      ,[svrv] = null
      ,[aev] = null
      ,[aort] = null
      ,[aisl] = null
      ,[amu] = null
      ,[aet] = null
      ,[aeos] = null
      ,[akay] = null
      ,[yev] = null
      ,[yort] = null
      ,[yisl] = null
      ,[ymu] = null
      ,[yet] = null
      ,[yeos] = null
      ,[ykay] = null
      ,[ev] = null
      ,[ort] = null
      ,[isl] = null
      ,[mu] = null
      ,[et] = null
      ,[eos] = null
      ,[kay] = null
      ,[ov89yc] = null
      ,[ov89nc] = null
      ,[ai] = null
      ,[rsb] = null
      ,[ma] = null--ma14m+ma14n+ma12m+ma12n+ma1m+ma1n+ma2m+ma2n+ma3m+ma3n
      ,[yl] = null
      ,[bi] = null--bi14m+bi14n+bi12m+bi12n+bi1m+bi1n+bi2m+bi2n+bi3m+bi3n
      ,[ge] = null--mt14m+mt14n+mt12m+mt12n+mt1m+mt1n+mt2m+mt2n+mt3m+mt3n
      ,[fy] = null--fy14m+fy14n+fy12m+fy12n+fy1m+fy1n+fy2m+fy2n+fy3m+fy3n
      ,[ke] = null--ke14m+ke14n+ke12m+ke12n+ke1m+ke1n+ke2m+ke2n+ke3m+ke3n
      ,[ter] = null
      ,[ue] = null
      ,[eti] = null
      ,[hi] = null
      ,[yh] = null
      ,[mus] = null
      ,[ku] = null
      ,[tt] = null--tt14m+tt14n+tt12m+tt12n+tt1m+tt1n+tt2m+tt2n+tt3m+tt3n
      ,[ts] = null--ts14m+ts14n+ts12m+ts12n+ts1m+ts1n+ts2m+ts2n+ts3m+ts3n
      ,[li] = null
      ,[ko] = null
      ,[yhd] = null
      ,[ain] = null
      ,[rsbn] = null
      ,[man] = null--ma14n+ma12n+ma1n+ma2n+ma3n
      ,[yln] = null
      ,[bin] = null--bi14n+bi12n+bi1n+bi2n+bi3n
      ,[gen] = null--mt14n+mt12n+mt1n+mt2n+mt3n
      ,[fyn] = null--fy14n+fy12n+fy1n+fy2n+fy3n
      ,[ken] = null--ke14n+ke12n+ke1n+ke2n+ke3n
      ,[tern] = null
      ,[uen] = null
      ,[etin] = null
      ,[hin] = null
      ,[yhn] = null
      ,[musn] = null
      ,[kun] = null
      ,[ttn] = null--tt14n+tt12n+tt1n+tt2n+tt3n
      ,[tsn] = null--ts14n+ts12n+ts1n+ts2n+ts3n
      ,[lin] = null
      ,[kon] = null
      ,[yhdn] = null
      ,[tietop] = null
      ,[tietok] = null
      ,[tietoi] = null
      ,[verkko] = null
      ,[kaytto] = null
      ,[tietolahde]=''R2.22_sopv_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_8_3_sopv_16]


UNION ALL

  SELECT [tilv]
      ,[jarj]
      ,[tiedtype]
      ,[tunn]
      ,[edesi]
      ,[edala]
      ,[edyla]
      ,[edlisa]
      ,[edainep]
      ,[syesi]
      ,[syala]
      ,[syyla]
      ,[sylisa]
      ,[symamu]
      ,[sylukio]
      ,[syamm]
      ,[symuu]
      ,[keve]
      ,[keven]
      ,[kev1]
      ,[kev1n]
      ,[kev2]
      ,[kev2n]
      ,[kev3]
      ,[kev3n]
      ,[kev4]
      ,[kev4n]
      ,[kev5]
      ,[kev5n]
      ,[kev6]
      ,[kev6n]
      ,[kev7]
      ,[kev7n]
      ,[kev8]
      ,[kev8n]
      ,[kev9]
      ,[kev9n]
      ,[kev10]
      ,[kev10n]
      ,[kev]
      ,[kevn]
      ,[luok1]
      ,[luok1n]
      ,[luok2]
      ,[luok2n]
      ,[luok3]
      ,[luok3n]
      ,[luok4]
      ,[luok4n]
      ,[luok5]
      ,[luok5n]
      ,[luok6]
      ,[luok6n]
      ,[luok7]
      ,[luok7n]
      ,[luok8]
      ,[luok8n]
      ,[luok9]
      ,[luok9n]
      ,[luok]
      ,[luokn]
      ,[kelaim]
      ,[kelaimn]
      ,[tod]
      ,[todn]
      ,[tutkt]
      ,[tutktn]
      ,[suor10]
      ,[suor10n]
      ,[oeriy]
      ,[oeriyn]
      ,[ilmtod]
      ,[ilmtodn]
      ,[aku]
      ,[mamukurs]
      ,[oppkurs]
      ,[muukurs]
      ,[akukurs]
      ,[kmamu]
      ,[kmamun]
      ,[syulkom]
      ,[syulkomn]
      ,[sykoti]
      ,[sykotin]
      ,[ika4e]
      ,[ika4en]
      ,[ika5e]
      ,[ika5en]
      ,[pid5v]
      ,[ika6e]
      ,[ika6en]
      ,[ika7e]
      ,[ika7en]
      ,[ikae]
      ,[ikaen]
      ,[ove]
      ,[ov1]
      ,[ov2]
      ,[ov3]
      ,[ov4]
      ,[ov5]
      ,[ov6]
      ,[ov7]
      ,[ov8]
      ,[ov9]
      ,[ov10]
      ,[ovy]
      ,[tehoe]
      ,[teho1]
      ,[teho2]
      ,[teho3]
      ,[teho4]
      ,[teho5]
      ,[teho6]
      ,[teho7]
      ,[teho8]
      ,[teho9]
      ,[teho10]
      ,[tehoy]
      ,[eipide]
      ,[eipid1]
      ,[eipid2]
      ,[eipid3]
      ,[eipid4]
      ,[eipid5]
      ,[eipid6]
      ,[eipid7]
      ,[eipid8]
      ,[eipid9]
      ,[eipid10]
      ,[eipidy]
      ,[ertuve]
      ,[ertuv1]
      ,[ertuv2]
      ,[ertuv3]
      ,[ertuv4]
      ,[ertuv5]
      ,[ertuv6]
      ,[ertuv7]
      ,[ertuv8]
      ,[ertuv9]
      ,[ertuv10]
      ,[ertuvy]
      ,[ertume]
      ,[ertum1]
      ,[ertum2]
      ,[ertum3]
      ,[ertum4]
      ,[ertum5]
      ,[ertum6]
      ,[ertum7]
      ,[ertum8]
      ,[ertum9]
      ,[ertum10]
      ,[ertumy]
      ,[tavove]
      ,[tavov1]
      ,[tavov2]
      ,[tavov3]
      ,[tavov4]
      ,[tavov5]
      ,[tavov6]
      ,[tavov7]
      ,[tavov8]
      ,[tavov9]
      ,[tavov10]
      ,[tavovy]
      ,[oven]
      ,[ov1n]
      ,[ov2n]
      ,[ov3n]
      ,[ov4n]
      ,[ov5n]
      ,[ov6n]
      ,[ov7n]
      ,[ov8n]
      ,[ov9n]
      ,[ov10n]
      ,[ovyn]
      ,[tehoen]
      ,[teho1n]
      ,[teho2n]
      ,[teho3n]
      ,[teho4n]
      ,[teho5n]
      ,[teho6n]
      ,[teho7n]
      ,[teho8n]
      ,[teho9n]
      ,[teho10n]
      ,[tehoyn]
      ,[eipiden]
      ,[eipid1n]
      ,[eipid2n]
      ,[eipid3n]
      ,[eipid4n]
      ,[eipid5n]
      ,[eipid6n]
      ,[eipid7n]
      ,[eipid8n]
      ,[eipid9n]
      ,[eipid10n]
      ,[eipidyn]
      ,[ertuven]
      ,[ertuv1n]
      ,[ertuv2n]
      ,[ertuv3n]
      ,[ertuv4n]
      ,[ertuv5n]
      ,[ertuv6n]
      ,[ertuv7n]
      ,[ertuv8n]
      ,[ertuv9n]
      ,[ertuv10n]
      ,[ertuvyn]
      ,[ertumen]
      ,[ertum1n]
      ,[ertum2n]
      ,[ertum3n]
      ,[ertum4n]
      ,[ertum5n]
      ,[ertum6n]
      ,[ertum7n]
      ,[ertum8n]
      ,[ertum9n]
      ,[ertum10n]
      ,[ertumyn]
      ,[tavoven]
      ,[tavov1n]
      ,[tavov2n]
      ,[tavov3n]
      ,[tavov4n]
      ,[tavov5n]
      ,[tavov6n]
      ,[tavov7n]
      ,[tavov8n]
      ,[tavov9n]
      ,[tavov10n]
      ,[tavovyn]
      ,[eipidec]
      ,[eipidpc]
      ,[eipidlc]
      ,[eipidyc]
      ,[ertuvec]
      ,[ertuvpc]
      ,[ertuvlc]
      ,[ertuvyc]
      ,[ertumec]
      ,[ertumpc]
      ,[ertumlc]
      ,[ertumyc]
      ,[muuec]
      ,[muupc]
      ,[muulc]
      ,[muuyc]
      ,[ovec]
      ,[ovpc]
      ,[ovlc]
      ,[ovyc]
      ,[sisae]
      ,[sisap]
      ,[sisal]
      ,[sisam]
      ,[sisay]
      ,[maeipide]
      ,[maeipidp]
      ,[maeipidl]
      ,[maeipidy]
      ,[maertuve]
      ,[maertuvp]
      ,[maertuvl]
      ,[maertuvy]
      ,[maertume]
      ,[maertump]
      ,[maertuml]
      ,[maertumy]
      ,[mamuue]
      ,[mamuup]
      ,[mamuul]
      ,[mamuuy]
      ,[maove]
      ,[maovp]
      ,[maovl]
      ,[maovy]
      ,[kueipide]
      ,[kueipidp]
      ,[kueipidl]
      ,[kueipidy]
      ,[kuertuve]
      ,[kuertuvp]
      ,[kuertuvl]
      ,[kuertuvy]
      ,[kuertume]
      ,[kuertump]
      ,[kuertuml]
      ,[kuertumy]
      ,[kumuue]
      ,[kumuup]
      ,[kumuul]
      ,[kumuuy]
      ,[kuove]
      ,[kuovp]
      ,[kuovl]
      ,[kuovy]
      ,[vieipide]
      ,[vieipidp]
      ,[vieipidl]
      ,[vieipidy]
      ,[viertuve]
      ,[viertuvp]
      ,[viertuvl]
      ,[viertuvy]
      ,[viertume]
      ,[viertump]
      ,[viertuml]
      ,[viertumy]
      ,[vimuue]
      ,[vimuup]
      ,[vimuul]
      ,[vimuuy]
      ,[viove]
      ,[viovp]
      ,[viovl]
      ,[viovy]
      ,[ika61]
      ,[ika61n]
      ,[ika71]
      ,[ika71n]
      ,[ika81]
      ,[ika81n]
      ,[ika91]
      ,[ika91n]
      ,[ika1]
      ,[ika1n]
      ,[lykk]
      ,[lykkn]
      ,[jopo]
      ,[jopon]
      ,[kan17v]
      ,[muu17v]
      ,[op17v]
      ,[lukoko]
      ,[lukokon]
      ,[luib]
      ,[luibn]
      ,[reife]
      ,[reifen]
      ,[gymn]
      ,[gymnn]
      ,[lueb]
      ,[luebn]
      ,[lukio]
      ,[lukion]
      ,[opsamm]
      ,[opsammn]
      ,[muuamm]
      ,[muuammn]
      ,[amm]
      ,[ammn]
      ,[peain]
      ,[peainn]
      ,[luain]
      ,[luainn]
      ,[vapsiv]
      ,[vapsivn]
      ,[taiop]
      ,[taiopn]
      ,[muukoul]
      ,[muukouln]
      ,[muuop]
      ,[muuopn]
      ,[tehoec]
      ,[teho16c]
      ,[teho79c]
      ,[teholc]
      ,[tehoyc]
      ,[ertuec]
      ,[ertu16c]
      ,[ertu79c]
      ,[ertulc]
      ,[ertuyc]
      ,[eritec]
      ,[erit16c]
      ,[erit79c]
      ,[eritlc]
      ,[erityc]
      ,[inte4]
      ,[int164]
      ,[int794]
      ,[intl4]
      ,[inty4]
      ,[inte3]
      ,[int163]
      ,[int793]
      ,[intl3]
      ,[inty3]
      ,[inte2]
      ,[int162]
      ,[int792]
      ,[intl2]
      ,[inty2]
      ,[inte1]
      ,[int161]
      ,[int791]
      ,[intl1]
      ,[inty1]
      ,[inte0]
      ,[int160]
      ,[int790]
      ,[intl0]
      ,[inty0]
      ,[intey]
      ,[int16y]
      ,[int79y]
      ,[intly]
      ,[intyy]
      ,[yks160]
      ,[yks790]
      ,[yksl0]
      ,[yksy0]
      ,[yks161]
      ,[yks791]
      ,[yksl1]
      ,[yksy1]
      ,[yks162]
      ,[yks792]
      ,[yksl2]
      ,[yksy2]
      ,[yks164]
      ,[yks794]
      ,[yksl4]
      ,[yksy4]
      ,[yks16t]
      ,[yks79t]
      ,[ykslt]
      ,[yksyt]
      ,[yks16y]
      ,[yks79y]
      ,[yksly]
      ,[yksyy]
      ,[tehoosa]
      ,[ertuosa]
      ,[eritosa]
      ,[tehotuki]
      ,[ertutuki]
      ,[erittuki]
      ,[tehoavu]
      ,[ertuavu]
      ,[eritavu]
      ,[tehomuu]
      ,[ertumuu]
      ,[eritmuu]
      ,[alc]
      ,[ylc]
      ,[luc]
      ,[amc]
      ,[alkieli0]
      ,[alkieli1]
      ,[alkieli2]
      ,[alkieli3]
      ,[alkieli4]
      ,[alkieliy]
      ,[ylkieli0]
      ,[ylkieli1]
      ,[ylkieli2]
      ,[ylkieli3]
      ,[ylkieli4]
      ,[ylkieli5]
      ,[ylkieliy]
      ,[lukieli0]
      ,[lukieli1]
      ,[lukieli2]
      ,[lukieli3]
      ,[lukieli4]
      ,[lukieli5]
      ,[lukieli6]
      ,[lukieliy]
      ,[amkieli0]
      ,[amkieli1]
      ,[amkieli2]
      ,[amkieli3]
      ,[amkieli4]
      ,[amkieli5]
      ,[amkieli6]
      ,[amkieliy]
      ,[aleny]
      ,[alruy]
      ,[alsuy]
      ,[alray]
      ,[alsay]
      ,[alvey]
      ,[alesy]
      ,[ality]
      ,[alsaay]
      ,[almuy]
      ,[yleny]
      ,[ylruy]
      ,[ylsuy]
      ,[ylray]
      ,[ylsay]
      ,[ylvey]
      ,[ylesy]
      ,[ylity]
      ,[ylsaay]
      ,[yllaty]
      ,[ylmuy]
      ,[lueny]
      ,[luruy]
      ,[lusuy]
      ,[luray]
      ,[lusay]
      ,[luvey]
      ,[luesy]
      ,[luity]
      ,[lusaay]
      ,[lulaty]
      ,[lumuy]
      ,[ameny]
      ,[amruy]
      ,[amsuy]
      ,[amray]
      ,[amsay]
      ,[amvey]
      ,[amesy]
      ,[amity]
      ,[amsaay]
      ,[amlaty]
      ,[ammuy]
      ,[ov1c]
      ,[ov2c]
      ,[ov3c]
      ,[ov4c]
      ,[ov5c]
      ,[ov6c]
      ,[ov16yc]
      ,[ov16nc]
      ,[eng1]
      ,[ru1]
      ,[su1]
      ,[ra1]
      ,[sa1]
      ,[ve1]
      ,[es1]
      ,[it1]
      ,[saa1]
      ,[mu1]
      ,[eopis1]
      ,[eng2]
      ,[ru2]
      ,[su2]
      ,[ra2]
      ,[sa2]
      ,[ve2]
      ,[es2]
      ,[it2]
      ,[saa2]
      ,[mu2]
      ,[eopis2]
      ,[eng3]
      ,[ru3]
      ,[su3]
      ,[ra3]
      ,[sa3]
      ,[ve3]
      ,[es3]
      ,[it3]
      ,[saa3]
      ,[mu3]
      ,[eopis3]
      ,[eng4]
      ,[ru4]
      ,[su4]
      ,[ra4]
      ,[sa4]
      ,[ve4]
      ,[es4]
      ,[it4]
      ,[saa4]
      ,[mu4]
      ,[eopis4]
      ,[eng5]
      ,[ru5]
      ,[su5]
      ,[ra5]
      ,[sa5]
      ,[ve5]
      ,[es5]
      ,[it5]
      ,[saa5]
      ,[mu5]
      ,[eopis5]
      ,[eng6]
      ,[ru6]
      ,[su6]
      ,[ra6]
      ,[sa6]
      ,[ve6]
      ,[es6]
      ,[it6]
      ,[saa6]
      ,[mu6]
      ,[eopis6]
      ,[eny]
      ,[ruy]
      ,[suy]
      ,[ray]
      ,[say]
      ,[vey]
      ,[esy]
      ,[ity]
      ,[saay]
      ,[muy]
      ,[eopisy]
      ,[enn]
      ,[run]
      ,[sun]
      ,[ran]
      ,[san]
      ,[ven]
      ,[esn]
      ,[itn]
      ,[saan]
      ,[mun]
      ,[eopisn]
      ,[ven1]
      ,[vru1]
      ,[vsu1]
      ,[vra1]
      ,[vsa1]
      ,[vve1]
      ,[ves1]
      ,[vit1]
      ,[vsaa1]
      ,[vmu1]
      ,[vyht1]
      ,[ven2]
      ,[vru2]
      ,[vsu2]
      ,[vra2]
      ,[vsa2]
      ,[vve2]
      ,[ves2]
      ,[vit2]
      ,[vsaa2]
      ,[vmu2]
      ,[vyht2]
      ,[ven3]
      ,[vru3]
      ,[vsu3]
      ,[vra3]
      ,[vsa3]
      ,[vve3]
      ,[ves3]
      ,[vit3]
      ,[vsaa3]
      ,[vmu3]
      ,[vyht3]
      ,[ven4]
      ,[vru4]
      ,[vsu4]
      ,[vra4]
      ,[vsa4]
      ,[vve4]
      ,[ves4]
      ,[vit4]
      ,[vsaa4]
      ,[vmu4]
      ,[vyht4]
      ,[ven5]
      ,[vru5]
      ,[vsu5]
      ,[vra5]
      ,[vsa5]
      ,[vve5]
      ,[ves5]
      ,[vit5]
      ,[vsaa5]
      ,[vmu5]
      ,[vyht5]
      ,[ven6]
      ,[vru6]
      ,[vsu6]
      ,[vra6]
      ,[vsa6]
      ,[vve6]
      ,[ves6]
      ,[vit6]
      ,[vsaa6]
      ,[vmu6]
      ,[vyht6]
      ,[veny]
      ,[vruy]
      ,[vsuy]
      ,[vray]
      ,[vsay]
      ,[vvey]
      ,[vesy]
      ,[vity]
      ,[vsaay]
      ,[vmuy]
      ,[vyht]
      ,[venn]
      ,[vrun]
      ,[vsun]
      ,[vran]
      ,[vsan]
      ,[vven]
      ,[vesn]
      ,[vitn]
      ,[vsaan]
      ,[vmun]
      ,[vtyt]
      ,[ov79yc]
      ,[ov79nc]
      ,[yaen1]
      ,[yaru1]
      ,[yasu1]
      ,[yara1]
      ,[yasa1]
      ,[yave1]
      ,[yaes1]
      ,[yait1]
      ,[yasaa1]
      ,[yalat1]
      ,[yamuu1]
      ,[yaen2]
      ,[yaru2]
      ,[yasu2]
      ,[yara2]
      ,[yasa2]
      ,[yave2]
      ,[yaes2]
      ,[yait2]
      ,[yasaa2]
      ,[yalat2]
      ,[yamuu2]
      ,[yyen]
      ,[yyru]
      ,[yysu]
      ,[yyra]
      ,[yysa]
      ,[yen]
      ,[yru]
      ,[ysu]
      ,[yra]
      ,[ysa]
      ,[yve]
      ,[yes]
      ,[yit]
      ,[ysaa]
      ,[ylat]
      ,[ymuu]
      ,[enyy]
      ,[ruyy]
      ,[suyy]
      ,[rayy]
      ,[sayy]
      ,[veyy]
      ,[esyy]
      ,[ityy]
      ,[saayy]
      ,[layy]
      ,[muyy]
      ,[yaen1n]
      ,[yaru1n]
      ,[yasu1n]
      ,[yara1n]
      ,[yasa1n]
      ,[yave1n]
      ,[yaes1n]
      ,[yait1n]
      ,[yasaa1n]
      ,[yalat1n]
      ,[yamuu1n]
      ,[yaen2n]
      ,[yaru2n]
      ,[yasu2n]
      ,[yara2n]
      ,[yasa2n]
      ,[yave2n]
      ,[yaes2n]
      ,[yait2n]
      ,[yasaa2n]
      ,[yalat2n]
      ,[yamuu2n]
      ,[yyenn]
      ,[yyrun]
      ,[yysun]
      ,[yyran]
      ,[yysan]
      ,[yenn]
      ,[yrun]
      ,[ysun]
      ,[yran]
      ,[ysan]
      ,[yven]
      ,[yesn]
      ,[yitn]
      ,[ysaan]
      ,[ylatn]
      ,[ymuun]
      ,[ennn]
      ,[runn]
      ,[sunn]
      ,[rann]
      ,[sann]
      ,[vennn]
      ,[esnn]
      ,[itnn]
      ,[saann]
      ,[lann]
      ,[munn]
      ,[asv]
      ,[arv]
      ,[asvrv]
      ,[ysv]
      ,[yrv]
      ,[ysvrv]
      ,[sv]
      ,[rv]
      ,[svrv]
      ,[aev]
      ,[aort]
      ,[aisl]
      ,[amu]
      ,[aet]
      ,[aeos]
      ,[akay]
      ,[yev]
      ,[yort]
      ,[yisl]
      ,[ymu]
      ,[yet]
      ,[yeos]
      ,[ykay]
      ,[ev]
      ,[ort]
      ,[isl]
      ,[mu]
      ,[et]
      ,[eos]
      ,[kay]
      ,[ov89yc]
      ,[ov89nc]
      ,[ai]
      ,[rsb]
      ,[ma]
      ,[yl]
      ,[bi]
      ,[ge]
      ,[fy]
      ,[ke]
      ,[ter]
      ,[ue]
      ,[eti]
      ,[hi]
      ,[yh]
      ,[mus]
      ,[ku]
      ,[tt]
      ,[ts]
      ,[li]
      ,[ko]
      ,[yhd]
      ,[ain]
      ,[rsbn]
      ,[man]
      ,[yln]
      ,[bin]
      ,[gen]
      ,[fyn]
      ,[ken]
      ,[tern]
      ,[uen]
      ,[etin]
      ,[hin]
      ,[yhn]
      ,[musn]
      ,[kun]
      ,[ttn]
      ,[tsn]
      ,[lin]
      ,[kon]
      ,[yhdn]
      ,[tietop]
      ,[tietok]
      ,[tietoi]
      ,[verkko]
      ,[kaytto]
      ,[tietolahde]=''R2.22_sopv_12''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_R2_22_sopv_12]
  UNION ALL
    SELECT [tilv]
      ,[jarj]
      ,[tiedtype]
      ,[tunn]
      ,[edesi]
      ,[edala]
      ,[edyla]
      ,[edlisa]
      ,[edainep]
      ,[syesi]
      ,[syala]
      ,[syyla]
      ,[sylisa]
      ,[symamu]
      ,[sylukio]
      ,[syamm]
      ,[symuu]
      ,[keve]
      ,[keven]
      ,[kev1]
      ,[kev1n]
      ,[kev2]
      ,[kev2n]
      ,[kev3]
      ,[kev3n]
      ,[kev4]
      ,[kev4n]
      ,[kev5]
      ,[kev5n]
      ,[kev6]
      ,[kev6n]
      ,[kev7]
      ,[kev7n]
      ,[kev8]
      ,[kev8n]
      ,[kev9]
      ,[kev9n]
      ,[kev10]
      ,[kev10n]
      ,[kev]
      ,[kevn]
      ,[luok1]
      ,[luok1n]
      ,[luok2]
      ,[luok2n]
      ,[luok3]
      ,[luok3n]
      ,[luok4]
      ,[luok4n]
      ,[luok5]
      ,[luok5n]
      ,[luok6]
      ,[luok6n]
      ,[luok7]
      ,[luok7n]
      ,[luok8]
      ,[luok8n]
      ,[luok9]
      ,[luok9n]
      ,[luok]
      ,[luokn]
      ,[kelaim]
      ,[kelaimn]
      ,[tod]
      ,[todn]
      ,[tutkt]
      ,[tutktn]
      ,[suor10]
      ,[suor10n]
      ,[oeriy]
      ,[oeriyn]
      ,[ilmtod]
      ,[ilmtodn]
      ,[aku]
      ,[mamukurs]
      ,[oppkurs]
      ,[muukurs]
      ,[akukurs]
      ,[kmamu]
      ,[kmamun]
      ,[syulkom]
      ,[syulkomn]
      ,[sykoti]
      ,[sykotin]
      ,[ika4e]
      ,[ika4en]
      ,[ika5e]
      ,[ika5en]
      ,[pid5v]
      ,[ika6e]
      ,[ika6en]
      ,[ika7e]
      ,[ika7en]
      ,[ikae]
      ,[ikaen]
      ,[ove]
      ,[ov1]
      ,[ov2]
      ,[ov3]
      ,[ov4]
      ,[ov5]
      ,[ov6]
      ,[ov7]
      ,[ov8]
      ,[ov9]
      ,[ov10]
      ,[ovy]
      ,[tehoe]
      ,[teho1]
      ,[teho2]
      ,[teho3]
      ,[teho4]
      ,[teho5]
      ,[teho6]
      ,[teho7]
      ,[teho8]
      ,[teho9]
      ,[teho10]
      ,[tehoy]
      ,[eipide]
      ,[eipid1]
      ,[eipid2]
      ,[eipid3]
      ,[eipid4]
      ,[eipid5]
      ,[eipid6]
      ,[eipid7]
      ,[eipid8]
      ,[eipid9]
      ,[eipid10]
      ,[eipidy]
      ,[ertuve]
      ,[ertuv1]
      ,[ertuv2]
      ,[ertuv3]
      ,[ertuv4]
      ,[ertuv5]
      ,[ertuv6]
      ,[ertuv7]
      ,[ertuv8]
      ,[ertuv9]
      ,[ertuv10]
      ,[ertuvy]
      ,[ertume]
      ,[ertum1]
      ,[ertum2]
      ,[ertum3]
      ,[ertum4]
      ,[ertum5]
      ,[ertum6]
      ,[ertum7]
      ,[ertum8]
      ,[ertum9]
      ,[ertum10]
      ,[ertumy]
      ,[tavove]
      ,[tavov1]
      ,[tavov2]
      ,[tavov3]
      ,[tavov4]
      ,[tavov5]
      ,[tavov6]
      ,[tavov7]
      ,[tavov8]
      ,[tavov9]
      ,[tavov10]
      ,[tavovy]
      ,[oven]
      ,[ov1n]
      ,[ov2n]
      ,[ov3n]
      ,[ov4n]
      ,[ov5n]
      ,[ov6n]
      ,[ov7n]
      ,[ov8n]
      ,[ov9n]
      ,[ov10n]
      ,[ovyn]
      ,[tehoen]
      ,[teho1n]
      ,[teho2n]
      ,[teho3n]
      ,[teho4n]
      ,[teho5n]
      ,[teho6n]
      ,[teho7n]
      ,[teho8n]
      ,[teho9n]
      ,[teho10n]
      ,[tehoyn]
      ,[eipiden]
      ,[eipid1n]
      ,[eipid2n]
      ,[eipid3n]
      ,[eipid4n]
      ,[eipid5n]
      ,[eipid6n]
      ,[eipid7n]
      ,[eipid8n]
      ,[eipid9n]
      ,[eipid10n]
      ,[eipidyn]
      ,[ertuven]
      ,[ertuv1n]
      ,[ertuv2n]
      ,[ertuv3n]
      ,[ertuv4n]
      ,[ertuv5n]
      ,[ertuv6n]
      ,[ertuv7n]
      ,[ertuv8n]
      ,[ertuv9n]
      ,[ertuv10n]
      ,[ertuvyn]
      ,[ertumen]
      ,[ertum1n]
      ,[ertum2n]
      ,[ertum3n]
      ,[ertum4n]
      ,[ertum5n]
      ,[ertum6n]
      ,[ertum7n]
      ,[ertum8n]
      ,[ertum9n]
      ,[ertum10n]
      ,[ertumyn]
      ,[tavoven]
      ,[tavov1n]
      ,[tavov2n]
      ,[tavov3n]
      ,[tavov4n]
      ,[tavov5n]
      ,[tavov6n]
      ,[tavov7n]
      ,[tavov8n]
      ,[tavov9n]
      ,[tavov10n]
      ,[tavovyn]
      ,[eipidec]
      ,[eipidpc]
      ,[eipidlc]
      ,[eipidyc]
      ,[ertuvec]
      ,[ertuvpc]
      ,[ertuvlc]
      ,[ertuvyc]
      ,[ertumec]
      ,[ertumpc]
      ,[ertumlc]
      ,[ertumyc]
      ,[muuec]
      ,[muupc]
      ,[muulc]
      ,[muuyc]
      ,[ovec]
      ,[ovpc]
      ,[ovlc]
      ,[ovyc]
      ,[sisae]
      ,[sisap]
      ,[sisal]
      ,[sisam]
      ,[sisay]
      ,[maeipide]
      ,[maeipidp]
      ,[maeipidl]
      ,[maeipidy]
      ,[maertuve]
      ,[maertuvp]
      ,[maertuvl]
      ,[maertuvy]
      ,[maertume]
      ,[maertump]
      ,[maertuml]
      ,[maertumy]
      ,[mamuue]
      ,[mamuup]
      ,[mamuul]
      ,[mamuuy]
      ,[maove]
      ,[maovp]
      ,[maovl]
      ,[maovy]
      ,[kueipide]
      ,[kueipidp]
      ,[kueipidl]
      ,[kueipidy]
      ,[kuertuve]
      ,[kuertuvp]
      ,[kuertuvl]
      ,[kuertuvy]
      ,[kuertume]
      ,[kuertump]
      ,[kuertuml]
      ,[kuertumy]
      ,[kumuue]
      ,[kumuup]
      ,[kumuul]
      ,[kumuuy]
      ,[kuove]
      ,[kuovp]
      ,[kuovl]
      ,[kuovy]
      ,[vieipide]
      ,[vieipidp]
      ,[vieipidl]
      ,[vieipidy]
      ,[viertuve]
      ,[viertuvp]
      ,[viertuvl]
      ,[viertuvy]
      ,[viertume]
      ,[viertump]
      ,[viertuml]
      ,[viertumy]
      ,[vimuue]
      ,[vimuup]
      ,[vimuul]
      ,[vimuuy]
      ,[viove]
      ,[viovp]
      ,[viovl]
      ,[viovy]
      ,[ika61]
      ,[ika61n]
      ,[ika71]
      ,[ika71n]
      ,[ika81]
      ,[ika81n]
      ,[ika91]
      ,[ika91n]
      ,[ika1]
      ,[ika1n]
      ,[lykk]
      ,[lykkn]
      ,[jopo]
      ,[jopon]
      ,[kan17v]
      ,[muu17v]
      ,[op17v]
      ,[lukoko]
      ,[lukokon]
      ,[luib]
      ,[luibn]
      ,[reife]
      ,[reifen]
      ,[gymn]
      ,[gymnn]
      ,[lueb]
      ,[luebn]
      ,[lukio]
      ,[lukion]
      ,[opsamm]
      ,[opsammn]
      ,[muuamm]
      ,[muuammn]
      ,[amm]
      ,[ammn]
      ,[peain]
      ,[peainn]
      ,[luain]
      ,[luainn]
      ,[vapsiv]
      ,[vapsivn]
      ,[taiop]
      ,[taiopn]
      ,[muukoul]
      ,[muukouln]
      ,[muuop]
      ,[muuopn]
      ,[tehoec]
      ,[teho16c]
      ,[teho79c]
      ,[teholc]
      ,[tehoyc]
      ,[ertuec]
      ,[ertu16c]
      ,[ertu79c]
      ,[ertulc]
      ,[ertuyc]
      ,[eritec]
      ,[erit16c]
      ,[erit79c]
      ,[eritlc]
      ,[erityc]
      ,[inte4]
      ,[int164]
      ,[int794]
      ,[intl4]
      ,[inty4]
      ,[inte3]
      ,[int163]
      ,[int793]
      ,[intl3]
      ,[inty3]
      ,[inte2]
      ,[int162]
      ,[int792]
      ,[intl2]
      ,[inty2]
      ,[inte1]
      ,[int161]
      ,[int791]
      ,[intl1]
      ,[inty1]
      ,[inte0]
      ,[int160]
      ,[int790]
      ,[intl0]
      ,[inty0]
      ,[intey]
      ,[int16y]
      ,[int79y]
      ,[intly]
      ,[intyy]
      ,[yks160]
      ,[yks790]
      ,[yksl0]
      ,[yksy0]
      ,[yks161]
      ,[yks791]
      ,[yksl1]
      ,[yksy1]
      ,[yks162]
      ,[yks792]
      ,[yksl2]
      ,[yksy2]
      ,[yks164]
      ,[yks794]
      ,[yksl4]
      ,[yksy4]
      ,[yks16t]
      ,[yks79t]
      ,[ykslt]
      ,[yksyt]
      ,[yks16y]
      ,[yks79y]
      ,[yksly]
      ,[yksyy]
      ,[tehoosa]
      ,[ertuosa]
      ,[eritosa]
      ,[tehotuki]
      ,[ertutuki]
      ,[erittuki]
      ,[tehoavu]
      ,[ertuavu]
      ,[eritavu]
      ,[tehomuu]
      ,[ertumuu]
      ,[eritmuu]
      ,[alc]
      ,[ylc]
      ,[luc]
      ,[amc]
      ,[alkieli0]
      ,[alkieli1]
      ,[alkieli2]
      ,[alkieli3]
      ,[alkieli4]
      ,[alkieliy]
      ,[ylkieli0]
      ,[ylkieli1]
      ,[ylkieli2]
      ,[ylkieli3]
      ,[ylkieli4]
      ,[ylkieli5]
      ,[ylkieliy]
      ,[lukieli0]
      ,[lukieli1]
      ,[lukieli2]
      ,[lukieli3]
      ,[lukieli4]
      ,[lukieli5]
      ,[lukieli6]
      ,[lukieliy]
      ,[amkieli0]
      ,[amkieli1]
      ,[amkieli2]
      ,[amkieli3]
      ,[amkieli4]
      ,[amkieli5]
      ,[amkieli6]
      ,[amkieliy]
      ,[aleny]
      ,[alruy]
      ,[alsuy]
      ,[alray]
      ,[alsay]
      ,[alvey]
      ,[alesy]
      ,[ality]
      ,[alsaay]
      ,[almuy]
      ,[yleny]
      ,[ylruy]
      ,[ylsuy]
      ,[ylray]
      ,[ylsay]
      ,[ylvey]
      ,[ylesy]
      ,[ylity]
      ,[ylsaay]
      ,[yllaty]
      ,[ylmuy]
      ,[lueny]
      ,[luruy]
      ,[lusuy]
      ,[luray]
      ,[lusay]
      ,[luvey]
      ,[luesy]
      ,[luity]
      ,[lusaay]
      ,[lulaty]
      ,[lumuy]
      ,[ameny]
      ,[amruy]
      ,[amsuy]
      ,[amray]
      ,[amsay]
      ,[amvey]
      ,[amesy]
      ,[amity]
      ,[amsaay]
      ,[amlaty]
      ,[ammuy]
      ,[ov1c]
      ,[ov2c]
      ,[ov3c]
      ,[ov4c]
      ,[ov5c]
      ,[ov6c]
      ,[ov16yc]
      ,[ov16nc]
      ,[eng1]
      ,[ru1]
      ,[su1]
      ,[ra1]
      ,[sa1]
      ,[ve1]
      ,[es1]
      ,[it1]
      ,[saa1]
      ,[mu1]
      ,[eopis1]
      ,[eng2]
      ,[ru2]
      ,[su2]
      ,[ra2]
      ,[sa2]
      ,[ve2]
      ,[es2]
      ,[it2]
      ,[saa2]
      ,[mu2]
      ,[eopis2]
      ,[eng3]
      ,[ru3]
      ,[su3]
      ,[ra3]
      ,[sa3]
      ,[ve3]
      ,[es3]
      ,[it3]
      ,[saa3]
      ,[mu3]
      ,[eopis3]
      ,[eng4]
      ,[ru4]
      ,[su4]
      ,[ra4]
      ,[sa4]
      ,[ve4]
      ,[es4]
      ,[it4]
      ,[saa4]
      ,[mu4]
      ,[eopis4]
      ,[eng5]
      ,[ru5]
      ,[su5]
      ,[ra5]
      ,[sa5]
      ,[ve5]
      ,[es5]
      ,[it5]
      ,[saa5]
      ,[mu5]
      ,[eopis5]
      ,[eng6]
      ,[ru6]
      ,[su6]
      ,[ra6]
      ,[sa6]
      ,[ve6]
      ,[es6]
      ,[it6]
      ,[saa6]
      ,[mu6]
      ,[eopis6]
      ,[eny]
      ,[ruy]
      ,[suy]
      ,[ray]
      ,[say]
      ,[vey]
      ,[esy]
      ,[ity]
      ,[saay]
      ,[muy]
      ,[eopisy]
      ,[enn]
      ,[run]
      ,[sun]
      ,[ran]
      ,[san]
      ,[ven]
      ,[esn]
      ,[itn]
      ,[saan]
      ,[mun]
      ,[eopisn]
      ,[ven1]
      ,[vru1]
      ,[vsu1]
      ,[vra1]
      ,[vsa1]
      ,[vve1]
      ,[ves1]
      ,[vit1]
      ,[vsaa1]
      ,[vmu1]
      ,[vyht1]
      ,[ven2]
      ,[vru2]
      ,[vsu2]
      ,[vra2]
      ,[vsa2]
      ,[vve2]
      ,[ves2]
      ,[vit2]
      ,[vsaa2]
      ,[vmu2]
      ,[vyht2]
      ,[ven3]
      ,[vru3]
      ,[vsu3]
      ,[vra3]
      ,[vsa3]
      ,[vve3]
      ,[ves3]
      ,[vit3]
      ,[vsaa3]
      ,[vmu3]
      ,[vyht3]
      ,[ven4]
      ,[vru4]
      ,[vsu4]
      ,[vra4]
      ,[vsa4]
      ,[vve4]
      ,[ves4]
      ,[vit4]
      ,[vsaa4]
      ,[vmu4]
      ,[vyht4]
      ,[ven5]
      ,[vru5]
      ,[vsu5]
      ,[vra5]
      ,[vsa5]
      ,[vve5]
      ,[ves5]
      ,[vit5]
      ,[vsaa5]
      ,[vmu5]
      ,[vyht5]
      ,[ven6]
      ,[vru6]
      ,[vsu6]
      ,[vra6]
      ,[vsa6]
      ,[vve6]
      ,[ves6]
      ,[vit6]
      ,[vsaa6]
      ,[vmu6]
      ,[vyht6]
      ,[veny]
      ,[vruy]
      ,[vsuy]
      ,[vray]
      ,[vsay]
      ,[vvey]
      ,[vesy]
      ,[vity]
      ,[vsaay]
      ,[vmuy]
      ,[vyht]
      ,[venn]
      ,[vrun]
      ,[vsun]
      ,[vran]
      ,[vsan]
      ,[vven]
      ,[vesn]
      ,[vitn]
      ,[vsaan]
      ,[vmun]
      ,[vtyt]
      ,[ov79yc]
      ,[ov79nc]
      ,[yaen1]
      ,[yaru1]
      ,[yasu1]
      ,[yara1]
      ,[yasa1]
      ,[yave1]
      ,[yaes1]
      ,[yait1]
      ,[yasaa1]
      ,[yalat1]
      ,[yamuu1]
      ,[yaen2]
      ,[yaru2]
      ,[yasu2]
      ,[yara2]
      ,[yasa2]
      ,[yave2]
      ,[yaes2]
      ,[yait2]
      ,[yasaa2]
      ,[yalat2]
      ,[yamuu2]
      ,[yyen]
      ,[yyru]
      ,[yysu]
      ,[yyra]
      ,[yysa]
      ,[yen]
      ,[yru]
      ,[ysu]
      ,[yra]
      ,[ysa]
      ,[yve]
      ,[yes]
      ,[yit]
      ,[ysaa]
      ,[ylat]
      ,[ymuu]
      ,[enyy]
      ,[ruyy]
      ,[suyy]
      ,[rayy]
      ,[sayy]
      ,[veyy]
      ,[esyy]
      ,[ityy]
      ,[saayy]
      ,[layy]
      ,[muyy]
      ,[yaen1n]
      ,[yaru1n]
      ,[yasu1n]
      ,[yara1n]
      ,[yasa1n]
      ,[yave1n]
      ,[yaes1n]
      ,[yait1n]
      ,[yasaa1n]
      ,[yalat1n]
      ,[yamuu1n]
      ,[yaen2n]
      ,[yaru2n]
      ,[yasu2n]
      ,[yara2n]
      ,[yasa2n]
      ,[yave2n]
      ,[yaes2n]
      ,[yait2n]
      ,[yasaa2n]
      ,[yalat2n]
      ,[yamuu2n]
      ,[yyenn]
      ,[yyrun]
      ,[yysun]
      ,[yyran]
      ,[yysan]
      ,[yenn]
      ,[yrun]
      ,[ysun]
      ,[yran]
      ,[ysan]
      ,[yven]
      ,[yesn]
      ,[yitn]
      ,[ysaan]
      ,[ylatn]
      ,[ymuun]
      ,[ennn]
      ,[runn]
      ,[sunn]
      ,[rann]
      ,[sann]
      ,[vennn]
      ,[esnn]
      ,[itnn]
      ,[saann]
      ,[lann]
      ,[munn]
      ,[asv]
      ,[arv]
      ,[asvrv]
      ,[ysv]
      ,[yrv]
      ,[ysvrv]
      ,[sv]
      ,[rv]
      ,[svrv]
      ,[aev]
      ,[aort]
      ,[aisl]
      ,[amu]
      ,[aet]
      ,[aeos]
      ,[akay]
      ,[yev]
      ,[yort]
      ,[yisl]
      ,[ymu]
      ,[yet]
      ,[yeos]
      ,[ykay]
      ,[ev]
      ,[ort]
      ,[isl]
      ,[mu]
      ,[et]
      ,[eos]
      ,[kay]
      ,[ov89yc]
      ,[ov89nc]
      ,[ai]
      ,[rsb]
      ,[ma]
      ,[yl]
      ,[bi]
      ,[ge]
      ,[fy]
      ,[ke]
      ,[ter]
      ,[ue]
      ,[eti]
      ,[hi]
      ,[yh]
      ,[mus]
      ,[ku]
      ,[tt]
      ,[ts]
      ,[li]
      ,[ko]
      ,[yhd]
      ,[ain]
      ,[rsbn]
      ,[man]
      ,[yln]
      ,[bin]
      ,[gen]
      ,[fyn]
      ,[ken]
      ,[tern]
      ,[uen]
      ,[etin]
      ,[hin]
      ,[yhn]
      ,[musn]
      ,[kun]
      ,[ttn]
      ,[tsn]
      ,[lin]
      ,[kon]
      ,[yhdn]
      ,[tietop]
      ,[tietok]
      ,[tietoi]
      ,[verkko]
      ,[kaytto]
      ,[tietolahde]=''R2.22_sopv_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_R2_22_sopv_13]
  UNION ALL
    SELECT [tilv]
      ,[jarj]
      ,[tiedtype]
      ,[tunn]
      ,[edesi]
      ,[edala]
      ,[edyla]
      ,[edlisa]
      ,[edainep]
      ,[syesi]
      ,[syala]
      ,[syyla]
      ,[sylisa]
      ,[symamu]
      ,[sylukio]
      ,[syamm]
      ,[symuu]
      ,[keve]
      ,[keven]
      ,[kev1]
      ,[kev1n]
      ,[kev2]
      ,[kev2n]
      ,[kev3]
      ,[kev3n]
      ,[kev4]
      ,[kev4n]
      ,[kev5]
      ,[kev5n]
      ,[kev6]
      ,[kev6n]
      ,[kev7]
      ,[kev7n]
      ,[kev8]
      ,[kev8n]
      ,[kev9]
      ,[kev9n]
      ,[kev10]
      ,[kev10n]
      ,[kev]
      ,[kevn]
      ,[luok1]
      ,[luok1n]
      ,[luok2]
      ,[luok2n]
      ,[luok3]
      ,[luok3n]
      ,[luok4]
      ,[luok4n]
      ,[luok5]
      ,[luok5n]
      ,[luok6]
      ,[luok6n]
      ,[luok7]
      ,[luok7n]
      ,[luok8]
      ,[luok8n]
      ,[luok9]
      ,[luok9n]
      ,[luok]
      ,[luokn]
      ,[kelaim]
      ,[kelaimn]
      ,[tod]
      ,[todn]
      ,[tutkt]
      ,[tutktn]
      ,[suor10]
      ,[suor10n]
      ,[oeriy]
      ,[oeriyn]
      ,[ilmtod]
      ,[ilmtodn]
      ,[aku]
      ,[mamukurs]
      ,[oppkurs]
      ,[muukurs]
      ,[akukurs]
      ,[kmamu]
      ,[kmamun]
      ,[syulkom]
      ,[syulkomn]
      ,[sykoti]
      ,[sykotin]
      ,[ika4e]
      ,[ika4en]
      ,[ika5e]
      ,[ika5en]
      ,[pid5v]
      ,[ika6e]
      ,[ika6en]
      ,[ika7e]
      ,[ika7en]
      ,[ikae]
      ,[ikaen]
      ,[ove]
      ,[ov1]
      ,[ov2]
      ,[ov3]
      ,[ov4]
      ,[ov5]
      ,[ov6]
      ,[ov7]
      ,[ov8]
      ,[ov9]
      ,[ov10]
      ,[ovy]
      ,[tehoe]
      ,[teho1]
      ,[teho2]
      ,[teho3]
      ,[teho4]
      ,[teho5]
      ,[teho6]
      ,[teho7]
      ,[teho8]
      ,[teho9]
      ,[teho10]
      ,[tehoy]
      ,[eipide]
      ,[eipid1]
      ,[eipid2]
      ,[eipid3]
      ,[eipid4]
      ,[eipid5]
      ,[eipid6]
      ,[eipid7]
      ,[eipid8]
      ,[eipid9]
      ,[eipid10]
      ,[eipidy]
      ,[ertuve]
      ,[ertuv1]
      ,[ertuv2]
      ,[ertuv3]
      ,[ertuv4]
      ,[ertuv5]
      ,[ertuv6]
      ,[ertuv7]
      ,[ertuv8]
      ,[ertuv9]
      ,[ertuv10]
      ,[ertuvy]
      ,[ertume]
      ,[ertum1]
      ,[ertum2]
      ,[ertum3]
      ,[ertum4]
      ,[ertum5]
      ,[ertum6]
      ,[ertum7]
      ,[ertum8]
      ,[ertum9]
      ,[ertum10]
      ,[ertumy]
      ,[tavove]
      ,[tavov1]
      ,[tavov2]
      ,[tavov3]
      ,[tavov4]
      ,[tavov5]
      ,[tavov6]
      ,[tavov7]
      ,[tavov8]
      ,[tavov9]
      ,[tavov10]
      ,[tavovy]
      ,[oven]
      ,[ov1n]
      ,[ov2n]
      ,[ov3n]
      ,[ov4n]
      ,[ov5n]
      ,[ov6n]
      ,[ov7n]
      ,[ov8n]
      ,[ov9n]
      ,[ov10n]
      ,[ovyn]
      ,[tehoen]
      ,[teho1n]
      ,[teho2n]
      ,[teho3n]
      ,[teho4n]
      ,[teho5n]
      ,[teho6n]
      ,[teho7n]
      ,[teho8n]
      ,[teho9n]
      ,[teho10n]
      ,[tehoyn]
      ,[eipiden]
      ,[eipid1n]
      ,[eipid2n]
      ,[eipid3n]
      ,[eipid4n]
      ,[eipid5n]
      ,[eipid6n]
      ,[eipid7n]
      ,[eipid8n]
      ,[eipid9n]
      ,[eipid10n]
      ,[eipidyn]
      ,[ertuven]
      ,[ertuv1n]
      ,[ertuv2n]
      ,[ertuv3n]
      ,[ertuv4n]
      ,[ertuv5n]
      ,[ertuv6n]
      ,[ertuv7n]
      ,[ertuv8n]
      ,[ertuv9n]
      ,[ertuv10n]
      ,[ertuvyn]
      ,[ertumen]
      ,[ertum1n]
      ,[ertum2n]
      ,[ertum3n]
      ,[ertum4n]
      ,[ertum5n]
      ,[ertum6n]
      ,[ertum7n]
      ,[ertum8n]
      ,[ertum9n]
      ,[ertum10n]
      ,[ertumyn]
      ,[tavoven]
      ,[tavov1n]
      ,[tavov2n]
      ,[tavov3n]
      ,[tavov4n]
      ,[tavov5n]
      ,[tavov6n]
      ,[tavov7n]
      ,[tavov8n]
      ,[tavov9n]
      ,[tavov10n]
      ,[tavovyn]
      ,[eipidec]
      ,[eipidpc]
      ,[eipidlc]
      ,[eipidyc]
      ,[ertuvec]
      ,[ertuvpc]
      ,[ertuvlc]
      ,[ertuvyc]
      ,[ertumec]
      ,[ertumpc]
      ,[ertumlc]
      ,[ertumyc]
      ,[muuec]
      ,[muupc]
      ,[muulc]
      ,[muuyc]
      ,[ovec]
      ,[ovpc]
      ,[ovlc]
      ,[ovyc]
      ,[sisae]
      ,[sisap]
      ,[sisal]
      ,[sisam]
      ,[sisay]
      ,[maeipide]
      ,[maeipidp]
      ,[maeipidl]
      ,[maeipidy]
      ,[maertuve]
      ,[maertuvp]
      ,[maertuvl]
      ,[maertuvy]
      ,[maertume]
      ,[maertump]
      ,[maertuml]
      ,[maertumy]
      ,[mamuue]
      ,[mamuup]
      ,[mamuul]
      ,[mamuuy]
      ,[maove]
      ,[maovp]
      ,[maovl]
      ,[maovy]
      ,[kueipide]
      ,[kueipidp]
      ,[kueipidl]
      ,[kueipidy]
      ,[kuertuve]
      ,[kuertuvp]
      ,[kuertuvl]
      ,[kuertuvy]
      ,[kuertume]
      ,[kuertump]
      ,[kuertuml]
      ,[kuertumy]
      ,[kumuue]
      ,[kumuup]
      ,[kumuul]
      ,[kumuuy]
      ,[kuove]
      ,[kuovp]
      ,[kuovl]
      ,[kuovy]
      ,[vieipide]
      ,[vieipidp]
      ,[vieipidl]
      ,[vieipidy]
      ,[viertuve]
      ,[viertuvp]
      ,[viertuvl]
      ,[viertuvy]
      ,[viertume]
      ,[viertump]
      ,[viertuml]
      ,[viertumy]
      ,[vimuue]
      ,[vimuup]
      ,[vimuul]
      ,[vimuuy]
      ,[viove]
      ,[viovp]
      ,[viovl]
      ,[viovy]
      ,[ika61]
      ,[ika61n]
      ,[ika71]
      ,[ika71n]
      ,[ika81]
      ,[ika81n]
      ,[ika91]
      ,[ika91n]
      ,[ika1]
      ,[ika1n]
      ,[lykk]
      ,[lykkn]
      ,[jopo]
      ,[jopon]
      ,[kan17v]
      ,[muu17v]
      ,[op17v]
      ,[lukoko]
      ,[lukokon]
      ,[luib]
      ,[luibn]
      ,[reife]
      ,[reifen]
      ,[gymn]
      ,[gymnn]
      ,[lueb]
      ,[luebn]
      ,[lukio]
      ,[lukion]
      ,[opsamm]
      ,[opsammn]
      ,[muuamm]
      ,[muuammn]
      ,[amm]
      ,[ammn]
      ,[peain]
      ,[peainn]
      ,[luain]
      ,[luainn]
      ,[vapsiv]
      ,[vapsivn]
      ,[taiop]
      ,[taiopn]
      ,[muukoul]
      ,[muukouln]
      ,[muuop]
      ,[muuopn]
      ,[tehoec]
      ,[teho16c]
      ,[teho79c]
      ,[teholc]
      ,[tehoyc]
      ,[ertuec]
      ,[ertu16c]
      ,[ertu79c]
      ,[ertulc]
      ,[ertuyc]
      ,[eritec]
      ,[erit16c]
      ,[erit79c]
      ,[eritlc]
      ,[erityc]
      ,[inte4]
      ,[int164]
      ,[int794]
      ,[intl4]
      ,[inty4]
      ,[inte3]
      ,[int163]
      ,[int793]
      ,[intl3]
      ,[inty3]
      ,[inte2]
      ,[int162]
      ,[int792]
      ,[intl2]
      ,[inty2]
      ,[inte1]
      ,[int161]
      ,[int791]
      ,[intl1]
      ,[inty1]
      ,[inte0]
      ,[int160]
      ,[int790]
      ,[intl0]
      ,[inty0]
      ,[intey]
      ,[int16y]
      ,[int79y]
      ,[intly]
      ,[intyy]
      ,[yks160]
      ,[yks790]
      ,[yksl0]
      ,[yksy0]
      ,[yks161]
      ,[yks791]
      ,[yksl1]
      ,[yksy1]
      ,[yks162]
      ,[yks792]
      ,[yksl2]
      ,[yksy2]
      ,[yks164]
      ,[yks794]
      ,[yksl4]
      ,[yksy4]
      ,[yks16t]
      ,[yks79t]
      ,[ykslt]
      ,[yksyt]
      ,[yks16y]
      ,[yks79y]
      ,[yksly]
      ,[yksyy]
      ,[tehoosa]
      ,[ertuosa]
      ,[eritosa]
      ,[tehotuki]
      ,[ertutuki]
      ,[erittuki]
      ,[tehoavu]
      ,[ertuavu]
      ,[eritavu]
      ,[tehomuu]
      ,[ertumuu]
      ,[eritmuu]
      ,[alc]
      ,[ylc]
      ,[luc]
      ,[amc]
      ,[alkieli0]
      ,[alkieli1]
      ,[alkieli2]
      ,[alkieli3]
      ,[alkieli4]
      ,[alkieliy]
      ,[ylkieli0]
      ,[ylkieli1]
      ,[ylkieli2]
      ,[ylkieli3]
      ,[ylkieli4]
      ,[ylkieli5]
      ,[ylkieliy]
      ,[lukieli0]
      ,[lukieli1]
      ,[lukieli2]
      ,[lukieli3]
      ,[lukieli4]
      ,[lukieli5]
      ,[lukieli6]
      ,[lukieliy]
      ,[amkieli0]
      ,[amkieli1]
      ,[amkieli2]
      ,[amkieli3]
      ,[amkieli4]
      ,[amkieli5]
      ,[amkieli6]
      ,[amkieliy]
      ,[aleny]
      ,[alruy]
      ,[alsuy]
      ,[alray]
      ,[alsay]
      ,[alvey]
      ,[alesy]
      ,[ality]
      ,[alsaay]
      ,[almuy]
      ,[yleny]
      ,[ylruy]
      ,[ylsuy]
      ,[ylray]
      ,[ylsay]
      ,[ylvey]
      ,[ylesy]
      ,[ylity]
      ,[ylsaay]
      ,[yllaty]
      ,[ylmuy]
      ,[lueny]
      ,[luruy]
      ,[lusuy]
      ,[luray]
      ,[lusay]
      ,[luvey]
      ,[luesy]
      ,[luity]
      ,[lusaay]
      ,[lulaty]
      ,[lumuy]
      ,[ameny]
      ,[amruy]
      ,[amsuy]
      ,[amray]
      ,[amsay]
      ,[amvey]
      ,[amesy]
      ,[amity]
      ,[amsaay]
      ,[amlaty]
      ,[ammuy]
      ,[ov1c]
      ,[ov2c]
      ,[ov3c]
      ,[ov4c]
      ,[ov5c]
      ,[ov6c]
      ,[ov16yc]
      ,[ov16nc]
      ,[eng1]
      ,[ru1]
      ,[su1]
      ,[ra1]
      ,[sa1]
      ,[ve1]
      ,[es1]
      ,[it1]
      ,[saa1]
      ,[mu1]
      ,[eopis1]
      ,[eng2]
      ,[ru2]
      ,[su2]
      ,[ra2]
      ,[sa2]
      ,[ve2]
      ,[es2]
      ,[it2]
      ,[saa2]
      ,[mu2]
      ,[eopis2]
      ,[eng3]
      ,[ru3]
      ,[su3]
      ,[ra3]
      ,[sa3]
      ,[ve3]
      ,[es3]
      ,[it3]
      ,[saa3]
      ,[mu3]
      ,[eopis3]
      ,[eng4]
      ,[ru4]
      ,[su4]
      ,[ra4]
      ,[sa4]
      ,[ve4]
      ,[es4]
      ,[it4]
      ,[saa4]
      ,[mu4]
      ,[eopis4]
      ,[eng5]
      ,[ru5]
      ,[su5]
      ,[ra5]
      ,[sa5]
      ,[ve5]
      ,[es5]
      ,[it5]
      ,[saa5]
      ,[mu5]
      ,[eopis5]
      ,[eng6]
      ,[ru6]
      ,[su6]
      ,[ra6]
      ,[sa6]
      ,[ve6]
      ,[es6]
      ,[it6]
      ,[saa6]
      ,[mu6]
      ,[eopis6]
      ,[eny]
      ,[ruy]
      ,[suy]
      ,[ray]
      ,[say]
      ,[vey]
      ,[esy]
      ,[ity]
      ,[saay]
      ,[muy]
      ,[eopisy]
      ,[enn]
      ,[run]
      ,[sun]
      ,[ran]
      ,[san]
      ,[ven]
      ,[esn]
      ,[itn]
      ,[saan]
      ,[mun]
      ,[eopisn]
      ,[ven1]
      ,[vru1]
      ,[vsu1]
      ,[vra1]
      ,[vsa1]
      ,[vve1]
      ,[ves1]
      ,[vit1]
      ,[vsaa1]
      ,[vmu1]
      ,[vyht1]
      ,[ven2]
      ,[vru2]
      ,[vsu2]
      ,[vra2]
      ,[vsa2]
      ,[vve2]
      ,[ves2]
      ,[vit2]
      ,[vsaa2]
      ,[vmu2]
      ,[vyht2]
      ,[ven3]
      ,[vru3]
      ,[vsu3]
      ,[vra3]
      ,[vsa3]
      ,[vve3]
      ,[ves3]
      ,[vit3]
      ,[vsaa3]
      ,[vmu3]
      ,[vyht3]
      ,[ven4]
      ,[vru4]
      ,[vsu4]
      ,[vra4]
      ,[vsa4]
      ,[vve4]
      ,[ves4]
      ,[vit4]
      ,[vsaa4]
      ,[vmu4]
      ,[vyht4]
      ,[ven5]
      ,[vru5]
      ,[vsu5]
      ,[vra5]
      ,[vsa5]
      ,[vve5]
      ,[ves5]
      ,[vit5]
      ,[vsaa5]
      ,[vmu5]
      ,[vyht5]
      ,[ven6]
      ,[vru6]
      ,[vsu6]
      ,[vra6]
      ,[vsa6]
      ,[vve6]
      ,[ves6]
      ,[vit6]
      ,[vsaa6]
      ,[vmu6]
      ,[vyht6]
      ,[veny]
      ,[vruy]
      ,[vsuy]
      ,[vray]
      ,[vsay]
      ,[vvey]
      ,[vesy]
      ,[vity]
      ,[vsaay]
      ,[vmuy]
      ,[vyht]
      ,[venn]
      ,[vrun]
      ,[vsun]
      ,[vran]
      ,[vsan]
      ,[vven]
      ,[vesn]
      ,[vitn]
      ,[vsaan]
      ,[vmun]
      ,[vtyt]
      ,[ov79yc]
      ,[ov79nc]
      ,[yaen1]
      ,[yaru1]
      ,[yasu1]
      ,[yara1]
      ,[yasa1]
      ,[yave1]
      ,[yaes1]
      ,[yait1]
      ,[yasaa1]
      ,[yalat1]
      ,[yamuu1]
      ,[yaen2]
      ,[yaru2]
      ,[yasu2]
      ,[yara2]
      ,[yasa2]
      ,[yave2]
      ,[yaes2]
      ,[yait2]
      ,[yasaa2]
      ,[yalat2]
      ,[yamuu2]
      ,[yyen]
      ,[yyru]
      ,[yysu]
      ,[yyra]
      ,[yysa]
      ,[yen]
      ,[yru]
      ,[ysu]
      ,[yra]
      ,[ysa]
      ,[yve]
      ,[yes]
      ,[yit]
      ,[ysaa]
      ,[ylat]
      ,[ymuu]
      ,[enyy]
      ,[ruyy]
      ,[suyy]
      ,[rayy]
      ,[sayy]
      ,[veyy]
      ,[esyy]
      ,[ityy]
      ,[saayy]
      ,[layy]
      ,[muyy]
      ,[yaen1n]
      ,[yaru1n]
      ,[yasu1n]
      ,[yara1n]
      ,[yasa1n]
      ,[yave1n]
      ,[yaes1n]
      ,[yait1n]
      ,[yasaa1n]
      ,[yalat1n]
      ,[yamuu1n]
      ,[yaen2n]
      ,[yaru2n]
      ,[yasu2n]
      ,[yara2n]
      ,[yasa2n]
      ,[yave2n]
      ,[yaes2n]
      ,[yait2n]
      ,[yasaa2n]
      ,[yalat2n]
      ,[yamuu2n]
      ,[yyenn]
      ,[yyrun]
      ,[yysun]
      ,[yyran]
      ,[yysan]
      ,[yenn]
      ,[yrun]
      ,[ysun]
      ,[yran]
      ,[ysan]
      ,[yven]
      ,[yesn]
      ,[yitn]
      ,[ysaan]
      ,[ylatn]
      ,[ymuun]
      ,[ennn]
      ,[runn]
      ,[sunn]
      ,[rann]
      ,[sann]
      ,[vennn]
      ,[esnn]
      ,[itnn]
      ,[saann]
      ,[lann]
      ,[munn]
      ,[asv]
      ,[arv]
      ,[asvrv]
      ,[ysv]
      ,[yrv]
      ,[ysvrv]
      ,[sv]
      ,[rv]
      ,[svrv]
      ,[aev]
      ,[aort]
      ,[aisl]
      ,[amu]
      ,[aet]
      ,[aeos]
      ,[akay]
      ,[yev]
      ,[yort]
      ,[yisl]
      ,[ymu]
      ,[yet]
      ,[yeos]
      ,[ykay]
      ,[ev]
      ,[ort]
      ,[isl]
      ,[mu]
      ,[et]
      ,[eos]
      ,[kay]
      ,[ov89yc]
      ,[ov89nc]
      ,[ai]
      ,[rsb]
      ,[ma]
      ,[yl]
      ,[bi]
      ,[ge]
      ,[fy]
      ,[ke]
      ,[ter]
      ,[ue]
      ,[eti]
      ,[hi]
      ,[yh]
      ,[mus]
      ,[ku]
      ,[tt]
      ,[ts]
      ,[li]
      ,[ko]
      ,[yhd]
      ,[ain]
      ,[rsbn]
      ,[man]
      ,[yln]
      ,[bin]
      ,[gen]
      ,[fyn]
      ,[ken]
      ,[tern]
      ,[uen]
      ,[etin]
      ,[hin]
      ,[yhn]
      ,[musn]
      ,[kun]
      ,[ttn]
      ,[tsn]
      ,[lin]
      ,[kon]
      ,[yhdn]
      ,[tietop]
      ,[tietok]
      ,[tietoi]
      ,[verkko]
      ,[kaytto]
      ,[tietolahde]=''R2.22_sopv_14''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_R2_22_sopv_14]
   UNION ALL
    SELECT [tilv]
      ,[jarj]
      ,[tiedtype]
      ,[tunn]
      ,[edesi]
      ,[edala]
      ,[edyla]
      ,[edlisa]
      ,[edainep]
      ,[syesi]
      ,[syala]
      ,[syyla]
      ,[sylisa]
      ,[symamu]
      ,[sylukio]
      ,[syamm]
      ,[symuu]
      ,[keve]
      ,[keven]
      ,[kev1]
      ,[kev1n]
      ,[kev2]
      ,[kev2n]
      ,[kev3]
      ,[kev3n]
      ,[kev4]
      ,[kev4n]
      ,[kev5]
      ,[kev5n]
      ,[kev6]
      ,[kev6n]
      ,[kev7]
      ,[kev7n]
      ,[kev8]
      ,[kev8n]
      ,[kev9]
      ,[kev9n]
      ,[kev10]
      ,[kev10n]
      ,[kev]
      ,[kevn]
      ,[luok1]
      ,[luok1n]
      ,[luok2]
      ,[luok2n]
      ,[luok3]
      ,[luok3n]
      ,[luok4]
      ,[luok4n]
      ,[luok5]
      ,[luok5n]
      ,[luok6]
      ,[luok6n]
      ,[luok7]
      ,[luok7n]
      ,[luok8]
      ,[luok8n]
      ,[luok9]
      ,[luok9n]
      ,[luok]
      ,[luokn]
      ,[kelaim]
      ,[kelaimn]
      ,[tod]
      ,[todn]
      ,[tutkt]
      ,[tutktn]
      ,[suor10]
      ,[suor10n]
      ,[oeriy]
      ,[oeriyn]
      ,[ilmtod]
      ,[ilmtodn]
      ,[aku]
      ,[mamukurs]
      ,[oppkurs]
      ,[muukurs]
      ,[akukurs]
      ,[kmamu]
      ,[kmamun]
      ,[syulkom]
      ,[syulkomn]
      ,[sykoti]
      ,[sykotin]
      ,[ika4e]
      ,[ika4en]
      ,[ika5e]
      ,[ika5en]
      ,[pid5v]
      ,[ika6e]
      ,[ika6en]
      ,[ika7e]
      ,[ika7en]
      ,[ikae]
      ,[ikaen]
      ,[ove]
      ,[ov1]
      ,[ov2]
      ,[ov3]
      ,[ov4]
      ,[ov5]
      ,[ov6]
      ,[ov7]
      ,[ov8]
      ,[ov9]
      ,[ov10]
      ,[ovy]
      ,[tehoe]
      ,[teho1]
      ,[teho2]
      ,[teho3]
      ,[teho4]
      ,[teho5]
      ,[teho6]
      ,[teho7]
      ,[teho8]
      ,[teho9]
      ,[teho10]
      ,[tehoy]
      ,[eipide]
      ,[eipid1]
      ,[eipid2]
      ,[eipid3]
      ,[eipid4]
      ,[eipid5]
      ,[eipid6]
      ,[eipid7]
      ,[eipid8]
      ,[eipid9]
      ,[eipid10]
      ,[eipidy]
      ,[ertuve]
      ,[ertuv1]
      ,[ertuv2]
      ,[ertuv3]
      ,[ertuv4]
      ,[ertuv5]
      ,[ertuv6]
      ,[ertuv7]
      ,[ertuv8]
      ,[ertuv9]
      ,[ertuv10]
      ,[ertuvy]
      ,[ertume]
      ,[ertum1]
      ,[ertum2]
      ,[ertum3]
      ,[ertum4]
      ,[ertum5]
      ,[ertum6]
      ,[ertum7]
      ,[ertum8]
      ,[ertum9]
      ,[ertum10]
      ,[ertumy]
      ,[tavove]
      ,[tavov1]
      ,[tavov2]
      ,[tavov3]
      ,[tavov4]
      ,[tavov5]
      ,[tavov6]
      ,[tavov7]
      ,[tavov8]
      ,[tavov9]
      ,[tavov10]
      ,[tavovy]
      ,[oven]
      ,[ov1n]
      ,[ov2n]
      ,[ov3n]
      ,[ov4n]
      ,[ov5n]
      ,[ov6n]
      ,[ov7n]
      ,[ov8n]
      ,[ov9n]
      ,[ov10n]
      ,[ovyn]
      ,[tehoen]
      ,[teho1n]
      ,[teho2n]
      ,[teho3n]
      ,[teho4n]
      ,[teho5n]
      ,[teho6n]
      ,[teho7n]
      ,[teho8n]
      ,[teho9n]
      ,[teho10n]
      ,[tehoyn]
      ,[eipiden]
      ,[eipid1n]
      ,[eipid2n]
      ,[eipid3n]
      ,[eipid4n]
      ,[eipid5n]
      ,[eipid6n]
      ,[eipid7n]
      ,[eipid8n]
      ,[eipid9n]
      ,[eipid10n]
      ,[eipidyn]
      ,[ertuven]
      ,[ertuv1n]
      ,[ertuv2n]
      ,[ertuv3n]
      ,[ertuv4n]
      ,[ertuv5n]
      ,[ertuv6n]
      ,[ertuv7n]
      ,[ertuv8n]
      ,[ertuv9n]
      ,[ertuv10n]
      ,[ertuvyn]
      ,[ertumen]
      ,[ertum1n]
      ,[ertum2n]
      ,[ertum3n]
      ,[ertum4n]
      ,[ertum5n]
      ,[ertum6n]
      ,[ertum7n]
      ,[ertum8n]
      ,[ertum9n]
      ,[ertum10n]
      ,[ertumyn]
      ,[tavoven]
      ,[tavov1n]
      ,[tavov2n]
      ,[tavov3n]
      ,[tavov4n]
      ,[tavov5n]
      ,[tavov6n]
      ,[tavov7n]
      ,[tavov8n]
      ,[tavov9n]
      ,[tavov10n]
      ,[tavovyn]
      ,[eipidec]
      ,[eipidpc]
      ,[eipidlc]
      ,[eipidyc]
      ,[ertuvec]
      ,[ertuvpc]
      ,[ertuvlc]
      ,[ertuvyc]
      ,[ertumec]
      ,[ertumpc]
      ,[ertumlc]
      ,[ertumyc]
      ,[muuec]
      ,[muupc]
      ,[muulc]
      ,[muuyc]
      ,[ovec]
      ,[ovpc]
      ,[ovlc]
      ,[ovyc]
      ,[sisae]
      ,[sisap]
      ,[sisal]
      ,[sisam]
      ,[sisay]
      ,[maeipide]
      ,[maeipidp]
      ,[maeipidl]
      ,[maeipidy]
      ,[maertuve]
      ,[maertuvp]
      ,[maertuvl]
      ,[maertuvy]
      ,[maertume]
      ,[maertump]
      ,[maertuml]
      ,[maertumy]
      ,[mamuue]
      ,[mamuup]
      ,[mamuul]
      ,[mamuuy]
      ,[maove]
      ,[maovp]
      ,[maovl]
      ,[maovy]
      ,[kueipide]
      ,[kueipidp]
      ,[kueipidl]
      ,[kueipidy]
      ,[kuertuve]
      ,[kuertuvp]
      ,[kuertuvl]
      ,[kuertuvy]
      ,[kuertume]
      ,[kuertump]
      ,[kuertuml]
      ,[kuertumy]
      ,[kumuue]
      ,[kumuup]
      ,[kumuul]
      ,[kumuuy]
      ,[kuove]
      ,[kuovp]
      ,[kuovl]
      ,[kuovy]
      ,[vieipide]
      ,[vieipidp]
      ,[vieipidl]
      ,[vieipidy]
      ,[viertuve]
      ,[viertuvp]
      ,[viertuvl]
      ,[viertuvy]
      ,[viertume]
      ,[viertump]
      ,[viertuml]
      ,[viertumy]
      ,[vimuue]
      ,[vimuup]
      ,[vimuul]
      ,[vimuuy]
      ,[viove]
      ,[viovp]
      ,[viovl]
      ,[viovy]
      ,[ika61]
      ,[ika61n]
      ,[ika71]
      ,[ika71n]
      ,[ika81]
      ,[ika81n]
      ,[ika91]
      ,[ika91n]
      ,[ika1]
      ,[ika1n]
      ,[lykk]
      ,[lykkn]
      ,[jopo]
      ,[jopon]
      ,[kan17v]
      ,[muu17v]
      ,[op17v]
      ,[lukoko]
      ,[lukokon]
      ,[luib]
      ,[luibn]
      ,[reife]
      ,[reifen]
      ,[gymn]
      ,[gymnn]
      ,[lueb]
      ,[luebn]
      ,[lukio]
      ,[lukion]
      ,[opsamm]
      ,[opsammn]
      ,[muuamm]
      ,[muuammn]
      ,[amm]
      ,[ammn]
      ,[peain]
      ,[peainn]
      ,[luain]
      ,[luainn]
      ,[vapsiv]
      ,[vapsivn]
      ,[taiop]
      ,[taiopn]
      ,[muukoul]
      ,[muukouln]
      ,[muuop]
      ,[muuopn]
      ,[tehoec]
      ,[teho16c]
      ,[teho79c]
      ,[teholc]
      ,[tehoyc]
      ,[ertuec]
      ,[ertu16c]
      ,[ertu79c]
      ,[ertulc]
      ,[ertuyc]
      ,[eritec]
      ,[erit16c]
      ,[erit79c]
      ,[eritlc]
      ,[erityc]
      ,[inte4]
      ,[int164]
      ,[int794]
      ,[intl4]
      ,[inty4]
      ,[inte3]
      ,[int163]
      ,[int793]
      ,[intl3]
      ,[inty3]
      ,[inte2]
      ,[int162]
      ,[int792]
      ,[intl2]
      ,[inty2]
      ,[inte1]
      ,[int161]
      ,[int791]
      ,[intl1]
      ,[inty1]
      ,[inte0]
      ,[int160]
      ,[int790]
      ,[intl0]
      ,[inty0]
      ,[intey]
      ,[int16y]
      ,[int79y]
      ,[intly]
      ,[intyy]
      ,[yks160]
      ,[yks790]
      ,[yksl0]
      ,[yksy0]
      ,[yks161]
      ,[yks791]
      ,[yksl1]
      ,[yksy1]
      ,[yks162]
      ,[yks792]
      ,[yksl2]
      ,[yksy2]
      ,[yks164]
      ,[yks794]
      ,[yksl4]
      ,[yksy4]
      ,[yks16t]
      ,[yks79t]
      ,[ykslt]
      ,[yksyt]
      ,[yks16y]
      ,[yks79y]
      ,[yksly]
      ,[yksyy]
      ,[tehoosa]
      ,[ertuosa]
      ,[eritosa]
      ,[tehotuki]
      ,[ertutuki]
      ,[erittuki]
      ,[tehoavu]
      ,[ertuavu]
      ,[eritavu]
      ,[tehomuu]
      ,[ertumuu]
      ,[eritmuu]
      ,[alc]
      ,[ylc]
      ,[luc]
      ,[amc]
      ,[alkieli0]
      ,[alkieli1]
      ,[alkieli2]
      ,[alkieli3]
      ,[alkieli4]
      ,[alkieliy]
      ,[ylkieli0]
      ,[ylkieli1]
      ,[ylkieli2]
      ,[ylkieli3]
      ,[ylkieli4]
      ,[ylkieli5]
      ,[ylkieliy]
      ,[lukieli0]
      ,[lukieli1]
      ,[lukieli2]
      ,[lukieli3]
      ,[lukieli4]
      ,[lukieli5]
      ,[lukieli6]
      ,[lukieliy]
      ,[amkieli0]
      ,[amkieli1]
      ,[amkieli2]
      ,[amkieli3]
      ,[amkieli4]
      ,[amkieli5]
      ,[amkieli6]
      ,[amkieliy]
      ,[aleny]
      ,[alruy]
      ,[alsuy]
      ,[alray]
      ,[alsay]
      ,[alvey]
      ,[alesy]
      ,[ality]
      ,[alsaay]
      ,[almuy]
      ,[yleny]
      ,[ylruy]
      ,[ylsuy]
      ,[ylray]
      ,[ylsay]
      ,[ylvey]
      ,[ylesy]
      ,[ylity]
      ,[ylsaay]
      ,[yllaty]
      ,[ylmuy]
      ,[lueny]
      ,[luruy]
      ,[lusuy]
      ,[luray]
      ,[lusay]
      ,[luvey]
      ,[luesy]
      ,[luity]
      ,[lusaay]
      ,[lulaty]
      ,[lumuy]
      ,[ameny]
      ,[amruy]
      ,[amsuy]
      ,[amray]
      ,[amsay]
      ,[amvey]
      ,[amesy]
      ,[amity]
      ,[amsaay]
      ,[amlaty]
      ,[ammuy]
      ,[ov1c]
      ,[ov2c]
      ,[ov3c]
      ,[ov4c]
      ,[ov5c]
      ,[ov6c]
      ,[ov16yc]
      ,[ov16nc]
      ,[eng1]
      ,[ru1]
      ,[su1]
      ,[ra1]
      ,[sa1]
      ,[ve1]
      ,[es1]
      ,[it1]
      ,[saa1]
      ,[mu1]
      ,[eopis1]
      ,[eng2]
      ,[ru2]
      ,[su2]
      ,[ra2]
      ,[sa2]
      ,[ve2]
      ,[es2]
      ,[it2]
      ,[saa2]
      ,[mu2]
      ,[eopis2]
      ,[eng3]
      ,[ru3]
      ,[su3]
      ,[ra3]
      ,[sa3]
      ,[ve3]
      ,[es3]
      ,[it3]
      ,[saa3]
      ,[mu3]
      ,[eopis3]
      ,[eng4]
      ,[ru4]
      ,[su4]
      ,[ra4]
      ,[sa4]
      ,[ve4]
      ,[es4]
      ,[it4]
      ,[saa4]
      ,[mu4]
      ,[eopis4]
      ,[eng5]
      ,[ru5]
      ,[su5]
      ,[ra5]
      ,[sa5]
      ,[ve5]
      ,[es5]
      ,[it5]
      ,[saa5]
      ,[mu5]
      ,[eopis5]
      ,[eng6]
      ,[ru6]
      ,[su6]
      ,[ra6]
      ,[sa6]
      ,[ve6]
      ,[es6]
      ,[it6]
      ,[saa6]
      ,[mu6]
      ,[eopis6]
      ,[eny]
      ,[ruy]
      ,[suy]
      ,[ray]
      ,[say]
      ,[vey]
      ,[esy]
      ,[ity]
      ,[saay]
      ,[muy]
      ,[eopisy]
      ,[enn]
      ,[run]
      ,[sun]
      ,[ran]
      ,[san]
      ,[ven]
      ,[esn]
      ,[itn]
      ,[saan]
      ,[mun]
      ,[eopisn]
      ,[ven1]
      ,[vru1]
      ,[vsu1]
      ,[vra1]
      ,[vsa1]
      ,[vve1]
      ,[ves1]
      ,[vit1]
      ,[vsaa1]
      ,[vmu1]
      ,[vyht1]
      ,[ven2]
      ,[vru2]
      ,[vsu2]
      ,[vra2]
      ,[vsa2]
      ,[vve2]
      ,[ves2]
      ,[vit2]
      ,[vsaa2]
      ,[vmu2]
      ,[vyht2]
      ,[ven3]
      ,[vru3]
      ,[vsu3]
      ,[vra3]
      ,[vsa3]
      ,[vve3]
      ,[ves3]
      ,[vit3]
      ,[vsaa3]
      ,[vmu3]
      ,[vyht3]
      ,[ven4]
      ,[vru4]
      ,[vsu4]
      ,[vra4]
      ,[vsa4]
      ,[vve4]
      ,[ves4]
      ,[vit4]
      ,[vsaa4]
      ,[vmu4]
      ,[vyht4]
      ,[ven5]
      ,[vru5]
      ,[vsu5]
      ,[vra5]
      ,[vsa5]
      ,[vve5]
      ,[ves5]
      ,[vit5]
      ,[vsaa5]
      ,[vmu5]
      ,[vyht5]
      ,[ven6]
      ,[vru6]
      ,[vsu6]
      ,[vra6]
      ,[vsa6]
      ,[vve6]
      ,[ves6]
      ,[vit6]
      ,[vsaa6]
      ,[vmu6]
      ,[vyht6]
      ,[veny]
      ,[vruy]
      ,[vsuy]
      ,[vray]
      ,[vsay]
      ,[vvey]
      ,[vesy]
      ,[vity]
      ,[vsaay]
      ,[vmuy]
      ,[vyht]
      ,[venn]
      ,[vrun]
      ,[vsun]
      ,[vran]
      ,[vsan]
      ,[vven]
      ,[vesn]
      ,[vitn]
      ,[vsaan]
      ,[vmun]
      ,[vtyt]
      ,[ov79yc]
      ,[ov79nc]
      ,[yaen1]
      ,[yaru1]
      ,[yasu1]
      ,[yara1]
      ,[yasa1]
      ,[yave1]
      ,[yaes1]
      ,[yait1]
      ,[yasaa1]
      ,[yalat1]
      ,[yamuu1]
      ,[yaen2]
      ,[yaru2]
      ,[yasu2]
      ,[yara2]
      ,[yasa2]
      ,[yave2]
      ,[yaes2]
      ,[yait2]
      ,[yasaa2]
      ,[yalat2]
      ,[yamuu2]
      ,[yyen]
      ,[yyru]
      ,[yysu]
      ,[yyra]
      ,[yysa]
      ,[yen]
      ,[yru]
      ,[ysu]
      ,[yra]
      ,[ysa]
      ,[yve]
      ,[yes]
      ,[yit]
      ,[ysaa]
      ,[ylat]
      ,[ymuu]
      ,[enyy]
      ,[ruyy]
      ,[suyy]
      ,[rayy]
      ,[sayy]
      ,[veyy]
      ,[esyy]
      ,[ityy]
      ,[saayy]
      ,[layy]
      ,[muyy]
      ,[yaen1n]
      ,[yaru1n]
      ,[yasu1n]
      ,[yara1n]
      ,[yasa1n]
      ,[yave1n]
      ,[yaes1n]
      ,[yait1n]
      ,[yasaa1n]
      ,[yalat1n]
      ,[yamuu1n]
      ,[yaen2n]
      ,[yaru2n]
      ,[yasu2n]
      ,[yara2n]
      ,[yasa2n]
      ,[yave2n]
      ,[yaes2n]
      ,[yait2n]
      ,[yasaa2n]
      ,[yalat2n]
      ,[yamuu2n]
      ,[yyenn]
      ,[yyrun]
      ,[yysun]
      ,[yyran]
      ,[yysan]
      ,[yenn]
      ,[yrun]
      ,[ysun]
      ,[yran]
      ,[ysan]
      ,[yven]
      ,[yesn]
      ,[yitn]
      ,[ysaan]
      ,[ylatn]
      ,[ymuun]
      ,[ennn]
      ,[runn]
      ,[sunn]
      ,[rann]
      ,[sann]
      ,[vennn]
      ,[esnn]
      ,[itnn]
      ,[saann]
      ,[lann]
      ,[munn]
      ,[asv]
      ,[arv]
      ,[asvrv]
      ,[ysv]
      ,[yrv]
      ,[ysvrv]
      ,[sv]
      ,[rv]
      ,[svrv]
      ,[aev]
      ,[aort]
      ,[aisl]
      ,[amu]
      ,[aet]
      ,[aeos]
      ,[akay]
      ,[yev]
      ,[yort]
      ,[yisl]
      ,[ymu]
      ,[yet]
      ,[yeos]
      ,[ykay]
      ,[ev]
      ,[ort]
      ,[isl]
      ,[mu]
      ,[et]
      ,[eos]
      ,[kay]
      ,[ov89yc]
      ,[ov89nc]
      ,[ai]
      ,[rsb]
      ,[ma]
      ,[yl]
      ,[bi]
      ,[ge]
      ,[fy]
      ,[ke]
      ,[ter]
      ,[ue]
      ,[eti]
      ,[hi]
      ,[yh]
      ,[mus]
      ,[ku]
      ,[tt]
      ,[ts]
      ,[li]
      ,[ko]
      ,[yhd]
      ,[ain]
      ,[rsbn]
      ,[man]
      ,[yln]
      ,[bin]
      ,[gen]
      ,[fyn]
      ,[ken]
      ,[tern]
      ,[uen]
      ,[etin]
      ,[hin]
      ,[yhn]
      ,[musn]
      ,[kun]
      ,[ttn]
      ,[tsn]
      ,[lin]
      ,[kon]
      ,[yhdn]
      ,[tietop]
      ,[tietok]
      ,[tietoi]
      ,[verkko]
      ,[kaytto]
      ,[tietolahde]=''R2.22_sopv_15''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_R2_22_sopv_15]
     UNION ALL
    SELECT [tilv]
      ,[jarj]
      ,[tiedtype]
      ,[tunn]
      ,[edesi]
      ,[edala]
      ,[edyla]
      ,[edlisa]
      ,[edainep]
      ,[syesi]
      ,[syala]
      ,[syyla]
      ,[sylisa]
      ,[symamu]
      ,[sylukio]
      ,[syamm]
      ,[symuu]
      ,[keve]
      ,[keven]
      ,[kev1]
      ,[kev1n]
      ,[kev2]
      ,[kev2n]
      ,[kev3]
      ,[kev3n]
      ,[kev4]
      ,[kev4n]
      ,[kev5]
      ,[kev5n]
      ,[kev6]
      ,[kev6n]
      ,[kev7]
      ,[kev7n]
      ,[kev8]
      ,[kev8n]
      ,[kev9]
      ,[kev9n]
      ,[kev10]
      ,[kev10n]
      ,[kev]
      ,[kevn]
      ,[luok1]
      ,[luok1n]
      ,[luok2]
      ,[luok2n]
      ,[luok3]
      ,[luok3n]
      ,[luok4]
      ,[luok4n]
      ,[luok5]
      ,[luok5n]
      ,[luok6]
      ,[luok6n]
      ,[luok7]
      ,[luok7n]
      ,[luok8]
      ,[luok8n]
      ,[luok9]
      ,[luok9n]
      ,[luok]
      ,[luokn]
      ,[kelaim]
      ,[kelaimn]
      ,[tod]
      ,[todn]
      ,[tutkt]
      ,[tutktn]
      ,[suor10]
      ,[suor10n]
      ,[oeriy]
      ,[oeriyn]
      ,[ilmtod]
      ,[ilmtodn]
      ,[aku]
      ,[mamukurs]
      ,[oppkurs]
      ,[muukurs]
      ,[akukurs]
      ,[kmamu]
      ,[kmamun]
      ,[syulkom]
      ,[syulkomn]
      ,[sykoti]
      ,[sykotin]
      ,[ika4e]
      ,[ika4en]
      ,[ika5e]
      ,[ika5en]
      ,[pid5v]
      ,[ika6e]
      ,[ika6en]
      ,[ika7e]
      ,[ika7en]
      ,[ikae]
      ,[ikaen]
      ,[ove]
      ,[ov1]
      ,[ov2]
      ,[ov3]
      ,[ov4]
      ,[ov5]
      ,[ov6]
      ,[ov7]
      ,[ov8]
      ,[ov9]
      ,[ov10]
      ,[ovy]
      ,[tehoe]
      ,[teho1]
      ,[teho2]
      ,[teho3]
      ,[teho4]
      ,[teho5]
      ,[teho6]
      ,[teho7]
      ,[teho8]
      ,[teho9]
      ,[teho10]
      ,[tehoy]
      ,[eipide]
      ,[eipid1]
      ,[eipid2]
      ,[eipid3]
      ,[eipid4]
      ,[eipid5]
      ,[eipid6]
      ,[eipid7]
      ,[eipid8]
      ,[eipid9]
      ,[eipid10]
      ,[eipidy]
      ,[ertuve]
      ,[ertuv1]
      ,[ertuv2]
      ,[ertuv3]
      ,[ertuv4]
      ,[ertuv5]
      ,[ertuv6]
      ,[ertuv7]
      ,[ertuv8]
      ,[ertuv9]
      ,[ertuv10]
      ,[ertuvy]
      ,[ertume]
      ,[ertum1]
      ,[ertum2]
      ,[ertum3]
      ,[ertum4]
      ,[ertum5]
      ,[ertum6]
      ,[ertum7]
      ,[ertum8]
      ,[ertum9]
      ,[ertum10]
      ,[ertumy]
      ,[tavove]
      ,[tavov1]
      ,[tavov2]
      ,[tavov3]
      ,[tavov4]
      ,[tavov5]
      ,[tavov6]
      ,[tavov7]
      ,[tavov8]
      ,[tavov9]
      ,[tavov10]
      ,[tavovy]
      ,[oven]
      ,[ov1n]
      ,[ov2n]
      ,[ov3n]
      ,[ov4n]
      ,[ov5n]
      ,[ov6n]
      ,[ov7n]
      ,[ov8n]
      ,[ov9n]
      ,[ov10n]
      ,[ovyn]
      ,[tehoen]
      ,[teho1n]
      ,[teho2n]
      ,[teho3n]
      ,[teho4n]
      ,[teho5n]
      ,[teho6n]
      ,[teho7n]
      ,[teho8n]
      ,[teho9n]
      ,[teho10n]
      ,[tehoyn]
      ,[eipiden]
      ,[eipid1n]
      ,[eipid2n]
      ,[eipid3n]
      ,[eipid4n]
      ,[eipid5n]
      ,[eipid6n]
      ,[eipid7n]
      ,[eipid8n]
      ,[eipid9n]
      ,[eipid10n]
      ,[eipidyn]
      ,[ertuven]
      ,[ertuv1n]
      ,[ertuv2n]
      ,[ertuv3n]
      ,[ertuv4n]
      ,[ertuv5n]
      ,[ertuv6n]
      ,[ertuv7n]
      ,[ertuv8n]
      ,[ertuv9n]
      ,[ertuv10n]
      ,[ertuvyn]
      ,[ertumen]
      ,[ertum1n]
      ,[ertum2n]
      ,[ertum3n]
      ,[ertum4n]
      ,[ertum5n]
      ,[ertum6n]
      ,[ertum7n]
      ,[ertum8n]
      ,[ertum9n]
      ,[ertum10n]
      ,[ertumyn]
      ,[tavoven]
      ,[tavov1n]
      ,[tavov2n]
      ,[tavov3n]
      ,[tavov4n]
      ,[tavov5n]
      ,[tavov6n]
      ,[tavov7n]
      ,[tavov8n]
      ,[tavov9n]
      ,[tavov10n]
      ,[tavovyn]
      ,[eipidec]
      ,[eipidpc]
      ,[eipidlc]
      ,[eipidyc]
      ,[ertuvec]
      ,[ertuvpc]
      ,[ertuvlc]
      ,[ertuvyc]
      ,[ertumec]
      ,[ertumpc]
      ,[ertumlc]
      ,[ertumyc]
      ,[muuec]
      ,[muupc]
      ,[muulc]
      ,[muuyc]
      ,[ovec]
      ,[ovpc]
      ,[ovlc]
      ,[ovyc]
      ,[sisae]
      ,[sisap]
      ,[sisal]
      ,[sisam]
      ,[sisay]
      ,[maeipide]
      ,[maeipidp]
      ,[maeipidl]
      ,[maeipidy]
      ,[maertuve]
      ,[maertuvp]
      ,[maertuvl]
      ,[maertuvy]
      ,[maertume]
      ,[maertump]
      ,[maertuml]
      ,[maertumy]
      ,[mamuue]
      ,[mamuup]
      ,[mamuul]
      ,[mamuuy]
      ,[maove]
      ,[maovp]
      ,[maovl]
      ,[maovy]
      ,[kueipide]
      ,[kueipidp]
      ,[kueipidl]
      ,[kueipidy]
      ,[kuertuve]
      ,[kuertuvp]
      ,[kuertuvl]
      ,[kuertuvy]
      ,[kuertume]
      ,[kuertump]
      ,[kuertuml]
      ,[kuertumy]
      ,[kumuue]
      ,[kumuup]
      ,[kumuul]
      ,[kumuuy]
      ,[kuove]
      ,[kuovp]
      ,[kuovl]
      ,[kuovy]
      ,[vieipide]
      ,[vieipidp]
      ,[vieipidl]
      ,[vieipidy]
      ,[viertuve]
      ,[viertuvp]
      ,[viertuvl]
      ,[viertuvy]
      ,[viertume]
      ,[viertump]
      ,[viertuml]
      ,[viertumy]
      ,[vimuue]
      ,[vimuup]
      ,[vimuul]
      ,[vimuuy]
      ,[viove]
      ,[viovp]
      ,[viovl]
      ,[viovy]
      ,[ika61]
      ,[ika61n]
      ,[ika71]
      ,[ika71n]
      ,[ika81]
      ,[ika81n]
      ,[ika91]
      ,[ika91n]
      ,[ika1]
      ,[ika1n]
      ,[lykk]
      ,[lykkn]
      ,[jopo]
      ,[jopon]
      ,[kan17v]
      ,[muu17v]
      ,[op17v]
      ,[lukoko]
      ,[lukokon]
      ,[luib]
      ,[luibn]
      ,[reife]
      ,[reifen]
      ,[gymn]
      ,[gymnn]
      ,[lueb]
      ,[luebn]
      ,[lukio]
      ,[lukion]
      ,[opsamm]
      ,[opsammn]
      ,[muuamm]
      ,[muuammn]
      ,[amm]
      ,[ammn]
      ,[peain]
      ,[peainn]
      ,[luain]
      ,[luainn]
      ,[vapsiv]
      ,[vapsivn]
      ,[taiop]
      ,[taiopn]
      ,[muukoul]
      ,[muukouln]
      ,[muuop]
      ,[muuopn]
      ,[tehoec]
      ,[teho16c]
      ,[teho79c]
      ,[teholc]
      ,[tehoyc]
      ,[ertuec]
      ,[ertu16c]
      ,[ertu79c]
      ,[ertulc]
      ,[ertuyc]
      ,[eritec]
      ,[erit16c]
      ,[erit79c]
      ,[eritlc]
      ,[erityc]
      ,[inte4]
      ,[int164]
      ,[int794]
      ,[intl4]
      ,[inty4]
      ,[inte3]
      ,[int163]
      ,[int793]
      ,[intl3]
      ,[inty3]
      ,[inte2]
      ,[int162]
      ,[int792]
      ,[intl2]
      ,[inty2]
      ,[inte1]
      ,[int161]
      ,[int791]
      ,[intl1]
      ,[inty1]
      ,[inte0]
      ,[int160]
      ,[int790]
      ,[intl0]
      ,[inty0]
      ,[intey]
      ,[int16y]
      ,[int79y]
      ,[intly]
      ,[intyy]
      ,[yks160]
      ,[yks790]
      ,[yksl0]
      ,[yksy0]
      ,[yks161]
      ,[yks791]
      ,[yksl1]
      ,[yksy1]
      ,[yks162]
      ,[yks792]
      ,[yksl2]
      ,[yksy2]
      ,[yks164]
      ,[yks794]
      ,[yksl4]
      ,[yksy4]
      ,[yks16t]
      ,[yks79t]
      ,[ykslt]
      ,[yksyt]
      ,[yks16y]
      ,[yks79y]
      ,[yksly]
      ,[yksyy]
      ,[tehoosa]
      ,[ertuosa]
      ,[eritosa]
      ,[tehotuki]
      ,[ertutuki]
      ,[erittuki]
      ,[tehoavu]
      ,[ertuavu]
      ,[eritavu]
      ,[tehomuu]
      ,[ertumuu]
      ,[eritmuu]
      ,[alc]
      ,[ylc]
      ,[luc]
      ,[amc]
      ,[alkieli0]
      ,[alkieli1]
      ,[alkieli2]
      ,[alkieli3]
      ,[alkieli4]
      ,[alkieliy]
      ,[ylkieli0]
      ,[ylkieli1]
      ,[ylkieli2]
      ,[ylkieli3]
      ,[ylkieli4]
      ,[ylkieli5]
      ,[ylkieliy]
      ,[lukieli0]
      ,[lukieli1]
      ,[lukieli2]
      ,[lukieli3]
      ,[lukieli4]
      ,[lukieli5]
      ,[lukieli6]
      ,[lukieliy]
      ,[amkieli0]
      ,[amkieli1]
      ,[amkieli2]
      ,[amkieli3]
      ,[amkieli4]
      ,[amkieli5]
      ,[amkieli6]
      ,[amkieliy]
      ,[aleny]
      ,[alruy]
      ,[alsuy]
      ,[alray]
      ,[alsay]
      ,[alvey]
      ,[alesy]
      ,[ality]
      ,[alsaay]
      ,[almuy]
      ,[yleny]
      ,[ylruy]
      ,[ylsuy]
      ,[ylray]
      ,[ylsay]
      ,[ylvey]
      ,[ylesy]
      ,[ylity]
      ,[ylsaay]
      ,[yllaty]
      ,[ylmuy]
      ,[lueny]
      ,[luruy]
      ,[lusuy]
      ,[luray]
      ,[lusay]
      ,[luvey]
      ,[luesy]
      ,[luity]
      ,[lusaay]
      ,[lulaty]
      ,[lumuy]
      ,[ameny]
      ,[amruy]
      ,[amsuy]
      ,[amray]
      ,[amsay]
      ,[amvey]
      ,[amesy]
      ,[amity]
      ,[amsaay]
      ,[amlaty]
      ,[ammuy]
      ,[ov1c]
      ,[ov2c]
      ,[ov3c]
      ,[ov4c]
      ,[ov5c]
      ,[ov6c]
      ,[ov16yc]
      ,[ov16nc]
      ,[eng1]
      ,[ru1]
      ,[su1]
      ,[ra1]
      ,[sa1]
      ,[ve1]
      ,[es1]
      ,[it1]
      ,[saa1]
      ,[mu1]
      ,[eopis1]
      ,[eng2]
      ,[ru2]
      ,[su2]
      ,[ra2]
      ,[sa2]
      ,[ve2]
      ,[es2]
      ,[it2]
      ,[saa2]
      ,[mu2]
      ,[eopis2]
      ,[eng3]
      ,[ru3]
      ,[su3]
      ,[ra3]
      ,[sa3]
      ,[ve3]
      ,[es3]
      ,[it3]
      ,[saa3]
      ,[mu3]
      ,[eopis3]
      ,[eng4]
      ,[ru4]
      ,[su4]
      ,[ra4]
      ,[sa4]
      ,[ve4]
      ,[es4]
      ,[it4]
      ,[saa4]
      ,[mu4]
      ,[eopis4]
      ,[eng5]
      ,[ru5]
      ,[su5]
      ,[ra5]
      ,[sa5]
      ,[ve5]
      ,[es5]
      ,[it5]
      ,[saa5]
      ,[mu5]
      ,[eopis5]
      ,[eng6]
      ,[ru6]
      ,[su6]
      ,[ra6]
      ,[sa6]
      ,[ve6]
      ,[es6]
      ,[it6]
      ,[saa6]
      ,[mu6]
      ,[eopis6]
      ,[eny]
      ,[ruy]
      ,[suy]
      ,[ray]
      ,[say]
      ,[vey]
      ,[esy]
      ,[ity]
      ,[saay]
      ,[muy]
      ,[eopisy]
      ,[enn]
      ,[run]
      ,[sun]
      ,[ran]
      ,[san]
      ,[ven]
      ,[esn]
      ,[itn]
      ,[saan]
      ,[mun]
      ,[eopisn]
      ,[ven1]
      ,[vru1]
      ,[vsu1]
      ,[vra1]
      ,[vsa1]
      ,[vve1]
      ,[ves1]
      ,[vit1]
      ,[vsaa1]
      ,[vmu1]
      ,[vyht1]
      ,[ven2]
      ,[vru2]
      ,[vsu2]
      ,[vra2]
      ,[vsa2]
      ,[vve2]
      ,[ves2]
      ,[vit2]
      ,[vsaa2]
      ,[vmu2]
      ,[vyht2]
      ,[ven3]
      ,[vru3]
      ,[vsu3]
      ,[vra3]
      ,[vsa3]
      ,[vve3]
      ,[ves3]
      ,[vit3]
      ,[vsaa3]
      ,[vmu3]
      ,[vyht3]
      ,[ven4]
      ,[vru4]
      ,[vsu4]
      ,[vra4]
      ,[vsa4]
      ,[vve4]
      ,[ves4]
      ,[vit4]
      ,[vsaa4]
      ,[vmu4]
      ,[vyht4]
      ,[ven5]
      ,[vru5]
      ,[vsu5]
      ,[vra5]
      ,[vsa5]
      ,[vve5]
      ,[ves5]
      ,[vit5]
      ,[vsaa5]
      ,[vmu5]
      ,[vyht5]
      ,[ven6]
      ,[vru6]
      ,[vsu6]
      ,[vra6]
      ,[vsa6]
      ,[vve6]
      ,[ves6]
      ,[vit6]
      ,[vsaa6]
      ,[vmu6]
      ,[vyht6]
      ,[veny]
      ,[vruy]
      ,[vsuy]
      ,[vray]
      ,[vsay]
      ,[vvey]
      ,[vesy]
      ,[vity]
      ,[vsaay]
      ,[vmuy]
      ,[vyht]
      ,[venn]
      ,[vrun]
      ,[vsun]
      ,[vran]
      ,[vsan]
      ,[vven]
      ,[vesn]
      ,[vitn]
      ,[vsaan]
      ,[vmun]
      ,[vtyt]
      ,[ov79yc]
      ,[ov79nc]
      ,[yaen1]
      ,[yaru1]
      ,[yasu1]
      ,[yara1]
      ,[yasa1]
      ,[yave1]
      ,[yaes1]
      ,[yait1]
      ,[yasaa1]
      ,[yalat1]
      ,[yamuu1]
      ,[yaen2]
      ,[yaru2]
      ,[yasu2]
      ,[yara2]
      ,[yasa2]
      ,[yave2]
      ,[yaes2]
      ,[yait2]
      ,[yasaa2]
      ,[yalat2]
      ,[yamuu2]
      ,[yyen]
      ,[yyru]
      ,[yysu]
      ,[yyra]
      ,[yysa]
      ,[yen]
      ,[yru]
      ,[ysu]
      ,[yra]
      ,[ysa]
      ,[yve]
      ,[yes]
      ,[yit]
      ,[ysaa]
      ,[ylat]
      ,[ymuu]
      ,[enyy]
      ,[ruyy]
      ,[suyy]
      ,[rayy]
      ,[sayy]
      ,[veyy]
      ,[esyy]
      ,[ityy]
      ,[saayy]
      ,[layy]
      ,[muyy]
      ,[yaen1n]
      ,[yaru1n]
      ,[yasu1n]
      ,[yara1n]
      ,[yasa1n]
      ,[yave1n]
      ,[yaes1n]
      ,[yait1n]
      ,[yasaa1n]
      ,[yalat1n]
      ,[yamuu1n]
      ,[yaen2n]
      ,[yaru2n]
      ,[yasu2n]
      ,[yara2n]
      ,[yasa2n]
      ,[yave2n]
      ,[yaes2n]
      ,[yait2n]
      ,[yasaa2n]
      ,[yalat2n]
      ,[yamuu2n]
      ,[yyenn]
      ,[yyrun]
      ,[yysun]
      ,[yyran]
      ,[yysan]
      ,[yenn]
      ,[yrun]
      ,[ysun]
      ,[yran]
      ,[ysan]
      ,[yven]
      ,[yesn]
      ,[yitn]
      ,[ysaan]
      ,[ylatn]
      ,[ymuun]
      ,[ennn]
      ,[runn]
      ,[sunn]
      ,[rann]
      ,[sann]
      ,[vennn]
      ,[esnn]
      ,[itnn]
      ,[saann]
      ,[lann]
      ,[munn]
      ,[asv]
      ,[arv]
      ,[asvrv]
      ,[ysv]
      ,[yrv]
      ,[ysvrv]
      ,[sv]
      ,[rv]
      ,[svrv]
      ,[aev]
      ,[aort]
      ,[aisl]
      ,[amu]
      ,[aet]
      ,[aeos]
      ,[akay]
      ,[yev]
      ,[yort]
      ,[yisl]
      ,[ymu]
      ,[yet]
      ,[yeos]
      ,[ykay]
      ,[ev]
      ,[ort]
      ,[isl]
      ,[mu]
      ,[et]
      ,[eos]
      ,[kay]
      ,[ov89yc]
      ,[ov89nc]
      ,[ai]
      ,[rsb]
      ,[ma]
      ,[yl]
      ,[bi]
      ,[ge]
      ,[fy]
      ,[ke]
      ,[ter]
      ,[ue]
      ,[eti]
      ,[hi]
      ,[yh]
      ,[mus]
      ,[ku]
      ,[tt]
      ,[ts]
      ,[li]
      ,[ko]
      ,[yhd]
      ,[ain]
      ,[rsbn]
      ,[man]
      ,[yln]
      ,[bin]
      ,[gen]
      ,[fyn]
      ,[ken]
      ,[tern]
      ,[uen]
      ,[etin]
      ,[hin]
      ,[yhn]
      ,[musn]
      ,[kun]
      ,[ttn]
      ,[tsn]
      ,[lin]
      ,[kon]
      ,[yhdn]
      ,[tietop]
      ,[tietok]
      ,[tietoi]
      ,[verkko]
      ,[kaytto]
      ,[tietolahde]=''R2.22_sopv_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_R2_22_sopv_16]

/*
  UNION ALL 
  --Aineisto 2.1
    SELECT [tilv]
      ,[jarj]
      ,[tiedtype] =NULL
      ,[tunn]
      ,[edesi] =NULL
      ,[edala] =NULL
      ,[edyla] =NULL
      ,[edlisa] =NULL
      ,[edainep] =NULL
      ,[syesi] =NULL
      ,[syala] =NULL
      ,[syyla] =NULL
      ,[sylisa] =NULL
      ,[symamu] =NULL
      ,[sylukio] =NULL
      ,[syamm] =NULL
      ,[symuu] =NULL
      ,[keve] =NULL
      ,[keven] =NULL
      ,[kev1]
      ,[kev1n]
      ,[kev2]
      ,[kev2n]
      ,[kev3]
      ,[kev3n]
      ,[kev4]
      ,[kev4n]
      ,[kev5]
      ,[kev5n]
      ,[kev6]
      ,[kev6n]
      ,[kev7]
      ,[kev7n]
      ,[kev8]
      ,[kev8n]
      ,[kev9]
      ,[kev9n]
      ,[kev10] =NULL
      ,[kev10n] =NULL
      ,[kev]
      ,[kevn]
      ,[luok1]
      ,[luok1n]
      ,[luok2]
      ,[luok2n]
      ,[luok3]
      ,[luok3n]
      ,[luok4]
      ,[luok4n]
      ,[luok5]
      ,[luok5n]
      ,[luok6]
      ,[luok6n]
      ,[luok7]
      ,[luok7n]
      ,[luok8]
      ,[luok8n]
      ,[luok9]
      ,[luok9n]
      ,[luok]
      ,[luokn]
      ,[kelaim] =NULL
      ,[kelaimn] =NULL
      ,[tod]
      ,[todn]
      ,[tutkt]
      ,[tutktn]
      ,[suor10]
      ,[suor10n]
      ,[oeriy]
      ,[oeriyn] =NULL
      ,[ilmtod] =NULL
      ,[ilmtodn] =NULL
      ,[aku] =NULL
      ,[mamukurs] =NULL
      ,[oppkurs] =NULL
      ,[muukurs] =NULL
      ,[akukurs] =NULL
      ,[kmamu] =NULL
      ,[kmamun] =NULL
      ,[syulkom] =NULL
      ,[syulkomn] =NULL
      ,[sykoti] =NULL
      ,[sykotin] =NULL
      ,[ika4e] =NULL
      ,[ika4en] =NULL
      ,[ika5e]
      ,[ika5en]
      ,[pid5v] =NULL
      ,[ika6e]
      ,[ika6en]
      ,[ika7e]
      ,[ika7en]
      ,[ikae]
      ,[ikaen]
      ,[ove]
      ,[ov1]
      ,[ov2]
      ,[ov3]
      ,[ov4]
      ,[ov5]
      ,[ov6]
      ,[ov7]
      ,[ov8]
      ,[ov9]
      ,[ov10]
      ,[ovy]
      ,[tehoe] =NULL
      ,[teho1] =NULL
      ,[teho2] =NULL
      ,[teho3] =NULL
      ,[teho4] =NULL
      ,[teho5] =NULL
      ,[teho6] =NULL
      ,[teho7] =NULL
      ,[teho8] =NULL
      ,[teho9] =NULL
      ,[teho10] =NULL
      ,[tehoy] =NULL
      ,[eipide] =NULL
      ,[eipid1] =NULL
      ,[eipid2] =NULL
      ,[eipid3] =NULL
      ,[eipid4] =NULL
      ,[eipid5] =NULL
      ,[eipid6] =NULL
      ,[eipid7] =NULL
      ,[eipid8] =NULL
      ,[eipid9] =NULL
      ,[eipid10] =NULL
      ,[eipidy] =NULL
      ,[ertuve] =NULL
      ,[ertuv1] =NULL
      ,[ertuv2] =NULL
      ,[ertuv3] =NULL
      ,[ertuv4] =NULL
      ,[ertuv5] =NULL
      ,[ertuv6] =NULL
      ,[ertuv7] =NULL
      ,[ertuv8] =NULL
      ,[ertuv9] =NULL
      ,[ertuv10] =NULL
      ,[ertuvy] =NULL
      ,[ertume] =NULL
      ,[ertum1] =NULL
      ,[ertum2] =NULL
      ,[ertum3] =NULL
      ,[ertum4] =NULL
      ,[ertum5] =NULL
      ,[ertum6] =NULL
      ,[ertum7] =NULL
      ,[ertum8] =NULL
      ,[ertum9] =NULL
      ,[ertum10] =NULL
      ,[ertumy] =NULL
      ,[tavove] =NULL
      ,[tavov1] =NULL
      ,[tavov2] =NULL
      ,[tavov3] =NULL
      ,[tavov4] =NULL
      ,[tavov5] =NULL
      ,[tavov6] =NULL
      ,[tavov7] =NULL
      ,[tavov8] =NULL
      ,[tavov9] =NULL
      ,[tavov10] =NULL
      ,[tavovy] =NULL
      ,[oven]
      ,[ov1n]
      ,[ov2n]
      ,[ov3n]
      ,[ov4n]
      ,[ov5n]
      ,[ov6n]
      ,[ov7n]
      ,[ov8n]
      ,[ov9n]
      ,[ov10n]
      ,[ovyn]
      ,[tehoen] =NULL
      ,[teho1n] =NULL
      ,[teho2n] =NULL
      ,[teho3n] =NULL
      ,[teho4n] =NULL
      ,[teho5n] =NULL
      ,[teho6n] =NULL
      ,[teho7n] =NULL
      ,[teho8n] =NULL
      ,[teho9n] =NULL
      ,[teho10n] =NULL
      ,[tehoyn] =NULL
      ,[eipiden] =NULL
      ,[eipid1n] =NULL
      ,[eipid2n] =NULL
      ,[eipid3n] =NULL
      ,[eipid4n] =NULL
      ,[eipid5n] =NULL
      ,[eipid6n] =NULL
      ,[eipid7n] =NULL
      ,[eipid8n] =NULL
      ,[eipid9n] =NULL
      ,[eipid10n] =NULL
      ,[eipidyn] =NULL
      ,[ertuven] =NULL
      ,[ertuv1n] =NULL
      ,[ertuv2n] =NULL
      ,[ertuv3n] =NULL
      ,[ertuv4n] =NULL
      ,[ertuv5n] =NULL
      ,[ertuv6n] =NULL
      ,[ertuv7n] =NULL
      ,[ertuv8n] =NULL
      ,[ertuv9n] =NULL
      ,[ertuv10n] =NULL
      ,[ertuvyn] =NULL
      ,[ertumen] =NULL
      ,[ertum1n] =NULL
      ,[ertum2n] =NULL
      ,[ertum3n] =NULL
      ,[ertum4n] =NULL
      ,[ertum5n] =NULL
      ,[ertum6n] =NULL
      ,[ertum7n] =NULL
      ,[ertum8n] =NULL
      ,[ertum9n] =NULL
      ,[ertum10n] =NULL
      ,[ertumyn] =NULL
      ,[tavoven] =NULL
      ,[tavov1n] =NULL
      ,[tavov2n] =NULL
      ,[tavov3n] =NULL
      ,[tavov4n] =NULL
      ,[tavov5n] =NULL
      ,[tavov6n] =NULL
      ,[tavov7n] =NULL
      ,[tavov8n] =NULL
      ,[tavov9n] =NULL
      ,[tavov10n] =NULL
      ,[tavovyn] =NULL
      ,[eipidec] =NULL
      ,[eipidpc] =NULL
      ,[eipidlc] =NULL
      ,[eipidyc] =NULL
      ,[ertuvec] =NULL
      ,[ertuvpc] =NULL
      ,[ertuvlc] =NULL
      ,[ertuvyc] =NULL
      ,[ertumec] =NULL
      ,[ertumpc] =NULL
      ,[ertumlc] =NULL
      ,[ertumyc] =NULL
      ,[muuec] =NULL
      ,[muupc] =NULL
      ,[muulc] =NULL
      ,[muuyc] =NULL
      ,[ovec] =NULL
      ,[ovpc] =NULL
      ,[ovlc] =NULL
      ,[ovyc] =NULL
      ,[sisae] =NULL
      ,[sisap] =NULL
      ,[sisal] =NULL
      ,[sisam] =NULL
      ,[sisay] =NULL
      ,[maeipide] =NULL
      ,[maeipidp] =NULL
      ,[maeipidl] =NULL
      ,[maeipidy] =NULL
      ,[maertuve] =NULL
      ,[maertuvp] =NULL
      ,[maertuvl] =NULL
      ,[maertuvy] =NULL
      ,[maertume] =NULL
      ,[maertump] =NULL
      ,[maertuml] =NULL
      ,[maertumy] =NULL
      ,[mamuue] =NULL
      ,[mamuup] =NULL
      ,[mamuul] =NULL
      ,[mamuuy] =NULL
      ,[maove] =NULL
      ,[maovp] =NULL
      ,[maovl] =NULL
      ,[maovy] =NULL
      ,[kueipide] =NULL
      ,[kueipidp] =NULL
      ,[kueipidl] =NULL
      ,[kueipidy] =NULL
      ,[kuertuve] =NULL
      ,[kuertuvp] =NULL
      ,[kuertuvl] =NULL
      ,[kuertuvy] =NULL
      ,[kuertume] =NULL
      ,[kuertump] =NULL
      ,[kuertuml] =NULL
      ,[kuertumy] =NULL
      ,[kumuue] =NULL
      ,[kumuup] =NULL
      ,[kumuul] =NULL
      ,[kumuuy] =NULL
      ,[kuove] =NULL
      ,[kuovp] =NULL
      ,[kuovl] =NULL
      ,[kuovy] =NULL
      ,[vieipide] =NULL
      ,[vieipidp] =NULL
      ,[vieipidl] =NULL
      ,[vieipidy] =NULL
      ,[viertuve] =NULL
      ,[viertuvp] =NULL
      ,[viertuvl] =NULL
      ,[viertuvy] =NULL
      ,[viertume] =NULL
      ,[viertump] =NULL
      ,[viertuml] =NULL
      ,[viertumy] =NULL
      ,[vimuue] =NULL
      ,[vimuup] =NULL
      ,[vimuul] =NULL
      ,[vimuuy] =NULL
      ,[viove] =NULL
      ,[viovp] =NULL
      ,[viovl] =NULL
      ,[viovy] =NULL
      ,[ika61]
      ,[ika61n]
      ,[ika71]
      ,[ika71n]
      ,[ika81]
      ,[ika81n]
      ,[ika91]
      ,[ika91n]
      ,[ika1]
      ,[ika1n]
      ,[lykk]
      ,[lykkn]
      ,[jopo] =NULL
      ,[jopon] =NULL
      ,[kan17v] =NULL
      ,[muu17v] =NULL
      ,[op17v] =NULL
      ,[lukoko] =NULL
      ,[lukokon] =NULL
      ,[luib] =NULL
      ,[luibn] =NULL
      ,[reife] =NULL
      ,[reifen] =NULL
      ,[gymn] =NULL
      ,[gymnn] =NULL
      ,[lueb] =NULL
      ,[luebn] =NULL
      ,[lukio] =NULL
      ,[lukion] =NULL
      ,[opsamm] =NULL
      ,[opsammn] =NULL
      ,[muuamm] =NULL
      ,[muuammn] =NULL
      ,[amm] =NULL
      ,[ammn] =NULL
      ,[peain] =NULL
      ,[peainn] =NULL
      ,[luain] =NULL
      ,[luainn] =NULL
      ,[vapsiv] =NULL
      ,[vapsivn] =NULL
      ,[taiop] =NULL
      ,[taiopn] =NULL
      ,[muukoul] =NULL
      ,[muukouln] =NULL
      ,[muuop] =NULL
      ,[muuopn] =NULL
      ,[tehoec] =NULL
      ,[teho16c] =NULL
      ,[teho79c] =NULL
      ,[teholc] =NULL
      ,[tehoyc] =NULL
      ,[ertuec] =NULL
      ,[ertu16c] =NULL
      ,[ertu79c] =NULL
      ,[ertulc] =NULL
      ,[ertuyc] =NULL
      ,[eritec] =NULL
      ,[erit16c] =NULL
      ,[erit79c] =NULL
      ,[eritlc] =NULL
      ,[erityc] =NULL
      ,[inte4] =NULL
      ,[int164] =NULL
      ,[int794] =NULL
      ,[intl4] =NULL
      ,[inty4] =NULL
      ,[inte3] =NULL
      ,[int163] =NULL
      ,[int793] =NULL
      ,[intl3] =NULL
      ,[inty3] =NULL
      ,[inte2] =NULL
      ,[int162] =NULL
      ,[int792] =NULL
      ,[intl2] =NULL
      ,[inty2] =NULL
      ,[inte1] =NULL
      ,[int161] =NULL
      ,[int791] =NULL
      ,[intl1] =NULL
      ,[inty1] =NULL
      ,[inte0] =NULL
      ,[int160] =NULL
      ,[int790] =NULL
      ,[intl0] =NULL
      ,[inty0] =NULL
      ,[intey] =NULL
      ,[int16y] =NULL
      ,[int79y] =NULL
      ,[intly] =NULL
      ,[intyy] =NULL
      ,[yks160] =NULL
      ,[yks790] =NULL
      ,[yksl0] =NULL
      ,[yksy0] =NULL
      ,[yks161] =NULL
      ,[yks791] =NULL
      ,[yksl1] =NULL
      ,[yksy1] =NULL
      ,[yks162] =NULL
      ,[yks792] =NULL
      ,[yksl2] =NULL
      ,[yksy2] =NULL
      ,[yks164] =NULL
      ,[yks794] =NULL
      ,[yksl4] =NULL
      ,[yksy4] =NULL
      ,[yks16t] =NULL
      ,[yks79t] =NULL
      ,[ykslt] =NULL
      ,[yksyt] =NULL
      ,[yks16y] =NULL
      ,[yks79y] =NULL
      ,[yksly] =NULL
      ,[yksyy] =NULL
      ,[tehoosa] =NULL
      ,[ertuosa] =NULL
      ,[eritosa] =NULL
      ,[tehotuki] =NULL
      ,[ertutuki] =NULL
      ,[erittuki] =NULL
      ,[tehoavu] =NULL
      ,[ertuavu] =NULL
      ,[eritavu] =NULL
      ,[tehomuu] =NULL
      ,[ertumuu] =NULL
      ,[eritmuu] =NULL
      ,[alc] =NULL
      ,[ylc] =NULL
      ,[luc] =NULL
      ,[amc] =NULL
      ,[alkieli0] =NULL
      ,[alkieli1] =NULL
      ,[alkieli2] =NULL
      ,[alkieli3] =NULL
      ,[alkieli4] =NULL
      ,[alkieliy] =NULL
      ,[ylkieli0] =NULL
      ,[ylkieli1] =NULL
      ,[ylkieli2] =NULL
      ,[ylkieli3] =NULL
      ,[ylkieli4] =NULL
      ,[ylkieli5] =NULL
      ,[ylkieliy] =NULL
      ,[lukieli0] =NULL
      ,[lukieli1] =NULL
      ,[lukieli2] =NULL
      ,[lukieli3] =NULL
      ,[lukieli4] =NULL
      ,[lukieli5] =NULL
      ,[lukieli6] =NULL
      ,[lukieliy] =NULL
      ,[amkieli0] =NULL
      ,[amkieli1] =NULL
      ,[amkieli2] =NULL
      ,[amkieli3] =NULL
      ,[amkieli4] =NULL
      ,[amkieli5] =NULL
      ,[amkieli6] =NULL
      ,[amkieliy] =NULL
      ,[aleny] =NULL
      ,[alruy] =NULL
      ,[alsuy] =NULL
      ,[alray] =NULL
      ,[alsay] =NULL
      ,[alvey] =NULL
      ,[alesy] =NULL
      ,[ality] =NULL
      ,[alsaay] =NULL
      ,[almuy] =NULL
      ,[yleny] =NULL
      ,[ylruy] =NULL
      ,[ylsuy] =NULL
      ,[ylray] =NULL
      ,[ylsay] =NULL
      ,[ylvey] =NULL
      ,[ylesy] =NULL
      ,[ylity] =NULL
      ,[ylsaay] =NULL
      ,[yllaty] =NULL
      ,[ylmuy] =NULL
      ,[lueny] =NULL
      ,[luruy] =NULL
      ,[lusuy] =NULL
      ,[luray] =NULL
      ,[lusay] =NULL
      ,[luvey] =NULL
      ,[luesy] =NULL
      ,[luity] =NULL
      ,[lusaay] =NULL
      ,[lulaty] =NULL
      ,[lumuy] =NULL
      ,[ameny] =NULL
      ,[amruy] =NULL
      ,[amsuy] =NULL
      ,[amray] =NULL
      ,[amsay] =NULL
      ,[amvey] =NULL
      ,[amesy] =NULL
      ,[amity] =NULL
      ,[amsaay] =NULL
      ,[amlaty] =NULL
      ,[ammuy] =NULL
      ,[ov1c] =NULL
      ,[ov2c] =NULL
      ,[ov3c] =NULL
      ,[ov4c] =NULL
      ,[ov5c] =NULL
      ,[ov6c] =NULL
      ,[ov16yc] =NULL
      ,[ov16nc] =NULL
      ,[eng1]
      ,[ru1]
      ,[su1]
      ,[ra1]
      ,[sa1]
      ,[ve1]
      ,[es1] =NULL
      ,[it1] =NULL
      ,[saa1]
      ,[mu1]
      ,[eopis1]
      ,[eng2]
      ,[ru2]
      ,[su2]
      ,[ra2]
      ,[sa2]
      ,[ve2]
      ,[es2] =NULL
      ,[it2] =NULL
      ,[saa2]
      ,[mu2]
      ,[eopis2]
      ,[eng3]
      ,[ru3]
      ,[su3]
      ,[ra3]
      ,[sa3]
      ,[ve3]
      ,[es3] =NULL
      ,[it3] =NULL
      ,[saa3]
      ,[mu3]
      ,[eopis3]
      ,[eng4]
      ,[ru4]
      ,[su4]
      ,[ra4]
      ,[sa4]
      ,[ve4]
      ,[es4] =NULL
      ,[it4] =NULL
      ,[saa4]
      ,[mu4]
      ,[eopis4]
      ,[eng5]
      ,[ru5]
      ,[su5]
      ,[ra5]
      ,[sa5]
      ,[ve5]
      ,[es5] =NULL
      ,[it5] =NULL
      ,[saa5]
      ,[mu5]
      ,[eopis5]
      ,[eng6]
      ,[ru6]
      ,[su6]
      ,[ra6]
      ,[sa6]
      ,[ve6]
      ,[es6] =NULL
      ,[it6] =NULL
      ,[saa6]
      ,[mu6]
      ,[eopis6]
      ,[eny]
      ,[ruy]
      ,[suy]
      ,[ray]
      ,[say]
      ,[vey]
      ,[esy] =NULL
      ,[ity] =NULL
      ,[saay]
      ,[muy]
      ,[eopisy]
      ,[enn]
      ,[run]
      ,[sun]
      ,[ran]
      ,[san]
      ,[ven]
      ,[esn] =NULL
      ,[itn] =NULL
      ,[saan]
      ,[mun]
      ,[eopisn]
      ,[ven1]
      ,[vru1]
      ,[vsu1]
      ,[vra1]
      ,[vsa1]
      ,[vve1]
      ,[ves1] =NULL
      ,[vit1] =NULL
      ,[vsaa1]
      ,[vmu1]
      ,[vyht1]
      ,[ven2]
      ,[vru2]
      ,[vsu2]
      ,[vra2]
      ,[vsa2]
      ,[vve2]
      ,[ves2] =NULL
      ,[vit2] =NULL
      ,[vsaa2]
      ,[vmu2]
      ,[vyht2]
      ,[ven3]
      ,[vru3]
      ,[vsu3]
      ,[vra3]
      ,[vsa3]
      ,[vve3]
      ,[ves3] =NULL
      ,[vit3] =NULL
      ,[vsaa3]
      ,[vmu3]
      ,[vyht3]
      ,[ven4]
      ,[vru4]
      ,[vsu4]
      ,[vra4]
      ,[vsa4]
      ,[vve4]
      ,[ves4] =NULL
      ,[vit4] =NULL
      ,[vsaa4]
      ,[vmu4]
      ,[vyht4]
      ,[ven5]
      ,[vru5]
      ,[vsu5]
      ,[vra5]
      ,[vsa5]
      ,[vve5]
      ,[ves5] =NULL
      ,[vit5] =NULL
      ,[vsaa5]
      ,[vmu5]
      ,[vyht5]
      ,[ven6]
      ,[vru6]
      ,[vsu6]
      ,[vra6]
      ,[vsa6]
      ,[vve6]
      ,[ves6] =NULL
      ,[vit6] =NULL
      ,[vsaa6]
      ,[vmu6]
      ,[vyht6]
      ,[veny]
      ,[vruy]
      ,[vsuy]
      ,[vray]
      ,[vsay]
      ,[vvey]
      ,[vesy] =NULL
      ,[vity] =NULL
      ,[vsaay]
      ,[vmuy]
      ,[vyht]
      ,[venn]
      ,[vrun]
      ,[vsun]
      ,[vran]
      ,[vsan]
      ,[vven]
      ,[vesn] =NULL
      ,[vitn] =NULL
      ,[vsaan]
      ,[vmun]
      ,[vtyt]
      ,[ov79yc] =NULL
      ,[ov79nc] =NULL
      ,[yaen1] =NULL
      ,[yaru1] =NULL
      ,[yasu1] =NULL
      ,[yara1] =NULL
      ,[yasa1] =NULL
      ,[yave1] =NULL
      ,[yaes1] =NULL
      ,[yait1] =NULL
      ,[yasaa1] =NULL
      ,[yalat1] =NULL
      ,[yamuu1] =NULL
      ,[yaen2] =NULL
      ,[yaru2] =NULL
      ,[yasu2] =NULL
      ,[yara2] =NULL
      ,[yasa2] =NULL
      ,[yave2] =NULL
      ,[yaes2] =NULL
      ,[yait2] =NULL
      ,[yasaa2] =NULL
      ,[yalat2] =NULL
      ,[yamuu2] =NULL
      ,[yyen] =NULL
      ,[yyru] =NULL
      ,[yysu] =NULL
      ,[yyra] =NULL
      ,[yysa] =NULL
      ,[yen] =NULL
      ,[yru] =NULL
      ,[ysu] =NULL
      ,[yra] =NULL
      ,[ysa] =NULL
      ,[yve] =NULL
      ,[yes] =NULL
      ,[yit] =NULL
      ,[ysaa] =NULL
      ,[ylat] =NULL
      ,[ymuu] =NULL
      ,[enyy] =NULL
      ,[ruyy] =NULL
      ,[suyy] =NULL
      ,[rayy] =NULL
      ,[sayy] =NULL
      ,[veyy] =NULL
      ,[esyy] =NULL
      ,[ityy] =NULL
      ,[saayy] =NULL
      ,[layy] =NULL
      ,[muyy] =NULL
      ,[yaen1n]
      ,[yaru1n]
      ,[yasu1n]
      ,[yara1n]
      ,[yasa1n]
      ,[yave1n]
      ,[yaes1n] =NULL
      ,[yait1n] =NULL
      ,[yasaa1n]
      ,[yalat1n]
      ,[yamuu1n]
      ,[yaen2n]
      ,[yaru2n]
      ,[yasu2n]
      ,[yara2n]
      ,[yasa2n]
      ,[yave2n]
      ,[yaes2n] =NULL
      ,[yait2n] =NULL
      ,[yasaa2n]
      ,[yalat2n]
      ,[yamuu2n]
      ,[yyenn]
      ,[yyrun]
      ,[yysun]
      ,[yyran]
      ,[yysan]
      ,[yenn]
      ,[yrun]
      ,[ysun]
      ,[yran]
      ,[ysan]
      ,[yven]
      ,[yesn] =NULL
      ,[yitn] =NULL
      ,[ysaan]
      ,[ylatn]
      ,[ymuun]
      ,[ennn]
      ,[runn]
      ,[sunn]
      ,[rann]
      ,[sann]
      ,[vennn]
      ,[esnn] =NULL
      ,[itnn] =NULL
      ,[saann]
      ,[lann]
      ,[munn]
      ,[asv]
      ,[arv]
      ,[asvrv]
      ,[ysv]
      ,[yrv]
      ,[ysvrv]
      ,[sv]
      ,[rv]
      ,[svrv]
      ,[aev]
      ,[aort]
      ,[aisl] =NULL
      ,[amu]
      ,[aet]
      ,[aeos]
      ,[akay]
      ,[yev]
      ,[yort]
      ,[yisl] =NULL
      ,[ymu]
      ,[yet]
      ,[yeos]
      ,[ykay]
      ,[ev]
      ,[ort]
      ,[isl] =NULL
      ,[mu]
      ,[et]
      ,[eos]
      ,[kay]
      ,[ov89yc] =NULL
      ,[ov89nc] =NULL
      ,[ai] =NULL
      ,[rsb] =NULL
      ,[ma] =NULL
      ,[yl] =NULL
      ,[bi] =NULL
      ,[ge] =NULL
      ,[fy] =NULL
      ,[ke] =NULL
      ,[ter] =NULL
      ,[ue] =NULL
      ,[eti] =NULL
      ,[hi] =NULL
      ,[yh] =NULL
      ,[mus] =NULL
      ,[ku] =NULL
      ,[tt] =NULL
      ,[ts] =NULL
      ,[li] =NULL
      ,[ko] =NULL
      ,[yhd] =NULL
      ,[ain] =NULL
      ,[rsbn] =NULL
      ,[man] =NULL
      ,[yln] =NULL
      ,[bin] =NULL
      ,[gen] =NULL
      ,[fyn] =NULL
      ,[ken] =NULL
      ,[tern] =NULL
      ,[uen] =NULL
      ,[etin] =NULL
      ,[hin] =NULL
      ,[yhn] =NULL
      ,[musn] =NULL
      ,[kun] =NULL
      ,[ttn] =NULL
      ,[tsn] =NULL
      ,[lin] =NULL
      ,[kon] =NULL
      ,[yhdn] =NULL
      ,[tietop] =NULL
      ,[tietok] =NULL
      ,[tietoi] =NULL
      ,[verkko] =NULL
      ,[kaytto] =NULL
      ,[tietolahde]
      ,[rivinumero]
  from dbo.sa_2_1_Peruskoulutiedosto_11
*/
  ) Aineistot





' 
GO
/****** Object:  View [dbo].[v_sa_R4_14_Alueella_tyossakayvat_toimialan_ammryhm_ja_koul_mukaan]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_R4_14_Alueella_tyossakayvat_toimialan_ammryhm_ja_koul_mukaan]'))
EXEC dbo.sp_executesql @statement = N'










CREATE VIEW [dbo].[v_sa_R4_14_Alueella_tyossakayvat_toimialan_ammryhm_ja_koul_mukaan] AS

/*
Drop table [VipunenTK_DW].[dbo].[f_R4_14_Alueella_tyossakayvat_toimialan_ammryhm_ja_koul_mukaan]
Select * into [VipunenTK_DW].[dbo].[f_R4_14_Alueella_tyossakayvat_toimialan_ammryhm_ja_koul_mukaan] FROM [TK_H9098_CSC].[dbo].[TK_v_sa_R4_14_Alueella_tyossakayvat_toimialan_ammryhm_ja_koul_mukaan]
Truncate table [VipunenTK_DW].[dbo].[f_R4_14_Alueella_tyossakayvat_toimialan_ammryhm_ja_koul_mukaan]
Insert into [VipunenTK_DW].[dbo].[f_R4_14_Alueella_tyossakayvat_toimialan_ammryhm_ja_koul_mukaan]
  Select * FROM [VipunenTK_SA].[dbo].[v_sa_R4_14_Alueella_tyossakayvat_toimialan_ammryhm_ja_koul_mukaan]
*/

SELECT [tilv] = CAST(kaikkivuodet.tilv as nvarchar(4))
	  ,[tilv_date] = Cast(kaikkivuodet.tilv+''0101'' as date)
      ,[sp] = CAST(kaikkivuodet.sp as nvarchar(10))
      ,[aikielir1] = CAST(kaikkivuodet.aikielir1 as nvarchar(10))
      ,[ikar1] = CAST(kaikkivuodet.ikar1 as nvarchar(10))
      ,[opmast] = CAST(kaikkivuodet.opmast as nvarchar(10))
      ,[tutklaja] = CAST(kaikkivuodet.tutklaja as nvarchar(10))
      ,[opmopa] = CAST(kaikkivuodet.opmopa as nvarchar(10))
      ,[tilvasmaak] = CAST(kaikkivuodet.tilvasmaak as varchar(2))
      ,[tol2008_m1] = CAST(kaikkivuodet.tol2008_m1 as nvarchar(20))
      ,[tol2008_m2] = CAST(kaikkivuodet.tol2008_m2 as nvarchar(20))
      ,[amm2001_m1] = CAST(kaikkivuodet.amm2001_m1 as nvarchar(20))
      ,[amm2001_m2] = CAST(kaikkivuodet.amm2001_m2 as nvarchar(20))
      ,[tsekt] = CAST(kaikkivuodet.tsekt as nvarchar(10))
      ,[tmaak] = CAST(kaikkivuodet.tmaak as nvarchar(10))
      ,[sose] = CAST(kaikkivuodet.sose as nvarchar(10))
      ,[lkm] = CAST(kaikkivuodet.lkm as int)
      ,[tietolahde] = CAST(kaikkivuodet.tietolahde as nvarchar(50))
      ,[rivinumero] = CAST(kaikkivuodet.rivinumero as int)
  FROM (
  SELECT [tilv]
      ,[sp]
      ,[aikielir1]
      ,[ikar1]
      ,[opmast]
      ,[tutklaja]
      ,[opmopa]
      ,[tilvasmaak]=case tilvasmaak when ''20'' then ''01'' else tilvasmaak end
      ,[tol2008_m1]=''MITENNA''+Replace([tol2008_m1],'','',''.'')
      ,[tol2008_m2]=''MITENNA''+Replace([tol2008_m2],'','',''.'')
      ,[amm2001_m1]=Case when amm2001_m1=''12'' then ''-1'' else ''MITENNA2001_''+Replace([amm2001_m1],'','',''.'') End --''MITENNA2001_''+Replace([amm2001_m1],'','',''.'')
      ,[amm2001_m2]=Case when left(amm2001_m2,2)=''12'' then ''-1'' else ''MITENNA2001_''+Replace([amm2001_m2],'','',''.'') End --''MITENNA2001_''+Replace([amm2001_m2],'','',''.'')
      ,[tsekt]
      ,[tmaak]=case tmaak when ''20'' then ''01'' else tmaak end
      ,[sose]
      ,[lkm]
      ,[tietolahde]=''R4_14_sopv_11''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_R4_14_sopv_11]
UNION ALL
SELECT [tilv]
      ,[sp]
      ,[aikielir1]
      ,[ikar1]
      ,[opmast]
      ,[tutklaja]
      ,[opmopa]
      ,[tilvasmaak]=case tilvasmaak when ''99'' then ''-1'' when ''20'' then ''01'' else tilvasmaak end
      ,[tol2008_m1]=''MITENNA''+Replace([tol2008_m1],'','',''.'')
      ,[tol2008_m2]=''MITENNA''+Replace([tol2008_m2],'','',''.'')
      ,[amm2001_m1]=Case when amm2001_m1=''12'' then ''-1'' else ''MITENNA2010_''+Replace([amm2001_m1],'','',''.'') end
      ,[amm2001_m2]=Case when left(amm2001_m2,2)=''12'' then ''-1'' else ''MITENNA2010_''+Replace([amm2001_m2],'','',''.'') end
      ,[tsekt]
      ,[tmaak]=case tmaak when ''20'' then ''01'' else tmaak end
      ,[sose]
      ,[lkm]
      ,[tietolahde]=''R4_14_2010_sopv_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_R4_14_2010_sopv_13]
UNION ALL
SELECT [tilv]
      ,[sp]
      ,[aikielir1]
      ,[ikar1]
      ,[opmast]
      ,[tutklaja]
      ,[opmopa]
      ,[tilvasmaak]
      ,[tol2008_m1]=''MITENNA''+Replace([tol2008_m1],'','',''.'')
      ,[tol2008_m2]=''MITENNA''+Replace([tol2008_m2],'','',''.'')
      ,[amm2001_m1]=Case when amm2001_m1=''12'' then ''-1'' else ''MITENNA2010_''+Replace([amm2001_m1],'','',''.'') end
      ,[amm2001_m2]=Case when left(amm2001_m2,2)=''12'' then ''-1'' else ''MITENNA2010_''+Replace([amm2001_m2],'','',''.'') end
      ,[tsekt]
      ,[tmaak]
      ,[sose]
      ,[lkm]
      ,[tietolahde]=''R4_14_2011_sopv_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_R4_14_2011_sopv_13]
UNION ALL
SELECT [tilv]
      ,[sp]
      ,[aikielir1]
      ,[ikar1]
      ,[opmast]
      ,[tutklaja]
      ,[opmopa]
      ,[tilvasmaak]
      ,[tol2008_m1]=''MITENNA''+Replace([tol2008_m1],'','',''.'')
      ,[tol2008_m2]=''MITENNA''+Replace([tol2008_m2],'','',''.'')
      ,[amm2001_m1]=Case when amm2010_m1=''12'' then ''-1'' else ''MITENNA2010_''+Replace([amm2010_m1],'','',''.'') end
      ,[amm2001_m2]=Case 
	  when left(amm2010_m2,2)=''12'' then ''-1'' 
	  when substring(amm2010_m2,4,1)=0 then ''MITENNA2010_''++Replace(LEFT(amm2010_m2,3),'','',''.'')+RIGHT(amm2010_m2,1)
	  else ''MITENNA2010_''+Replace([amm2010_m2],'','',''.'') end
      ,[tsekt]
      ,[tmaak]
      ,[sose]
      ,[lkm]
      ,[tietolahde]=''R4_14a_2012_sopv_14''
	  ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_R4_14a_sopv_14]
UNION ALL
SELECT [tilv]
      ,[sp]
      ,[aikielir1]
      ,[ikar1]
      ,[opmast]
      ,[tutklaja]
      ,[opmopa]
      ,[tilvasmaak]
      ,[tol2008_m1]=''MITENNA''+Replace(isnull([tol2008_m1],28),'','',''.'')
      ,[tol2008_m2]=''MITENNA''+Replace(isnull([tol2008_m2],''28.0''),'','',''.'')
      ,[amm2001_m1]=Case when amm2010_m1=''12'' then ''-1'' else ''MITENNA2010_''+Replace([amm2010_m1],'','',''.'') end
      ,[amm2001_m2]=Case 
	  when left(amm2010_m2,2)=''12'' then ''-1'' 
	  when substring(amm2010_m2,4,1)=0 then ''MITENNA2010_''++Replace(LEFT(amm2010_m2,3),'','',''.'')+RIGHT(amm2010_m2,1)
	  else ''MITENNA2010_''+Replace([amm2010_m2],'','',''.'') end
      ,[tsekt]
      ,[tmaak]
      ,[sose]
      ,[lkm]
      ,[tietolahde]=''R4_14a_2012_sopv_15''
	  ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_R4_14a_sopv_15]

UNION ALL
SELECT [tilv]
      ,[sp]
      ,[aikielir1]
      ,[ikar1]
      ,[opmast]
      ,[tutklaja]
      ,[opmopa]
      ,[tilvasmaak]
      ,[tol2008_m1]=''MITENNA''+Replace(isnull([tol2008_m1],28),'','',''.'')
      ,[tol2008_m2]=''MITENNA''+Replace(isnull([tol2008_m2],''28.0''),'','',''.'')
      ,[amm2001_m1]=Case when amm2010_m1=''12'' then ''-1'' else ''MITENNA2010_''+Replace([amm2010_m1],'','',''.'') end
      ,[amm2001_m2]=Case 
	  when left(amm2010_m2,2)=''12'' then ''-1'' 
	  when substring(amm2010_m2,4,1)=0 then ''MITENNA2010_''++Replace(LEFT(amm2010_m2,3),'','',''.'')+RIGHT(amm2010_m2,1)
	  else ''MITENNA2010_''+Replace([amm2010_m2],'','',''.'') end
      ,[tsekt]
      ,[tmaak]
      ,[sose]
      ,[lkm]
      ,[tietolahde]=''R4_14a_2012_sopv_16''
	  ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_R4_14a_sopv_16]


) kaikkivuodet










' 
GO
/****** Object:  View [dbo].[v_sa_R4_14b_Alueella_tyossakayvat_tilastokeskuksen_toimialan_mukaan]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_R4_14b_Alueella_tyossakayvat_tilastokeskuksen_toimialan_mukaan]'))
EXEC dbo.sp_executesql @statement = N'









CREATE VIEW [dbo].[v_sa_R4_14b_Alueella_tyossakayvat_tilastokeskuksen_toimialan_mukaan] AS

/*
Drop table [VipunenTK_DW].[dbo].[f_R4_14b_Alueella_tyossakayvat_tilastokeskuksen_toimialan_mukaan]
Select * into [VipunenTK_DW].[dbo].[f_R4_14b_Alueella_tyossakayvat_tilastokeskuksen_toimialan_mukaan] FROM [VipunenTK_SA].[dbo].[v_sa_R4_14b_Alueella_tyossakayvat_tilastokeskuksen_toimialan_mukaan]
Truncate table [VipunenTK_DW].[dbo].[f_R4_14b_Alueella_tyossakayvat_tilastokeskuksen_toimialan_mukaan]
Insert into [VipunenTK_DW].[dbo].[f_R4_14b_Alueella_tyossakayvat_tilastokeskuksen_toimialan_mukaan]
  Select * FROM [VipunenTK_SA].[dbo].[v_sa_R4_14b_Alueella_tyossakayvat_tilastokeskuksen_toimialan_mukaan]
*/

SELECT [tilv] = CAST(kaikkivuodet.tilv as nvarchar(4))
	  ,[tilv_date] = Cast(kaikkivuodet.tilv+''0101'' as date)
      ,[ikar1] = CAST(kaikkivuodet.ikar1 as nvarchar(10))
      ,[opmast] = CAST(kaikkivuodet.opmast as nvarchar(10))
      ,[tutklaja] = CAST(kaikkivuodet.tutklaja as nvarchar(10))
      ,[opmopa] = CAST(kaikkivuodet.opmopa as nvarchar(10))
      ,[tol2008_m1] = CAST(kaikkivuodet.tol2008_m1 as nvarchar(20))
      ,[tol2008_m2] = CAST(kaikkivuodet.tol2008_m2 as nvarchar(20))
	  ,[tol2008] = CAST(kaikkivuodet.tol2008 as nvarchar(20))
      ,[amm2001_m1] = CAST(kaikkivuodet.amm2001_m1 as nvarchar(20))
      ,[amm2001_m2] = CAST(kaikkivuodet.amm2001_m2 as nvarchar(20))
      ,[tmaak] = CAST(kaikkivuodet.tmaak as nvarchar(10))
      ,[lkm] = CAST(kaikkivuodet.lkm as int)
      ,[tietolahde] = CAST(kaikkivuodet.tietolahde as nvarchar(50))
      ,[rivinumero] = CAST(kaikkivuodet.rivinumero as int)
  FROM (
 

SELECT [tilv]
      ,[ikar1]
      ,[opmast]
      ,[tutklaja]
      ,[opmopa]
      ,[tol2008_m1]=''MITENNA''+Replace([tol2008_m1],'','',''.'')
      ,[tol2008_m2]=''MITENNA''+Replace([tol2008_m2],'','',''.'')
	  ,[tol2008]=''TOL''+tol2008
      ,[amm2001_m1]=Case when amm2010_m1=''12'' then ''-1'' else ''MITENNA2010_''+Replace([amm2010_m1],'','',''.'') end
      ,[amm2001_m2]=Case 
	  when left(amm2010_m2,2)=''12'' then ''-1'' 
	  when substring(amm2010_m2,4,1)=0 then ''MITENNA2010_''++Replace(LEFT(amm2010_m2,3),'','',''.'')+RIGHT(amm2010_m2,1)
	  else ''MITENNA2010_''+Replace([amm2010_m2],'','',''.'') end 
      ,[tmaak]
      ,[lkm]
      ,[tietolahde]=''R4_14b_sopv_14''
	  ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_R4_14b_sopv_14]
UNION All
SELECT [tilv]
      ,[ikar1]
      ,[opmast]
      ,[tutklaja]
      ,[opmopa]
      ,[tol2008_m1]=''MITENNA''+Replace(isnull([tol2008_m1],28),'','',''.'')
      ,[tol2008_m2]=''MITENNA''+Replace(isnull([tol2008_m2],''28.0''),'','',''.'')
	  ,[tol2008]=''TOL''+tol2008
      ,[amm2001_m1]=Case when amm2010_m1=''12'' then ''-1'' else ''MITENNA2010_''+Replace([amm2010_m1],'','',''.'') end
      ,[amm2001_m2]=Case 
	  when left(amm2010_m2,2)=''12'' then ''-1'' 
	  when substring(amm2010_m2,4,1)=0 then ''MITENNA2010_''++Replace(LEFT(amm2010_m2,3),'','',''.'')+RIGHT(amm2010_m2,1)
	  else ''MITENNA2010_''+Replace([amm2010_m2],'','',''.'') end 
      ,[tmaak]
      ,[lkm]
      ,[tietolahde]=''R4_14b_sopv_15''
	  ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_R4_14b_sopv_15]

UNION All
SELECT [tilv]
      ,[ikar1]
      ,[opmast]
      ,[tutklaja]
      ,[opmopa]
      ,[tol2008_m1]=''MITENNA''+Replace(isnull([tol2008_m1],28),'','',''.'')
      ,[tol2008_m2]=''MITENNA''+Replace(isnull([tol2008_m2],''28.0''),'','',''.'')
	  ,[tol2008]=''TOL''+tol2008
      ,[amm2001_m1]=Case when amm2010_m1=''12'' then ''-1'' else ''MITENNA2010_''+Replace([amm2010_m1],'','',''.'') end
      ,[amm2001_m2]=Case 
	  when left(amm2010_m2,2)=''12'' then ''-1'' 
	  when substring(amm2010_m2,4,1)=0 then ''MITENNA2010_''++Replace(LEFT(amm2010_m2,3),'','',''.'')+RIGHT(amm2010_m2,1)
	  else ''MITENNA2010_''+Replace([amm2010_m2],'','',''.'') end 
      ,[tmaak]
      ,[lkm]
      ,[tietolahde]=''R4_14b_sopv_16''
	  ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_R4_14b_sopv_16]

) kaikkivuodet










' 
GO
/****** Object:  View [dbo].[v_sa_R4_15_Alueella_tyossakayvat_toimialan_ammryhm_ja_koul_mukaan_1vuotisikaryh]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_R4_15_Alueella_tyossakayvat_toimialan_ammryhm_ja_koul_mukaan_1vuotisikaryh]'))
EXEC dbo.sp_executesql @statement = N'










CREATE VIEW [dbo].[v_sa_R4_15_Alueella_tyossakayvat_toimialan_ammryhm_ja_koul_mukaan_1vuotisikaryh] AS

/*
Drop table [VipunenTK_DW].[dbo].[f_R4_15_Alueella_tyossakayvat_toimialan_ammryhm_ja_koul_mukaan_1vuotisikaryh]
Select * into [VipunenTK_DW].[dbo].[f_R4_15_Alueella_tyossakayvat_toimialan_ammryhm_ja_koul_mukaan_1vuotisikaryh] FROM [TK_H9098_CSC].[dbo].[TK_v_sa_R4_15_Alueella_tyossakayvat_toimialan_ammryhm_ja_koul_mukaan_1vuotisikaryh]
Truncate table [VipunenTK_DW].[dbo].[f_R4_15_Alueella_tyossakayvat_toimialan_ammryhm_ja_koul_mukaan_1vuotisikaryh]
Insert into [VipunenTK_DW].[dbo].[f_R4_15_Alueella_tyossakayvat_toimialan_ammryhm_ja_koul_mukaan_1vuotisikaryh]
  Select * FROM [VipunenTK_SA].[dbo].[v_sa_R4_15_Alueella_tyossakayvat_toimialan_ammryhm_ja_koul_mukaan_1vuotisikaryh]
*/
SELECT [tilv] = CAST(kaikkivuodet.tilv as nvarchar(4))
	  ,[tilv_date] = Cast(kaikkivuodet.tilv+''0101'' as date)
      ,[aikielir1] = CAST(kaikkivuodet.aikielir1 as nvarchar(10))
      ,[ika] = CAST(kaikkivuodet.ika as nvarchar(10))
      ,[tilvasmaak] = CAST(kaikkivuodet.tilvasmaak as nvarchar(10))
      ,[tol2008_m1] = CAST(kaikkivuodet.tol2008_m1 as nvarchar(20))
      ,[tol2008_m2] = CAST(kaikkivuodet.tol2008_m2 as nvarchar(20))
      ,[amm2001_m1] = CAST(kaikkivuodet.amm2001_m1 as nvarchar(20))
      ,[amm2001_m2] = CAST(kaikkivuodet.amm2001_m2 as nvarchar(20))
      ,[tmaak] = CAST(kaikkivuodet.tmaak as nvarchar(10))
      ,[lkm] = CAST(kaikkivuodet.lkm as int)
      ,[tietolahde] = CAST(kaikkivuodet.tietolahde as nvarchar(50))
      ,[rivinumero] = CAST(kaikkivuodet.rivinumero as int)
  FROM (
SELECT [tilv]
      ,[aikielir1]
      ,[ika]
      ,[tilvasmaak]=case tilvasmaak when ''20'' then ''01'' else tilvasmaak end
      ,[tol2008_m1]=''MITENNA''+Replace([tol2008_m1],'','',''.'')
      ,[tol2008_m2]=''MITENNA''+Replace([tol2008_m2],'','',''.'')
      ,[amm2001_m1]=Case when amm2001_m1=''12'' then ''-1'' else ''MITENNA2001_''+Replace([amm2001_m1],'','',''.'') End --''MITENNA2001_''+Replace([amm2001_m1],'','',''.'')
      ,[amm2001_m2]=Case when left(amm2001_m2,2)=''12'' then ''-1'' else ''MITENNA2001_''+Replace([amm2001_m2],'','',''.'') End --''MITENNA2001_''+Replace([amm2001_m2],'','',''.'')
      ,[tmaak]=case tmaak when ''20'' then ''01'' else tmaak end
      ,[lkm]
      ,[tietolahde]=''R4_15_sopv_11''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_R4_15_sopv_11]
UNION ALL
SELECT [tilv]
      ,[aikielir1]
      ,[ika]
      ,[tilvasmaak]= case tilvasmaak when ''99'' then ''-1'' when ''20'' then ''01'' else tilvasmaak end
      ,[tol2008_m1]=''MITENNA''+Replace([tol2008_m1],'','',''.'')
      ,[tol2008_m2]=''MITENNA''+Replace([tol2008_m2],'','',''.'')
      ,[amm2001_m1]=Case when amm2001_m1=''12'' then ''-1'' else ''MITENNA2010_''+Replace([amm2001_m1],'','',''.'') end
      ,[amm2001_m2]=Case when left(amm2001_m2,2)=''12'' then ''-1'' else ''MITENNA2010_''+Replace([amm2001_m2],'','',''.'') end
      ,[tmaak]=case tmaak when ''20'' then ''01'' else tmaak end
      ,[lkm]
      ,[tietolahde]=''R4_15_2010_sopv_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_R4_15_2010_sopv_13]
UNION ALL
SELECT [tilv]
      ,[aikielir1]
      ,[ika]
      ,[tilvasmaak]
      ,[tol2008_m1]=''MITENNA''+Replace([tol2008_m1],'','',''.'')
      ,[tol2008_m2]=''MITENNA''+Replace([tol2008_m2],'','',''.'')
      ,[amm2001_m1]=Case when amm2001_m1=''12'' then ''-1'' else ''MITENNA2010_''+Replace([amm2001_m1],'','',''.'') end
      ,[amm2001_m2]=Case when left(amm2001_m2,2)=''12'' then ''-1'' else ''MITENNA2010_''+Replace([amm2001_m2],'','',''.'') end
      ,[tmaak]
      ,[lkm]
      ,[tietolahde]=''R4_15_2011_sopv_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_R4_15_2011_sopv_13]
UNION ALL
SELECT [tilv]
      ,[aikielir1]
      ,[ika]
      ,[tilvasmaak]
      ,[tol2008_m1]=''MITENNA''+Replace([tol2008_m1],'','',''.'')
      ,[tol2008_m2]=''MITENNA''+Replace([tol2008_m2],'','',''.'')
      ,[amm2001_m1]=Case when amm2010_m1=''12'' then ''-1'' else ''MITENNA2010_''+Replace([amm2010_m1],'','',''.'') end
      ,[amm2001_m2]=Case 
	  when left(amm2010_m2,2)=''12'' then ''-1'' 
	  when substring(amm2010_m2,4,1)=0 then ''MITENNA2010_''++Replace(LEFT(amm2010_m2,3),'','',''.'')+RIGHT(amm2010_m2,1)
	  else ''MITENNA2010_''+Replace([amm2010_m2],'','',''.'') end
      ,[tmaak]
      ,[lkm]
	  ,[tietolahde]=''R4_15_2012_sopv_14''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_R4_15_sopv_14]
UNION ALL
SELECT [tilv]
      ,[aikielir1]
      ,[ika]
      ,[tilvasmaak]
      ,[tol2008_m1]=''MITENNA''+Replace(isnull([tol2008_m1],28),'','',''.'')
      ,[tol2008_m2]=''MITENNA''+Replace(isnull([tol2008_m2],''28.0''),'','',''.'')
      ,[amm2001_m1]=Case when amm2010_m1=''12'' then ''-1'' else ''MITENNA2010_''+Replace([amm2010_m1],'','',''.'') end
      ,[amm2001_m2]=Case 
	  when left(amm2010_m2,2)=''12'' then ''-1'' 
	  when substring(amm2010_m2,4,1)=0 then ''MITENNA2010_''++Replace(LEFT(amm2010_m2,3),'','',''.'')+RIGHT(amm2010_m2,1)
	  else ''MITENNA2010_''+Replace([amm2010_m2],'','',''.'') end
      ,[tmaak]
      ,[lkm]
	  ,[tietolahde]=''R4_15_2012_sopv_15''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_R4_15_sopv_15]

UNION ALL
SELECT [tilv]
      ,[aikielir1]
      ,[ika]
      ,[tilvasmaak]
      ,[tol2008_m1]=''MITENNA''+Replace(isnull([tol2008_m1],28),'','',''.'')
      ,[tol2008_m2]=''MITENNA''+Replace(isnull([tol2008_m2],''28.0''),'','',''.'')
      ,[amm2001_m1]=Case when amm2010_m1=''12'' then ''-1'' else ''MITENNA2010_''+Replace([amm2010_m1],'','',''.'') end
      ,[amm2001_m2]=Case 
	  when left(amm2010_m2,2)=''12'' then ''-1'' 
	  when substring(amm2010_m2,4,1)=0 then ''MITENNA2010_''++Replace(LEFT(amm2010_m2,3),'','',''.'')+RIGHT(amm2010_m2,1)
	  else ''MITENNA2010_''+Replace([amm2010_m2],'','',''.'') end
      ,[tmaak]
      ,[lkm]
	  ,[tietolahde]=''R4_15_2012_sopv_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_R4_15_sopv_16]
 
 
) kaikkivuodet











' 
GO
/****** Object:  View [dbo].[v_sa_R4_16_Tyossakayvat_ammateittain]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_R4_16_Tyossakayvat_ammateittain]'))
EXEC dbo.sp_executesql @statement = N'









CREATE VIEW [dbo].[v_sa_R4_16_Tyossakayvat_ammateittain] AS

/*
Drop table [VipunenTK_DW].[dbo].[f_R4_16_Tyossakayvat_ammateittain]
Select * into [VipunenTK_DW].[dbo].[f_R4_16_Tyossakayvat_ammateittain] FROM [VipunenTK_SA].[dbo].[v_sa_R4_16_Tyossakayvat_ammateittain]
Truncate table [VipunenTK_DW].[dbo].[f_R4_16_Tyossakayvat_ammateittain]
Insert into [VipunenTK_DW].[dbo].[f_R4_16_Tyossakayvat_ammateittain]
  Select * FROM [VipunenTK_SA].[dbo].[v_sa_R4_16_Tyossakayvat_ammateittain]
*/

SELECT [tilv] = CAST(tilv as nvarchar(4))
	  ,[tilv_date] = Cast(tilv+''0101'' as date)
      ,[sp] = CAST(sp as nvarchar(10))
      ,[aikielir1] = CAST(aikielir1 as nvarchar(10))
      ,[ika] = CAST(ika as nvarchar(10))
      ,[opmast] = CAST(opmast as nvarchar(10))
      ,[tutklaja] = CAST(tutklaja as nvarchar(10))
      ,[opmopa] = CAST(opmopa as nvarchar(10))
      ,[amm2001_m1] = CAST(amm2001_m1 as nvarchar(20))
      ,[amm2001_m2] = CAST(amm2001_m2 as nvarchar(20))
      ,[amm2001_m] = CAST(amm2001_m as nvarchar(20))
      ,[lkm] = CAST(lkm as int)
      ,[tietolahde] = CAST(tietolahde as nvarchar(10))
      ,[rivinumero] = CAST(rivinumero as int)
      ,[tmaak] = CAST(tmaak as nvarchar(10))
      ,[amm2001_mnim] = CAST(amm2001_mnim as nvarchar(10))
  FROM 
(
SELECT [tilv]
      ,[sp]
      ,[aikielir1]
      ,[ika]
      ,[opmast]
      ,[tutklaja]
      ,[opmopa]=Case when opmopa=''999'' then ''-1'' else opmopa End
      ,[amm2001_m1]=Case when amm2001_m1=''12'' then ''-1'' else ''MITENNA2001_''+Replace([amm2001_m1],'','',''.'') End
      ,[amm2001_m2]=Case when left(amm2001_m2,2)=''12'' then ''-1'' else ''MITENNA2001_''+Replace([amm2001_m2],'','',''.'') End
      ,[amm2001_m]=Case when Left(amm2001_m,2)=''99'' then ''-1'' else ''MITENNA2001_''+Replace([amm2001_m],'','',''.'') End
      ,[lkm]
      ,[tietolahde]=''R4_16_sopv_11''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
      ,[tmaak]=case tmaak when ''20'' then ''01'' else tmaak end
      ,[amm2001_mnim]
  FROM [TK_H9098_CSC].[dbo].[TK_R4_16_sopv_11]
UNION ALL
SELECT [tilv]
      ,[sp]
      ,[aikielir1]
      ,[ika]
      ,[opmast]
      ,[tutklaja]
      ,[opmopa]=Case when opmopa=''999'' then ''-1'' else opmopa End
      ,[amm2001_m1]=Case when amm2001_m1=''12'' then ''-1'' else ''MITENNA2010_''+Replace([amm2001_m1],'','',''.'') End
      ,[amm2001_m2]=Case when left(amm2001_m2,2)=''12'' then ''-1'' else ''MITENNA2010_''+Replace([amm2001_m2],'','',''.'') End
      ,[amm2001_m]=Case when Left(amm2001_m,1)=''X'' then ''-1'' else ''MITENNA2010_''+Replace([amm2001_m],'','',''.'') End
      --,[amm2001_m]=''MITENNA2010_''+Replace([amm2010],'','',''.'')
      ,[lkm]
      ,[tietolahde]=''R4_16_2010_sopv_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
      ,[tmaak]=case tmaak when ''20'' then ''01'' else tmaak end
      ,[amm2001_mnim]
  FROM [TK_H9098_CSC].[dbo].[TK_R4_16_2010_sopv_13]
UNION ALL
SELECT [tilv]
      ,[sp]
      ,[aikielir1]
      ,[ika]
      ,[opmast]
      ,[tutklaja]
      ,[opmopa]=Case when opmopa=''999'' then ''-1'' else opmopa End
      ,[amm2001_m1]=Case when amm2001_m1=''12'' then ''-1'' else ''MITENNA2010_''+Replace([amm2001_m1],'','',''.'') End
      ,[amm2001_m2]=Case when left(amm2001_m2,2)=''12'' then ''-1'' else ''MITENNA2010_''+Replace([amm2001_m2],'','',''.'') End
      ,[amm2001_m]=Case when Left(amm2001_m,1)=''X'' then ''-1'' else ''MITENNA2010_''+Replace([amm2001_m],'','',''.'') End
      --,[amm2001_m]=''MITENNA2010_''+Replace([amm2010],'','',''.'')
      ,[lkm]
      ,[tietolahde]=''R4_16_2011_sopv_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
      ,[tmaak]
      ,[amm2001_mnim]
  FROM [TK_H9098_CSC].[dbo].[TK_R4_16_2011_sopv_13]
UNION ALL
SELECT [tilv]
      ,[sp]
      ,[aikielir1]
      ,[ika]
      ,[opmast]
      ,[tutklaja]
      ,[opmopa]=Case when opmopa=''999'' then ''-1'' else opmopa End
      ,[amm2001_m1]=Case when amm2010_m1=''12'' then ''-1'' else ''MITENNA2010_''+Replace([amm2010_m1],'','',''.'') End
      ,[amm2001_m2]=Case when left(amm2010_m2,2)=''12'' then ''-1'' else ''MITENNA2010_''+Replace([amm2010_m2],'','',''.'') End
      --LÄHDEAINEISTOSSA PUUTTUU PISTEET AMMATTILUOKITUKSESTA, KORJAUS TEHDÄÄN ALLA
	  ,[amm2001_m]=Case 
					when amm2010=''99999'' then ''-1'' 
					else LEFT(''MITENNA2010_''+Replace([amm2010],'','',''.'')+''.....'',17) End
      ,[lkm]
      ,[tietolahde]=''R4_16_2011_sopv_14''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
      ,[tmaak]
      ,[amm2010_nim]
  FROM [TK_H9098_CSC].[dbo].[TK_R4_16_sopv_14] 
  WHERE tilv!='''' AND tilv!=''asia''
UNION ALL
SELECT [tilv]
      ,[sp]
      ,[aikielir1]
      ,[ika]
      ,[opmast]
      ,[tutklaja]
      ,[opmopa]=Case when opmopa=''999'' then ''-1'' else opmopa End
      ,[amm2001_m1]=Case when amm2010_m1=''12'' then ''-1'' else ''MITENNA2010_''+Replace([amm2010_m1],'','',''.'') End
      ,[amm2001_m2]=Case when left(amm2010_m2,2)=''12'' then ''-1'' else ''MITENNA2010_''+Replace([amm2010_m2],'','',''.'') End
      --LÄHDEAINEISTOSSA PUUTTUU PISTEET AMMATTILUOKITUKSESTA, KORJAUS TEHDÄÄN ALLA
	  ,[amm2001_m]=Case 
					when amm2010=''99999'' then ''-1'' 
					else LEFT(''MITENNA2010_''+Replace([amm2010],'','',''.'')+''.....'',17) End
      ,[lkm]
      ,[tietolahde]=''R4_16_2011_sopv_15''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
      ,[tmaak]
      ,[amm2010_nim]
  FROM [TK_H9098_CSC].[dbo].[TK_R4_16_sopv_15] 

UNION ALL
SELECT [tilv]
      ,[sp]
      ,[aikielir1]
      ,[ika]
      ,[opmast]
      ,[tutklaja]
      ,[opmopa]=Case when opmopa=''999'' then ''-1'' else opmopa End
      ,[amm2001_m1]=Case when amm2010_m1=''12'' then ''-1'' else ''MITENNA2010_''+Replace([amm2010_m1],'','',''.'') End
      ,[amm2001_m2]=Case when left(amm2010_m2,2)=''12'' then ''-1'' else ''MITENNA2010_''+Replace([amm2010_m2],'','',''.'') End
      --LÄHDEAINEISTOSSA PUUTTUU PISTEET AMMATTILUOKITUKSESTA, KORJAUS TEHDÄÄN ALLA
	  ,[amm2001_m]=Case 
					when amm2010=''99999'' then ''-1'' 
					else LEFT(''MITENNA2010_''+Replace([amm2010],'','',''.'')+''.....'',17) End
      ,[lkm]
      ,[tietolahde]=''R4_16_2011_sopv_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
      ,[tmaak]
      ,[amm2010_nim]
  FROM [TK_H9098_CSC].[dbo].[TK_R4_16_sopv_16] 


) kaikkivuodet










' 
GO
/****** Object:  View [dbo].[v_sa_R4_17_Elakkeelle_siirt_ja_heidan_ammatti]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_R4_17_Elakkeelle_siirt_ja_heidan_ammatti]'))
EXEC dbo.sp_executesql @statement = N'
/****** Script for SelectTopNRows command from SSMS  ******/
CREATE VIEW [dbo].[v_sa_R4_17_Elakkeelle_siirt_ja_heidan_ammatti] AS

/**********

drop table [VipunenTK_DW].[dbo].[f_R4_17_Elakkeelle_siirt_ja_heidan_ammatti]

truncate table [VipunenTK_DW].[dbo].[f_R4_17_Elakkeelle_siirt_ja_heidan_ammatti]

insert into [VipunenTK_DW].[dbo].[f_R4_17_Elakkeelle_siirt_ja_heidan_ammatti]
SELECT [tilv]
      ,[tilv_date]
      ,[lahde]
      ,[sp]
      ,[aikielir1]
      ,[ika]
      ,[elaji]
      ,[elk_koodi]
      ,[ptoim1r8x]
      ,[tmaakx]
      ,[amm2001_m1x]
      ,[amm2001_m2x]
      ,[lkm]
      ,[tietolahde]
      ,[rivinumero]
      ,[tietojen_ajankohta]
      ,[tiet_ak]
      ,[tiet_akdate]      
      ,[aineisto]
--  INTO [VipunenTK_DW].[dbo].[f_R4_17_Elakkeelle_siirt_ja_heidan_ammatti]
  FROM [TK_H9098_CSC].[dbo].[TK_v_sa_R4_17_Elakkeelle_siirt_ja_heidan_ammatti]

**********/

SELECT [tilv] = CAST([tilv] AS nvarchar(4))
	  ,[tilv_date] = CAST(tilv+''0101'' as date)
      ,[lahde] = CAST([lahde] as nvarchar(10))
      ,[sp] = CAST([sp] as nvarchar(10))
      ,[aikielir1] = CAST([aikielir1] as nvarchar(10))
      ,[ika] = CAST([ika] as nvarchar(10))
      ,[elaji] = CAST([elaji] as nvarchar(10))
      ,[elk_koodi] = 
		CASE WHEN [lahde] = ''E'' THEN CAST([elaji] as nvarchar(10))      
		WHEN [lahde] = ''K'' THEN CAST(''100'' as nvarchar(10))     
      END
      ,[ptoim1r8x] = 
      CASE
          WHEN [ptoim1r8x] = 99 THEN CAST(''-1'' as nvarchar(10))
          ELSE CAST([ptoim1r8x] as nvarchar(10))
      END
      ,[tmaakx] = 
		CASE WHEN [tmaakx] = 99 THEN CAST(''-1'' as nvarchar(10))
		ELSE CAST([tmaakx] as nvarchar(10))
      END      
      ,[amm2001_m1x] = 
		CASE WHEN [amm2001_m1_x] = ''XX'' THEN CAST(''-1'' as nvarchar(10))
		ELSE CAST([amm2001_m1_x] as nvarchar(10))
      END
      ,[amm2001_m2x] = 
		CASE WHEN [amm2001_m2_x] LIKE ''%XX%'' THEN CAST(''-1'' as nvarchar(20))
		ELSE CAST([amm2001_m2_x] as nvarchar(20))
	  END
      ,[lkm] = CAST([lkm] as int)
      ,[tietolahde] = CAST([tietolahde] as nvarchar(50))
      ,[rivinumero] = CAST([rivinumero] as int)
      ,[tietojen_ajankohta] = CAST([tietojen_ajankohta] as nvarchar(10))
      ,[tiet_ak] = CAST(CAST([tilv] as int) - 1 AS nvarchar(4))
      ,[tiet_akdate] = CAST(CAST(CAST([tilv] as int) - 1 as nvarchar(10)) + ''0101'' as date)
      ,aineisto = CAST(''R4.17'' as nvarchar(8))

FROM      

(
SELECT [tilv]
      ,[lahde]
      ,[sp]
      ,[aikielir1]
      ,[ika]
      ,[elaji]
      ,[ptoim1r8x]
      ,[tmaakx]
      ,[amm2001_m1_x]
--      ,[amm2001_m2x]
      ,[amm2001_m2_x]=''MITENNA2001_''+Replace([amm2001_m2_x],'','',''.'')            
      ,[lkm]
      ,[tietolahde]=''R4_17a_Elakkeelle_siirt_ja_heidan_ammatti_11''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
      ,''1'' AS tietojen_ajankohta
      
  FROM [TK_H9098_CSC].[dbo].[TK_R4_17a_sopv_11]

UNION ALL

SELECT [tilv]
      ,[lahde]
      ,[sp]
      ,[aikielir1]
      ,[ika]
      ,[elaji]
      ,[ptoim1r8x]
      ,[tmaakx]
      ,[amm2001_m1_x]
--      ,[amm2001_m2x]
      ,[amm2001_m2_x]=''MITENNA2010_''+Replace([amm2001_m2_x],'','',''.'')
      ,[lkm]
      ,[tietolahde]=''R4_17a_Elakkeelle_siirt_ja_heidan_ammatti_12''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
      ,''1'' AS tietojen_ajankohta
  FROM [TK_H9098_CSC].[dbo].[TK_R4_17a_sopv_12]
 
UNION ALL

SELECT [tilv]
      ,[lahde]
      ,[sp]
      ,[aikielir1]
      ,[ika]
      ,[elaji]
      ,[ptoim1r8x]
      ,[tmaakx]
      ,[amm2001_m1_x]
--      ,[amm2001_m2x]
      ,[amm2001_m2_x]=''MITENNA2010_''+Replace([amm2001_m2_x],'','',''.'')
      ,[lkm]
      ,[tietolahde]=''R4_17a_Elakkeelle_siirt_ja_heidan_ammatti_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
      ,''1'' AS tietojen_ajankohta
  FROM [TK_H9098_CSC].[dbo].[TK_R4_17a_sopv_13] 
 
UNION ALL

SELECT [tilv]
      ,[lahde]
      ,[sp]
      ,[aikielir1]
      ,[ika]
      ,[elaji]
      ,[ptoim1r8x]
      ,[tmaakx]
      ,[amm2010_m1_x]
--      ,[amm2001_m2x]
      ,[amm2010_m2_x]=''MITENNA2010_''+Replace([amm2010_m2_x],'','',''.'')
      ,[lkm]
      ,[tietolahde]=''R4_17a_Elakkeelle_siirt_ja_heidan_ammatti_14''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
      ,''1'' AS tietojen_ajankohta
  FROM [TK_H9098_CSC].[dbo].[TK_R4_17a_sopv_14]

UNION ALL

SELECT [tilv]
      ,[lahde]
      ,[sp]
      ,[aikielir1]
      ,[ika]
      ,[elaji]
      ,[ptoim1r8x]
      ,[tmaakx]
      ,[amm2010_m1_x]
--      ,[amm2001_m2x]
      ,[amm2010_m2_x]=''MITENNA2010_''+Replace([amm2010_m2_x],'','',''.'')
      ,[lkm]
      ,[tietolahde]=''R4_17a_Elakkeelle_siirt_ja_heidan_ammatti_15''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
      ,''1'' AS tietojen_ajankohta
  FROM [TK_H9098_CSC].[dbo].[TK_R4_17a_sopv_15]

UNION ALL

SELECT [tilv]
      ,[lahde]
      ,[sp]
      ,[aikielir1]
      ,[ika]
      ,[elaji]
      ,[ptoim1r8x]
      ,[tmaakx]
      ,[amm2010_m1_x]
--      ,[amm2001_m2x]
      ,[amm2010_m2_x]=''MITENNA2010_''+Replace([amm2010_m2_x],'','',''.'')
      ,[lkm]
      ,[tietolahde]=''R4_17a_Elakkeelle_siirt_ja_heidan_ammatti_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
      ,''1'' AS tietojen_ajankohta
  FROM [TK_H9098_CSC].[dbo].[TK_R4_17a_sopv_16]



UNION ALL

SELECT [tilv]
      ,[lahde]
      ,[sp]
      ,[aikielir1]
      ,[ika]
      ,-1 AS elaji
      ,[ptoim1r8x]
      ,[tmaakx]
      ,[amm2001_m1_x]
--      ,[amm2001_m2x]
      ,[amm2001_m2_x]=''MITENNA2010_''+Replace([amm2001_m2_x],'','',''.'')
      ,[lkm]
      ,[tietolahde]=''R4_17b_Kuolleet_ja_heidan_ammatti_11''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
      ,''1'' AS tietojen_ajankohta
  FROM [TK_H9098_CSC].[dbo].[TK_R4_17b_sopv_11]
  
UNION ALL

SELECT [tilv]
      ,[lahde]
      ,[sp]
      ,[aikielir1]
      ,[ika]
      ,-1 AS elaji      
      ,[ptoim1r8x]
      ,[tmaakx]
      ,[amm2001_m1_x]
--    ,[amm2001_m2x]
      ,[amm2010_m2_x]=''MITENNA2010_''+Replace([amm2001_m2_x],'','',''.'')
      ,[lkm]
      ,[tietolahde]=''R4_17b_Kuolleet_ja_heidan_ammatti_12''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
      ,''1'' AS tietojen_ajankohta
  FROM [TK_H9098_CSC].[dbo].[TK_R4_17b_sopv_12]

UNION ALL

SELECT [tilv]
      ,[lahde]
      ,[sp]
      ,[aikielir1]
      ,[ika]
      ,-1 AS elaji      
      ,[ptoim1r8x]
      ,[tmaakx]
      ,[amm2001_m1_x]
--    ,[amm2001_m2x]
      ,[amm2010_m2_x]=''MITENNA2010_''+Replace([amm2001_m2_x],'','',''.'')
      ,[lkm]
      ,[tietolahde]=''R4_17b_Kuolleet_ja_heidan_ammatti_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
      ,''1'' AS tietojen_ajankohta
  FROM [TK_H9098_CSC].[dbo].[TK_R4_17b_sopv_13]

UNION ALL

SELECT [tilv]
      ,[lahde]
      ,[sp]
      ,[aikielir1]
      ,[ika]
      ,-1 AS elaji      
      ,[ptoim1r8x]
      ,[tmaakx]
      ,[amm2010_m1_x]
--    ,[amm2001_m2x]
      ,[amm2010_m2_x]=''MITENNA2010_''+Replace([amm2010_m2_x],'','',''.'')
      ,[lkm]
      ,[tietolahde]=''R4_17b_Kuolleet_ja_heidan_ammatti_14''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
      ,''1'' AS tietojen_ajankohta
  FROM [TK_H9098_CSC].[dbo].[TK_R4_17b_sopv_14]

UNION ALL

SELECT [tilv]
      ,[lahde]
      ,[sp]
      ,[aikielir1]
      ,[ika]
      ,-1 AS elaji      
      ,[ptoim1r8x]
      ,[tmaakx]
      ,[amm2010_m1_x]
--    ,[amm2001_m2x]
      ,[amm2010_m2_x]=''MITENNA2010_''+Replace([amm2010_m2_x],'','',''.'')
      ,[lkm]
      ,[tietolahde]=''R4_17b_Kuolleet_ja_heidan_ammatti_15''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
      ,''1'' AS tietojen_ajankohta
  FROM [TK_H9098_CSC].[dbo].[TK_R4_17b_sopv_15]

UNION ALL

SELECT [tilv]
      ,[lahde]
      ,[sp]
      ,[aikielir1]
      ,[ika]
      ,-1 AS elaji      
      ,[ptoim1r8x]
      ,[tmaakx]
      ,[amm2010_m1_x]
--    ,[amm2001_m2x]
      ,[amm2010_m2_x]=''MITENNA2010_''+Replace([amm2010_m2_x],'','',''.'')
      ,[lkm]
      ,[tietolahde]=''R4_17b_Kuolleet_ja_heidan_ammatti_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
      ,''1'' AS tietojen_ajankohta
  FROM [TK_H9098_CSC].[dbo].[TK_R4_17b_sopv_16]


) kaikkivuodet

' 
GO
/****** Object:  View [dbo].[v_sa_R4_18_Elakkeelle_siirt_ja_heidan_ammatti_2v_aiemmin]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_R4_18_Elakkeelle_siirt_ja_heidan_ammatti_2v_aiemmin]'))
EXEC dbo.sp_executesql @statement = N'
/****** Script for SelectTopNRows command from SSMS  ******/
CREATE VIEW [dbo].[v_sa_R4_18_Elakkeelle_siirt_ja_heidan_ammatti_2v_aiemmin] AS

/******************

drop table [VipunenTK_DW].[dbo].[f_R4_18_Elakkeelle_siirt_ja_heidan_ammatti_2v_aiemmin]
truncate table [VipunenTK_DW].[dbo].[f_R4_18_Elakkeelle_siirt_ja_heidan_ammatti_2v_aiemmin]

SELECT [tilv]
	  ,[tilv_date]
      ,[lahde]
      ,[sp]
      ,[aikielir1]
      ,[ika]
      ,[elaji]
      ,[elk_koodi]
      ,[ptoim1r8_2x]
      ,[tmaak2x]
      ,[amm2001_m1_2x]
      ,[amm2001_m2_2x]
      ,[lkm]
      ,[tietolahde]
      ,[rivinumero]
      ,[tietojen_ajankohta]
      ,[tiet_ak]
      ,[tiet_akdate]    
      ,[aineisto]  
  INTO [VipunenTK_DW].[dbo].[f_R4_18_Elakkeelle_siirt_ja_heidan_ammatti_2v_aiemmin]
  FROM [TK_H9098_CSC].[dbo].[TK_v_sa_R4_18_Elakkeelle_siirt_ja_heidan_ammatti_2v_aiemmin]

******************/

SELECT [tilv] = CAST([tilv] AS nvarchar(4))
	  ,[tilv_date] = CAST(tilv+''0101'' as date)
      ,[lahde] = CAST([lahde] as nvarchar(10))
      ,[sp] = CAST([sp] as nvarchar(10))
      ,[aikielir1] = CAST([aikielir1] as nvarchar(10))
      ,[ika] = CAST([ika] as nvarchar(10))
      ,[elaji] = CAST([elaji] as nvarchar(10))
      ,[elk_koodi] = 
		CASE WHEN [lahde] = ''E'' THEN CAST([elaji] as nvarchar(10))      
		WHEN [lahde] = ''K'' THEN CAST(''100'' as nvarchar(10))     
      END      
      ,[ptoim1r8_2x] = 
      CASE
          WHEN [ptoim1r8_2x] = 99 THEN CAST(''-1'' as nvarchar(10))
          ELSE CAST([ptoim1r8_2x] as nvarchar(10))
      END
      ,[tmaak2x] = 
		CASE WHEN [tmaak2x] = 99 THEN CAST(''-1'' as nvarchar(10))
		ELSE CAST([tmaak2x] as nvarchar(10))
      END      
      ,[amm2001_m1_2x] = 
		CASE WHEN [amm2001_m1_2x] = ''XX'' THEN CAST(''-1'' as nvarchar(10))
		ELSE CAST([amm2001_m1_2x] as nvarchar(10))
      END
      ,[amm2001_m2_2x] = 
		CASE WHEN [amm2001_m2_2x] LIKE ''%XX%'' THEN CAST(''-1'' as nvarchar(20))
		ELSE CAST([amm2001_m2_2x] as nvarchar(20))
	  END
      ,[lkm] = CAST([lkm] as int)
      ,[tietolahde] = CAST([tietolahde] as nvarchar(50))
      ,[rivinumero] = CAST([rivinumero] as int)
      ,[tietojen_ajankohta] = CAST([tietojen_ajankohta] as nvarchar(20))
      ,[tiet_ak] = CAST(CAST([tilv] as int) - 2 AS nvarchar(4))
      ,[tiet_akdate] = CAST(CAST(CAST([tilv] as int) - 2 as nvarchar(10)) + ''0101'' as date)   
      ,aineisto = CAST(''R4.18'' as nvarchar(8))         

FROM

(
SELECT [tilv]
      ,[lahde]
      ,[sp]
      ,[aikielir1]
      ,[ika]
      ,[elaji]
      ,[ptoim1r8_2x]
      ,[tmaak2x]
      ,[amm2001_m1_2x]
      ,[amm2001_m2_2x]=''MITENNA2001_''+Replace([amm2001_m2_2x],'','',''.'')      
      ,[lkm]
      ,[tietolahde]=''sa_R4_18a_sopv_11''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
      ,''2'' AS tietojen_ajankohta  
  FROM [TK_H9098_CSC].[dbo].[TK_R4_18a_sopv_11]

UNION ALL

SELECT [tilv]
      ,[lahde]
      ,[sp]
      ,[aikielir1]
      ,[ika]
      ,[elaji]
      ,[ptoim1r8_2x]
      ,[tmaak2x]
      ,[amm2001_m1_2x]
      ,[amm2001_m2_2x]=''MITENNA2010_''+Replace([amm2001_m2_2x],'','',''.'')
      ,[lkm]
      ,[tietolahde]=''R4_18a_sopv_12''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
      ,''2'' AS tietojen_ajankohta  
  FROM [TK_H9098_CSC].[dbo].[TK_R4_18a_sopv_12]

UNION ALL

SELECT [tilv]
      ,[lahde]
      ,[sp]
      ,[aikielir1]
      ,[ika]
      ,[elaji]
      ,[ptoim1r8_2x]
      ,[tmaak2x]
      ,[amm2001_m1_2x]
      ,[amm2001_m2_2x]=''MITENNA2010_''+Replace([amm2001_m2_2x],'','',''.'')
      ,[lkm]
      ,[tietolahde]=''R4_18a_sopv_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
      ,''2'' AS tietojen_ajankohta  
  FROM [TK_H9098_CSC].[dbo].[TK_R4_18a_sopv_13]

UNION ALL

SELECT [tilv]
      ,[lahde]
      ,[sp]
      ,[aikielir1]
      ,[ika]
      ,[elaji]
      ,[ptoim1r8_2x]
      ,[tmaak2x]
      ,[amm2010_m1_2x]
      ,[amm2010_m2_2x]=''MITENNA2010_''+Replace([amm2010_m2_2x],'','',''.'')
      ,[lkm]
      ,[tietolahde]=''R4_18a_sopv_14''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
      ,''2'' AS tietojen_ajankohta  
  FROM [TK_H9098_CSC].[dbo].[TK_R4_18a_sopv_14]

UNION ALL

SELECT [tilv]
      ,[lahde]
      ,[sp]
      ,[aikielir1]
      ,[ika]
      ,[elaji]
      ,[ptoim1r8_2x]
      ,[tmaak2x]
      ,[amm2010_m1_2x]
      ,[amm2010_m2_2x]=''MITENNA2010_''+Replace([amm2010_m2_2x],'','',''.'')
      ,[lkm]
      ,[tietolahde]=''R4_18a_sopv_15''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
      ,''2'' AS tietojen_ajankohta  
  FROM [TK_H9098_CSC].[dbo].[TK_R4_18a_sopv_15]

UNION ALL

SELECT [tilv]
      ,[lahde]
      ,[sp]
      ,[aikielir1]
      ,[ika]
      ,[elaji]
      ,[ptoim1r8_2x]
      ,[tmaak2x]
      ,[amm2010_m1_2x]
      ,[amm2010_m2_2x]=''MITENNA2010_''+Replace([amm2010_m2_2x],'','',''.'')
      ,[lkm]
      ,[tietolahde]=''R4_18a_sopv_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
      ,''2'' AS tietojen_ajankohta  
  FROM [TK_H9098_CSC].[dbo].[TK_R4_18a_sopv_16] 
  
UNION ALL

SELECT [tilv]
      ,[lahde]
      ,[sp]
      ,[aikielir1]
      ,[ika]
      ,-1 as [elaji]
      ,[ptoim1r8_2x]
      ,[tmaak2x]
      ,[amm2001_m1_2x]
      ,[amm2001_m2_2x]=''MITENNA2010_''+Replace([amm2001_m2_2x],'','',''.'')
      ,[lkm]
      ,[tietolahde]=''R4_18b_sopv_11''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
      ,''2'' AS tietojen_ajankohta  
  FROM [TK_H9098_CSC].[dbo].[TK_R4_18b_sopv_11]
  
UNION ALL

SELECT [tilv]
      ,[lahde]
      ,[sp]
      ,[aikielir1]
      ,[ika]
      ,-1 as [elaji]
      ,[ptoim1r8_2x]
      ,[tmaak2x]
      ,[amm2001_m1_2x]
      ,[amm2001_m2_2x]=''MITENNA2010_''+Replace([amm2001_m2_2x],'','',''.'')
      ,[lkm]
      ,[tietolahde]=''R4_18b_sopv_12''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
      ,''2'' AS tietojen_ajankohta  
  FROM [TK_H9098_CSC].[dbo].[TK_R4_18b_sopv_12]

UNION ALL

SELECT [tilv]
      ,[lahde]
      ,[sp]
      ,[aikielir1]
      ,[ika]
      ,-1 as [elaji]
      ,[ptoim1r8_2x]
      ,[tmaak2x]
      ,[amm2001_m1_2x]
      ,[amm2001_m2_2x]=''MITENNA2010_''+Replace([amm2001_m2_2x],'','',''.'')
      ,[lkm]
      ,[tietolahde]=''R4_18b_sopv_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
      ,''2'' AS tietojen_ajankohta  
  FROM [TK_H9098_CSC].[dbo].[TK_R4_18b_sopv_13]

UNION ALL

SELECT [tilv]
      ,[lahde]
      ,[sp]
      ,[aikielir1]
      ,[ika]
      ,-1 as [elaji]
      ,[ptoim1r8_2x]
      ,[tmaak2x]
      ,[amm2010_m1_2x]
      ,[amm2010_m2_2x]=''MITENNA2010_''+Replace([amm2010_m2_2x],'','',''.'')
      ,[lkm]
      ,[tietolahde]=''R4_18b_sopv_14''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
      ,''2'' AS tietojen_ajankohta  
  FROM [TK_H9098_CSC].[dbo].[TK_R4_18b_sopv_14]

UNION ALL

SELECT [tilv]
      ,[lahde]
      ,[sp]
      ,[aikielir1]
      ,[ika]
      ,-1 as [elaji]
      ,[ptoim1r8_2x]
      ,[tmaak2x]
      ,[amm2010_m1_2x]
      ,[amm2010_m2_2x]=''MITENNA2010_''+Replace([amm2010_m2_2x],'','',''.'')
      ,[lkm]
      ,[tietolahde]=''R4_18b_sopv_15''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
      ,''2'' AS tietojen_ajankohta  
  FROM [TK_H9098_CSC].[dbo].[TK_R4_18b_sopv_15]

UNION ALL

SELECT [tilv]
      ,[lahde]
      ,[sp]
      ,[aikielir1]
      ,[ika]
      ,-1 as [elaji]
      ,[ptoim1r8_2x]
      ,[tmaak2x]
      ,[amm2010_m1_2x]
      ,[amm2010_m2_2x]=''MITENNA2010_''+Replace([amm2010_m2_2x],'','',''.'')
      ,[lkm]
      ,[tietolahde]=''R4_18b_sopv_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
      ,''2'' AS tietojen_ajankohta  
  FROM [TK_H9098_CSC].[dbo].[TK_R4_18b_sopv_16]


) kaikkivuodet

' 
GO
/****** Object:  View [dbo].[v_sa_R4_19_Tyollisten_ammattisiirtymat]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_R4_19_Tyollisten_ammattisiirtymat]'))
EXEC dbo.sp_executesql @statement = N'




/****** Script for SelectTopNRows command from SSMS  ******/
CREATE VIEW [dbo].[v_sa_R4_19_Tyollisten_ammattisiirtymat] AS

SELECT [tilv]
      ,[sp]
      ,[aikielir1]
      ,[ikar1] = ''5V'' + ikar1
      ,[tmaak] = ''MAAK'' + tmaak
      ,[amm2001_m1]
      ,amm2001_m2 = 
			CASE WHEN amm2001_m2 = ''99999'' or amm2001_m2 = '''' THEN ''-1''
			ELSE ''MITENNA2001_'' + replace([amm2001_m2], '','', ''.'')
			END
      ,[ptoim1r7_2009]
      ,[tmaakr1_2009]
      ,[amm2001_m1_2009]
      ,[amm2001_m2_2009] = 
			CASE WHEN amm2001_m2_2009 = ''99999'' THEN ''-1''
			ELSE ''MITENNA2001_'' + replace([amm2001_m2_2009], '','', ''.'')
			END
      ,[lkm]
      ,suhteellinen_ajankohta_avain =  
		CASE 
		 WHEN tilv = 2005 THEN ''tilv+4''
		 WHEN tilv = 2008 THEN ''tilv+1''
		 ELSE ''-1''		 
		END

  FROM [TK_H9098_CSC].[dbo].[TK_R4_19_sopv_11]
  
UNION ALL
  
SELECT [tilv]
      ,[sp]
      ,[aikielir1]
      ,[ikar1] = ''5V'' + ikar1
      ,[tmaak] = ''MAAK'' + tmaak
      ,[amm2001_m1]
      ,amm2001_m2 = 
			CASE WHEN amm2001_m2 = ''99999'' or amm2001_m2 = '''' THEN ''-1''
			ELSE ''MITENNA2001_'' + replace([amm2001_m2], '','', ''.'')
			END
      ,[ptoim1r7_2010]
      ,[tmaakr1_2010]
      ,[amm2010_m1_2010]
      ,[amm2010_m2_2010] = 
			CASE WHEN amm2010_m2_2010 = ''99999'' THEN ''-1''
			ELSE ''MITENNA2010_'' + replace([amm2010_m2_2010], '','', ''.'')
			END
      ,[lkm]
      ,suhteellinen_ajankohta_avain =  
		CASE 
		 WHEN tilv = 2005 THEN ''tilv+5''
		 WHEN tilv = 2009 THEN ''tilv+1''
		 ELSE ''-1''		 
		END
      
  FROM [TK_H9098_CSC].[dbo].[TK_R4_19_sopv_12]

UNION ALL

SELECT [tilv]
      ,[sp]
      ,[aikielir1]
      ,[ikar1] = ''5V'' + ikar1
      ,[tmaak] = ''MAAK'' + tmaak
      ,[amm2001_m1] = CASE 
						WHEN tilv = 2006 then amm2001_m1
						when tilv = 2010 then amm2010_m1
						else ''-1''
					  END
      ,amm2001_m2 = 
			CASE 
				WHEN tilv = 2006 THEN 
					CASE
						WHEN amm2001_m2 = ''99999'' or amm2001_m2 = '''' THEN ''-1''
						ELSE ''MITENNA2001_'' + replace([amm2001_m2], '','', ''.'')
					END
				WHEN tilv = 2010 THEN
					CASE
						WHEN amm2010_m2 = ''99999'' or amm2010_m2 = '''' THEN ''-1''
						ELSE ''MITENNA2010_'' + replace([amm2010_m2], '','', ''.'')
					END
			END
      ,[ptoim1r7_2011]
      ,[tmaakr1_2011]
      ,[amm2010_m1_2011]
      ,[amm2010_m2_2011] = 
			CASE WHEN amm2010_m2_2011 = ''99999'' THEN ''-1''
			ELSE ''MITENNA2010_'' + replace([amm2010_m2_2011], '','', ''.'')
			END
      ,[lkm]
      ,suhteellinen_ajankohta_avain =  
		CASE 
		 WHEN tilv = 2006 THEN ''tilv+5''
		 WHEN tilv = 2010 THEN ''tilv+1''
		 ELSE ''-1''		 
		END

  FROM [TK_H9098_CSC].[dbo].[TK_R4_19_sopv_13]

  UNION ALL

SELECT [tilv]
      ,[sp]
      ,[aikielir1]
      ,[ikar1] = ''5V'' + ikar1
      ,[tmaak] = ''MAAK'' + tmaak
      ,[amm2001_m1] = CASE 
						WHEN tilv = 2007 then amm2001_m1
						when tilv = 2011 then amm2010_m1
						else ''-1''
					  END
      ,amm2001_m2 = 
			CASE 
				WHEN tilv = 2007 THEN 
					CASE
						WHEN amm2001_m2 = ''99999'' or amm2001_m2 = '''' THEN ''-1''
						ELSE ''MITENNA2001_'' + replace([amm2001_m2], '','', ''.'')
					END
				WHEN tilv = 2011 THEN
					CASE
						WHEN amm2010_m2 = ''99999'' or amm2010_m2 = '''' THEN ''-1''
						ELSE ''MITENNA2010_'' + replace([amm2010_m2], '','', ''.'')
					END
			END
      ,[ptoim1r7_2012]
      ,[tmaakr1_2012]
      ,[amm2010_m1_2012]
      ,[amm2010_m2_2012] = 
			CASE WHEN amm2010_m2_2012 = ''99999'' THEN ''-1''
			ELSE ''MITENNA2010_'' + replace([amm2010_m2_2012], '','', ''.'')
			END
      ,[lkm]
      ,suhteellinen_ajankohta_avain =  
		CASE 
		 WHEN tilv = 2007 THEN ''tilv+5''
		 WHEN tilv = 2011 THEN ''tilv+1''
		 ELSE ''-1''		 
		END

  FROM [TK_H9098_CSC].[dbo].[TK_R4_19_sopv_14]

    UNION ALL

SELECT [tilv]
      ,[sp]
      ,[aikielir1]
      ,[ikar1] = ''5V'' + ikar1
      ,[tmaak] = ''MAAK'' + tmaak
      ,[amm2001_m1] = CASE 
						WHEN tilv = 2008 then amm2001_m1
						when tilv = 2012 then amm2010_m1
						else ''-1''
					  END
      ,amm2001_m2 = 
			CASE 
				WHEN tilv = 2008 THEN 
					CASE
						WHEN amm2001_m2 = ''99999'' or amm2001_m2 = '''' THEN ''-1''
						ELSE ''MITENNA2001_'' + replace([amm2001_m2], '','', ''.'')
					END
				WHEN tilv = 2012 THEN
					CASE
						WHEN amm2010_m2 = ''99999'' or amm2010_m2 = '''' THEN ''-1''
						ELSE ''MITENNA2010_'' + replace([amm2010_m2], '','', ''.'')
					END
			END
      ,[ptoim1r7_2013]
      ,[tmaakr1_2013]
      ,[amm2010_m1_2013]
      ,[amm2010_m2_2013	  ] = 
			CASE WHEN amm2010_m2_2013 = ''99999'' THEN ''-1''
			ELSE ''MITENNA2010_'' + replace([amm2010_m2_2013], '','', ''.'')
			END
      ,[lkm]
      ,suhteellinen_ajankohta_avain =  
		CASE 
		 WHEN tilv = 2008 THEN ''tilv+5''
		 WHEN tilv = 2012 THEN ''tilv+1''
		 ELSE ''-1''		 
		END

  FROM [TK_H9098_CSC].[dbo].[TK_R4_19_sopv_15]


    UNION ALL

SELECT [tilv]
      ,[sp]
      ,[aikielir1]
      ,[ikar1] = ''5V'' + ikar1
      ,[tmaak] = ''MAAK'' + tmaak
      ,[amm2001_m1] = CASE 
						WHEN tilv = 2009 then amm2001_m1
						when tilv = 2013 then amm2010_m1
						else ''-1''
					  END
      ,amm2001_m2 = 
			CASE 
				WHEN tilv = 2009 THEN 
					CASE
						WHEN amm2001_m2 = ''99999'' or amm2001_m2 = '''' THEN ''-1''
						ELSE ''MITENNA2001_'' + replace([amm2001_m2], '','', ''.'')
					END
				WHEN tilv = 2013 THEN
					CASE
						WHEN amm2010_m2 = ''99999'' or amm2010_m2 = '''' THEN ''-1''
						ELSE ''MITENNA2010_'' + replace([amm2010_m2], '','', ''.'')
					END
			END
      ,[ptoim1r7_2014]
      ,[tmaakr1_2014]
      ,[amm2010_m1_2014]
      ,[amm2010_m2_2014] = 
			CASE WHEN amm2010_m2_2014 = ''99999'' THEN ''-1''
			ELSE ''MITENNA2010_'' + replace([amm2010_m2_2014], '','', ''.'')
			END
      ,[lkm]
      ,suhteellinen_ajankohta_avain =  
		CASE 
		 WHEN tilv = 2009 THEN ''tilv+5''
		 WHEN tilv = 2013 THEN ''tilv+1''
		 ELSE ''-1''		 
		END

  FROM [TK_H9098_CSC].[dbo].[TK_R4_19_sopv_16]




' 
GO
/****** Object:  View [dbo].[v_sa_R4_20_Tyollisten_aiemmat_ammatit]    Script Date: 21.6.2017 10:26:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_R4_20_Tyollisten_aiemmat_ammatit]'))
EXEC dbo.sp_executesql @statement = N'


/****** Script for SelectTopNRows command from SSMS  ******/

CREATE VIEW [dbo].[v_sa_R4_20_Tyollisten_aiemmat_ammatit] AS

SELECT [tilv]
      ,[aikielir1]
      ,[ikar1] = ''5V'' + ikar1
      ,[tmaak] = ''MAAK'' + tmaak
      ,[amm2001_m1]
      ,amm2001_m2 = 
		CASE
			WHEN amm2001_m2 = ''99999'' THEN ''-1''
			ELSE ''MITENNA2001_'' + replace([amm2001_m2], '','', ''.'')
		END
      ,[ptoim1r7_2004]
      ,[tmaakr1_2004]
      ,[amm2001_m1_2004]
      ,[amm2001_m2_2004] =
		CASE
			WHEN amm2001_m2_2004 = ''99999'' THEN ''-1''
			ELSE ''MITENNA2001_'' + replace([amm2001_m2_2004], '','', ''.'')
		END
      ,[lkm]
      ,suhteellinen_ajankohta_avain =  
		CASE 
		 WHEN tilv = 2009 THEN ''tilv-5''
		 ELSE ''-1''
		END
		      
  FROM [TK_H9098_CSC].[dbo].[TK_R4_20_sopv_11]
  
UNION ALL

SELECT [tilv]
      ,[aikielir1]
      ,[ikar1] = ''5V'' + ikar1
      ,[tmaak] = ''MAAK'' + tmaak
      ,[amm2001_m1]
      ,amm2001_m2 = 
		CASE
			WHEN amm2001_m2 = ''99999'' THEN ''-1''
			ELSE ''MITENNA2010_'' + replace([amm2001_m2], '','', ''.'')
		END      
      ,[ptoim1r7_2005]
      ,[tmaakr1_2005]
      ,[amm2001_m1_2005]
      ,[amm2001_m2_2005] =
		CASE
			WHEN amm2001_m2_2005 = ''99999'' THEN ''-1''
			ELSE ''MITENNA2001_'' + replace([amm2001_m2_2005], '','', ''.'')
		END
      ,[lkm]
      ,suhteellinen_ajankohta_avain =  
		CASE 
		 WHEN tilv = 2010 THEN ''tilv-5''
		 ELSE ''-1''
		END      
      
  FROM [TK_H9098_CSC].[dbo].[TK_R4_20_sopv_12]  
  
UNION ALL

SELECT [tilv]
      ,[aikielir1]
      ,[ikar1] = ''5V'' + ikar1
      ,[tmaak] = ''MAAK'' + tmaak
      ,[amm2001_m1]
      ,amm2001_m2 = 
		CASE
			WHEN amm2001_m2 = ''99999'' THEN ''-1''
			ELSE ''MITENNA2010_'' + replace([amm2001_m2], '','', ''.'')
		END
      
      ,[ptoim1r7_2006]
      ,[tmaakr1_2006]
      ,[amm2001_m1_2006]
      ,[amm2001_m2_2006] =
		CASE
			WHEN amm2001_m2_2006 = ''99999'' THEN ''-1''
			ELSE ''MITENNA2001_'' + replace([amm2001_m2_2006], '','', ''.'')
		END

      ,[lkm]
      ,suhteellinen_ajankohta_avain =  
		CASE 
		 WHEN tilv = 2011 THEN ''tilv-5''
		 ELSE ''-1''
		END      
      
  FROM [TK_H9098_CSC].[dbo].[TK_R4_20_sopv_13]

  UNION ALL

SELECT [tilv]
      ,[aikielir1]
      ,[ikar1] = ''5V'' + ikar1
      ,[tmaak] = ''MAAK'' + tmaak
      ,[amm2010_m1]
      ,amm2010_m2 = 
		CASE
			WHEN amm2010_m2 = ''99999'' THEN ''-1''
			ELSE ''MITENNA2010_'' + replace([amm2010_m2], '','', ''.'')
		END
      
      ,[ptoim1r7_2007]
      ,[tmaakr1_2007]
      ,[amm2001_m1_2007]
      ,[amm2001_m2_2007] =
		CASE
			WHEN amm2001_m2_2007 = ''99999'' THEN ''-1''
			ELSE ''MITENNA2001_'' + replace([amm2001_m2_2007], '','', ''.'')
		END

      ,[lkm]
      ,suhteellinen_ajankohta_avain =  
		CASE 
		 WHEN tilv = 2012 THEN ''tilv-5''
		 ELSE ''-1''
		END      
      
  FROM [TK_H9098_CSC].[dbo].[TK_R4_20_sopv_14]

  UNION ALL

SELECT [tilv]
      ,[aikielir1]
      ,[ikar1] = ''5V'' + ikar1
      ,[tmaak] = ''MAAK'' + tmaak
      ,[amm2010_m1]
      ,amm2010_m2 = 
		CASE
			WHEN amm2010_m2 = ''99999'' THEN ''-1''
			ELSE ''MITENNA2010_'' + replace([amm2010_m2], '','', ''.'')
		END
      
      ,[ptoim1r7_2008]
      ,[tmaakr1_2008]
      ,[amm2001_m1_2008]
      ,[amm2001_m2_2008] =
		CASE
			WHEN amm2001_m2_2008 = ''99999'' THEN ''-1''
			ELSE ''MITENNA2001_'' + replace([amm2001_m2_2008], '','', ''.'')
		END

      ,[lkm]
      ,suhteellinen_ajankohta_avain =  
		CASE 
		 WHEN tilv = 2013 THEN ''tilv-5''
		 ELSE ''-1''
		END      
      
  FROM [TK_H9098_CSC].[dbo].[TK_R4_20_sopv_15]

  UNION ALL

SELECT [tilv]
      ,[aikielir1]
      ,[ikar1] = ''5V'' + ikar1
      ,[tmaak] = ''MAAK'' + tmaak
      ,[amm2010_m1]
      ,amm2010_m2 = 
		CASE
			WHEN amm2010_m2 = ''99999'' THEN ''-1''
			ELSE ''MITENNA2010_'' + replace([amm2010_m2], '','', ''.'')
		END
      
      ,[ptoim1r7_2009]
      ,[tmaakr1_2009]
      ,[amm2001_m1_2009]
      ,[amm2001_m2_2009] =
		CASE
			WHEN amm2001_m2_2009 = ''99999'' THEN ''-1''
			ELSE ''MITENNA2001_'' + replace([amm2001_m2_2009], '','', ''.'')
		END

      ,[lkm]
      ,suhteellinen_ajankohta_avain =  
		CASE 
		 WHEN tilv = 2014 THEN ''tilv-5''
		 ELSE ''-1''
		END      
      
  FROM [TK_H9098_CSC].[dbo].[TK_R4_20_sopv_16]


' 

USE [ANTERO]