USE [VipunenTK_SA]
GO
/****** Object:  StoredProcedure [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_5_0_tarkastelujakso]    Script Date: 29.8.2018 15:59:41 ******/
DROP PROCEDURE [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_5_0_tarkastelujakso]
GO
/****** Object:  StoredProcedure [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_4_5_tarkastelujakso]    Script Date: 29.8.2018 15:59:41 ******/
DROP PROCEDURE [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_4_5_tarkastelujakso]
GO
/****** Object:  StoredProcedure [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_4_0_tarkastelujakso]    Script Date: 29.8.2018 15:59:41 ******/
DROP PROCEDURE [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_4_0_tarkastelujakso]
GO
/****** Object:  StoredProcedure [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_3_5_tarkastelujakso]    Script Date: 29.8.2018 15:59:41 ******/
DROP PROCEDURE [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_3_5_tarkastelujakso]
GO
/****** Object:  StoredProcedure [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_3_0_tarkastelujakso]    Script Date: 29.8.2018 15:59:41 ******/
DROP PROCEDURE [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_3_0_tarkastelujakso]
GO
/****** Object:  StoredProcedure [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_2_5_tarkastelujakso]    Script Date: 29.8.2018 15:59:41 ******/
DROP PROCEDURE [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_2_5_tarkastelujakso]
GO
/****** Object:  StoredProcedure [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_2_0_tarkastelujakso]    Script Date: 29.8.2018 15:59:41 ******/
DROP PROCEDURE [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_2_0_tarkastelujakso]
GO
/****** Object:  StoredProcedure [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_1_tarkastelujakso]    Script Date: 29.8.2018 15:59:41 ******/
DROP PROCEDURE [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_1_tarkastelujakso]
GO
/****** Object:  StoredProcedure [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_1_5_tarkastelujakso]    Script Date: 29.8.2018 15:59:41 ******/
DROP PROCEDURE [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_1_5_tarkastelujakso]
GO
/****** Object:  StoredProcedure [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_0_5_tarkastelujakso]    Script Date: 29.8.2018 15:59:41 ******/
DROP PROCEDURE [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_0_5_tarkastelujakso]
GO
/****** Object:  StoredProcedure [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_0__valittomasti_tarkastelujakso]    Script Date: 29.8.2018 15:59:41 ******/
DROP PROCEDURE [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_0__valittomasti_tarkastelujakso]
GO
/****** Object:  StoredProcedure [dbo].[p_lataa_f_koulutukseen_sijoittuneet_2v_1_tarkastelujakso]    Script Date: 29.8.2018 15:59:41 ******/
DROP PROCEDURE [dbo].[p_lataa_f_koulutukseen_sijoittuneet_2v_1_tarkastelujakso]
GO
/****** Object:  StoredProcedure [dbo].[p_lataa_f_koulutukseen_sijoittuneet_2v_0_5_tarkastelujakso]    Script Date: 29.8.2018 15:59:41 ******/
DROP PROCEDURE [dbo].[p_lataa_f_koulutukseen_sijoittuneet_2v_0_5_tarkastelujakso]
GO
/****** Object:  StoredProcedure [dbo].[p_lataa_f_koulutukseen_sijoittuneet_2v_0__valittomasti__tarkastelujakso]    Script Date: 29.8.2018 15:59:41 ******/
DROP PROCEDURE [dbo].[p_lataa_f_koulutukseen_sijoittuneet_2v_0__valittomasti__tarkastelujakso]
GO
/****** Object:  StoredProcedure [dbo].[p_lataa_f_koulutukseen_sijoittuneet_2v_0__valittomasti__tarkastelujakso]    Script Date: 29.8.2018 15:59:41 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE PROCEDURE [dbo].[p_lataa_f_koulutukseen_sijoittuneet_2v_0__valittomasti__tarkastelujakso] AS


/*declare @debug_what_to_run tinyint; set @debug_what_to_run=2; -- käytä arvoa 3 vain kun teet yhden vuoden
print '$'+convert(varchar,sysdatetime(),20)+'$ '+'DEBUG (what to run)='+cast(@debug_what_to_run as varchar)+
': 0=luo vain taulut, älä tulosta mitään; 1=luo taulut ja tulosta joitakin merkittävimpiä välivaiheita; 2=luo taulut ja tulosta välivaiheet; 3=luo taulut, tulosta välivaiheet ja tulosta myös tulokset, 4=tulosta välivaiheet, mutta älä tee mitään';



-- lisätään data
if @debug_what_to_run not in (4) begin
if @debug_what_to_run>0 print 'inserting data';

-- parametrimuuttujien arvot
-- parametrimuuttujat
DECLARE @ensimmainen_suoritusvuosi int;
DECLARE @toinen_suoritusvuosi int;
DECLARE @kolmas_suoritusvuosi int;
DECLARE @neljas_suoritusvuosi int;
DECLARE @viides_suoritusvuosi int;
DECLARE @kuudes_suoritusvuosi int;
DECLARE @seitsemas_suoritusvuosi int;
DECLARE @kahdeksas_suoritusvuosi int;

set @ensimmainen_suoritusvuosi = 2008;
set @toinen_suoritusvuosi = 2009;
set @kolmas_suoritusvuosi = 2010;
set @neljas_suoritusvuosi = 2011;
set @viides_suoritusvuosi = 2012;
set @kuudes_suoritusvuosi = 2013;
set @seitsemas_suoritusvuosi = 2014;
set @kahdeksas_suoritusvuosi = 2015;

*/

INSERT INTO [VipunenTK_DW].[dbo].[_koulutukseen_sijoittuneet_2v_tarkastelu]
(
rivinumero
, tarkastelujakso
, tilv 
, tilv_date
, tutkryh 
, suorv
, suorlk 
, sp 
, syntv
, aikielir1 
, tutkkaskun 
, kansalr1
, pohjmaa 
, eumaa 
, etamaa 
, tunn
, jarj
, kkielir1 
, tutklaja 
, tutktav 
, aikoul 
, tutkmaak
, koulutus_1
, oppilaitos_1
, koulutuksen_jarjestaja_1
, koulutuksen_maakunta_1
, koulutus_2
, oppilaitos_2
, koulutuksen_jarjestaja_2
, koulutuksen_maakunta_2
, monihaku
, paaasiallinen_toiminta
, ammattiasema
, lkm
, pohjkoulk
, tietolahde
, aineisto
, lukiokoulutuksessa
, ammatillisessa_koulutuksessa
, ammattikorkeakoulutuksessa
, yliopistokoulutuksessa
, lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa
, toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa
, ammattikorkeakoulutuksessa_ja_yliopistokoulutuksessa
, koulutuksen_paattaneiden_toiminta
, ika_1v
, ika_5v
, ika_1v_suorv
, opisk_lu
, opisk_amm_pk
, opisk_amm_at
, opisk_amm_eat
, opisk_amm
, opisk_amk
, opisk_yo
, opisk_amk_koulala1
, opisk_amk_koulala2
, opisk_amk_koulala3
, opisk_amk_koulala4
, opisk_amk_koulala5
, opisk_amk_koulala6
, opisk_amk_koulala7
, opisk_amk_koulala8
, opisk_amk_koulala9
, opisk_amk_koulala10
, opisk_yo_koulala1
, opisk_yo_koulala2
, opisk_yo_koulala3
, opisk_yo_koulala4
, opisk_yo_koulala5
, opisk_yo_koulala6
, opisk_yo_koulala7
, opisk_yo_koulala8
, opisk_yo_koulala9
, opisk_yo_koulala10
, opisk_vah2_koulala
, haku_amm
, haku_amk
, haku_yo
, eihaku_kk_eiopisk
, eihaku_kk_eiopisk_kk_opisk_ta
, eihaku_kk_eiopisk_kk_opisk_lu
, eihaku_kk_eiopisk_kk_opisk_pk
, eihaku_kk_eiopisk_kk_opisk_at
, eihaku_kk_eiopisk_kk_opisk_eat
, haku_kk_eiopisk_kk
, haku_kk_eiopisk_kk_eiopisk_ta
, haku_kk_eiopisk_kk_opisk_ta
, haku_amk_eiopisk_kk
, haku_yo_eiopisk_kk
, haku_amkyo_eiopisk_kk
, opisk_kk
, opisk_kk_eiopisk_ta
, opisk_kk_opisk_ta
, opisk_vain_amk
, opisk_vain_yo
, opisk_amkyo
)
SELECT 
 l.rivinumero,
 '0',
 l.tilv,
 l.tilv_date,
  (case 
	when l.tutkryh=3 and tutklaja=1 then 31
	when l.tutkryh=3 and tutklaja=2 then 32
	when l.tutkryh=3 and tutklaja=3 then 33
	else l.tutkryh
  end),
 l.suorv,
   (case
	when l.suorlk = '1'  then (l.suorv+'0'+l.suorlk)
	when l.suorlk = '2'  then (l.suorv+'0'+'8')
	else ''
	end),
 l.sp,
 l.syntv,
 l.aikielir1,
 l.tutkaskun,
 l.kansalr1,
 l.pohjmaa,
 l.eumaa,
 l.etamaa,
 l.tunn,
 l.jarj,
 l.kkielir1,
 l.tutklaja,
l.tutktav,
l.aikoul,
l.tutkmaak,


 -- Koulutus 1
 (case
    --lukiokoulutuksessa
	when  l.suorlk = '1' and l.luopiskkoulk_1 <> '' and l.ammopiskkoulk_1 = '' and
	l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' then l.luopiskkoulk_1 
	-- ammattikoulutuksessa _1
	when  l.suorlk = '1' and l.luopiskkoulk_1 = '' and l.ammopiskkoulk_1 <> '' and
	l.amkopiskkoulk_1 ='' and l.yoopiskkoulk_1 = ''  then l.ammopiskkoulk_1 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen _1 ensim. koulutustietoihin
	when  l.suorlk = '1' and l.luopiskkoulk_1 <> '' and l.ammopiskkoulk_1 <> '' and
	l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' then l.luopiskkoulk_1
	-- ammattikorkeakoulutuksessa _1
	when  l.suorlk = '1' and l.amkopiskkoulk_1  <> '' and l.yoopiskkoulk_1  = '' and
	l.luopiskkoulk_1 = '' and l.ammopiskkoulk_1 = '' then l.amkopiskkoulk_1
	-- yliopistokoulutuksessa _1
	when  l.suorlk = '1' and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 <> '' and 
	l.luopiskkoulk_1 = '' and l.ammopiskkoulk_1 = ''   then l.yoopiskkoulk_1
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa, merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when  l.suorlk = '1' and l.amkopiskkoulk_1 <> '' and l.yoopiskkoulk_1  <> '' and
	l.luopiskkoulk_1 = '' and ammopiskkoulk_1 = ''  then l.amkopiskkoulk_1 		
	else ''	    
	    end),
	    
-- Oppilaitos 1
	(case
	-- lukiokoulutuksen oppilaitos
	when  l.suorlk = '1' and l.luopisktunn_1 <> '' and l.ammopisktunn_1 = '' and
	l.amkopisktunn_1 = '' and l.yoopisktunn_1 = '' then l.luopisktunn_1 
	-- ammattikoulutuksen oppilaitos _1
	when  l.suorlk = '1' and l.luopisktunn_1 = '' and l.ammopisktunn_1 <> '' and
	l.amkopisktunn_1 ='' and l.yoopisktunn_1 = ''  then l.ammopisktunn_1 
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos _1
	when  l.suorlk = '1' and l.luopisktunn_1 <> '' and l.ammopisktunn_1 <> '' and
	l.amkopisktunn_1 = '' and l.yoopisktunn_1 = '' then l.luopisktunn_1
	-- ammattikorkeakoulutuksen oppilaitos _1
	when  l.suorlk = '1' and l.amkopisktunn_1  <> '' and l.yoopisktunn_1  = '' and
	l.luopisktunn_1 = '' and l.ammopisktunn_1 = '' then l.amkopisktunn_1
	-- yliopistokoulutuksen oppilaitos _1
	when  l.suorlk = '1' and l.amkopisktunn_1 = '' and l.yoopisktunn_1 <> '' and 
	l.luopisktunn_1 = '' and l.ammopisktunn_1 = ''   then l.yoopisktunn_1
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus _1  
	when  l.suorlk = '1' and l.amkopisktunn_1 <> '' and l.yoopisktunn_1  <> '' and
	l.luopisktunn_1 = '' and l.ammopisktunn_1 = ''  then l.amkopisktunn_1 	
	else ''
	    end),

  --Koulutuksen järjestäjä 1
	(case
	-- lukikoulutuksen järjestäjä
	when  l.suorlk = '1' and l.luopiskjarj_1  <> '' and l.ammopiskjarj_1 = '' and
	l.amkopiskjarj_1 = '' and yoopiskjarj_1 = '' then l.luopiskjarj_1
	-- ammatillisen koulutuksen järjestäjä _1  
	when  l.suorlk = '1' and l.luopiskjarj_1 = '' and l.ammopiskjarj_1 <> '' and
	l.amkopiskjarj_1 ='' and l.yoopiskjarj_1 = ''  then l.ammopiskjarj_1
	-- lukio- ja ammatillisen koulutuksen järjestäjä, merkitään lukiokoulutuksen _1 järjestäjä 
	when  l.suorlk = '1' and l.luopiskjarj_1 <> '' and l.ammopiskjarj_1 <> '' and
	l.amkopiskjarj_1 = '' and l.yoopiskjarj_1 = '' then l.luopiskjarj_1
	-- ammattikorkeakoulutuksen järjestäjä _1
	when  l.suorlk = '1' and l.amkopiskjarj_1  <> '' and l.yoopiskjarj_1   = '' and
	l.luopiskjarj_1 = '' and l.ammopiskjarj_1 = '' then l.amkopiskjarj_1
	-- yliopistokoulutuksen järjestäjä _1 
	when  l.suorlk = '1' and l.amkopiskjarj_1  = '' and l.yoopiskjarj_1  <> '' and 
	l.luopiskjarj_1  = '' and l.ammopiskjarj_1 = ''   then l.yoopiskjarj_1
	-- ammattikorkea- ja yliopistokoulutuksen järjestäjä, merkitään ammattikorkeakoulutuksen _1 järjestäjä   
	when  l.suorlk = '1' and l.amkopiskjarj_1  <> '' and l.yoopiskjarj_1   <> '' and
	l.luopiskjarj_1  = '' and l.ammopiskjarj_1  = ''  then l.amkopiskjarj_1 
	else ''
	    end),

 --Koulutuksen maakunta 1
	(case
	-- lukioopiskelun maakunta 
	when  l.suorlk = '1' and l.luopiskmaak_1   <> '' and l.ammopiskmaak_1  = '' and
	l.amkopiskmaak_1  = '' and l.yoopiskmaak_1  = '' then l.luopiskmaak_1   
	-- ammatillisen koulutuksen maakunta _1
	when  l.suorlk = '1' and l.luopiskmaak_1  = '' and l.ammopiskmaak_1  <> '' and
	l.amkopiskmaak_1  ='' and l.yoopiskmaak_1  = ''  then l.ammopiskmaak_1  
	-- lukiokoulutuksen ja ammatillisen koulutus otetaan lukiokoulutuksen maakunta _1
	when  l.suorlk = '1' and l.luopiskmaak_1  <> '' and l.ammopiskmaak_1  <> '' and
	l.amkopiskmaak_1  = '' and l.yoopiskmaak_1  = '' then l.luopiskmaak_1 
    -- ammattikorkeakoulutuksen maakunta _1
	when  l.suorlk = '1' and l.amkopiskmaak_1   <> '' and l.yoopiskmaak_1   = '' and
	l.luopiskjarj_1 = '' and l.ammopiskmaak_1 = '' then l.amkopiskmaak_1
	-- yliopistokoulutuksen maakunta _1 
	when  l.suorlk = '1' and l.amkopiskmaak_1  = '' and l.yoopiskmaak_1  <> '' and 
	l.luopiskjarj_1  = '' and l.ammopiskmaak_1 = ''   then l.yoopiskmaak_1
	-- ammattikorkekoulutuksen ja yliopistokoulutksen maakunta otetaan ammattikorkeakoulutuksen maakunta _1   
	when  l.suorlk = '1' and l.amkopiskmaak_1  <> '' and l.yoopiskmaak_1   <> '' and
	l.luopiskjarj_1  = '' and l.ammopiskmaak_1  = ''  then l.amkopiskmaak_1 
	else ''	
	    end),

-- Koulutus 2
(case
   -- jos lukiokoulutuksessa vain niin jätetään tyhjäksi
	when  l.suorlk = '1' and l.luopiskkoulk_1 <> '' and l.ammopiskkoulk_1 = '' and
	l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' then ''
	-- jos ammattikoulutuksessa vain  jätetään tyhjäksi _1 
	when  l.suorlk = '1' and l.luopiskkoulk_1 = '' and l.ammopiskkoulk_1 <> '' and
	l.amkopiskkoulk_1 ='' and l.yoopiskkoulk_1 = ''  then ''
	-- jos lukiokoulutksessa ja ammattikoulutuksessa merkitään ammattikoulutus _1 
	when  l.suorlk = '1' and l.luopiskkoulk_1 <> '' and l.ammopiskkoulk_1 <> '' and
	l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' then l.ammopiskkoulk_1 
	-- jos vain ammattikorkeakoulutuksessa jätetään tyhjäksi
	when  l.suorlk = '1' and l.amkopiskkoulk_1  <> '' and l.yoopiskkoulk_1  = '' and
	l.luopiskkoulk_1 = '' and l.ammopiskkoulk_1 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when  l.suorlk = '1' and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 <> '' and 
	l.luopiskkoulk_1 = '' and l.ammopiskkoulk_1 = ''   then ''
	-- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus _1
	when  l.suorlk = '1' and l.amkopiskkoulk_1 <> '' and l.yoopiskkoulk_1  <> '' and
	l.luopiskkoulk_1 = '' and l.ammopiskkoulk_1 = ''  then l.yoopiskkoulk_1
	else ''
	    end),

-- Oppilaitos 2
(case
    -- lukiokoulutuksen oppilaitos vain merkitään tyhjäksi
	when  l.suorlk = '1' and l.luopisktunn_1 <> '' and l.ammopisktunn_1 = '' and
	l.amkopisktunn_1 = '' and l.yoopisktunn_1 = '' then ''
	-- ammatillisen koulutuksen oppilaitos _1 merkitään tyhjäksi
	when  l.suorlk = '1' and l.luopisktunn_1 = '' and l.ammopisktunn_1 <> '' and
	l.amkopisktunn_1 ='' and l.yoopisktunn_1 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos merkitään ammatillisen koulutuksen oppilaitos _1
	when  l.suorlk = '1' and l.luopisktunn_1 <> '' and l.ammopisktunn_1 <> '' and
	l.amkopisktunn_1 = '' and l.yoopisktunn_1 = '' then l.ammopisktunn_1 
	-- ammattikorkeakoulutksen oppilaitos vain merkitään tyhjäksi _1
	when  l.suorlk = '1' and l.amkopisktunn_1  <> '' and l.yoopisktunn_1  = '' and
	l.luopisktunn_1 = '' and l.ammopisktunn_1 = '' then ''
	-- yliopistokoulutksen oppilaitos vain merkitään tyhjäksi _1
	when  l.suorlk = '1' and l.amkopisktunn_1 = '' and l.yoopisktunn_1 <> '' and 
	l.luopisktunn_1 = '' and l.ammopisktunn_1 = ''   then ''  
	--  ammattikorkeakoulutksen oppilaitos ja yliopistokoulutuksen oppilaitos, merkitään yliopistokoulutuksen oppilaitos _1
	when  l.suorlk = '1' and l.amkopisktunn_1 <> '' and l.yoopisktunn_1  <> '' and
	l.luopisktunn_1 = '' and l.ammopisktunn_1 = ''  then l.yoopisktunn_1 
	else ''
	    end),

-- Koulutuksen järjestäjä 2
	(case
	-- lukiokoulutuksen järjestäjä vain _1, merkitään tyhjäksi
	when  l.suorlk = '1' and l.luopiskjarj_1  <> '' and l.ammopiskjarj_1 = '' and
	l.amkopiskjarj_1 = '' and l.yoopiskjarj_1 = '' then ''
	-- ammatillisen koulutuksen järjestäjä vain _1, merkitään tyhjäksi
	when  l.suorlk = '1' and l.luopiskjarj_1 = '' and l.ammopiskjarj_1 <> '' and
	l.amkopiskjarj_1 ='' and l.yoopiskjarj_1 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä _1
	when  l.suorlk = '1' and l.luopiskjarj_1 <> '' and l.ammopiskjarj_1 <> '' and
	l.amkopiskjarj_1 = '' and l.yoopiskjarj_1 = '' then l.ammopiskjarj_1 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi
	when  l.suorlk = '1' and l.amkopiskjarj_1  <> '' and l.yoopiskjarj_1   = '' and
	l.luopiskjarj_1 = '' and l.ammopiskjarj_1 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, merkitään tyhjäksi
	when  l.suorlk = '1' and l.amkopiskjarj_1  = '' and l.yoopiskjarj_1  <> '' and 
	l.luopiskjarj_1  = '' and l.ammopiskjarj_1 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestäjä merkitään yliopistokoulutuksen järjetäjä _1
	when  l.suorlk = '1' and l.amkopiskjarj_1  <> '' and l.yoopiskjarj_1   <> '' and
	l.luopiskjarj_1  = '' and l.ammopiskjarj_1  = ''  then l.yoopiskjarj_1 	
	else ''
	    end),

-- Koulutuksen maakunta 2
	(case
	-- vain lukiokoulutuksen maakunta _1, jätetään tyhjäksi
	when  l.suorlk = '1' and l.luopiskmaak_1   <> '' and l.ammopiskmaak_1  = '' and
	l.amkopiskmaak_1  = '' and l.yoopiskmaak_1  = '' then ''
	-- vain ammatillisen koulutuksen maakunta _1, jätetään tyhjäksi   
	when  l.suorlk = '1' and l.luopiskmaak_1  = '' and l.ammopiskmaak_1  <> '' and
	l.amkopiskmaak_1  ='' and l.yoopiskmaak_1  = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta, merkitään ammatillisen koulutuksen maakunta _1
	when  l.suorlk = '1' and l.luopiskmaak_1  <> '' and l.ammopiskmaak_1  <> '' and
	l.amkopiskmaak_1  = '' and l.yoopiskmaak_1  = '' then l.ammopiskmaak_1 
	-- vain ammattikorkeakoulutuksen maakunta _1, jätetään tyhjäksi
	when  l.suorlk = '1' and l.amkopiskmaak_1   <> '' and l.yoopiskmaak_1   = '' and
	l.luopiskmaak_1 = '' and l.ammopiskmaak_1 = '' then '' 
	-- vain yliopistokoulutuksen maakunta _1, merkitään tyhjäksi
	when  l.suorlk = '1' and l.amkopiskmaak_1  = '' and l.yoopiskmaak_1  <> '' and 
	l.luopiskmaak_1  = '' and l.ammopiskmaak_1 = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta _1, merkitään yliopistokoulutuksen maakunta _1
	when  l.suorlk = '1' and l.amkopiskmaak_1  <> '' and l.yoopiskmaak_1   <> '' and
	l.luopiskjarj_1  = '' and l.ammopiskmaak_1  = ''  then l.yoopiskmaak_1
	else ''
	    end),

	-- Monihaku
	(case 
		when l.monihaku_1 is NULL then ''
		when  l.suorlk = '1' then l.monihaku_1	
		else '8'
	end),

    -- Pääasiallinen toiminta
    (case when l.suorlk = '1' then l.ptoim1r4_1 else '' end),

	-- Ammattiasema
	(case when  l.suorlk = '1' then l.amas_1 else '' end),
    l.lkm,
     (case when l.pohjkoul= '' then '' when l.pohjkoul is NULL then '' else l.pohjkoul end ),
 l.tietolahde,
 'K3.12',
 -- Lukiokoulutuksessa
 (case
	    when  (l.suorlk = '1' ) and  l.luopiskkoulk_1 <> '' and l.ammopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_1 = '' then '1'  
	    else '0'
	    end) as lukiokoulutuksessa,
 -- Ammatillisessa koulutuksessa 
 (case
	    when  (l.suorlk = '1') and  l.ammopiskkoulk_1  <> '' and l.luopiskkoulk_1 = '' and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' then '1' 
	    else '0'
	    end) as ammatillisessa_koulutuksessa,
-- Ammattikorkeakoulutuksessa
 (case
	   when  (l.suorlk = '1') and  l.amkopiskkoulk_1 <> '' and l.ammopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.luopiskkoulk_1 = '' then  '1'
	   else '0' 
	   end) as ammattikorkeakoulutuksessa,
-- Yliopistokoulutuksessa
 (case
	    when  (l.suorlk = '1') and  l.yoopiskkoulk_1  <> '' and l.amkopiskkoulk_1 = '' and l.luopiskkoulk_1 = '' and l.ammopiskkoulk_1 = '' then '1' 
	    else '0'
	    end) as yliopistokoulutuksessa,
-- Lukiokoulutuksessa ja ammatillisessa koulutuksessa
(case
	    when  (l.suorlk = '1') and  l.luopiskkoulk_1  <> '' and l.ammopiskkoulk_1 <> '' and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1  = '' then '1'  
	    else '0'
	    end) as lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa,
-- Toisen asteen ammatillisessa koulutuksessa ja korkeakoulutuksessa
(case
	    when  (l.suorlk = '1') and  l.ammopiskkoulk_1  <> '' and l.amkopiskkoulk_1 <> '' and l.luopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' then '1' 
	    else '0'
	    end) as toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa,
-- Ammattikorkeakoulutuksessa ja yliopistokoulutuksessa
(case
	    when  (l.suorlk = '1') and  l.amkopiskkoulk_1  <> '' and l.yoopiskkoulk_1 <> '' and l.ammopiskkoulk_1  = '' and l.luopiskkoulk_1 = ''  then '1' 
	    else '0'
	    end) as ammattikorkekoulutuksessa_ja_yliopistokoulutuksessa,    
-- Koulutuksen päättäneiden toiminta
(case
	   -- Tutkintoon johtavassa koulutuksessa olevat
	   when (l.suorlk = '1') 
	   and (l.ptoim1r4_1 = '22' or l.ptoim1r4_1 = '13')
	   and (l.luopiskkoulk_1 <>'' or l.ammopiskkoulk_1 <>'' or l.amkopiskkoulk_1 <>'' or l.yoopiskkoulk_1 <>'') then '1' 

	  -- Ei tutkintoon johtavassa koulutuksessa olevat
	   when  (l.suorlk = '1') 
	   and (l.ptoim1r4_1 = '22' or l.ptoim1r4_1 = '13')
	   and (l.luopiskkoulk_1 ='' and l.ammopiskkoulk_1 ='' and l.amkopiskkoulk_1 ='' and l.yoopiskkoulk_1 ='') then '2' 
	 
	   -- Ei opiskelevat työlliset
	   when (l.suorlk = '1')and  l.ptoim1r4_1  = '10'  then '3' 
	   -- Ei opiskelevat työttömät
	   when  (l.suorlk = '1') and  l.ptoim1r4_1  = '12'  then '4' 
	   --  
	   -- Ei opiskelevat muut
		else '5' 
	   end ) as koulutuksen_paattaneiden_toiminta
 ,ika_1v = cast((case 
            when syntv = '' then '-1' else  ((cast(tilv as int) - cast(syntv as int))) end)  as nvarchar(10))
 ,ika_5v =cast(
       (
		case
		when (cast(tilv as int) - cast(syntv as int)) < 15 then '5v10'
		when ((cast(tilv as int) - cast(syntv as int)) >= 15 and (cast(tilv as int) - cast(syntv as int)) <= 19) then '5v15'
		when ((cast(tilv as int) - cast(syntv as int)) >= 20 and (cast(tilv as int) - cast(syntv as int)) <= 24) then '5v20'
		when ((cast(tilv as int) - cast(syntv as int)) >= 25 and (cast(tilv as int) - cast(syntv as int)) <= 29) then '5v25'
		when ((cast(tilv as int) - cast(syntv as int)) >= 30 and (cast(tilv as int) - cast(syntv as int)) <= 34) then '5v30'
		when ((cast(tilv as int) - cast(syntv as int)) >= 35 and (cast(tilv as int) - cast(syntv as int)) <= 39) then '5v35'
		when ((cast(tilv as int) - cast(syntv as int)) >= 40 and (cast(tilv as int) - cast(syntv as int)) <= 44) then '5v40'
		when ((cast(tilv as int) - cast(syntv as int)) >= 45 and (cast(tilv as int) - cast(syntv as int)) <= 49) then '5v45'
		when ((cast(tilv as int) - cast(syntv as int)) >= 50 and (cast(tilv as int) - cast(syntv as int)) <= 54) then '5v50'
		when ((cast(tilv as int) - cast(syntv as int)) >= 55 and (cast(tilv as int) - cast(syntv as int)) <= 59) then '5v55'
		when ((cast(tilv as int) - cast(syntv as int)) >= 60 and (cast(tilv as int) - cast(syntv as int)) <= 64) then '5v60'
		when ((cast(tilv as int) - cast(syntv as int)) >= 65 and (cast(tilv as int) - cast(syntv as int)) <= 69) then '5v65'
		when ((cast(tilv as int) - cast(syntv as int)) >= 70 and (cast(tilv as int) - cast(syntv as int)) <= 74) then '5v70'
		when ((cast(tilv as int) - cast(syntv as int)) >= 75 and (cast(tilv as int) - cast(syntv as int)) <= 79) then '5v75'
		when ((cast(tilv as int) - cast(syntv as int)) >= 80 and (cast(tilv as int) - cast(syntv as int)) <= 84) then '5v80'
		when ((cast(tilv as int) - cast(syntv as int)) >= 85 and (cast(tilv as int) - cast(syntv as int)) <= 89) then '5v85'
		when ((cast(tilv as int) - cast(syntv as int)) >= 90 and (cast(tilv as int) - cast(syntv as int)) <= 94) then '5v90'
		when ((cast(tilv as int) - cast(syntv as int)) >= 95) then '5v95'
		
		end
	   ) as nvarchar (10))

  ,ika_1v_suorv = cast(
					(case 
						when syntv = '' then '-1' 
						else ((cast(suorv as int) - cast(syntv as int))) 
					end)  
	as nvarchar(10))



--uudet muuttujat 03/2018

----OPISKELUT KYLLÄ/EI
--Opiskellut lukiokoulutuksessa
,case
	when  l.suorlk = '1' and l.luopiskkoulk_1 <> '' then 1 else 0
end as opisk_lu
--Opiskellut ammatillisessa peruskoulutuksessa
,case
	when  l.suorlk = '1' and l.ammopiskkoulk_1 <> '' and d1c.Koulutusaste_taso2_koodi = '32' then 1 else 0
end as opisk_amm_pk
--Opiskellut ammattitutkintokoulutuksessa
,case
	when  l.suorlk = '1' and l.ammopiskkoulk_1 <> '' and d1c.Koulutusaste_taso2_koodi = '33' then 1 else 0
end as opisk_amm_at
--Opiskellut erikoisammattitutkintokoulutuksessa
,case
	when l.suorlk = '1' and l.ammopiskkoulk_1 <> '' and d1c.Koulutusaste_taso2_koodi = '41' then 1 else 0
end as opisk_amm_eat
--Opiskellut ammatillisessa koulutuksessa
,case
	when l.suorlk = '1' and l.ammopiskkoulk_1 <> '' then 1 else 0
end as opisk_amm
--Opiskellut ammattikorkeakoulutuksessa
,case
	when  l.suorlk = '1' and l.amkopiskkoulk_1 <> '' then 1 else 0
end as opisk_amk
--Opiskellut yliopistokoulutuksessa
,case
	when  l.suorlk = '1' and l.yoopiskkoulk_1 <> '' then 1 else 0
end as opisk_yo




----KOULUTUSALA, TASO 1 KYLLÄ/EI
--Opiskellut koulutusala1 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and l.amkopiskkoulk_1 <> '' and d1a.iscfibroad2013_koodi = '01' then 1 else 0
end as opisk_amk_koulala1
--Opiskellut koulutusala2 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and l.amkopiskkoulk_1 <> '' and d1a.iscfibroad2013_koodi = '02' then 1 else 0
end as opisk_amk_koulala2
--Opiskellut koulutusala3 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and l.amkopiskkoulk_1 <> '' and d1a.iscfibroad2013_koodi = '03' then 1 else 0
end as opisk_amk_koulala3
--Opiskellut koulutusala4 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and l.amkopiskkoulk_1 <> '' and d1a.iscfibroad2013_koodi = '04' then 1 else 0
end as opisk_amk_koulala4
--Opiskellut koulutusala5 (amk) (taso 1) (kyllä/ei)
,case
	when l.suorlk = '1' and l.amkopiskkoulk_1 <> '' and d1a.iscfibroad2013_koodi = '05' then 1 else 0
end as opisk_amk_koulala5
--Opiskellut koulutusala6 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and l.amkopiskkoulk_1 <> '' and d1a.iscfibroad2013_koodi = '06' then 1 else 0
end as opisk_amk_koulala6
--Opiskellut koulutusala7 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and l.amkopiskkoulk_1 <> '' and d1a.iscfibroad2013_koodi = '07' then 1 else 0
end as opisk_amk_koulala7
--Opiskellut koulutusala8 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and l.amkopiskkoulk_1 <> '' and d1a.iscfibroad2013_koodi = '08' then 1 else 0
end as opisk_amk_koulala8
--Opiskellut koulutusala9 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and l.amkopiskkoulk_1 <> '' and d1a.iscfibroad2013_koodi = '09' then 1 else 0
end as opisk_amk_koulala9
--Opiskellut koulutusala10 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and l.amkopiskkoulk_1 <> '' and d1a.iscfibroad2013_koodi = '10' then 1 else 0
end as opisk_amk_koulala10




--Opiskellut koulutusala1 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and l.yoopiskkoulk_1 <> '' and d1b.iscfibroad2013_koodi = '01' then 1 else 0
end as opisk_yo_koulala1
--Opiskellut koulutusala2 (yo) (taso 1) (kyllä/ei)
,case
	when l.suorlk = '1' and l.yoopiskkoulk_1 <> '' and d1b.iscfibroad2013_koodi = '02' then 1 else 0
end as opisk_yo_koulala2
--Opiskellut koulutusala3 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and l.yoopiskkoulk_1 <> '' and d1b.iscfibroad2013_koodi = '03' then 1 else 0
end as opisk_yo_koulala3
--Opiskellut koulutusala4 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and l.yoopiskkoulk_1 <> '' and d1b.iscfibroad2013_koodi = '04' then 1 else 0
end as opisk_yo_koulala4
--Opiskellut koulutusala5 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and l.yoopiskkoulk_1 <> '' and d1b.iscfibroad2013_koodi = '05' then 1 else 0
end as opisk_yo_koulala5
--Opiskellut koulutusala6 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and l.yoopiskkoulk_1 <> '' and d1b.iscfibroad2013_koodi = '06' then 1 else 0
end as opisk_yo_koulala6
--Opiskellut koulutusala7 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and l.yoopiskkoulk_1 <> '' and d1b.iscfibroad2013_koodi = '07' then 1 else 0
end as opisk_yo_koulala7
--Opiskellut koulutusala8 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and l.yoopiskkoulk_1 <> '' and d1b.iscfibroad2013_koodi = '08' then 1 else 0
end as opisk_yo_koulala8
--Opiskellut koulutusala9 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and l.yoopiskkoulk_1 <> '' and d1b.iscfibroad2013_koodi = '09' then 1 else 0
end as opisk_yo_koulala9
--Opiskellut koulutusala10 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and l.yoopiskkoulk_1 <> '' and d1b.iscfibroad2013_koodi = '10' then 1 else 0
end as opisk_yo_koulala10


--Opiskellut useampaa kuin yhtä alaa (taso 1) (kyllä/ei)
,case --ensimmäisenä vuotena on mahdollista olla vain yksi ala
	when  l.suorlk = '1' and d1a.iscfibroad2013_koodi <> d1b.iscfibroad2013_koodi then 1 else 0
end as opisk_vah2_koulala



----HAUT KYLLÄ/EI
--Hakenut ammatilliseen koulutukseen
,case
	when  l.suorlk = '1' and l.monihaku_1 in (2,3,5) then 1 else 0
end as haku_amm
--Hakenut ammattikorkeakoulutukseen
,case
	when l.suorlk = '1' and l.monihaku_1 in (4,6) then 1 else 0
end as haku_amk
--Hakenut yliopistokoulutukseen
,case
	when l.suorlk = '1' and l.monihaku_1 in (6,7) then 1 else 0
end as haku_yo




----MITTARIT
--Ei hakenut eikä opiskellut mitään
,case
	when  l.suorlk = '1' and monihaku_1 not in (4,5,6,7) and l.luopiskkoulk_1 = '' and l.ammopiskkoulk_1 = '' and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' then 1 else 0
end eihaku_kk_eiopisk

--Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa
,case 
	when  l.suorlk = '1' and monihaku_1 not in (4,5,6,7) and (l.luopiskkoulk_1 <> '' or l.ammopiskkoulk_1 <> '') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' then 1 else 0
end eihaku_kk_eiopisk_kk_opisk_ta

----Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa, opiskellut lukiokoulutuksessa
,case 
	when  l.suorlk = '1' and monihaku_1 not in (4,5,6,7) and (l.luopiskkoulk_1 <> '') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' then 1 else 0
end eihaku_kk_eiopisk_kk_opisk_lu

----Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa, opiskellut ammatillisessa peruskoulutuksessa
,case 
	when l.suorlk = '1' and monihaku_1 not in (4,5,6,7) and (l.ammopiskkoulk_1 <> '') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and d1c.Koulutusaste_taso2_koodi = '32' then 1 else 0
end eihaku_kk_eiopisk_kk_opisk_pk

------Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa, opiskellut ammattitutkintokoulutuksessa
,case 
	when  l.suorlk = '1' and monihaku_1 not in (4,5,6,7) and (l.ammopiskkoulk_1 <> '') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and d1c.Koulutusaste_taso2_koodi = '33' then 1 else 0
end eihaku_kk_eiopisk_kk_opisk_at

------Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa, opiskellut erikoisammattitutkintokoulutuksessa
,case 
	when  l.suorlk = '1' and monihaku_1 not in (4,5,6,7) and (l.ammopiskkoulk_1 <> '') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and d1c.Koulutusaste_taso2_koodi = '41' then 1 else 0
end eihaku_kk_eiopisk_kk_opisk_eat

--Hakenut korkea-asteelle, ei opiskellut korkea-asteella
,case 
	when  l.suorlk = '1' and monihaku_1 in (4,5,6,7) and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' then 1 else 0
end haku_kk_eiopisk_kk
----Hakenut korkea-asteelle, ei opiskellut korkea-asteella, ei-opiskellut toisen asteen koulutuksessa
,case
	when l.suorlk = '1' and monihaku_1 in (4,5,6,7) and l.luopiskkoulk_1 = '' and l.ammopiskkoulk_1 = '' and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' then 1 else 0
end haku_kk_eiopisk_kk_eiopisk_ta
----Hakenut korkea-asteelle, ei opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa
,case
	when  l.suorlk = '1' and monihaku_1 in (4,5,6,7) and (l.luopiskkoulk_1 <> '' or l.ammopiskkoulk_1 <> '') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' then 1 else 0
end haku_kk_eiopisk_kk_opisk_ta
----Hakenut vain ammattikorkeakouluun, ei opiskellut korkea-asteella
,case
	when  l.suorlk = '1' and monihaku_1 = 4 and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' then 1 else 0
end haku_amk_eiopisk_kk
----Hakenut vain yliopistokoulutukseen, ei opiskellut korkea-asteella
,case
	when  l.suorlk = '1' and monihaku_1 = 7 and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' then 1	else 0
end haku_yo_eiopisk_kk
----Hakenut sekä amk- että yliopistokoulutukseen, ei opiskellut korkea-asteella
,case
	when  l.suorlk = '1' and monihaku_1 = 6 and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' then 1 else 0
end haku_amkyo_eiopisk_kk

--Opiskellut korkea-asteella
,case
	when  l.suorlk = '1' and (l.amkopiskkoulk_1 <> '' or l.yoopiskkoulk_1 <> '') then 1 else 0
end opisk_kk
----Opiskellut korkea-asteella, ei-opiskellut toisen asteen koulutuksessa
,case
	when  l.suorlk = '1' and l.luopiskkoulk_1 = '' and l.ammopiskkoulk_1 = '' and (l.amkopiskkoulk_1 <> '' or l.yoopiskkoulk_1 <> '') then 1 else 0
end opisk_kk_eiopisk_ta
----Opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa
,case
	when  l.suorlk = '1' and (l.luopiskkoulk_1 <> '' or l.ammopiskkoulk_1 <> '') and (l.amkopiskkoulk_1 <> '' or l.yoopiskkoulk_1 <> '') then 1 else 0
end opisk_kk_opisk_ta
----Opiskellut vain ammattikorkeakoulussa
,case
	when  l.suorlk = '1' and l.amkopiskkoulk_1 <> '' and l.yoopiskkoulk_1 = '' then 1 else 0
end opisk_vain_amk
----Opiskellut vain yliopistokoulutuksessa
,case
	when  l.suorlk = '1' and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 <> '' then 1 else 0
end opisk_vain_yo
----Opiskellut sekä amk- että yliopistokoulutuksessa
,case
	when  l.suorlk = '1' and l.amkopiskkoulk_1 <> '' and l.yoopiskkoulk_1 <> '' then 1 else 0
end opisk_amkyo


FROM 
    (
	select * from [VipunenTK_SA].[dbo].[v_K3_12_Perusk_paattaneet_amm_tutk_suorittaneet]
	where suorlk = '1'
	) as l

INNER JOIN VipunenTK.dbo.d_koulutusluokitus d1a on d1a.koulutusluokitus_avain=COALESCE(NULLIF(l.amkopiskkoulk_1,''),'-1')
--INNER JOIN VipunenTK.dbo.d_koulutusluokitus d2a on d2a.koulutusluokitus_avain=COALESCE(NULLIF(l.amkopiskkoulk_2,''),'-1')
/*INNER JOIN VipunenTK.dbo.d_koulutusluokitus d2a on d2a.koulutusluokitus_avain=COALESCE(NULLIF(l.amkopiskkoulk2009,''),'-1')
INNER JOIN VipunenTK.dbo.d_koulutusluokitus d3a on d3a.koulutusluokitus_avain=COALESCE(NULLIF(l.amkopiskkoulk2010,''),'-1')
INNER JOIN VipunenTK.dbo.d_koulutusluokitus d4a on d4a.koulutusluokitus_avain=COALESCE(NULLIF(l.amkopiskkoulk2011,''),'-1')
INNER JOIN VipunenTK.dbo.d_koulutusluokitus d5a on d5a.koulutusluokitus_avain=COALESCE(NULLIF(l.amkopiskkoulk2012,''),'-1')
INNER JOIN VipunenTK.dbo.d_koulutusluokitus d6a on d6a.koulutusluokitus_avain=COALESCE(NULLIF(l.amkopiskkoulk2013,''),'-1')
INNER JOIN VipunenTK.dbo.d_koulutusluokitus d7a on d7a.koulutusluokitus_avain=COALESCE(NULLIF(l.amkopiskkoulk2014,''),'-1')
INNER JOIN VipunenTK.dbo.d_koulutusluokitus d8a on d8a.koulutusluokitus_avain=COALESCE(NULLIF(l.amkopiskkoulk2015,''),'-1')*/

INNER JOIN VipunenTK.dbo.d_koulutusluokitus d1b on d1b.koulutusluokitus_avain=COALESCE(NULLIF(l.yoopiskkoulk_1,''),'-1')
--INNER JOIN VipunenTK.dbo.d_koulutusluokitus d2b on d2b.koulutusluokitus_avain=COALESCE(NULLIF(l.yoopiskkoulk_2,''),'-1')
/*INNER JOIN VipunenTK.dbo.d_koulutusluokitus d2b on d2b.koulutusluokitus_avain=COALESCE(NULLIF(l.yoopiskkoulk2009,''),'-1')
INNER JOIN VipunenTK.dbo.d_koulutusluokitus d3b on d3b.koulutusluokitus_avain=COALESCE(NULLIF(l.yoopiskkoulk2010,''),'-1')
INNER JOIN VipunenTK.dbo.d_koulutusluokitus d4b on d4b.koulutusluokitus_avain=COALESCE(NULLIF(l.yoopiskkoulk2011,''),'-1')
INNER JOIN VipunenTK.dbo.d_koulutusluokitus d5b on d5b.koulutusluokitus_avain=COALESCE(NULLIF(l.yoopiskkoulk2012,''),'-1')
INNER JOIN VipunenTK.dbo.d_koulutusluokitus d6b on d6b.koulutusluokitus_avain=COALESCE(NULLIF(l.yoopiskkoulk2013,''),'-1')
INNER JOIN VipunenTK.dbo.d_koulutusluokitus d7b on d7b.koulutusluokitus_avain=COALESCE(NULLIF(l.yoopiskkoulk2014,''),'-1')
INNER JOIN VipunenTK.dbo.d_koulutusluokitus d8b on d8b.koulutusluokitus_avain=COALESCE(NULLIF(l.yoopiskkoulk2015,''),'-1')*/

INNER JOIN VipunenTK.dbo.d_koulutusluokitus d1c on d1c.koulutusluokitus_avain=COALESCE(NULLIF(l.ammopiskkoulk_1,''),'-1')
--INNER JOIN VipunenTK.dbo.d_koulutusluokitus d2c on d2c.koulutusluokitus_avain=COALESCE(NULLIF(l.ammopiskkoulk_2,''),'-1')
/*INNER JOIN VipunenTK.dbo.d_koulutusluokitus d2c on d2c.koulutusluokitus_avain=COALESCE(NULLIF(l.ammopiskkoulk2009,''),'-1')
INNER JOIN VipunenTK.dbo.d_koulutusluokitus d3c on d3c.koulutusluokitus_avain=COALESCE(NULLIF(l.ammopiskkoulk2010,''),'-1')
INNER JOIN VipunenTK.dbo.d_koulutusluokitus d4c on d4c.koulutusluokitus_avain=COALESCE(NULLIF(l.ammopiskkoulk2011,''),'-1')
INNER JOIN VipunenTK.dbo.d_koulutusluokitus d5c on d5c.koulutusluokitus_avain=COALESCE(NULLIF(l.ammopiskkoulk2012,''),'-1')
INNER JOIN VipunenTK.dbo.d_koulutusluokitus d6c on d6c.koulutusluokitus_avain=COALESCE(NULLIF(l.ammopiskkoulk2013,''),'-1')
INNER JOIN VipunenTK.dbo.d_koulutusluokitus d7c on d7c.koulutusluokitus_avain=COALESCE(NULLIF(l.ammopiskkoulk2014,''),'-1')	
INNER JOIN VipunenTK.dbo.d_koulutusluokitus d8c on d8c.koulutusluokitus_avain=COALESCE(NULLIF(l.ammopiskkoulk2015,''),'-1')	*/

	WHERE 1=1
--end;

--
-- TULOS
-- 
/*if @debug_what_to_run>=3 begin
	if @debug_what_to_run>0 print 'querying result';
	select * from [VipunenTK_DW].[dbo].[_koulutukseen_sijoittuneet_2v]
	
end;

if @debug_what_to_run>0 PRINT 'all done.';*/


--GO



GO
/****** Object:  StoredProcedure [dbo].[p_lataa_f_koulutukseen_sijoittuneet_2v_0_5_tarkastelujakso]    Script Date: 29.8.2018 15:59:41 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


CREATE PROCEDURE [dbo].[p_lataa_f_koulutukseen_sijoittuneet_2v_0_5_tarkastelujakso] AS


/*declare @debug_what_to_run tinyint; set @debug_what_to_run=2; -- käytä arvoa 3 vain kun teet yhden vuoden
print '$'+convert(varchar,sysdatetime(),20)+'$ '+'DEBUG (what to run)='+cast(@debug_what_to_run as varchar)+
': 0=luo vain taulut, älä tulosta mitään; 1=luo taulut ja tulosta joitakin merkittävimpiä välivaiheita; 2=luo taulut ja tulosta välivaiheet; 3=luo taulut, tulosta välivaiheet ja tulosta myös tulokset, 4=tulosta välivaiheet, mutta älä tee mitään';



-- lisätään data
if @debug_what_to_run not in (4) begin
if @debug_what_to_run>0 print 'inserting data';

-- parametrimuuttujien arvot
-- parametrimuuttujat
DECLARE @ensimmainen_suoritusvuosi int;
DECLARE @toinen_suoritusvuosi int;
DECLARE @kolmas_suoritusvuosi int;
DECLARE @neljas_suoritusvuosi int;
DECLARE @viides_suoritusvuosi int;
DECLARE @kuudes_suoritusvuosi int;
DECLARE @seitsemas_suoritusvuosi int;
DECLARE @kahdeksas_suoritusvuosi int;

set @ensimmainen_suoritusvuosi = _1;
set @toinen_suoritusvuosi = _2;
set @kolmas_suoritusvuosi = 2010;
set @neljas_suoritusvuosi = 2011;
set @viides_suoritusvuosi = 2012;
set @kuudes_suoritusvuosi = 2013;
set @seitsemas_suoritusvuosi = 2014;
set @kahdeksas_suoritusvuosi = 2015;

*/

INSERT INTO [VipunenTK_DW].[dbo].[_koulutukseen_sijoittuneet_2v_tarkastelu]
(
rivinumero
, tarkastelujakso
, tilv 
, tilv_date
, tutkryh 
, suorv
, suorlk 
, sp 
, syntv
, aikielir1 
, tutkkaskun 
, kansalr1
, pohjmaa 
, eumaa 
, etamaa 
, tunn
, jarj
, kkielir1 
, tutklaja 
, tutktav 
, aikoul 
, tutkmaak
, koulutus_1
, oppilaitos_1
, koulutuksen_jarjestaja_1
, koulutuksen_maakunta_1
, koulutus_2
, oppilaitos_2
, koulutuksen_jarjestaja_2
, koulutuksen_maakunta_2
, monihaku
, paaasiallinen_toiminta
, ammattiasema
, lkm
, pohjkoulk
, tietolahde
, aineisto
, lukiokoulutuksessa
, ammatillisessa_koulutuksessa
, ammattikorkeakoulutuksessa
, yliopistokoulutuksessa
, lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa
, toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa
, ammattikorkeakoulutuksessa_ja_yliopistokoulutuksessa
, koulutuksen_paattaneiden_toiminta
, ika_1v
, ika_5v
, ika_1v_suorv
, opisk_lu
, opisk_amm_pk
, opisk_amm_at
, opisk_amm_eat
, opisk_amm
, opisk_amk
, opisk_yo
, opisk_amk_koulala1
, opisk_amk_koulala2
, opisk_amk_koulala3
, opisk_amk_koulala4
, opisk_amk_koulala5
, opisk_amk_koulala6
, opisk_amk_koulala7
, opisk_amk_koulala8
, opisk_amk_koulala9
, opisk_amk_koulala10
, opisk_yo_koulala1
, opisk_yo_koulala2
, opisk_yo_koulala3
, opisk_yo_koulala4
, opisk_yo_koulala5
, opisk_yo_koulala6
, opisk_yo_koulala7
, opisk_yo_koulala8
, opisk_yo_koulala9
, opisk_yo_koulala10
, opisk_vah2_koulala
, haku_amm
, haku_amk
, haku_yo
, eihaku_kk_eiopisk
, eihaku_kk_eiopisk_kk_opisk_ta
, eihaku_kk_eiopisk_kk_opisk_lu
, eihaku_kk_eiopisk_kk_opisk_pk
, eihaku_kk_eiopisk_kk_opisk_at
, eihaku_kk_eiopisk_kk_opisk_eat
, haku_kk_eiopisk_kk
, haku_kk_eiopisk_kk_eiopisk_ta
, haku_kk_eiopisk_kk_opisk_ta
, haku_amk_eiopisk_kk
, haku_yo_eiopisk_kk
, haku_amkyo_eiopisk_kk
, opisk_kk
, opisk_kk_eiopisk_ta
, opisk_kk_opisk_ta
, opisk_vain_amk
, opisk_vain_yo
, opisk_amkyo
)
SELECT
 l.rivinumero,
 '0,5',
 l.tilv,
 l.tilv_date,
  (case 
	when l.tutkryh=3 and tutklaja=1 then 31
	when l.tutkryh=3 and tutklaja=2 then 32
	when l.tutkryh=3 and tutklaja=3 then 33
	else l.tutkryh
  end),
 l.suorv,
  (case
	when l.suorlk = '1'  then (l.suorv+'0'+l.suorlk)
	when l.suorlk = '2'  then (l.suorv+'0'+'8')
	else ''
	end),
 l.sp,
 l.syntv,
 l.aikielir1,
 l.tutkaskun,
 l.kansalr1,
 l.pohjmaa,
 l.eumaa,
 l.etamaa,
 l.tunn,
 l.jarj,
 l.kkielir1,
 l.tutklaja,
l.tutktav,
l.aikoul,
l.tutkmaak,


 -- Koulutus 1
 (case
    --lukiokoulutuksessa
	when  l.suorlk = '2' and l.luopiskkoulk_2 <> '' and l.ammopiskkoulk_2 = '' and
	l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' then l.luopiskkoulk_2 
	-- ammattikoulutuksessa _2
	when  l.suorlk = '2' and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 <> '' and
	l.amkopiskkoulk_2 ='' and l.yoopiskkoulk_2 = ''  then l.ammopiskkoulk_2 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen _2 ensim. koulutustietoihin
	when  l.suorlk = '2' and l.luopiskkoulk_2 <> '' and l.ammopiskkoulk_2 <> '' and
	l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' then l.luopiskkoulk_2
	-- ammattikorkeakoulutuksessa _2
	when  l.suorlk = '2' and l.amkopiskkoulk_2  <> '' and l.yoopiskkoulk_2  = '' and
	l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' then l.amkopiskkoulk_2
	-- yliopistokoulutuksessa _2
	when  l.suorlk = '2' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 <> '' and 
	l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = ''   then l.yoopiskkoulk_2
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa, merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when  l.suorlk = '2' and l.amkopiskkoulk_2 <> '' and l.yoopiskkoulk_2  <> '' and
	l.luopiskkoulk_2 = '' and ammopiskkoulk_2 = ''  then l.amkopiskkoulk_2 		
	else ''	    
	    end),
	    
-- Oppilaitos 1
	(case
	-- lukiokoulutuksen oppilaitos
	when  l.suorlk = '2' and l.luopisktunn_2 <> '' and l.ammopisktunn_2 = '' and
	l.amkopisktunn_2 = '' and l.yoopisktunn_2 = '' then l.luopisktunn_2 
	-- ammattikoulutuksen oppilaitos _2
	when  l.suorlk = '2' and l.luopisktunn_2 = '' and l.ammopisktunn_2 <> '' and
	l.amkopisktunn_2 ='' and l.yoopisktunn_2 = ''  then l.ammopisktunn_2 
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos _2
	when  l.suorlk = '2' and l.luopisktunn_2 <> '' and l.ammopisktunn_2 <> '' and
	l.amkopisktunn_2 = '' and l.yoopisktunn_2 = '' then l.luopisktunn_2
	-- ammattikorkeakoulutuksen oppilaitos _2
	when  l.suorlk = '2' and l.amkopisktunn_2  <> '' and l.yoopisktunn_2  = '' and
	l.luopisktunn_2 = '' and l.ammopisktunn_2 = '' then l.amkopisktunn_2
	-- yliopistokoulutuksen oppilaitos _2
	when  l.suorlk = '2' and l.amkopisktunn_2 = '' and l.yoopisktunn_2 <> '' and 
	l.luopisktunn_2 = '' and l.ammopisktunn_2 = ''   then l.yoopisktunn_2
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus _2  
	when  l.suorlk = '2' and l.amkopisktunn_2 <> '' and l.yoopisktunn_2  <> '' and
	l.luopisktunn_2 = '' and l.ammopisktunn_2 = ''  then l.amkopisktunn_2 	
	else ''
	    end),

  --Koulutuksen järjestäjä 1
	(case
	-- lukikoulutuksen järjestäjä
	when  l.suorlk = '2' and l.luopiskjarj_2  <> '' and l.ammopiskjarj_2 = '' and
	l.amkopiskjarj_2 = '' and yoopiskjarj_2 = '' then l.luopiskjarj_2
	-- ammatillisen koulutuksen järjestäjä _2  
	when  l.suorlk = '2' and l.luopiskjarj_2 = '' and l.ammopiskjarj_2 <> '' and
	l.amkopiskjarj_2 ='' and l.yoopiskjarj_2 = ''  then l.ammopiskjarj_2
	-- lukio- ja ammatillisen koulutuksen järjestäjä, merkitään lukiokoulutuksen _2 järjestäjä 
	when  l.suorlk = '2' and l.luopiskjarj_2 <> '' and l.ammopiskjarj_2 <> '' and
	l.amkopiskjarj_2 = '' and l.yoopiskjarj_2 = '' then l.luopiskjarj_2
	-- ammattikorkeakoulutuksen järjestäjä _2
	when  l.suorlk = '2' and l.amkopiskjarj_2  <> '' and l.yoopiskjarj_2   = '' and
	l.luopiskjarj_2 = '' and l.ammopiskjarj_2 = '' then l.amkopiskjarj_2
	-- yliopistokoulutuksen järjestäjä _2 
	when  l.suorlk = '2' and l.amkopiskjarj_2  = '' and l.yoopiskjarj_2  <> '' and 
	l.luopiskjarj_2  = '' and l.ammopiskjarj_2 = ''   then l.yoopiskjarj_2
	-- ammattikorkea- ja yliopistokoulutuksen järjestäjä, merkitään ammattikorkeakoulutuksen _2 järjestäjä   
	when  l.suorlk = '2' and l.amkopiskjarj_2  <> '' and l.yoopiskjarj_2   <> '' and
	l.luopiskjarj_2  = '' and l.ammopiskjarj_2  = ''  then l.amkopiskjarj_2 
	else ''
	    end),

 --Koulutuksen maakunta 1
	(case
	-- lukioopiskelun maakunta 
	when  l.suorlk = '2' and l.luopiskmaak_2   <> '' and l.ammopiskmaak_2  = '' and
	l.amkopiskmaak_2  = '' and l.yoopiskmaak_2  = '' then l.luopiskmaak_2   
	-- ammatillisen koulutuksen maakunta _2
	when  l.suorlk = '2' and l.luopiskmaak_2  = '' and l.ammopiskmaak_2  <> '' and
	l.amkopiskmaak_2  ='' and l.yoopiskmaak_2  = ''  then l.ammopiskmaak_2  
	-- lukiokoulutuksen ja ammatillisen koulutus otetaan lukiokoulutuksen maakunta _2
	when  l.suorlk = '2' and l.luopiskmaak_2  <> '' and l.ammopiskmaak_2  <> '' and
	l.amkopiskmaak_2  = '' and l.yoopiskmaak_2  = '' then l.luopiskmaak_2 
    -- ammattikorkeakoulutuksen maakunta _2
	when  l.suorlk = '2' and l.amkopiskmaak_2   <> '' and l.yoopiskmaak_2   = '' and
	l.luopiskjarj_2 = '' and l.ammopiskmaak_2 = '' then l.amkopiskmaak_2
	-- yliopistokoulutuksen maakunta _2 
	when  l.suorlk = '2' and l.amkopiskmaak_2  = '' and l.yoopiskmaak_2  <> '' and 
	l.luopiskjarj_2  = '' and l.ammopiskmaak_2 = ''   then l.yoopiskmaak_2
	-- ammattikorkekoulutuksen ja yliopistokoulutksen maakunta otetaan ammattikorkeakoulutuksen maakunta _2   
	when  l.suorlk = '2' and l.amkopiskmaak_2  <> '' and l.yoopiskmaak_2   <> '' and
	l.luopiskjarj_2  = '' and l.ammopiskmaak_2  = ''  then l.amkopiskmaak_2 
	else ''	
	    end),

-- Koulutus 2
(case
   -- jos lukiokoulutuksessa vain niin jätetään tyhjäksi
	when  l.suorlk = '2' and l.luopiskkoulk_2 <> '' and l.ammopiskkoulk_2 = '' and
	l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' then ''
	-- jos ammattikoulutuksessa vain  jätetään tyhjäksi _2 
	when  l.suorlk = '2' and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 <> '' and
	l.amkopiskkoulk_2 ='' and l.yoopiskkoulk_2 = ''  then ''
	-- jos lukiokoulutksessa ja ammattikoulutuksessa merkitään ammattikoulutus _2 
	when  l.suorlk = '2' and l.luopiskkoulk_2 <> '' and l.ammopiskkoulk_2 <> '' and
	l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' then l.ammopiskkoulk_2 
	-- jos vain ammattikorkeakoulutuksessa jätetään tyhjäksi
	when  l.suorlk = '2' and l.amkopiskkoulk_2  <> '' and l.yoopiskkoulk_2  = '' and
	l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when  l.suorlk = '2' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 <> '' and 
	l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = ''   then ''
	-- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus _2
	when  l.suorlk = '2' and l.amkopiskkoulk_2 <> '' and l.yoopiskkoulk_2  <> '' and
	l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = ''  then l.yoopiskkoulk_2
	else ''
	    end),

-- Oppilaitos 2
(case
    -- lukiokoulutuksen oppilaitos vain merkitään tyhjäksi
	when  l.suorlk = '2' and l.luopisktunn_2 <> '' and l.ammopisktunn_2 = '' and
	l.amkopisktunn_2 = '' and l.yoopisktunn_2 = '' then ''
	-- ammatillisen koulutuksen oppilaitos _2 merkitään tyhjäksi
	when  l.suorlk = '2' and l.luopisktunn_2 = '' and l.ammopisktunn_2 <> '' and
	l.amkopisktunn_2 ='' and l.yoopisktunn_2 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos merkitään ammatillisen koulutuksen oppilaitos _2
	when  l.suorlk = '2' and l.luopisktunn_2 <> '' and l.ammopisktunn_2 <> '' and
	l.amkopisktunn_2 = '' and l.yoopisktunn_2 = '' then l.ammopisktunn_2 
	-- ammattikorkeakoulutksen oppilaitos vain merkitään tyhjäksi _2
	when  l.suorlk = '2' and l.amkopisktunn_2  <> '' and l.yoopisktunn_2  = '' and
	l.luopisktunn_2 = '' and l.ammopisktunn_2 = '' then ''
	-- yliopistokoulutksen oppilaitos vain merkitään tyhjäksi _2
	when  l.suorlk = '2' and l.amkopisktunn_2 = '' and l.yoopisktunn_2 <> '' and 
	l.luopisktunn_2 = '' and l.ammopisktunn_2 = ''   then ''  
	--  ammattikorkeakoulutksen oppilaitos ja yliopistokoulutuksen oppilaitos, merkitään yliopistokoulutuksen oppilaitos _2
	when  l.suorlk = '2' and l.amkopisktunn_2 <> '' and l.yoopisktunn_2  <> '' and
	l.luopisktunn_2 = '' and l.ammopisktunn_2 = ''  then l.yoopisktunn_2 
	else ''
	    end),

-- Koulutuksen järjestäjä 2
	(case
	-- lukiokoulutuksen järjestäjä vain _2, merkitään tyhjäksi
	when  l.suorlk = '2' and l.luopiskjarj_2  <> '' and l.ammopiskjarj_2 = '' and
	l.amkopiskjarj_2 = '' and l.yoopiskjarj_2 = '' then ''
	-- ammatillisen koulutuksen järjestäjä vain _2, merkitään tyhjäksi
	when  l.suorlk = '2' and l.luopiskjarj_2 = '' and l.ammopiskjarj_2 <> '' and
	l.amkopiskjarj_2 ='' and l.yoopiskjarj_2 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä _2
	when  l.suorlk = '2' and l.luopiskjarj_2 <> '' and l.ammopiskjarj_2 <> '' and
	l.amkopiskjarj_2 = '' and l.yoopiskjarj_2 = '' then l.ammopiskjarj_2 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi
	when  l.suorlk = '2' and l.amkopiskjarj_2  <> '' and l.yoopiskjarj_2   = '' and
	l.luopiskjarj_2 = '' and l.ammopiskjarj_2 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, merkitään tyhjäksi
	when  l.suorlk = '2' and l.amkopiskjarj_2  = '' and l.yoopiskjarj_2  <> '' and 
	l.luopiskjarj_2  = '' and l.ammopiskjarj_2 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestäjä merkitään yliopistokoulutuksen järjetäjä _2
	when  l.suorlk = '2' and l.amkopiskjarj_2  <> '' and l.yoopiskjarj_2   <> '' and
	l.luopiskjarj_2  = '' and l.ammopiskjarj_2  = ''  then l.yoopiskjarj_2 	
	else ''
	    end),

-- Koulutuksen maakunta 2
	(case
	-- vain lukiokoulutuksen maakunta _2, jätetään tyhjäksi
	when  l.suorlk = '2' and l.luopiskmaak_2   <> '' and l.ammopiskmaak_2  = '' and
	l.amkopiskmaak_2  = '' and l.yoopiskmaak_2  = '' then ''
	-- vain ammatillisen koulutuksen maakunta _2, jätetään tyhjäksi   
	when  l.suorlk = '2' and l.luopiskmaak_2  = '' and l.ammopiskmaak_2  <> '' and
	l.amkopiskmaak_2  ='' and l.yoopiskmaak_2  = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta, merkitään ammatillisen koulutuksen maakunta _2
	when  l.suorlk = '2' and l.luopiskmaak_2  <> '' and l.ammopiskmaak_2  <> '' and
	l.amkopiskmaak_2  = '' and l.yoopiskmaak_2  = '' then l.ammopiskmaak_2 
	-- vain ammattikorkeakoulutuksen maakunta _2, jätetään tyhjäksi
	when  l.suorlk = '2' and l.amkopiskmaak_2   <> '' and l.yoopiskmaak_2   = '' and
	l.luopiskmaak_2 = '' and l.ammopiskmaak_2 = '' then '' 
	-- vain yliopistokoulutuksen maakunta _2, merkitään tyhjäksi
	when  l.suorlk = '2' and l.amkopiskmaak_2  = '' and l.yoopiskmaak_2  <> '' and 
	l.luopiskmaak_2  = '' and l.ammopiskmaak_2 = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta _2, merkitään yliopistokoulutuksen maakunta _2
	when  l.suorlk = '2' and l.amkopiskmaak_2  <> '' and l.yoopiskmaak_2   <> '' and
	l.luopiskjarj_2  = '' and l.ammopiskmaak_2  = ''  then l.yoopiskmaak_2
	else ''
	    end),

	-- Monihaku
	(case 
		when l.monihaku_2 is NULL then ''
		when  l.suorlk = '2' then l.monihaku_2	
		else '8'
	end),

    -- Pääasiallinen toiminta
    (case when l.suorlk = '2' then l.ptoim1r4_2 else '' end),

	-- Ammattiasema
	(case when  l.suorlk = '2' then l.amas_2 else '' end),
    l.lkm,
     (case when l.pohjkoul= '' then '' when l.pohjkoul is NULL then '' else l.pohjkoul end ),
 l.tietolahde,
 'K3.12',
 -- Lukiokoulutuksessa
 (case
	    when  (l.suorlk = '2' ) and  l.luopiskkoulk_2 <> '' and l.ammopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_2 = '' then '1'  
	    else '0'
	    end) as lukiokoulutuksessa,
 -- Ammatillisessa koulutuksessa 
 (case
	    when  (l.suorlk = '2') and  l.ammopiskkoulk_2  <> '' and l.luopiskkoulk_2 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' then '1' 
	    else '0'
	    end) as ammatillisessa_koulutuksessa,
-- Ammattikorkeakoulutuksessa
 (case
	   when  (l.suorlk = '2') and  l.amkopiskkoulk_2 <> '' and l.ammopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.luopiskkoulk_2 = '' then  '1'
	   else '0' 
	   end) as ammattikorkeakoulutuksessa,
-- Yliopistokoulutuksessa
 (case
	    when  (l.suorlk = '2') and  l.yoopiskkoulk_2  <> '' and l.amkopiskkoulk_2 = '' and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' then '1' 
	    else '0'
	    end) as yliopistokoulutuksessa,
-- Lukiokoulutuksessa ja ammatillisessa koulutuksessa
(case
	    when  (l.suorlk = '2') and  l.luopiskkoulk_2  <> '' and l.ammopiskkoulk_2 <> '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2  = '' then '1'  
	    else '0'
	    end) as lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa,
-- Toisen asteen ammatillisessa koulutuksessa ja korkeakoulutuksessa
(case
	    when  (l.suorlk = '2') and  l.ammopiskkoulk_2  <> '' and l.amkopiskkoulk_2 <> '' and l.luopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' then '1' 
	    else '0'
	    end) as toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa,
-- Ammattikorkeakoulutuksessa ja yliopistokoulutuksessa
(case
	    when  (l.suorlk = '2') and  l.amkopiskkoulk_2  <> '' and l.yoopiskkoulk_2 <> '' and l.ammopiskkoulk_2  = '' and l.luopiskkoulk_2 = ''  then '1' 
	    else '0'
	    end) as ammattikorkekoulutuksessa_ja_yliopistokoulutuksessa,    
-- Koulutuksen päättäneiden toiminta
(case
	   -- Tutkintoon johtavassa koulutuksessa olevat
	   when (l.suorlk = '2') 
	   and (l.ptoim1r4_2 = '22' or l.ptoim1r4_2 = '13')
	   and (l.luopiskkoulk_2 <>'' or l.ammopiskkoulk_2 <>'' or l.amkopiskkoulk_2 <>'' or l.yoopiskkoulk_2 <>'') then '1' 

	  -- Ei tutkintoon johtavassa koulutuksessa olevat
	   when  (l.suorlk = '2') 
	   and (l.ptoim1r4_2 = '22' or l.ptoim1r4_2 = '13')
	   and (l.luopiskkoulk_2 ='' and l.ammopiskkoulk_2 ='' and l.amkopiskkoulk_2 ='' and l.yoopiskkoulk_2 ='') then '2' 
	 
	   -- Ei opiskelevat työlliset
	   when (l.suorlk = '2')and  l.ptoim1r4_2  = '10'  then '3' 
	   -- Ei opiskelevat työttömät
	   when  (l.suorlk = '2') and  l.ptoim1r4_2  = '12'  then '4' 
	   --  
	   -- Ei opiskelevat muut
		else '5' 
	   end ) as koulutuksen_paattaneiden_toiminta
 ,ika_1v = cast((case 
            when syntv = '' then '-1' else  ((cast(tilv as int) - cast(syntv as int))) end)  as nvarchar(10))
 ,ika_5v =cast(
       (
		case
		when (cast(tilv as int) - cast(syntv as int)) < 15 then '5v10'
		when ((cast(tilv as int) - cast(syntv as int)) >= 15 and (cast(tilv as int) - cast(syntv as int)) <= 19) then '5v15'
		when ((cast(tilv as int) - cast(syntv as int)) >= 20 and (cast(tilv as int) - cast(syntv as int)) <= 24) then '5v20'
		when ((cast(tilv as int) - cast(syntv as int)) >= 25 and (cast(tilv as int) - cast(syntv as int)) <= 29) then '5v25'
		when ((cast(tilv as int) - cast(syntv as int)) >= 30 and (cast(tilv as int) - cast(syntv as int)) <= 34) then '5v30'
		when ((cast(tilv as int) - cast(syntv as int)) >= 35 and (cast(tilv as int) - cast(syntv as int)) <= 39) then '5v35'
		when ((cast(tilv as int) - cast(syntv as int)) >= 40 and (cast(tilv as int) - cast(syntv as int)) <= 44) then '5v40'
		when ((cast(tilv as int) - cast(syntv as int)) >= 45 and (cast(tilv as int) - cast(syntv as int)) <= 49) then '5v45'
		when ((cast(tilv as int) - cast(syntv as int)) >= 50 and (cast(tilv as int) - cast(syntv as int)) <= 54) then '5v50'
		when ((cast(tilv as int) - cast(syntv as int)) >= 55 and (cast(tilv as int) - cast(syntv as int)) <= 59) then '5v55'
		when ((cast(tilv as int) - cast(syntv as int)) >= 60 and (cast(tilv as int) - cast(syntv as int)) <= 64) then '5v60'
		when ((cast(tilv as int) - cast(syntv as int)) >= 65 and (cast(tilv as int) - cast(syntv as int)) <= 69) then '5v65'
		when ((cast(tilv as int) - cast(syntv as int)) >= 70 and (cast(tilv as int) - cast(syntv as int)) <= 74) then '5v70'
		when ((cast(tilv as int) - cast(syntv as int)) >= 75 and (cast(tilv as int) - cast(syntv as int)) <= 79) then '5v75'
		when ((cast(tilv as int) - cast(syntv as int)) >= 80 and (cast(tilv as int) - cast(syntv as int)) <= 84) then '5v80'
		when ((cast(tilv as int) - cast(syntv as int)) >= 85 and (cast(tilv as int) - cast(syntv as int)) <= 89) then '5v85'
		when ((cast(tilv as int) - cast(syntv as int)) >= 90 and (cast(tilv as int) - cast(syntv as int)) <= 94) then '5v90'
		when ((cast(tilv as int) - cast(syntv as int)) >= 95) then '5v95'
		
		end
	   ) as nvarchar (10))

  ,ika_1v_suorv = cast(
					(case 
						when syntv = '' then '-1' 
						else ((cast(suorv as int) - cast(syntv as int))) 
					end)  
	as nvarchar(10))



--uudet muuttujat 03/2018

,case
	when  l.suorlk = '2' and (l.luopiskkoulk_1 <> '' or l.luopiskkoulk_2 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk_2 <> '' or l.luopiskkoulk2010 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk2013 <> '' or l.luopiskkoulk2014 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk2014 <> '' or l.luopiskkoulk2015 <> '') then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk2015 <> '' or l.luopiskkoulk2016 <> '') then 1*/
	else 0
end as opisk_lu
--Opiskellut ammatillisessa peruskoulutuksessa
,case
	when  l.suorlk = '2' and (l.ammopiskkoulk_1 <> '' or l.ammopiskkoulk_2 <> '') and (d1c.Koulutusaste_taso2_koodi = '32' or d2c.Koulutusaste_taso2_koodi = '32') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk2010 <> '') and (d2c.Koulutusaste_taso2_koodi = '32' or d3c.Koulutusaste_taso2_koodi = '32') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '') and (d3c.Koulutusaste_taso2_koodi = '32' or d4c.Koulutusaste_taso2_koodi = '32') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '') and (d4c.Koulutusaste_taso2_koodi = '32' or d5c.Koulutusaste_taso2_koodi = '32') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2012 <> '' or l.ammopiskkoulk2013 <> '') and (d5c.Koulutusaste_taso2_koodi = '32' or d6c.Koulutusaste_taso2_koodi = '32') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2013 <> '' or l.ammopiskkoulk2014 <> '') and (d6c.Koulutusaste_taso2_koodi = '32' or d7c.Koulutusaste_taso2_koodi = '32') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2014 <> '' or l.ammopiskkoulk2015 <> '') and (d7c.Koulutusaste_taso2_koodi = '32' or d8c.Koulutusaste_taso2_koodi = '32') then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2015 <> '' or l.ammopiskkoulk2016 <> '') and (d8c.Koulutusaste_taso2_koodi = '32' or d9c.Koulutusaste_taso2_koodi = '32') then 1*/
	else 0
end as opisk_amm_pk
--Opiskellut ammattitutkintokoulutuksessa
,case
	when  l.suorlk = '2' and (l.ammopiskkoulk_1 <> '' or l.ammopiskkoulk_2 <> '') and (d1c.Koulutusaste_taso2_koodi = '33' or d2c.Koulutusaste_taso2_koodi = '33') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk2010 <> '') and (d2c.Koulutusaste_taso2_koodi = '33' or d3c.Koulutusaste_taso2_koodi = '33') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '') and (d3c.Koulutusaste_taso2_koodi = '33' or d4c.Koulutusaste_taso2_koodi = '33') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '') and (d4c.Koulutusaste_taso2_koodi = '33' or d5c.Koulutusaste_taso2_koodi = '33') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2012 <> '' or l.ammopiskkoulk2013 <> '') and (d5c.Koulutusaste_taso2_koodi = '33' or d6c.Koulutusaste_taso2_koodi = '33') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2013 <> '' or l.ammopiskkoulk2014 <> '') and (d6c.Koulutusaste_taso2_koodi = '33' or d7c.Koulutusaste_taso2_koodi = '33') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2014 <> '' or l.ammopiskkoulk2015 <> '') and (d7c.Koulutusaste_taso2_koodi = '33' or d8c.Koulutusaste_taso2_koodi = '33') then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2015 <> '' or l.ammopiskkoulk2016 <> '') and (d8c.Koulutusaste_taso2_koodi = '33' or d9c.Koulutusaste_taso2_koodi = '33') then 1*/
	else 0
end as opisk_amm_at
--Opiskellut erikoisammattitutkintokoulutuksessa
,case
	when  l.suorlk = '2' and (l.ammopiskkoulk_1 <> '' or l.ammopiskkoulk_2 <> '') and (d1c.Koulutusaste_taso2_koodi = '41' or d2c.Koulutusaste_taso2_koodi = '41') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk2010 <> '') and (d2c.Koulutusaste_taso2_koodi = '41' or d3c.Koulutusaste_taso2_koodi = '41') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '') and (d3c.Koulutusaste_taso2_koodi = '41' or d4c.Koulutusaste_taso2_koodi = '41') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '') and (d4c.Koulutusaste_taso2_koodi = '41' or d5c.Koulutusaste_taso2_koodi = '41') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2012 <> '' or l.ammopiskkoulk2013 <> '') and (d5c.Koulutusaste_taso2_koodi = '41' or d6c.Koulutusaste_taso2_koodi = '41') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2013 <> '' or l.ammopiskkoulk2014 <> '') and (d6c.Koulutusaste_taso2_koodi = '41' or d7c.Koulutusaste_taso2_koodi = '41') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2014 <> '' or l.ammopiskkoulk2015 <> '') and (d7c.Koulutusaste_taso2_koodi = '41' or d8c.Koulutusaste_taso2_koodi = '41') then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2015 <> '' or l.ammopiskkoulk2016 <> '') and (d8c.Koulutusaste_taso2_koodi = '41' or d9c.Koulutusaste_taso2_koodi = '41') then 1*/
	else 0
end as opisk_amm_eat
--Opiskellut ammatillisessa koulutuksessa
,case
	when  l.suorlk = '2' and (l.ammopiskkoulk_1 <> '' or l.ammopiskkoulk_2 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk2010 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2012 <> '' or l.ammopiskkoulk2013 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2013 <> '' or l.ammopiskkoulk2014 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2014 <> '' or l.ammopiskkoulk2015 <> '') then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2015 <> '' or l.ammopiskkoulk2016 <> '') then 1*/
	else 0
end as opisk_amm
--Opiskellut ammattikorkeakoulutuksessa
,case
	when  l.suorlk = '2' and (l.amkopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk_2 <> '' or l.amkopiskkoulk2010 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2013 <> '' or l.amkopiskkoulk2014 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2014 <> '' or l.amkopiskkoulk2015 <> '') then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2015 <> '' or l.amkopiskkoulk2016 <> '') then 1*/
	else 0
end as opisk_amk
--Opiskellut yliopistokoulutuksessa
,case
	when  l.suorlk = '2' and (l.yoopiskkoulk_1 <> '' or l.yoopiskkoulk_2 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.yoopiskkoulk_2 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.yoopiskkoulk2011 <> '' or l.yoopiskkoulk2012 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.yoopiskkoulk2012 <> '' or l.yoopiskkoulk2013 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.yoopiskkoulk2013 <> '' or l.yoopiskkoulk2014 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.yoopiskkoulk2014 <> '' or l.yoopiskkoulk2015 <> '') then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '2' and (l.yoopiskkoulk2015 <> '' or l.yoopiskkoulk2016 <> '') then 1*/
	else 0
end as opisk_yo



----KOULUTUSALA, TASO 1 KYLLÄ/EI
--Opiskellut koulutusala1 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1a.iscfibroad2013_koodi = '01' or d2a.iscfibroad2013_koodi = '01') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2a.iscfibroad2013_koodi = '01' or d3a.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3a.iscfibroad2013_koodi = '01' or d4a.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4a.iscfibroad2013_koodi = '01' or d5a.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5a.iscfibroad2013_koodi = '01' or d6a.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6a.iscfibroad2013_koodi = '01' or d7a.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7a.iscfibroad2013_koodi = '01' or d8a.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '2' and (d8a.iscfibroad2013_koodi = '01' or d9a.iscfibroad2013_koodi = '01') then 1*/
	else 0
end as opisk_amk_koulala1
--Opiskellut koulutusala2 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1a.iscfibroad2013_koodi = '02' or d2a.iscfibroad2013_koodi = '02') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2a.iscfibroad2013_koodi = '02' or d3a.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3a.iscfibroad2013_koodi = '02' or d4a.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4a.iscfibroad2013_koodi = '02' or d5a.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5a.iscfibroad2013_koodi = '02' or d6a.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6a.iscfibroad2013_koodi = '02' or d7a.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7a.iscfibroad2013_koodi = '02' or d8a.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '2' and (d8a.iscfibroad2013_koodi = '02' or d9a.iscfibroad2013_koodi = '02') then 1*/
	else 0
end as opisk_amk_koulala2
--Opiskellut koulutusala3 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1a.iscfibroad2013_koodi = '03' or d2a.iscfibroad2013_koodi = '03') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2a.iscfibroad2013_koodi = '03' or d3a.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3a.iscfibroad2013_koodi = '03' or d4a.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4a.iscfibroad2013_koodi = '03' or d5a.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5a.iscfibroad2013_koodi = '03' or d6a.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6a.iscfibroad2013_koodi = '03' or d7a.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7a.iscfibroad2013_koodi = '03' or d8a.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '2' and (d8a.iscfibroad2013_koodi = '03' or d9a.iscfibroad2013_koodi = '03') then 1*/
	else 0
end as opisk_amk_koulala3
--Opiskellut koulutusala4 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1a.iscfibroad2013_koodi = '04' or d2a.iscfibroad2013_koodi = '04') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2a.iscfibroad2013_koodi = '04' or d3a.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3a.iscfibroad2013_koodi = '04' or d4a.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4a.iscfibroad2013_koodi = '04' or d5a.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5a.iscfibroad2013_koodi = '04' or d6a.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6a.iscfibroad2013_koodi = '04' or d7a.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7a.iscfibroad2013_koodi = '04' or d8a.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '2' and (d8a.iscfibroad2013_koodi = '04' or d9a.iscfibroad2013_koodi = '04') then 1*/
	else 0
end as opisk_amk_koulala4
--Opiskellut koulutusala5 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1a.iscfibroad2013_koodi = '05' or d2a.iscfibroad2013_koodi = '05') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2a.iscfibroad2013_koodi = '05' or d3a.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3a.iscfibroad2013_koodi = '05' or d4a.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4a.iscfibroad2013_koodi = '05' or d5a.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5a.iscfibroad2013_koodi = '05' or d6a.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6a.iscfibroad2013_koodi = '05' or d7a.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7a.iscfibroad2013_koodi = '05' or d8a.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '2' and (d8a.iscfibroad2013_koodi = '05' or d9a.iscfibroad2013_koodi = '05') then 1*/
	else 0
end as opisk_amk_koulala5
--Opiskellut koulutusala6 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1a.iscfibroad2013_koodi = '06' or d2a.iscfibroad2013_koodi = '06') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2a.iscfibroad2013_koodi = '06' or d3a.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3a.iscfibroad2013_koodi = '06' or d4a.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4a.iscfibroad2013_koodi = '06' or d5a.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5a.iscfibroad2013_koodi = '06' or d6a.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6a.iscfibroad2013_koodi = '06' or d7a.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7a.iscfibroad2013_koodi = '06' or d8a.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '2' and (d8a.iscfibroad2013_koodi = '06' or d9a.iscfibroad2013_koodi = '06') then 1*/
	else 0
end as opisk_amk_koulala6
--Opiskellut koulutusala7 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1a.iscfibroad2013_koodi = '07' or d2a.iscfibroad2013_koodi = '07') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2a.iscfibroad2013_koodi = '07' or d3a.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3a.iscfibroad2013_koodi = '07' or d4a.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4a.iscfibroad2013_koodi = '07' or d5a.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5a.iscfibroad2013_koodi = '07' or d6a.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6a.iscfibroad2013_koodi = '07' or d7a.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7a.iscfibroad2013_koodi = '07' or d8a.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '2' and (d8a.iscfibroad2013_koodi = '07' or d9a.iscfibroad2013_koodi = '07') then 1*/
	else 0
end as opisk_amk_koulala7
--Opiskellut koulutusala8 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1a.iscfibroad2013_koodi = '08' or d2a.iscfibroad2013_koodi = '08') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2a.iscfibroad2013_koodi = '08' or d3a.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3a.iscfibroad2013_koodi = '08' or d4a.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4a.iscfibroad2013_koodi = '08' or d5a.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5a.iscfibroad2013_koodi = '08' or d6a.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6a.iscfibroad2013_koodi = '08' or d7a.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7a.iscfibroad2013_koodi = '08' or d8a.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '2' and (d8a.iscfibroad2013_koodi = '08' or d9a.iscfibroad2013_koodi = '08') then 1*/
	else 0
end as opisk_amk_koulala8
--Opiskellut koulutusala9 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1a.iscfibroad2013_koodi = '09' or d2a.iscfibroad2013_koodi = '09') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2a.iscfibroad2013_koodi = '09' or d3a.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3a.iscfibroad2013_koodi = '09' or d4a.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4a.iscfibroad2013_koodi = '09' or d5a.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5a.iscfibroad2013_koodi = '09' or d6a.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6a.iscfibroad2013_koodi = '09' or d7a.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7a.iscfibroad2013_koodi = '09' or d8a.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '2' and (d8a.iscfibroad2013_koodi = '09' or d9a.iscfibroad2013_koodi = '09') then 1*/
	else 0
end as opisk_amk_koulala9
--Opiskellut koulutusala10 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1a.iscfibroad2013_koodi = '10' or d2a.iscfibroad2013_koodi = '10') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2a.iscfibroad2013_koodi = '10' or d3a.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3a.iscfibroad2013_koodi = '10' or d4a.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4a.iscfibroad2013_koodi = '10' or d5a.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5a.iscfibroad2013_koodi = '10' or d6a.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6a.iscfibroad2013_koodi = '10' or d7a.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7a.iscfibroad2013_koodi = '10' or d8a.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '2' and (d8a.iscfibroad2013_koodi = '10' or d9a.iscfibroad2013_koodi = '10') then 1*/
	else 0
end as opisk_amk_koulala10




--Opiskellut koulutusala1 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1b.iscfibroad2013_koodi = '01' or d2b.iscfibroad2013_koodi = '01') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2b.iscfibroad2013_koodi = '01' or d3b.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3b.iscfibroad2013_koodi = '01' or d4b.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4b.iscfibroad2013_koodi = '01' or d5b.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5b.iscfibroad2013_koodi = '01' or d6b.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6b.iscfibroad2013_koodi = '01' or d7b.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7b.iscfibroad2013_koodi = '01' or d8b.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '2' and (d8b.iscfibroad2013_koodi = '01' or d9b.iscfibroad2013_koodi = '01') then 1*/
	else 0
end as opisk_yo_koulala1
--Opiskellut koulutusala2 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1b.iscfibroad2013_koodi = '02' or d2b.iscfibroad2013_koodi = '02') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2b.iscfibroad2013_koodi = '02' or d3b.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3b.iscfibroad2013_koodi = '02' or d4b.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4b.iscfibroad2013_koodi = '02' or d5b.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5b.iscfibroad2013_koodi = '02' or d6b.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6b.iscfibroad2013_koodi = '02' or d7b.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7b.iscfibroad2013_koodi = '02' or d8b.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '2' and (d8b.iscfibroad2013_koodi = '02' or d9b.iscfibroad2013_koodi = '02') then 1*/
	else 0
end as opisk_yo_koulala2
--Opiskellut koulutusala3 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1b.iscfibroad2013_koodi = '03' or d2b.iscfibroad2013_koodi = '03') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2b.iscfibroad2013_koodi = '03' or d3b.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3b.iscfibroad2013_koodi = '03' or d4b.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4b.iscfibroad2013_koodi = '03' or d5b.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5b.iscfibroad2013_koodi = '03' or d6b.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6b.iscfibroad2013_koodi = '03' or d7b.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7b.iscfibroad2013_koodi = '03' or d8b.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '2' and (d8b.iscfibroad2013_koodi = '03' or d9b.iscfibroad2013_koodi = '03') then 1*/
	else 0
end as opisk_yo_koulala3
--Opiskellut koulutusala4 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1b.iscfibroad2013_koodi = '04' or d2b.iscfibroad2013_koodi = '04') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2b.iscfibroad2013_koodi = '04' or d3b.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3b.iscfibroad2013_koodi = '04' or d4b.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4b.iscfibroad2013_koodi = '04' or d5b.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5b.iscfibroad2013_koodi = '04' or d6b.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6b.iscfibroad2013_koodi = '04' or d7b.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7b.iscfibroad2013_koodi = '04' or d8b.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '2' and (d8b.iscfibroad2013_koodi = '04' or d9b.iscfibroad2013_koodi = '04') then 1*/
	else 0
end as opisk_yo_koulala4
--Opiskellut koulutusala5 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1b.iscfibroad2013_koodi = '05' or d2b.iscfibroad2013_koodi = '05') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2b.iscfibroad2013_koodi = '05' or d3b.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3b.iscfibroad2013_koodi = '05' or d4b.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4b.iscfibroad2013_koodi = '05' or d5b.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5b.iscfibroad2013_koodi = '05' or d6b.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6b.iscfibroad2013_koodi = '05' or d7b.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7b.iscfibroad2013_koodi = '05' or d8b.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '2' and (d8b.iscfibroad2013_koodi = '05' or d9b.iscfibroad2013_koodi = '05') then 1*/
	else 0
end as opisk_yo_koulala5
--Opiskellut koulutusala6 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1b.iscfibroad2013_koodi = '06' or d2b.iscfibroad2013_koodi = '06') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2b.iscfibroad2013_koodi = '06' or d3b.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3b.iscfibroad2013_koodi = '06' or d4b.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4b.iscfibroad2013_koodi = '06' or d5b.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5b.iscfibroad2013_koodi = '06' or d6b.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6b.iscfibroad2013_koodi = '06' or d7b.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7b.iscfibroad2013_koodi = '06' or d8b.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '2' and (d8b.iscfibroad2013_koodi = '06' or d9b.iscfibroad2013_koodi = '06') then 1*/
	else 0
end as opisk_yo_koulala6
--Opiskellut koulutusala7 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1b.iscfibroad2013_koodi = '07' or d2b.iscfibroad2013_koodi = '07') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2b.iscfibroad2013_koodi = '07' or d3b.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3b.iscfibroad2013_koodi = '07' or d4b.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4b.iscfibroad2013_koodi = '07' or d5b.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5b.iscfibroad2013_koodi = '07' or d6b.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6b.iscfibroad2013_koodi = '07' or d7b.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7b.iscfibroad2013_koodi = '07' or d8b.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '2' and (d8b.iscfibroad2013_koodi = '07' or d9b.iscfibroad2013_koodi = '07') then 1*/
	else 0
end as opisk_yo_koulala7
--Opiskellut koulutusala8 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1b.iscfibroad2013_koodi = '08' or d2b.iscfibroad2013_koodi = '08') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2b.iscfibroad2013_koodi = '08' or d3b.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3b.iscfibroad2013_koodi = '08' or d4b.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4b.iscfibroad2013_koodi = '08' or d5b.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5b.iscfibroad2013_koodi = '08' or d6b.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6b.iscfibroad2013_koodi = '08' or d7b.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7b.iscfibroad2013_koodi = '08' or d8b.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '2' and (d8b.iscfibroad2013_koodi = '08' or d9b.iscfibroad2013_koodi = '08') then 1*/
	else 0
end as opisk_yo_koulala8
--Opiskellut koulutusala9 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1b.iscfibroad2013_koodi = '09' or d2b.iscfibroad2013_koodi = '09') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2b.iscfibroad2013_koodi = '09' or d3b.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3b.iscfibroad2013_koodi = '09' or d4b.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4b.iscfibroad2013_koodi = '09' or d5b.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5b.iscfibroad2013_koodi = '09' or d6b.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6b.iscfibroad2013_koodi = '09' or d7b.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7b.iscfibroad2013_koodi = '09' or d8b.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '2' and (d8b.iscfibroad2013_koodi = '09' or d9b.iscfibroad2013_koodi = '09') then 1*/
	else 0
end as opisk_yo_koulala9
--Opiskellut koulutusala10 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1b.iscfibroad2013_koodi = '10' or d2b.iscfibroad2013_koodi = '10') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2b.iscfibroad2013_koodi = '10' or d3b.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3b.iscfibroad2013_koodi = '10' or d4b.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4b.iscfibroad2013_koodi = '10' or d5b.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5b.iscfibroad2013_koodi = '10' or d6b.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6b.iscfibroad2013_koodi = '10' or d7b.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7b.iscfibroad2013_koodi = '10' or d8b.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '2' and (d8b.iscfibroad2013_koodi = '10' or d9b.iscfibroad2013_koodi = '10') then 1*/
	else 0
end as opisk_yo_koulala10


--Opiskellut useampaa kuin yhtä alaa (taso 1) (kyllä/ei)
,case --ensimmäisenä vuotena on mahdollista olla vain yksi ala
	when  l.suorlk = '2' and m1.MinValue <> m1.MaxValue then 1 
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and m2.MinValue <> m2.MaxValue then 1 
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and m3.MinValue <> m3.MaxValue then 1 
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and m4.MinValue <> m4.MaxValue then 1 
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and m5.MinValue <> m5.MaxValue then 1 
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and m6.MinValue <> m6.MaxValue then 1 
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and m7.MinValue <> m7.MaxValue then 1 
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '2' and m8.MinValue <> m8.MaxValue then 1 */
	else 0
end as opisk_vah2_koulala


----HAUT KYLLÄ/EI
--Hakenut ammatilliseen koulutukseen
,case
	when  l.suorlk = '2' and (l.monihaku_1 in (2,3,5) or l.monihaku_2 in (2,3,5)) then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.monihaku_2 in (2,3,5) or l.monihaku2010 in (2,3,5)) then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.monihaku2010 in (2,3,5) or l.monihaku2011 in (2,3,5)) then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.monihaku2011 in (2,3,5) or l.monihaku2012 in (2,3,5)) then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.monihaku2012 in (2,3,5) or l.monihaku2013 in (2,3,5)) then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.monihaku2013 in (2,3,5) or l.monihaku2014 in (2,3,5)) then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.monihaku2014 in (2,3,5) or l.monihaku2015 in (2,3,5)) then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '2' and (l.monihaku2015 in (2,3,5) or l.monihaku2016 in (2,3,5)) then 1*/
	else 0
end as haku_amm
--Hakenut ammattikorkeakoulutukseen
,case
	when  l.suorlk = '2' and (l.monihaku_1 in (4,6) or l.monihaku_2 in (4,6)) then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.monihaku_2 in (4,6) or l.monihaku2010 in (4,6)) then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.monihaku2010 in (4,6) or l.monihaku2011 in (4,6)) then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.monihaku2011 in (4,6) or l.monihaku2012 in (4,6)) then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.monihaku2012 in (4,6) or l.monihaku2013 in (4,6)) then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.monihaku2013 in (4,6) or l.monihaku2014 in (4,6)) then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.monihaku2014 in (4,6) or l.monihaku2015 in (4,6)) then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '2' and (l.monihaku2015 in (4,6) or l.monihaku2016 in (4,6)) then 1*/
	else 0
end as haku_amk
--Hakenut yliopistokoulutukseen
,case
	when  l.suorlk = '2' and (l.monihaku_1 in (6,7) or l.monihaku_2 in (6,7)) then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.monihaku_2 in (6,7) or l.monihaku2010 in (6,7)) then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.monihaku2010 in (6,7) or l.monihaku2011 in (6,7)) then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.monihaku2011 in (6,7) or l.monihaku2012 in (6,7)) then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.monihaku2012 in (6,7) or l.monihaku2013 in (6,7)) then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.monihaku2013 in (6,7) or l.monihaku2014 in (6,7)) then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.monihaku2014 in (6,7) or l.monihaku2015 in (6,7)) then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '2' and (l.monihaku2015 in (6,7) or l.monihaku2016 in (6,7)) then 1*/
	else 0
end as haku_yo




----MITTARIT
--Ei hakenut eikä opiskellut mitään
,case
	when  l.suorlk = '2' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and l.luopiskkoulk_1 = '' and l.ammopiskkoulk_1 = '' and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and monihaku_2 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and monihaku2013 not in (4,5,6,7) and monihaku2014 not in (4,5,6,7) and l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and monihaku2014 not in (4,5,6,7) and monihaku2015 not in (4,5,6,7) and l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' and l.luopiskkoulk2015 = '' and l.ammopiskkoulk2015 = '' and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '2' and monihaku2015 not in (4,5,6,7) and monihaku2016 not in (4,5,6,7) and l.luopiskkoulk2015 = '' and l.ammopiskkoulk2015 = '' and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' and l.luopiskkoulk2016 = '' and l.ammopiskkoulk2016 = '' and l.amkopiskkoulk2016 = '' and l.yoopiskkoulk2016 = '' then 1*/
	else 0
end eihaku_kk_eiopisk

--Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa
,case 
	when  l.suorlk = '2' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and (l.luopiskkoulk_1 <> '' or l.ammopiskkoulk_1 <> '' or l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and monihaku_2 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and (l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and (l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and (l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '') and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and (l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '' or l.ammopiskkoulk2013 <> '') and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and monihaku2013 not in (4,5,6,7) and monihaku2014 not in (4,5,6,7) and (l.luopiskkoulk2013 <> '' or l.ammopiskkoulk2013 <> '' or l.luopiskkoulk2014 <> '' or l.ammopiskkoulk2014 <> '') and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and monihaku2014 not in (4,5,6,7) and monihaku2015 not in (4,5,6,7) and (l.luopiskkoulk2014 <> '' or l.ammopiskkoulk2014 <> '' or l.luopiskkoulk2015 <> '' or l.ammopiskkoulk2015 <> '') and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '2' and monihaku2015 not in (4,5,6,7) and monihaku2016 not in (4,5,6,7) and (l.luopiskkoulk2015 <> '' or l.ammopiskkoulk2015 <> '' or l.luopiskkoulk2016 <> '' or l.ammopiskkoulk2016 <> '') and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' and l.amkopiskkoulk2016 = '' and l.yoopiskkoulk2016 = '' then 1*/
	else 0
end eihaku_kk_eiopisk_kk_opisk_ta

----Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa, opiskellut lukiokoulutuksessa
,case 
	when  l.suorlk = '2' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and (l.luopiskkoulk_1 <> '' or l.luopiskkoulk_2 <> '') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = ''  then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and monihaku_2 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and (l.luopiskkoulk_2 <> '' or l.luopiskkoulk2010 <> '') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and (l.luopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and (l.luopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '') and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and (l.luopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '') and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and monihaku2013 not in (4,5,6,7) and monihaku2014 not in (4,5,6,7) and (l.luopiskkoulk2013 <> '' or l.luopiskkoulk2014 <> '') and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and monihaku2014 not in (4,5,6,7) and monihaku2015 not in (4,5,6,7) and (l.luopiskkoulk2014 <> '' or l.luopiskkoulk2015 <> '') and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '2' and monihaku2015 not in (4,5,6,7) and monihaku2016 not in (4,5,6,7) and (l.luopiskkoulk2015 <> '' or l.luopiskkoulk2016 <> '') and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' and l.amkopiskkoulk2016 = '' and l.yoopiskkoulk2016 = '' then 1*/
	else 0
end eihaku_kk_eiopisk_kk_opisk_lu

----Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa, opiskellut ammatillisessa peruskoulutuksessa
,case 
	when  l.suorlk = '2' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and (l.ammopiskkoulk_1 <> '' or l.ammopiskkoulk_2 <> '') and (d1c.Koulutusaste_taso2_koodi = '32' or d2c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and monihaku_2 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and (l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk2010 <> '') and (d2c.Koulutusaste_taso2_koodi = '32' or d3c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and (l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '') and (d3c.Koulutusaste_taso2_koodi = '32' or d4c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and (l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '') and (d4c.Koulutusaste_taso2_koodi = '32' or d5c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and (l.ammopiskkoulk2012 <> '' or l.ammopiskkoulk2013 <> '') and (d5c.Koulutusaste_taso2_koodi = '32' or d6c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and monihaku2013 not in (4,5,6,7) and monihaku2014 not in (4,5,6,7) and (l.ammopiskkoulk2013 <> '' or l.ammopiskkoulk2014 <> '') and (d6c.Koulutusaste_taso2_koodi = '32' or d7c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and monihaku2014 not in (4,5,6,7) and monihaku2015 not in (4,5,6,7) and (l.ammopiskkoulk2014 <> '' or l.ammopiskkoulk2015 <> '') and (d7c.Koulutusaste_taso2_koodi = '32' or d8c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '2' and monihaku2015 not in (4,5,6,7) and monihaku2016 not in (4,5,6,7) and (l.ammopiskkoulk2015 <> '' or l.ammopiskkoulk2016 <> '') and (d7c.Koulutusaste_taso2_koodi = '32' or d8c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' and l.amkopiskkoulk2016 = '' and l.yoopiskkoulk2016 = '' then 1*/
	else 0
end eihaku_kk_eiopisk_kk_opisk_pk

------Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa, opiskellut ammattitutkintokoulutuksessa
,case 
	when  l.suorlk = '2' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and (l.ammopiskkoulk_1 <> '' or l.ammopiskkoulk_2 <> '') and (d1c.Koulutusaste_taso2_koodi = '33' or d2c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and monihaku_2 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and (l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk2010 <> '') and (d2c.Koulutusaste_taso2_koodi = '33' or d3c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and (l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '') and (d3c.Koulutusaste_taso2_koodi = '33' or d4c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and (l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '') and (d4c.Koulutusaste_taso2_koodi = '33' or d5c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and (l.ammopiskkoulk2012 <> '' or l.ammopiskkoulk2013 <> '') and (d5c.Koulutusaste_taso2_koodi = '33' or d6c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and monihaku2013 not in (4,5,6,7) and monihaku2014 not in (4,5,6,7) and (l.ammopiskkoulk2013 <> '' or l.ammopiskkoulk2014 <> '') and (d6c.Koulutusaste_taso2_koodi = '33' or d7c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and monihaku2014 not in (4,5,6,7) and monihaku2015 not in (4,5,6,7) and (l.ammopiskkoulk2014 <> '' or l.ammopiskkoulk2015 <> '') and (d7c.Koulutusaste_taso2_koodi = '33' or d8c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '2' and monihaku2015 not in (4,5,6,7) and monihaku2016 not in (4,5,6,7) and (l.ammopiskkoulk2015 <> '' or l.ammopiskkoulk2016 <> '') and (d7c.Koulutusaste_taso2_koodi = '33' or d8c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' and l.amkopiskkoulk2016 = '' and l.yoopiskkoulk2016 = '' then 1*/
	else 0
end eihaku_kk_eiopisk_kk_opisk_at

------Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa, opiskellut erikoisammattitutkintokoulutuksessa
,case 
	when  l.suorlk = '2' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and (l.ammopiskkoulk_1 <> '' or l.ammopiskkoulk_2 <> '') and (d1c.Koulutusaste_taso2_koodi = '41' or d2c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and monihaku_2 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and (l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk2010 <> '') and (d2c.Koulutusaste_taso2_koodi = '41' or d3c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and (l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '') and (d3c.Koulutusaste_taso2_koodi = '41' or d4c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and (l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '') and (d4c.Koulutusaste_taso2_koodi = '41' or d5c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and (l.ammopiskkoulk2012 <> '' or l.ammopiskkoulk2013 <> '') and (d5c.Koulutusaste_taso2_koodi = '41' or d6c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and monihaku2013 not in (4,5,6,7) and monihaku2014 not in (4,5,6,7) and (l.ammopiskkoulk2013 <> '' or l.ammopiskkoulk2014 <> '') and (d6c.Koulutusaste_taso2_koodi = '41' or d7c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and monihaku2014 not in (4,5,6,7) and monihaku2015 not in (4,5,6,7) and (l.ammopiskkoulk2014 <> '' or l.ammopiskkoulk2015 <> '') and (d7c.Koulutusaste_taso2_koodi = '41' or d8c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '2' and monihaku2015 not in (4,5,6,7) and monihaku2016 not in (4,5,6,7) and (l.ammopiskkoulk2015 <> '' or l.ammopiskkoulk2016 <> '') and (d7c.Koulutusaste_taso2_koodi = '41' or d8c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' and l.amkopiskkoulk2016 = '' and l.yoopiskkoulk2016 = '' then 1*/
	else 0
end eihaku_kk_eiopisk_kk_opisk_eat

--Hakenut korkea-asteelle, ei opiskellut korkea-asteella
,case 
	when  l.suorlk = '2' and (monihaku_1 in (4,5,6,7) or monihaku_2 in (4,5,6,7)) and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (monihaku_2 in (4,5,6,7) or monihaku2010 in (4,5,6,7)) and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7)) and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (monihaku2011 in (4,5,6,7) or monihaku2012 in (4,5,6,7)) and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (monihaku2012 in (4,5,6,7) or monihaku2013 in (4,5,6,7)) and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (monihaku2013 in (4,5,6,7) or monihaku2014 in (4,5,6,7)) and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (monihaku2014 in (4,5,6,7) or monihaku2015 in (4,5,6,7)) and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '2' and (monihaku2015 in (4,5,6,7) or monihaku2016 in (4,5,6,7)) and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' and l.amkopiskkoulk2016 = '' and l.yoopiskkoulk2016 = '' then 1*/
	else 0
end haku_kk_eiopisk_kk
----Hakenut korkea-asteelle, ei opiskellut korkea-asteella, ei-opiskellut toisen asteen koulutuksessa
,case
	when  l.suorlk = '2' and (monihaku_1 in (4,5,6,7) or monihaku_2 in (4,5,6,7)) and l.luopiskkoulk_1 = '' and l.ammopiskkoulk_1 = '' and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (monihaku_2 in (4,5,6,7) or monihaku2010 in (4,5,6,7)) and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7)) and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (monihaku2011 in (4,5,6,7) or monihaku2012 in (4,5,6,7)) and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (monihaku2012 in (4,5,6,7) or monihaku2013 in (4,5,6,7)) and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (monihaku2013 in (4,5,6,7) or monihaku2014 in (4,5,6,7)) and l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (monihaku2014 in (4,5,6,7) or monihaku2015 in (4,5,6,7)) and l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' and l.luopiskkoulk2015 = '' and l.ammopiskkoulk2015 = '' and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '2' and (monihaku2015 in (4,5,6,7) or monihaku2016 in (4,5,6,7)) and l.luopiskkoulk2015 = '' and l.ammopiskkoulk2015 = '' and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' and l.luopiskkoulk2016 = '' and l.ammopiskkoulk2016 = '' and l.amkopiskkoulk2016 = '' and l.yoopiskkoulk2016 = '' then 1*/
	else 0
end haku_kk_eiopisk_kk_eiopisk_ta
----Hakenut korkea-asteelle, ei opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa
,case
	when  l.suorlk = '2' and (monihaku_1 in (4,5,6,7) or monihaku_2 in (4,5,6,7)) and (l.luopiskkoulk_1 <> '' or l.ammopiskkoulk_1 <> '' or l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (monihaku_2 in (4,5,6,7) or monihaku2010 in (4,5,6,7)) and (l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7)) and (l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (monihaku2011 in (4,5,6,7) or monihaku2012 in (4,5,6,7)) and (l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '') and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (monihaku2012 in (4,5,6,7) or monihaku2013 in (4,5,6,7)) and (l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '' or l.ammopiskkoulk2013 <> '') and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (monihaku2013 in (4,5,6,7) or monihaku2014 in (4,5,6,7)) and (l.luopiskkoulk2013 <> '' or l.ammopiskkoulk2013 <> '' or l.luopiskkoulk2014 <> '' or l.ammopiskkoulk2014 <> '') and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (monihaku2014 in (4,5,6,7) or monihaku2015 in (4,5,6,7)) and (l.luopiskkoulk2014 <> '' or l.ammopiskkoulk2014 <> '' or l.luopiskkoulk2015 <> '' or l.ammopiskkoulk2015 <> '') and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '2' and (monihaku2015 in (4,5,6,7) or monihaku2016 in (4,5,6,7)) and (l.luopiskkoulk2015 <> '' or l.ammopiskkoulk2015 <> '' or l.luopiskkoulk2016 <> '' or l.ammopiskkoulk2016 <> '') and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' and l.amkopiskkoulk2016 = '' and l.yoopiskkoulk2016 = '' then 1*/
	else 0
end haku_kk_eiopisk_kk_opisk_ta
----Hakenut vain ammattikorkeakouluun, ei opiskellut korkea-asteella
,case
	when  l.suorlk = '2' and (monihaku_1 = 4 or monihaku_2 = 4) and (monihaku_1 not in (5,6,7) and monihaku_2 not in (5,6,7)) and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (monihaku_2 = 4 or monihaku2010 = 4) and (monihaku_2 not in (5,6,7) and monihaku2010 not in (5,6,7)) and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (monihaku2010 = 4 or monihaku2011 = 4) and (monihaku2010 not in (5,6,7) and monihaku2011 not in (5,6,7)) and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (monihaku2011 = 4 or monihaku2012 = 4) and (monihaku2011 not in (5,6,7) and monihaku2012 not in (5,6,7)) and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (monihaku2012 = 4 or monihaku2013 = 4) and (monihaku2012 not in (5,6,7) and monihaku2013 not in (5,6,7)) and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (monihaku2013 = 4 or monihaku2014 = 4) and (monihaku2013 not in (5,6,7) and monihaku2014 not in (5,6,7)) and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (monihaku2014 = 4 or monihaku2015 = 4) and (monihaku2014 not in (5,6,7) and monihaku2015 not in (5,6,7)) and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '2' and (monihaku2015 = 4 or monihaku2016 = 4) and (monihaku2015 not in (5,6,7) and monihaku2016 not in (5,6,7)) and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' and l.amkopiskkoulk2016 = '' and l.yoopiskkoulk2016 = '' then 1*/
	else 0
end haku_amk_eiopisk_kk
----Hakenut vain yliopistokoulutukseen, ei opiskellut korkea-asteella
,case
	when  l.suorlk = '2' and (monihaku_1 = 7 or monihaku_2 = 7) and (monihaku_1 not in (4,5,6) and monihaku_2 not in (4,5,6)) and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (monihaku_2 = 7 or monihaku2010 = 7) and (monihaku_2 not in (4,5,6) and monihaku2010 not in (4,5,6)) and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (monihaku2010 = 7 or monihaku2011 = 7) and (monihaku2010 not in (4,5,6) and monihaku2011 not in (4,5,6)) and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (monihaku2011 = 7 or monihaku2012 = 7) and (monihaku2011 not in (4,5,6) and monihaku2012 not in (4,5,6)) and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (monihaku2012 = 7 or monihaku2013 = 7) and (monihaku2012 not in (4,5,6) and monihaku2013 not in (4,5,6)) and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (monihaku2013 = 7 or monihaku2014 = 7) and (monihaku2013 not in (4,5,6) and monihaku2014 not in (4,5,6)) and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (monihaku2014 = 7 or monihaku2015 = 7) and (monihaku2014 not in (4,5,6) and monihaku2015 not in (4,5,6)) and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '2' and (monihaku2015 = 7 or monihaku2016 = 7) and (monihaku2015 not in (4,5,6) and monihaku2016 not in (4,5,6)) and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' and l.amkopiskkoulk2016 = '' and l.yoopiskkoulk2016 = '' then 1*/
	else 0
end haku_yo_eiopisk_kk
----Hakenut sekä amk- että yliopistokoulutukseen, ei opiskellut korkea-asteella
,case
	when  l.suorlk = '2' and (monihaku_1 = 6 or monihaku_2 = 6 or ((monihaku_1 = 4 or monihaku_2 = 4) and (monihaku_1 = 7 or monihaku_2 = 7))) and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (monihaku_2 = 6 or monihaku2010 = 6 or ((monihaku_2 = 4 or monihaku2010 = 4) and (monihaku_2 = 7 or monihaku2010 = 7))) and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (monihaku2010 = 6 or monihaku2011 = 6 or ((monihaku2010 = 4 or monihaku2011 = 4) and (monihaku2010 = 7 or monihaku2011 = 7))) and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (monihaku2011 = 6 or monihaku2012 = 6 or ((monihaku2011 = 4 or monihaku2012 = 4) and (monihaku2011 = 7 or monihaku2012 = 7))) and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (monihaku2012 = 6 or monihaku2013 = 6 or ((monihaku2012 = 4 or monihaku2013 = 4) and (monihaku2012 = 7 or monihaku2013 = 7))) and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (monihaku2013 = 6 or monihaku2014 = 6 or ((monihaku2013 = 4 or monihaku2014 = 4) and (monihaku2013 = 7 or monihaku2014 = 7))) and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (monihaku2014 = 6 or monihaku2015 = 6 or ((monihaku2014 = 4 or monihaku2015 = 4) and (monihaku2014 = 7 or monihaku2015 = 7))) and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '2' and (monihaku2015 = 6 or monihaku2016 = 6 or ((monihaku2015 = 4 or monihaku2016 = 4) and (monihaku2015 = 7 or monihaku2016 = 7))) and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' and l.amkopiskkoulk2016 = '' and l.yoopiskkoulk2016 = '' then 1*/
	else 0
end haku_amkyo_eiopisk_kk

--Opiskellut korkea-asteella
,case
	when  l.suorlk = '2' and (l.amkopiskkoulk_1 <> '' or l.yoopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '' or l.yoopiskkoulk2013 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2013 <> '' or l.yoopiskkoulk2013 <> '' or l.amkopiskkoulk2014 <> '' or l.yoopiskkoulk2014 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2014 <> '' or l.yoopiskkoulk2014 <> '' or l.amkopiskkoulk2015 <> '' or l.yoopiskkoulk2015 <> '') then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2015 <> '' or l.yoopiskkoulk2015 <> '' or l.amkopiskkoulk2016 <> '' or l.yoopiskkoulk2016 <> '') then 1*/
	else 0
end opisk_kk
----Opiskellut korkea-asteella, ei-opiskellut toisen asteen koulutuksessa
,case
	when  l.suorlk = '2' and l.luopiskkoulk_1 = '' and l.ammopiskkoulk_1 = '' and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and (l.amkopiskkoulk_1 <> '' or l.yoopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and (l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and (l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and (l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = '' and (l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '' or l.yoopiskkoulk2013 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = '' and l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 = '' and (l.amkopiskkoulk2013 <> '' or l.yoopiskkoulk2013 <> '' or l.amkopiskkoulk2014 <> '' or l.yoopiskkoulk2014 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 = '' and l.luopiskkoulk2015 = '' and l.ammopiskkoulk2015 = '' and (l.amkopiskkoulk2014 <> '' or l.yoopiskkoulk2014 <> '' or l.amkopiskkoulk2015 <> '' or l.yoopiskkoulk2015 <> '') then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '2' and l.luopiskkoulk2015 = '' and l.ammopiskkoulk2015 = '' and l.luopiskkoulk2016 = '' and l.ammopiskkoulk2016 = '' and (l.amkopiskkoulk2015 <> '' or l.yoopiskkoulk2015 <> '' or l.amkopiskkoulk2016 <> '' or l.yoopiskkoulk2016 <> '') then 1*/
	else 0
end opisk_kk_eiopisk_ta
----Opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa
,case
	when  l.suorlk = '2' and (l.luopiskkoulk_1 <> '' or l.ammopiskkoulk_1 <> '' or l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '') and (l.amkopiskkoulk_1 <> '' or l.yoopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '') and (l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '') and (l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '') and (l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '' or l.ammopiskkoulk2013 <> '') and (l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '' or l.yoopiskkoulk2013 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk2013 <> '' or l.ammopiskkoulk2013 <> '' or l.luopiskkoulk2014 <> '' or l.ammopiskkoulk2014 <> '') and (l.amkopiskkoulk2013 <> '' or l.yoopiskkoulk2013 <> '' or l.amkopiskkoulk2014 <> '' or l.yoopiskkoulk2014 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk2014 <> '' or l.ammopiskkoulk2014 <> '' or l.luopiskkoulk2015 <> '' or l.ammopiskkoulk2015 <> '') and (l.amkopiskkoulk2014 <> '' or l.yoopiskkoulk2014 <> '' or l.amkopiskkoulk2015 <> '' or l.yoopiskkoulk2015 <> '') then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk2015 <> '' or l.ammopiskkoulk2015 <> '' or l.luopiskkoulk2016 <> '' or l.ammopiskkoulk2016 <> '') and (l.amkopiskkoulk2015 <> '' or l.yoopiskkoulk2015 <> '' or l.amkopiskkoulk2016 <> '' or l.yoopiskkoulk2016 <> '') then 1*/
	else 0
end opisk_kk_opisk_ta
----Opiskellut vain ammattikorkeakoulussa
,case
	when  l.suorlk = '2' and (l.amkopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '') and l.yoopiskkoulk_1 = '' and l.yoopiskkoulk_2 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk_2 <> '' or l.amkopiskkoulk2010 <> '') and l.yoopiskkoulk_2 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '') and l.yoopiskkoulk2010 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '') and l.yoopiskkoulk2011 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '') and l.yoopiskkoulk2012 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2013 <> '' or l.amkopiskkoulk2014 <> '') and l.yoopiskkoulk2013 = '' and l.yoopiskkoulk2014 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2014 <> '' or l.amkopiskkoulk2015 <> '') and l.yoopiskkoulk2014 = '' and l.yoopiskkoulk2015 = '' then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2015 <> '' or l.amkopiskkoulk2016 <> '') and l.yoopiskkoulk2015 = '' and l.yoopiskkoulk2016 = '' then 1*/
	else 0
end opisk_vain_amk
----Opiskellut vain yliopistokoulutuksessa
,case
	when  l.suorlk = '2' and l.amkopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and (l.yoopiskkoulk_1 <> '' or l.yoopiskkoulk_2 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and l.amkopiskkoulk_2 = '' and l.amkopiskkoulk2010 = '' and (l.yoopiskkoulk_2 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and l.amkopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and (l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and l.amkopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and (l.yoopiskkoulk2011 <> '' or l.yoopiskkoulk2012 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and l.amkopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and (l.yoopiskkoulk2012 <> '' or l.yoopiskkoulk2013 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and l.amkopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and (l.yoopiskkoulk2013 <> '' or l.yoopiskkoulk2014 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and l.amkopiskkoulk2014 = '' and l.amkopiskkoulk2015 = '' and (l.yoopiskkoulk2014 <> '' or l.yoopiskkoulk2015 <> '') then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '2' and l.amkopiskkoulk2015 = '' and l.amkopiskkoulk2016 = '' and (l.yoopiskkoulk2015 <> '' or l.yoopiskkoulk2016 <> '') then 1*/
	else 0
end opisk_vain_yo
----Opiskellut sekä amk- että yliopistokoulutuksessa
,case
	when  l.suorlk = '2' and (l.amkopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '') and (l.yoopiskkoulk_1 <> '' or l.yoopiskkoulk_2 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk_2 <> '' or l.amkopiskkoulk2010 <> '') and (l.yoopiskkoulk_2 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '') and (l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '') and (l.yoopiskkoulk2011 <> '' or l.yoopiskkoulk2012 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '') and (l.yoopiskkoulk2012 <> '' or l.yoopiskkoulk2013 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2013 <> '' or l.amkopiskkoulk2014 <> '') and (l.yoopiskkoulk2013 <> '' or l.yoopiskkoulk2014 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2014 <> '' or l.amkopiskkoulk2015 <> '') and (l.yoopiskkoulk2014 <> '' or l.yoopiskkoulk2015 <> '') then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2015 <> '' or l.amkopiskkoulk2016 <> '') and (l.yoopiskkoulk2015 <> '' or l.yoopiskkoulk2016 <> '') then 1*/
	else 0
end opisk_amkyo


FROM 
    (
	select * from [VipunenTK_SA].[dbo].[v_K3_12_Perusk_paattaneet_amm_tutk_suorittaneet]
	where suorlk = '2'
	) as l

INNER JOIN VipunenTK.dbo.d_koulutusluokitus d1a on d1a.koulutusluokitus_avain=COALESCE(NULLIF(l.amkopiskkoulk_1,''),'-1')
INNER JOIN VipunenTK.dbo.d_koulutusluokitus d2a on d2a.koulutusluokitus_avain=COALESCE(NULLIF(l.amkopiskkoulk_2,''),'-1')
/*INNER JOIN VipunenTK.dbo.d_koulutusluokitus d2a on d2a.koulutusluokitus_avain=COALESCE(NULLIF(l.amkopiskkoulk_2,''),'-1')
INNER JOIN VipunenTK.dbo.d_koulutusluokitus d3a on d3a.koulutusluokitus_avain=COALESCE(NULLIF(l.amkopiskkoulk2010,''),'-1')
INNER JOIN VipunenTK.dbo.d_koulutusluokitus d4a on d4a.koulutusluokitus_avain=COALESCE(NULLIF(l.amkopiskkoulk2011,''),'-1')
INNER JOIN VipunenTK.dbo.d_koulutusluokitus d5a on d5a.koulutusluokitus_avain=COALESCE(NULLIF(l.amkopiskkoulk2012,''),'-1')
INNER JOIN VipunenTK.dbo.d_koulutusluokitus d6a on d6a.koulutusluokitus_avain=COALESCE(NULLIF(l.amkopiskkoulk2013,''),'-1')
INNER JOIN VipunenTK.dbo.d_koulutusluokitus d7a on d7a.koulutusluokitus_avain=COALESCE(NULLIF(l.amkopiskkoulk2014,''),'-1')
INNER JOIN VipunenTK.dbo.d_koulutusluokitus d8a on d8a.koulutusluokitus_avain=COALESCE(NULLIF(l.amkopiskkoulk2015,''),'-1')*/

INNER JOIN VipunenTK.dbo.d_koulutusluokitus d1b on d1b.koulutusluokitus_avain=COALESCE(NULLIF(l.yoopiskkoulk_1,''),'-1')
INNER JOIN VipunenTK.dbo.d_koulutusluokitus d2b on d2b.koulutusluokitus_avain=COALESCE(NULLIF(l.yoopiskkoulk_2,''),'-1')
/*INNER JOIN VipunenTK.dbo.d_koulutusluokitus d2b on d2b.koulutusluokitus_avain=COALESCE(NULLIF(l.yoopiskkoulk_2,''),'-1')
INNER JOIN VipunenTK.dbo.d_koulutusluokitus d3b on d3b.koulutusluokitus_avain=COALESCE(NULLIF(l.yoopiskkoulk2010,''),'-1')
INNER JOIN VipunenTK.dbo.d_koulutusluokitus d4b on d4b.koulutusluokitus_avain=COALESCE(NULLIF(l.yoopiskkoulk2011,''),'-1')
INNER JOIN VipunenTK.dbo.d_koulutusluokitus d5b on d5b.koulutusluokitus_avain=COALESCE(NULLIF(l.yoopiskkoulk2012,''),'-1')
INNER JOIN VipunenTK.dbo.d_koulutusluokitus d6b on d6b.koulutusluokitus_avain=COALESCE(NULLIF(l.yoopiskkoulk2013,''),'-1')
INNER JOIN VipunenTK.dbo.d_koulutusluokitus d7b on d7b.koulutusluokitus_avain=COALESCE(NULLIF(l.yoopiskkoulk2014,''),'-1')
INNER JOIN VipunenTK.dbo.d_koulutusluokitus d8b on d8b.koulutusluokitus_avain=COALESCE(NULLIF(l.yoopiskkoulk2015,''),'-1')*/

INNER JOIN VipunenTK.dbo.d_koulutusluokitus d1c on d1c.koulutusluokitus_avain=COALESCE(NULLIF(l.ammopiskkoulk_1,''),'-1')
INNER JOIN VipunenTK.dbo.d_koulutusluokitus d2c on d2c.koulutusluokitus_avain=COALESCE(NULLIF(l.ammopiskkoulk_2,''),'-1')
/*INNER JOIN VipunenTK.dbo.d_koulutusluokitus d2c on d2c.koulutusluokitus_avain=COALESCE(NULLIF(l.ammopiskkoulk_2,''),'-1')
INNER JOIN VipunenTK.dbo.d_koulutusluokitus d3c on d3c.koulutusluokitus_avain=COALESCE(NULLIF(l.ammopiskkoulk2010,''),'-1')
INNER JOIN VipunenTK.dbo.d_koulutusluokitus d4c on d4c.koulutusluokitus_avain=COALESCE(NULLIF(l.ammopiskkoulk2011,''),'-1')
INNER JOIN VipunenTK.dbo.d_koulutusluokitus d5c on d5c.koulutusluokitus_avain=COALESCE(NULLIF(l.ammopiskkoulk2012,''),'-1')
INNER JOIN VipunenTK.dbo.d_koulutusluokitus d6c on d6c.koulutusluokitus_avain=COALESCE(NULLIF(l.ammopiskkoulk2013,''),'-1')
INNER JOIN VipunenTK.dbo.d_koulutusluokitus d7c on d7c.koulutusluokitus_avain=COALESCE(NULLIF(l.ammopiskkoulk2014,''),'-1')	
INNER JOIN VipunenTK.dbo.d_koulutusluokitus d8c on d8c.koulutusluokitus_avain=COALESCE(NULLIF(l.ammopiskkoulk2015,''),'-1')	*/

CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d1a.iscfibroad2013_koodi),(d1b.iscfibroad2013_koodi), (d2a.iscfibroad2013_koodi),(d2b.iscfibroad2013_koodi)) AS a(d)) m1
--CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d2a.iscfibroad2013_koodi),(d2b.iscfibroad2013_koodi)/*, (d3a.iscfibroad2013_koodi),(d3b.iscfibroad2013_koodi))*/) AS a(d)) m2
/*CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d3a.iscfibroad2013_koodi),(d3b.iscfibroad2013_koodi), (d4a.iscfibroad2013_koodi),(d4b.iscfibroad2013_koodi)) AS a(d)) m3
CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d4a.iscfibroad2013_koodi),(d4b.iscfibroad2013_koodi), (d5a.iscfibroad2013_koodi),(d5b.iscfibroad2013_koodi)) AS a(d)) m4
CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d5a.iscfibroad2013_koodi),(d5b.iscfibroad2013_koodi), (d6a.iscfibroad2013_koodi),(d6b.iscfibroad2013_koodi)) AS a(d)) m5
CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d6a.iscfibroad2013_koodi),(d6b.iscfibroad2013_koodi), (d7a.iscfibroad2013_koodi),(d7b.iscfibroad2013_koodi)) AS a(d)) m6
CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d7a.iscfibroad2013_koodi),(d7b.iscfibroad2013_koodi), (d8a.iscfibroad2013_koodi),(d8b.iscfibroad2013_koodi)) AS a(d)) m7
CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d8a.iscfibroad2013_koodi),(d8b.iscfibroad2013_koodi), (d9a.iscfibroad2013_koodi),(d9b.iscfibroad2013_koodi)) AS a(d)) m8*/

	WHERE 1=1
--end;

--
-- TULOS
-- 
/*if @debug_what_to_run>=3 begin
	if @debug_what_to_run>0 print 'querying result';
	select * from [VipunenTK_DW].[dbo].[_koulutukseen_sijoittuneet_2v]
	
end;

if @debug_what_to_run>0 PRINT 'all done.';*/


--GO




GO
/****** Object:  StoredProcedure [dbo].[p_lataa_f_koulutukseen_sijoittuneet_2v_1_tarkastelujakso]    Script Date: 29.8.2018 15:59:41 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


CREATE PROCEDURE [dbo].[p_lataa_f_koulutukseen_sijoittuneet_2v_1_tarkastelujakso] AS


/*declare @debug_what_to_run tinyint; set @debug_what_to_run=2; -- käytä arvoa 3 vain kun teet yhden vuoden
print '$'+convert(varchar,sysdatetime(),20)+'$ '+'DEBUG (what to run)='+cast(@debug_what_to_run as varchar)+
': 0=luo vain taulut, älä tulosta mitään; 1=luo taulut ja tulosta joitakin merkittävimpiä välivaiheita; 2=luo taulut ja tulosta välivaiheet; 3=luo taulut, tulosta välivaiheet ja tulosta myös tulokset, 4=tulosta välivaiheet, mutta älä tee mitään';



-- lisätään data
if @debug_what_to_run not in (4) begin
if @debug_what_to_run>0 print 'inserting data';

-- parametrimuuttujien arvot
-- parametrimuuttujat
DECLARE @ensimmainen_suoritusvuosi int;
DECLARE @toinen_suoritusvuosi int;
DECLARE @kolmas_suoritusvuosi int;
DECLARE @neljas_suoritusvuosi int;
DECLARE @viides_suoritusvuosi int;
DECLARE @kuudes_suoritusvuosi int;
DECLARE @seitsemas_suoritusvuosi int;
DECLARE @kahdeksas_suoritusvuosi int;

set @ensimmainen_suoritusvuosi = 2008;
set @toinen_suoritusvuosi = 2009;
set @kolmas_suoritusvuosi = 2010;
set @neljas_suoritusvuosi = 2011;
set @viides_suoritusvuosi = 2012;
set @kuudes_suoritusvuosi = 2013;
set @seitsemas_suoritusvuosi = 2014;
set @kahdeksas_suoritusvuosi = 2015;

*/

INSERT INTO [VipunenTK_DW].[dbo].[_koulutukseen_sijoittuneet_2v_tarkastelu]
(
rivinumero
, tarkastelujakso
, tilv 
, tilv_date
, tutkryh 
, suorv
, suorlk 
, sp 
, syntv
, aikielir1 
, tutkkaskun 
, kansalr1
, pohjmaa 
, eumaa 
, etamaa 
, tunn
, jarj
, kkielir1 
, tutklaja 
, tutktav 
, aikoul 
, tutkmaak
, koulutus_1
, oppilaitos_1
, koulutuksen_jarjestaja_1
, koulutuksen_maakunta_1
, koulutus_2
, oppilaitos_2
, koulutuksen_jarjestaja_2
, koulutuksen_maakunta_2
, monihaku
, paaasiallinen_toiminta
, ammattiasema
, lkm
, pohjkoulk
, tietolahde
, aineisto
, lukiokoulutuksessa
, ammatillisessa_koulutuksessa
, ammattikorkeakoulutuksessa
, yliopistokoulutuksessa
, lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa
, toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa
, ammattikorkeakoulutuksessa_ja_yliopistokoulutuksessa
, koulutuksen_paattaneiden_toiminta
, ika_1v
, ika_5v
, ika_1v_suorv
, opisk_lu
, opisk_amm_pk
, opisk_amm_at
, opisk_amm_eat
, opisk_amm
, opisk_amk
, opisk_yo
, opisk_amk_koulala1
, opisk_amk_koulala2
, opisk_amk_koulala3
, opisk_amk_koulala4
, opisk_amk_koulala5
, opisk_amk_koulala6
, opisk_amk_koulala7
, opisk_amk_koulala8
, opisk_amk_koulala9
, opisk_amk_koulala10
, opisk_yo_koulala1
, opisk_yo_koulala2
, opisk_yo_koulala3
, opisk_yo_koulala4
, opisk_yo_koulala5
, opisk_yo_koulala6
, opisk_yo_koulala7
, opisk_yo_koulala8
, opisk_yo_koulala9
, opisk_yo_koulala10
, opisk_vah2_koulala
, haku_amm
, haku_amk
, haku_yo
, eihaku_kk_eiopisk
, eihaku_kk_eiopisk_kk_opisk_ta
, eihaku_kk_eiopisk_kk_opisk_lu
, eihaku_kk_eiopisk_kk_opisk_pk
, eihaku_kk_eiopisk_kk_opisk_at
, eihaku_kk_eiopisk_kk_opisk_eat
, haku_kk_eiopisk_kk
, haku_kk_eiopisk_kk_eiopisk_ta
, haku_kk_eiopisk_kk_opisk_ta
, haku_amk_eiopisk_kk
, haku_yo_eiopisk_kk
, haku_amkyo_eiopisk_kk
, opisk_kk
, opisk_kk_eiopisk_ta
, opisk_kk_opisk_ta
, opisk_vain_amk
, opisk_vain_yo
, opisk_amkyo
)
SELECT 
 l.rivinumero,
 '1',
 l.tilv,
 l.tilv_date,
  (case 
	when l.tutkryh=3 and tutklaja=1 then 31
	when l.tutkryh=3 and tutklaja=2 then 32
	when l.tutkryh=3 and tutklaja=3 then 33
	else l.tutkryh
  end),
 l.suorv,
   (case
	when l.suorlk = '1'  then (l.suorv+'0'+l.suorlk)
	when l.suorlk = '2'  then (l.suorv+'0'+'8')
	else ''
	end),
 l.sp,
 l.syntv,
 l.aikielir1,
 l.tutkaskun,
 l.kansalr1,
 l.pohjmaa,
 l.eumaa,
 l.etamaa,
 l.tunn,
 l.jarj,
 l.kkielir1,
 l.tutklaja,
l.tutktav,
l.aikoul,
l.tutkmaak,


 -- Koulutus 1
 (case
    --lukiokoulutuksessa
	when  l.suorlk = '1' and l.luopiskkoulk_2 <> '' and l.ammopiskkoulk_2 = '' and
	l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' then l.luopiskkoulk_2 
	-- ammattikoulutuksessa _2
	when  l.suorlk = '1' and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 <> '' and
	l.amkopiskkoulk_2 ='' and l.yoopiskkoulk_2 = ''  then l.ammopiskkoulk_2 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen _2 ensim. koulutustietoihin
	when  l.suorlk = '1' and l.luopiskkoulk_2 <> '' and l.ammopiskkoulk_2 <> '' and
	l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' then l.luopiskkoulk_2
	-- ammattikorkeakoulutuksessa _2
	when  l.suorlk = '1' and l.amkopiskkoulk_2  <> '' and l.yoopiskkoulk_2  = '' and
	l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' then l.amkopiskkoulk_2
	-- yliopistokoulutuksessa _2
	when  l.suorlk = '1' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 <> '' and 
	l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = ''   then l.yoopiskkoulk_2
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa, merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when  l.suorlk = '1' and l.amkopiskkoulk_2 <> '' and l.yoopiskkoulk_2  <> '' and
	l.luopiskkoulk_2 = '' and ammopiskkoulk_2 = ''  then l.amkopiskkoulk_2 		
	else ''	    
	    end),
	    
-- Oppilaitos 1
	(case
	-- lukiokoulutuksen oppilaitos
	when  l.suorlk = '1' and l.luopisktunn_2 <> '' and l.ammopisktunn_2 = '' and
	l.amkopisktunn_2 = '' and l.yoopisktunn_2 = '' then l.luopisktunn_2 
	-- ammattikoulutuksen oppilaitos _2
	when  l.suorlk = '1' and l.luopisktunn_2 = '' and l.ammopisktunn_2 <> '' and
	l.amkopisktunn_2 ='' and l.yoopisktunn_2 = ''  then l.ammopisktunn_2 
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos _2
	when  l.suorlk = '1' and l.luopisktunn_2 <> '' and l.ammopisktunn_2 <> '' and
	l.amkopisktunn_2 = '' and l.yoopisktunn_2 = '' then l.luopisktunn_2
	-- ammattikorkeakoulutuksen oppilaitos _2
	when  l.suorlk = '1' and l.amkopisktunn_2  <> '' and l.yoopisktunn_2  = '' and
	l.luopisktunn_2 = '' and l.ammopisktunn_2 = '' then l.amkopisktunn_2
	-- yliopistokoulutuksen oppilaitos _2
	when  l.suorlk = '1' and l.amkopisktunn_2 = '' and l.yoopisktunn_2 <> '' and 
	l.luopisktunn_2 = '' and l.ammopisktunn_2 = ''   then l.yoopisktunn_2
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus _2  
	when  l.suorlk = '1' and l.amkopisktunn_2 <> '' and l.yoopisktunn_2  <> '' and
	l.luopisktunn_2 = '' and l.ammopisktunn_2 = ''  then l.amkopisktunn_2 	
	else ''
	    end),

  --Koulutuksen järjestäjä 1
	(case
	-- lukikoulutuksen järjestäjä
	when  l.suorlk = '1' and l.luopiskjarj_2  <> '' and l.ammopiskjarj_2 = '' and
	l.amkopiskjarj_2 = '' and yoopiskjarj_2 = '' then l.luopiskjarj_2
	-- ammatillisen koulutuksen järjestäjä _2  
	when  l.suorlk = '1' and l.luopiskjarj_2 = '' and l.ammopiskjarj_2 <> '' and
	l.amkopiskjarj_2 ='' and l.yoopiskjarj_2 = ''  then l.ammopiskjarj_2
	-- lukio- ja ammatillisen koulutuksen järjestäjä, merkitään lukiokoulutuksen _2 järjestäjä 
	when  l.suorlk = '1' and l.luopiskjarj_2 <> '' and l.ammopiskjarj_2 <> '' and
	l.amkopiskjarj_2 = '' and l.yoopiskjarj_2 = '' then l.luopiskjarj_2
	-- ammattikorkeakoulutuksen järjestäjä _2
	when  l.suorlk = '1' and l.amkopiskjarj_2  <> '' and l.yoopiskjarj_2   = '' and
	l.luopiskjarj_2 = '' and l.ammopiskjarj_2 = '' then l.amkopiskjarj_2
	-- yliopistokoulutuksen järjestäjä _2 
	when  l.suorlk = '1' and l.amkopiskjarj_2  = '' and l.yoopiskjarj_2  <> '' and 
	l.luopiskjarj_2  = '' and l.ammopiskjarj_2 = ''   then l.yoopiskjarj_2
	-- ammattikorkea- ja yliopistokoulutuksen järjestäjä, merkitään ammattikorkeakoulutuksen _2 järjestäjä   
	when  l.suorlk = '1' and l.amkopiskjarj_2  <> '' and l.yoopiskjarj_2   <> '' and
	l.luopiskjarj_2  = '' and l.ammopiskjarj_2  = ''  then l.amkopiskjarj_2 
	else ''
	    end),

 --Koulutuksen maakunta 1
	(case
	-- lukioopiskelun maakunta 
	when  l.suorlk = '1' and l.luopiskmaak_2   <> '' and l.ammopiskmaak_2  = '' and
	l.amkopiskmaak_2  = '' and l.yoopiskmaak_2  = '' then l.luopiskmaak_2   
	-- ammatillisen koulutuksen maakunta _2
	when  l.suorlk = '1' and l.luopiskmaak_2  = '' and l.ammopiskmaak_2  <> '' and
	l.amkopiskmaak_2  ='' and l.yoopiskmaak_2  = ''  then l.ammopiskmaak_2  
	-- lukiokoulutuksen ja ammatillisen koulutus otetaan lukiokoulutuksen maakunta _2
	when  l.suorlk = '1' and l.luopiskmaak_2  <> '' and l.ammopiskmaak_2  <> '' and
	l.amkopiskmaak_2  = '' and l.yoopiskmaak_2  = '' then l.luopiskmaak_2 
    -- ammattikorkeakoulutuksen maakunta _2
	when  l.suorlk = '1' and l.amkopiskmaak_2   <> '' and l.yoopiskmaak_2   = '' and
	l.luopiskjarj_2 = '' and l.ammopiskmaak_2 = '' then l.amkopiskmaak_2
	-- yliopistokoulutuksen maakunta _2 
	when  l.suorlk = '1' and l.amkopiskmaak_2  = '' and l.yoopiskmaak_2  <> '' and 
	l.luopiskjarj_2  = '' and l.ammopiskmaak_2 = ''   then l.yoopiskmaak_2
	-- ammattikorkekoulutuksen ja yliopistokoulutksen maakunta otetaan ammattikorkeakoulutuksen maakunta _2   
	when  l.suorlk = '1' and l.amkopiskmaak_2  <> '' and l.yoopiskmaak_2   <> '' and
	l.luopiskjarj_2  = '' and l.ammopiskmaak_2  = ''  then l.amkopiskmaak_2 
	else ''	
	    end),

-- Koulutus 2
(case
   -- jos lukiokoulutuksessa vain niin jätetään tyhjäksi
	when  l.suorlk = '1' and l.luopiskkoulk_2 <> '' and l.ammopiskkoulk_2 = '' and
	l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' then ''
	-- jos ammattikoulutuksessa vain  jätetään tyhjäksi _2 
	when  l.suorlk = '1' and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 <> '' and
	l.amkopiskkoulk_2 ='' and l.yoopiskkoulk_2 = ''  then ''
	-- jos lukiokoulutksessa ja ammattikoulutuksessa merkitään ammattikoulutus _2 
	when  l.suorlk = '1' and l.luopiskkoulk_2 <> '' and l.ammopiskkoulk_2 <> '' and
	l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' then l.ammopiskkoulk_2 
	-- jos vain ammattikorkeakoulutuksessa jätetään tyhjäksi
	when  l.suorlk = '1' and l.amkopiskkoulk_2  <> '' and l.yoopiskkoulk_2  = '' and
	l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when  l.suorlk = '1' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 <> '' and 
	l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = ''   then ''
	-- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus _2
	when  l.suorlk = '1' and l.amkopiskkoulk_2 <> '' and l.yoopiskkoulk_2  <> '' and
	l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = ''  then l.yoopiskkoulk_2
	else ''
	    end),

-- Oppilaitos 2
(case
    -- lukiokoulutuksen oppilaitos vain merkitään tyhjäksi
	when  l.suorlk = '1' and l.luopisktunn_2 <> '' and l.ammopisktunn_2 = '' and
	l.amkopisktunn_2 = '' and l.yoopisktunn_2 = '' then ''
	-- ammatillisen koulutuksen oppilaitos _2 merkitään tyhjäksi
	when  l.suorlk = '1' and l.luopisktunn_2 = '' and l.ammopisktunn_2 <> '' and
	l.amkopisktunn_2 ='' and l.yoopisktunn_2 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos merkitään ammatillisen koulutuksen oppilaitos _2
	when  l.suorlk = '1' and l.luopisktunn_2 <> '' and l.ammopisktunn_2 <> '' and
	l.amkopisktunn_2 = '' and l.yoopisktunn_2 = '' then l.ammopisktunn_2 
	-- ammattikorkeakoulutksen oppilaitos vain merkitään tyhjäksi _2
	when  l.suorlk = '1' and l.amkopisktunn_2  <> '' and l.yoopisktunn_2  = '' and
	l.luopisktunn_2 = '' and l.ammopisktunn_2 = '' then ''
	-- yliopistokoulutksen oppilaitos vain merkitään tyhjäksi _2
	when  l.suorlk = '1' and l.amkopisktunn_2 = '' and l.yoopisktunn_2 <> '' and 
	l.luopisktunn_2 = '' and l.ammopisktunn_2 = ''   then ''  
	--  ammattikorkeakoulutksen oppilaitos ja yliopistokoulutuksen oppilaitos, merkitään yliopistokoulutuksen oppilaitos _2
	when  l.suorlk = '1' and l.amkopisktunn_2 <> '' and l.yoopisktunn_2  <> '' and
	l.luopisktunn_2 = '' and l.ammopisktunn_2 = ''  then l.yoopisktunn_2 
	else ''
	    end),

-- Koulutuksen järjestäjä 2
	(case
	-- lukiokoulutuksen järjestäjä vain _2, merkitään tyhjäksi
	when  l.suorlk = '1' and l.luopiskjarj_2  <> '' and l.ammopiskjarj_2 = '' and
	l.amkopiskjarj_2 = '' and l.yoopiskjarj_2 = '' then ''
	-- ammatillisen koulutuksen järjestäjä vain _2, merkitään tyhjäksi
	when  l.suorlk = '1' and l.luopiskjarj_2 = '' and l.ammopiskjarj_2 <> '' and
	l.amkopiskjarj_2 ='' and l.yoopiskjarj_2 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä _2
	when  l.suorlk = '1' and l.luopiskjarj_2 <> '' and l.ammopiskjarj_2 <> '' and
	l.amkopiskjarj_2 = '' and l.yoopiskjarj_2 = '' then l.ammopiskjarj_2 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi
	when  l.suorlk = '1' and l.amkopiskjarj_2  <> '' and l.yoopiskjarj_2   = '' and
	l.luopiskjarj_2 = '' and l.ammopiskjarj_2 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, merkitään tyhjäksi
	when  l.suorlk = '1' and l.amkopiskjarj_2  = '' and l.yoopiskjarj_2  <> '' and 
	l.luopiskjarj_2  = '' and l.ammopiskjarj_2 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestäjä merkitään yliopistokoulutuksen järjetäjä _2
	when  l.suorlk = '1' and l.amkopiskjarj_2  <> '' and l.yoopiskjarj_2   <> '' and
	l.luopiskjarj_2  = '' and l.ammopiskjarj_2  = ''  then l.yoopiskjarj_2 	
	else ''
	    end),

-- Koulutuksen maakunta 2
	(case
	-- vain lukiokoulutuksen maakunta _2, jätetään tyhjäksi
	when  l.suorlk = '1' and l.luopiskmaak_2   <> '' and l.ammopiskmaak_2  = '' and
	l.amkopiskmaak_2  = '' and l.yoopiskmaak_2  = '' then ''
	-- vain ammatillisen koulutuksen maakunta _2, jätetään tyhjäksi   
	when  l.suorlk = '1' and l.luopiskmaak_2  = '' and l.ammopiskmaak_2  <> '' and
	l.amkopiskmaak_2  ='' and l.yoopiskmaak_2  = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta, merkitään ammatillisen koulutuksen maakunta _2
	when  l.suorlk = '1' and l.luopiskmaak_2  <> '' and l.ammopiskmaak_2  <> '' and
	l.amkopiskmaak_2  = '' and l.yoopiskmaak_2  = '' then l.ammopiskmaak_2 
	-- vain ammattikorkeakoulutuksen maakunta _2, jätetään tyhjäksi
	when  l.suorlk = '1' and l.amkopiskmaak_2   <> '' and l.yoopiskmaak_2   = '' and
	l.luopiskmaak_2 = '' and l.ammopiskmaak_2 = '' then '' 
	-- vain yliopistokoulutuksen maakunta _2, merkitään tyhjäksi
	when  l.suorlk = '1' and l.amkopiskmaak_2  = '' and l.yoopiskmaak_2  <> '' and 
	l.luopiskmaak_2  = '' and l.ammopiskmaak_2 = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta _2, merkitään yliopistokoulutuksen maakunta _2
	when  l.suorlk = '1' and l.amkopiskmaak_2  <> '' and l.yoopiskmaak_2   <> '' and
	l.luopiskjarj_2  = '' and l.ammopiskmaak_2  = ''  then l.yoopiskmaak_2
	else ''
	    end),

	-- Monihaku
	(case
	-- 2009
	when  l.suorlk = '1' then l.monihaku_2
	

	else '8'
	end),

    -- Pääasiallinen toiminta
    (case when l.suorlk = '1' then l.ptoim1r4_2 else '' end),

	-- Ammattiasema
	(case when  l.suorlk = '1' then l.amas_2 else '' end),
    l.lkm,
     (case when l.pohjkoul= '' then '' when l.pohjkoul is NULL then '' else l.pohjkoul end ),
 l.tietolahde,
 'K3.12',
 -- Lukiokoulutuksessa
 (case
	    when  (l.suorlk = '1' ) and  l.luopiskkoulk_2 <> '' and l.ammopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_2 = '' then '1'  
	    else '0'
	    end) as lukiokoulutuksessa,
 -- Ammatillisessa koulutuksessa 
 (case
	    when  (l.suorlk = '1') and  l.ammopiskkoulk_2  <> '' and l.luopiskkoulk_2 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' then '1' 
	    else '0'
	    end) as ammatillisessa_koulutuksessa,
-- Ammattikorkeakoulutuksessa
 (case
	   when  (l.suorlk = '1') and  l.amkopiskkoulk_2 <> '' and l.ammopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.luopiskkoulk_2 = '' then  '1'
	   else '0' 
	   end) as ammattikorkeakoulutuksessa,
-- Yliopistokoulutuksessa
 (case
	    when  (l.suorlk = '1') and  l.yoopiskkoulk_2  <> '' and l.amkopiskkoulk_2 = '' and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' then '1' 
	    else '0'
	    end) as yliopistokoulutuksessa,
-- Lukiokoulutuksessa ja ammatillisessa koulutuksessa
(case
	    when  (l.suorlk = '1') and  l.luopiskkoulk_2  <> '' and l.ammopiskkoulk_2 <> '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2  = '' then '1'  
	    else '0'
	    end) as lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa,
-- Toisen asteen ammatillisessa koulutuksessa ja korkeakoulutuksessa
(case
	    when  (l.suorlk = '1') and  l.ammopiskkoulk_2  <> '' and l.amkopiskkoulk_2 <> '' and l.luopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' then '1' 
	    else '0'
	    end) as toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa,
-- Ammattikorkeakoulutuksessa ja yliopistokoulutuksessa
(case
	    when  (l.suorlk = '1') and  l.amkopiskkoulk_2  <> '' and l.yoopiskkoulk_2 <> '' and l.ammopiskkoulk_2  = '' and l.luopiskkoulk_2 = ''  then '1' 
	    else '0'
	    end) as ammattikorkekoulutuksessa_ja_yliopistokoulutuksessa,    
-- Koulutuksen päättäneiden toiminta
(case
	   -- Tutkintoon johtavassa koulutuksessa olevat
	   when (l.suorlk = '1') 
	   and (l.ptoim1r4_2 = '22' or l.ptoim1r4_2 = '13')
	   and (l.luopiskkoulk_2 <>'' or l.ammopiskkoulk_2 <>'' or l.amkopiskkoulk_2 <>'' or l.yoopiskkoulk_2 <>'') then '1' 

	  -- Ei tutkintoon johtavassa koulutuksessa olevat
	   when  (l.suorlk = '1') 
	   and (l.ptoim1r4_2 = '22' or l.ptoim1r4_2 = '13')
	   and (l.luopiskkoulk_2 ='' and l.ammopiskkoulk_2 ='' and l.amkopiskkoulk_2 ='' and l.yoopiskkoulk_2 ='') then '2' 
	 
	   -- Ei opiskelevat työlliset
	   when (l.suorlk = '1')and  l.ptoim1r4_2  = '10'  then '3' 
	   -- Ei opiskelevat työttömät
	   when  (l.suorlk = '1') and  l.ptoim1r4_2  = '12'  then '4' 
	   --  
	   -- Ei opiskelevat muut
		else '5' 
	   end ) as koulutuksen_paattaneiden_toiminta
 ,ika_1v = cast((case 
            when syntv = '' then '-1' else  ((cast(tilv as int) - cast(syntv as int))) end)  as nvarchar(10))
 ,ika_5v =cast(
       (
		case
		when (cast(tilv as int) - cast(syntv as int)) < 15 then '5v10'
		when ((cast(tilv as int) - cast(syntv as int)) >= 15 and (cast(tilv as int) - cast(syntv as int)) <= 19) then '5v15'
		when ((cast(tilv as int) - cast(syntv as int)) >= 20 and (cast(tilv as int) - cast(syntv as int)) <= 24) then '5v20'
		when ((cast(tilv as int) - cast(syntv as int)) >= 25 and (cast(tilv as int) - cast(syntv as int)) <= 29) then '5v25'
		when ((cast(tilv as int) - cast(syntv as int)) >= 30 and (cast(tilv as int) - cast(syntv as int)) <= 34) then '5v30'
		when ((cast(tilv as int) - cast(syntv as int)) >= 35 and (cast(tilv as int) - cast(syntv as int)) <= 39) then '5v35'
		when ((cast(tilv as int) - cast(syntv as int)) >= 40 and (cast(tilv as int) - cast(syntv as int)) <= 44) then '5v40'
		when ((cast(tilv as int) - cast(syntv as int)) >= 45 and (cast(tilv as int) - cast(syntv as int)) <= 49) then '5v45'
		when ((cast(tilv as int) - cast(syntv as int)) >= 50 and (cast(tilv as int) - cast(syntv as int)) <= 54) then '5v50'
		when ((cast(tilv as int) - cast(syntv as int)) >= 55 and (cast(tilv as int) - cast(syntv as int)) <= 59) then '5v55'
		when ((cast(tilv as int) - cast(syntv as int)) >= 60 and (cast(tilv as int) - cast(syntv as int)) <= 64) then '5v60'
		when ((cast(tilv as int) - cast(syntv as int)) >= 65 and (cast(tilv as int) - cast(syntv as int)) <= 69) then '5v65'
		when ((cast(tilv as int) - cast(syntv as int)) >= 70 and (cast(tilv as int) - cast(syntv as int)) <= 74) then '5v70'
		when ((cast(tilv as int) - cast(syntv as int)) >= 75 and (cast(tilv as int) - cast(syntv as int)) <= 79) then '5v75'
		when ((cast(tilv as int) - cast(syntv as int)) >= 80 and (cast(tilv as int) - cast(syntv as int)) <= 84) then '5v80'
		when ((cast(tilv as int) - cast(syntv as int)) >= 85 and (cast(tilv as int) - cast(syntv as int)) <= 89) then '5v85'
		when ((cast(tilv as int) - cast(syntv as int)) >= 90 and (cast(tilv as int) - cast(syntv as int)) <= 94) then '5v90'
		when ((cast(tilv as int) - cast(syntv as int)) >= 95) then '5v95'
		
		end
	   ) as nvarchar (10))

  ,ika_1v_suorv = cast(
					(case 
						when syntv = '' then '-1' 
						else ((cast(suorv as int) - cast(syntv as int))) 
					end)  
	as nvarchar(10))



--uudet muuttujat 03/2018

,case
	when  l.suorlk = '1' and (l.luopiskkoulk_1 <> '' or l.luopiskkoulk_2 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk_2 <> '' or l.luopiskkoulk2010 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk2013 <> '' or l.luopiskkoulk2014 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk2014 <> '' or l.luopiskkoulk2015 <> '') then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk2015 <> '' or l.luopiskkoulk2016 <> '') then 1*/
	else 0
end as opisk_lu
--Opiskellut ammatillisessa peruskoulutuksessa
,case
	when  l.suorlk = '1' and (l.ammopiskkoulk_1 <> '' or l.ammopiskkoulk_2 <> '') and (d1c.Koulutusaste_taso2_koodi = '32' or d2c.Koulutusaste_taso2_koodi = '32') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk2010 <> '') and (d2c.Koulutusaste_taso2_koodi = '32' or d3c.Koulutusaste_taso2_koodi = '32') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '') and (d3c.Koulutusaste_taso2_koodi = '32' or d4c.Koulutusaste_taso2_koodi = '32') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '') and (d4c.Koulutusaste_taso2_koodi = '32' or d5c.Koulutusaste_taso2_koodi = '32') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2012 <> '' or l.ammopiskkoulk2013 <> '') and (d5c.Koulutusaste_taso2_koodi = '32' or d6c.Koulutusaste_taso2_koodi = '32') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2013 <> '' or l.ammopiskkoulk2014 <> '') and (d6c.Koulutusaste_taso2_koodi = '32' or d7c.Koulutusaste_taso2_koodi = '32') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2014 <> '' or l.ammopiskkoulk2015 <> '') and (d7c.Koulutusaste_taso2_koodi = '32' or d8c.Koulutusaste_taso2_koodi = '32') then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2015 <> '' or l.ammopiskkoulk2016 <> '') and (d8c.Koulutusaste_taso2_koodi = '32' or d9c.Koulutusaste_taso2_koodi = '32') then 1*/
	else 0
end as opisk_amm_pk
--Opiskellut ammattitutkintokoulutuksessa
,case
	when  l.suorlk = '1' and (l.ammopiskkoulk_1 <> '' or l.ammopiskkoulk_2 <> '') and (d1c.Koulutusaste_taso2_koodi = '33' or d2c.Koulutusaste_taso2_koodi = '33') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk2010 <> '') and (d2c.Koulutusaste_taso2_koodi = '33' or d3c.Koulutusaste_taso2_koodi = '33') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '') and (d3c.Koulutusaste_taso2_koodi = '33' or d4c.Koulutusaste_taso2_koodi = '33') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '') and (d4c.Koulutusaste_taso2_koodi = '33' or d5c.Koulutusaste_taso2_koodi = '33') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2012 <> '' or l.ammopiskkoulk2013 <> '') and (d5c.Koulutusaste_taso2_koodi = '33' or d6c.Koulutusaste_taso2_koodi = '33') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2013 <> '' or l.ammopiskkoulk2014 <> '') and (d6c.Koulutusaste_taso2_koodi = '33' or d7c.Koulutusaste_taso2_koodi = '33') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2014 <> '' or l.ammopiskkoulk2015 <> '') and (d7c.Koulutusaste_taso2_koodi = '33' or d8c.Koulutusaste_taso2_koodi = '33') then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2015 <> '' or l.ammopiskkoulk2016 <> '') and (d8c.Koulutusaste_taso2_koodi = '33' or d9c.Koulutusaste_taso2_koodi = '33') then 1*/
	else 0
end as opisk_amm_at
--Opiskellut erikoisammattitutkintokoulutuksessa
,case
	when  l.suorlk = '1' and (l.ammopiskkoulk_1 <> '' or l.ammopiskkoulk_2 <> '') and (d1c.Koulutusaste_taso2_koodi = '41' or d2c.Koulutusaste_taso2_koodi = '41') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk2010 <> '') and (d2c.Koulutusaste_taso2_koodi = '41' or d3c.Koulutusaste_taso2_koodi = '41') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '') and (d3c.Koulutusaste_taso2_koodi = '41' or d4c.Koulutusaste_taso2_koodi = '41') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '') and (d4c.Koulutusaste_taso2_koodi = '41' or d5c.Koulutusaste_taso2_koodi = '41') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2012 <> '' or l.ammopiskkoulk2013 <> '') and (d5c.Koulutusaste_taso2_koodi = '41' or d6c.Koulutusaste_taso2_koodi = '41') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2013 <> '' or l.ammopiskkoulk2014 <> '') and (d6c.Koulutusaste_taso2_koodi = '41' or d7c.Koulutusaste_taso2_koodi = '41') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2014 <> '' or l.ammopiskkoulk2015 <> '') and (d7c.Koulutusaste_taso2_koodi = '41' or d8c.Koulutusaste_taso2_koodi = '41') then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2015 <> '' or l.ammopiskkoulk2016 <> '') and (d8c.Koulutusaste_taso2_koodi = '41' or d9c.Koulutusaste_taso2_koodi = '41') then 1*/
	else 0
end as opisk_amm_eat
--Opiskellut ammatillisessa koulutuksessa
,case
	when  l.suorlk = '1' and (l.ammopiskkoulk_1 <> '' or l.ammopiskkoulk_2 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk2010 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2012 <> '' or l.ammopiskkoulk2013 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2013 <> '' or l.ammopiskkoulk2014 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2014 <> '' or l.ammopiskkoulk2015 <> '') then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2015 <> '' or l.ammopiskkoulk2016 <> '') then 1*/
	else 0
end as opisk_amm
--Opiskellut ammattikorkeakoulutuksessa
,case
	when  l.suorlk = '1' and (l.amkopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk_2 <> '' or l.amkopiskkoulk2010 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2013 <> '' or l.amkopiskkoulk2014 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2014 <> '' or l.amkopiskkoulk2015 <> '') then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2015 <> '' or l.amkopiskkoulk2016 <> '') then 1*/
	else 0
end as opisk_amk
--Opiskellut yliopistokoulutuksessa
,case
	when  l.suorlk = '1' and (l.yoopiskkoulk_1 <> '' or l.yoopiskkoulk_2 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.yoopiskkoulk_2 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.yoopiskkoulk2011 <> '' or l.yoopiskkoulk2012 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.yoopiskkoulk2012 <> '' or l.yoopiskkoulk2013 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.yoopiskkoulk2013 <> '' or l.yoopiskkoulk2014 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.yoopiskkoulk2014 <> '' or l.yoopiskkoulk2015 <> '') then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '1' and (l.yoopiskkoulk2015 <> '' or l.yoopiskkoulk2016 <> '') then 1*/
	else 0
end as opisk_yo



----KOULUTUSALA, TASO 1 KYLLÄ/EI
--Opiskellut koulutusala1 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1a.iscfibroad2013_koodi = '01' or d2a.iscfibroad2013_koodi = '01') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2a.iscfibroad2013_koodi = '01' or d3a.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3a.iscfibroad2013_koodi = '01' or d4a.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4a.iscfibroad2013_koodi = '01' or d5a.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5a.iscfibroad2013_koodi = '01' or d6a.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6a.iscfibroad2013_koodi = '01' or d7a.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7a.iscfibroad2013_koodi = '01' or d8a.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '1' and (d8a.iscfibroad2013_koodi = '01' or d9a.iscfibroad2013_koodi = '01') then 1*/
	else 0
end as opisk_amk_koulala1
--Opiskellut koulutusala2 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1a.iscfibroad2013_koodi = '02' or d2a.iscfibroad2013_koodi = '02') then 1
/*		when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2a.iscfibroad2013_koodi = '02' or d3a.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3a.iscfibroad2013_koodi = '02' or d4a.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4a.iscfibroad2013_koodi = '02' or d5a.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5a.iscfibroad2013_koodi = '02' or d6a.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6a.iscfibroad2013_koodi = '02' or d7a.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7a.iscfibroad2013_koodi = '02' or d8a.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '1' and (d8a.iscfibroad2013_koodi = '02' or d9a.iscfibroad2013_koodi = '02') then 1*/
	else 0
end as opisk_amk_koulala2
--Opiskellut koulutusala3 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1a.iscfibroad2013_koodi = '03' or d2a.iscfibroad2013_koodi = '03') then 1
/*		when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2a.iscfibroad2013_koodi = '03' or d3a.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3a.iscfibroad2013_koodi = '03' or d4a.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4a.iscfibroad2013_koodi = '03' or d5a.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5a.iscfibroad2013_koodi = '03' or d6a.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6a.iscfibroad2013_koodi = '03' or d7a.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7a.iscfibroad2013_koodi = '03' or d8a.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '1' and (d8a.iscfibroad2013_koodi = '03' or d9a.iscfibroad2013_koodi = '03') then 1*/
	else 0
end as opisk_amk_koulala3
--Opiskellut koulutusala4 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1a.iscfibroad2013_koodi = '04' or d2a.iscfibroad2013_koodi = '04') then 1
/*		when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2a.iscfibroad2013_koodi = '04' or d3a.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3a.iscfibroad2013_koodi = '04' or d4a.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4a.iscfibroad2013_koodi = '04' or d5a.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5a.iscfibroad2013_koodi = '04' or d6a.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6a.iscfibroad2013_koodi = '04' or d7a.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7a.iscfibroad2013_koodi = '04' or d8a.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '1' and (d8a.iscfibroad2013_koodi = '04' or d9a.iscfibroad2013_koodi = '04') then 1*/
	else 0
end as opisk_amk_koulala4
--Opiskellut koulutusala5 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1a.iscfibroad2013_koodi = '05' or d2a.iscfibroad2013_koodi = '05') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2a.iscfibroad2013_koodi = '05' or d3a.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3a.iscfibroad2013_koodi = '05' or d4a.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4a.iscfibroad2013_koodi = '05' or d5a.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5a.iscfibroad2013_koodi = '05' or d6a.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6a.iscfibroad2013_koodi = '05' or d7a.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7a.iscfibroad2013_koodi = '05' or d8a.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '1' and (d8a.iscfibroad2013_koodi = '05' or d9a.iscfibroad2013_koodi = '05') then 1*/
	else 0
end as opisk_amk_koulala5
--Opiskellut koulutusala6 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1a.iscfibroad2013_koodi = '06' or d2a.iscfibroad2013_koodi = '06') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2a.iscfibroad2013_koodi = '06' or d3a.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3a.iscfibroad2013_koodi = '06' or d4a.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4a.iscfibroad2013_koodi = '06' or d5a.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5a.iscfibroad2013_koodi = '06' or d6a.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6a.iscfibroad2013_koodi = '06' or d7a.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7a.iscfibroad2013_koodi = '06' or d8a.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '1' and (d8a.iscfibroad2013_koodi = '06' or d9a.iscfibroad2013_koodi = '06') then 1*/
	else 0
end as opisk_amk_koulala6
--Opiskellut koulutusala7 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1a.iscfibroad2013_koodi = '07' or d2a.iscfibroad2013_koodi = '07') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2a.iscfibroad2013_koodi = '07' or d3a.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3a.iscfibroad2013_koodi = '07' or d4a.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4a.iscfibroad2013_koodi = '07' or d5a.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5a.iscfibroad2013_koodi = '07' or d6a.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6a.iscfibroad2013_koodi = '07' or d7a.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7a.iscfibroad2013_koodi = '07' or d8a.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '1' and (d8a.iscfibroad2013_koodi = '07' or d9a.iscfibroad2013_koodi = '07') then 1*/
	else 0
end as opisk_amk_koulala7
--Opiskellut koulutusala8 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1a.iscfibroad2013_koodi = '08' or d2a.iscfibroad2013_koodi = '08') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2a.iscfibroad2013_koodi = '08' or d3a.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3a.iscfibroad2013_koodi = '08' or d4a.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4a.iscfibroad2013_koodi = '08' or d5a.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5a.iscfibroad2013_koodi = '08' or d6a.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6a.iscfibroad2013_koodi = '08' or d7a.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7a.iscfibroad2013_koodi = '08' or d8a.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '1' and (d8a.iscfibroad2013_koodi = '08' or d9a.iscfibroad2013_koodi = '08') then 1*/
	else 0
end as opisk_amk_koulala8
--Opiskellut koulutusala9 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1a.iscfibroad2013_koodi = '09' or d2a.iscfibroad2013_koodi = '09') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2a.iscfibroad2013_koodi = '09' or d3a.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3a.iscfibroad2013_koodi = '09' or d4a.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4a.iscfibroad2013_koodi = '09' or d5a.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5a.iscfibroad2013_koodi = '09' or d6a.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6a.iscfibroad2013_koodi = '09' or d7a.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7a.iscfibroad2013_koodi = '09' or d8a.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '1' and (d8a.iscfibroad2013_koodi = '09' or d9a.iscfibroad2013_koodi = '09') then 1*/
	else 0
end as opisk_amk_koulala9
--Opiskellut koulutusala10 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1a.iscfibroad2013_koodi = '10' or d2a.iscfibroad2013_koodi = '10') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2a.iscfibroad2013_koodi = '10' or d3a.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3a.iscfibroad2013_koodi = '10' or d4a.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4a.iscfibroad2013_koodi = '10' or d5a.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5a.iscfibroad2013_koodi = '10' or d6a.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6a.iscfibroad2013_koodi = '10' or d7a.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7a.iscfibroad2013_koodi = '10' or d8a.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '1' and (d8a.iscfibroad2013_koodi = '10' or d9a.iscfibroad2013_koodi = '10') then 1*/
	else 0
end as opisk_amk_koulala10




--Opiskellut koulutusala1 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1b.iscfibroad2013_koodi = '01' or d2b.iscfibroad2013_koodi = '01') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2b.iscfibroad2013_koodi = '01' or d3b.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3b.iscfibroad2013_koodi = '01' or d4b.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4b.iscfibroad2013_koodi = '01' or d5b.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5b.iscfibroad2013_koodi = '01' or d6b.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6b.iscfibroad2013_koodi = '01' or d7b.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7b.iscfibroad2013_koodi = '01' or d8b.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '1' and (d8b.iscfibroad2013_koodi = '01' or d9b.iscfibroad2013_koodi = '01') then 1*/
	else 0
end as opisk_yo_koulala1
--Opiskellut koulutusala2 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1b.iscfibroad2013_koodi = '02' or d2b.iscfibroad2013_koodi = '02') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2b.iscfibroad2013_koodi = '02' or d3b.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3b.iscfibroad2013_koodi = '02' or d4b.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4b.iscfibroad2013_koodi = '02' or d5b.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5b.iscfibroad2013_koodi = '02' or d6b.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6b.iscfibroad2013_koodi = '02' or d7b.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7b.iscfibroad2013_koodi = '02' or d8b.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '1' and (d8b.iscfibroad2013_koodi = '02' or d9b.iscfibroad2013_koodi = '02') then 1*/
	else 0
end as opisk_yo_koulala2
--Opiskellut koulutusala3 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1b.iscfibroad2013_koodi = '03' or d2b.iscfibroad2013_koodi = '03') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2b.iscfibroad2013_koodi = '03' or d3b.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3b.iscfibroad2013_koodi = '03' or d4b.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4b.iscfibroad2013_koodi = '03' or d5b.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5b.iscfibroad2013_koodi = '03' or d6b.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6b.iscfibroad2013_koodi = '03' or d7b.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7b.iscfibroad2013_koodi = '03' or d8b.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '1' and (d8b.iscfibroad2013_koodi = '03' or d9b.iscfibroad2013_koodi = '03') then 1*/
	else 0
end as opisk_yo_koulala3
--Opiskellut koulutusala4 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1b.iscfibroad2013_koodi = '04' or d2b.iscfibroad2013_koodi = '04') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2b.iscfibroad2013_koodi = '04' or d3b.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3b.iscfibroad2013_koodi = '04' or d4b.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4b.iscfibroad2013_koodi = '04' or d5b.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5b.iscfibroad2013_koodi = '04' or d6b.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6b.iscfibroad2013_koodi = '04' or d7b.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7b.iscfibroad2013_koodi = '04' or d8b.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '1' and (d8b.iscfibroad2013_koodi = '04' or d9b.iscfibroad2013_koodi = '04') then 1*/
	else 0
end as opisk_yo_koulala4
--Opiskellut koulutusala5 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1b.iscfibroad2013_koodi = '05' or d2b.iscfibroad2013_koodi = '05') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2b.iscfibroad2013_koodi = '05' or d3b.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3b.iscfibroad2013_koodi = '05' or d4b.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4b.iscfibroad2013_koodi = '05' or d5b.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5b.iscfibroad2013_koodi = '05' or d6b.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6b.iscfibroad2013_koodi = '05' or d7b.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7b.iscfibroad2013_koodi = '05' or d8b.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '1' and (d8b.iscfibroad2013_koodi = '05' or d9b.iscfibroad2013_koodi = '05') then 1*/
	else 0
end as opisk_yo_koulala5
--Opiskellut koulutusala6 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1b.iscfibroad2013_koodi = '06' or d2b.iscfibroad2013_koodi = '06') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2b.iscfibroad2013_koodi = '06' or d3b.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3b.iscfibroad2013_koodi = '06' or d4b.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4b.iscfibroad2013_koodi = '06' or d5b.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5b.iscfibroad2013_koodi = '06' or d6b.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6b.iscfibroad2013_koodi = '06' or d7b.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7b.iscfibroad2013_koodi = '06' or d8b.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '1' and (d8b.iscfibroad2013_koodi = '06' or d9b.iscfibroad2013_koodi = '06') then 1*/
	else 0
end as opisk_yo_koulala6
--Opiskellut koulutusala7 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1b.iscfibroad2013_koodi = '07' or d2b.iscfibroad2013_koodi = '07') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2b.iscfibroad2013_koodi = '07' or d3b.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3b.iscfibroad2013_koodi = '07' or d4b.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4b.iscfibroad2013_koodi = '07' or d5b.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5b.iscfibroad2013_koodi = '07' or d6b.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6b.iscfibroad2013_koodi = '07' or d7b.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7b.iscfibroad2013_koodi = '07' or d8b.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '1' and (d8b.iscfibroad2013_koodi = '07' or d9b.iscfibroad2013_koodi = '07') then 1*/
	else 0
end as opisk_yo_koulala7
--Opiskellut koulutusala8 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1b.iscfibroad2013_koodi = '08' or d2b.iscfibroad2013_koodi = '08') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2b.iscfibroad2013_koodi = '08' or d3b.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3b.iscfibroad2013_koodi = '08' or d4b.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4b.iscfibroad2013_koodi = '08' or d5b.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5b.iscfibroad2013_koodi = '08' or d6b.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6b.iscfibroad2013_koodi = '08' or d7b.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7b.iscfibroad2013_koodi = '08' or d8b.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '1' and (d8b.iscfibroad2013_koodi = '08' or d9b.iscfibroad2013_koodi = '08') then 1*/
	else 0
end as opisk_yo_koulala8
--Opiskellut koulutusala9 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1b.iscfibroad2013_koodi = '09' or d2b.iscfibroad2013_koodi = '09') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2b.iscfibroad2013_koodi = '09' or d3b.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3b.iscfibroad2013_koodi = '09' or d4b.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4b.iscfibroad2013_koodi = '09' or d5b.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5b.iscfibroad2013_koodi = '09' or d6b.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6b.iscfibroad2013_koodi = '09' or d7b.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7b.iscfibroad2013_koodi = '09' or d8b.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '1' and (d8b.iscfibroad2013_koodi = '09' or d9b.iscfibroad2013_koodi = '09') then 1*/
	else 0
end as opisk_yo_koulala9
--Opiskellut koulutusala10 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1b.iscfibroad2013_koodi = '10' or d2b.iscfibroad2013_koodi = '10') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2b.iscfibroad2013_koodi = '10' or d3b.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3b.iscfibroad2013_koodi = '10' or d4b.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4b.iscfibroad2013_koodi = '10' or d5b.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5b.iscfibroad2013_koodi = '10' or d6b.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6b.iscfibroad2013_koodi = '10' or d7b.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7b.iscfibroad2013_koodi = '10' or d8b.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '1' and (d8b.iscfibroad2013_koodi = '10' or d9b.iscfibroad2013_koodi = '10') then 1*/
	else 0
end as opisk_yo_koulala10


--Opiskellut useampaa kuin yhtä alaa (taso 1) (kyllä/ei)
,case --ensimmäisenä vuotena on mahdollista olla vain yksi ala
	when  l.suorlk = '1' and m1.MinValue <> m1.MaxValue then 1 
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and m2.MinValue <> m2.MaxValue then 1 
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and m3.MinValue <> m3.MaxValue then 1 
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and m4.MinValue <> m4.MaxValue then 1 
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and m5.MinValue <> m5.MaxValue then 1 
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and m6.MinValue <> m6.MaxValue then 1 
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and m7.MinValue <> m7.MaxValue then 1 
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '1' and m8.MinValue <> m8.MaxValue then 1 */
	else 0
end as opisk_vah2_koulala


----HAUT KYLLÄ/EI
--Hakenut ammatilliseen koulutukseen
,case
	when  l.suorlk = '1' and (l.monihaku_1 in (2,3,5) or l.monihaku_2 in (2,3,5)) then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.monihaku_2 in (2,3,5) or l.monihaku2010 in (2,3,5)) then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.monihaku2010 in (2,3,5) or l.monihaku2011 in (2,3,5)) then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.monihaku2011 in (2,3,5) or l.monihaku2012 in (2,3,5)) then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.monihaku2012 in (2,3,5) or l.monihaku2013 in (2,3,5)) then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.monihaku2013 in (2,3,5) or l.monihaku2014 in (2,3,5)) then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.monihaku2014 in (2,3,5) or l.monihaku2015 in (2,3,5)) then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '1' and (l.monihaku2015 in (2,3,5) or l.monihaku2016 in (2,3,5)) then 1*/
	else 0
end as haku_amm
--Hakenut ammattikorkeakoulutukseen
,case
	when  l.suorlk = '1' and (l.monihaku_1 in (4,6) or l.monihaku_2 in (4,6)) then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.monihaku_2 in (4,6) or l.monihaku2010 in (4,6)) then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.monihaku2010 in (4,6) or l.monihaku2011 in (4,6)) then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.monihaku2011 in (4,6) or l.monihaku2012 in (4,6)) then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.monihaku2012 in (4,6) or l.monihaku2013 in (4,6)) then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.monihaku2013 in (4,6) or l.monihaku2014 in (4,6)) then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.monihaku2014 in (4,6) or l.monihaku2015 in (4,6)) then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '1' and (l.monihaku2015 in (4,6) or l.monihaku2016 in (4,6)) then 1*/
	else 0
end as haku_amk
--Hakenut yliopistokoulutukseen
,case
	when  l.suorlk = '1' and (l.monihaku_1 in (6,7) or l.monihaku_2 in (6,7)) then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.monihaku_2 in (6,7) or l.monihaku2010 in (6,7)) then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.monihaku2010 in (6,7) or l.monihaku2011 in (6,7)) then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.monihaku2011 in (6,7) or l.monihaku2012 in (6,7)) then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.monihaku2012 in (6,7) or l.monihaku2013 in (6,7)) then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.monihaku2013 in (6,7) or l.monihaku2014 in (6,7)) then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.monihaku2014 in (6,7) or l.monihaku2015 in (6,7)) then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '1' and (l.monihaku2015 in (6,7) or l.monihaku2016 in (6,7)) then 1*/
	else 0
end as haku_yo




----MITTARIT
,case
	when  l.suorlk = '1' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and l.luopiskkoulk_1 = '' and l.ammopiskkoulk_1 = '' and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and monihaku_2 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and monihaku2013 not in (4,5,6,7) and monihaku2014 not in (4,5,6,7) and l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and monihaku2014 not in (4,5,6,7) and monihaku2015 not in (4,5,6,7) and l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' and l.luopiskkoulk2015 = '' and l.ammopiskkoulk2015 = '' and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '1' and monihaku2015 not in (4,5,6,7) and monihaku2016 not in (4,5,6,7) and l.luopiskkoulk2015 = '' and l.ammopiskkoulk2015 = '' and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' and l.luopiskkoulk2016 = '' and l.ammopiskkoulk2016 = '' and l.amkopiskkoulk2016 = '' and l.yoopiskkoulk2016 = '' then 1*/
	else 0
end eihaku_kk_eiopisk

--Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa
,case 
	when  l.suorlk = '1' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and (l.luopiskkoulk_1 <> '' or l.ammopiskkoulk_1 <> '' or l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and monihaku_2 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and (l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and (l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and (l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '') and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and (l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '' or l.ammopiskkoulk2013 <> '') and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and monihaku2013 not in (4,5,6,7) and monihaku2014 not in (4,5,6,7) and (l.luopiskkoulk2013 <> '' or l.ammopiskkoulk2013 <> '' or l.luopiskkoulk2014 <> '' or l.ammopiskkoulk2014 <> '') and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and monihaku2014 not in (4,5,6,7) and monihaku2015 not in (4,5,6,7) and (l.luopiskkoulk2014 <> '' or l.ammopiskkoulk2014 <> '' or l.luopiskkoulk2015 <> '' or l.ammopiskkoulk2015 <> '') and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '1' and monihaku2015 not in (4,5,6,7) and monihaku2016 not in (4,5,6,7) and (l.luopiskkoulk2015 <> '' or l.ammopiskkoulk2015 <> '' or l.luopiskkoulk2016 <> '' or l.ammopiskkoulk2016 <> '') and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' and l.amkopiskkoulk2016 = '' and l.yoopiskkoulk2016 = '' then 1*/
	else 0
end eihaku_kk_eiopisk_kk_opisk_ta

----Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa, opiskellut lukiokoulutuksessa
,case 
	when  l.suorlk = '1' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and (l.luopiskkoulk_1 <> '' or l.luopiskkoulk_2 <> '') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = ''  then 1
/*--	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and monihaku_2 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and (l.luopiskkoulk_2 <> '' or l.luopiskkoulk2010 <> '') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
--	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and (l.luopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
--	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and (l.luopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '') and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
--	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and (l.luopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '') and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and monihaku2013 not in (4,5,6,7) and monihaku2014 not in (4,5,6,7) and (l.luopiskkoulk2013 <> '' or l.luopiskkoulk2014 <> '') and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and monihaku2014 not in (4,5,6,7) and monihaku2015 not in (4,5,6,7) and (l.luopiskkoulk2014 <> '' or l.luopiskkoulk2015 <> '') and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '1' and monihaku2015 not in (4,5,6,7) and monihaku2016 not in (4,5,6,7) and (l.luopiskkoulk2015 <> '' or l.luopiskkoulk2016 <> '') and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' and l.amkopiskkoulk2016 = '' and l.yoopiskkoulk2016 = '' then 1*/
	else 0
end eihaku_kk_eiopisk_kk_opisk_lu

----Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa, opiskellut ammatillisessa peruskoulutuksessa
,case 
	when  l.suorlk = '1' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and (l.ammopiskkoulk_1 <> '' or l.ammopiskkoulk_2 <> '') and (d1c.Koulutusaste_taso2_koodi = '32' or d2c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and monihaku_2 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and (l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk2010 <> '') and (d2c.Koulutusaste_taso2_koodi = '32' or d3c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and (l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '') and (d3c.Koulutusaste_taso2_koodi = '32' or d4c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and (l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '') and (d4c.Koulutusaste_taso2_koodi = '32' or d5c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and (l.ammopiskkoulk2012 <> '' or l.ammopiskkoulk2013 <> '') and (d5c.Koulutusaste_taso2_koodi = '32' or d6c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and monihaku2013 not in (4,5,6,7) and monihaku2014 not in (4,5,6,7) and (l.ammopiskkoulk2013 <> '' or l.ammopiskkoulk2014 <> '') and (d6c.Koulutusaste_taso2_koodi = '32' or d7c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and monihaku2014 not in (4,5,6,7) and monihaku2015 not in (4,5,6,7) and (l.ammopiskkoulk2014 <> '' or l.ammopiskkoulk2015 <> '') and (d7c.Koulutusaste_taso2_koodi = '32' or d8c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '1' and monihaku2015 not in (4,5,6,7) and monihaku2016 not in (4,5,6,7) and (l.ammopiskkoulk2015 <> '' or l.ammopiskkoulk2016 <> '') and (d7c.Koulutusaste_taso2_koodi = '32' or d8c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' and l.amkopiskkoulk2016 = '' and l.yoopiskkoulk2016 = '' then 1*/
	else 0
end eihaku_kk_eiopisk_kk_opisk_pk

------Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa, opiskellut ammattitutkintokoulutuksessa
,case 
	when  l.suorlk = '1' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and (l.ammopiskkoulk_1 <> '' or l.ammopiskkoulk_2 <> '') and (d1c.Koulutusaste_taso2_koodi = '33' or d2c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and monihaku_2 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and (l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk2010 <> '') and (d2c.Koulutusaste_taso2_koodi = '33' or d3c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and (l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '') and (d3c.Koulutusaste_taso2_koodi = '33' or d4c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and (l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '') and (d4c.Koulutusaste_taso2_koodi = '33' or d5c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and (l.ammopiskkoulk2012 <> '' or l.ammopiskkoulk2013 <> '') and (d5c.Koulutusaste_taso2_koodi = '33' or d6c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and monihaku2013 not in (4,5,6,7) and monihaku2014 not in (4,5,6,7) and (l.ammopiskkoulk2013 <> '' or l.ammopiskkoulk2014 <> '') and (d6c.Koulutusaste_taso2_koodi = '33' or d7c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and monihaku2014 not in (4,5,6,7) and monihaku2015 not in (4,5,6,7) and (l.ammopiskkoulk2014 <> '' or l.ammopiskkoulk2015 <> '') and (d7c.Koulutusaste_taso2_koodi = '33' or d8c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '1' and monihaku2015 not in (4,5,6,7) and monihaku2016 not in (4,5,6,7) and (l.ammopiskkoulk2015 <> '' or l.ammopiskkoulk2016 <> '') and (d7c.Koulutusaste_taso2_koodi = '33' or d8c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' and l.amkopiskkoulk2016 = '' and l.yoopiskkoulk2016 = '' then 1*/
	else 0
end eihaku_kk_eiopisk_kk_opisk_at

------Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa, opiskellut erikoisammattitutkintokoulutuksessa
,case 
	when  l.suorlk = '1' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and (l.ammopiskkoulk_1 <> '' or l.ammopiskkoulk_2 <> '') and (d1c.Koulutusaste_taso2_koodi = '41' or d2c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and monihaku_2 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and (l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk2010 <> '') and (d2c.Koulutusaste_taso2_koodi = '41' or d3c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and (l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '') and (d3c.Koulutusaste_taso2_koodi = '41' or d4c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and (l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '') and (d4c.Koulutusaste_taso2_koodi = '41' or d5c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and (l.ammopiskkoulk2012 <> '' or l.ammopiskkoulk2013 <> '') and (d5c.Koulutusaste_taso2_koodi = '41' or d6c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and monihaku2013 not in (4,5,6,7) and monihaku2014 not in (4,5,6,7) and (l.ammopiskkoulk2013 <> '' or l.ammopiskkoulk2014 <> '') and (d6c.Koulutusaste_taso2_koodi = '41' or d7c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and monihaku2014 not in (4,5,6,7) and monihaku2015 not in (4,5,6,7) and (l.ammopiskkoulk2014 <> '' or l.ammopiskkoulk2015 <> '') and (d7c.Koulutusaste_taso2_koodi = '41' or d8c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '1' and monihaku2015 not in (4,5,6,7) and monihaku2016 not in (4,5,6,7) and (l.ammopiskkoulk2015 <> '' or l.ammopiskkoulk2016 <> '') and (d7c.Koulutusaste_taso2_koodi = '41' or d8c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' and l.amkopiskkoulk2016 = '' and l.yoopiskkoulk2016 = '' then 1*/
	else 0
end eihaku_kk_eiopisk_kk_opisk_eat

--Hakenut korkea-asteelle, ei opiskellut korkea-asteella
,case 
	when  l.suorlk = '1' and (monihaku_1 in (4,5,6,7) or monihaku_2 in (4,5,6,7)) and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (monihaku_2 in (4,5,6,7) or monihaku2010 in (4,5,6,7)) and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7)) and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (monihaku2011 in (4,5,6,7) or monihaku2012 in (4,5,6,7)) and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (monihaku2012 in (4,5,6,7) or monihaku2013 in (4,5,6,7)) and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (monihaku2013 in (4,5,6,7) or monihaku2014 in (4,5,6,7)) and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (monihaku2014 in (4,5,6,7) or monihaku2015 in (4,5,6,7)) and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '1' and (monihaku2015 in (4,5,6,7) or monihaku2016 in (4,5,6,7)) and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' and l.amkopiskkoulk2016 = '' and l.yoopiskkoulk2016 = '' then 1*/
	else 0
end haku_kk_eiopisk_kk
----Hakenut korkea-asteelle, ei opiskellut korkea-asteella, ei-opiskellut toisen asteen koulutuksessa
,case
	when  l.suorlk = '1' and (monihaku_1 in (4,5,6,7) or monihaku_2 in (4,5,6,7)) and l.luopiskkoulk_1 = '' and l.ammopiskkoulk_1 = '' and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (monihaku_2 in (4,5,6,7) or monihaku2010 in (4,5,6,7)) and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7)) and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (monihaku2011 in (4,5,6,7) or monihaku2012 in (4,5,6,7)) and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (monihaku2012 in (4,5,6,7) or monihaku2013 in (4,5,6,7)) and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (monihaku2013 in (4,5,6,7) or monihaku2014 in (4,5,6,7)) and l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (monihaku2014 in (4,5,6,7) or monihaku2015 in (4,5,6,7)) and l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' and l.luopiskkoulk2015 = '' and l.ammopiskkoulk2015 = '' and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '1' and (monihaku2015 in (4,5,6,7) or monihaku2016 in (4,5,6,7)) and l.luopiskkoulk2015 = '' and l.ammopiskkoulk2015 = '' and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' and l.luopiskkoulk2016 = '' and l.ammopiskkoulk2016 = '' and l.amkopiskkoulk2016 = '' and l.yoopiskkoulk2016 = '' then 1*/
	else 0
end haku_kk_eiopisk_kk_eiopisk_ta
----Hakenut korkea-asteelle, ei opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa
,case
	when  l.suorlk = '1' and (monihaku_1 in (4,5,6,7) or monihaku_2 in (4,5,6,7)) and (l.luopiskkoulk_1 <> '' or l.ammopiskkoulk_1 <> '' or l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (monihaku_2 in (4,5,6,7) or monihaku2010 in (4,5,6,7)) and (l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7)) and (l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (monihaku2011 in (4,5,6,7) or monihaku2012 in (4,5,6,7)) and (l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '') and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (monihaku2012 in (4,5,6,7) or monihaku2013 in (4,5,6,7)) and (l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '' or l.ammopiskkoulk2013 <> '') and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (monihaku2013 in (4,5,6,7) or monihaku2014 in (4,5,6,7)) and (l.luopiskkoulk2013 <> '' or l.ammopiskkoulk2013 <> '' or l.luopiskkoulk2014 <> '' or l.ammopiskkoulk2014 <> '') and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (monihaku2014 in (4,5,6,7) or monihaku2015 in (4,5,6,7)) and (l.luopiskkoulk2014 <> '' or l.ammopiskkoulk2014 <> '' or l.luopiskkoulk2015 <> '' or l.ammopiskkoulk2015 <> '') and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '1' and (monihaku2015 in (4,5,6,7) or monihaku2016 in (4,5,6,7)) and (l.luopiskkoulk2015 <> '' or l.ammopiskkoulk2015 <> '' or l.luopiskkoulk2016 <> '' or l.ammopiskkoulk2016 <> '') and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' and l.amkopiskkoulk2016 = '' and l.yoopiskkoulk2016 = '' then 1*/
	else 0
end haku_kk_eiopisk_kk_opisk_ta
----Hakenut vain ammattikorkeakouluun, ei opiskellut korkea-asteella
,case
	when  l.suorlk = '1' and (monihaku_1 = 4 or monihaku_2 = 4) and (monihaku_1 not in (5,6,7) and monihaku_2 not in (5,6,7)) and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (monihaku_2 = 4 or monihaku2010 = 4) and (monihaku_2 not in (5,6,7) and monihaku2010 not in (5,6,7)) and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (monihaku2010 = 4 or monihaku2011 = 4) and (monihaku2010 not in (5,6,7) and monihaku2011 not in (5,6,7)) and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (monihaku2011 = 4 or monihaku2012 = 4) and (monihaku2011 not in (5,6,7) and monihaku2012 not in (5,6,7)) and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (monihaku2012 = 4 or monihaku2013 = 4) and (monihaku2012 not in (5,6,7) and monihaku2013 not in (5,6,7)) and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (monihaku2013 = 4 or monihaku2014 = 4) and (monihaku2013 not in (5,6,7) and monihaku2014 not in (5,6,7)) and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (monihaku2014 = 4 or monihaku2015 = 4) and (monihaku2014 not in (5,6,7) and monihaku2015 not in (5,6,7)) and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '1' and (monihaku2015 = 4 or monihaku2016 = 4) and (monihaku2015 not in (5,6,7) and monihaku2016 not in (5,6,7)) and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' and l.amkopiskkoulk2016 = '' and l.yoopiskkoulk2016 = '' then 1*/
	else 0
end haku_amk_eiopisk_kk
----Hakenut vain yliopistokoulutukseen, ei opiskellut korkea-asteella
,case
	when  l.suorlk = '1' and (monihaku_1 = 7 or monihaku_2 = 7) and (monihaku_1 not in (4,5,6) and monihaku_2 not in (4,5,6)) and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (monihaku_2 = 7 or monihaku2010 = 7) and (monihaku_2 not in (4,5,6) and monihaku2010 not in (4,5,6)) and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (monihaku2010 = 7 or monihaku2011 = 7) and (monihaku2010 not in (4,5,6) and monihaku2011 not in (4,5,6)) and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (monihaku2011 = 7 or monihaku2012 = 7) and (monihaku2011 not in (4,5,6) and monihaku2012 not in (4,5,6)) and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (monihaku2012 = 7 or monihaku2013 = 7) and (monihaku2012 not in (4,5,6) and monihaku2013 not in (4,5,6)) and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (monihaku2013 = 7 or monihaku2014 = 7) and (monihaku2013 not in (4,5,6) and monihaku2014 not in (4,5,6)) and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (monihaku2014 = 7 or monihaku2015 = 7) and (monihaku2014 not in (4,5,6) and monihaku2015 not in (4,5,6)) and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '1' and (monihaku2015 = 7 or monihaku2016 = 7) and (monihaku2015 not in (4,5,6) and monihaku2016 not in (4,5,6)) and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' and l.amkopiskkoulk2016 = '' and l.yoopiskkoulk2016 = '' then 1*/
	else 0
end haku_yo_eiopisk_kk
----Hakenut sekä amk- että yliopistokoulutukseen, ei opiskellut korkea-asteella
,case
	when  l.suorlk = '1' and (monihaku_1 = 6 or monihaku_2 = 6 or ((monihaku_1 = 4 or monihaku_2 = 4) and (monihaku_1 = 7 or monihaku_2 = 7))) and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (monihaku_2 = 6 or monihaku2010 = 6 or ((monihaku_2 = 4 or monihaku2010 = 4) and (monihaku_2 = 7 or monihaku2010 = 7))) and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (monihaku2010 = 6 or monihaku2011 = 6 or ((monihaku2010 = 4 or monihaku2011 = 4) and (monihaku2010 = 7 or monihaku2011 = 7))) and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (monihaku2011 = 6 or monihaku2012 = 6 or ((monihaku2011 = 4 or monihaku2012 = 4) and (monihaku2011 = 7 or monihaku2012 = 7))) and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (monihaku2012 = 6 or monihaku2013 = 6 or ((monihaku2012 = 4 or monihaku2013 = 4) and (monihaku2012 = 7 or monihaku2013 = 7))) and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (monihaku2013 = 6 or monihaku2014 = 6 or ((monihaku2013 = 4 or monihaku2014 = 4) and (monihaku2013 = 7 or monihaku2014 = 7))) and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (monihaku2014 = 6 or monihaku2015 = 6 or ((monihaku2014 = 4 or monihaku2015 = 4) and (monihaku2014 = 7 or monihaku2015 = 7))) and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '1' and (monihaku2015 = 6 or monihaku2016 = 6 or ((monihaku2015 = 4 or monihaku2016 = 4) and (monihaku2015 = 7 or monihaku2016 = 7))) and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' and l.amkopiskkoulk2016 = '' and l.yoopiskkoulk2016 = '' then 1*/
	else 0
end haku_amkyo_eiopisk_kk

--Opiskellut korkea-asteella
,case
	when  l.suorlk = '1' and (l.amkopiskkoulk_1 <> '' or l.yoopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '' or l.yoopiskkoulk2013 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2013 <> '' or l.yoopiskkoulk2013 <> '' or l.amkopiskkoulk2014 <> '' or l.yoopiskkoulk2014 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2014 <> '' or l.yoopiskkoulk2014 <> '' or l.amkopiskkoulk2015 <> '' or l.yoopiskkoulk2015 <> '') then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2015 <> '' or l.yoopiskkoulk2015 <> '' or l.amkopiskkoulk2016 <> '' or l.yoopiskkoulk2016 <> '') then 1*/
	else 0
end opisk_kk
----Opiskellut korkea-asteella, ei-opiskellut toisen asteen koulutuksessa
,case
	when  l.suorlk = '1' and l.luopiskkoulk_1 = '' and l.ammopiskkoulk_1 = '' and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and (l.amkopiskkoulk_1 <> '' or l.yoopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and (l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and (l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and (l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = '' and (l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '' or l.yoopiskkoulk2013 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = '' and l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 = '' and (l.amkopiskkoulk2013 <> '' or l.yoopiskkoulk2013 <> '' or l.amkopiskkoulk2014 <> '' or l.yoopiskkoulk2014 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 = '' and l.luopiskkoulk2015 = '' and l.ammopiskkoulk2015 = '' and (l.amkopiskkoulk2014 <> '' or l.yoopiskkoulk2014 <> '' or l.amkopiskkoulk2015 <> '' or l.yoopiskkoulk2015 <> '') then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '1' and l.luopiskkoulk2015 = '' and l.ammopiskkoulk2015 = '' and l.luopiskkoulk2016 = '' and l.ammopiskkoulk2016 = '' and (l.amkopiskkoulk2015 <> '' or l.yoopiskkoulk2015 <> '' or l.amkopiskkoulk2016 <> '' or l.yoopiskkoulk2016 <> '') then 1*/
	else 0
end opisk_kk_eiopisk_ta
----Opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa
,case
	when  l.suorlk = '1' and (l.luopiskkoulk_1 <> '' or l.ammopiskkoulk_1 <> '' or l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '') and (l.amkopiskkoulk_1 <> '' or l.yoopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '') and (l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '') and (l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '') and (l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '' or l.ammopiskkoulk2013 <> '') and (l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '' or l.yoopiskkoulk2013 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk2013 <> '' or l.ammopiskkoulk2013 <> '' or l.luopiskkoulk2014 <> '' or l.ammopiskkoulk2014 <> '') and (l.amkopiskkoulk2013 <> '' or l.yoopiskkoulk2013 <> '' or l.amkopiskkoulk2014 <> '' or l.yoopiskkoulk2014 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk2014 <> '' or l.ammopiskkoulk2014 <> '' or l.luopiskkoulk2015 <> '' or l.ammopiskkoulk2015 <> '') and (l.amkopiskkoulk2014 <> '' or l.yoopiskkoulk2014 <> '' or l.amkopiskkoulk2015 <> '' or l.yoopiskkoulk2015 <> '') then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk2015 <> '' or l.ammopiskkoulk2015 <> '' or l.luopiskkoulk2016 <> '' or l.ammopiskkoulk2016 <> '') and (l.amkopiskkoulk2015 <> '' or l.yoopiskkoulk2015 <> '' or l.amkopiskkoulk2016 <> '' or l.yoopiskkoulk2016 <> '') then 1*/
	else 0
end opisk_kk_opisk_ta
----Opiskellut vain ammattikorkeakoulussa
,case
	when  l.suorlk = '1' and (l.amkopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '') and l.yoopiskkoulk_1 = '' and l.yoopiskkoulk_2 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk_2 <> '' or l.amkopiskkoulk2010 <> '') and l.yoopiskkoulk_2 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '') and l.yoopiskkoulk2010 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '') and l.yoopiskkoulk2011 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '') and l.yoopiskkoulk2012 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2013 <> '' or l.amkopiskkoulk2014 <> '') and l.yoopiskkoulk2013 = '' and l.yoopiskkoulk2014 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2014 <> '' or l.amkopiskkoulk2015 <> '') and l.yoopiskkoulk2014 = '' and l.yoopiskkoulk2015 = '' then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2015 <> '' or l.amkopiskkoulk2016 <> '') and l.yoopiskkoulk2015 = '' and l.yoopiskkoulk2016 = '' then 1*/
	else 0
end opisk_vain_amk
----Opiskellut vain yliopistokoulutuksessa
,case
	when  l.suorlk = '1' and l.amkopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and (l.yoopiskkoulk_1 <> '' or l.yoopiskkoulk_2 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and l.amkopiskkoulk_2 = '' and l.amkopiskkoulk2010 = '' and (l.yoopiskkoulk_2 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and l.amkopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and (l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and l.amkopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and (l.yoopiskkoulk2011 <> '' or l.yoopiskkoulk2012 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and l.amkopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and (l.yoopiskkoulk2012 <> '' or l.yoopiskkoulk2013 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and l.amkopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and (l.yoopiskkoulk2013 <> '' or l.yoopiskkoulk2014 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and l.amkopiskkoulk2014 = '' and l.amkopiskkoulk2015 = '' and (l.yoopiskkoulk2014 <> '' or l.yoopiskkoulk2015 <> '') then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '1' and l.amkopiskkoulk2015 = '' and l.amkopiskkoulk2016 = '' and (l.yoopiskkoulk2015 <> '' or l.yoopiskkoulk2016 <> '') then 1*/
	else 0
end opisk_vain_yo
----Opiskellut sekä amk- että yliopistokoulutuksessa
,case
	when  l.suorlk = '1' and (l.amkopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '') and (l.yoopiskkoulk_1 <> '' or l.yoopiskkoulk_2 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk_2 <> '' or l.amkopiskkoulk2010 <> '') and (l.yoopiskkoulk_2 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '') and (l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '') and (l.yoopiskkoulk2011 <> '' or l.yoopiskkoulk2012 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '') and (l.yoopiskkoulk2012 <> '' or l.yoopiskkoulk2013 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2013 <> '' or l.amkopiskkoulk2014 <> '') and (l.yoopiskkoulk2013 <> '' or l.yoopiskkoulk2014 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2014 <> '' or l.amkopiskkoulk2015 <> '') and (l.yoopiskkoulk2014 <> '' or l.yoopiskkoulk2015 <> '') then 1
	when l.suorv = @kahdeksas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2015 <> '' or l.amkopiskkoulk2016 <> '') and (l.yoopiskkoulk2015 <> '' or l.yoopiskkoulk2016 <> '') then 1*/
	else 0
end opisk_amkyo


FROM 
    (
	select * from [VipunenTK_SA].[dbo].[v_K3_12_Perusk_paattaneet_amm_tutk_suorittaneet]
	where suorlk = '1'
	) as l

INNER JOIN VipunenTK.dbo.d_koulutusluokitus d1a on d1a.koulutusluokitus_avain=COALESCE(NULLIF(l.amkopiskkoulk_1,''),'-1')
INNER JOIN VipunenTK.dbo.d_koulutusluokitus d2a on d2a.koulutusluokitus_avain=COALESCE(NULLIF(l.amkopiskkoulk_2,''),'-1')
/*INNER JOIN VipunenTK.dbo.d_koulutusluokitus d2a on d2a.koulutusluokitus_avain=COALESCE(NULLIF(l.amkopiskkoulk2009,''),'-1')
INNER JOIN VipunenTK.dbo.d_koulutusluokitus d3a on d3a.koulutusluokitus_avain=COALESCE(NULLIF(l.amkopiskkoulk2010,''),'-1')
INNER JOIN VipunenTK.dbo.d_koulutusluokitus d4a on d4a.koulutusluokitus_avain=COALESCE(NULLIF(l.amkopiskkoulk2011,''),'-1')
INNER JOIN VipunenTK.dbo.d_koulutusluokitus d5a on d5a.koulutusluokitus_avain=COALESCE(NULLIF(l.amkopiskkoulk2012,''),'-1')
INNER JOIN VipunenTK.dbo.d_koulutusluokitus d6a on d6a.koulutusluokitus_avain=COALESCE(NULLIF(l.amkopiskkoulk2013,''),'-1')
INNER JOIN VipunenTK.dbo.d_koulutusluokitus d7a on d7a.koulutusluokitus_avain=COALESCE(NULLIF(l.amkopiskkoulk2014,''),'-1')
INNER JOIN VipunenTK.dbo.d_koulutusluokitus d8a on d8a.koulutusluokitus_avain=COALESCE(NULLIF(l.amkopiskkoulk2015,''),'-1')*/

INNER JOIN VipunenTK.dbo.d_koulutusluokitus d1b on d1b.koulutusluokitus_avain=COALESCE(NULLIF(l.yoopiskkoulk_1,''),'-1')
INNER JOIN VipunenTK.dbo.d_koulutusluokitus d2b on d2b.koulutusluokitus_avain=COALESCE(NULLIF(l.yoopiskkoulk_2,''),'-1')
/*INNER JOIN VipunenTK.dbo.d_koulutusluokitus d2b on d2b.koulutusluokitus_avain=COALESCE(NULLIF(l.yoopiskkoulk2009,''),'-1')
INNER JOIN VipunenTK.dbo.d_koulutusluokitus d3b on d3b.koulutusluokitus_avain=COALESCE(NULLIF(l.yoopiskkoulk2010,''),'-1')
INNER JOIN VipunenTK.dbo.d_koulutusluokitus d4b on d4b.koulutusluokitus_avain=COALESCE(NULLIF(l.yoopiskkoulk2011,''),'-1')
INNER JOIN VipunenTK.dbo.d_koulutusluokitus d5b on d5b.koulutusluokitus_avain=COALESCE(NULLIF(l.yoopiskkoulk2012,''),'-1')
INNER JOIN VipunenTK.dbo.d_koulutusluokitus d6b on d6b.koulutusluokitus_avain=COALESCE(NULLIF(l.yoopiskkoulk2013,''),'-1')
INNER JOIN VipunenTK.dbo.d_koulutusluokitus d7b on d7b.koulutusluokitus_avain=COALESCE(NULLIF(l.yoopiskkoulk2014,''),'-1')
INNER JOIN VipunenTK.dbo.d_koulutusluokitus d8b on d8b.koulutusluokitus_avain=COALESCE(NULLIF(l.yoopiskkoulk2015,''),'-1')*/

INNER JOIN VipunenTK.dbo.d_koulutusluokitus d1c on d1c.koulutusluokitus_avain=COALESCE(NULLIF(l.ammopiskkoulk_1,''),'-1')
INNER JOIN VipunenTK.dbo.d_koulutusluokitus d2c on d2c.koulutusluokitus_avain=COALESCE(NULLIF(l.ammopiskkoulk_2,''),'-1')
/*INNER JOIN VipunenTK.dbo.d_koulutusluokitus d2c on d2c.koulutusluokitus_avain=COALESCE(NULLIF(l.ammopiskkoulk2009,''),'-1')
INNER JOIN VipunenTK.dbo.d_koulutusluokitus d3c on d3c.koulutusluokitus_avain=COALESCE(NULLIF(l.ammopiskkoulk2010,''),'-1')
INNER JOIN VipunenTK.dbo.d_koulutusluokitus d4c on d4c.koulutusluokitus_avain=COALESCE(NULLIF(l.ammopiskkoulk2011,''),'-1')
INNER JOIN VipunenTK.dbo.d_koulutusluokitus d5c on d5c.koulutusluokitus_avain=COALESCE(NULLIF(l.ammopiskkoulk2012,''),'-1')
INNER JOIN VipunenTK.dbo.d_koulutusluokitus d6c on d6c.koulutusluokitus_avain=COALESCE(NULLIF(l.ammopiskkoulk2013,''),'-1')
INNER JOIN VipunenTK.dbo.d_koulutusluokitus d7c on d7c.koulutusluokitus_avain=COALESCE(NULLIF(l.ammopiskkoulk2014,''),'-1')	
INNER JOIN VipunenTK.dbo.d_koulutusluokitus d8c on d8c.koulutusluokitus_avain=COALESCE(NULLIF(l.ammopiskkoulk2015,''),'-1')	*/

CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d1a.iscfibroad2013_koodi),(d1b.iscfibroad2013_koodi), (d2a.iscfibroad2013_koodi),(d2b.iscfibroad2013_koodi)) AS a(d)) m1
/*CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d2a.iscfibroad2013_koodi),(d2b.iscfibroad2013_koodi), (d3a.iscfibroad2013_koodi),(d3b.iscfibroad2013_koodi)) AS a(d)) m2
CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d3a.iscfibroad2013_koodi),(d3b.iscfibroad2013_koodi), (d4a.iscfibroad2013_koodi),(d4b.iscfibroad2013_koodi)) AS a(d)) m3
CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d4a.iscfibroad2013_koodi),(d4b.iscfibroad2013_koodi), (d5a.iscfibroad2013_koodi),(d5b.iscfibroad2013_koodi)) AS a(d)) m4
CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d5a.iscfibroad2013_koodi),(d5b.iscfibroad2013_koodi), (d6a.iscfibroad2013_koodi),(d6b.iscfibroad2013_koodi)) AS a(d)) m5
CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d6a.iscfibroad2013_koodi),(d6b.iscfibroad2013_koodi), (d7a.iscfibroad2013_koodi),(d7b.iscfibroad2013_koodi)) AS a(d)) m6
CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d7a.iscfibroad2013_koodi),(d7b.iscfibroad2013_koodi), (d8a.iscfibroad2013_koodi),(d8b.iscfibroad2013_koodi)) AS a(d)) m7
CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d8a.iscfibroad2013_koodi),(d8b.iscfibroad2013_koodi), (d9a.iscfibroad2013_koodi),(d9b.iscfibroad2013_koodi)) AS a(d)) m8*/

	WHERE 1=1
--end;

--
-- TULOS
-- 
/*if @debug_what_to_run>=3 begin
	if @debug_what_to_run>0 print 'querying result';
	select * from [VipunenTK_DW].[dbo].[_koulutukseen_sijoittuneet_2v]
	
end;

if @debug_what_to_run>0 PRINT 'all done.';*/


--GO




GO
/****** Object:  StoredProcedure [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_0__valittomasti_tarkastelujakso]    Script Date: 29.8.2018 15:59:41 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE PROCEDURE [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_0__valittomasti_tarkastelujakso] AS
/*declare @debug_what_to_run tinyint; set @debug_what_to_run=2; -- käytä arvoa 3 vain kun teet yhden vuoden
print '$'+convert(varchar,sysdatetime(),20)+'$ '+'DEBUG (what to run)='+cast(@debug_what_to_run as varchar)+
': 0=luo vain taulut, älä tulosta mitään; 1=luo taulut ja tulosta joitakin merkittävimpiä välivaiheita; 2=luo taulut ja tulosta välivaiheet; 3=luo taulut, tulosta välivaiheet ja tulosta myös tulokset, 4=tulosta välivaiheet, mutta älä tee mitään';




-- lisätään data
if @debug_what_to_run not in (4) begin
if @debug_what_to_run>0 print 'inserting data';

-- parametrimuuttujien arvot
-- parametrimuuttujat
DECLARE @ensimmainen_suoritusvuosi int;
DECLARE @toinen_suoritusvuosi int;
DECLARE @kolmas_suoritusvuosi int;
DECLARE @neljas_suoritusvuosi int;
DECLARE @viides_suoritusvuosi int;
DECLARE @kuudes_suoritusvuosi int;
DECLARE @seitsemas_suoritusvuosi int;


set @ensimmainen_suoritusvuosi = _1;
set @toinen_suoritusvuosi = 2005;
set @kolmas_suoritusvuosi = 2006;
set @neljas_suoritusvuosi = 2007;
set @viides_suoritusvuosi = 2008;
set @kuudes_suoritusvuosi = 2009;
set @seitsemas_suoritusvuosi = 2010;

*/

INSERT INTO [VipunenTK_DW].[dbo].[_koulutukseen_sijoittuneet_6v_tarkastelu]
(
rivinumero
, tarkastelujakso
, tilv 
, tilv_date
, tutkryh 
, suorv
, suorlk 
, sp 
, syntv
, aikielir1 
, tutkkaskun 
, kansalr1
, pohjmaa 
, eumaa 
, etamaa 
, tunn
, jarj
, kkielir1 
, tutklaja 
, tutktav 
, aikoul 
, tutkmaak
, koulutus_1
, oppilaitos_1
, koulutuksen_jarjestaja_1
, koulutuksen_maakunta_1
, koulutus_2
, oppilaitos_2
, koulutuksen_jarjestaja_2
, koulutuksen_maakunta_2
, monihaku
, paaasiallinen_toiminta
, ammattiasema
, lkm
, pohjkoulk
, tietolahde
, aineisto
, lukiokoulutuksessa
, ammatillisessa_koulutuksessa
, ammattikorkeakoulutuksessa
, yliopistokoulutuksessa
, lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa
, toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa
, ammattikorkeakoulutuksessa_ja_yliopistokoulutuksessa
, koulutuksen_paattaneiden_toiminta
, ika_1v
, ika_5v
, ika_1v_suorv
, opisk_lu
, opisk_amm_pk
, opisk_amm_at
, opisk_amm_eat
, opisk_amm
, opisk_amk
, opisk_yo
, opisk_amk_koulala1
, opisk_amk_koulala2
, opisk_amk_koulala3
, opisk_amk_koulala4
, opisk_amk_koulala5
, opisk_amk_koulala6
, opisk_amk_koulala7
, opisk_amk_koulala8
, opisk_amk_koulala9
, opisk_amk_koulala10
, opisk_yo_koulala1
, opisk_yo_koulala2
, opisk_yo_koulala3
, opisk_yo_koulala4
, opisk_yo_koulala5
, opisk_yo_koulala6
, opisk_yo_koulala7
, opisk_yo_koulala8
, opisk_yo_koulala9
, opisk_yo_koulala10
, opisk_vah2_koulala
, haku_amm
, haku_amk
, haku_yo
, eihaku_kk_eiopisk
, eihaku_kk_eiopisk_kk_opisk_ta
, eihaku_kk_eiopisk_kk_opisk_lu
, eihaku_kk_eiopisk_kk_opisk_pk
, eihaku_kk_eiopisk_kk_opisk_at
, eihaku_kk_eiopisk_kk_opisk_eat
, haku_kk_eiopisk_kk
, haku_kk_eiopisk_kk_eiopisk_ta
, haku_kk_eiopisk_kk_opisk_ta
, haku_amk_eiopisk_kk
, haku_yo_eiopisk_kk
, haku_amkyo_eiopisk_kk
, opisk_kk
, opisk_kk_eiopisk_ta
, opisk_kk_opisk_ta
, opisk_vain_amk
, opisk_vain_yo
, opisk_amkyo
)
SELECT
 l.rivinumero,
 '0',
 l.tilv,
 l.tilv_date,
 (case 
	when l.tutkryh=3 and tutklaja=1 then 31
	when l.tutkryh=3 and tutklaja=2 then 32
	when l.tutkryh=3 and tutklaja=3 then 33
	else l.tutkryh
  end),
 l.suorv,
  (case
	when l.suorlk = '1'  then (l.suorv+'0'+l.suorlk)
	when l.suorlk = '2'  then (l.suorv+'0'+'8')
	else ''
	end),
 l.sp,
 l.syntv,
 l.aikielir1,
 l.tutkaskun,
 l.kansalr1,
 l.pohjmaa,
 l.eumaa,
 l.etamaa,
 l.tunn,
 l.jarj,
 l.kkielir1,
 l.tutklaja,
 l.tutktav,
 l.aikoul,
 l.tutkmaak,
 -- Koulutus 1
 (case
    --lukiokoulutuksessa _1
	when l.suorlk = '1' and l.luopiskkoulk_1 <> '' and l.ammopiskkoulk_1 = '' and
	l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' then l.luopiskkoulk_1 
	-- ammattikoulutuksessa _1
	when l.suorlk = '1' and l.luopiskkoulk_1 = '' and l.ammopiskkoulk_1 <> '' and
	l.amkopiskkoulk_1 ='' and l.yoopiskkoulk_1 = ''  then l.ammopiskkoulk_1 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen _1 ensim. koulutustietoihin
	when l.suorlk = '1' and l.luopiskkoulk_1 <> '' and l.ammopiskkoulk_1 <> '' and
	l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' then l.luopiskkoulk_1
	-- ammattikorkeakoulutuksessa _1
	when l.suorlk = '1' and l.amkopiskkoulk_1  <> '' and l.yoopiskkoulk_1  = '' and
	l.luopiskkoulk_1 = '' and l.ammopiskkoulk_1 = '' then l.amkopiskkoulk_1
	-- yliopistokoulutuksessa _1
	when l.suorlk = '1' and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 <> '' and 
	l.luopiskkoulk_1 = '' and l.ammopiskkoulk_1 = ''   then l.yoopiskkoulk_1
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa, merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorlk = '1' and l.amkopiskkoulk_1 <> '' and l.yoopiskkoulk_1  <> '' and
	l.luopiskkoulk_1 = '' and ammopiskkoulk_1 = ''  then l.amkopiskkoulk_1 
	
	else ''

	
	    
	    end),
	    
-- Oppilaitos 1
	(case
	-- lukiokoulutuksen oppilaitos _1
	when l.suorlk = '1' and l.luopisktunn_1 <> '' and l.ammopisktunn_1 = '' and
	l.amkopisktunn_1 = '' and l.yoopisktunn_1 = '' then l.luopisktunn_1 
	-- ammattikoulutuksen oppilaitos _1
	when l.suorlk = '1' and l.luopisktunn_1 = '' and l.ammopisktunn_1 <> '' and
	l.amkopisktunn_1 ='' and l.yoopisktunn_1 = ''  then l.ammopisktunn_1 
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos _1
	when l.suorlk = '1' and l.luopisktunn_1 <> '' and l.ammopisktunn_1 <> '' and
	l.amkopisktunn_1 = '' and l.yoopisktunn_1 = '' then l.luopisktunn_1
	-- ammattikorkeakoulutuksen oppilaitos _1
	when l.suorlk = '1' and l.amkopisktunn_1  <> '' and l.yoopisktunn_1  = '' and
	l.luopisktunn_1 = '' and l.ammopisktunn_1 = '' then l.amkopisktunn_1
	-- yliopistokoulutuksen oppilaitos _1
	when l.suorlk = '1' and l.amkopisktunn_1 = '' and l.yoopisktunn_1 <> '' and 
	l.luopisktunn_1 = '' and l.ammopisktunn_1 = ''   then l.yoopisktunn_1
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus _1  
	when l.suorlk = '1' and l.amkopisktunn_1 <> '' and l.yoopisktunn_1  <> '' and
	l.luopisktunn_1 = '' and l.ammopisktunn_1 = ''  then l.amkopisktunn_1 
	
	
	

	
	else ''
	
	    end),
  --Koulutuksen järjestäjä 1
	(case
	-- lukikoulutuksen järjestäjä _1
	when l.suorlk = '1' and l.luopiskjarj_1  <> '' and l.ammopiskjarj_1 = '' and
	l.amkopiskjarj_1 = '' and yoopiskjarj_1 = '' then l.luopiskjarj_1
	-- ammatillisen koulutuksen järjestäjä _1  
	when l.suorlk = '1' and l.luopiskjarj_1 = '' and l.ammopiskjarj_1 <> '' and
	l.amkopiskjarj_1 ='' and l.yoopiskjarj_1 = ''  then l.ammopiskjarj_1
	-- lukio- ja ammatillisen koulutuksen järjestäjä, merkitään lukiokoulutuksen _1 järjestäjä 
	when l.suorlk = '1' and l.luopiskjarj_1 <> '' and l.ammopiskjarj_1 <> '' and
	l.amkopiskjarj_1 = '' and l.yoopiskjarj_1 = '' then l.luopiskjarj_1
	-- ammattikorkeakoulutuksen järjestäjä _1
	when l.suorlk = '1' and l.amkopiskjarj_1  <> '' and l.yoopiskjarj_1   = '' and
	l.luopiskjarj_1 = '' and l.ammopiskjarj_1 = '' then l.amkopiskjarj_1
	-- yliopistokoulutuksen järjestäjä _1 
	when l.suorlk = '1' and l.amkopiskjarj_1  = '' and l.yoopiskjarj_1  <> '' and 
	l.luopiskjarj_1  = '' and l.ammopiskjarj_1 = ''   then l.yoopiskjarj_1
	-- ammattikorkea- ja yliopistokoulutuksen järjestäjä, merkitään ammattikorkeakoulutuksen _1 järjestäjä   
	when l.suorlk = '1' and l.amkopiskjarj_1  <> '' and l.yoopiskjarj_1   <> '' and
	l.luopiskjarj_1  = '' and l.ammopiskjarj_1  = ''  then l.amkopiskjarj_1 

	
	else ''
	    end),
 --Koulutuksen maakunta 1
	(case
	-- lukioopiskelun maakunta _1
	when l.suorlk = '1' and l.luopiskmaak_1   <> '' and l.ammopiskmaak_1  = '' and
	l.amkopiskmaak_1  = '' and l.yoopiskmaak_1  = '' then l.luopiskmaak_1   
	-- ammatillisen koulutuksen maakunta _1
	when l.suorlk = '1' and l.luopiskmaak_1  = '' and l.ammopiskmaak_1  <> '' and
	l.amkopiskmaak_1  ='' and l.yoopiskmaak_1  = ''  then l.ammopiskmaak_1  
	-- lukiokoulutuksen ja ammatillisen koulutus otetaan lukiokoulutuksen maakunta _1
	when l.suorlk = '1' and l.luopiskmaak_1  <> '' and l.ammopiskmaak_1  <> '' and
	l.amkopiskmaak_1  = '' and l.yoopiskmaak_1  = '' then l.luopiskmaak_1 
    -- ammattikorkeakoulutuksen maakunta _1
	when l.suorlk = '1' and l.amkopiskmaak_1   <> '' and l.yoopiskmaak_1   = '' and
	l.luopiskjarj_1 = '' and l.ammopiskmaak_1 = '' then l.amkopiskmaak_1
	-- yliopistokoulutuksen maakunta _1 
	when l.suorlk = '1' and l.amkopiskmaak_1  = '' and l.yoopiskmaak_1  <> '' and 
	l.luopiskjarj_1  = '' and l.ammopiskmaak_1 = ''   then l.yoopiskmaak_1
	-- ammattikorkekoulutuksen ja yliopistokoulutksen maakunta otetaan ammattikorkeakoulutuksen maakunta _1   
	when l.suorlk = '1' and l.amkopiskmaak_1  <> '' and l.yoopiskmaak_1   <> '' and
	l.luopiskjarj_1  = '' and l.ammopiskmaak_1  = ''  then l.amkopiskmaak_1 
	
	else ''
	
	    end),
-- Koulutus 2
(case
   -- jos lukiokoulutuksessa vain niin jätetään tyhjäksi _1
	when l.suorlk = '1' and l.luopiskkoulk_1 <> '' and l.ammopiskkoulk_1 = '' and
	l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' then ''
	-- jos ammattikoulutuksessa vain  jätetään tyhjäksi _1 
	when l.suorlk = '1' and l.luopiskkoulk_1 = '' and l.ammopiskkoulk_1 <> '' and
	l.amkopiskkoulk_1 ='' and l.yoopiskkoulk_1 = ''  then ''
	-- jos lukiokoulutksessa ja ammattikoulutuksessa merkitään ammattikoulutus _1 
	when l.suorlk = '1' and l.luopiskkoulk_1 <> '' and l.ammopiskkoulk_1 <> '' and
	l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' then l.ammopiskkoulk_1 
	-- jos vain ammattikorkeakoulutuksessa jätetään tyhjäksi
	when l.suorlk = '1' and l.amkopiskkoulk_1  <> '' and l.yoopiskkoulk_1  = '' and
	l.luopiskkoulk_1 = '' and l.ammopiskkoulk_1 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorlk = '1' and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 <> '' and 
	l.luopiskkoulk_1 = '' and l.ammopiskkoulk_1 = ''   then ''
	-- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus _1
	when l.suorlk = '1' and l.amkopiskkoulk_1 <> '' and l.yoopiskkoulk_1  <> '' and
	l.luopiskkoulk_1 = '' and l.ammopiskkoulk_1 = ''  then l.yoopiskkoulk_1
	
	
	
	else ''
	    end),
-- Oppilaitos 2
(case
    -- lukiokoulutuksen oppilaitos vain merkitään tyhjäksi
	when l.suorlk = '1' and l.luopisktunn_1 <> '' and l.ammopisktunn_1 = '' and
	l.amkopisktunn_1 = '' and l.yoopisktunn_1 = '' then ''
	-- ammatillisen koulutuksen oppilaitos _1 merkitään tyhjäksi
	when l.suorlk = '1' and l.luopisktunn_1 = '' and l.ammopisktunn_1 <> '' and
	l.amkopisktunn_1 ='' and l.yoopisktunn_1 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos merkitään ammatillisen koulutuksen oppilaitos _1
	when l.suorlk = '1' and l.luopisktunn_1 <> '' and l.ammopisktunn_1 <> '' and
	l.amkopisktunn_1 = '' and l.yoopisktunn_1 = '' then l.ammopisktunn_1 
	-- ammattikorkeakoulutksen oppilaitos vain merkitään tyhjäksi _1
	when l.suorlk = '1' and l.amkopisktunn_1  <> '' and l.yoopisktunn_1  = '' and
	l.luopisktunn_1 = '' and l.ammopisktunn_1 = '' then ''
	-- yliopistokoulutksen oppilaitos vain merkitään tyhjäksi _1
	when l.suorlk = '1' and l.amkopisktunn_1 = '' and l.yoopisktunn_1 <> '' and 
	l.luopisktunn_1 = '' and l.ammopisktunn_1 = ''   then ''  
	--  ammattikorkeakoulutksen oppilaitos ja yliopistokoulutuksen oppilaitos, merkitään yliopistokoulutuksen oppilaitos _1
	when l.suorlk = '1' and l.amkopisktunn_1 <> '' and l.yoopisktunn_1  <> '' and
	l.luopisktunn_1 = '' and l.ammopisktunn_1 = ''  then l.yoopisktunn_1 
	
	
	else ''
	    end),
-- Koulutuksen järjestäjä 2
	(case
	-- lukiokoulutuksen järjestäjä vain _1, merkitään tyhjäksi
	when l.suorlk = '1' and l.luopiskjarj_1  <> '' and l.ammopiskjarj_1 = '' and
	l.amkopiskjarj_1 = '' and l.yoopiskjarj_1 = '' then ''
	-- ammatillisen koulutuksen järjestäjä vain _1, merkitään tyhjäksi
	when l.suorlk = '1' and l.luopiskjarj_1 = '' and l.ammopiskjarj_1 <> '' and
	l.amkopiskjarj_1 ='' and l.yoopiskjarj_1 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä _1
	when l.suorlk = '1' and l.luopiskjarj_1 <> '' and l.ammopiskjarj_1 <> '' and
	l.amkopiskjarj_1 = '' and l.yoopiskjarj_1 = '' then l.ammopiskjarj_1 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi
	when l.suorlk = '1' and l.amkopiskjarj_1  <> '' and l.yoopiskjarj_1   = '' and
	l.luopiskjarj_1 = '' and l.ammopiskjarj_1 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, merkitään tyhjäksi
	when l.suorlk = '1' and l.amkopiskjarj_1  = '' and l.yoopiskjarj_1  <> '' and 
	l.luopiskjarj_1  = '' and l.ammopiskjarj_1 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestäjä merkitään yliopistokoulutuksen järjetäjä _1
	when l.suorlk = '1' and l.amkopiskjarj_1  <> '' and l.yoopiskjarj_1   <> '' and
	l.luopiskjarj_1  = '' and l.ammopiskjarj_1  = ''  then l.yoopiskjarj_1 
	

	else ''
	    end),
-- Koulutuksen maakunta 2
	(case
	-- vain lukiokoulutuksen maakunta _1, jätetään tyhjäksi
	when l.suorlk = '1' and l.luopiskmaak_1   <> '' and l.ammopiskmaak_1  = '' and
	l.amkopiskmaak_1  = '' and l.yoopiskmaak_1  = '' then ''
	-- vain ammatillisen koulutuksen maakunta _1, jätetään tyhjäksi   
	when l.suorlk = '1' and l.luopiskmaak_1  = '' and l.ammopiskmaak_1  <> '' and
	l.amkopiskmaak_1  ='' and l.yoopiskmaak_1  = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta, merkitään ammatillisen koulutuksen maakunta _1
	when l.suorlk = '1' and l.luopiskmaak_1  <> '' and l.ammopiskmaak_1  <> '' and
	l.amkopiskmaak_1  = '' and l.yoopiskmaak_1  = '' then l.ammopiskmaak_1 
	-- vain ammattikorkeakoulutuksen maakunta _1, jätetään tyhjäksi
	when l.suorlk = '1' and l.amkopiskmaak_1   <> '' and l.yoopiskmaak_1   = '' and
	l.luopiskmaak_1 = '' and l.ammopiskmaak_1 = '' then '' 
	-- vain yliopistokoulutuksen maakunta _1, merkitään tyhjäksi
	when l.suorlk = '1' and l.amkopiskmaak_1  = '' and l.yoopiskmaak_1  <> '' and 
	l.luopiskmaak_1  = '' and l.ammopiskmaak_1 = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta _1, merkitään yliopistokoulutuksen maakunta _1
	when l.suorlk = '1' and l.amkopiskmaak_1  <> '' and l.yoopiskmaak_1   <> '' and
	l.luopiskjarj_1  = '' and l.ammopiskmaak_1  = ''  then l.yoopiskmaak_1
	

	else ''
	
	    end),
	-- Monihaku
	(case
	-- _1
	when l.suorlk = '1' then l.monihaku_1		
	else '8'
	end),
    -- Pääasiallinen toiminta
    (case
    -- _1
	when l.suorlk = '1' then l.ptoim1r4_1
	else ''
	end),
	-- Ammattiasema
	(case
	-- _1
	when l.suorlk = '1' then l.amas_1
	else ''
	end),
    l.lkm,
	l.pohjkoul,
 l.tietolahde,
 'K3.13',
 -- Lukiokoulutuksessa
 (case
	    when (l.suorlk = '1' ) and  l.luopiskkoulk_1 <> '' and l.ammopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_1 = '' then '1'    
	    else '0'
	    end) as lukiokoulutuksessa,
 -- Ammatillisessa koulutuksessa 
 (case
	    when (l.suorlk = '1') and  l.ammopiskkoulk_1  <> '' and l.luopiskkoulk_1 = '' and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' then '1' 
	    else '0'
	    end) as ammatillisessa_koulutuksessa,
-- Ammattikorkeakoulutuksessa
 (case
	   when (l.suorlk = '1') and  l.amkopiskkoulk_1 <> '' and l.ammopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.luopiskkoulk_1 = '' then  '1'
	   else '0' 
	   end) as ammattikorkeakoulutuksessa,
-- Yliopistokoulutuksessa
 (case
	    when (l.suorlk = '1') and  l.yoopiskkoulk_1  <> '' and l.amkopiskkoulk_1 = '' and l.luopiskkoulk_1 = '' and l.ammopiskkoulk_1 = '' then '1'   	   
	    else '0'
	    end) as yliopistokoulutuksessa,
-- Lukiokoulutuksessa ja ammatillisessa koulutuksessa
(case
	    when (l.suorlk = '1') and  l.luopiskkoulk_1  <> '' and l.ammopiskkoulk_1 <> '' and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1  = '' then '1'  
	    else '0'
	    end) as lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa,
-- Toisen asteen ammatillisessa koulutuksessa ja korkeakoulutuksessa
(case
	    when (l.suorlk = '1') and  l.ammopiskkoulk_1  <> '' and l.amkopiskkoulk_1 <> '' and l.luopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' then '1'  
	    else '0'
	    end) as toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa,
-- Ammattikorkeakoulutuksessa ja yliopistokoulutuksessa
(case
	    when (l.suorlk = '1') and  l.amkopiskkoulk_1  <> '' and l.yoopiskkoulk_1 <> '' and l.ammopiskkoulk_1  = '' and l.luopiskkoulk_1 = ''  then '1' 
	    else '0'
	    end) as ammattikorkekoulutuksessa_ja_yliopistokoulutuksessa,    
-- Koulutuksen päättäneiden toiminta
(case
	   -- Tutkintoon johtavassa koulutuksessa olevat
	   when (l.suorlk = '1')  and (l.ptoim1r4_1 = '22' or l.ptoim1r4_1 = '13')
       and	(l.luopiskkoulk_1 <>'' or l.ammopiskkoulk_1 <>'' or l.amkopiskkoulk_1 <>'' or l.yoopiskkoulk_1 <>'')   then '1' 
	
	   -- Ei tutkintoon johtavassa koulutuksessa olevat
	   when (l.suorlk = '1')  and (l.ptoim1r4_1 = '22' or l.ptoim1r4_1 = '13')
       and	(l.luopiskkoulk_1 ='' and l.ammopiskkoulk_1 ='' and l.amkopiskkoulk_1 ='' and l.yoopiskkoulk_1 ='')   then '2' 
   
   
	   -- Ei opiskelevat työlliset
	   when (l.suorlk = '1')and  l.ptoim1r4_1  = '10'  then '3' 
	   -- Ei opiskelevat työttömät
	   when (l.suorlk = '1') and  l.ptoim1r4_1  = '12'  then '4' 
	   -- Ei opiskelevat muut
		else '5' 
	   end ) as koulutuksen_paattaneiden_toiminta
 ,ika_1v = cast((case 
            when syntv = '' then '-1'
            when  (cast(tilv as int) - cast(syntv as int)) > 99 then ''
            else  ((cast(tilv as int) - cast(syntv as int))) end)  as nvarchar(10))
 ,ika_5v =cast(
       (
		case
		when (cast(tilv as int) - cast(syntv as int)) < 15 then '5v10'
		when ((cast(tilv as int) - cast(syntv as int)) >= 15 and (cast(tilv as int) - cast(syntv as int)) <= 19) then '5v15'
		when ((cast(tilv as int) - cast(syntv as int)) >= 20 and (cast(tilv as int) - cast(syntv as int)) <= 24) then '5v20'
		when ((cast(tilv as int) - cast(syntv as int)) >= 25 and (cast(tilv as int) - cast(syntv as int)) <= 29) then '5v25'
		when ((cast(tilv as int) - cast(syntv as int)) >= 30 and (cast(tilv as int) - cast(syntv as int)) <= 34) then '5v30'
		when ((cast(tilv as int) - cast(syntv as int)) >= 35 and (cast(tilv as int) - cast(syntv as int)) <= 39) then '5v35'
		when ((cast(tilv as int) - cast(syntv as int)) >= 40 and (cast(tilv as int) - cast(syntv as int)) <= 44) then '5v40'
		when ((cast(tilv as int) - cast(syntv as int)) >= 45 and (cast(tilv as int) - cast(syntv as int)) <= 49) then '5v45'
		when ((cast(tilv as int) - cast(syntv as int)) >= 50 and (cast(tilv as int) - cast(syntv as int)) <= 54) then '5v50'
		when ((cast(tilv as int) - cast(syntv as int)) >= 55 and (cast(tilv as int) - cast(syntv as int)) <= 59) then '5v55'
		when ((cast(tilv as int) - cast(syntv as int)) >= 60 and (cast(tilv as int) - cast(syntv as int)) <= 64) then '5v60'
		when ((cast(tilv as int) - cast(syntv as int)) >= 65 and (cast(tilv as int) - cast(syntv as int)) <= 69) then '5v65'
		when ((cast(tilv as int) - cast(syntv as int)) >= 70 and (cast(tilv as int) - cast(syntv as int)) <= 74) then '5v70'
		when ((cast(tilv as int) - cast(syntv as int)) >= 75 and (cast(tilv as int) - cast(syntv as int)) <= 79) then '5v75'
		when ((cast(tilv as int) - cast(syntv as int)) >= 80 and (cast(tilv as int) - cast(syntv as int)) <= 84) then '5v80'
		when ((cast(tilv as int) - cast(syntv as int)) >= 85 and (cast(tilv as int) - cast(syntv as int)) <= 89) then '5v85'
		when ((cast(tilv as int) - cast(syntv as int)) >= 90 and (cast(tilv as int) - cast(syntv as int)) <= 94) then '5v90'
		when ((cast(tilv as int) - cast(syntv as int)) >= 95) then '5v95'
		
		end
	   ) as nvarchar (10))

  ,ika_1v_suorv = cast(
					(case 
						when syntv = '' then '-1' 
						else ((cast(suorv as int) - cast(syntv as int))) 
					end)  
	as nvarchar(10))




--uudet muuttujat 03/2018

----OPISKELUT KYLLÄ/EI
--Opiskellut lukiokoulutuksessa
,case
	when  l.suorlk = '1' and l.luopiskkoulk_1 <> '' then 1
	else 0
end as opisk_lu
--Opiskellut ammatillisessa peruskoulutuksessa
,case
	when  l.suorlk = '1' and l.ammopiskkoulk_1 <> '' and d1c.Koulutusaste_taso2_koodi = '32' then 1

	else 0
end as opisk_amm_pk
--Opiskellut ammattitutkintokoulutuksessa
,case
	when  l.suorlk = '1' and l.ammopiskkoulk_1 <> '' and d1c.Koulutusaste_taso2_koodi = '33' then 1
	else 0
end as opisk_amm_at
--Opiskellut erikoisammattitutkintokoulutuksessa
,case
	when l.suorlk = '1' and l.ammopiskkoulk_1 <> '' and d1c.Koulutusaste_taso2_koodi = '41' then 1
	else 0
end as opisk_amm_eat
--Opiskellut ammatillisessa koulutuksessa
,case
	when l.suorlk = '1' and l.ammopiskkoulk_1 <> '' then 1
	else 0
end as opisk_amm
--Opiskellut ammattikorkeakoulutuksessa
,case
	when l.suorlk = '1' and l.amkopiskkoulk_1 <> '' then 1
	else 0
end as opisk_amk
--Opiskellut yliopistokoulutuksessa
,case
	when l.suorlk = '1' and l.yoopiskkoulk_1 <> '' then 1
	else 0
end as opisk_yo




----KOULUTUSALA, TASO 1 KYLLÄ/EI
--Opiskellut koulutusala1 (amk) (taso 1) (kyllä/ei)
,case
	when l.suorlk = '1' and l.amkopiskkoulk_1 <> '' and d1a.iscfibroad2013_koodi = '01' then 1
	else 0
end as opisk_amk_koulala1
--Opiskellut koulutusala2 (amk) (taso 1) (kyllä/ei)
,case
	when l.suorlk = '1' and l.amkopiskkoulk_1 <> '' and d1a.iscfibroad2013_koodi = '02' then 1
	else 0
end as opisk_amk_koulala2
--Opiskellut koulutusala3 (amk) (taso 1) (kyllä/ei)
,case
	when l.suorlk = '1' and l.amkopiskkoulk_1 <> '' and d1a.iscfibroad2013_koodi = '03' then 1
	else 0
end as opisk_amk_koulala3
--Opiskellut koulutusala4 (amk) (taso 1) (kyllä/ei)
,case
	when l.suorlk = '1' and l.amkopiskkoulk_1 <> '' and d1a.iscfibroad2013_koodi = '04' then 1
	else 0
end as opisk_amk_koulala4
--Opiskellut koulutusala5 (amk) (taso 1) (kyllä/ei)
,case
	when l.suorlk = '1' and l.amkopiskkoulk_1 <> '' and d1a.iscfibroad2013_koodi = '05' then 1
	else 0
end as opisk_amk_koulala5
--Opiskellut koulutusala6 (amk) (taso 1) (kyllä/ei)
,case
	when l.suorlk = '1' and l.amkopiskkoulk_1 <> '' and d1a.iscfibroad2013_koodi = '06' then 1
	else 0
end as opisk_amk_koulala6
--Opiskellut koulutusala7 (amk) (taso 1) (kyllä/ei)
,case
	when l.suorlk = '1' and l.amkopiskkoulk_1 <> '' and d1a.iscfibroad2013_koodi = '07' then 1
	else 0
end as opisk_amk_koulala7
--Opiskellut koulutusala8 (amk) (taso 1) (kyllä/ei)
,case
	when l.suorlk = '1' and l.amkopiskkoulk_1 <> '' and d1a.iscfibroad2013_koodi = '08' then 1
	else 0
end as opisk_amk_koulala8
--Opiskellut koulutusala9 (amk) (taso 1) (kyllä/ei)
,case
	when l.suorlk = '1' and l.amkopiskkoulk_1 <> '' and d1a.iscfibroad2013_koodi = '09' then 1
	else 0
end as opisk_amk_koulala9
--Opiskellut koulutusala10 (amk) (taso 1) (kyllä/ei)
,case
	when l.suorlk = '1' and l.amkopiskkoulk_1 <> '' and d1a.iscfibroad2013_koodi = '10' then 1
	else 0
end as opisk_amk_koulala10




--Opiskellut koulutusala1 (yo) (taso 1) (kyllä/ei)
,case
	when l.suorlk = '1' and l.yoopiskkoulk_1 <> '' and d1b.iscfibroad2013_koodi = '01' then 1
	else 0
end as opisk_yo_koulala1
--Opiskellut koulutusala2 (yo) (taso 1) (kyllä/ei)
,case
	when l.suorlk = '1' and l.yoopiskkoulk_1 <> '' and d1b.iscfibroad2013_koodi = '02' then 1
	else 0
end as opisk_yo_koulala2
--Opiskellut koulutusala3 (yo) (taso 1) (kyllä/ei)
,case
	when l.suorlk = '1' and l.yoopiskkoulk_1 <> '' and d1b.iscfibroad2013_koodi = '03' then 1
	else 0
end as opisk_yo_koulala3
--Opiskellut koulutusala4 (yo) (taso 1) (kyllä/ei)
,case
	when l.suorlk = '1' and l.yoopiskkoulk_1 <> '' and d1b.iscfibroad2013_koodi = '04' then 1
	else 0
end as opisk_yo_koulala4
--Opiskellut koulutusala5 (yo) (taso 1) (kyllä/ei)
,case
	when l.suorlk = '1' and l.yoopiskkoulk_1 <> '' and d1b.iscfibroad2013_koodi = '05' then 1
	else 0
end as opisk_yo_koulala5
--Opiskellut koulutusala6 (yo) (taso 1) (kyllä/ei)
,case
	when l.suorlk = '1' and l.yoopiskkoulk_1 <> '' and d1b.iscfibroad2013_koodi = '06' then 1
	else 0
end as opisk_yo_koulala6
--Opiskellut koulutusala7 (yo) (taso 1) (kyllä/ei)
,case
	when l.suorlk = '1' and l.yoopiskkoulk_1 <> '' and d1b.iscfibroad2013_koodi = '07' then 1
	else 0
end as opisk_yo_koulala7
--Opiskellut koulutusala8 (yo) (taso 1) (kyllä/ei)
,case
	when l.suorlk = '1' and l.yoopiskkoulk_1 <> '' and d1b.iscfibroad2013_koodi = '08' then 1
	else 0
end as opisk_yo_koulala8
--Opiskellut koulutusala9 (yo) (taso 1) (kyllä/ei)
,case
	when l.suorlk = '1' and l.yoopiskkoulk_1 <> '' and d1b.iscfibroad2013_koodi = '09' then 1
	else 0
end as opisk_yo_koulala9
--Opiskellut koulutusala10 (yo) (taso 1) (kyllä/ei)
,case
	when l.suorlk = '1' and l.yoopiskkoulk_1 <> '' and d1b.iscfibroad2013_koodi = '10' then 1
	else 0
end as opisk_yo_koulala10


--Opiskellut useampaa kuin yhtä alaa (taso 1) (kyllä/ei)
,case --ensimmäisenä vuotena on mahdollista olla vain yksi ala
	when l.suorlk = '1' and d1a.iscfibroad2013_koodi <> d1b.iscfibroad2013_koodi then 1
	else 0
end as opisk_vah2_koulala



----HAUT KYLLÄ/EI
--Hakenut ammatilliseen koulutukseen
,case
	when l.suorlk = '1' and l.monihaku_1 in (2,3,5) then 1
	else 0
end as haku_amm
--Hakenut ammattikorkeakoulutukseen
,case
	when l.suorlk = '1' and l.monihaku_1 in (4,6) then 1
	else 0
end as haku_amk
--Hakenut yliopistokoulutukseen
,case
	when l.suorlk = '1' and l.monihaku_1 in (6,7) then 1
	else 0
end as haku_yo




----MITTARIT
--Ei hakenut eikä opiskellut mitään
,case
	when l.suorlk = '1' and monihaku_1 not in (4,5,6,7) and l.luopiskkoulk_1 = '' and l.ammopiskkoulk_1 = '' and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' then 1
	else 0
end eihaku_kk_eiopisk

--Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa
,case 
	when l.suorlk = '1' and monihaku_1 not in (4,5,6,7) and (l.luopiskkoulk_1 <> '' or l.ammopiskkoulk_1 <> '') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' then 1
	else 0
end eihaku_kk_eiopisk_kk_opisk_ta

----Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa, opiskellut lukiokoulutuksessa
,case 
	when l.suorlk = '1' and monihaku_1 not in (4,5,6,7) and (l.luopiskkoulk_1 <> '') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' then 1
	else 0
end eihaku_kk_eiopisk_kk_opisk_lu

----Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa, opiskellut ammatillisessa peruskoulutuksessa
,case 
	when l.suorlk = '1' and monihaku_1 not in (4,5,6,7) and (l.ammopiskkoulk_1 <> '') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and d1c.Koulutusaste_taso2_koodi = '32' then 1
	else 0
end eihaku_kk_eiopisk_kk_opisk_pk

------Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa, opiskellut ammattitutkintokoulutuksessa
,case 
	when l.suorlk = '1' and monihaku_1 not in (4,5,6,7) and (l.ammopiskkoulk_1 <> '') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and d1c.Koulutusaste_taso2_koodi = '33' then 1
	else 0
end eihaku_kk_eiopisk_kk_opisk_at

------Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa, opiskellut erikoisammattitutkintokoulutuksessa
,case 
	when l.suorlk = '1' and monihaku_1 not in (4,5,6,7) and (l.ammopiskkoulk_1 <> '') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and d1c.Koulutusaste_taso2_koodi = '41' then 1
	else 0
end eihaku_kk_eiopisk_kk_opisk_eat

--Hakenut korkea-asteelle, ei opiskellut korkea-asteella
,case 
	when l.suorlk = '1' and monihaku_1 in (4,5,6,7) and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' then 1
	else 0
end haku_kk_eiopisk_kk
----Hakenut korkea-asteelle, ei opiskellut korkea-asteella, ei-opiskellut toisen asteen koulutuksessa
,case
	when l.suorlk = '1' and monihaku_1 in (4,5,6,7) and l.luopiskkoulk_1 = '' and l.ammopiskkoulk_1 = '' and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' then 1
	else 0
end haku_kk_eiopisk_kk_eiopisk_ta
----Hakenut korkea-asteelle, ei opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa
,case
	when l.suorlk = '1' and monihaku_1 in (4,5,6,7) and (l.luopiskkoulk_1 <> '' or l.ammopiskkoulk_1 <> '') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' then 1
	else 0
end haku_kk_eiopisk_kk_opisk_ta
----Hakenut vain ammattikorkeakouluun, ei opiskellut korkea-asteella
,case
	when l.suorlk = '1' and monihaku_1 = 4 and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' then 1
	else 0
end haku_amk_eiopisk_kk
----Hakenut vain yliopistokoulutukseen, ei opiskellut korkea-asteella
,case
	when l.suorlk = '1' and monihaku_1 = 7 and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' then 1
	else 0
end haku_yo_eiopisk_kk
----Hakenut sekä amk- että yliopistokoulutukseen, ei opiskellut korkea-asteella
,case
	when l.suorlk = '1' and monihaku_1 = 6 and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' then 1
	else 0
end haku_amkyo_eiopisk_kk

--Opiskellut korkea-asteella
,case
	when l.suorlk = '1' and (l.amkopiskkoulk_1 <> '' or l.yoopiskkoulk_1 <> '') then 1
	else 0
end opisk_kk
----Opiskellut korkea-asteella, ei-opiskellut toisen asteen koulutuksessa
,case
	when l.suorlk = '1' and l.luopiskkoulk_1 = '' and l.ammopiskkoulk_1 = '' and (l.amkopiskkoulk_1 <> '' or l.yoopiskkoulk_1 <> '') then 1
	else 0
end opisk_kk_eiopisk_ta
----Opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa
,case
	when l.suorlk = '1' and (l.luopiskkoulk_1 <> '' or l.ammopiskkoulk_1 <> '') and (l.amkopiskkoulk_1 <> '' or l.yoopiskkoulk_1 <> '') then 1
	else 0
end opisk_kk_opisk_ta
----Opiskellut vain ammattikorkeakoulussa
,case
	when l.suorlk = '1' and l.amkopiskkoulk_1 <> '' and l.yoopiskkoulk_1 = '' then 1
	else 0
end opisk_vain_amk
----Opiskellut vain yliopistokoulutuksessa
,case
	when l.suorlk = '1' and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 <> '' then 1
	else 0
end opisk_vain_yo
----Opiskellut sekä amk- että yliopistokoulutuksessa
,case
	when l.suorlk = '1' and l.amkopiskkoulk_1 <> '' and l.yoopiskkoulk_1 <> '' then 1
	else 0
end opisk_amkyo



FROM 
    (
	select * from [VipunenTK_SA].[dbo].[v_K3_13_Perusk_paattaneet_amm_tutk_suorittaneet]
	where suorlk = '1'
	) as l


LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d1a on d1a.koulutusluokitus_avain=l.amkopiskkoulk_1
/*LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d2a on d2a.koulutusluokitus_avain=l.amkopiskkoulk2005
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d3a on d3a.koulutusluokitus_avain=l.amkopiskkoulk2006
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d4a on d4a.koulutusluokitus_avain=l.amkopiskkoulk2007
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d5a on d5a.koulutusluokitus_avain=l.amkopiskkoulk2008
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d6a on d6a.koulutusluokitus_avain=l.amkopiskkoulk2009
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d7a on d7a.koulutusluokitus_avain=l.amkopiskkoulk2010*/

LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d1b on d1b.koulutusluokitus_avain=l.yoopiskkoulk_1
/*LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d2b on d2b.koulutusluokitus_avain=l.yoopiskkoulk2005
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d3b on d3b.koulutusluokitus_avain=l.yoopiskkoulk2006
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d4b on d4b.koulutusluokitus_avain=l.yoopiskkoulk2007
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d5b on d5b.koulutusluokitus_avain=l.yoopiskkoulk2008
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d6b on d6b.koulutusluokitus_avain=l.yoopiskkoulk2009
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d7b on d7b.koulutusluokitus_avain=l.yoopiskkoulk2010*/

LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d1c on d1c.koulutusluokitus_avain=l.ammopiskkoulk_1
/*LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d2c on d2c.koulutusluokitus_avain=l.ammopiskkoulk2005
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d3c on d3c.koulutusluokitus_avain=l.ammopiskkoulk2006
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d4c on d4c.koulutusluokitus_avain=l.ammopiskkoulk2007
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d5c on d5c.koulutusluokitus_avain=l.ammopiskkoulk2008
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d6c on d6c.koulutusluokitus_avain=l.ammopiskkoulk2009
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d7c on d7c.koulutusluokitus_avain=l.ammopiskkoulk2010*/

	WHERE 1=1
--end;

--
-- TULOS
-- 
/*
if @debug_what_to_run>=3 begin
	if @debug_what_to_run>0 print 'querying result';
	select * from [VipunenTK_DW].[dbo].[_koulutukseen_sijoittuneet_6v]
	--select COUNT(*) from vipunen_tk.f_tyol_ja_jatko_opin_ where aineisto=(select id from vipunen_tk.d_aineisto where aineistokoodi='4.3' and @toinen_suoritusvuosi between alkaa and paattyy)
end;

if @debug_what_to_run>0 PRINT 'all done.';
*/

GO
/****** Object:  StoredProcedure [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_0_5_tarkastelujakso]    Script Date: 29.8.2018 15:59:41 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE PROCEDURE [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_0_5_tarkastelujakso] AS
/*declare @debug_what_to_run tinyint; set @debug_what_to_run=2; -- käytä arvoa 3 vain kun teet yhden vuoden
print '$'+convert(varchar,sysdatetime(),20)+'$ '+'DEBUG (what to run)='+cast(@debug_what_to_run as varchar)+
': 0=luo vain taulut, älä tulosta mitään; 1=luo taulut ja tulosta joitakin merkittävimpiä välivaiheita; 2=luo taulut ja tulosta välivaiheet; 3=luo taulut, tulosta välivaiheet ja tulosta myös tulokset, 4=tulosta välivaiheet, mutta älä tee mitään';




-- lisätään data
if @debug_what_to_run not in (4) begin
if @debug_what_to_run>0 print 'inserting data';

-- parametrimuuttujien arvot
-- parametrimuuttujat
DECLARE @ensimmainen_suoritusvuosi int;
DECLARE @toinen_suoritusvuosi int;
DECLARE @kolmas_suoritusvuosi int;
DECLARE @neljas_suoritusvuosi int;
DECLARE @viides_suoritusvuosi int;
DECLARE @kuudes_suoritusvuosi int;
DECLARE @seitsemas_suoritusvuosi int;


set @ensimmainen_suoritusvuosi = _1;
set @toinen_suoritusvuosi = 2005;
set @kolmas_suoritusvuosi = 2006;
set @neljas_suoritusvuosi = 2007;
set @viides_suoritusvuosi = 2008;
set @kuudes_suoritusvuosi = 2009;
set @seitsemas_suoritusvuosi = 2010;

*/

INSERT INTO [VipunenTK_DW].[dbo].[_koulutukseen_sijoittuneet_6v_tarkastelu]
(
rivinumero
, tarkastelujakso
, tilv 
, tilv_date
, tutkryh 
, suorv
, suorlk 
, sp 
, syntv
, aikielir1 
, tutkkaskun 
, kansalr1
, pohjmaa 
, eumaa 
, etamaa 
, tunn
, jarj
, kkielir1 
, tutklaja 
, tutktav 
, aikoul 
, tutkmaak
, koulutus_1
, oppilaitos_1
, koulutuksen_jarjestaja_1
, koulutuksen_maakunta_1
, koulutus_2
, oppilaitos_2
, koulutuksen_jarjestaja_2
, koulutuksen_maakunta_2
, monihaku
, paaasiallinen_toiminta
, ammattiasema
, lkm
, pohjkoulk
, tietolahde
, aineisto
, lukiokoulutuksessa
, ammatillisessa_koulutuksessa
, ammattikorkeakoulutuksessa
, yliopistokoulutuksessa
, lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa
, toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa
, ammattikorkeakoulutuksessa_ja_yliopistokoulutuksessa
, koulutuksen_paattaneiden_toiminta
, ika_1v
, ika_5v
, ika_1v_suorv
, opisk_lu
, opisk_amm_pk
, opisk_amm_at
, opisk_amm_eat
, opisk_amm
, opisk_amk
, opisk_yo
, opisk_amk_koulala1
, opisk_amk_koulala2
, opisk_amk_koulala3
, opisk_amk_koulala4
, opisk_amk_koulala5
, opisk_amk_koulala6
, opisk_amk_koulala7
, opisk_amk_koulala8
, opisk_amk_koulala9
, opisk_amk_koulala10
, opisk_yo_koulala1
, opisk_yo_koulala2
, opisk_yo_koulala3
, opisk_yo_koulala4
, opisk_yo_koulala5
, opisk_yo_koulala6
, opisk_yo_koulala7
, opisk_yo_koulala8
, opisk_yo_koulala9
, opisk_yo_koulala10
, opisk_vah2_koulala
, haku_amm
, haku_amk
, haku_yo
, eihaku_kk_eiopisk
, eihaku_kk_eiopisk_kk_opisk_ta
, eihaku_kk_eiopisk_kk_opisk_lu
, eihaku_kk_eiopisk_kk_opisk_pk
, eihaku_kk_eiopisk_kk_opisk_at
, eihaku_kk_eiopisk_kk_opisk_eat
, haku_kk_eiopisk_kk
, haku_kk_eiopisk_kk_eiopisk_ta
, haku_kk_eiopisk_kk_opisk_ta
, haku_amk_eiopisk_kk
, haku_yo_eiopisk_kk
, haku_amkyo_eiopisk_kk
, opisk_kk
, opisk_kk_eiopisk_ta
, opisk_kk_opisk_ta
, opisk_vain_amk
, opisk_vain_yo
, opisk_amkyo
)
SELECT
 l.rivinumero,
 '0,5',
 l.tilv,
 l.tilv_date,
 (case 
	when l.tutkryh=3 and tutklaja=1 then 31
	when l.tutkryh=3 and tutklaja=2 then 32
	when l.tutkryh=3 and tutklaja=3 then 33
	else l.tutkryh
  end),
 l.suorv,
  (case
	when l.suorlk = '1'  then (l.suorv+'0'+l.suorlk)
	when l.suorlk = '2'  then (l.suorv+'0'+'8')
	else ''
	end),
 l.sp,
 l.syntv,
 l.aikielir1,
 l.tutkaskun,
 l.kansalr1,
 l.pohjmaa,
 l.eumaa,
 l.etamaa,
 l.tunn,
 l.jarj,
 l.kkielir1,
 l.tutklaja,
 l.tutktav,
 l.aikoul,
 l.tutkmaak,
 -- Koulutus 1
 (case
    --lukiokoulutuksessa _2
	when l.suorlk = '2' and l.luopiskkoulk_2 <> '' and l.ammopiskkoulk_2 = '' and
	l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' then l.luopiskkoulk_2 
	-- ammattikoulutuksessa _2
	when l.suorlk = '2' and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 <> '' and
	l.amkopiskkoulk_2 ='' and l.yoopiskkoulk_2 = ''  then l.ammopiskkoulk_2 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen _2 ensim. koulutustietoihin
	when l.suorlk = '2' and l.luopiskkoulk_2 <> '' and l.ammopiskkoulk_2 <> '' and
	l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' then l.luopiskkoulk_2
	-- ammattikorkeakoulutuksessa _2
	when l.suorlk = '2' and l.amkopiskkoulk_2  <> '' and l.yoopiskkoulk_2  = '' and
	l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' then l.amkopiskkoulk_2
	-- yliopistokoulutuksessa _2
	when l.suorlk = '2' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 <> '' and 
	l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = ''   then l.yoopiskkoulk_2
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa, merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorlk = '2' and l.amkopiskkoulk_2 <> '' and l.yoopiskkoulk_2  <> '' and
	l.luopiskkoulk_2 = '' and ammopiskkoulk_2 = ''  then l.amkopiskkoulk_2 
	
	else ''

	
	    
	    end),
	    
-- Oppilaitos 1
	(case
	-- lukiokoulutuksen oppilaitos _2
	when l.suorlk = '2' and l.luopisktunn_2 <> '' and l.ammopisktunn_2 = '' and
	l.amkopisktunn_2 = '' and l.yoopisktunn_2 = '' then l.luopisktunn_2 
	-- ammattikoulutuksen oppilaitos _2
	when l.suorlk = '2' and l.luopisktunn_2 = '' and l.ammopisktunn_2 <> '' and
	l.amkopisktunn_2 ='' and l.yoopisktunn_2 = ''  then l.ammopisktunn_2 
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos _2
	when l.suorlk = '2' and l.luopisktunn_2 <> '' and l.ammopisktunn_2 <> '' and
	l.amkopisktunn_2 = '' and l.yoopisktunn_2 = '' then l.luopisktunn_2
	-- ammattikorkeakoulutuksen oppilaitos _2
	when l.suorlk = '2' and l.amkopisktunn_2  <> '' and l.yoopisktunn_2  = '' and
	l.luopisktunn_2 = '' and l.ammopisktunn_2 = '' then l.amkopisktunn_2
	-- yliopistokoulutuksen oppilaitos _2
	when l.suorlk = '2' and l.amkopisktunn_2 = '' and l.yoopisktunn_2 <> '' and 
	l.luopisktunn_2 = '' and l.ammopisktunn_2 = ''   then l.yoopisktunn_2
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus _2  
	when l.suorlk = '2' and l.amkopisktunn_2 <> '' and l.yoopisktunn_2  <> '' and
	l.luopisktunn_2 = '' and l.ammopisktunn_2 = ''  then l.amkopisktunn_2 	
	else ''	
	    end),

  --Koulutuksen järjestäjä 1
	(case
	-- lukikoulutuksen järjestäjä _2
	when l.suorlk = '2' and l.luopiskjarj_2  <> '' and l.ammopiskjarj_2 = '' and
	l.amkopiskjarj_2 = '' and yoopiskjarj_2 = '' then l.luopiskjarj_2
	-- ammatillisen koulutuksen järjestäjä _2  
	when l.suorlk = '2' and l.luopiskjarj_2 = '' and l.ammopiskjarj_2 <> '' and
	l.amkopiskjarj_2 ='' and l.yoopiskjarj_2 = ''  then l.ammopiskjarj_2
	-- lukio- ja ammatillisen koulutuksen järjestäjä, merkitään lukiokoulutuksen _2 järjestäjä 
	when l.suorlk = '2' and l.luopiskjarj_2 <> '' and l.ammopiskjarj_2 <> '' and
	l.amkopiskjarj_2 = '' and l.yoopiskjarj_2 = '' then l.luopiskjarj_2
	-- ammattikorkeakoulutuksen järjestäjä _2
	when l.suorlk = '2' and l.amkopiskjarj_2  <> '' and l.yoopiskjarj_2   = '' and
	l.luopiskjarj_2 = '' and l.ammopiskjarj_2 = '' then l.amkopiskjarj_2
	-- yliopistokoulutuksen järjestäjä _2 
	when l.suorlk = '2' and l.amkopiskjarj_2  = '' and l.yoopiskjarj_2  <> '' and 
	l.luopiskjarj_2  = '' and l.ammopiskjarj_2 = ''   then l.yoopiskjarj_2
	-- ammattikorkea- ja yliopistokoulutuksen järjestäjä, merkitään ammattikorkeakoulutuksen _2 järjestäjä   
	when l.suorlk = '2' and l.amkopiskjarj_2  <> '' and l.yoopiskjarj_2   <> '' and
	l.luopiskjarj_2  = '' and l.ammopiskjarj_2  = ''  then l.amkopiskjarj_2 

	
	else ''
	    end),
 --Koulutuksen maakunta 1
	(case
	-- lukioopiskelun maakunta _2
	when l.suorlk = '2' and l.luopiskmaak_2   <> '' and l.ammopiskmaak_2  = '' and
	l.amkopiskmaak_2  = '' and l.yoopiskmaak_2  = '' then l.luopiskmaak_2   
	-- ammatillisen koulutuksen maakunta _2
	when l.suorlk = '2' and l.luopiskmaak_2  = '' and l.ammopiskmaak_2  <> '' and
	l.amkopiskmaak_2  ='' and l.yoopiskmaak_2  = ''  then l.ammopiskmaak_2  
	-- lukiokoulutuksen ja ammatillisen koulutus otetaan lukiokoulutuksen maakunta _2
	when l.suorlk = '2' and l.luopiskmaak_2  <> '' and l.ammopiskmaak_2  <> '' and
	l.amkopiskmaak_2  = '' and l.yoopiskmaak_2  = '' then l.luopiskmaak_2 
    -- ammattikorkeakoulutuksen maakunta _2
	when l.suorlk = '2' and l.amkopiskmaak_2   <> '' and l.yoopiskmaak_2   = '' and
	l.luopiskjarj_2 = '' and l.ammopiskmaak_2 = '' then l.amkopiskmaak_2
	-- yliopistokoulutuksen maakunta _2 
	when l.suorlk = '2' and l.amkopiskmaak_2  = '' and l.yoopiskmaak_2  <> '' and 
	l.luopiskjarj_2  = '' and l.ammopiskmaak_2 = ''   then l.yoopiskmaak_2
	-- ammattikorkekoulutuksen ja yliopistokoulutksen maakunta otetaan ammattikorkeakoulutuksen maakunta _2   
	when l.suorlk = '2' and l.amkopiskmaak_2  <> '' and l.yoopiskmaak_2   <> '' and
	l.luopiskjarj_2  = '' and l.ammopiskmaak_2  = ''  then l.amkopiskmaak_2 
	
	else ''
	
	    end),
-- Koulutus 2
(case
   -- jos lukiokoulutuksessa vain niin jätetään tyhjäksi _2
	when l.suorlk = '2' and l.luopiskkoulk_2 <> '' and l.ammopiskkoulk_2 = '' and
	l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' then ''
	-- jos ammattikoulutuksessa vain  jätetään tyhjäksi _2 
	when l.suorlk = '2' and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 <> '' and
	l.amkopiskkoulk_2 ='' and l.yoopiskkoulk_2 = ''  then ''
	-- jos lukiokoulutksessa ja ammattikoulutuksessa merkitään ammattikoulutus _2 
	when l.suorlk = '2' and l.luopiskkoulk_2 <> '' and l.ammopiskkoulk_2 <> '' and
	l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' then l.ammopiskkoulk_2 
	-- jos vain ammattikorkeakoulutuksessa jätetään tyhjäksi
	when l.suorlk = '2' and l.amkopiskkoulk_2  <> '' and l.yoopiskkoulk_2  = '' and
	l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorlk = '2' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 <> '' and 
	l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = ''   then ''
	-- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus _2
	when l.suorlk = '2' and l.amkopiskkoulk_2 <> '' and l.yoopiskkoulk_2  <> '' and
	l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = ''  then l.yoopiskkoulk_2
	
	
	
	else ''
	    end),
-- Oppilaitos 2
(case
    -- lukiokoulutuksen oppilaitos vain merkitään tyhjäksi
	when l.suorlk = '2' and l.luopisktunn_2 <> '' and l.ammopisktunn_2 = '' and
	l.amkopisktunn_2 = '' and l.yoopisktunn_2 = '' then ''
	-- ammatillisen koulutuksen oppilaitos _2 merkitään tyhjäksi
	when l.suorlk = '2' and l.luopisktunn_2 = '' and l.ammopisktunn_2 <> '' and
	l.amkopisktunn_2 ='' and l.yoopisktunn_2 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos merkitään ammatillisen koulutuksen oppilaitos _2
	when l.suorlk = '2' and l.luopisktunn_2 <> '' and l.ammopisktunn_2 <> '' and
	l.amkopisktunn_2 = '' and l.yoopisktunn_2 = '' then l.ammopisktunn_2 
	-- ammattikorkeakoulutksen oppilaitos vain merkitään tyhjäksi _2
	when l.suorlk = '2' and l.amkopisktunn_2  <> '' and l.yoopisktunn_2  = '' and
	l.luopisktunn_2 = '' and l.ammopisktunn_2 = '' then ''
	-- yliopistokoulutksen oppilaitos vain merkitään tyhjäksi _2
	when l.suorlk = '2' and l.amkopisktunn_2 = '' and l.yoopisktunn_2 <> '' and 
	l.luopisktunn_2 = '' and l.ammopisktunn_2 = ''   then ''  
	--  ammattikorkeakoulutksen oppilaitos ja yliopistokoulutuksen oppilaitos, merkitään yliopistokoulutuksen oppilaitos _2
	when l.suorlk = '2' and l.amkopisktunn_2 <> '' and l.yoopisktunn_2  <> '' and
	l.luopisktunn_2 = '' and l.ammopisktunn_2 = ''  then l.yoopisktunn_2 
	
	
	else ''
	    end),
-- Koulutuksen järjestäjä 2
	(case
	-- lukiokoulutuksen järjestäjä vain _2, merkitään tyhjäksi
	when l.suorlk = '2' and l.luopiskjarj_2  <> '' and l.ammopiskjarj_2 = '' and
	l.amkopiskjarj_2 = '' and l.yoopiskjarj_2 = '' then ''
	-- ammatillisen koulutuksen järjestäjä vain _2, merkitään tyhjäksi
	when l.suorlk = '2' and l.luopiskjarj_2 = '' and l.ammopiskjarj_2 <> '' and
	l.amkopiskjarj_2 ='' and l.yoopiskjarj_2 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä _2
	when l.suorlk = '2' and l.luopiskjarj_2 <> '' and l.ammopiskjarj_2 <> '' and
	l.amkopiskjarj_2 = '' and l.yoopiskjarj_2 = '' then l.ammopiskjarj_2 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi
	when l.suorlk = '2' and l.amkopiskjarj_2  <> '' and l.yoopiskjarj_2   = '' and
	l.luopiskjarj_2 = '' and l.ammopiskjarj_2 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, merkitään tyhjäksi
	when l.suorlk = '2' and l.amkopiskjarj_2  = '' and l.yoopiskjarj_2  <> '' and 
	l.luopiskjarj_2  = '' and l.ammopiskjarj_2 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestäjä merkitään yliopistokoulutuksen järjetäjä _2
	when l.suorlk = '2' and l.amkopiskjarj_2  <> '' and l.yoopiskjarj_2   <> '' and
	l.luopiskjarj_2  = '' and l.ammopiskjarj_2  = ''  then l.yoopiskjarj_2 
	

	else ''
	    end),
-- Koulutuksen maakunta 2
	(case
	-- vain lukiokoulutuksen maakunta _2, jätetään tyhjäksi
	when l.suorlk = '2' and l.luopiskmaak_2   <> '' and l.ammopiskmaak_2  = '' and
	l.amkopiskmaak_2  = '' and l.yoopiskmaak_2  = '' then ''
	-- vain ammatillisen koulutuksen maakunta _2, jätetään tyhjäksi   
	when l.suorlk = '2' and l.luopiskmaak_2  = '' and l.ammopiskmaak_2  <> '' and
	l.amkopiskmaak_2  ='' and l.yoopiskmaak_2  = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta, merkitään ammatillisen koulutuksen maakunta _2
	when l.suorlk = '2' and l.luopiskmaak_2  <> '' and l.ammopiskmaak_2  <> '' and
	l.amkopiskmaak_2  = '' and l.yoopiskmaak_2  = '' then l.ammopiskmaak_2 
	-- vain ammattikorkeakoulutuksen maakunta _2, jätetään tyhjäksi
	when l.suorlk = '2' and l.amkopiskmaak_2   <> '' and l.yoopiskmaak_2   = '' and
	l.luopiskmaak_2 = '' and l.ammopiskmaak_2 = '' then '' 
	-- vain yliopistokoulutuksen maakunta _2, merkitään tyhjäksi
	when l.suorlk = '2' and l.amkopiskmaak_2  = '' and l.yoopiskmaak_2  <> '' and 
	l.luopiskmaak_2  = '' and l.ammopiskmaak_2 = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta _2, merkitään yliopistokoulutuksen maakunta _2
	when l.suorlk = '2' and l.amkopiskmaak_2  <> '' and l.yoopiskmaak_2   <> '' and
	l.luopiskjarj_2  = '' and l.ammopiskmaak_2  = ''  then l.yoopiskmaak_2
	

	else ''
	
	    end),
	-- Monihaku
	(case
	-- _2
	when l.suorlk = '2' then l.monihaku_2		
	else '8'
	end),
    -- Pääasiallinen toiminta
    (case
    -- _2
	when l.suorlk = '2' then l.ptoim1r4_2
	else ''
	end),
	-- Ammattiasema
	(case
	-- _2
	when l.suorlk = '2' then l.amas_2
	else ''
	end),
    l.lkm,
	l.pohjkoul,
 l.tietolahde,
 'K3.13',
 -- Lukiokoulutuksessa
 (case
	    when (l.suorlk = '2' ) and  l.luopiskkoulk_2 <> '' and l.ammopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_2 = '' then '1'    
	    else '0'
	    end) as lukiokoulutuksessa,
 -- Ammatillisessa koulutuksessa 
 (case
	    when (l.suorlk = '2') and  l.ammopiskkoulk_2  <> '' and l.luopiskkoulk_2 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' then '1' 
	    else '0'
	    end) as ammatillisessa_koulutuksessa,
-- Ammattikorkeakoulutuksessa
 (case
	   when (l.suorlk = '2') and  l.amkopiskkoulk_2 <> '' and l.ammopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.luopiskkoulk_2 = '' then  '1'
	   else '0' 
	   end) as ammattikorkeakoulutuksessa,
-- Yliopistokoulutuksessa
 (case
	    when (l.suorlk = '2') and  l.yoopiskkoulk_2  <> '' and l.amkopiskkoulk_2 = '' and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' then '1'   	   
	    else '0'
	    end) as yliopistokoulutuksessa,
-- Lukiokoulutuksessa ja ammatillisessa koulutuksessa
(case
	    when (l.suorlk = '2') and  l.luopiskkoulk_2  <> '' and l.ammopiskkoulk_2 <> '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2  = '' then '1'  
	    else '0'
	    end) as lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa,
-- Toisen asteen ammatillisessa koulutuksessa ja korkeakoulutuksessa
(case
	    when (l.suorlk = '2') and  l.ammopiskkoulk_2  <> '' and l.amkopiskkoulk_2 <> '' and l.luopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' then '1'  
	    else '0'
	    end) as toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa,
-- Ammattikorkeakoulutuksessa ja yliopistokoulutuksessa
(case
	    when (l.suorlk = '2') and  l.amkopiskkoulk_2  <> '' and l.yoopiskkoulk_2 <> '' and l.ammopiskkoulk_2  = '' and l.luopiskkoulk_2 = ''  then '1' 
	    else '0'
	    end) as ammattikorkekoulutuksessa_ja_yliopistokoulutuksessa,    
-- Koulutuksen päättäneiden toiminta
(case
	   -- Tutkintoon johtavassa koulutuksessa olevat
	   when (l.suorlk = '2')  and (l.ptoim1r4_2 = '22' or l.ptoim1r4_2 = '13')
       and	(l.luopiskkoulk_2 <>'' or l.ammopiskkoulk_2 <>'' or l.amkopiskkoulk_2 <>'' or l.yoopiskkoulk_2 <>'')   then '1' 
	
	   -- Ei tutkintoon johtavassa koulutuksessa olevat
	   when (l.suorlk = '2')  and (l.ptoim1r4_2 = '22' or l.ptoim1r4_2 = '13')
       and	(l.luopiskkoulk_2 ='' and l.ammopiskkoulk_2 ='' and l.amkopiskkoulk_2 ='' and l.yoopiskkoulk_2 ='')   then '2' 
   
   
	   -- Ei opiskelevat työlliset
	   when (l.suorlk = '2')and  l.ptoim1r4_2  = '10'  then '3' 
	   -- Ei opiskelevat työttömät
	   when (l.suorlk = '2') and  l.ptoim1r4_2  = '12'  then '4' 
	   -- Ei opiskelevat muut
		else '5' 
	   end ) as koulutuksen_paattaneiden_toiminta
 ,ika_1v = cast((case 
            when syntv = '' then '-1'
            when  (cast(tilv as int) - cast(syntv as int)) > 99 then ''
            else  ((cast(tilv as int) - cast(syntv as int))) end)  as nvarchar(10))
 ,ika_5v =cast(
       (
		case
		when (cast(tilv as int) - cast(syntv as int)) < 15 then '5v10'
		when ((cast(tilv as int) - cast(syntv as int)) >= 15 and (cast(tilv as int) - cast(syntv as int)) <= 19) then '5v15'
		when ((cast(tilv as int) - cast(syntv as int)) >= 20 and (cast(tilv as int) - cast(syntv as int)) <= 24) then '5v20'
		when ((cast(tilv as int) - cast(syntv as int)) >= 25 and (cast(tilv as int) - cast(syntv as int)) <= 29) then '5v25'
		when ((cast(tilv as int) - cast(syntv as int)) >= 30 and (cast(tilv as int) - cast(syntv as int)) <= 34) then '5v30'
		when ((cast(tilv as int) - cast(syntv as int)) >= 35 and (cast(tilv as int) - cast(syntv as int)) <= 39) then '5v35'
		when ((cast(tilv as int) - cast(syntv as int)) >= 40 and (cast(tilv as int) - cast(syntv as int)) <= 44) then '5v40'
		when ((cast(tilv as int) - cast(syntv as int)) >= 45 and (cast(tilv as int) - cast(syntv as int)) <= 49) then '5v45'
		when ((cast(tilv as int) - cast(syntv as int)) >= 50 and (cast(tilv as int) - cast(syntv as int)) <= 54) then '5v50'
		when ((cast(tilv as int) - cast(syntv as int)) >= 55 and (cast(tilv as int) - cast(syntv as int)) <= 59) then '5v55'
		when ((cast(tilv as int) - cast(syntv as int)) >= 60 and (cast(tilv as int) - cast(syntv as int)) <= 64) then '5v60'
		when ((cast(tilv as int) - cast(syntv as int)) >= 65 and (cast(tilv as int) - cast(syntv as int)) <= 69) then '5v65'
		when ((cast(tilv as int) - cast(syntv as int)) >= 70 and (cast(tilv as int) - cast(syntv as int)) <= 74) then '5v70'
		when ((cast(tilv as int) - cast(syntv as int)) >= 75 and (cast(tilv as int) - cast(syntv as int)) <= 79) then '5v75'
		when ((cast(tilv as int) - cast(syntv as int)) >= 80 and (cast(tilv as int) - cast(syntv as int)) <= 84) then '5v80'
		when ((cast(tilv as int) - cast(syntv as int)) >= 85 and (cast(tilv as int) - cast(syntv as int)) <= 89) then '5v85'
		when ((cast(tilv as int) - cast(syntv as int)) >= 90 and (cast(tilv as int) - cast(syntv as int)) <= 94) then '5v90'
		when ((cast(tilv as int) - cast(syntv as int)) >= 95) then '5v95'
		
		end
	   ) as nvarchar (10))

  ,ika_1v_suorv = cast(
					(case 
						when syntv = '' then '-1' 
						else ((cast(suorv as int) - cast(syntv as int))) 
					end)  
	as nvarchar(10))




--uudet muuttujat 03/2018


----OPISKELUT KYLLÄ/EI
--Opiskellut lukiokoulutuksessa
,case
	when l.suorlk = '2' and (l.luopiskkoulk_1 <> '' or l.luopiskkoulk_2 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk2005 <> '' or l.luopiskkoulk2006 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk2006 <> '' or l.luopiskkoulk2007 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk2007 <> '' or l.luopiskkoulk2008 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk2008 <> '' or l.luopiskkoulk2009 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '') then 1*/
	else 0
end as opisk_lu
--Opiskellut ammatillisessa peruskoulutuksessa
,case
	when   l.suorlk = '2' and (l.ammopiskkoulk_1 <> '' or l.ammopiskkoulk_2 <> '') and (d1c.Koulutusaste_taso2_koodi = '32' or d2c.Koulutusaste_taso2_koodi = '32') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2005 <> '' or l.ammopiskkoulk2006 <> '') and (d2c.Koulutusaste_taso2_koodi = '32' or d3c.Koulutusaste_taso2_koodi = '32') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2006 <> '' or l.ammopiskkoulk2007 <> '') and (d3c.Koulutusaste_taso2_koodi = '32' or d4c.Koulutusaste_taso2_koodi = '32') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2007 <> '' or l.ammopiskkoulk2008 <> '') and (d4c.Koulutusaste_taso2_koodi = '32' or d5c.Koulutusaste_taso2_koodi = '32') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2008 <> '' or l.ammopiskkoulk2009 <> '') and (d5c.Koulutusaste_taso2_koodi = '32' or d6c.Koulutusaste_taso2_koodi = '32') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '') and (d6c.Koulutusaste_taso2_koodi = '32' or d7c.Koulutusaste_taso2_koodi = '32') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '') and (d7c.Koulutusaste_taso2_koodi = '32' or d8c.Koulutusaste_taso2_koodi = '32') then 1*/
	else 0
end as opisk_amm_pk
--Opiskellut ammattitutkintokoulutuksessa
,case
	when   l.suorlk = '2' and (l.ammopiskkoulk_1 <> '' or l.ammopiskkoulk_2 <> '') and (d1c.Koulutusaste_taso2_koodi = '33' or d2c.Koulutusaste_taso2_koodi = '33') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2005 <> '' or l.ammopiskkoulk2006 <> '') and (d2c.Koulutusaste_taso2_koodi = '33' or d3c.Koulutusaste_taso2_koodi = '33') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2006 <> '' or l.ammopiskkoulk2007 <> '') and (d3c.Koulutusaste_taso2_koodi = '33' or d4c.Koulutusaste_taso2_koodi = '33') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2007 <> '' or l.ammopiskkoulk2008 <> '') and (d4c.Koulutusaste_taso2_koodi = '33' or d5c.Koulutusaste_taso2_koodi = '33') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2008 <> '' or l.ammopiskkoulk2009 <> '') and (d5c.Koulutusaste_taso2_koodi = '33' or d6c.Koulutusaste_taso2_koodi = '33') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '') and (d6c.Koulutusaste_taso2_koodi = '33' or d7c.Koulutusaste_taso2_koodi = '33') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '') and (d7c.Koulutusaste_taso2_koodi = '33' or d8c.Koulutusaste_taso2_koodi = '33') then 1*/
	else 0
end as opisk_amm_at
--Opiskellut erikoisammattitutkintokoulutuksessa
,case
	when   l.suorlk = '2' and (l.ammopiskkoulk_1 <> '' or l.ammopiskkoulk_2 <> '') and (d1c.Koulutusaste_taso2_koodi = '41' or d2c.Koulutusaste_taso2_koodi = '41') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2005 <> '' or l.ammopiskkoulk2006 <> '') and (d2c.Koulutusaste_taso2_koodi = '41' or d3c.Koulutusaste_taso2_koodi = '41') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2006 <> '' or l.ammopiskkoulk2007 <> '') and (d3c.Koulutusaste_taso2_koodi = '41' or d4c.Koulutusaste_taso2_koodi = '41') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2007 <> '' or l.ammopiskkoulk2008 <> '') and (d4c.Koulutusaste_taso2_koodi = '41' or d5c.Koulutusaste_taso2_koodi = '41') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2008 <> '' or l.ammopiskkoulk2009 <> '') and (d5c.Koulutusaste_taso2_koodi = '41' or d6c.Koulutusaste_taso2_koodi = '41') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '') and (d6c.Koulutusaste_taso2_koodi = '41' or d7c.Koulutusaste_taso2_koodi = '41') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '') and (d7c.Koulutusaste_taso2_koodi = '41' or d8c.Koulutusaste_taso2_koodi = '41') then 1*/
	else 0
end as opisk_amm_eat
--Opiskellut ammatillisessa koulutuksessa
,case
	when   l.suorlk = '2' and (l.ammopiskkoulk_1 <> '' or l.ammopiskkoulk_2 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2005 <> '' or l.ammopiskkoulk2006 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2006 <> '' or l.ammopiskkoulk2007 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2007 <> '' or l.ammopiskkoulk2008 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2008 <> '' or l.ammopiskkoulk2009 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '') then 1*/
	else 0
end as opisk_amm
--Opiskellut ammattikorkeakoulutuksessa
,case
	when   l.suorlk = '2' and (l.amkopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2005 <> '' or l.amkopiskkoulk2006 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2006 <> '' or l.amkopiskkoulk2007 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2007 <> '' or l.amkopiskkoulk2008 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '') then 1*/
	else 0
end as opisk_amk
--Opiskellut yliopistokoulutuksessa
,case
	when   l.suorlk = '2' and (l.yoopiskkoulk_1 <> '' or l.yoopiskkoulk_2 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.yoopiskkoulk2005 <> '' or l.yoopiskkoulk2006 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.yoopiskkoulk2006 <> '' or l.yoopiskkoulk2007 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.yoopiskkoulk2007 <> '' or l.yoopiskkoulk2008 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.yoopiskkoulk2008 <> '' or l.yoopiskkoulk2009 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.yoopiskkoulk2009 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '') then 1*/
	else 0
end as opisk_yo



----KOULUTUSALA, TASO 1 KYLLÄ/EI
--Opiskellut koulutusala1 (amk) (taso 1) (kyllä/ei)
,case
	when   l.suorlk = '2' and (d1a.iscfibroad2013_koodi = '01' or d2a.iscfibroad2013_koodi = '01') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2a.iscfibroad2013_koodi = '01' or d3a.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3a.iscfibroad2013_koodi = '01' or d4a.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4a.iscfibroad2013_koodi = '01' or d5a.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5a.iscfibroad2013_koodi = '01' or d6a.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6a.iscfibroad2013_koodi = '01' or d7a.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7a.iscfibroad2013_koodi = '01' or d8a.iscfibroad2013_koodi = '01') then 1*/
	else 0
end as opisk_amk_koulala1
--Opiskellut koulutusala2 (amk) (taso 1) (kyllä/ei)
,case
	when   l.suorlk = '2' and (d1a.iscfibroad2013_koodi = '02' or d2a.iscfibroad2013_koodi = '02') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2a.iscfibroad2013_koodi = '02' or d3a.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3a.iscfibroad2013_koodi = '02' or d4a.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4a.iscfibroad2013_koodi = '02' or d5a.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5a.iscfibroad2013_koodi = '02' or d6a.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6a.iscfibroad2013_koodi = '02' or d7a.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7a.iscfibroad2013_koodi = '02' or d8a.iscfibroad2013_koodi = '02') then 1*/
	else 0
end as opisk_amk_koulala2
--Opiskellut koulutusala3 (amk) (taso 1) (kyllä/ei)
,case
	when   l.suorlk = '2' and (d1a.iscfibroad2013_koodi = '03' or d2a.iscfibroad2013_koodi = '03') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2a.iscfibroad2013_koodi = '03' or d3a.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3a.iscfibroad2013_koodi = '03' or d4a.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4a.iscfibroad2013_koodi = '03' or d5a.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5a.iscfibroad2013_koodi = '03' or d6a.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6a.iscfibroad2013_koodi = '03' or d7a.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7a.iscfibroad2013_koodi = '03' or d8a.iscfibroad2013_koodi = '03') then 1*/
	else 0
end as opisk_amk_koulala3
--Opiskellut koulutusala4 (amk) (taso 1) (kyllä/ei)
,case
	when   l.suorlk = '2' and (d1a.iscfibroad2013_koodi = '04' or d2a.iscfibroad2013_koodi = '04') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2a.iscfibroad2013_koodi = '04' or d3a.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3a.iscfibroad2013_koodi = '04' or d4a.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4a.iscfibroad2013_koodi = '04' or d5a.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5a.iscfibroad2013_koodi = '04' or d6a.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6a.iscfibroad2013_koodi = '04' or d7a.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7a.iscfibroad2013_koodi = '04' or d8a.iscfibroad2013_koodi = '04') then 1*/
	else 0
end as opisk_amk_koulala4
--Opiskellut koulutusala5 (amk) (taso 1) (kyllä/ei)
,case
	when   l.suorlk = '2' and (d1a.iscfibroad2013_koodi = '05' or d2a.iscfibroad2013_koodi = '05') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2a.iscfibroad2013_koodi = '05' or d3a.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3a.iscfibroad2013_koodi = '05' or d4a.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4a.iscfibroad2013_koodi = '05' or d5a.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5a.iscfibroad2013_koodi = '05' or d6a.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6a.iscfibroad2013_koodi = '05' or d7a.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7a.iscfibroad2013_koodi = '05' or d8a.iscfibroad2013_koodi = '05') then 1*/
	else 0
end as opisk_amk_koulala5
--Opiskellut koulutusala6 (amk) (taso 1) (kyllä/ei)
,case
	when   l.suorlk = '2' and (d1a.iscfibroad2013_koodi = '06' or d2a.iscfibroad2013_koodi = '06') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2a.iscfibroad2013_koodi = '06' or d3a.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3a.iscfibroad2013_koodi = '06' or d4a.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4a.iscfibroad2013_koodi = '06' or d5a.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5a.iscfibroad2013_koodi = '06' or d6a.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6a.iscfibroad2013_koodi = '06' or d7a.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7a.iscfibroad2013_koodi = '06' or d8a.iscfibroad2013_koodi = '06') then 1*/
	else 0
end as opisk_amk_koulala6
--Opiskellut koulutusala7 (amk) (taso 1) (kyllä/ei)
,case
	when   l.suorlk = '2' and (d1a.iscfibroad2013_koodi = '07' or d2a.iscfibroad2013_koodi = '07') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2a.iscfibroad2013_koodi = '07' or d3a.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3a.iscfibroad2013_koodi = '07' or d4a.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4a.iscfibroad2013_koodi = '07' or d5a.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5a.iscfibroad2013_koodi = '07' or d6a.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6a.iscfibroad2013_koodi = '07' or d7a.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7a.iscfibroad2013_koodi = '07' or d8a.iscfibroad2013_koodi = '07') then 1*/
	else 0
end as opisk_amk_koulala7
--Opiskellut koulutusala8 (amk) (taso 1) (kyllä/ei)
,case
	when   l.suorlk = '2' and (d1a.iscfibroad2013_koodi = '08' or d2a.iscfibroad2013_koodi = '08') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2a.iscfibroad2013_koodi = '08' or d3a.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3a.iscfibroad2013_koodi = '08' or d4a.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4a.iscfibroad2013_koodi = '08' or d5a.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5a.iscfibroad2013_koodi = '08' or d6a.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6a.iscfibroad2013_koodi = '08' or d7a.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7a.iscfibroad2013_koodi = '08' or d8a.iscfibroad2013_koodi = '08') then 1*/
	else 0
end as opisk_amk_koulala8
--Opiskellut koulutusala9 (amk) (taso 1) (kyllä/ei)
,case
	when   l.suorlk = '2' and (d1a.iscfibroad2013_koodi = '09' or d2a.iscfibroad2013_koodi = '09') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2a.iscfibroad2013_koodi = '09' or d3a.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3a.iscfibroad2013_koodi = '09' or d4a.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4a.iscfibroad2013_koodi = '09' or d5a.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5a.iscfibroad2013_koodi = '09' or d6a.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6a.iscfibroad2013_koodi = '09' or d7a.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7a.iscfibroad2013_koodi = '09' or d8a.iscfibroad2013_koodi = '09') then 1*/
	else 0
end as opisk_amk_koulala9
--Opiskellut koulutusala10 (amk) (taso 1) (kyllä/ei)
,case
	when   l.suorlk = '2' and (d1a.iscfibroad2013_koodi = '10' or d2a.iscfibroad2013_koodi = '10') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2a.iscfibroad2013_koodi = '10' or d3a.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3a.iscfibroad2013_koodi = '10' or d4a.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4a.iscfibroad2013_koodi = '10' or d5a.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5a.iscfibroad2013_koodi = '10' or d6a.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6a.iscfibroad2013_koodi = '10' or d7a.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7a.iscfibroad2013_koodi = '10' or d8a.iscfibroad2013_koodi = '10') then 1*/
	else 0
end as opisk_amk_koulala10




--Opiskellut koulutusala1 (yo) (taso 1) (kyllä/ei)
,case
	when   l.suorlk = '2' and (d1b.iscfibroad2013_koodi = '01' or d2b.iscfibroad2013_koodi = '01') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2b.iscfibroad2013_koodi = '01' or d3b.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3b.iscfibroad2013_koodi = '01' or d4b.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4b.iscfibroad2013_koodi = '01' or d5b.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5b.iscfibroad2013_koodi = '01' or d6b.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6b.iscfibroad2013_koodi = '01' or d7b.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7b.iscfibroad2013_koodi = '01' or d8b.iscfibroad2013_koodi = '01') then 1*/
	else 0
end as opisk_yo_koulala1
--Opiskellut koulutusala2 (yo) (taso 1) (kyllä/ei)
,case
	when   l.suorlk = '2' and (d1b.iscfibroad2013_koodi = '02' or d2b.iscfibroad2013_koodi = '02') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2b.iscfibroad2013_koodi = '02' or d3b.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3b.iscfibroad2013_koodi = '02' or d4b.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4b.iscfibroad2013_koodi = '02' or d5b.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5b.iscfibroad2013_koodi = '02' or d6b.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6b.iscfibroad2013_koodi = '02' or d7b.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7b.iscfibroad2013_koodi = '02' or d8b.iscfibroad2013_koodi = '02') then 1*/
	else 0
end as opisk_yo_koulala2
--Opiskellut koulutusala3 (yo) (taso 1) (kyllä/ei)
,case
	when   l.suorlk = '2' and (d1b.iscfibroad2013_koodi = '03' or d2b.iscfibroad2013_koodi = '03') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2b.iscfibroad2013_koodi = '03' or d3b.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3b.iscfibroad2013_koodi = '03' or d4b.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4b.iscfibroad2013_koodi = '03' or d5b.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5b.iscfibroad2013_koodi = '03' or d6b.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6b.iscfibroad2013_koodi = '03' or d7b.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7b.iscfibroad2013_koodi = '03' or d8b.iscfibroad2013_koodi = '03') then 1*/
	else 0
end as opisk_yo_koulala3
--Opiskellut koulutusala4 (yo) (taso 1) (kyllä/ei)
,case
	when   l.suorlk = '2' and (d1b.iscfibroad2013_koodi = '04' or d2b.iscfibroad2013_koodi = '04') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2b.iscfibroad2013_koodi = '04' or d3b.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3b.iscfibroad2013_koodi = '04' or d4b.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4b.iscfibroad2013_koodi = '04' or d5b.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5b.iscfibroad2013_koodi = '04' or d6b.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6b.iscfibroad2013_koodi = '04' or d7b.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7b.iscfibroad2013_koodi = '04' or d8b.iscfibroad2013_koodi = '04') then 1*/
	else 0
end as opisk_yo_koulala4
--Opiskellut koulutusala5 (yo) (taso 1) (kyllä/ei)
,case
	when   l.suorlk = '2' and (d1b.iscfibroad2013_koodi = '05' or d2b.iscfibroad2013_koodi = '05') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2b.iscfibroad2013_koodi = '05' or d3b.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3b.iscfibroad2013_koodi = '05' or d4b.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4b.iscfibroad2013_koodi = '05' or d5b.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5b.iscfibroad2013_koodi = '05' or d6b.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6b.iscfibroad2013_koodi = '05' or d7b.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7b.iscfibroad2013_koodi = '05' or d8b.iscfibroad2013_koodi = '05') then 1*/
	else 0
end as opisk_yo_koulala5
--Opiskellut koulutusala6 (yo) (taso 1) (kyllä/ei)
,case
	when   l.suorlk = '2' and (d1b.iscfibroad2013_koodi = '06' or d2b.iscfibroad2013_koodi = '06') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2b.iscfibroad2013_koodi = '06' or d3b.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3b.iscfibroad2013_koodi = '06' or d4b.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4b.iscfibroad2013_koodi = '06' or d5b.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5b.iscfibroad2013_koodi = '06' or d6b.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6b.iscfibroad2013_koodi = '06' or d7b.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7b.iscfibroad2013_koodi = '06' or d8b.iscfibroad2013_koodi = '06') then 1*/
	else 0
end as opisk_yo_koulala6
--Opiskellut koulutusala7 (yo) (taso 1) (kyllä/ei)
,case
	when   l.suorlk = '2' and (d1b.iscfibroad2013_koodi = '07' or d2b.iscfibroad2013_koodi = '07') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2b.iscfibroad2013_koodi = '07' or d3b.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3b.iscfibroad2013_koodi = '07' or d4b.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4b.iscfibroad2013_koodi = '07' or d5b.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5b.iscfibroad2013_koodi = '07' or d6b.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6b.iscfibroad2013_koodi = '07' or d7b.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7b.iscfibroad2013_koodi = '07' or d8b.iscfibroad2013_koodi = '07') then 1*/
	else 0
end as opisk_yo_koulala7
--Opiskellut koulutusala8 (yo) (taso 1) (kyllä/ei)
,case
	when   l.suorlk = '2' and (d1b.iscfibroad2013_koodi = '08' or d2b.iscfibroad2013_koodi = '08') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2b.iscfibroad2013_koodi = '08' or d3b.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3b.iscfibroad2013_koodi = '08' or d4b.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4b.iscfibroad2013_koodi = '08' or d5b.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5b.iscfibroad2013_koodi = '08' or d6b.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6b.iscfibroad2013_koodi = '08' or d7b.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7b.iscfibroad2013_koodi = '08' or d8b.iscfibroad2013_koodi = '08') then 1*/
	else 0
end as opisk_yo_koulala8
--Opiskellut koulutusala9 (yo) (taso 1) (kyllä/ei)
,case
	when   l.suorlk = '2' and (d1b.iscfibroad2013_koodi = '09' or d2b.iscfibroad2013_koodi = '09') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2b.iscfibroad2013_koodi = '09' or d3b.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3b.iscfibroad2013_koodi = '09' or d4b.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4b.iscfibroad2013_koodi = '09' or d5b.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5b.iscfibroad2013_koodi = '09' or d6b.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6b.iscfibroad2013_koodi = '09' or d7b.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7b.iscfibroad2013_koodi = '09' or d8b.iscfibroad2013_koodi = '09') then 1*/
	else 0
end as opisk_yo_koulala9
--Opiskellut koulutusala10 (yo) (taso 1) (kyllä/ei)
,case
	when   l.suorlk = '2' and (d1b.iscfibroad2013_koodi = '10' or d2b.iscfibroad2013_koodi = '10') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2b.iscfibroad2013_koodi = '10' or d3b.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3b.iscfibroad2013_koodi = '10' or d4b.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4b.iscfibroad2013_koodi = '10' or d5b.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5b.iscfibroad2013_koodi = '10' or d6b.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6b.iscfibroad2013_koodi = '10' or d7b.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7b.iscfibroad2013_koodi = '10' or d8b.iscfibroad2013_koodi = '10') then 1*/
	else 0
end as opisk_yo_koulala10


--Opiskellut useampaa kuin yhtä alaa (taso 1) (kyllä/ei)
,case --ensimmäisenä vuotena on mahdollista olla vain yksi ala
	when   l.suorlk = '2' and m1.MinValue <> m1.MaxValue then 1 
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and m2.MinValue <> m2.MaxValue then 1 
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and m3.MinValue <> m3.MaxValue then 1 
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and m4.MinValue <> m4.MaxValue then 1 
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and m5.MinValue <> m5.MaxValue then 1 
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and m6.MinValue <> m6.MaxValue then 1 
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and m7.MinValue <> m7.MaxValue then 1 */
	else 0
end as opisk_vah2_koulala


----HAUT KYLLÄ/EI
--Hakenut ammatilliseen koulutukseen
,case
	when   l.suorlk = '2' and (l.monihaku_1 in (2,3,5) or l.monihaku_2 in (2,3,5)) then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.monihaku_2 in (2,3,5) or l.monihaku2006 in (2,3,5)) then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.monihaku2006 in (2,3,5) or l.monihaku2007 in (2,3,5)) then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.monihaku2007 in (2,3,5) or l.monihaku2008 in (2,3,5)) then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.monihaku2008 in (2,3,5) or l.monihaku2009 in (2,3,5)) then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.monihaku2009 in (2,3,5) or l.monihaku2010 in (2,3,5)) then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.monihaku2010 in (2,3,5) or l.monihaku2011 in (2,3,5)) then 1*/
	else 0
end as haku_amm
--Hakenut ammattikorkeakoulutukseen
,case
	when   l.suorlk = '2' and (l.monihaku_1 in (4,6) or l.monihaku_2 in (4,6)) then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.monihaku_2 in (4,6) or l.monihaku2006 in (4,6)) then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.monihaku2006 in (4,6) or l.monihaku2007 in (4,6)) then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.monihaku2007 in (4,6) or l.monihaku2008 in (4,6)) then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.monihaku2008 in (4,6) or l.monihaku2009 in (4,6)) then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.monihaku2009 in (4,6) or l.monihaku2010 in (4,6)) then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.monihaku2010 in (4,6) or l.monihaku2011 in (4,6)) then 1*/
	else 0
end as haku_amk
--Hakenut yliopistokoulutukseen
,case
	when   l.suorlk = '2' and (l.monihaku_1 in (6,7) or l.monihaku_2 in (6,7)) then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.monihaku_2 in (6,7) or l.monihaku2006 in (6,7)) then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.monihaku2006 in (6,7) or l.monihaku2007 in (6,7)) then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.monihaku2007 in (6,7) or l.monihaku2008 in (6,7)) then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.monihaku2008 in (6,7) or l.monihaku2009 in (6,7)) then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.monihaku2009 in (6,7) or l.monihaku2010 in (6,7)) then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.monihaku2010 in (6,7) or l.monihaku2011 in (6,7)) then 1*/
	else 0
end as haku_yo




----MITTARIT
--Ei hakenut eikä opiskellut mitään
,case
	when   l.suorlk = '2' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and l.luopiskkoulk_1 = '' and l.ammopiskkoulk_1 = '' and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and monihaku_2 not in (4,5,6,7) and monihaku2006 not in (4,5,6,7) and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.luopiskkoulk2006 = '' and l.ammopiskkoulk2006 = '' and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and monihaku2006 not in (4,5,6,7) and monihaku2007 not in (4,5,6,7) and l.luopiskkoulk2006 = '' and l.ammopiskkoulk2006 = '' and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' and l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and monihaku2007 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1*/
	else 0
end eihaku_kk_eiopisk

--Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa
,case 
	when   l.suorlk = '2' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and (l.luopiskkoulk_1 <> '' or l.ammopiskkoulk_1 <> '' or l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and monihaku_2 not in (4,5,6,7) and monihaku2006 not in (4,5,6,7) and (l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '' or l.luopiskkoulk2006 <> '' or l.ammopiskkoulk2006 <> '') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and monihaku2006 not in (4,5,6,7) and monihaku2007 not in (4,5,6,7) and (l.luopiskkoulk2006 <> '' or l.ammopiskkoulk2006 <> '' or l.luopiskkoulk2007 <> '' or l.ammopiskkoulk2007 <> '') and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and monihaku2007 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and (l.luopiskkoulk2007 <> '' or l.ammopiskkoulk2007 <> '' or l.luopiskkoulk2008 <> '' or l.ammopiskkoulk2008 <> '') and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and (l.luopiskkoulk2008 <> '' or l.ammopiskkoulk2008 <> '' or l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '') and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and (l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '') and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and (l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1*/
	else 0
end eihaku_kk_eiopisk_kk_opisk_ta

----Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa, opiskellut lukiokoulutuksessa
,case 
	when   l.suorlk = '2' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and (l.luopiskkoulk_1 <> '' or l.luopiskkoulk_2 <> '') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = ''  then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and monihaku_2 not in (4,5,6,7) and monihaku2006 not in (4,5,6,7) and (l.luopiskkoulk_2 <> '' or l.luopiskkoulk2006 <> '') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and monihaku2006 not in (4,5,6,7) and monihaku2007 not in (4,5,6,7) and (l.luopiskkoulk2006 <> '' or l.luopiskkoulk2007 <> '') and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and monihaku2007 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and (l.luopiskkoulk2007 <> '' or l.luopiskkoulk2008 <> '') and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and (l.luopiskkoulk2008 <> '' or l.luopiskkoulk2009 <> '') and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and (l.luopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '') and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and (l.luopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1*/
	else 0
end eihaku_kk_eiopisk_kk_opisk_lu

----Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa, opiskellut ammatillisessa peruskoulutuksessa
,case 
	when   l.suorlk = '2' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and (l.ammopiskkoulk_1 <> '' or l.ammopiskkoulk_2 <> '') and (d1c.Koulutusaste_taso2_koodi = '32' or d2c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and monihaku_2 not in (4,5,6,7) and monihaku2006 not in (4,5,6,7) and (l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk2006 <> '') and (d2c.Koulutusaste_taso2_koodi = '32' or d3c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and monihaku2006 not in (4,5,6,7) and monihaku2007 not in (4,5,6,7) and (l.ammopiskkoulk2006 <> '' or l.ammopiskkoulk2007 <> '') and (d3c.Koulutusaste_taso2_koodi = '32' or d4c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and monihaku2007 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and (l.ammopiskkoulk2007 <> '' or l.ammopiskkoulk2008 <> '') and (d4c.Koulutusaste_taso2_koodi = '32' or d5c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and (l.ammopiskkoulk2008 <> '' or l.ammopiskkoulk2009 <> '') and (d5c.Koulutusaste_taso2_koodi = '32' or d6c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and (l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '') and (d6c.Koulutusaste_taso2_koodi = '32' or d7c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and (l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '') and (d7c.Koulutusaste_taso2_koodi = '32' or d8c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1*/
	else 0
end eihaku_kk_eiopisk_kk_opisk_pk

------Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa, opiskellut ammattitutkintokoulutuksessa
,case 
	when   l.suorlk = '2' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and (l.ammopiskkoulk_1 <> '' or l.ammopiskkoulk_2 <> '') and (d1c.Koulutusaste_taso2_koodi = '33' or d2c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and monihaku_2 not in (4,5,6,7) and monihaku2006 not in (4,5,6,7) and (l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk2006 <> '') and (d2c.Koulutusaste_taso2_koodi = '33' or d3c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and monihaku2006 not in (4,5,6,7) and monihaku2007 not in (4,5,6,7) and (l.ammopiskkoulk2006 <> '' or l.ammopiskkoulk2007 <> '') and (d3c.Koulutusaste_taso2_koodi = '33' or d4c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and monihaku2007 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and (l.ammopiskkoulk2007 <> '' or l.ammopiskkoulk2008 <> '') and (d4c.Koulutusaste_taso2_koodi = '33' or d5c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and (l.ammopiskkoulk2008 <> '' or l.ammopiskkoulk2009 <> '') and (d5c.Koulutusaste_taso2_koodi = '33' or d6c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and (l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '') and (d6c.Koulutusaste_taso2_koodi = '33' or d7c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and (l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '') and (d7c.Koulutusaste_taso2_koodi = '33' or d8c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1*/
	else 0
end eihaku_kk_eiopisk_kk_opisk_at

------Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa, opiskellut erikoisammattitutkintokoulutuksessa
,case 
	when   l.suorlk = '2' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and (l.ammopiskkoulk_1 <> '' or l.ammopiskkoulk_2 <> '') and (d1c.Koulutusaste_taso2_koodi = '41' or d2c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and monihaku_2 not in (4,5,6,7) and monihaku2006 not in (4,5,6,7) and (l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk2006 <> '') and (d2c.Koulutusaste_taso2_koodi = '41' or d3c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and monihaku2006 not in (4,5,6,7) and monihaku2007 not in (4,5,6,7) and (l.ammopiskkoulk2006 <> '' or l.ammopiskkoulk2007 <> '') and (d3c.Koulutusaste_taso2_koodi = '41' or d4c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and monihaku2007 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and (l.ammopiskkoulk2007 <> '' or l.ammopiskkoulk2008 <> '') and (d4c.Koulutusaste_taso2_koodi = '41' or d5c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and (l.ammopiskkoulk2008 <> '' or l.ammopiskkoulk2009 <> '') and (d5c.Koulutusaste_taso2_koodi = '41' or d6c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and (l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '') and (d6c.Koulutusaste_taso2_koodi = '41' or d7c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and (l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '') and (d7c.Koulutusaste_taso2_koodi = '41' or d8c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1*/
	else 0
end eihaku_kk_eiopisk_kk_opisk_eat

--Hakenut korkea-asteelle, ei opiskellut korkea-asteella
,case 
	when   l.suorlk = '2' and (monihaku_1 in (4,5,6,7) or monihaku_2 in (4,5,6,7)) and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (monihaku_2 in (4,5,6,7) or monihaku2006 in (4,5,6,7)) and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (monihaku2006 in (4,5,6,7) or monihaku2007 in (4,5,6,7)) and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (monihaku2007 in (4,5,6,7) or monihaku2008 in (4,5,6,7)) and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (monihaku2008 in (4,5,6,7) or monihaku2009 in (4,5,6,7)) and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (monihaku2009 in (4,5,6,7) or monihaku2010 in (4,5,6,7)) and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7)) and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1*/
	else 0
end haku_kk_eiopisk_kk
----Hakenut korkea-asteelle, ei opiskellut korkea-asteella, ei-opiskellut toisen asteen koulutuksessa
,case
	when   l.suorlk = '2' and (monihaku_1 in (4,5,6,7) or monihaku_2 in (4,5,6,7)) and l.luopiskkoulk_1 = '' and l.ammopiskkoulk_1 = '' and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (monihaku_2 in (4,5,6,7) or monihaku2006 in (4,5,6,7)) and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.luopiskkoulk2006 = '' and l.ammopiskkoulk2006 = '' and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (monihaku2006 in (4,5,6,7) or monihaku2007 in (4,5,6,7)) and l.luopiskkoulk2006 = '' and l.ammopiskkoulk2006 = '' and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' and l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (monihaku2007 in (4,5,6,7) or monihaku2008 in (4,5,6,7)) and l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (monihaku2008 in (4,5,6,7) or monihaku2009 in (4,5,6,7)) and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (monihaku2009 in (4,5,6,7) or monihaku2010 in (4,5,6,7)) and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7)) and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1*/
	else 0
end haku_kk_eiopisk_kk_eiopisk_ta
----Hakenut korkea-asteelle, ei opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa
,case
	when   l.suorlk = '2' and (monihaku_1 in (4,5,6,7) or monihaku_2 in (4,5,6,7)) and (l.luopiskkoulk_1 <> '' or l.ammopiskkoulk_1 <> '' or l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (monihaku_2 in (4,5,6,7) or monihaku2006 in (4,5,6,7)) and (l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '' or l.luopiskkoulk2006 <> '' or l.ammopiskkoulk2006 <> '') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (monihaku2006 in (4,5,6,7) or monihaku2007 in (4,5,6,7)) and (l.luopiskkoulk2006 <> '' or l.ammopiskkoulk2006 <> '' or l.luopiskkoulk2007 <> '' or l.ammopiskkoulk2007 <> '') and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (monihaku2007 in (4,5,6,7) or monihaku2008 in (4,5,6,7)) and (l.luopiskkoulk2007 <> '' or l.ammopiskkoulk2007 <> '' or l.luopiskkoulk2008 <> '' or l.ammopiskkoulk2008 <> '') and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (monihaku2008 in (4,5,6,7) or monihaku2009 in (4,5,6,7)) and (l.luopiskkoulk2008 <> '' or l.ammopiskkoulk2008 <> '' or l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '') and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (monihaku2009 in (4,5,6,7) or monihaku2010 in (4,5,6,7)) and (l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '') and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7)) and (l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1*/
	else 0
end haku_kk_eiopisk_kk_opisk_ta
----Hakenut vain ammattikorkeakouluun, ei opiskellut korkea-asteella
,case
	when   l.suorlk = '2' and (monihaku_1 = 4 or monihaku_2 = 4) and (monihaku_1 not in (5,6,7) and monihaku_2 not in (5,6,7)) and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (monihaku_2 = 4 or monihaku2006 = 4) and (monihaku_2 not in (5,6,7) and monihaku2006 not in (5,6,7)) and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (monihaku2006 = 4 or monihaku2007 = 4) and (monihaku2006 not in (5,6,7) and monihaku2007 not in (5,6,7)) and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (monihaku2007 = 4 or monihaku2008 = 4) and (monihaku2007 not in (5,6,7) and monihaku2008 not in (5,6,7)) and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (monihaku2008 = 4 or monihaku2009 = 4) and (monihaku2008 not in (5,6,7) and monihaku2009 not in (5,6,7)) and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (monihaku2009 = 4 or monihaku2010 = 4) and (monihaku2009 not in (5,6,7) and monihaku2010 not in (5,6,7)) and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (monihaku2010 = 4 or monihaku2011 = 4) and (monihaku2010 not in (5,6,7) and monihaku2011 not in (5,6,7)) and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1*/
	else 0
end haku_amk_eiopisk_kk
----Hakenut vain yliopistokoulutukseen, ei opiskellut korkea-asteella
,case
	when   l.suorlk = '2' and (monihaku_1 = 7 or monihaku_2 = 7) and (monihaku_1 not in (4,5,6) and monihaku_2 not in (4,5,6)) and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (monihaku_2 = 7 or monihaku2006 = 7) and (monihaku_2 not in (4,5,6) and monihaku2006 not in (4,5,6)) and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (monihaku2006 = 7 or monihaku2007 = 7) and (monihaku2006 not in (4,5,6) and monihaku2007 not in (4,5,6)) and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (monihaku2007 = 7 or monihaku2008 = 7) and (monihaku2007 not in (4,5,6) and monihaku2008 not in (4,5,6)) and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (monihaku2008 = 7 or monihaku2009 = 7) and (monihaku2008 not in (4,5,6) and monihaku2009 not in (4,5,6)) and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (monihaku2009 = 7 or monihaku2010 = 7) and (monihaku2009 not in (4,5,6) and monihaku2010 not in (4,5,6)) and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (monihaku2010 = 7 or monihaku2011 = 7) and (monihaku2010 not in (4,5,6) and monihaku2011 not in (4,5,6)) and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1*/
	else 0
end haku_yo_eiopisk_kk
----Hakenut sekä amk- että yliopistokoulutukseen, ei opiskellut korkea-asteella
,case
	when   l.suorlk = '2' and (monihaku_1 = 6 or monihaku_2 = 6 or ((monihaku_1 = 4 or monihaku_2 = 4) and (monihaku_1 = 7 or monihaku_2 = 7))) and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (monihaku_2 = 6 or monihaku2006 = 6 or ((monihaku_2 = 4 or monihaku2006 = 4) and (monihaku_2 = 7 or monihaku2006 = 7))) and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (monihaku2006 = 6 or monihaku2007 = 6 or ((monihaku2006 = 4 or monihaku2007 = 4) and (monihaku2006 = 7 or monihaku2007 = 7))) and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (monihaku2007 = 6 or monihaku2008 = 6 or ((monihaku2007 = 4 or monihaku2008 = 4) and (monihaku2007 = 7 or monihaku2008 = 7))) and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (monihaku2008 = 6 or monihaku2009 = 6 or ((monihaku2008 = 4 or monihaku2009 = 4) and (monihaku2008 = 7 or monihaku2009 = 7))) and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (monihaku2009 = 6 or monihaku2010 = 6 or ((monihaku2009 = 4 or monihaku2010 = 4) and (monihaku2009 = 7 or monihaku2010 = 7))) and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (monihaku2010 = 6 or monihaku2011 = 6 or ((monihaku2010 = 4 or monihaku2011 = 4) and (monihaku2010 = 7 or monihaku2011 = 7))) and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1*/
	else 0
end haku_amkyo_eiopisk_kk

--Opiskellut korkea-asteella
,case
	when   l.suorlk = '2' and (l.amkopiskkoulk_1 <> '' or l.yoopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '' or l.amkopiskkoulk2006 <> '' or l.yoopiskkoulk2006 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2006 <> '' or l.yoopiskkoulk2006 <> '' or l.amkopiskkoulk2007 <> '' or l.yoopiskkoulk2007 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2007 <> '' or l.yoopiskkoulk2007 <> '' or l.amkopiskkoulk2008 <> '' or l.yoopiskkoulk2008 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2008 <> '' or l.yoopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '') then 1*/
	else 0
end opisk_kk
----Opiskellut korkea-asteella, ei-opiskellut toisen asteen koulutuksessa
,case
	when   l.suorlk = '2' and l.luopiskkoulk_1 = '' and l.ammopiskkoulk_1 = '' and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and (l.amkopiskkoulk_1 <> '' or l.yoopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and l.luopiskkoulk2006 = '' and l.ammopiskkoulk2006 = '' and (l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '' or l.amkopiskkoulk2006 <> '' or l.yoopiskkoulk2006 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and l.luopiskkoulk2006 = '' and l.ammopiskkoulk2006 = '' and l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 = '' and (l.amkopiskkoulk2006 <> '' or l.yoopiskkoulk2006 <> '' or l.amkopiskkoulk2007 <> '' or l.yoopiskkoulk2007 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 = '' and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' and (l.amkopiskkoulk2007 <> '' or l.yoopiskkoulk2007 <> '' or l.amkopiskkoulk2008 <> '' or l.yoopiskkoulk2008 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and (l.amkopiskkoulk2008 <> '' or l.yoopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and (l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and (l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '') then 1*/
	else 0
end opisk_kk_eiopisk_ta
----Opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa
,case
	when   l.suorlk = '2' and (l.luopiskkoulk_1 <> '' or l.ammopiskkoulk_1 <> '' or l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '') and (l.amkopiskkoulk_1 <> '' or l.yoopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '' or l.luopiskkoulk2006 <> '' or l.ammopiskkoulk2006 <> '') and (l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '' or l.amkopiskkoulk2006 <> '' or l.yoopiskkoulk2006 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk2006 <> '' or l.ammopiskkoulk2006 <> '' or l.luopiskkoulk2007 <> '' or l.ammopiskkoulk2007 <> '') and (l.amkopiskkoulk2006 <> '' or l.yoopiskkoulk2006 <> '' or l.amkopiskkoulk2007 <> '' or l.yoopiskkoulk2007 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk2007 <> '' or l.ammopiskkoulk2007 <> '' or l.luopiskkoulk2008 <> '' or l.ammopiskkoulk2008 <> '') and (l.amkopiskkoulk2007 <> '' or l.yoopiskkoulk2007 <> '' or l.amkopiskkoulk2008 <> '' or l.yoopiskkoulk2008 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk2008 <> '' or l.ammopiskkoulk2008 <> '' or l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '') and (l.amkopiskkoulk2008 <> '' or l.yoopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '') and (l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '') and (l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '') then 1*/
	else 0
end opisk_kk_opisk_ta
----Opiskellut vain ammattikorkeakoulussa
,case
	when   l.suorlk = '2' and (l.amkopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '') and l.yoopiskkoulk_1 = '' and l.yoopiskkoulk_2 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk_2 <> '' or l.amkopiskkoulk2006 <> '') and l.yoopiskkoulk_2 = '' and l.yoopiskkoulk2006 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2006 <> '' or l.amkopiskkoulk2007 <> '') and l.yoopiskkoulk2006 = '' and l.yoopiskkoulk2007 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2007 <> '' or l.amkopiskkoulk2008 <> '') and l.yoopiskkoulk2007 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '') and l.yoopiskkoulk2008 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '') and l.yoopiskkoulk2009 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '') and l.yoopiskkoulk2010 = '' and l.yoopiskkoulk2011 = '' then 1*/
	else 0
end opisk_vain_amk
----Opiskellut vain yliopistokoulutuksessa
,case
	when   l.suorlk = '2' and l.amkopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and (l.yoopiskkoulk_1 <> '' or l.yoopiskkoulk_2 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and l.amkopiskkoulk_2 = '' and l.amkopiskkoulk2006 = '' and (l.yoopiskkoulk_2 <> '' or l.yoopiskkoulk2006 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and l.amkopiskkoulk2006 = '' and l.amkopiskkoulk2007 = '' and (l.yoopiskkoulk2006 <> '' or l.yoopiskkoulk2007 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and l.amkopiskkoulk2007 = '' and l.amkopiskkoulk2008 = '' and (l.yoopiskkoulk2007 <> '' or l.yoopiskkoulk2008 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and l.amkopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and (l.yoopiskkoulk2008 <> '' or l.yoopiskkoulk2009 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and l.amkopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and (l.yoopiskkoulk2009 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and l.amkopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and (l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '') then 1*/
	else 0
end opisk_vain_yo
----Opiskellut sekä amk- että yliopistokoulutuksessa
,case
	when   l.suorlk = '2' and (l.amkopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '') and (l.yoopiskkoulk_1 <> '' or l.yoopiskkoulk_2 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk_2 <> '' or l.amkopiskkoulk2006 <> '') and (l.yoopiskkoulk_2 <> '' or l.yoopiskkoulk2006 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2006 <> '' or l.amkopiskkoulk2007 <> '') and (l.yoopiskkoulk2006 <> '' or l.yoopiskkoulk2007 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2007 <> '' or l.amkopiskkoulk2008 <> '') and (l.yoopiskkoulk2007 <> '' or l.yoopiskkoulk2008 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '') and (l.yoopiskkoulk2008 <> '' or l.yoopiskkoulk2009 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '') and (l.yoopiskkoulk2009 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '') and (l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '') then 1*/
	else 0
end opisk_amkyo



FROM 
    (
	select * from [VipunenTK_SA].[dbo].[v_K3_13_Perusk_paattaneet_amm_tutk_suorittaneet]
	where suorlk = '2'
	) as l


LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d1a on d1a.koulutusluokitus_avain=l.amkopiskkoulk_1
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d2a on d2a.koulutusluokitus_avain=l.amkopiskkoulk_2
/*LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d3a on d3a.koulutusluokitus_avain=l.amkopiskkoulk2006
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d4a on d4a.koulutusluokitus_avain=l.amkopiskkoulk2007
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d5a on d5a.koulutusluokitus_avain=l.amkopiskkoulk2008
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d6a on d6a.koulutusluokitus_avain=l.amkopiskkoulk2009
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d7a on d7a.koulutusluokitus_avain=l.amkopiskkoulk2010*/

LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d1b on d1b.koulutusluokitus_avain=l.yoopiskkoulk_1
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d2b on d2b.koulutusluokitus_avain=l.yoopiskkoulk_2
/*LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d3b on d3b.koulutusluokitus_avain=l.yoopiskkoulk2006
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d4b on d4b.koulutusluokitus_avain=l.yoopiskkoulk2007
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d5b on d5b.koulutusluokitus_avain=l.yoopiskkoulk2008
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d6b on d6b.koulutusluokitus_avain=l.yoopiskkoulk2009
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d7b on d7b.koulutusluokitus_avain=l.yoopiskkoulk2010*/

LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d1c on d1c.koulutusluokitus_avain=l.ammopiskkoulk_1
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d2c on d1c.koulutusluokitus_avain=l.ammopiskkoulk_2
/*LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d2c on d2c.koulutusluokitus_avain=l.ammopiskkoulk2005
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d3c on d3c.koulutusluokitus_avain=l.ammopiskkoulk2006
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d4c on d4c.koulutusluokitus_avain=l.ammopiskkoulk2007
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d5c on d5c.koulutusluokitus_avain=l.ammopiskkoulk2008
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d6c on d6c.koulutusluokitus_avain=l.ammopiskkoulk2009
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d7c on d7c.koulutusluokitus_avain=l.ammopiskkoulk2010*/

CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d1a.iscfibroad2013_koodi),(d1b.iscfibroad2013_koodi), (d2a.iscfibroad2013_koodi),(d2b.iscfibroad2013_koodi)) AS a(d)) m1
/*CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d2a.iscfibroad2013_koodi),(d2b.iscfibroad2013_koodi), (d3a.iscfibroad2013_koodi),(d3b.iscfibroad2013_koodi)) AS a(d)) m2
CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d3a.iscfibroad2013_koodi),(d3b.iscfibroad2013_koodi), (d4a.iscfibroad2013_koodi),(d4b.iscfibroad2013_koodi)) AS a(d)) m3
CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d4a.iscfibroad2013_koodi),(d4b.iscfibroad2013_koodi), (d5a.iscfibroad2013_koodi),(d5b.iscfibroad2013_koodi)) AS a(d)) m4
CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d5a.iscfibroad2013_koodi),(d5b.iscfibroad2013_koodi), (d6a.iscfibroad2013_koodi),(d6b.iscfibroad2013_koodi)) AS a(d)) m5
CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d6a.iscfibroad2013_koodi),(d6b.iscfibroad2013_koodi), (d7a.iscfibroad2013_koodi),(d7b.iscfibroad2013_koodi)) AS a(d)) m6
CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d7a.iscfibroad2013_koodi),(d7b.iscfibroad2013_koodi), (d8a.iscfibroad2013_koodi),(d8b.iscfibroad2013_koodi)) AS a(d)) m7*/
	WHERE 1=1
--end;

--
-- TULOS
-- 
/*
if @debug_what_to_run>=3 begin
	if @debug_what_to_run>0 print 'querying result';
	select * from [VipunenTK_DW].[dbo].[_koulutukseen_sijoittuneet_6v]
	--select COUNT(*) from vipunen_tk.f_tyol_ja_jatko_opin_ where aineisto=(select id from vipunen_tk.d_aineisto where aineistokoodi='4.3' and @toinen_suoritusvuosi between alkaa and paattyy)
end;

if @debug_what_to_run>0 PRINT 'all done.';
*/



GO
/****** Object:  StoredProcedure [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_1_5_tarkastelujakso]    Script Date: 29.8.2018 15:59:41 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


CREATE PROCEDURE [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_1_5_tarkastelujakso] AS
/*declare @debug_what_to_run tinyint; set @debug_what_to_run=2; -- käytä arvoa 3 vain kun teet yhden vuoden
print '$'+convert(varchar,sysdatetime(),20)+'$ '+'DEBUG (what to run)='+cast(@debug_what_to_run as varchar)+
': 0=luo vain taulut, älä tulosta mitään; 1=luo taulut ja tulosta joitakin merkittävimpiä välivaiheita; 2=luo taulut ja tulosta välivaiheet; 3=luo taulut, tulosta välivaiheet ja tulosta myös tulokset, 4=tulosta välivaiheet, mutta älä tee mitään';




-- lisätään data
if @debug_what_to_run not in (4) begin
if @debug_what_to_run>0 print 'inserting data';

-- parametrimuuttujien arvot
-- parametrimuuttujat
DECLARE @ensimmainen_suoritusvuosi int;
DECLARE @toinen_suoritusvuosi int;
DECLARE @kolmas_suoritusvuosi int;
DECLARE @neljas_suoritusvuosi int;
DECLARE @viides_suoritusvuosi int;
DECLARE @kuudes_suoritusvuosi int;
DECLARE @seitsemas_suoritusvuosi int;


set @ensimmainen_suoritusvuosi = _2;
set @toinen_suoritusvuosi = 2005;
set @kolmas_suoritusvuosi = 2006;
set @neljas_suoritusvuosi = 2007;
set @viides_suoritusvuosi = 2008;
set @kuudes_suoritusvuosi = 2009;
set @seitsemas_suoritusvuosi = 2010;

*/

INSERT INTO [VipunenTK_DW].[dbo].[_koulutukseen_sijoittuneet_6v_tarkastelu]
(
rivinumero
, tarkastelujakso
, tilv 
, tilv_date
, tutkryh 
, suorv
, suorlk 
, sp 
, syntv
, aikielir1 
, tutkkaskun 
, kansalr1
, pohjmaa 
, eumaa 
, etamaa 
, tunn
, jarj
, kkielir1 
, tutklaja 
, tutktav 
, aikoul 
, tutkmaak
, koulutus_1
, oppilaitos_1
, koulutuksen_jarjestaja_1
, koulutuksen_maakunta_1
, koulutus_2
, oppilaitos_2
, koulutuksen_jarjestaja_2
, koulutuksen_maakunta_2
, monihaku
, paaasiallinen_toiminta
, ammattiasema
, lkm
, pohjkoulk
, tietolahde
, aineisto
, lukiokoulutuksessa
, ammatillisessa_koulutuksessa
, ammattikorkeakoulutuksessa
, yliopistokoulutuksessa
, lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa
, toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa
, ammattikorkeakoulutuksessa_ja_yliopistokoulutuksessa
, koulutuksen_paattaneiden_toiminta
, ika_1v
, ika_5v
, ika_1v_suorv
, opisk_lu
, opisk_amm_pk
, opisk_amm_at
, opisk_amm_eat
, opisk_amm
, opisk_amk
, opisk_yo
, opisk_amk_koulala1
, opisk_amk_koulala2
, opisk_amk_koulala3
, opisk_amk_koulala4
, opisk_amk_koulala5
, opisk_amk_koulala6
, opisk_amk_koulala7
, opisk_amk_koulala8
, opisk_amk_koulala9
, opisk_amk_koulala10
, opisk_yo_koulala1
, opisk_yo_koulala2
, opisk_yo_koulala3
, opisk_yo_koulala4
, opisk_yo_koulala5
, opisk_yo_koulala6
, opisk_yo_koulala7
, opisk_yo_koulala8
, opisk_yo_koulala9
, opisk_yo_koulala10
, opisk_vah2_koulala
, haku_amm
, haku_amk
, haku_yo
, eihaku_kk_eiopisk
, eihaku_kk_eiopisk_kk_opisk_ta
, eihaku_kk_eiopisk_kk_opisk_lu
, eihaku_kk_eiopisk_kk_opisk_pk
, eihaku_kk_eiopisk_kk_opisk_at
, eihaku_kk_eiopisk_kk_opisk_eat
, haku_kk_eiopisk_kk
, haku_kk_eiopisk_kk_eiopisk_ta
, haku_kk_eiopisk_kk_opisk_ta
, haku_amk_eiopisk_kk
, haku_yo_eiopisk_kk
, haku_amkyo_eiopisk_kk
, opisk_kk
, opisk_kk_eiopisk_ta
, opisk_kk_opisk_ta
, opisk_vain_amk
, opisk_vain_yo
, opisk_amkyo
)
SELECT
 l.rivinumero,
 '1,5',
 l.tilv,
 l.tilv_date,
 (case 
	when l.tutkryh=3 and tutklaja=1 then 31
	when l.tutkryh=3 and tutklaja=2 then 32
	when l.tutkryh=3 and tutklaja=3 then 33
	else l.tutkryh
  end),
 l.suorv,
  (case
	when l.suorlk = '1'  then (l.suorv+'0'+l.suorlk)
	when l.suorlk = '2'  then (l.suorv+'0'+'8')
	else ''
	end),
 l.sp,
 l.syntv,
 l.aikielir1,
 l.tutkaskun,
 l.kansalr1,
 l.pohjmaa,
 l.eumaa,
 l.etamaa,
 l.tunn,
 l.jarj,
 l.kkielir1,
 l.tutklaja,
 l.tutktav,
 l.aikoul,
 l.tutkmaak,
 -- Koulutus 1
 (case
    --lukiokoulutuksessa _3
	when l.suorlk = '2' and l.luopiskkoulk_3 <> '' and l.ammopiskkoulk_3 = '' and
	l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' then l.luopiskkoulk_3 
	-- ammattikoulutuksessa _3
	when l.suorlk = '2' and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 <> '' and
	l.amkopiskkoulk_3 ='' and l.yoopiskkoulk_3 = ''  then l.ammopiskkoulk_3 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen _3 ensim. koulutustietoihin
	when l.suorlk = '2' and l.luopiskkoulk_3 <> '' and l.ammopiskkoulk_3 <> '' and
	l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' then l.luopiskkoulk_3
	-- ammattikorkeakoulutuksessa _3
	when l.suorlk = '2' and l.amkopiskkoulk_3  <> '' and l.yoopiskkoulk_3  = '' and
	l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' then l.amkopiskkoulk_3
	-- yliopistokoulutuksessa _3
	when l.suorlk = '2' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 <> '' and 
	l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = ''   then l.yoopiskkoulk_3
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa, merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorlk = '2' and l.amkopiskkoulk_3 <> '' and l.yoopiskkoulk_3  <> '' and
	l.luopiskkoulk_3 = '' and ammopiskkoulk_3 = ''  then l.amkopiskkoulk_3 
	
	else ''

	
	    
	    end),
	    
-- Oppilaitos 1
	(case
	-- lukiokoulutuksen oppilaitos _3
	when l.suorlk = '2' and l.luopisktunn_3 <> '' and l.ammopisktunn_3 = '' and
	l.amkopisktunn_3 = '' and l.yoopisktunn_3 = '' then l.luopisktunn_3 
	-- ammattikoulutuksen oppilaitos _3
	when l.suorlk = '2' and l.luopisktunn_3 = '' and l.ammopisktunn_3 <> '' and
	l.amkopisktunn_3 ='' and l.yoopisktunn_3 = ''  then l.ammopisktunn_3 
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos _3
	when l.suorlk = '2' and l.luopisktunn_3 <> '' and l.ammopisktunn_3 <> '' and
	l.amkopisktunn_3 = '' and l.yoopisktunn_3 = '' then l.luopisktunn_3
	-- ammattikorkeakoulutuksen oppilaitos _3
	when l.suorlk = '2' and l.amkopisktunn_3  <> '' and l.yoopisktunn_3  = '' and
	l.luopisktunn_3 = '' and l.ammopisktunn_3 = '' then l.amkopisktunn_3
	-- yliopistokoulutuksen oppilaitos _3
	when l.suorlk = '2' and l.amkopisktunn_3 = '' and l.yoopisktunn_3 <> '' and 
	l.luopisktunn_3 = '' and l.ammopisktunn_3 = ''   then l.yoopisktunn_3
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus _3  
	when l.suorlk = '2' and l.amkopisktunn_3 <> '' and l.yoopisktunn_3  <> '' and
	l.luopisktunn_3 = '' and l.ammopisktunn_3 = ''  then l.amkopisktunn_3 
	
	
	

	
	else ''
	
	    end),
  --Koulutuksen järjestäjä 1
	(case
	-- lukikoulutuksen järjestäjä _3
	when l.suorlk = '2' and l.luopiskjarj_3  <> '' and l.ammopiskjarj_3 = '' and
	l.amkopiskjarj_3 = '' and yoopiskjarj_3 = '' then l.luopiskjarj_3
	-- ammatillisen koulutuksen järjestäjä _3  
	when l.suorlk = '2' and l.luopiskjarj_3 = '' and l.ammopiskjarj_3 <> '' and
	l.amkopiskjarj_3 ='' and l.yoopiskjarj_3 = ''  then l.ammopiskjarj_3
	-- lukio- ja ammatillisen koulutuksen järjestäjä, merkitään lukiokoulutuksen _3 järjestäjä 
	when l.suorlk = '2' and l.luopiskjarj_3 <> '' and l.ammopiskjarj_3 <> '' and
	l.amkopiskjarj_3 = '' and l.yoopiskjarj_3 = '' then l.luopiskjarj_3
	-- ammattikorkeakoulutuksen järjestäjä _3
	when l.suorlk = '2' and l.amkopiskjarj_3  <> '' and l.yoopiskjarj_3   = '' and
	l.luopiskjarj_3 = '' and l.ammopiskjarj_3 = '' then l.amkopiskjarj_3
	-- yliopistokoulutuksen järjestäjä _3 
	when l.suorlk = '2' and l.amkopiskjarj_3  = '' and l.yoopiskjarj_3  <> '' and 
	l.luopiskjarj_3  = '' and l.ammopiskjarj_3 = ''   then l.yoopiskjarj_3
	-- ammattikorkea- ja yliopistokoulutuksen järjestäjä, merkitään ammattikorkeakoulutuksen _3 järjestäjä   
	when l.suorlk = '2' and l.amkopiskjarj_3  <> '' and l.yoopiskjarj_3   <> '' and
	l.luopiskjarj_3  = '' and l.ammopiskjarj_3  = ''  then l.amkopiskjarj_3 

	
	else ''
	    end),
 --Koulutuksen maakunta 1
	(case
	-- lukioopiskelun maakunta _3
	when l.suorlk = '2' and l.luopiskmaak_3   <> '' and l.ammopiskmaak_3  = '' and
	l.amkopiskmaak_3  = '' and l.yoopiskmaak_3  = '' then l.luopiskmaak_3   
	-- ammatillisen koulutuksen maakunta _3
	when l.suorlk = '2' and l.luopiskmaak_3  = '' and l.ammopiskmaak_3  <> '' and
	l.amkopiskmaak_3  ='' and l.yoopiskmaak_3  = ''  then l.ammopiskmaak_3  
	-- lukiokoulutuksen ja ammatillisen koulutus otetaan lukiokoulutuksen maakunta _3
	when l.suorlk = '2' and l.luopiskmaak_3  <> '' and l.ammopiskmaak_3  <> '' and
	l.amkopiskmaak_3  = '' and l.yoopiskmaak_3  = '' then l.luopiskmaak_3 
    -- ammattikorkeakoulutuksen maakunta _3
	when l.suorlk = '2' and l.amkopiskmaak_3   <> '' and l.yoopiskmaak_3   = '' and
	l.luopiskjarj_3 = '' and l.ammopiskmaak_3 = '' then l.amkopiskmaak_3
	-- yliopistokoulutuksen maakunta _3 
	when l.suorlk = '2' and l.amkopiskmaak_3  = '' and l.yoopiskmaak_3  <> '' and 
	l.luopiskjarj_3  = '' and l.ammopiskmaak_3 = ''   then l.yoopiskmaak_3
	-- ammattikorkekoulutuksen ja yliopistokoulutksen maakunta otetaan ammattikorkeakoulutuksen maakunta _3   
	when l.suorlk = '2' and l.amkopiskmaak_3  <> '' and l.yoopiskmaak_3   <> '' and
	l.luopiskjarj_3  = '' and l.ammopiskmaak_3  = ''  then l.amkopiskmaak_3 
	
	else ''
	
	    end),
-- Koulutus 2
(case
   -- jos lukiokoulutuksessa vain niin jätetään tyhjäksi _3
	when l.suorlk = '2' and l.luopiskkoulk_3 <> '' and l.ammopiskkoulk_3 = '' and
	l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' then ''
	-- jos ammattikoulutuksessa vain  jätetään tyhjäksi _3 
	when l.suorlk = '2' and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 <> '' and
	l.amkopiskkoulk_3 ='' and l.yoopiskkoulk_3 = ''  then ''
	-- jos lukiokoulutksessa ja ammattikoulutuksessa merkitään ammattikoulutus _3 
	when l.suorlk = '2' and l.luopiskkoulk_3 <> '' and l.ammopiskkoulk_3 <> '' and
	l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' then l.ammopiskkoulk_3 
	-- jos vain ammattikorkeakoulutuksessa jätetään tyhjäksi
	when l.suorlk = '2' and l.amkopiskkoulk_3  <> '' and l.yoopiskkoulk_3  = '' and
	l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorlk = '2' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 <> '' and 
	l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = ''   then ''
	-- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus _3
	when l.suorlk = '2' and l.amkopiskkoulk_3 <> '' and l.yoopiskkoulk_3  <> '' and
	l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = ''  then l.yoopiskkoulk_3
	
	
	
	else ''
	    end),
-- Oppilaitos 2
(case
    -- lukiokoulutuksen oppilaitos vain merkitään tyhjäksi
	when l.suorlk = '2' and l.luopisktunn_3 <> '' and l.ammopisktunn_3 = '' and
	l.amkopisktunn_3 = '' and l.yoopisktunn_3 = '' then ''
	-- ammatillisen koulutuksen oppilaitos _3 merkitään tyhjäksi
	when l.suorlk = '2' and l.luopisktunn_3 = '' and l.ammopisktunn_3 <> '' and
	l.amkopisktunn_3 ='' and l.yoopisktunn_3 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos merkitään ammatillisen koulutuksen oppilaitos _3
	when l.suorlk = '2' and l.luopisktunn_3 <> '' and l.ammopisktunn_3 <> '' and
	l.amkopisktunn_3 = '' and l.yoopisktunn_3 = '' then l.ammopisktunn_3 
	-- ammattikorkeakoulutksen oppilaitos vain merkitään tyhjäksi _3
	when l.suorlk = '2' and l.amkopisktunn_3  <> '' and l.yoopisktunn_3  = '' and
	l.luopisktunn_3 = '' and l.ammopisktunn_3 = '' then ''
	-- yliopistokoulutksen oppilaitos vain merkitään tyhjäksi _3
	when l.suorlk = '2' and l.amkopisktunn_3 = '' and l.yoopisktunn_3 <> '' and 
	l.luopisktunn_3 = '' and l.ammopisktunn_3 = ''   then ''  
	--  ammattikorkeakoulutksen oppilaitos ja yliopistokoulutuksen oppilaitos, merkitään yliopistokoulutuksen oppilaitos _3
	when l.suorlk = '2' and l.amkopisktunn_3 <> '' and l.yoopisktunn_3  <> '' and
	l.luopisktunn_3 = '' and l.ammopisktunn_3 = ''  then l.yoopisktunn_3 
	
	
	else ''
	    end),
-- Koulutuksen järjestäjä 2
	(case
	-- lukiokoulutuksen järjestäjä vain _3, merkitään tyhjäksi
	when l.suorlk = '2' and l.luopiskjarj_3  <> '' and l.ammopiskjarj_3 = '' and
	l.amkopiskjarj_3 = '' and l.yoopiskjarj_3 = '' then ''
	-- ammatillisen koulutuksen järjestäjä vain _3, merkitään tyhjäksi
	when l.suorlk = '2' and l.luopiskjarj_3 = '' and l.ammopiskjarj_3 <> '' and
	l.amkopiskjarj_3 ='' and l.yoopiskjarj_3 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä _3
	when l.suorlk = '2' and l.luopiskjarj_3 <> '' and l.ammopiskjarj_3 <> '' and
	l.amkopiskjarj_3 = '' and l.yoopiskjarj_3 = '' then l.ammopiskjarj_3 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi
	when l.suorlk = '2' and l.amkopiskjarj_3  <> '' and l.yoopiskjarj_3   = '' and
	l.luopiskjarj_3 = '' and l.ammopiskjarj_3 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, merkitään tyhjäksi
	when l.suorlk = '2' and l.amkopiskjarj_3  = '' and l.yoopiskjarj_3  <> '' and 
	l.luopiskjarj_3  = '' and l.ammopiskjarj_3 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestäjä merkitään yliopistokoulutuksen järjetäjä _3
	when l.suorlk = '2' and l.amkopiskjarj_3  <> '' and l.yoopiskjarj_3   <> '' and
	l.luopiskjarj_3  = '' and l.ammopiskjarj_3  = ''  then l.yoopiskjarj_3 
	

	else ''
	    end),
-- Koulutuksen maakunta 2
	(case
	-- vain lukiokoulutuksen maakunta _3, jätetään tyhjäksi
	when l.suorlk = '2' and l.luopiskmaak_3   <> '' and l.ammopiskmaak_3  = '' and
	l.amkopiskmaak_3  = '' and l.yoopiskmaak_3  = '' then ''
	-- vain ammatillisen koulutuksen maakunta _3, jätetään tyhjäksi   
	when l.suorlk = '2' and l.luopiskmaak_3  = '' and l.ammopiskmaak_3  <> '' and
	l.amkopiskmaak_3  ='' and l.yoopiskmaak_3  = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta, merkitään ammatillisen koulutuksen maakunta _3
	when l.suorlk = '2' and l.luopiskmaak_3  <> '' and l.ammopiskmaak_3  <> '' and
	l.amkopiskmaak_3  = '' and l.yoopiskmaak_3  = '' then l.ammopiskmaak_3 
	-- vain ammattikorkeakoulutuksen maakunta _3, jätetään tyhjäksi
	when l.suorlk = '2' and l.amkopiskmaak_3   <> '' and l.yoopiskmaak_3   = '' and
	l.luopiskmaak_3 = '' and l.ammopiskmaak_3 = '' then '' 
	-- vain yliopistokoulutuksen maakunta _3, merkitään tyhjäksi
	when l.suorlk = '2' and l.amkopiskmaak_3  = '' and l.yoopiskmaak_3  <> '' and 
	l.luopiskmaak_3  = '' and l.ammopiskmaak_3 = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta _3, merkitään yliopistokoulutuksen maakunta _3
	when l.suorlk = '2' and l.amkopiskmaak_3  <> '' and l.yoopiskmaak_3   <> '' and
	l.luopiskjarj_3  = '' and l.ammopiskmaak_3  = ''  then l.yoopiskmaak_3
	

	else ''
	
	    end),
	-- Monihaku
	(case
	-- _3
	when l.suorlk = '2' then l.monihaku_3		
	else '8'
	end),
    -- Pääasiallinen toiminta
    (case
    -- _3
	when l.suorlk = '2' then l.ptoim1r4_3
	else ''
	end),
	-- Ammattiasema
	(case
	-- _3
	when l.suorlk = '2' then l.amas_3
	else ''
	end),
    l.lkm,
	l.pohjkoul,
 l.tietolahde,
 'K3.13',
 -- Lukiokoulutuksessa
 (case
	    when (l.suorlk = '2' ) and  l.luopiskkoulk_3 <> '' and l.ammopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_3 = '' then '1'    
	    else '0'
	    end) as lukiokoulutuksessa,
 -- Ammatillisessa koulutuksessa 
 (case
	    when (l.suorlk = '2') and  l.ammopiskkoulk_3  <> '' and l.luopiskkoulk_3 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' then '1' 
	    else '0'
	    end) as ammatillisessa_koulutuksessa,
-- Ammattikorkeakoulutuksessa
 (case
	   when (l.suorlk = '2') and  l.amkopiskkoulk_3 <> '' and l.ammopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.luopiskkoulk_3 = '' then  '1'
	   else '0' 
	   end) as ammattikorkeakoulutuksessa,
-- Yliopistokoulutuksessa
 (case
	    when (l.suorlk = '2') and  l.yoopiskkoulk_3  <> '' and l.amkopiskkoulk_3 = '' and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' then '1'   	   
	    else '0'
	    end) as yliopistokoulutuksessa,
-- Lukiokoulutuksessa ja ammatillisessa koulutuksessa
(case
	    when (l.suorlk = '2') and  l.luopiskkoulk_3  <> '' and l.ammopiskkoulk_3 <> '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3  = '' then '1'  
	    else '0'
	    end) as lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa,
-- Toisen asteen ammatillisessa koulutuksessa ja korkeakoulutuksessa
(case
	    when (l.suorlk = '2') and  l.ammopiskkoulk_3  <> '' and l.amkopiskkoulk_3 <> '' and l.luopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' then '1'  
	    else '0'
	    end) as toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa,
-- Ammattikorkeakoulutuksessa ja yliopistokoulutuksessa
(case
	    when (l.suorlk = '2') and  l.amkopiskkoulk_3  <> '' and l.yoopiskkoulk_3 <> '' and l.ammopiskkoulk_3  = '' and l.luopiskkoulk_3 = ''  then '1' 
	    else '0'
	    end) as ammattikorkekoulutuksessa_ja_yliopistokoulutuksessa,    
-- Koulutuksen päättäneiden toiminta
(case
	   -- Tutkintoon johtavassa koulutuksessa olevat
	   when (l.suorlk = '2')  and (l.ptoim1r4_3 = '22' or l.ptoim1r4_3 = '13')
       and	(l.luopiskkoulk_3 <>'' or l.ammopiskkoulk_3 <>'' or l.amkopiskkoulk_3 <>'' or l.yoopiskkoulk_3 <>'')   then '1' 
	
	   -- Ei tutkintoon johtavassa koulutuksessa olevat
	   when (l.suorlk = '2')  and (l.ptoim1r4_3 = '22' or l.ptoim1r4_3 = '13')
       and	(l.luopiskkoulk_3 ='' and l.ammopiskkoulk_3 ='' and l.amkopiskkoulk_3 ='' and l.yoopiskkoulk_3 ='')   then '2' 
   
   
	   -- Ei opiskelevat työlliset
	   when (l.suorlk = '2')and  l.ptoim1r4_3  = '10'  then '3' 
	   -- Ei opiskelevat työttömät
	   when (l.suorlk = '2') and  l.ptoim1r4_3  = '12'  then '4' 
	   -- Ei opiskelevat muut
		else '5' 
	   end ) as koulutuksen_paattaneiden_toiminta
 ,ika_1v = cast((case 
            when syntv = '' then '-1'
            when  (cast(tilv as int) - cast(syntv as int)) > 99 then ''
            else  ((cast(tilv as int) - cast(syntv as int))) end)  as nvarchar(10))
 ,ika_5v =cast(
       (
		case
		when (cast(tilv as int) - cast(syntv as int)) < 15 then '5v10'
		when ((cast(tilv as int) - cast(syntv as int)) >= 15 and (cast(tilv as int) - cast(syntv as int)) <= 19) then '5v15'
		when ((cast(tilv as int) - cast(syntv as int)) >= 20 and (cast(tilv as int) - cast(syntv as int)) <= 24) then '5v20'
		when ((cast(tilv as int) - cast(syntv as int)) >= 25 and (cast(tilv as int) - cast(syntv as int)) <= 29) then '5v25'
		when ((cast(tilv as int) - cast(syntv as int)) >= 30 and (cast(tilv as int) - cast(syntv as int)) <= 34) then '5v30'
		when ((cast(tilv as int) - cast(syntv as int)) >= 35 and (cast(tilv as int) - cast(syntv as int)) <= 39) then '5v35'
		when ((cast(tilv as int) - cast(syntv as int)) >= 40 and (cast(tilv as int) - cast(syntv as int)) <= 44) then '5v40'
		when ((cast(tilv as int) - cast(syntv as int)) >= 45 and (cast(tilv as int) - cast(syntv as int)) <= 49) then '5v45'
		when ((cast(tilv as int) - cast(syntv as int)) >= 50 and (cast(tilv as int) - cast(syntv as int)) <= 54) then '5v50'
		when ((cast(tilv as int) - cast(syntv as int)) >= 55 and (cast(tilv as int) - cast(syntv as int)) <= 59) then '5v55'
		when ((cast(tilv as int) - cast(syntv as int)) >= 60 and (cast(tilv as int) - cast(syntv as int)) <= 64) then '5v60'
		when ((cast(tilv as int) - cast(syntv as int)) >= 65 and (cast(tilv as int) - cast(syntv as int)) <= 69) then '5v65'
		when ((cast(tilv as int) - cast(syntv as int)) >= 70 and (cast(tilv as int) - cast(syntv as int)) <= 74) then '5v70'
		when ((cast(tilv as int) - cast(syntv as int)) >= 75 and (cast(tilv as int) - cast(syntv as int)) <= 79) then '5v75'
		when ((cast(tilv as int) - cast(syntv as int)) >= 80 and (cast(tilv as int) - cast(syntv as int)) <= 84) then '5v80'
		when ((cast(tilv as int) - cast(syntv as int)) >= 85 and (cast(tilv as int) - cast(syntv as int)) <= 89) then '5v85'
		when ((cast(tilv as int) - cast(syntv as int)) >= 90 and (cast(tilv as int) - cast(syntv as int)) <= 94) then '5v90'
		when ((cast(tilv as int) - cast(syntv as int)) >= 95) then '5v95'
		
		end
	   ) as nvarchar (10))

  ,ika_1v_suorv = cast(
					(case 
						when syntv = '' then '-1' 
						else ((cast(suorv as int) - cast(syntv as int))) 
					end)  
	as nvarchar(10))




--uudet muuttujat 03/2018
----OPISKELUT KYLLÄ/EI
--Opiskellut lukiokoulutuksessa
,case
	when  l.suorlk = '2' and (l.luopiskkoulk_1 <> '' or l.luopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.luopiskkoulk2007 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk_3 <> '' or l.luopiskkoulk2007 <> '' or l.luopiskkoulk2008 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk2007 <> '' or l.luopiskkoulk2008 <> '' or l.luopiskkoulk2009 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk2008 <> '' or l.luopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '') then 1*/
	else 0
end as opisk_lu
--Opiskellut ammatillisessa peruskoulutuksessa
,case
	when  l.suorlk = '2' and (l.ammopiskkoulk_1 <> '' or l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk_3 <> '') and (d1c.Koulutusaste_taso2_koodi = '32' or d2c.Koulutusaste_taso2_koodi = '32' or d3c.Koulutusaste_taso2_koodi = '32') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk2007 <> '') and (d2c.Koulutusaste_taso2_koodi = '32' or d3c.Koulutusaste_taso2_koodi = '32' or d4c.Koulutusaste_taso2_koodi = '32') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk2007 <> '' or l.ammopiskkoulk2008 <> '') and (d3c.Koulutusaste_taso2_koodi = '32' or d4c.Koulutusaste_taso2_koodi = '32' or d5c.Koulutusaste_taso2_koodi = '32') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2007 <> '' or l.ammopiskkoulk2008 <> '' or l.ammopiskkoulk2009 <> '') and (d4c.Koulutusaste_taso2_koodi = '32' or d5c.Koulutusaste_taso2_koodi = '32' or d6c.Koulutusaste_taso2_koodi = '32') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2008 <> '' or l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '') and (d5c.Koulutusaste_taso2_koodi = '32' or d6c.Koulutusaste_taso2_koodi = '32' or d7c.Koulutusaste_taso2_koodi = '32') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '') and (d6c.Koulutusaste_taso2_koodi = '32' or d7c.Koulutusaste_taso2_koodi = '32' or d8c.Koulutusaste_taso2_koodi = '32') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '') and (d7c.Koulutusaste_taso2_koodi = '32' or d8c.Koulutusaste_taso2_koodi = '32' or d9c.Koulutusaste_taso2_koodi = '32') then 1*/
	else 0
end as opisk_amm_pk
--Opiskellut ammattitutkintokoulutuksessa
,case
	when  l.suorlk = '2' and (l.ammopiskkoulk_1 <> '' or l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk_3 <> '') and (d1c.Koulutusaste_taso2_koodi = '33' or d2c.Koulutusaste_taso2_koodi = '33' or d3c.Koulutusaste_taso2_koodi = '33') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk2007 <> '') and (d2c.Koulutusaste_taso2_koodi = '33' or d3c.Koulutusaste_taso2_koodi = '33' or d4c.Koulutusaste_taso2_koodi = '33') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk2007 <> '' or l.ammopiskkoulk2008 <> '') and (d3c.Koulutusaste_taso2_koodi = '33' or d4c.Koulutusaste_taso2_koodi = '33' or d5c.Koulutusaste_taso2_koodi = '33') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2007 <> '' or l.ammopiskkoulk2008 <> '' or l.ammopiskkoulk2009 <> '') and (d4c.Koulutusaste_taso2_koodi = '33' or d5c.Koulutusaste_taso2_koodi = '33' or d6c.Koulutusaste_taso2_koodi = '33') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2008 <> '' or l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '') and (d5c.Koulutusaste_taso2_koodi = '33' or d6c.Koulutusaste_taso2_koodi = '33' or d7c.Koulutusaste_taso2_koodi = '33') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '') and (d6c.Koulutusaste_taso2_koodi = '33' or d7c.Koulutusaste_taso2_koodi = '33' or d8c.Koulutusaste_taso2_koodi = '33') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '') and (d7c.Koulutusaste_taso2_koodi = '33' or d8c.Koulutusaste_taso2_koodi = '33' or d9c.Koulutusaste_taso2_koodi = '33') then 1*/
	else 0
end as opisk_amm_at
--Opiskellut erikoisammattitutkintokoulutuksessa
,case
	when  l.suorlk = '2' and (l.ammopiskkoulk_1 <> '' or l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk_3 <> '') and (d1c.Koulutusaste_taso2_koodi = '41' or d2c.Koulutusaste_taso2_koodi = '41' or d3c.Koulutusaste_taso2_koodi = '41') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk2007 <> '') and (d2c.Koulutusaste_taso2_koodi = '41' or d3c.Koulutusaste_taso2_koodi = '41' or d4c.Koulutusaste_taso2_koodi = '41') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk2007 <> '' or l.ammopiskkoulk2008 <> '') and (d3c.Koulutusaste_taso2_koodi = '41' or d4c.Koulutusaste_taso2_koodi = '41' or d5c.Koulutusaste_taso2_koodi = '41') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2007 <> '' or l.ammopiskkoulk2008 <> '' or l.ammopiskkoulk2009 <> '') and (d4c.Koulutusaste_taso2_koodi = '41' or d5c.Koulutusaste_taso2_koodi = '41' or d6c.Koulutusaste_taso2_koodi = '41') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2008 <> '' or l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '') and (d5c.Koulutusaste_taso2_koodi = '41' or d6c.Koulutusaste_taso2_koodi = '41' or d7c.Koulutusaste_taso2_koodi = '41') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '') and (d6c.Koulutusaste_taso2_koodi = '41' or d7c.Koulutusaste_taso2_koodi = '41' or d8c.Koulutusaste_taso2_koodi = '41') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '') and (d7c.Koulutusaste_taso2_koodi = '41' or d8c.Koulutusaste_taso2_koodi = '41' or d9c.Koulutusaste_taso2_koodi = '41') then 1*/
	else 0
end as opisk_amm_eat
--Opiskellut ammatillisessa koulutuksessa
,case
	when  l.suorlk = '2' and (l.ammopiskkoulk_1 <> '' or l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk_3 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk2007 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk2007 <> '' or l.ammopiskkoulk2008 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2007 <> '' or l.ammopiskkoulk2008 <> '' or l.ammopiskkoulk2009 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2008 <> '' or l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '') then 1*/
	else 0
end as opisk_amm
--Opiskellut ammattikorkeakoulutuksessa
,case
	when  l.suorlk = '2' and (l.amkopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.amkopiskkoulk2007 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk_3 <> '' or l.amkopiskkoulk2007 <> '' or l.amkopiskkoulk2008 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2007 <> '' or l.amkopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '') then 1*/
	else 0
end as opisk_amk
--Opiskellut yliopistokoulutuksessa
,case
	when  l.suorlk = '2' and (l.yoopiskkoulk_1 <> '' or l.yoopiskkoulk_2 <> '' or l.yoopiskkoulk_3 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.yoopiskkoulk_2 <> '' or l.yoopiskkoulk_3 <> '' or l.yoopiskkoulk2007 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.yoopiskkoulk_3 <> '' or l.yoopiskkoulk2007 <> '' or l.yoopiskkoulk2008 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.yoopiskkoulk2007 <> '' or l.yoopiskkoulk2008 <> '' or l.yoopiskkoulk2009 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.yoopiskkoulk2008 <> '' or l.yoopiskkoulk2009 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.yoopiskkoulk2009 <> '' or l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '' or l.yoopiskkoulk2012 <> '') then 1*/
	else 0
end as opisk_yo



----KOULUTUSALA, TASO 1 KYLLÄ/EI
--Opiskellut koulutusala1 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1a.iscfibroad2013_koodi = '01' or d2a.iscfibroad2013_koodi = '01' or d3a.iscfibroad2013_koodi = '01') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2a.iscfibroad2013_koodi = '01' or d3a.iscfibroad2013_koodi = '01' or d4a.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3a.iscfibroad2013_koodi = '01' or d4a.iscfibroad2013_koodi = '01' or d5a.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4a.iscfibroad2013_koodi = '01' or d5a.iscfibroad2013_koodi = '01' or d6a.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5a.iscfibroad2013_koodi = '01' or d6a.iscfibroad2013_koodi = '01' or d7a.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6a.iscfibroad2013_koodi = '01' or d7a.iscfibroad2013_koodi = '01' or d8a.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7a.iscfibroad2013_koodi = '01' or d8a.iscfibroad2013_koodi = '01' or d9a.iscfibroad2013_koodi = '01') then 1*/
	else 0
end as opisk_amk_koulala1
--Opiskellut koulutusala2 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1a.iscfibroad2013_koodi = '02' or d2a.iscfibroad2013_koodi = '02' or d3a.iscfibroad2013_koodi = '02') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2a.iscfibroad2013_koodi = '02' or d3a.iscfibroad2013_koodi = '02' or d4a.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3a.iscfibroad2013_koodi = '02' or d4a.iscfibroad2013_koodi = '02' or d5a.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4a.iscfibroad2013_koodi = '02' or d5a.iscfibroad2013_koodi = '02' or d6a.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5a.iscfibroad2013_koodi = '02' or d6a.iscfibroad2013_koodi = '02' or d7a.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6a.iscfibroad2013_koodi = '02' or d7a.iscfibroad2013_koodi = '02' or d8a.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7a.iscfibroad2013_koodi = '02' or d8a.iscfibroad2013_koodi = '02' or d9a.iscfibroad2013_koodi = '02') then 1*/
	else 0
end as opisk_amk_koulala2
--Opiskellut koulutusala3 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1a.iscfibroad2013_koodi = '03' or d2a.iscfibroad2013_koodi = '03' or d3a.iscfibroad2013_koodi = '03') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2a.iscfibroad2013_koodi = '03' or d3a.iscfibroad2013_koodi = '03' or d4a.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3a.iscfibroad2013_koodi = '03' or d4a.iscfibroad2013_koodi = '03' or d5a.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4a.iscfibroad2013_koodi = '03' or d5a.iscfibroad2013_koodi = '03' or d6a.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5a.iscfibroad2013_koodi = '03' or d6a.iscfibroad2013_koodi = '03' or d7a.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6a.iscfibroad2013_koodi = '03' or d7a.iscfibroad2013_koodi = '03' or d8a.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7a.iscfibroad2013_koodi = '03' or d8a.iscfibroad2013_koodi = '03' or d9a.iscfibroad2013_koodi = '03') then 1*/
	else 0
end as opisk_amk_koulala3
--Opiskellut koulutusala4 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1a.iscfibroad2013_koodi = '04' or d2a.iscfibroad2013_koodi = '04' or d3a.iscfibroad2013_koodi = '04') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2a.iscfibroad2013_koodi = '04' or d3a.iscfibroad2013_koodi = '04' or d4a.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3a.iscfibroad2013_koodi = '04' or d4a.iscfibroad2013_koodi = '04' or d5a.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4a.iscfibroad2013_koodi = '04' or d5a.iscfibroad2013_koodi = '04' or d6a.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5a.iscfibroad2013_koodi = '04' or d6a.iscfibroad2013_koodi = '04' or d7a.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6a.iscfibroad2013_koodi = '04' or d7a.iscfibroad2013_koodi = '04' or d8a.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7a.iscfibroad2013_koodi = '04' or d8a.iscfibroad2013_koodi = '04' or d9a.iscfibroad2013_koodi = '04') then 1*/
	else 0
end as opisk_amk_koulala4
--Opiskellut koulutusala5 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1a.iscfibroad2013_koodi = '05' or d2a.iscfibroad2013_koodi = '05' or d3a.iscfibroad2013_koodi = '05') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2a.iscfibroad2013_koodi = '05' or d3a.iscfibroad2013_koodi = '05' or d4a.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3a.iscfibroad2013_koodi = '05' or d4a.iscfibroad2013_koodi = '05' or d5a.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4a.iscfibroad2013_koodi = '05' or d5a.iscfibroad2013_koodi = '05' or d6a.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5a.iscfibroad2013_koodi = '05' or d6a.iscfibroad2013_koodi = '05' or d7a.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6a.iscfibroad2013_koodi = '05' or d7a.iscfibroad2013_koodi = '05' or d8a.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7a.iscfibroad2013_koodi = '05' or d8a.iscfibroad2013_koodi = '05' or d9a.iscfibroad2013_koodi = '05') then 1*/
	else 0
end as opisk_amk_koulala5
--Opiskellut koulutusala6 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1a.iscfibroad2013_koodi = '06' or d2a.iscfibroad2013_koodi = '06' or d3a.iscfibroad2013_koodi = '06') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2a.iscfibroad2013_koodi = '06' or d3a.iscfibroad2013_koodi = '06' or d4a.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3a.iscfibroad2013_koodi = '06' or d4a.iscfibroad2013_koodi = '06' or d5a.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4a.iscfibroad2013_koodi = '06' or d5a.iscfibroad2013_koodi = '06' or d6a.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5a.iscfibroad2013_koodi = '06' or d6a.iscfibroad2013_koodi = '06' or d7a.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6a.iscfibroad2013_koodi = '06' or d7a.iscfibroad2013_koodi = '06' or d8a.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7a.iscfibroad2013_koodi = '06' or d8a.iscfibroad2013_koodi = '06' or d9a.iscfibroad2013_koodi = '06') then 1*/
	else 0
end as opisk_amk_koulala6
--Opiskellut koulutusala7 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1a.iscfibroad2013_koodi = '07' or d2a.iscfibroad2013_koodi = '07' or d3a.iscfibroad2013_koodi = '07') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2a.iscfibroad2013_koodi = '07' or d3a.iscfibroad2013_koodi = '07' or d4a.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3a.iscfibroad2013_koodi = '07' or d4a.iscfibroad2013_koodi = '07' or d5a.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4a.iscfibroad2013_koodi = '07' or d5a.iscfibroad2013_koodi = '07' or d6a.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5a.iscfibroad2013_koodi = '07' or d6a.iscfibroad2013_koodi = '07' or d7a.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6a.iscfibroad2013_koodi = '07' or d7a.iscfibroad2013_koodi = '07' or d8a.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7a.iscfibroad2013_koodi = '07' or d8a.iscfibroad2013_koodi = '07' or d9a.iscfibroad2013_koodi = '07') then 1*/
	else 0
end as opisk_amk_koulala7
--Opiskellut koulutusala8 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1a.iscfibroad2013_koodi = '08' or d2a.iscfibroad2013_koodi = '08' or d3a.iscfibroad2013_koodi = '08') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2a.iscfibroad2013_koodi = '08' or d3a.iscfibroad2013_koodi = '08' or d4a.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3a.iscfibroad2013_koodi = '08' or d4a.iscfibroad2013_koodi = '08' or d5a.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4a.iscfibroad2013_koodi = '08' or d5a.iscfibroad2013_koodi = '08' or d6a.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5a.iscfibroad2013_koodi = '08' or d6a.iscfibroad2013_koodi = '08' or d7a.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6a.iscfibroad2013_koodi = '08' or d7a.iscfibroad2013_koodi = '08' or d8a.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7a.iscfibroad2013_koodi = '08' or d8a.iscfibroad2013_koodi = '08' or d9a.iscfibroad2013_koodi = '08') then 1*/
	else 0
end as opisk_amk_koulala8
--Opiskellut koulutusala9 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1a.iscfibroad2013_koodi = '09' or d2a.iscfibroad2013_koodi = '09' or d3a.iscfibroad2013_koodi = '09') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2a.iscfibroad2013_koodi = '09' or d3a.iscfibroad2013_koodi = '09' or d4a.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3a.iscfibroad2013_koodi = '09' or d4a.iscfibroad2013_koodi = '09' or d5a.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4a.iscfibroad2013_koodi = '09' or d5a.iscfibroad2013_koodi = '09' or d6a.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5a.iscfibroad2013_koodi = '09' or d6a.iscfibroad2013_koodi = '09' or d7a.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6a.iscfibroad2013_koodi = '09' or d7a.iscfibroad2013_koodi = '09' or d8a.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7a.iscfibroad2013_koodi = '09' or d8a.iscfibroad2013_koodi = '09' or d9a.iscfibroad2013_koodi = '09') then 1*/
	else 0
end as opisk_amk_koulala9
--Opiskellut koulutusala10 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1a.iscfibroad2013_koodi = '10' or d2a.iscfibroad2013_koodi = '10' or d3a.iscfibroad2013_koodi = '10') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2a.iscfibroad2013_koodi = '10' or d3a.iscfibroad2013_koodi = '10' or d4a.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3a.iscfibroad2013_koodi = '10' or d4a.iscfibroad2013_koodi = '10' or d5a.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4a.iscfibroad2013_koodi = '10' or d5a.iscfibroad2013_koodi = '10' or d6a.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5a.iscfibroad2013_koodi = '10' or d6a.iscfibroad2013_koodi = '10' or d7a.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6a.iscfibroad2013_koodi = '10' or d7a.iscfibroad2013_koodi = '10' or d8a.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7a.iscfibroad2013_koodi = '10' or d8a.iscfibroad2013_koodi = '10' or d9a.iscfibroad2013_koodi = '10') then 1*/
	else 0
end as opisk_amk_koulala10




--Opiskellut koulutusala1 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1b.iscfibroad2013_koodi = '01' or d2b.iscfibroad2013_koodi = '01' or d3b.iscfibroad2013_koodi = '01') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2b.iscfibroad2013_koodi = '01' or d3b.iscfibroad2013_koodi = '01' or d4b.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3b.iscfibroad2013_koodi = '01' or d4b.iscfibroad2013_koodi = '01' or d5b.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4b.iscfibroad2013_koodi = '01' or d5b.iscfibroad2013_koodi = '01' or d6b.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5b.iscfibroad2013_koodi = '01' or d6b.iscfibroad2013_koodi = '01' or d7b.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6b.iscfibroad2013_koodi = '01' or d7b.iscfibroad2013_koodi = '01' or d8b.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7b.iscfibroad2013_koodi = '01' or d8b.iscfibroad2013_koodi = '01' or d9b.iscfibroad2013_koodi = '01') then 1*/
	else 0
end as opisk_yo_koulala1
--Opiskellut koulutusala2 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1b.iscfibroad2013_koodi = '02' or d2b.iscfibroad2013_koodi = '02' or d3b.iscfibroad2013_koodi = '02') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2b.iscfibroad2013_koodi = '02' or d3b.iscfibroad2013_koodi = '02' or d4b.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3b.iscfibroad2013_koodi = '02' or d4b.iscfibroad2013_koodi = '02' or d5b.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4b.iscfibroad2013_koodi = '02' or d5b.iscfibroad2013_koodi = '02' or d6b.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5b.iscfibroad2013_koodi = '02' or d6b.iscfibroad2013_koodi = '02' or d7b.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6b.iscfibroad2013_koodi = '02' or d7b.iscfibroad2013_koodi = '02' or d8b.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7b.iscfibroad2013_koodi = '02' or d8b.iscfibroad2013_koodi = '02' or d9b.iscfibroad2013_koodi = '02') then 1*/
	else 0
end as opisk_yo_koulala2
--Opiskellut koulutusala3 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1b.iscfibroad2013_koodi = '03' or d2b.iscfibroad2013_koodi = '03' or d3b.iscfibroad2013_koodi = '03') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2b.iscfibroad2013_koodi = '03' or d3b.iscfibroad2013_koodi = '03' or d4b.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3b.iscfibroad2013_koodi = '03' or d4b.iscfibroad2013_koodi = '03' or d5b.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4b.iscfibroad2013_koodi = '03' or d5b.iscfibroad2013_koodi = '03' or d6b.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5b.iscfibroad2013_koodi = '03' or d6b.iscfibroad2013_koodi = '03' or d7b.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6b.iscfibroad2013_koodi = '03' or d7b.iscfibroad2013_koodi = '03' or d8b.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7b.iscfibroad2013_koodi = '03' or d8b.iscfibroad2013_koodi = '03' or d9b.iscfibroad2013_koodi = '03') then 1*/
	else 0
end as opisk_yo_koulala3
--Opiskellut koulutusala4 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1b.iscfibroad2013_koodi = '04' or d2b.iscfibroad2013_koodi = '04' or d3b.iscfibroad2013_koodi = '04') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2b.iscfibroad2013_koodi = '04' or d3b.iscfibroad2013_koodi = '04' or d4b.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3b.iscfibroad2013_koodi = '04' or d4b.iscfibroad2013_koodi = '04' or d5b.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4b.iscfibroad2013_koodi = '04' or d5b.iscfibroad2013_koodi = '04' or d6b.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5b.iscfibroad2013_koodi = '04' or d6b.iscfibroad2013_koodi = '04' or d7b.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6b.iscfibroad2013_koodi = '04' or d7b.iscfibroad2013_koodi = '04' or d8b.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7b.iscfibroad2013_koodi = '04' or d8b.iscfibroad2013_koodi = '04' or d9b.iscfibroad2013_koodi = '04') then 1*/
	else 0
end as opisk_yo_koulala4
--Opiskellut koulutusala5 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1b.iscfibroad2013_koodi = '05' or d2b.iscfibroad2013_koodi = '05' or d3b.iscfibroad2013_koodi = '05') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2b.iscfibroad2013_koodi = '05' or d3b.iscfibroad2013_koodi = '05' or d4b.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3b.iscfibroad2013_koodi = '05' or d4b.iscfibroad2013_koodi = '05' or d5b.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4b.iscfibroad2013_koodi = '05' or d5b.iscfibroad2013_koodi = '05' or d6b.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5b.iscfibroad2013_koodi = '05' or d6b.iscfibroad2013_koodi = '05' or d7b.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6b.iscfibroad2013_koodi = '05' or d7b.iscfibroad2013_koodi = '05' or d8b.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7b.iscfibroad2013_koodi = '05' or d8b.iscfibroad2013_koodi = '05' or d9b.iscfibroad2013_koodi = '05') then 1*/
	else 0
end as opisk_yo_koulala5
--Opiskellut koulutusala6 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1b.iscfibroad2013_koodi = '06' or d2b.iscfibroad2013_koodi = '06' or d3b.iscfibroad2013_koodi = '06') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2b.iscfibroad2013_koodi = '06' or d3b.iscfibroad2013_koodi = '06' or d4b.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3b.iscfibroad2013_koodi = '06' or d4b.iscfibroad2013_koodi = '06' or d5b.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4b.iscfibroad2013_koodi = '06' or d5b.iscfibroad2013_koodi = '06' or d6b.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5b.iscfibroad2013_koodi = '06' or d6b.iscfibroad2013_koodi = '06' or d7b.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6b.iscfibroad2013_koodi = '06' or d7b.iscfibroad2013_koodi = '06' or d8b.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7b.iscfibroad2013_koodi = '06' or d8b.iscfibroad2013_koodi = '06' or d9b.iscfibroad2013_koodi = '06') then 1*/
	else 0
end as opisk_yo_koulala6
--Opiskellut koulutusala7 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1b.iscfibroad2013_koodi = '07' or d2b.iscfibroad2013_koodi = '07' or d3b.iscfibroad2013_koodi = '07') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2b.iscfibroad2013_koodi = '07' or d3b.iscfibroad2013_koodi = '07' or d4b.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3b.iscfibroad2013_koodi = '07' or d4b.iscfibroad2013_koodi = '07' or d5b.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4b.iscfibroad2013_koodi = '07' or d5b.iscfibroad2013_koodi = '07' or d6b.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5b.iscfibroad2013_koodi = '07' or d6b.iscfibroad2013_koodi = '07' or d7b.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6b.iscfibroad2013_koodi = '07' or d7b.iscfibroad2013_koodi = '07' or d8b.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7b.iscfibroad2013_koodi = '07' or d8b.iscfibroad2013_koodi = '07' or d9b.iscfibroad2013_koodi = '07') then 1*/
	else 0
end as opisk_yo_koulala7
--Opiskellut koulutusala8 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1b.iscfibroad2013_koodi = '08' or d2b.iscfibroad2013_koodi = '08' or d3b.iscfibroad2013_koodi = '08') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2b.iscfibroad2013_koodi = '08' or d3b.iscfibroad2013_koodi = '08' or d4b.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3b.iscfibroad2013_koodi = '08' or d4b.iscfibroad2013_koodi = '08' or d5b.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4b.iscfibroad2013_koodi = '08' or d5b.iscfibroad2013_koodi = '08' or d6b.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5b.iscfibroad2013_koodi = '08' or d6b.iscfibroad2013_koodi = '08' or d7b.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6b.iscfibroad2013_koodi = '08' or d7b.iscfibroad2013_koodi = '08' or d8b.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7b.iscfibroad2013_koodi = '08' or d8b.iscfibroad2013_koodi = '08' or d9b.iscfibroad2013_koodi = '08') then 1*/
	else 0
end as opisk_yo_koulala8
--Opiskellut koulutusala9 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1b.iscfibroad2013_koodi = '09' or d2b.iscfibroad2013_koodi = '09' or d3b.iscfibroad2013_koodi = '09') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2b.iscfibroad2013_koodi = '09' or d3b.iscfibroad2013_koodi = '09' or d4b.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3b.iscfibroad2013_koodi = '09' or d4b.iscfibroad2013_koodi = '09' or d5b.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4b.iscfibroad2013_koodi = '09' or d5b.iscfibroad2013_koodi = '09' or d6b.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5b.iscfibroad2013_koodi = '09' or d6b.iscfibroad2013_koodi = '09' or d7b.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6b.iscfibroad2013_koodi = '09' or d7b.iscfibroad2013_koodi = '09' or d8b.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7b.iscfibroad2013_koodi = '09' or d8b.iscfibroad2013_koodi = '09' or d9b.iscfibroad2013_koodi = '09') then 1*/
	else 0
end as opisk_yo_koulala9
--Opiskellut koulutusala10 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1b.iscfibroad2013_koodi = '10' or d2b.iscfibroad2013_koodi = '10' or d3b.iscfibroad2013_koodi = '10') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2b.iscfibroad2013_koodi = '10' or d3b.iscfibroad2013_koodi = '10' or d4b.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3b.iscfibroad2013_koodi = '10' or d4b.iscfibroad2013_koodi = '10' or d5b.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4b.iscfibroad2013_koodi = '10' or d5b.iscfibroad2013_koodi = '10' or d6b.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5b.iscfibroad2013_koodi = '10' or d6b.iscfibroad2013_koodi = '10' or d7b.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6b.iscfibroad2013_koodi = '10' or d7b.iscfibroad2013_koodi = '10' or d8b.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7b.iscfibroad2013_koodi = '10' or d8b.iscfibroad2013_koodi = '10' or d9b.iscfibroad2013_koodi = '10') then 1*/
	else 0
end as opisk_yo_koulala10


--Opiskellut useampaa kuin yhtä alaa (taso 1) (kyllä/ei)
,case --ensimmäisenä vuotena on mahdollista olla vain yksi ala
	when  l.suorlk = '2' and m1.MinValue <> m1.MaxValue then 1 
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and m2.MinValue <> m2.MaxValue then 1 
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and m3.MinValue <> m3.MaxValue then 1 
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and m4.MinValue <> m4.MaxValue then 1 
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and m5.MinValue <> m5.MaxValue then 1 
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and m6.MinValue <> m6.MaxValue then 1 
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and m7.MinValue <> m7.MaxValue then 1 */
	else 0
end as opisk_vah2_koulala


----HAUT KYLLÄ/EI
--Hakenut ammatilliseen koulutukseen
,case
	when  l.suorlk = '2' and (l.monihaku_1 in (2,3,5) or l.monihaku_2 in (2,3,5) or l.monihaku_3 in (2,3,5)) then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.monihaku_2 in (2,3,5) or l.monihaku_3 in (2,3,5) or l.monihaku2007 in (2,3,5)) then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.monihaku_3 in (2,3,5) or l.monihaku2007 in (2,3,5) or l.monihaku2008 in (2,3,5)) then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.monihaku2007 in (2,3,5) or l.monihaku2008 in (2,3,5) or l.monihaku2009 in (2,3,5)) then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.monihaku2008 in (2,3,5) or l.monihaku2009 in (2,3,5) or l.monihaku2010 in (2,3,5)) then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.monihaku2009 in (2,3,5) or l.monihaku2010 in (2,3,5) or l.monihaku2011 in (2,3,5)) then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.monihaku2010 in (2,3,5) or l.monihaku2011 in (2,3,5) or l.monihaku2012 in (2,3,5)) then 1*/
	else 0
end as haku_amm
--Hakenut ammattikorkeakoulutukseen
,case
	when  l.suorlk = '2' and (l.monihaku_1 in (4,6) or l.monihaku_2 in (4,6) or l.monihaku_3 in (4,6)) then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.monihaku_2 in (4,6) or l.monihaku_3 in (4,6) or l.monihaku2007 in (4,6)) then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.monihaku_3 in (4,6) or l.monihaku2007 in (4,6) or l.monihaku2008 in (4,6)) then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.monihaku2007 in (4,6) or l.monihaku2008 in (4,6) or l.monihaku2009 in (4,6)) then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.monihaku2008 in (4,6) or l.monihaku2009 in (4,6) or l.monihaku2010 in (4,6)) then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.monihaku2009 in (4,6) or l.monihaku2010 in (4,6) or l.monihaku2011 in (4,6)) then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.monihaku2010 in (4,6) or l.monihaku2011 in (4,6) or l.monihaku2012 in (4,6)) then 1*/
	else 0
end as haku_amk
--Hakenut yliopistokoulutukseen
,case
	when  l.suorlk = '2' and (l.monihaku_1 in (6,7) or l.monihaku_2 in (6,7) or l.monihaku_3 in (6,7)) then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.monihaku_2 in (6,7) or l.monihaku_3 in (6,7) or l.monihaku2007 in (6,7)) then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.monihaku_3 in (6,7) or l.monihaku2007 in (6,7) or l.monihaku2008 in (6,7)) then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.monihaku2007 in (6,7) or l.monihaku2008 in (6,7) or l.monihaku2009 in (6,7)) then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.monihaku2008 in (6,7) or l.monihaku2009 in (6,7) or l.monihaku2010 in (6,7)) then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.monihaku2009 in (6,7) or l.monihaku2010 in (6,7) or l.monihaku2011 in (6,7)) then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.monihaku2010 in (6,7) or l.monihaku2011 in (6,7) or l.monihaku2012 in (6,7)) then 1*/
	else 0
end as haku_yo




----MITTARIT
--Ei hakenut eikä opiskellut mitään
,case
	when  l.suorlk = '2' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and l.luopiskkoulk_1 = '' and l.ammopiskkoulk_1 = '' and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku2007 not in (4,5,6,7) and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and monihaku_3 not in (4,5,6,7) and monihaku2007 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and monihaku2007 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1*/
	else 0
end eihaku_kk_eiopisk

--Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa
,case 
	when  l.suorlk = '2' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and (l.luopiskkoulk_1 <> '' or l.ammopiskkoulk_1 <> '' or l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku2007 not in (4,5,6,7) and (l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '' or l.luopiskkoulk2007 <> '' or l.ammopiskkoulk2007 <> '') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and monihaku_3 not in (4,5,6,7) and monihaku2007 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and (l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '' or l.luopiskkoulk2007 <> '' or l.ammopiskkoulk2007 <> '' or l.luopiskkoulk2008 <> '' or l.ammopiskkoulk2008 <> '') and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and monihaku2007 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and (l.luopiskkoulk2007 <> '' or l.ammopiskkoulk2007 <> '' or l.luopiskkoulk2008 <> '' or l.ammopiskkoulk2008 <> '' or l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '') and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and (l.luopiskkoulk2008 <> '' or l.ammopiskkoulk2008 <> '' or l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '') and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and (l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '') and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and (l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1*/
	else 0
end eihaku_kk_eiopisk_kk_opisk_ta

----Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa, opiskellut lukiokoulutuksessa
,case 
	when  l.suorlk = '2' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and (l.luopiskkoulk_1 <> '' or l.luopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku2007 not in (4,5,6,7) and (l.luopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.luopiskkoulk2007 <> '') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and monihaku_3 not in (4,5,6,7) and monihaku2007 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and (l.luopiskkoulk_3 <> '' or l.luopiskkoulk2007 <> '' or l.luopiskkoulk2008 <> '') and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and monihaku2007 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and (l.luopiskkoulk2007 <> '' or l.luopiskkoulk2008 <> '' or l.luopiskkoulk2009 <> '') and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and (l.luopiskkoulk2008 <> '' or l.luopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '') and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and (l.luopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '') and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and (l.luopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1*/
	else 0
end eihaku_kk_eiopisk_kk_opisk_lu

----Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa, opiskellut ammatillisessa peruskoulutuksessa
,case 
	when  l.suorlk = '2' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and (d1c.Koulutusaste_taso2_koodi = '32' or d2c.Koulutusaste_taso2_koodi = '32' or d3c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku2007 not in (4,5,6,7) and (d2c.Koulutusaste_taso2_koodi = '32' or d3c.Koulutusaste_taso2_koodi = '32' or d4c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and monihaku_3 not in (4,5,6,7) and monihaku2007 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and (d3c.Koulutusaste_taso2_koodi = '32' or d4c.Koulutusaste_taso2_koodi = '32' or d5c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and monihaku2007 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and (d4c.Koulutusaste_taso2_koodi = '32' or d5c.Koulutusaste_taso2_koodi = '32' or d6c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and (d5c.Koulutusaste_taso2_koodi = '32' or d6c.Koulutusaste_taso2_koodi = '32' or d7c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and (d6c.Koulutusaste_taso2_koodi = '32' or d7c.Koulutusaste_taso2_koodi = '32' or d8c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and (d7c.Koulutusaste_taso2_koodi = '32' or d8c.Koulutusaste_taso2_koodi = '32' or d9c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1*/
	else 0
end eihaku_kk_eiopisk_kk_opisk_pk

------Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa, opiskellut ammattitutkintokoulutuksessa
,case 
	when  l.suorlk = '2' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and (d1c.Koulutusaste_taso2_koodi = '33' or d2c.Koulutusaste_taso2_koodi = '33' or d3c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku2007 not in (4,5,6,7) and (d2c.Koulutusaste_taso2_koodi = '33' or d3c.Koulutusaste_taso2_koodi = '33' or d4c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and monihaku_3 not in (4,5,6,7) and monihaku2007 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and (d3c.Koulutusaste_taso2_koodi = '33' or d4c.Koulutusaste_taso2_koodi = '33' or d5c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and monihaku2007 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and (d4c.Koulutusaste_taso2_koodi = '33' or d5c.Koulutusaste_taso2_koodi = '33' or d6c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and (d5c.Koulutusaste_taso2_koodi = '33' or d6c.Koulutusaste_taso2_koodi = '33' or d7c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and (d6c.Koulutusaste_taso2_koodi = '33' or d7c.Koulutusaste_taso2_koodi = '33' or d8c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and (d7c.Koulutusaste_taso2_koodi = '33' or d8c.Koulutusaste_taso2_koodi = '33' or d9c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1*/
	else 0
end eihaku_kk_eiopisk_kk_opisk_at

------Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa, opiskellut erikoisammattitutkintokoulutuksessa
,case 
	when  l.suorlk = '2' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and (d1c.Koulutusaste_taso2_koodi = '41' or d2c.Koulutusaste_taso2_koodi = '41' or d3c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku2007 not in (4,5,6,7) and (d2c.Koulutusaste_taso2_koodi = '41' or d3c.Koulutusaste_taso2_koodi = '41' or d4c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and monihaku_3 not in (4,5,6,7) and monihaku2007 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and (d3c.Koulutusaste_taso2_koodi = '41' or d4c.Koulutusaste_taso2_koodi = '41' or d5c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and monihaku2007 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and (d4c.Koulutusaste_taso2_koodi = '41' or d5c.Koulutusaste_taso2_koodi = '41' or d6c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and (d5c.Koulutusaste_taso2_koodi = '41' or d6c.Koulutusaste_taso2_koodi = '41' or d7c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and (d6c.Koulutusaste_taso2_koodi = '41' or d7c.Koulutusaste_taso2_koodi = '41' or d8c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and (d7c.Koulutusaste_taso2_koodi = '41' or d8c.Koulutusaste_taso2_koodi = '41' or d9c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1*/
	else 0
end eihaku_kk_eiopisk_kk_opisk_eat

--Hakenut korkea-asteelle, ei opiskellut korkea-asteella
,case 
	when  l.suorlk = '2' and (monihaku_1 in (4,5,6,7) or monihaku_2 in (4,5,6,7) or monihaku_3 in (4,5,6,7)) and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (monihaku_2 in (4,5,6,7) or monihaku_3 in (4,5,6,7) or monihaku2007 in (4,5,6,7)) and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (monihaku_3 in (4,5,6,7) or monihaku2007 in (4,5,6,7) or monihaku2008 in (4,5,6,7)) and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (monihaku2007 in (4,5,6,7) or monihaku2008 in (4,5,6,7) or monihaku2009 in (4,5,6,7)) and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (monihaku2008 in (4,5,6,7) or monihaku2009 in (4,5,6,7) or monihaku2010 in (4,5,6,7)) and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (monihaku2009 in (4,5,6,7) or monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7)) and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7) or monihaku2012 in (4,5,6,7)) and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1*/
	else 0
end haku_kk_eiopisk_kk
----Hakenut korkea-asteelle, ei opiskellut korkea-asteella, ei-opiskellut toisen asteen koulutuksessa
,case
	when  l.suorlk = '2' and (monihaku_1 in (4,5,6,7) or monihaku_2 in (4,5,6,7) or monihaku_3 in (4,5,6,7)) and l.luopiskkoulk_1 = '' and l.ammopiskkoulk_1 = '' and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (monihaku_2 in (4,5,6,7) or monihaku_3 in (4,5,6,7) or monihaku2007 in (4,5,6,7)) and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (monihaku_3 in (4,5,6,7) or monihaku2007 in (4,5,6,7) or monihaku2008 in (4,5,6,7)) and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (monihaku2007 in (4,5,6,7) or monihaku2008 in (4,5,6,7) or monihaku2009 in (4,5,6,7)) and l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (monihaku2008 in (4,5,6,7) or monihaku2009 in (4,5,6,7) or monihaku2010 in (4,5,6,7)) and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (monihaku2009 in (4,5,6,7) or monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7)) and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7) or monihaku2012 in (4,5,6,7)) and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1*/
	else 0
end haku_kk_eiopisk_kk_eiopisk_ta
----Hakenut korkea-asteelle, ei opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa
,case
	when  l.suorlk = '2' and (monihaku_1 in (4,5,6,7) or monihaku_2 in (4,5,6,7) or monihaku_3 in (4,5,6,7)) and (l.luopiskkoulk_1 <> '' or l.ammopiskkoulk_1 <> '' or l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (monihaku_2 in (4,5,6,7) or monihaku_3 in (4,5,6,7) or monihaku2007 in (4,5,6,7)) and (l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '' or l.luopiskkoulk2007 <> '' or l.ammopiskkoulk2007 <> '') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (monihaku_3 in (4,5,6,7) or monihaku2007 in (4,5,6,7) or monihaku2008 in (4,5,6,7)) and (l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '' or l.luopiskkoulk2007 <> '' or l.ammopiskkoulk2007 <> '' or l.luopiskkoulk2008 <> '' or l.ammopiskkoulk2008 <> '') and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (monihaku2007 in (4,5,6,7) or monihaku2008 in (4,5,6,7) or monihaku2009 in (4,5,6,7)) and (l.luopiskkoulk2007 <> '' or l.ammopiskkoulk2007 <> '' or l.luopiskkoulk2008 <> '' or l.ammopiskkoulk2008 <> '' or l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '') and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (monihaku2008 in (4,5,6,7) or monihaku2009 in (4,5,6,7) or monihaku2010 in (4,5,6,7)) and (l.luopiskkoulk2008 <> '' or l.ammopiskkoulk2008 <> '' or l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '') and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (monihaku2009 in (4,5,6,7) or monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7)) and (l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '') and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7) or monihaku2012 in (4,5,6,7)) and (l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1*/
	else 0
end haku_kk_eiopisk_kk_opisk_ta
----Hakenut vain ammattikorkeakouluun, ei opiskellut korkea-asteella
,case
	when  l.suorlk = '2' and (monihaku_1 = 4 or monihaku_2 = 4 or monihaku_3 = 4) and (monihaku_1 not in (5,6,7) and monihaku_2 not in (5,6,7) and monihaku_3 not in (5,6,7)) and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (monihaku_2 = 4 or monihaku_3 = 4 or monihaku2007 = 4) and (monihaku_2 not in (5,6,7) and monihaku_3 not in (5,6,7) and monihaku2007 not in (5,6,7)) and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (monihaku_3 = 4 or monihaku2007 = 4 or monihaku2008 = 4) and (monihaku_3 not in (5,6,7) and monihaku2007 not in (5,6,7) and monihaku2008 not in (5,6,7)) and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (monihaku2007 = 4 or monihaku2008 = 4 or monihaku2009 = 4) and (monihaku2007 not in (5,6,7) and monihaku2008 not in (5,6,7) and monihaku2009 not in (5,6,7)) and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (monihaku2008 = 4 or monihaku2009 = 4 or monihaku2010 = 4) and (monihaku2008 not in (5,6,7) and monihaku2009 not in (5,6,7) and monihaku2010 not in (5,6,7)) and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (monihaku2009 = 4 or monihaku2010 = 4 or monihaku2011 = 4) and (monihaku2009 not in (5,6,7) and monihaku2010 not in (5,6,7) and monihaku2011 not in (5,6,7)) and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (monihaku2010 = 4 or monihaku2011 = 4 or monihaku2012 = 4) and (monihaku2010 not in (5,6,7) and monihaku2011 not in (5,6,7) and monihaku2012 not in (5,6,7)) and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1*/
	else 0
end haku_amk_eiopisk_kk
----Hakenut vain yliopistokoulutukseen, ei opiskellut korkea-asteella
,case
	when  l.suorlk = '2' and (monihaku_1 = 7 or monihaku_2 = 7 or monihaku_3 = 7) and (monihaku_1 not in (4,5,6) and monihaku_2 not in (4,5,6) and monihaku_3 not in (4,5,6)) and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (monihaku_2 = 7 or monihaku_3 = 7 or monihaku2007 = 7) and (monihaku_2 not in (4,5,6) and monihaku_3 not in (4,5,6) and monihaku2007 not in (4,5,6)) and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (monihaku_3 = 7 or monihaku2007 = 7 or monihaku2008 = 7) and (monihaku_3 not in (4,5,6) and monihaku2007 not in (4,5,6) and monihaku2008 not in (4,5,6)) and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (monihaku2007 = 7 or monihaku2008 = 7 or monihaku2009 = 7) and (monihaku2007 not in (4,5,6) and monihaku2008 not in (4,5,6) and monihaku2009 not in (4,5,6)) and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (monihaku2008 = 7 or monihaku2009 = 7 or monihaku2010 = 7) and (monihaku2008 not in (4,5,6) and monihaku2009 not in (4,5,6) and monihaku2010 not in (4,5,6)) and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (monihaku2009 = 7 or monihaku2010 = 7 or monihaku2011 = 7) and (monihaku2009 not in (4,5,6) and monihaku2010 not in (4,5,6) and monihaku2011 not in (4,5,6)) and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (monihaku2010 = 7 or monihaku2011 = 7 or monihaku2012 = 7) and (monihaku2010 not in (4,5,6) and monihaku2011 not in (4,5,6) and monihaku2012 not in (4,5,6)) and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1*/
	else 0
end haku_yo_eiopisk_kk
----Hakenut sekä amk- että yliopistokoulutukseen, ei opiskellut korkea-asteella
,case
	when  l.suorlk = '2' and (monihaku_1 = 6 or monihaku_2 = 6 or monihaku_3 = 6 or ((monihaku_1 = 4 or monihaku_2 = 4 or monihaku_3 = 4) and (monihaku_1 = 7 or monihaku_2 = 7 or monihaku_3 = 7))) and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (monihaku_2 = 6 or monihaku_3 = 6 or monihaku2007 = 6 or ((monihaku_2 = 4 or monihaku_3 = 4 or monihaku2007 = 4) and (monihaku_2 = 7 or monihaku_3 = 7 or monihaku2007 = 7))) and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (monihaku_3 = 6 or monihaku2007 = 6 or monihaku2008 = 6 or ((monihaku_3 = 4 or monihaku2007 = 4 or monihaku2008 = 4) and (monihaku_3 = 7 or monihaku2007 = 7 or monihaku2008 = 7))) and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (monihaku2007 = 6 or monihaku2008 = 6 or monihaku2009 = 6 or ((monihaku2007 = 4 or monihaku2008 = 4 or monihaku2009 = 4) and (monihaku2007 = 7 or monihaku2008 = 7 or monihaku2009 = 7))) and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (monihaku2008 = 6 or monihaku2009 = 6 or monihaku2010 = 6 or ((monihaku2008 = 4 or monihaku2009 = 4 or monihaku2010 = 4) and (monihaku2008 = 7 or monihaku2009 = 7 or monihaku2010 = 7))) and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (monihaku2009 = 6 or monihaku2010 = 6 or monihaku2011 = 6 or ((monihaku2009 = 4 or monihaku2010 = 4 or monihaku2011 = 4) and (monihaku2009 = 7 or monihaku2010 = 7 or monihaku2011 = 7))) and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (monihaku2010 = 6 or monihaku2011 = 6 or monihaku2012 = 6 or ((monihaku2010 = 4 or monihaku2011 = 4 or monihaku2012 = 4) and (monihaku2010 = 7 or monihaku2011 = 7 or monihaku2012 = 7))) and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1*/
	else 0
end haku_amkyo_eiopisk_kk

--Opiskellut korkea-asteella
,case
	when  l.suorlk = '2' and (l.amkopiskkoulk_1 <> '' or l.yoopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '' or l.amkopiskkoulk2007 <> '' or l.yoopiskkoulk2007 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '' or l.amkopiskkoulk2007 <> '' or l.yoopiskkoulk2007 <> '' or l.amkopiskkoulk2008 <> '' or l.yoopiskkoulk2008 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2007 <> '' or l.yoopiskkoulk2007 <> '' or l.amkopiskkoulk2008 <> '' or l.yoopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2008 <> '' or l.yoopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '') then 1*/
	else 0
end opisk_kk
----Opiskellut korkea-asteella, ei-opiskellut toisen asteen koulutuksessa
,case
	when  l.suorlk = '2' and l.luopiskkoulk_1 = '' and l.ammopiskkoulk_1 = '' and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and (l.amkopiskkoulk_1 <> '' or l.yoopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 = '' and (l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '' or l.amkopiskkoulk2007 <> '' or l.yoopiskkoulk2007 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 = '' and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' and (l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '' or l.amkopiskkoulk2007 <> '' or l.yoopiskkoulk2007 <> '' or l.amkopiskkoulk2008 <> '' or l.yoopiskkoulk2008 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 = '' and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and (l.amkopiskkoulk2007 <> '' or l.yoopiskkoulk2007 <> '' or l.amkopiskkoulk2008 <> '' or l.yoopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and (l.amkopiskkoulk2008 <> '' or l.yoopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and (l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and (l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '') then 1*/
	else 0
end opisk_kk_eiopisk_ta
----Opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa
,case
	when  l.suorlk = '2' and (l.luopiskkoulk_1 <> '' or l.ammopiskkoulk_1 <> '' or l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '') and (l.amkopiskkoulk_1 <> '' or l.yoopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '' or l.luopiskkoulk2007 <> '' or l.ammopiskkoulk2007 <> '') and (l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '' or l.amkopiskkoulk2007 <> '' or l.yoopiskkoulk2007 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '' or l.luopiskkoulk2007 <> '' or l.ammopiskkoulk2007 <> '' or l.luopiskkoulk2008 <> '' or l.ammopiskkoulk2008 <> '') and (l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '' or l.amkopiskkoulk2007 <> '' or l.yoopiskkoulk2007 <> '' or l.amkopiskkoulk2008 <> '' or l.yoopiskkoulk2008 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk2007 <> '' or l.ammopiskkoulk2007 <> '' or l.luopiskkoulk2008 <> '' or l.ammopiskkoulk2008 <> '' or l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '') and (l.amkopiskkoulk2007 <> '' or l.yoopiskkoulk2007 <> '' or l.amkopiskkoulk2008 <> '' or l.yoopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk2008 <> '' or l.ammopiskkoulk2008 <> '' or l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '') and (l.amkopiskkoulk2008 <> '' or l.yoopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '') and (l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '') and (l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '') then 1*/
	else 0
end opisk_kk_opisk_ta
----Opiskellut vain ammattikorkeakoulussa
,case
	when  l.suorlk = '2' and (l.amkopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '') and l.yoopiskkoulk_1 = '' and l.yoopiskkoulk_2 = '' and l.yoopiskkoulk_3 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.amkopiskkoulk2007 <> '') and l.yoopiskkoulk_2 = '' and l.yoopiskkoulk_3 = '' and l.yoopiskkoulk2007 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk_3 <> '' or l.amkopiskkoulk2007 <> '' or l.amkopiskkoulk2008 <> '') and l.yoopiskkoulk_3 = '' and l.yoopiskkoulk2007 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2007 <> '' or l.amkopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '') and l.yoopiskkoulk2007 = '' and l.yoopiskkoulk2008 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '') and l.yoopiskkoulk2008 = '' and l.yoopiskkoulk2009 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '') and l.yoopiskkoulk2009 = '' and l.yoopiskkoulk2010 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '') and l.yoopiskkoulk2010 = '' and l.yoopiskkoulk2011 = '' and l.yoopiskkoulk2012 = '' then 1*/
	else 0
end opisk_vain_amk
----Opiskellut vain yliopistokoulutuksessa
,case
	when  l.suorlk = '2' and l.amkopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and (l.yoopiskkoulk_1 <> '' or l.yoopiskkoulk_2 <> '' or l.yoopiskkoulk_3 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and l.amkopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.amkopiskkoulk2007 = '' and (l.yoopiskkoulk_2 <> '' or l.yoopiskkoulk_3 <> '' or l.yoopiskkoulk2007 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and l.amkopiskkoulk_3 = '' and l.amkopiskkoulk2007 = '' and l.amkopiskkoulk2008 = '' and (l.yoopiskkoulk_3 <> '' or l.yoopiskkoulk2007 <> '' or l.yoopiskkoulk2008 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and l.amkopiskkoulk2007 = '' and l.amkopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and (l.yoopiskkoulk2007 <> '' or l.yoopiskkoulk2008 <> '' or l.yoopiskkoulk2009 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and l.amkopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and (l.yoopiskkoulk2008 <> '' or l.yoopiskkoulk2009 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and l.amkopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and (l.yoopiskkoulk2009 <> '' or l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and l.amkopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and (l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '' or l.yoopiskkoulk2012 <> '') then 1*/
	else 0
end opisk_vain_yo
----Opiskellut sekä amk- että yliopistokoulutuksessa
,case
	when  l.suorlk = '2' and (l.amkopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '') and (l.yoopiskkoulk_1 <> '' or l.yoopiskkoulk_2 <> '' or l.yoopiskkoulk_3 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.amkopiskkoulk2007 <> '') and (l.yoopiskkoulk_2 <> '' or l.yoopiskkoulk_3 <> '' or l.yoopiskkoulk2007 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk_3 <> '' or l.amkopiskkoulk2007 <> '' or l.amkopiskkoulk2008 <> '') and (l.yoopiskkoulk_3 <> '' or l.yoopiskkoulk2007 <> '' or l.yoopiskkoulk2008 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2007 <> '' or l.amkopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '') and (l.yoopiskkoulk2007 <> '' or l.yoopiskkoulk2008 <> '' or l.yoopiskkoulk2009 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '') and (l.yoopiskkoulk2008 <> '' or l.yoopiskkoulk2009 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '') and (l.yoopiskkoulk2009 <> '' or l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '') and (l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '' or l.yoopiskkoulk2012 <> '') then 1*/
	else 0
end opisk_amkyo



FROM 
    (
	select * from [VipunenTK_SA].[dbo].[v_K3_13_Perusk_paattaneet_amm_tutk_suorittaneet]
	where suorlk = '2'
	) as l


LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d1a on d1a.koulutusluokitus_avain=l.amkopiskkoulk_1
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d2a on d2a.koulutusluokitus_avain=l.amkopiskkoulk_2
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d3a on d3a.koulutusluokitus_avain=l.amkopiskkoulk_3
/*LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d4a on d4a.koulutusluokitus_avain=l.amkopiskkoulk2007
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d5a on d5a.koulutusluokitus_avain=l.amkopiskkoulk2008
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d6a on d6a.koulutusluokitus_avain=l.amkopiskkoulk2009
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d7a on d7a.koulutusluokitus_avain=l.amkopiskkoulk2010
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d8a on d8a.koulutusluokitus_avain=l.amkopiskkoulk2011
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d9a on d9a.koulutusluokitus_avain=l.amkopiskkoulk2012*/

LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d1b on d1b.koulutusluokitus_avain=l.yoopiskkoulk_1
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d2b on d2b.koulutusluokitus_avain=l.yoopiskkoulk_2
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d3b on d3b.koulutusluokitus_avain=l.yoopiskkoulk_3
/*LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d4b on d4b.koulutusluokitus_avain=l.yoopiskkoulk2007
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d5b on d5b.koulutusluokitus_avain=l.yoopiskkoulk2008
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d6b on d6b.koulutusluokitus_avain=l.yoopiskkoulk2009
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d7b on d7b.koulutusluokitus_avain=l.yoopiskkoulk2010
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d8b on d8b.koulutusluokitus_avain=l.yoopiskkoulk2011	
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d9b on d9b.koulutusluokitus_avain=l.yoopiskkoulk2012*/

LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d1c on d1c.koulutusluokitus_avain=l.ammopiskkoulk_1
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d2c on d2c.koulutusluokitus_avain=l.ammopiskkoulk_2
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d3c on d3c.koulutusluokitus_avain=l.ammopiskkoulk_3
/*LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d4c on d4c.koulutusluokitus_avain=l.ammopiskkoulk2007
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d5c on d5c.koulutusluokitus_avain=l.ammopiskkoulk2008
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d6c on d6c.koulutusluokitus_avain=l.ammopiskkoulk2009
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d7c on d7c.koulutusluokitus_avain=l.ammopiskkoulk2010
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d8c on d8c.koulutusluokitus_avain=l.ammopiskkoulk2011
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d9c on d9c.koulutusluokitus_avain=l.ammopiskkoulk2012*/

CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d1a.iscfibroad2013_koodi),(d1b.iscfibroad2013_koodi), (d2a.iscfibroad2013_koodi),(d2b.iscfibroad2013_koodi), (d3a.iscfibroad2013_koodi),(d3b.iscfibroad2013_koodi)) AS a(d)) m1
/*CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d2a.iscfibroad2013_koodi),(d2b.iscfibroad2013_koodi), (d3a.iscfibroad2013_koodi),(d3b.iscfibroad2013_koodi), (d4a.iscfibroad2013_koodi),(d4b.iscfibroad2013_koodi)) AS a(d)) m2
CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d3a.iscfibroad2013_koodi),(d3b.iscfibroad2013_koodi), (d4a.iscfibroad2013_koodi),(d4b.iscfibroad2013_koodi), (d5a.iscfibroad2013_koodi),(d5b.iscfibroad2013_koodi)) AS a(d)) m3
CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d4a.iscfibroad2013_koodi),(d4b.iscfibroad2013_koodi), (d5a.iscfibroad2013_koodi),(d5b.iscfibroad2013_koodi), (d6a.iscfibroad2013_koodi),(d6b.iscfibroad2013_koodi)) AS a(d)) m4
CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d5a.iscfibroad2013_koodi),(d5b.iscfibroad2013_koodi), (d6a.iscfibroad2013_koodi),(d6b.iscfibroad2013_koodi), (d7a.iscfibroad2013_koodi),(d7b.iscfibroad2013_koodi)) AS a(d)) m5
CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d6a.iscfibroad2013_koodi),(d6b.iscfibroad2013_koodi), (d7a.iscfibroad2013_koodi),(d7b.iscfibroad2013_koodi), (d8a.iscfibroad2013_koodi),(d8b.iscfibroad2013_koodi)) AS a(d)) m6
CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d7a.iscfibroad2013_koodi),(d7b.iscfibroad2013_koodi), (d8a.iscfibroad2013_koodi),(d8b.iscfibroad2013_koodi), (d9a.iscfibroad2013_koodi),(d9b.iscfibroad2013_koodi)) AS a(d)) m7*/

	WHERE 1=1
--
-- TULOS
-- 
/*
if @debug_what_to_run>=3 begin
	if @debug_what_to_run>0 print 'querying result';
	select * from [VipunenTK_DW].[dbo].[_koulutukseen_sijoittuneet_6v]
	--select COUNT(*) from vipunen_tk.f_tyol_ja_jatko_opin_ where aineisto=(select id from vipunen_tk.d_aineisto where aineistokoodi='4.3' and @toinen_suoritusvuosi between alkaa and paattyy)
end;

if @debug_what_to_run>0 PRINT 'all done.';
*/


GO
/****** Object:  StoredProcedure [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_1_tarkastelujakso]    Script Date: 29.8.2018 15:59:41 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


CREATE PROCEDURE [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_1_tarkastelujakso] AS
/*declare @debug_what_to_run tinyint; set @debug_what_to_run=2; -- käytä arvoa 3 vain kun teet yhden vuoden
print '$'+convert(varchar,sysdatetime(),20)+'$ '+'DEBUG (what to run)='+cast(@debug_what_to_run as varchar)+
': 0=luo vain taulut, älä tulosta mitään; 1=luo taulut ja tulosta joitakin merkittävimpiä välivaiheita; 2=luo taulut ja tulosta välivaiheet; 3=luo taulut, tulosta välivaiheet ja tulosta myös tulokset, 4=tulosta välivaiheet, mutta älä tee mitään';




-- lisätään data
if @debug_what_to_run not in (4) begin
if @debug_what_to_run>0 print 'inserting data';

-- parametrimuuttujien arvot
-- parametrimuuttujat
DECLARE @ensimmainen_suoritusvuosi int;
DECLARE @toinen_suoritusvuosi int;
DECLARE @kolmas_suoritusvuosi int;
DECLARE @neljas_suoritusvuosi int;
DECLARE @viides_suoritusvuosi int;
DECLARE @kuudes_suoritusvuosi int;
DECLARE @seitsemas_suoritusvuosi int;


set @ensimmainen_suoritusvuosi = _2;
set @toinen_suoritusvuosi = 2005;
set @kolmas_suoritusvuosi = 2006;
set @neljas_suoritusvuosi = 2007;
set @viides_suoritusvuosi = 2008;
set @kuudes_suoritusvuosi = 2009;
set @seitsemas_suoritusvuosi = 2010;

*/

INSERT INTO [VipunenTK_DW].[dbo].[_koulutukseen_sijoittuneet_6v_tarkastelu]
(
rivinumero
, tarkastelujakso
, tilv 
, tilv_date
, tutkryh 
, suorv
, suorlk 
, sp 
, syntv
, aikielir1 
, tutkkaskun 
, kansalr1
, pohjmaa 
, eumaa 
, etamaa 
, tunn
, jarj
, kkielir1 
, tutklaja 
, tutktav 
, aikoul 
, tutkmaak
, koulutus_1
, oppilaitos_1
, koulutuksen_jarjestaja_1
, koulutuksen_maakunta_1
, koulutus_2
, oppilaitos_2
, koulutuksen_jarjestaja_2
, koulutuksen_maakunta_2
, monihaku
, paaasiallinen_toiminta
, ammattiasema
, lkm
, pohjkoulk
, tietolahde
, aineisto
, lukiokoulutuksessa
, ammatillisessa_koulutuksessa
, ammattikorkeakoulutuksessa
, yliopistokoulutuksessa
, lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa
, toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa
, ammattikorkeakoulutuksessa_ja_yliopistokoulutuksessa
, koulutuksen_paattaneiden_toiminta
, ika_1v
, ika_5v
, ika_1v_suorv
, opisk_lu
, opisk_amm_pk
, opisk_amm_at
, opisk_amm_eat
, opisk_amm
, opisk_amk
, opisk_yo
, opisk_amk_koulala1
, opisk_amk_koulala2
, opisk_amk_koulala3
, opisk_amk_koulala4
, opisk_amk_koulala5
, opisk_amk_koulala6
, opisk_amk_koulala7
, opisk_amk_koulala8
, opisk_amk_koulala9
, opisk_amk_koulala10
, opisk_yo_koulala1
, opisk_yo_koulala2
, opisk_yo_koulala3
, opisk_yo_koulala4
, opisk_yo_koulala5
, opisk_yo_koulala6
, opisk_yo_koulala7
, opisk_yo_koulala8
, opisk_yo_koulala9
, opisk_yo_koulala10
, opisk_vah2_koulala
, haku_amm
, haku_amk
, haku_yo
, eihaku_kk_eiopisk
, eihaku_kk_eiopisk_kk_opisk_ta
, eihaku_kk_eiopisk_kk_opisk_lu
, eihaku_kk_eiopisk_kk_opisk_pk
, eihaku_kk_eiopisk_kk_opisk_at
, eihaku_kk_eiopisk_kk_opisk_eat
, haku_kk_eiopisk_kk
, haku_kk_eiopisk_kk_eiopisk_ta
, haku_kk_eiopisk_kk_opisk_ta
, haku_amk_eiopisk_kk
, haku_yo_eiopisk_kk
, haku_amkyo_eiopisk_kk
, opisk_kk
, opisk_kk_eiopisk_ta
, opisk_kk_opisk_ta
, opisk_vain_amk
, opisk_vain_yo
, opisk_amkyo
)
SELECT
 l.rivinumero,
 '1',
 l.tilv,
 l.tilv_date,
 (case 
	when l.tutkryh=3 and tutklaja=1 then 31
	when l.tutkryh=3 and tutklaja=2 then 32
	when l.tutkryh=3 and tutklaja=3 then 33
	else l.tutkryh
  end),
 l.suorv,
  (case
	when l.suorlk = '1'  then (l.suorv+'0'+l.suorlk)
	when l.suorlk = '2'  then (l.suorv+'0'+'8')
	else ''
	end),
 l.sp,
 l.syntv,
 l.aikielir1,
 l.tutkaskun,
 l.kansalr1,
 l.pohjmaa,
 l.eumaa,
 l.etamaa,
 l.tunn,
 l.jarj,
 l.kkielir1,
 l.tutklaja,
 l.tutktav,
 l.aikoul,
 l.tutkmaak,
 -- Koulutus 1
 (case
    --lukiokoulutuksessa _2
	when l.suorlk = '1' and l.luopiskkoulk_2 <> '' and l.ammopiskkoulk_2 = '' and
	l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' then l.luopiskkoulk_2 
	-- ammattikoulutuksessa _2
	when l.suorlk = '1' and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 <> '' and
	l.amkopiskkoulk_2 ='' and l.yoopiskkoulk_2 = ''  then l.ammopiskkoulk_2 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen _2 ensim. koulutustietoihin
	when l.suorlk = '1' and l.luopiskkoulk_2 <> '' and l.ammopiskkoulk_2 <> '' and
	l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' then l.luopiskkoulk_2
	-- ammattikorkeakoulutuksessa _2
	when l.suorlk = '1' and l.amkopiskkoulk_2  <> '' and l.yoopiskkoulk_2  = '' and
	l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' then l.amkopiskkoulk_2
	-- yliopistokoulutuksessa _2
	when l.suorlk = '1' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 <> '' and 
	l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = ''   then l.yoopiskkoulk_2
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa, merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorlk = '1' and l.amkopiskkoulk_2 <> '' and l.yoopiskkoulk_2  <> '' and
	l.luopiskkoulk_2 = '' and ammopiskkoulk_2 = ''  then l.amkopiskkoulk_2 
	
	else ''

	
	    
	    end),
	    
-- Oppilaitos 1
	(case
	-- lukiokoulutuksen oppilaitos _2
	when l.suorlk = '1' and l.luopisktunn_2 <> '' and l.ammopisktunn_2 = '' and
	l.amkopisktunn_2 = '' and l.yoopisktunn_2 = '' then l.luopisktunn_2 
	-- ammattikoulutuksen oppilaitos _2
	when l.suorlk = '1' and l.luopisktunn_2 = '' and l.ammopisktunn_2 <> '' and
	l.amkopisktunn_2 ='' and l.yoopisktunn_2 = ''  then l.ammopisktunn_2 
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos _2
	when l.suorlk = '1' and l.luopisktunn_2 <> '' and l.ammopisktunn_2 <> '' and
	l.amkopisktunn_2 = '' and l.yoopisktunn_2 = '' then l.luopisktunn_2
	-- ammattikorkeakoulutuksen oppilaitos _2
	when l.suorlk = '1' and l.amkopisktunn_2  <> '' and l.yoopisktunn_2  = '' and
	l.luopisktunn_2 = '' and l.ammopisktunn_2 = '' then l.amkopisktunn_2
	-- yliopistokoulutuksen oppilaitos _2
	when l.suorlk = '1' and l.amkopisktunn_2 = '' and l.yoopisktunn_2 <> '' and 
	l.luopisktunn_2 = '' and l.ammopisktunn_2 = ''   then l.yoopisktunn_2
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus _2  
	when l.suorlk = '1' and l.amkopisktunn_2 <> '' and l.yoopisktunn_2  <> '' and
	l.luopisktunn_2 = '' and l.ammopisktunn_2 = ''  then l.amkopisktunn_2 
	
	
	

	
	else ''
	
	    end),
  --Koulutuksen järjestäjä 1
	(case
	-- lukikoulutuksen järjestäjä _2
	when l.suorlk = '1' and l.luopiskjarj_2  <> '' and l.ammopiskjarj_2 = '' and
	l.amkopiskjarj_2 = '' and yoopiskjarj_2 = '' then l.luopiskjarj_2
	-- ammatillisen koulutuksen järjestäjä _2  
	when l.suorlk = '1' and l.luopiskjarj_2 = '' and l.ammopiskjarj_2 <> '' and
	l.amkopiskjarj_2 ='' and l.yoopiskjarj_2 = ''  then l.ammopiskjarj_2
	-- lukio- ja ammatillisen koulutuksen järjestäjä, merkitään lukiokoulutuksen _2 järjestäjä 
	when l.suorlk = '1' and l.luopiskjarj_2 <> '' and l.ammopiskjarj_2 <> '' and
	l.amkopiskjarj_2 = '' and l.yoopiskjarj_2 = '' then l.luopiskjarj_2
	-- ammattikorkeakoulutuksen järjestäjä _2
	when l.suorlk = '1' and l.amkopiskjarj_2  <> '' and l.yoopiskjarj_2   = '' and
	l.luopiskjarj_2 = '' and l.ammopiskjarj_2 = '' then l.amkopiskjarj_2
	-- yliopistokoulutuksen järjestäjä _2 
	when l.suorlk = '1' and l.amkopiskjarj_2  = '' and l.yoopiskjarj_2  <> '' and 
	l.luopiskjarj_2  = '' and l.ammopiskjarj_2 = ''   then l.yoopiskjarj_2
	-- ammattikorkea- ja yliopistokoulutuksen järjestäjä, merkitään ammattikorkeakoulutuksen _2 järjestäjä   
	when l.suorlk = '1' and l.amkopiskjarj_2  <> '' and l.yoopiskjarj_2   <> '' and
	l.luopiskjarj_2  = '' and l.ammopiskjarj_2  = ''  then l.amkopiskjarj_2 

	
	else ''
	    end),
 --Koulutuksen maakunta 1
	(case
	-- lukioopiskelun maakunta _2
	when l.suorlk = '1' and l.luopiskmaak_2   <> '' and l.ammopiskmaak_2  = '' and
	l.amkopiskmaak_2  = '' and l.yoopiskmaak_2  = '' then l.luopiskmaak_2   
	-- ammatillisen koulutuksen maakunta _2
	when l.suorlk = '1' and l.luopiskmaak_2  = '' and l.ammopiskmaak_2  <> '' and
	l.amkopiskmaak_2  ='' and l.yoopiskmaak_2  = ''  then l.ammopiskmaak_2  
	-- lukiokoulutuksen ja ammatillisen koulutus otetaan lukiokoulutuksen maakunta _2
	when l.suorlk = '1' and l.luopiskmaak_2  <> '' and l.ammopiskmaak_2  <> '' and
	l.amkopiskmaak_2  = '' and l.yoopiskmaak_2  = '' then l.luopiskmaak_2 
    -- ammattikorkeakoulutuksen maakunta _2
	when l.suorlk = '1' and l.amkopiskmaak_2   <> '' and l.yoopiskmaak_2   = '' and
	l.luopiskjarj_2 = '' and l.ammopiskmaak_2 = '' then l.amkopiskmaak_2
	-- yliopistokoulutuksen maakunta _2 
	when l.suorlk = '1' and l.amkopiskmaak_2  = '' and l.yoopiskmaak_2  <> '' and 
	l.luopiskjarj_2  = '' and l.ammopiskmaak_2 = ''   then l.yoopiskmaak_2
	-- ammattikorkekoulutuksen ja yliopistokoulutksen maakunta otetaan ammattikorkeakoulutuksen maakunta _2   
	when l.suorlk = '1' and l.amkopiskmaak_2  <> '' and l.yoopiskmaak_2   <> '' and
	l.luopiskjarj_2  = '' and l.ammopiskmaak_2  = ''  then l.amkopiskmaak_2 
	
	else ''
	
	    end),
-- Koulutus 2
(case
   -- jos lukiokoulutuksessa vain niin jätetään tyhjäksi _2
	when l.suorlk = '1' and l.luopiskkoulk_2 <> '' and l.ammopiskkoulk_2 = '' and
	l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' then ''
	-- jos ammattikoulutuksessa vain  jätetään tyhjäksi _2 
	when l.suorlk = '1' and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 <> '' and
	l.amkopiskkoulk_2 ='' and l.yoopiskkoulk_2 = ''  then ''
	-- jos lukiokoulutksessa ja ammattikoulutuksessa merkitään ammattikoulutus _2 
	when l.suorlk = '1' and l.luopiskkoulk_2 <> '' and l.ammopiskkoulk_2 <> '' and
	l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' then l.ammopiskkoulk_2 
	-- jos vain ammattikorkeakoulutuksessa jätetään tyhjäksi
	when l.suorlk = '1' and l.amkopiskkoulk_2  <> '' and l.yoopiskkoulk_2  = '' and
	l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorlk = '1' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 <> '' and 
	l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = ''   then ''
	-- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus _2
	when l.suorlk = '1' and l.amkopiskkoulk_2 <> '' and l.yoopiskkoulk_2  <> '' and
	l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = ''  then l.yoopiskkoulk_2
	
	
	
	else ''
	    end),
-- Oppilaitos 2
(case
    -- lukiokoulutuksen oppilaitos vain merkitään tyhjäksi
	when l.suorlk = '1' and l.luopisktunn_2 <> '' and l.ammopisktunn_2 = '' and
	l.amkopisktunn_2 = '' and l.yoopisktunn_2 = '' then ''
	-- ammatillisen koulutuksen oppilaitos _2 merkitään tyhjäksi
	when l.suorlk = '1' and l.luopisktunn_2 = '' and l.ammopisktunn_2 <> '' and
	l.amkopisktunn_2 ='' and l.yoopisktunn_2 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos merkitään ammatillisen koulutuksen oppilaitos _2
	when l.suorlk = '1' and l.luopisktunn_2 <> '' and l.ammopisktunn_2 <> '' and
	l.amkopisktunn_2 = '' and l.yoopisktunn_2 = '' then l.ammopisktunn_2 
	-- ammattikorkeakoulutksen oppilaitos vain merkitään tyhjäksi _2
	when l.suorlk = '1' and l.amkopisktunn_2  <> '' and l.yoopisktunn_2  = '' and
	l.luopisktunn_2 = '' and l.ammopisktunn_2 = '' then ''
	-- yliopistokoulutksen oppilaitos vain merkitään tyhjäksi _2
	when l.suorlk = '1' and l.amkopisktunn_2 = '' and l.yoopisktunn_2 <> '' and 
	l.luopisktunn_2 = '' and l.ammopisktunn_2 = ''   then ''  
	--  ammattikorkeakoulutksen oppilaitos ja yliopistokoulutuksen oppilaitos, merkitään yliopistokoulutuksen oppilaitos _2
	when l.suorlk = '1' and l.amkopisktunn_2 <> '' and l.yoopisktunn_2  <> '' and
	l.luopisktunn_2 = '' and l.ammopisktunn_2 = ''  then l.yoopisktunn_2 
	
	
	else ''
	    end),
-- Koulutuksen järjestäjä 2
	(case
	-- lukiokoulutuksen järjestäjä vain _2, merkitään tyhjäksi
	when l.suorlk = '1' and l.luopiskjarj_2  <> '' and l.ammopiskjarj_2 = '' and
	l.amkopiskjarj_2 = '' and l.yoopiskjarj_2 = '' then ''
	-- ammatillisen koulutuksen järjestäjä vain _2, merkitään tyhjäksi
	when l.suorlk = '1' and l.luopiskjarj_2 = '' and l.ammopiskjarj_2 <> '' and
	l.amkopiskjarj_2 ='' and l.yoopiskjarj_2 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä _2
	when l.suorlk = '1' and l.luopiskjarj_2 <> '' and l.ammopiskjarj_2 <> '' and
	l.amkopiskjarj_2 = '' and l.yoopiskjarj_2 = '' then l.ammopiskjarj_2 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi
	when l.suorlk = '1' and l.amkopiskjarj_2  <> '' and l.yoopiskjarj_2   = '' and
	l.luopiskjarj_2 = '' and l.ammopiskjarj_2 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, merkitään tyhjäksi
	when l.suorlk = '1' and l.amkopiskjarj_2  = '' and l.yoopiskjarj_2  <> '' and 
	l.luopiskjarj_2  = '' and l.ammopiskjarj_2 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestäjä merkitään yliopistokoulutuksen järjetäjä _2
	when l.suorlk = '1' and l.amkopiskjarj_2  <> '' and l.yoopiskjarj_2   <> '' and
	l.luopiskjarj_2  = '' and l.ammopiskjarj_2  = ''  then l.yoopiskjarj_2 
	

	else ''
	    end),
-- Koulutuksen maakunta 2
	(case
	-- vain lukiokoulutuksen maakunta _2, jätetään tyhjäksi
	when l.suorlk = '1' and l.luopiskmaak_2   <> '' and l.ammopiskmaak_2  = '' and
	l.amkopiskmaak_2  = '' and l.yoopiskmaak_2  = '' then ''
	-- vain ammatillisen koulutuksen maakunta _2, jätetään tyhjäksi   
	when l.suorlk = '1' and l.luopiskmaak_2  = '' and l.ammopiskmaak_2  <> '' and
	l.amkopiskmaak_2  ='' and l.yoopiskmaak_2  = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta, merkitään ammatillisen koulutuksen maakunta _2
	when l.suorlk = '1' and l.luopiskmaak_2  <> '' and l.ammopiskmaak_2  <> '' and
	l.amkopiskmaak_2  = '' and l.yoopiskmaak_2  = '' then l.ammopiskmaak_2 
	-- vain ammattikorkeakoulutuksen maakunta _2, jätetään tyhjäksi
	when l.suorlk = '1' and l.amkopiskmaak_2   <> '' and l.yoopiskmaak_2   = '' and
	l.luopiskmaak_2 = '' and l.ammopiskmaak_2 = '' then '' 
	-- vain yliopistokoulutuksen maakunta _2, merkitään tyhjäksi
	when l.suorlk = '1' and l.amkopiskmaak_2  = '' and l.yoopiskmaak_2  <> '' and 
	l.luopiskmaak_2  = '' and l.ammopiskmaak_2 = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta _2, merkitään yliopistokoulutuksen maakunta _2
	when l.suorlk = '1' and l.amkopiskmaak_2  <> '' and l.yoopiskmaak_2   <> '' and
	l.luopiskjarj_2  = '' and l.ammopiskmaak_2  = ''  then l.yoopiskmaak_2
	

	else ''
	
	    end),
	-- Monihaku
	(case
	-- _2
	when l.suorlk = '1' then l.monihaku_2		
	else '8'
	end),
    -- Pääasiallinen toiminta
    (case
    -- _2
	when l.suorlk = '1' then l.ptoim1r4_2
	else ''
	end),
	-- Ammattiasema
	(case
	-- _2
	when l.suorlk = '1' then l.amas_2
	else ''
	end),
    l.lkm,
	l.pohjkoul,
 l.tietolahde,
 'K3.13',
 -- Lukiokoulutuksessa
 (case
	    when (l.suorlk = '1' ) and  l.luopiskkoulk_2 <> '' and l.ammopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_2 = '' then '1'    
	    else '0'
	    end) as lukiokoulutuksessa,
 -- Ammatillisessa koulutuksessa 
 (case
	    when (l.suorlk = '1') and  l.ammopiskkoulk_2  <> '' and l.luopiskkoulk_2 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' then '1' 
	    else '0'
	    end) as ammatillisessa_koulutuksessa,
-- Ammattikorkeakoulutuksessa
 (case
	   when (l.suorlk = '1') and  l.amkopiskkoulk_2 <> '' and l.ammopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.luopiskkoulk_2 = '' then  '1'
	   else '0' 
	   end) as ammattikorkeakoulutuksessa,
-- Yliopistokoulutuksessa
 (case
	    when (l.suorlk = '1') and  l.yoopiskkoulk_2  <> '' and l.amkopiskkoulk_2 = '' and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' then '1'   	   
	    else '0'
	    end) as yliopistokoulutuksessa,
-- Lukiokoulutuksessa ja ammatillisessa koulutuksessa
(case
	    when (l.suorlk = '1') and  l.luopiskkoulk_2  <> '' and l.ammopiskkoulk_2 <> '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2  = '' then '1'  
	    else '0'
	    end) as lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa,
-- Toisen asteen ammatillisessa koulutuksessa ja korkeakoulutuksessa
(case
	    when (l.suorlk = '1') and  l.ammopiskkoulk_2  <> '' and l.amkopiskkoulk_2 <> '' and l.luopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' then '1'  
	    else '0'
	    end) as toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa,
-- Ammattikorkeakoulutuksessa ja yliopistokoulutuksessa
(case
	    when (l.suorlk = '1') and  l.amkopiskkoulk_2  <> '' and l.yoopiskkoulk_2 <> '' and l.ammopiskkoulk_2  = '' and l.luopiskkoulk_2 = ''  then '1' 
	    else '0'
	    end) as ammattikorkekoulutuksessa_ja_yliopistokoulutuksessa,    
-- Koulutuksen päättäneiden toiminta
(case
	   -- Tutkintoon johtavassa koulutuksessa olevat
	   when (l.suorlk = '1')  and (l.ptoim1r4_2 = '22' or l.ptoim1r4_2 = '13')
       and	(l.luopiskkoulk_2 <>'' or l.ammopiskkoulk_2 <>'' or l.amkopiskkoulk_2 <>'' or l.yoopiskkoulk_2 <>'')   then '1' 
	
	   -- Ei tutkintoon johtavassa koulutuksessa olevat
	   when (l.suorlk = '1')  and (l.ptoim1r4_2 = '22' or l.ptoim1r4_2 = '13')
       and	(l.luopiskkoulk_2 ='' and l.ammopiskkoulk_2 ='' and l.amkopiskkoulk_2 ='' and l.yoopiskkoulk_2 ='')   then '2' 
   
   
	   -- Ei opiskelevat työlliset
	   when (l.suorlk = '1')and  l.ptoim1r4_2  = '10'  then '3' 
	   -- Ei opiskelevat työttömät
	   when (l.suorlk = '1') and  l.ptoim1r4_2  = '12'  then '4' 
	   -- Ei opiskelevat muut
		else '5' 
	   end ) as koulutuksen_paattaneiden_toiminta
 ,ika_1v = cast((case 
            when syntv = '' then '-1'
            when  (cast(tilv as int) - cast(syntv as int)) > 99 then ''
            else  ((cast(tilv as int) - cast(syntv as int))) end)  as nvarchar(10))
 ,ika_5v =cast(
       (
		case
		when (cast(tilv as int) - cast(syntv as int)) < 15 then '5v10'
		when ((cast(tilv as int) - cast(syntv as int)) >= 15 and (cast(tilv as int) - cast(syntv as int)) <= 19) then '5v15'
		when ((cast(tilv as int) - cast(syntv as int)) >= 20 and (cast(tilv as int) - cast(syntv as int)) <= 24) then '5v20'
		when ((cast(tilv as int) - cast(syntv as int)) >= 25 and (cast(tilv as int) - cast(syntv as int)) <= 29) then '5v25'
		when ((cast(tilv as int) - cast(syntv as int)) >= 30 and (cast(tilv as int) - cast(syntv as int)) <= 34) then '5v30'
		when ((cast(tilv as int) - cast(syntv as int)) >= 35 and (cast(tilv as int) - cast(syntv as int)) <= 39) then '5v35'
		when ((cast(tilv as int) - cast(syntv as int)) >= 40 and (cast(tilv as int) - cast(syntv as int)) <= 44) then '5v40'
		when ((cast(tilv as int) - cast(syntv as int)) >= 45 and (cast(tilv as int) - cast(syntv as int)) <= 49) then '5v45'
		when ((cast(tilv as int) - cast(syntv as int)) >= 50 and (cast(tilv as int) - cast(syntv as int)) <= 54) then '5v50'
		when ((cast(tilv as int) - cast(syntv as int)) >= 55 and (cast(tilv as int) - cast(syntv as int)) <= 59) then '5v55'
		when ((cast(tilv as int) - cast(syntv as int)) >= 60 and (cast(tilv as int) - cast(syntv as int)) <= 64) then '5v60'
		when ((cast(tilv as int) - cast(syntv as int)) >= 65 and (cast(tilv as int) - cast(syntv as int)) <= 69) then '5v65'
		when ((cast(tilv as int) - cast(syntv as int)) >= 70 and (cast(tilv as int) - cast(syntv as int)) <= 74) then '5v70'
		when ((cast(tilv as int) - cast(syntv as int)) >= 75 and (cast(tilv as int) - cast(syntv as int)) <= 79) then '5v75'
		when ((cast(tilv as int) - cast(syntv as int)) >= 80 and (cast(tilv as int) - cast(syntv as int)) <= 84) then '5v80'
		when ((cast(tilv as int) - cast(syntv as int)) >= 85 and (cast(tilv as int) - cast(syntv as int)) <= 89) then '5v85'
		when ((cast(tilv as int) - cast(syntv as int)) >= 90 and (cast(tilv as int) - cast(syntv as int)) <= 94) then '5v90'
		when ((cast(tilv as int) - cast(syntv as int)) >= 95) then '5v95'
		
		end
	   ) as nvarchar (10))

  ,ika_1v_suorv = cast(
					(case 
						when syntv = '' then '-1' 
						else ((cast(suorv as int) - cast(syntv as int))) 
					end)  
	as nvarchar(10))




--uudet muuttujat 03/2018

,case
	when  l.suorlk = '1' and (l.luopiskkoulk_1 <> '' or l.luopiskkoulk_2 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk_2 <> '' or l.luopiskkoulk2006 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk2006 <> '' or l.luopiskkoulk2007 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk2007 <> '' or l.luopiskkoulk2008 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk2008 <> '' or l.luopiskkoulk2009 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '') then 1*/
	else 0
end as opisk_lu
--Opiskellut ammatillisessa peruskoulutuksessa
,case
	when  l.suorlk = '1' and (l.ammopiskkoulk_1 <> '' or l.ammopiskkoulk_2 <> '') and (d1c.Koulutusaste_taso2_koodi = '32' or d2c.Koulutusaste_taso2_koodi = '32') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk2006 <> '') and (d2c.Koulutusaste_taso2_koodi = '32' or d3c.Koulutusaste_taso2_koodi = '32') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2006 <> '' or l.ammopiskkoulk2007 <> '') and (d3c.Koulutusaste_taso2_koodi = '32' or d4c.Koulutusaste_taso2_koodi = '32') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2007 <> '' or l.ammopiskkoulk2008 <> '') and (d4c.Koulutusaste_taso2_koodi = '32' or d5c.Koulutusaste_taso2_koodi = '32') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2008 <> '' or l.ammopiskkoulk2009 <> '') and (d5c.Koulutusaste_taso2_koodi = '32' or d6c.Koulutusaste_taso2_koodi = '32') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '') and (d6c.Koulutusaste_taso2_koodi = '32' or d7c.Koulutusaste_taso2_koodi = '32') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '') and (d7c.Koulutusaste_taso2_koodi = '32' or d8c.Koulutusaste_taso2_koodi = '32') then 1*/
	else 0
end as opisk_amm_pk
--Opiskellut ammattitutkintokoulutuksessa
,case
	when  l.suorlk = '1' and (l.ammopiskkoulk_1 <> '' or l.ammopiskkoulk_2 <> '') and (d1c.Koulutusaste_taso2_koodi = '33' or d2c.Koulutusaste_taso2_koodi = '33') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk2006 <> '') and (d2c.Koulutusaste_taso2_koodi = '33' or d3c.Koulutusaste_taso2_koodi = '33') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2006 <> '' or l.ammopiskkoulk2007 <> '') and (d3c.Koulutusaste_taso2_koodi = '33' or d4c.Koulutusaste_taso2_koodi = '33') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2007 <> '' or l.ammopiskkoulk2008 <> '') and (d4c.Koulutusaste_taso2_koodi = '33' or d5c.Koulutusaste_taso2_koodi = '33') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2008 <> '' or l.ammopiskkoulk2009 <> '') and (d5c.Koulutusaste_taso2_koodi = '33' or d6c.Koulutusaste_taso2_koodi = '33') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '') and (d6c.Koulutusaste_taso2_koodi = '33' or d7c.Koulutusaste_taso2_koodi = '33') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '') and (d7c.Koulutusaste_taso2_koodi = '33' or d8c.Koulutusaste_taso2_koodi = '33') then 1*/
	else 0
end as opisk_amm_at
--Opiskellut erikoisammattitutkintokoulutuksessa
,case
	when  l.suorlk = '1' and (l.ammopiskkoulk_1 <> '' or l.ammopiskkoulk_2 <> '') and (d1c.Koulutusaste_taso2_koodi = '41' or d2c.Koulutusaste_taso2_koodi = '41') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk2006 <> '') and (d2c.Koulutusaste_taso2_koodi = '41' or d3c.Koulutusaste_taso2_koodi = '41') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2006 <> '' or l.ammopiskkoulk2007 <> '') and (d3c.Koulutusaste_taso2_koodi = '41' or d4c.Koulutusaste_taso2_koodi = '41') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2007 <> '' or l.ammopiskkoulk2008 <> '') and (d4c.Koulutusaste_taso2_koodi = '41' or d5c.Koulutusaste_taso2_koodi = '41') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2008 <> '' or l.ammopiskkoulk2009 <> '') and (d5c.Koulutusaste_taso2_koodi = '41' or d6c.Koulutusaste_taso2_koodi = '41') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '') and (d6c.Koulutusaste_taso2_koodi = '41' or d7c.Koulutusaste_taso2_koodi = '41') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '') and (d7c.Koulutusaste_taso2_koodi = '41' or d8c.Koulutusaste_taso2_koodi = '41') then 1*/
	else 0
end as opisk_amm_eat
--Opiskellut ammatillisessa koulutuksessa
,case
	when  l.suorlk = '1' and (l.ammopiskkoulk_1 <> '' or l.ammopiskkoulk_2 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk2006 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2006 <> '' or l.ammopiskkoulk2007 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2007 <> '' or l.ammopiskkoulk2008 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2008 <> '' or l.ammopiskkoulk2009 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '') then 1*/
	else 0
end as opisk_amm
--Opiskellut ammattikorkeakoulutuksessa
,case
	when  l.suorlk = '1' and (l.amkopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk_2 <> '' or l.amkopiskkoulk2006 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2006 <> '' or l.amkopiskkoulk2007 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2007 <> '' or l.amkopiskkoulk2008 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '') then 1*/
	else 0
end as opisk_amk
--Opiskellut yliopistokoulutuksessa
,case
	when  l.suorlk = '1' and (l.yoopiskkoulk_1 <> '' or l.yoopiskkoulk_2 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.yoopiskkoulk_2 <> '' or l.yoopiskkoulk2006 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.yoopiskkoulk2006 <> '' or l.yoopiskkoulk2007 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.yoopiskkoulk2007 <> '' or l.yoopiskkoulk2008 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.yoopiskkoulk2008 <> '' or l.yoopiskkoulk2009 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.yoopiskkoulk2009 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '') then 1*/
	else 0
end as opisk_yo



----KOULUTUSALA, TASO 1 KYLLÄ/EI
--Opiskellut koulutusala1 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1a.iscfibroad2013_koodi = '01' or d2a.iscfibroad2013_koodi = '01') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2a.iscfibroad2013_koodi = '01' or d3a.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3a.iscfibroad2013_koodi = '01' or d4a.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4a.iscfibroad2013_koodi = '01' or d5a.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5a.iscfibroad2013_koodi = '01' or d6a.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6a.iscfibroad2013_koodi = '01' or d7a.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7a.iscfibroad2013_koodi = '01' or d8a.iscfibroad2013_koodi = '01') then 1*/
	else 0
end as opisk_amk_koulala1
--Opiskellut koulutusala2 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1a.iscfibroad2013_koodi = '02' or d2a.iscfibroad2013_koodi = '02') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2a.iscfibroad2013_koodi = '02' or d3a.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3a.iscfibroad2013_koodi = '02' or d4a.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4a.iscfibroad2013_koodi = '02' or d5a.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5a.iscfibroad2013_koodi = '02' or d6a.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6a.iscfibroad2013_koodi = '02' or d7a.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7a.iscfibroad2013_koodi = '02' or d8a.iscfibroad2013_koodi = '02') then 1*/
	else 0
end as opisk_amk_koulala2
--Opiskellut koulutusala3 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1a.iscfibroad2013_koodi = '03' or d2a.iscfibroad2013_koodi = '03') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2a.iscfibroad2013_koodi = '03' or d3a.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3a.iscfibroad2013_koodi = '03' or d4a.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4a.iscfibroad2013_koodi = '03' or d5a.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5a.iscfibroad2013_koodi = '03' or d6a.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6a.iscfibroad2013_koodi = '03' or d7a.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7a.iscfibroad2013_koodi = '03' or d8a.iscfibroad2013_koodi = '03') then 1*/
	else 0
end as opisk_amk_koulala3
--Opiskellut koulutusala4 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1a.iscfibroad2013_koodi = '04' or d2a.iscfibroad2013_koodi = '04') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2a.iscfibroad2013_koodi = '04' or d3a.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3a.iscfibroad2013_koodi = '04' or d4a.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4a.iscfibroad2013_koodi = '04' or d5a.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5a.iscfibroad2013_koodi = '04' or d6a.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6a.iscfibroad2013_koodi = '04' or d7a.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7a.iscfibroad2013_koodi = '04' or d8a.iscfibroad2013_koodi = '04') then 1*/
	else 0
end as opisk_amk_koulala4
--Opiskellut koulutusala5 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1a.iscfibroad2013_koodi = '05' or d2a.iscfibroad2013_koodi = '05') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2a.iscfibroad2013_koodi = '05' or d3a.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3a.iscfibroad2013_koodi = '05' or d4a.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4a.iscfibroad2013_koodi = '05' or d5a.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5a.iscfibroad2013_koodi = '05' or d6a.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6a.iscfibroad2013_koodi = '05' or d7a.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7a.iscfibroad2013_koodi = '05' or d8a.iscfibroad2013_koodi = '05') then 1*/
	else 0
end as opisk_amk_koulala5
--Opiskellut koulutusala6 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1a.iscfibroad2013_koodi = '06' or d2a.iscfibroad2013_koodi = '06') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2a.iscfibroad2013_koodi = '06' or d3a.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3a.iscfibroad2013_koodi = '06' or d4a.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4a.iscfibroad2013_koodi = '06' or d5a.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5a.iscfibroad2013_koodi = '06' or d6a.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6a.iscfibroad2013_koodi = '06' or d7a.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7a.iscfibroad2013_koodi = '06' or d8a.iscfibroad2013_koodi = '06') then 1*/
	else 0
end as opisk_amk_koulala6
--Opiskellut koulutusala7 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1a.iscfibroad2013_koodi = '07' or d2a.iscfibroad2013_koodi = '07') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2a.iscfibroad2013_koodi = '07' or d3a.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3a.iscfibroad2013_koodi = '07' or d4a.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4a.iscfibroad2013_koodi = '07' or d5a.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5a.iscfibroad2013_koodi = '07' or d6a.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6a.iscfibroad2013_koodi = '07' or d7a.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7a.iscfibroad2013_koodi = '07' or d8a.iscfibroad2013_koodi = '07') then 1*/
	else 0
end as opisk_amk_koulala7
--Opiskellut koulutusala8 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1a.iscfibroad2013_koodi = '08' or d2a.iscfibroad2013_koodi = '08') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2a.iscfibroad2013_koodi = '08' or d3a.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3a.iscfibroad2013_koodi = '08' or d4a.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4a.iscfibroad2013_koodi = '08' or d5a.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5a.iscfibroad2013_koodi = '08' or d6a.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6a.iscfibroad2013_koodi = '08' or d7a.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7a.iscfibroad2013_koodi = '08' or d8a.iscfibroad2013_koodi = '08') then 1*/
	else 0
end as opisk_amk_koulala8
--Opiskellut koulutusala9 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1a.iscfibroad2013_koodi = '09' or d2a.iscfibroad2013_koodi = '09') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2a.iscfibroad2013_koodi = '09' or d3a.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3a.iscfibroad2013_koodi = '09' or d4a.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4a.iscfibroad2013_koodi = '09' or d5a.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5a.iscfibroad2013_koodi = '09' or d6a.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6a.iscfibroad2013_koodi = '09' or d7a.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7a.iscfibroad2013_koodi = '09' or d8a.iscfibroad2013_koodi = '09') then 1*/
	else 0
end as opisk_amk_koulala9
--Opiskellut koulutusala10 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1a.iscfibroad2013_koodi = '10' or d2a.iscfibroad2013_koodi = '10') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2a.iscfibroad2013_koodi = '10' or d3a.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3a.iscfibroad2013_koodi = '10' or d4a.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4a.iscfibroad2013_koodi = '10' or d5a.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5a.iscfibroad2013_koodi = '10' or d6a.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6a.iscfibroad2013_koodi = '10' or d7a.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7a.iscfibroad2013_koodi = '10' or d8a.iscfibroad2013_koodi = '10') then 1*/
	else 0
end as opisk_amk_koulala10




--Opiskellut koulutusala1 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1b.iscfibroad2013_koodi = '01' or d2b.iscfibroad2013_koodi = '01') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2b.iscfibroad2013_koodi = '01' or d3b.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3b.iscfibroad2013_koodi = '01' or d4b.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4b.iscfibroad2013_koodi = '01' or d5b.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5b.iscfibroad2013_koodi = '01' or d6b.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6b.iscfibroad2013_koodi = '01' or d7b.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7b.iscfibroad2013_koodi = '01' or d8b.iscfibroad2013_koodi = '01') then 1*/
	else 0
end as opisk_yo_koulala1
--Opiskellut koulutusala2 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1b.iscfibroad2013_koodi = '02' or d2b.iscfibroad2013_koodi = '02') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2b.iscfibroad2013_koodi = '02' or d3b.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3b.iscfibroad2013_koodi = '02' or d4b.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4b.iscfibroad2013_koodi = '02' or d5b.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5b.iscfibroad2013_koodi = '02' or d6b.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6b.iscfibroad2013_koodi = '02' or d7b.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7b.iscfibroad2013_koodi = '02' or d8b.iscfibroad2013_koodi = '02') then 1*/
	else 0
end as opisk_yo_koulala2
--Opiskellut koulutusala3 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1b.iscfibroad2013_koodi = '03' or d2b.iscfibroad2013_koodi = '03') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2b.iscfibroad2013_koodi = '03' or d3b.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3b.iscfibroad2013_koodi = '03' or d4b.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4b.iscfibroad2013_koodi = '03' or d5b.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5b.iscfibroad2013_koodi = '03' or d6b.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6b.iscfibroad2013_koodi = '03' or d7b.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7b.iscfibroad2013_koodi = '03' or d8b.iscfibroad2013_koodi = '03') then 1*/
	else 0
end as opisk_yo_koulala3
--Opiskellut koulutusala4 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1b.iscfibroad2013_koodi = '04' or d2b.iscfibroad2013_koodi = '04') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2b.iscfibroad2013_koodi = '04' or d3b.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3b.iscfibroad2013_koodi = '04' or d4b.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4b.iscfibroad2013_koodi = '04' or d5b.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5b.iscfibroad2013_koodi = '04' or d6b.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6b.iscfibroad2013_koodi = '04' or d7b.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7b.iscfibroad2013_koodi = '04' or d8b.iscfibroad2013_koodi = '04') then 1*/
	else 0
end as opisk_yo_koulala4
--Opiskellut koulutusala5 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1b.iscfibroad2013_koodi = '05' or d2b.iscfibroad2013_koodi = '05') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2b.iscfibroad2013_koodi = '05' or d3b.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3b.iscfibroad2013_koodi = '05' or d4b.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4b.iscfibroad2013_koodi = '05' or d5b.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5b.iscfibroad2013_koodi = '05' or d6b.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6b.iscfibroad2013_koodi = '05' or d7b.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7b.iscfibroad2013_koodi = '05' or d8b.iscfibroad2013_koodi = '05') then 1*/
	else 0
end as opisk_yo_koulala5
--Opiskellut koulutusala6 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1b.iscfibroad2013_koodi = '06' or d2b.iscfibroad2013_koodi = '06') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2b.iscfibroad2013_koodi = '06' or d3b.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3b.iscfibroad2013_koodi = '06' or d4b.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4b.iscfibroad2013_koodi = '06' or d5b.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5b.iscfibroad2013_koodi = '06' or d6b.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6b.iscfibroad2013_koodi = '06' or d7b.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7b.iscfibroad2013_koodi = '06' or d8b.iscfibroad2013_koodi = '06') then 1*/
	else 0
end as opisk_yo_koulala6
--Opiskellut koulutusala7 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1b.iscfibroad2013_koodi = '07' or d2b.iscfibroad2013_koodi = '07') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2b.iscfibroad2013_koodi = '07' or d3b.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3b.iscfibroad2013_koodi = '07' or d4b.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4b.iscfibroad2013_koodi = '07' or d5b.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5b.iscfibroad2013_koodi = '07' or d6b.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6b.iscfibroad2013_koodi = '07' or d7b.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7b.iscfibroad2013_koodi = '07' or d8b.iscfibroad2013_koodi = '07') then 1*/
	else 0
end as opisk_yo_koulala7
--Opiskellut koulutusala8 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1b.iscfibroad2013_koodi = '08' or d2b.iscfibroad2013_koodi = '08') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2b.iscfibroad2013_koodi = '08' or d3b.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3b.iscfibroad2013_koodi = '08' or d4b.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4b.iscfibroad2013_koodi = '08' or d5b.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5b.iscfibroad2013_koodi = '08' or d6b.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6b.iscfibroad2013_koodi = '08' or d7b.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7b.iscfibroad2013_koodi = '08' or d8b.iscfibroad2013_koodi = '08') then 1*/
	else 0
end as opisk_yo_koulala8
--Opiskellut koulutusala9 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1b.iscfibroad2013_koodi = '09' or d2b.iscfibroad2013_koodi = '09') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2b.iscfibroad2013_koodi = '09' or d3b.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3b.iscfibroad2013_koodi = '09' or d4b.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4b.iscfibroad2013_koodi = '09' or d5b.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5b.iscfibroad2013_koodi = '09' or d6b.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6b.iscfibroad2013_koodi = '09' or d7b.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7b.iscfibroad2013_koodi = '09' or d8b.iscfibroad2013_koodi = '09') then 1*/
	else 0
end as opisk_yo_koulala9
--Opiskellut koulutusala10 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1b.iscfibroad2013_koodi = '10' or d2b.iscfibroad2013_koodi = '10') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2b.iscfibroad2013_koodi = '10' or d3b.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3b.iscfibroad2013_koodi = '10' or d4b.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4b.iscfibroad2013_koodi = '10' or d5b.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5b.iscfibroad2013_koodi = '10' or d6b.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6b.iscfibroad2013_koodi = '10' or d7b.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7b.iscfibroad2013_koodi = '10' or d8b.iscfibroad2013_koodi = '10') then 1*/
	else 0
end as opisk_yo_koulala10



--Opiskellut useampaa kuin yhtä alaa (taso 1) (kyllä/ei)
,case --ensimmäisenä vuotena on mahdollista olla vain yksi ala
	when  l.suorlk = '1' and m1.MinValue <> m1.MaxValue then 1 
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and m2.MinValue <> m2.MaxValue then 1 
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and m3.MinValue <> m3.MaxValue then 1 
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and m4.MinValue <> m4.MaxValue then 1 
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and m5.MinValue <> m5.MaxValue then 1 
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and m6.MinValue <> m6.MaxValue then 1 
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and m7.MinValue <> m7.MaxValue then 1 */
	else 0
end as opisk_vah2_koulala


----HAUT KYLLÄ/EI
--Hakenut ammatilliseen koulutukseen
,case
	when  l.suorlk = '1' and (l.monihaku_1 in (2,3,5) or l.monihaku_2 in (2,3,5)) then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.monihaku_2 in (2,3,5) or l.monihaku2006 in (2,3,5)) then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.monihaku2006 in (2,3,5) or l.monihaku2007 in (2,3,5)) then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.monihaku2007 in (2,3,5) or l.monihaku2008 in (2,3,5)) then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.monihaku2008 in (2,3,5) or l.monihaku2009 in (2,3,5)) then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.monihaku2009 in (2,3,5) or l.monihaku2010 in (2,3,5)) then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.monihaku2010 in (2,3,5) or l.monihaku2011 in (2,3,5)) then 1*/
	else 0
end as haku_amm
--Hakenut ammattikorkeakoulutukseen
,case
	when  l.suorlk = '1' and (l.monihaku_1 in (4,6) or l.monihaku_2 in (4,6)) then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.monihaku_2 in (4,6) or l.monihaku2006 in (4,6)) then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.monihaku2006 in (4,6) or l.monihaku2007 in (4,6)) then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.monihaku2007 in (4,6) or l.monihaku2008 in (4,6)) then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.monihaku2008 in (4,6) or l.monihaku2009 in (4,6)) then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.monihaku2009 in (4,6) or l.monihaku2010 in (4,6)) then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.monihaku2010 in (4,6) or l.monihaku2011 in (4,6)) then 1*/
	else 0
end as haku_amk
--Hakenut yliopistokoulutukseen
,case
	when  l.suorlk = '1' and (l.monihaku_1 in (6,7) or l.monihaku_2 in (6,7)) then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.monihaku_2 in (6,7) or l.monihaku2006 in (6,7)) then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.monihaku2006 in (6,7) or l.monihaku2007 in (6,7)) then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.monihaku2007 in (6,7) or l.monihaku2008 in (6,7)) then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.monihaku2008 in (6,7) or l.monihaku2009 in (6,7)) then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.monihaku2009 in (6,7) or l.monihaku2010 in (6,7)) then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.monihaku2010 in (6,7) or l.monihaku2011 in (6,7)) then 1*/
	else 0
end as haku_yo




----MITTARIT
--Ei hakenut eikä opiskellut mitään
,case
	when  l.suorlk = '1' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and l.luopiskkoulk_1 = '' and l.ammopiskkoulk_1 = '' and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and monihaku_2 not in (4,5,6,7) and monihaku2006 not in (4,5,6,7) and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.luopiskkoulk2006 = '' and l.ammopiskkoulk2006 = '' and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and monihaku2006 not in (4,5,6,7) and monihaku2007 not in (4,5,6,7) and l.luopiskkoulk2006 = '' and l.ammopiskkoulk2006 = '' and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' and l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and monihaku2007 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1*/
	else 0
end eihaku_kk_eiopisk

--Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa
,case 
	when  l.suorlk = '1' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and (l.luopiskkoulk_1 <> '' or l.ammopiskkoulk_1 <> '' or l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and monihaku_2 not in (4,5,6,7) and monihaku2006 not in (4,5,6,7) and (l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '' or l.luopiskkoulk2006 <> '' or l.ammopiskkoulk2006 <> '') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and monihaku2006 not in (4,5,6,7) and monihaku2007 not in (4,5,6,7) and (l.luopiskkoulk2006 <> '' or l.ammopiskkoulk2006 <> '' or l.luopiskkoulk2007 <> '' or l.ammopiskkoulk2007 <> '') and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and monihaku2007 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and (l.luopiskkoulk2007 <> '' or l.ammopiskkoulk2007 <> '' or l.luopiskkoulk2008 <> '' or l.ammopiskkoulk2008 <> '') and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and (l.luopiskkoulk2008 <> '' or l.ammopiskkoulk2008 <> '' or l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '') and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and (l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '') and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and (l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1*/
	else 0
end eihaku_kk_eiopisk_kk_opisk_ta

----Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa, opiskellut lukiokoulutuksessa
,case 
	when  l.suorlk = '1' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and (l.luopiskkoulk_1 <> '' or l.luopiskkoulk_2 <> '') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = ''  then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and monihaku_2 not in (4,5,6,7) and monihaku2006 not in (4,5,6,7) and (l.luopiskkoulk_2 <> '' or l.luopiskkoulk2006 <> '') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and monihaku2006 not in (4,5,6,7) and monihaku2007 not in (4,5,6,7) and (l.luopiskkoulk2006 <> '' or l.luopiskkoulk2007 <> '') and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and monihaku2007 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and (l.luopiskkoulk2007 <> '' or l.luopiskkoulk2008 <> '') and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and (l.luopiskkoulk2008 <> '' or l.luopiskkoulk2009 <> '') and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and (l.luopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '') and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and (l.luopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1*/
	else 0
end eihaku_kk_eiopisk_kk_opisk_lu

----Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa, opiskellut ammatillisessa peruskoulutuksessa
,case 
	when  l.suorlk = '1' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and (l.ammopiskkoulk_1 <> '' or l.ammopiskkoulk_2 <> '') and (d1c.Koulutusaste_taso2_koodi = '32' or d2c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and monihaku_2 not in (4,5,6,7) and monihaku2006 not in (4,5,6,7) and (l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk2006 <> '') and (d2c.Koulutusaste_taso2_koodi = '32' or d3c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and monihaku2006 not in (4,5,6,7) and monihaku2007 not in (4,5,6,7) and (l.ammopiskkoulk2006 <> '' or l.ammopiskkoulk2007 <> '') and (d3c.Koulutusaste_taso2_koodi = '32' or d4c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and monihaku2007 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and (l.ammopiskkoulk2007 <> '' or l.ammopiskkoulk2008 <> '') and (d4c.Koulutusaste_taso2_koodi = '32' or d5c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and (l.ammopiskkoulk2008 <> '' or l.ammopiskkoulk2009 <> '') and (d5c.Koulutusaste_taso2_koodi = '32' or d6c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and (l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '') and (d6c.Koulutusaste_taso2_koodi = '32' or d7c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and (l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '') and (d7c.Koulutusaste_taso2_koodi = '32' or d8c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1*/
	else 0
end eihaku_kk_eiopisk_kk_opisk_pk

------Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa, opiskellut ammattitutkintokoulutuksessa
,case 
	when  l.suorlk = '1' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and (l.ammopiskkoulk_1 <> '' or l.ammopiskkoulk_2 <> '') and (d1c.Koulutusaste_taso2_koodi = '33' or d2c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and monihaku_2 not in (4,5,6,7) and monihaku2006 not in (4,5,6,7) and (l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk2006 <> '') and (d2c.Koulutusaste_taso2_koodi = '33' or d3c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and monihaku2006 not in (4,5,6,7) and monihaku2007 not in (4,5,6,7) and (l.ammopiskkoulk2006 <> '' or l.ammopiskkoulk2007 <> '') and (d3c.Koulutusaste_taso2_koodi = '33' or d4c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and monihaku2007 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and (l.ammopiskkoulk2007 <> '' or l.ammopiskkoulk2008 <> '') and (d4c.Koulutusaste_taso2_koodi = '33' or d5c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and (l.ammopiskkoulk2008 <> '' or l.ammopiskkoulk2009 <> '') and (d5c.Koulutusaste_taso2_koodi = '33' or d6c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and (l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '') and (d6c.Koulutusaste_taso2_koodi = '33' or d7c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and (l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '') and (d7c.Koulutusaste_taso2_koodi = '33' or d8c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1*/
	else 0
end eihaku_kk_eiopisk_kk_opisk_at

------Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa, opiskellut erikoisammattitutkintokoulutuksessa
,case 
	when  l.suorlk = '1' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and (l.ammopiskkoulk_1 <> '' or l.ammopiskkoulk_2 <> '') and (d1c.Koulutusaste_taso2_koodi = '41' or d2c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and monihaku_2 not in (4,5,6,7) and monihaku2006 not in (4,5,6,7) and (l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk2006 <> '') and (d2c.Koulutusaste_taso2_koodi = '41' or d3c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and monihaku2006 not in (4,5,6,7) and monihaku2007 not in (4,5,6,7) and (l.ammopiskkoulk2006 <> '' or l.ammopiskkoulk2007 <> '') and (d3c.Koulutusaste_taso2_koodi = '41' or d4c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and monihaku2007 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and (l.ammopiskkoulk2007 <> '' or l.ammopiskkoulk2008 <> '') and (d4c.Koulutusaste_taso2_koodi = '41' or d5c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and (l.ammopiskkoulk2008 <> '' or l.ammopiskkoulk2009 <> '') and (d5c.Koulutusaste_taso2_koodi = '41' or d6c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and (l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '') and (d6c.Koulutusaste_taso2_koodi = '41' or d7c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and (l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '') and (d7c.Koulutusaste_taso2_koodi = '41' or d8c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1*/
	else 0
end eihaku_kk_eiopisk_kk_opisk_eat

--Hakenut korkea-asteelle, ei opiskellut korkea-asteella
,case 
	when  l.suorlk = '1' and (monihaku_1 in (4,5,6,7) or monihaku_2 in (4,5,6,7)) and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (monihaku_2 in (4,5,6,7) or monihaku2006 in (4,5,6,7)) and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (monihaku2006 in (4,5,6,7) or monihaku2007 in (4,5,6,7)) and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (monihaku2007 in (4,5,6,7) or monihaku2008 in (4,5,6,7)) and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (monihaku2008 in (4,5,6,7) or monihaku2009 in (4,5,6,7)) and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (monihaku2009 in (4,5,6,7) or monihaku2010 in (4,5,6,7)) and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7)) and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1*/
	else 0
end haku_kk_eiopisk_kk
----Hakenut korkea-asteelle, ei opiskellut korkea-asteella, ei-opiskellut toisen asteen koulutuksessa
,case
	when  l.suorlk = '1' and (monihaku_1 in (4,5,6,7) or monihaku_2 in (4,5,6,7)) and l.luopiskkoulk_1 = '' and l.ammopiskkoulk_1 = '' and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (monihaku_2 in (4,5,6,7) or monihaku2006 in (4,5,6,7)) and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.luopiskkoulk2006 = '' and l.ammopiskkoulk2006 = '' and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (monihaku2006 in (4,5,6,7) or monihaku2007 in (4,5,6,7)) and l.luopiskkoulk2006 = '' and l.ammopiskkoulk2006 = '' and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' and l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (monihaku2007 in (4,5,6,7) or monihaku2008 in (4,5,6,7)) and l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (monihaku2008 in (4,5,6,7) or monihaku2009 in (4,5,6,7)) and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (monihaku2009 in (4,5,6,7) or monihaku2010 in (4,5,6,7)) and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7)) and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1*/
	else 0
end haku_kk_eiopisk_kk_eiopisk_ta
----Hakenut korkea-asteelle, ei opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa
,case
	when  l.suorlk = '1' and (monihaku_1 in (4,5,6,7) or monihaku_2 in (4,5,6,7)) and (l.luopiskkoulk_1 <> '' or l.ammopiskkoulk_1 <> '' or l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (monihaku_2 in (4,5,6,7) or monihaku2006 in (4,5,6,7)) and (l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '' or l.luopiskkoulk2006 <> '' or l.ammopiskkoulk2006 <> '') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (monihaku2006 in (4,5,6,7) or monihaku2007 in (4,5,6,7)) and (l.luopiskkoulk2006 <> '' or l.ammopiskkoulk2006 <> '' or l.luopiskkoulk2007 <> '' or l.ammopiskkoulk2007 <> '') and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (monihaku2007 in (4,5,6,7) or monihaku2008 in (4,5,6,7)) and (l.luopiskkoulk2007 <> '' or l.ammopiskkoulk2007 <> '' or l.luopiskkoulk2008 <> '' or l.ammopiskkoulk2008 <> '') and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (monihaku2008 in (4,5,6,7) or monihaku2009 in (4,5,6,7)) and (l.luopiskkoulk2008 <> '' or l.ammopiskkoulk2008 <> '' or l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '') and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (monihaku2009 in (4,5,6,7) or monihaku2010 in (4,5,6,7)) and (l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '') and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7)) and (l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1*/
	else 0
end haku_kk_eiopisk_kk_opisk_ta
----Hakenut vain ammattikorkeakouluun, ei opiskellut korkea-asteella
,case
	when  l.suorlk = '1' and (monihaku_1 = 4 or monihaku_2 = 4) and (monihaku_1 not in (5,6,7) and monihaku_2 not in (5,6,7)) and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (monihaku_2 = 4 or monihaku2006 = 4) and (monihaku_2 not in (5,6,7) and monihaku2006 not in (5,6,7)) and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (monihaku2006 = 4 or monihaku2007 = 4) and (monihaku2006 not in (5,6,7) and monihaku2007 not in (5,6,7)) and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (monihaku2007 = 4 or monihaku2008 = 4) and (monihaku2007 not in (5,6,7) and monihaku2008 not in (5,6,7)) and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (monihaku2008 = 4 or monihaku2009 = 4) and (monihaku2008 not in (5,6,7) and monihaku2009 not in (5,6,7)) and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (monihaku2009 = 4 or monihaku2010 = 4) and (monihaku2009 not in (5,6,7) and monihaku2010 not in (5,6,7)) and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (monihaku2010 = 4 or monihaku2011 = 4) and (monihaku2010 not in (5,6,7) and monihaku2011 not in (5,6,7)) and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1*/
	else 0
end haku_amk_eiopisk_kk
----Hakenut vain yliopistokoulutukseen, ei opiskellut korkea-asteella
,case
	when  l.suorlk = '1' and (monihaku_1 = 7 or monihaku_2 = 7) and (monihaku_1 not in (4,5,6) and monihaku_2 not in (4,5,6)) and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (monihaku_2 = 7 or monihaku2006 = 7) and (monihaku_2 not in (4,5,6) and monihaku2006 not in (4,5,6)) and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (monihaku2006 = 7 or monihaku2007 = 7) and (monihaku2006 not in (4,5,6) and monihaku2007 not in (4,5,6)) and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (monihaku2007 = 7 or monihaku2008 = 7) and (monihaku2007 not in (4,5,6) and monihaku2008 not in (4,5,6)) and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (monihaku2008 = 7 or monihaku2009 = 7) and (monihaku2008 not in (4,5,6) and monihaku2009 not in (4,5,6)) and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (monihaku2009 = 7 or monihaku2010 = 7) and (monihaku2009 not in (4,5,6) and monihaku2010 not in (4,5,6)) and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (monihaku2010 = 7 or monihaku2011 = 7) and (monihaku2010 not in (4,5,6) and monihaku2011 not in (4,5,6)) and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1*/
	else 0
end haku_yo_eiopisk_kk
----Hakenut sekä amk- että yliopistokoulutukseen, ei opiskellut korkea-asteella
,case
	when  l.suorlk = '1' and (monihaku_1 = 6 or monihaku_2 = 6 or ((monihaku_1 = 4 or monihaku_2 = 4) and (monihaku_1 = 7 or monihaku_2 = 7))) and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (monihaku_2 = 6 or monihaku2006 = 6 or ((monihaku_2 = 4 or monihaku2006 = 4) and (monihaku_2 = 7 or monihaku2006 = 7))) and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (monihaku2006 = 6 or monihaku2007 = 6 or ((monihaku2006 = 4 or monihaku2007 = 4) and (monihaku2006 = 7 or monihaku2007 = 7))) and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (monihaku2007 = 6 or monihaku2008 = 6 or ((monihaku2007 = 4 or monihaku2008 = 4) and (monihaku2007 = 7 or monihaku2008 = 7))) and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (monihaku2008 = 6 or monihaku2009 = 6 or ((monihaku2008 = 4 or monihaku2009 = 4) and (monihaku2008 = 7 or monihaku2009 = 7))) and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (monihaku2009 = 6 or monihaku2010 = 6 or ((monihaku2009 = 4 or monihaku2010 = 4) and (monihaku2009 = 7 or monihaku2010 = 7))) and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (monihaku2010 = 6 or monihaku2011 = 6 or ((monihaku2010 = 4 or monihaku2011 = 4) and (monihaku2010 = 7 or monihaku2011 = 7))) and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1*/
	else 0
end haku_amkyo_eiopisk_kk

--Opiskellut korkea-asteella
,case
	when  l.suorlk = '1' and (l.amkopiskkoulk_1 <> '' or l.yoopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '' or l.amkopiskkoulk2006 <> '' or l.yoopiskkoulk2006 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2006 <> '' or l.yoopiskkoulk2006 <> '' or l.amkopiskkoulk2007 <> '' or l.yoopiskkoulk2007 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2007 <> '' or l.yoopiskkoulk2007 <> '' or l.amkopiskkoulk2008 <> '' or l.yoopiskkoulk2008 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2008 <> '' or l.yoopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '') then 1*/
	else 0
end opisk_kk
----Opiskellut korkea-asteella, ei-opiskellut toisen asteen koulutuksessa
,case
	when  l.suorlk = '1' and l.luopiskkoulk_1 = '' and l.ammopiskkoulk_1 = '' and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and (l.amkopiskkoulk_1 <> '' or l.yoopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and l.luopiskkoulk2006 = '' and l.ammopiskkoulk2006 = '' and (l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '' or l.amkopiskkoulk2006 <> '' or l.yoopiskkoulk2006 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and l.luopiskkoulk2006 = '' and l.ammopiskkoulk2006 = '' and l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 = '' and (l.amkopiskkoulk2006 <> '' or l.yoopiskkoulk2006 <> '' or l.amkopiskkoulk2007 <> '' or l.yoopiskkoulk2007 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 = '' and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' and (l.amkopiskkoulk2007 <> '' or l.yoopiskkoulk2007 <> '' or l.amkopiskkoulk2008 <> '' or l.yoopiskkoulk2008 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and (l.amkopiskkoulk2008 <> '' or l.yoopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and (l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and (l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '') then 1*/
	else 0
end opisk_kk_eiopisk_ta
----Opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa
,case
	when  l.suorlk = '1' and (l.luopiskkoulk_1 <> '' or l.ammopiskkoulk_1 <> '' or l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '') and (l.amkopiskkoulk_1 <> '' or l.yoopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '' or l.luopiskkoulk2006 <> '' or l.ammopiskkoulk2006 <> '') and (l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '' or l.amkopiskkoulk2006 <> '' or l.yoopiskkoulk2006 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk2006 <> '' or l.ammopiskkoulk2006 <> '' or l.luopiskkoulk2007 <> '' or l.ammopiskkoulk2007 <> '') and (l.amkopiskkoulk2006 <> '' or l.yoopiskkoulk2006 <> '' or l.amkopiskkoulk2007 <> '' or l.yoopiskkoulk2007 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk2007 <> '' or l.ammopiskkoulk2007 <> '' or l.luopiskkoulk2008 <> '' or l.ammopiskkoulk2008 <> '') and (l.amkopiskkoulk2007 <> '' or l.yoopiskkoulk2007 <> '' or l.amkopiskkoulk2008 <> '' or l.yoopiskkoulk2008 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk2008 <> '' or l.ammopiskkoulk2008 <> '' or l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '') and (l.amkopiskkoulk2008 <> '' or l.yoopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '') and (l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '') and (l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '') then 1*/
	else 0
end opisk_kk_opisk_ta
----Opiskellut vain ammattikorkeakoulussa
,case
	when  l.suorlk = '1' and (l.amkopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '') and l.yoopiskkoulk_1 = '' and l.yoopiskkoulk_2 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk_2 <> '' or l.amkopiskkoulk2006 <> '') and l.yoopiskkoulk_2 = '' and l.yoopiskkoulk2006 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2006 <> '' or l.amkopiskkoulk2007 <> '') and l.yoopiskkoulk2006 = '' and l.yoopiskkoulk2007 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2007 <> '' or l.amkopiskkoulk2008 <> '') and l.yoopiskkoulk2007 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '') and l.yoopiskkoulk2008 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '') and l.yoopiskkoulk2009 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '') and l.yoopiskkoulk2010 = '' and l.yoopiskkoulk2011 = '' then 1*/
	else 0
end opisk_vain_amk
----Opiskellut vain yliopistokoulutuksessa
,case
	when  l.suorlk = '1' and l.amkopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and (l.yoopiskkoulk_1 <> '' or l.yoopiskkoulk_2 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and l.amkopiskkoulk_2 = '' and l.amkopiskkoulk2006 = '' and (l.yoopiskkoulk_2 <> '' or l.yoopiskkoulk2006 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and l.amkopiskkoulk2006 = '' and l.amkopiskkoulk2007 = '' and (l.yoopiskkoulk2006 <> '' or l.yoopiskkoulk2007 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and l.amkopiskkoulk2007 = '' and l.amkopiskkoulk2008 = '' and (l.yoopiskkoulk2007 <> '' or l.yoopiskkoulk2008 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and l.amkopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and (l.yoopiskkoulk2008 <> '' or l.yoopiskkoulk2009 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and l.amkopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and (l.yoopiskkoulk2009 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and l.amkopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and (l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '') then 1*/
	else 0
end opisk_vain_yo
----Opiskellut sekä amk- että yliopistokoulutuksessa
,case
	when  l.suorlk = '1' and (l.amkopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '') and (l.yoopiskkoulk_1 <> '' or l.yoopiskkoulk_2 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk_2 <> '' or l.amkopiskkoulk2006 <> '') and (l.yoopiskkoulk_2 <> '' or l.yoopiskkoulk2006 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2006 <> '' or l.amkopiskkoulk2007 <> '') and (l.yoopiskkoulk2006 <> '' or l.yoopiskkoulk2007 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2007 <> '' or l.amkopiskkoulk2008 <> '') and (l.yoopiskkoulk2007 <> '' or l.yoopiskkoulk2008 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '') and (l.yoopiskkoulk2008 <> '' or l.yoopiskkoulk2009 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '') and (l.yoopiskkoulk2009 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '') and (l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '') then 1*/
	else 0
end opisk_amkyo





FROM 
    (
	select * from [VipunenTK_SA].[dbo].[v_K3_13_Perusk_paattaneet_amm_tutk_suorittaneet]
	where suorlk = '1'
	) as l


LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d1a on d1a.koulutusluokitus_avain=l.amkopiskkoulk_1
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d2a on d2a.koulutusluokitus_avain=l.amkopiskkoulk_2
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d3a on d3a.koulutusluokitus_avain=l.amkopiskkoulk_3
/*LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d4a on d4a.koulutusluokitus_avain=l.amkopiskkoulk2007
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d5a on d5a.koulutusluokitus_avain=l.amkopiskkoulk2008
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d6a on d6a.koulutusluokitus_avain=l.amkopiskkoulk2009
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d7a on d7a.koulutusluokitus_avain=l.amkopiskkoulk2010
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d8a on d8a.koulutusluokitus_avain=l.amkopiskkoulk2011
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d9a on d9a.koulutusluokitus_avain=l.amkopiskkoulk2012*/

LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d1b on d1b.koulutusluokitus_avain=l.yoopiskkoulk_1
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d2b on d2b.koulutusluokitus_avain=l.yoopiskkoulk_2
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d3b on d3b.koulutusluokitus_avain=l.yoopiskkoulk_3
/*LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d4b on d4b.koulutusluokitus_avain=l.yoopiskkoulk2007
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d5b on d5b.koulutusluokitus_avain=l.yoopiskkoulk2008
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d6b on d6b.koulutusluokitus_avain=l.yoopiskkoulk2009
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d7b on d7b.koulutusluokitus_avain=l.yoopiskkoulk2010
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d8b on d8b.koulutusluokitus_avain=l.yoopiskkoulk2011	
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d9b on d9b.koulutusluokitus_avain=l.yoopiskkoulk2012*/

LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d1c on d1c.koulutusluokitus_avain=l.ammopiskkoulk_1
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d2c on d2c.koulutusluokitus_avain=l.ammopiskkoulk_2
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d3c on d3c.koulutusluokitus_avain=l.ammopiskkoulk_3
/*LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d4c on d4c.koulutusluokitus_avain=l.ammopiskkoulk2007
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d5c on d5c.koulutusluokitus_avain=l.ammopiskkoulk2008
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d6c on d6c.koulutusluokitus_avain=l.ammopiskkoulk2009
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d7c on d7c.koulutusluokitus_avain=l.ammopiskkoulk2010
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d8c on d8c.koulutusluokitus_avain=l.ammopiskkoulk2011
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d9c on d9c.koulutusluokitus_avain=l.ammopiskkoulk2012*/

CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d1a.iscfibroad2013_koodi),(d1b.iscfibroad2013_koodi), (d2a.iscfibroad2013_koodi),(d2b.iscfibroad2013_koodi), (d3a.iscfibroad2013_koodi),(d3b.iscfibroad2013_koodi)) AS a(d)) m1
/*CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d2a.iscfibroad2013_koodi),(d2b.iscfibroad2013_koodi), (d3a.iscfibroad2013_koodi),(d3b.iscfibroad2013_koodi), (d4a.iscfibroad2013_koodi),(d4b.iscfibroad2013_koodi)) AS a(d)) m2
CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d3a.iscfibroad2013_koodi),(d3b.iscfibroad2013_koodi), (d4a.iscfibroad2013_koodi),(d4b.iscfibroad2013_koodi), (d5a.iscfibroad2013_koodi),(d5b.iscfibroad2013_koodi)) AS a(d)) m3
CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d4a.iscfibroad2013_koodi),(d4b.iscfibroad2013_koodi), (d5a.iscfibroad2013_koodi),(d5b.iscfibroad2013_koodi), (d6a.iscfibroad2013_koodi),(d6b.iscfibroad2013_koodi)) AS a(d)) m4
CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d5a.iscfibroad2013_koodi),(d5b.iscfibroad2013_koodi), (d6a.iscfibroad2013_koodi),(d6b.iscfibroad2013_koodi), (d7a.iscfibroad2013_koodi),(d7b.iscfibroad2013_koodi)) AS a(d)) m5
CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d6a.iscfibroad2013_koodi),(d6b.iscfibroad2013_koodi), (d7a.iscfibroad2013_koodi),(d7b.iscfibroad2013_koodi), (d8a.iscfibroad2013_koodi),(d8b.iscfibroad2013_koodi)) AS a(d)) m6
CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d7a.iscfibroad2013_koodi),(d7b.iscfibroad2013_koodi), (d8a.iscfibroad2013_koodi),(d8b.iscfibroad2013_koodi), (d9a.iscfibroad2013_koodi),(d9b.iscfibroad2013_koodi)) AS a(d)) m7*/

	WHERE 1=1
--end;

--
-- TULOS
-- 
/*
if @debug_what_to_run>=3 begin
	if @debug_what_to_run>0 print 'querying result';
	select * from [VipunenTK_DW].[dbo].[_koulutukseen_sijoittuneet_6v]
	--select COUNT(*) from vipunen_tk.f_tyol_ja_jatko_opin_ where aineisto=(select id from vipunen_tk.d_aineisto where aineistokoodi='4.3' and @toinen_suoritusvuosi between alkaa and paattyy)
end;

if @debug_what_to_run>0 PRINT 'all done.';
*/


GO
/****** Object:  StoredProcedure [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_2_0_tarkastelujakso]    Script Date: 29.8.2018 15:59:41 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


CREATE PROCEDURE [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_2_0_tarkastelujakso] AS
/*declare @debug_what_to_run tinyint; set @debug_what_to_run=2; -- käytä arvoa 3 vain kun teet yhden vuoden
print '$'+convert(varchar,sysdatetime(),20)+'$ '+'DEBUG (what to run)='+cast(@debug_what_to_run as varchar)+
': 0=luo vain taulut, älä tulosta mitään; 1=luo taulut ja tulosta joitakin merkittävimpiä välivaiheita; 2=luo taulut ja tulosta välivaiheet; 3=luo taulut, tulosta välivaiheet ja tulosta myös tulokset, 4=tulosta välivaiheet, mutta älä tee mitään';




-- lisätään data
if @debug_what_to_run not in (4) begin
if @debug_what_to_run>0 print 'inserting data';

-- parametrimuuttujien arvot
-- parametrimuuttujat
DECLARE @ensimmainen_suoritusvuosi int;
DECLARE @toinen_suoritusvuosi int;
DECLARE @kolmas_suoritusvuosi int;
DECLARE @neljas_suoritusvuosi int;
DECLARE @viides_suoritusvuosi int;
DECLARE @kuudes_suoritusvuosi int;
DECLARE @seitsemas_suoritusvuosi int;


set @ensimmainen_suoritusvuosi = _3;
set @toinen_suoritusvuosi = 2005;
set @kolmas_suoritusvuosi = 2006;
set @neljas_suoritusvuosi = 2007;
set @viides_suoritusvuosi = 2008;
set @kuudes_suoritusvuosi = 2009;
set @seitsemas_suoritusvuosi = 2010;

*/

INSERT INTO [VipunenTK_DW].[dbo].[_koulutukseen_sijoittuneet_6v_tarkastelu]
(
rivinumero
, tarkastelujakso
, tilv 
, tilv_date
, tutkryh 
, suorv
, suorlk 
, sp 
, syntv
, aikielir1 
, tutkkaskun 
, kansalr1
, pohjmaa 
, eumaa 
, etamaa 
, tunn
, jarj
, kkielir1 
, tutklaja 
, tutktav 
, aikoul 
, tutkmaak
, koulutus_1
, oppilaitos_1
, koulutuksen_jarjestaja_1
, koulutuksen_maakunta_1
, koulutus_2
, oppilaitos_2
, koulutuksen_jarjestaja_2
, koulutuksen_maakunta_2
, monihaku
, paaasiallinen_toiminta
, ammattiasema
, lkm
, pohjkoulk
, tietolahde
, aineisto
, lukiokoulutuksessa
, ammatillisessa_koulutuksessa
, ammattikorkeakoulutuksessa
, yliopistokoulutuksessa
, lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa
, toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa
, ammattikorkeakoulutuksessa_ja_yliopistokoulutuksessa
, koulutuksen_paattaneiden_toiminta
, ika_1v
, ika_5v
, ika_1v_suorv
, opisk_lu
, opisk_amm_pk
, opisk_amm_at
, opisk_amm_eat
, opisk_amm
, opisk_amk
, opisk_yo
, opisk_amk_koulala1
, opisk_amk_koulala2
, opisk_amk_koulala3
, opisk_amk_koulala4
, opisk_amk_koulala5
, opisk_amk_koulala6
, opisk_amk_koulala7
, opisk_amk_koulala8
, opisk_amk_koulala9
, opisk_amk_koulala10
, opisk_yo_koulala1
, opisk_yo_koulala2
, opisk_yo_koulala3
, opisk_yo_koulala4
, opisk_yo_koulala5
, opisk_yo_koulala6
, opisk_yo_koulala7
, opisk_yo_koulala8
, opisk_yo_koulala9
, opisk_yo_koulala10
, opisk_vah2_koulala
, haku_amm
, haku_amk
, haku_yo
, eihaku_kk_eiopisk
, eihaku_kk_eiopisk_kk_opisk_ta
, eihaku_kk_eiopisk_kk_opisk_lu
, eihaku_kk_eiopisk_kk_opisk_pk
, eihaku_kk_eiopisk_kk_opisk_at
, eihaku_kk_eiopisk_kk_opisk_eat
, haku_kk_eiopisk_kk
, haku_kk_eiopisk_kk_eiopisk_ta
, haku_kk_eiopisk_kk_opisk_ta
, haku_amk_eiopisk_kk
, haku_yo_eiopisk_kk
, haku_amkyo_eiopisk_kk
, opisk_kk
, opisk_kk_eiopisk_ta
, opisk_kk_opisk_ta
, opisk_vain_amk
, opisk_vain_yo
, opisk_amkyo
)
SELECT
 l.rivinumero,
 '2',
 l.tilv,
 l.tilv_date,
 (case 
	when l.tutkryh=3 and tutklaja=1 then 31
	when l.tutkryh=3 and tutklaja=2 then 32
	when l.tutkryh=3 and tutklaja=3 then 33
	else l.tutkryh
  end),
 l.suorv,
  (case
	when l.suorlk = '1'  then (l.suorv+'0'+l.suorlk)
	when l.suorlk = '2'  then (l.suorv+'0'+'8')
	else ''
	end),
 l.sp,
 l.syntv,
 l.aikielir1,
 l.tutkaskun,
 l.kansalr1,
 l.pohjmaa,
 l.eumaa,
 l.etamaa,
 l.tunn,
 l.jarj,
 l.kkielir1,
 l.tutklaja,
 l.tutktav,
 l.aikoul,
 l.tutkmaak,
 -- Koulutus 1
 (case
    --lukiokoulutuksessa _3
	when l.suorlk = '1' and l.luopiskkoulk_3 <> '' and l.ammopiskkoulk_3 = '' and
	l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' then l.luopiskkoulk_3 
	-- ammattikoulutuksessa _3
	when l.suorlk = '1' and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 <> '' and
	l.amkopiskkoulk_3 ='' and l.yoopiskkoulk_3 = ''  then l.ammopiskkoulk_3 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen _3 ensim. koulutustietoihin
	when l.suorlk = '1' and l.luopiskkoulk_3 <> '' and l.ammopiskkoulk_3 <> '' and
	l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' then l.luopiskkoulk_3
	-- ammattikorkeakoulutuksessa _3
	when l.suorlk = '1' and l.amkopiskkoulk_3  <> '' and l.yoopiskkoulk_3  = '' and
	l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' then l.amkopiskkoulk_3
	-- yliopistokoulutuksessa _3
	when l.suorlk = '1' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 <> '' and 
	l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = ''   then l.yoopiskkoulk_3
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa, merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorlk = '1' and l.amkopiskkoulk_3 <> '' and l.yoopiskkoulk_3  <> '' and
	l.luopiskkoulk_3 = '' and ammopiskkoulk_3 = ''  then l.amkopiskkoulk_3 
	
	else ''

	
	    
	    end),
	    
-- Oppilaitos 1
	(case
	-- lukiokoulutuksen oppilaitos _3
	when l.suorlk = '1' and l.luopisktunn_3 <> '' and l.ammopisktunn_3 = '' and
	l.amkopisktunn_3 = '' and l.yoopisktunn_3 = '' then l.luopisktunn_3 
	-- ammattikoulutuksen oppilaitos _3
	when l.suorlk = '1' and l.luopisktunn_3 = '' and l.ammopisktunn_3 <> '' and
	l.amkopisktunn_3 ='' and l.yoopisktunn_3 = ''  then l.ammopisktunn_3 
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos _3
	when l.suorlk = '1' and l.luopisktunn_3 <> '' and l.ammopisktunn_3 <> '' and
	l.amkopisktunn_3 = '' and l.yoopisktunn_3 = '' then l.luopisktunn_3
	-- ammattikorkeakoulutuksen oppilaitos _3
	when l.suorlk = '1' and l.amkopisktunn_3  <> '' and l.yoopisktunn_3  = '' and
	l.luopisktunn_3 = '' and l.ammopisktunn_3 = '' then l.amkopisktunn_3
	-- yliopistokoulutuksen oppilaitos _3
	when l.suorlk = '1' and l.amkopisktunn_3 = '' and l.yoopisktunn_3 <> '' and 
	l.luopisktunn_3 = '' and l.ammopisktunn_3 = ''   then l.yoopisktunn_3
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus _3  
	when l.suorlk = '1' and l.amkopisktunn_3 <> '' and l.yoopisktunn_3  <> '' and
	l.luopisktunn_3 = '' and l.ammopisktunn_3 = ''  then l.amkopisktunn_3 
	
	
	

	
	else ''
	
	    end),
  --Koulutuksen järjestäjä 1
	(case
	-- lukikoulutuksen järjestäjä _3
	when l.suorlk = '1' and l.luopiskjarj_3  <> '' and l.ammopiskjarj_3 = '' and
	l.amkopiskjarj_3 = '' and yoopiskjarj_3 = '' then l.luopiskjarj_3
	-- ammatillisen koulutuksen järjestäjä _3  
	when l.suorlk = '1' and l.luopiskjarj_3 = '' and l.ammopiskjarj_3 <> '' and
	l.amkopiskjarj_3 ='' and l.yoopiskjarj_3 = ''  then l.ammopiskjarj_3
	-- lukio- ja ammatillisen koulutuksen järjestäjä, merkitään lukiokoulutuksen _3 järjestäjä 
	when l.suorlk = '1' and l.luopiskjarj_3 <> '' and l.ammopiskjarj_3 <> '' and
	l.amkopiskjarj_3 = '' and l.yoopiskjarj_3 = '' then l.luopiskjarj_3
	-- ammattikorkeakoulutuksen järjestäjä _3
	when l.suorlk = '1' and l.amkopiskjarj_3  <> '' and l.yoopiskjarj_3   = '' and
	l.luopiskjarj_3 = '' and l.ammopiskjarj_3 = '' then l.amkopiskjarj_3
	-- yliopistokoulutuksen järjestäjä _3 
	when l.suorlk = '1' and l.amkopiskjarj_3  = '' and l.yoopiskjarj_3  <> '' and 
	l.luopiskjarj_3  = '' and l.ammopiskjarj_3 = ''   then l.yoopiskjarj_3
	-- ammattikorkea- ja yliopistokoulutuksen järjestäjä, merkitään ammattikorkeakoulutuksen _3 järjestäjä   
	when l.suorlk = '1' and l.amkopiskjarj_3  <> '' and l.yoopiskjarj_3   <> '' and
	l.luopiskjarj_3  = '' and l.ammopiskjarj_3  = ''  then l.amkopiskjarj_3 

	
	else ''
	    end),
 --Koulutuksen maakunta 1
	(case
	-- lukioopiskelun maakunta _3
	when l.suorlk = '1' and l.luopiskmaak_3   <> '' and l.ammopiskmaak_3  = '' and
	l.amkopiskmaak_3  = '' and l.yoopiskmaak_3  = '' then l.luopiskmaak_3   
	-- ammatillisen koulutuksen maakunta _3
	when l.suorlk = '1' and l.luopiskmaak_3  = '' and l.ammopiskmaak_3  <> '' and
	l.amkopiskmaak_3  ='' and l.yoopiskmaak_3  = ''  then l.ammopiskmaak_3  
	-- lukiokoulutuksen ja ammatillisen koulutus otetaan lukiokoulutuksen maakunta _3
	when l.suorlk = '1' and l.luopiskmaak_3  <> '' and l.ammopiskmaak_3  <> '' and
	l.amkopiskmaak_3  = '' and l.yoopiskmaak_3  = '' then l.luopiskmaak_3 
    -- ammattikorkeakoulutuksen maakunta _3
	when l.suorlk = '1' and l.amkopiskmaak_3   <> '' and l.yoopiskmaak_3   = '' and
	l.luopiskjarj_3 = '' and l.ammopiskmaak_3 = '' then l.amkopiskmaak_3
	-- yliopistokoulutuksen maakunta _3 
	when l.suorlk = '1' and l.amkopiskmaak_3  = '' and l.yoopiskmaak_3  <> '' and 
	l.luopiskjarj_3  = '' and l.ammopiskmaak_3 = ''   then l.yoopiskmaak_3
	-- ammattikorkekoulutuksen ja yliopistokoulutksen maakunta otetaan ammattikorkeakoulutuksen maakunta _3   
	when l.suorlk = '1' and l.amkopiskmaak_3  <> '' and l.yoopiskmaak_3   <> '' and
	l.luopiskjarj_3  = '' and l.ammopiskmaak_3  = ''  then l.amkopiskmaak_3 
	
	else ''
	
	    end),
-- Koulutus 2
(case
   -- jos lukiokoulutuksessa vain niin jätetään tyhjäksi _3
	when l.suorlk = '1' and l.luopiskkoulk_3 <> '' and l.ammopiskkoulk_3 = '' and
	l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' then ''
	-- jos ammattikoulutuksessa vain  jätetään tyhjäksi _3 
	when l.suorlk = '1' and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 <> '' and
	l.amkopiskkoulk_3 ='' and l.yoopiskkoulk_3 = ''  then ''
	-- jos lukiokoulutksessa ja ammattikoulutuksessa merkitään ammattikoulutus _3 
	when l.suorlk = '1' and l.luopiskkoulk_3 <> '' and l.ammopiskkoulk_3 <> '' and
	l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' then l.ammopiskkoulk_3 
	-- jos vain ammattikorkeakoulutuksessa jätetään tyhjäksi
	when l.suorlk = '1' and l.amkopiskkoulk_3  <> '' and l.yoopiskkoulk_3  = '' and
	l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorlk = '1' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 <> '' and 
	l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = ''   then ''
	-- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus _3
	when l.suorlk = '1' and l.amkopiskkoulk_3 <> '' and l.yoopiskkoulk_3  <> '' and
	l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = ''  then l.yoopiskkoulk_3
	
	
	
	else ''
	    end),
-- Oppilaitos 2
(case
    -- lukiokoulutuksen oppilaitos vain merkitään tyhjäksi
	when l.suorlk = '1' and l.luopisktunn_3 <> '' and l.ammopisktunn_3 = '' and
	l.amkopisktunn_3 = '' and l.yoopisktunn_3 = '' then ''
	-- ammatillisen koulutuksen oppilaitos _3 merkitään tyhjäksi
	when l.suorlk = '1' and l.luopisktunn_3 = '' and l.ammopisktunn_3 <> '' and
	l.amkopisktunn_3 ='' and l.yoopisktunn_3 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos merkitään ammatillisen koulutuksen oppilaitos _3
	when l.suorlk = '1' and l.luopisktunn_3 <> '' and l.ammopisktunn_3 <> '' and
	l.amkopisktunn_3 = '' and l.yoopisktunn_3 = '' then l.ammopisktunn_3 
	-- ammattikorkeakoulutksen oppilaitos vain merkitään tyhjäksi _3
	when l.suorlk = '1' and l.amkopisktunn_3  <> '' and l.yoopisktunn_3  = '' and
	l.luopisktunn_3 = '' and l.ammopisktunn_3 = '' then ''
	-- yliopistokoulutksen oppilaitos vain merkitään tyhjäksi _3
	when l.suorlk = '1' and l.amkopisktunn_3 = '' and l.yoopisktunn_3 <> '' and 
	l.luopisktunn_3 = '' and l.ammopisktunn_3 = ''   then ''  
	--  ammattikorkeakoulutksen oppilaitos ja yliopistokoulutuksen oppilaitos, merkitään yliopistokoulutuksen oppilaitos _3
	when l.suorlk = '1' and l.amkopisktunn_3 <> '' and l.yoopisktunn_3  <> '' and
	l.luopisktunn_3 = '' and l.ammopisktunn_3 = ''  then l.yoopisktunn_3 
	
	
	else ''
	    end),
-- Koulutuksen järjestäjä 2
	(case
	-- lukiokoulutuksen järjestäjä vain _3, merkitään tyhjäksi
	when l.suorlk = '1' and l.luopiskjarj_3  <> '' and l.ammopiskjarj_3 = '' and
	l.amkopiskjarj_3 = '' and l.yoopiskjarj_3 = '' then ''
	-- ammatillisen koulutuksen järjestäjä vain _3, merkitään tyhjäksi
	when l.suorlk = '1' and l.luopiskjarj_3 = '' and l.ammopiskjarj_3 <> '' and
	l.amkopiskjarj_3 ='' and l.yoopiskjarj_3 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä _3
	when l.suorlk = '1' and l.luopiskjarj_3 <> '' and l.ammopiskjarj_3 <> '' and
	l.amkopiskjarj_3 = '' and l.yoopiskjarj_3 = '' then l.ammopiskjarj_3 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi
	when l.suorlk = '1' and l.amkopiskjarj_3  <> '' and l.yoopiskjarj_3   = '' and
	l.luopiskjarj_3 = '' and l.ammopiskjarj_3 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, merkitään tyhjäksi
	when l.suorlk = '1' and l.amkopiskjarj_3  = '' and l.yoopiskjarj_3  <> '' and 
	l.luopiskjarj_3  = '' and l.ammopiskjarj_3 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestäjä merkitään yliopistokoulutuksen järjetäjä _3
	when l.suorlk = '1' and l.amkopiskjarj_3  <> '' and l.yoopiskjarj_3   <> '' and
	l.luopiskjarj_3  = '' and l.ammopiskjarj_3  = ''  then l.yoopiskjarj_3 
	

	else ''
	    end),
-- Koulutuksen maakunta 2
	(case
	-- vain lukiokoulutuksen maakunta _3, jätetään tyhjäksi
	when l.suorlk = '1' and l.luopiskmaak_3   <> '' and l.ammopiskmaak_3  = '' and
	l.amkopiskmaak_3  = '' and l.yoopiskmaak_3  = '' then ''
	-- vain ammatillisen koulutuksen maakunta _3, jätetään tyhjäksi   
	when l.suorlk = '1' and l.luopiskmaak_3  = '' and l.ammopiskmaak_3  <> '' and
	l.amkopiskmaak_3  ='' and l.yoopiskmaak_3  = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta, merkitään ammatillisen koulutuksen maakunta _3
	when l.suorlk = '1' and l.luopiskmaak_3  <> '' and l.ammopiskmaak_3  <> '' and
	l.amkopiskmaak_3  = '' and l.yoopiskmaak_3  = '' then l.ammopiskmaak_3 
	-- vain ammattikorkeakoulutuksen maakunta _3, jätetään tyhjäksi
	when l.suorlk = '1' and l.amkopiskmaak_3   <> '' and l.yoopiskmaak_3   = '' and
	l.luopiskmaak_3 = '' and l.ammopiskmaak_3 = '' then '' 
	-- vain yliopistokoulutuksen maakunta _3, merkitään tyhjäksi
	when l.suorlk = '1' and l.amkopiskmaak_3  = '' and l.yoopiskmaak_3  <> '' and 
	l.luopiskmaak_3  = '' and l.ammopiskmaak_3 = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta _3, merkitään yliopistokoulutuksen maakunta _3
	when l.suorlk = '1' and l.amkopiskmaak_3  <> '' and l.yoopiskmaak_3   <> '' and
	l.luopiskjarj_3  = '' and l.ammopiskmaak_3  = ''  then l.yoopiskmaak_3
	

	else ''
	
	    end),
	-- Monihaku
	(case
	-- _3
	when l.suorlk = '1' then l.monihaku_3		
	else '8'
	end),
    -- Pääasiallinen toiminta
    (case
    -- _3
	when l.suorlk = '1' then l.ptoim1r4_3
	else ''
	end),
	-- Ammattiasema
	(case
	-- _3
	when l.suorlk = '1' then l.amas_3
	else ''
	end),
    l.lkm,
	l.pohjkoul,
 l.tietolahde,
 'K3.13',
 -- Lukiokoulutuksessa
 (case
	    when (l.suorlk = '1' ) and  l.luopiskkoulk_3 <> '' and l.ammopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_3 = '' then '1'    
	    else '0'
	    end) as lukiokoulutuksessa,
 -- Ammatillisessa koulutuksessa 
 (case
	    when (l.suorlk = '1') and  l.ammopiskkoulk_3  <> '' and l.luopiskkoulk_3 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' then '1' 
	    else '0'
	    end) as ammatillisessa_koulutuksessa,
-- Ammattikorkeakoulutuksessa
 (case
	   when (l.suorlk = '1') and  l.amkopiskkoulk_3 <> '' and l.ammopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.luopiskkoulk_3 = '' then  '1'
	   else '0' 
	   end) as ammattikorkeakoulutuksessa,
-- Yliopistokoulutuksessa
 (case
	    when (l.suorlk = '1') and  l.yoopiskkoulk_3  <> '' and l.amkopiskkoulk_3 = '' and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' then '1'   	   
	    else '0'
	    end) as yliopistokoulutuksessa,
-- Lukiokoulutuksessa ja ammatillisessa koulutuksessa
(case
	    when (l.suorlk = '1') and  l.luopiskkoulk_3  <> '' and l.ammopiskkoulk_3 <> '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3  = '' then '1'  
	    else '0'
	    end) as lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa,
-- Toisen asteen ammatillisessa koulutuksessa ja korkeakoulutuksessa
(case
	    when (l.suorlk = '1') and  l.ammopiskkoulk_3  <> '' and l.amkopiskkoulk_3 <> '' and l.luopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' then '1'  
	    else '0'
	    end) as toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa,
-- Ammattikorkeakoulutuksessa ja yliopistokoulutuksessa
(case
	    when (l.suorlk = '1') and  l.amkopiskkoulk_3  <> '' and l.yoopiskkoulk_3 <> '' and l.ammopiskkoulk_3  = '' and l.luopiskkoulk_3 = ''  then '1' 
	    else '0'
	    end) as ammattikorkekoulutuksessa_ja_yliopistokoulutuksessa,    
-- Koulutuksen päättäneiden toiminta
(case
	   -- Tutkintoon johtavassa koulutuksessa olevat
	   when (l.suorlk = '1')  and (l.ptoim1r4_3 = '22' or l.ptoim1r4_3 = '13')
       and	(l.luopiskkoulk_3 <>'' or l.ammopiskkoulk_3 <>'' or l.amkopiskkoulk_3 <>'' or l.yoopiskkoulk_3 <>'')   then '1' 
	
	   -- Ei tutkintoon johtavassa koulutuksessa olevat
	   when (l.suorlk = '1')  and (l.ptoim1r4_3 = '22' or l.ptoim1r4_3 = '13')
       and	(l.luopiskkoulk_3 ='' and l.ammopiskkoulk_3 ='' and l.amkopiskkoulk_3 ='' and l.yoopiskkoulk_3 ='')   then '2' 
   
   
	   -- Ei opiskelevat työlliset
	   when (l.suorlk = '1')and  l.ptoim1r4_3  = '10'  then '3' 
	   -- Ei opiskelevat työttömät
	   when (l.suorlk = '1') and  l.ptoim1r4_3  = '12'  then '4' 
	   -- Ei opiskelevat muut
		else '5' 
	   end ) as koulutuksen_paattaneiden_toiminta
 ,ika_1v = cast((case 
            when syntv = '' then '-1'
            when  (cast(tilv as int) - cast(syntv as int)) > 99 then ''
            else  ((cast(tilv as int) - cast(syntv as int))) end)  as nvarchar(10))
 ,ika_5v =cast(
       (
		case
		when (cast(tilv as int) - cast(syntv as int)) < 15 then '5v10'
		when ((cast(tilv as int) - cast(syntv as int)) >= 15 and (cast(tilv as int) - cast(syntv as int)) <= 19) then '5v15'
		when ((cast(tilv as int) - cast(syntv as int)) >= 20 and (cast(tilv as int) - cast(syntv as int)) <= 24) then '5v20'
		when ((cast(tilv as int) - cast(syntv as int)) >= 25 and (cast(tilv as int) - cast(syntv as int)) <= 29) then '5v25'
		when ((cast(tilv as int) - cast(syntv as int)) >= 30 and (cast(tilv as int) - cast(syntv as int)) <= 34) then '5v30'
		when ((cast(tilv as int) - cast(syntv as int)) >= 35 and (cast(tilv as int) - cast(syntv as int)) <= 39) then '5v35'
		when ((cast(tilv as int) - cast(syntv as int)) >= 40 and (cast(tilv as int) - cast(syntv as int)) <= 44) then '5v40'
		when ((cast(tilv as int) - cast(syntv as int)) >= 45 and (cast(tilv as int) - cast(syntv as int)) <= 49) then '5v45'
		when ((cast(tilv as int) - cast(syntv as int)) >= 50 and (cast(tilv as int) - cast(syntv as int)) <= 54) then '5v50'
		when ((cast(tilv as int) - cast(syntv as int)) >= 55 and (cast(tilv as int) - cast(syntv as int)) <= 59) then '5v55'
		when ((cast(tilv as int) - cast(syntv as int)) >= 60 and (cast(tilv as int) - cast(syntv as int)) <= 64) then '5v60'
		when ((cast(tilv as int) - cast(syntv as int)) >= 65 and (cast(tilv as int) - cast(syntv as int)) <= 69) then '5v65'
		when ((cast(tilv as int) - cast(syntv as int)) >= 70 and (cast(tilv as int) - cast(syntv as int)) <= 74) then '5v70'
		when ((cast(tilv as int) - cast(syntv as int)) >= 75 and (cast(tilv as int) - cast(syntv as int)) <= 79) then '5v75'
		when ((cast(tilv as int) - cast(syntv as int)) >= 80 and (cast(tilv as int) - cast(syntv as int)) <= 84) then '5v80'
		when ((cast(tilv as int) - cast(syntv as int)) >= 85 and (cast(tilv as int) - cast(syntv as int)) <= 89) then '5v85'
		when ((cast(tilv as int) - cast(syntv as int)) >= 90 and (cast(tilv as int) - cast(syntv as int)) <= 94) then '5v90'
		when ((cast(tilv as int) - cast(syntv as int)) >= 95) then '5v95'
		
		end
	   ) as nvarchar (10))

  ,ika_1v_suorv = cast(
					(case 
						when syntv = '' then '-1' 
						else ((cast(suorv as int) - cast(syntv as int))) 
					end)  
	as nvarchar(10))




--uudet muuttujat 03/2018

----OPISKELUT KYLLÄ/EI
--Opiskellut lukiokoulutuksessa
,case
	when  l.suorlk = '1' and (l.luopiskkoulk_1 <> '' or l.luopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.luopiskkoulk2007 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk_3 <> '' or l.luopiskkoulk2007 <> '' or l.luopiskkoulk2008 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk2007 <> '' or l.luopiskkoulk2008 <> '' or l.luopiskkoulk2009 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk2008 <> '' or l.luopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '') then 1*/
	else 0
end as opisk_lu
--Opiskellut ammatillisessa peruskoulutuksessa
,case
	when  l.suorlk = '1' and (l.ammopiskkoulk_1 <> '' or l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk_3 <> '') and (d1c.Koulutusaste_taso2_koodi = '32' or d2c.Koulutusaste_taso2_koodi = '32' or d3c.Koulutusaste_taso2_koodi = '32') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk2007 <> '') and (d2c.Koulutusaste_taso2_koodi = '32' or d3c.Koulutusaste_taso2_koodi = '32' or d4c.Koulutusaste_taso2_koodi = '32') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk2007 <> '' or l.ammopiskkoulk2008 <> '') and (d3c.Koulutusaste_taso2_koodi = '32' or d4c.Koulutusaste_taso2_koodi = '32' or d5c.Koulutusaste_taso2_koodi = '32') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2007 <> '' or l.ammopiskkoulk2008 <> '' or l.ammopiskkoulk2009 <> '') and (d4c.Koulutusaste_taso2_koodi = '32' or d5c.Koulutusaste_taso2_koodi = '32' or d6c.Koulutusaste_taso2_koodi = '32') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2008 <> '' or l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '') and (d5c.Koulutusaste_taso2_koodi = '32' or d6c.Koulutusaste_taso2_koodi = '32' or d7c.Koulutusaste_taso2_koodi = '32') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '') and (d6c.Koulutusaste_taso2_koodi = '32' or d7c.Koulutusaste_taso2_koodi = '32' or d8c.Koulutusaste_taso2_koodi = '32') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '') and (d7c.Koulutusaste_taso2_koodi = '32' or d8c.Koulutusaste_taso2_koodi = '32' or d9c.Koulutusaste_taso2_koodi = '32') then 1*/
	else 0
end as opisk_amm_pk
--Opiskellut ammattitutkintokoulutuksessa
,case
	when  l.suorlk = '1' and (l.ammopiskkoulk_1 <> '' or l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk_3 <> '') and (d1c.Koulutusaste_taso2_koodi = '33' or d2c.Koulutusaste_taso2_koodi = '33' or d3c.Koulutusaste_taso2_koodi = '33') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk2007 <> '') and (d2c.Koulutusaste_taso2_koodi = '33' or d3c.Koulutusaste_taso2_koodi = '33' or d4c.Koulutusaste_taso2_koodi = '33') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk2007 <> '' or l.ammopiskkoulk2008 <> '') and (d3c.Koulutusaste_taso2_koodi = '33' or d4c.Koulutusaste_taso2_koodi = '33' or d5c.Koulutusaste_taso2_koodi = '33') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2007 <> '' or l.ammopiskkoulk2008 <> '' or l.ammopiskkoulk2009 <> '') and (d4c.Koulutusaste_taso2_koodi = '33' or d5c.Koulutusaste_taso2_koodi = '33' or d6c.Koulutusaste_taso2_koodi = '33') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2008 <> '' or l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '') and (d5c.Koulutusaste_taso2_koodi = '33' or d6c.Koulutusaste_taso2_koodi = '33' or d7c.Koulutusaste_taso2_koodi = '33') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '') and (d6c.Koulutusaste_taso2_koodi = '33' or d7c.Koulutusaste_taso2_koodi = '33' or d8c.Koulutusaste_taso2_koodi = '33') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '') and (d7c.Koulutusaste_taso2_koodi = '33' or d8c.Koulutusaste_taso2_koodi = '33' or d9c.Koulutusaste_taso2_koodi = '33') then 1*/
	else 0
end as opisk_amm_at
--Opiskellut erikoisammattitutkintokoulutuksessa
,case
	when  l.suorlk = '1' and (l.ammopiskkoulk_1 <> '' or l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk_3 <> '') and (d1c.Koulutusaste_taso2_koodi = '41' or d2c.Koulutusaste_taso2_koodi = '41' or d3c.Koulutusaste_taso2_koodi = '41') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk2007 <> '') and (d2c.Koulutusaste_taso2_koodi = '41' or d3c.Koulutusaste_taso2_koodi = '41' or d4c.Koulutusaste_taso2_koodi = '41') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk2007 <> '' or l.ammopiskkoulk2008 <> '') and (d3c.Koulutusaste_taso2_koodi = '41' or d4c.Koulutusaste_taso2_koodi = '41' or d5c.Koulutusaste_taso2_koodi = '41') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2007 <> '' or l.ammopiskkoulk2008 <> '' or l.ammopiskkoulk2009 <> '') and (d4c.Koulutusaste_taso2_koodi = '41' or d5c.Koulutusaste_taso2_koodi = '41' or d6c.Koulutusaste_taso2_koodi = '41') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2008 <> '' or l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '') and (d5c.Koulutusaste_taso2_koodi = '41' or d6c.Koulutusaste_taso2_koodi = '41' or d7c.Koulutusaste_taso2_koodi = '41') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '') and (d6c.Koulutusaste_taso2_koodi = '41' or d7c.Koulutusaste_taso2_koodi = '41' or d8c.Koulutusaste_taso2_koodi = '41') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '') and (d7c.Koulutusaste_taso2_koodi = '41' or d8c.Koulutusaste_taso2_koodi = '41' or d9c.Koulutusaste_taso2_koodi = '41') then 1*/
	else 0
end as opisk_amm_eat
--Opiskellut ammatillisessa koulutuksessa
,case
	when  l.suorlk = '1' and (l.ammopiskkoulk_1 <> '' or l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk_3 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk2007 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk2007 <> '' or l.ammopiskkoulk2008 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2007 <> '' or l.ammopiskkoulk2008 <> '' or l.ammopiskkoulk2009 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2008 <> '' or l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '') then 1*/
	else 0
end as opisk_amm
--Opiskellut ammattikorkeakoulutuksessa
,case
	when  l.suorlk = '1' and (l.amkopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.amkopiskkoulk2007 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk_3 <> '' or l.amkopiskkoulk2007 <> '' or l.amkopiskkoulk2008 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2007 <> '' or l.amkopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '') then 1*/
	else 0
end as opisk_amk
--Opiskellut yliopistokoulutuksessa
,case
	when  l.suorlk = '1' and (l.yoopiskkoulk_1 <> '' or l.yoopiskkoulk_2 <> '' or l.yoopiskkoulk_3 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.yoopiskkoulk_2 <> '' or l.yoopiskkoulk_3 <> '' or l.yoopiskkoulk2007 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.yoopiskkoulk_3 <> '' or l.yoopiskkoulk2007 <> '' or l.yoopiskkoulk2008 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.yoopiskkoulk2007 <> '' or l.yoopiskkoulk2008 <> '' or l.yoopiskkoulk2009 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.yoopiskkoulk2008 <> '' or l.yoopiskkoulk2009 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.yoopiskkoulk2009 <> '' or l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '' or l.yoopiskkoulk2012 <> '') then 1*/
	else 0
end as opisk_yo



----KOULUTUSALA, TASO 1 KYLLÄ/EI
--Opiskellut koulutusala1 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1a.iscfibroad2013_koodi = '01' or d2a.iscfibroad2013_koodi = '01' or d3a.iscfibroad2013_koodi = '01') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2a.iscfibroad2013_koodi = '01' or d3a.iscfibroad2013_koodi = '01' or d4a.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3a.iscfibroad2013_koodi = '01' or d4a.iscfibroad2013_koodi = '01' or d5a.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4a.iscfibroad2013_koodi = '01' or d5a.iscfibroad2013_koodi = '01' or d6a.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5a.iscfibroad2013_koodi = '01' or d6a.iscfibroad2013_koodi = '01' or d7a.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6a.iscfibroad2013_koodi = '01' or d7a.iscfibroad2013_koodi = '01' or d8a.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7a.iscfibroad2013_koodi = '01' or d8a.iscfibroad2013_koodi = '01' or d9a.iscfibroad2013_koodi = '01') then 1*/
	else 0
end as opisk_amk_koulala1
--Opiskellut koulutusala2 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1a.iscfibroad2013_koodi = '02' or d2a.iscfibroad2013_koodi = '02' or d3a.iscfibroad2013_koodi = '02') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2a.iscfibroad2013_koodi = '02' or d3a.iscfibroad2013_koodi = '02' or d4a.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3a.iscfibroad2013_koodi = '02' or d4a.iscfibroad2013_koodi = '02' or d5a.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4a.iscfibroad2013_koodi = '02' or d5a.iscfibroad2013_koodi = '02' or d6a.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5a.iscfibroad2013_koodi = '02' or d6a.iscfibroad2013_koodi = '02' or d7a.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6a.iscfibroad2013_koodi = '02' or d7a.iscfibroad2013_koodi = '02' or d8a.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7a.iscfibroad2013_koodi = '02' or d8a.iscfibroad2013_koodi = '02' or d9a.iscfibroad2013_koodi = '02') then 1*/
	else 0
end as opisk_amk_koulala2
--Opiskellut koulutusala3 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1a.iscfibroad2013_koodi = '03' or d2a.iscfibroad2013_koodi = '03' or d3a.iscfibroad2013_koodi = '03') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2a.iscfibroad2013_koodi = '03' or d3a.iscfibroad2013_koodi = '03' or d4a.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3a.iscfibroad2013_koodi = '03' or d4a.iscfibroad2013_koodi = '03' or d5a.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4a.iscfibroad2013_koodi = '03' or d5a.iscfibroad2013_koodi = '03' or d6a.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5a.iscfibroad2013_koodi = '03' or d6a.iscfibroad2013_koodi = '03' or d7a.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6a.iscfibroad2013_koodi = '03' or d7a.iscfibroad2013_koodi = '03' or d8a.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7a.iscfibroad2013_koodi = '03' or d8a.iscfibroad2013_koodi = '03' or d9a.iscfibroad2013_koodi = '03') then 1*/
	else 0
end as opisk_amk_koulala3
--Opiskellut koulutusala4 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1a.iscfibroad2013_koodi = '04' or d2a.iscfibroad2013_koodi = '04' or d3a.iscfibroad2013_koodi = '04') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2a.iscfibroad2013_koodi = '04' or d3a.iscfibroad2013_koodi = '04' or d4a.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3a.iscfibroad2013_koodi = '04' or d4a.iscfibroad2013_koodi = '04' or d5a.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4a.iscfibroad2013_koodi = '04' or d5a.iscfibroad2013_koodi = '04' or d6a.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5a.iscfibroad2013_koodi = '04' or d6a.iscfibroad2013_koodi = '04' or d7a.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6a.iscfibroad2013_koodi = '04' or d7a.iscfibroad2013_koodi = '04' or d8a.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7a.iscfibroad2013_koodi = '04' or d8a.iscfibroad2013_koodi = '04' or d9a.iscfibroad2013_koodi = '04') then 1*/
	else 0
end as opisk_amk_koulala4
--Opiskellut koulutusala5 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1a.iscfibroad2013_koodi = '05' or d2a.iscfibroad2013_koodi = '05' or d3a.iscfibroad2013_koodi = '05') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2a.iscfibroad2013_koodi = '05' or d3a.iscfibroad2013_koodi = '05' or d4a.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3a.iscfibroad2013_koodi = '05' or d4a.iscfibroad2013_koodi = '05' or d5a.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4a.iscfibroad2013_koodi = '05' or d5a.iscfibroad2013_koodi = '05' or d6a.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5a.iscfibroad2013_koodi = '05' or d6a.iscfibroad2013_koodi = '05' or d7a.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6a.iscfibroad2013_koodi = '05' or d7a.iscfibroad2013_koodi = '05' or d8a.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7a.iscfibroad2013_koodi = '05' or d8a.iscfibroad2013_koodi = '05' or d9a.iscfibroad2013_koodi = '05') then 1*/
	else 0
end as opisk_amk_koulala5
--Opiskellut koulutusala6 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1a.iscfibroad2013_koodi = '06' or d2a.iscfibroad2013_koodi = '06' or d3a.iscfibroad2013_koodi = '06') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2a.iscfibroad2013_koodi = '06' or d3a.iscfibroad2013_koodi = '06' or d4a.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3a.iscfibroad2013_koodi = '06' or d4a.iscfibroad2013_koodi = '06' or d5a.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4a.iscfibroad2013_koodi = '06' or d5a.iscfibroad2013_koodi = '06' or d6a.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5a.iscfibroad2013_koodi = '06' or d6a.iscfibroad2013_koodi = '06' or d7a.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6a.iscfibroad2013_koodi = '06' or d7a.iscfibroad2013_koodi = '06' or d8a.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7a.iscfibroad2013_koodi = '06' or d8a.iscfibroad2013_koodi = '06' or d9a.iscfibroad2013_koodi = '06') then 1*/
	else 0
end as opisk_amk_koulala6
--Opiskellut koulutusala7 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1a.iscfibroad2013_koodi = '07' or d2a.iscfibroad2013_koodi = '07' or d3a.iscfibroad2013_koodi = '07') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2a.iscfibroad2013_koodi = '07' or d3a.iscfibroad2013_koodi = '07' or d4a.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3a.iscfibroad2013_koodi = '07' or d4a.iscfibroad2013_koodi = '07' or d5a.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4a.iscfibroad2013_koodi = '07' or d5a.iscfibroad2013_koodi = '07' or d6a.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5a.iscfibroad2013_koodi = '07' or d6a.iscfibroad2013_koodi = '07' or d7a.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6a.iscfibroad2013_koodi = '07' or d7a.iscfibroad2013_koodi = '07' or d8a.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7a.iscfibroad2013_koodi = '07' or d8a.iscfibroad2013_koodi = '07' or d9a.iscfibroad2013_koodi = '07') then 1*/
	else 0
end as opisk_amk_koulala7
--Opiskellut koulutusala8 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1a.iscfibroad2013_koodi = '08' or d2a.iscfibroad2013_koodi = '08' or d3a.iscfibroad2013_koodi = '08') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2a.iscfibroad2013_koodi = '08' or d3a.iscfibroad2013_koodi = '08' or d4a.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3a.iscfibroad2013_koodi = '08' or d4a.iscfibroad2013_koodi = '08' or d5a.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4a.iscfibroad2013_koodi = '08' or d5a.iscfibroad2013_koodi = '08' or d6a.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5a.iscfibroad2013_koodi = '08' or d6a.iscfibroad2013_koodi = '08' or d7a.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6a.iscfibroad2013_koodi = '08' or d7a.iscfibroad2013_koodi = '08' or d8a.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7a.iscfibroad2013_koodi = '08' or d8a.iscfibroad2013_koodi = '08' or d9a.iscfibroad2013_koodi = '08') then 1*/
	else 0
end as opisk_amk_koulala8
--Opiskellut koulutusala9 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1a.iscfibroad2013_koodi = '09' or d2a.iscfibroad2013_koodi = '09' or d3a.iscfibroad2013_koodi = '09') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2a.iscfibroad2013_koodi = '09' or d3a.iscfibroad2013_koodi = '09' or d4a.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3a.iscfibroad2013_koodi = '09' or d4a.iscfibroad2013_koodi = '09' or d5a.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4a.iscfibroad2013_koodi = '09' or d5a.iscfibroad2013_koodi = '09' or d6a.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5a.iscfibroad2013_koodi = '09' or d6a.iscfibroad2013_koodi = '09' or d7a.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6a.iscfibroad2013_koodi = '09' or d7a.iscfibroad2013_koodi = '09' or d8a.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7a.iscfibroad2013_koodi = '09' or d8a.iscfibroad2013_koodi = '09' or d9a.iscfibroad2013_koodi = '09') then 1*/
	else 0
end as opisk_amk_koulala9
--Opiskellut koulutusala10 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1a.iscfibroad2013_koodi = '10' or d2a.iscfibroad2013_koodi = '10' or d3a.iscfibroad2013_koodi = '10') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2a.iscfibroad2013_koodi = '10' or d3a.iscfibroad2013_koodi = '10' or d4a.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3a.iscfibroad2013_koodi = '10' or d4a.iscfibroad2013_koodi = '10' or d5a.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4a.iscfibroad2013_koodi = '10' or d5a.iscfibroad2013_koodi = '10' or d6a.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5a.iscfibroad2013_koodi = '10' or d6a.iscfibroad2013_koodi = '10' or d7a.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6a.iscfibroad2013_koodi = '10' or d7a.iscfibroad2013_koodi = '10' or d8a.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7a.iscfibroad2013_koodi = '10' or d8a.iscfibroad2013_koodi = '10' or d9a.iscfibroad2013_koodi = '10') then 1*/
	else 0
end as opisk_amk_koulala10




--Opiskellut koulutusala1 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1b.iscfibroad2013_koodi = '01' or d2b.iscfibroad2013_koodi = '01' or d3b.iscfibroad2013_koodi = '01') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2b.iscfibroad2013_koodi = '01' or d3b.iscfibroad2013_koodi = '01' or d4b.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3b.iscfibroad2013_koodi = '01' or d4b.iscfibroad2013_koodi = '01' or d5b.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4b.iscfibroad2013_koodi = '01' or d5b.iscfibroad2013_koodi = '01' or d6b.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5b.iscfibroad2013_koodi = '01' or d6b.iscfibroad2013_koodi = '01' or d7b.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6b.iscfibroad2013_koodi = '01' or d7b.iscfibroad2013_koodi = '01' or d8b.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7b.iscfibroad2013_koodi = '01' or d8b.iscfibroad2013_koodi = '01' or d9b.iscfibroad2013_koodi = '01') then 1*/
	else 0
end as opisk_yo_koulala1
--Opiskellut koulutusala2 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1b.iscfibroad2013_koodi = '02' or d2b.iscfibroad2013_koodi = '02' or d3b.iscfibroad2013_koodi = '02') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2b.iscfibroad2013_koodi = '02' or d3b.iscfibroad2013_koodi = '02' or d4b.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3b.iscfibroad2013_koodi = '02' or d4b.iscfibroad2013_koodi = '02' or d5b.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4b.iscfibroad2013_koodi = '02' or d5b.iscfibroad2013_koodi = '02' or d6b.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5b.iscfibroad2013_koodi = '02' or d6b.iscfibroad2013_koodi = '02' or d7b.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6b.iscfibroad2013_koodi = '02' or d7b.iscfibroad2013_koodi = '02' or d8b.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7b.iscfibroad2013_koodi = '02' or d8b.iscfibroad2013_koodi = '02' or d9b.iscfibroad2013_koodi = '02') then 1*/
	else 0
end as opisk_yo_koulala2
--Opiskellut koulutusala3 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1b.iscfibroad2013_koodi = '03' or d2b.iscfibroad2013_koodi = '03' or d3b.iscfibroad2013_koodi = '03') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2b.iscfibroad2013_koodi = '03' or d3b.iscfibroad2013_koodi = '03' or d4b.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3b.iscfibroad2013_koodi = '03' or d4b.iscfibroad2013_koodi = '03' or d5b.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4b.iscfibroad2013_koodi = '03' or d5b.iscfibroad2013_koodi = '03' or d6b.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5b.iscfibroad2013_koodi = '03' or d6b.iscfibroad2013_koodi = '03' or d7b.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6b.iscfibroad2013_koodi = '03' or d7b.iscfibroad2013_koodi = '03' or d8b.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7b.iscfibroad2013_koodi = '03' or d8b.iscfibroad2013_koodi = '03' or d9b.iscfibroad2013_koodi = '03') then 1*/
	else 0
end as opisk_yo_koulala3
--Opiskellut koulutusala4 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1b.iscfibroad2013_koodi = '04' or d2b.iscfibroad2013_koodi = '04' or d3b.iscfibroad2013_koodi = '04') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2b.iscfibroad2013_koodi = '04' or d3b.iscfibroad2013_koodi = '04' or d4b.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3b.iscfibroad2013_koodi = '04' or d4b.iscfibroad2013_koodi = '04' or d5b.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4b.iscfibroad2013_koodi = '04' or d5b.iscfibroad2013_koodi = '04' or d6b.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5b.iscfibroad2013_koodi = '04' or d6b.iscfibroad2013_koodi = '04' or d7b.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6b.iscfibroad2013_koodi = '04' or d7b.iscfibroad2013_koodi = '04' or d8b.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7b.iscfibroad2013_koodi = '04' or d8b.iscfibroad2013_koodi = '04' or d9b.iscfibroad2013_koodi = '04') then 1*/
	else 0
end as opisk_yo_koulala4
--Opiskellut koulutusala5 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1b.iscfibroad2013_koodi = '05' or d2b.iscfibroad2013_koodi = '05' or d3b.iscfibroad2013_koodi = '05') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2b.iscfibroad2013_koodi = '05' or d3b.iscfibroad2013_koodi = '05' or d4b.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3b.iscfibroad2013_koodi = '05' or d4b.iscfibroad2013_koodi = '05' or d5b.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4b.iscfibroad2013_koodi = '05' or d5b.iscfibroad2013_koodi = '05' or d6b.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5b.iscfibroad2013_koodi = '05' or d6b.iscfibroad2013_koodi = '05' or d7b.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6b.iscfibroad2013_koodi = '05' or d7b.iscfibroad2013_koodi = '05' or d8b.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7b.iscfibroad2013_koodi = '05' or d8b.iscfibroad2013_koodi = '05' or d9b.iscfibroad2013_koodi = '05') then 1*/
	else 0
end as opisk_yo_koulala5
--Opiskellut koulutusala6 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1b.iscfibroad2013_koodi = '06' or d2b.iscfibroad2013_koodi = '06' or d3b.iscfibroad2013_koodi = '06') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2b.iscfibroad2013_koodi = '06' or d3b.iscfibroad2013_koodi = '06' or d4b.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3b.iscfibroad2013_koodi = '06' or d4b.iscfibroad2013_koodi = '06' or d5b.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4b.iscfibroad2013_koodi = '06' or d5b.iscfibroad2013_koodi = '06' or d6b.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5b.iscfibroad2013_koodi = '06' or d6b.iscfibroad2013_koodi = '06' or d7b.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6b.iscfibroad2013_koodi = '06' or d7b.iscfibroad2013_koodi = '06' or d8b.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7b.iscfibroad2013_koodi = '06' or d8b.iscfibroad2013_koodi = '06' or d9b.iscfibroad2013_koodi = '06') then 1*/
	else 0
end as opisk_yo_koulala6
--Opiskellut koulutusala7 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1b.iscfibroad2013_koodi = '07' or d2b.iscfibroad2013_koodi = '07' or d3b.iscfibroad2013_koodi = '07') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2b.iscfibroad2013_koodi = '07' or d3b.iscfibroad2013_koodi = '07' or d4b.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3b.iscfibroad2013_koodi = '07' or d4b.iscfibroad2013_koodi = '07' or d5b.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4b.iscfibroad2013_koodi = '07' or d5b.iscfibroad2013_koodi = '07' or d6b.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5b.iscfibroad2013_koodi = '07' or d6b.iscfibroad2013_koodi = '07' or d7b.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6b.iscfibroad2013_koodi = '07' or d7b.iscfibroad2013_koodi = '07' or d8b.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7b.iscfibroad2013_koodi = '07' or d8b.iscfibroad2013_koodi = '07' or d9b.iscfibroad2013_koodi = '07') then 1*/
	else 0
end as opisk_yo_koulala7
--Opiskellut koulutusala8 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1b.iscfibroad2013_koodi = '08' or d2b.iscfibroad2013_koodi = '08' or d3b.iscfibroad2013_koodi = '08') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2b.iscfibroad2013_koodi = '08' or d3b.iscfibroad2013_koodi = '08' or d4b.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3b.iscfibroad2013_koodi = '08' or d4b.iscfibroad2013_koodi = '08' or d5b.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4b.iscfibroad2013_koodi = '08' or d5b.iscfibroad2013_koodi = '08' or d6b.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5b.iscfibroad2013_koodi = '08' or d6b.iscfibroad2013_koodi = '08' or d7b.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6b.iscfibroad2013_koodi = '08' or d7b.iscfibroad2013_koodi = '08' or d8b.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7b.iscfibroad2013_koodi = '08' or d8b.iscfibroad2013_koodi = '08' or d9b.iscfibroad2013_koodi = '08') then 1*/
	else 0
end as opisk_yo_koulala8
--Opiskellut koulutusala9 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1b.iscfibroad2013_koodi = '09' or d2b.iscfibroad2013_koodi = '09' or d3b.iscfibroad2013_koodi = '09') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2b.iscfibroad2013_koodi = '09' or d3b.iscfibroad2013_koodi = '09' or d4b.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3b.iscfibroad2013_koodi = '09' or d4b.iscfibroad2013_koodi = '09' or d5b.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4b.iscfibroad2013_koodi = '09' or d5b.iscfibroad2013_koodi = '09' or d6b.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5b.iscfibroad2013_koodi = '09' or d6b.iscfibroad2013_koodi = '09' or d7b.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6b.iscfibroad2013_koodi = '09' or d7b.iscfibroad2013_koodi = '09' or d8b.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7b.iscfibroad2013_koodi = '09' or d8b.iscfibroad2013_koodi = '09' or d9b.iscfibroad2013_koodi = '09') then 1*/
	else 0
end as opisk_yo_koulala9
--Opiskellut koulutusala10 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1b.iscfibroad2013_koodi = '10' or d2b.iscfibroad2013_koodi = '10' or d3b.iscfibroad2013_koodi = '10') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2b.iscfibroad2013_koodi = '10' or d3b.iscfibroad2013_koodi = '10' or d4b.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3b.iscfibroad2013_koodi = '10' or d4b.iscfibroad2013_koodi = '10' or d5b.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4b.iscfibroad2013_koodi = '10' or d5b.iscfibroad2013_koodi = '10' or d6b.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5b.iscfibroad2013_koodi = '10' or d6b.iscfibroad2013_koodi = '10' or d7b.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6b.iscfibroad2013_koodi = '10' or d7b.iscfibroad2013_koodi = '10' or d8b.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7b.iscfibroad2013_koodi = '10' or d8b.iscfibroad2013_koodi = '10' or d9b.iscfibroad2013_koodi = '10') then 1*/
	else 0
end as opisk_yo_koulala10


--Opiskellut useampaa kuin yhtä alaa (taso 1) (kyllä/ei)
,case --ensimmäisenä vuotena on mahdollista olla vain yksi ala
	when  l.suorlk = '1' and m1.MinValue <> m1.MaxValue then 1 
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and m2.MinValue <> m2.MaxValue then 1 
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and m3.MinValue <> m3.MaxValue then 1 
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and m4.MinValue <> m4.MaxValue then 1 
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and m5.MinValue <> m5.MaxValue then 1 
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and m6.MinValue <> m6.MaxValue then 1 
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and m7.MinValue <> m7.MaxValue then 1 */
	else 0
end as opisk_vah2_koulala


----HAUT KYLLÄ/EI
--Hakenut ammatilliseen koulutukseen
,case
	when  l.suorlk = '1' and (l.monihaku_1 in (2,3,5) or l.monihaku_2 in (2,3,5) or l.monihaku_3 in (2,3,5)) then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.monihaku_2 in (2,3,5) or l.monihaku_3 in (2,3,5) or l.monihaku2007 in (2,3,5)) then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.monihaku_3 in (2,3,5) or l.monihaku2007 in (2,3,5) or l.monihaku2008 in (2,3,5)) then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.monihaku2007 in (2,3,5) or l.monihaku2008 in (2,3,5) or l.monihaku2009 in (2,3,5)) then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.monihaku2008 in (2,3,5) or l.monihaku2009 in (2,3,5) or l.monihaku2010 in (2,3,5)) then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.monihaku2009 in (2,3,5) or l.monihaku2010 in (2,3,5) or l.monihaku2011 in (2,3,5)) then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.monihaku2010 in (2,3,5) or l.monihaku2011 in (2,3,5) or l.monihaku2012 in (2,3,5)) then 1*/
	else 0
end as haku_amm
--Hakenut ammattikorkeakoulutukseen
,case
	when  l.suorlk = '1' and (l.monihaku_1 in (4,6) or l.monihaku_2 in (4,6) or l.monihaku_3 in (4,6)) then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.monihaku_2 in (4,6) or l.monihaku_3 in (4,6) or l.monihaku2007 in (4,6)) then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.monihaku_3 in (4,6) or l.monihaku2007 in (4,6) or l.monihaku2008 in (4,6)) then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.monihaku2007 in (4,6) or l.monihaku2008 in (4,6) or l.monihaku2009 in (4,6)) then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.monihaku2008 in (4,6) or l.monihaku2009 in (4,6) or l.monihaku2010 in (4,6)) then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.monihaku2009 in (4,6) or l.monihaku2010 in (4,6) or l.monihaku2011 in (4,6)) then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.monihaku2010 in (4,6) or l.monihaku2011 in (4,6) or l.monihaku2012 in (4,6)) then 1*/
	else 0
end as haku_amk
--Hakenut yliopistokoulutukseen
,case
	when  l.suorlk = '1' and (l.monihaku_1 in (6,7) or l.monihaku_2 in (6,7) or l.monihaku_3 in (6,7)) then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.monihaku_2 in (6,7) or l.monihaku_3 in (6,7) or l.monihaku2007 in (6,7)) then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.monihaku_3 in (6,7) or l.monihaku2007 in (6,7) or l.monihaku2008 in (6,7)) then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.monihaku2007 in (6,7) or l.monihaku2008 in (6,7) or l.monihaku2009 in (6,7)) then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.monihaku2008 in (6,7) or l.monihaku2009 in (6,7) or l.monihaku2010 in (6,7)) then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.monihaku2009 in (6,7) or l.monihaku2010 in (6,7) or l.monihaku2011 in (6,7)) then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.monihaku2010 in (6,7) or l.monihaku2011 in (6,7) or l.monihaku2012 in (6,7)) then 1*/
	else 0
end as haku_yo




----MITTARIT
--Ei hakenut eikä opiskellut mitään
,case
	when  l.suorlk = '1' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and l.luopiskkoulk_1 = '' and l.ammopiskkoulk_1 = '' and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku2007 not in (4,5,6,7) and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and monihaku_3 not in (4,5,6,7) and monihaku2007 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and monihaku2007 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1*/
	else 0
end eihaku_kk_eiopisk

--Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa
,case 
	when  l.suorlk = '1' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and (l.luopiskkoulk_1 <> '' or l.ammopiskkoulk_1 <> '' or l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku2007 not in (4,5,6,7) and (l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '' or l.luopiskkoulk2007 <> '' or l.ammopiskkoulk2007 <> '') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and monihaku_3 not in (4,5,6,7) and monihaku2007 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and (l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '' or l.luopiskkoulk2007 <> '' or l.ammopiskkoulk2007 <> '' or l.luopiskkoulk2008 <> '' or l.ammopiskkoulk2008 <> '') and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and monihaku2007 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and (l.luopiskkoulk2007 <> '' or l.ammopiskkoulk2007 <> '' or l.luopiskkoulk2008 <> '' or l.ammopiskkoulk2008 <> '' or l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '') and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and (l.luopiskkoulk2008 <> '' or l.ammopiskkoulk2008 <> '' or l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '') and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and (l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '') and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and (l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1*/
	else 0
end eihaku_kk_eiopisk_kk_opisk_ta

----Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa, opiskellut lukiokoulutuksessa
,case 
	when  l.suorlk = '1' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and (l.luopiskkoulk_1 <> '' or l.luopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku2007 not in (4,5,6,7) and (l.luopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.luopiskkoulk2007 <> '') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and monihaku_3 not in (4,5,6,7) and monihaku2007 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and (l.luopiskkoulk_3 <> '' or l.luopiskkoulk2007 <> '' or l.luopiskkoulk2008 <> '') and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and monihaku2007 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and (l.luopiskkoulk2007 <> '' or l.luopiskkoulk2008 <> '' or l.luopiskkoulk2009 <> '') and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and (l.luopiskkoulk2008 <> '' or l.luopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '') and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and (l.luopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '') and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and (l.luopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1*/
	else 0
end eihaku_kk_eiopisk_kk_opisk_lu

----Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa, opiskellut ammatillisessa peruskoulutuksessa
,case 
	when  l.suorlk = '1' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and (d1c.Koulutusaste_taso2_koodi = '32' or d2c.Koulutusaste_taso2_koodi = '32' or d3c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku2007 not in (4,5,6,7) and (d2c.Koulutusaste_taso2_koodi = '32' or d3c.Koulutusaste_taso2_koodi = '32' or d4c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and monihaku_3 not in (4,5,6,7) and monihaku2007 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and (d3c.Koulutusaste_taso2_koodi = '32' or d4c.Koulutusaste_taso2_koodi = '32' or d5c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and monihaku2007 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and (d4c.Koulutusaste_taso2_koodi = '32' or d5c.Koulutusaste_taso2_koodi = '32' or d6c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and (d5c.Koulutusaste_taso2_koodi = '32' or d6c.Koulutusaste_taso2_koodi = '32' or d7c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and (d6c.Koulutusaste_taso2_koodi = '32' or d7c.Koulutusaste_taso2_koodi = '32' or d8c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and (d7c.Koulutusaste_taso2_koodi = '32' or d8c.Koulutusaste_taso2_koodi = '32' or d9c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1*/
	else 0
end eihaku_kk_eiopisk_kk_opisk_pk

------Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa, opiskellut ammattitutkintokoulutuksessa
,case 
	when  l.suorlk = '1' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and (d1c.Koulutusaste_taso2_koodi = '33' or d2c.Koulutusaste_taso2_koodi = '33' or d3c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku2007 not in (4,5,6,7) and (d2c.Koulutusaste_taso2_koodi = '33' or d3c.Koulutusaste_taso2_koodi = '33' or d4c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and monihaku_3 not in (4,5,6,7) and monihaku2007 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and (d3c.Koulutusaste_taso2_koodi = '33' or d4c.Koulutusaste_taso2_koodi = '33' or d5c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and monihaku2007 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and (d4c.Koulutusaste_taso2_koodi = '33' or d5c.Koulutusaste_taso2_koodi = '33' or d6c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and (d5c.Koulutusaste_taso2_koodi = '33' or d6c.Koulutusaste_taso2_koodi = '33' or d7c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and (d6c.Koulutusaste_taso2_koodi = '33' or d7c.Koulutusaste_taso2_koodi = '33' or d8c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and (d7c.Koulutusaste_taso2_koodi = '33' or d8c.Koulutusaste_taso2_koodi = '33' or d9c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1*/
	else 0
end eihaku_kk_eiopisk_kk_opisk_at

------Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa, opiskellut erikoisammattitutkintokoulutuksessa
,case 
	when  l.suorlk = '1' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and (d1c.Koulutusaste_taso2_koodi = '41' or d2c.Koulutusaste_taso2_koodi = '41' or d3c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku2007 not in (4,5,6,7) and (d2c.Koulutusaste_taso2_koodi = '41' or d3c.Koulutusaste_taso2_koodi = '41' or d4c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and monihaku_3 not in (4,5,6,7) and monihaku2007 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and (d3c.Koulutusaste_taso2_koodi = '41' or d4c.Koulutusaste_taso2_koodi = '41' or d5c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and monihaku2007 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and (d4c.Koulutusaste_taso2_koodi = '41' or d5c.Koulutusaste_taso2_koodi = '41' or d6c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and (d5c.Koulutusaste_taso2_koodi = '41' or d6c.Koulutusaste_taso2_koodi = '41' or d7c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and (d6c.Koulutusaste_taso2_koodi = '41' or d7c.Koulutusaste_taso2_koodi = '41' or d8c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and (d7c.Koulutusaste_taso2_koodi = '41' or d8c.Koulutusaste_taso2_koodi = '41' or d9c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1*/
	else 0
end eihaku_kk_eiopisk_kk_opisk_eat

--Hakenut korkea-asteelle, ei opiskellut korkea-asteella
,case 
	when  l.suorlk = '1' and (monihaku_1 in (4,5,6,7) or monihaku_2 in (4,5,6,7) or monihaku_3 in (4,5,6,7)) and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (monihaku_2 in (4,5,6,7) or monihaku_3 in (4,5,6,7) or monihaku2007 in (4,5,6,7)) and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (monihaku_3 in (4,5,6,7) or monihaku2007 in (4,5,6,7) or monihaku2008 in (4,5,6,7)) and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (monihaku2007 in (4,5,6,7) or monihaku2008 in (4,5,6,7) or monihaku2009 in (4,5,6,7)) and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (monihaku2008 in (4,5,6,7) or monihaku2009 in (4,5,6,7) or monihaku2010 in (4,5,6,7)) and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (monihaku2009 in (4,5,6,7) or monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7)) and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7) or monihaku2012 in (4,5,6,7)) and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1*/
	else 0
end haku_kk_eiopisk_kk
----Hakenut korkea-asteelle, ei opiskellut korkea-asteella, ei-opiskellut toisen asteen koulutuksessa
,case
	when  l.suorlk = '1' and (monihaku_1 in (4,5,6,7) or monihaku_2 in (4,5,6,7) or monihaku_3 in (4,5,6,7)) and l.luopiskkoulk_1 = '' and l.ammopiskkoulk_1 = '' and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (monihaku_2 in (4,5,6,7) or monihaku_3 in (4,5,6,7) or monihaku2007 in (4,5,6,7)) and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (monihaku_3 in (4,5,6,7) or monihaku2007 in (4,5,6,7) or monihaku2008 in (4,5,6,7)) and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (monihaku2007 in (4,5,6,7) or monihaku2008 in (4,5,6,7) or monihaku2009 in (4,5,6,7)) and l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (monihaku2008 in (4,5,6,7) or monihaku2009 in (4,5,6,7) or monihaku2010 in (4,5,6,7)) and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (monihaku2009 in (4,5,6,7) or monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7)) and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7) or monihaku2012 in (4,5,6,7)) and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1*/
	else 0
end haku_kk_eiopisk_kk_eiopisk_ta
----Hakenut korkea-asteelle, ei opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa
,case
	when  l.suorlk = '1' and (monihaku_1 in (4,5,6,7) or monihaku_2 in (4,5,6,7) or monihaku_3 in (4,5,6,7)) and (l.luopiskkoulk_1 <> '' or l.ammopiskkoulk_1 <> '' or l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (monihaku_2 in (4,5,6,7) or monihaku_3 in (4,5,6,7) or monihaku2007 in (4,5,6,7)) and (l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '' or l.luopiskkoulk2007 <> '' or l.ammopiskkoulk2007 <> '') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (monihaku_3 in (4,5,6,7) or monihaku2007 in (4,5,6,7) or monihaku2008 in (4,5,6,7)) and (l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '' or l.luopiskkoulk2007 <> '' or l.ammopiskkoulk2007 <> '' or l.luopiskkoulk2008 <> '' or l.ammopiskkoulk2008 <> '') and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (monihaku2007 in (4,5,6,7) or monihaku2008 in (4,5,6,7) or monihaku2009 in (4,5,6,7)) and (l.luopiskkoulk2007 <> '' or l.ammopiskkoulk2007 <> '' or l.luopiskkoulk2008 <> '' or l.ammopiskkoulk2008 <> '' or l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '') and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (monihaku2008 in (4,5,6,7) or monihaku2009 in (4,5,6,7) or monihaku2010 in (4,5,6,7)) and (l.luopiskkoulk2008 <> '' or l.ammopiskkoulk2008 <> '' or l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '') and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (monihaku2009 in (4,5,6,7) or monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7)) and (l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '') and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7) or monihaku2012 in (4,5,6,7)) and (l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1*/
	else 0
end haku_kk_eiopisk_kk_opisk_ta
----Hakenut vain ammattikorkeakouluun, ei opiskellut korkea-asteella
,case
	when  l.suorlk = '1' and (monihaku_1 = 4 or monihaku_2 = 4 or monihaku_3 = 4) and (monihaku_1 not in (5,6,7) and monihaku_2 not in (5,6,7) and monihaku_3 not in (5,6,7)) and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (monihaku_2 = 4 or monihaku_3 = 4 or monihaku2007 = 4) and (monihaku_2 not in (5,6,7) and monihaku_3 not in (5,6,7) and monihaku2007 not in (5,6,7)) and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (monihaku_3 = 4 or monihaku2007 = 4 or monihaku2008 = 4) and (monihaku_3 not in (5,6,7) and monihaku2007 not in (5,6,7) and monihaku2008 not in (5,6,7)) and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (monihaku2007 = 4 or monihaku2008 = 4 or monihaku2009 = 4) and (monihaku2007 not in (5,6,7) and monihaku2008 not in (5,6,7) and monihaku2009 not in (5,6,7)) and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (monihaku2008 = 4 or monihaku2009 = 4 or monihaku2010 = 4) and (monihaku2008 not in (5,6,7) and monihaku2009 not in (5,6,7) and monihaku2010 not in (5,6,7)) and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (monihaku2009 = 4 or monihaku2010 = 4 or monihaku2011 = 4) and (monihaku2009 not in (5,6,7) and monihaku2010 not in (5,6,7) and monihaku2011 not in (5,6,7)) and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (monihaku2010 = 4 or monihaku2011 = 4 or monihaku2012 = 4) and (monihaku2010 not in (5,6,7) and monihaku2011 not in (5,6,7) and monihaku2012 not in (5,6,7)) and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1*/
	else 0
end haku_amk_eiopisk_kk
----Hakenut vain yliopistokoulutukseen, ei opiskellut korkea-asteella
,case
	when  l.suorlk = '1' and (monihaku_1 = 7 or monihaku_2 = 7 or monihaku_3 = 7) and (monihaku_1 not in (4,5,6) and monihaku_2 not in (4,5,6) and monihaku_3 not in (4,5,6)) and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (monihaku_2 = 7 or monihaku_3 = 7 or monihaku2007 = 7) and (monihaku_2 not in (4,5,6) and monihaku_3 not in (4,5,6) and monihaku2007 not in (4,5,6)) and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (monihaku_3 = 7 or monihaku2007 = 7 or monihaku2008 = 7) and (monihaku_3 not in (4,5,6) and monihaku2007 not in (4,5,6) and monihaku2008 not in (4,5,6)) and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (monihaku2007 = 7 or monihaku2008 = 7 or monihaku2009 = 7) and (monihaku2007 not in (4,5,6) and monihaku2008 not in (4,5,6) and monihaku2009 not in (4,5,6)) and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (monihaku2008 = 7 or monihaku2009 = 7 or monihaku2010 = 7) and (monihaku2008 not in (4,5,6) and monihaku2009 not in (4,5,6) and monihaku2010 not in (4,5,6)) and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (monihaku2009 = 7 or monihaku2010 = 7 or monihaku2011 = 7) and (monihaku2009 not in (4,5,6) and monihaku2010 not in (4,5,6) and monihaku2011 not in (4,5,6)) and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (monihaku2010 = 7 or monihaku2011 = 7 or monihaku2012 = 7) and (monihaku2010 not in (4,5,6) and monihaku2011 not in (4,5,6) and monihaku2012 not in (4,5,6)) and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1*/
	else 0
end haku_yo_eiopisk_kk
----Hakenut sekä amk- että yliopistokoulutukseen, ei opiskellut korkea-asteella
,case
	when  l.suorlk = '1' and (monihaku_1 = 6 or monihaku_2 = 6 or monihaku_3 = 6 or ((monihaku_1 = 4 or monihaku_2 = 4 or monihaku_3 = 4) and (monihaku_1 = 7 or monihaku_2 = 7 or monihaku_3 = 7))) and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (monihaku_2 = 6 or monihaku_3 = 6 or monihaku2007 = 6 or ((monihaku_2 = 4 or monihaku_3 = 4 or monihaku2007 = 4) and (monihaku_2 = 7 or monihaku_3 = 7 or monihaku2007 = 7))) and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (monihaku_3 = 6 or monihaku2007 = 6 or monihaku2008 = 6 or ((monihaku_3 = 4 or monihaku2007 = 4 or monihaku2008 = 4) and (monihaku_3 = 7 or monihaku2007 = 7 or monihaku2008 = 7))) and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (monihaku2007 = 6 or monihaku2008 = 6 or monihaku2009 = 6 or ((monihaku2007 = 4 or monihaku2008 = 4 or monihaku2009 = 4) and (monihaku2007 = 7 or monihaku2008 = 7 or monihaku2009 = 7))) and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (monihaku2008 = 6 or monihaku2009 = 6 or monihaku2010 = 6 or ((monihaku2008 = 4 or monihaku2009 = 4 or monihaku2010 = 4) and (monihaku2008 = 7 or monihaku2009 = 7 or monihaku2010 = 7))) and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (monihaku2009 = 6 or monihaku2010 = 6 or monihaku2011 = 6 or ((monihaku2009 = 4 or monihaku2010 = 4 or monihaku2011 = 4) and (monihaku2009 = 7 or monihaku2010 = 7 or monihaku2011 = 7))) and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (monihaku2010 = 6 or monihaku2011 = 6 or monihaku2012 = 6 or ((monihaku2010 = 4 or monihaku2011 = 4 or monihaku2012 = 4) and (monihaku2010 = 7 or monihaku2011 = 7 or monihaku2012 = 7))) and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1*/
	else 0
end haku_amkyo_eiopisk_kk

--Opiskellut korkea-asteella
,case
	when  l.suorlk = '1' and (l.amkopiskkoulk_1 <> '' or l.yoopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '' or l.amkopiskkoulk2007 <> '' or l.yoopiskkoulk2007 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '' or l.amkopiskkoulk2007 <> '' or l.yoopiskkoulk2007 <> '' or l.amkopiskkoulk2008 <> '' or l.yoopiskkoulk2008 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2007 <> '' or l.yoopiskkoulk2007 <> '' or l.amkopiskkoulk2008 <> '' or l.yoopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2008 <> '' or l.yoopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '') then 1*/
	else 0
end opisk_kk
----Opiskellut korkea-asteella, ei-opiskellut toisen asteen koulutuksessa
,case
	when  l.suorlk = '1' and l.luopiskkoulk_1 = '' and l.ammopiskkoulk_1 = '' and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and (l.amkopiskkoulk_1 <> '' or l.yoopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 = '' and (l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '' or l.amkopiskkoulk2007 <> '' or l.yoopiskkoulk2007 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 = '' and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' and (l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '' or l.amkopiskkoulk2007 <> '' or l.yoopiskkoulk2007 <> '' or l.amkopiskkoulk2008 <> '' or l.yoopiskkoulk2008 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 = '' and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and (l.amkopiskkoulk2007 <> '' or l.yoopiskkoulk2007 <> '' or l.amkopiskkoulk2008 <> '' or l.yoopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and (l.amkopiskkoulk2008 <> '' or l.yoopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and (l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and (l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '') then 1*/
	else 0
end opisk_kk_eiopisk_ta
----Opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa
,case
	when  l.suorlk = '1' and (l.luopiskkoulk_1 <> '' or l.ammopiskkoulk_1 <> '' or l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '') and (l.amkopiskkoulk_1 <> '' or l.yoopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '' or l.luopiskkoulk2007 <> '' or l.ammopiskkoulk2007 <> '') and (l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '' or l.amkopiskkoulk2007 <> '' or l.yoopiskkoulk2007 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '' or l.luopiskkoulk2007 <> '' or l.ammopiskkoulk2007 <> '' or l.luopiskkoulk2008 <> '' or l.ammopiskkoulk2008 <> '') and (l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '' or l.amkopiskkoulk2007 <> '' or l.yoopiskkoulk2007 <> '' or l.amkopiskkoulk2008 <> '' or l.yoopiskkoulk2008 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk2007 <> '' or l.ammopiskkoulk2007 <> '' or l.luopiskkoulk2008 <> '' or l.ammopiskkoulk2008 <> '' or l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '') and (l.amkopiskkoulk2007 <> '' or l.yoopiskkoulk2007 <> '' or l.amkopiskkoulk2008 <> '' or l.yoopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk2008 <> '' or l.ammopiskkoulk2008 <> '' or l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '') and (l.amkopiskkoulk2008 <> '' or l.yoopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '') and (l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '') and (l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '') then 1*/
	else 0
end opisk_kk_opisk_ta
----Opiskellut vain ammattikorkeakoulussa
,case
	when  l.suorlk = '1' and (l.amkopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '') and l.yoopiskkoulk_1 = '' and l.yoopiskkoulk_2 = '' and l.yoopiskkoulk_3 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.amkopiskkoulk2007 <> '') and l.yoopiskkoulk_2 = '' and l.yoopiskkoulk_3 = '' and l.yoopiskkoulk2007 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk_3 <> '' or l.amkopiskkoulk2007 <> '' or l.amkopiskkoulk2008 <> '') and l.yoopiskkoulk_3 = '' and l.yoopiskkoulk2007 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2007 <> '' or l.amkopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '') and l.yoopiskkoulk2007 = '' and l.yoopiskkoulk2008 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '') and l.yoopiskkoulk2008 = '' and l.yoopiskkoulk2009 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '') and l.yoopiskkoulk2009 = '' and l.yoopiskkoulk2010 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '') and l.yoopiskkoulk2010 = '' and l.yoopiskkoulk2011 = '' and l.yoopiskkoulk2012 = '' then 1*/
	else 0
end opisk_vain_amk
----Opiskellut vain yliopistokoulutuksessa
,case
	when  l.suorlk = '1' and l.amkopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and (l.yoopiskkoulk_1 <> '' or l.yoopiskkoulk_2 <> '' or l.yoopiskkoulk_3 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and l.amkopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.amkopiskkoulk2007 = '' and (l.yoopiskkoulk_2 <> '' or l.yoopiskkoulk_3 <> '' or l.yoopiskkoulk2007 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and l.amkopiskkoulk_3 = '' and l.amkopiskkoulk2007 = '' and l.amkopiskkoulk2008 = '' and (l.yoopiskkoulk_3 <> '' or l.yoopiskkoulk2007 <> '' or l.yoopiskkoulk2008 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and l.amkopiskkoulk2007 = '' and l.amkopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and (l.yoopiskkoulk2007 <> '' or l.yoopiskkoulk2008 <> '' or l.yoopiskkoulk2009 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and l.amkopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and (l.yoopiskkoulk2008 <> '' or l.yoopiskkoulk2009 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and l.amkopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and (l.yoopiskkoulk2009 <> '' or l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and l.amkopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and (l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '' or l.yoopiskkoulk2012 <> '') then 1*/
	else 0
end opisk_vain_yo
----Opiskellut sekä amk- että yliopistokoulutuksessa
,case
	when  l.suorlk = '1' and (l.amkopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '') and (l.yoopiskkoulk_1 <> '' or l.yoopiskkoulk_2 <> '' or l.yoopiskkoulk_3 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.amkopiskkoulk2007 <> '') and (l.yoopiskkoulk_2 <> '' or l.yoopiskkoulk_3 <> '' or l.yoopiskkoulk2007 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk_3 <> '' or l.amkopiskkoulk2007 <> '' or l.amkopiskkoulk2008 <> '') and (l.yoopiskkoulk_3 <> '' or l.yoopiskkoulk2007 <> '' or l.yoopiskkoulk2008 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2007 <> '' or l.amkopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '') and (l.yoopiskkoulk2007 <> '' or l.yoopiskkoulk2008 <> '' or l.yoopiskkoulk2009 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '') and (l.yoopiskkoulk2008 <> '' or l.yoopiskkoulk2009 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '') and (l.yoopiskkoulk2009 <> '' or l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '') and (l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '' or l.yoopiskkoulk2012 <> '') then 1*/
	else 0
end opisk_amkyo



FROM 
    (
	select * from [VipunenTK_SA].[dbo].[v_K3_13_Perusk_paattaneet_amm_tutk_suorittaneet]
	where suorlk = '1'
	) as l

LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d1a on d1a.koulutusluokitus_avain=l.amkopiskkoulk_1
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d2a on d2a.koulutusluokitus_avain=l.amkopiskkoulk_2
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d3a on d3a.koulutusluokitus_avain=l.amkopiskkoulk_3
/*LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d4a on d4a.koulutusluokitus_avain=l.amkopiskkoulk2007
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d5a on d5a.koulutusluokitus_avain=l.amkopiskkoulk2008
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d6a on d6a.koulutusluokitus_avain=l.amkopiskkoulk2009
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d7a on d7a.koulutusluokitus_avain=l.amkopiskkoulk2010
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d8a on d8a.koulutusluokitus_avain=l.amkopiskkoulk2011
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d9a on d9a.koulutusluokitus_avain=l.amkopiskkoulk2012*/

LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d1b on d1b.koulutusluokitus_avain=l.yoopiskkoulk_1
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d2b on d2b.koulutusluokitus_avain=l.yoopiskkoulk_2
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d3b on d3b.koulutusluokitus_avain=l.yoopiskkoulk_3
/*LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d4b on d4b.koulutusluokitus_avain=l.yoopiskkoulk2007
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d5b on d5b.koulutusluokitus_avain=l.yoopiskkoulk2008
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d6b on d6b.koulutusluokitus_avain=l.yoopiskkoulk2009
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d7b on d7b.koulutusluokitus_avain=l.yoopiskkoulk2010
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d8b on d8b.koulutusluokitus_avain=l.yoopiskkoulk2011	
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d9b on d9b.koulutusluokitus_avain=l.yoopiskkoulk2012*/

LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d1c on d1c.koulutusluokitus_avain=l.ammopiskkoulk_1
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d2c on d2c.koulutusluokitus_avain=l.ammopiskkoulk_2
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d3c on d3c.koulutusluokitus_avain=l.ammopiskkoulk_3
/*LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d4c on d4c.koulutusluokitus_avain=l.ammopiskkoulk2007
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d5c on d5c.koulutusluokitus_avain=l.ammopiskkoulk2008
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d6c on d6c.koulutusluokitus_avain=l.ammopiskkoulk2009
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d7c on d7c.koulutusluokitus_avain=l.ammopiskkoulk2010
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d8c on d8c.koulutusluokitus_avain=l.ammopiskkoulk2011
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d9c on d9c.koulutusluokitus_avain=l.ammopiskkoulk2012*/

CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d1a.iscfibroad2013_koodi),(d1b.iscfibroad2013_koodi), (d2a.iscfibroad2013_koodi),(d2b.iscfibroad2013_koodi), (d3a.iscfibroad2013_koodi),(d3b.iscfibroad2013_koodi)) AS a(d)) m1
/*CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d2a.iscfibroad2013_koodi),(d2b.iscfibroad2013_koodi), (d3a.iscfibroad2013_koodi),(d3b.iscfibroad2013_koodi), (d4a.iscfibroad2013_koodi),(d4b.iscfibroad2013_koodi)) AS a(d)) m2
CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d3a.iscfibroad2013_koodi),(d3b.iscfibroad2013_koodi), (d4a.iscfibroad2013_koodi),(d4b.iscfibroad2013_koodi), (d5a.iscfibroad2013_koodi),(d5b.iscfibroad2013_koodi)) AS a(d)) m3
CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d4a.iscfibroad2013_koodi),(d4b.iscfibroad2013_koodi), (d5a.iscfibroad2013_koodi),(d5b.iscfibroad2013_koodi), (d6a.iscfibroad2013_koodi),(d6b.iscfibroad2013_koodi)) AS a(d)) m4
CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d5a.iscfibroad2013_koodi),(d5b.iscfibroad2013_koodi), (d6a.iscfibroad2013_koodi),(d6b.iscfibroad2013_koodi), (d7a.iscfibroad2013_koodi),(d7b.iscfibroad2013_koodi)) AS a(d)) m5
CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d6a.iscfibroad2013_koodi),(d6b.iscfibroad2013_koodi), (d7a.iscfibroad2013_koodi),(d7b.iscfibroad2013_koodi), (d8a.iscfibroad2013_koodi),(d8b.iscfibroad2013_koodi)) AS a(d)) m6
CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d7a.iscfibroad2013_koodi),(d7b.iscfibroad2013_koodi), (d8a.iscfibroad2013_koodi),(d8b.iscfibroad2013_koodi), (d9a.iscfibroad2013_koodi),(d9b.iscfibroad2013_koodi)) AS a(d)) m7*/

	
WHERE 1=1

--
-- TULOS
-- 
/*
if @debug_what_to_run>=3 begin
	if @debug_what_to_run>0 print 'querying result';
	select * from [VipunenTK_DW].[dbo].[_koulutukseen_sijoittuneet_6v]
	--select COUNT(*) from vipunen_tk.f_tyol_ja_jatko_opin_ where aineisto=(select id from vipunen_tk.d_aineisto where aineistokoodi='4.3' and @toinen_suoritusvuosi between alkaa and paattyy)
end;

if @debug_what_to_run>0 PRINT 'all done.';
*/


GO
/****** Object:  StoredProcedure [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_2_5_tarkastelujakso]    Script Date: 29.8.2018 15:59:41 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE PROCEDURE [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_2_5_tarkastelujakso] AS
/*declare @debug_what_to_run tinyint; set @debug_what_to_run=2; -- käytä arvoa 3 vain kun teet yhden vuoden
print '$'+convert(varchar,sysdatetime(),20)+'$ '+'DEBUG (what to run)='+cast(@debug_what_to_run as varchar)+
': 0=luo vain taulut, älä tulosta mitään; 1=luo taulut ja tulosta joitakin merkittävimpiä välivaiheita; 2=luo taulut ja tulosta välivaiheet; 3=luo taulut, tulosta välivaiheet ja tulosta myös tulokset, 4=tulosta välivaiheet, mutta älä tee mitään';




-- lisätään data
if @debug_what_to_run not in (4) begin
if @debug_what_to_run>0 print 'inserting data';

-- parametrimuuttujien arvot
-- parametrimuuttujat
DECLARE @ensimmainen_suoritusvuosi int;
DECLARE @toinen_suoritusvuosi int;
DECLARE @kolmas_suoritusvuosi int;
DECLARE @neljas_suoritusvuosi int;
DECLARE @viides_suoritusvuosi int;
DECLARE @kuudes_suoritusvuosi int;
DECLARE @seitsemas_suoritusvuosi int;


set @ensimmainen_suoritusvuosi = _2;
set @toinen_suoritusvuosi = 2005;
set @kolmas_suoritusvuosi = 2006;
set @neljas_suoritusvuosi = 2007;
set @viides_suoritusvuosi = 2008;
set @kuudes_suoritusvuosi = 2009;
set @seitsemas_suoritusvuosi = 2010;

*/

INSERT INTO [VipunenTK_DW].[dbo].[_koulutukseen_sijoittuneet_6v_tarkastelu]
(
rivinumero
, tarkastelujakso
, tilv 
, tilv_date
, tutkryh 
, suorv
, suorlk 
, sp 
, syntv
, aikielir1 
, tutkkaskun 
, kansalr1
, pohjmaa 
, eumaa 
, etamaa 
, tunn
, jarj
, kkielir1 
, tutklaja 
, tutktav 
, aikoul 
, tutkmaak
, koulutus_1
, oppilaitos_1
, koulutuksen_jarjestaja_1
, koulutuksen_maakunta_1
, koulutus_2
, oppilaitos_2
, koulutuksen_jarjestaja_2
, koulutuksen_maakunta_2
, monihaku
, paaasiallinen_toiminta
, ammattiasema
, lkm
, pohjkoulk
, tietolahde
, aineisto
, lukiokoulutuksessa
, ammatillisessa_koulutuksessa
, ammattikorkeakoulutuksessa
, yliopistokoulutuksessa
, lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa
, toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa
, ammattikorkeakoulutuksessa_ja_yliopistokoulutuksessa
, koulutuksen_paattaneiden_toiminta
, ika_1v
, ika_5v
, ika_1v_suorv
, opisk_lu
, opisk_amm_pk
, opisk_amm_at
, opisk_amm_eat
, opisk_amm
, opisk_amk
, opisk_yo
, opisk_amk_koulala1
, opisk_amk_koulala2
, opisk_amk_koulala3
, opisk_amk_koulala4
, opisk_amk_koulala5
, opisk_amk_koulala6
, opisk_amk_koulala7
, opisk_amk_koulala8
, opisk_amk_koulala9
, opisk_amk_koulala10
, opisk_yo_koulala1
, opisk_yo_koulala2
, opisk_yo_koulala3
, opisk_yo_koulala4
, opisk_yo_koulala5
, opisk_yo_koulala6
, opisk_yo_koulala7
, opisk_yo_koulala8
, opisk_yo_koulala9
, opisk_yo_koulala10
, opisk_vah2_koulala
, haku_amm
, haku_amk
, haku_yo
, eihaku_kk_eiopisk
, eihaku_kk_eiopisk_kk_opisk_ta
, eihaku_kk_eiopisk_kk_opisk_lu
, eihaku_kk_eiopisk_kk_opisk_pk
, eihaku_kk_eiopisk_kk_opisk_at
, eihaku_kk_eiopisk_kk_opisk_eat
, haku_kk_eiopisk_kk
, haku_kk_eiopisk_kk_eiopisk_ta
, haku_kk_eiopisk_kk_opisk_ta
, haku_amk_eiopisk_kk
, haku_yo_eiopisk_kk
, haku_amkyo_eiopisk_kk
, opisk_kk
, opisk_kk_eiopisk_ta
, opisk_kk_opisk_ta
, opisk_vain_amk
, opisk_vain_yo
, opisk_amkyo
)
SELECT
 l.rivinumero,
 '2,5',
 l.tilv,
 l.tilv_date,
 (case 
	when l.tutkryh=3 and tutklaja=1 then 31
	when l.tutkryh=3 and tutklaja=2 then 32
	when l.tutkryh=3 and tutklaja=3 then 33
	else l.tutkryh
  end),
 l.suorv,
  (case
	when l.suorlk = '1'  then (l.suorv+'0'+l.suorlk)
	when l.suorlk = '2'  then (l.suorv+'0'+'8')
	else ''
	end),
 l.sp,
 l.syntv,
 l.aikielir1,
 l.tutkaskun,
 l.kansalr1,
 l.pohjmaa,
 l.eumaa,
 l.etamaa,
 l.tunn,
 l.jarj,
 l.kkielir1,
 l.tutklaja,
 l.tutktav,
 l.aikoul,
 l.tutkmaak,
 -- Koulutus 1
 (case
    --lukiokoulutuksessa _4
	when l.suorlk = '2' and l.luopiskkoulk_4 <> '' and l.ammopiskkoulk_4 = '' and
	l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' then l.luopiskkoulk_4 
	-- ammattikoulutuksessa _4
	when l.suorlk = '2' and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 <> '' and
	l.amkopiskkoulk_4 ='' and l.yoopiskkoulk_4 = ''  then l.ammopiskkoulk_4 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen _4 ensim. koulutustietoihin
	when l.suorlk = '2' and l.luopiskkoulk_4 <> '' and l.ammopiskkoulk_4 <> '' and
	l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' then l.luopiskkoulk_4
	-- ammattikorkeakoulutuksessa _4
	when l.suorlk = '2' and l.amkopiskkoulk_4  <> '' and l.yoopiskkoulk_4  = '' and
	l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' then l.amkopiskkoulk_4
	-- yliopistokoulutuksessa _4
	when l.suorlk = '2' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 <> '' and 
	l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = ''   then l.yoopiskkoulk_4
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa, merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorlk = '2' and l.amkopiskkoulk_4 <> '' and l.yoopiskkoulk_4  <> '' and
	l.luopiskkoulk_4 = '' and ammopiskkoulk_4 = ''  then l.amkopiskkoulk_4 
	
	else ''

	
	    
	    end),
	    
-- Oppilaitos 1
	(case
	-- lukiokoulutuksen oppilaitos _4
	when l.suorlk = '2' and l.luopisktunn_4 <> '' and l.ammopisktunn_4 = '' and
	l.amkopisktunn_4 = '' and l.yoopisktunn_4 = '' then l.luopisktunn_4 
	-- ammattikoulutuksen oppilaitos _4
	when l.suorlk = '2' and l.luopisktunn_4 = '' and l.ammopisktunn_4 <> '' and
	l.amkopisktunn_4 ='' and l.yoopisktunn_4 = ''  then l.ammopisktunn_4 
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos _4
	when l.suorlk = '2' and l.luopisktunn_4 <> '' and l.ammopisktunn_4 <> '' and
	l.amkopisktunn_4 = '' and l.yoopisktunn_4 = '' then l.luopisktunn_4
	-- ammattikorkeakoulutuksen oppilaitos _4
	when l.suorlk = '2' and l.amkopisktunn_4  <> '' and l.yoopisktunn_4  = '' and
	l.luopisktunn_4 = '' and l.ammopisktunn_4 = '' then l.amkopisktunn_4
	-- yliopistokoulutuksen oppilaitos _4
	when l.suorlk = '2' and l.amkopisktunn_4 = '' and l.yoopisktunn_4 <> '' and 
	l.luopisktunn_4 = '' and l.ammopisktunn_4 = ''   then l.yoopisktunn_4
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus _4  
	when l.suorlk = '2' and l.amkopisktunn_4 <> '' and l.yoopisktunn_4  <> '' and
	l.luopisktunn_4 = '' and l.ammopisktunn_4 = ''  then l.amkopisktunn_4 
	
	
	

	
	else ''
	
	    end),
  --Koulutuksen järjestäjä 1
	(case
	-- lukikoulutuksen järjestäjä _4
	when l.suorlk = '2' and l.luopiskjarj_4  <> '' and l.ammopiskjarj_4 = '' and
	l.amkopiskjarj_4 = '' and yoopiskjarj_4 = '' then l.luopiskjarj_4
	-- ammatillisen koulutuksen järjestäjä _4  
	when l.suorlk = '2' and l.luopiskjarj_4 = '' and l.ammopiskjarj_4 <> '' and
	l.amkopiskjarj_4 ='' and l.yoopiskjarj_4 = ''  then l.ammopiskjarj_4
	-- lukio- ja ammatillisen koulutuksen järjestäjä, merkitään lukiokoulutuksen _4 järjestäjä 
	when l.suorlk = '2' and l.luopiskjarj_4 <> '' and l.ammopiskjarj_4 <> '' and
	l.amkopiskjarj_4 = '' and l.yoopiskjarj_4 = '' then l.luopiskjarj_4
	-- ammattikorkeakoulutuksen järjestäjä _4
	when l.suorlk = '2' and l.amkopiskjarj_4  <> '' and l.yoopiskjarj_4   = '' and
	l.luopiskjarj_4 = '' and l.ammopiskjarj_4 = '' then l.amkopiskjarj_4
	-- yliopistokoulutuksen järjestäjä _4 
	when l.suorlk = '2' and l.amkopiskjarj_4  = '' and l.yoopiskjarj_4  <> '' and 
	l.luopiskjarj_4  = '' and l.ammopiskjarj_4 = ''   then l.yoopiskjarj_4
	-- ammattikorkea- ja yliopistokoulutuksen järjestäjä, merkitään ammattikorkeakoulutuksen _4 järjestäjä   
	when l.suorlk = '2' and l.amkopiskjarj_4  <> '' and l.yoopiskjarj_4   <> '' and
	l.luopiskjarj_4  = '' and l.ammopiskjarj_4  = ''  then l.amkopiskjarj_4 

	
	else ''
	    end),
 --Koulutuksen maakunta 1
	(case
	-- lukioopiskelun maakunta _4
	when l.suorlk = '2' and l.luopiskmaak_4   <> '' and l.ammopiskmaak_4  = '' and
	l.amkopiskmaak_4  = '' and l.yoopiskmaak_4  = '' then l.luopiskmaak_4   
	-- ammatillisen koulutuksen maakunta _4
	when l.suorlk = '2' and l.luopiskmaak_4  = '' and l.ammopiskmaak_4  <> '' and
	l.amkopiskmaak_4  ='' and l.yoopiskmaak_4  = ''  then l.ammopiskmaak_4  
	-- lukiokoulutuksen ja ammatillisen koulutus otetaan lukiokoulutuksen maakunta _4
	when l.suorlk = '2' and l.luopiskmaak_4  <> '' and l.ammopiskmaak_4  <> '' and
	l.amkopiskmaak_4  = '' and l.yoopiskmaak_4  = '' then l.luopiskmaak_4 
    -- ammattikorkeakoulutuksen maakunta _4
	when l.suorlk = '2' and l.amkopiskmaak_4   <> '' and l.yoopiskmaak_4   = '' and
	l.luopiskjarj_4 = '' and l.ammopiskmaak_4 = '' then l.amkopiskmaak_4
	-- yliopistokoulutuksen maakunta _4 
	when l.suorlk = '2' and l.amkopiskmaak_4  = '' and l.yoopiskmaak_4  <> '' and 
	l.luopiskjarj_4  = '' and l.ammopiskmaak_4 = ''   then l.yoopiskmaak_4
	-- ammattikorkekoulutuksen ja yliopistokoulutksen maakunta otetaan ammattikorkeakoulutuksen maakunta _4   
	when l.suorlk = '2' and l.amkopiskmaak_4  <> '' and l.yoopiskmaak_4   <> '' and
	l.luopiskjarj_4  = '' and l.ammopiskmaak_4  = ''  then l.amkopiskmaak_4 
	
	else ''
	
	    end),
-- Koulutus 2
(case
   -- jos lukiokoulutuksessa vain niin jätetään tyhjäksi _4
	when l.suorlk = '2' and l.luopiskkoulk_4 <> '' and l.ammopiskkoulk_4 = '' and
	l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' then ''
	-- jos ammattikoulutuksessa vain  jätetään tyhjäksi _4 
	when l.suorlk = '2' and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 <> '' and
	l.amkopiskkoulk_4 ='' and l.yoopiskkoulk_4 = ''  then ''
	-- jos lukiokoulutksessa ja ammattikoulutuksessa merkitään ammattikoulutus _4 
	when l.suorlk = '2' and l.luopiskkoulk_4 <> '' and l.ammopiskkoulk_4 <> '' and
	l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' then l.ammopiskkoulk_4 
	-- jos vain ammattikorkeakoulutuksessa jätetään tyhjäksi
	when l.suorlk = '2' and l.amkopiskkoulk_4  <> '' and l.yoopiskkoulk_4  = '' and
	l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorlk = '2' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 <> '' and 
	l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = ''   then ''
	-- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus _4
	when l.suorlk = '2' and l.amkopiskkoulk_4 <> '' and l.yoopiskkoulk_4  <> '' and
	l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = ''  then l.yoopiskkoulk_4
	
	
	
	else ''
	    end),
-- Oppilaitos 2
(case
    -- lukiokoulutuksen oppilaitos vain merkitään tyhjäksi
	when l.suorlk = '2' and l.luopisktunn_4 <> '' and l.ammopisktunn_4 = '' and
	l.amkopisktunn_4 = '' and l.yoopisktunn_4 = '' then ''
	-- ammatillisen koulutuksen oppilaitos _4 merkitään tyhjäksi
	when l.suorlk = '2' and l.luopisktunn_4 = '' and l.ammopisktunn_4 <> '' and
	l.amkopisktunn_4 ='' and l.yoopisktunn_4 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos merkitään ammatillisen koulutuksen oppilaitos _4
	when l.suorlk = '2' and l.luopisktunn_4 <> '' and l.ammopisktunn_4 <> '' and
	l.amkopisktunn_4 = '' and l.yoopisktunn_4 = '' then l.ammopisktunn_4 
	-- ammattikorkeakoulutksen oppilaitos vain merkitään tyhjäksi _4
	when l.suorlk = '2' and l.amkopisktunn_4  <> '' and l.yoopisktunn_4  = '' and
	l.luopisktunn_4 = '' and l.ammopisktunn_4 = '' then ''
	-- yliopistokoulutksen oppilaitos vain merkitään tyhjäksi _4
	when l.suorlk = '2' and l.amkopisktunn_4 = '' and l.yoopisktunn_4 <> '' and 
	l.luopisktunn_4 = '' and l.ammopisktunn_4 = ''   then ''  
	--  ammattikorkeakoulutksen oppilaitos ja yliopistokoulutuksen oppilaitos, merkitään yliopistokoulutuksen oppilaitos _4
	when l.suorlk = '2' and l.amkopisktunn_4 <> '' and l.yoopisktunn_4  <> '' and
	l.luopisktunn_4 = '' and l.ammopisktunn_4 = ''  then l.yoopisktunn_4 
	
	
	else ''
	    end),
-- Koulutuksen järjestäjä 2
	(case
	-- lukiokoulutuksen järjestäjä vain _4, merkitään tyhjäksi
	when l.suorlk = '2' and l.luopiskjarj_4  <> '' and l.ammopiskjarj_4 = '' and
	l.amkopiskjarj_4 = '' and l.yoopiskjarj_4 = '' then ''
	-- ammatillisen koulutuksen järjestäjä vain _4, merkitään tyhjäksi
	when l.suorlk = '2' and l.luopiskjarj_4 = '' and l.ammopiskjarj_4 <> '' and
	l.amkopiskjarj_4 ='' and l.yoopiskjarj_4 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä _4
	when l.suorlk = '2' and l.luopiskjarj_4 <> '' and l.ammopiskjarj_4 <> '' and
	l.amkopiskjarj_4 = '' and l.yoopiskjarj_4 = '' then l.ammopiskjarj_4 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi
	when l.suorlk = '2' and l.amkopiskjarj_4  <> '' and l.yoopiskjarj_4   = '' and
	l.luopiskjarj_4 = '' and l.ammopiskjarj_4 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, merkitään tyhjäksi
	when l.suorlk = '2' and l.amkopiskjarj_4  = '' and l.yoopiskjarj_4  <> '' and 
	l.luopiskjarj_4  = '' and l.ammopiskjarj_4 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestäjä merkitään yliopistokoulutuksen järjetäjä _4
	when l.suorlk = '2' and l.amkopiskjarj_4  <> '' and l.yoopiskjarj_4   <> '' and
	l.luopiskjarj_4  = '' and l.ammopiskjarj_4  = ''  then l.yoopiskjarj_4 
	

	else ''
	    end),
-- Koulutuksen maakunta 2
	(case
	-- vain lukiokoulutuksen maakunta _4, jätetään tyhjäksi
	when l.suorlk = '2' and l.luopiskmaak_4   <> '' and l.ammopiskmaak_4  = '' and
	l.amkopiskmaak_4  = '' and l.yoopiskmaak_4  = '' then ''
	-- vain ammatillisen koulutuksen maakunta _4, jätetään tyhjäksi   
	when l.suorlk = '2' and l.luopiskmaak_4  = '' and l.ammopiskmaak_4  <> '' and
	l.amkopiskmaak_4  ='' and l.yoopiskmaak_4  = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta, merkitään ammatillisen koulutuksen maakunta _4
	when l.suorlk = '2' and l.luopiskmaak_4  <> '' and l.ammopiskmaak_4  <> '' and
	l.amkopiskmaak_4  = '' and l.yoopiskmaak_4  = '' then l.ammopiskmaak_4 
	-- vain ammattikorkeakoulutuksen maakunta _4, jätetään tyhjäksi
	when l.suorlk = '2' and l.amkopiskmaak_4   <> '' and l.yoopiskmaak_4   = '' and
	l.luopiskmaak_4 = '' and l.ammopiskmaak_4 = '' then '' 
	-- vain yliopistokoulutuksen maakunta _4, merkitään tyhjäksi
	when l.suorlk = '2' and l.amkopiskmaak_4  = '' and l.yoopiskmaak_4  <> '' and 
	l.luopiskmaak_4  = '' and l.ammopiskmaak_4 = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta _4, merkitään yliopistokoulutuksen maakunta _4
	when l.suorlk = '2' and l.amkopiskmaak_4  <> '' and l.yoopiskmaak_4   <> '' and
	l.luopiskjarj_4  = '' and l.ammopiskmaak_4  = ''  then l.yoopiskmaak_4
	

	else ''
	
	    end),
	-- Monihaku
	(case
	-- _4
	when l.suorlk = '2' then l.monihaku_4		
	else '8'
	end),
    -- Pääasiallinen toiminta
    (case
    -- _4
	when l.suorlk = '2' then l.ptoim1r4_4
	else ''
	end),
	-- Ammattiasema
	(case
	-- _4
	when l.suorlk = '2' then l.amas_4
	else ''
	end),
    l.lkm,
	l.pohjkoul,
 l.tietolahde,
 'K3.13',
 -- Lukiokoulutuksessa
 (case
	    when (l.suorlk = '2' ) and  l.luopiskkoulk_4 <> '' and l.ammopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_4 = '' then '1'    
	    else '0'
	    end) as lukiokoulutuksessa,
 -- Ammatillisessa koulutuksessa 
 (case
	    when (l.suorlk = '2') and  l.ammopiskkoulk_4  <> '' and l.luopiskkoulk_4 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' then '1' 
	    else '0'
	    end) as ammatillisessa_koulutuksessa,
-- Ammattikorkeakoulutuksessa
 (case
	   when (l.suorlk = '2') and  l.amkopiskkoulk_4 <> '' and l.ammopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.luopiskkoulk_4 = '' then  '1'
	   else '0' 
	   end) as ammattikorkeakoulutuksessa,
-- Yliopistokoulutuksessa
 (case
	    when (l.suorlk = '2') and  l.yoopiskkoulk_4  <> '' and l.amkopiskkoulk_4 = '' and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' then '1'   	   
	    else '0'
	    end) as yliopistokoulutuksessa,
-- Lukiokoulutuksessa ja ammatillisessa koulutuksessa
(case
	    when (l.suorlk = '2') and  l.luopiskkoulk_4  <> '' and l.ammopiskkoulk_4 <> '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4  = '' then '1'  
	    else '0'
	    end) as lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa,
-- Toisen asteen ammatillisessa koulutuksessa ja korkeakoulutuksessa
(case
	    when (l.suorlk = '2') and  l.ammopiskkoulk_4  <> '' and l.amkopiskkoulk_4 <> '' and l.luopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' then '1'  
	    else '0'
	    end) as toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa,
-- Ammattikorkeakoulutuksessa ja yliopistokoulutuksessa
(case
	    when (l.suorlk = '2') and  l.amkopiskkoulk_4  <> '' and l.yoopiskkoulk_4 <> '' and l.ammopiskkoulk_4  = '' and l.luopiskkoulk_4 = ''  then '1' 
	    else '0'
	    end) as ammattikorkekoulutuksessa_ja_yliopistokoulutuksessa,    
-- Koulutuksen päättäneiden toiminta
(case
	   -- Tutkintoon johtavassa koulutuksessa olevat
	   when (l.suorlk = '2')  and (l.ptoim1r4_4 = '22' or l.ptoim1r4_4 = '13')
       and	(l.luopiskkoulk_4 <>'' or l.ammopiskkoulk_4 <>'' or l.amkopiskkoulk_4 <>'' or l.yoopiskkoulk_4 <>'')   then '1' 
	
	   -- Ei tutkintoon johtavassa koulutuksessa olevat
	   when (l.suorlk = '2')  and (l.ptoim1r4_4 = '22' or l.ptoim1r4_4 = '13')
       and	(l.luopiskkoulk_4 ='' and l.ammopiskkoulk_4 ='' and l.amkopiskkoulk_4 ='' and l.yoopiskkoulk_4 ='')   then '2' 
   
   
	   -- Ei opiskelevat työlliset
	   when (l.suorlk = '2')and  l.ptoim1r4_4  = '10'  then '3' 
	   -- Ei opiskelevat työttömät
	   when (l.suorlk = '2') and  l.ptoim1r4_4  = '12'  then '4' 
	   -- Ei opiskelevat muut
		else '5' 
	   end ) as koulutuksen_paattaneiden_toiminta
 ,ika_1v = cast((case 
            when syntv = '' then '-1'
            when  (cast(tilv as int) - cast(syntv as int)) > 99 then ''
            else  ((cast(tilv as int) - cast(syntv as int))) end)  as nvarchar(10))
 ,ika_5v =cast(
       (
		case
		when (cast(tilv as int) - cast(syntv as int)) < 15 then '5v10'
		when ((cast(tilv as int) - cast(syntv as int)) >= 15 and (cast(tilv as int) - cast(syntv as int)) <= 19) then '5v15'
		when ((cast(tilv as int) - cast(syntv as int)) >= 20 and (cast(tilv as int) - cast(syntv as int)) <= 24) then '5v20'
		when ((cast(tilv as int) - cast(syntv as int)) >= 25 and (cast(tilv as int) - cast(syntv as int)) <= 29) then '5v25'
		when ((cast(tilv as int) - cast(syntv as int)) >= 30 and (cast(tilv as int) - cast(syntv as int)) <= 34) then '5v30'
		when ((cast(tilv as int) - cast(syntv as int)) >= 35 and (cast(tilv as int) - cast(syntv as int)) <= 39) then '5v35'
		when ((cast(tilv as int) - cast(syntv as int)) >= 40 and (cast(tilv as int) - cast(syntv as int)) <= 44) then '5v40'
		when ((cast(tilv as int) - cast(syntv as int)) >= 45 and (cast(tilv as int) - cast(syntv as int)) <= 49) then '5v45'
		when ((cast(tilv as int) - cast(syntv as int)) >= 50 and (cast(tilv as int) - cast(syntv as int)) <= 54) then '5v50'
		when ((cast(tilv as int) - cast(syntv as int)) >= 55 and (cast(tilv as int) - cast(syntv as int)) <= 59) then '5v55'
		when ((cast(tilv as int) - cast(syntv as int)) >= 60 and (cast(tilv as int) - cast(syntv as int)) <= 64) then '5v60'
		when ((cast(tilv as int) - cast(syntv as int)) >= 65 and (cast(tilv as int) - cast(syntv as int)) <= 69) then '5v65'
		when ((cast(tilv as int) - cast(syntv as int)) >= 70 and (cast(tilv as int) - cast(syntv as int)) <= 74) then '5v70'
		when ((cast(tilv as int) - cast(syntv as int)) >= 75 and (cast(tilv as int) - cast(syntv as int)) <= 79) then '5v75'
		when ((cast(tilv as int) - cast(syntv as int)) >= 80 and (cast(tilv as int) - cast(syntv as int)) <= 84) then '5v80'
		when ((cast(tilv as int) - cast(syntv as int)) >= 85 and (cast(tilv as int) - cast(syntv as int)) <= 89) then '5v85'
		when ((cast(tilv as int) - cast(syntv as int)) >= 90 and (cast(tilv as int) - cast(syntv as int)) <= 94) then '5v90'
		when ((cast(tilv as int) - cast(syntv as int)) >= 95) then '5v95'
		
		end
	   ) as nvarchar (10))

  ,ika_1v_suorv = cast(
					(case 
						when syntv = '' then '-1' 
						else ((cast(suorv as int) - cast(syntv as int))) 
					end)  
	as nvarchar(10))




--uudet muuttujat 03/2018

----OPISKELUT KYLLÄ/EI
--Opiskellut lukiokoulutuksessa
,case
	when  l.suorlk = '2' and (l.luopiskkoulk_1 <> '' or l.luopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.luopiskkoulk2008 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.luopiskkoulk2008 <> '' or l.luopiskkoulk2009 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk_4 <> '' or l.luopiskkoulk2008 <> '' or l.luopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk2008 <> '' or l.luopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '') then 1*/
	else 0
end as opisk_lu
--Opiskellut ammatillisessa peruskoulutuksessa
,case
	when  l.suorlk = '2' and (l.ammopiskkoulk_1 <> '' or l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '') and (d1c.Koulutusaste_taso2_koodi = '32' or d2c.Koulutusaste_taso2_koodi = '32' or d3c.Koulutusaste_taso2_koodi = '32' or d4c.Koulutusaste_taso2_koodi = '32') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk2008 <> '') and (d2c.Koulutusaste_taso2_koodi = '32' or d3c.Koulutusaste_taso2_koodi = '32' or d4c.Koulutusaste_taso2_koodi = '32' or d5c.Koulutusaste_taso2_koodi = '32') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk2008 <> '' or l.ammopiskkoulk2009 <> '') and (d3c.Koulutusaste_taso2_koodi = '32' or d4c.Koulutusaste_taso2_koodi = '32' or d5c.Koulutusaste_taso2_koodi = '32' or d6c.Koulutusaste_taso2_koodi = '32') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk2008 <> '' or l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '') and (d4c.Koulutusaste_taso2_koodi = '32' or d5c.Koulutusaste_taso2_koodi = '32' or d6c.Koulutusaste_taso2_koodi = '32' or d7c.Koulutusaste_taso2_koodi = '32') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2008 <> '' or l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '') and (d5c.Koulutusaste_taso2_koodi = '32' or d6c.Koulutusaste_taso2_koodi = '32' or d7c.Koulutusaste_taso2_koodi = '32' or d8c.Koulutusaste_taso2_koodi = '32') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '') and (d6c.Koulutusaste_taso2_koodi = '32' or d7c.Koulutusaste_taso2_koodi = '32' or d8c.Koulutusaste_taso2_koodi = '32' or d9c.Koulutusaste_taso2_koodi = '32') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '' or l.ammopiskkoulk2013 <> '') and (d7c.Koulutusaste_taso2_koodi = '32' or d8c.Koulutusaste_taso2_koodi = '32' or d9c.Koulutusaste_taso2_koodi = '32' or d10c.Koulutusaste_taso2_koodi = '32') then 1*/
	else 0
end as opisk_amm_pk
--Opiskellut ammattitutkintokoulutuksessa
,case
	when  l.suorlk = '2' and (l.ammopiskkoulk_1 <> '' or l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '') and (d1c.Koulutusaste_taso2_koodi = '33' or d2c.Koulutusaste_taso2_koodi = '33' or d3c.Koulutusaste_taso2_koodi = '33' or d4c.Koulutusaste_taso2_koodi = '33') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk2008 <> '') and (d2c.Koulutusaste_taso2_koodi = '33' or d3c.Koulutusaste_taso2_koodi = '33' or d4c.Koulutusaste_taso2_koodi = '33' or d5c.Koulutusaste_taso2_koodi = '33') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk2008 <> '' or l.ammopiskkoulk2009 <> '') and (d3c.Koulutusaste_taso2_koodi = '33' or d4c.Koulutusaste_taso2_koodi = '33' or d5c.Koulutusaste_taso2_koodi = '33' or d6c.Koulutusaste_taso2_koodi = '33') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk2008 <> '' or l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '') and (d4c.Koulutusaste_taso2_koodi = '33' or d5c.Koulutusaste_taso2_koodi = '33' or d6c.Koulutusaste_taso2_koodi = '33' or d7c.Koulutusaste_taso2_koodi = '33') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2008 <> '' or l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '') and (d5c.Koulutusaste_taso2_koodi = '33' or d6c.Koulutusaste_taso2_koodi = '33' or d7c.Koulutusaste_taso2_koodi = '33' or d8c.Koulutusaste_taso2_koodi = '33') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '') and (d6c.Koulutusaste_taso2_koodi = '33' or d7c.Koulutusaste_taso2_koodi = '33' or d8c.Koulutusaste_taso2_koodi = '33' or d9c.Koulutusaste_taso2_koodi = '33') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '' or l.ammopiskkoulk2013 <> '') and (d7c.Koulutusaste_taso2_koodi = '33' or d8c.Koulutusaste_taso2_koodi = '33' or d9c.Koulutusaste_taso2_koodi = '33' or d10c.Koulutusaste_taso2_koodi = '33') then 1*/
	else 0
end as opisk_amm_at
--Opiskellut erikoisammattitutkintokoulutuksessa
,case
	when  l.suorlk = '2' and (l.ammopiskkoulk_1 <> '' or l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '') and (d1c.Koulutusaste_taso2_koodi = '41' or d2c.Koulutusaste_taso2_koodi = '41' or d3c.Koulutusaste_taso2_koodi = '41' or d4c.Koulutusaste_taso2_koodi = '41') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk2008 <> '') and (d2c.Koulutusaste_taso2_koodi = '41' or d3c.Koulutusaste_taso2_koodi = '41' or d4c.Koulutusaste_taso2_koodi = '41' or d5c.Koulutusaste_taso2_koodi = '41') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk2008 <> '' or l.ammopiskkoulk2009 <> '') and (d3c.Koulutusaste_taso2_koodi = '41' or d4c.Koulutusaste_taso2_koodi = '41' or d5c.Koulutusaste_taso2_koodi = '41' or d6c.Koulutusaste_taso2_koodi = '41') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk2008 <> '' or l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '') and (d4c.Koulutusaste_taso2_koodi = '41' or d5c.Koulutusaste_taso2_koodi = '41' or d6c.Koulutusaste_taso2_koodi = '41' or d7c.Koulutusaste_taso2_koodi = '41') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2008 <> '' or l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '') and (d5c.Koulutusaste_taso2_koodi = '41' or d6c.Koulutusaste_taso2_koodi = '41' or d7c.Koulutusaste_taso2_koodi = '41' or d8c.Koulutusaste_taso2_koodi = '41') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '') and (d6c.Koulutusaste_taso2_koodi = '41' or d7c.Koulutusaste_taso2_koodi = '41' or d8c.Koulutusaste_taso2_koodi = '41' or d9c.Koulutusaste_taso2_koodi = '41') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '' or l.ammopiskkoulk2013 <> '') and (d7c.Koulutusaste_taso2_koodi = '41' or d8c.Koulutusaste_taso2_koodi = '41' or d9c.Koulutusaste_taso2_koodi = '41' or d10c.Koulutusaste_taso2_koodi = '41') then 1*/
	else 0
end as opisk_amm_eat
--Opiskellut ammatillisessa koulutuksessa
,case
	when  l.suorlk = '2' and (l.ammopiskkoulk_1 <> '' or l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk2008 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk2008 <> '' or l.ammopiskkoulk2009 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk2008 <> '' or l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2008 <> '' or l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '' or l.ammopiskkoulk2013 <> '') then 1*/
	else 0
end as opisk_amm
--Opiskellut ammattikorkeakoulutuksessa
,case
	when  l.suorlk = '2' and (l.amkopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.amkopiskkoulk2008 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.amkopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk_4 <> '' or l.amkopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '') then 1*/
	else 0
end as opisk_amk
--Opiskellut yliopistokoulutuksessa
,case
	when  l.suorlk = '2' and (l.yoopiskkoulk_1 <> '' or l.yoopiskkoulk_2 <> '' or l.yoopiskkoulk_3 <> '' or l.yoopiskkoulk_4 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.yoopiskkoulk_2 <> '' or l.yoopiskkoulk_3 <> '' or l.yoopiskkoulk_4 <> '' or l.yoopiskkoulk2008 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.yoopiskkoulk_3 <> '' or l.yoopiskkoulk_4 <> '' or l.yoopiskkoulk2008 <> '' or l.yoopiskkoulk2009 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.yoopiskkoulk_4 <> '' or l.yoopiskkoulk2008 <> '' or l.yoopiskkoulk2009 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.yoopiskkoulk2008 <> '' or l.yoopiskkoulk2009 <> '' or l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.yoopiskkoulk2009 <> '' or l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '' or l.yoopiskkoulk2012 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '' or l.yoopiskkoulk2012 <> '' or l.yoopiskkoulk2013 <> '') then 1*/
	else 0
end as opisk_yo



----KOULUTUSALA, TASO 1 KYLLÄ/EI
--Opiskellut koulutusala1 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1a.iscfibroad2013_koodi = '01' or d2a.iscfibroad2013_koodi = '01' or d3a.iscfibroad2013_koodi = '01' or d4a.iscfibroad2013_koodi = '01') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2a.iscfibroad2013_koodi = '01' or d3a.iscfibroad2013_koodi = '01' or d4a.iscfibroad2013_koodi = '01' or d5a.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3a.iscfibroad2013_koodi = '01' or d4a.iscfibroad2013_koodi = '01' or d5a.iscfibroad2013_koodi = '01' or d6a.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4a.iscfibroad2013_koodi = '01' or d5a.iscfibroad2013_koodi = '01' or d6a.iscfibroad2013_koodi = '01' or d7a.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5a.iscfibroad2013_koodi = '01' or d6a.iscfibroad2013_koodi = '01' or d7a.iscfibroad2013_koodi = '01' or d8a.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6a.iscfibroad2013_koodi = '01' or d7a.iscfibroad2013_koodi = '01' or d8a.iscfibroad2013_koodi = '01' or d9a.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7a.iscfibroad2013_koodi = '01' or d8a.iscfibroad2013_koodi = '01' or d9a.iscfibroad2013_koodi = '01' or d10a.iscfibroad2013_koodi = '01') then 1*/
	else 0
end as opisk_amk_koulala1
--Opiskellut koulutusala2 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1a.iscfibroad2013_koodi = '02' or d2a.iscfibroad2013_koodi = '02' or d3a.iscfibroad2013_koodi = '02' or d4a.iscfibroad2013_koodi = '02') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2a.iscfibroad2013_koodi = '02' or d3a.iscfibroad2013_koodi = '02' or d4a.iscfibroad2013_koodi = '02' or d5a.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3a.iscfibroad2013_koodi = '02' or d4a.iscfibroad2013_koodi = '02' or d5a.iscfibroad2013_koodi = '02' or d6a.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4a.iscfibroad2013_koodi = '02' or d5a.iscfibroad2013_koodi = '02' or d6a.iscfibroad2013_koodi = '02' or d7a.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5a.iscfibroad2013_koodi = '02' or d6a.iscfibroad2013_koodi = '02' or d7a.iscfibroad2013_koodi = '02' or d8a.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6a.iscfibroad2013_koodi = '02' or d7a.iscfibroad2013_koodi = '02' or d8a.iscfibroad2013_koodi = '02' or d9a.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7a.iscfibroad2013_koodi = '02' or d8a.iscfibroad2013_koodi = '02' or d9a.iscfibroad2013_koodi = '02' or d10a.iscfibroad2013_koodi = '02') then 1*/
	else 0
end as opisk_amk_koulala2
--Opiskellut koulutusala3 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1a.iscfibroad2013_koodi = '03' or d2a.iscfibroad2013_koodi = '03' or d3a.iscfibroad2013_koodi = '03' or d4a.iscfibroad2013_koodi = '03') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2a.iscfibroad2013_koodi = '03' or d3a.iscfibroad2013_koodi = '03' or d4a.iscfibroad2013_koodi = '03' or d5a.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3a.iscfibroad2013_koodi = '03' or d4a.iscfibroad2013_koodi = '03' or d5a.iscfibroad2013_koodi = '03' or d6a.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4a.iscfibroad2013_koodi = '03' or d5a.iscfibroad2013_koodi = '03' or d6a.iscfibroad2013_koodi = '03' or d7a.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5a.iscfibroad2013_koodi = '03' or d6a.iscfibroad2013_koodi = '03' or d7a.iscfibroad2013_koodi = '03' or d8a.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6a.iscfibroad2013_koodi = '03' or d7a.iscfibroad2013_koodi = '03' or d8a.iscfibroad2013_koodi = '03' or d9a.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7a.iscfibroad2013_koodi = '03' or d8a.iscfibroad2013_koodi = '03' or d9a.iscfibroad2013_koodi = '03' or d10a.iscfibroad2013_koodi = '03') then 1*/
	else 0
end as opisk_amk_koulala3
--Opiskellut koulutusala4 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1a.iscfibroad2013_koodi = '04' or d2a.iscfibroad2013_koodi = '04' or d3a.iscfibroad2013_koodi = '04' or d4a.iscfibroad2013_koodi = '04') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2a.iscfibroad2013_koodi = '04' or d3a.iscfibroad2013_koodi = '04' or d4a.iscfibroad2013_koodi = '04' or d5a.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3a.iscfibroad2013_koodi = '04' or d4a.iscfibroad2013_koodi = '04' or d5a.iscfibroad2013_koodi = '04' or d6a.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4a.iscfibroad2013_koodi = '04' or d5a.iscfibroad2013_koodi = '04' or d6a.iscfibroad2013_koodi = '04' or d7a.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5a.iscfibroad2013_koodi = '04' or d6a.iscfibroad2013_koodi = '04' or d7a.iscfibroad2013_koodi = '04' or d8a.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6a.iscfibroad2013_koodi = '04' or d7a.iscfibroad2013_koodi = '04' or d8a.iscfibroad2013_koodi = '04' or d9a.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7a.iscfibroad2013_koodi = '04' or d8a.iscfibroad2013_koodi = '04' or d9a.iscfibroad2013_koodi = '04' or d10a.iscfibroad2013_koodi = '04') then 1*/
	else 0
end as opisk_amk_koulala4
--Opiskellut koulutusala5 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1a.iscfibroad2013_koodi = '05' or d2a.iscfibroad2013_koodi = '05' or d3a.iscfibroad2013_koodi = '05' or d4a.iscfibroad2013_koodi = '05') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2a.iscfibroad2013_koodi = '05' or d3a.iscfibroad2013_koodi = '05' or d4a.iscfibroad2013_koodi = '05' or d5a.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3a.iscfibroad2013_koodi = '05' or d4a.iscfibroad2013_koodi = '05' or d5a.iscfibroad2013_koodi = '05' or d6a.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4a.iscfibroad2013_koodi = '05' or d5a.iscfibroad2013_koodi = '05' or d6a.iscfibroad2013_koodi = '05' or d7a.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5a.iscfibroad2013_koodi = '05' or d6a.iscfibroad2013_koodi = '05' or d7a.iscfibroad2013_koodi = '05' or d8a.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6a.iscfibroad2013_koodi = '05' or d7a.iscfibroad2013_koodi = '05' or d8a.iscfibroad2013_koodi = '05' or d9a.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7a.iscfibroad2013_koodi = '05' or d8a.iscfibroad2013_koodi = '05' or d9a.iscfibroad2013_koodi = '05' or d10a.iscfibroad2013_koodi = '05') then 1*/
	else 0
end as opisk_amk_koulala5
--Opiskellut koulutusala6 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1a.iscfibroad2013_koodi = '06' or d2a.iscfibroad2013_koodi = '06' or d3a.iscfibroad2013_koodi = '06' or d4a.iscfibroad2013_koodi = '06') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2a.iscfibroad2013_koodi = '06' or d3a.iscfibroad2013_koodi = '06' or d4a.iscfibroad2013_koodi = '06' or d5a.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3a.iscfibroad2013_koodi = '06' or d4a.iscfibroad2013_koodi = '06' or d5a.iscfibroad2013_koodi = '06' or d6a.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4a.iscfibroad2013_koodi = '06' or d5a.iscfibroad2013_koodi = '06' or d6a.iscfibroad2013_koodi = '06' or d7a.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5a.iscfibroad2013_koodi = '06' or d6a.iscfibroad2013_koodi = '06' or d7a.iscfibroad2013_koodi = '06' or d8a.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6a.iscfibroad2013_koodi = '06' or d7a.iscfibroad2013_koodi = '06' or d8a.iscfibroad2013_koodi = '06' or d9a.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7a.iscfibroad2013_koodi = '06' or d8a.iscfibroad2013_koodi = '06' or d9a.iscfibroad2013_koodi = '06' or d10a.iscfibroad2013_koodi = '06') then 1*/
	else 0
end as opisk_amk_koulala6
--Opiskellut koulutusala7 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1a.iscfibroad2013_koodi = '07' or d2a.iscfibroad2013_koodi = '07' or d3a.iscfibroad2013_koodi = '07' or d4a.iscfibroad2013_koodi = '07') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2a.iscfibroad2013_koodi = '07' or d3a.iscfibroad2013_koodi = '07' or d4a.iscfibroad2013_koodi = '07' or d5a.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3a.iscfibroad2013_koodi = '07' or d4a.iscfibroad2013_koodi = '07' or d5a.iscfibroad2013_koodi = '07' or d6a.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4a.iscfibroad2013_koodi = '07' or d5a.iscfibroad2013_koodi = '07' or d6a.iscfibroad2013_koodi = '07' or d7a.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5a.iscfibroad2013_koodi = '07' or d6a.iscfibroad2013_koodi = '07' or d7a.iscfibroad2013_koodi = '07' or d8a.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6a.iscfibroad2013_koodi = '07' or d7a.iscfibroad2013_koodi = '07' or d8a.iscfibroad2013_koodi = '07' or d9a.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7a.iscfibroad2013_koodi = '07' or d8a.iscfibroad2013_koodi = '07' or d9a.iscfibroad2013_koodi = '07' or d10a.iscfibroad2013_koodi = '07') then 1*/
	else 0
end as opisk_amk_koulala7
--Opiskellut koulutusala8 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1a.iscfibroad2013_koodi = '08' or d2a.iscfibroad2013_koodi = '08' or d3a.iscfibroad2013_koodi = '08' or d4a.iscfibroad2013_koodi = '08') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2a.iscfibroad2013_koodi = '08' or d3a.iscfibroad2013_koodi = '08' or d4a.iscfibroad2013_koodi = '08' or d5a.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3a.iscfibroad2013_koodi = '08' or d4a.iscfibroad2013_koodi = '08' or d5a.iscfibroad2013_koodi = '08' or d6a.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4a.iscfibroad2013_koodi = '08' or d5a.iscfibroad2013_koodi = '08' or d6a.iscfibroad2013_koodi = '08' or d7a.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5a.iscfibroad2013_koodi = '08' or d6a.iscfibroad2013_koodi = '08' or d7a.iscfibroad2013_koodi = '08' or d8a.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6a.iscfibroad2013_koodi = '08' or d7a.iscfibroad2013_koodi = '08' or d8a.iscfibroad2013_koodi = '08' or d9a.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7a.iscfibroad2013_koodi = '08' or d8a.iscfibroad2013_koodi = '08' or d9a.iscfibroad2013_koodi = '08' or d10a.iscfibroad2013_koodi = '08') then 1*/
	else 0
end as opisk_amk_koulala8
--Opiskellut koulutusala9 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1a.iscfibroad2013_koodi = '09' or d2a.iscfibroad2013_koodi = '09' or d3a.iscfibroad2013_koodi = '09' or d4a.iscfibroad2013_koodi = '09') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2a.iscfibroad2013_koodi = '09' or d3a.iscfibroad2013_koodi = '09' or d4a.iscfibroad2013_koodi = '09' or d5a.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3a.iscfibroad2013_koodi = '09' or d4a.iscfibroad2013_koodi = '09' or d5a.iscfibroad2013_koodi = '09' or d6a.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4a.iscfibroad2013_koodi = '09' or d5a.iscfibroad2013_koodi = '09' or d6a.iscfibroad2013_koodi = '09' or d7a.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5a.iscfibroad2013_koodi = '09' or d6a.iscfibroad2013_koodi = '09' or d7a.iscfibroad2013_koodi = '09' or d8a.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6a.iscfibroad2013_koodi = '09' or d7a.iscfibroad2013_koodi = '09' or d8a.iscfibroad2013_koodi = '09' or d9a.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7a.iscfibroad2013_koodi = '09' or d8a.iscfibroad2013_koodi = '09' or d9a.iscfibroad2013_koodi = '09' or d10a.iscfibroad2013_koodi = '09') then 1*/
	else 0
end as opisk_amk_koulala9
--Opiskellut koulutusala10 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1a.iscfibroad2013_koodi = '10' or d2a.iscfibroad2013_koodi = '10' or d3a.iscfibroad2013_koodi = '10' or d4a.iscfibroad2013_koodi = '10') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2a.iscfibroad2013_koodi = '10' or d3a.iscfibroad2013_koodi = '10' or d4a.iscfibroad2013_koodi = '10' or d5a.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3a.iscfibroad2013_koodi = '10' or d4a.iscfibroad2013_koodi = '10' or d5a.iscfibroad2013_koodi = '10' or d6a.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4a.iscfibroad2013_koodi = '10' or d5a.iscfibroad2013_koodi = '10' or d6a.iscfibroad2013_koodi = '10' or d7a.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5a.iscfibroad2013_koodi = '10' or d6a.iscfibroad2013_koodi = '10' or d7a.iscfibroad2013_koodi = '10' or d8a.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6a.iscfibroad2013_koodi = '10' or d7a.iscfibroad2013_koodi = '10' or d8a.iscfibroad2013_koodi = '10' or d9a.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7a.iscfibroad2013_koodi = '10' or d8a.iscfibroad2013_koodi = '10' or d9a.iscfibroad2013_koodi = '10' or d10a.iscfibroad2013_koodi = '10') then 1*/
	else 0
end as opisk_amk_koulala10



--Opiskellut koulutusala1 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1b.iscfibroad2013_koodi = '01' or d2b.iscfibroad2013_koodi = '01' or d3b.iscfibroad2013_koodi = '01' or d4b.iscfibroad2013_koodi = '01') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2b.iscfibroad2013_koodi = '01' or d3b.iscfibroad2013_koodi = '01' or d4b.iscfibroad2013_koodi = '01' or d5b.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3b.iscfibroad2013_koodi = '01' or d4b.iscfibroad2013_koodi = '01' or d5b.iscfibroad2013_koodi = '01' or d6b.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4b.iscfibroad2013_koodi = '01' or d5b.iscfibroad2013_koodi = '01' or d6b.iscfibroad2013_koodi = '01' or d7b.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5b.iscfibroad2013_koodi = '01' or d6b.iscfibroad2013_koodi = '01' or d7b.iscfibroad2013_koodi = '01' or d8b.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6b.iscfibroad2013_koodi = '01' or d7b.iscfibroad2013_koodi = '01' or d8b.iscfibroad2013_koodi = '01' or d9b.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7b.iscfibroad2013_koodi = '01' or d8b.iscfibroad2013_koodi = '01' or d9b.iscfibroad2013_koodi = '01' or d10b.iscfibroad2013_koodi = '01') then 1*/
	else 0
end as opisk_yo_koulala1
--Opiskellut koulutusala2 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1b.iscfibroad2013_koodi = '02' or d2b.iscfibroad2013_koodi = '02' or d3b.iscfibroad2013_koodi = '02' or d4b.iscfibroad2013_koodi = '02') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2b.iscfibroad2013_koodi = '02' or d3b.iscfibroad2013_koodi = '02' or d4b.iscfibroad2013_koodi = '02' or d5b.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3b.iscfibroad2013_koodi = '02' or d4b.iscfibroad2013_koodi = '02' or d5b.iscfibroad2013_koodi = '02' or d6b.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4b.iscfibroad2013_koodi = '02' or d5b.iscfibroad2013_koodi = '02' or d6b.iscfibroad2013_koodi = '02' or d7b.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5b.iscfibroad2013_koodi = '02' or d6b.iscfibroad2013_koodi = '02' or d7b.iscfibroad2013_koodi = '02' or d8b.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6b.iscfibroad2013_koodi = '02' or d7b.iscfibroad2013_koodi = '02' or d8b.iscfibroad2013_koodi = '02' or d9b.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7b.iscfibroad2013_koodi = '02' or d8b.iscfibroad2013_koodi = '02' or d9b.iscfibroad2013_koodi = '02' or d10b.iscfibroad2013_koodi = '02') then 1*/
	else 0
end as opisk_yo_koulala2
--Opiskellut koulutusala3 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1b.iscfibroad2013_koodi = '03' or d2b.iscfibroad2013_koodi = '03' or d3b.iscfibroad2013_koodi = '03' or d4b.iscfibroad2013_koodi = '03') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2b.iscfibroad2013_koodi = '03' or d3b.iscfibroad2013_koodi = '03' or d4b.iscfibroad2013_koodi = '03' or d5b.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3b.iscfibroad2013_koodi = '03' or d4b.iscfibroad2013_koodi = '03' or d5b.iscfibroad2013_koodi = '03' or d6b.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4b.iscfibroad2013_koodi = '03' or d5b.iscfibroad2013_koodi = '03' or d6b.iscfibroad2013_koodi = '03' or d7b.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5b.iscfibroad2013_koodi = '03' or d6b.iscfibroad2013_koodi = '03' or d7b.iscfibroad2013_koodi = '03' or d8b.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6b.iscfibroad2013_koodi = '03' or d7b.iscfibroad2013_koodi = '03' or d8b.iscfibroad2013_koodi = '03' or d9b.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7b.iscfibroad2013_koodi = '03' or d8b.iscfibroad2013_koodi = '03' or d9b.iscfibroad2013_koodi = '03' or d10b.iscfibroad2013_koodi = '03') then 1*/
	else 0
end as opisk_yo_koulala3
--Opiskellut koulutusala4 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1b.iscfibroad2013_koodi = '04' or d2b.iscfibroad2013_koodi = '04' or d3b.iscfibroad2013_koodi = '04' or d4b.iscfibroad2013_koodi = '04') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2b.iscfibroad2013_koodi = '04' or d3b.iscfibroad2013_koodi = '04' or d4b.iscfibroad2013_koodi = '04' or d5b.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3b.iscfibroad2013_koodi = '04' or d4b.iscfibroad2013_koodi = '04' or d5b.iscfibroad2013_koodi = '04' or d6b.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4b.iscfibroad2013_koodi = '04' or d5b.iscfibroad2013_koodi = '04' or d6b.iscfibroad2013_koodi = '04' or d7b.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5b.iscfibroad2013_koodi = '04' or d6b.iscfibroad2013_koodi = '04' or d7b.iscfibroad2013_koodi = '04' or d8b.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6b.iscfibroad2013_koodi = '04' or d7b.iscfibroad2013_koodi = '04' or d8b.iscfibroad2013_koodi = '04' or d9b.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7b.iscfibroad2013_koodi = '04' or d8b.iscfibroad2013_koodi = '04' or d9b.iscfibroad2013_koodi = '04' or d10b.iscfibroad2013_koodi = '04') then 1*/
	else 0
end as opisk_yo_koulala4
--Opiskellut koulutusala5 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1b.iscfibroad2013_koodi = '05' or d2b.iscfibroad2013_koodi = '05' or d3b.iscfibroad2013_koodi = '05' or d4b.iscfibroad2013_koodi = '05') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2b.iscfibroad2013_koodi = '05' or d3b.iscfibroad2013_koodi = '05' or d4b.iscfibroad2013_koodi = '05' or d5b.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3b.iscfibroad2013_koodi = '05' or d4b.iscfibroad2013_koodi = '05' or d5b.iscfibroad2013_koodi = '05' or d6b.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4b.iscfibroad2013_koodi = '05' or d5b.iscfibroad2013_koodi = '05' or d6b.iscfibroad2013_koodi = '05' or d7b.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5b.iscfibroad2013_koodi = '05' or d6b.iscfibroad2013_koodi = '05' or d7b.iscfibroad2013_koodi = '05' or d8b.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6b.iscfibroad2013_koodi = '05' or d7b.iscfibroad2013_koodi = '05' or d8b.iscfibroad2013_koodi = '05' or d9b.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7b.iscfibroad2013_koodi = '05' or d8b.iscfibroad2013_koodi = '05' or d9b.iscfibroad2013_koodi = '05' or d10b.iscfibroad2013_koodi = '05') then 1*/
	else 0
end as opisk_yo_koulala5
--Opiskellut koulutusala6 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1b.iscfibroad2013_koodi = '06' or d2b.iscfibroad2013_koodi = '06' or d3b.iscfibroad2013_koodi = '06' or d4b.iscfibroad2013_koodi = '06') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2b.iscfibroad2013_koodi = '06' or d3b.iscfibroad2013_koodi = '06' or d4b.iscfibroad2013_koodi = '06' or d5b.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3b.iscfibroad2013_koodi = '06' or d4b.iscfibroad2013_koodi = '06' or d5b.iscfibroad2013_koodi = '06' or d6b.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4b.iscfibroad2013_koodi = '06' or d5b.iscfibroad2013_koodi = '06' or d6b.iscfibroad2013_koodi = '06' or d7b.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5b.iscfibroad2013_koodi = '06' or d6b.iscfibroad2013_koodi = '06' or d7b.iscfibroad2013_koodi = '06' or d8b.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6b.iscfibroad2013_koodi = '06' or d7b.iscfibroad2013_koodi = '06' or d8b.iscfibroad2013_koodi = '06' or d9b.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7b.iscfibroad2013_koodi = '06' or d8b.iscfibroad2013_koodi = '06' or d9b.iscfibroad2013_koodi = '06' or d10b.iscfibroad2013_koodi = '06') then 1*/
	else 0
end as opisk_yo_koulala6
--Opiskellut koulutusala7 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1b.iscfibroad2013_koodi = '07' or d2b.iscfibroad2013_koodi = '07' or d3b.iscfibroad2013_koodi = '07' or d4b.iscfibroad2013_koodi = '07') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2b.iscfibroad2013_koodi = '07' or d3b.iscfibroad2013_koodi = '07' or d4b.iscfibroad2013_koodi = '07' or d5b.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3b.iscfibroad2013_koodi = '07' or d4b.iscfibroad2013_koodi = '07' or d5b.iscfibroad2013_koodi = '07' or d6b.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4b.iscfibroad2013_koodi = '07' or d5b.iscfibroad2013_koodi = '07' or d6b.iscfibroad2013_koodi = '07' or d7b.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5b.iscfibroad2013_koodi = '07' or d6b.iscfibroad2013_koodi = '07' or d7b.iscfibroad2013_koodi = '07' or d8b.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6b.iscfibroad2013_koodi = '07' or d7b.iscfibroad2013_koodi = '07' or d8b.iscfibroad2013_koodi = '07' or d9b.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7b.iscfibroad2013_koodi = '07' or d8b.iscfibroad2013_koodi = '07' or d9b.iscfibroad2013_koodi = '07' or d10b.iscfibroad2013_koodi = '07') then 1*/
	else 0
end as opisk_yo_koulala7
--Opiskellut koulutusala8 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1b.iscfibroad2013_koodi = '08' or d2b.iscfibroad2013_koodi = '08' or d3b.iscfibroad2013_koodi = '08' or d4b.iscfibroad2013_koodi = '08') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2b.iscfibroad2013_koodi = '08' or d3b.iscfibroad2013_koodi = '08' or d4b.iscfibroad2013_koodi = '08' or d5b.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3b.iscfibroad2013_koodi = '08' or d4b.iscfibroad2013_koodi = '08' or d5b.iscfibroad2013_koodi = '08' or d6b.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4b.iscfibroad2013_koodi = '08' or d5b.iscfibroad2013_koodi = '08' or d6b.iscfibroad2013_koodi = '08' or d7b.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5b.iscfibroad2013_koodi = '08' or d6b.iscfibroad2013_koodi = '08' or d7b.iscfibroad2013_koodi = '08' or d8b.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6b.iscfibroad2013_koodi = '08' or d7b.iscfibroad2013_koodi = '08' or d8b.iscfibroad2013_koodi = '08' or d9b.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7b.iscfibroad2013_koodi = '08' or d8b.iscfibroad2013_koodi = '08' or d9b.iscfibroad2013_koodi = '08' or d10b.iscfibroad2013_koodi = '08') then 1*/
	else 0
end as opisk_yo_koulala8
--Opiskellut koulutusala9 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1b.iscfibroad2013_koodi = '09' or d2b.iscfibroad2013_koodi = '09' or d3b.iscfibroad2013_koodi = '09' or d4b.iscfibroad2013_koodi = '09') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2b.iscfibroad2013_koodi = '09' or d3b.iscfibroad2013_koodi = '09' or d4b.iscfibroad2013_koodi = '09' or d5b.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3b.iscfibroad2013_koodi = '09' or d4b.iscfibroad2013_koodi = '09' or d5b.iscfibroad2013_koodi = '09' or d6b.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4b.iscfibroad2013_koodi = '09' or d5b.iscfibroad2013_koodi = '09' or d6b.iscfibroad2013_koodi = '09' or d7b.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5b.iscfibroad2013_koodi = '09' or d6b.iscfibroad2013_koodi = '09' or d7b.iscfibroad2013_koodi = '09' or d8b.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6b.iscfibroad2013_koodi = '09' or d7b.iscfibroad2013_koodi = '09' or d8b.iscfibroad2013_koodi = '09' or d9b.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7b.iscfibroad2013_koodi = '09' or d8b.iscfibroad2013_koodi = '09' or d9b.iscfibroad2013_koodi = '09' or d10b.iscfibroad2013_koodi = '09') then 1*/
	else 0
end as opisk_yo_koulala9
--Opiskellut koulutusala10 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1b.iscfibroad2013_koodi = '10' or d2b.iscfibroad2013_koodi = '10' or d3b.iscfibroad2013_koodi = '10' or d4b.iscfibroad2013_koodi = '10') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2b.iscfibroad2013_koodi = '10' or d3b.iscfibroad2013_koodi = '10' or d4b.iscfibroad2013_koodi = '10' or d5b.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3b.iscfibroad2013_koodi = '10' or d4b.iscfibroad2013_koodi = '10' or d5b.iscfibroad2013_koodi = '10' or d6b.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4b.iscfibroad2013_koodi = '10' or d5b.iscfibroad2013_koodi = '10' or d6b.iscfibroad2013_koodi = '10' or d7b.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5b.iscfibroad2013_koodi = '10' or d6b.iscfibroad2013_koodi = '10' or d7b.iscfibroad2013_koodi = '10' or d8b.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6b.iscfibroad2013_koodi = '10' or d7b.iscfibroad2013_koodi = '10' or d8b.iscfibroad2013_koodi = '10' or d9b.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7b.iscfibroad2013_koodi = '10' or d8b.iscfibroad2013_koodi = '10' or d9b.iscfibroad2013_koodi = '10' or d10b.iscfibroad2013_koodi = '10') then 1*/
	else 0
end as opisk_yo_koulala10


--Opiskellut useampaa kuin yhtä alaa (taso 1) (kyllä/ei)
,case --ensimmäisenä vuotena on mahdollista olla vain yksi ala
	when  l.suorlk = '2' and m1.MinValue <> m1.MaxValue then 1 
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and m2.MinValue <> m2.MaxValue then 1 
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and m3.MinValue <> m3.MaxValue then 1 
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and m4.MinValue <> m4.MaxValue then 1 
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and m5.MinValue <> m5.MaxValue then 1 
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and m6.MinValue <> m6.MaxValue then 1 
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and m7.MinValue <> m7.MaxValue then 1 */
	else 0
end as opisk_vah2_koulala


----HAUT KYLLÄ/EI
--Hakenut ammatilliseen koulutukseen
,case
	when  l.suorlk = '2' and (l.monihaku_1 in (2,3,5) or l.monihaku_2 in (2,3,5) or l.monihaku_3 in (2,3,5) or l.monihaku_4 in (2,3,5)) then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.monihaku_2 in (2,3,5) or l.monihaku_3 in (2,3,5) or l.monihaku_4 in (2,3,5) or l.monihaku2008 in (2,3,5)) then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.monihaku_3 in (2,3,5) or l.monihaku_4 in (2,3,5) or l.monihaku2008 in (2,3,5) or l.monihaku2009 in (2,3,5)) then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.monihaku_4 in (2,3,5) or l.monihaku2008 in (2,3,5) or l.monihaku2009 in (2,3,5) or l.monihaku2010 in (2,3,5)) then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.monihaku2008 in (2,3,5) or l.monihaku2009 in (2,3,5) or l.monihaku2010 in (2,3,5) or l.monihaku2011 in (2,3,5)) then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.monihaku2009 in (2,3,5) or l.monihaku2010 in (2,3,5) or l.monihaku2011 in (2,3,5) or l.monihaku2012 in (2,3,5)) then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.monihaku2010 in (2,3,5) or l.monihaku2011 in (2,3,5) or l.monihaku2012 in (2,3,5) or l.monihaku2013 in (2,3,5)) then 1*/
	else 0
end as haku_amm
--Hakenut ammattikorkeakoulutukseen
,case
	when  l.suorlk = '2' and (l.monihaku_1 in (4,6) or l.monihaku_2 in (4,6) or l.monihaku_3 in (4,6) or l.monihaku_4 in (4,6)) then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.monihaku_2 in (4,6) or l.monihaku_3 in (4,6) or l.monihaku_4 in (4,6) or l.monihaku2008 in (4,6)) then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.monihaku_3 in (4,6) or l.monihaku_4 in (4,6) or l.monihaku2008 in (4,6) or l.monihaku2009 in (4,6)) then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.monihaku_4 in (4,6) or l.monihaku2008 in (4,6) or l.monihaku2009 in (4,6) or l.monihaku2010 in (4,6)) then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.monihaku2008 in (4,6) or l.monihaku2009 in (4,6) or l.monihaku2010 in (4,6) or l.monihaku2011 in (4,6)) then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.monihaku2009 in (4,6) or l.monihaku2010 in (4,6) or l.monihaku2011 in (4,6) or l.monihaku2012 in (4,6)) then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.monihaku2010 in (4,6) or l.monihaku2011 in (4,6) or l.monihaku2012 in (4,6) or l.monihaku2013 in (4,6)) then 1*/
	else 0
end as haku_amk
--Hakenut yliopistokoulutukseen
,case
	when  l.suorlk = '2' and (l.monihaku_1 in (6,7) or l.monihaku_2 in (6,7) or l.monihaku_3 in (6,7) or l.monihaku_4 in (6,7)) then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.monihaku_2 in (6,7) or l.monihaku_3 in (6,7) or l.monihaku_4 in (6,7) or l.monihaku2008 in (6,7)) then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.monihaku_3 in (6,7) or l.monihaku_4 in (6,7) or l.monihaku2008 in (6,7) or l.monihaku2009 in (6,7)) then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.monihaku_4 in (6,7) or l.monihaku2008 in (6,7) or l.monihaku2009 in (6,7) or l.monihaku2010 in (6,7)) then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.monihaku2008 in (6,7) or l.monihaku2009 in (6,7) or l.monihaku2010 in (6,7) or l.monihaku2011 in (6,7)) then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.monihaku2009 in (6,7) or l.monihaku2010 in (6,7) or l.monihaku2011 in (6,7) or l.monihaku2012 in (6,7)) then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.monihaku2010 in (6,7) or l.monihaku2011 in (6,7) or l.monihaku2012 in (6,7) or l.monihaku2013 in (6,7)) then 1*/
	else 0
end as haku_yo




----MITTARIT
--Ei hakenut eikä opiskellut mitään
,case
	when  l.suorlk = '2' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and l.luopiskkoulk_1 = '' and l.ammopiskkoulk_1 = '' and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and monihaku_4 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1*/
	else 0
end eihaku_kk_eiopisk

--Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa
,case 
	when  l.suorlk = '2' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and (l.luopiskkoulk_1 <> '' or l.ammopiskkoulk_1 <> '' or l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and (l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '' or l.luopiskkoulk2008 <> '' or l.ammopiskkoulk2008 <> '') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and (l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '' or l.luopiskkoulk2008 <> '' or l.ammopiskkoulk2008 <> '' or l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '') and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and monihaku_4 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and (l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '' or l.luopiskkoulk2008 <> '' or l.ammopiskkoulk2008 <> '' or l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '') and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and (l.luopiskkoulk2008 <> '' or l.ammopiskkoulk2008 <> '' or l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '') and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and (l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '') and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and (l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '' or l.ammopiskkoulk2013 <> '') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1*/
	else 0
end eihaku_kk_eiopisk_kk_opisk_ta

----Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa, opiskellut lukiokoulutuksessa
,case 
	when  l.suorlk = '2' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and (l.luopiskkoulk_1 <> '' or l.luopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and (l.luopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.luopiskkoulk2008 <> '') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and (l.luopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.luopiskkoulk2008 <> '' or l.luopiskkoulk2009 <> '') and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and monihaku_4 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and (l.luopiskkoulk_4 <> '' or l.luopiskkoulk2008 <> '' or l.luopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '') and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and (l.luopiskkoulk2008 <> '' or l.luopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '') and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and (l.luopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '') and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and (l.luopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1*/
	else 0
end eihaku_kk_eiopisk_kk_opisk_lu

----Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa, opiskellut ammatillisessa peruskoulutuksessa
,case 
	when  l.suorlk = '2' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and (d1c.Koulutusaste_taso2_koodi = '32' or d2c.Koulutusaste_taso2_koodi = '32' or d3c.Koulutusaste_taso2_koodi = '32' or d4c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and (d2c.Koulutusaste_taso2_koodi = '32' or d3c.Koulutusaste_taso2_koodi = '32' or d4c.Koulutusaste_taso2_koodi = '32' or d5c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and (d3c.Koulutusaste_taso2_koodi = '32' or d4c.Koulutusaste_taso2_koodi = '32' or d5c.Koulutusaste_taso2_koodi = '32' or d6c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and monihaku_4 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and (d4c.Koulutusaste_taso2_koodi = '32' or d5c.Koulutusaste_taso2_koodi = '32' or d6c.Koulutusaste_taso2_koodi = '32' or d7c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and (d5c.Koulutusaste_taso2_koodi = '32' or d6c.Koulutusaste_taso2_koodi = '32' or d7c.Koulutusaste_taso2_koodi = '32' or d8c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and (d6c.Koulutusaste_taso2_koodi = '32' or d7c.Koulutusaste_taso2_koodi = '32' or d8c.Koulutusaste_taso2_koodi = '32' or d9c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and (d7c.Koulutusaste_taso2_koodi = '32' or d8c.Koulutusaste_taso2_koodi = '32' or d9c.Koulutusaste_taso2_koodi = '32' or d10c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1*/
	else 0
end eihaku_kk_eiopisk_kk_opisk_pk

------Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa, opiskellut ammattitutkintokoulutuksessa
,case 
	when  l.suorlk = '2' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and (d1c.Koulutusaste_taso2_koodi = '33' or d2c.Koulutusaste_taso2_koodi = '33' or d3c.Koulutusaste_taso2_koodi = '33' or d4c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and (d2c.Koulutusaste_taso2_koodi = '33' or d3c.Koulutusaste_taso2_koodi = '33' or d4c.Koulutusaste_taso2_koodi = '33' or d5c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and (d3c.Koulutusaste_taso2_koodi = '33' or d4c.Koulutusaste_taso2_koodi = '33' or d5c.Koulutusaste_taso2_koodi = '33' or d6c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and monihaku_4 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and (d4c.Koulutusaste_taso2_koodi = '33' or d5c.Koulutusaste_taso2_koodi = '33' or d6c.Koulutusaste_taso2_koodi = '33' or d7c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and (d5c.Koulutusaste_taso2_koodi = '33' or d6c.Koulutusaste_taso2_koodi = '33' or d7c.Koulutusaste_taso2_koodi = '33' or d8c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and (d6c.Koulutusaste_taso2_koodi = '33' or d7c.Koulutusaste_taso2_koodi = '33' or d8c.Koulutusaste_taso2_koodi = '33' or d9c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and (d7c.Koulutusaste_taso2_koodi = '33' or d8c.Koulutusaste_taso2_koodi = '33' or d9c.Koulutusaste_taso2_koodi = '33' or d10c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1*/
	else 0
end eihaku_kk_eiopisk_kk_opisk_at

------Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa, opiskellut erikoisammattitutkintokoulutuksessa
,case 
	when  l.suorlk = '2' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and (d1c.Koulutusaste_taso2_koodi = '41' or d2c.Koulutusaste_taso2_koodi = '41' or d3c.Koulutusaste_taso2_koodi = '41' or d4c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and (d2c.Koulutusaste_taso2_koodi = '41' or d3c.Koulutusaste_taso2_koodi = '41' or d4c.Koulutusaste_taso2_koodi = '41' or d5c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and (d3c.Koulutusaste_taso2_koodi = '41' or d4c.Koulutusaste_taso2_koodi = '41' or d5c.Koulutusaste_taso2_koodi = '41' or d6c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and monihaku_4 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and (d4c.Koulutusaste_taso2_koodi = '41' or d5c.Koulutusaste_taso2_koodi = '41' or d6c.Koulutusaste_taso2_koodi = '41' or d7c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and (d5c.Koulutusaste_taso2_koodi = '41' or d6c.Koulutusaste_taso2_koodi = '41' or d7c.Koulutusaste_taso2_koodi = '41' or d8c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and (d6c.Koulutusaste_taso2_koodi = '41' or d7c.Koulutusaste_taso2_koodi = '41' or d8c.Koulutusaste_taso2_koodi = '41' or d9c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and (d7c.Koulutusaste_taso2_koodi = '41' or d8c.Koulutusaste_taso2_koodi = '41' or d9c.Koulutusaste_taso2_koodi = '41' or d10c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1*/
	else 0
end eihaku_kk_eiopisk_kk_opisk_eat

--Hakenut korkea-asteelle, ei opiskellut korkea-asteella
,case 
	when  l.suorlk = '2' and (monihaku_1 in (4,5,6,7) or monihaku_2 in (4,5,6,7) or monihaku_3 in (4,5,6,7) or monihaku_4 in (4,5,6,7)) and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (monihaku_2 in (4,5,6,7) or monihaku_3 in (4,5,6,7) or monihaku_4 in (4,5,6,7) or monihaku2008 in (4,5,6,7)) and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (monihaku_3 in (4,5,6,7) or monihaku_4 in (4,5,6,7) or monihaku2008 in (4,5,6,7) or monihaku2009 in (4,5,6,7)) and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (monihaku_4 in (4,5,6,7) or monihaku2008 in (4,5,6,7) or monihaku2009 in (4,5,6,7) or monihaku2010 in (4,5,6,7)) and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (monihaku2008 in (4,5,6,7) or monihaku2009 in (4,5,6,7) or monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7)) and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (monihaku2009 in (4,5,6,7) or monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7) or monihaku2012 in (4,5,6,7)) and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7) or monihaku2012 in (4,5,6,7) or monihaku2013 in (4,5,6,7)) and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1*/
	else 0
end haku_kk_eiopisk_kk
----Hakenut korkea-asteelle, ei opiskellut korkea-asteella, ei-opiskellut toisen asteen koulutuksessa
,case
	when  l.suorlk = '2' and (monihaku_1 in (4,5,6,7) or monihaku_2 in (4,5,6,7) or monihaku_3 in (4,5,6,7) or monihaku_4 in (4,5,6,7)) and l.luopiskkoulk_1 = '' and l.ammopiskkoulk_1 = '' and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (monihaku_2 in (4,5,6,7) or monihaku_3 in (4,5,6,7) or monihaku_4 in (4,5,6,7) or monihaku2008 in (4,5,6,7)) and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (monihaku_3 in (4,5,6,7) or monihaku_4 in (4,5,6,7) or monihaku2008 in (4,5,6,7) or monihaku2009 in (4,5,6,7)) and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (monihaku_4 in (4,5,6,7) or monihaku2008 in (4,5,6,7) or monihaku2009 in (4,5,6,7) or monihaku2010 in (4,5,6,7)) and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (monihaku2008 in (4,5,6,7) or monihaku2009 in (4,5,6,7) or monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7)) and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (monihaku2009 in (4,5,6,7) or monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7) or monihaku2012 in (4,5,6,7)) and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7) or monihaku2012 in (4,5,6,7) or monihaku2013 in (4,5,6,7)) and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1*/
	else 0
end haku_kk_eiopisk_kk_eiopisk_ta
----Hakenut korkea-asteelle, ei opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa
,case
	when  l.suorlk = '2' and (monihaku_1 in (4,5,6,7) or monihaku_2 in (4,5,6,7) or monihaku_3 in (4,5,6,7) or monihaku_4 in (4,5,6,7)) and (l.luopiskkoulk_1 <> '' or l.ammopiskkoulk_1 <> '' or l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (monihaku_2 in (4,5,6,7) or monihaku_3 in (4,5,6,7) or monihaku_4 in (4,5,6,7) or monihaku2008 in (4,5,6,7)) and (l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '' or l.luopiskkoulk2008 <> '' or l.ammopiskkoulk2008 <> '') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (monihaku_3 in (4,5,6,7) or monihaku_4 in (4,5,6,7) or monihaku2008 in (4,5,6,7) or monihaku2009 in (4,5,6,7)) and (l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '' or l.luopiskkoulk2008 <> '' or l.ammopiskkoulk2008 <> '' or l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '') and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (monihaku_4 in (4,5,6,7) or monihaku2008 in (4,5,6,7) or monihaku2009 in (4,5,6,7) or monihaku2010 in (4,5,6,7)) and (l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '' or l.luopiskkoulk2008 <> '' or l.ammopiskkoulk2008 <> '' or l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '') and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (monihaku2008 in (4,5,6,7) or monihaku2009 in (4,5,6,7) or monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7)) and (l.luopiskkoulk2008 <> '' or l.ammopiskkoulk2008 <> '' or l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '') and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (monihaku2009 in (4,5,6,7) or monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7) or monihaku2012 in (4,5,6,7)) and (l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '') and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7) or monihaku2012 in (4,5,6,7) or monihaku2013 in (4,5,6,7)) and (l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '' or l.ammopiskkoulk2013 <> '') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1*/
	else 0
end haku_kk_eiopisk_kk_opisk_ta
----Hakenut vain ammattikorkeakouluun, ei opiskellut korkea-asteella
,case
	when  l.suorlk = '2' and (monihaku_1 = 4 or monihaku_2 = 4 or monihaku_3 = 4 or monihaku_4 = 4) and (monihaku_1 not in (5,6,7) and monihaku_2 not in (5,6,7) and monihaku_3 not in (5,6,7) and monihaku_4 not in (5,6,7)) and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (monihaku_2 = 4 or monihaku_3 = 4 or monihaku_4 = 4 or monihaku2008 = 4) and (monihaku_2 not in (5,6,7) and monihaku_3 not in (5,6,7) and monihaku_4 not in (5,6,7) and monihaku2008 not in (5,6,7)) and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (monihaku_3 = 4 or monihaku_4 = 4 or monihaku2008 = 4 or monihaku2009 = 4) and (monihaku_3 not in (5,6,7) and monihaku_4 not in (5,6,7) and monihaku2008 not in (5,6,7) and monihaku2009 not in (5,6,7)) and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (monihaku_4 = 4 or monihaku2008 = 4 or monihaku2009 = 4 or monihaku2010 = 4) and (monihaku_4 not in (5,6,7) and monihaku2008 not in (5,6,7) and monihaku2009 not in (5,6,7) and monihaku2010 not in (5,6,7)) and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (monihaku2008 = 4 or monihaku2009 = 4 or monihaku2010 = 4 or monihaku2011 = 4) and (monihaku2008 not in (5,6,7) and monihaku2009 not in (5,6,7) and monihaku2010 not in (5,6,7) and monihaku2011 not in (5,6,7)) and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (monihaku2009 = 4 or monihaku2010 = 4 or monihaku2011 = 4 or monihaku2012 = 4) and (monihaku2009 not in (5,6,7) and monihaku2010 not in (5,6,7) and monihaku2011 not in (5,6,7) and monihaku2012 not in (5,6,7)) and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (monihaku2010 = 4 or monihaku2011 = 4 or monihaku2012 = 4 or monihaku2013 = 4) and (monihaku2010 not in (5,6,7) and monihaku2011 not in (5,6,7) and monihaku2012 not in (5,6,7) and monihaku2013 not in (5,6,7)) and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1*/
	else 0
end haku_amk_eiopisk_kk
----Hakenut vain yliopistokoulutukseen, ei opiskellut korkea-asteella
,case
	when  l.suorlk = '2' and (monihaku_1 = 7 or monihaku_2 = 7 or monihaku_3 = 7 or monihaku_4 = 7) and (monihaku_1 not in (4,5,6) and monihaku_2 not in (4,5,6) and monihaku_3 not in (4,5,6) and monihaku_4 not in (4,5,6)) and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (monihaku_2 = 7 or monihaku_3 = 7 or monihaku_4 = 7 or monihaku2008 = 7) and (monihaku_2 not in (4,5,6) and monihaku_3 not in (4,5,6) and monihaku_4 not in (4,5,6) and monihaku2008 not in (4,5,6)) and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (monihaku_3 = 7 or monihaku_4 = 7 or monihaku2008 = 7 or monihaku2009 = 7) and (monihaku_3 not in (4,5,6) and monihaku_4 not in (4,5,6) and monihaku2008 not in (4,5,6) and monihaku2009 not in (4,5,6)) and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (monihaku_4 = 7 or monihaku2008 = 7 or monihaku2009 = 7 or monihaku2010 = 7) and (monihaku_4 not in (4,5,6) and monihaku2008 not in (4,5,6) and monihaku2009 not in (4,5,6) and monihaku2010 not in (4,5,6)) and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (monihaku2008 = 7 or monihaku2009 = 7 or monihaku2010 = 7 or monihaku2011 = 7) and (monihaku2008 not in (4,5,6) and monihaku2009 not in (4,5,6) and monihaku2010 not in (4,5,6) and monihaku2011 not in (4,5,6)) and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (monihaku2009 = 7 or monihaku2010 = 7 or monihaku2011 = 7 or monihaku2012 = 7) and (monihaku2009 not in (4,5,6) and monihaku2010 not in (4,5,6) and monihaku2011 not in (4,5,6) and monihaku2012 not in (4,5,6)) and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (monihaku2010 = 7 or monihaku2011 = 7 or monihaku2012 = 7 or monihaku2013 = 7) and (monihaku2010 not in (4,5,6) and monihaku2011 not in (4,5,6) and monihaku2012 not in (4,5,6) and monihaku2013 not in (4,5,6)) and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1*/
	else 0
end haku_yo_eiopisk_kk
----Hakenut sekä amk- että yliopistokoulutukseen, ei opiskellut korkea-asteella
,case
	when  l.suorlk = '2' and (monihaku_1 = 6 or monihaku_2 = 6 or monihaku_3 = 6 or monihaku_4 = 6 or ((monihaku_1 = 4 or monihaku_2 = 4 or monihaku_3 = 4 or monihaku_4 = 4) and (monihaku_1 = 7 or monihaku_2 = 7 or monihaku_3 = 7 or monihaku_4 = 7))) and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (monihaku_2 = 6 or monihaku_3 = 6 or monihaku_4 = 6 or monihaku2008 = 6 or ((monihaku_2 = 4 or monihaku_3 = 4 or monihaku_4 = 4 or monihaku2008 = 4) and (monihaku_2 = 7 or monihaku_3 = 7 or monihaku_4 = 7 or monihaku2008 = 7))) and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (monihaku_3 = 6 or monihaku_4 = 6 or monihaku2008 = 6 or monihaku2009 = 6 or ((monihaku_3 = 4 or monihaku_4 = 4 or monihaku2008 = 4 or monihaku2009 = 4) and (monihaku_3 = 7 or monihaku_4 = 7 or monihaku2008 = 7 or monihaku2009 = 7))) and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (monihaku_4 = 6 or monihaku2008 = 6 or monihaku2009 = 6 or monihaku2010 = 6 or ((monihaku_4 = 4 or monihaku2008 = 4 or monihaku2009 = 4 or monihaku2010 = 4) and (monihaku_4 = 7 or monihaku2008 = 7 or monihaku2009 = 7 or monihaku2010 = 7))) and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (monihaku2008 = 6 or monihaku2009 = 6 or monihaku2010 = 6 or monihaku2011 = 6 or ((monihaku2008 = 4 or monihaku2009 = 4 or monihaku2010 = 4 or monihaku2011 = 4) and (monihaku2008 = 7 or monihaku2009 = 7 or monihaku2010 = 7 or monihaku2011 = 7))) and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (monihaku2009 = 6 or monihaku2010 = 6 or monihaku2011 = 6 or monihaku2012 = 6 or ((monihaku2009 = 4 or monihaku2010 = 4 or monihaku2011 = 4 or monihaku2012 = 4) and (monihaku2009 = 7 or monihaku2010 = 7 or monihaku2011 = 7 or monihaku2012 = 7))) and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (monihaku2010 = 6 or monihaku2011 = 6 or monihaku2012 = 6 or monihaku2013 = 6 or ((monihaku2010 = 4 or monihaku2011 = 4 or monihaku2012 = 4 or monihaku2013 = 4) and (monihaku2010 = 7 or monihaku2011 = 7 or monihaku2012 = 7 or monihaku2013 = 7))) and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1*/
	else 0
end haku_amkyo_eiopisk_kk

--Opiskellut korkea-asteella
,case
	when  l.suorlk = '2' and (l.amkopiskkoulk_1 <> '' or l.yoopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '' or l.amkopiskkoulk2008 <> '' or l.yoopiskkoulk2008 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '' or l.amkopiskkoulk2008 <> '' or l.yoopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '' or l.amkopiskkoulk2008 <> '' or l.yoopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2008 <> '' or l.yoopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '' or l.yoopiskkoulk2013 <> '') then 1*/
	else 0
end opisk_kk
----Opiskellut korkea-asteella, ei-opiskellut toisen asteen koulutuksessa
,case
	when  l.suorlk = '2' and l.luopiskkoulk_1 = '' and l.ammopiskkoulk_1 = '' and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = ''and (l.amkopiskkoulk_1 <> '' or l.yoopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = ''and (l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '' or l.amkopiskkoulk2008 <> '' or l.yoopiskkoulk2008 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = ''and (l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '' or l.amkopiskkoulk2008 <> '' or l.yoopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = ''and (l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '' or l.amkopiskkoulk2008 <> '' or l.yoopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = ''and (l.amkopiskkoulk2008 <> '' or l.yoopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = ''and (l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = ''and (l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '' or l.yoopiskkoulk2013 <> '') then 1*/
	else 0
end opisk_kk_eiopisk_ta
----Opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa
,case
	when  l.suorlk = '2' and (l.luopiskkoulk_1 <> '' or l.ammopiskkoulk_1 <> '' or l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '') and (l.amkopiskkoulk_1 <> '' or l.yoopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '' or l.luopiskkoulk2008 <> '' or l.ammopiskkoulk2008 <> '') and (l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '' or l.amkopiskkoulk2008 <> '' or l.yoopiskkoulk2008 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '' or l.luopiskkoulk2008 <> '' or l.ammopiskkoulk2008 <> '' or l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '') and (l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '' or l.amkopiskkoulk2008 <> '' or l.yoopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '' or l.luopiskkoulk2008 <> '' or l.ammopiskkoulk2008 <> '' or l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '') and (l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '' or l.amkopiskkoulk2008 <> '' or l.yoopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk2008 <> '' or l.ammopiskkoulk2008 <> '' or l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '') and (l.amkopiskkoulk2008 <> '' or l.yoopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '') and (l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '' or l.ammopiskkoulk2013 <> '') and (l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '' or l.yoopiskkoulk2013 <> '') then 1*/
	else 0
end opisk_kk_opisk_ta
----Opiskellut vain ammattikorkeakoulussa
,case
	when  l.suorlk = '2' and (l.amkopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '') and l.yoopiskkoulk_1 = '' and l.yoopiskkoulk_2 = '' and l.yoopiskkoulk_3 = '' and l.yoopiskkoulk_4 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.amkopiskkoulk2008 <> '') and l.yoopiskkoulk_2 = '' and l.yoopiskkoulk_3 = '' and l.yoopiskkoulk_4 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.amkopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '') and l.yoopiskkoulk_3 = '' and l.yoopiskkoulk_4 = '' and l.yoopiskkoulk2008 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk_4 <> '' or l.amkopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '') and l.yoopiskkoulk_4 = '' and l.yoopiskkoulk2008 = '' and l.yoopiskkoulk2009 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '') and l.yoopiskkoulk2008 = '' and l.yoopiskkoulk2009 = '' and l.yoopiskkoulk2010 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '') and l.yoopiskkoulk2009 = '' and l.yoopiskkoulk2010 = '' and l.yoopiskkoulk2011 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '') and l.yoopiskkoulk2010 = '' and l.yoopiskkoulk2011 = '' and l.yoopiskkoulk2012 = '' and l.yoopiskkoulk2013 = '' then 1*/
	else 0
end opisk_vain_amk
----Opiskellut vain yliopistokoulutuksessa
,case
	when  l.suorlk = '2' and l.amkopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and (l.yoopiskkoulk_1 <> '' or l.yoopiskkoulk_2 <> '' or l.yoopiskkoulk_3 <> '' or l.yoopiskkoulk_4 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and l.amkopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.amkopiskkoulk2008 = '' and (l.yoopiskkoulk_2 <> '' or l.yoopiskkoulk_3 <> '' or l.yoopiskkoulk_4 <> '' or l.yoopiskkoulk2008 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and l.amkopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.amkopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and (l.yoopiskkoulk_3 <> '' or l.yoopiskkoulk_4 <> '' or l.yoopiskkoulk2008 <> '' or l.yoopiskkoulk2009 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and l.amkopiskkoulk_4 = '' and l.amkopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and (l.yoopiskkoulk_4 <> '' or l.yoopiskkoulk2008 <> '' or l.yoopiskkoulk2009 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and l.amkopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and (l.yoopiskkoulk2008 <> '' or l.yoopiskkoulk2009 <> '' or l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and l.amkopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and (l.yoopiskkoulk2009 <> '' or l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '' or l.yoopiskkoulk2012 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and l.amkopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and (l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '' or l.yoopiskkoulk2012 <> '' or l.yoopiskkoulk2013 <> '') then 1*/
	else 0
end opisk_vain_yo
----Opiskellut sekä amk- että yliopistokoulutuksessa
,case
	when  l.suorlk = '2' and (l.amkopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '') and (l.yoopiskkoulk_1 <> '' or l.yoopiskkoulk_2 <> '' or l.yoopiskkoulk_3 <> '' or l.yoopiskkoulk_4 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.amkopiskkoulk2008 <> '') and (l.yoopiskkoulk_2 <> '' or l.yoopiskkoulk_3 <> '' or l.yoopiskkoulk_4 <> '' or l.yoopiskkoulk2008 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.amkopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '') and (l.yoopiskkoulk_3 <> '' or l.yoopiskkoulk_4 <> '' or l.yoopiskkoulk2008 <> '' or l.yoopiskkoulk2009 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk_4 <> '' or l.amkopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '') and (l.yoopiskkoulk_4 <> '' or l.yoopiskkoulk2008 <> '' or l.yoopiskkoulk2009 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '') and (l.yoopiskkoulk2008 <> '' or l.yoopiskkoulk2009 <> '' or l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '') and (l.yoopiskkoulk2009 <> '' or l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '' or l.yoopiskkoulk2012 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '') and (l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '' or l.yoopiskkoulk2012 <> '' or l.yoopiskkoulk2013 <> '') then 1*/
	else 0
end opisk_amkyo

	     
FROM 
    (
	select * from [VipunenTK_SA].[dbo].[v_K3_13_Perusk_paattaneet_amm_tutk_suorittaneet]
	where suorlk = '2'
	
	) as l

LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d1a on d1a.koulutusluokitus_avain=l.amkopiskkoulk_1
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d2a on d2a.koulutusluokitus_avain=l.amkopiskkoulk_2
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d3a on d3a.koulutusluokitus_avain=l.amkopiskkoulk_3
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d4a on d4a.koulutusluokitus_avain=l.amkopiskkoulk_4
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d5a on d5a.koulutusluokitus_avain=l.amkopiskkoulk_5
/*LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d6a on d6a.koulutusluokitus_avain=l.amkopiskkoulk2009
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d7a on d7a.koulutusluokitus_avain=l.amkopiskkoulk2010
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d8a on d8a.koulutusluokitus_avain=l.amkopiskkoulk2011
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d9a on d9a.koulutusluokitus_avain=l.amkopiskkoulk2012
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d10a on d10a.koulutusluokitus_avain=l.amkopiskkoulk2013*/

LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d1b on d1b.koulutusluokitus_avain=l.yoopiskkoulk_1
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d2b on d2b.koulutusluokitus_avain=l.yoopiskkoulk_2
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d3b on d3b.koulutusluokitus_avain=l.yoopiskkoulk_3
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d4b on d4b.koulutusluokitus_avain=l.yoopiskkoulk_4
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d5b on d5b.koulutusluokitus_avain=l.yoopiskkoulk_5
/*LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d6b on d6b.koulutusluokitus_avain=l.yoopiskkoulk2009
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d7b on d7b.koulutusluokitus_avain=l.yoopiskkoulk2010
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d8b on d8b.koulutusluokitus_avain=l.yoopiskkoulk2011	
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d9b on d9b.koulutusluokitus_avain=l.yoopiskkoulk2012
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d10b on d10b.koulutusluokitus_avain=l.yoopiskkoulk2013	*/

LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d1c on d1c.koulutusluokitus_avain=l.ammopiskkoulk_1
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d2c on d2c.koulutusluokitus_avain=l.ammopiskkoulk_2
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d3c on d3c.koulutusluokitus_avain=l.ammopiskkoulk_3
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d4c on d4c.koulutusluokitus_avain=l.ammopiskkoulk_4
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d5c on d5c.koulutusluokitus_avain=l.ammopiskkoulk_5
/*LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d6c on d6c.koulutusluokitus_avain=l.ammopiskkoulk2009
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d7c on d7c.koulutusluokitus_avain=l.ammopiskkoulk2010
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d8c on d8c.koulutusluokitus_avain=l.ammopiskkoulk2011
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d9c on d9c.koulutusluokitus_avain=l.ammopiskkoulk2012
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d10c on d10c.koulutusluokitus_avain=l.ammopiskkoulk2013*/

CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d1a.iscfibroad2013_koodi),(d1b.iscfibroad2013_koodi), (d2a.iscfibroad2013_koodi),(d2b.iscfibroad2013_koodi), (d3a.iscfibroad2013_koodi),(d3b.iscfibroad2013_koodi), (d4a.iscfibroad2013_koodi),(d4b.iscfibroad2013_koodi)) AS a(d)) m1
CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d2a.iscfibroad2013_koodi),(d2b.iscfibroad2013_koodi), (d3a.iscfibroad2013_koodi),(d3b.iscfibroad2013_koodi), (d4a.iscfibroad2013_koodi),(d4b.iscfibroad2013_koodi), (d5a.iscfibroad2013_koodi),(d5b.iscfibroad2013_koodi)) AS a(d)) m2
/*CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d3a.iscfibroad2013_koodi),(d3b.iscfibroad2013_koodi), (d4a.iscfibroad2013_koodi),(d4b.iscfibroad2013_koodi), (d5a.iscfibroad2013_koodi),(d5b.iscfibroad2013_koodi), (d6a.iscfibroad2013_koodi),(d6b.iscfibroad2013_koodi)) AS a(d)) m3
CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d4a.iscfibroad2013_koodi),(d4b.iscfibroad2013_koodi), (d5a.iscfibroad2013_koodi),(d5b.iscfibroad2013_koodi), (d6a.iscfibroad2013_koodi),(d6b.iscfibroad2013_koodi), (d7a.iscfibroad2013_koodi),(d7b.iscfibroad2013_koodi)) AS a(d)) m4
CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d5a.iscfibroad2013_koodi),(d5b.iscfibroad2013_koodi), (d6a.iscfibroad2013_koodi),(d6b.iscfibroad2013_koodi), (d7a.iscfibroad2013_koodi),(d7b.iscfibroad2013_koodi), (d8a.iscfibroad2013_koodi),(d8b.iscfibroad2013_koodi)) AS a(d)) m5
CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d6a.iscfibroad2013_koodi),(d6b.iscfibroad2013_koodi), (d7a.iscfibroad2013_koodi),(d7b.iscfibroad2013_koodi), (d8a.iscfibroad2013_koodi),(d8b.iscfibroad2013_koodi), (d9a.iscfibroad2013_koodi),(d9b.iscfibroad2013_koodi)) AS a(d)) m6
CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d7a.iscfibroad2013_koodi),(d7b.iscfibroad2013_koodi), (d8a.iscfibroad2013_koodi),(d8b.iscfibroad2013_koodi), (d9a.iscfibroad2013_koodi),(d9b.iscfibroad2013_koodi), (d10a.iscfibroad2013_koodi),(d10b.iscfibroad2013_koodi)) AS a(d)) m7*/
	
	
	WHERE 1=1
--end;

--
-- TULOS
-- 
/*
if @debug_what_to_run>=3 begin
	if @debug_what_to_run>0 print 'querying result';
	select * from [VipunenTK_DW].[dbo].[_koulutukseen_sijoittuneet_6v]
	--select COUNT(*) from vipunen_tk.f_tyol_ja_jatko_opin_ where aineisto=(select id from vipunen_tk.d_aineisto where aineistokoodi='4.3' and @toinen_suoritusvuosi between alkaa and paattyy)
end;

if @debug_what_to_run>0 PRINT 'all done.';
*/



GO
/****** Object:  StoredProcedure [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_3_0_tarkastelujakso]    Script Date: 29.8.2018 15:59:41 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE PROCEDURE [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_3_0_tarkastelujakso] AS
/*declare @debug_what_to_run tinyint; set @debug_what_to_run=2; -- käytä arvoa 3 vain kun teet yhden vuoden
print '$'+convert(varchar,sysdatetime(),20)+'$ '+'DEBUG (what to run)='+cast(@debug_what_to_run as varchar)+
': 0=luo vain taulut, älä tulosta mitään; 1=luo taulut ja tulosta joitakin merkittävimpiä välivaiheita; 2=luo taulut ja tulosta välivaiheet; 3=luo taulut, tulosta välivaiheet ja tulosta myös tulokset, 4=tulosta välivaiheet, mutta älä tee mitään';




-- lisätään data
if @debug_what_to_run not in (4) begin
if @debug_what_to_run>0 print 'inserting data';

-- parametrimuuttujien arvot
-- parametrimuuttujat
DECLARE @ensimmainen_suoritusvuosi int;
DECLARE @toinen_suoritusvuosi int;
DECLARE @kolmas_suoritusvuosi int;
DECLARE @neljas_suoritusvuosi int;
DECLARE @viides_suoritusvuosi int;
DECLARE @kuudes_suoritusvuosi int;
DECLARE @seitsemas_suoritusvuosi int;


set @ensimmainen_suoritusvuosi = _4;
set @toinen_suoritusvuosi = 2005;
set @kolmas_suoritusvuosi = 2006;
set @neljas_suoritusvuosi = 2007;
set @viides_suoritusvuosi = 2008;
set @kuudes_suoritusvuosi = 2009;
set @seitsemas_suoritusvuosi = 2010;

*/

INSERT INTO [VipunenTK_DW].[dbo].[_koulutukseen_sijoittuneet_6v_tarkastelu]
(
rivinumero
, tarkastelujakso
, tilv 
, tilv_date
, tutkryh 
, suorv
, suorlk 
, sp 
, syntv
, aikielir1 
, tutkkaskun 
, kansalr1
, pohjmaa 
, eumaa 
, etamaa 
, tunn
, jarj
, kkielir1 
, tutklaja 
, tutktav 
, aikoul 
, tutkmaak
, koulutus_1
, oppilaitos_1
, koulutuksen_jarjestaja_1
, koulutuksen_maakunta_1
, koulutus_2
, oppilaitos_2
, koulutuksen_jarjestaja_2
, koulutuksen_maakunta_2
, monihaku
, paaasiallinen_toiminta
, ammattiasema
, lkm
, pohjkoulk
, tietolahde
, aineisto
, lukiokoulutuksessa
, ammatillisessa_koulutuksessa
, ammattikorkeakoulutuksessa
, yliopistokoulutuksessa
, lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa
, toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa
, ammattikorkeakoulutuksessa_ja_yliopistokoulutuksessa
, koulutuksen_paattaneiden_toiminta
, ika_1v
, ika_5v
, ika_1v_suorv
, opisk_lu
, opisk_amm_pk
, opisk_amm_at
, opisk_amm_eat
, opisk_amm
, opisk_amk
, opisk_yo
, opisk_amk_koulala1
, opisk_amk_koulala2
, opisk_amk_koulala3
, opisk_amk_koulala4
, opisk_amk_koulala5
, opisk_amk_koulala6
, opisk_amk_koulala7
, opisk_amk_koulala8
, opisk_amk_koulala9
, opisk_amk_koulala10
, opisk_yo_koulala1
, opisk_yo_koulala2
, opisk_yo_koulala3
, opisk_yo_koulala4
, opisk_yo_koulala5
, opisk_yo_koulala6
, opisk_yo_koulala7
, opisk_yo_koulala8
, opisk_yo_koulala9
, opisk_yo_koulala10
, opisk_vah2_koulala
, haku_amm
, haku_amk
, haku_yo
, eihaku_kk_eiopisk
, eihaku_kk_eiopisk_kk_opisk_ta
, eihaku_kk_eiopisk_kk_opisk_lu
, eihaku_kk_eiopisk_kk_opisk_pk
, eihaku_kk_eiopisk_kk_opisk_at
, eihaku_kk_eiopisk_kk_opisk_eat
, haku_kk_eiopisk_kk
, haku_kk_eiopisk_kk_eiopisk_ta
, haku_kk_eiopisk_kk_opisk_ta
, haku_amk_eiopisk_kk
, haku_yo_eiopisk_kk
, haku_amkyo_eiopisk_kk
, opisk_kk
, opisk_kk_eiopisk_ta
, opisk_kk_opisk_ta
, opisk_vain_amk
, opisk_vain_yo
, opisk_amkyo
)
SELECT
 l.rivinumero,
 '3',
 l.tilv,
 l.tilv_date,
 (case 
	when l.tutkryh=3 and tutklaja=1 then 31
	when l.tutkryh=3 and tutklaja=2 then 32
	when l.tutkryh=3 and tutklaja=3 then 33
	else l.tutkryh
  end),
 l.suorv,
  (case
	when l.suorlk = '1'  then (l.suorv+'0'+l.suorlk)
	when l.suorlk = '2'  then (l.suorv+'0'+'8')
	else ''
	end),
 l.sp,
 l.syntv,
 l.aikielir1,
 l.tutkaskun,
 l.kansalr1,
 l.pohjmaa,
 l.eumaa,
 l.etamaa,
 l.tunn,
 l.jarj,
 l.kkielir1,
 l.tutklaja,
 l.tutktav,
 l.aikoul,
 l.tutkmaak,
 -- Koulutus 1
 (case
    --lukiokoulutuksessa _4
	when l.suorlk = '1' and l.luopiskkoulk_4 <> '' and l.ammopiskkoulk_4 = '' and
	l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' then l.luopiskkoulk_4 
	-- ammattikoulutuksessa _4
	when l.suorlk = '1' and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 <> '' and
	l.amkopiskkoulk_4 ='' and l.yoopiskkoulk_4 = ''  then l.ammopiskkoulk_4 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen _4 ensim. koulutustietoihin
	when l.suorlk = '1' and l.luopiskkoulk_4 <> '' and l.ammopiskkoulk_4 <> '' and
	l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' then l.luopiskkoulk_4
	-- ammattikorkeakoulutuksessa _4
	when l.suorlk = '1' and l.amkopiskkoulk_4  <> '' and l.yoopiskkoulk_4  = '' and
	l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' then l.amkopiskkoulk_4
	-- yliopistokoulutuksessa _4
	when l.suorlk = '1' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 <> '' and 
	l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = ''   then l.yoopiskkoulk_4
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa, merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorlk = '1' and l.amkopiskkoulk_4 <> '' and l.yoopiskkoulk_4  <> '' and
	l.luopiskkoulk_4 = '' and ammopiskkoulk_4 = ''  then l.amkopiskkoulk_4 
	
	else ''

	
	    
	    end),
	    
-- Oppilaitos 1
	(case
	-- lukiokoulutuksen oppilaitos _4
	when l.suorlk = '1' and l.luopisktunn_4 <> '' and l.ammopisktunn_4 = '' and
	l.amkopisktunn_4 = '' and l.yoopisktunn_4 = '' then l.luopisktunn_4 
	-- ammattikoulutuksen oppilaitos _4
	when l.suorlk = '1' and l.luopisktunn_4 = '' and l.ammopisktunn_4 <> '' and
	l.amkopisktunn_4 ='' and l.yoopisktunn_4 = ''  then l.ammopisktunn_4 
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos _4
	when l.suorlk = '1' and l.luopisktunn_4 <> '' and l.ammopisktunn_4 <> '' and
	l.amkopisktunn_4 = '' and l.yoopisktunn_4 = '' then l.luopisktunn_4
	-- ammattikorkeakoulutuksen oppilaitos _4
	when l.suorlk = '1' and l.amkopisktunn_4  <> '' and l.yoopisktunn_4  = '' and
	l.luopisktunn_4 = '' and l.ammopisktunn_4 = '' then l.amkopisktunn_4
	-- yliopistokoulutuksen oppilaitos _4
	when l.suorlk = '1' and l.amkopisktunn_4 = '' and l.yoopisktunn_4 <> '' and 
	l.luopisktunn_4 = '' and l.ammopisktunn_4 = ''   then l.yoopisktunn_4
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus _4  
	when l.suorlk = '1' and l.amkopisktunn_4 <> '' and l.yoopisktunn_4  <> '' and
	l.luopisktunn_4 = '' and l.ammopisktunn_4 = ''  then l.amkopisktunn_4 
	
	
	

	
	else ''
	
	    end),
  --Koulutuksen järjestäjä 1
	(case
	-- lukikoulutuksen järjestäjä _4
	when l.suorlk = '1' and l.luopiskjarj_4  <> '' and l.ammopiskjarj_4 = '' and
	l.amkopiskjarj_4 = '' and yoopiskjarj_4 = '' then l.luopiskjarj_4
	-- ammatillisen koulutuksen järjestäjä _4  
	when l.suorlk = '1' and l.luopiskjarj_4 = '' and l.ammopiskjarj_4 <> '' and
	l.amkopiskjarj_4 ='' and l.yoopiskjarj_4 = ''  then l.ammopiskjarj_4
	-- lukio- ja ammatillisen koulutuksen järjestäjä, merkitään lukiokoulutuksen _4 järjestäjä 
	when l.suorlk = '1' and l.luopiskjarj_4 <> '' and l.ammopiskjarj_4 <> '' and
	l.amkopiskjarj_4 = '' and l.yoopiskjarj_4 = '' then l.luopiskjarj_4
	-- ammattikorkeakoulutuksen järjestäjä _4
	when l.suorlk = '1' and l.amkopiskjarj_4  <> '' and l.yoopiskjarj_4   = '' and
	l.luopiskjarj_4 = '' and l.ammopiskjarj_4 = '' then l.amkopiskjarj_4
	-- yliopistokoulutuksen järjestäjä _4 
	when l.suorlk = '1' and l.amkopiskjarj_4  = '' and l.yoopiskjarj_4  <> '' and 
	l.luopiskjarj_4  = '' and l.ammopiskjarj_4 = ''   then l.yoopiskjarj_4
	-- ammattikorkea- ja yliopistokoulutuksen järjestäjä, merkitään ammattikorkeakoulutuksen _4 järjestäjä   
	when l.suorlk = '1' and l.amkopiskjarj_4  <> '' and l.yoopiskjarj_4   <> '' and
	l.luopiskjarj_4  = '' and l.ammopiskjarj_4  = ''  then l.amkopiskjarj_4 

	
	else ''
	    end),
 --Koulutuksen maakunta 1
	(case
	-- lukioopiskelun maakunta _4
	when l.suorlk = '1' and l.luopiskmaak_4   <> '' and l.ammopiskmaak_4  = '' and
	l.amkopiskmaak_4  = '' and l.yoopiskmaak_4  = '' then l.luopiskmaak_4   
	-- ammatillisen koulutuksen maakunta _4
	when l.suorlk = '1' and l.luopiskmaak_4  = '' and l.ammopiskmaak_4  <> '' and
	l.amkopiskmaak_4  ='' and l.yoopiskmaak_4  = ''  then l.ammopiskmaak_4  
	-- lukiokoulutuksen ja ammatillisen koulutus otetaan lukiokoulutuksen maakunta _4
	when l.suorlk = '1' and l.luopiskmaak_4  <> '' and l.ammopiskmaak_4  <> '' and
	l.amkopiskmaak_4  = '' and l.yoopiskmaak_4  = '' then l.luopiskmaak_4 
    -- ammattikorkeakoulutuksen maakunta _4
	when l.suorlk = '1' and l.amkopiskmaak_4   <> '' and l.yoopiskmaak_4   = '' and
	l.luopiskjarj_4 = '' and l.ammopiskmaak_4 = '' then l.amkopiskmaak_4
	-- yliopistokoulutuksen maakunta _4 
	when l.suorlk = '1' and l.amkopiskmaak_4  = '' and l.yoopiskmaak_4  <> '' and 
	l.luopiskjarj_4  = '' and l.ammopiskmaak_4 = ''   then l.yoopiskmaak_4
	-- ammattikorkekoulutuksen ja yliopistokoulutksen maakunta otetaan ammattikorkeakoulutuksen maakunta _4   
	when l.suorlk = '1' and l.amkopiskmaak_4  <> '' and l.yoopiskmaak_4   <> '' and
	l.luopiskjarj_4  = '' and l.ammopiskmaak_4  = ''  then l.amkopiskmaak_4 
	
	else ''
	
	    end),
-- Koulutus 2
(case
   -- jos lukiokoulutuksessa vain niin jätetään tyhjäksi _4
	when l.suorlk = '1' and l.luopiskkoulk_4 <> '' and l.ammopiskkoulk_4 = '' and
	l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' then ''
	-- jos ammattikoulutuksessa vain  jätetään tyhjäksi _4 
	when l.suorlk = '1' and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 <> '' and
	l.amkopiskkoulk_4 ='' and l.yoopiskkoulk_4 = ''  then ''
	-- jos lukiokoulutksessa ja ammattikoulutuksessa merkitään ammattikoulutus _4 
	when l.suorlk = '1' and l.luopiskkoulk_4 <> '' and l.ammopiskkoulk_4 <> '' and
	l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' then l.ammopiskkoulk_4 
	-- jos vain ammattikorkeakoulutuksessa jätetään tyhjäksi
	when l.suorlk = '1' and l.amkopiskkoulk_4  <> '' and l.yoopiskkoulk_4  = '' and
	l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorlk = '1' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 <> '' and 
	l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = ''   then ''
	-- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus _4
	when l.suorlk = '1' and l.amkopiskkoulk_4 <> '' and l.yoopiskkoulk_4  <> '' and
	l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = ''  then l.yoopiskkoulk_4
	
	
	
	else ''
	    end),
-- Oppilaitos 2
(case
    -- lukiokoulutuksen oppilaitos vain merkitään tyhjäksi
	when l.suorlk = '1' and l.luopisktunn_4 <> '' and l.ammopisktunn_4 = '' and
	l.amkopisktunn_4 = '' and l.yoopisktunn_4 = '' then ''
	-- ammatillisen koulutuksen oppilaitos _4 merkitään tyhjäksi
	when l.suorlk = '1' and l.luopisktunn_4 = '' and l.ammopisktunn_4 <> '' and
	l.amkopisktunn_4 ='' and l.yoopisktunn_4 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos merkitään ammatillisen koulutuksen oppilaitos _4
	when l.suorlk = '1' and l.luopisktunn_4 <> '' and l.ammopisktunn_4 <> '' and
	l.amkopisktunn_4 = '' and l.yoopisktunn_4 = '' then l.ammopisktunn_4 
	-- ammattikorkeakoulutksen oppilaitos vain merkitään tyhjäksi _4
	when l.suorlk = '1' and l.amkopisktunn_4  <> '' and l.yoopisktunn_4  = '' and
	l.luopisktunn_4 = '' and l.ammopisktunn_4 = '' then ''
	-- yliopistokoulutksen oppilaitos vain merkitään tyhjäksi _4
	when l.suorlk = '1' and l.amkopisktunn_4 = '' and l.yoopisktunn_4 <> '' and 
	l.luopisktunn_4 = '' and l.ammopisktunn_4 = ''   then ''  
	--  ammattikorkeakoulutksen oppilaitos ja yliopistokoulutuksen oppilaitos, merkitään yliopistokoulutuksen oppilaitos _4
	when l.suorlk = '1' and l.amkopisktunn_4 <> '' and l.yoopisktunn_4  <> '' and
	l.luopisktunn_4 = '' and l.ammopisktunn_4 = ''  then l.yoopisktunn_4 
	
	
	else ''
	    end),
-- Koulutuksen järjestäjä 2
	(case
	-- lukiokoulutuksen järjestäjä vain _4, merkitään tyhjäksi
	when l.suorlk = '1' and l.luopiskjarj_4  <> '' and l.ammopiskjarj_4 = '' and
	l.amkopiskjarj_4 = '' and l.yoopiskjarj_4 = '' then ''
	-- ammatillisen koulutuksen järjestäjä vain _4, merkitään tyhjäksi
	when l.suorlk = '1' and l.luopiskjarj_4 = '' and l.ammopiskjarj_4 <> '' and
	l.amkopiskjarj_4 ='' and l.yoopiskjarj_4 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä _4
	when l.suorlk = '1' and l.luopiskjarj_4 <> '' and l.ammopiskjarj_4 <> '' and
	l.amkopiskjarj_4 = '' and l.yoopiskjarj_4 = '' then l.ammopiskjarj_4 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi
	when l.suorlk = '1' and l.amkopiskjarj_4  <> '' and l.yoopiskjarj_4   = '' and
	l.luopiskjarj_4 = '' and l.ammopiskjarj_4 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, merkitään tyhjäksi
	when l.suorlk = '1' and l.amkopiskjarj_4  = '' and l.yoopiskjarj_4  <> '' and 
	l.luopiskjarj_4  = '' and l.ammopiskjarj_4 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestäjä merkitään yliopistokoulutuksen järjetäjä _4
	when l.suorlk = '1' and l.amkopiskjarj_4  <> '' and l.yoopiskjarj_4   <> '' and
	l.luopiskjarj_4  = '' and l.ammopiskjarj_4  = ''  then l.yoopiskjarj_4 
	

	else ''
	    end),
-- Koulutuksen maakunta 2
	(case
	-- vain lukiokoulutuksen maakunta _4, jätetään tyhjäksi
	when l.suorlk = '1' and l.luopiskmaak_4   <> '' and l.ammopiskmaak_4  = '' and
	l.amkopiskmaak_4  = '' and l.yoopiskmaak_4  = '' then ''
	-- vain ammatillisen koulutuksen maakunta _4, jätetään tyhjäksi   
	when l.suorlk = '1' and l.luopiskmaak_4  = '' and l.ammopiskmaak_4  <> '' and
	l.amkopiskmaak_4  ='' and l.yoopiskmaak_4  = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta, merkitään ammatillisen koulutuksen maakunta _4
	when l.suorlk = '1' and l.luopiskmaak_4  <> '' and l.ammopiskmaak_4  <> '' and
	l.amkopiskmaak_4  = '' and l.yoopiskmaak_4  = '' then l.ammopiskmaak_4 
	-- vain ammattikorkeakoulutuksen maakunta _4, jätetään tyhjäksi
	when l.suorlk = '1' and l.amkopiskmaak_4   <> '' and l.yoopiskmaak_4   = '' and
	l.luopiskmaak_4 = '' and l.ammopiskmaak_4 = '' then '' 
	-- vain yliopistokoulutuksen maakunta _4, merkitään tyhjäksi
	when l.suorlk = '1' and l.amkopiskmaak_4  = '' and l.yoopiskmaak_4  <> '' and 
	l.luopiskmaak_4  = '' and l.ammopiskmaak_4 = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta _4, merkitään yliopistokoulutuksen maakunta _4
	when l.suorlk = '1' and l.amkopiskmaak_4  <> '' and l.yoopiskmaak_4   <> '' and
	l.luopiskjarj_4  = '' and l.ammopiskmaak_4  = ''  then l.yoopiskmaak_4
	

	else ''
	
	    end),
	-- Monihaku
	(case
	-- _4
	when l.suorlk = '1' then l.monihaku_4		
	else '8'
	end),
    -- Pääasiallinen toiminta
    (case
    -- _4
	when l.suorlk = '1' then l.ptoim1r4_4
	else ''
	end),
	-- Ammattiasema
	(case
	-- _4
	when l.suorlk = '1' then l.amas_4
	else ''
	end),
    l.lkm,
	l.pohjkoul,
 l.tietolahde,
 'K3.13',
 -- Lukiokoulutuksessa
 (case
	    when (l.suorlk = '1' ) and  l.luopiskkoulk_4 <> '' and l.ammopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_4 = '' then '1'    
	    else '0'
	    end) as lukiokoulutuksessa,
 -- Ammatillisessa koulutuksessa 
 (case
	    when (l.suorlk = '1') and  l.ammopiskkoulk_4  <> '' and l.luopiskkoulk_4 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' then '1' 
	    else '0'
	    end) as ammatillisessa_koulutuksessa,
-- Ammattikorkeakoulutuksessa
 (case
	   when (l.suorlk = '1') and  l.amkopiskkoulk_4 <> '' and l.ammopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.luopiskkoulk_4 = '' then  '1'
	   else '0' 
	   end) as ammattikorkeakoulutuksessa,
-- Yliopistokoulutuksessa
 (case
	    when (l.suorlk = '1') and  l.yoopiskkoulk_4  <> '' and l.amkopiskkoulk_4 = '' and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' then '1'   	   
	    else '0'
	    end) as yliopistokoulutuksessa,
-- Lukiokoulutuksessa ja ammatillisessa koulutuksessa
(case
	    when (l.suorlk = '1') and  l.luopiskkoulk_4  <> '' and l.ammopiskkoulk_4 <> '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4  = '' then '1'  
	    else '0'
	    end) as lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa,
-- Toisen asteen ammatillisessa koulutuksessa ja korkeakoulutuksessa
(case
	    when (l.suorlk = '1') and  l.ammopiskkoulk_4  <> '' and l.amkopiskkoulk_4 <> '' and l.luopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' then '1'  
	    else '0'
	    end) as toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa,
-- Ammattikorkeakoulutuksessa ja yliopistokoulutuksessa
(case
	    when (l.suorlk = '1') and  l.amkopiskkoulk_4  <> '' and l.yoopiskkoulk_4 <> '' and l.ammopiskkoulk_4  = '' and l.luopiskkoulk_4 = ''  then '1' 
	    else '0'
	    end) as ammattikorkekoulutuksessa_ja_yliopistokoulutuksessa,    
-- Koulutuksen päättäneiden toiminta
(case
	   -- Tutkintoon johtavassa koulutuksessa olevat
	   when (l.suorlk = '1')  and (l.ptoim1r4_4 = '22' or l.ptoim1r4_4 = '13')
       and	(l.luopiskkoulk_4 <>'' or l.ammopiskkoulk_4 <>'' or l.amkopiskkoulk_4 <>'' or l.yoopiskkoulk_4 <>'')   then '1' 
	
	   -- Ei tutkintoon johtavassa koulutuksessa olevat
	   when (l.suorlk = '1')  and (l.ptoim1r4_4 = '22' or l.ptoim1r4_4 = '13')
       and	(l.luopiskkoulk_4 ='' and l.ammopiskkoulk_4 ='' and l.amkopiskkoulk_4 ='' and l.yoopiskkoulk_4 ='')   then '2' 
   
   
	   -- Ei opiskelevat työlliset
	   when (l.suorlk = '1')and  l.ptoim1r4_4  = '10'  then '3' 
	   -- Ei opiskelevat työttömät
	   when (l.suorlk = '1') and  l.ptoim1r4_4  = '12'  then '4' 
	   -- Ei opiskelevat muut
		else '5' 
	   end ) as koulutuksen_paattaneiden_toiminta
 ,ika_1v = cast((case 
            when syntv = '' then '-1'
            when  (cast(tilv as int) - cast(syntv as int)) > 99 then ''
            else  ((cast(tilv as int) - cast(syntv as int))) end)  as nvarchar(10))
 ,ika_5v =cast(
       (
		case
		when (cast(tilv as int) - cast(syntv as int)) < 15 then '5v10'
		when ((cast(tilv as int) - cast(syntv as int)) >= 15 and (cast(tilv as int) - cast(syntv as int)) <= 19) then '5v15'
		when ((cast(tilv as int) - cast(syntv as int)) >= 20 and (cast(tilv as int) - cast(syntv as int)) <= 24) then '5v20'
		when ((cast(tilv as int) - cast(syntv as int)) >= 25 and (cast(tilv as int) - cast(syntv as int)) <= 29) then '5v25'
		when ((cast(tilv as int) - cast(syntv as int)) >= 30 and (cast(tilv as int) - cast(syntv as int)) <= 34) then '5v30'
		when ((cast(tilv as int) - cast(syntv as int)) >= 35 and (cast(tilv as int) - cast(syntv as int)) <= 39) then '5v35'
		when ((cast(tilv as int) - cast(syntv as int)) >= 40 and (cast(tilv as int) - cast(syntv as int)) <= 44) then '5v40'
		when ((cast(tilv as int) - cast(syntv as int)) >= 45 and (cast(tilv as int) - cast(syntv as int)) <= 49) then '5v45'
		when ((cast(tilv as int) - cast(syntv as int)) >= 50 and (cast(tilv as int) - cast(syntv as int)) <= 54) then '5v50'
		when ((cast(tilv as int) - cast(syntv as int)) >= 55 and (cast(tilv as int) - cast(syntv as int)) <= 59) then '5v55'
		when ((cast(tilv as int) - cast(syntv as int)) >= 60 and (cast(tilv as int) - cast(syntv as int)) <= 64) then '5v60'
		when ((cast(tilv as int) - cast(syntv as int)) >= 65 and (cast(tilv as int) - cast(syntv as int)) <= 69) then '5v65'
		when ((cast(tilv as int) - cast(syntv as int)) >= 70 and (cast(tilv as int) - cast(syntv as int)) <= 74) then '5v70'
		when ((cast(tilv as int) - cast(syntv as int)) >= 75 and (cast(tilv as int) - cast(syntv as int)) <= 79) then '5v75'
		when ((cast(tilv as int) - cast(syntv as int)) >= 80 and (cast(tilv as int) - cast(syntv as int)) <= 84) then '5v80'
		when ((cast(tilv as int) - cast(syntv as int)) >= 85 and (cast(tilv as int) - cast(syntv as int)) <= 89) then '5v85'
		when ((cast(tilv as int) - cast(syntv as int)) >= 90 and (cast(tilv as int) - cast(syntv as int)) <= 94) then '5v90'
		when ((cast(tilv as int) - cast(syntv as int)) >= 95) then '5v95'
		
		end
	   ) as nvarchar (10))

  ,ika_1v_suorv = cast(
					(case 
						when syntv = '' then '-1' 
						else ((cast(suorv as int) - cast(syntv as int))) 
					end)  
	as nvarchar(10))




--uudet muuttujat 03/2018

--uudet muuttujat 03/2018

----OPISKELUT KYLLÄ/EI
--Opiskellut lukiokoulutuksessa
,case
	when  l.suorlk = '1' and (l.luopiskkoulk_1 <> '' or l.luopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.luopiskkoulk2008 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.luopiskkoulk2008 <> '' or l.luopiskkoulk2009 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk_4 <> '' or l.luopiskkoulk2008 <> '' or l.luopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk2008 <> '' or l.luopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '') then 1*/
	else 0
end as opisk_lu
--Opiskellut ammatillisessa peruskoulutuksessa
,case
	when  l.suorlk = '1' and (l.ammopiskkoulk_1 <> '' or l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '') and (d1c.Koulutusaste_taso2_koodi = '32' or d2c.Koulutusaste_taso2_koodi = '32' or d3c.Koulutusaste_taso2_koodi = '32' or d4c.Koulutusaste_taso2_koodi = '32') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk2008 <> '') and (d2c.Koulutusaste_taso2_koodi = '32' or d3c.Koulutusaste_taso2_koodi = '32' or d4c.Koulutusaste_taso2_koodi = '32' or d5c.Koulutusaste_taso2_koodi = '32') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk2008 <> '' or l.ammopiskkoulk2009 <> '') and (d3c.Koulutusaste_taso2_koodi = '32' or d4c.Koulutusaste_taso2_koodi = '32' or d5c.Koulutusaste_taso2_koodi = '32' or d6c.Koulutusaste_taso2_koodi = '32') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk2008 <> '' or l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '') and (d4c.Koulutusaste_taso2_koodi = '32' or d5c.Koulutusaste_taso2_koodi = '32' or d6c.Koulutusaste_taso2_koodi = '32' or d7c.Koulutusaste_taso2_koodi = '32') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2008 <> '' or l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '') and (d5c.Koulutusaste_taso2_koodi = '32' or d6c.Koulutusaste_taso2_koodi = '32' or d7c.Koulutusaste_taso2_koodi = '32' or d8c.Koulutusaste_taso2_koodi = '32') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '') and (d6c.Koulutusaste_taso2_koodi = '32' or d7c.Koulutusaste_taso2_koodi = '32' or d8c.Koulutusaste_taso2_koodi = '32' or d9c.Koulutusaste_taso2_koodi = '32') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '' or l.ammopiskkoulk2013 <> '') and (d7c.Koulutusaste_taso2_koodi = '32' or d8c.Koulutusaste_taso2_koodi = '32' or d9c.Koulutusaste_taso2_koodi = '32' or d10c.Koulutusaste_taso2_koodi = '32') then 1*/
	else 0
end as opisk_amm_pk
--Opiskellut ammattitutkintokoulutuksessa
,case
	when  l.suorlk = '1' and (l.ammopiskkoulk_1 <> '' or l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '') and (d1c.Koulutusaste_taso2_koodi = '33' or d2c.Koulutusaste_taso2_koodi = '33' or d3c.Koulutusaste_taso2_koodi = '33' or d4c.Koulutusaste_taso2_koodi = '33') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk2008 <> '') and (d2c.Koulutusaste_taso2_koodi = '33' or d3c.Koulutusaste_taso2_koodi = '33' or d4c.Koulutusaste_taso2_koodi = '33' or d5c.Koulutusaste_taso2_koodi = '33') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk2008 <> '' or l.ammopiskkoulk2009 <> '') and (d3c.Koulutusaste_taso2_koodi = '33' or d4c.Koulutusaste_taso2_koodi = '33' or d5c.Koulutusaste_taso2_koodi = '33' or d6c.Koulutusaste_taso2_koodi = '33') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk2008 <> '' or l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '') and (d4c.Koulutusaste_taso2_koodi = '33' or d5c.Koulutusaste_taso2_koodi = '33' or d6c.Koulutusaste_taso2_koodi = '33' or d7c.Koulutusaste_taso2_koodi = '33') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2008 <> '' or l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '') and (d5c.Koulutusaste_taso2_koodi = '33' or d6c.Koulutusaste_taso2_koodi = '33' or d7c.Koulutusaste_taso2_koodi = '33' or d8c.Koulutusaste_taso2_koodi = '33') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '') and (d6c.Koulutusaste_taso2_koodi = '33' or d7c.Koulutusaste_taso2_koodi = '33' or d8c.Koulutusaste_taso2_koodi = '33' or d9c.Koulutusaste_taso2_koodi = '33') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '' or l.ammopiskkoulk2013 <> '') and (d7c.Koulutusaste_taso2_koodi = '33' or d8c.Koulutusaste_taso2_koodi = '33' or d9c.Koulutusaste_taso2_koodi = '33' or d10c.Koulutusaste_taso2_koodi = '33') then 1*/
	else 0
end as opisk_amm_at
--Opiskellut erikoisammattitutkintokoulutuksessa
,case
	when  l.suorlk = '1' and (l.ammopiskkoulk_1 <> '' or l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '') and (d1c.Koulutusaste_taso2_koodi = '41' or d2c.Koulutusaste_taso2_koodi = '41' or d3c.Koulutusaste_taso2_koodi = '41' or d4c.Koulutusaste_taso2_koodi = '41') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk2008 <> '') and (d2c.Koulutusaste_taso2_koodi = '41' or d3c.Koulutusaste_taso2_koodi = '41' or d4c.Koulutusaste_taso2_koodi = '41' or d5c.Koulutusaste_taso2_koodi = '41') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk2008 <> '' or l.ammopiskkoulk2009 <> '') and (d3c.Koulutusaste_taso2_koodi = '41' or d4c.Koulutusaste_taso2_koodi = '41' or d5c.Koulutusaste_taso2_koodi = '41' or d6c.Koulutusaste_taso2_koodi = '41') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk2008 <> '' or l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '') and (d4c.Koulutusaste_taso2_koodi = '41' or d5c.Koulutusaste_taso2_koodi = '41' or d6c.Koulutusaste_taso2_koodi = '41' or d7c.Koulutusaste_taso2_koodi = '41') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2008 <> '' or l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '') and (d5c.Koulutusaste_taso2_koodi = '41' or d6c.Koulutusaste_taso2_koodi = '41' or d7c.Koulutusaste_taso2_koodi = '41' or d8c.Koulutusaste_taso2_koodi = '41') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '') and (d6c.Koulutusaste_taso2_koodi = '41' or d7c.Koulutusaste_taso2_koodi = '41' or d8c.Koulutusaste_taso2_koodi = '41' or d9c.Koulutusaste_taso2_koodi = '41') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '' or l.ammopiskkoulk2013 <> '') and (d7c.Koulutusaste_taso2_koodi = '41' or d8c.Koulutusaste_taso2_koodi = '41' or d9c.Koulutusaste_taso2_koodi = '41' or d10c.Koulutusaste_taso2_koodi = '41') then 1*/
	else 0
end as opisk_amm_eat
--Opiskellut ammatillisessa koulutuksessa
,case
	when  l.suorlk = '1' and (l.ammopiskkoulk_1 <> '' or l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk2008 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk2008 <> '' or l.ammopiskkoulk2009 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk2008 <> '' or l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2008 <> '' or l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '' or l.ammopiskkoulk2013 <> '') then 1*/
	else 0
end as opisk_amm
--Opiskellut ammattikorkeakoulutuksessa
,case
	when  l.suorlk = '1' and (l.amkopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.amkopiskkoulk2008 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.amkopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk_4 <> '' or l.amkopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '') then 1*/
	else 0
end as opisk_amk
--Opiskellut yliopistokoulutuksessa
,case
	when  l.suorlk = '1' and (l.yoopiskkoulk_1 <> '' or l.yoopiskkoulk_2 <> '' or l.yoopiskkoulk_3 <> '' or l.yoopiskkoulk_4 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.yoopiskkoulk_2 <> '' or l.yoopiskkoulk_3 <> '' or l.yoopiskkoulk_4 <> '' or l.yoopiskkoulk2008 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.yoopiskkoulk_3 <> '' or l.yoopiskkoulk_4 <> '' or l.yoopiskkoulk2008 <> '' or l.yoopiskkoulk2009 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.yoopiskkoulk_4 <> '' or l.yoopiskkoulk2008 <> '' or l.yoopiskkoulk2009 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.yoopiskkoulk2008 <> '' or l.yoopiskkoulk2009 <> '' or l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.yoopiskkoulk2009 <> '' or l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '' or l.yoopiskkoulk2012 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '' or l.yoopiskkoulk2012 <> '' or l.yoopiskkoulk2013 <> '') then 1*/
	else 0
end as opisk_yo



----KOULUTUSALA, TASO 1 KYLLÄ/EI
--Opiskellut koulutusala1 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1a.iscfibroad2013_koodi = '01' or d2a.iscfibroad2013_koodi = '01' or d3a.iscfibroad2013_koodi = '01' or d4a.iscfibroad2013_koodi = '01') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2a.iscfibroad2013_koodi = '01' or d3a.iscfibroad2013_koodi = '01' or d4a.iscfibroad2013_koodi = '01' or d5a.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3a.iscfibroad2013_koodi = '01' or d4a.iscfibroad2013_koodi = '01' or d5a.iscfibroad2013_koodi = '01' or d6a.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4a.iscfibroad2013_koodi = '01' or d5a.iscfibroad2013_koodi = '01' or d6a.iscfibroad2013_koodi = '01' or d7a.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5a.iscfibroad2013_koodi = '01' or d6a.iscfibroad2013_koodi = '01' or d7a.iscfibroad2013_koodi = '01' or d8a.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6a.iscfibroad2013_koodi = '01' or d7a.iscfibroad2013_koodi = '01' or d8a.iscfibroad2013_koodi = '01' or d9a.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7a.iscfibroad2013_koodi = '01' or d8a.iscfibroad2013_koodi = '01' or d9a.iscfibroad2013_koodi = '01' or d10a.iscfibroad2013_koodi = '01') then 1*/
	else 0
end as opisk_amk_koulala1
--Opiskellut koulutusala2 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1a.iscfibroad2013_koodi = '02' or d2a.iscfibroad2013_koodi = '02' or d3a.iscfibroad2013_koodi = '02' or d4a.iscfibroad2013_koodi = '02') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2a.iscfibroad2013_koodi = '02' or d3a.iscfibroad2013_koodi = '02' or d4a.iscfibroad2013_koodi = '02' or d5a.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3a.iscfibroad2013_koodi = '02' or d4a.iscfibroad2013_koodi = '02' or d5a.iscfibroad2013_koodi = '02' or d6a.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4a.iscfibroad2013_koodi = '02' or d5a.iscfibroad2013_koodi = '02' or d6a.iscfibroad2013_koodi = '02' or d7a.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5a.iscfibroad2013_koodi = '02' or d6a.iscfibroad2013_koodi = '02' or d7a.iscfibroad2013_koodi = '02' or d8a.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6a.iscfibroad2013_koodi = '02' or d7a.iscfibroad2013_koodi = '02' or d8a.iscfibroad2013_koodi = '02' or d9a.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7a.iscfibroad2013_koodi = '02' or d8a.iscfibroad2013_koodi = '02' or d9a.iscfibroad2013_koodi = '02' or d10a.iscfibroad2013_koodi = '02') then 1*/
	else 0
end as opisk_amk_koulala2
--Opiskellut koulutusala3 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1a.iscfibroad2013_koodi = '03' or d2a.iscfibroad2013_koodi = '03' or d3a.iscfibroad2013_koodi = '03' or d4a.iscfibroad2013_koodi = '03') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2a.iscfibroad2013_koodi = '03' or d3a.iscfibroad2013_koodi = '03' or d4a.iscfibroad2013_koodi = '03' or d5a.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3a.iscfibroad2013_koodi = '03' or d4a.iscfibroad2013_koodi = '03' or d5a.iscfibroad2013_koodi = '03' or d6a.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4a.iscfibroad2013_koodi = '03' or d5a.iscfibroad2013_koodi = '03' or d6a.iscfibroad2013_koodi = '03' or d7a.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5a.iscfibroad2013_koodi = '03' or d6a.iscfibroad2013_koodi = '03' or d7a.iscfibroad2013_koodi = '03' or d8a.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6a.iscfibroad2013_koodi = '03' or d7a.iscfibroad2013_koodi = '03' or d8a.iscfibroad2013_koodi = '03' or d9a.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7a.iscfibroad2013_koodi = '03' or d8a.iscfibroad2013_koodi = '03' or d9a.iscfibroad2013_koodi = '03' or d10a.iscfibroad2013_koodi = '03') then 1*/
	else 0
end as opisk_amk_koulala3
--Opiskellut koulutusala4 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1a.iscfibroad2013_koodi = '04' or d2a.iscfibroad2013_koodi = '04' or d3a.iscfibroad2013_koodi = '04' or d4a.iscfibroad2013_koodi = '04') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2a.iscfibroad2013_koodi = '04' or d3a.iscfibroad2013_koodi = '04' or d4a.iscfibroad2013_koodi = '04' or d5a.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3a.iscfibroad2013_koodi = '04' or d4a.iscfibroad2013_koodi = '04' or d5a.iscfibroad2013_koodi = '04' or d6a.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4a.iscfibroad2013_koodi = '04' or d5a.iscfibroad2013_koodi = '04' or d6a.iscfibroad2013_koodi = '04' or d7a.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5a.iscfibroad2013_koodi = '04' or d6a.iscfibroad2013_koodi = '04' or d7a.iscfibroad2013_koodi = '04' or d8a.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6a.iscfibroad2013_koodi = '04' or d7a.iscfibroad2013_koodi = '04' or d8a.iscfibroad2013_koodi = '04' or d9a.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7a.iscfibroad2013_koodi = '04' or d8a.iscfibroad2013_koodi = '04' or d9a.iscfibroad2013_koodi = '04' or d10a.iscfibroad2013_koodi = '04') then 1*/
	else 0
end as opisk_amk_koulala4
--Opiskellut koulutusala5 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1a.iscfibroad2013_koodi = '05' or d2a.iscfibroad2013_koodi = '05' or d3a.iscfibroad2013_koodi = '05' or d4a.iscfibroad2013_koodi = '05') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2a.iscfibroad2013_koodi = '05' or d3a.iscfibroad2013_koodi = '05' or d4a.iscfibroad2013_koodi = '05' or d5a.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3a.iscfibroad2013_koodi = '05' or d4a.iscfibroad2013_koodi = '05' or d5a.iscfibroad2013_koodi = '05' or d6a.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4a.iscfibroad2013_koodi = '05' or d5a.iscfibroad2013_koodi = '05' or d6a.iscfibroad2013_koodi = '05' or d7a.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5a.iscfibroad2013_koodi = '05' or d6a.iscfibroad2013_koodi = '05' or d7a.iscfibroad2013_koodi = '05' or d8a.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6a.iscfibroad2013_koodi = '05' or d7a.iscfibroad2013_koodi = '05' or d8a.iscfibroad2013_koodi = '05' or d9a.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7a.iscfibroad2013_koodi = '05' or d8a.iscfibroad2013_koodi = '05' or d9a.iscfibroad2013_koodi = '05' or d10a.iscfibroad2013_koodi = '05') then 1*/
	else 0
end as opisk_amk_koulala5
--Opiskellut koulutusala6 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1a.iscfibroad2013_koodi = '06' or d2a.iscfibroad2013_koodi = '06' or d3a.iscfibroad2013_koodi = '06' or d4a.iscfibroad2013_koodi = '06') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2a.iscfibroad2013_koodi = '06' or d3a.iscfibroad2013_koodi = '06' or d4a.iscfibroad2013_koodi = '06' or d5a.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3a.iscfibroad2013_koodi = '06' or d4a.iscfibroad2013_koodi = '06' or d5a.iscfibroad2013_koodi = '06' or d6a.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4a.iscfibroad2013_koodi = '06' or d5a.iscfibroad2013_koodi = '06' or d6a.iscfibroad2013_koodi = '06' or d7a.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5a.iscfibroad2013_koodi = '06' or d6a.iscfibroad2013_koodi = '06' or d7a.iscfibroad2013_koodi = '06' or d8a.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6a.iscfibroad2013_koodi = '06' or d7a.iscfibroad2013_koodi = '06' or d8a.iscfibroad2013_koodi = '06' or d9a.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7a.iscfibroad2013_koodi = '06' or d8a.iscfibroad2013_koodi = '06' or d9a.iscfibroad2013_koodi = '06' or d10a.iscfibroad2013_koodi = '06') then 1*/
	else 0
end as opisk_amk_koulala6
--Opiskellut koulutusala7 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1a.iscfibroad2013_koodi = '07' or d2a.iscfibroad2013_koodi = '07' or d3a.iscfibroad2013_koodi = '07' or d4a.iscfibroad2013_koodi = '07') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2a.iscfibroad2013_koodi = '07' or d3a.iscfibroad2013_koodi = '07' or d4a.iscfibroad2013_koodi = '07' or d5a.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3a.iscfibroad2013_koodi = '07' or d4a.iscfibroad2013_koodi = '07' or d5a.iscfibroad2013_koodi = '07' or d6a.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4a.iscfibroad2013_koodi = '07' or d5a.iscfibroad2013_koodi = '07' or d6a.iscfibroad2013_koodi = '07' or d7a.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5a.iscfibroad2013_koodi = '07' or d6a.iscfibroad2013_koodi = '07' or d7a.iscfibroad2013_koodi = '07' or d8a.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6a.iscfibroad2013_koodi = '07' or d7a.iscfibroad2013_koodi = '07' or d8a.iscfibroad2013_koodi = '07' or d9a.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7a.iscfibroad2013_koodi = '07' or d8a.iscfibroad2013_koodi = '07' or d9a.iscfibroad2013_koodi = '07' or d10a.iscfibroad2013_koodi = '07') then 1*/
	else 0
end as opisk_amk_koulala7
--Opiskellut koulutusala8 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1a.iscfibroad2013_koodi = '08' or d2a.iscfibroad2013_koodi = '08' or d3a.iscfibroad2013_koodi = '08' or d4a.iscfibroad2013_koodi = '08') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2a.iscfibroad2013_koodi = '08' or d3a.iscfibroad2013_koodi = '08' or d4a.iscfibroad2013_koodi = '08' or d5a.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3a.iscfibroad2013_koodi = '08' or d4a.iscfibroad2013_koodi = '08' or d5a.iscfibroad2013_koodi = '08' or d6a.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4a.iscfibroad2013_koodi = '08' or d5a.iscfibroad2013_koodi = '08' or d6a.iscfibroad2013_koodi = '08' or d7a.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5a.iscfibroad2013_koodi = '08' or d6a.iscfibroad2013_koodi = '08' or d7a.iscfibroad2013_koodi = '08' or d8a.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6a.iscfibroad2013_koodi = '08' or d7a.iscfibroad2013_koodi = '08' or d8a.iscfibroad2013_koodi = '08' or d9a.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7a.iscfibroad2013_koodi = '08' or d8a.iscfibroad2013_koodi = '08' or d9a.iscfibroad2013_koodi = '08' or d10a.iscfibroad2013_koodi = '08') then 1*/
	else 0
end as opisk_amk_koulala8
--Opiskellut koulutusala9 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1a.iscfibroad2013_koodi = '09' or d2a.iscfibroad2013_koodi = '09' or d3a.iscfibroad2013_koodi = '09' or d4a.iscfibroad2013_koodi = '09') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2a.iscfibroad2013_koodi = '09' or d3a.iscfibroad2013_koodi = '09' or d4a.iscfibroad2013_koodi = '09' or d5a.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3a.iscfibroad2013_koodi = '09' or d4a.iscfibroad2013_koodi = '09' or d5a.iscfibroad2013_koodi = '09' or d6a.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4a.iscfibroad2013_koodi = '09' or d5a.iscfibroad2013_koodi = '09' or d6a.iscfibroad2013_koodi = '09' or d7a.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5a.iscfibroad2013_koodi = '09' or d6a.iscfibroad2013_koodi = '09' or d7a.iscfibroad2013_koodi = '09' or d8a.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6a.iscfibroad2013_koodi = '09' or d7a.iscfibroad2013_koodi = '09' or d8a.iscfibroad2013_koodi = '09' or d9a.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7a.iscfibroad2013_koodi = '09' or d8a.iscfibroad2013_koodi = '09' or d9a.iscfibroad2013_koodi = '09' or d10a.iscfibroad2013_koodi = '09') then 1*/
	else 0
end as opisk_amk_koulala9
--Opiskellut koulutusala10 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1a.iscfibroad2013_koodi = '10' or d2a.iscfibroad2013_koodi = '10' or d3a.iscfibroad2013_koodi = '10' or d4a.iscfibroad2013_koodi = '10') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2a.iscfibroad2013_koodi = '10' or d3a.iscfibroad2013_koodi = '10' or d4a.iscfibroad2013_koodi = '10' or d5a.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3a.iscfibroad2013_koodi = '10' or d4a.iscfibroad2013_koodi = '10' or d5a.iscfibroad2013_koodi = '10' or d6a.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4a.iscfibroad2013_koodi = '10' or d5a.iscfibroad2013_koodi = '10' or d6a.iscfibroad2013_koodi = '10' or d7a.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5a.iscfibroad2013_koodi = '10' or d6a.iscfibroad2013_koodi = '10' or d7a.iscfibroad2013_koodi = '10' or d8a.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6a.iscfibroad2013_koodi = '10' or d7a.iscfibroad2013_koodi = '10' or d8a.iscfibroad2013_koodi = '10' or d9a.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7a.iscfibroad2013_koodi = '10' or d8a.iscfibroad2013_koodi = '10' or d9a.iscfibroad2013_koodi = '10' or d10a.iscfibroad2013_koodi = '10') then 1*/
	else 0
end as opisk_amk_koulala10



--Opiskellut koulutusala1 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1b.iscfibroad2013_koodi = '01' or d2b.iscfibroad2013_koodi = '01' or d3b.iscfibroad2013_koodi = '01' or d4b.iscfibroad2013_koodi = '01') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2b.iscfibroad2013_koodi = '01' or d3b.iscfibroad2013_koodi = '01' or d4b.iscfibroad2013_koodi = '01' or d5b.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3b.iscfibroad2013_koodi = '01' or d4b.iscfibroad2013_koodi = '01' or d5b.iscfibroad2013_koodi = '01' or d6b.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4b.iscfibroad2013_koodi = '01' or d5b.iscfibroad2013_koodi = '01' or d6b.iscfibroad2013_koodi = '01' or d7b.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5b.iscfibroad2013_koodi = '01' or d6b.iscfibroad2013_koodi = '01' or d7b.iscfibroad2013_koodi = '01' or d8b.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6b.iscfibroad2013_koodi = '01' or d7b.iscfibroad2013_koodi = '01' or d8b.iscfibroad2013_koodi = '01' or d9b.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7b.iscfibroad2013_koodi = '01' or d8b.iscfibroad2013_koodi = '01' or d9b.iscfibroad2013_koodi = '01' or d10b.iscfibroad2013_koodi = '01') then 1*/
	else 0
end as opisk_yo_koulala1
--Opiskellut koulutusala2 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1b.iscfibroad2013_koodi = '02' or d2b.iscfibroad2013_koodi = '02' or d3b.iscfibroad2013_koodi = '02' or d4b.iscfibroad2013_koodi = '02') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2b.iscfibroad2013_koodi = '02' or d3b.iscfibroad2013_koodi = '02' or d4b.iscfibroad2013_koodi = '02' or d5b.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3b.iscfibroad2013_koodi = '02' or d4b.iscfibroad2013_koodi = '02' or d5b.iscfibroad2013_koodi = '02' or d6b.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4b.iscfibroad2013_koodi = '02' or d5b.iscfibroad2013_koodi = '02' or d6b.iscfibroad2013_koodi = '02' or d7b.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5b.iscfibroad2013_koodi = '02' or d6b.iscfibroad2013_koodi = '02' or d7b.iscfibroad2013_koodi = '02' or d8b.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6b.iscfibroad2013_koodi = '02' or d7b.iscfibroad2013_koodi = '02' or d8b.iscfibroad2013_koodi = '02' or d9b.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7b.iscfibroad2013_koodi = '02' or d8b.iscfibroad2013_koodi = '02' or d9b.iscfibroad2013_koodi = '02' or d10b.iscfibroad2013_koodi = '02') then 1*/
	else 0
end as opisk_yo_koulala2
--Opiskellut koulutusala3 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1b.iscfibroad2013_koodi = '03' or d2b.iscfibroad2013_koodi = '03' or d3b.iscfibroad2013_koodi = '03' or d4b.iscfibroad2013_koodi = '03') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2b.iscfibroad2013_koodi = '03' or d3b.iscfibroad2013_koodi = '03' or d4b.iscfibroad2013_koodi = '03' or d5b.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3b.iscfibroad2013_koodi = '03' or d4b.iscfibroad2013_koodi = '03' or d5b.iscfibroad2013_koodi = '03' or d6b.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4b.iscfibroad2013_koodi = '03' or d5b.iscfibroad2013_koodi = '03' or d6b.iscfibroad2013_koodi = '03' or d7b.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5b.iscfibroad2013_koodi = '03' or d6b.iscfibroad2013_koodi = '03' or d7b.iscfibroad2013_koodi = '03' or d8b.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6b.iscfibroad2013_koodi = '03' or d7b.iscfibroad2013_koodi = '03' or d8b.iscfibroad2013_koodi = '03' or d9b.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7b.iscfibroad2013_koodi = '03' or d8b.iscfibroad2013_koodi = '03' or d9b.iscfibroad2013_koodi = '03' or d10b.iscfibroad2013_koodi = '03') then 1*/
	else 0
end as opisk_yo_koulala3
--Opiskellut koulutusala4 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1b.iscfibroad2013_koodi = '04' or d2b.iscfibroad2013_koodi = '04' or d3b.iscfibroad2013_koodi = '04' or d4b.iscfibroad2013_koodi = '04') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2b.iscfibroad2013_koodi = '04' or d3b.iscfibroad2013_koodi = '04' or d4b.iscfibroad2013_koodi = '04' or d5b.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3b.iscfibroad2013_koodi = '04' or d4b.iscfibroad2013_koodi = '04' or d5b.iscfibroad2013_koodi = '04' or d6b.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4b.iscfibroad2013_koodi = '04' or d5b.iscfibroad2013_koodi = '04' or d6b.iscfibroad2013_koodi = '04' or d7b.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5b.iscfibroad2013_koodi = '04' or d6b.iscfibroad2013_koodi = '04' or d7b.iscfibroad2013_koodi = '04' or d8b.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6b.iscfibroad2013_koodi = '04' or d7b.iscfibroad2013_koodi = '04' or d8b.iscfibroad2013_koodi = '04' or d9b.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7b.iscfibroad2013_koodi = '04' or d8b.iscfibroad2013_koodi = '04' or d9b.iscfibroad2013_koodi = '04' or d10b.iscfibroad2013_koodi = '04') then 1*/
	else 0
end as opisk_yo_koulala4
--Opiskellut koulutusala5 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1b.iscfibroad2013_koodi = '05' or d2b.iscfibroad2013_koodi = '05' or d3b.iscfibroad2013_koodi = '05' or d4b.iscfibroad2013_koodi = '05') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2b.iscfibroad2013_koodi = '05' or d3b.iscfibroad2013_koodi = '05' or d4b.iscfibroad2013_koodi = '05' or d5b.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3b.iscfibroad2013_koodi = '05' or d4b.iscfibroad2013_koodi = '05' or d5b.iscfibroad2013_koodi = '05' or d6b.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4b.iscfibroad2013_koodi = '05' or d5b.iscfibroad2013_koodi = '05' or d6b.iscfibroad2013_koodi = '05' or d7b.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5b.iscfibroad2013_koodi = '05' or d6b.iscfibroad2013_koodi = '05' or d7b.iscfibroad2013_koodi = '05' or d8b.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6b.iscfibroad2013_koodi = '05' or d7b.iscfibroad2013_koodi = '05' or d8b.iscfibroad2013_koodi = '05' or d9b.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7b.iscfibroad2013_koodi = '05' or d8b.iscfibroad2013_koodi = '05' or d9b.iscfibroad2013_koodi = '05' or d10b.iscfibroad2013_koodi = '05') then 1*/
	else 0
end as opisk_yo_koulala5
--Opiskellut koulutusala6 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1b.iscfibroad2013_koodi = '06' or d2b.iscfibroad2013_koodi = '06' or d3b.iscfibroad2013_koodi = '06' or d4b.iscfibroad2013_koodi = '06') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2b.iscfibroad2013_koodi = '06' or d3b.iscfibroad2013_koodi = '06' or d4b.iscfibroad2013_koodi = '06' or d5b.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3b.iscfibroad2013_koodi = '06' or d4b.iscfibroad2013_koodi = '06' or d5b.iscfibroad2013_koodi = '06' or d6b.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4b.iscfibroad2013_koodi = '06' or d5b.iscfibroad2013_koodi = '06' or d6b.iscfibroad2013_koodi = '06' or d7b.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5b.iscfibroad2013_koodi = '06' or d6b.iscfibroad2013_koodi = '06' or d7b.iscfibroad2013_koodi = '06' or d8b.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6b.iscfibroad2013_koodi = '06' or d7b.iscfibroad2013_koodi = '06' or d8b.iscfibroad2013_koodi = '06' or d9b.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7b.iscfibroad2013_koodi = '06' or d8b.iscfibroad2013_koodi = '06' or d9b.iscfibroad2013_koodi = '06' or d10b.iscfibroad2013_koodi = '06') then 1*/
	else 0
end as opisk_yo_koulala6
--Opiskellut koulutusala7 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1b.iscfibroad2013_koodi = '07' or d2b.iscfibroad2013_koodi = '07' or d3b.iscfibroad2013_koodi = '07' or d4b.iscfibroad2013_koodi = '07') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2b.iscfibroad2013_koodi = '07' or d3b.iscfibroad2013_koodi = '07' or d4b.iscfibroad2013_koodi = '07' or d5b.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3b.iscfibroad2013_koodi = '07' or d4b.iscfibroad2013_koodi = '07' or d5b.iscfibroad2013_koodi = '07' or d6b.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4b.iscfibroad2013_koodi = '07' or d5b.iscfibroad2013_koodi = '07' or d6b.iscfibroad2013_koodi = '07' or d7b.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5b.iscfibroad2013_koodi = '07' or d6b.iscfibroad2013_koodi = '07' or d7b.iscfibroad2013_koodi = '07' or d8b.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6b.iscfibroad2013_koodi = '07' or d7b.iscfibroad2013_koodi = '07' or d8b.iscfibroad2013_koodi = '07' or d9b.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7b.iscfibroad2013_koodi = '07' or d8b.iscfibroad2013_koodi = '07' or d9b.iscfibroad2013_koodi = '07' or d10b.iscfibroad2013_koodi = '07') then 1*/
	else 0
end as opisk_yo_koulala7
--Opiskellut koulutusala8 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1b.iscfibroad2013_koodi = '08' or d2b.iscfibroad2013_koodi = '08' or d3b.iscfibroad2013_koodi = '08' or d4b.iscfibroad2013_koodi = '08') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2b.iscfibroad2013_koodi = '08' or d3b.iscfibroad2013_koodi = '08' or d4b.iscfibroad2013_koodi = '08' or d5b.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3b.iscfibroad2013_koodi = '08' or d4b.iscfibroad2013_koodi = '08' or d5b.iscfibroad2013_koodi = '08' or d6b.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4b.iscfibroad2013_koodi = '08' or d5b.iscfibroad2013_koodi = '08' or d6b.iscfibroad2013_koodi = '08' or d7b.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5b.iscfibroad2013_koodi = '08' or d6b.iscfibroad2013_koodi = '08' or d7b.iscfibroad2013_koodi = '08' or d8b.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6b.iscfibroad2013_koodi = '08' or d7b.iscfibroad2013_koodi = '08' or d8b.iscfibroad2013_koodi = '08' or d9b.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7b.iscfibroad2013_koodi = '08' or d8b.iscfibroad2013_koodi = '08' or d9b.iscfibroad2013_koodi = '08' or d10b.iscfibroad2013_koodi = '08') then 1*/
	else 0
end as opisk_yo_koulala8
--Opiskellut koulutusala9 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1b.iscfibroad2013_koodi = '09' or d2b.iscfibroad2013_koodi = '09' or d3b.iscfibroad2013_koodi = '09' or d4b.iscfibroad2013_koodi = '09') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2b.iscfibroad2013_koodi = '09' or d3b.iscfibroad2013_koodi = '09' or d4b.iscfibroad2013_koodi = '09' or d5b.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3b.iscfibroad2013_koodi = '09' or d4b.iscfibroad2013_koodi = '09' or d5b.iscfibroad2013_koodi = '09' or d6b.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4b.iscfibroad2013_koodi = '09' or d5b.iscfibroad2013_koodi = '09' or d6b.iscfibroad2013_koodi = '09' or d7b.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5b.iscfibroad2013_koodi = '09' or d6b.iscfibroad2013_koodi = '09' or d7b.iscfibroad2013_koodi = '09' or d8b.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6b.iscfibroad2013_koodi = '09' or d7b.iscfibroad2013_koodi = '09' or d8b.iscfibroad2013_koodi = '09' or d9b.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7b.iscfibroad2013_koodi = '09' or d8b.iscfibroad2013_koodi = '09' or d9b.iscfibroad2013_koodi = '09' or d10b.iscfibroad2013_koodi = '09') then 1*/
	else 0
end as opisk_yo_koulala9
--Opiskellut koulutusala10 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1b.iscfibroad2013_koodi = '10' or d2b.iscfibroad2013_koodi = '10' or d3b.iscfibroad2013_koodi = '10' or d4b.iscfibroad2013_koodi = '10') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2b.iscfibroad2013_koodi = '10' or d3b.iscfibroad2013_koodi = '10' or d4b.iscfibroad2013_koodi = '10' or d5b.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3b.iscfibroad2013_koodi = '10' or d4b.iscfibroad2013_koodi = '10' or d5b.iscfibroad2013_koodi = '10' or d6b.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4b.iscfibroad2013_koodi = '10' or d5b.iscfibroad2013_koodi = '10' or d6b.iscfibroad2013_koodi = '10' or d7b.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5b.iscfibroad2013_koodi = '10' or d6b.iscfibroad2013_koodi = '10' or d7b.iscfibroad2013_koodi = '10' or d8b.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6b.iscfibroad2013_koodi = '10' or d7b.iscfibroad2013_koodi = '10' or d8b.iscfibroad2013_koodi = '10' or d9b.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7b.iscfibroad2013_koodi = '10' or d8b.iscfibroad2013_koodi = '10' or d9b.iscfibroad2013_koodi = '10' or d10b.iscfibroad2013_koodi = '10') then 1*/
	else 0
end as opisk_yo_koulala10


--Opiskellut useampaa kuin yhtä alaa (taso 1) (kyllä/ei)
,case --ensimmäisenä vuotena on mahdollista olla vain yksi ala
	when  l.suorlk = '1' and m1.MinValue <> m1.MaxValue then 1 
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and m2.MinValue <> m2.MaxValue then 1 
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and m3.MinValue <> m3.MaxValue then 1 
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and m4.MinValue <> m4.MaxValue then 1 
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and m5.MinValue <> m5.MaxValue then 1 
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and m6.MinValue <> m6.MaxValue then 1 
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and m7.MinValue <> m7.MaxValue then 1 */
	else 0
end as opisk_vah2_koulala


----HAUT KYLLÄ/EI
--Hakenut ammatilliseen koulutukseen
,case
	when  l.suorlk = '1' and (l.monihaku_1 in (2,3,5) or l.monihaku_2 in (2,3,5) or l.monihaku_3 in (2,3,5) or l.monihaku_4 in (2,3,5)) then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.monihaku_2 in (2,3,5) or l.monihaku_3 in (2,3,5) or l.monihaku_4 in (2,3,5) or l.monihaku2008 in (2,3,5)) then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.monihaku_3 in (2,3,5) or l.monihaku_4 in (2,3,5) or l.monihaku2008 in (2,3,5) or l.monihaku2009 in (2,3,5)) then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.monihaku_4 in (2,3,5) or l.monihaku2008 in (2,3,5) or l.monihaku2009 in (2,3,5) or l.monihaku2010 in (2,3,5)) then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.monihaku2008 in (2,3,5) or l.monihaku2009 in (2,3,5) or l.monihaku2010 in (2,3,5) or l.monihaku2011 in (2,3,5)) then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.monihaku2009 in (2,3,5) or l.monihaku2010 in (2,3,5) or l.monihaku2011 in (2,3,5) or l.monihaku2012 in (2,3,5)) then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.monihaku2010 in (2,3,5) or l.monihaku2011 in (2,3,5) or l.monihaku2012 in (2,3,5) or l.monihaku2013 in (2,3,5)) then 1*/
	else 0
end as haku_amm
--Hakenut ammattikorkeakoulutukseen
,case
	when  l.suorlk = '1' and (l.monihaku_1 in (4,6) or l.monihaku_2 in (4,6) or l.monihaku_3 in (4,6) or l.monihaku_4 in (4,6)) then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.monihaku_2 in (4,6) or l.monihaku_3 in (4,6) or l.monihaku_4 in (4,6) or l.monihaku2008 in (4,6)) then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.monihaku_3 in (4,6) or l.monihaku_4 in (4,6) or l.monihaku2008 in (4,6) or l.monihaku2009 in (4,6)) then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.monihaku_4 in (4,6) or l.monihaku2008 in (4,6) or l.monihaku2009 in (4,6) or l.monihaku2010 in (4,6)) then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.monihaku2008 in (4,6) or l.monihaku2009 in (4,6) or l.monihaku2010 in (4,6) or l.monihaku2011 in (4,6)) then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.monihaku2009 in (4,6) or l.monihaku2010 in (4,6) or l.monihaku2011 in (4,6) or l.monihaku2012 in (4,6)) then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.monihaku2010 in (4,6) or l.monihaku2011 in (4,6) or l.monihaku2012 in (4,6) or l.monihaku2013 in (4,6)) then 1*/
	else 0
end as haku_amk
--Hakenut yliopistokoulutukseen
,case
	when  l.suorlk = '1' and (l.monihaku_1 in (6,7) or l.monihaku_2 in (6,7) or l.monihaku_3 in (6,7) or l.monihaku_4 in (6,7)) then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.monihaku_2 in (6,7) or l.monihaku_3 in (6,7) or l.monihaku_4 in (6,7) or l.monihaku2008 in (6,7)) then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.monihaku_3 in (6,7) or l.monihaku_4 in (6,7) or l.monihaku2008 in (6,7) or l.monihaku2009 in (6,7)) then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.monihaku_4 in (6,7) or l.monihaku2008 in (6,7) or l.monihaku2009 in (6,7) or l.monihaku2010 in (6,7)) then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.monihaku2008 in (6,7) or l.monihaku2009 in (6,7) or l.monihaku2010 in (6,7) or l.monihaku2011 in (6,7)) then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.monihaku2009 in (6,7) or l.monihaku2010 in (6,7) or l.monihaku2011 in (6,7) or l.monihaku2012 in (6,7)) then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.monihaku2010 in (6,7) or l.monihaku2011 in (6,7) or l.monihaku2012 in (6,7) or l.monihaku2013 in (6,7)) then 1*/
	else 0
end as haku_yo




----MITTARIT
--Ei hakenut eikä opiskellut mitään
,case
	when  l.suorlk = '1' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and l.luopiskkoulk_1 = '' and l.ammopiskkoulk_1 = '' and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and monihaku_4 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1*/
	else 0
end eihaku_kk_eiopisk

--Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa
,case 
	when  l.suorlk = '1' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and (l.luopiskkoulk_1 <> '' or l.ammopiskkoulk_1 <> '' or l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and (l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '' or l.luopiskkoulk2008 <> '' or l.ammopiskkoulk2008 <> '') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and (l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '' or l.luopiskkoulk2008 <> '' or l.ammopiskkoulk2008 <> '' or l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '') and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and monihaku_4 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and (l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '' or l.luopiskkoulk2008 <> '' or l.ammopiskkoulk2008 <> '' or l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '') and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and (l.luopiskkoulk2008 <> '' or l.ammopiskkoulk2008 <> '' or l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '') and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and (l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '') and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and (l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '' or l.ammopiskkoulk2013 <> '') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1*/
	else 0
end eihaku_kk_eiopisk_kk_opisk_ta

----Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa, opiskellut lukiokoulutuksessa
,case 
	when  l.suorlk = '1' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and (l.luopiskkoulk_1 <> '' or l.luopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and (l.luopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.luopiskkoulk2008 <> '') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and (l.luopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.luopiskkoulk2008 <> '' or l.luopiskkoulk2009 <> '') and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and monihaku_4 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and (l.luopiskkoulk_4 <> '' or l.luopiskkoulk2008 <> '' or l.luopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '') and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and (l.luopiskkoulk2008 <> '' or l.luopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '') and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and (l.luopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '') and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and (l.luopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1*/
	else 0
end eihaku_kk_eiopisk_kk_opisk_lu

----Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa, opiskellut ammatillisessa peruskoulutuksessa
,case 
	when  l.suorlk = '1' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and (d1c.Koulutusaste_taso2_koodi = '32' or d2c.Koulutusaste_taso2_koodi = '32' or d3c.Koulutusaste_taso2_koodi = '32' or d4c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and (d2c.Koulutusaste_taso2_koodi = '32' or d3c.Koulutusaste_taso2_koodi = '32' or d4c.Koulutusaste_taso2_koodi = '32' or d5c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and (d3c.Koulutusaste_taso2_koodi = '32' or d4c.Koulutusaste_taso2_koodi = '32' or d5c.Koulutusaste_taso2_koodi = '32' or d6c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and monihaku_4 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and (d4c.Koulutusaste_taso2_koodi = '32' or d5c.Koulutusaste_taso2_koodi = '32' or d6c.Koulutusaste_taso2_koodi = '32' or d7c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and (d5c.Koulutusaste_taso2_koodi = '32' or d6c.Koulutusaste_taso2_koodi = '32' or d7c.Koulutusaste_taso2_koodi = '32' or d8c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and (d6c.Koulutusaste_taso2_koodi = '32' or d7c.Koulutusaste_taso2_koodi = '32' or d8c.Koulutusaste_taso2_koodi = '32' or d9c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and (d7c.Koulutusaste_taso2_koodi = '32' or d8c.Koulutusaste_taso2_koodi = '32' or d9c.Koulutusaste_taso2_koodi = '32' or d10c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1*/
	else 0
end eihaku_kk_eiopisk_kk_opisk_pk

------Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa, opiskellut ammattitutkintokoulutuksessa
,case 
	when  l.suorlk = '1' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and (d1c.Koulutusaste_taso2_koodi = '33' or d2c.Koulutusaste_taso2_koodi = '33' or d3c.Koulutusaste_taso2_koodi = '33' or d4c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and (d2c.Koulutusaste_taso2_koodi = '33' or d3c.Koulutusaste_taso2_koodi = '33' or d4c.Koulutusaste_taso2_koodi = '33' or d5c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and (d3c.Koulutusaste_taso2_koodi = '33' or d4c.Koulutusaste_taso2_koodi = '33' or d5c.Koulutusaste_taso2_koodi = '33' or d6c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and monihaku_4 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and (d4c.Koulutusaste_taso2_koodi = '33' or d5c.Koulutusaste_taso2_koodi = '33' or d6c.Koulutusaste_taso2_koodi = '33' or d7c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and (d5c.Koulutusaste_taso2_koodi = '33' or d6c.Koulutusaste_taso2_koodi = '33' or d7c.Koulutusaste_taso2_koodi = '33' or d8c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and (d6c.Koulutusaste_taso2_koodi = '33' or d7c.Koulutusaste_taso2_koodi = '33' or d8c.Koulutusaste_taso2_koodi = '33' or d9c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and (d7c.Koulutusaste_taso2_koodi = '33' or d8c.Koulutusaste_taso2_koodi = '33' or d9c.Koulutusaste_taso2_koodi = '33' or d10c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1*/
	else 0
end eihaku_kk_eiopisk_kk_opisk_at

------Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa, opiskellut erikoisammattitutkintokoulutuksessa
,case 
	when  l.suorlk = '1' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and (d1c.Koulutusaste_taso2_koodi = '41' or d2c.Koulutusaste_taso2_koodi = '41' or d3c.Koulutusaste_taso2_koodi = '41' or d4c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and (d2c.Koulutusaste_taso2_koodi = '41' or d3c.Koulutusaste_taso2_koodi = '41' or d4c.Koulutusaste_taso2_koodi = '41' or d5c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and (d3c.Koulutusaste_taso2_koodi = '41' or d4c.Koulutusaste_taso2_koodi = '41' or d5c.Koulutusaste_taso2_koodi = '41' or d6c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and monihaku_4 not in (4,5,6,7) and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and (d4c.Koulutusaste_taso2_koodi = '41' or d5c.Koulutusaste_taso2_koodi = '41' or d6c.Koulutusaste_taso2_koodi = '41' or d7c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and monihaku2008 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and (d5c.Koulutusaste_taso2_koodi = '41' or d6c.Koulutusaste_taso2_koodi = '41' or d7c.Koulutusaste_taso2_koodi = '41' or d8c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and (d6c.Koulutusaste_taso2_koodi = '41' or d7c.Koulutusaste_taso2_koodi = '41' or d8c.Koulutusaste_taso2_koodi = '41' or d9c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and (d7c.Koulutusaste_taso2_koodi = '41' or d8c.Koulutusaste_taso2_koodi = '41' or d9c.Koulutusaste_taso2_koodi = '41' or d10c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1*/
	else 0
end eihaku_kk_eiopisk_kk_opisk_eat

--Hakenut korkea-asteelle, ei opiskellut korkea-asteella
,case 
	when  l.suorlk = '1' and (monihaku_1 in (4,5,6,7) or monihaku_2 in (4,5,6,7) or monihaku_3 in (4,5,6,7) or monihaku_4 in (4,5,6,7)) and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (monihaku_2 in (4,5,6,7) or monihaku_3 in (4,5,6,7) or monihaku_4 in (4,5,6,7) or monihaku2008 in (4,5,6,7)) and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (monihaku_3 in (4,5,6,7) or monihaku_4 in (4,5,6,7) or monihaku2008 in (4,5,6,7) or monihaku2009 in (4,5,6,7)) and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (monihaku_4 in (4,5,6,7) or monihaku2008 in (4,5,6,7) or monihaku2009 in (4,5,6,7) or monihaku2010 in (4,5,6,7)) and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (monihaku2008 in (4,5,6,7) or monihaku2009 in (4,5,6,7) or monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7)) and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (monihaku2009 in (4,5,6,7) or monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7) or monihaku2012 in (4,5,6,7)) and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7) or monihaku2012 in (4,5,6,7) or monihaku2013 in (4,5,6,7)) and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1*/
	else 0
end haku_kk_eiopisk_kk
----Hakenut korkea-asteelle, ei opiskellut korkea-asteella, ei-opiskellut toisen asteen koulutuksessa
,case
	when  l.suorlk = '1' and (monihaku_1 in (4,5,6,7) or monihaku_2 in (4,5,6,7) or monihaku_3 in (4,5,6,7) or monihaku_4 in (4,5,6,7)) and l.luopiskkoulk_1 = '' and l.ammopiskkoulk_1 = '' and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (monihaku_2 in (4,5,6,7) or monihaku_3 in (4,5,6,7) or monihaku_4 in (4,5,6,7) or monihaku2008 in (4,5,6,7)) and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (monihaku_3 in (4,5,6,7) or monihaku_4 in (4,5,6,7) or monihaku2008 in (4,5,6,7) or monihaku2009 in (4,5,6,7)) and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (monihaku_4 in (4,5,6,7) or monihaku2008 in (4,5,6,7) or monihaku2009 in (4,5,6,7) or monihaku2010 in (4,5,6,7)) and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (monihaku2008 in (4,5,6,7) or monihaku2009 in (4,5,6,7) or monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7)) and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (monihaku2009 in (4,5,6,7) or monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7) or monihaku2012 in (4,5,6,7)) and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7) or monihaku2012 in (4,5,6,7) or monihaku2013 in (4,5,6,7)) and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1*/
	else 0
end haku_kk_eiopisk_kk_eiopisk_ta
----Hakenut korkea-asteelle, ei opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa
,case
	when  l.suorlk = '1' and (monihaku_1 in (4,5,6,7) or monihaku_2 in (4,5,6,7) or monihaku_3 in (4,5,6,7) or monihaku_4 in (4,5,6,7)) and (l.luopiskkoulk_1 <> '' or l.ammopiskkoulk_1 <> '' or l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (monihaku_2 in (4,5,6,7) or monihaku_3 in (4,5,6,7) or monihaku_4 in (4,5,6,7) or monihaku2008 in (4,5,6,7)) and (l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '' or l.luopiskkoulk2008 <> '' or l.ammopiskkoulk2008 <> '') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (monihaku_3 in (4,5,6,7) or monihaku_4 in (4,5,6,7) or monihaku2008 in (4,5,6,7) or monihaku2009 in (4,5,6,7)) and (l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '' or l.luopiskkoulk2008 <> '' or l.ammopiskkoulk2008 <> '' or l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '') and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (monihaku_4 in (4,5,6,7) or monihaku2008 in (4,5,6,7) or monihaku2009 in (4,5,6,7) or monihaku2010 in (4,5,6,7)) and (l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '' or l.luopiskkoulk2008 <> '' or l.ammopiskkoulk2008 <> '' or l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '') and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (monihaku2008 in (4,5,6,7) or monihaku2009 in (4,5,6,7) or monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7)) and (l.luopiskkoulk2008 <> '' or l.ammopiskkoulk2008 <> '' or l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '') and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (monihaku2009 in (4,5,6,7) or monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7) or monihaku2012 in (4,5,6,7)) and (l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '') and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7) or monihaku2012 in (4,5,6,7) or monihaku2013 in (4,5,6,7)) and (l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '' or l.ammopiskkoulk2013 <> '') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1*/
	else 0
end haku_kk_eiopisk_kk_opisk_ta
----Hakenut vain ammattikorkeakouluun, ei opiskellut korkea-asteella
,case
	when  l.suorlk = '1' and (monihaku_1 = 4 or monihaku_2 = 4 or monihaku_3 = 4 or monihaku_4 = 4) and (monihaku_1 not in (5,6,7) and monihaku_2 not in (5,6,7) and monihaku_3 not in (5,6,7) and monihaku_4 not in (5,6,7)) and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (monihaku_2 = 4 or monihaku_3 = 4 or monihaku_4 = 4 or monihaku2008 = 4) and (monihaku_2 not in (5,6,7) and monihaku_3 not in (5,6,7) and monihaku_4 not in (5,6,7) and monihaku2008 not in (5,6,7)) and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (monihaku_3 = 4 or monihaku_4 = 4 or monihaku2008 = 4 or monihaku2009 = 4) and (monihaku_3 not in (5,6,7) and monihaku_4 not in (5,6,7) and monihaku2008 not in (5,6,7) and monihaku2009 not in (5,6,7)) and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (monihaku_4 = 4 or monihaku2008 = 4 or monihaku2009 = 4 or monihaku2010 = 4) and (monihaku_4 not in (5,6,7) and monihaku2008 not in (5,6,7) and monihaku2009 not in (5,6,7) and monihaku2010 not in (5,6,7)) and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (monihaku2008 = 4 or monihaku2009 = 4 or monihaku2010 = 4 or monihaku2011 = 4) and (monihaku2008 not in (5,6,7) and monihaku2009 not in (5,6,7) and monihaku2010 not in (5,6,7) and monihaku2011 not in (5,6,7)) and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (monihaku2009 = 4 or monihaku2010 = 4 or monihaku2011 = 4 or monihaku2012 = 4) and (monihaku2009 not in (5,6,7) and monihaku2010 not in (5,6,7) and monihaku2011 not in (5,6,7) and monihaku2012 not in (5,6,7)) and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (monihaku2010 = 4 or monihaku2011 = 4 or monihaku2012 = 4 or monihaku2013 = 4) and (monihaku2010 not in (5,6,7) and monihaku2011 not in (5,6,7) and monihaku2012 not in (5,6,7) and monihaku2013 not in (5,6,7)) and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1*/
	else 0
end haku_amk_eiopisk_kk
----Hakenut vain yliopistokoulutukseen, ei opiskellut korkea-asteella
,case
	when  l.suorlk = '1' and (monihaku_1 = 7 or monihaku_2 = 7 or monihaku_3 = 7 or monihaku_4 = 7) and (monihaku_1 not in (4,5,6) and monihaku_2 not in (4,5,6) and monihaku_3 not in (4,5,6) and monihaku_4 not in (4,5,6)) and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (monihaku_2 = 7 or monihaku_3 = 7 or monihaku_4 = 7 or monihaku2008 = 7) and (monihaku_2 not in (4,5,6) and monihaku_3 not in (4,5,6) and monihaku_4 not in (4,5,6) and monihaku2008 not in (4,5,6)) and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (monihaku_3 = 7 or monihaku_4 = 7 or monihaku2008 = 7 or monihaku2009 = 7) and (monihaku_3 not in (4,5,6) and monihaku_4 not in (4,5,6) and monihaku2008 not in (4,5,6) and monihaku2009 not in (4,5,6)) and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (monihaku_4 = 7 or monihaku2008 = 7 or monihaku2009 = 7 or monihaku2010 = 7) and (monihaku_4 not in (4,5,6) and monihaku2008 not in (4,5,6) and monihaku2009 not in (4,5,6) and monihaku2010 not in (4,5,6)) and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (monihaku2008 = 7 or monihaku2009 = 7 or monihaku2010 = 7 or monihaku2011 = 7) and (monihaku2008 not in (4,5,6) and monihaku2009 not in (4,5,6) and monihaku2010 not in (4,5,6) and monihaku2011 not in (4,5,6)) and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (monihaku2009 = 7 or monihaku2010 = 7 or monihaku2011 = 7 or monihaku2012 = 7) and (monihaku2009 not in (4,5,6) and monihaku2010 not in (4,5,6) and monihaku2011 not in (4,5,6) and monihaku2012 not in (4,5,6)) and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (monihaku2010 = 7 or monihaku2011 = 7 or monihaku2012 = 7 or monihaku2013 = 7) and (monihaku2010 not in (4,5,6) and monihaku2011 not in (4,5,6) and monihaku2012 not in (4,5,6) and monihaku2013 not in (4,5,6)) and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1*/
	else 0
end haku_yo_eiopisk_kk
----Hakenut sekä amk- että yliopistokoulutukseen, ei opiskellut korkea-asteella
,case
	when  l.suorlk = '1' and (monihaku_1 = 6 or monihaku_2 = 6 or monihaku_3 = 6 or monihaku_4 = 6 or ((monihaku_1 = 4 or monihaku_2 = 4 or monihaku_3 = 4 or monihaku_4 = 4) and (monihaku_1 = 7 or monihaku_2 = 7 or monihaku_3 = 7 or monihaku_4 = 7))) and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (monihaku_2 = 6 or monihaku_3 = 6 or monihaku_4 = 6 or monihaku2008 = 6 or ((monihaku_2 = 4 or monihaku_3 = 4 or monihaku_4 = 4 or monihaku2008 = 4) and (monihaku_2 = 7 or monihaku_3 = 7 or monihaku_4 = 7 or monihaku2008 = 7))) and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (monihaku_3 = 6 or monihaku_4 = 6 or monihaku2008 = 6 or monihaku2009 = 6 or ((monihaku_3 = 4 or monihaku_4 = 4 or monihaku2008 = 4 or monihaku2009 = 4) and (monihaku_3 = 7 or monihaku_4 = 7 or monihaku2008 = 7 or monihaku2009 = 7))) and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (monihaku_4 = 6 or monihaku2008 = 6 or monihaku2009 = 6 or monihaku2010 = 6 or ((monihaku_4 = 4 or monihaku2008 = 4 or monihaku2009 = 4 or monihaku2010 = 4) and (monihaku_4 = 7 or monihaku2008 = 7 or monihaku2009 = 7 or monihaku2010 = 7))) and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (monihaku2008 = 6 or monihaku2009 = 6 or monihaku2010 = 6 or monihaku2011 = 6 or ((monihaku2008 = 4 or monihaku2009 = 4 or monihaku2010 = 4 or monihaku2011 = 4) and (monihaku2008 = 7 or monihaku2009 = 7 or monihaku2010 = 7 or monihaku2011 = 7))) and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (monihaku2009 = 6 or monihaku2010 = 6 or monihaku2011 = 6 or monihaku2012 = 6 or ((monihaku2009 = 4 or monihaku2010 = 4 or monihaku2011 = 4 or monihaku2012 = 4) and (monihaku2009 = 7 or monihaku2010 = 7 or monihaku2011 = 7 or monihaku2012 = 7))) and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (monihaku2010 = 6 or monihaku2011 = 6 or monihaku2012 = 6 or monihaku2013 = 6 or ((monihaku2010 = 4 or monihaku2011 = 4 or monihaku2012 = 4 or monihaku2013 = 4) and (monihaku2010 = 7 or monihaku2011 = 7 or monihaku2012 = 7 or monihaku2013 = 7))) and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1*/
	else 0
end haku_amkyo_eiopisk_kk

--Opiskellut korkea-asteella
,case
	when  l.suorlk = '1' and (l.amkopiskkoulk_1 <> '' or l.yoopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '' or l.amkopiskkoulk2008 <> '' or l.yoopiskkoulk2008 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '' or l.amkopiskkoulk2008 <> '' or l.yoopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '' or l.amkopiskkoulk2008 <> '' or l.yoopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2008 <> '' or l.yoopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '' or l.yoopiskkoulk2013 <> '') then 1*/
	else 0
end opisk_kk
----Opiskellut korkea-asteella, ei-opiskellut toisen asteen koulutuksessa
,case
	when  l.suorlk = '1' and l.luopiskkoulk_1 = '' and l.ammopiskkoulk_1 = '' and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = ''and (l.amkopiskkoulk_1 <> '' or l.yoopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = ''and (l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '' or l.amkopiskkoulk2008 <> '' or l.yoopiskkoulk2008 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = ''and (l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '' or l.amkopiskkoulk2008 <> '' or l.yoopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = ''and (l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '' or l.amkopiskkoulk2008 <> '' or l.yoopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = ''and (l.amkopiskkoulk2008 <> '' or l.yoopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = ''and (l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = ''and (l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '' or l.yoopiskkoulk2013 <> '') then 1*/
	else 0
end opisk_kk_eiopisk_ta
----Opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa
,case
	when  l.suorlk = '1' and (l.luopiskkoulk_1 <> '' or l.ammopiskkoulk_1 <> '' or l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '') and (l.amkopiskkoulk_1 <> '' or l.yoopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '' or l.luopiskkoulk2008 <> '' or l.ammopiskkoulk2008 <> '') and (l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '' or l.amkopiskkoulk2008 <> '' or l.yoopiskkoulk2008 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '' or l.luopiskkoulk2008 <> '' or l.ammopiskkoulk2008 <> '' or l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '') and (l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '' or l.amkopiskkoulk2008 <> '' or l.yoopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '' or l.luopiskkoulk2008 <> '' or l.ammopiskkoulk2008 <> '' or l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '') and (l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '' or l.amkopiskkoulk2008 <> '' or l.yoopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk2008 <> '' or l.ammopiskkoulk2008 <> '' or l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '') and (l.amkopiskkoulk2008 <> '' or l.yoopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '') and (l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '' or l.ammopiskkoulk2013 <> '') and (l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '' or l.yoopiskkoulk2013 <> '') then 1*/
	else 0
end opisk_kk_opisk_ta
----Opiskellut vain ammattikorkeakoulussa
,case
	when  l.suorlk = '1' and (l.amkopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '') and l.yoopiskkoulk_1 = '' and l.yoopiskkoulk_2 = '' and l.yoopiskkoulk_3 = '' and l.yoopiskkoulk_4 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.amkopiskkoulk2008 <> '') and l.yoopiskkoulk_2 = '' and l.yoopiskkoulk_3 = '' and l.yoopiskkoulk_4 = '' and l.yoopiskkoulk2008 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.amkopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '') and l.yoopiskkoulk_3 = '' and l.yoopiskkoulk_4 = '' and l.yoopiskkoulk2008 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk_4 <> '' or l.amkopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '') and l.yoopiskkoulk_4 = '' and l.yoopiskkoulk2008 = '' and l.yoopiskkoulk2009 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '') and l.yoopiskkoulk2008 = '' and l.yoopiskkoulk2009 = '' and l.yoopiskkoulk2010 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '') and l.yoopiskkoulk2009 = '' and l.yoopiskkoulk2010 = '' and l.yoopiskkoulk2011 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '') and l.yoopiskkoulk2010 = '' and l.yoopiskkoulk2011 = '' and l.yoopiskkoulk2012 = '' and l.yoopiskkoulk2013 = '' then 1*/
	else 0
end opisk_vain_amk
----Opiskellut vain yliopistokoulutuksessa
,case
	when  l.suorlk = '1' and l.amkopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and (l.yoopiskkoulk_1 <> '' or l.yoopiskkoulk_2 <> '' or l.yoopiskkoulk_3 <> '' or l.yoopiskkoulk_4 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and l.amkopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.amkopiskkoulk2008 = '' and (l.yoopiskkoulk_2 <> '' or l.yoopiskkoulk_3 <> '' or l.yoopiskkoulk_4 <> '' or l.yoopiskkoulk2008 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and l.amkopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.amkopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and (l.yoopiskkoulk_3 <> '' or l.yoopiskkoulk_4 <> '' or l.yoopiskkoulk2008 <> '' or l.yoopiskkoulk2009 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and l.amkopiskkoulk_4 = '' and l.amkopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and (l.yoopiskkoulk_4 <> '' or l.yoopiskkoulk2008 <> '' or l.yoopiskkoulk2009 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and l.amkopiskkoulk2008 = '' and l.amkopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and (l.yoopiskkoulk2008 <> '' or l.yoopiskkoulk2009 <> '' or l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and l.amkopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and (l.yoopiskkoulk2009 <> '' or l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '' or l.yoopiskkoulk2012 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and l.amkopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and (l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '' or l.yoopiskkoulk2012 <> '' or l.yoopiskkoulk2013 <> '') then 1*/
	else 0
end opisk_vain_yo
----Opiskellut sekä amk- että yliopistokoulutuksessa
,case
	when  l.suorlk = '1' and (l.amkopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '') and (l.yoopiskkoulk_1 <> '' or l.yoopiskkoulk_2 <> '' or l.yoopiskkoulk_3 <> '' or l.yoopiskkoulk_4 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.amkopiskkoulk2008 <> '') and (l.yoopiskkoulk_2 <> '' or l.yoopiskkoulk_3 <> '' or l.yoopiskkoulk_4 <> '' or l.yoopiskkoulk2008 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.amkopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '') and (l.yoopiskkoulk_3 <> '' or l.yoopiskkoulk_4 <> '' or l.yoopiskkoulk2008 <> '' or l.yoopiskkoulk2009 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk_4 <> '' or l.amkopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '') and (l.yoopiskkoulk_4 <> '' or l.yoopiskkoulk2008 <> '' or l.yoopiskkoulk2009 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2008 <> '' or l.amkopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '') and (l.yoopiskkoulk2008 <> '' or l.yoopiskkoulk2009 <> '' or l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '') and (l.yoopiskkoulk2009 <> '' or l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '' or l.yoopiskkoulk2012 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '') and (l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '' or l.yoopiskkoulk2012 <> '' or l.yoopiskkoulk2013 <> '') then 1*/
	else 0
end opisk_amkyo

	     
FROM 
    (
	select * from [VipunenTK_SA].[dbo].[v_K3_13_Perusk_paattaneet_amm_tutk_suorittaneet]
	where suorlk = '1'
	
	) as l

LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d1a on d1a.koulutusluokitus_avain=l.amkopiskkoulk_1
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d2a on d2a.koulutusluokitus_avain=l.amkopiskkoulk_2
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d3a on d3a.koulutusluokitus_avain=l.amkopiskkoulk_3
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d4a on d4a.koulutusluokitus_avain=l.amkopiskkoulk_4
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d5a on d5a.koulutusluokitus_avain=l.amkopiskkoulk_5
/*LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d6a on d6a.koulutusluokitus_avain=l.amkopiskkoulk2009
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d7a on d7a.koulutusluokitus_avain=l.amkopiskkoulk2010
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d8a on d8a.koulutusluokitus_avain=l.amkopiskkoulk2011
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d9a on d9a.koulutusluokitus_avain=l.amkopiskkoulk2012
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d10a on d10a.koulutusluokitus_avain=l.amkopiskkoulk2013*/

LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d1b on d1b.koulutusluokitus_avain=l.yoopiskkoulk_1
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d2b on d2b.koulutusluokitus_avain=l.yoopiskkoulk_2
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d3b on d3b.koulutusluokitus_avain=l.yoopiskkoulk_3
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d4b on d4b.koulutusluokitus_avain=l.yoopiskkoulk_4
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d5b on d5b.koulutusluokitus_avain=l.yoopiskkoulk_5
/*LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d6b on d6b.koulutusluokitus_avain=l.yoopiskkoulk2009
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d7b on d7b.koulutusluokitus_avain=l.yoopiskkoulk2010
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d8b on d8b.koulutusluokitus_avain=l.yoopiskkoulk2011	
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d9b on d9b.koulutusluokitus_avain=l.yoopiskkoulk2012
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d10b on d10b.koulutusluokitus_avain=l.yoopiskkoulk2013	*/

LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d1c on d1c.koulutusluokitus_avain=l.ammopiskkoulk_1
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d2c on d2c.koulutusluokitus_avain=l.ammopiskkoulk_2
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d3c on d3c.koulutusluokitus_avain=l.ammopiskkoulk_3
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d4c on d4c.koulutusluokitus_avain=l.ammopiskkoulk_4
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d5c on d5c.koulutusluokitus_avain=l.ammopiskkoulk_5
/*LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d6c on d6c.koulutusluokitus_avain=l.ammopiskkoulk2009
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d7c on d7c.koulutusluokitus_avain=l.ammopiskkoulk2010
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d8c on d8c.koulutusluokitus_avain=l.ammopiskkoulk2011
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d9c on d9c.koulutusluokitus_avain=l.ammopiskkoulk2012
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d10c on d10c.koulutusluokitus_avain=l.ammopiskkoulk2013*/

CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d1a.iscfibroad2013_koodi),(d1b.iscfibroad2013_koodi), (d2a.iscfibroad2013_koodi),(d2b.iscfibroad2013_koodi), (d3a.iscfibroad2013_koodi),(d3b.iscfibroad2013_koodi), (d4a.iscfibroad2013_koodi),(d4b.iscfibroad2013_koodi)) AS a(d)) m1
CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d2a.iscfibroad2013_koodi),(d2b.iscfibroad2013_koodi), (d3a.iscfibroad2013_koodi),(d3b.iscfibroad2013_koodi), (d4a.iscfibroad2013_koodi),(d4b.iscfibroad2013_koodi), (d5a.iscfibroad2013_koodi),(d5b.iscfibroad2013_koodi)) AS a(d)) m2
/*CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d3a.iscfibroad2013_koodi),(d3b.iscfibroad2013_koodi), (d4a.iscfibroad2013_koodi),(d4b.iscfibroad2013_koodi), (d5a.iscfibroad2013_koodi),(d5b.iscfibroad2013_koodi), (d6a.iscfibroad2013_koodi),(d6b.iscfibroad2013_koodi)) AS a(d)) m3
CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d4a.iscfibroad2013_koodi),(d4b.iscfibroad2013_koodi), (d5a.iscfibroad2013_koodi),(d5b.iscfibroad2013_koodi), (d6a.iscfibroad2013_koodi),(d6b.iscfibroad2013_koodi), (d7a.iscfibroad2013_koodi),(d7b.iscfibroad2013_koodi)) AS a(d)) m4
CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d5a.iscfibroad2013_koodi),(d5b.iscfibroad2013_koodi), (d6a.iscfibroad2013_koodi),(d6b.iscfibroad2013_koodi), (d7a.iscfibroad2013_koodi),(d7b.iscfibroad2013_koodi), (d8a.iscfibroad2013_koodi),(d8b.iscfibroad2013_koodi)) AS a(d)) m5
CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d6a.iscfibroad2013_koodi),(d6b.iscfibroad2013_koodi), (d7a.iscfibroad2013_koodi),(d7b.iscfibroad2013_koodi), (d8a.iscfibroad2013_koodi),(d8b.iscfibroad2013_koodi), (d9a.iscfibroad2013_koodi),(d9b.iscfibroad2013_koodi)) AS a(d)) m6
CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d7a.iscfibroad2013_koodi),(d7b.iscfibroad2013_koodi), (d8a.iscfibroad2013_koodi),(d8b.iscfibroad2013_koodi), (d9a.iscfibroad2013_koodi),(d9b.iscfibroad2013_koodi), (d10a.iscfibroad2013_koodi),(d10b.iscfibroad2013_koodi)) AS a(d)) m7*/
	WHERE 1 = 1
--end;

--
-- TULOS
-- 
/*
if @debug_what_to_run>=3 begin
	if @debug_what_to_run>0 print 'querying result';
	select * from [VipunenTK_DW].[dbo].[_koulutukseen_sijoittuneet_6v]
	--select COUNT(*) from vipunen_tk.f_tyol_ja_jatko_opin_ where aineisto=(select id from vipunen_tk.d_aineisto where aineistokoodi='4.3' and @toinen_suoritusvuosi between alkaa and paattyy)
end;

if @debug_what_to_run>0 PRINT 'all done.';
*/

GO
/****** Object:  StoredProcedure [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_3_5_tarkastelujakso]    Script Date: 29.8.2018 15:59:41 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


CREATE PROCEDURE [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_3_5_tarkastelujakso] AS
/*declare @debug_what_to_run tinyint; set @debug_what_to_run=2; -- käytä arvoa 3 vain kun teet yhden vuoden
print '$'+convert(varchar,sysdatetime(),20)+'$ '+'DEBUG (what to run)='+cast(@debug_what_to_run as varchar)+
': 0=luo vain taulut, älä tulosta mitään; 1=luo taulut ja tulosta joitakin merkittävimpiä välivaiheita; 2=luo taulut ja tulosta välivaiheet; 3=luo taulut, tulosta välivaiheet ja tulosta myös tulokset, 4=tulosta välivaiheet, mutta älä tee mitään';




-- lisätään data
if @debug_what_to_run not in (4) begin
if @debug_what_to_run>0 print 'inserting data';

-- parametrimuuttujien arvot
-- parametrimuuttujat
DECLARE @ensimmainen_suoritusvuosi int;
DECLARE @toinen_suoritusvuosi int;
DECLARE @kolmas_suoritusvuosi int;
DECLARE @neljas_suoritusvuosi int;
DECLARE @viides_suoritusvuosi int;
DECLARE @kuudes_suoritusvuosi int;
DECLARE @seitsemas_suoritusvuosi int;


set @ensimmainen_suoritusvuosi = _4;
set @toinen_suoritusvuosi = 2005;
set @kolmas_suoritusvuosi = 2006;
set @neljas_suoritusvuosi = 2007;
set @viides_suoritusvuosi = 2008;
set @kuudes_suoritusvuosi = 2009;
set @seitsemas_suoritusvuosi = 2010;

*/

INSERT INTO [VipunenTK_DW].[dbo].[_koulutukseen_sijoittuneet_6v_tarkastelu]
(
rivinumero
, tarkastelujakso
, tilv 
, tilv_date
, tutkryh 
, suorv
, suorlk 
, sp 
, syntv
, aikielir1 
, tutkkaskun 
, kansalr1
, pohjmaa 
, eumaa 
, etamaa 
, tunn
, jarj
, kkielir1 
, tutklaja 
, tutktav 
, aikoul 
, tutkmaak
, koulutus_1
, oppilaitos_1
, koulutuksen_jarjestaja_1
, koulutuksen_maakunta_1
, koulutus_2
, oppilaitos_2
, koulutuksen_jarjestaja_2
, koulutuksen_maakunta_2
, monihaku
, paaasiallinen_toiminta
, ammattiasema
, lkm
, pohjkoulk
, tietolahde
, aineisto
, lukiokoulutuksessa
, ammatillisessa_koulutuksessa
, ammattikorkeakoulutuksessa
, yliopistokoulutuksessa
, lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa
, toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa
, ammattikorkeakoulutuksessa_ja_yliopistokoulutuksessa
, koulutuksen_paattaneiden_toiminta
, ika_1v
, ika_5v
, ika_1v_suorv
, opisk_lu
, opisk_amm_pk
, opisk_amm_at
, opisk_amm_eat
, opisk_amm
, opisk_amk
, opisk_yo
, opisk_amk_koulala1
, opisk_amk_koulala2
, opisk_amk_koulala3
, opisk_amk_koulala4
, opisk_amk_koulala5
, opisk_amk_koulala6
, opisk_amk_koulala7
, opisk_amk_koulala8
, opisk_amk_koulala9
, opisk_amk_koulala10
, opisk_yo_koulala1
, opisk_yo_koulala2
, opisk_yo_koulala3
, opisk_yo_koulala4
, opisk_yo_koulala5
, opisk_yo_koulala6
, opisk_yo_koulala7
, opisk_yo_koulala8
, opisk_yo_koulala9
, opisk_yo_koulala10
, opisk_vah2_koulala
, haku_amm
, haku_amk
, haku_yo
, eihaku_kk_eiopisk
, eihaku_kk_eiopisk_kk_opisk_ta
, eihaku_kk_eiopisk_kk_opisk_lu
, eihaku_kk_eiopisk_kk_opisk_pk
, eihaku_kk_eiopisk_kk_opisk_at
, eihaku_kk_eiopisk_kk_opisk_eat
, haku_kk_eiopisk_kk
, haku_kk_eiopisk_kk_eiopisk_ta
, haku_kk_eiopisk_kk_opisk_ta
, haku_amk_eiopisk_kk
, haku_yo_eiopisk_kk
, haku_amkyo_eiopisk_kk
, opisk_kk
, opisk_kk_eiopisk_ta
, opisk_kk_opisk_ta
, opisk_vain_amk
, opisk_vain_yo
, opisk_amkyo
)
SELECT
 l.rivinumero,
 '3,5',
 l.tilv,
 l.tilv_date,
 (case 
	when l.tutkryh=3 and tutklaja=1 then 31
	when l.tutkryh=3 and tutklaja=2 then 32
	when l.tutkryh=3 and tutklaja=3 then 33
	else l.tutkryh
  end),
 l.suorv,
  (case
	when l.suorlk = '1'  then (l.suorv+'0'+l.suorlk)
	when l.suorlk = '2'  then (l.suorv+'0'+'8')
	else ''
	end),
 l.sp,
 l.syntv,
 l.aikielir1,
 l.tutkaskun,
 l.kansalr1,
 l.pohjmaa,
 l.eumaa,
 l.etamaa,
 l.tunn,
 l.jarj,
 l.kkielir1,
 l.tutklaja,
 l.tutktav,
 l.aikoul,
 l.tutkmaak,
 -- Koulutus 1
 (case
    --lukiokoulutuksessa _5
	when l.suorlk = '2' and l.luopiskkoulk_5 <> '' and l.ammopiskkoulk_5 = '' and
	l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' then l.luopiskkoulk_5 
	-- ammattikoulutuksessa _5
	when l.suorlk = '2' and l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 <> '' and
	l.amkopiskkoulk_5 ='' and l.yoopiskkoulk_5 = ''  then l.ammopiskkoulk_5 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen _5 ensim. koulutustietoihin
	when l.suorlk = '2' and l.luopiskkoulk_5 <> '' and l.ammopiskkoulk_5 <> '' and
	l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' then l.luopiskkoulk_5
	-- ammattikorkeakoulutuksessa _5
	when l.suorlk = '2' and l.amkopiskkoulk_5  <> '' and l.yoopiskkoulk_5  = '' and
	l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = '' then l.amkopiskkoulk_5
	-- yliopistokoulutuksessa _5
	when l.suorlk = '2' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 <> '' and 
	l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = ''   then l.yoopiskkoulk_5
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa, merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorlk = '2' and l.amkopiskkoulk_5 <> '' and l.yoopiskkoulk_5  <> '' and
	l.luopiskkoulk_5 = '' and ammopiskkoulk_5 = ''  then l.amkopiskkoulk_5 
	
	else ''

	
	    
	    end),
	    
-- Oppilaitos 1
	(case
	-- lukiokoulutuksen oppilaitos _5
	when l.suorlk = '2' and l.luopisktunn_5 <> '' and l.ammopisktunn_5 = '' and
	l.amkopisktunn_5 = '' and l.yoopisktunn_5 = '' then l.luopisktunn_5 
	-- ammattikoulutuksen oppilaitos _5
	when l.suorlk = '2' and l.luopisktunn_5 = '' and l.ammopisktunn_5 <> '' and
	l.amkopisktunn_5 ='' and l.yoopisktunn_5 = ''  then l.ammopisktunn_5 
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos _5
	when l.suorlk = '2' and l.luopisktunn_5 <> '' and l.ammopisktunn_5 <> '' and
	l.amkopisktunn_5 = '' and l.yoopisktunn_5 = '' then l.luopisktunn_5
	-- ammattikorkeakoulutuksen oppilaitos _5
	when l.suorlk = '2' and l.amkopisktunn_5  <> '' and l.yoopisktunn_5  = '' and
	l.luopisktunn_5 = '' and l.ammopisktunn_5 = '' then l.amkopisktunn_5
	-- yliopistokoulutuksen oppilaitos _5
	when l.suorlk = '2' and l.amkopisktunn_5 = '' and l.yoopisktunn_5 <> '' and 
	l.luopisktunn_5 = '' and l.ammopisktunn_5 = ''   then l.yoopisktunn_5
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus _5  
	when l.suorlk = '2' and l.amkopisktunn_5 <> '' and l.yoopisktunn_5  <> '' and
	l.luopisktunn_5 = '' and l.ammopisktunn_5 = ''  then l.amkopisktunn_5 
	
	
	

	
	else ''
	
	    end),
  --Koulutuksen järjestäjä 1
	(case
	-- lukikoulutuksen järjestäjä _5
	when l.suorlk = '2' and l.luopiskjarj_5  <> '' and l.ammopiskjarj_5 = '' and
	l.amkopiskjarj_5 = '' and yoopiskjarj_5 = '' then l.luopiskjarj_5
	-- ammatillisen koulutuksen järjestäjä _5  
	when l.suorlk = '2' and l.luopiskjarj_5 = '' and l.ammopiskjarj_5 <> '' and
	l.amkopiskjarj_5 ='' and l.yoopiskjarj_5 = ''  then l.ammopiskjarj_5
	-- lukio- ja ammatillisen koulutuksen järjestäjä, merkitään lukiokoulutuksen _5 järjestäjä 
	when l.suorlk = '2' and l.luopiskjarj_5 <> '' and l.ammopiskjarj_5 <> '' and
	l.amkopiskjarj_5 = '' and l.yoopiskjarj_5 = '' then l.luopiskjarj_5
	-- ammattikorkeakoulutuksen järjestäjä _5
	when l.suorlk = '2' and l.amkopiskjarj_5  <> '' and l.yoopiskjarj_5   = '' and
	l.luopiskjarj_5 = '' and l.ammopiskjarj_5 = '' then l.amkopiskjarj_5
	-- yliopistokoulutuksen järjestäjä _5 
	when l.suorlk = '2' and l.amkopiskjarj_5  = '' and l.yoopiskjarj_5  <> '' and 
	l.luopiskjarj_5  = '' and l.ammopiskjarj_5 = ''   then l.yoopiskjarj_5
	-- ammattikorkea- ja yliopistokoulutuksen järjestäjä, merkitään ammattikorkeakoulutuksen _5 järjestäjä   
	when l.suorlk = '2' and l.amkopiskjarj_5  <> '' and l.yoopiskjarj_5   <> '' and
	l.luopiskjarj_5  = '' and l.ammopiskjarj_5  = ''  then l.amkopiskjarj_5 

	
	else ''
	    end),
 --Koulutuksen maakunta 1
	(case
	-- lukioopiskelun maakunta _5
	when l.suorlk = '2' and l.luopiskmaak_5   <> '' and l.ammopiskmaak_5  = '' and
	l.amkopiskmaak_5  = '' and l.yoopiskmaak_5  = '' then l.luopiskmaak_5   
	-- ammatillisen koulutuksen maakunta _5
	when l.suorlk = '2' and l.luopiskmaak_5  = '' and l.ammopiskmaak_5  <> '' and
	l.amkopiskmaak_5  ='' and l.yoopiskmaak_5  = ''  then l.ammopiskmaak_5  
	-- lukiokoulutuksen ja ammatillisen koulutus otetaan lukiokoulutuksen maakunta _5
	when l.suorlk = '2' and l.luopiskmaak_5  <> '' and l.ammopiskmaak_5  <> '' and
	l.amkopiskmaak_5  = '' and l.yoopiskmaak_5  = '' then l.luopiskmaak_5 
    -- ammattikorkeakoulutuksen maakunta _5
	when l.suorlk = '2' and l.amkopiskmaak_5   <> '' and l.yoopiskmaak_5   = '' and
	l.luopiskjarj_5 = '' and l.ammopiskmaak_5 = '' then l.amkopiskmaak_5
	-- yliopistokoulutuksen maakunta _5 
	when l.suorlk = '2' and l.amkopiskmaak_5  = '' and l.yoopiskmaak_5  <> '' and 
	l.luopiskjarj_5  = '' and l.ammopiskmaak_5 = ''   then l.yoopiskmaak_5
	-- ammattikorkekoulutuksen ja yliopistokoulutksen maakunta otetaan ammattikorkeakoulutuksen maakunta _5   
	when l.suorlk = '2' and l.amkopiskmaak_5  <> '' and l.yoopiskmaak_5   <> '' and
	l.luopiskjarj_5  = '' and l.ammopiskmaak_5  = ''  then l.amkopiskmaak_5 
	
	else ''
	
	    end),
-- Koulutus 2
(case
   -- jos lukiokoulutuksessa vain niin jätetään tyhjäksi _5
	when l.suorlk = '2' and l.luopiskkoulk_5 <> '' and l.ammopiskkoulk_5 = '' and
	l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' then ''
	-- jos ammattikoulutuksessa vain  jätetään tyhjäksi _5 
	when l.suorlk = '2' and l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 <> '' and
	l.amkopiskkoulk_5 ='' and l.yoopiskkoulk_5 = ''  then ''
	-- jos lukiokoulutksessa ja ammattikoulutuksessa merkitään ammattikoulutus _5 
	when l.suorlk = '2' and l.luopiskkoulk_5 <> '' and l.ammopiskkoulk_5 <> '' and
	l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' then l.ammopiskkoulk_5 
	-- jos vain ammattikorkeakoulutuksessa jätetään tyhjäksi
	when l.suorlk = '2' and l.amkopiskkoulk_5  <> '' and l.yoopiskkoulk_5  = '' and
	l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorlk = '2' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 <> '' and 
	l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = ''   then ''
	-- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus _5
	when l.suorlk = '2' and l.amkopiskkoulk_5 <> '' and l.yoopiskkoulk_5  <> '' and
	l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = ''  then l.yoopiskkoulk_5
	
	
	
	else ''
	    end),
-- Oppilaitos 2
(case
    -- lukiokoulutuksen oppilaitos vain merkitään tyhjäksi
	when l.suorlk = '2' and l.luopisktunn_5 <> '' and l.ammopisktunn_5 = '' and
	l.amkopisktunn_5 = '' and l.yoopisktunn_5 = '' then ''
	-- ammatillisen koulutuksen oppilaitos _5 merkitään tyhjäksi
	when l.suorlk = '2' and l.luopisktunn_5 = '' and l.ammopisktunn_5 <> '' and
	l.amkopisktunn_5 ='' and l.yoopisktunn_5 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos merkitään ammatillisen koulutuksen oppilaitos _5
	when l.suorlk = '2' and l.luopisktunn_5 <> '' and l.ammopisktunn_5 <> '' and
	l.amkopisktunn_5 = '' and l.yoopisktunn_5 = '' then l.ammopisktunn_5 
	-- ammattikorkeakoulutksen oppilaitos vain merkitään tyhjäksi _5
	when l.suorlk = '2' and l.amkopisktunn_5  <> '' and l.yoopisktunn_5  = '' and
	l.luopisktunn_5 = '' and l.ammopisktunn_5 = '' then ''
	-- yliopistokoulutksen oppilaitos vain merkitään tyhjäksi _5
	when l.suorlk = '2' and l.amkopisktunn_5 = '' and l.yoopisktunn_5 <> '' and 
	l.luopisktunn_5 = '' and l.ammopisktunn_5 = ''   then ''  
	--  ammattikorkeakoulutksen oppilaitos ja yliopistokoulutuksen oppilaitos, merkitään yliopistokoulutuksen oppilaitos _5
	when l.suorlk = '2' and l.amkopisktunn_5 <> '' and l.yoopisktunn_5  <> '' and
	l.luopisktunn_5 = '' and l.ammopisktunn_5 = ''  then l.yoopisktunn_5 
	
	
	else ''
	    end),
-- Koulutuksen järjestäjä 2
	(case
	-- lukiokoulutuksen järjestäjä vain _5, merkitään tyhjäksi
	when l.suorlk = '2' and l.luopiskjarj_5  <> '' and l.ammopiskjarj_5 = '' and
	l.amkopiskjarj_5 = '' and l.yoopiskjarj_5 = '' then ''
	-- ammatillisen koulutuksen järjestäjä vain _5, merkitään tyhjäksi
	when l.suorlk = '2' and l.luopiskjarj_5 = '' and l.ammopiskjarj_5 <> '' and
	l.amkopiskjarj_5 ='' and l.yoopiskjarj_5 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä _5
	when l.suorlk = '2' and l.luopiskjarj_5 <> '' and l.ammopiskjarj_5 <> '' and
	l.amkopiskjarj_5 = '' and l.yoopiskjarj_5 = '' then l.ammopiskjarj_5 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi
	when l.suorlk = '2' and l.amkopiskjarj_5  <> '' and l.yoopiskjarj_5   = '' and
	l.luopiskjarj_5 = '' and l.ammopiskjarj_5 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, merkitään tyhjäksi
	when l.suorlk = '2' and l.amkopiskjarj_5  = '' and l.yoopiskjarj_5  <> '' and 
	l.luopiskjarj_5  = '' and l.ammopiskjarj_5 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestäjä merkitään yliopistokoulutuksen järjetäjä _5
	when l.suorlk = '2' and l.amkopiskjarj_5  <> '' and l.yoopiskjarj_5   <> '' and
	l.luopiskjarj_5  = '' and l.ammopiskjarj_5  = ''  then l.yoopiskjarj_5 
	

	else ''
	    end),
-- Koulutuksen maakunta 2
	(case
	-- vain lukiokoulutuksen maakunta _5, jätetään tyhjäksi
	when l.suorlk = '2' and l.luopiskmaak_5   <> '' and l.ammopiskmaak_5  = '' and
	l.amkopiskmaak_5  = '' and l.yoopiskmaak_5  = '' then ''
	-- vain ammatillisen koulutuksen maakunta _5, jätetään tyhjäksi   
	when l.suorlk = '2' and l.luopiskmaak_5  = '' and l.ammopiskmaak_5  <> '' and
	l.amkopiskmaak_5  ='' and l.yoopiskmaak_5  = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta, merkitään ammatillisen koulutuksen maakunta _5
	when l.suorlk = '2' and l.luopiskmaak_5  <> '' and l.ammopiskmaak_5  <> '' and
	l.amkopiskmaak_5  = '' and l.yoopiskmaak_5  = '' then l.ammopiskmaak_5 
	-- vain ammattikorkeakoulutuksen maakunta _5, jätetään tyhjäksi
	when l.suorlk = '2' and l.amkopiskmaak_5   <> '' and l.yoopiskmaak_5   = '' and
	l.luopiskmaak_5 = '' and l.ammopiskmaak_5 = '' then '' 
	-- vain yliopistokoulutuksen maakunta _5, merkitään tyhjäksi
	when l.suorlk = '2' and l.amkopiskmaak_5  = '' and l.yoopiskmaak_5  <> '' and 
	l.luopiskmaak_5  = '' and l.ammopiskmaak_5 = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta _5, merkitään yliopistokoulutuksen maakunta _5
	when l.suorlk = '2' and l.amkopiskmaak_5  <> '' and l.yoopiskmaak_5   <> '' and
	l.luopiskjarj_5  = '' and l.ammopiskmaak_5  = ''  then l.yoopiskmaak_5
	

	else ''
	
	    end),
	-- Monihaku
	(case
	-- _5
	when l.suorlk = '2' then l.monihaku_5		
	else '8'
	end),
    -- Pääasiallinen toiminta
    (case
    -- _5
	when l.suorlk = '2' then l.ptoim1r4_5
	else ''
	end),
	-- Ammattiasema
	(case
	-- _5
	when l.suorlk = '2' then l.amas_5
	else ''
	end),
    l.lkm,
	l.pohjkoul,
 l.tietolahde,
 'K3.13',
 -- Lukiokoulutuksessa
 (case
	    when (l.suorlk = '2' ) and  l.luopiskkoulk_5 <> '' and l.ammopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_5 = '' then '1'    
	    else '0'
	    end) as lukiokoulutuksessa,
 -- Ammatillisessa koulutuksessa 
 (case
	    when (l.suorlk = '2') and  l.ammopiskkoulk_5  <> '' and l.luopiskkoulk_5 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' then '1' 
	    else '0'
	    end) as ammatillisessa_koulutuksessa,
-- Ammattikorkeakoulutuksessa
 (case
	   when (l.suorlk = '2') and  l.amkopiskkoulk_5 <> '' and l.ammopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.luopiskkoulk_5 = '' then  '1'
	   else '0' 
	   end) as ammattikorkeakoulutuksessa,
-- Yliopistokoulutuksessa
 (case
	    when (l.suorlk = '2') and  l.yoopiskkoulk_5  <> '' and l.amkopiskkoulk_5 = '' and l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = '' then '1'   	   
	    else '0'
	    end) as yliopistokoulutuksessa,
-- Lukiokoulutuksessa ja ammatillisessa koulutuksessa
(case
	    when (l.suorlk = '2') and  l.luopiskkoulk_5  <> '' and l.ammopiskkoulk_5 <> '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5  = '' then '1'  
	    else '0'
	    end) as lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa,
-- Toisen asteen ammatillisessa koulutuksessa ja korkeakoulutuksessa
(case
	    when (l.suorlk = '2') and  l.ammopiskkoulk_5  <> '' and l.amkopiskkoulk_5 <> '' and l.luopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' then '1'  
	    else '0'
	    end) as toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa,
-- Ammattikorkeakoulutuksessa ja yliopistokoulutuksessa
(case
	    when (l.suorlk = '2') and  l.amkopiskkoulk_5  <> '' and l.yoopiskkoulk_5 <> '' and l.ammopiskkoulk_5  = '' and l.luopiskkoulk_5 = ''  then '1' 
	    else '0'
	    end) as ammattikorkekoulutuksessa_ja_yliopistokoulutuksessa,    
-- Koulutuksen päättäneiden toiminta
(case
	   -- Tutkintoon johtavassa koulutuksessa olevat
	   when (l.suorlk = '2')  and (l.ptoim1r4_5 = '22' or l.ptoim1r4_5 = '13')
       and	(l.luopiskkoulk_5 <>'' or l.ammopiskkoulk_5 <>'' or l.amkopiskkoulk_5 <>'' or l.yoopiskkoulk_5 <>'')   then '1' 
	
	   -- Ei tutkintoon johtavassa koulutuksessa olevat
	   when (l.suorlk = '2')  and (l.ptoim1r4_5 = '22' or l.ptoim1r4_5 = '13')
       and	(l.luopiskkoulk_5 ='' and l.ammopiskkoulk_5 ='' and l.amkopiskkoulk_5 ='' and l.yoopiskkoulk_5 ='')   then '2' 
   
   
	   -- Ei opiskelevat työlliset
	   when (l.suorlk = '2')and  l.ptoim1r4_5  = '10'  then '3' 
	   -- Ei opiskelevat työttömät
	   when (l.suorlk = '2') and  l.ptoim1r4_5  = '12'  then '4' 
	   -- Ei opiskelevat muut
		else '5' 
	   end ) as koulutuksen_paattaneiden_toiminta
 ,ika_1v = cast((case 
            when syntv = '' then '-1'
            when  (cast(tilv as int) - cast(syntv as int)) > 99 then ''
            else  ((cast(tilv as int) - cast(syntv as int))) end)  as nvarchar(10))
 ,ika_5v =cast(
       (
		case
		when (cast(tilv as int) - cast(syntv as int)) < 15 then '5v10'
		when ((cast(tilv as int) - cast(syntv as int)) >= 15 and (cast(tilv as int) - cast(syntv as int)) <= 19) then '5v15'
		when ((cast(tilv as int) - cast(syntv as int)) >= 20 and (cast(tilv as int) - cast(syntv as int)) <= 24) then '5v20'
		when ((cast(tilv as int) - cast(syntv as int)) >= 25 and (cast(tilv as int) - cast(syntv as int)) <= 29) then '5v25'
		when ((cast(tilv as int) - cast(syntv as int)) >= 30 and (cast(tilv as int) - cast(syntv as int)) <= 34) then '5v30'
		when ((cast(tilv as int) - cast(syntv as int)) >= 35 and (cast(tilv as int) - cast(syntv as int)) <= 39) then '5v35'
		when ((cast(tilv as int) - cast(syntv as int)) >= 40 and (cast(tilv as int) - cast(syntv as int)) <= 44) then '5v40'
		when ((cast(tilv as int) - cast(syntv as int)) >= 45 and (cast(tilv as int) - cast(syntv as int)) <= 49) then '5v45'
		when ((cast(tilv as int) - cast(syntv as int)) >= 50 and (cast(tilv as int) - cast(syntv as int)) <= 54) then '5v50'
		when ((cast(tilv as int) - cast(syntv as int)) >= 55 and (cast(tilv as int) - cast(syntv as int)) <= 59) then '5v55'
		when ((cast(tilv as int) - cast(syntv as int)) >= 60 and (cast(tilv as int) - cast(syntv as int)) <= 64) then '5v60'
		when ((cast(tilv as int) - cast(syntv as int)) >= 65 and (cast(tilv as int) - cast(syntv as int)) <= 69) then '5v65'
		when ((cast(tilv as int) - cast(syntv as int)) >= 70 and (cast(tilv as int) - cast(syntv as int)) <= 74) then '5v70'
		when ((cast(tilv as int) - cast(syntv as int)) >= 75 and (cast(tilv as int) - cast(syntv as int)) <= 79) then '5v75'
		when ((cast(tilv as int) - cast(syntv as int)) >= 80 and (cast(tilv as int) - cast(syntv as int)) <= 84) then '5v80'
		when ((cast(tilv as int) - cast(syntv as int)) >= 85 and (cast(tilv as int) - cast(syntv as int)) <= 89) then '5v85'
		when ((cast(tilv as int) - cast(syntv as int)) >= 90 and (cast(tilv as int) - cast(syntv as int)) <= 94) then '5v90'
		when ((cast(tilv as int) - cast(syntv as int)) >= 95) then '5v95'
		
		end
	   ) as nvarchar (10))

  ,ika_1v_suorv = cast(
					(case 
						when syntv = '' then '-1' 
						else ((cast(suorv as int) - cast(syntv as int))) 
					end)  
	as nvarchar(10))




--uudet muuttujat 03/2018

----OPISKELUT KYLLÄ/EI
--Opiskellut lukiokoulutuksessa
,case
	when  l.suorlk = '2' and (l.luopiskkoulk_1 <> '' or l.luopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.luopiskkoulk2009 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.luopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.luopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk_5 <> '' or l.luopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '' or l.luopiskkoulk2014 <> '') then 1*/
	else 0
end as opisk_lu
--Opiskellut ammatillisessa peruskoulutuksessa
,case
	when  l.suorlk = '2' and (l.ammopiskkoulk_1 <> '' or l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk_5 <> '') and (d1c.Koulutusaste_taso2_koodi = '32' or d2c.Koulutusaste_taso2_koodi = '32' or d3c.Koulutusaste_taso2_koodi = '32' or d4c.Koulutusaste_taso2_koodi = '32' or d5c.Koulutusaste_taso2_koodi = '32') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk2009 <> '') and (d2c.Koulutusaste_taso2_koodi = '32' or d3c.Koulutusaste_taso2_koodi = '32' or d4c.Koulutusaste_taso2_koodi = '32' or d5c.Koulutusaste_taso2_koodi = '32' or d6c.Koulutusaste_taso2_koodi = '32') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '') and (d3c.Koulutusaste_taso2_koodi = '32' or d4c.Koulutusaste_taso2_koodi = '32' or d5c.Koulutusaste_taso2_koodi = '32' or d6c.Koulutusaste_taso2_koodi = '32' or d7c.Koulutusaste_taso2_koodi = '32') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '') and (d4c.Koulutusaste_taso2_koodi = '32' or d5c.Koulutusaste_taso2_koodi = '32' or d6c.Koulutusaste_taso2_koodi = '32' or d7c.Koulutusaste_taso2_koodi = '32' or d8c.Koulutusaste_taso2_koodi = '32') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '') and (d5c.Koulutusaste_taso2_koodi = '32' or d6c.Koulutusaste_taso2_koodi = '32' or d7c.Koulutusaste_taso2_koodi = '32' or d8c.Koulutusaste_taso2_koodi = '32' or d9c.Koulutusaste_taso2_koodi = '32') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '' or l.ammopiskkoulk2013 <> '') and (d6c.Koulutusaste_taso2_koodi = '32' or d7c.Koulutusaste_taso2_koodi = '32' or d8c.Koulutusaste_taso2_koodi = '32' or d9c.Koulutusaste_taso2_koodi = '32' or d10c.Koulutusaste_taso2_koodi = '32') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '' or l.ammopiskkoulk2013 <> '' or l.ammopiskkoulk2014 <> '') and (d7c.Koulutusaste_taso2_koodi = '32' or d8c.Koulutusaste_taso2_koodi = '32' or d9c.Koulutusaste_taso2_koodi = '32' or d10c.Koulutusaste_taso2_koodi = '32' or d11c.Koulutusaste_taso2_koodi = '32') then 1*/
	else 0
end as opisk_amm_pk
--Opiskellut ammattitutkintokoulutuksessa
,case
	when  l.suorlk = '2' and (l.ammopiskkoulk_1 <> '' or l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk_5 <> '') and (d1c.Koulutusaste_taso2_koodi = '33' or d2c.Koulutusaste_taso2_koodi = '33' or d3c.Koulutusaste_taso2_koodi = '33' or d4c.Koulutusaste_taso2_koodi = '33' or d5c.Koulutusaste_taso2_koodi = '33') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk2009 <> '') and (d2c.Koulutusaste_taso2_koodi = '33' or d3c.Koulutusaste_taso2_koodi = '33' or d4c.Koulutusaste_taso2_koodi = '33' or d5c.Koulutusaste_taso2_koodi = '33' or d6c.Koulutusaste_taso2_koodi = '33') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '') and (d3c.Koulutusaste_taso2_koodi = '33' or d4c.Koulutusaste_taso2_koodi = '33' or d5c.Koulutusaste_taso2_koodi = '33' or d6c.Koulutusaste_taso2_koodi = '33' or d7c.Koulutusaste_taso2_koodi = '33') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '') and (d4c.Koulutusaste_taso2_koodi = '33' or d5c.Koulutusaste_taso2_koodi = '33' or d6c.Koulutusaste_taso2_koodi = '33' or d7c.Koulutusaste_taso2_koodi = '33' or d8c.Koulutusaste_taso2_koodi = '33') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '') and (d5c.Koulutusaste_taso2_koodi = '33' or d6c.Koulutusaste_taso2_koodi = '33' or d7c.Koulutusaste_taso2_koodi = '33' or d8c.Koulutusaste_taso2_koodi = '33' or d9c.Koulutusaste_taso2_koodi = '33') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '' or l.ammopiskkoulk2013 <> '') and (d6c.Koulutusaste_taso2_koodi = '33' or d7c.Koulutusaste_taso2_koodi = '33' or d8c.Koulutusaste_taso2_koodi = '33' or d9c.Koulutusaste_taso2_koodi = '33' or d10c.Koulutusaste_taso2_koodi = '33') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '' or l.ammopiskkoulk2013 <> '' or l.ammopiskkoulk2014 <> '') and (d7c.Koulutusaste_taso2_koodi = '33' or d8c.Koulutusaste_taso2_koodi = '33' or d9c.Koulutusaste_taso2_koodi = '33' or d10c.Koulutusaste_taso2_koodi = '33' or d11c.Koulutusaste_taso2_koodi = '33') then 1*/
	else 0
end as opisk_amm_at
--Opiskellut erikoisammattitutkintokoulutuksessa
,case
	when  l.suorlk = '2' and (l.ammopiskkoulk_1 <> '' or l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk_5 <> '') and (d1c.Koulutusaste_taso2_koodi = '41' or d2c.Koulutusaste_taso2_koodi = '41' or d3c.Koulutusaste_taso2_koodi = '41' or d4c.Koulutusaste_taso2_koodi = '41' or d5c.Koulutusaste_taso2_koodi = '41') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk2009 <> '') and (d2c.Koulutusaste_taso2_koodi = '41' or d3c.Koulutusaste_taso2_koodi = '41' or d4c.Koulutusaste_taso2_koodi = '41' or d5c.Koulutusaste_taso2_koodi = '41' or d6c.Koulutusaste_taso2_koodi = '41') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '') and (d3c.Koulutusaste_taso2_koodi = '41' or d4c.Koulutusaste_taso2_koodi = '41' or d5c.Koulutusaste_taso2_koodi = '41' or d6c.Koulutusaste_taso2_koodi = '41' or d7c.Koulutusaste_taso2_koodi = '41') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '') and (d4c.Koulutusaste_taso2_koodi = '41' or d5c.Koulutusaste_taso2_koodi = '41' or d6c.Koulutusaste_taso2_koodi = '41' or d7c.Koulutusaste_taso2_koodi = '41' or d8c.Koulutusaste_taso2_koodi = '41') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '') and (d5c.Koulutusaste_taso2_koodi = '41' or d6c.Koulutusaste_taso2_koodi = '41' or d7c.Koulutusaste_taso2_koodi = '41' or d8c.Koulutusaste_taso2_koodi = '41' or d9c.Koulutusaste_taso2_koodi = '41') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '' or l.ammopiskkoulk2013 <> '') and (d6c.Koulutusaste_taso2_koodi = '41' or d7c.Koulutusaste_taso2_koodi = '41' or d8c.Koulutusaste_taso2_koodi = '41' or d9c.Koulutusaste_taso2_koodi = '41' or d10c.Koulutusaste_taso2_koodi = '41') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '' or l.ammopiskkoulk2013 <> '' or l.ammopiskkoulk2014 <> '') and (d7c.Koulutusaste_taso2_koodi = '41' or d8c.Koulutusaste_taso2_koodi = '41' or d9c.Koulutusaste_taso2_koodi = '41' or d10c.Koulutusaste_taso2_koodi = '41' or d11c.Koulutusaste_taso2_koodi = '41') then 1*/
	else 0
end as opisk_amm_eat
--Opiskellut ammatillisessa koulutuksessa
,case
	when  l.suorlk = '2' and (l.ammopiskkoulk_1 <> '' or l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk_5 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk2009 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '' or l.ammopiskkoulk2013 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '' or l.ammopiskkoulk2013 <> '' or l.ammopiskkoulk2014 <> '') then 1*/
	else 0
end as opisk_amm
--Opiskellut ammattikorkeakoulutuksessa
,case
	when  l.suorlk = '2' and (l.amkopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.amkopiskkoulk2009 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.amkopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.amkopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk_5 <> '' or l.amkopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '' or l.amkopiskkoulk2014 <> '') then 1*/
	else 0
end as opisk_amk
--Opiskellut yliopistokoulutuksessa
,case
	when  l.suorlk = '2' and (l.yoopiskkoulk_1 <> '' or l.yoopiskkoulk_2 <> '' or l.yoopiskkoulk_3 <> '' or l.yoopiskkoulk_4 <> '' or l.yoopiskkoulk_5 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.yoopiskkoulk_2 <> '' or l.yoopiskkoulk_3 <> '' or l.yoopiskkoulk_4 <> '' or l.yoopiskkoulk_5 <> '' or l.yoopiskkoulk2009 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.yoopiskkoulk_3 <> '' or l.yoopiskkoulk_4 <> '' or l.yoopiskkoulk_5 <> '' or l.yoopiskkoulk2009 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.yoopiskkoulk_4 <> '' or l.yoopiskkoulk_5 <> '' or l.yoopiskkoulk2009 <> '' or l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.yoopiskkoulk_5 <> '' or l.yoopiskkoulk2009 <> '' or l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '' or l.yoopiskkoulk2012 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.yoopiskkoulk2009 <> '' or l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '' or l.yoopiskkoulk2012 <> '' or l.yoopiskkoulk2013 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '' or l.yoopiskkoulk2012 <> '' or l.yoopiskkoulk2013 <> '' or l.yoopiskkoulk2014 <> '') then 1*/
	else 0
end as opisk_yo



----KOULUTUSALA, TASO 1 KYLLÄ/EI
--Opiskellut koulutusala1 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1a.iscfibroad2013_koodi = '01' or d2a.iscfibroad2013_koodi = '01' or d3a.iscfibroad2013_koodi = '01' or d4a.iscfibroad2013_koodi = '01' or d5a.iscfibroad2013_koodi = '01') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2a.iscfibroad2013_koodi = '01' or d3a.iscfibroad2013_koodi = '01' or d4a.iscfibroad2013_koodi = '01' or d5a.iscfibroad2013_koodi = '01' or d6a.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3a.iscfibroad2013_koodi = '01' or d4a.iscfibroad2013_koodi = '01' or d5a.iscfibroad2013_koodi = '01' or d6a.iscfibroad2013_koodi = '01' or d7a.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4a.iscfibroad2013_koodi = '01' or d5a.iscfibroad2013_koodi = '01' or d6a.iscfibroad2013_koodi = '01' or d7a.iscfibroad2013_koodi = '01' or d8a.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5a.iscfibroad2013_koodi = '01' or d6a.iscfibroad2013_koodi = '01' or d7a.iscfibroad2013_koodi = '01' or d8a.iscfibroad2013_koodi = '01' or d9a.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6a.iscfibroad2013_koodi = '01' or d7a.iscfibroad2013_koodi = '01' or d8a.iscfibroad2013_koodi = '01' or d9a.iscfibroad2013_koodi = '01' or d10a.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7a.iscfibroad2013_koodi = '01' or d8a.iscfibroad2013_koodi = '01' or d9a.iscfibroad2013_koodi = '01' or d10a.iscfibroad2013_koodi = '01' or d11a.iscfibroad2013_koodi = '01') then 1*/
	else 0
end as opisk_amk_koulala1
--Opiskellut koulutusala2 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1a.iscfibroad2013_koodi = '02' or d2a.iscfibroad2013_koodi = '02' or d3a.iscfibroad2013_koodi = '02' or d4a.iscfibroad2013_koodi = '02' or d5a.iscfibroad2013_koodi = '02') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2a.iscfibroad2013_koodi = '02' or d3a.iscfibroad2013_koodi = '02' or d4a.iscfibroad2013_koodi = '02' or d5a.iscfibroad2013_koodi = '02' or d6a.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3a.iscfibroad2013_koodi = '02' or d4a.iscfibroad2013_koodi = '02' or d5a.iscfibroad2013_koodi = '02' or d6a.iscfibroad2013_koodi = '02' or d7a.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4a.iscfibroad2013_koodi = '02' or d5a.iscfibroad2013_koodi = '02' or d6a.iscfibroad2013_koodi = '02' or d7a.iscfibroad2013_koodi = '02' or d8a.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5a.iscfibroad2013_koodi = '02' or d6a.iscfibroad2013_koodi = '02' or d7a.iscfibroad2013_koodi = '02' or d8a.iscfibroad2013_koodi = '02' or d9a.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6a.iscfibroad2013_koodi = '02' or d7a.iscfibroad2013_koodi = '02' or d8a.iscfibroad2013_koodi = '02' or d9a.iscfibroad2013_koodi = '02' or d10a.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7a.iscfibroad2013_koodi = '02' or d8a.iscfibroad2013_koodi = '02' or d9a.iscfibroad2013_koodi = '02' or d10a.iscfibroad2013_koodi = '02' or d11a.iscfibroad2013_koodi = '02') then 1*/
	else 0
end as opisk_amk_koulala2
--Opiskellut koulutusala3 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1a.iscfibroad2013_koodi = '03' or d2a.iscfibroad2013_koodi = '03' or d3a.iscfibroad2013_koodi = '03' or d4a.iscfibroad2013_koodi = '03' or d5a.iscfibroad2013_koodi = '03') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2a.iscfibroad2013_koodi = '03' or d3a.iscfibroad2013_koodi = '03' or d4a.iscfibroad2013_koodi = '03' or d5a.iscfibroad2013_koodi = '03' or d6a.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3a.iscfibroad2013_koodi = '03' or d4a.iscfibroad2013_koodi = '03' or d5a.iscfibroad2013_koodi = '03' or d6a.iscfibroad2013_koodi = '03' or d7a.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4a.iscfibroad2013_koodi = '03' or d5a.iscfibroad2013_koodi = '03' or d6a.iscfibroad2013_koodi = '03' or d7a.iscfibroad2013_koodi = '03' or d8a.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5a.iscfibroad2013_koodi = '03' or d6a.iscfibroad2013_koodi = '03' or d7a.iscfibroad2013_koodi = '03' or d8a.iscfibroad2013_koodi = '03' or d9a.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6a.iscfibroad2013_koodi = '03' or d7a.iscfibroad2013_koodi = '03' or d8a.iscfibroad2013_koodi = '03' or d9a.iscfibroad2013_koodi = '03' or d10a.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7a.iscfibroad2013_koodi = '03' or d8a.iscfibroad2013_koodi = '03' or d9a.iscfibroad2013_koodi = '03' or d10a.iscfibroad2013_koodi = '03' or d11a.iscfibroad2013_koodi = '03') then 1*/
	else 0
end as opisk_amk_koulala3
--Opiskellut koulutusala4 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1a.iscfibroad2013_koodi = '04' or d2a.iscfibroad2013_koodi = '04' or d3a.iscfibroad2013_koodi = '04' or d4a.iscfibroad2013_koodi = '04' or d5a.iscfibroad2013_koodi = '04') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2a.iscfibroad2013_koodi = '04' or d3a.iscfibroad2013_koodi = '04' or d4a.iscfibroad2013_koodi = '04' or d5a.iscfibroad2013_koodi = '04' or d6a.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3a.iscfibroad2013_koodi = '04' or d4a.iscfibroad2013_koodi = '04' or d5a.iscfibroad2013_koodi = '04' or d6a.iscfibroad2013_koodi = '04' or d7a.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4a.iscfibroad2013_koodi = '04' or d5a.iscfibroad2013_koodi = '04' or d6a.iscfibroad2013_koodi = '04' or d7a.iscfibroad2013_koodi = '04' or d8a.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5a.iscfibroad2013_koodi = '04' or d6a.iscfibroad2013_koodi = '04' or d7a.iscfibroad2013_koodi = '04' or d8a.iscfibroad2013_koodi = '04' or d9a.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6a.iscfibroad2013_koodi = '04' or d7a.iscfibroad2013_koodi = '04' or d8a.iscfibroad2013_koodi = '04' or d9a.iscfibroad2013_koodi = '04' or d10a.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7a.iscfibroad2013_koodi = '04' or d8a.iscfibroad2013_koodi = '04' or d9a.iscfibroad2013_koodi = '04' or d10a.iscfibroad2013_koodi = '04' or d11a.iscfibroad2013_koodi = '04') then 1*/
	else 0
end as opisk_amk_koulala4
--Opiskellut koulutusala5 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1a.iscfibroad2013_koodi = '05' or d2a.iscfibroad2013_koodi = '05' or d3a.iscfibroad2013_koodi = '05' or d4a.iscfibroad2013_koodi = '05' or d5a.iscfibroad2013_koodi = '05') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2a.iscfibroad2013_koodi = '05' or d3a.iscfibroad2013_koodi = '05' or d4a.iscfibroad2013_koodi = '05' or d5a.iscfibroad2013_koodi = '05' or d6a.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3a.iscfibroad2013_koodi = '05' or d4a.iscfibroad2013_koodi = '05' or d5a.iscfibroad2013_koodi = '05' or d6a.iscfibroad2013_koodi = '05' or d7a.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4a.iscfibroad2013_koodi = '05' or d5a.iscfibroad2013_koodi = '05' or d6a.iscfibroad2013_koodi = '05' or d7a.iscfibroad2013_koodi = '05' or d8a.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5a.iscfibroad2013_koodi = '05' or d6a.iscfibroad2013_koodi = '05' or d7a.iscfibroad2013_koodi = '05' or d8a.iscfibroad2013_koodi = '05' or d9a.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6a.iscfibroad2013_koodi = '05' or d7a.iscfibroad2013_koodi = '05' or d8a.iscfibroad2013_koodi = '05' or d9a.iscfibroad2013_koodi = '05' or d10a.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7a.iscfibroad2013_koodi = '05' or d8a.iscfibroad2013_koodi = '05' or d9a.iscfibroad2013_koodi = '05' or d10a.iscfibroad2013_koodi = '05' or d11a.iscfibroad2013_koodi = '05') then 1*/
	else 0
end as opisk_amk_koulala5
--Opiskellut koulutusala6 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1a.iscfibroad2013_koodi = '06' or d2a.iscfibroad2013_koodi = '06' or d3a.iscfibroad2013_koodi = '06' or d4a.iscfibroad2013_koodi = '06' or d5a.iscfibroad2013_koodi = '06') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2a.iscfibroad2013_koodi = '06' or d3a.iscfibroad2013_koodi = '06' or d4a.iscfibroad2013_koodi = '06' or d5a.iscfibroad2013_koodi = '06' or d6a.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3a.iscfibroad2013_koodi = '06' or d4a.iscfibroad2013_koodi = '06' or d5a.iscfibroad2013_koodi = '06' or d6a.iscfibroad2013_koodi = '06' or d7a.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4a.iscfibroad2013_koodi = '06' or d5a.iscfibroad2013_koodi = '06' or d6a.iscfibroad2013_koodi = '06' or d7a.iscfibroad2013_koodi = '06' or d8a.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5a.iscfibroad2013_koodi = '06' or d6a.iscfibroad2013_koodi = '06' or d7a.iscfibroad2013_koodi = '06' or d8a.iscfibroad2013_koodi = '06' or d9a.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6a.iscfibroad2013_koodi = '06' or d7a.iscfibroad2013_koodi = '06' or d8a.iscfibroad2013_koodi = '06' or d9a.iscfibroad2013_koodi = '06' or d10a.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7a.iscfibroad2013_koodi = '06' or d8a.iscfibroad2013_koodi = '06' or d9a.iscfibroad2013_koodi = '06' or d10a.iscfibroad2013_koodi = '06' or d11a.iscfibroad2013_koodi = '06') then 1*/
	else 0
end as opisk_amk_koulala6
--Opiskellut koulutusala7 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1a.iscfibroad2013_koodi = '07' or d2a.iscfibroad2013_koodi = '07' or d3a.iscfibroad2013_koodi = '07' or d4a.iscfibroad2013_koodi = '07' or d5a.iscfibroad2013_koodi = '07') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2a.iscfibroad2013_koodi = '07' or d3a.iscfibroad2013_koodi = '07' or d4a.iscfibroad2013_koodi = '07' or d5a.iscfibroad2013_koodi = '07' or d6a.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3a.iscfibroad2013_koodi = '07' or d4a.iscfibroad2013_koodi = '07' or d5a.iscfibroad2013_koodi = '07' or d6a.iscfibroad2013_koodi = '07' or d7a.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4a.iscfibroad2013_koodi = '07' or d5a.iscfibroad2013_koodi = '07' or d6a.iscfibroad2013_koodi = '07' or d7a.iscfibroad2013_koodi = '07' or d8a.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5a.iscfibroad2013_koodi = '07' or d6a.iscfibroad2013_koodi = '07' or d7a.iscfibroad2013_koodi = '07' or d8a.iscfibroad2013_koodi = '07' or d9a.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6a.iscfibroad2013_koodi = '07' or d7a.iscfibroad2013_koodi = '07' or d8a.iscfibroad2013_koodi = '07' or d9a.iscfibroad2013_koodi = '07' or d10a.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7a.iscfibroad2013_koodi = '07' or d8a.iscfibroad2013_koodi = '07' or d9a.iscfibroad2013_koodi = '07' or d10a.iscfibroad2013_koodi = '07' or d11a.iscfibroad2013_koodi = '07') then 1*/
	else 0
end as opisk_amk_koulala7
--Opiskellut koulutusala8 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1a.iscfibroad2013_koodi = '08' or d2a.iscfibroad2013_koodi = '08' or d3a.iscfibroad2013_koodi = '08' or d4a.iscfibroad2013_koodi = '08' or d5a.iscfibroad2013_koodi = '08') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2a.iscfibroad2013_koodi = '08' or d3a.iscfibroad2013_koodi = '08' or d4a.iscfibroad2013_koodi = '08' or d5a.iscfibroad2013_koodi = '08' or d6a.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3a.iscfibroad2013_koodi = '08' or d4a.iscfibroad2013_koodi = '08' or d5a.iscfibroad2013_koodi = '08' or d6a.iscfibroad2013_koodi = '08' or d7a.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4a.iscfibroad2013_koodi = '08' or d5a.iscfibroad2013_koodi = '08' or d6a.iscfibroad2013_koodi = '08' or d7a.iscfibroad2013_koodi = '08' or d8a.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5a.iscfibroad2013_koodi = '08' or d6a.iscfibroad2013_koodi = '08' or d7a.iscfibroad2013_koodi = '08' or d8a.iscfibroad2013_koodi = '08' or d9a.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6a.iscfibroad2013_koodi = '08' or d7a.iscfibroad2013_koodi = '08' or d8a.iscfibroad2013_koodi = '08' or d9a.iscfibroad2013_koodi = '08' or d10a.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7a.iscfibroad2013_koodi = '08' or d8a.iscfibroad2013_koodi = '08' or d9a.iscfibroad2013_koodi = '08' or d10a.iscfibroad2013_koodi = '08' or d11a.iscfibroad2013_koodi = '08') then 1*/
	else 0
end as opisk_amk_koulala8
--Opiskellut koulutusala9 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1a.iscfibroad2013_koodi = '09' or d2a.iscfibroad2013_koodi = '09' or d3a.iscfibroad2013_koodi = '09' or d4a.iscfibroad2013_koodi = '09' or d5a.iscfibroad2013_koodi = '09') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2a.iscfibroad2013_koodi = '09' or d3a.iscfibroad2013_koodi = '09' or d4a.iscfibroad2013_koodi = '09' or d5a.iscfibroad2013_koodi = '09' or d6a.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3a.iscfibroad2013_koodi = '09' or d4a.iscfibroad2013_koodi = '09' or d5a.iscfibroad2013_koodi = '09' or d6a.iscfibroad2013_koodi = '09' or d7a.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4a.iscfibroad2013_koodi = '09' or d5a.iscfibroad2013_koodi = '09' or d6a.iscfibroad2013_koodi = '09' or d7a.iscfibroad2013_koodi = '09' or d8a.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5a.iscfibroad2013_koodi = '09' or d6a.iscfibroad2013_koodi = '09' or d7a.iscfibroad2013_koodi = '09' or d8a.iscfibroad2013_koodi = '09' or d9a.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6a.iscfibroad2013_koodi = '09' or d7a.iscfibroad2013_koodi = '09' or d8a.iscfibroad2013_koodi = '09' or d9a.iscfibroad2013_koodi = '09' or d10a.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7a.iscfibroad2013_koodi = '09' or d8a.iscfibroad2013_koodi = '09' or d9a.iscfibroad2013_koodi = '09' or d10a.iscfibroad2013_koodi = '09' or d11a.iscfibroad2013_koodi = '09') then 1*/
	else 0
end as opisk_amk_koulala9
--Opiskellut koulutusala10 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1a.iscfibroad2013_koodi = '10' or d2a.iscfibroad2013_koodi = '10' or d3a.iscfibroad2013_koodi = '10' or d4a.iscfibroad2013_koodi = '10' or d5a.iscfibroad2013_koodi = '10') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2a.iscfibroad2013_koodi = '10' or d3a.iscfibroad2013_koodi = '10' or d4a.iscfibroad2013_koodi = '10' or d5a.iscfibroad2013_koodi = '10' or d6a.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3a.iscfibroad2013_koodi = '10' or d4a.iscfibroad2013_koodi = '10' or d5a.iscfibroad2013_koodi = '10' or d6a.iscfibroad2013_koodi = '10' or d7a.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4a.iscfibroad2013_koodi = '10' or d5a.iscfibroad2013_koodi = '10' or d6a.iscfibroad2013_koodi = '10' or d7a.iscfibroad2013_koodi = '10' or d8a.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5a.iscfibroad2013_koodi = '10' or d6a.iscfibroad2013_koodi = '10' or d7a.iscfibroad2013_koodi = '10' or d8a.iscfibroad2013_koodi = '10' or d9a.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6a.iscfibroad2013_koodi = '10' or d7a.iscfibroad2013_koodi = '10' or d8a.iscfibroad2013_koodi = '10' or d9a.iscfibroad2013_koodi = '10' or d10a.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7a.iscfibroad2013_koodi = '10' or d8a.iscfibroad2013_koodi = '10' or d9a.iscfibroad2013_koodi = '10' or d10a.iscfibroad2013_koodi = '10' or d11a.iscfibroad2013_koodi = '10') then 1*/
	else 0
end as opisk_amk_koulala10



--Opiskellut koulutusala1 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1b.iscfibroad2013_koodi = '01' or d2b.iscfibroad2013_koodi = '01' or d3b.iscfibroad2013_koodi = '01' or d4b.iscfibroad2013_koodi = '01' or d5b.iscfibroad2013_koodi = '01') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2b.iscfibroad2013_koodi = '01' or d3b.iscfibroad2013_koodi = '01' or d4b.iscfibroad2013_koodi = '01' or d5b.iscfibroad2013_koodi = '01' or d6b.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3b.iscfibroad2013_koodi = '01' or d4b.iscfibroad2013_koodi = '01' or d5b.iscfibroad2013_koodi = '01' or d6b.iscfibroad2013_koodi = '01' or d7b.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4b.iscfibroad2013_koodi = '01' or d5b.iscfibroad2013_koodi = '01' or d6b.iscfibroad2013_koodi = '01' or d7b.iscfibroad2013_koodi = '01' or d8b.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5b.iscfibroad2013_koodi = '01' or d6b.iscfibroad2013_koodi = '01' or d7b.iscfibroad2013_koodi = '01' or d8b.iscfibroad2013_koodi = '01' or d9b.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6b.iscfibroad2013_koodi = '01' or d7b.iscfibroad2013_koodi = '01' or d8b.iscfibroad2013_koodi = '01' or d9b.iscfibroad2013_koodi = '01' or d10b.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7b.iscfibroad2013_koodi = '01' or d8b.iscfibroad2013_koodi = '01' or d9b.iscfibroad2013_koodi = '01' or d10b.iscfibroad2013_koodi = '01' or d11b.iscfibroad2013_koodi = '01') then 1*/
	else 0
end as opisk_yo_koulala1
--Opiskellut koulutusala2 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1b.iscfibroad2013_koodi = '02' or d2b.iscfibroad2013_koodi = '02' or d3b.iscfibroad2013_koodi = '02' or d4b.iscfibroad2013_koodi = '02' or d5b.iscfibroad2013_koodi = '02') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2b.iscfibroad2013_koodi = '02' or d3b.iscfibroad2013_koodi = '02' or d4b.iscfibroad2013_koodi = '02' or d5b.iscfibroad2013_koodi = '02' or d6b.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3b.iscfibroad2013_koodi = '02' or d4b.iscfibroad2013_koodi = '02' or d5b.iscfibroad2013_koodi = '02' or d6b.iscfibroad2013_koodi = '02' or d7b.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4b.iscfibroad2013_koodi = '02' or d5b.iscfibroad2013_koodi = '02' or d6b.iscfibroad2013_koodi = '02' or d7b.iscfibroad2013_koodi = '02' or d8b.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5b.iscfibroad2013_koodi = '02' or d6b.iscfibroad2013_koodi = '02' or d7b.iscfibroad2013_koodi = '02' or d8b.iscfibroad2013_koodi = '02' or d9b.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6b.iscfibroad2013_koodi = '02' or d7b.iscfibroad2013_koodi = '02' or d8b.iscfibroad2013_koodi = '02' or d9b.iscfibroad2013_koodi = '02' or d10b.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7b.iscfibroad2013_koodi = '02' or d8b.iscfibroad2013_koodi = '02' or d9b.iscfibroad2013_koodi = '02' or d10b.iscfibroad2013_koodi = '02' or d11b.iscfibroad2013_koodi = '02') then 1*/
	else 0
end as opisk_yo_koulala2
--Opiskellut koulutusala3 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1b.iscfibroad2013_koodi = '03' or d2b.iscfibroad2013_koodi = '03' or d3b.iscfibroad2013_koodi = '03' or d4b.iscfibroad2013_koodi = '03' or d5b.iscfibroad2013_koodi = '03') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2b.iscfibroad2013_koodi = '03' or d3b.iscfibroad2013_koodi = '03' or d4b.iscfibroad2013_koodi = '03' or d5b.iscfibroad2013_koodi = '03' or d6b.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3b.iscfibroad2013_koodi = '03' or d4b.iscfibroad2013_koodi = '03' or d5b.iscfibroad2013_koodi = '03' or d6b.iscfibroad2013_koodi = '03' or d7b.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4b.iscfibroad2013_koodi = '03' or d5b.iscfibroad2013_koodi = '03' or d6b.iscfibroad2013_koodi = '03' or d7b.iscfibroad2013_koodi = '03' or d8b.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5b.iscfibroad2013_koodi = '03' or d6b.iscfibroad2013_koodi = '03' or d7b.iscfibroad2013_koodi = '03' or d8b.iscfibroad2013_koodi = '03' or d9b.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6b.iscfibroad2013_koodi = '03' or d7b.iscfibroad2013_koodi = '03' or d8b.iscfibroad2013_koodi = '03' or d9b.iscfibroad2013_koodi = '03' or d10b.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7b.iscfibroad2013_koodi = '03' or d8b.iscfibroad2013_koodi = '03' or d9b.iscfibroad2013_koodi = '03' or d10b.iscfibroad2013_koodi = '03' or d11b.iscfibroad2013_koodi = '03') then 1*/
	else 0
end as opisk_yo_koulala3
--Opiskellut koulutusala4 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1b.iscfibroad2013_koodi = '04' or d2b.iscfibroad2013_koodi = '04' or d3b.iscfibroad2013_koodi = '04' or d4b.iscfibroad2013_koodi = '04' or d5b.iscfibroad2013_koodi = '04') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2b.iscfibroad2013_koodi = '04' or d3b.iscfibroad2013_koodi = '04' or d4b.iscfibroad2013_koodi = '04' or d5b.iscfibroad2013_koodi = '04' or d6b.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3b.iscfibroad2013_koodi = '04' or d4b.iscfibroad2013_koodi = '04' or d5b.iscfibroad2013_koodi = '04' or d6b.iscfibroad2013_koodi = '04' or d7b.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4b.iscfibroad2013_koodi = '04' or d5b.iscfibroad2013_koodi = '04' or d6b.iscfibroad2013_koodi = '04' or d7b.iscfibroad2013_koodi = '04' or d8b.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5b.iscfibroad2013_koodi = '04' or d6b.iscfibroad2013_koodi = '04' or d7b.iscfibroad2013_koodi = '04' or d8b.iscfibroad2013_koodi = '04' or d9b.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6b.iscfibroad2013_koodi = '04' or d7b.iscfibroad2013_koodi = '04' or d8b.iscfibroad2013_koodi = '04' or d9b.iscfibroad2013_koodi = '04' or d10b.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7b.iscfibroad2013_koodi = '04' or d8b.iscfibroad2013_koodi = '04' or d9b.iscfibroad2013_koodi = '04' or d10b.iscfibroad2013_koodi = '04' or d11b.iscfibroad2013_koodi = '04') then 1*/
	else 0
end as opisk_yo_koulala4
--Opiskellut koulutusala5 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1b.iscfibroad2013_koodi = '05' or d2b.iscfibroad2013_koodi = '05' or d3b.iscfibroad2013_koodi = '05' or d4b.iscfibroad2013_koodi = '05' or d5b.iscfibroad2013_koodi = '05') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2b.iscfibroad2013_koodi = '05' or d3b.iscfibroad2013_koodi = '05' or d4b.iscfibroad2013_koodi = '05' or d5b.iscfibroad2013_koodi = '05' or d6b.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3b.iscfibroad2013_koodi = '05' or d4b.iscfibroad2013_koodi = '05' or d5b.iscfibroad2013_koodi = '05' or d6b.iscfibroad2013_koodi = '05' or d7b.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4b.iscfibroad2013_koodi = '05' or d5b.iscfibroad2013_koodi = '05' or d6b.iscfibroad2013_koodi = '05' or d7b.iscfibroad2013_koodi = '05' or d8b.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5b.iscfibroad2013_koodi = '05' or d6b.iscfibroad2013_koodi = '05' or d7b.iscfibroad2013_koodi = '05' or d8b.iscfibroad2013_koodi = '05' or d9b.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6b.iscfibroad2013_koodi = '05' or d7b.iscfibroad2013_koodi = '05' or d8b.iscfibroad2013_koodi = '05' or d9b.iscfibroad2013_koodi = '05' or d10b.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7b.iscfibroad2013_koodi = '05' or d8b.iscfibroad2013_koodi = '05' or d9b.iscfibroad2013_koodi = '05' or d10b.iscfibroad2013_koodi = '05' or d11b.iscfibroad2013_koodi = '05') then 1*/
	else 0
end as opisk_yo_koulala5
--Opiskellut koulutusala6 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1b.iscfibroad2013_koodi = '06' or d2b.iscfibroad2013_koodi = '06' or d3b.iscfibroad2013_koodi = '06' or d4b.iscfibroad2013_koodi = '06' or d5b.iscfibroad2013_koodi = '06') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2b.iscfibroad2013_koodi = '06' or d3b.iscfibroad2013_koodi = '06' or d4b.iscfibroad2013_koodi = '06' or d5b.iscfibroad2013_koodi = '06' or d6b.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3b.iscfibroad2013_koodi = '06' or d4b.iscfibroad2013_koodi = '06' or d5b.iscfibroad2013_koodi = '06' or d6b.iscfibroad2013_koodi = '06' or d7b.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4b.iscfibroad2013_koodi = '06' or d5b.iscfibroad2013_koodi = '06' or d6b.iscfibroad2013_koodi = '06' or d7b.iscfibroad2013_koodi = '06' or d8b.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5b.iscfibroad2013_koodi = '06' or d6b.iscfibroad2013_koodi = '06' or d7b.iscfibroad2013_koodi = '06' or d8b.iscfibroad2013_koodi = '06' or d9b.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6b.iscfibroad2013_koodi = '06' or d7b.iscfibroad2013_koodi = '06' or d8b.iscfibroad2013_koodi = '06' or d9b.iscfibroad2013_koodi = '06' or d10b.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7b.iscfibroad2013_koodi = '06' or d8b.iscfibroad2013_koodi = '06' or d9b.iscfibroad2013_koodi = '06' or d10b.iscfibroad2013_koodi = '06' or d11b.iscfibroad2013_koodi = '06') then 1*/
	else 0
end as opisk_yo_koulala6
--Opiskellut koulutusala7 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1b.iscfibroad2013_koodi = '07' or d2b.iscfibroad2013_koodi = '07' or d3b.iscfibroad2013_koodi = '07' or d4b.iscfibroad2013_koodi = '07' or d5b.iscfibroad2013_koodi = '07') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2b.iscfibroad2013_koodi = '07' or d3b.iscfibroad2013_koodi = '07' or d4b.iscfibroad2013_koodi = '07' or d5b.iscfibroad2013_koodi = '07' or d6b.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3b.iscfibroad2013_koodi = '07' or d4b.iscfibroad2013_koodi = '07' or d5b.iscfibroad2013_koodi = '07' or d6b.iscfibroad2013_koodi = '07' or d7b.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4b.iscfibroad2013_koodi = '07' or d5b.iscfibroad2013_koodi = '07' or d6b.iscfibroad2013_koodi = '07' or d7b.iscfibroad2013_koodi = '07' or d8b.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5b.iscfibroad2013_koodi = '07' or d6b.iscfibroad2013_koodi = '07' or d7b.iscfibroad2013_koodi = '07' or d8b.iscfibroad2013_koodi = '07' or d9b.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6b.iscfibroad2013_koodi = '07' or d7b.iscfibroad2013_koodi = '07' or d8b.iscfibroad2013_koodi = '07' or d9b.iscfibroad2013_koodi = '07' or d10b.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7b.iscfibroad2013_koodi = '07' or d8b.iscfibroad2013_koodi = '07' or d9b.iscfibroad2013_koodi = '07' or d10b.iscfibroad2013_koodi = '07' or d11b.iscfibroad2013_koodi = '07') then 1*/
	else 0
end as opisk_yo_koulala7
--Opiskellut koulutusala8 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1b.iscfibroad2013_koodi = '08' or d2b.iscfibroad2013_koodi = '08' or d3b.iscfibroad2013_koodi = '08' or d4b.iscfibroad2013_koodi = '08' or d5b.iscfibroad2013_koodi = '08') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2b.iscfibroad2013_koodi = '08' or d3b.iscfibroad2013_koodi = '08' or d4b.iscfibroad2013_koodi = '08' or d5b.iscfibroad2013_koodi = '08' or d6b.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3b.iscfibroad2013_koodi = '08' or d4b.iscfibroad2013_koodi = '08' or d5b.iscfibroad2013_koodi = '08' or d6b.iscfibroad2013_koodi = '08' or d7b.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4b.iscfibroad2013_koodi = '08' or d5b.iscfibroad2013_koodi = '08' or d6b.iscfibroad2013_koodi = '08' or d7b.iscfibroad2013_koodi = '08' or d8b.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5b.iscfibroad2013_koodi = '08' or d6b.iscfibroad2013_koodi = '08' or d7b.iscfibroad2013_koodi = '08' or d8b.iscfibroad2013_koodi = '08' or d9b.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6b.iscfibroad2013_koodi = '08' or d7b.iscfibroad2013_koodi = '08' or d8b.iscfibroad2013_koodi = '08' or d9b.iscfibroad2013_koodi = '08' or d10b.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7b.iscfibroad2013_koodi = '08' or d8b.iscfibroad2013_koodi = '08' or d9b.iscfibroad2013_koodi = '08' or d10b.iscfibroad2013_koodi = '08' or d11b.iscfibroad2013_koodi = '08') then 1*/
	else 0
end as opisk_yo_koulala8
--Opiskellut koulutusala9 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1b.iscfibroad2013_koodi = '09' or d2b.iscfibroad2013_koodi = '09' or d3b.iscfibroad2013_koodi = '09' or d4b.iscfibroad2013_koodi = '09' or d5b.iscfibroad2013_koodi = '09') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2b.iscfibroad2013_koodi = '09' or d3b.iscfibroad2013_koodi = '09' or d4b.iscfibroad2013_koodi = '09' or d5b.iscfibroad2013_koodi = '09' or d6b.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3b.iscfibroad2013_koodi = '09' or d4b.iscfibroad2013_koodi = '09' or d5b.iscfibroad2013_koodi = '09' or d6b.iscfibroad2013_koodi = '09' or d7b.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4b.iscfibroad2013_koodi = '09' or d5b.iscfibroad2013_koodi = '09' or d6b.iscfibroad2013_koodi = '09' or d7b.iscfibroad2013_koodi = '09' or d8b.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5b.iscfibroad2013_koodi = '09' or d6b.iscfibroad2013_koodi = '09' or d7b.iscfibroad2013_koodi = '09' or d8b.iscfibroad2013_koodi = '09' or d9b.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6b.iscfibroad2013_koodi = '09' or d7b.iscfibroad2013_koodi = '09' or d8b.iscfibroad2013_koodi = '09' or d9b.iscfibroad2013_koodi = '09' or d10b.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7b.iscfibroad2013_koodi = '09' or d8b.iscfibroad2013_koodi = '09' or d9b.iscfibroad2013_koodi = '09' or d10b.iscfibroad2013_koodi = '09' or d11b.iscfibroad2013_koodi = '09') then 1*/
	else 0
end as opisk_yo_koulala9
--Opiskellut koulutusala10 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1b.iscfibroad2013_koodi = '10' or d2b.iscfibroad2013_koodi = '10' or d3b.iscfibroad2013_koodi = '10' or d4b.iscfibroad2013_koodi = '10' or d5b.iscfibroad2013_koodi = '10') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2b.iscfibroad2013_koodi = '10' or d3b.iscfibroad2013_koodi = '10' or d4b.iscfibroad2013_koodi = '10' or d5b.iscfibroad2013_koodi = '10' or d6b.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3b.iscfibroad2013_koodi = '10' or d4b.iscfibroad2013_koodi = '10' or d5b.iscfibroad2013_koodi = '10' or d6b.iscfibroad2013_koodi = '10' or d7b.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4b.iscfibroad2013_koodi = '10' or d5b.iscfibroad2013_koodi = '10' or d6b.iscfibroad2013_koodi = '10' or d7b.iscfibroad2013_koodi = '10' or d8b.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5b.iscfibroad2013_koodi = '10' or d6b.iscfibroad2013_koodi = '10' or d7b.iscfibroad2013_koodi = '10' or d8b.iscfibroad2013_koodi = '10' or d9b.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6b.iscfibroad2013_koodi = '10' or d7b.iscfibroad2013_koodi = '10' or d8b.iscfibroad2013_koodi = '10' or d9b.iscfibroad2013_koodi = '10' or d10b.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7b.iscfibroad2013_koodi = '10' or d8b.iscfibroad2013_koodi = '10' or d9b.iscfibroad2013_koodi = '10' or d10b.iscfibroad2013_koodi = '10' or d11b.iscfibroad2013_koodi = '10') then 1*/
	else 0
end as opisk_yo_koulala10


--Opiskellut useampaa kuin yhtä alaa (taso 1) (kyllä/ei)
,case --ensimmäisenä vuotena on mahdollista olla vain yksi ala
	when  l.suorlk = '2' and m1.MinValue <> m1.MaxValue then 1 
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and m2.MinValue <> m2.MaxValue then 1 
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and m3.MinValue <> m3.MaxValue then 1 
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and m4.MinValue <> m4.MaxValue then 1 
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and m5.MinValue <> m5.MaxValue then 1 
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and m6.MinValue <> m6.MaxValue then 1 
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and m7.MinValue <> m7.MaxValue then 1 */
	else 0
end as opisk_vah2_koulala


----HAUT KYLLÄ/EI
--Hakenut ammatilliseen koulutukseen
,case
	when  l.suorlk = '2' and (l.monihaku_1 in (2,3,5) or l.monihaku_2 in (2,3,5) or l.monihaku_3 in (2,3,5) or l.monihaku_4 in (2,3,5) or l.monihaku_5 in (2,3,5)) then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.monihaku_2 in (2,3,5) or l.monihaku_3 in (2,3,5) or l.monihaku_4 in (2,3,5) or l.monihaku_5 in (2,3,5) or l.monihaku2009 in (2,3,5)) then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.monihaku_3 in (2,3,5) or l.monihaku_4 in (2,3,5) or l.monihaku_5 in (2,3,5) or l.monihaku2009 in (2,3,5) or l.monihaku2010 in (2,3,5)) then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.monihaku_4 in (2,3,5) or l.monihaku_5 in (2,3,5) or l.monihaku2009 in (2,3,5) or l.monihaku2010 in (2,3,5) or l.monihaku2011 in (2,3,5)) then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.monihaku_5 in (2,3,5) or l.monihaku2009 in (2,3,5) or l.monihaku2010 in (2,3,5) or l.monihaku2011 in (2,3,5) or l.monihaku2012 in (2,3,5)) then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.monihaku2009 in (2,3,5) or l.monihaku2010 in (2,3,5) or l.monihaku2011 in (2,3,5) or l.monihaku2012 in (2,3,5) or l.monihaku2013 in (2,3,5)) then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.monihaku2010 in (2,3,5) or l.monihaku2011 in (2,3,5) or l.monihaku2012 in (2,3,5) or l.monihaku2013 in (2,3,5) or l.monihaku2014 in (2,3,5)) then 1*/
	else 0
end as haku_amm
--Hakenut ammattikorkeakoulutukseen
,case
	when  l.suorlk = '2' and (l.monihaku_1 in (4,6) or l.monihaku_2 in (4,6) or l.monihaku_3 in (4,6) or l.monihaku_4 in (4,6) or l.monihaku_5 in (4,6)) then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.monihaku_2 in (4,6) or l.monihaku_3 in (4,6) or l.monihaku_4 in (4,6) or l.monihaku_5 in (4,6) or l.monihaku2009 in (4,6)) then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.monihaku_3 in (4,6) or l.monihaku_4 in (4,6) or l.monihaku_5 in (4,6) or l.monihaku2009 in (4,6) or l.monihaku2010 in (4,6)) then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.monihaku_4 in (4,6) or l.monihaku_5 in (4,6) or l.monihaku2009 in (4,6) or l.monihaku2010 in (4,6) or l.monihaku2011 in (4,6)) then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.monihaku_5 in (4,6) or l.monihaku2009 in (4,6) or l.monihaku2010 in (4,6) or l.monihaku2011 in (4,6) or l.monihaku2012 in (4,6)) then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.monihaku2009 in (4,6) or l.monihaku2010 in (4,6) or l.monihaku2011 in (4,6) or l.monihaku2012 in (4,6) or l.monihaku2013 in (4,6)) then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.monihaku2010 in (4,6) or l.monihaku2011 in (4,6) or l.monihaku2012 in (4,6) or l.monihaku2013 in (4,6) or l.monihaku2014 in (4,6)) then 1*/
	else 0
end as haku_amk
--Hakenut yliopistokoulutukseen
,case
	when  l.suorlk = '2' and (l.monihaku_1 in (6,7) or l.monihaku_2 in (6,7) or l.monihaku_3 in (6,7) or l.monihaku_4 in (6,7) or l.monihaku_5 in (6,7)) then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.monihaku_2 in (6,7) or l.monihaku_3 in (6,7) or l.monihaku_4 in (6,7) or l.monihaku_5 in (6,7) or l.monihaku2009 in (6,7)) then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.monihaku_3 in (6,7) or l.monihaku_4 in (6,7) or l.monihaku_5 in (6,7) or l.monihaku2009 in (6,7) or l.monihaku2010 in (6,7)) then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.monihaku_4 in (6,7) or l.monihaku_5 in (6,7) or l.monihaku2009 in (6,7) or l.monihaku2010 in (6,7) or l.monihaku2011 in (6,7)) then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.monihaku_5 in (6,7) or l.monihaku2009 in (6,7) or l.monihaku2010 in (6,7) or l.monihaku2011 in (6,7) or l.monihaku2012 in (6,7)) then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.monihaku2009 in (6,7) or l.monihaku2010 in (6,7) or l.monihaku2011 in (6,7) or l.monihaku2012 in (6,7) or l.monihaku2013 in (6,7)) then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.monihaku2010 in (6,7) or l.monihaku2011 in (6,7) or l.monihaku2012 in (6,7) or l.monihaku2013 in (6,7) or l.monihaku2014 in (6,7)) then 1*/
	else 0
end as haku_yo




----MITTARIT
--Ei hakenut eikä opiskellut mitään
,case
	when  l.suorlk = '2' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and l.luopiskkoulk_1 = '' and l.ammopiskkoulk_1 = '' and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and monihaku_5 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and monihaku2014 not in (4,5,6,7) and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1*/
	else 0
end eihaku_kk_eiopisk

--Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa
,case 
	when  l.suorlk = '2' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and (l.luopiskkoulk_1 <> '' or l.ammopiskkoulk_1 <> '' or l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.ammopiskkoulk_5 <> '') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and (l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.ammopiskkoulk_5 <> '' or l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and (l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.ammopiskkoulk_5 <> '' or l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '') and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and (l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.ammopiskkoulk_5 <> '' or l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '') and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and monihaku_5 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and (l.luopiskkoulk_5 <> '' or l.ammopiskkoulk_5 <> '' or l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '') and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and (l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '' or l.ammopiskkoulk2013 <> '') and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and monihaku2014 not in (4,5,6,7) and (l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '' or l.ammopiskkoulk2013 <> '' or l.luopiskkoulk2014 <> '' or l.ammopiskkoulk2014 <> '') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1*/
	else 0
end eihaku_kk_eiopisk_kk_opisk_ta

----Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa, opiskellut lukiokoulutuksessa
,case 
	when  l.suorlk = '2' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and (l.luopiskkoulk_1 <> '' or l.luopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and (l.luopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.luopiskkoulk2009 <> '') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and (l.luopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.luopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '') and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and (l.luopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.luopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '') and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and monihaku_5 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and (l.luopiskkoulk_5 <> '' or l.luopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '') and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and (l.luopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '') and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and monihaku2014 not in (4,5,6,7) and (l.luopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '' or l.luopiskkoulk2014 <> '') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1*/
	else 0
end eihaku_kk_eiopisk_kk_opisk_lu

----Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa, opiskellut ammatillisessa peruskoulutuksessa
,case 
	when  l.suorlk = '2' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and (d1c.Koulutusaste_taso2_koodi = '32' or d2c.Koulutusaste_taso2_koodi = '32' or d3c.Koulutusaste_taso2_koodi = '32' or d4c.Koulutusaste_taso2_koodi = '32' or d5c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and (d2c.Koulutusaste_taso2_koodi = '32' or d3c.Koulutusaste_taso2_koodi = '32' or d4c.Koulutusaste_taso2_koodi = '32' or d5c.Koulutusaste_taso2_koodi = '32' or d6c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and (d3c.Koulutusaste_taso2_koodi = '32' or d4c.Koulutusaste_taso2_koodi = '32' or d5c.Koulutusaste_taso2_koodi = '32' or d6c.Koulutusaste_taso2_koodi = '32' or d7c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and (d4c.Koulutusaste_taso2_koodi = '32' or d5c.Koulutusaste_taso2_koodi = '32' or d6c.Koulutusaste_taso2_koodi = '32' or d7c.Koulutusaste_taso2_koodi = '32' or d8c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and monihaku_5 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and (d5c.Koulutusaste_taso2_koodi = '32' or d6c.Koulutusaste_taso2_koodi = '32' or d7c.Koulutusaste_taso2_koodi = '32' or d8c.Koulutusaste_taso2_koodi = '32' or d9c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and (d6c.Koulutusaste_taso2_koodi = '32' or d7c.Koulutusaste_taso2_koodi = '32' or d8c.Koulutusaste_taso2_koodi = '32' or d9c.Koulutusaste_taso2_koodi = '32' or d10c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and monihaku2014 not in (4,5,6,7) and (d7c.Koulutusaste_taso2_koodi = '32' or d8c.Koulutusaste_taso2_koodi = '32' or d9c.Koulutusaste_taso2_koodi = '32' or d10c.Koulutusaste_taso2_koodi = '32' or d11c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1*/
	else 0
end eihaku_kk_eiopisk_kk_opisk_pk

------Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa, opiskellut ammattitutkintokoulutuksessa
,case 
	when  l.suorlk = '2' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and (d1c.Koulutusaste_taso2_koodi = '33' or d2c.Koulutusaste_taso2_koodi = '33' or d3c.Koulutusaste_taso2_koodi = '33' or d4c.Koulutusaste_taso2_koodi = '33' or d5c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and (d2c.Koulutusaste_taso2_koodi = '33' or d3c.Koulutusaste_taso2_koodi = '33' or d4c.Koulutusaste_taso2_koodi = '33' or d5c.Koulutusaste_taso2_koodi = '33' or d6c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and (d3c.Koulutusaste_taso2_koodi = '33' or d4c.Koulutusaste_taso2_koodi = '33' or d5c.Koulutusaste_taso2_koodi = '33' or d6c.Koulutusaste_taso2_koodi = '33' or d7c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and (d4c.Koulutusaste_taso2_koodi = '33' or d5c.Koulutusaste_taso2_koodi = '33' or d6c.Koulutusaste_taso2_koodi = '33' or d7c.Koulutusaste_taso2_koodi = '33' or d8c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and monihaku_5 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and (d5c.Koulutusaste_taso2_koodi = '33' or d6c.Koulutusaste_taso2_koodi = '33' or d7c.Koulutusaste_taso2_koodi = '33' or d8c.Koulutusaste_taso2_koodi = '33' or d9c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and (d6c.Koulutusaste_taso2_koodi = '33' or d7c.Koulutusaste_taso2_koodi = '33' or d8c.Koulutusaste_taso2_koodi = '33' or d9c.Koulutusaste_taso2_koodi = '33' or d10c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and monihaku2014 not in (4,5,6,7) and (d7c.Koulutusaste_taso2_koodi = '33' or d8c.Koulutusaste_taso2_koodi = '33' or d9c.Koulutusaste_taso2_koodi = '33' or d10c.Koulutusaste_taso2_koodi = '33' or d11c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1*/
	else 0
end eihaku_kk_eiopisk_kk_opisk_at

------Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa, opiskellut erikoisammattitutkintokoulutuksessa
,case 
	when  l.suorlk = '2' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and (d1c.Koulutusaste_taso2_koodi = '41' or d2c.Koulutusaste_taso2_koodi = '41' or d3c.Koulutusaste_taso2_koodi = '41' or d4c.Koulutusaste_taso2_koodi = '41' or d5c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and (d2c.Koulutusaste_taso2_koodi = '41' or d3c.Koulutusaste_taso2_koodi = '41' or d4c.Koulutusaste_taso2_koodi = '41' or d5c.Koulutusaste_taso2_koodi = '41' or d6c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and (d3c.Koulutusaste_taso2_koodi = '41' or d4c.Koulutusaste_taso2_koodi = '41' or d5c.Koulutusaste_taso2_koodi = '41' or d6c.Koulutusaste_taso2_koodi = '41' or d7c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and (d4c.Koulutusaste_taso2_koodi = '41' or d5c.Koulutusaste_taso2_koodi = '41' or d6c.Koulutusaste_taso2_koodi = '41' or d7c.Koulutusaste_taso2_koodi = '41' or d8c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and monihaku_5 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and (d5c.Koulutusaste_taso2_koodi = '41' or d6c.Koulutusaste_taso2_koodi = '41' or d7c.Koulutusaste_taso2_koodi = '41' or d8c.Koulutusaste_taso2_koodi = '41' or d9c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and (d6c.Koulutusaste_taso2_koodi = '41' or d7c.Koulutusaste_taso2_koodi = '41' or d8c.Koulutusaste_taso2_koodi = '41' or d9c.Koulutusaste_taso2_koodi = '41' or d10c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and monihaku2014 not in (4,5,6,7) and (d7c.Koulutusaste_taso2_koodi = '41' or d8c.Koulutusaste_taso2_koodi = '41' or d9c.Koulutusaste_taso2_koodi = '41' or d10c.Koulutusaste_taso2_koodi = '41' or d11c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1*/
	else 0
end eihaku_kk_eiopisk_kk_opisk_eat

--Hakenut korkea-asteelle, ei opiskellut korkea-asteella
,case 
	when  l.suorlk = '2' and (monihaku_1 in (4,5,6,7) or monihaku_2 in (4,5,6,7) or monihaku_3 in (4,5,6,7) or monihaku_4 in (4,5,6,7) or monihaku_5 in (4,5,6,7)) and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (monihaku_2 in (4,5,6,7) or monihaku_3 in (4,5,6,7) or monihaku_4 in (4,5,6,7) or monihaku_5 in (4,5,6,7) or monihaku2009 in (4,5,6,7)) and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (monihaku_3 in (4,5,6,7) or monihaku_4 in (4,5,6,7) or monihaku_5 in (4,5,6,7) or monihaku2009 in (4,5,6,7) or monihaku2010 in (4,5,6,7)) and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (monihaku_4 in (4,5,6,7) or monihaku_5 in (4,5,6,7) or monihaku2009 in (4,5,6,7) or monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7)) and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (monihaku_5 in (4,5,6,7) or monihaku2009 in (4,5,6,7) or monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7) or monihaku2012 in (4,5,6,7)) and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (monihaku2009 in (4,5,6,7) or monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7) or monihaku2012 in (4,5,6,7) or monihaku2013 in (4,5,6,7)) and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7) or monihaku2012 in (4,5,6,7) or monihaku2013 in (4,5,6,7) or monihaku2014 in (4,5,6,7)) and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1*/
	else 0
end haku_kk_eiopisk_kk
----Hakenut korkea-asteelle, ei opiskellut korkea-asteella, ei-opiskellut toisen asteen koulutuksessa
,case
	when  l.suorlk = '2' and (monihaku_1 in (4,5,6,7) or monihaku_2 in (4,5,6,7) or monihaku_3 in (4,5,6,7) or monihaku_4 in (4,5,6,7) or monihaku_5 in (4,5,6,7)) and l.luopiskkoulk_1 = '' and l.ammopiskkoulk_1 = '' and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (monihaku_2 in (4,5,6,7) or monihaku_3 in (4,5,6,7) or monihaku_4 in (4,5,6,7) or monihaku_5 in (4,5,6,7) or monihaku2009 in (4,5,6,7)) and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (monihaku_3 in (4,5,6,7) or monihaku_4 in (4,5,6,7) or monihaku_5 in (4,5,6,7) or monihaku2009 in (4,5,6,7) or monihaku2010 in (4,5,6,7)) and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (monihaku_4 in (4,5,6,7) or monihaku_5 in (4,5,6,7) or monihaku2009 in (4,5,6,7) or monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7)) and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (monihaku_5 in (4,5,6,7) or monihaku2009 in (4,5,6,7) or monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7) or monihaku2012 in (4,5,6,7)) and l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (monihaku2009 in (4,5,6,7) or monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7) or monihaku2012 in (4,5,6,7) or monihaku2013 in (4,5,6,7)) and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7) or monihaku2012 in (4,5,6,7) or monihaku2013 in (4,5,6,7) or monihaku2014 in (4,5,6,7)) and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1*/
	else 0
end haku_kk_eiopisk_kk_eiopisk_ta
----Hakenut korkea-asteelle, ei opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa
,case
	when  l.suorlk = '2' and (monihaku_1 in (4,5,6,7) or monihaku_2 in (4,5,6,7) or monihaku_3 in (4,5,6,7) or monihaku_4 in (4,5,6,7) or monihaku_5 in (4,5,6,7)) and (l.luopiskkoulk_1 <> '' or l.ammopiskkoulk_1 <> '' or l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.ammopiskkoulk_5 <> '') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (monihaku_2 in (4,5,6,7) or monihaku_3 in (4,5,6,7) or monihaku_4 in (4,5,6,7) or monihaku_5 in (4,5,6,7) or monihaku2009 in (4,5,6,7)) and (l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.ammopiskkoulk_5 <> '' or l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (monihaku_3 in (4,5,6,7) or monihaku_4 in (4,5,6,7) or monihaku_5 in (4,5,6,7) or monihaku2009 in (4,5,6,7) or monihaku2010 in (4,5,6,7)) and (l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.ammopiskkoulk_5 <> '' or l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '') and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (monihaku_4 in (4,5,6,7) or monihaku_5 in (4,5,6,7) or monihaku2009 in (4,5,6,7) or monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7)) and (l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.ammopiskkoulk_5 <> '' or l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '') and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (monihaku_5 in (4,5,6,7) or monihaku2009 in (4,5,6,7) or monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7) or monihaku2012 in (4,5,6,7)) and (l.luopiskkoulk_5 <> '' or l.ammopiskkoulk_5 <> '' or l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '') and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (monihaku2009 in (4,5,6,7) or monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7) or monihaku2012 in (4,5,6,7) or monihaku2013 in (4,5,6,7)) and (l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '' or l.ammopiskkoulk2013 <> '') and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7) or monihaku2012 in (4,5,6,7) or monihaku2013 in (4,5,6,7) or monihaku2014 in (4,5,6,7)) and (l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '' or l.ammopiskkoulk2013 <> '' or l.luopiskkoulk2014 <> '' or l.ammopiskkoulk2014 <> '') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1*/
	else 0
end haku_kk_eiopisk_kk_opisk_ta
----Hakenut vain ammattikorkeakouluun, ei opiskellut korkea-asteella
,case
	when  l.suorlk = '2' and (monihaku_1 = 4 or monihaku_2 = 4 or monihaku_3 = 4 or monihaku_4 = 4 or monihaku_5 = 4) and (monihaku_1 not in (5,6,7) and monihaku_2 not in (5,6,7) and monihaku_3 not in (5,6,7) and monihaku_4 not in (5,6,7) and monihaku_5 not in (5,6,7)) and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (monihaku_2 = 4 or monihaku_3 = 4 or monihaku_4 = 4 or monihaku_5 = 4 or monihaku2009 = 4) and (monihaku_2 not in (5,6,7) and monihaku_3 not in (5,6,7) and monihaku_4 not in (5,6,7) and monihaku_5 not in (5,6,7) and monihaku2009 not in (5,6,7)) and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (monihaku_3 = 4 or monihaku_4 = 4 or monihaku_5 = 4 or monihaku2009 = 4 or monihaku2010 = 4) and (monihaku_3 not in (5,6,7) and monihaku_4 not in (5,6,7) and monihaku_5 not in (5,6,7) and monihaku2009 not in (5,6,7) and monihaku2010 not in (5,6,7)) and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (monihaku_4 = 4 or monihaku_5 = 4 or monihaku2009 = 4 or monihaku2010 = 4 or monihaku2011 = 4) and (monihaku_4 not in (5,6,7) and monihaku_5 not in (5,6,7) and monihaku2009 not in (5,6,7) and monihaku2010 not in (5,6,7) and monihaku2011 not in (5,6,7)) and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (monihaku_5 = 4 or monihaku2009 = 4 or monihaku2010 = 4 or monihaku2011 = 4 or monihaku2012 = 4) and (monihaku_5 not in (5,6,7) and monihaku2009 not in (5,6,7) and monihaku2010 not in (5,6,7) and monihaku2011 not in (5,6,7) and monihaku2012 not in (5,6,7)) and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (monihaku2009 = 4 or monihaku2010 = 4 or monihaku2011 = 4 or monihaku2012 = 4 or monihaku2013 = 4) and (monihaku2009 not in (5,6,7) and monihaku2010 not in (5,6,7) and monihaku2011 not in (5,6,7) and monihaku2012 not in (5,6,7) and monihaku2013 not in (5,6,7)) and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (monihaku2010 = 4 or monihaku2011 = 4 or monihaku2012 = 4 or monihaku2013 = 4 or monihaku2014 = 4) and (monihaku2010 not in (5,6,7) and monihaku2011 not in (5,6,7) and monihaku2012 not in (5,6,7) and monihaku2013 not in (5,6,7) and monihaku2014 not in (5,6,7)) and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1*/
	else 0
end haku_amk_eiopisk_kk
----Hakenut vain yliopistokoulutukseen, ei opiskellut korkea-asteella
,case
	when  l.suorlk = '2' and (monihaku_1 = 7 or monihaku_2 = 7 or monihaku_3 = 7 or monihaku_4 = 7 or monihaku_5 = 7) and (monihaku_1 not in (4,5,6) and monihaku_2 not in (4,5,6) and monihaku_3 not in (4,5,6) and monihaku_4 not in (4,5,6) and monihaku_5 not in (4,5,6)) and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (monihaku_2 = 7 or monihaku_3 = 7 or monihaku_4 = 7 or monihaku_5 = 7 or monihaku2009 = 7) and (monihaku_2 not in (4,5,6) and monihaku_3 not in (4,5,6) and monihaku_4 not in (4,5,6) and monihaku_5 not in (4,5,6) and monihaku2009 not in (4,5,6)) and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (monihaku_3 = 7 or monihaku_4 = 7 or monihaku_5 = 7 or monihaku2009 = 7 or monihaku2010 = 7) and (monihaku_3 not in (4,5,6) and monihaku_4 not in (4,5,6) and monihaku_5 not in (4,5,6) and monihaku2009 not in (4,5,6) and monihaku2010 not in (4,5,6)) and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (monihaku_4 = 7 or monihaku_5 = 7 or monihaku2009 = 7 or monihaku2010 = 7 or monihaku2011 = 7) and (monihaku_4 not in (4,5,6) and monihaku_5 not in (4,5,6) and monihaku2009 not in (4,5,6) and monihaku2010 not in (4,5,6) and monihaku2011 not in (4,5,6)) and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (monihaku_5 = 7 or monihaku2009 = 7 or monihaku2010 = 7 or monihaku2011 = 7 or monihaku2012 = 7) and (monihaku_5 not in (4,5,6) and monihaku2009 not in (4,5,6) and monihaku2010 not in (4,5,6) and monihaku2011 not in (4,5,6) and monihaku2012 not in (4,5,6)) and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (monihaku2009 = 7 or monihaku2010 = 7 or monihaku2011 = 7 or monihaku2012 = 7 or monihaku2013 = 7) and (monihaku2009 not in (4,5,6) and monihaku2010 not in (4,5,6) and monihaku2011 not in (4,5,6) and monihaku2012 not in (4,5,6) and monihaku2013 not in (4,5,6)) and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (monihaku2010 = 7 or monihaku2011 = 7 or monihaku2012 = 7 or monihaku2013 = 7 or monihaku2014 = 7) and (monihaku2010 not in (4,5,6) and monihaku2011 not in (4,5,6) and monihaku2012 not in (4,5,6) and monihaku2013 not in (4,5,6) and monihaku2014 not in (4,5,6)) and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1*/
	else 0
end haku_yo_eiopisk_kk
----Hakenut sekä amk- että yliopistokoulutukseen, ei opiskellut korkea-asteella
,case
	when  l.suorlk = '2' and (monihaku_1 = 6 or monihaku_2 = 6 or monihaku_3 = 6 or monihaku_4 = 6 or monihaku_5 = 6 or ((monihaku_1 = 4 or monihaku_2 = 4 or monihaku_3 = 4 or monihaku_4 = 4 or monihaku_5 = 4) and (monihaku_1 = 7 or monihaku_2 = 7 or monihaku_3 = 7 or monihaku_4 = 7 or monihaku_5 = 7))) and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (monihaku_2 = 6 or monihaku_3 = 6 or monihaku_4 = 6 or monihaku_5 = 6 or monihaku2009 = 6 or ((monihaku_2 = 4 or monihaku_3 = 4 or monihaku_4 = 4 or monihaku_5 = 4 or monihaku2009 = 4) and (monihaku_2 = 7 or monihaku_3 = 7 or monihaku_4 = 7 or monihaku_5 = 7 or monihaku2009 = 7))) and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (monihaku_3 = 6 or monihaku_4 = 6 or monihaku_5 = 6 or monihaku2009 = 6 or monihaku2010 = 6 or ((monihaku_3 = 4 or monihaku_4 = 4 or monihaku_5 = 4 or monihaku2009 = 4 or monihaku2010 = 4) and (monihaku_3 = 7 or monihaku_4 = 7 or monihaku_5 = 7 or monihaku2009 = 7 or monihaku2010 = 7))) and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (monihaku_4 = 6 or monihaku_5 = 6 or monihaku2009 = 6 or monihaku2010 = 6 or monihaku2011 = 6 or ((monihaku_4 = 4 or monihaku_5 = 4 or monihaku2009 = 4 or monihaku2010 = 4 or monihaku2011 = 4) and (monihaku_4 = 7 or monihaku_5 = 7 or monihaku2009 = 7 or monihaku2010 = 7 or monihaku2011 = 7))) and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (monihaku_5 = 6 or monihaku2009 = 6 or monihaku2010 = 6 or monihaku2011 = 6 or monihaku2012 = 6 or ((monihaku_5 = 4 or monihaku2009 = 4 or monihaku2010 = 4 or monihaku2011 = 4 or monihaku2012 = 4) and (monihaku_5 = 7 or monihaku2009 = 7 or monihaku2010 = 7 or monihaku2011 = 7 or monihaku2012 = 7))) and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (monihaku2009 = 6 or monihaku2010 = 6 or monihaku2011 = 6 or monihaku2012 = 6 or monihaku2013 = 6 or ((monihaku2009 = 4 or monihaku2010 = 4 or monihaku2011 = 4 or monihaku2012 = 4 or monihaku2013 = 4) and (monihaku2009 = 7 or monihaku2010 = 7 or monihaku2011 = 7 or monihaku2012 = 7 or monihaku2013 = 7))) and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (monihaku2010 = 6 or monihaku2011 = 6 or monihaku2012 = 6 or monihaku2013 = 6 or monihaku2014 = 6 or ((monihaku2010 = 4 or monihaku2011 = 4 or monihaku2012 = 4 or monihaku2013 = 4 or monihaku2014 = 4) and (monihaku2010 = 7 or monihaku2011 = 7 or monihaku2012 = 7 or monihaku2013 = 7 or monihaku2014 = 7))) and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1*/
	else 0
end haku_amkyo_eiopisk_kk

--Opiskellut korkea-asteella
,case
	when  l.suorlk = '2' and (l.amkopiskkoulk_1 <> '' or l.yoopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.yoopiskkoulk_5 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.yoopiskkoulk_5 <> '' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.yoopiskkoulk_5 <> '' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.yoopiskkoulk_5 <> '' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk_5 <> '' or l.yoopiskkoulk_5 <> '' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '' or l.yoopiskkoulk2013 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '' or l.yoopiskkoulk2013 <> '' or l.amkopiskkoulk2014 <> '' or l.yoopiskkoulk2014 <> '') then 1*/
	else 0
end opisk_kk
----Opiskellut korkea-asteella, ei-opiskellut toisen asteen koulutuksessa
,case
	when  l.suorlk = '2' and l.luopiskkoulk_1 = '' and l.ammopiskkoulk_1 = '' and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = '' and (l.amkopiskkoulk_1 <> '' or l.yoopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.yoopiskkoulk_5 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = '' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and (l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.yoopiskkoulk_5 <> '' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = '' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and (l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.yoopiskkoulk_5 <> '' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = '' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and (l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.yoopiskkoulk_5 <> '' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = '' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and (l.amkopiskkoulk_5 <> '' or l.yoopiskkoulk_5 <> '' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = '' and (l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '' or l.yoopiskkoulk2013 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = '' and l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 = '' and (l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '' or l.yoopiskkoulk2013 <> '' or l.amkopiskkoulk2014 <> '' or l.yoopiskkoulk2014 <> '') then 1*/
	else 0
end opisk_kk_eiopisk_ta
----Opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa
,case
	when  l.suorlk = '2' and (l.luopiskkoulk_1 <> '' or l.ammopiskkoulk_1 <> '' or l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.ammopiskkoulk_5 <> '') and (l.amkopiskkoulk_1 <> '' or l.yoopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.yoopiskkoulk_5 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.ammopiskkoulk_5 <> '' or l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '') and (l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.yoopiskkoulk_5 <> '' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.ammopiskkoulk_5 <> '' or l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '') and (l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.yoopiskkoulk_5 <> '' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.ammopiskkoulk_5 <> '' or l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '') and (l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.yoopiskkoulk_5 <> '' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk_5 <> '' or l.ammopiskkoulk_5 <> '' or l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '') and (l.amkopiskkoulk_5 <> '' or l.yoopiskkoulk_5 <> '' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '' or l.ammopiskkoulk2013 <> '') and (l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '' or l.yoopiskkoulk2013 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '' or l.ammopiskkoulk2013 <> '' or l.luopiskkoulk2014 <> '' or l.ammopiskkoulk2014 <> '') and (l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '' or l.yoopiskkoulk2013 <> '' or l.amkopiskkoulk2014 <> '' or l.yoopiskkoulk2014 <> '') then 1*/
	else 0
end opisk_kk_opisk_ta
----Opiskellut vain ammattikorkeakoulussa
,case
	when  l.suorlk = '2' and (l.amkopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '') and l.yoopiskkoulk_1 = '' and l.yoopiskkoulk_2 = '' and l.yoopiskkoulk_3 = '' and l.yoopiskkoulk_4 = '' and l.yoopiskkoulk_5 = ''then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.amkopiskkoulk2009 <> '') and l.yoopiskkoulk_2 = '' and l.yoopiskkoulk_3 = '' and l.yoopiskkoulk_4 = '' and l.yoopiskkoulk_5 = '' and l.yoopiskkoulk2009 = ''then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.amkopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '') and l.yoopiskkoulk_3 = '' and l.yoopiskkoulk_4 = '' and l.yoopiskkoulk_5 = '' and l.yoopiskkoulk2009 = '' and l.yoopiskkoulk2010 = ''then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.amkopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '') and l.yoopiskkoulk_4 = '' and l.yoopiskkoulk_5 = '' and l.yoopiskkoulk2009 = '' and l.yoopiskkoulk2010 = '' and l.yoopiskkoulk2011 = ''then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk_5 <> '' or l.amkopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '') and l.yoopiskkoulk_5 = '' and l.yoopiskkoulk2009 = '' and l.yoopiskkoulk2010 = '' and l.yoopiskkoulk2011 = '' and l.yoopiskkoulk2012 = ''then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '') and l.yoopiskkoulk2009 = '' and l.yoopiskkoulk2010 = '' and l.yoopiskkoulk2011 = '' and l.yoopiskkoulk2012 = '' and l.yoopiskkoulk2013 = ''then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '' or l.amkopiskkoulk2014 <> '') and l.yoopiskkoulk2010 = '' and l.yoopiskkoulk2011 = '' and l.yoopiskkoulk2012 = '' and l.yoopiskkoulk2013 = '' and l.yoopiskkoulk2014 = ''then 1*/
	else 0
end opisk_vain_amk
----Opiskellut vain yliopistokoulutuksessa
,case
	when  l.suorlk = '2' and l.amkopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and (l.yoopiskkoulk_1 <> '' or l.yoopiskkoulk_2 <> '' or l.yoopiskkoulk_3 <> '' or l.yoopiskkoulk_4 <> '' or l.yoopiskkoulk_5 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and l.amkopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and (l.yoopiskkoulk_2 <> '' or l.yoopiskkoulk_3 <> '' or l.yoopiskkoulk_4 <> '' or l.yoopiskkoulk_5 <> '' or l.yoopiskkoulk2009 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and l.amkopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and (l.yoopiskkoulk_3 <> '' or l.yoopiskkoulk_4 <> '' or l.yoopiskkoulk_5 <> '' or l.yoopiskkoulk2009 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and l.amkopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and (l.yoopiskkoulk_4 <> '' or l.yoopiskkoulk_5 <> '' or l.yoopiskkoulk2009 <> '' or l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and l.amkopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and (l.yoopiskkoulk_5 <> '' or l.yoopiskkoulk2009 <> '' or l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '' or l.yoopiskkoulk2012 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and l.amkopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and (l.yoopiskkoulk2009 <> '' or l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '' or l.yoopiskkoulk2012 <> '' or l.yoopiskkoulk2013 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and l.amkopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and (l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '' or l.yoopiskkoulk2012 <> '' or l.yoopiskkoulk2013 <> '' or l.yoopiskkoulk2014 <> '') then 1*/
	else 0
end opisk_vain_yo
----Opiskellut sekä amk- että yliopistokoulutuksessa
,case
	when  l.suorlk = '2' and (l.amkopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '') and (l.yoopiskkoulk_1 <> '' or l.yoopiskkoulk_2 <> '' or l.yoopiskkoulk_3 <> '' or l.yoopiskkoulk_4 <> '' or l.yoopiskkoulk_5 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.amkopiskkoulk2009 <> '') and (l.yoopiskkoulk_2 <> '' or l.yoopiskkoulk_3 <> '' or l.yoopiskkoulk_4 <> '' or l.yoopiskkoulk_5 <> '' or l.yoopiskkoulk2009 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.amkopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '') and (l.yoopiskkoulk_3 <> '' or l.yoopiskkoulk_4 <> '' or l.yoopiskkoulk_5 <> '' or l.yoopiskkoulk2009 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.amkopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '') and (l.yoopiskkoulk_4 <> '' or l.yoopiskkoulk_5 <> '' or l.yoopiskkoulk2009 <> '' or l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk_5 <> '' or l.amkopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '') and (l.yoopiskkoulk_5 <> '' or l.yoopiskkoulk2009 <> '' or l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '' or l.yoopiskkoulk2012 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '') and (l.yoopiskkoulk2009 <> '' or l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '' or l.yoopiskkoulk2012 <> '' or l.yoopiskkoulk2013 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '' or l.amkopiskkoulk2014 <> '') and (l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '' or l.yoopiskkoulk2012 <> '' or l.yoopiskkoulk2013 <> '' or l.yoopiskkoulk2014 <> '') then 1*/
	else 0
end opisk_amkyo


	 
FROM 
    (
	select * from [VipunenTK_SA].[dbo].[v_K3_13_Perusk_paattaneet_amm_tutk_suorittaneet]
	where suorlk = '2'
	
	) as l

LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d1a on d1a.koulutusluokitus_avain=l.amkopiskkoulk_1
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d2a on d2a.koulutusluokitus_avain=l.amkopiskkoulk_2
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d3a on d3a.koulutusluokitus_avain=l.amkopiskkoulk_3
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d4a on d4a.koulutusluokitus_avain=l.amkopiskkoulk_4
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d5a on d5a.koulutusluokitus_avain=l.amkopiskkoulk_5
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d6a on d6a.koulutusluokitus_avain=l.amkopiskkoulk_6
/*LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d7a on d7a.koulutusluokitus_avain=l.amkopiskkoulk2010
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d8a on d8a.koulutusluokitus_avain=l.amkopiskkoulk2011
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d9a on d9a.koulutusluokitus_avain=l.amkopiskkoulk2012
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d10a on d10a.koulutusluokitus_avain=l.amkopiskkoulk2013
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d11a on d11a.koulutusluokitus_avain=l.amkopiskkoulk2014*/

LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d1b on d1b.koulutusluokitus_avain=l.yoopiskkoulk_1
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d2b on d2b.koulutusluokitus_avain=l.yoopiskkoulk_2
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d3b on d3b.koulutusluokitus_avain=l.yoopiskkoulk_3
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d4b on d4b.koulutusluokitus_avain=l.yoopiskkoulk_4
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d5b on d5b.koulutusluokitus_avain=l.yoopiskkoulk_5
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d6b on d6b.koulutusluokitus_avain=l.yoopiskkoulk_6
/*LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d7b on d7b.koulutusluokitus_avain=l.yoopiskkoulk2010
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d8b on d8b.koulutusluokitus_avain=l.yoopiskkoulk2011	
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d9b on d9b.koulutusluokitus_avain=l.yoopiskkoulk2012
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d10b on d10b.koulutusluokitus_avain=l.yoopiskkoulk2013
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d11b on d11b.koulutusluokitus_avain=l.yoopiskkoulk2014	*/

LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d1c on d1c.koulutusluokitus_avain=l.ammopiskkoulk_1
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d2c on d2c.koulutusluokitus_avain=l.ammopiskkoulk_2
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d3c on d3c.koulutusluokitus_avain=l.ammopiskkoulk_3
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d4c on d4c.koulutusluokitus_avain=l.ammopiskkoulk_4
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d5c on d5c.koulutusluokitus_avain=l.ammopiskkoulk_5
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d6c on d6c.koulutusluokitus_avain=l.ammopiskkoulk_6
/*LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d7c on d7c.koulutusluokitus_avain=l.ammopiskkoulk2010
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d8c on d8c.koulutusluokitus_avain=l.ammopiskkoulk2011
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d9c on d9c.koulutusluokitus_avain=l.ammopiskkoulk2012
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d10c on d10c.koulutusluokitus_avain=l.ammopiskkoulk2013
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d11c on d11c.koulutusluokitus_avain=l.ammopiskkoulk2014*/
	
CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d1a.iscfibroad2013_koodi),(d1b.iscfibroad2013_koodi), (d2a.iscfibroad2013_koodi),(d2b.iscfibroad2013_koodi), (d3a.iscfibroad2013_koodi),(d3b.iscfibroad2013_koodi), (d4a.iscfibroad2013_koodi),(d4b.iscfibroad2013_koodi), (d5a.iscfibroad2013_koodi),(d5b.iscfibroad2013_koodi)) AS a(d)) m1
CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d2a.iscfibroad2013_koodi),(d2b.iscfibroad2013_koodi), (d3a.iscfibroad2013_koodi),(d3b.iscfibroad2013_koodi), (d4a.iscfibroad2013_koodi),(d4b.iscfibroad2013_koodi), (d5a.iscfibroad2013_koodi),(d5b.iscfibroad2013_koodi), (d6a.iscfibroad2013_koodi),(d6b.iscfibroad2013_koodi)) AS a(d)) m2
/*CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d3a.iscfibroad2013_koodi),(d3b.iscfibroad2013_koodi), (d4a.iscfibroad2013_koodi),(d4b.iscfibroad2013_koodi), (d5a.iscfibroad2013_koodi),(d5b.iscfibroad2013_koodi), (d6a.iscfibroad2013_koodi),(d6b.iscfibroad2013_koodi), (d7a.iscfibroad2013_koodi),(d7b.iscfibroad2013_koodi)) AS a(d)) m3
CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d4a.iscfibroad2013_koodi),(d4b.iscfibroad2013_koodi), (d5a.iscfibroad2013_koodi),(d5b.iscfibroad2013_koodi), (d6a.iscfibroad2013_koodi),(d6b.iscfibroad2013_koodi), (d7a.iscfibroad2013_koodi),(d7b.iscfibroad2013_koodi), (d8a.iscfibroad2013_koodi),(d8b.iscfibroad2013_koodi)) AS a(d)) m4
CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d5a.iscfibroad2013_koodi),(d5b.iscfibroad2013_koodi), (d6a.iscfibroad2013_koodi),(d6b.iscfibroad2013_koodi), (d7a.iscfibroad2013_koodi),(d7b.iscfibroad2013_koodi), (d8a.iscfibroad2013_koodi),(d8b.iscfibroad2013_koodi), (d9a.iscfibroad2013_koodi),(d9b.iscfibroad2013_koodi)) AS a(d)) m5
CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d6a.iscfibroad2013_koodi),(d6b.iscfibroad2013_koodi), (d7a.iscfibroad2013_koodi),(d7b.iscfibroad2013_koodi), (d8a.iscfibroad2013_koodi),(d8b.iscfibroad2013_koodi), (d9a.iscfibroad2013_koodi),(d9b.iscfibroad2013_koodi), (d10a.iscfibroad2013_koodi),(d10b.iscfibroad2013_koodi)) AS a(d)) m6
CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d7a.iscfibroad2013_koodi),(d7b.iscfibroad2013_koodi), (d8a.iscfibroad2013_koodi),(d8b.iscfibroad2013_koodi), (d9a.iscfibroad2013_koodi),(d9b.iscfibroad2013_koodi), (d10a.iscfibroad2013_koodi),(d10b.iscfibroad2013_koodi), (d11a.iscfibroad2013_koodi),(d11b.iscfibroad2013_koodi)) AS a(d)) m7*/

	
	WHERE 1=1

--end;

--
-- TULOS
-- 
/*
if @debug_what_to_run>=3 begin
	if @debug_what_to_run>0 print 'querying result';
	select * from [VipunenTK_DW].[dbo].[_koulutukseen_sijoittuneet_6v]
	--select COUNT(*) from vipunen_tk.f_tyol_ja_jatko_opin_ where aineisto=(select id from vipunen_tk.d_aineisto where aineistokoodi='4.3' and @toinen_suoritusvuosi between alkaa and paattyy)
end;

if @debug_what_to_run>0 PRINT 'all done.';
*/


GO
/****** Object:  StoredProcedure [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_4_0_tarkastelujakso]    Script Date: 29.8.2018 15:59:41 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE PROCEDURE [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_4_0_tarkastelujakso] AS
/*declare @debug_what_to_run tinyint; set @debug_what_to_run=2; -- käytä arvoa 3 vain kun teet yhden vuoden
print '$'+convert(varchar,sysdatetime(),20)+'$ '+'DEBUG (what to run)='+cast(@debug_what_to_run as varchar)+
': 0=luo vain taulut, älä tulosta mitään; 1=luo taulut ja tulosta joitakin merkittävimpiä välivaiheita; 2=luo taulut ja tulosta välivaiheet; 3=luo taulut, tulosta välivaiheet ja tulosta myös tulokset, 4=tulosta välivaiheet, mutta älä tee mitään';




-- lisätään data
if @debug_what_to_run not in (4) begin
if @debug_what_to_run>0 print 'inserting data';

-- parametrimuuttujien arvot
-- parametrimuuttujat
DECLARE @ensimmainen_suoritusvuosi int;
DECLARE @toinen_suoritusvuosi int;
DECLARE @kolmas_suoritusvuosi int;
DECLARE @neljas_suoritusvuosi int;
DECLARE @viides_suoritusvuosi int;
DECLARE @kuudes_suoritusvuosi int;
DECLARE @seitsemas_suoritusvuosi int;


set @ensimmainen_suoritusvuosi = _5;
set @toinen_suoritusvuosi = 2005;
set @kolmas_suoritusvuosi = 2006;
set @neljas_suoritusvuosi = 2007;
set @viides_suoritusvuosi = 2008;
set @kuudes_suoritusvuosi = 2009;
set @seitsemas_suoritusvuosi = 2010;

*/

INSERT INTO [VipunenTK_DW].[dbo].[_koulutukseen_sijoittuneet_6v_tarkastelu]
(
rivinumero
, tarkastelujakso
, tilv 
, tilv_date
, tutkryh 
, suorv
, suorlk 
, sp 
, syntv
, aikielir1 
, tutkkaskun 
, kansalr1
, pohjmaa 
, eumaa 
, etamaa 
, tunn
, jarj
, kkielir1 
, tutklaja 
, tutktav 
, aikoul 
, tutkmaak
, koulutus_1
, oppilaitos_1
, koulutuksen_jarjestaja_1
, koulutuksen_maakunta_1
, koulutus_2
, oppilaitos_2
, koulutuksen_jarjestaja_2
, koulutuksen_maakunta_2
, monihaku
, paaasiallinen_toiminta
, ammattiasema
, lkm
, pohjkoulk
, tietolahde
, aineisto
, lukiokoulutuksessa
, ammatillisessa_koulutuksessa
, ammattikorkeakoulutuksessa
, yliopistokoulutuksessa
, lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa
, toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa
, ammattikorkeakoulutuksessa_ja_yliopistokoulutuksessa
, koulutuksen_paattaneiden_toiminta
, ika_1v
, ika_5v
, ika_1v_suorv
, opisk_lu
, opisk_amm_pk
, opisk_amm_at
, opisk_amm_eat
, opisk_amm
, opisk_amk
, opisk_yo
, opisk_amk_koulala1
, opisk_amk_koulala2
, opisk_amk_koulala3
, opisk_amk_koulala4
, opisk_amk_koulala5
, opisk_amk_koulala6
, opisk_amk_koulala7
, opisk_amk_koulala8
, opisk_amk_koulala9
, opisk_amk_koulala10
, opisk_yo_koulala1
, opisk_yo_koulala2
, opisk_yo_koulala3
, opisk_yo_koulala4
, opisk_yo_koulala5
, opisk_yo_koulala6
, opisk_yo_koulala7
, opisk_yo_koulala8
, opisk_yo_koulala9
, opisk_yo_koulala10
, opisk_vah2_koulala
, haku_amm
, haku_amk
, haku_yo
, eihaku_kk_eiopisk
, eihaku_kk_eiopisk_kk_opisk_ta
, eihaku_kk_eiopisk_kk_opisk_lu
, eihaku_kk_eiopisk_kk_opisk_pk
, eihaku_kk_eiopisk_kk_opisk_at
, eihaku_kk_eiopisk_kk_opisk_eat
, haku_kk_eiopisk_kk
, haku_kk_eiopisk_kk_eiopisk_ta
, haku_kk_eiopisk_kk_opisk_ta
, haku_amk_eiopisk_kk
, haku_yo_eiopisk_kk
, haku_amkyo_eiopisk_kk
, opisk_kk
, opisk_kk_eiopisk_ta
, opisk_kk_opisk_ta
, opisk_vain_amk
, opisk_vain_yo
, opisk_amkyo
)
SELECT
 l.rivinumero,
 '4',
 l.tilv,
 l.tilv_date,
 (case 
	when l.tutkryh=3 and tutklaja=1 then 31
	when l.tutkryh=3 and tutklaja=2 then 32
	when l.tutkryh=3 and tutklaja=3 then 33
	else l.tutkryh
  end),
 l.suorv,
  (case
	when l.suorlk = '1'  then (l.suorv+'0'+l.suorlk)
	when l.suorlk = '2'  then (l.suorv+'0'+'8')
	else ''
	end),
 l.sp,
 l.syntv,
 l.aikielir1,
 l.tutkaskun,
 l.kansalr1,
 l.pohjmaa,
 l.eumaa,
 l.etamaa,
 l.tunn,
 l.jarj,
 l.kkielir1,
 l.tutklaja,
 l.tutktav,
 l.aikoul,
 l.tutkmaak,
 -- Koulutus 1
 (case
    --lukiokoulutuksessa _5
	when l.suorlk = '1' and l.luopiskkoulk_5 <> '' and l.ammopiskkoulk_5 = '' and
	l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' then l.luopiskkoulk_5 
	-- ammattikoulutuksessa _5
	when l.suorlk = '1' and l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 <> '' and
	l.amkopiskkoulk_5 ='' and l.yoopiskkoulk_5 = ''  then l.ammopiskkoulk_5 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen _5 ensim. koulutustietoihin
	when l.suorlk = '1' and l.luopiskkoulk_5 <> '' and l.ammopiskkoulk_5 <> '' and
	l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' then l.luopiskkoulk_5
	-- ammattikorkeakoulutuksessa _5
	when l.suorlk = '1' and l.amkopiskkoulk_5  <> '' and l.yoopiskkoulk_5  = '' and
	l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = '' then l.amkopiskkoulk_5
	-- yliopistokoulutuksessa _5
	when l.suorlk = '1' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 <> '' and 
	l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = ''   then l.yoopiskkoulk_5
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa, merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorlk = '1' and l.amkopiskkoulk_5 <> '' and l.yoopiskkoulk_5  <> '' and
	l.luopiskkoulk_5 = '' and ammopiskkoulk_5 = ''  then l.amkopiskkoulk_5 
	
	else ''

	
	    
	    end),
	    
-- Oppilaitos 1
	(case
	-- lukiokoulutuksen oppilaitos _5
	when l.suorlk = '1' and l.luopisktunn_5 <> '' and l.ammopisktunn_5 = '' and
	l.amkopisktunn_5 = '' and l.yoopisktunn_5 = '' then l.luopisktunn_5 
	-- ammattikoulutuksen oppilaitos _5
	when l.suorlk = '1' and l.luopisktunn_5 = '' and l.ammopisktunn_5 <> '' and
	l.amkopisktunn_5 ='' and l.yoopisktunn_5 = ''  then l.ammopisktunn_5 
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos _5
	when l.suorlk = '1' and l.luopisktunn_5 <> '' and l.ammopisktunn_5 <> '' and
	l.amkopisktunn_5 = '' and l.yoopisktunn_5 = '' then l.luopisktunn_5
	-- ammattikorkeakoulutuksen oppilaitos _5
	when l.suorlk = '1' and l.amkopisktunn_5  <> '' and l.yoopisktunn_5  = '' and
	l.luopisktunn_5 = '' and l.ammopisktunn_5 = '' then l.amkopisktunn_5
	-- yliopistokoulutuksen oppilaitos _5
	when l.suorlk = '1' and l.amkopisktunn_5 = '' and l.yoopisktunn_5 <> '' and 
	l.luopisktunn_5 = '' and l.ammopisktunn_5 = ''   then l.yoopisktunn_5
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus _5  
	when l.suorlk = '1' and l.amkopisktunn_5 <> '' and l.yoopisktunn_5  <> '' and
	l.luopisktunn_5 = '' and l.ammopisktunn_5 = ''  then l.amkopisktunn_5 
	
	
	

	
	else ''
	
	    end),
  --Koulutuksen järjestäjä 1
	(case
	-- lukikoulutuksen järjestäjä _5
	when l.suorlk = '1' and l.luopiskjarj_5  <> '' and l.ammopiskjarj_5 = '' and
	l.amkopiskjarj_5 = '' and yoopiskjarj_5 = '' then l.luopiskjarj_5
	-- ammatillisen koulutuksen järjestäjä _5  
	when l.suorlk = '1' and l.luopiskjarj_5 = '' and l.ammopiskjarj_5 <> '' and
	l.amkopiskjarj_5 ='' and l.yoopiskjarj_5 = ''  then l.ammopiskjarj_5
	-- lukio- ja ammatillisen koulutuksen järjestäjä, merkitään lukiokoulutuksen _5 järjestäjä 
	when l.suorlk = '1' and l.luopiskjarj_5 <> '' and l.ammopiskjarj_5 <> '' and
	l.amkopiskjarj_5 = '' and l.yoopiskjarj_5 = '' then l.luopiskjarj_5
	-- ammattikorkeakoulutuksen järjestäjä _5
	when l.suorlk = '1' and l.amkopiskjarj_5  <> '' and l.yoopiskjarj_5   = '' and
	l.luopiskjarj_5 = '' and l.ammopiskjarj_5 = '' then l.amkopiskjarj_5
	-- yliopistokoulutuksen järjestäjä _5 
	when l.suorlk = '1' and l.amkopiskjarj_5  = '' and l.yoopiskjarj_5  <> '' and 
	l.luopiskjarj_5  = '' and l.ammopiskjarj_5 = ''   then l.yoopiskjarj_5
	-- ammattikorkea- ja yliopistokoulutuksen järjestäjä, merkitään ammattikorkeakoulutuksen _5 järjestäjä   
	when l.suorlk = '1' and l.amkopiskjarj_5  <> '' and l.yoopiskjarj_5   <> '' and
	l.luopiskjarj_5  = '' and l.ammopiskjarj_5  = ''  then l.amkopiskjarj_5 

	
	else ''
	    end),
 --Koulutuksen maakunta 1
	(case
	-- lukioopiskelun maakunta _5
	when l.suorlk = '1' and l.luopiskmaak_5   <> '' and l.ammopiskmaak_5  = '' and
	l.amkopiskmaak_5  = '' and l.yoopiskmaak_5  = '' then l.luopiskmaak_5   
	-- ammatillisen koulutuksen maakunta _5
	when l.suorlk = '1' and l.luopiskmaak_5  = '' and l.ammopiskmaak_5  <> '' and
	l.amkopiskmaak_5  ='' and l.yoopiskmaak_5  = ''  then l.ammopiskmaak_5  
	-- lukiokoulutuksen ja ammatillisen koulutus otetaan lukiokoulutuksen maakunta _5
	when l.suorlk = '1' and l.luopiskmaak_5  <> '' and l.ammopiskmaak_5  <> '' and
	l.amkopiskmaak_5  = '' and l.yoopiskmaak_5  = '' then l.luopiskmaak_5 
    -- ammattikorkeakoulutuksen maakunta _5
	when l.suorlk = '1' and l.amkopiskmaak_5   <> '' and l.yoopiskmaak_5   = '' and
	l.luopiskjarj_5 = '' and l.ammopiskmaak_5 = '' then l.amkopiskmaak_5
	-- yliopistokoulutuksen maakunta _5 
	when l.suorlk = '1' and l.amkopiskmaak_5  = '' and l.yoopiskmaak_5  <> '' and 
	l.luopiskjarj_5  = '' and l.ammopiskmaak_5 = ''   then l.yoopiskmaak_5
	-- ammattikorkekoulutuksen ja yliopistokoulutksen maakunta otetaan ammattikorkeakoulutuksen maakunta _5   
	when l.suorlk = '1' and l.amkopiskmaak_5  <> '' and l.yoopiskmaak_5   <> '' and
	l.luopiskjarj_5  = '' and l.ammopiskmaak_5  = ''  then l.amkopiskmaak_5 
	
	else ''
	
	    end),
-- Koulutus 2
(case
   -- jos lukiokoulutuksessa vain niin jätetään tyhjäksi _5
	when l.suorlk = '1' and l.luopiskkoulk_5 <> '' and l.ammopiskkoulk_5 = '' and
	l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' then ''
	-- jos ammattikoulutuksessa vain  jätetään tyhjäksi _5 
	when l.suorlk = '1' and l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 <> '' and
	l.amkopiskkoulk_5 ='' and l.yoopiskkoulk_5 = ''  then ''
	-- jos lukiokoulutksessa ja ammattikoulutuksessa merkitään ammattikoulutus _5 
	when l.suorlk = '1' and l.luopiskkoulk_5 <> '' and l.ammopiskkoulk_5 <> '' and
	l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' then l.ammopiskkoulk_5 
	-- jos vain ammattikorkeakoulutuksessa jätetään tyhjäksi
	when l.suorlk = '1' and l.amkopiskkoulk_5  <> '' and l.yoopiskkoulk_5  = '' and
	l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorlk = '1' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 <> '' and 
	l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = ''   then ''
	-- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus _5
	when l.suorlk = '1' and l.amkopiskkoulk_5 <> '' and l.yoopiskkoulk_5  <> '' and
	l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = ''  then l.yoopiskkoulk_5
	
	
	
	else ''
	    end),
-- Oppilaitos 2
(case
    -- lukiokoulutuksen oppilaitos vain merkitään tyhjäksi
	when l.suorlk = '1' and l.luopisktunn_5 <> '' and l.ammopisktunn_5 = '' and
	l.amkopisktunn_5 = '' and l.yoopisktunn_5 = '' then ''
	-- ammatillisen koulutuksen oppilaitos _5 merkitään tyhjäksi
	when l.suorlk = '1' and l.luopisktunn_5 = '' and l.ammopisktunn_5 <> '' and
	l.amkopisktunn_5 ='' and l.yoopisktunn_5 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos merkitään ammatillisen koulutuksen oppilaitos _5
	when l.suorlk = '1' and l.luopisktunn_5 <> '' and l.ammopisktunn_5 <> '' and
	l.amkopisktunn_5 = '' and l.yoopisktunn_5 = '' then l.ammopisktunn_5 
	-- ammattikorkeakoulutksen oppilaitos vain merkitään tyhjäksi _5
	when l.suorlk = '1' and l.amkopisktunn_5  <> '' and l.yoopisktunn_5  = '' and
	l.luopisktunn_5 = '' and l.ammopisktunn_5 = '' then ''
	-- yliopistokoulutksen oppilaitos vain merkitään tyhjäksi _5
	when l.suorlk = '1' and l.amkopisktunn_5 = '' and l.yoopisktunn_5 <> '' and 
	l.luopisktunn_5 = '' and l.ammopisktunn_5 = ''   then ''  
	--  ammattikorkeakoulutksen oppilaitos ja yliopistokoulutuksen oppilaitos, merkitään yliopistokoulutuksen oppilaitos _5
	when l.suorlk = '1' and l.amkopisktunn_5 <> '' and l.yoopisktunn_5  <> '' and
	l.luopisktunn_5 = '' and l.ammopisktunn_5 = ''  then l.yoopisktunn_5 
	
	
	else ''
	    end),
-- Koulutuksen järjestäjä 2
	(case
	-- lukiokoulutuksen järjestäjä vain _5, merkitään tyhjäksi
	when l.suorlk = '1' and l.luopiskjarj_5  <> '' and l.ammopiskjarj_5 = '' and
	l.amkopiskjarj_5 = '' and l.yoopiskjarj_5 = '' then ''
	-- ammatillisen koulutuksen järjestäjä vain _5, merkitään tyhjäksi
	when l.suorlk = '1' and l.luopiskjarj_5 = '' and l.ammopiskjarj_5 <> '' and
	l.amkopiskjarj_5 ='' and l.yoopiskjarj_5 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä _5
	when l.suorlk = '1' and l.luopiskjarj_5 <> '' and l.ammopiskjarj_5 <> '' and
	l.amkopiskjarj_5 = '' and l.yoopiskjarj_5 = '' then l.ammopiskjarj_5 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi
	when l.suorlk = '1' and l.amkopiskjarj_5  <> '' and l.yoopiskjarj_5   = '' and
	l.luopiskjarj_5 = '' and l.ammopiskjarj_5 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, merkitään tyhjäksi
	when l.suorlk = '1' and l.amkopiskjarj_5  = '' and l.yoopiskjarj_5  <> '' and 
	l.luopiskjarj_5  = '' and l.ammopiskjarj_5 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestäjä merkitään yliopistokoulutuksen järjetäjä _5
	when l.suorlk = '1' and l.amkopiskjarj_5  <> '' and l.yoopiskjarj_5   <> '' and
	l.luopiskjarj_5  = '' and l.ammopiskjarj_5  = ''  then l.yoopiskjarj_5 
	

	else ''
	    end),
-- Koulutuksen maakunta 2
	(case
	-- vain lukiokoulutuksen maakunta _5, jätetään tyhjäksi
	when l.suorlk = '1' and l.luopiskmaak_5   <> '' and l.ammopiskmaak_5  = '' and
	l.amkopiskmaak_5  = '' and l.yoopiskmaak_5  = '' then ''
	-- vain ammatillisen koulutuksen maakunta _5, jätetään tyhjäksi   
	when l.suorlk = '1' and l.luopiskmaak_5  = '' and l.ammopiskmaak_5  <> '' and
	l.amkopiskmaak_5  ='' and l.yoopiskmaak_5  = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta, merkitään ammatillisen koulutuksen maakunta _5
	when l.suorlk = '1' and l.luopiskmaak_5  <> '' and l.ammopiskmaak_5  <> '' and
	l.amkopiskmaak_5  = '' and l.yoopiskmaak_5  = '' then l.ammopiskmaak_5 
	-- vain ammattikorkeakoulutuksen maakunta _5, jätetään tyhjäksi
	when l.suorlk = '1' and l.amkopiskmaak_5   <> '' and l.yoopiskmaak_5   = '' and
	l.luopiskmaak_5 = '' and l.ammopiskmaak_5 = '' then '' 
	-- vain yliopistokoulutuksen maakunta _5, merkitään tyhjäksi
	when l.suorlk = '1' and l.amkopiskmaak_5  = '' and l.yoopiskmaak_5  <> '' and 
	l.luopiskmaak_5  = '' and l.ammopiskmaak_5 = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta _5, merkitään yliopistokoulutuksen maakunta _5
	when l.suorlk = '1' and l.amkopiskmaak_5  <> '' and l.yoopiskmaak_5   <> '' and
	l.luopiskjarj_5  = '' and l.ammopiskmaak_5  = ''  then l.yoopiskmaak_5
	

	else ''
	
	    end),
	-- Monihaku
	(case
	-- _5
	when l.suorlk = '1' then l.monihaku_5		
	else '8'
	end),
    -- Pääasiallinen toiminta
    (case
    -- _5
	when l.suorlk = '1' then l.ptoim1r4_5
	else ''
	end),
	-- Ammattiasema
	(case
	-- _5
	when l.suorlk = '1' then l.amas_5
	else ''
	end),
    l.lkm,
	l.pohjkoul,
 l.tietolahde,
 'K3.13',
 -- Lukiokoulutuksessa
 (case
	    when (l.suorlk = '1' ) and  l.luopiskkoulk_5 <> '' and l.ammopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_5 = '' then '1'    
	    else '0'
	    end) as lukiokoulutuksessa,
 -- Ammatillisessa koulutuksessa 
 (case
	    when (l.suorlk = '1') and  l.ammopiskkoulk_5  <> '' and l.luopiskkoulk_5 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' then '1' 
	    else '0'
	    end) as ammatillisessa_koulutuksessa,
-- Ammattikorkeakoulutuksessa
 (case
	   when (l.suorlk = '1') and  l.amkopiskkoulk_5 <> '' and l.ammopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.luopiskkoulk_5 = '' then  '1'
	   else '0' 
	   end) as ammattikorkeakoulutuksessa,
-- Yliopistokoulutuksessa
 (case
	    when (l.suorlk = '1') and  l.yoopiskkoulk_5  <> '' and l.amkopiskkoulk_5 = '' and l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = '' then '1'   	   
	    else '0'
	    end) as yliopistokoulutuksessa,
-- Lukiokoulutuksessa ja ammatillisessa koulutuksessa
(case
	    when (l.suorlk = '1') and  l.luopiskkoulk_5  <> '' and l.ammopiskkoulk_5 <> '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5  = '' then '1'  
	    else '0'
	    end) as lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa,
-- Toisen asteen ammatillisessa koulutuksessa ja korkeakoulutuksessa
(case
	    when (l.suorlk = '1') and  l.ammopiskkoulk_5  <> '' and l.amkopiskkoulk_5 <> '' and l.luopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' then '1'  
	    else '0'
	    end) as toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa,
-- Ammattikorkeakoulutuksessa ja yliopistokoulutuksessa
(case
	    when (l.suorlk = '1') and  l.amkopiskkoulk_5  <> '' and l.yoopiskkoulk_5 <> '' and l.ammopiskkoulk_5  = '' and l.luopiskkoulk_5 = ''  then '1' 
	    else '0'
	    end) as ammattikorkekoulutuksessa_ja_yliopistokoulutuksessa,    
-- Koulutuksen päättäneiden toiminta
(case
	   -- Tutkintoon johtavassa koulutuksessa olevat
	   when (l.suorlk = '1')  and (l.ptoim1r4_5 = '22' or l.ptoim1r4_5 = '13')
       and	(l.luopiskkoulk_5 <>'' or l.ammopiskkoulk_5 <>'' or l.amkopiskkoulk_5 <>'' or l.yoopiskkoulk_5 <>'')   then '1' 
	
	   -- Ei tutkintoon johtavassa koulutuksessa olevat
	   when (l.suorlk = '1')  and (l.ptoim1r4_5 = '22' or l.ptoim1r4_5 = '13')
       and	(l.luopiskkoulk_5 ='' and l.ammopiskkoulk_5 ='' and l.amkopiskkoulk_5 ='' and l.yoopiskkoulk_5 ='')   then '2' 
   
   
	   -- Ei opiskelevat työlliset
	   when (l.suorlk = '1')and  l.ptoim1r4_5  = '10'  then '3' 
	   -- Ei opiskelevat työttömät
	   when (l.suorlk = '1') and  l.ptoim1r4_5  = '12'  then '4' 
	   -- Ei opiskelevat muut
		else '5' 
	   end ) as koulutuksen_paattaneiden_toiminta
 ,ika_1v = cast((case 
            when syntv = '' then '-1'
            when  (cast(tilv as int) - cast(syntv as int)) > 99 then ''
            else  ((cast(tilv as int) - cast(syntv as int))) end)  as nvarchar(10))
 ,ika_5v =cast(
       (
		case
		when (cast(tilv as int) - cast(syntv as int)) < 15 then '5v10'
		when ((cast(tilv as int) - cast(syntv as int)) >= 15 and (cast(tilv as int) - cast(syntv as int)) <= 19) then '5v15'
		when ((cast(tilv as int) - cast(syntv as int)) >= 20 and (cast(tilv as int) - cast(syntv as int)) <= 24) then '5v20'
		when ((cast(tilv as int) - cast(syntv as int)) >= 25 and (cast(tilv as int) - cast(syntv as int)) <= 29) then '5v25'
		when ((cast(tilv as int) - cast(syntv as int)) >= 30 and (cast(tilv as int) - cast(syntv as int)) <= 34) then '5v30'
		when ((cast(tilv as int) - cast(syntv as int)) >= 35 and (cast(tilv as int) - cast(syntv as int)) <= 39) then '5v35'
		when ((cast(tilv as int) - cast(syntv as int)) >= 40 and (cast(tilv as int) - cast(syntv as int)) <= 44) then '5v40'
		when ((cast(tilv as int) - cast(syntv as int)) >= 45 and (cast(tilv as int) - cast(syntv as int)) <= 49) then '5v45'
		when ((cast(tilv as int) - cast(syntv as int)) >= 50 and (cast(tilv as int) - cast(syntv as int)) <= 54) then '5v50'
		when ((cast(tilv as int) - cast(syntv as int)) >= 55 and (cast(tilv as int) - cast(syntv as int)) <= 59) then '5v55'
		when ((cast(tilv as int) - cast(syntv as int)) >= 60 and (cast(tilv as int) - cast(syntv as int)) <= 64) then '5v60'
		when ((cast(tilv as int) - cast(syntv as int)) >= 65 and (cast(tilv as int) - cast(syntv as int)) <= 69) then '5v65'
		when ((cast(tilv as int) - cast(syntv as int)) >= 70 and (cast(tilv as int) - cast(syntv as int)) <= 74) then '5v70'
		when ((cast(tilv as int) - cast(syntv as int)) >= 75 and (cast(tilv as int) - cast(syntv as int)) <= 79) then '5v75'
		when ((cast(tilv as int) - cast(syntv as int)) >= 80 and (cast(tilv as int) - cast(syntv as int)) <= 84) then '5v80'
		when ((cast(tilv as int) - cast(syntv as int)) >= 85 and (cast(tilv as int) - cast(syntv as int)) <= 89) then '5v85'
		when ((cast(tilv as int) - cast(syntv as int)) >= 90 and (cast(tilv as int) - cast(syntv as int)) <= 94) then '5v90'
		when ((cast(tilv as int) - cast(syntv as int)) >= 95) then '5v95'
		
		end
	   ) as nvarchar (10))

  ,ika_1v_suorv = cast(
					(case 
						when syntv = '' then '-1' 
						else ((cast(suorv as int) - cast(syntv as int))) 
					end)  
	as nvarchar(10))




--uudet muuttujat 03/2018
----OPISKELUT KYLLÄ/EI
--Opiskellut lukiokoulutuksessa

,case
	when  l.suorlk = '1' and (l.luopiskkoulk_1 <> '' or l.luopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.luopiskkoulk2009 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.luopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.luopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk_5 <> '' or l.luopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '' or l.luopiskkoulk2014 <> '') then 1*/
	else 0
end as opisk_lu
--Opiskellut ammatillisessa peruskoulutuksessa
,case
	when  l.suorlk = '1' and (l.ammopiskkoulk_1 <> '' or l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk_5 <> '') and (d1c.Koulutusaste_taso2_koodi = '32' or d2c.Koulutusaste_taso2_koodi = '32' or d3c.Koulutusaste_taso2_koodi = '32' or d4c.Koulutusaste_taso2_koodi = '32' or d5c.Koulutusaste_taso2_koodi = '32') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk2009 <> '') and (d2c.Koulutusaste_taso2_koodi = '32' or d3c.Koulutusaste_taso2_koodi = '32' or d4c.Koulutusaste_taso2_koodi = '32' or d5c.Koulutusaste_taso2_koodi = '32' or d6c.Koulutusaste_taso2_koodi = '32') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '') and (d3c.Koulutusaste_taso2_koodi = '32' or d4c.Koulutusaste_taso2_koodi = '32' or d5c.Koulutusaste_taso2_koodi = '32' or d6c.Koulutusaste_taso2_koodi = '32' or d7c.Koulutusaste_taso2_koodi = '32') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '') and (d4c.Koulutusaste_taso2_koodi = '32' or d5c.Koulutusaste_taso2_koodi = '32' or d6c.Koulutusaste_taso2_koodi = '32' or d7c.Koulutusaste_taso2_koodi = '32' or d8c.Koulutusaste_taso2_koodi = '32') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '') and (d5c.Koulutusaste_taso2_koodi = '32' or d6c.Koulutusaste_taso2_koodi = '32' or d7c.Koulutusaste_taso2_koodi = '32' or d8c.Koulutusaste_taso2_koodi = '32' or d9c.Koulutusaste_taso2_koodi = '32') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '' or l.ammopiskkoulk2013 <> '') and (d6c.Koulutusaste_taso2_koodi = '32' or d7c.Koulutusaste_taso2_koodi = '32' or d8c.Koulutusaste_taso2_koodi = '32' or d9c.Koulutusaste_taso2_koodi = '32' or d10c.Koulutusaste_taso2_koodi = '32') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '' or l.ammopiskkoulk2013 <> '' or l.ammopiskkoulk2014 <> '') and (d7c.Koulutusaste_taso2_koodi = '32' or d8c.Koulutusaste_taso2_koodi = '32' or d9c.Koulutusaste_taso2_koodi = '32' or d10c.Koulutusaste_taso2_koodi = '32' or d11c.Koulutusaste_taso2_koodi = '32') then 1*/
	else 0
end as opisk_amm_pk
--Opiskellut ammattitutkintokoulutuksessa
,case
	when  l.suorlk = '1' and (l.ammopiskkoulk_1 <> '' or l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk_5 <> '') and (d1c.Koulutusaste_taso2_koodi = '33' or d2c.Koulutusaste_taso2_koodi = '33' or d3c.Koulutusaste_taso2_koodi = '33' or d4c.Koulutusaste_taso2_koodi = '33' or d5c.Koulutusaste_taso2_koodi = '33') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk2009 <> '') and (d2c.Koulutusaste_taso2_koodi = '33' or d3c.Koulutusaste_taso2_koodi = '33' or d4c.Koulutusaste_taso2_koodi = '33' or d5c.Koulutusaste_taso2_koodi = '33' or d6c.Koulutusaste_taso2_koodi = '33') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '') and (d3c.Koulutusaste_taso2_koodi = '33' or d4c.Koulutusaste_taso2_koodi = '33' or d5c.Koulutusaste_taso2_koodi = '33' or d6c.Koulutusaste_taso2_koodi = '33' or d7c.Koulutusaste_taso2_koodi = '33') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '') and (d4c.Koulutusaste_taso2_koodi = '33' or d5c.Koulutusaste_taso2_koodi = '33' or d6c.Koulutusaste_taso2_koodi = '33' or d7c.Koulutusaste_taso2_koodi = '33' or d8c.Koulutusaste_taso2_koodi = '33') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '') and (d5c.Koulutusaste_taso2_koodi = '33' or d6c.Koulutusaste_taso2_koodi = '33' or d7c.Koulutusaste_taso2_koodi = '33' or d8c.Koulutusaste_taso2_koodi = '33' or d9c.Koulutusaste_taso2_koodi = '33') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '' or l.ammopiskkoulk2013 <> '') and (d6c.Koulutusaste_taso2_koodi = '33' or d7c.Koulutusaste_taso2_koodi = '33' or d8c.Koulutusaste_taso2_koodi = '33' or d9c.Koulutusaste_taso2_koodi = '33' or d10c.Koulutusaste_taso2_koodi = '33') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '' or l.ammopiskkoulk2013 <> '' or l.ammopiskkoulk2014 <> '') and (d7c.Koulutusaste_taso2_koodi = '33' or d8c.Koulutusaste_taso2_koodi = '33' or d9c.Koulutusaste_taso2_koodi = '33' or d10c.Koulutusaste_taso2_koodi = '33' or d11c.Koulutusaste_taso2_koodi = '33') then 1*/
	else 0
end as opisk_amm_at
--Opiskellut erikoisammattitutkintokoulutuksessa
,case
	when  l.suorlk = '1' and (l.ammopiskkoulk_1 <> '' or l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk_5 <> '') and (d1c.Koulutusaste_taso2_koodi = '41' or d2c.Koulutusaste_taso2_koodi = '41' or d3c.Koulutusaste_taso2_koodi = '41' or d4c.Koulutusaste_taso2_koodi = '41' or d5c.Koulutusaste_taso2_koodi = '41') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk2009 <> '') and (d2c.Koulutusaste_taso2_koodi = '41' or d3c.Koulutusaste_taso2_koodi = '41' or d4c.Koulutusaste_taso2_koodi = '41' or d5c.Koulutusaste_taso2_koodi = '41' or d6c.Koulutusaste_taso2_koodi = '41') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '') and (d3c.Koulutusaste_taso2_koodi = '41' or d4c.Koulutusaste_taso2_koodi = '41' or d5c.Koulutusaste_taso2_koodi = '41' or d6c.Koulutusaste_taso2_koodi = '41' or d7c.Koulutusaste_taso2_koodi = '41') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '') and (d4c.Koulutusaste_taso2_koodi = '41' or d5c.Koulutusaste_taso2_koodi = '41' or d6c.Koulutusaste_taso2_koodi = '41' or d7c.Koulutusaste_taso2_koodi = '41' or d8c.Koulutusaste_taso2_koodi = '41') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '') and (d5c.Koulutusaste_taso2_koodi = '41' or d6c.Koulutusaste_taso2_koodi = '41' or d7c.Koulutusaste_taso2_koodi = '41' or d8c.Koulutusaste_taso2_koodi = '41' or d9c.Koulutusaste_taso2_koodi = '41') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '' or l.ammopiskkoulk2013 <> '') and (d6c.Koulutusaste_taso2_koodi = '41' or d7c.Koulutusaste_taso2_koodi = '41' or d8c.Koulutusaste_taso2_koodi = '41' or d9c.Koulutusaste_taso2_koodi = '41' or d10c.Koulutusaste_taso2_koodi = '41') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '' or l.ammopiskkoulk2013 <> '' or l.ammopiskkoulk2014 <> '') and (d7c.Koulutusaste_taso2_koodi = '41' or d8c.Koulutusaste_taso2_koodi = '41' or d9c.Koulutusaste_taso2_koodi = '41' or d10c.Koulutusaste_taso2_koodi = '41' or d11c.Koulutusaste_taso2_koodi = '41') then 1*/
	else 0
end as opisk_amm_eat
--Opiskellut ammatillisessa koulutuksessa
,case
	when  l.suorlk = '1' and (l.ammopiskkoulk_1 <> '' or l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk_5 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk2009 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2009 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '' or l.ammopiskkoulk2013 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '' or l.ammopiskkoulk2013 <> '' or l.ammopiskkoulk2014 <> '') then 1*/
	else 0
end as opisk_amm
--Opiskellut ammattikorkeakoulutuksessa
,case
	when  l.suorlk = '1' and (l.amkopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.amkopiskkoulk2009 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.amkopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.amkopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk_5 <> '' or l.amkopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '' or l.amkopiskkoulk2014 <> '') then 1*/
	else 0
end as opisk_amk
--Opiskellut yliopistokoulutuksessa
,case
	when  l.suorlk = '1' and (l.yoopiskkoulk_1 <> '' or l.yoopiskkoulk_2 <> '' or l.yoopiskkoulk_3 <> '' or l.yoopiskkoulk_4 <> '' or l.yoopiskkoulk_5 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.yoopiskkoulk_2 <> '' or l.yoopiskkoulk_3 <> '' or l.yoopiskkoulk_4 <> '' or l.yoopiskkoulk_5 <> '' or l.yoopiskkoulk2009 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.yoopiskkoulk_3 <> '' or l.yoopiskkoulk_4 <> '' or l.yoopiskkoulk_5 <> '' or l.yoopiskkoulk2009 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.yoopiskkoulk_4 <> '' or l.yoopiskkoulk_5 <> '' or l.yoopiskkoulk2009 <> '' or l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.yoopiskkoulk_5 <> '' or l.yoopiskkoulk2009 <> '' or l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '' or l.yoopiskkoulk2012 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.yoopiskkoulk2009 <> '' or l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '' or l.yoopiskkoulk2012 <> '' or l.yoopiskkoulk2013 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '' or l.yoopiskkoulk2012 <> '' or l.yoopiskkoulk2013 <> '' or l.yoopiskkoulk2014 <> '') then 1*/
	else 0
end as opisk_yo



----KOULUTUSALA, TASO 1 KYLLÄ/EI
--Opiskellut koulutusala1 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1a.iscfibroad2013_koodi = '01' or d2a.iscfibroad2013_koodi = '01' or d3a.iscfibroad2013_koodi = '01' or d4a.iscfibroad2013_koodi = '01' or d5a.iscfibroad2013_koodi = '01') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2a.iscfibroad2013_koodi = '01' or d3a.iscfibroad2013_koodi = '01' or d4a.iscfibroad2013_koodi = '01' or d5a.iscfibroad2013_koodi = '01' or d6a.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3a.iscfibroad2013_koodi = '01' or d4a.iscfibroad2013_koodi = '01' or d5a.iscfibroad2013_koodi = '01' or d6a.iscfibroad2013_koodi = '01' or d7a.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4a.iscfibroad2013_koodi = '01' or d5a.iscfibroad2013_koodi = '01' or d6a.iscfibroad2013_koodi = '01' or d7a.iscfibroad2013_koodi = '01' or d8a.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5a.iscfibroad2013_koodi = '01' or d6a.iscfibroad2013_koodi = '01' or d7a.iscfibroad2013_koodi = '01' or d8a.iscfibroad2013_koodi = '01' or d9a.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6a.iscfibroad2013_koodi = '01' or d7a.iscfibroad2013_koodi = '01' or d8a.iscfibroad2013_koodi = '01' or d9a.iscfibroad2013_koodi = '01' or d10a.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7a.iscfibroad2013_koodi = '01' or d8a.iscfibroad2013_koodi = '01' or d9a.iscfibroad2013_koodi = '01' or d10a.iscfibroad2013_koodi = '01' or d11a.iscfibroad2013_koodi = '01') then 1*/
	else 0
end as opisk_amk_koulala1
--Opiskellut koulutusala2 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1a.iscfibroad2013_koodi = '02' or d2a.iscfibroad2013_koodi = '02' or d3a.iscfibroad2013_koodi = '02' or d4a.iscfibroad2013_koodi = '02' or d5a.iscfibroad2013_koodi = '02') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2a.iscfibroad2013_koodi = '02' or d3a.iscfibroad2013_koodi = '02' or d4a.iscfibroad2013_koodi = '02' or d5a.iscfibroad2013_koodi = '02' or d6a.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3a.iscfibroad2013_koodi = '02' or d4a.iscfibroad2013_koodi = '02' or d5a.iscfibroad2013_koodi = '02' or d6a.iscfibroad2013_koodi = '02' or d7a.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4a.iscfibroad2013_koodi = '02' or d5a.iscfibroad2013_koodi = '02' or d6a.iscfibroad2013_koodi = '02' or d7a.iscfibroad2013_koodi = '02' or d8a.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5a.iscfibroad2013_koodi = '02' or d6a.iscfibroad2013_koodi = '02' or d7a.iscfibroad2013_koodi = '02' or d8a.iscfibroad2013_koodi = '02' or d9a.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6a.iscfibroad2013_koodi = '02' or d7a.iscfibroad2013_koodi = '02' or d8a.iscfibroad2013_koodi = '02' or d9a.iscfibroad2013_koodi = '02' or d10a.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7a.iscfibroad2013_koodi = '02' or d8a.iscfibroad2013_koodi = '02' or d9a.iscfibroad2013_koodi = '02' or d10a.iscfibroad2013_koodi = '02' or d11a.iscfibroad2013_koodi = '02') then 1*/
	else 0
end as opisk_amk_koulala2
--Opiskellut koulutusala3 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1a.iscfibroad2013_koodi = '03' or d2a.iscfibroad2013_koodi = '03' or d3a.iscfibroad2013_koodi = '03' or d4a.iscfibroad2013_koodi = '03' or d5a.iscfibroad2013_koodi = '03') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2a.iscfibroad2013_koodi = '03' or d3a.iscfibroad2013_koodi = '03' or d4a.iscfibroad2013_koodi = '03' or d5a.iscfibroad2013_koodi = '03' or d6a.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3a.iscfibroad2013_koodi = '03' or d4a.iscfibroad2013_koodi = '03' or d5a.iscfibroad2013_koodi = '03' or d6a.iscfibroad2013_koodi = '03' or d7a.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4a.iscfibroad2013_koodi = '03' or d5a.iscfibroad2013_koodi = '03' or d6a.iscfibroad2013_koodi = '03' or d7a.iscfibroad2013_koodi = '03' or d8a.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5a.iscfibroad2013_koodi = '03' or d6a.iscfibroad2013_koodi = '03' or d7a.iscfibroad2013_koodi = '03' or d8a.iscfibroad2013_koodi = '03' or d9a.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6a.iscfibroad2013_koodi = '03' or d7a.iscfibroad2013_koodi = '03' or d8a.iscfibroad2013_koodi = '03' or d9a.iscfibroad2013_koodi = '03' or d10a.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7a.iscfibroad2013_koodi = '03' or d8a.iscfibroad2013_koodi = '03' or d9a.iscfibroad2013_koodi = '03' or d10a.iscfibroad2013_koodi = '03' or d11a.iscfibroad2013_koodi = '03') then 1*/
	else 0
end as opisk_amk_koulala3
--Opiskellut koulutusala4 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1a.iscfibroad2013_koodi = '04' or d2a.iscfibroad2013_koodi = '04' or d3a.iscfibroad2013_koodi = '04' or d4a.iscfibroad2013_koodi = '04' or d5a.iscfibroad2013_koodi = '04') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2a.iscfibroad2013_koodi = '04' or d3a.iscfibroad2013_koodi = '04' or d4a.iscfibroad2013_koodi = '04' or d5a.iscfibroad2013_koodi = '04' or d6a.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3a.iscfibroad2013_koodi = '04' or d4a.iscfibroad2013_koodi = '04' or d5a.iscfibroad2013_koodi = '04' or d6a.iscfibroad2013_koodi = '04' or d7a.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4a.iscfibroad2013_koodi = '04' or d5a.iscfibroad2013_koodi = '04' or d6a.iscfibroad2013_koodi = '04' or d7a.iscfibroad2013_koodi = '04' or d8a.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5a.iscfibroad2013_koodi = '04' or d6a.iscfibroad2013_koodi = '04' or d7a.iscfibroad2013_koodi = '04' or d8a.iscfibroad2013_koodi = '04' or d9a.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6a.iscfibroad2013_koodi = '04' or d7a.iscfibroad2013_koodi = '04' or d8a.iscfibroad2013_koodi = '04' or d9a.iscfibroad2013_koodi = '04' or d10a.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7a.iscfibroad2013_koodi = '04' or d8a.iscfibroad2013_koodi = '04' or d9a.iscfibroad2013_koodi = '04' or d10a.iscfibroad2013_koodi = '04' or d11a.iscfibroad2013_koodi = '04') then 1*/
	else 0
end as opisk_amk_koulala4
--Opiskellut koulutusala5 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1a.iscfibroad2013_koodi = '05' or d2a.iscfibroad2013_koodi = '05' or d3a.iscfibroad2013_koodi = '05' or d4a.iscfibroad2013_koodi = '05' or d5a.iscfibroad2013_koodi = '05') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2a.iscfibroad2013_koodi = '05' or d3a.iscfibroad2013_koodi = '05' or d4a.iscfibroad2013_koodi = '05' or d5a.iscfibroad2013_koodi = '05' or d6a.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3a.iscfibroad2013_koodi = '05' or d4a.iscfibroad2013_koodi = '05' or d5a.iscfibroad2013_koodi = '05' or d6a.iscfibroad2013_koodi = '05' or d7a.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4a.iscfibroad2013_koodi = '05' or d5a.iscfibroad2013_koodi = '05' or d6a.iscfibroad2013_koodi = '05' or d7a.iscfibroad2013_koodi = '05' or d8a.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5a.iscfibroad2013_koodi = '05' or d6a.iscfibroad2013_koodi = '05' or d7a.iscfibroad2013_koodi = '05' or d8a.iscfibroad2013_koodi = '05' or d9a.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6a.iscfibroad2013_koodi = '05' or d7a.iscfibroad2013_koodi = '05' or d8a.iscfibroad2013_koodi = '05' or d9a.iscfibroad2013_koodi = '05' or d10a.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7a.iscfibroad2013_koodi = '05' or d8a.iscfibroad2013_koodi = '05' or d9a.iscfibroad2013_koodi = '05' or d10a.iscfibroad2013_koodi = '05' or d11a.iscfibroad2013_koodi = '05') then 1*/
	else 0
end as opisk_amk_koulala5
--Opiskellut koulutusala6 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1a.iscfibroad2013_koodi = '06' or d2a.iscfibroad2013_koodi = '06' or d3a.iscfibroad2013_koodi = '06' or d4a.iscfibroad2013_koodi = '06' or d5a.iscfibroad2013_koodi = '06') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2a.iscfibroad2013_koodi = '06' or d3a.iscfibroad2013_koodi = '06' or d4a.iscfibroad2013_koodi = '06' or d5a.iscfibroad2013_koodi = '06' or d6a.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3a.iscfibroad2013_koodi = '06' or d4a.iscfibroad2013_koodi = '06' or d5a.iscfibroad2013_koodi = '06' or d6a.iscfibroad2013_koodi = '06' or d7a.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4a.iscfibroad2013_koodi = '06' or d5a.iscfibroad2013_koodi = '06' or d6a.iscfibroad2013_koodi = '06' or d7a.iscfibroad2013_koodi = '06' or d8a.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5a.iscfibroad2013_koodi = '06' or d6a.iscfibroad2013_koodi = '06' or d7a.iscfibroad2013_koodi = '06' or d8a.iscfibroad2013_koodi = '06' or d9a.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6a.iscfibroad2013_koodi = '06' or d7a.iscfibroad2013_koodi = '06' or d8a.iscfibroad2013_koodi = '06' or d9a.iscfibroad2013_koodi = '06' or d10a.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7a.iscfibroad2013_koodi = '06' or d8a.iscfibroad2013_koodi = '06' or d9a.iscfibroad2013_koodi = '06' or d10a.iscfibroad2013_koodi = '06' or d11a.iscfibroad2013_koodi = '06') then 1*/
	else 0
end as opisk_amk_koulala6
--Opiskellut koulutusala7 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1a.iscfibroad2013_koodi = '07' or d2a.iscfibroad2013_koodi = '07' or d3a.iscfibroad2013_koodi = '07' or d4a.iscfibroad2013_koodi = '07' or d5a.iscfibroad2013_koodi = '07') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2a.iscfibroad2013_koodi = '07' or d3a.iscfibroad2013_koodi = '07' or d4a.iscfibroad2013_koodi = '07' or d5a.iscfibroad2013_koodi = '07' or d6a.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3a.iscfibroad2013_koodi = '07' or d4a.iscfibroad2013_koodi = '07' or d5a.iscfibroad2013_koodi = '07' or d6a.iscfibroad2013_koodi = '07' or d7a.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4a.iscfibroad2013_koodi = '07' or d5a.iscfibroad2013_koodi = '07' or d6a.iscfibroad2013_koodi = '07' or d7a.iscfibroad2013_koodi = '07' or d8a.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5a.iscfibroad2013_koodi = '07' or d6a.iscfibroad2013_koodi = '07' or d7a.iscfibroad2013_koodi = '07' or d8a.iscfibroad2013_koodi = '07' or d9a.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6a.iscfibroad2013_koodi = '07' or d7a.iscfibroad2013_koodi = '07' or d8a.iscfibroad2013_koodi = '07' or d9a.iscfibroad2013_koodi = '07' or d10a.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7a.iscfibroad2013_koodi = '07' or d8a.iscfibroad2013_koodi = '07' or d9a.iscfibroad2013_koodi = '07' or d10a.iscfibroad2013_koodi = '07' or d11a.iscfibroad2013_koodi = '07') then 1*/
	else 0
end as opisk_amk_koulala7
--Opiskellut koulutusala8 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1a.iscfibroad2013_koodi = '08' or d2a.iscfibroad2013_koodi = '08' or d3a.iscfibroad2013_koodi = '08' or d4a.iscfibroad2013_koodi = '08' or d5a.iscfibroad2013_koodi = '08') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2a.iscfibroad2013_koodi = '08' or d3a.iscfibroad2013_koodi = '08' or d4a.iscfibroad2013_koodi = '08' or d5a.iscfibroad2013_koodi = '08' or d6a.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3a.iscfibroad2013_koodi = '08' or d4a.iscfibroad2013_koodi = '08' or d5a.iscfibroad2013_koodi = '08' or d6a.iscfibroad2013_koodi = '08' or d7a.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4a.iscfibroad2013_koodi = '08' or d5a.iscfibroad2013_koodi = '08' or d6a.iscfibroad2013_koodi = '08' or d7a.iscfibroad2013_koodi = '08' or d8a.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5a.iscfibroad2013_koodi = '08' or d6a.iscfibroad2013_koodi = '08' or d7a.iscfibroad2013_koodi = '08' or d8a.iscfibroad2013_koodi = '08' or d9a.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6a.iscfibroad2013_koodi = '08' or d7a.iscfibroad2013_koodi = '08' or d8a.iscfibroad2013_koodi = '08' or d9a.iscfibroad2013_koodi = '08' or d10a.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7a.iscfibroad2013_koodi = '08' or d8a.iscfibroad2013_koodi = '08' or d9a.iscfibroad2013_koodi = '08' or d10a.iscfibroad2013_koodi = '08' or d11a.iscfibroad2013_koodi = '08') then 1*/
	else 0
end as opisk_amk_koulala8
--Opiskellut koulutusala9 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1a.iscfibroad2013_koodi = '09' or d2a.iscfibroad2013_koodi = '09' or d3a.iscfibroad2013_koodi = '09' or d4a.iscfibroad2013_koodi = '09' or d5a.iscfibroad2013_koodi = '09') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2a.iscfibroad2013_koodi = '09' or d3a.iscfibroad2013_koodi = '09' or d4a.iscfibroad2013_koodi = '09' or d5a.iscfibroad2013_koodi = '09' or d6a.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3a.iscfibroad2013_koodi = '09' or d4a.iscfibroad2013_koodi = '09' or d5a.iscfibroad2013_koodi = '09' or d6a.iscfibroad2013_koodi = '09' or d7a.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4a.iscfibroad2013_koodi = '09' or d5a.iscfibroad2013_koodi = '09' or d6a.iscfibroad2013_koodi = '09' or d7a.iscfibroad2013_koodi = '09' or d8a.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5a.iscfibroad2013_koodi = '09' or d6a.iscfibroad2013_koodi = '09' or d7a.iscfibroad2013_koodi = '09' or d8a.iscfibroad2013_koodi = '09' or d9a.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6a.iscfibroad2013_koodi = '09' or d7a.iscfibroad2013_koodi = '09' or d8a.iscfibroad2013_koodi = '09' or d9a.iscfibroad2013_koodi = '09' or d10a.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7a.iscfibroad2013_koodi = '09' or d8a.iscfibroad2013_koodi = '09' or d9a.iscfibroad2013_koodi = '09' or d10a.iscfibroad2013_koodi = '09' or d11a.iscfibroad2013_koodi = '09') then 1*/
	else 0
end as opisk_amk_koulala9
--Opiskellut koulutusala10 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1a.iscfibroad2013_koodi = '10' or d2a.iscfibroad2013_koodi = '10' or d3a.iscfibroad2013_koodi = '10' or d4a.iscfibroad2013_koodi = '10' or d5a.iscfibroad2013_koodi = '10') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2a.iscfibroad2013_koodi = '10' or d3a.iscfibroad2013_koodi = '10' or d4a.iscfibroad2013_koodi = '10' or d5a.iscfibroad2013_koodi = '10' or d6a.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3a.iscfibroad2013_koodi = '10' or d4a.iscfibroad2013_koodi = '10' or d5a.iscfibroad2013_koodi = '10' or d6a.iscfibroad2013_koodi = '10' or d7a.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4a.iscfibroad2013_koodi = '10' or d5a.iscfibroad2013_koodi = '10' or d6a.iscfibroad2013_koodi = '10' or d7a.iscfibroad2013_koodi = '10' or d8a.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5a.iscfibroad2013_koodi = '10' or d6a.iscfibroad2013_koodi = '10' or d7a.iscfibroad2013_koodi = '10' or d8a.iscfibroad2013_koodi = '10' or d9a.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6a.iscfibroad2013_koodi = '10' or d7a.iscfibroad2013_koodi = '10' or d8a.iscfibroad2013_koodi = '10' or d9a.iscfibroad2013_koodi = '10' or d10a.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7a.iscfibroad2013_koodi = '10' or d8a.iscfibroad2013_koodi = '10' or d9a.iscfibroad2013_koodi = '10' or d10a.iscfibroad2013_koodi = '10' or d11a.iscfibroad2013_koodi = '10') then 1*/
	else 0
end as opisk_amk_koulala10



--Opiskellut koulutusala1 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1b.iscfibroad2013_koodi = '01' or d2b.iscfibroad2013_koodi = '01' or d3b.iscfibroad2013_koodi = '01' or d4b.iscfibroad2013_koodi = '01' or d5b.iscfibroad2013_koodi = '01') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2b.iscfibroad2013_koodi = '01' or d3b.iscfibroad2013_koodi = '01' or d4b.iscfibroad2013_koodi = '01' or d5b.iscfibroad2013_koodi = '01' or d6b.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3b.iscfibroad2013_koodi = '01' or d4b.iscfibroad2013_koodi = '01' or d5b.iscfibroad2013_koodi = '01' or d6b.iscfibroad2013_koodi = '01' or d7b.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4b.iscfibroad2013_koodi = '01' or d5b.iscfibroad2013_koodi = '01' or d6b.iscfibroad2013_koodi = '01' or d7b.iscfibroad2013_koodi = '01' or d8b.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5b.iscfibroad2013_koodi = '01' or d6b.iscfibroad2013_koodi = '01' or d7b.iscfibroad2013_koodi = '01' or d8b.iscfibroad2013_koodi = '01' or d9b.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6b.iscfibroad2013_koodi = '01' or d7b.iscfibroad2013_koodi = '01' or d8b.iscfibroad2013_koodi = '01' or d9b.iscfibroad2013_koodi = '01' or d10b.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7b.iscfibroad2013_koodi = '01' or d8b.iscfibroad2013_koodi = '01' or d9b.iscfibroad2013_koodi = '01' or d10b.iscfibroad2013_koodi = '01' or d11b.iscfibroad2013_koodi = '01') then 1*/
	else 0
end as opisk_yo_koulala1
--Opiskellut koulutusala2 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1b.iscfibroad2013_koodi = '02' or d2b.iscfibroad2013_koodi = '02' or d3b.iscfibroad2013_koodi = '02' or d4b.iscfibroad2013_koodi = '02' or d5b.iscfibroad2013_koodi = '02') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2b.iscfibroad2013_koodi = '02' or d3b.iscfibroad2013_koodi = '02' or d4b.iscfibroad2013_koodi = '02' or d5b.iscfibroad2013_koodi = '02' or d6b.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3b.iscfibroad2013_koodi = '02' or d4b.iscfibroad2013_koodi = '02' or d5b.iscfibroad2013_koodi = '02' or d6b.iscfibroad2013_koodi = '02' or d7b.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4b.iscfibroad2013_koodi = '02' or d5b.iscfibroad2013_koodi = '02' or d6b.iscfibroad2013_koodi = '02' or d7b.iscfibroad2013_koodi = '02' or d8b.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5b.iscfibroad2013_koodi = '02' or d6b.iscfibroad2013_koodi = '02' or d7b.iscfibroad2013_koodi = '02' or d8b.iscfibroad2013_koodi = '02' or d9b.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6b.iscfibroad2013_koodi = '02' or d7b.iscfibroad2013_koodi = '02' or d8b.iscfibroad2013_koodi = '02' or d9b.iscfibroad2013_koodi = '02' or d10b.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7b.iscfibroad2013_koodi = '02' or d8b.iscfibroad2013_koodi = '02' or d9b.iscfibroad2013_koodi = '02' or d10b.iscfibroad2013_koodi = '02' or d11b.iscfibroad2013_koodi = '02') then 1*/
	else 0
end as opisk_yo_koulala2
--Opiskellut koulutusala3 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1b.iscfibroad2013_koodi = '03' or d2b.iscfibroad2013_koodi = '03' or d3b.iscfibroad2013_koodi = '03' or d4b.iscfibroad2013_koodi = '03' or d5b.iscfibroad2013_koodi = '03') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2b.iscfibroad2013_koodi = '03' or d3b.iscfibroad2013_koodi = '03' or d4b.iscfibroad2013_koodi = '03' or d5b.iscfibroad2013_koodi = '03' or d6b.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3b.iscfibroad2013_koodi = '03' or d4b.iscfibroad2013_koodi = '03' or d5b.iscfibroad2013_koodi = '03' or d6b.iscfibroad2013_koodi = '03' or d7b.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4b.iscfibroad2013_koodi = '03' or d5b.iscfibroad2013_koodi = '03' or d6b.iscfibroad2013_koodi = '03' or d7b.iscfibroad2013_koodi = '03' or d8b.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5b.iscfibroad2013_koodi = '03' or d6b.iscfibroad2013_koodi = '03' or d7b.iscfibroad2013_koodi = '03' or d8b.iscfibroad2013_koodi = '03' or d9b.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6b.iscfibroad2013_koodi = '03' or d7b.iscfibroad2013_koodi = '03' or d8b.iscfibroad2013_koodi = '03' or d9b.iscfibroad2013_koodi = '03' or d10b.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7b.iscfibroad2013_koodi = '03' or d8b.iscfibroad2013_koodi = '03' or d9b.iscfibroad2013_koodi = '03' or d10b.iscfibroad2013_koodi = '03' or d11b.iscfibroad2013_koodi = '03') then 1*/
	else 0
end as opisk_yo_koulala3
--Opiskellut koulutusala4 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1b.iscfibroad2013_koodi = '04' or d2b.iscfibroad2013_koodi = '04' or d3b.iscfibroad2013_koodi = '04' or d4b.iscfibroad2013_koodi = '04' or d5b.iscfibroad2013_koodi = '04') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2b.iscfibroad2013_koodi = '04' or d3b.iscfibroad2013_koodi = '04' or d4b.iscfibroad2013_koodi = '04' or d5b.iscfibroad2013_koodi = '04' or d6b.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3b.iscfibroad2013_koodi = '04' or d4b.iscfibroad2013_koodi = '04' or d5b.iscfibroad2013_koodi = '04' or d6b.iscfibroad2013_koodi = '04' or d7b.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4b.iscfibroad2013_koodi = '04' or d5b.iscfibroad2013_koodi = '04' or d6b.iscfibroad2013_koodi = '04' or d7b.iscfibroad2013_koodi = '04' or d8b.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5b.iscfibroad2013_koodi = '04' or d6b.iscfibroad2013_koodi = '04' or d7b.iscfibroad2013_koodi = '04' or d8b.iscfibroad2013_koodi = '04' or d9b.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6b.iscfibroad2013_koodi = '04' or d7b.iscfibroad2013_koodi = '04' or d8b.iscfibroad2013_koodi = '04' or d9b.iscfibroad2013_koodi = '04' or d10b.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7b.iscfibroad2013_koodi = '04' or d8b.iscfibroad2013_koodi = '04' or d9b.iscfibroad2013_koodi = '04' or d10b.iscfibroad2013_koodi = '04' or d11b.iscfibroad2013_koodi = '04') then 1*/
	else 0
end as opisk_yo_koulala4
--Opiskellut koulutusala5 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1b.iscfibroad2013_koodi = '05' or d2b.iscfibroad2013_koodi = '05' or d3b.iscfibroad2013_koodi = '05' or d4b.iscfibroad2013_koodi = '05' or d5b.iscfibroad2013_koodi = '05') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2b.iscfibroad2013_koodi = '05' or d3b.iscfibroad2013_koodi = '05' or d4b.iscfibroad2013_koodi = '05' or d5b.iscfibroad2013_koodi = '05' or d6b.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3b.iscfibroad2013_koodi = '05' or d4b.iscfibroad2013_koodi = '05' or d5b.iscfibroad2013_koodi = '05' or d6b.iscfibroad2013_koodi = '05' or d7b.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4b.iscfibroad2013_koodi = '05' or d5b.iscfibroad2013_koodi = '05' or d6b.iscfibroad2013_koodi = '05' or d7b.iscfibroad2013_koodi = '05' or d8b.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5b.iscfibroad2013_koodi = '05' or d6b.iscfibroad2013_koodi = '05' or d7b.iscfibroad2013_koodi = '05' or d8b.iscfibroad2013_koodi = '05' or d9b.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6b.iscfibroad2013_koodi = '05' or d7b.iscfibroad2013_koodi = '05' or d8b.iscfibroad2013_koodi = '05' or d9b.iscfibroad2013_koodi = '05' or d10b.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7b.iscfibroad2013_koodi = '05' or d8b.iscfibroad2013_koodi = '05' or d9b.iscfibroad2013_koodi = '05' or d10b.iscfibroad2013_koodi = '05' or d11b.iscfibroad2013_koodi = '05') then 1*/
	else 0
end as opisk_yo_koulala5
--Opiskellut koulutusala6 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1b.iscfibroad2013_koodi = '06' or d2b.iscfibroad2013_koodi = '06' or d3b.iscfibroad2013_koodi = '06' or d4b.iscfibroad2013_koodi = '06' or d5b.iscfibroad2013_koodi = '06') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2b.iscfibroad2013_koodi = '06' or d3b.iscfibroad2013_koodi = '06' or d4b.iscfibroad2013_koodi = '06' or d5b.iscfibroad2013_koodi = '06' or d6b.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3b.iscfibroad2013_koodi = '06' or d4b.iscfibroad2013_koodi = '06' or d5b.iscfibroad2013_koodi = '06' or d6b.iscfibroad2013_koodi = '06' or d7b.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4b.iscfibroad2013_koodi = '06' or d5b.iscfibroad2013_koodi = '06' or d6b.iscfibroad2013_koodi = '06' or d7b.iscfibroad2013_koodi = '06' or d8b.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5b.iscfibroad2013_koodi = '06' or d6b.iscfibroad2013_koodi = '06' or d7b.iscfibroad2013_koodi = '06' or d8b.iscfibroad2013_koodi = '06' or d9b.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6b.iscfibroad2013_koodi = '06' or d7b.iscfibroad2013_koodi = '06' or d8b.iscfibroad2013_koodi = '06' or d9b.iscfibroad2013_koodi = '06' or d10b.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7b.iscfibroad2013_koodi = '06' or d8b.iscfibroad2013_koodi = '06' or d9b.iscfibroad2013_koodi = '06' or d10b.iscfibroad2013_koodi = '06' or d11b.iscfibroad2013_koodi = '06') then 1*/
	else 0
end as opisk_yo_koulala6
--Opiskellut koulutusala7 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1b.iscfibroad2013_koodi = '07' or d2b.iscfibroad2013_koodi = '07' or d3b.iscfibroad2013_koodi = '07' or d4b.iscfibroad2013_koodi = '07' or d5b.iscfibroad2013_koodi = '07') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2b.iscfibroad2013_koodi = '07' or d3b.iscfibroad2013_koodi = '07' or d4b.iscfibroad2013_koodi = '07' or d5b.iscfibroad2013_koodi = '07' or d6b.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3b.iscfibroad2013_koodi = '07' or d4b.iscfibroad2013_koodi = '07' or d5b.iscfibroad2013_koodi = '07' or d6b.iscfibroad2013_koodi = '07' or d7b.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4b.iscfibroad2013_koodi = '07' or d5b.iscfibroad2013_koodi = '07' or d6b.iscfibroad2013_koodi = '07' or d7b.iscfibroad2013_koodi = '07' or d8b.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5b.iscfibroad2013_koodi = '07' or d6b.iscfibroad2013_koodi = '07' or d7b.iscfibroad2013_koodi = '07' or d8b.iscfibroad2013_koodi = '07' or d9b.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6b.iscfibroad2013_koodi = '07' or d7b.iscfibroad2013_koodi = '07' or d8b.iscfibroad2013_koodi = '07' or d9b.iscfibroad2013_koodi = '07' or d10b.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7b.iscfibroad2013_koodi = '07' or d8b.iscfibroad2013_koodi = '07' or d9b.iscfibroad2013_koodi = '07' or d10b.iscfibroad2013_koodi = '07' or d11b.iscfibroad2013_koodi = '07') then 1*/
	else 0
end as opisk_yo_koulala7
--Opiskellut koulutusala8 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1b.iscfibroad2013_koodi = '08' or d2b.iscfibroad2013_koodi = '08' or d3b.iscfibroad2013_koodi = '08' or d4b.iscfibroad2013_koodi = '08' or d5b.iscfibroad2013_koodi = '08') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2b.iscfibroad2013_koodi = '08' or d3b.iscfibroad2013_koodi = '08' or d4b.iscfibroad2013_koodi = '08' or d5b.iscfibroad2013_koodi = '08' or d6b.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3b.iscfibroad2013_koodi = '08' or d4b.iscfibroad2013_koodi = '08' or d5b.iscfibroad2013_koodi = '08' or d6b.iscfibroad2013_koodi = '08' or d7b.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4b.iscfibroad2013_koodi = '08' or d5b.iscfibroad2013_koodi = '08' or d6b.iscfibroad2013_koodi = '08' or d7b.iscfibroad2013_koodi = '08' or d8b.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5b.iscfibroad2013_koodi = '08' or d6b.iscfibroad2013_koodi = '08' or d7b.iscfibroad2013_koodi = '08' or d8b.iscfibroad2013_koodi = '08' or d9b.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6b.iscfibroad2013_koodi = '08' or d7b.iscfibroad2013_koodi = '08' or d8b.iscfibroad2013_koodi = '08' or d9b.iscfibroad2013_koodi = '08' or d10b.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7b.iscfibroad2013_koodi = '08' or d8b.iscfibroad2013_koodi = '08' or d9b.iscfibroad2013_koodi = '08' or d10b.iscfibroad2013_koodi = '08' or d11b.iscfibroad2013_koodi = '08') then 1*/
	else 0
end as opisk_yo_koulala8
--Opiskellut koulutusala9 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1b.iscfibroad2013_koodi = '09' or d2b.iscfibroad2013_koodi = '09' or d3b.iscfibroad2013_koodi = '09' or d4b.iscfibroad2013_koodi = '09' or d5b.iscfibroad2013_koodi = '09') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2b.iscfibroad2013_koodi = '09' or d3b.iscfibroad2013_koodi = '09' or d4b.iscfibroad2013_koodi = '09' or d5b.iscfibroad2013_koodi = '09' or d6b.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3b.iscfibroad2013_koodi = '09' or d4b.iscfibroad2013_koodi = '09' or d5b.iscfibroad2013_koodi = '09' or d6b.iscfibroad2013_koodi = '09' or d7b.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4b.iscfibroad2013_koodi = '09' or d5b.iscfibroad2013_koodi = '09' or d6b.iscfibroad2013_koodi = '09' or d7b.iscfibroad2013_koodi = '09' or d8b.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5b.iscfibroad2013_koodi = '09' or d6b.iscfibroad2013_koodi = '09' or d7b.iscfibroad2013_koodi = '09' or d8b.iscfibroad2013_koodi = '09' or d9b.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6b.iscfibroad2013_koodi = '09' or d7b.iscfibroad2013_koodi = '09' or d8b.iscfibroad2013_koodi = '09' or d9b.iscfibroad2013_koodi = '09' or d10b.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7b.iscfibroad2013_koodi = '09' or d8b.iscfibroad2013_koodi = '09' or d9b.iscfibroad2013_koodi = '09' or d10b.iscfibroad2013_koodi = '09' or d11b.iscfibroad2013_koodi = '09') then 1*/
	else 0
end as opisk_yo_koulala9
--Opiskellut koulutusala10 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1b.iscfibroad2013_koodi = '10' or d2b.iscfibroad2013_koodi = '10' or d3b.iscfibroad2013_koodi = '10' or d4b.iscfibroad2013_koodi = '10' or d5b.iscfibroad2013_koodi = '10') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2b.iscfibroad2013_koodi = '10' or d3b.iscfibroad2013_koodi = '10' or d4b.iscfibroad2013_koodi = '10' or d5b.iscfibroad2013_koodi = '10' or d6b.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3b.iscfibroad2013_koodi = '10' or d4b.iscfibroad2013_koodi = '10' or d5b.iscfibroad2013_koodi = '10' or d6b.iscfibroad2013_koodi = '10' or d7b.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4b.iscfibroad2013_koodi = '10' or d5b.iscfibroad2013_koodi = '10' or d6b.iscfibroad2013_koodi = '10' or d7b.iscfibroad2013_koodi = '10' or d8b.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5b.iscfibroad2013_koodi = '10' or d6b.iscfibroad2013_koodi = '10' or d7b.iscfibroad2013_koodi = '10' or d8b.iscfibroad2013_koodi = '10' or d9b.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6b.iscfibroad2013_koodi = '10' or d7b.iscfibroad2013_koodi = '10' or d8b.iscfibroad2013_koodi = '10' or d9b.iscfibroad2013_koodi = '10' or d10b.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7b.iscfibroad2013_koodi = '10' or d8b.iscfibroad2013_koodi = '10' or d9b.iscfibroad2013_koodi = '10' or d10b.iscfibroad2013_koodi = '10' or d11b.iscfibroad2013_koodi = '10') then 1*/
	else 0
end as opisk_yo_koulala10


--Opiskellut useampaa kuin yhtä alaa (taso 1) (kyllä/ei)
,case --ensimmäisenä vuotena on mahdollista olla vain yksi ala
	when  l.suorlk = '1' and m1.MinValue <> m1.MaxValue then 1 
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and m2.MinValue <> m2.MaxValue then 1 
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and m3.MinValue <> m3.MaxValue then 1 
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and m4.MinValue <> m4.MaxValue then 1 
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and m5.MinValue <> m5.MaxValue then 1 
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and m6.MinValue <> m6.MaxValue then 1 
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and m7.MinValue <> m7.MaxValue then 1 */
	else 0
end as opisk_vah2_koulala


----HAUT KYLLÄ/EI
--Hakenut ammatilliseen koulutukseen
,case
	when  l.suorlk = '1' and (l.monihaku_1 in (2,3,5) or l.monihaku_2 in (2,3,5) or l.monihaku_3 in (2,3,5) or l.monihaku_4 in (2,3,5) or l.monihaku_5 in (2,3,5)) then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.monihaku_2 in (2,3,5) or l.monihaku_3 in (2,3,5) or l.monihaku_4 in (2,3,5) or l.monihaku_5 in (2,3,5) or l.monihaku2009 in (2,3,5)) then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.monihaku_3 in (2,3,5) or l.monihaku_4 in (2,3,5) or l.monihaku_5 in (2,3,5) or l.monihaku2009 in (2,3,5) or l.monihaku2010 in (2,3,5)) then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.monihaku_4 in (2,3,5) or l.monihaku_5 in (2,3,5) or l.monihaku2009 in (2,3,5) or l.monihaku2010 in (2,3,5) or l.monihaku2011 in (2,3,5)) then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.monihaku_5 in (2,3,5) or l.monihaku2009 in (2,3,5) or l.monihaku2010 in (2,3,5) or l.monihaku2011 in (2,3,5) or l.monihaku2012 in (2,3,5)) then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.monihaku2009 in (2,3,5) or l.monihaku2010 in (2,3,5) or l.monihaku2011 in (2,3,5) or l.monihaku2012 in (2,3,5) or l.monihaku2013 in (2,3,5)) then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.monihaku2010 in (2,3,5) or l.monihaku2011 in (2,3,5) or l.monihaku2012 in (2,3,5) or l.monihaku2013 in (2,3,5) or l.monihaku2014 in (2,3,5)) then 1*/
	else 0
end as haku_amm
--Hakenut ammattikorkeakoulutukseen
,case
	when  l.suorlk = '1' and (l.monihaku_1 in (4,6) or l.monihaku_2 in (4,6) or l.monihaku_3 in (4,6) or l.monihaku_4 in (4,6) or l.monihaku_5 in (4,6)) then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.monihaku_2 in (4,6) or l.monihaku_3 in (4,6) or l.monihaku_4 in (4,6) or l.monihaku_5 in (4,6) or l.monihaku2009 in (4,6)) then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.monihaku_3 in (4,6) or l.monihaku_4 in (4,6) or l.monihaku_5 in (4,6) or l.monihaku2009 in (4,6) or l.monihaku2010 in (4,6)) then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.monihaku_4 in (4,6) or l.monihaku_5 in (4,6) or l.monihaku2009 in (4,6) or l.monihaku2010 in (4,6) or l.monihaku2011 in (4,6)) then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.monihaku_5 in (4,6) or l.monihaku2009 in (4,6) or l.monihaku2010 in (4,6) or l.monihaku2011 in (4,6) or l.monihaku2012 in (4,6)) then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.monihaku2009 in (4,6) or l.monihaku2010 in (4,6) or l.monihaku2011 in (4,6) or l.monihaku2012 in (4,6) or l.monihaku2013 in (4,6)) then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.monihaku2010 in (4,6) or l.monihaku2011 in (4,6) or l.monihaku2012 in (4,6) or l.monihaku2013 in (4,6) or l.monihaku2014 in (4,6)) then 1*/
	else 0
end as haku_amk
--Hakenut yliopistokoulutukseen
,case
	when  l.suorlk = '1' and (l.monihaku_1 in (6,7) or l.monihaku_2 in (6,7) or l.monihaku_3 in (6,7) or l.monihaku_4 in (6,7) or l.monihaku_5 in (6,7)) then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.monihaku_2 in (6,7) or l.monihaku_3 in (6,7) or l.monihaku_4 in (6,7) or l.monihaku_5 in (6,7) or l.monihaku2009 in (6,7)) then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.monihaku_3 in (6,7) or l.monihaku_4 in (6,7) or l.monihaku_5 in (6,7) or l.monihaku2009 in (6,7) or l.monihaku2010 in (6,7)) then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.monihaku_4 in (6,7) or l.monihaku_5 in (6,7) or l.monihaku2009 in (6,7) or l.monihaku2010 in (6,7) or l.monihaku2011 in (6,7)) then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.monihaku_5 in (6,7) or l.monihaku2009 in (6,7) or l.monihaku2010 in (6,7) or l.monihaku2011 in (6,7) or l.monihaku2012 in (6,7)) then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.monihaku2009 in (6,7) or l.monihaku2010 in (6,7) or l.monihaku2011 in (6,7) or l.monihaku2012 in (6,7) or l.monihaku2013 in (6,7)) then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.monihaku2010 in (6,7) or l.monihaku2011 in (6,7) or l.monihaku2012 in (6,7) or l.monihaku2013 in (6,7) or l.monihaku2014 in (6,7)) then 1*/
	else 0
end as haku_yo




----MITTARIT
--Ei hakenut eikä opiskellut mitään
,case
	when  l.suorlk = '1' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and l.luopiskkoulk_1 = '' and l.ammopiskkoulk_1 = '' and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and monihaku_5 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and monihaku2014 not in (4,5,6,7) and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1*/
	else 0
end eihaku_kk_eiopisk

--Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa
,case 
	when  l.suorlk = '1' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and (l.luopiskkoulk_1 <> '' or l.ammopiskkoulk_1 <> '' or l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.ammopiskkoulk_5 <> '') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and (l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.ammopiskkoulk_5 <> '' or l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and (l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.ammopiskkoulk_5 <> '' or l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '') and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and (l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.ammopiskkoulk_5 <> '' or l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '') and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and monihaku_5 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and (l.luopiskkoulk_5 <> '' or l.ammopiskkoulk_5 <> '' or l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '') and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and (l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '' or l.ammopiskkoulk2013 <> '') and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and monihaku2014 not in (4,5,6,7) and (l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '' or l.ammopiskkoulk2013 <> '' or l.luopiskkoulk2014 <> '' or l.ammopiskkoulk2014 <> '') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1*/
	else 0
end eihaku_kk_eiopisk_kk_opisk_ta

----Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa, opiskellut lukiokoulutuksessa
,case 
	when  l.suorlk = '1' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and (l.luopiskkoulk_1 <> '' or l.luopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and (l.luopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.luopiskkoulk2009 <> '') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and (l.luopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.luopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '') and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and (l.luopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.luopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '') and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and monihaku_5 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and (l.luopiskkoulk_5 <> '' or l.luopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '') and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and (l.luopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '') and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and monihaku2014 not in (4,5,6,7) and (l.luopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '' or l.luopiskkoulk2014 <> '') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1*/
	else 0
end eihaku_kk_eiopisk_kk_opisk_lu

----Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa, opiskellut ammatillisessa peruskoulutuksessa
,case 
	when  l.suorlk = '1' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and (d1c.Koulutusaste_taso2_koodi = '32' or d2c.Koulutusaste_taso2_koodi = '32' or d3c.Koulutusaste_taso2_koodi = '32' or d4c.Koulutusaste_taso2_koodi = '32' or d5c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and (d2c.Koulutusaste_taso2_koodi = '32' or d3c.Koulutusaste_taso2_koodi = '32' or d4c.Koulutusaste_taso2_koodi = '32' or d5c.Koulutusaste_taso2_koodi = '32' or d6c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and (d3c.Koulutusaste_taso2_koodi = '32' or d4c.Koulutusaste_taso2_koodi = '32' or d5c.Koulutusaste_taso2_koodi = '32' or d6c.Koulutusaste_taso2_koodi = '32' or d7c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and (d4c.Koulutusaste_taso2_koodi = '32' or d5c.Koulutusaste_taso2_koodi = '32' or d6c.Koulutusaste_taso2_koodi = '32' or d7c.Koulutusaste_taso2_koodi = '32' or d8c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and monihaku_5 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and (d5c.Koulutusaste_taso2_koodi = '32' or d6c.Koulutusaste_taso2_koodi = '32' or d7c.Koulutusaste_taso2_koodi = '32' or d8c.Koulutusaste_taso2_koodi = '32' or d9c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and (d6c.Koulutusaste_taso2_koodi = '32' or d7c.Koulutusaste_taso2_koodi = '32' or d8c.Koulutusaste_taso2_koodi = '32' or d9c.Koulutusaste_taso2_koodi = '32' or d10c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and monihaku2014 not in (4,5,6,7) and (d7c.Koulutusaste_taso2_koodi = '32' or d8c.Koulutusaste_taso2_koodi = '32' or d9c.Koulutusaste_taso2_koodi = '32' or d10c.Koulutusaste_taso2_koodi = '32' or d11c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1*/
	else 0
end eihaku_kk_eiopisk_kk_opisk_pk

------Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa, opiskellut ammattitutkintokoulutuksessa
,case 
	when  l.suorlk = '1' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and (d1c.Koulutusaste_taso2_koodi = '33' or d2c.Koulutusaste_taso2_koodi = '33' or d3c.Koulutusaste_taso2_koodi = '33' or d4c.Koulutusaste_taso2_koodi = '33' or d5c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and (d2c.Koulutusaste_taso2_koodi = '33' or d3c.Koulutusaste_taso2_koodi = '33' or d4c.Koulutusaste_taso2_koodi = '33' or d5c.Koulutusaste_taso2_koodi = '33' or d6c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and (d3c.Koulutusaste_taso2_koodi = '33' or d4c.Koulutusaste_taso2_koodi = '33' or d5c.Koulutusaste_taso2_koodi = '33' or d6c.Koulutusaste_taso2_koodi = '33' or d7c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and (d4c.Koulutusaste_taso2_koodi = '33' or d5c.Koulutusaste_taso2_koodi = '33' or d6c.Koulutusaste_taso2_koodi = '33' or d7c.Koulutusaste_taso2_koodi = '33' or d8c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and monihaku_5 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and (d5c.Koulutusaste_taso2_koodi = '33' or d6c.Koulutusaste_taso2_koodi = '33' or d7c.Koulutusaste_taso2_koodi = '33' or d8c.Koulutusaste_taso2_koodi = '33' or d9c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and (d6c.Koulutusaste_taso2_koodi = '33' or d7c.Koulutusaste_taso2_koodi = '33' or d8c.Koulutusaste_taso2_koodi = '33' or d9c.Koulutusaste_taso2_koodi = '33' or d10c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and monihaku2014 not in (4,5,6,7) and (d7c.Koulutusaste_taso2_koodi = '33' or d8c.Koulutusaste_taso2_koodi = '33' or d9c.Koulutusaste_taso2_koodi = '33' or d10c.Koulutusaste_taso2_koodi = '33' or d11c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1*/
	else 0
end eihaku_kk_eiopisk_kk_opisk_at

------Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa, opiskellut erikoisammattitutkintokoulutuksessa
,case 
	when  l.suorlk = '1' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and (d1c.Koulutusaste_taso2_koodi = '41' or d2c.Koulutusaste_taso2_koodi = '41' or d3c.Koulutusaste_taso2_koodi = '41' or d4c.Koulutusaste_taso2_koodi = '41' or d5c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and (d2c.Koulutusaste_taso2_koodi = '41' or d3c.Koulutusaste_taso2_koodi = '41' or d4c.Koulutusaste_taso2_koodi = '41' or d5c.Koulutusaste_taso2_koodi = '41' or d6c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and (d3c.Koulutusaste_taso2_koodi = '41' or d4c.Koulutusaste_taso2_koodi = '41' or d5c.Koulutusaste_taso2_koodi = '41' or d6c.Koulutusaste_taso2_koodi = '41' or d7c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and (d4c.Koulutusaste_taso2_koodi = '41' or d5c.Koulutusaste_taso2_koodi = '41' or d6c.Koulutusaste_taso2_koodi = '41' or d7c.Koulutusaste_taso2_koodi = '41' or d8c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and monihaku_5 not in (4,5,6,7) and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and (d5c.Koulutusaste_taso2_koodi = '41' or d6c.Koulutusaste_taso2_koodi = '41' or d7c.Koulutusaste_taso2_koodi = '41' or d8c.Koulutusaste_taso2_koodi = '41' or d9c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and monihaku2009 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and (d6c.Koulutusaste_taso2_koodi = '41' or d7c.Koulutusaste_taso2_koodi = '41' or d8c.Koulutusaste_taso2_koodi = '41' or d9c.Koulutusaste_taso2_koodi = '41' or d10c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and monihaku2014 not in (4,5,6,7) and (d7c.Koulutusaste_taso2_koodi = '41' or d8c.Koulutusaste_taso2_koodi = '41' or d9c.Koulutusaste_taso2_koodi = '41' or d10c.Koulutusaste_taso2_koodi = '41' or d11c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1*/
	else 0
end eihaku_kk_eiopisk_kk_opisk_eat

--Hakenut korkea-asteelle, ei opiskellut korkea-asteella
,case 
	when  l.suorlk = '1' and (monihaku_1 in (4,5,6,7) or monihaku_2 in (4,5,6,7) or monihaku_3 in (4,5,6,7) or monihaku_4 in (4,5,6,7) or monihaku_5 in (4,5,6,7)) and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (monihaku_2 in (4,5,6,7) or monihaku_3 in (4,5,6,7) or monihaku_4 in (4,5,6,7) or monihaku_5 in (4,5,6,7) or monihaku2009 in (4,5,6,7)) and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (monihaku_3 in (4,5,6,7) or monihaku_4 in (4,5,6,7) or monihaku_5 in (4,5,6,7) or monihaku2009 in (4,5,6,7) or monihaku2010 in (4,5,6,7)) and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (monihaku_4 in (4,5,6,7) or monihaku_5 in (4,5,6,7) or monihaku2009 in (4,5,6,7) or monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7)) and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (monihaku_5 in (4,5,6,7) or monihaku2009 in (4,5,6,7) or monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7) or monihaku2012 in (4,5,6,7)) and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (monihaku2009 in (4,5,6,7) or monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7) or monihaku2012 in (4,5,6,7) or monihaku2013 in (4,5,6,7)) and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7) or monihaku2012 in (4,5,6,7) or monihaku2013 in (4,5,6,7) or monihaku2014 in (4,5,6,7)) and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1*/
	else 0
end haku_kk_eiopisk_kk
----Hakenut korkea-asteelle, ei opiskellut korkea-asteella, ei-opiskellut toisen asteen koulutuksessa
,case
	when  l.suorlk = '1' and (monihaku_1 in (4,5,6,7) or monihaku_2 in (4,5,6,7) or monihaku_3 in (4,5,6,7) or monihaku_4 in (4,5,6,7) or monihaku_5 in (4,5,6,7)) and l.luopiskkoulk_1 = '' and l.ammopiskkoulk_1 = '' and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (monihaku_2 in (4,5,6,7) or monihaku_3 in (4,5,6,7) or monihaku_4 in (4,5,6,7) or monihaku_5 in (4,5,6,7) or monihaku2009 in (4,5,6,7)) and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (monihaku_3 in (4,5,6,7) or monihaku_4 in (4,5,6,7) or monihaku_5 in (4,5,6,7) or monihaku2009 in (4,5,6,7) or monihaku2010 in (4,5,6,7)) and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (monihaku_4 in (4,5,6,7) or monihaku_5 in (4,5,6,7) or monihaku2009 in (4,5,6,7) or monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7)) and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (monihaku_5 in (4,5,6,7) or monihaku2009 in (4,5,6,7) or monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7) or monihaku2012 in (4,5,6,7)) and l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (monihaku2009 in (4,5,6,7) or monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7) or monihaku2012 in (4,5,6,7) or monihaku2013 in (4,5,6,7)) and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7) or monihaku2012 in (4,5,6,7) or monihaku2013 in (4,5,6,7) or monihaku2014 in (4,5,6,7)) and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1*/
	else 0
end haku_kk_eiopisk_kk_eiopisk_ta
----Hakenut korkea-asteelle, ei opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa
,case
	when  l.suorlk = '1' and (monihaku_1 in (4,5,6,7) or monihaku_2 in (4,5,6,7) or monihaku_3 in (4,5,6,7) or monihaku_4 in (4,5,6,7) or monihaku_5 in (4,5,6,7)) and (l.luopiskkoulk_1 <> '' or l.ammopiskkoulk_1 <> '' or l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.ammopiskkoulk_5 <> '') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (monihaku_2 in (4,5,6,7) or monihaku_3 in (4,5,6,7) or monihaku_4 in (4,5,6,7) or monihaku_5 in (4,5,6,7) or monihaku2009 in (4,5,6,7)) and (l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.ammopiskkoulk_5 <> '' or l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (monihaku_3 in (4,5,6,7) or monihaku_4 in (4,5,6,7) or monihaku_5 in (4,5,6,7) or monihaku2009 in (4,5,6,7) or monihaku2010 in (4,5,6,7)) and (l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.ammopiskkoulk_5 <> '' or l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '') and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (monihaku_4 in (4,5,6,7) or monihaku_5 in (4,5,6,7) or monihaku2009 in (4,5,6,7) or monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7)) and (l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.ammopiskkoulk_5 <> '' or l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '') and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (monihaku_5 in (4,5,6,7) or monihaku2009 in (4,5,6,7) or monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7) or monihaku2012 in (4,5,6,7)) and (l.luopiskkoulk_5 <> '' or l.ammopiskkoulk_5 <> '' or l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '') and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (monihaku2009 in (4,5,6,7) or monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7) or monihaku2012 in (4,5,6,7) or monihaku2013 in (4,5,6,7)) and (l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '' or l.ammopiskkoulk2013 <> '') and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7) or monihaku2012 in (4,5,6,7) or monihaku2013 in (4,5,6,7) or monihaku2014 in (4,5,6,7)) and (l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '' or l.ammopiskkoulk2013 <> '' or l.luopiskkoulk2014 <> '' or l.ammopiskkoulk2014 <> '') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1*/
	else 0
end haku_kk_eiopisk_kk_opisk_ta
----Hakenut vain ammattikorkeakouluun, ei opiskellut korkea-asteella
,case
	when  l.suorlk = '1' and (monihaku_1 = 4 or monihaku_2 = 4 or monihaku_3 = 4 or monihaku_4 = 4 or monihaku_5 = 4) and (monihaku_1 not in (5,6,7) and monihaku_2 not in (5,6,7) and monihaku_3 not in (5,6,7) and monihaku_4 not in (5,6,7) and monihaku_5 not in (5,6,7)) and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (monihaku_2 = 4 or monihaku_3 = 4 or monihaku_4 = 4 or monihaku_5 = 4 or monihaku2009 = 4) and (monihaku_2 not in (5,6,7) and monihaku_3 not in (5,6,7) and monihaku_4 not in (5,6,7) and monihaku_5 not in (5,6,7) and monihaku2009 not in (5,6,7)) and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (monihaku_3 = 4 or monihaku_4 = 4 or monihaku_5 = 4 or monihaku2009 = 4 or monihaku2010 = 4) and (monihaku_3 not in (5,6,7) and monihaku_4 not in (5,6,7) and monihaku_5 not in (5,6,7) and monihaku2009 not in (5,6,7) and monihaku2010 not in (5,6,7)) and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (monihaku_4 = 4 or monihaku_5 = 4 or monihaku2009 = 4 or monihaku2010 = 4 or monihaku2011 = 4) and (monihaku_4 not in (5,6,7) and monihaku_5 not in (5,6,7) and monihaku2009 not in (5,6,7) and monihaku2010 not in (5,6,7) and monihaku2011 not in (5,6,7)) and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (monihaku_5 = 4 or monihaku2009 = 4 or monihaku2010 = 4 or monihaku2011 = 4 or monihaku2012 = 4) and (monihaku_5 not in (5,6,7) and monihaku2009 not in (5,6,7) and monihaku2010 not in (5,6,7) and monihaku2011 not in (5,6,7) and monihaku2012 not in (5,6,7)) and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (monihaku2009 = 4 or monihaku2010 = 4 or monihaku2011 = 4 or monihaku2012 = 4 or monihaku2013 = 4) and (monihaku2009 not in (5,6,7) and monihaku2010 not in (5,6,7) and monihaku2011 not in (5,6,7) and monihaku2012 not in (5,6,7) and monihaku2013 not in (5,6,7)) and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (monihaku2010 = 4 or monihaku2011 = 4 or monihaku2012 = 4 or monihaku2013 = 4 or monihaku2014 = 4) and (monihaku2010 not in (5,6,7) and monihaku2011 not in (5,6,7) and monihaku2012 not in (5,6,7) and monihaku2013 not in (5,6,7) and monihaku2014 not in (5,6,7)) and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1*/
	else 0
end haku_amk_eiopisk_kk
----Hakenut vain yliopistokoulutukseen, ei opiskellut korkea-asteella
,case
	when  l.suorlk = '1' and (monihaku_1 = 7 or monihaku_2 = 7 or monihaku_3 = 7 or monihaku_4 = 7 or monihaku_5 = 7) and (monihaku_1 not in (4,5,6) and monihaku_2 not in (4,5,6) and monihaku_3 not in (4,5,6) and monihaku_4 not in (4,5,6) and monihaku_5 not in (4,5,6)) and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (monihaku_2 = 7 or monihaku_3 = 7 or monihaku_4 = 7 or monihaku_5 = 7 or monihaku2009 = 7) and (monihaku_2 not in (4,5,6) and monihaku_3 not in (4,5,6) and monihaku_4 not in (4,5,6) and monihaku_5 not in (4,5,6) and monihaku2009 not in (4,5,6)) and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (monihaku_3 = 7 or monihaku_4 = 7 or monihaku_5 = 7 or monihaku2009 = 7 or monihaku2010 = 7) and (monihaku_3 not in (4,5,6) and monihaku_4 not in (4,5,6) and monihaku_5 not in (4,5,6) and monihaku2009 not in (4,5,6) and monihaku2010 not in (4,5,6)) and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (monihaku_4 = 7 or monihaku_5 = 7 or monihaku2009 = 7 or monihaku2010 = 7 or monihaku2011 = 7) and (monihaku_4 not in (4,5,6) and monihaku_5 not in (4,5,6) and monihaku2009 not in (4,5,6) and monihaku2010 not in (4,5,6) and monihaku2011 not in (4,5,6)) and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (monihaku_5 = 7 or monihaku2009 = 7 or monihaku2010 = 7 or monihaku2011 = 7 or monihaku2012 = 7) and (monihaku_5 not in (4,5,6) and monihaku2009 not in (4,5,6) and monihaku2010 not in (4,5,6) and monihaku2011 not in (4,5,6) and monihaku2012 not in (4,5,6)) and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (monihaku2009 = 7 or monihaku2010 = 7 or monihaku2011 = 7 or monihaku2012 = 7 or monihaku2013 = 7) and (monihaku2009 not in (4,5,6) and monihaku2010 not in (4,5,6) and monihaku2011 not in (4,5,6) and monihaku2012 not in (4,5,6) and monihaku2013 not in (4,5,6)) and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (monihaku2010 = 7 or monihaku2011 = 7 or monihaku2012 = 7 or monihaku2013 = 7 or monihaku2014 = 7) and (monihaku2010 not in (4,5,6) and monihaku2011 not in (4,5,6) and monihaku2012 not in (4,5,6) and monihaku2013 not in (4,5,6) and monihaku2014 not in (4,5,6)) and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1*/
	else 0
end haku_yo_eiopisk_kk
----Hakenut sekä amk- että yliopistokoulutukseen, ei opiskellut korkea-asteella
,case
	when  l.suorlk = '1' and (monihaku_1 = 6 or monihaku_2 = 6 or monihaku_3 = 6 or monihaku_4 = 6 or monihaku_5 = 6 or ((monihaku_1 = 4 or monihaku_2 = 4 or monihaku_3 = 4 or monihaku_4 = 4 or monihaku_5 = 4) and (monihaku_1 = 7 or monihaku_2 = 7 or monihaku_3 = 7 or monihaku_4 = 7 or monihaku_5 = 7))) and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (monihaku_2 = 6 or monihaku_3 = 6 or monihaku_4 = 6 or monihaku_5 = 6 or monihaku2009 = 6 or ((monihaku_2 = 4 or monihaku_3 = 4 or monihaku_4 = 4 or monihaku_5 = 4 or monihaku2009 = 4) and (monihaku_2 = 7 or monihaku_3 = 7 or monihaku_4 = 7 or monihaku_5 = 7 or monihaku2009 = 7))) and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (monihaku_3 = 6 or monihaku_4 = 6 or monihaku_5 = 6 or monihaku2009 = 6 or monihaku2010 = 6 or ((monihaku_3 = 4 or monihaku_4 = 4 or monihaku_5 = 4 or monihaku2009 = 4 or monihaku2010 = 4) and (monihaku_3 = 7 or monihaku_4 = 7 or monihaku_5 = 7 or monihaku2009 = 7 or monihaku2010 = 7))) and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (monihaku_4 = 6 or monihaku_5 = 6 or monihaku2009 = 6 or monihaku2010 = 6 or monihaku2011 = 6 or ((monihaku_4 = 4 or monihaku_5 = 4 or monihaku2009 = 4 or monihaku2010 = 4 or monihaku2011 = 4) and (monihaku_4 = 7 or monihaku_5 = 7 or monihaku2009 = 7 or monihaku2010 = 7 or monihaku2011 = 7))) and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (monihaku_5 = 6 or monihaku2009 = 6 or monihaku2010 = 6 or monihaku2011 = 6 or monihaku2012 = 6 or ((monihaku_5 = 4 or monihaku2009 = 4 or monihaku2010 = 4 or monihaku2011 = 4 or monihaku2012 = 4) and (monihaku_5 = 7 or monihaku2009 = 7 or monihaku2010 = 7 or monihaku2011 = 7 or monihaku2012 = 7))) and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (monihaku2009 = 6 or monihaku2010 = 6 or monihaku2011 = 6 or monihaku2012 = 6 or monihaku2013 = 6 or ((monihaku2009 = 4 or monihaku2010 = 4 or monihaku2011 = 4 or monihaku2012 = 4 or monihaku2013 = 4) and (monihaku2009 = 7 or monihaku2010 = 7 or monihaku2011 = 7 or monihaku2012 = 7 or monihaku2013 = 7))) and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (monihaku2010 = 6 or monihaku2011 = 6 or monihaku2012 = 6 or monihaku2013 = 6 or monihaku2014 = 6 or ((monihaku2010 = 4 or monihaku2011 = 4 or monihaku2012 = 4 or monihaku2013 = 4 or monihaku2014 = 4) and (monihaku2010 = 7 or monihaku2011 = 7 or monihaku2012 = 7 or monihaku2013 = 7 or monihaku2014 = 7))) and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1*/
	else 0
end haku_amkyo_eiopisk_kk

--Opiskellut korkea-asteella
,case
	when  l.suorlk = '1' and (l.amkopiskkoulk_1 <> '' or l.yoopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.yoopiskkoulk_5 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.yoopiskkoulk_5 <> '' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.yoopiskkoulk_5 <> '' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.yoopiskkoulk_5 <> '' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk_5 <> '' or l.yoopiskkoulk_5 <> '' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '' or l.yoopiskkoulk2013 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '' or l.yoopiskkoulk2013 <> '' or l.amkopiskkoulk2014 <> '' or l.yoopiskkoulk2014 <> '') then 1*/
	else 0
end opisk_kk
----Opiskellut korkea-asteella, ei-opiskellut toisen asteen koulutuksessa
,case
	when  l.suorlk = '1' and l.luopiskkoulk_1 = '' and l.ammopiskkoulk_1 = '' and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = '' and (l.amkopiskkoulk_1 <> '' or l.yoopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.yoopiskkoulk_5 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = '' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and (l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.yoopiskkoulk_5 <> '' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = '' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and (l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.yoopiskkoulk_5 <> '' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = '' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and (l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.yoopiskkoulk_5 <> '' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = '' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and (l.amkopiskkoulk_5 <> '' or l.yoopiskkoulk_5 <> '' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = '' and (l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '' or l.yoopiskkoulk2013 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = '' and l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 = '' and (l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '' or l.yoopiskkoulk2013 <> '' or l.amkopiskkoulk2014 <> '' or l.yoopiskkoulk2014 <> '') then 1*/
	else 0
end opisk_kk_eiopisk_ta
----Opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa
,case
	when  l.suorlk = '1' and (l.luopiskkoulk_1 <> '' or l.ammopiskkoulk_1 <> '' or l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.ammopiskkoulk_5 <> '') and (l.amkopiskkoulk_1 <> '' or l.yoopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.yoopiskkoulk_5 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.ammopiskkoulk_5 <> '' or l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '') and (l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.yoopiskkoulk_5 <> '' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.ammopiskkoulk_5 <> '' or l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '') and (l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.yoopiskkoulk_5 <> '' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.ammopiskkoulk_5 <> '' or l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '') and (l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.yoopiskkoulk_5 <> '' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk_5 <> '' or l.ammopiskkoulk_5 <> '' or l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '') and (l.amkopiskkoulk_5 <> '' or l.yoopiskkoulk_5 <> '' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '' or l.ammopiskkoulk2013 <> '') and (l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '' or l.yoopiskkoulk2013 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '' or l.ammopiskkoulk2013 <> '' or l.luopiskkoulk2014 <> '' or l.ammopiskkoulk2014 <> '') and (l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '' or l.yoopiskkoulk2013 <> '' or l.amkopiskkoulk2014 <> '' or l.yoopiskkoulk2014 <> '') then 1*/
	else 0
end opisk_kk_opisk_ta
----Opiskellut vain ammattikorkeakoulussa
,case
	when  l.suorlk = '1' and (l.amkopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '') and l.yoopiskkoulk_1 = '' and l.yoopiskkoulk_2 = '' and l.yoopiskkoulk_3 = '' and l.yoopiskkoulk_4 = '' and l.yoopiskkoulk_5 = ''then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.amkopiskkoulk2009 <> '') and l.yoopiskkoulk_2 = '' and l.yoopiskkoulk_3 = '' and l.yoopiskkoulk_4 = '' and l.yoopiskkoulk_5 = '' and l.yoopiskkoulk2009 = ''then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.amkopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '') and l.yoopiskkoulk_3 = '' and l.yoopiskkoulk_4 = '' and l.yoopiskkoulk_5 = '' and l.yoopiskkoulk2009 = '' and l.yoopiskkoulk2010 = ''then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.amkopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '') and l.yoopiskkoulk_4 = '' and l.yoopiskkoulk_5 = '' and l.yoopiskkoulk2009 = '' and l.yoopiskkoulk2010 = '' and l.yoopiskkoulk2011 = ''then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk_5 <> '' or l.amkopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '') and l.yoopiskkoulk_5 = '' and l.yoopiskkoulk2009 = '' and l.yoopiskkoulk2010 = '' and l.yoopiskkoulk2011 = '' and l.yoopiskkoulk2012 = ''then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '') and l.yoopiskkoulk2009 = '' and l.yoopiskkoulk2010 = '' and l.yoopiskkoulk2011 = '' and l.yoopiskkoulk2012 = '' and l.yoopiskkoulk2013 = ''then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '' or l.amkopiskkoulk2014 <> '') and l.yoopiskkoulk2010 = '' and l.yoopiskkoulk2011 = '' and l.yoopiskkoulk2012 = '' and l.yoopiskkoulk2013 = '' and l.yoopiskkoulk2014 = ''then 1*/
	else 0
end opisk_vain_amk
----Opiskellut vain yliopistokoulutuksessa
,case
	when  l.suorlk = '1' and l.amkopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and (l.yoopiskkoulk_1 <> '' or l.yoopiskkoulk_2 <> '' or l.yoopiskkoulk_3 <> '' or l.yoopiskkoulk_4 <> '' or l.yoopiskkoulk_5 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and l.amkopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and (l.yoopiskkoulk_2 <> '' or l.yoopiskkoulk_3 <> '' or l.yoopiskkoulk_4 <> '' or l.yoopiskkoulk_5 <> '' or l.yoopiskkoulk2009 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and l.amkopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and (l.yoopiskkoulk_3 <> '' or l.yoopiskkoulk_4 <> '' or l.yoopiskkoulk_5 <> '' or l.yoopiskkoulk2009 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and l.amkopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and (l.yoopiskkoulk_4 <> '' or l.yoopiskkoulk_5 <> '' or l.yoopiskkoulk2009 <> '' or l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and l.amkopiskkoulk_5 = '' and l.amkopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and (l.yoopiskkoulk_5 <> '' or l.yoopiskkoulk2009 <> '' or l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '' or l.yoopiskkoulk2012 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and l.amkopiskkoulk2009 = '' and l.amkopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and (l.yoopiskkoulk2009 <> '' or l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '' or l.yoopiskkoulk2012 <> '' or l.yoopiskkoulk2013 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and l.amkopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and (l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '' or l.yoopiskkoulk2012 <> '' or l.yoopiskkoulk2013 <> '' or l.yoopiskkoulk2014 <> '') then 1*/
	else 0
end opisk_vain_yo
----Opiskellut sekä amk- että yliopistokoulutuksessa
,case
	when  l.suorlk = '1' and (l.amkopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '') and (l.yoopiskkoulk_1 <> '' or l.yoopiskkoulk_2 <> '' or l.yoopiskkoulk_3 <> '' or l.yoopiskkoulk_4 <> '' or l.yoopiskkoulk_5 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.amkopiskkoulk2009 <> '') and (l.yoopiskkoulk_2 <> '' or l.yoopiskkoulk_3 <> '' or l.yoopiskkoulk_4 <> '' or l.yoopiskkoulk_5 <> '' or l.yoopiskkoulk2009 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.amkopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '') and (l.yoopiskkoulk_3 <> '' or l.yoopiskkoulk_4 <> '' or l.yoopiskkoulk_5 <> '' or l.yoopiskkoulk2009 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.amkopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '') and (l.yoopiskkoulk_4 <> '' or l.yoopiskkoulk_5 <> '' or l.yoopiskkoulk2009 <> '' or l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk_5 <> '' or l.amkopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '') and (l.yoopiskkoulk_5 <> '' or l.yoopiskkoulk2009 <> '' or l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '' or l.yoopiskkoulk2012 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2009 <> '' or l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '') and (l.yoopiskkoulk2009 <> '' or l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '' or l.yoopiskkoulk2012 <> '' or l.yoopiskkoulk2013 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '' or l.amkopiskkoulk2014 <> '') and (l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '' or l.yoopiskkoulk2012 <> '' or l.yoopiskkoulk2013 <> '' or l.yoopiskkoulk2014 <> '') then 1*/
	else 0
end opisk_amkyo


	 
FROM 
    (
	select * from [VipunenTK_SA].[dbo].[v_K3_13_Perusk_paattaneet_amm_tutk_suorittaneet]
	where suorlk = '1'
	
	) as l

LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d1a on d1a.koulutusluokitus_avain=l.amkopiskkoulk_1
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d2a on d2a.koulutusluokitus_avain=l.amkopiskkoulk_2
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d3a on d3a.koulutusluokitus_avain=l.amkopiskkoulk_3
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d4a on d4a.koulutusluokitus_avain=l.amkopiskkoulk_4
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d5a on d5a.koulutusluokitus_avain=l.amkopiskkoulk_5
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d6a on d6a.koulutusluokitus_avain=l.amkopiskkoulk_6
/*LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d7a on d7a.koulutusluokitus_avain=l.amkopiskkoulk2010
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d8a on d8a.koulutusluokitus_avain=l.amkopiskkoulk2011
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d9a on d9a.koulutusluokitus_avain=l.amkopiskkoulk2012
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d10a on d10a.koulutusluokitus_avain=l.amkopiskkoulk2013
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d11a on d11a.koulutusluokitus_avain=l.amkopiskkoulk2014*/

LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d1b on d1b.koulutusluokitus_avain=l.yoopiskkoulk_1
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d2b on d2b.koulutusluokitus_avain=l.yoopiskkoulk_2
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d3b on d3b.koulutusluokitus_avain=l.yoopiskkoulk_3
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d4b on d4b.koulutusluokitus_avain=l.yoopiskkoulk_4
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d5b on d5b.koulutusluokitus_avain=l.yoopiskkoulk_5
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d6b on d6b.koulutusluokitus_avain=l.yoopiskkoulk_6
/*LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d7b on d7b.koulutusluokitus_avain=l.yoopiskkoulk2010
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d8b on d8b.koulutusluokitus_avain=l.yoopiskkoulk2011	
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d9b on d9b.koulutusluokitus_avain=l.yoopiskkoulk2012
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d10b on d10b.koulutusluokitus_avain=l.yoopiskkoulk2013
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d11b on d11b.koulutusluokitus_avain=l.yoopiskkoulk2014	*/

LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d1c on d1c.koulutusluokitus_avain=l.ammopiskkoulk_1
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d2c on d2c.koulutusluokitus_avain=l.ammopiskkoulk_2
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d3c on d3c.koulutusluokitus_avain=l.ammopiskkoulk_3
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d4c on d4c.koulutusluokitus_avain=l.ammopiskkoulk_4
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d5c on d5c.koulutusluokitus_avain=l.ammopiskkoulk_5
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d6c on d6c.koulutusluokitus_avain=l.ammopiskkoulk_6
/*LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d7c on d7c.koulutusluokitus_avain=l.ammopiskkoulk2010
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d8c on d8c.koulutusluokitus_avain=l.ammopiskkoulk2011
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d9c on d9c.koulutusluokitus_avain=l.ammopiskkoulk2012
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d10c on d10c.koulutusluokitus_avain=l.ammopiskkoulk2013
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d11c on d11c.koulutusluokitus_avain=l.ammopiskkoulk2014*/
	
CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d1a.iscfibroad2013_koodi),(d1b.iscfibroad2013_koodi), (d2a.iscfibroad2013_koodi),(d2b.iscfibroad2013_koodi), (d3a.iscfibroad2013_koodi),(d3b.iscfibroad2013_koodi), (d4a.iscfibroad2013_koodi),(d4b.iscfibroad2013_koodi), (d5a.iscfibroad2013_koodi),(d5b.iscfibroad2013_koodi)) AS a(d)) m1
CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d2a.iscfibroad2013_koodi),(d2b.iscfibroad2013_koodi), (d3a.iscfibroad2013_koodi),(d3b.iscfibroad2013_koodi), (d4a.iscfibroad2013_koodi),(d4b.iscfibroad2013_koodi), (d5a.iscfibroad2013_koodi),(d5b.iscfibroad2013_koodi), (d6a.iscfibroad2013_koodi),(d6b.iscfibroad2013_koodi)) AS a(d)) m2
/*CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d3a.iscfibroad2013_koodi),(d3b.iscfibroad2013_koodi), (d4a.iscfibroad2013_koodi),(d4b.iscfibroad2013_koodi), (d5a.iscfibroad2013_koodi),(d5b.iscfibroad2013_koodi), (d6a.iscfibroad2013_koodi),(d6b.iscfibroad2013_koodi), (d7a.iscfibroad2013_koodi),(d7b.iscfibroad2013_koodi)) AS a(d)) m3
CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d4a.iscfibroad2013_koodi),(d4b.iscfibroad2013_koodi), (d5a.iscfibroad2013_koodi),(d5b.iscfibroad2013_koodi), (d6a.iscfibroad2013_koodi),(d6b.iscfibroad2013_koodi), (d7a.iscfibroad2013_koodi),(d7b.iscfibroad2013_koodi), (d8a.iscfibroad2013_koodi),(d8b.iscfibroad2013_koodi)) AS a(d)) m4
CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d5a.iscfibroad2013_koodi),(d5b.iscfibroad2013_koodi), (d6a.iscfibroad2013_koodi),(d6b.iscfibroad2013_koodi), (d7a.iscfibroad2013_koodi),(d7b.iscfibroad2013_koodi), (d8a.iscfibroad2013_koodi),(d8b.iscfibroad2013_koodi), (d9a.iscfibroad2013_koodi),(d9b.iscfibroad2013_koodi)) AS a(d)) m5
CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d6a.iscfibroad2013_koodi),(d6b.iscfibroad2013_koodi), (d7a.iscfibroad2013_koodi),(d7b.iscfibroad2013_koodi), (d8a.iscfibroad2013_koodi),(d8b.iscfibroad2013_koodi), (d9a.iscfibroad2013_koodi),(d9b.iscfibroad2013_koodi), (d10a.iscfibroad2013_koodi),(d10b.iscfibroad2013_koodi)) AS a(d)) m6
CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d7a.iscfibroad2013_koodi),(d7b.iscfibroad2013_koodi), (d8a.iscfibroad2013_koodi),(d8b.iscfibroad2013_koodi), (d9a.iscfibroad2013_koodi),(d9b.iscfibroad2013_koodi), (d10a.iscfibroad2013_koodi),(d10b.iscfibroad2013_koodi), (d11a.iscfibroad2013_koodi),(d11b.iscfibroad2013_koodi)) AS a(d)) m7*/

	
	WHERE 1=1
--end;

--
-- TULOS
-- 
/*
if @debug_what_to_run>=3 begin
	if @debug_what_to_run>0 print 'querying result';
	select * from [VipunenTK_DW].[dbo].[_koulutukseen_sijoittuneet_6v]
	--select COUNT(*) from vipunen_tk.f_tyol_ja_jatko_opin_ where aineisto=(select id from vipunen_tk.d_aineisto where aineistokoodi='4.3' and @toinen_suoritusvuosi between alkaa and paattyy)
end;

if @debug_what_to_run>0 PRINT 'all done.';
*/

GO
/****** Object:  StoredProcedure [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_4_5_tarkastelujakso]    Script Date: 29.8.2018 15:59:41 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


CREATE PROCEDURE [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_4_5_tarkastelujakso] AS
/*declare @debug_what_to_run tinyint; set @debug_what_to_run=2; -- käytä arvoa 3 vain kun teet yhden vuoden
print '$'+convert(varchar,sysdatetime(),20)+'$ '+'DEBUG (what to run)='+cast(@debug_what_to_run as varchar)+
': 0=luo vain taulut, älä tulosta mitään; 1=luo taulut ja tulosta joitakin merkittävimpiä välivaiheita; 2=luo taulut ja tulosta välivaiheet; 3=luo taulut, tulosta välivaiheet ja tulosta myös tulokset, 4=tulosta välivaiheet, mutta älä tee mitään';




-- lisätään data
if @debug_what_to_run not in (4) begin
if @debug_what_to_run>0 print 'inserting data';

-- parametrimuuttujien arvot
-- parametrimuuttujat
DECLARE @ensimmainen_suoritusvuosi int;
DECLARE @toinen_suoritusvuosi int;
DECLARE @kolmas_suoritusvuosi int;
DECLARE @neljas_suoritusvuosi int;
DECLARE @viides_suoritusvuosi int;
DECLARE @kuudes_suoritusvuosi int;
DECLARE @seitsemas_suoritusvuosi int;


set @ensimmainen_suoritusvuosi = _5;
set @toinen_suoritusvuosi = 2005;
set @kolmas_suoritusvuosi = 2006;
set @neljas_suoritusvuosi = 2007;
set @viides_suoritusvuosi = 2008;
set @kuudes_suoritusvuosi = 2009;
set @seitsemas_suoritusvuosi = 2010;

*/

INSERT INTO [VipunenTK_DW].[dbo].[_koulutukseen_sijoittuneet_6v_tarkastelu]
(
rivinumero
, tarkastelujakso
, tilv 
, tilv_date
, tutkryh 
, suorv
, suorlk 
, sp 
, syntv
, aikielir1 
, tutkkaskun 
, kansalr1
, pohjmaa 
, eumaa 
, etamaa 
, tunn
, jarj
, kkielir1 
, tutklaja 
, tutktav 
, aikoul 
, tutkmaak
, koulutus_1
, oppilaitos_1
, koulutuksen_jarjestaja_1
, koulutuksen_maakunta_1
, koulutus_2
, oppilaitos_2
, koulutuksen_jarjestaja_2
, koulutuksen_maakunta_2
, monihaku
, paaasiallinen_toiminta
, ammattiasema
, lkm
, pohjkoulk
, tietolahde
, aineisto
, lukiokoulutuksessa
, ammatillisessa_koulutuksessa
, ammattikorkeakoulutuksessa
, yliopistokoulutuksessa
, lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa
, toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa
, ammattikorkeakoulutuksessa_ja_yliopistokoulutuksessa
, koulutuksen_paattaneiden_toiminta
, ika_1v
, ika_5v
, ika_1v_suorv
, opisk_lu
, opisk_amm_pk
, opisk_amm_at
, opisk_amm_eat
, opisk_amm
, opisk_amk
, opisk_yo
, opisk_amk_koulala1
, opisk_amk_koulala2
, opisk_amk_koulala3
, opisk_amk_koulala4
, opisk_amk_koulala5
, opisk_amk_koulala6
, opisk_amk_koulala7
, opisk_amk_koulala8
, opisk_amk_koulala9
, opisk_amk_koulala10
, opisk_yo_koulala1
, opisk_yo_koulala2
, opisk_yo_koulala3
, opisk_yo_koulala4
, opisk_yo_koulala5
, opisk_yo_koulala6
, opisk_yo_koulala7
, opisk_yo_koulala8
, opisk_yo_koulala9
, opisk_yo_koulala10
, opisk_vah2_koulala
, haku_amm
, haku_amk
, haku_yo
, eihaku_kk_eiopisk
, eihaku_kk_eiopisk_kk_opisk_ta
, eihaku_kk_eiopisk_kk_opisk_lu
, eihaku_kk_eiopisk_kk_opisk_pk
, eihaku_kk_eiopisk_kk_opisk_at
, eihaku_kk_eiopisk_kk_opisk_eat
, haku_kk_eiopisk_kk
, haku_kk_eiopisk_kk_eiopisk_ta
, haku_kk_eiopisk_kk_opisk_ta
, haku_amk_eiopisk_kk
, haku_yo_eiopisk_kk
, haku_amkyo_eiopisk_kk
, opisk_kk
, opisk_kk_eiopisk_ta
, opisk_kk_opisk_ta
, opisk_vain_amk
, opisk_vain_yo
, opisk_amkyo
)
SELECT
 l.rivinumero,
 '4,5',
 l.tilv,
 l.tilv_date,
 (case 
	when l.tutkryh=3 and tutklaja=1 then 31
	when l.tutkryh=3 and tutklaja=2 then 32
	when l.tutkryh=3 and tutklaja=3 then 33
	else l.tutkryh
  end),
 l.suorv,
  (case
	when l.suorlk = '1'  then (l.suorv+'0'+l.suorlk)
	when l.suorlk = '2'  then (l.suorv+'0'+'8')
	else ''
	end),
 l.sp,
 l.syntv,
 l.aikielir1,
 l.tutkaskun,
 l.kansalr1,
 l.pohjmaa,
 l.eumaa,
 l.etamaa,
 l.tunn,
 l.jarj,
 l.kkielir1,
 l.tutklaja,
 l.tutktav,
 l.aikoul,
 l.tutkmaak,
 -- Koulutus 1
 (case
    --lukiokoulutuksessa _6
	when l.suorlk = '2' and l.luopiskkoulk_6 <> '' and l.ammopiskkoulk_6 = '' and
	l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' then l.luopiskkoulk_6 
	-- ammattikoulutuksessa _6
	when l.suorlk = '2' and l.luopiskkoulk_6 = '' and l.ammopiskkoulk_6 <> '' and
	l.amkopiskkoulk_6 ='' and l.yoopiskkoulk_6 = ''  then l.ammopiskkoulk_6 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen _6 ensim. koulutustietoihin
	when l.suorlk = '2' and l.luopiskkoulk_6 <> '' and l.ammopiskkoulk_6 <> '' and
	l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' then l.luopiskkoulk_6
	-- ammattikorkeakoulutuksessa _6
	when l.suorlk = '2' and l.amkopiskkoulk_6  <> '' and l.yoopiskkoulk_6  = '' and
	l.luopiskkoulk_6 = '' and l.ammopiskkoulk_6 = '' then l.amkopiskkoulk_6
	-- yliopistokoulutuksessa _6
	when l.suorlk = '2' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 <> '' and 
	l.luopiskkoulk_6 = '' and l.ammopiskkoulk_6 = ''   then l.yoopiskkoulk_6
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa, merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorlk = '2' and l.amkopiskkoulk_6 <> '' and l.yoopiskkoulk_6  <> '' and
	l.luopiskkoulk_6 = '' and ammopiskkoulk_6 = ''  then l.amkopiskkoulk_6 
	
	else ''

	
	    
	    end),
	    
-- Oppilaitos 1
	(case
	-- lukiokoulutuksen oppilaitos _6
	when l.suorlk = '2' and l.luopisktunn_6 <> '' and l.ammopisktunn_6 = '' and
	l.amkopisktunn_6 = '' and l.yoopisktunn_6 = '' then l.luopisktunn_6 
	-- ammattikoulutuksen oppilaitos _6
	when l.suorlk = '2' and l.luopisktunn_6 = '' and l.ammopisktunn_6 <> '' and
	l.amkopisktunn_6 ='' and l.yoopisktunn_6 = ''  then l.ammopisktunn_6 
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos _6
	when l.suorlk = '2' and l.luopisktunn_6 <> '' and l.ammopisktunn_6 <> '' and
	l.amkopisktunn_6 = '' and l.yoopisktunn_6 = '' then l.luopisktunn_6
	-- ammattikorkeakoulutuksen oppilaitos _6
	when l.suorlk = '2' and l.amkopisktunn_6  <> '' and l.yoopisktunn_6  = '' and
	l.luopisktunn_6 = '' and l.ammopisktunn_6 = '' then l.amkopisktunn_6
	-- yliopistokoulutuksen oppilaitos _6
	when l.suorlk = '2' and l.amkopisktunn_6 = '' and l.yoopisktunn_6 <> '' and 
	l.luopisktunn_6 = '' and l.ammopisktunn_6 = ''   then l.yoopisktunn_6
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus _6  
	when l.suorlk = '2' and l.amkopisktunn_6 <> '' and l.yoopisktunn_6  <> '' and
	l.luopisktunn_6 = '' and l.ammopisktunn_6 = ''  then l.amkopisktunn_6 
	
	
	

	
	else ''
	
	    end),
  --Koulutuksen järjestäjä 1
	(case
	-- lukikoulutuksen järjestäjä _6
	when l.suorlk = '2' and l.luopiskjarj_6  <> '' and l.ammopiskjarj_6 = '' and
	l.amkopiskjarj_6 = '' and yoopiskjarj_6 = '' then l.luopiskjarj_6
	-- ammatillisen koulutuksen järjestäjä _6  
	when l.suorlk = '2' and l.luopiskjarj_6 = '' and l.ammopiskjarj_6 <> '' and
	l.amkopiskjarj_6 ='' and l.yoopiskjarj_6 = ''  then l.ammopiskjarj_6
	-- lukio- ja ammatillisen koulutuksen järjestäjä, merkitään lukiokoulutuksen _6 järjestäjä 
	when l.suorlk = '2' and l.luopiskjarj_6 <> '' and l.ammopiskjarj_6 <> '' and
	l.amkopiskjarj_6 = '' and l.yoopiskjarj_6 = '' then l.luopiskjarj_6
	-- ammattikorkeakoulutuksen järjestäjä _6
	when l.suorlk = '2' and l.amkopiskjarj_6  <> '' and l.yoopiskjarj_6   = '' and
	l.luopiskjarj_6 = '' and l.ammopiskjarj_6 = '' then l.amkopiskjarj_6
	-- yliopistokoulutuksen järjestäjä _6 
	when l.suorlk = '2' and l.amkopiskjarj_6  = '' and l.yoopiskjarj_6  <> '' and 
	l.luopiskjarj_6  = '' and l.ammopiskjarj_6 = ''   then l.yoopiskjarj_6
	-- ammattikorkea- ja yliopistokoulutuksen järjestäjä, merkitään ammattikorkeakoulutuksen _6 järjestäjä   
	when l.suorlk = '2' and l.amkopiskjarj_6  <> '' and l.yoopiskjarj_6   <> '' and
	l.luopiskjarj_6  = '' and l.ammopiskjarj_6  = ''  then l.amkopiskjarj_6 

	
	else ''
	    end),
 --Koulutuksen maakunta 1
	(case
	-- lukioopiskelun maakunta _6
	when l.suorlk = '2' and l.luopiskmaak_6   <> '' and l.ammopiskmaak_6  = '' and
	l.amkopiskmaak_6  = '' and l.yoopiskmaak_6  = '' then l.luopiskmaak_6   
	-- ammatillisen koulutuksen maakunta _6
	when l.suorlk = '2' and l.luopiskmaak_6  = '' and l.ammopiskmaak_6  <> '' and
	l.amkopiskmaak_6  ='' and l.yoopiskmaak_6  = ''  then l.ammopiskmaak_6  
	-- lukiokoulutuksen ja ammatillisen koulutus otetaan lukiokoulutuksen maakunta _6
	when l.suorlk = '2' and l.luopiskmaak_6  <> '' and l.ammopiskmaak_6  <> '' and
	l.amkopiskmaak_6  = '' and l.yoopiskmaak_6  = '' then l.luopiskmaak_6 
    -- ammattikorkeakoulutuksen maakunta _6
	when l.suorlk = '2' and l.amkopiskmaak_6   <> '' and l.yoopiskmaak_6   = '' and
	l.luopiskjarj_6 = '' and l.ammopiskmaak_6 = '' then l.amkopiskmaak_6
	-- yliopistokoulutuksen maakunta _6 
	when l.suorlk = '2' and l.amkopiskmaak_6  = '' and l.yoopiskmaak_6  <> '' and 
	l.luopiskjarj_6  = '' and l.ammopiskmaak_6 = ''   then l.yoopiskmaak_6
	-- ammattikorkekoulutuksen ja yliopistokoulutksen maakunta otetaan ammattikorkeakoulutuksen maakunta _6   
	when l.suorlk = '2' and l.amkopiskmaak_6  <> '' and l.yoopiskmaak_6   <> '' and
	l.luopiskjarj_6  = '' and l.ammopiskmaak_6  = ''  then l.amkopiskmaak_6 
	
	else ''
	
	    end),
-- Koulutus 2
(case
   -- jos lukiokoulutuksessa vain niin jätetään tyhjäksi _6
	when l.suorlk = '2' and l.luopiskkoulk_6 <> '' and l.ammopiskkoulk_6 = '' and
	l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' then ''
	-- jos ammattikoulutuksessa vain  jätetään tyhjäksi _6 
	when l.suorlk = '2' and l.luopiskkoulk_6 = '' and l.ammopiskkoulk_6 <> '' and
	l.amkopiskkoulk_6 ='' and l.yoopiskkoulk_6 = ''  then ''
	-- jos lukiokoulutksessa ja ammattikoulutuksessa merkitään ammattikoulutus _6 
	when l.suorlk = '2' and l.luopiskkoulk_6 <> '' and l.ammopiskkoulk_6 <> '' and
	l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' then l.ammopiskkoulk_6 
	-- jos vain ammattikorkeakoulutuksessa jätetään tyhjäksi
	when l.suorlk = '2' and l.amkopiskkoulk_6  <> '' and l.yoopiskkoulk_6  = '' and
	l.luopiskkoulk_6 = '' and l.ammopiskkoulk_6 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorlk = '2' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 <> '' and 
	l.luopiskkoulk_6 = '' and l.ammopiskkoulk_6 = ''   then ''
	-- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus _6
	when l.suorlk = '2' and l.amkopiskkoulk_6 <> '' and l.yoopiskkoulk_6  <> '' and
	l.luopiskkoulk_6 = '' and l.ammopiskkoulk_6 = ''  then l.yoopiskkoulk_6
	
	
	
	else ''
	    end),
-- Oppilaitos 2
(case
    -- lukiokoulutuksen oppilaitos vain merkitään tyhjäksi
	when l.suorlk = '2' and l.luopisktunn_6 <> '' and l.ammopisktunn_6 = '' and
	l.amkopisktunn_6 = '' and l.yoopisktunn_6 = '' then ''
	-- ammatillisen koulutuksen oppilaitos _6 merkitään tyhjäksi
	when l.suorlk = '2' and l.luopisktunn_6 = '' and l.ammopisktunn_6 <> '' and
	l.amkopisktunn_6 ='' and l.yoopisktunn_6 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos merkitään ammatillisen koulutuksen oppilaitos _6
	when l.suorlk = '2' and l.luopisktunn_6 <> '' and l.ammopisktunn_6 <> '' and
	l.amkopisktunn_6 = '' and l.yoopisktunn_6 = '' then l.ammopisktunn_6 
	-- ammattikorkeakoulutksen oppilaitos vain merkitään tyhjäksi _6
	when l.suorlk = '2' and l.amkopisktunn_6  <> '' and l.yoopisktunn_6  = '' and
	l.luopisktunn_6 = '' and l.ammopisktunn_6 = '' then ''
	-- yliopistokoulutksen oppilaitos vain merkitään tyhjäksi _6
	when l.suorlk = '2' and l.amkopisktunn_6 = '' and l.yoopisktunn_6 <> '' and 
	l.luopisktunn_6 = '' and l.ammopisktunn_6 = ''   then ''  
	--  ammattikorkeakoulutksen oppilaitos ja yliopistokoulutuksen oppilaitos, merkitään yliopistokoulutuksen oppilaitos _6
	when l.suorlk = '2' and l.amkopisktunn_6 <> '' and l.yoopisktunn_6  <> '' and
	l.luopisktunn_6 = '' and l.ammopisktunn_6 = ''  then l.yoopisktunn_6 
	
	
	else ''
	    end),
-- Koulutuksen järjestäjä 2
	(case
	-- lukiokoulutuksen järjestäjä vain _6, merkitään tyhjäksi
	when l.suorlk = '2' and l.luopiskjarj_6  <> '' and l.ammopiskjarj_6 = '' and
	l.amkopiskjarj_6 = '' and l.yoopiskjarj_6 = '' then ''
	-- ammatillisen koulutuksen järjestäjä vain _6, merkitään tyhjäksi
	when l.suorlk = '2' and l.luopiskjarj_6 = '' and l.ammopiskjarj_6 <> '' and
	l.amkopiskjarj_6 ='' and l.yoopiskjarj_6 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä _6
	when l.suorlk = '2' and l.luopiskjarj_6 <> '' and l.ammopiskjarj_6 <> '' and
	l.amkopiskjarj_6 = '' and l.yoopiskjarj_6 = '' then l.ammopiskjarj_6 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi
	when l.suorlk = '2' and l.amkopiskjarj_6  <> '' and l.yoopiskjarj_6   = '' and
	l.luopiskjarj_6 = '' and l.ammopiskjarj_6 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, merkitään tyhjäksi
	when l.suorlk = '2' and l.amkopiskjarj_6  = '' and l.yoopiskjarj_6  <> '' and 
	l.luopiskjarj_6  = '' and l.ammopiskjarj_6 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestäjä merkitään yliopistokoulutuksen järjetäjä _6
	when l.suorlk = '2' and l.amkopiskjarj_6  <> '' and l.yoopiskjarj_6   <> '' and
	l.luopiskjarj_6  = '' and l.ammopiskjarj_6  = ''  then l.yoopiskjarj_6 
	

	else ''
	    end),
-- Koulutuksen maakunta 2
	(case
	-- vain lukiokoulutuksen maakunta _6, jätetään tyhjäksi
	when l.suorlk = '2' and l.luopiskmaak_6   <> '' and l.ammopiskmaak_6  = '' and
	l.amkopiskmaak_6  = '' and l.yoopiskmaak_6  = '' then ''
	-- vain ammatillisen koulutuksen maakunta _6, jätetään tyhjäksi   
	when l.suorlk = '2' and l.luopiskmaak_6  = '' and l.ammopiskmaak_6  <> '' and
	l.amkopiskmaak_6  ='' and l.yoopiskmaak_6  = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta, merkitään ammatillisen koulutuksen maakunta _6
	when l.suorlk = '2' and l.luopiskmaak_6  <> '' and l.ammopiskmaak_6  <> '' and
	l.amkopiskmaak_6  = '' and l.yoopiskmaak_6  = '' then l.ammopiskmaak_6 
	-- vain ammattikorkeakoulutuksen maakunta _6, jätetään tyhjäksi
	when l.suorlk = '2' and l.amkopiskmaak_6   <> '' and l.yoopiskmaak_6   = '' and
	l.luopiskmaak_6 = '' and l.ammopiskmaak_6 = '' then '' 
	-- vain yliopistokoulutuksen maakunta _6, merkitään tyhjäksi
	when l.suorlk = '2' and l.amkopiskmaak_6  = '' and l.yoopiskmaak_6  <> '' and 
	l.luopiskmaak_6  = '' and l.ammopiskmaak_6 = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta _6, merkitään yliopistokoulutuksen maakunta _6
	when l.suorlk = '2' and l.amkopiskmaak_6  <> '' and l.yoopiskmaak_6   <> '' and
	l.luopiskjarj_6  = '' and l.ammopiskmaak_6  = ''  then l.yoopiskmaak_6
	

	else ''
	
	    end),
	-- Monihaku
	(case
	-- _6
	when l.suorlk = '2' then l.monihaku_6		
	else '8'
	end),
    -- Pääasiallinen toiminta
    (case
    -- _6
	when l.suorlk = '2' then l.ptoim1r4_6
	else ''
	end),
	-- Ammattiasema
	(case
	-- _6
	when l.suorlk = '2' then l.amas_6
	else ''
	end),
    l.lkm,
	l.pohjkoul,
 l.tietolahde,
 'K3.13',
 -- Lukiokoulutuksessa
 (case
	    when (l.suorlk = '2' ) and  l.luopiskkoulk_6 <> '' and l.ammopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk_6 = '' then '1'    
	    else '0'
	    end) as lukiokoulutuksessa,
 -- Ammatillisessa koulutuksessa 
 (case
	    when (l.suorlk = '2') and  l.ammopiskkoulk_6  <> '' and l.luopiskkoulk_6 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' then '1' 
	    else '0'
	    end) as ammatillisessa_koulutuksessa,
-- Ammattikorkeakoulutuksessa
 (case
	   when (l.suorlk = '2') and  l.amkopiskkoulk_6 <> '' and l.ammopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.luopiskkoulk_6 = '' then  '1'
	   else '0' 
	   end) as ammattikorkeakoulutuksessa,
-- Yliopistokoulutuksessa
 (case
	    when (l.suorlk = '2') and  l.yoopiskkoulk_6  <> '' and l.amkopiskkoulk_6 = '' and l.luopiskkoulk_6 = '' and l.ammopiskkoulk_6 = '' then '1'   	   
	    else '0'
	    end) as yliopistokoulutuksessa,
-- Lukiokoulutuksessa ja ammatillisessa koulutuksessa
(case
	    when (l.suorlk = '2') and  l.luopiskkoulk_6  <> '' and l.ammopiskkoulk_6 <> '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6  = '' then '1'  
	    else '0'
	    end) as lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa,
-- Toisen asteen ammatillisessa koulutuksessa ja korkeakoulutuksessa
(case
	    when (l.suorlk = '2') and  l.ammopiskkoulk_6  <> '' and l.amkopiskkoulk_6 <> '' and l.luopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' then '1'  
	    else '0'
	    end) as toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa,
-- Ammattikorkeakoulutuksessa ja yliopistokoulutuksessa
(case
	    when (l.suorlk = '2') and  l.amkopiskkoulk_6  <> '' and l.yoopiskkoulk_6 <> '' and l.ammopiskkoulk_6  = '' and l.luopiskkoulk_6 = ''  then '1' 
	    else '0'
	    end) as ammattikorkekoulutuksessa_ja_yliopistokoulutuksessa,    
-- Koulutuksen päättäneiden toiminta
(case
	   -- Tutkintoon johtavassa koulutuksessa olevat
	   when (l.suorlk = '2')  and (l.ptoim1r4_6 = '22' or l.ptoim1r4_6 = '13')
       and	(l.luopiskkoulk_6 <>'' or l.ammopiskkoulk_6 <>'' or l.amkopiskkoulk_6 <>'' or l.yoopiskkoulk_6 <>'')   then '1' 
	
	   -- Ei tutkintoon johtavassa koulutuksessa olevat
	   when (l.suorlk = '2')  and (l.ptoim1r4_6 = '22' or l.ptoim1r4_6 = '13')
       and	(l.luopiskkoulk_6 ='' and l.ammopiskkoulk_6 ='' and l.amkopiskkoulk_6 ='' and l.yoopiskkoulk_6 ='')   then '2' 
   
   
	   -- Ei opiskelevat työlliset
	   when (l.suorlk = '2')and  l.ptoim1r4_6  = '10'  then '3' 
	   -- Ei opiskelevat työttömät
	   when (l.suorlk = '2') and  l.ptoim1r4_6  = '12'  then '4' 
	   -- Ei opiskelevat muut
		else '5' 
	   end ) as koulutuksen_paattaneiden_toiminta
 ,ika_1v = cast((case 
            when syntv = '' then '-1'
            when  (cast(tilv as int) - cast(syntv as int)) > 99 then ''
            else  ((cast(tilv as int) - cast(syntv as int))) end)  as nvarchar(10))
 ,ika_5v =cast(
       (
		case
		when (cast(tilv as int) - cast(syntv as int)) < 15 then '5v10'
		when ((cast(tilv as int) - cast(syntv as int)) >= 15 and (cast(tilv as int) - cast(syntv as int)) <= 19) then '5v15'
		when ((cast(tilv as int) - cast(syntv as int)) >= 20 and (cast(tilv as int) - cast(syntv as int)) <= 24) then '5v20'
		when ((cast(tilv as int) - cast(syntv as int)) >= 25 and (cast(tilv as int) - cast(syntv as int)) <= 29) then '5v25'
		when ((cast(tilv as int) - cast(syntv as int)) >= 30 and (cast(tilv as int) - cast(syntv as int)) <= 34) then '5v30'
		when ((cast(tilv as int) - cast(syntv as int)) >= 35 and (cast(tilv as int) - cast(syntv as int)) <= 39) then '5v35'
		when ((cast(tilv as int) - cast(syntv as int)) >= 40 and (cast(tilv as int) - cast(syntv as int)) <= 44) then '5v40'
		when ((cast(tilv as int) - cast(syntv as int)) >= 45 and (cast(tilv as int) - cast(syntv as int)) <= 49) then '5v45'
		when ((cast(tilv as int) - cast(syntv as int)) >= 50 and (cast(tilv as int) - cast(syntv as int)) <= 54) then '5v50'
		when ((cast(tilv as int) - cast(syntv as int)) >= 55 and (cast(tilv as int) - cast(syntv as int)) <= 59) then '5v55'
		when ((cast(tilv as int) - cast(syntv as int)) >= 60 and (cast(tilv as int) - cast(syntv as int)) <= 64) then '5v60'
		when ((cast(tilv as int) - cast(syntv as int)) >= 65 and (cast(tilv as int) - cast(syntv as int)) <= 69) then '5v65'
		when ((cast(tilv as int) - cast(syntv as int)) >= 70 and (cast(tilv as int) - cast(syntv as int)) <= 74) then '5v70'
		when ((cast(tilv as int) - cast(syntv as int)) >= 75 and (cast(tilv as int) - cast(syntv as int)) <= 79) then '5v75'
		when ((cast(tilv as int) - cast(syntv as int)) >= 80 and (cast(tilv as int) - cast(syntv as int)) <= 84) then '5v80'
		when ((cast(tilv as int) - cast(syntv as int)) >= 85 and (cast(tilv as int) - cast(syntv as int)) <= 89) then '5v85'
		when ((cast(tilv as int) - cast(syntv as int)) >= 90 and (cast(tilv as int) - cast(syntv as int)) <= 94) then '5v90'
		when ((cast(tilv as int) - cast(syntv as int)) >= 95) then '5v95'
		
		end
	   ) as nvarchar (10))

  ,ika_1v_suorv = cast(
					(case 
						when syntv = '' then '-1' 
						else ((cast(suorv as int) - cast(syntv as int))) 
					end)  
	as nvarchar(10))




--uudet muuttujat 03/2018

----OPISKELUT KYLLÄ/EI
--Opiskellut lukiokoulutuksessa
,case
	when  l.suorlk = '2' and (l.luopiskkoulk_1 <> '' or l.luopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.luopiskkoulk_6 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.luopiskkoulk_6 <> '' or l.luopiskkoulk2010 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.luopiskkoulk_6 <> '' or l.luopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.luopiskkoulk_6 <> '' or l.luopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk_5 <> '' or l.luopiskkoulk_6 <> '' or l.luopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk_6 <> '' or l.luopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '' or l.luopiskkoulk2014 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '' or l.luopiskkoulk2014 <> '' or l.luopiskkoulk2015 <> '') then 1*/
	else 0
end as opisk_lu
--Opiskellut ammatillisessa peruskoulutuksessa
,case
	when  l.suorlk = '2' and (l.ammopiskkoulk_1 <> '' or l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk_6 <> '') and (d1c.Koulutusaste_taso2_koodi = '32' or d2c.Koulutusaste_taso2_koodi = '32' or d3c.Koulutusaste_taso2_koodi = '32' or d4c.Koulutusaste_taso2_koodi = '32' or d5c.Koulutusaste_taso2_koodi = '32' or d6c.Koulutusaste_taso2_koodi = '32') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk_6 <> '' or l.ammopiskkoulk2010 <> '') and (d2c.Koulutusaste_taso2_koodi = '32' or d3c.Koulutusaste_taso2_koodi = '32' or d4c.Koulutusaste_taso2_koodi = '32' or d5c.Koulutusaste_taso2_koodi = '32' or d6c.Koulutusaste_taso2_koodi = '32' or d7c.Koulutusaste_taso2_koodi = '32') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk_6 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '') and (d3c.Koulutusaste_taso2_koodi = '32' or d4c.Koulutusaste_taso2_koodi = '32' or d5c.Koulutusaste_taso2_koodi = '32' or d6c.Koulutusaste_taso2_koodi = '32' or d7c.Koulutusaste_taso2_koodi = '32' or d8c.Koulutusaste_taso2_koodi = '32') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk_6 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '') and (d4c.Koulutusaste_taso2_koodi = '32' or d5c.Koulutusaste_taso2_koodi = '32' or d6c.Koulutusaste_taso2_koodi = '32' or d7c.Koulutusaste_taso2_koodi = '32' or d8c.Koulutusaste_taso2_koodi = '32' or d9c.Koulutusaste_taso2_koodi = '32') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk_6 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '' or l.ammopiskkoulk2013 <> '') and (d5c.Koulutusaste_taso2_koodi = '32' or d6c.Koulutusaste_taso2_koodi = '32' or d7c.Koulutusaste_taso2_koodi = '32' or d8c.Koulutusaste_taso2_koodi = '32' or d9c.Koulutusaste_taso2_koodi = '32' or d10c.Koulutusaste_taso2_koodi = '32') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk_6 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '' or l.ammopiskkoulk2013 <> '' or l.ammopiskkoulk2014 <> '') and (d6c.Koulutusaste_taso2_koodi = '32' or d7c.Koulutusaste_taso2_koodi = '32' or d8c.Koulutusaste_taso2_koodi = '32' or d9c.Koulutusaste_taso2_koodi = '32' or d10c.Koulutusaste_taso2_koodi = '32' or d11c.Koulutusaste_taso2_koodi = '32') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '' or l.ammopiskkoulk2013 <> '' or l.ammopiskkoulk2014 <> '' or l.ammopiskkoulk2015 <> '') and (d7c.Koulutusaste_taso2_koodi = '32' or d8c.Koulutusaste_taso2_koodi = '32' or d9c.Koulutusaste_taso2_koodi = '32' or d10c.Koulutusaste_taso2_koodi = '32' or d11c.Koulutusaste_taso2_koodi = '32' or d12c.Koulutusaste_taso2_koodi = '32') then 1*/
	else 0
end as opisk_amm_pk
--Opiskellut ammattitutkintokoulutuksessa
,case
	when  l.suorlk = '2' and (l.ammopiskkoulk_1 <> '' or l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk_6 <> '') and (d1c.Koulutusaste_taso2_koodi = '33' or d2c.Koulutusaste_taso2_koodi = '33' or d3c.Koulutusaste_taso2_koodi = '33' or d4c.Koulutusaste_taso2_koodi = '33' or d5c.Koulutusaste_taso2_koodi = '33' or d6c.Koulutusaste_taso2_koodi = '33') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk_6 <> '' or l.ammopiskkoulk2010 <> '') and (d2c.Koulutusaste_taso2_koodi = '33' or d3c.Koulutusaste_taso2_koodi = '33' or d4c.Koulutusaste_taso2_koodi = '33' or d5c.Koulutusaste_taso2_koodi = '33' or d6c.Koulutusaste_taso2_koodi = '33' or d7c.Koulutusaste_taso2_koodi = '33') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk_6 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '') and (d3c.Koulutusaste_taso2_koodi = '33' or d4c.Koulutusaste_taso2_koodi = '33' or d5c.Koulutusaste_taso2_koodi = '33' or d6c.Koulutusaste_taso2_koodi = '33' or d7c.Koulutusaste_taso2_koodi = '33' or d8c.Koulutusaste_taso2_koodi = '33') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk_6 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '') and (d4c.Koulutusaste_taso2_koodi = '33' or d5c.Koulutusaste_taso2_koodi = '33' or d6c.Koulutusaste_taso2_koodi = '33' or d7c.Koulutusaste_taso2_koodi = '33' or d8c.Koulutusaste_taso2_koodi = '33' or d9c.Koulutusaste_taso2_koodi = '33') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk_6 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '' or l.ammopiskkoulk2013 <> '') and (d5c.Koulutusaste_taso2_koodi = '33' or d6c.Koulutusaste_taso2_koodi = '33' or d7c.Koulutusaste_taso2_koodi = '33' or d8c.Koulutusaste_taso2_koodi = '33' or d9c.Koulutusaste_taso2_koodi = '33' or d10c.Koulutusaste_taso2_koodi = '33') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk_6 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '' or l.ammopiskkoulk2013 <> '' or l.ammopiskkoulk2014 <> '') and (d6c.Koulutusaste_taso2_koodi = '33' or d7c.Koulutusaste_taso2_koodi = '33' or d8c.Koulutusaste_taso2_koodi = '33' or d9c.Koulutusaste_taso2_koodi = '33' or d10c.Koulutusaste_taso2_koodi = '33' or d11c.Koulutusaste_taso2_koodi = '33') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '' or l.ammopiskkoulk2013 <> '' or l.ammopiskkoulk2014 <> '' or l.ammopiskkoulk2015 <> '') and (d7c.Koulutusaste_taso2_koodi = '33' or d8c.Koulutusaste_taso2_koodi = '33' or d9c.Koulutusaste_taso2_koodi = '33' or d10c.Koulutusaste_taso2_koodi = '33' or d11c.Koulutusaste_taso2_koodi = '33' or d12c.Koulutusaste_taso2_koodi = '33') then 1*/
	else 0
end as opisk_amm_at
--Opiskellut erikoisammattitutkintokoulutuksessa
,case
	when  l.suorlk = '2' and (l.ammopiskkoulk_1 <> '' or l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk_6 <> '') and (d1c.Koulutusaste_taso2_koodi = '41' or d2c.Koulutusaste_taso2_koodi = '41' or d3c.Koulutusaste_taso2_koodi = '41' or d4c.Koulutusaste_taso2_koodi = '41' or d5c.Koulutusaste_taso2_koodi = '41' or d6c.Koulutusaste_taso2_koodi = '41') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk_6 <> '' or l.ammopiskkoulk2010 <> '') and (d2c.Koulutusaste_taso2_koodi = '41' or d3c.Koulutusaste_taso2_koodi = '41' or d4c.Koulutusaste_taso2_koodi = '41' or d5c.Koulutusaste_taso2_koodi = '41' or d6c.Koulutusaste_taso2_koodi = '41' or d7c.Koulutusaste_taso2_koodi = '41') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk_6 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '') and (d3c.Koulutusaste_taso2_koodi = '41' or d4c.Koulutusaste_taso2_koodi = '41' or d5c.Koulutusaste_taso2_koodi = '41' or d6c.Koulutusaste_taso2_koodi = '41' or d7c.Koulutusaste_taso2_koodi = '41' or d8c.Koulutusaste_taso2_koodi = '41') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk_6 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '') and (d4c.Koulutusaste_taso2_koodi = '41' or d5c.Koulutusaste_taso2_koodi = '41' or d6c.Koulutusaste_taso2_koodi = '41' or d7c.Koulutusaste_taso2_koodi = '41' or d8c.Koulutusaste_taso2_koodi = '41' or d9c.Koulutusaste_taso2_koodi = '41') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk_6 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '' or l.ammopiskkoulk2013 <> '') and (d5c.Koulutusaste_taso2_koodi = '41' or d6c.Koulutusaste_taso2_koodi = '41' or d7c.Koulutusaste_taso2_koodi = '41' or d8c.Koulutusaste_taso2_koodi = '41' or d9c.Koulutusaste_taso2_koodi = '41' or d10c.Koulutusaste_taso2_koodi = '41') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk_6 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '' or l.ammopiskkoulk2013 <> '' or l.ammopiskkoulk2014 <> '') and (d6c.Koulutusaste_taso2_koodi = '41' or d7c.Koulutusaste_taso2_koodi = '41' or d8c.Koulutusaste_taso2_koodi = '41' or d9c.Koulutusaste_taso2_koodi = '41' or d10c.Koulutusaste_taso2_koodi = '41' or d11c.Koulutusaste_taso2_koodi = '41') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '' or l.ammopiskkoulk2013 <> '' or l.ammopiskkoulk2014 <> '' or l.ammopiskkoulk2015 <> '') and (d7c.Koulutusaste_taso2_koodi = '41' or d8c.Koulutusaste_taso2_koodi = '41' or d9c.Koulutusaste_taso2_koodi = '41' or d10c.Koulutusaste_taso2_koodi = '41' or d11c.Koulutusaste_taso2_koodi = '41' or d12c.Koulutusaste_taso2_koodi = '41') then 1*/
	else 0
end as opisk_amm_eat
--Opiskellut ammatillisessa koulutuksessa
,case
	when  l.suorlk = '2' and (l.ammopiskkoulk_1 <> '' or l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk_6 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk_6 <> '' or l.ammopiskkoulk2010 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk_6 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk_6 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk_6 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '' or l.ammopiskkoulk2013 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk_6 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '' or l.ammopiskkoulk2013 <> '' or l.ammopiskkoulk2014 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '' or l.ammopiskkoulk2013 <> '' or l.ammopiskkoulk2014 <> '' or l.ammopiskkoulk2015 <> '') then 1*/
	else 0
end as opisk_amm
--Opiskellut ammattikorkeakoulutuksessa
,case
	when  l.suorlk = '2' and (l.amkopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.amkopiskkoulk_6 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.amkopiskkoulk_6 <> '' or l.amkopiskkoulk2010 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.amkopiskkoulk_6 <> '' or l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.amkopiskkoulk_6 <> '' or l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk_5 <> '' or l.amkopiskkoulk_6 <> '' or l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk_6 <> '' or l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '' or l.amkopiskkoulk2014 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '' or l.amkopiskkoulk2014 <> '' or l.amkopiskkoulk2015 <> '') then 1*/
	else 0
end as opisk_amk
--Opiskellut yliopistokoulutuksessa
,case
	when  l.suorlk = '2' and (l.yoopiskkoulk_1 <> '' or l.yoopiskkoulk_2 <> '' or l.yoopiskkoulk_3 <> '' or l.yoopiskkoulk_4 <> '' or l.yoopiskkoulk_5 <> '' or l.yoopiskkoulk_6 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.yoopiskkoulk_2 <> '' or l.yoopiskkoulk_3 <> '' or l.yoopiskkoulk_4 <> '' or l.yoopiskkoulk_5 <> '' or l.yoopiskkoulk_6 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.yoopiskkoulk_3 <> '' or l.yoopiskkoulk_4 <> '' or l.yoopiskkoulk_5 <> '' or l.yoopiskkoulk_6 <> '' or l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.yoopiskkoulk_4 <> '' or l.yoopiskkoulk_5 <> '' or l.yoopiskkoulk_6 <> '' or l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '' or l.yoopiskkoulk2012 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.yoopiskkoulk_5 <> '' or l.yoopiskkoulk_6 <> '' or l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '' or l.yoopiskkoulk2012 <> '' or l.yoopiskkoulk2013 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.yoopiskkoulk_6 <> '' or l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '' or l.yoopiskkoulk2012 <> '' or l.yoopiskkoulk2013 <> '' or l.yoopiskkoulk2014 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '' or l.yoopiskkoulk2012 <> '' or l.yoopiskkoulk2013 <> '' or l.yoopiskkoulk2014 <> '' or l.yoopiskkoulk2015 <> '') then 1*/
	else 0
end as opisk_yo



----KOULUTUSALA, TASO 1 KYLLÄ/EI
--Opiskellut koulutusala1 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1a.iscfibroad2013_koodi = '01' or d2a.iscfibroad2013_koodi = '01' or d3a.iscfibroad2013_koodi = '01' or d4a.iscfibroad2013_koodi = '01' or d5a.iscfibroad2013_koodi = '01' or d6a.iscfibroad2013_koodi = '01') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2a.iscfibroad2013_koodi = '01' or d3a.iscfibroad2013_koodi = '01' or d4a.iscfibroad2013_koodi = '01' or d5a.iscfibroad2013_koodi = '01' or d6a.iscfibroad2013_koodi = '01' or d7a.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3a.iscfibroad2013_koodi = '01' or d4a.iscfibroad2013_koodi = '01' or d5a.iscfibroad2013_koodi = '01' or d6a.iscfibroad2013_koodi = '01' or d7a.iscfibroad2013_koodi = '01' or d8a.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4a.iscfibroad2013_koodi = '01' or d5a.iscfibroad2013_koodi = '01' or d6a.iscfibroad2013_koodi = '01' or d7a.iscfibroad2013_koodi = '01' or d8a.iscfibroad2013_koodi = '01' or d9a.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5a.iscfibroad2013_koodi = '01' or d6a.iscfibroad2013_koodi = '01' or d7a.iscfibroad2013_koodi = '01' or d8a.iscfibroad2013_koodi = '01' or d9a.iscfibroad2013_koodi = '01' or d10a.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6a.iscfibroad2013_koodi = '01' or d7a.iscfibroad2013_koodi = '01' or d8a.iscfibroad2013_koodi = '01' or d9a.iscfibroad2013_koodi = '01' or d10a.iscfibroad2013_koodi = '01' or d11a.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7a.iscfibroad2013_koodi = '01' or d8a.iscfibroad2013_koodi = '01' or d9a.iscfibroad2013_koodi = '01' or d10a.iscfibroad2013_koodi = '01' or d11a.iscfibroad2013_koodi = '01' or d12a.iscfibroad2013_koodi = '01') then 1*/
	else 0
end as opisk_amk_koulala1
--Opiskellut koulutusala2 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1a.iscfibroad2013_koodi = '02' or d2a.iscfibroad2013_koodi = '02' or d3a.iscfibroad2013_koodi = '02' or d4a.iscfibroad2013_koodi = '02' or d5a.iscfibroad2013_koodi = '02' or d6a.iscfibroad2013_koodi = '02') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2a.iscfibroad2013_koodi = '02' or d3a.iscfibroad2013_koodi = '02' or d4a.iscfibroad2013_koodi = '02' or d5a.iscfibroad2013_koodi = '02' or d6a.iscfibroad2013_koodi = '02' or d7a.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3a.iscfibroad2013_koodi = '02' or d4a.iscfibroad2013_koodi = '02' or d5a.iscfibroad2013_koodi = '02' or d6a.iscfibroad2013_koodi = '02' or d7a.iscfibroad2013_koodi = '02' or d8a.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4a.iscfibroad2013_koodi = '02' or d5a.iscfibroad2013_koodi = '02' or d6a.iscfibroad2013_koodi = '02' or d7a.iscfibroad2013_koodi = '02' or d8a.iscfibroad2013_koodi = '02' or d9a.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5a.iscfibroad2013_koodi = '02' or d6a.iscfibroad2013_koodi = '02' or d7a.iscfibroad2013_koodi = '02' or d8a.iscfibroad2013_koodi = '02' or d9a.iscfibroad2013_koodi = '02' or d10a.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6a.iscfibroad2013_koodi = '02' or d7a.iscfibroad2013_koodi = '02' or d8a.iscfibroad2013_koodi = '02' or d9a.iscfibroad2013_koodi = '02' or d10a.iscfibroad2013_koodi = '02' or d11a.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7a.iscfibroad2013_koodi = '02' or d8a.iscfibroad2013_koodi = '02' or d9a.iscfibroad2013_koodi = '02' or d10a.iscfibroad2013_koodi = '02' or d11a.iscfibroad2013_koodi = '02' or d12a.iscfibroad2013_koodi = '02') then 1*/
	else 0
end as opisk_amk_koulala2
--Opiskellut koulutusala3 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1a.iscfibroad2013_koodi = '03' or d2a.iscfibroad2013_koodi = '03' or d3a.iscfibroad2013_koodi = '03' or d4a.iscfibroad2013_koodi = '03' or d5a.iscfibroad2013_koodi = '03' or d6a.iscfibroad2013_koodi = '03') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2a.iscfibroad2013_koodi = '03' or d3a.iscfibroad2013_koodi = '03' or d4a.iscfibroad2013_koodi = '03' or d5a.iscfibroad2013_koodi = '03' or d6a.iscfibroad2013_koodi = '03' or d7a.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3a.iscfibroad2013_koodi = '03' or d4a.iscfibroad2013_koodi = '03' or d5a.iscfibroad2013_koodi = '03' or d6a.iscfibroad2013_koodi = '03' or d7a.iscfibroad2013_koodi = '03' or d8a.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4a.iscfibroad2013_koodi = '03' or d5a.iscfibroad2013_koodi = '03' or d6a.iscfibroad2013_koodi = '03' or d7a.iscfibroad2013_koodi = '03' or d8a.iscfibroad2013_koodi = '03' or d9a.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5a.iscfibroad2013_koodi = '03' or d6a.iscfibroad2013_koodi = '03' or d7a.iscfibroad2013_koodi = '03' or d8a.iscfibroad2013_koodi = '03' or d9a.iscfibroad2013_koodi = '03' or d10a.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6a.iscfibroad2013_koodi = '03' or d7a.iscfibroad2013_koodi = '03' or d8a.iscfibroad2013_koodi = '03' or d9a.iscfibroad2013_koodi = '03' or d10a.iscfibroad2013_koodi = '03' or d11a.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7a.iscfibroad2013_koodi = '03' or d8a.iscfibroad2013_koodi = '03' or d9a.iscfibroad2013_koodi = '03' or d10a.iscfibroad2013_koodi = '03' or d11a.iscfibroad2013_koodi = '03' or d12a.iscfibroad2013_koodi = '03') then 1*/
	else 0
end as opisk_amk_koulala3
--Opiskellut koulutusala4 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1a.iscfibroad2013_koodi = '04' or d2a.iscfibroad2013_koodi = '04' or d3a.iscfibroad2013_koodi = '04' or d4a.iscfibroad2013_koodi = '04' or d5a.iscfibroad2013_koodi = '04' or d6a.iscfibroad2013_koodi = '04') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2a.iscfibroad2013_koodi = '04' or d3a.iscfibroad2013_koodi = '04' or d4a.iscfibroad2013_koodi = '04' or d5a.iscfibroad2013_koodi = '04' or d6a.iscfibroad2013_koodi = '04' or d7a.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3a.iscfibroad2013_koodi = '04' or d4a.iscfibroad2013_koodi = '04' or d5a.iscfibroad2013_koodi = '04' or d6a.iscfibroad2013_koodi = '04' or d7a.iscfibroad2013_koodi = '04' or d8a.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4a.iscfibroad2013_koodi = '04' or d5a.iscfibroad2013_koodi = '04' or d6a.iscfibroad2013_koodi = '04' or d7a.iscfibroad2013_koodi = '04' or d8a.iscfibroad2013_koodi = '04' or d9a.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5a.iscfibroad2013_koodi = '04' or d6a.iscfibroad2013_koodi = '04' or d7a.iscfibroad2013_koodi = '04' or d8a.iscfibroad2013_koodi = '04' or d9a.iscfibroad2013_koodi = '04' or d10a.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6a.iscfibroad2013_koodi = '04' or d7a.iscfibroad2013_koodi = '04' or d8a.iscfibroad2013_koodi = '04' or d9a.iscfibroad2013_koodi = '04' or d10a.iscfibroad2013_koodi = '04' or d11a.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7a.iscfibroad2013_koodi = '04' or d8a.iscfibroad2013_koodi = '04' or d9a.iscfibroad2013_koodi = '04' or d10a.iscfibroad2013_koodi = '04' or d11a.iscfibroad2013_koodi = '04' or d12a.iscfibroad2013_koodi = '04') then 1*/
	else 0
end as opisk_amk_koulala4
--Opiskellut koulutusala5 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1a.iscfibroad2013_koodi = '05' or d2a.iscfibroad2013_koodi = '05' or d3a.iscfibroad2013_koodi = '05' or d4a.iscfibroad2013_koodi = '05' or d5a.iscfibroad2013_koodi = '05' or d6a.iscfibroad2013_koodi = '05') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2a.iscfibroad2013_koodi = '05' or d3a.iscfibroad2013_koodi = '05' or d4a.iscfibroad2013_koodi = '05' or d5a.iscfibroad2013_koodi = '05' or d6a.iscfibroad2013_koodi = '05' or d7a.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3a.iscfibroad2013_koodi = '05' or d4a.iscfibroad2013_koodi = '05' or d5a.iscfibroad2013_koodi = '05' or d6a.iscfibroad2013_koodi = '05' or d7a.iscfibroad2013_koodi = '05' or d8a.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4a.iscfibroad2013_koodi = '05' or d5a.iscfibroad2013_koodi = '05' or d6a.iscfibroad2013_koodi = '05' or d7a.iscfibroad2013_koodi = '05' or d8a.iscfibroad2013_koodi = '05' or d9a.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5a.iscfibroad2013_koodi = '05' or d6a.iscfibroad2013_koodi = '05' or d7a.iscfibroad2013_koodi = '05' or d8a.iscfibroad2013_koodi = '05' or d9a.iscfibroad2013_koodi = '05' or d10a.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6a.iscfibroad2013_koodi = '05' or d7a.iscfibroad2013_koodi = '05' or d8a.iscfibroad2013_koodi = '05' or d9a.iscfibroad2013_koodi = '05' or d10a.iscfibroad2013_koodi = '05' or d11a.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7a.iscfibroad2013_koodi = '05' or d8a.iscfibroad2013_koodi = '05' or d9a.iscfibroad2013_koodi = '05' or d10a.iscfibroad2013_koodi = '05' or d11a.iscfibroad2013_koodi = '05' or d12a.iscfibroad2013_koodi = '05') then 1*/
	else 0
end as opisk_amk_koulala5
--Opiskellut koulutusala6 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1a.iscfibroad2013_koodi = '06' or d2a.iscfibroad2013_koodi = '06' or d3a.iscfibroad2013_koodi = '06' or d4a.iscfibroad2013_koodi = '06' or d5a.iscfibroad2013_koodi = '06' or d6a.iscfibroad2013_koodi = '06') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2a.iscfibroad2013_koodi = '06' or d3a.iscfibroad2013_koodi = '06' or d4a.iscfibroad2013_koodi = '06' or d5a.iscfibroad2013_koodi = '06' or d6a.iscfibroad2013_koodi = '06' or d7a.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3a.iscfibroad2013_koodi = '06' or d4a.iscfibroad2013_koodi = '06' or d5a.iscfibroad2013_koodi = '06' or d6a.iscfibroad2013_koodi = '06' or d7a.iscfibroad2013_koodi = '06' or d8a.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4a.iscfibroad2013_koodi = '06' or d5a.iscfibroad2013_koodi = '06' or d6a.iscfibroad2013_koodi = '06' or d7a.iscfibroad2013_koodi = '06' or d8a.iscfibroad2013_koodi = '06' or d9a.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5a.iscfibroad2013_koodi = '06' or d6a.iscfibroad2013_koodi = '06' or d7a.iscfibroad2013_koodi = '06' or d8a.iscfibroad2013_koodi = '06' or d9a.iscfibroad2013_koodi = '06' or d10a.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6a.iscfibroad2013_koodi = '06' or d7a.iscfibroad2013_koodi = '06' or d8a.iscfibroad2013_koodi = '06' or d9a.iscfibroad2013_koodi = '06' or d10a.iscfibroad2013_koodi = '06' or d11a.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7a.iscfibroad2013_koodi = '06' or d8a.iscfibroad2013_koodi = '06' or d9a.iscfibroad2013_koodi = '06' or d10a.iscfibroad2013_koodi = '06' or d11a.iscfibroad2013_koodi = '06' or d12a.iscfibroad2013_koodi = '06') then 1*/
	else 0
end as opisk_amk_koulala6
--Opiskellut koulutusala7 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1a.iscfibroad2013_koodi = '07' or d2a.iscfibroad2013_koodi = '07' or d3a.iscfibroad2013_koodi = '07' or d4a.iscfibroad2013_koodi = '07' or d5a.iscfibroad2013_koodi = '07' or d6a.iscfibroad2013_koodi = '07') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2a.iscfibroad2013_koodi = '07' or d3a.iscfibroad2013_koodi = '07' or d4a.iscfibroad2013_koodi = '07' or d5a.iscfibroad2013_koodi = '07' or d6a.iscfibroad2013_koodi = '07' or d7a.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3a.iscfibroad2013_koodi = '07' or d4a.iscfibroad2013_koodi = '07' or d5a.iscfibroad2013_koodi = '07' or d6a.iscfibroad2013_koodi = '07' or d7a.iscfibroad2013_koodi = '07' or d8a.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4a.iscfibroad2013_koodi = '07' or d5a.iscfibroad2013_koodi = '07' or d6a.iscfibroad2013_koodi = '07' or d7a.iscfibroad2013_koodi = '07' or d8a.iscfibroad2013_koodi = '07' or d9a.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5a.iscfibroad2013_koodi = '07' or d6a.iscfibroad2013_koodi = '07' or d7a.iscfibroad2013_koodi = '07' or d8a.iscfibroad2013_koodi = '07' or d9a.iscfibroad2013_koodi = '07' or d10a.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6a.iscfibroad2013_koodi = '07' or d7a.iscfibroad2013_koodi = '07' or d8a.iscfibroad2013_koodi = '07' or d9a.iscfibroad2013_koodi = '07' or d10a.iscfibroad2013_koodi = '07' or d11a.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7a.iscfibroad2013_koodi = '07' or d8a.iscfibroad2013_koodi = '07' or d9a.iscfibroad2013_koodi = '07' or d10a.iscfibroad2013_koodi = '07' or d11a.iscfibroad2013_koodi = '07' or d12a.iscfibroad2013_koodi = '07') then 1*/
	else 0
end as opisk_amk_koulala7
--Opiskellut koulutusala8 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1a.iscfibroad2013_koodi = '08' or d2a.iscfibroad2013_koodi = '08' or d3a.iscfibroad2013_koodi = '08' or d4a.iscfibroad2013_koodi = '08' or d5a.iscfibroad2013_koodi = '08' or d6a.iscfibroad2013_koodi = '08') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2a.iscfibroad2013_koodi = '08' or d3a.iscfibroad2013_koodi = '08' or d4a.iscfibroad2013_koodi = '08' or d5a.iscfibroad2013_koodi = '08' or d6a.iscfibroad2013_koodi = '08' or d7a.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3a.iscfibroad2013_koodi = '08' or d4a.iscfibroad2013_koodi = '08' or d5a.iscfibroad2013_koodi = '08' or d6a.iscfibroad2013_koodi = '08' or d7a.iscfibroad2013_koodi = '08' or d8a.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4a.iscfibroad2013_koodi = '08' or d5a.iscfibroad2013_koodi = '08' or d6a.iscfibroad2013_koodi = '08' or d7a.iscfibroad2013_koodi = '08' or d8a.iscfibroad2013_koodi = '08' or d9a.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5a.iscfibroad2013_koodi = '08' or d6a.iscfibroad2013_koodi = '08' or d7a.iscfibroad2013_koodi = '08' or d8a.iscfibroad2013_koodi = '08' or d9a.iscfibroad2013_koodi = '08' or d10a.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6a.iscfibroad2013_koodi = '08' or d7a.iscfibroad2013_koodi = '08' or d8a.iscfibroad2013_koodi = '08' or d9a.iscfibroad2013_koodi = '08' or d10a.iscfibroad2013_koodi = '08' or d11a.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7a.iscfibroad2013_koodi = '08' or d8a.iscfibroad2013_koodi = '08' or d9a.iscfibroad2013_koodi = '08' or d10a.iscfibroad2013_koodi = '08' or d11a.iscfibroad2013_koodi = '08' or d12a.iscfibroad2013_koodi = '08') then 1*/
	else 0
end as opisk_amk_koulala8
--Opiskellut koulutusala9 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1a.iscfibroad2013_koodi = '09' or d2a.iscfibroad2013_koodi = '09' or d3a.iscfibroad2013_koodi = '09' or d4a.iscfibroad2013_koodi = '09' or d5a.iscfibroad2013_koodi = '09' or d6a.iscfibroad2013_koodi = '09') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2a.iscfibroad2013_koodi = '09' or d3a.iscfibroad2013_koodi = '09' or d4a.iscfibroad2013_koodi = '09' or d5a.iscfibroad2013_koodi = '09' or d6a.iscfibroad2013_koodi = '09' or d7a.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3a.iscfibroad2013_koodi = '09' or d4a.iscfibroad2013_koodi = '09' or d5a.iscfibroad2013_koodi = '09' or d6a.iscfibroad2013_koodi = '09' or d7a.iscfibroad2013_koodi = '09' or d8a.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4a.iscfibroad2013_koodi = '09' or d5a.iscfibroad2013_koodi = '09' or d6a.iscfibroad2013_koodi = '09' or d7a.iscfibroad2013_koodi = '09' or d8a.iscfibroad2013_koodi = '09' or d9a.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5a.iscfibroad2013_koodi = '09' or d6a.iscfibroad2013_koodi = '09' or d7a.iscfibroad2013_koodi = '09' or d8a.iscfibroad2013_koodi = '09' or d9a.iscfibroad2013_koodi = '09' or d10a.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6a.iscfibroad2013_koodi = '09' or d7a.iscfibroad2013_koodi = '09' or d8a.iscfibroad2013_koodi = '09' or d9a.iscfibroad2013_koodi = '09' or d10a.iscfibroad2013_koodi = '09' or d11a.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7a.iscfibroad2013_koodi = '09' or d8a.iscfibroad2013_koodi = '09' or d9a.iscfibroad2013_koodi = '09' or d10a.iscfibroad2013_koodi = '09' or d11a.iscfibroad2013_koodi = '09' or d12a.iscfibroad2013_koodi = '09') then 1*/
	else 0
end as opisk_amk_koulala9
--Opiskellut koulutusala10 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1a.iscfibroad2013_koodi = '10' or d2a.iscfibroad2013_koodi = '10' or d3a.iscfibroad2013_koodi = '10' or d4a.iscfibroad2013_koodi = '10' or d5a.iscfibroad2013_koodi = '10' or d6a.iscfibroad2013_koodi = '10') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2a.iscfibroad2013_koodi = '10' or d3a.iscfibroad2013_koodi = '10' or d4a.iscfibroad2013_koodi = '10' or d5a.iscfibroad2013_koodi = '10' or d6a.iscfibroad2013_koodi = '10' or d7a.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3a.iscfibroad2013_koodi = '10' or d4a.iscfibroad2013_koodi = '10' or d5a.iscfibroad2013_koodi = '10' or d6a.iscfibroad2013_koodi = '10' or d7a.iscfibroad2013_koodi = '10' or d8a.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4a.iscfibroad2013_koodi = '10' or d5a.iscfibroad2013_koodi = '10' or d6a.iscfibroad2013_koodi = '10' or d7a.iscfibroad2013_koodi = '10' or d8a.iscfibroad2013_koodi = '10' or d9a.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5a.iscfibroad2013_koodi = '10' or d6a.iscfibroad2013_koodi = '10' or d7a.iscfibroad2013_koodi = '10' or d8a.iscfibroad2013_koodi = '10' or d9a.iscfibroad2013_koodi = '10' or d10a.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6a.iscfibroad2013_koodi = '10' or d7a.iscfibroad2013_koodi = '10' or d8a.iscfibroad2013_koodi = '10' or d9a.iscfibroad2013_koodi = '10' or d10a.iscfibroad2013_koodi = '10' or d11a.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7a.iscfibroad2013_koodi = '10' or d8a.iscfibroad2013_koodi = '10' or d9a.iscfibroad2013_koodi = '10' or d10a.iscfibroad2013_koodi = '10' or d11a.iscfibroad2013_koodi = '10' or d12a.iscfibroad2013_koodi = '10') then 1*/
	else 0
end as opisk_amk_koulala10



--Opiskellut koulutusala1 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1b.iscfibroad2013_koodi = '01' or d2b.iscfibroad2013_koodi = '01' or d3b.iscfibroad2013_koodi = '01' or d4b.iscfibroad2013_koodi = '01' or d5b.iscfibroad2013_koodi = '01' or d6b.iscfibroad2013_koodi = '01') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2b.iscfibroad2013_koodi = '01' or d3b.iscfibroad2013_koodi = '01' or d4b.iscfibroad2013_koodi = '01' or d5b.iscfibroad2013_koodi = '01' or d6b.iscfibroad2013_koodi = '01' or d7b.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3b.iscfibroad2013_koodi = '01' or d4b.iscfibroad2013_koodi = '01' or d5b.iscfibroad2013_koodi = '01' or d6b.iscfibroad2013_koodi = '01' or d7b.iscfibroad2013_koodi = '01' or d8b.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4b.iscfibroad2013_koodi = '01' or d5b.iscfibroad2013_koodi = '01' or d6b.iscfibroad2013_koodi = '01' or d7b.iscfibroad2013_koodi = '01' or d8b.iscfibroad2013_koodi = '01' or d9b.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5b.iscfibroad2013_koodi = '01' or d6b.iscfibroad2013_koodi = '01' or d7b.iscfibroad2013_koodi = '01' or d8b.iscfibroad2013_koodi = '01' or d9b.iscfibroad2013_koodi = '01' or d10b.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6b.iscfibroad2013_koodi = '01' or d7b.iscfibroad2013_koodi = '01' or d8b.iscfibroad2013_koodi = '01' or d9b.iscfibroad2013_koodi = '01' or d10b.iscfibroad2013_koodi = '01' or d11b.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7b.iscfibroad2013_koodi = '01' or d8b.iscfibroad2013_koodi = '01' or d9b.iscfibroad2013_koodi = '01' or d10b.iscfibroad2013_koodi = '01' or d11b.iscfibroad2013_koodi = '01' or d12b.iscfibroad2013_koodi = '01') then 1*/
	else 0
end as opisk_yo_koulala1
--Opiskellut koulutusala2 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1b.iscfibroad2013_koodi = '02' or d2b.iscfibroad2013_koodi = '02' or d3b.iscfibroad2013_koodi = '02' or d4b.iscfibroad2013_koodi = '02' or d5b.iscfibroad2013_koodi = '02' or d6b.iscfibroad2013_koodi = '02') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2b.iscfibroad2013_koodi = '02' or d3b.iscfibroad2013_koodi = '02' or d4b.iscfibroad2013_koodi = '02' or d5b.iscfibroad2013_koodi = '02' or d6b.iscfibroad2013_koodi = '02' or d7b.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3b.iscfibroad2013_koodi = '02' or d4b.iscfibroad2013_koodi = '02' or d5b.iscfibroad2013_koodi = '02' or d6b.iscfibroad2013_koodi = '02' or d7b.iscfibroad2013_koodi = '02' or d8b.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4b.iscfibroad2013_koodi = '02' or d5b.iscfibroad2013_koodi = '02' or d6b.iscfibroad2013_koodi = '02' or d7b.iscfibroad2013_koodi = '02' or d8b.iscfibroad2013_koodi = '02' or d9b.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5b.iscfibroad2013_koodi = '02' or d6b.iscfibroad2013_koodi = '02' or d7b.iscfibroad2013_koodi = '02' or d8b.iscfibroad2013_koodi = '02' or d9b.iscfibroad2013_koodi = '02' or d10b.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6b.iscfibroad2013_koodi = '02' or d7b.iscfibroad2013_koodi = '02' or d8b.iscfibroad2013_koodi = '02' or d9b.iscfibroad2013_koodi = '02' or d10b.iscfibroad2013_koodi = '02' or d11b.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7b.iscfibroad2013_koodi = '02' or d8b.iscfibroad2013_koodi = '02' or d9b.iscfibroad2013_koodi = '02' or d10b.iscfibroad2013_koodi = '02' or d11b.iscfibroad2013_koodi = '02' or d12b.iscfibroad2013_koodi = '02') then 1*/
	else 0
end as opisk_yo_koulala2
--Opiskellut koulutusala3 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1b.iscfibroad2013_koodi = '03' or d2b.iscfibroad2013_koodi = '03' or d3b.iscfibroad2013_koodi = '03' or d4b.iscfibroad2013_koodi = '03' or d5b.iscfibroad2013_koodi = '03' or d6b.iscfibroad2013_koodi = '03') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2b.iscfibroad2013_koodi = '03' or d3b.iscfibroad2013_koodi = '03' or d4b.iscfibroad2013_koodi = '03' or d5b.iscfibroad2013_koodi = '03' or d6b.iscfibroad2013_koodi = '03' or d7b.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3b.iscfibroad2013_koodi = '03' or d4b.iscfibroad2013_koodi = '03' or d5b.iscfibroad2013_koodi = '03' or d6b.iscfibroad2013_koodi = '03' or d7b.iscfibroad2013_koodi = '03' or d8b.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4b.iscfibroad2013_koodi = '03' or d5b.iscfibroad2013_koodi = '03' or d6b.iscfibroad2013_koodi = '03' or d7b.iscfibroad2013_koodi = '03' or d8b.iscfibroad2013_koodi = '03' or d9b.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5b.iscfibroad2013_koodi = '03' or d6b.iscfibroad2013_koodi = '03' or d7b.iscfibroad2013_koodi = '03' or d8b.iscfibroad2013_koodi = '03' or d9b.iscfibroad2013_koodi = '03' or d10b.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6b.iscfibroad2013_koodi = '03' or d7b.iscfibroad2013_koodi = '03' or d8b.iscfibroad2013_koodi = '03' or d9b.iscfibroad2013_koodi = '03' or d10b.iscfibroad2013_koodi = '03' or d11b.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7b.iscfibroad2013_koodi = '03' or d8b.iscfibroad2013_koodi = '03' or d9b.iscfibroad2013_koodi = '03' or d10b.iscfibroad2013_koodi = '03' or d11b.iscfibroad2013_koodi = '03' or d12b.iscfibroad2013_koodi = '03') then 1*/
	else 0
end as opisk_yo_koulala3
--Opiskellut koulutusala4 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1b.iscfibroad2013_koodi = '04' or d2b.iscfibroad2013_koodi = '04' or d3b.iscfibroad2013_koodi = '04' or d4b.iscfibroad2013_koodi = '04' or d5b.iscfibroad2013_koodi = '04' or d6b.iscfibroad2013_koodi = '04') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2b.iscfibroad2013_koodi = '04' or d3b.iscfibroad2013_koodi = '04' or d4b.iscfibroad2013_koodi = '04' or d5b.iscfibroad2013_koodi = '04' or d6b.iscfibroad2013_koodi = '04' or d7b.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3b.iscfibroad2013_koodi = '04' or d4b.iscfibroad2013_koodi = '04' or d5b.iscfibroad2013_koodi = '04' or d6b.iscfibroad2013_koodi = '04' or d7b.iscfibroad2013_koodi = '04' or d8b.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4b.iscfibroad2013_koodi = '04' or d5b.iscfibroad2013_koodi = '04' or d6b.iscfibroad2013_koodi = '04' or d7b.iscfibroad2013_koodi = '04' or d8b.iscfibroad2013_koodi = '04' or d9b.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5b.iscfibroad2013_koodi = '04' or d6b.iscfibroad2013_koodi = '04' or d7b.iscfibroad2013_koodi = '04' or d8b.iscfibroad2013_koodi = '04' or d9b.iscfibroad2013_koodi = '04' or d10b.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6b.iscfibroad2013_koodi = '04' or d7b.iscfibroad2013_koodi = '04' or d8b.iscfibroad2013_koodi = '04' or d9b.iscfibroad2013_koodi = '04' or d10b.iscfibroad2013_koodi = '04' or d11b.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7b.iscfibroad2013_koodi = '04' or d8b.iscfibroad2013_koodi = '04' or d9b.iscfibroad2013_koodi = '04' or d10b.iscfibroad2013_koodi = '04' or d11b.iscfibroad2013_koodi = '04' or d12b.iscfibroad2013_koodi = '04') then 1*/
	else 0
end as opisk_yo_koulala4
--Opiskellut koulutusala5 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1b.iscfibroad2013_koodi = '05' or d2b.iscfibroad2013_koodi = '05' or d3b.iscfibroad2013_koodi = '05' or d4b.iscfibroad2013_koodi = '05' or d5b.iscfibroad2013_koodi = '05' or d6b.iscfibroad2013_koodi = '05') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2b.iscfibroad2013_koodi = '05' or d3b.iscfibroad2013_koodi = '05' or d4b.iscfibroad2013_koodi = '05' or d5b.iscfibroad2013_koodi = '05' or d6b.iscfibroad2013_koodi = '05' or d7b.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3b.iscfibroad2013_koodi = '05' or d4b.iscfibroad2013_koodi = '05' or d5b.iscfibroad2013_koodi = '05' or d6b.iscfibroad2013_koodi = '05' or d7b.iscfibroad2013_koodi = '05' or d8b.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4b.iscfibroad2013_koodi = '05' or d5b.iscfibroad2013_koodi = '05' or d6b.iscfibroad2013_koodi = '05' or d7b.iscfibroad2013_koodi = '05' or d8b.iscfibroad2013_koodi = '05' or d9b.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5b.iscfibroad2013_koodi = '05' or d6b.iscfibroad2013_koodi = '05' or d7b.iscfibroad2013_koodi = '05' or d8b.iscfibroad2013_koodi = '05' or d9b.iscfibroad2013_koodi = '05' or d10b.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6b.iscfibroad2013_koodi = '05' or d7b.iscfibroad2013_koodi = '05' or d8b.iscfibroad2013_koodi = '05' or d9b.iscfibroad2013_koodi = '05' or d10b.iscfibroad2013_koodi = '05' or d11b.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7b.iscfibroad2013_koodi = '05' or d8b.iscfibroad2013_koodi = '05' or d9b.iscfibroad2013_koodi = '05' or d10b.iscfibroad2013_koodi = '05' or d11b.iscfibroad2013_koodi = '05' or d12b.iscfibroad2013_koodi = '05') then 1*/
	else 0
end as opisk_yo_koulala5
--Opiskellut koulutusala6 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1b.iscfibroad2013_koodi = '06' or d2b.iscfibroad2013_koodi = '06' or d3b.iscfibroad2013_koodi = '06' or d4b.iscfibroad2013_koodi = '06' or d5b.iscfibroad2013_koodi = '06' or d6b.iscfibroad2013_koodi = '06') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2b.iscfibroad2013_koodi = '06' or d3b.iscfibroad2013_koodi = '06' or d4b.iscfibroad2013_koodi = '06' or d5b.iscfibroad2013_koodi = '06' or d6b.iscfibroad2013_koodi = '06' or d7b.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3b.iscfibroad2013_koodi = '06' or d4b.iscfibroad2013_koodi = '06' or d5b.iscfibroad2013_koodi = '06' or d6b.iscfibroad2013_koodi = '06' or d7b.iscfibroad2013_koodi = '06' or d8b.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4b.iscfibroad2013_koodi = '06' or d5b.iscfibroad2013_koodi = '06' or d6b.iscfibroad2013_koodi = '06' or d7b.iscfibroad2013_koodi = '06' or d8b.iscfibroad2013_koodi = '06' or d9b.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5b.iscfibroad2013_koodi = '06' or d6b.iscfibroad2013_koodi = '06' or d7b.iscfibroad2013_koodi = '06' or d8b.iscfibroad2013_koodi = '06' or d9b.iscfibroad2013_koodi = '06' or d10b.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6b.iscfibroad2013_koodi = '06' or d7b.iscfibroad2013_koodi = '06' or d8b.iscfibroad2013_koodi = '06' or d9b.iscfibroad2013_koodi = '06' or d10b.iscfibroad2013_koodi = '06' or d11b.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7b.iscfibroad2013_koodi = '06' or d8b.iscfibroad2013_koodi = '06' or d9b.iscfibroad2013_koodi = '06' or d10b.iscfibroad2013_koodi = '06' or d11b.iscfibroad2013_koodi = '06' or d12b.iscfibroad2013_koodi = '06') then 1*/
	else 0
end as opisk_yo_koulala6
--Opiskellut koulutusala7 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1b.iscfibroad2013_koodi = '07' or d2b.iscfibroad2013_koodi = '07' or d3b.iscfibroad2013_koodi = '07' or d4b.iscfibroad2013_koodi = '07' or d5b.iscfibroad2013_koodi = '07' or d6b.iscfibroad2013_koodi = '07') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2b.iscfibroad2013_koodi = '07' or d3b.iscfibroad2013_koodi = '07' or d4b.iscfibroad2013_koodi = '07' or d5b.iscfibroad2013_koodi = '07' or d6b.iscfibroad2013_koodi = '07' or d7b.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3b.iscfibroad2013_koodi = '07' or d4b.iscfibroad2013_koodi = '07' or d5b.iscfibroad2013_koodi = '07' or d6b.iscfibroad2013_koodi = '07' or d7b.iscfibroad2013_koodi = '07' or d8b.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4b.iscfibroad2013_koodi = '07' or d5b.iscfibroad2013_koodi = '07' or d6b.iscfibroad2013_koodi = '07' or d7b.iscfibroad2013_koodi = '07' or d8b.iscfibroad2013_koodi = '07' or d9b.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5b.iscfibroad2013_koodi = '07' or d6b.iscfibroad2013_koodi = '07' or d7b.iscfibroad2013_koodi = '07' or d8b.iscfibroad2013_koodi = '07' or d9b.iscfibroad2013_koodi = '07' or d10b.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6b.iscfibroad2013_koodi = '07' or d7b.iscfibroad2013_koodi = '07' or d8b.iscfibroad2013_koodi = '07' or d9b.iscfibroad2013_koodi = '07' or d10b.iscfibroad2013_koodi = '07' or d11b.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7b.iscfibroad2013_koodi = '07' or d8b.iscfibroad2013_koodi = '07' or d9b.iscfibroad2013_koodi = '07' or d10b.iscfibroad2013_koodi = '07' or d11b.iscfibroad2013_koodi = '07' or d12b.iscfibroad2013_koodi = '07') then 1*/
	else 0
end as opisk_yo_koulala7
--Opiskellut koulutusala8 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1b.iscfibroad2013_koodi = '08' or d2b.iscfibroad2013_koodi = '08' or d3b.iscfibroad2013_koodi = '08' or d4b.iscfibroad2013_koodi = '08' or d5b.iscfibroad2013_koodi = '08' or d6b.iscfibroad2013_koodi = '08') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2b.iscfibroad2013_koodi = '08' or d3b.iscfibroad2013_koodi = '08' or d4b.iscfibroad2013_koodi = '08' or d5b.iscfibroad2013_koodi = '08' or d6b.iscfibroad2013_koodi = '08' or d7b.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3b.iscfibroad2013_koodi = '08' or d4b.iscfibroad2013_koodi = '08' or d5b.iscfibroad2013_koodi = '08' or d6b.iscfibroad2013_koodi = '08' or d7b.iscfibroad2013_koodi = '08' or d8b.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4b.iscfibroad2013_koodi = '08' or d5b.iscfibroad2013_koodi = '08' or d6b.iscfibroad2013_koodi = '08' or d7b.iscfibroad2013_koodi = '08' or d8b.iscfibroad2013_koodi = '08' or d9b.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5b.iscfibroad2013_koodi = '08' or d6b.iscfibroad2013_koodi = '08' or d7b.iscfibroad2013_koodi = '08' or d8b.iscfibroad2013_koodi = '08' or d9b.iscfibroad2013_koodi = '08' or d10b.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6b.iscfibroad2013_koodi = '08' or d7b.iscfibroad2013_koodi = '08' or d8b.iscfibroad2013_koodi = '08' or d9b.iscfibroad2013_koodi = '08' or d10b.iscfibroad2013_koodi = '08' or d11b.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7b.iscfibroad2013_koodi = '08' or d8b.iscfibroad2013_koodi = '08' or d9b.iscfibroad2013_koodi = '08' or d10b.iscfibroad2013_koodi = '08' or d11b.iscfibroad2013_koodi = '08' or d12b.iscfibroad2013_koodi = '08') then 1*/
	else 0
end as opisk_yo_koulala8
--Opiskellut koulutusala9 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1b.iscfibroad2013_koodi = '09' or d2b.iscfibroad2013_koodi = '09' or d3b.iscfibroad2013_koodi = '09' or d4b.iscfibroad2013_koodi = '09' or d5b.iscfibroad2013_koodi = '09' or d6b.iscfibroad2013_koodi = '09') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2b.iscfibroad2013_koodi = '09' or d3b.iscfibroad2013_koodi = '09' or d4b.iscfibroad2013_koodi = '09' or d5b.iscfibroad2013_koodi = '09' or d6b.iscfibroad2013_koodi = '09' or d7b.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3b.iscfibroad2013_koodi = '09' or d4b.iscfibroad2013_koodi = '09' or d5b.iscfibroad2013_koodi = '09' or d6b.iscfibroad2013_koodi = '09' or d7b.iscfibroad2013_koodi = '09' or d8b.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4b.iscfibroad2013_koodi = '09' or d5b.iscfibroad2013_koodi = '09' or d6b.iscfibroad2013_koodi = '09' or d7b.iscfibroad2013_koodi = '09' or d8b.iscfibroad2013_koodi = '09' or d9b.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5b.iscfibroad2013_koodi = '09' or d6b.iscfibroad2013_koodi = '09' or d7b.iscfibroad2013_koodi = '09' or d8b.iscfibroad2013_koodi = '09' or d9b.iscfibroad2013_koodi = '09' or d10b.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6b.iscfibroad2013_koodi = '09' or d7b.iscfibroad2013_koodi = '09' or d8b.iscfibroad2013_koodi = '09' or d9b.iscfibroad2013_koodi = '09' or d10b.iscfibroad2013_koodi = '09' or d11b.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7b.iscfibroad2013_koodi = '09' or d8b.iscfibroad2013_koodi = '09' or d9b.iscfibroad2013_koodi = '09' or d10b.iscfibroad2013_koodi = '09' or d11b.iscfibroad2013_koodi = '09' or d12b.iscfibroad2013_koodi = '09') then 1*/
	else 0
end as opisk_yo_koulala9
--Opiskellut koulutusala10 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '2' and (d1b.iscfibroad2013_koodi = '10' or d2b.iscfibroad2013_koodi = '10' or d3b.iscfibroad2013_koodi = '10' or d4b.iscfibroad2013_koodi = '10' or d5b.iscfibroad2013_koodi = '10' or d6b.iscfibroad2013_koodi = '10') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (d2b.iscfibroad2013_koodi = '10' or d3b.iscfibroad2013_koodi = '10' or d4b.iscfibroad2013_koodi = '10' or d5b.iscfibroad2013_koodi = '10' or d6b.iscfibroad2013_koodi = '10' or d7b.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (d3b.iscfibroad2013_koodi = '10' or d4b.iscfibroad2013_koodi = '10' or d5b.iscfibroad2013_koodi = '10' or d6b.iscfibroad2013_koodi = '10' or d7b.iscfibroad2013_koodi = '10' or d8b.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (d4b.iscfibroad2013_koodi = '10' or d5b.iscfibroad2013_koodi = '10' or d6b.iscfibroad2013_koodi = '10' or d7b.iscfibroad2013_koodi = '10' or d8b.iscfibroad2013_koodi = '10' or d9b.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (d5b.iscfibroad2013_koodi = '10' or d6b.iscfibroad2013_koodi = '10' or d7b.iscfibroad2013_koodi = '10' or d8b.iscfibroad2013_koodi = '10' or d9b.iscfibroad2013_koodi = '10' or d10b.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (d6b.iscfibroad2013_koodi = '10' or d7b.iscfibroad2013_koodi = '10' or d8b.iscfibroad2013_koodi = '10' or d9b.iscfibroad2013_koodi = '10' or d10b.iscfibroad2013_koodi = '10' or d11b.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (d7b.iscfibroad2013_koodi = '10' or d8b.iscfibroad2013_koodi = '10' or d9b.iscfibroad2013_koodi = '10' or d10b.iscfibroad2013_koodi = '10' or d11b.iscfibroad2013_koodi = '10' or d12b.iscfibroad2013_koodi = '10') then 1*/
	else 0
end as opisk_yo_koulala10


--Opiskellut useampaa kuin yhtä alaa (taso 1) (kyllä/ei)
,case --ensimmäisenä vuotena on mahdollista olla vain yksi ala
	when  l.suorlk = '2' and m1.MinValue <> m1.MaxValue then 1 
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and m2.MinValue <> m2.MaxValue then 1 
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and m3.MinValue <> m3.MaxValue then 1 
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and m4.MinValue <> m4.MaxValue then 1 
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and m5.MinValue <> m5.MaxValue then 1 
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and m6.MinValue <> m6.MaxValue then 1 
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and m7.MinValue <> m7.MaxValue then 1 */
	else 0
end as opisk_vah2_koulala


----HAUT KYLLÄ/EI
--Hakenut ammatilliseen koulutukseen
,case
	when  l.suorlk = '2' and (l.monihaku_1 in (2,3,5) or l.monihaku_2 in (2,3,5) or l.monihaku_3 in (2,3,5) or l.monihaku_4 in (2,3,5) or l.monihaku_5 in (2,3,5) or l.monihaku_6 in (2,3,5)) then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.monihaku_2 in (2,3,5) or l.monihaku_3 in (2,3,5) or l.monihaku_4 in (2,3,5) or l.monihaku_5 in (2,3,5) or l.monihaku_6 in (2,3,5) or l.monihaku2010 in (2,3,5)) then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.monihaku_3 in (2,3,5) or l.monihaku_4 in (2,3,5) or l.monihaku_5 in (2,3,5) or l.monihaku_6 in (2,3,5) or l.monihaku2010 in (2,3,5) or l.monihaku2011 in (2,3,5)) then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.monihaku_4 in (2,3,5) or l.monihaku_5 in (2,3,5) or l.monihaku_6 in (2,3,5) or l.monihaku2010 in (2,3,5) or l.monihaku2011 in (2,3,5) or l.monihaku2012 in (2,3,5)) then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.monihaku_5 in (2,3,5) or l.monihaku_6 in (2,3,5) or l.monihaku2010 in (2,3,5) or l.monihaku2011 in (2,3,5) or l.monihaku2012 in (2,3,5) or l.monihaku2013 in (2,3,5)) then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.monihaku_6 in (2,3,5) or l.monihaku2010 in (2,3,5) or l.monihaku2011 in (2,3,5) or l.monihaku2012 in (2,3,5) or l.monihaku2013 in (2,3,5) or l.monihaku2014 in (2,3,5)) then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.monihaku2010 in (2,3,5) or l.monihaku2011 in (2,3,5) or l.monihaku2012 in (2,3,5) or l.monihaku2013 in (2,3,5) or l.monihaku2014 in (2,3,5) or l.monihaku2015 in (2,3,5)) then 1*/
	else 0
end as haku_amm
--Hakenut ammattikorkeakoulutukseen
,case
	when  l.suorlk = '2' and (l.monihaku_1 in (4,6) or l.monihaku_2 in (4,6) or l.monihaku_3 in (4,6) or l.monihaku_4 in (4,6) or l.monihaku_5 in (4,6) or l.monihaku_6 in (4,6)) then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.monihaku_2 in (4,6) or l.monihaku_3 in (4,6) or l.monihaku_4 in (4,6) or l.monihaku_5 in (4,6) or l.monihaku_6 in (4,6) or l.monihaku2010 in (4,6)) then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.monihaku_3 in (4,6) or l.monihaku_4 in (4,6) or l.monihaku_5 in (4,6) or l.monihaku_6 in (4,6) or l.monihaku2010 in (4,6) or l.monihaku2011 in (4,6)) then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.monihaku_4 in (4,6) or l.monihaku_5 in (4,6) or l.monihaku_6 in (4,6) or l.monihaku2010 in (4,6) or l.monihaku2011 in (4,6) or l.monihaku2012 in (4,6)) then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.monihaku_5 in (4,6) or l.monihaku_6 in (4,6) or l.monihaku2010 in (4,6) or l.monihaku2011 in (4,6) or l.monihaku2012 in (4,6) or l.monihaku2013 in (4,6)) then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.monihaku_6 in (4,6) or l.monihaku2010 in (4,6) or l.monihaku2011 in (4,6) or l.monihaku2012 in (4,6) or l.monihaku2013 in (4,6) or l.monihaku2014 in (4,6)) then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.monihaku2010 in (4,6) or l.monihaku2011 in (4,6) or l.monihaku2012 in (4,6) or l.monihaku2013 in (4,6) or l.monihaku2014 in (4,6) or l.monihaku2015 in (4,6)) then 1*/
	else 0
end as haku_amk
--Hakenut yliopistokoulutukseen
,case
	when  l.suorlk = '2' and (l.monihaku_1 in (6,7) or l.monihaku_2 in (6,7) or l.monihaku_3 in (6,7) or l.monihaku_4 in (6,7) or l.monihaku_5 in (6,7) or l.monihaku_6 in (6,7)) then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.monihaku_2 in (6,7) or l.monihaku_3 in (6,7) or l.monihaku_4 in (6,7) or l.monihaku_5 in (6,7) or l.monihaku_6 in (6,7) or l.monihaku2010 in (6,7)) then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.monihaku_3 in (6,7) or l.monihaku_4 in (6,7) or l.monihaku_5 in (6,7) or l.monihaku_6 in (6,7) or l.monihaku2010 in (6,7) or l.monihaku2011 in (6,7)) then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.monihaku_4 in (6,7) or l.monihaku_5 in (6,7) or l.monihaku_6 in (6,7) or l.monihaku2010 in (6,7) or l.monihaku2011 in (6,7) or l.monihaku2012 in (6,7)) then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.monihaku_5 in (6,7) or l.monihaku_6 in (6,7) or l.monihaku2010 in (6,7) or l.monihaku2011 in (6,7) or l.monihaku2012 in (6,7) or l.monihaku2013 in (6,7)) then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.monihaku_6 in (6,7) or l.monihaku2010 in (6,7) or l.monihaku2011 in (6,7) or l.monihaku2012 in (6,7) or l.monihaku2013 in (6,7) or l.monihaku2014 in (6,7)) then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.monihaku2010 in (6,7) or l.monihaku2011 in (6,7) or l.monihaku2012 in (6,7) or l.monihaku2013 in (6,7) or l.monihaku2014 in (6,7) or l.monihaku2015 in (6,7)) then 1*/
	else 0
end as haku_yo




----MITTARIT
--Ei hakenut eikä opiskellut mitään
,case
	when  l.suorlk = '2' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku_6 not in (4,5,6,7) and l.luopiskkoulk_1 = '' and l.ammopiskkoulk_1 = '' and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.luopiskkoulk_6 = '' and l.ammopiskkoulk_6 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku_6 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.luopiskkoulk_6 = '' and l.ammopiskkoulk_6 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku_6 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.luopiskkoulk_6 = '' and l.ammopiskkoulk_6 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku_6 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.luopiskkoulk_6 = '' and l.ammopiskkoulk_6 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and monihaku_5 not in (4,5,6,7) and monihaku_6 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.luopiskkoulk_6 = '' and l.ammopiskkoulk_6 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and monihaku_6 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and monihaku2014 not in (4,5,6,7) and l.luopiskkoulk_6 = '' and l.ammopiskkoulk_6 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and monihaku2014 not in (4,5,6,7) and monihaku2015 not in (4,5,6,7) and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' and l.luopiskkoulk2015 = '' and l.ammopiskkoulk2015 = '' and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' then 1*/
	else 0
end eihaku_kk_eiopisk

--Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa
,case 
	when  l.suorlk = '2' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku_6 not in (4,5,6,7) and (l.luopiskkoulk_1 <> '' or l.ammopiskkoulk_1 <> '' or l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.ammopiskkoulk_5 <> '' or l.luopiskkoulk_6 <> '' or l.ammopiskkoulk_6 <> '') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku_6 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and (l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.ammopiskkoulk_5 <> '' or l.luopiskkoulk_6 <> '' or l.ammopiskkoulk_6 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku_6 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and (l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.ammopiskkoulk_5 <> '' or l.luopiskkoulk_6 <> '' or l.ammopiskkoulk_6 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '') and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku_6 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and (l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.ammopiskkoulk_5 <> '' or l.luopiskkoulk_6 <> '' or l.ammopiskkoulk_6 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '') and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and monihaku_5 not in (4,5,6,7) and monihaku_6 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and (l.luopiskkoulk_5 <> '' or l.ammopiskkoulk_5 <> '' or l.luopiskkoulk_6 <> '' or l.ammopiskkoulk_6 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '' or l.ammopiskkoulk2013 <> '') and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and monihaku_6 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and monihaku2014 not in (4,5,6,7) and (l.luopiskkoulk_6 <> '' or l.ammopiskkoulk_6 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '' or l.ammopiskkoulk2013 <> '' or l.luopiskkoulk2014 <> '' or l.ammopiskkoulk2014 <> '') and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and monihaku2014 not in (4,5,6,7) and monihaku2015 not in (4,5,6,7) and (l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '' or l.ammopiskkoulk2013 <> '' or l.luopiskkoulk2014 <> '' or l.ammopiskkoulk2014 <> '' or l.luopiskkoulk2015 <> '' or l.ammopiskkoulk2015 <> '') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' then 1*/
	else 0
end eihaku_kk_eiopisk_kk_opisk_ta

----Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa, opiskellut lukiokoulutuksessa
,case 
	when  l.suorlk = '2' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku_6 not in (4,5,6,7) and (l.luopiskkoulk_1 <> '' or l.luopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.luopiskkoulk_6 <> '') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku_6 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and (l.luopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.luopiskkoulk_6 <> '' or l.luopiskkoulk2010 <> '') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku_6 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and (l.luopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.luopiskkoulk_6 <> '' or l.luopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '') and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku_6 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and (l.luopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.luopiskkoulk_6 <> '' or l.luopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '') and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and monihaku_5 not in (4,5,6,7) and monihaku_6 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and (l.luopiskkoulk_5 <> '' or l.luopiskkoulk_6 <> '' or l.luopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '') and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and monihaku_6 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and monihaku2014 not in (4,5,6,7) and (l.luopiskkoulk_6 <> '' or l.luopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '' or l.luopiskkoulk2014 <> '') and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and monihaku2014 not in (4,5,6,7) and monihaku2015 not in (4,5,6,7) and (l.luopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '' or l.luopiskkoulk2014 <> '' or l.luopiskkoulk2015 <> '') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' then 1*/
	else 0
end eihaku_kk_eiopisk_kk_opisk_lu

----Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa, opiskellut ammatillisessa peruskoulutuksessa
,case 
	when  l.suorlk = '2' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku_6 not in (4,5,6,7) and (d1c.Koulutusaste_taso2_koodi = '32' or d2c.Koulutusaste_taso2_koodi = '32' or d3c.Koulutusaste_taso2_koodi = '32' or d4c.Koulutusaste_taso2_koodi = '32' or d5c.Koulutusaste_taso2_koodi = '32' or d6c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku_6 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and (d2c.Koulutusaste_taso2_koodi = '32' or d3c.Koulutusaste_taso2_koodi = '32' or d4c.Koulutusaste_taso2_koodi = '32' or d5c.Koulutusaste_taso2_koodi = '32' or d6c.Koulutusaste_taso2_koodi = '32' or d7c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku_6 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and (d3c.Koulutusaste_taso2_koodi = '32' or d4c.Koulutusaste_taso2_koodi = '32' or d5c.Koulutusaste_taso2_koodi = '32' or d6c.Koulutusaste_taso2_koodi = '32' or d7c.Koulutusaste_taso2_koodi = '32' or d8c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku_6 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and (d4c.Koulutusaste_taso2_koodi = '32' or d5c.Koulutusaste_taso2_koodi = '32' or d6c.Koulutusaste_taso2_koodi = '32' or d7c.Koulutusaste_taso2_koodi = '32' or d8c.Koulutusaste_taso2_koodi = '32' or d9c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and monihaku_5 not in (4,5,6,7) and monihaku_6 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and (d5c.Koulutusaste_taso2_koodi = '32' or d6c.Koulutusaste_taso2_koodi = '32' or d7c.Koulutusaste_taso2_koodi = '32' or d8c.Koulutusaste_taso2_koodi = '32' or d9c.Koulutusaste_taso2_koodi = '32' or d10c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and monihaku_6 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and monihaku2014 not in (4,5,6,7) and (d6c.Koulutusaste_taso2_koodi = '32' or d7c.Koulutusaste_taso2_koodi = '32' or d8c.Koulutusaste_taso2_koodi = '32' or d9c.Koulutusaste_taso2_koodi = '32' or d10c.Koulutusaste_taso2_koodi = '32' or d11c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and monihaku2014 not in (4,5,6,7) and monihaku2015 not in (4,5,6,7) and (d7c.Koulutusaste_taso2_koodi = '32' or d8c.Koulutusaste_taso2_koodi = '32' or d9c.Koulutusaste_taso2_koodi = '32' or d10c.Koulutusaste_taso2_koodi = '32' or d11c.Koulutusaste_taso2_koodi = '32' or d12c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' then 1*/
	else 0
end eihaku_kk_eiopisk_kk_opisk_pk

------Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa, opiskellut ammattitutkintokoulutuksessa
,case 
	when  l.suorlk = '2' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku_6 not in (4,5,6,7) and (d1c.Koulutusaste_taso2_koodi = '33' or d2c.Koulutusaste_taso2_koodi = '33' or d3c.Koulutusaste_taso2_koodi = '33' or d4c.Koulutusaste_taso2_koodi = '33' or d5c.Koulutusaste_taso2_koodi = '33' or d6c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku_6 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and (d2c.Koulutusaste_taso2_koodi = '33' or d3c.Koulutusaste_taso2_koodi = '33' or d4c.Koulutusaste_taso2_koodi = '33' or d5c.Koulutusaste_taso2_koodi = '33' or d6c.Koulutusaste_taso2_koodi = '33' or d7c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku_6 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and (d3c.Koulutusaste_taso2_koodi = '33' or d4c.Koulutusaste_taso2_koodi = '33' or d5c.Koulutusaste_taso2_koodi = '33' or d6c.Koulutusaste_taso2_koodi = '33' or d7c.Koulutusaste_taso2_koodi = '33' or d8c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku_6 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and (d4c.Koulutusaste_taso2_koodi = '33' or d5c.Koulutusaste_taso2_koodi = '33' or d6c.Koulutusaste_taso2_koodi = '33' or d7c.Koulutusaste_taso2_koodi = '33' or d8c.Koulutusaste_taso2_koodi = '33' or d9c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and monihaku_5 not in (4,5,6,7) and monihaku_6 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and (d5c.Koulutusaste_taso2_koodi = '33' or d6c.Koulutusaste_taso2_koodi = '33' or d7c.Koulutusaste_taso2_koodi = '33' or d8c.Koulutusaste_taso2_koodi = '33' or d9c.Koulutusaste_taso2_koodi = '33' or d10c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and monihaku_6 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and monihaku2014 not in (4,5,6,7) and (d6c.Koulutusaste_taso2_koodi = '33' or d7c.Koulutusaste_taso2_koodi = '33' or d8c.Koulutusaste_taso2_koodi = '33' or d9c.Koulutusaste_taso2_koodi = '33' or d10c.Koulutusaste_taso2_koodi = '33' or d11c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and monihaku2014 not in (4,5,6,7) and monihaku2015 not in (4,5,6,7) and (d7c.Koulutusaste_taso2_koodi = '33' or d8c.Koulutusaste_taso2_koodi = '33' or d9c.Koulutusaste_taso2_koodi = '33' or d10c.Koulutusaste_taso2_koodi = '33' or d11c.Koulutusaste_taso2_koodi = '33' or d12c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' then 1*/
	else 0
end eihaku_kk_eiopisk_kk_opisk_at

------Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa, opiskellut erikoisammattitutkintokoulutuksessa
,case 
	when  l.suorlk = '2' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku_6 not in (4,5,6,7) and (d1c.Koulutusaste_taso2_koodi = '41' or d2c.Koulutusaste_taso2_koodi = '41' or d3c.Koulutusaste_taso2_koodi = '41' or d4c.Koulutusaste_taso2_koodi = '41' or d5c.Koulutusaste_taso2_koodi = '41' or d6c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku_6 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and (d2c.Koulutusaste_taso2_koodi = '41' or d3c.Koulutusaste_taso2_koodi = '41' or d4c.Koulutusaste_taso2_koodi = '41' or d5c.Koulutusaste_taso2_koodi = '41' or d6c.Koulutusaste_taso2_koodi = '41' or d7c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku_6 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and (d3c.Koulutusaste_taso2_koodi = '41' or d4c.Koulutusaste_taso2_koodi = '41' or d5c.Koulutusaste_taso2_koodi = '41' or d6c.Koulutusaste_taso2_koodi = '41' or d7c.Koulutusaste_taso2_koodi = '41' or d8c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku_6 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and (d4c.Koulutusaste_taso2_koodi = '41' or d5c.Koulutusaste_taso2_koodi = '41' or d6c.Koulutusaste_taso2_koodi = '41' or d7c.Koulutusaste_taso2_koodi = '41' or d8c.Koulutusaste_taso2_koodi = '41' or d9c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and monihaku_5 not in (4,5,6,7) and monihaku_6 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and (d5c.Koulutusaste_taso2_koodi = '41' or d6c.Koulutusaste_taso2_koodi = '41' or d7c.Koulutusaste_taso2_koodi = '41' or d8c.Koulutusaste_taso2_koodi = '41' or d9c.Koulutusaste_taso2_koodi = '41' or d10c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and monihaku_6 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and monihaku2014 not in (4,5,6,7) and (d6c.Koulutusaste_taso2_koodi = '41' or d7c.Koulutusaste_taso2_koodi = '41' or d8c.Koulutusaste_taso2_koodi = '41' or d9c.Koulutusaste_taso2_koodi = '41' or d10c.Koulutusaste_taso2_koodi = '41' or d11c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and monihaku2014 not in (4,5,6,7) and monihaku2015 not in (4,5,6,7) and (d7c.Koulutusaste_taso2_koodi = '41' or d8c.Koulutusaste_taso2_koodi = '41' or d9c.Koulutusaste_taso2_koodi = '41' or d10c.Koulutusaste_taso2_koodi = '41' or d11c.Koulutusaste_taso2_koodi = '41' or d12c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' then 1*/
	else 0
end eihaku_kk_eiopisk_kk_opisk_eat

--Hakenut korkea-asteelle, ei opiskellut korkea-asteella
,case 
	when  l.suorlk = '2' and (monihaku_1 in (4,5,6,7) or monihaku_2 in (4,5,6,7) or monihaku_3 in (4,5,6,7) or monihaku_4 in (4,5,6,7) or monihaku_5 in (4,5,6,7) or monihaku_6 in (4,5,6,7)) and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (monihaku_2 in (4,5,6,7) or monihaku_3 in (4,5,6,7) or monihaku_4 in (4,5,6,7) or monihaku_5 in (4,5,6,7) or monihaku_6 in (4,5,6,7) or monihaku2010 in (4,5,6,7)) and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (monihaku_3 in (4,5,6,7) or monihaku_4 in (4,5,6,7) or monihaku_5 in (4,5,6,7) or monihaku_6 in (4,5,6,7) or monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7)) and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (monihaku_4 in (4,5,6,7) or monihaku_5 in (4,5,6,7) or monihaku_6 in (4,5,6,7) or monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7) or monihaku2012 in (4,5,6,7)) and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (monihaku_5 in (4,5,6,7) or monihaku_6 in (4,5,6,7) or monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7) or monihaku2012 in (4,5,6,7) or monihaku2013 in (4,5,6,7)) and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (monihaku_6 in (4,5,6,7) or monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7) or monihaku2012 in (4,5,6,7) or monihaku2013 in (4,5,6,7) or monihaku2014 in (4,5,6,7)) and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7) or monihaku2012 in (4,5,6,7) or monihaku2013 in (4,5,6,7) or monihaku2014 in (4,5,6,7) or monihaku2015 in (4,5,6,7)) and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' then 1*/
	else 0
end haku_kk_eiopisk_kk
----Hakenut korkea-asteelle, ei opiskellut korkea-asteella, ei-opiskellut toisen asteen koulutuksessa
,case
	when  l.suorlk = '2' and (monihaku_1 in (4,5,6,7) or monihaku_2 in (4,5,6,7) or monihaku_3 in (4,5,6,7) or monihaku_4 in (4,5,6,7) or monihaku_5 in (4,5,6,7) or monihaku_6 in (4,5,6,7)) and l.luopiskkoulk_1 = '' and l.ammopiskkoulk_1 = '' and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.luopiskkoulk_6 = '' and l.ammopiskkoulk_6 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (monihaku_2 in (4,5,6,7) or monihaku_3 in (4,5,6,7) or monihaku_4 in (4,5,6,7) or monihaku_5 in (4,5,6,7) or monihaku_6 in (4,5,6,7) or monihaku2010 in (4,5,6,7)) and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.luopiskkoulk_6 = '' and l.ammopiskkoulk_6 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (monihaku_3 in (4,5,6,7) or monihaku_4 in (4,5,6,7) or monihaku_5 in (4,5,6,7) or monihaku_6 in (4,5,6,7) or monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7)) and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.luopiskkoulk_6 = '' and l.ammopiskkoulk_6 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (monihaku_4 in (4,5,6,7) or monihaku_5 in (4,5,6,7) or monihaku_6 in (4,5,6,7) or monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7) or monihaku2012 in (4,5,6,7)) and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.luopiskkoulk_6 = '' and l.ammopiskkoulk_6 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (monihaku_5 in (4,5,6,7) or monihaku_6 in (4,5,6,7) or monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7) or monihaku2012 in (4,5,6,7) or monihaku2013 in (4,5,6,7)) and l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.luopiskkoulk_6 = '' and l.ammopiskkoulk_6 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (monihaku_6 in (4,5,6,7) or monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7) or monihaku2012 in (4,5,6,7) or monihaku2013 in (4,5,6,7) or monihaku2014 in (4,5,6,7)) and l.luopiskkoulk_6 = '' and l.ammopiskkoulk_6 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7) or monihaku2012 in (4,5,6,7) or monihaku2013 in (4,5,6,7) or monihaku2014 in (4,5,6,7) or monihaku2015 in (4,5,6,7)) and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' and l.luopiskkoulk2015 = '' and l.ammopiskkoulk2015 = '' and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' then 1*/
	else 0
end haku_kk_eiopisk_kk_eiopisk_ta
----Hakenut korkea-asteelle, ei opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa
,case
	when  l.suorlk = '2' and (monihaku_1 in (4,5,6,7) or monihaku_2 in (4,5,6,7) or monihaku_3 in (4,5,6,7) or monihaku_4 in (4,5,6,7) or monihaku_5 in (4,5,6,7) or monihaku_6 in (4,5,6,7)) and (l.luopiskkoulk_1 <> '' or l.ammopiskkoulk_1 <> '' or l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.ammopiskkoulk_5 <> '' or l.luopiskkoulk_6 <> '' or l.ammopiskkoulk_6 <> '') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (monihaku_2 in (4,5,6,7) or monihaku_3 in (4,5,6,7) or monihaku_4 in (4,5,6,7) or monihaku_5 in (4,5,6,7) or monihaku_6 in (4,5,6,7) or monihaku2010 in (4,5,6,7)) and (l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.ammopiskkoulk_5 <> '' or l.luopiskkoulk_6 <> '' or l.ammopiskkoulk_6 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (monihaku_3 in (4,5,6,7) or monihaku_4 in (4,5,6,7) or monihaku_5 in (4,5,6,7) or monihaku_6 in (4,5,6,7) or monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7)) and (l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.ammopiskkoulk_5 <> '' or l.luopiskkoulk_6 <> '' or l.ammopiskkoulk_6 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '') and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (monihaku_4 in (4,5,6,7) or monihaku_5 in (4,5,6,7) or monihaku_6 in (4,5,6,7) or monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7) or monihaku2012 in (4,5,6,7)) and (l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.ammopiskkoulk_5 <> '' or l.luopiskkoulk_6 <> '' or l.ammopiskkoulk_6 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '') and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (monihaku_5 in (4,5,6,7) or monihaku_6 in (4,5,6,7) or monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7) or monihaku2012 in (4,5,6,7) or monihaku2013 in (4,5,6,7)) and (l.luopiskkoulk_5 <> '' or l.ammopiskkoulk_5 <> '' or l.luopiskkoulk_6 <> '' or l.ammopiskkoulk_6 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '' or l.ammopiskkoulk2013 <> '') and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (monihaku_6 in (4,5,6,7) or monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7) or monihaku2012 in (4,5,6,7) or monihaku2013 in (4,5,6,7) or monihaku2014 in (4,5,6,7)) and (l.luopiskkoulk_6 <> '' or l.ammopiskkoulk_6 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '' or l.ammopiskkoulk2013 <> '' or l.luopiskkoulk2014 <> '' or l.ammopiskkoulk2014 <> '') and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7) or monihaku2012 in (4,5,6,7) or monihaku2013 in (4,5,6,7) or monihaku2014 in (4,5,6,7) or monihaku2015 in (4,5,6,7)) and (l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '' or l.ammopiskkoulk2013 <> '' or l.luopiskkoulk2014 <> '' or l.ammopiskkoulk2014 <> '' or l.luopiskkoulk2015 <> '' or l.ammopiskkoulk2015 <> '') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' then 1*/
	else 0
end haku_kk_eiopisk_kk_opisk_ta
----Hakenut vain ammattikorkeakouluun, ei opiskellut korkea-asteella
,case
	when  l.suorlk = '2' and (monihaku_1 = 4 or monihaku_2 = 4 or monihaku_3 = 4 or monihaku_4 = 4 or monihaku_5 = 4 or monihaku_6 = 4) and (monihaku_1 not in (5,6,7) and monihaku_2 not in (5,6,7) and monihaku_3 not in (5,6,7) and monihaku_4 not in (5,6,7) and monihaku_5 not in (5,6,7) and monihaku_6 not in (5,6,7)) and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (monihaku_2 = 4 or monihaku_3 = 4 or monihaku_4 = 4 or monihaku_5 = 4 or monihaku_6 = 4 or monihaku2010 = 4) and (monihaku_2 not in (5,6,7) and monihaku_3 not in (5,6,7) and monihaku_4 not in (5,6,7) and monihaku_5 not in (5,6,7) and monihaku_6 not in (5,6,7) and monihaku2010 not in (5,6,7)) and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (monihaku_3 = 4 or monihaku_4 = 4 or monihaku_5 = 4 or monihaku_6 = 4 or monihaku2010 = 4 or monihaku2011 = 4) and (monihaku_3 not in (5,6,7) and monihaku_4 not in (5,6,7) and monihaku_5 not in (5,6,7) and monihaku_6 not in (5,6,7) and monihaku2010 not in (5,6,7) and monihaku2011 not in (5,6,7)) and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (monihaku_4 = 4 or monihaku_5 = 4 or monihaku_6 = 4 or monihaku2010 = 4 or monihaku2011 = 4 or monihaku2012 = 4) and (monihaku_4 not in (5,6,7) and monihaku_5 not in (5,6,7) and monihaku_6 not in (5,6,7) and monihaku2010 not in (5,6,7) and monihaku2011 not in (5,6,7) and monihaku2012 not in (5,6,7)) and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (monihaku_5 = 4 or monihaku_6 = 4 or monihaku2010 = 4 or monihaku2011 = 4 or monihaku2012 = 4 or monihaku2013 = 4) and (monihaku_5 not in (5,6,7) and monihaku_6 not in (5,6,7) and monihaku2010 not in (5,6,7) and monihaku2011 not in (5,6,7) and monihaku2012 not in (5,6,7) and monihaku2013 not in (5,6,7)) and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (monihaku_6 = 4 or monihaku2010 = 4 or monihaku2011 = 4 or monihaku2012 = 4 or monihaku2013 = 4 or monihaku2014 = 4) and (monihaku_6 not in (5,6,7) and monihaku2010 not in (5,6,7) and monihaku2011 not in (5,6,7) and monihaku2012 not in (5,6,7) and monihaku2013 not in (5,6,7) and monihaku2014 not in (5,6,7)) and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (monihaku2010 = 4 or monihaku2011 = 4 or monihaku2012 = 4 or monihaku2013 = 4 or monihaku2014 = 4 or monihaku2015 = 4) and (monihaku2010 not in (5,6,7) and monihaku2011 not in (5,6,7) and monihaku2012 not in (5,6,7) and monihaku2013 not in (5,6,7) and monihaku2014 not in (5,6,7) and monihaku2015 not in (5,6,7)) and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' then 1*/
	else 0
end haku_amk_eiopisk_kk
----Hakenut vain yliopistokoulutukseen, ei opiskellut korkea-asteella
,case
	when  l.suorlk = '2' and (monihaku_1 = 7 or monihaku_2 = 7 or monihaku_3 = 7 or monihaku_4 = 7 or monihaku_5 = 7 or monihaku_6 = 7) and (monihaku_1 not in (4,5,6) and monihaku_2 not in (4,5,6) and monihaku_3 not in (4,5,6) and monihaku_4 not in (4,5,6) and monihaku_5 not in (4,5,6) and monihaku_6 not in (4,5,6)) and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (monihaku_2 = 7 or monihaku_3 = 7 or monihaku_4 = 7 or monihaku_5 = 7 or monihaku_6 = 7 or monihaku2010 = 7) and (monihaku_2 not in (4,5,6) and monihaku_3 not in (4,5,6) and monihaku_4 not in (4,5,6) and monihaku_5 not in (4,5,6) and monihaku_6 not in (4,5,6) and monihaku2010 not in (4,5,6)) and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (monihaku_3 = 7 or monihaku_4 = 7 or monihaku_5 = 7 or monihaku_6 = 7 or monihaku2010 = 7 or monihaku2011 = 7) and (monihaku_3 not in (4,5,6) and monihaku_4 not in (4,5,6) and monihaku_5 not in (4,5,6) and monihaku_6 not in (4,5,6) and monihaku2010 not in (4,5,6) and monihaku2011 not in (4,5,6)) and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (monihaku_4 = 7 or monihaku_5 = 7 or monihaku_6 = 7 or monihaku2010 = 7 or monihaku2011 = 7 or monihaku2012 = 7) and (monihaku_4 not in (4,5,6) and monihaku_5 not in (4,5,6) and monihaku_6 not in (4,5,6) and monihaku2010 not in (4,5,6) and monihaku2011 not in (4,5,6) and monihaku2012 not in (4,5,6)) and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (monihaku_5 = 7 or monihaku_6 = 7 or monihaku2010 = 7 or monihaku2011 = 7 or monihaku2012 = 7 or monihaku2013 = 7) and (monihaku_5 not in (4,5,6) and monihaku_6 not in (4,5,6) and monihaku2010 not in (4,5,6) and monihaku2011 not in (4,5,6) and monihaku2012 not in (4,5,6) and monihaku2013 not in (4,5,6)) and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (monihaku_6 = 7 or monihaku2010 = 7 or monihaku2011 = 7 or monihaku2012 = 7 or monihaku2013 = 7 or monihaku2014 = 7) and (monihaku_6 not in (4,5,6) and monihaku2010 not in (4,5,6) and monihaku2011 not in (4,5,6) and monihaku2012 not in (4,5,6) and monihaku2013 not in (4,5,6) and monihaku2014 not in (4,5,6)) and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (monihaku2010 = 7 or monihaku2011 = 7 or monihaku2012 = 7 or monihaku2013 = 7 or monihaku2014 = 7 or monihaku2015 = 7) and (monihaku2010 not in (4,5,6) and monihaku2011 not in (4,5,6) and monihaku2012 not in (4,5,6) and monihaku2013 not in (4,5,6) and monihaku2014 not in (4,5,6) and monihaku2015 not in (4,5,6)) and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' then 1*/
	else 0
end haku_yo_eiopisk_kk
----Hakenut sekä amk- että yliopistokoulutukseen, ei opiskellut korkea-asteella
,case
	when  l.suorlk = '2' and (monihaku_1 = 6 or monihaku_2 = 6 or monihaku_3 = 6 or monihaku_4 = 6 or monihaku_5 = 6 or monihaku_6 = 6 or ((monihaku_1 = 4 or monihaku_2 = 4 or monihaku_3 = 4 or monihaku_4 = 4 or monihaku_5 = 4 or monihaku_6 = 4) and (monihaku_1 = 7 or monihaku_2 = 7 or monihaku_3 = 7 or monihaku_4 = 7 or monihaku_5 = 7 or monihaku_6 = 7))) and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (monihaku_2 = 6 or monihaku_3 = 6 or monihaku_4 = 6 or monihaku_5 = 6 or monihaku_6 = 6 or monihaku2010 = 6 or ((monihaku_2 = 4 or monihaku_3 = 4 or monihaku_4 = 4 or monihaku_5 = 4 or monihaku_6 = 4 or monihaku2010 = 4) and (monihaku_2 = 7 or monihaku_3 = 7 or monihaku_4 = 7 or monihaku_5 = 7 or monihaku_6 = 7 or monihaku2010 = 7))) and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (monihaku_3 = 6 or monihaku_4 = 6 or monihaku_5 = 6 or monihaku_6 = 6 or monihaku2010 = 6 or monihaku2011 = 6 or ((monihaku_3 = 4 or monihaku_4 = 4 or monihaku_5 = 4 or monihaku_6 = 4 or monihaku2010 = 4 or monihaku2011 = 4) and (monihaku_3 = 7 or monihaku_4 = 7 or monihaku_5 = 7 or monihaku_6 = 7 or monihaku2010 = 7 or monihaku2011 = 7))) and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (monihaku_4 = 6 or monihaku_5 = 6 or monihaku_6 = 6 or monihaku2010 = 6 or monihaku2011 = 6 or monihaku2012 = 6 or ((monihaku_4 = 4 or monihaku_5 = 4 or monihaku_6 = 4 or monihaku2010 = 4 or monihaku2011 = 4 or monihaku2012 = 4) and (monihaku_4 = 7 or monihaku_5 = 7 or monihaku_6 = 7 or monihaku2010 = 7 or monihaku2011 = 7 or monihaku2012 = 7))) and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (monihaku_5 = 6 or monihaku_6 = 6 or monihaku2010 = 6 or monihaku2011 = 6 or monihaku2012 = 6 or monihaku2013 = 6 or ((monihaku_5 = 4 or monihaku_6 = 4 or monihaku2010 = 4 or monihaku2011 = 4 or monihaku2012 = 4 or monihaku2013 = 4) and (monihaku_5 = 7 or monihaku_6 = 7 or monihaku2010 = 7 or monihaku2011 = 7 or monihaku2012 = 7 or monihaku2013 = 7))) and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (monihaku_6 = 6 or monihaku2010 = 6 or monihaku2011 = 6 or monihaku2012 = 6 or monihaku2013 = 6 or monihaku2014 = 6 or ((monihaku_6 = 4 or monihaku2010 = 4 or monihaku2011 = 4 or monihaku2012 = 4 or monihaku2013 = 4 or monihaku2014 = 4) and (monihaku_6 = 7 or monihaku2010 = 7 or monihaku2011 = 7 or monihaku2012 = 7 or monihaku2013 = 7 or monihaku2014 = 7))) and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (monihaku2010 = 6 or monihaku2011 = 6 or monihaku2012 = 6 or monihaku2013 = 6 or monihaku2014 = 6 or monihaku2015 = 6 or ((monihaku2010 = 4 or monihaku2011 = 4 or monihaku2012 = 4 or monihaku2013 = 4 or monihaku2014 = 4 or monihaku2015 = 4) and (monihaku2010 = 7 or monihaku2011 = 7 or monihaku2012 = 7 or monihaku2013 = 7 or monihaku2014 = 7 or monihaku2015 = 7))) and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' then 1*/
	else 0
end haku_amkyo_eiopisk_kk

--Opiskellut korkea-asteella
,case
	when  l.suorlk = '2' and (l.amkopiskkoulk_1 <> '' or l.yoopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.yoopiskkoulk_5 <> '' or l.amkopiskkoulk_6 <> '' or l.yoopiskkoulk_6 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.yoopiskkoulk_5 <> '' or l.amkopiskkoulk_6 <> '' or l.yoopiskkoulk_6 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.yoopiskkoulk_5 <> '' or l.amkopiskkoulk_6 <> '' or l.yoopiskkoulk_6 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.yoopiskkoulk_5 <> '' or l.amkopiskkoulk_6 <> '' or l.yoopiskkoulk_6 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk_5 <> '' or l.yoopiskkoulk_5 <> '' or l.amkopiskkoulk_6 <> '' or l.yoopiskkoulk_6 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '' or l.yoopiskkoulk2013 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk_6 <> '' or l.yoopiskkoulk_6 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '' or l.yoopiskkoulk2013 <> '' or l.amkopiskkoulk2014 <> '' or l.yoopiskkoulk2014 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '' or l.yoopiskkoulk2013 <> '' or l.amkopiskkoulk2014 <> '' or l.yoopiskkoulk2014 <> '' or l.amkopiskkoulk2015 <> '' or l.yoopiskkoulk2015 <> '') then 1*/
	else 0
end opisk_kk
----Opiskellut korkea-asteella, ei-opiskellut toisen asteen koulutuksessa
,case
	when  l.suorlk = '2' and l.luopiskkoulk_1 = '' and l.ammopiskkoulk_1 = '' and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = '' and l.luopiskkoulk_6 = '' and l.ammopiskkoulk_6 = '' and (l.amkopiskkoulk_1 <> '' or l.yoopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.yoopiskkoulk_5 <> '' or l.amkopiskkoulk_6 <> '' or l.yoopiskkoulk_6 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = '' and l.luopiskkoulk_6 = '' and l.ammopiskkoulk_6 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and (l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.yoopiskkoulk_5 <> '' or l.amkopiskkoulk_6 <> '' or l.yoopiskkoulk_6 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = '' and l.luopiskkoulk_6 = '' and l.ammopiskkoulk_6 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and (l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.yoopiskkoulk_5 <> '' or l.amkopiskkoulk_6 <> '' or l.yoopiskkoulk_6 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = '' and l.luopiskkoulk_6 = '' and l.ammopiskkoulk_6 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and (l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.yoopiskkoulk_5 <> '' or l.amkopiskkoulk_6 <> '' or l.yoopiskkoulk_6 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = '' and l.luopiskkoulk_6 = '' and l.ammopiskkoulk_6 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = '' and (l.amkopiskkoulk_5 <> '' or l.yoopiskkoulk_5 <> '' or l.amkopiskkoulk_6 <> '' or l.yoopiskkoulk_6 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '' or l.yoopiskkoulk2013 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and l.luopiskkoulk_6 = '' and l.ammopiskkoulk_6 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = '' and l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 = '' and (l.amkopiskkoulk_6 <> '' or l.yoopiskkoulk_6 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '' or l.yoopiskkoulk2013 <> '' or l.amkopiskkoulk2014 <> '' or l.yoopiskkoulk2014 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = '' and l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 = '' and l.luopiskkoulk2015 = '' and l.ammopiskkoulk2015 = '' and (l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '' or l.yoopiskkoulk2013 <> '' or l.amkopiskkoulk2014 <> '' or l.yoopiskkoulk2014 <> '' or l.amkopiskkoulk2015 <> '' or l.yoopiskkoulk2015 <> '') then 1*/
	else 0
end opisk_kk_eiopisk_ta
----Opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa
,case
	when  l.suorlk = '2' and (l.luopiskkoulk_1 <> '' or l.ammopiskkoulk_1 <> '' or l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.ammopiskkoulk_5 <> '' or l.luopiskkoulk_6 <> '' or l.ammopiskkoulk_6 <> '') and (l.amkopiskkoulk_1 <> '' or l.yoopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.yoopiskkoulk_5 <> '' or l.amkopiskkoulk_6 <> '' or l.yoopiskkoulk_6 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.ammopiskkoulk_5 <> '' or l.luopiskkoulk_6 <> '' or l.ammopiskkoulk_6 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '') and (l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.yoopiskkoulk_5 <> '' or l.amkopiskkoulk_6 <> '' or l.yoopiskkoulk_6 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.ammopiskkoulk_5 <> '' or l.luopiskkoulk_6 <> '' or l.ammopiskkoulk_6 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '') and (l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.yoopiskkoulk_5 <> '' or l.amkopiskkoulk_6 <> '' or l.yoopiskkoulk_6 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.ammopiskkoulk_5 <> '' or l.luopiskkoulk_6 <> '' or l.ammopiskkoulk_6 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '') and (l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.yoopiskkoulk_5 <> '' or l.amkopiskkoulk_6 <> '' or l.yoopiskkoulk_6 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk_5 <> '' or l.ammopiskkoulk_5 <> '' or l.luopiskkoulk_6 <> '' or l.ammopiskkoulk_6 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '' or l.ammopiskkoulk2013 <> '') and (l.amkopiskkoulk_5 <> '' or l.yoopiskkoulk_5 <> '' or l.amkopiskkoulk_6 <> '' or l.yoopiskkoulk_6 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '' or l.yoopiskkoulk2013 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk_6 <> '' or l.ammopiskkoulk_6 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '' or l.ammopiskkoulk2013 <> '' or l.luopiskkoulk2014 <> '' or l.ammopiskkoulk2014 <> '') and (l.amkopiskkoulk_6 <> '' or l.yoopiskkoulk_6 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '' or l.yoopiskkoulk2013 <> '' or l.amkopiskkoulk2014 <> '' or l.yoopiskkoulk2014 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '' or l.ammopiskkoulk2013 <> '' or l.luopiskkoulk2014 <> '' or l.ammopiskkoulk2014 <> '' or l.luopiskkoulk2015 <> '' or l.ammopiskkoulk2015 <> '') and (l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '' or l.yoopiskkoulk2013 <> '' or l.amkopiskkoulk2014 <> '' or l.yoopiskkoulk2014 <> '' or l.amkopiskkoulk2015 <> '' or l.yoopiskkoulk2015 <> '') then 1*/
	else 0
end opisk_kk_opisk_ta
----Opiskellut vain ammattikorkeakoulussa
,case
	when  l.suorlk = '2' and (l.amkopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.amkopiskkoulk_6 <> '') and l.yoopiskkoulk_1 = '' and l.yoopiskkoulk_2 = '' and l.yoopiskkoulk_3 = '' and l.yoopiskkoulk_4 = '' and l.yoopiskkoulk_5 = '' and l.yoopiskkoulk_6 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.amkopiskkoulk_6 <> '' or l.amkopiskkoulk2010 <> '') and l.yoopiskkoulk_2 = '' and l.yoopiskkoulk_3 = '' and l.yoopiskkoulk_4 = '' and l.yoopiskkoulk_5 = '' and l.yoopiskkoulk_6 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.amkopiskkoulk_6 <> '' or l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '') and l.yoopiskkoulk_3 = '' and l.yoopiskkoulk_4 = '' and l.yoopiskkoulk_5 = '' and l.yoopiskkoulk_6 = '' and l.yoopiskkoulk2010 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.amkopiskkoulk_6 <> '' or l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '') and l.yoopiskkoulk_4 = '' and l.yoopiskkoulk_5 = '' and l.yoopiskkoulk_6 = '' and l.yoopiskkoulk2010 = '' and l.yoopiskkoulk2011 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk_5 <> '' or l.amkopiskkoulk_6 <> '' or l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '') and l.yoopiskkoulk_5 = '' and l.yoopiskkoulk_6 = '' and l.yoopiskkoulk2010 = '' and l.yoopiskkoulk2011 = '' and l.yoopiskkoulk2012 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk_6 <> '' or l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '' or l.amkopiskkoulk2014 <> '') and l.yoopiskkoulk_6 = '' and l.yoopiskkoulk2010 = '' and l.yoopiskkoulk2011 = '' and l.yoopiskkoulk2012 = '' and l.yoopiskkoulk2013 = '' and l.yoopiskkoulk2014 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '' or l.amkopiskkoulk2014 <> '' or l.amkopiskkoulk2015 <> '') and l.yoopiskkoulk2010 = '' and l.yoopiskkoulk2011 = '' and l.yoopiskkoulk2012 = '' and l.yoopiskkoulk2013 = '' and l.yoopiskkoulk2014 = '' and l.yoopiskkoulk2015 = '' then 1*/
	else 0
end opisk_vain_amk
----Opiskellut vain yliopistokoulutuksessa
,case
	when  l.suorlk = '2' and l.amkopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and (l.yoopiskkoulk_1 <> '' or l.yoopiskkoulk_2 <> '' or l.yoopiskkoulk_3 <> '' or l.yoopiskkoulk_4 <> '' or l.yoopiskkoulk_5 <> '' or l.yoopiskkoulk_6 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and l.amkopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and (l.yoopiskkoulk_2 <> '' or l.yoopiskkoulk_3 <> '' or l.yoopiskkoulk_4 <> '' or l.yoopiskkoulk_5 <> '' or l.yoopiskkoulk_6 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and l.amkopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and (l.yoopiskkoulk_3 <> '' or l.yoopiskkoulk_4 <> '' or l.yoopiskkoulk_5 <> '' or l.yoopiskkoulk_6 <> '' or l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and l.amkopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and (l.yoopiskkoulk_4 <> '' or l.yoopiskkoulk_5 <> '' or l.yoopiskkoulk_6 <> '' or l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '' or l.yoopiskkoulk2012 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and l.amkopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and (l.yoopiskkoulk_5 <> '' or l.yoopiskkoulk_6 <> '' or l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '' or l.yoopiskkoulk2012 <> '' or l.yoopiskkoulk2013 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and l.amkopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and (l.yoopiskkoulk_6 <> '' or l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '' or l.yoopiskkoulk2012 <> '' or l.yoopiskkoulk2013 <> '' or l.yoopiskkoulk2014 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and l.amkopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.amkopiskkoulk2015 = '' and (l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '' or l.yoopiskkoulk2012 <> '' or l.yoopiskkoulk2013 <> '' or l.yoopiskkoulk2014 <> '' or l.yoopiskkoulk2015 <> '') then 1*/
	else 0
end opisk_vain_yo
----Opiskellut sekä amk- että yliopistokoulutuksessa
,case
	when  l.suorlk = '2' and (l.amkopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.amkopiskkoulk_6 <> '') and (l.yoopiskkoulk_1 <> '' or l.yoopiskkoulk_2 <> '' or l.yoopiskkoulk_3 <> '' or l.yoopiskkoulk_4 <> '' or l.yoopiskkoulk_5 <> '' or l.yoopiskkoulk_6 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.amkopiskkoulk_6 <> '' or l.amkopiskkoulk2010 <> '') and (l.yoopiskkoulk_2 <> '' or l.yoopiskkoulk_3 <> '' or l.yoopiskkoulk_4 <> '' or l.yoopiskkoulk_5 <> '' or l.yoopiskkoulk_6 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.amkopiskkoulk_6 <> '' or l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '') and (l.yoopiskkoulk_3 <> '' or l.yoopiskkoulk_4 <> '' or l.yoopiskkoulk_5 <> '' or l.yoopiskkoulk_6 <> '' or l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.amkopiskkoulk_6 <> '' or l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '') and (l.yoopiskkoulk_4 <> '' or l.yoopiskkoulk_5 <> '' or l.yoopiskkoulk_6 <> '' or l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '' or l.yoopiskkoulk2012 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk_5 <> '' or l.amkopiskkoulk_6 <> '' or l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '') and (l.yoopiskkoulk_5 <> '' or l.yoopiskkoulk_6 <> '' or l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '' or l.yoopiskkoulk2012 <> '' or l.yoopiskkoulk2013 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk_6 <> '' or l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '' or l.amkopiskkoulk2014 <> '') and (l.yoopiskkoulk_6 <> '' or l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '' or l.yoopiskkoulk2012 <> '' or l.yoopiskkoulk2013 <> '' or l.yoopiskkoulk2014 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '2' and (l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '' or l.amkopiskkoulk2014 <> '' or l.amkopiskkoulk2015 <> '') and (l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '' or l.yoopiskkoulk2012 <> '' or l.yoopiskkoulk2013 <> '' or l.yoopiskkoulk2014 <> '' or l.yoopiskkoulk2015 <> '') then 1*/
	else 0
end opisk_amkyo

FROM 
    (
	select * from [VipunenTK_SA].[dbo].[v_K3_13_Perusk_paattaneet_amm_tutk_suorittaneet]
	where suorlk = '2'
	
	) as l

LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d1a on d1a.koulutusluokitus_avain=l.amkopiskkoulk_1
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d2a on d2a.koulutusluokitus_avain=l.amkopiskkoulk_2
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d3a on d3a.koulutusluokitus_avain=l.amkopiskkoulk_3
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d4a on d4a.koulutusluokitus_avain=l.amkopiskkoulk_4
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d5a on d5a.koulutusluokitus_avain=l.amkopiskkoulk_5
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d6a on d6a.koulutusluokitus_avain=l.amkopiskkoulk_6
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d7a on d7a.koulutusluokitus_avain=l.amkopiskkoulk_6
/*LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d8a on d8a.koulutusluokitus_avain=l.amkopiskkoulk2011
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d9a on d9a.koulutusluokitus_avain=l.amkopiskkoulk2012
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d10a on d10a.koulutusluokitus_avain=l.amkopiskkoulk2013
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d11a on d11a.koulutusluokitus_avain=l.amkopiskkoulk2014
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d12a on d12a.koulutusluokitus_avain=l.amkopiskkoulk2015*/

LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d1b on d1b.koulutusluokitus_avain=l.yoopiskkoulk_1
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d2b on d2b.koulutusluokitus_avain=l.yoopiskkoulk_2
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d3b on d3b.koulutusluokitus_avain=l.yoopiskkoulk_3
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d4b on d4b.koulutusluokitus_avain=l.yoopiskkoulk_4
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d5b on d5b.koulutusluokitus_avain=l.yoopiskkoulk_5
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d6b on d6b.koulutusluokitus_avain=l.yoopiskkoulk_6
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d7b on d7b.koulutusluokitus_avain=l.yoopiskkoulk_6
/*LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d8b on d8b.koulutusluokitus_avain=l.yoopiskkoulk2011	
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d9b on d9b.koulutusluokitus_avain=l.yoopiskkoulk2012
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d10b on d10b.koulutusluokitus_avain=l.yoopiskkoulk2013
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d11b on d11b.koulutusluokitus_avain=l.yoopiskkoulk2014	
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d12b on d12b.koulutusluokitus_avain=l.yoopiskkoulk2015	*/

LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d1c on d1c.koulutusluokitus_avain=l.ammopiskkoulk_1
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d2c on d2c.koulutusluokitus_avain=l.ammopiskkoulk_2
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d3c on d3c.koulutusluokitus_avain=l.ammopiskkoulk_3
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d4c on d4c.koulutusluokitus_avain=l.ammopiskkoulk_4
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d5c on d5c.koulutusluokitus_avain=l.ammopiskkoulk_5
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d6c on d6c.koulutusluokitus_avain=l.ammopiskkoulk_6
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d7c on d7c.koulutusluokitus_avain=l.ammopiskkoulk_6
/*LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d8c on d8c.koulutusluokitus_avain=l.ammopiskkoulk2011
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d9c on d9c.koulutusluokitus_avain=l.ammopiskkoulk2012
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d10c on d10c.koulutusluokitus_avain=l.ammopiskkoulk2013
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d11c on d11c.koulutusluokitus_avain=l.ammopiskkoulk2014
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d12c on d12c.koulutusluokitus_avain=l.ammopiskkoulk2015*/

CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d1a.iscfibroad2013_koodi),(d1b.iscfibroad2013_koodi), (d2a.iscfibroad2013_koodi),(d2b.iscfibroad2013_koodi), (d3a.iscfibroad2013_koodi),(d3b.iscfibroad2013_koodi), (d4a.iscfibroad2013_koodi),(d4b.iscfibroad2013_koodi), (d5a.iscfibroad2013_koodi),(d5b.iscfibroad2013_koodi), (d6a.iscfibroad2013_koodi),(d6b.iscfibroad2013_koodi)) AS a(d)) m1
CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d2a.iscfibroad2013_koodi),(d2b.iscfibroad2013_koodi), (d3a.iscfibroad2013_koodi),(d3b.iscfibroad2013_koodi), (d4a.iscfibroad2013_koodi),(d4b.iscfibroad2013_koodi), (d5a.iscfibroad2013_koodi),(d5b.iscfibroad2013_koodi), (d6a.iscfibroad2013_koodi),(d6b.iscfibroad2013_koodi), (d7a.iscfibroad2013_koodi),(d7b.iscfibroad2013_koodi)) AS a(d)) m2
/*CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d3a.iscfibroad2013_koodi),(d3b.iscfibroad2013_koodi), (d4a.iscfibroad2013_koodi),(d4b.iscfibroad2013_koodi), (d5a.iscfibroad2013_koodi),(d5b.iscfibroad2013_koodi), (d6a.iscfibroad2013_koodi),(d6b.iscfibroad2013_koodi), (d7a.iscfibroad2013_koodi),(d7b.iscfibroad2013_koodi), (d8a.iscfibroad2013_koodi),(d8b.iscfibroad2013_koodi)) AS a(d)) m3
CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d4a.iscfibroad2013_koodi),(d4b.iscfibroad2013_koodi), (d5a.iscfibroad2013_koodi),(d5b.iscfibroad2013_koodi), (d6a.iscfibroad2013_koodi),(d6b.iscfibroad2013_koodi), (d7a.iscfibroad2013_koodi),(d7b.iscfibroad2013_koodi), (d8a.iscfibroad2013_koodi),(d8b.iscfibroad2013_koodi), (d9a.iscfibroad2013_koodi),(d9b.iscfibroad2013_koodi)) AS a(d)) m4
CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d5a.iscfibroad2013_koodi),(d5b.iscfibroad2013_koodi), (d6a.iscfibroad2013_koodi),(d6b.iscfibroad2013_koodi), (d7a.iscfibroad2013_koodi),(d7b.iscfibroad2013_koodi), (d8a.iscfibroad2013_koodi),(d8b.iscfibroad2013_koodi), (d9a.iscfibroad2013_koodi),(d9b.iscfibroad2013_koodi), (d10a.iscfibroad2013_koodi),(d10b.iscfibroad2013_koodi)) AS a(d)) m5
CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d6a.iscfibroad2013_koodi),(d6b.iscfibroad2013_koodi), (d7a.iscfibroad2013_koodi),(d7b.iscfibroad2013_koodi), (d8a.iscfibroad2013_koodi),(d8b.iscfibroad2013_koodi), (d9a.iscfibroad2013_koodi),(d9b.iscfibroad2013_koodi), (d10a.iscfibroad2013_koodi),(d10b.iscfibroad2013_koodi), (d11a.iscfibroad2013_koodi),(d11b.iscfibroad2013_koodi)) AS a(d)) m6
CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d7a.iscfibroad2013_koodi),(d7b.iscfibroad2013_koodi), (d8a.iscfibroad2013_koodi),(d8b.iscfibroad2013_koodi), (d9a.iscfibroad2013_koodi),(d9b.iscfibroad2013_koodi), (d10a.iscfibroad2013_koodi),(d10b.iscfibroad2013_koodi), (d11a.iscfibroad2013_koodi),(d11b.iscfibroad2013_koodi), (d12a.iscfibroad2013_koodi),(d12b.iscfibroad2013_koodi)) AS a(d)) m7*/

	
	WHERE 1=1
--end;

--
-- TULOS
-- 
/*
if @debug_what_to_run>=3 begin
	if @debug_what_to_run>0 print 'querying result';
	select * from [VipunenTK_DW].[dbo].[_koulutukseen_sijoittuneet_6v]
	--select COUNT(*) from vipunen_tk.f_tyol_ja_jatko_opin_ where aineisto=(select id from vipunen_tk.d_aineisto where aineistokoodi='4.3' and @toinen_suoritusvuosi between alkaa and paattyy)
end;

if @debug_what_to_run>0 PRINT 'all done.';
*/


GO
/****** Object:  StoredProcedure [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_5_0_tarkastelujakso]    Script Date: 29.8.2018 15:59:41 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE PROCEDURE [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_5_0_tarkastelujakso] AS
/*declare @debug_what_to_run tinyint; set @debug_what_to_run=2; -- käytä arvoa 3 vain kun teet yhden vuoden
print '$'+convert(varchar,sysdatetime(),20)+'$ '+'DEBUG (what to run)='+cast(@debug_what_to_run as varchar)+
': 0=luo vain taulut, älä tulosta mitään; 1=luo taulut ja tulosta joitakin merkittävimpiä välivaiheita; 2=luo taulut ja tulosta välivaiheet; 3=luo taulut, tulosta välivaiheet ja tulosta myös tulokset, 4=tulosta välivaiheet, mutta älä tee mitään';




-- lisätään data
if @debug_what_to_run not in (4) begin
if @debug_what_to_run>0 print 'inserting data';

-- parametrimuuttujien arvot
-- parametrimuuttujat
DECLARE @ensimmainen_suoritusvuosi int;
DECLARE @toinen_suoritusvuosi int;
DECLARE @kolmas_suoritusvuosi int;
DECLARE @neljas_suoritusvuosi int;
DECLARE @viides_suoritusvuosi int;
DECLARE @kuudes_suoritusvuosi int;
DECLARE @seitsemas_suoritusvuosi int;


set @ensimmainen_suoritusvuosi = _6;
set @toinen_suoritusvuosi = 2005;
set @kolmas_suoritusvuosi = 2006;
set @neljas_suoritusvuosi = 2007;
set @viides_suoritusvuosi = 2008;
set @kuudes_suoritusvuosi = 2009;
set @seitsemas_suoritusvuosi = 2010;

*/

INSERT INTO [VipunenTK_DW].[dbo].[_koulutukseen_sijoittuneet_6v_tarkastelu]
(
rivinumero
, tarkastelujakso
, tilv 
, tilv_date
, tutkryh 
, suorv
, suorlk 
, sp 
, syntv
, aikielir1 
, tutkkaskun 
, kansalr1
, pohjmaa 
, eumaa 
, etamaa 
, tunn
, jarj
, kkielir1 
, tutklaja 
, tutktav 
, aikoul 
, tutkmaak
, koulutus_1
, oppilaitos_1
, koulutuksen_jarjestaja_1
, koulutuksen_maakunta_1
, koulutus_2
, oppilaitos_2
, koulutuksen_jarjestaja_2
, koulutuksen_maakunta_2
, monihaku
, paaasiallinen_toiminta
, ammattiasema
, lkm
, pohjkoulk
, tietolahde
, aineisto
, lukiokoulutuksessa
, ammatillisessa_koulutuksessa
, ammattikorkeakoulutuksessa
, yliopistokoulutuksessa
, lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa
, toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa
, ammattikorkeakoulutuksessa_ja_yliopistokoulutuksessa
, koulutuksen_paattaneiden_toiminta
, ika_1v
, ika_5v
, ika_1v_suorv
, opisk_lu
, opisk_amm_pk
, opisk_amm_at
, opisk_amm_eat
, opisk_amm
, opisk_amk
, opisk_yo
, opisk_amk_koulala1
, opisk_amk_koulala2
, opisk_amk_koulala3
, opisk_amk_koulala4
, opisk_amk_koulala5
, opisk_amk_koulala6
, opisk_amk_koulala7
, opisk_amk_koulala8
, opisk_amk_koulala9
, opisk_amk_koulala10
, opisk_yo_koulala1
, opisk_yo_koulala2
, opisk_yo_koulala3
, opisk_yo_koulala4
, opisk_yo_koulala5
, opisk_yo_koulala6
, opisk_yo_koulala7
, opisk_yo_koulala8
, opisk_yo_koulala9
, opisk_yo_koulala10
, opisk_vah2_koulala
, haku_amm
, haku_amk
, haku_yo
, eihaku_kk_eiopisk
, eihaku_kk_eiopisk_kk_opisk_ta
, eihaku_kk_eiopisk_kk_opisk_lu
, eihaku_kk_eiopisk_kk_opisk_pk
, eihaku_kk_eiopisk_kk_opisk_at
, eihaku_kk_eiopisk_kk_opisk_eat
, haku_kk_eiopisk_kk
, haku_kk_eiopisk_kk_eiopisk_ta
, haku_kk_eiopisk_kk_opisk_ta
, haku_amk_eiopisk_kk
, haku_yo_eiopisk_kk
, haku_amkyo_eiopisk_kk
, opisk_kk
, opisk_kk_eiopisk_ta
, opisk_kk_opisk_ta
, opisk_vain_amk
, opisk_vain_yo
, opisk_amkyo
)
SELECT
 l.rivinumero,
 '5',
 l.tilv,
 l.tilv_date,
 (case 
	when l.tutkryh=3 and tutklaja=1 then 31
	when l.tutkryh=3 and tutklaja=2 then 32
	when l.tutkryh=3 and tutklaja=3 then 33
	else l.tutkryh
  end),
 l.suorv,
  (case
	when l.suorlk = '1'  then (l.suorv+'0'+l.suorlk)
	when l.suorlk = '2'  then (l.suorv+'0'+'8')
	else ''
	end),
 l.sp,
 l.syntv,
 l.aikielir1,
 l.tutkaskun,
 l.kansalr1,
 l.pohjmaa,
 l.eumaa,
 l.etamaa,
 l.tunn,
 l.jarj,
 l.kkielir1,
 l.tutklaja,
 l.tutktav,
 l.aikoul,
 l.tutkmaak,
 -- Koulutus 1
 (case
    --lukiokoulutuksessa _6
	when l.suorlk = '1' and l.luopiskkoulk_6 <> '' and l.ammopiskkoulk_6 = '' and
	l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' then l.luopiskkoulk_6 
	-- ammattikoulutuksessa _6
	when l.suorlk = '1' and l.luopiskkoulk_6 = '' and l.ammopiskkoulk_6 <> '' and
	l.amkopiskkoulk_6 ='' and l.yoopiskkoulk_6 = ''  then l.ammopiskkoulk_6 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen _6 ensim. koulutustietoihin
	when l.suorlk = '1' and l.luopiskkoulk_6 <> '' and l.ammopiskkoulk_6 <> '' and
	l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' then l.luopiskkoulk_6
	-- ammattikorkeakoulutuksessa _6
	when l.suorlk = '1' and l.amkopiskkoulk_6  <> '' and l.yoopiskkoulk_6  = '' and
	l.luopiskkoulk_6 = '' and l.ammopiskkoulk_6 = '' then l.amkopiskkoulk_6
	-- yliopistokoulutuksessa _6
	when l.suorlk = '1' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 <> '' and 
	l.luopiskkoulk_6 = '' and l.ammopiskkoulk_6 = ''   then l.yoopiskkoulk_6
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa, merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorlk = '1' and l.amkopiskkoulk_6 <> '' and l.yoopiskkoulk_6  <> '' and
	l.luopiskkoulk_6 = '' and ammopiskkoulk_6 = ''  then l.amkopiskkoulk_6 
	
	else ''

	
	    
	    end),
	    
-- Oppilaitos 1
	(case
	-- lukiokoulutuksen oppilaitos _6
	when l.suorlk = '1' and l.luopisktunn_6 <> '' and l.ammopisktunn_6 = '' and
	l.amkopisktunn_6 = '' and l.yoopisktunn_6 = '' then l.luopisktunn_6 
	-- ammattikoulutuksen oppilaitos _6
	when l.suorlk = '1' and l.luopisktunn_6 = '' and l.ammopisktunn_6 <> '' and
	l.amkopisktunn_6 ='' and l.yoopisktunn_6 = ''  then l.ammopisktunn_6 
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos _6
	when l.suorlk = '1' and l.luopisktunn_6 <> '' and l.ammopisktunn_6 <> '' and
	l.amkopisktunn_6 = '' and l.yoopisktunn_6 = '' then l.luopisktunn_6
	-- ammattikorkeakoulutuksen oppilaitos _6
	when l.suorlk = '1' and l.amkopisktunn_6  <> '' and l.yoopisktunn_6  = '' and
	l.luopisktunn_6 = '' and l.ammopisktunn_6 = '' then l.amkopisktunn_6
	-- yliopistokoulutuksen oppilaitos _6
	when l.suorlk = '1' and l.amkopisktunn_6 = '' and l.yoopisktunn_6 <> '' and 
	l.luopisktunn_6 = '' and l.ammopisktunn_6 = ''   then l.yoopisktunn_6
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus _6  
	when l.suorlk = '1' and l.amkopisktunn_6 <> '' and l.yoopisktunn_6  <> '' and
	l.luopisktunn_6 = '' and l.ammopisktunn_6 = ''  then l.amkopisktunn_6 
	
	
	

	
	else ''
	
	    end),
  --Koulutuksen järjestäjä 1
	(case
	-- lukikoulutuksen järjestäjä _6
	when l.suorlk = '1' and l.luopiskjarj_6  <> '' and l.ammopiskjarj_6 = '' and
	l.amkopiskjarj_6 = '' and yoopiskjarj_6 = '' then l.luopiskjarj_6
	-- ammatillisen koulutuksen järjestäjä _6  
	when l.suorlk = '1' and l.luopiskjarj_6 = '' and l.ammopiskjarj_6 <> '' and
	l.amkopiskjarj_6 ='' and l.yoopiskjarj_6 = ''  then l.ammopiskjarj_6
	-- lukio- ja ammatillisen koulutuksen järjestäjä, merkitään lukiokoulutuksen _6 järjestäjä 
	when l.suorlk = '1' and l.luopiskjarj_6 <> '' and l.ammopiskjarj_6 <> '' and
	l.amkopiskjarj_6 = '' and l.yoopiskjarj_6 = '' then l.luopiskjarj_6
	-- ammattikorkeakoulutuksen järjestäjä _6
	when l.suorlk = '1' and l.amkopiskjarj_6  <> '' and l.yoopiskjarj_6   = '' and
	l.luopiskjarj_6 = '' and l.ammopiskjarj_6 = '' then l.amkopiskjarj_6
	-- yliopistokoulutuksen järjestäjä _6 
	when l.suorlk = '1' and l.amkopiskjarj_6  = '' and l.yoopiskjarj_6  <> '' and 
	l.luopiskjarj_6  = '' and l.ammopiskjarj_6 = ''   then l.yoopiskjarj_6
	-- ammattikorkea- ja yliopistokoulutuksen järjestäjä, merkitään ammattikorkeakoulutuksen _6 järjestäjä   
	when l.suorlk = '1' and l.amkopiskjarj_6  <> '' and l.yoopiskjarj_6   <> '' and
	l.luopiskjarj_6  = '' and l.ammopiskjarj_6  = ''  then l.amkopiskjarj_6 

	
	else ''
	    end),
 --Koulutuksen maakunta 1
	(case
	-- lukioopiskelun maakunta _6
	when l.suorlk = '1' and l.luopiskmaak_6   <> '' and l.ammopiskmaak_6  = '' and
	l.amkopiskmaak_6  = '' and l.yoopiskmaak_6  = '' then l.luopiskmaak_6   
	-- ammatillisen koulutuksen maakunta _6
	when l.suorlk = '1' and l.luopiskmaak_6  = '' and l.ammopiskmaak_6  <> '' and
	l.amkopiskmaak_6  ='' and l.yoopiskmaak_6  = ''  then l.ammopiskmaak_6  
	-- lukiokoulutuksen ja ammatillisen koulutus otetaan lukiokoulutuksen maakunta _6
	when l.suorlk = '1' and l.luopiskmaak_6  <> '' and l.ammopiskmaak_6  <> '' and
	l.amkopiskmaak_6  = '' and l.yoopiskmaak_6  = '' then l.luopiskmaak_6 
    -- ammattikorkeakoulutuksen maakunta _6
	when l.suorlk = '1' and l.amkopiskmaak_6   <> '' and l.yoopiskmaak_6   = '' and
	l.luopiskjarj_6 = '' and l.ammopiskmaak_6 = '' then l.amkopiskmaak_6
	-- yliopistokoulutuksen maakunta _6 
	when l.suorlk = '1' and l.amkopiskmaak_6  = '' and l.yoopiskmaak_6  <> '' and 
	l.luopiskjarj_6  = '' and l.ammopiskmaak_6 = ''   then l.yoopiskmaak_6
	-- ammattikorkekoulutuksen ja yliopistokoulutksen maakunta otetaan ammattikorkeakoulutuksen maakunta _6   
	when l.suorlk = '1' and l.amkopiskmaak_6  <> '' and l.yoopiskmaak_6   <> '' and
	l.luopiskjarj_6  = '' and l.ammopiskmaak_6  = ''  then l.amkopiskmaak_6 
	
	else ''
	
	    end),
-- Koulutus 2
(case
   -- jos lukiokoulutuksessa vain niin jätetään tyhjäksi _6
	when l.suorlk = '1' and l.luopiskkoulk_6 <> '' and l.ammopiskkoulk_6 = '' and
	l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' then ''
	-- jos ammattikoulutuksessa vain  jätetään tyhjäksi _6 
	when l.suorlk = '1' and l.luopiskkoulk_6 = '' and l.ammopiskkoulk_6 <> '' and
	l.amkopiskkoulk_6 ='' and l.yoopiskkoulk_6 = ''  then ''
	-- jos lukiokoulutksessa ja ammattikoulutuksessa merkitään ammattikoulutus _6 
	when l.suorlk = '1' and l.luopiskkoulk_6 <> '' and l.ammopiskkoulk_6 <> '' and
	l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' then l.ammopiskkoulk_6 
	-- jos vain ammattikorkeakoulutuksessa jätetään tyhjäksi
	when l.suorlk = '1' and l.amkopiskkoulk_6  <> '' and l.yoopiskkoulk_6  = '' and
	l.luopiskkoulk_6 = '' and l.ammopiskkoulk_6 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorlk = '1' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 <> '' and 
	l.luopiskkoulk_6 = '' and l.ammopiskkoulk_6 = ''   then ''
	-- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus _6
	when l.suorlk = '1' and l.amkopiskkoulk_6 <> '' and l.yoopiskkoulk_6  <> '' and
	l.luopiskkoulk_6 = '' and l.ammopiskkoulk_6 = ''  then l.yoopiskkoulk_6
	
	
	
	else ''
	    end),
-- Oppilaitos 2
(case
    -- lukiokoulutuksen oppilaitos vain merkitään tyhjäksi
	when l.suorlk = '1' and l.luopisktunn_6 <> '' and l.ammopisktunn_6 = '' and
	l.amkopisktunn_6 = '' and l.yoopisktunn_6 = '' then ''
	-- ammatillisen koulutuksen oppilaitos _6 merkitään tyhjäksi
	when l.suorlk = '1' and l.luopisktunn_6 = '' and l.ammopisktunn_6 <> '' and
	l.amkopisktunn_6 ='' and l.yoopisktunn_6 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos merkitään ammatillisen koulutuksen oppilaitos _6
	when l.suorlk = '1' and l.luopisktunn_6 <> '' and l.ammopisktunn_6 <> '' and
	l.amkopisktunn_6 = '' and l.yoopisktunn_6 = '' then l.ammopisktunn_6 
	-- ammattikorkeakoulutksen oppilaitos vain merkitään tyhjäksi _6
	when l.suorlk = '1' and l.amkopisktunn_6  <> '' and l.yoopisktunn_6  = '' and
	l.luopisktunn_6 = '' and l.ammopisktunn_6 = '' then ''
	-- yliopistokoulutksen oppilaitos vain merkitään tyhjäksi _6
	when l.suorlk = '1' and l.amkopisktunn_6 = '' and l.yoopisktunn_6 <> '' and 
	l.luopisktunn_6 = '' and l.ammopisktunn_6 = ''   then ''  
	--  ammattikorkeakoulutksen oppilaitos ja yliopistokoulutuksen oppilaitos, merkitään yliopistokoulutuksen oppilaitos _6
	when l.suorlk = '1' and l.amkopisktunn_6 <> '' and l.yoopisktunn_6  <> '' and
	l.luopisktunn_6 = '' and l.ammopisktunn_6 = ''  then l.yoopisktunn_6 
	
	
	else ''
	    end),
-- Koulutuksen järjestäjä 2
	(case
	-- lukiokoulutuksen järjestäjä vain _6, merkitään tyhjäksi
	when l.suorlk = '1' and l.luopiskjarj_6  <> '' and l.ammopiskjarj_6 = '' and
	l.amkopiskjarj_6 = '' and l.yoopiskjarj_6 = '' then ''
	-- ammatillisen koulutuksen järjestäjä vain _6, merkitään tyhjäksi
	when l.suorlk = '1' and l.luopiskjarj_6 = '' and l.ammopiskjarj_6 <> '' and
	l.amkopiskjarj_6 ='' and l.yoopiskjarj_6 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä _6
	when l.suorlk = '1' and l.luopiskjarj_6 <> '' and l.ammopiskjarj_6 <> '' and
	l.amkopiskjarj_6 = '' and l.yoopiskjarj_6 = '' then l.ammopiskjarj_6 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi
	when l.suorlk = '1' and l.amkopiskjarj_6  <> '' and l.yoopiskjarj_6   = '' and
	l.luopiskjarj_6 = '' and l.ammopiskjarj_6 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, merkitään tyhjäksi
	when l.suorlk = '1' and l.amkopiskjarj_6  = '' and l.yoopiskjarj_6  <> '' and 
	l.luopiskjarj_6  = '' and l.ammopiskjarj_6 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestäjä merkitään yliopistokoulutuksen järjetäjä _6
	when l.suorlk = '1' and l.amkopiskjarj_6  <> '' and l.yoopiskjarj_6   <> '' and
	l.luopiskjarj_6  = '' and l.ammopiskjarj_6  = ''  then l.yoopiskjarj_6 
	

	else ''
	    end),
-- Koulutuksen maakunta 2
	(case
	-- vain lukiokoulutuksen maakunta _6, jätetään tyhjäksi
	when l.suorlk = '1' and l.luopiskmaak_6   <> '' and l.ammopiskmaak_6  = '' and
	l.amkopiskmaak_6  = '' and l.yoopiskmaak_6  = '' then ''
	-- vain ammatillisen koulutuksen maakunta _6, jätetään tyhjäksi   
	when l.suorlk = '1' and l.luopiskmaak_6  = '' and l.ammopiskmaak_6  <> '' and
	l.amkopiskmaak_6  ='' and l.yoopiskmaak_6  = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta, merkitään ammatillisen koulutuksen maakunta _6
	when l.suorlk = '1' and l.luopiskmaak_6  <> '' and l.ammopiskmaak_6  <> '' and
	l.amkopiskmaak_6  = '' and l.yoopiskmaak_6  = '' then l.ammopiskmaak_6 
	-- vain ammattikorkeakoulutuksen maakunta _6, jätetään tyhjäksi
	when l.suorlk = '1' and l.amkopiskmaak_6   <> '' and l.yoopiskmaak_6   = '' and
	l.luopiskmaak_6 = '' and l.ammopiskmaak_6 = '' then '' 
	-- vain yliopistokoulutuksen maakunta _6, merkitään tyhjäksi
	when l.suorlk = '1' and l.amkopiskmaak_6  = '' and l.yoopiskmaak_6  <> '' and 
	l.luopiskmaak_6  = '' and l.ammopiskmaak_6 = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta _6, merkitään yliopistokoulutuksen maakunta _6
	when l.suorlk = '1' and l.amkopiskmaak_6  <> '' and l.yoopiskmaak_6   <> '' and
	l.luopiskjarj_6  = '' and l.ammopiskmaak_6  = ''  then l.yoopiskmaak_6
	

	else ''
	
	    end),
	-- Monihaku
	(case
	-- _6
	when l.suorlk = '1' then l.monihaku_6		
	else '8'
	end),
    -- Pääasiallinen toiminta
    (case
    -- _6
	when l.suorlk = '1' then l.ptoim1r4_6
	else ''
	end),
	-- Ammattiasema
	(case
	-- _6
	when l.suorlk = '1' then l.amas_6
	else ''
	end),
    l.lkm,
	l.pohjkoul,
 l.tietolahde,
 'K3.13',
 -- Lukiokoulutuksessa
 (case
	    when (l.suorlk = '1' ) and  l.luopiskkoulk_6 <> '' and l.ammopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk_6 = '' then '1'    
	    else '0'
	    end) as lukiokoulutuksessa,
 -- Ammatillisessa koulutuksessa 
 (case
	    when (l.suorlk = '1') and  l.ammopiskkoulk_6  <> '' and l.luopiskkoulk_6 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' then '1' 
	    else '0'
	    end) as ammatillisessa_koulutuksessa,
-- Ammattikorkeakoulutuksessa
 (case
	   when (l.suorlk = '1') and  l.amkopiskkoulk_6 <> '' and l.ammopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.luopiskkoulk_6 = '' then  '1'
	   else '0' 
	   end) as ammattikorkeakoulutuksessa,
-- Yliopistokoulutuksessa
 (case
	    when (l.suorlk = '1') and  l.yoopiskkoulk_6  <> '' and l.amkopiskkoulk_6 = '' and l.luopiskkoulk_6 = '' and l.ammopiskkoulk_6 = '' then '1'   	   
	    else '0'
	    end) as yliopistokoulutuksessa,
-- Lukiokoulutuksessa ja ammatillisessa koulutuksessa
(case
	    when (l.suorlk = '1') and  l.luopiskkoulk_6  <> '' and l.ammopiskkoulk_6 <> '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6  = '' then '1'  
	    else '0'
	    end) as lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa,
-- Toisen asteen ammatillisessa koulutuksessa ja korkeakoulutuksessa
(case
	    when (l.suorlk = '1') and  l.ammopiskkoulk_6  <> '' and l.amkopiskkoulk_6 <> '' and l.luopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' then '1'  
	    else '0'
	    end) as toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa,
-- Ammattikorkeakoulutuksessa ja yliopistokoulutuksessa
(case
	    when (l.suorlk = '1') and  l.amkopiskkoulk_6  <> '' and l.yoopiskkoulk_6 <> '' and l.ammopiskkoulk_6  = '' and l.luopiskkoulk_6 = ''  then '1' 
	    else '0'
	    end) as ammattikorkekoulutuksessa_ja_yliopistokoulutuksessa,    
-- Koulutuksen päättäneiden toiminta
(case
	   -- Tutkintoon johtavassa koulutuksessa olevat
	   when (l.suorlk = '1')  and (l.ptoim1r4_6 = '22' or l.ptoim1r4_6 = '13')
       and	(l.luopiskkoulk_6 <>'' or l.ammopiskkoulk_6 <>'' or l.amkopiskkoulk_6 <>'' or l.yoopiskkoulk_6 <>'')   then '1' 
	
	   -- Ei tutkintoon johtavassa koulutuksessa olevat
	   when (l.suorlk = '1')  and (l.ptoim1r4_6 = '22' or l.ptoim1r4_6 = '13')
       and	(l.luopiskkoulk_6 ='' and l.ammopiskkoulk_6 ='' and l.amkopiskkoulk_6 ='' and l.yoopiskkoulk_6 ='')   then '2' 
   
   
	   -- Ei opiskelevat työlliset
	   when (l.suorlk = '1')and  l.ptoim1r4_6  = '10'  then '3' 
	   -- Ei opiskelevat työttömät
	   when (l.suorlk = '1') and  l.ptoim1r4_6  = '12'  then '4' 
	   -- Ei opiskelevat muut
		else '5' 
	   end ) as koulutuksen_paattaneiden_toiminta
 ,ika_1v = cast((case 
            when syntv = '' then '-1'
            when  (cast(tilv as int) - cast(syntv as int)) > 99 then ''
            else  ((cast(tilv as int) - cast(syntv as int))) end)  as nvarchar(10))
 ,ika_5v =cast(
       (
		case
		when (cast(tilv as int) - cast(syntv as int)) < 15 then '5v10'
		when ((cast(tilv as int) - cast(syntv as int)) >= 15 and (cast(tilv as int) - cast(syntv as int)) <= 19) then '5v15'
		when ((cast(tilv as int) - cast(syntv as int)) >= 20 and (cast(tilv as int) - cast(syntv as int)) <= 24) then '5v20'
		when ((cast(tilv as int) - cast(syntv as int)) >= 25 and (cast(tilv as int) - cast(syntv as int)) <= 29) then '5v25'
		when ((cast(tilv as int) - cast(syntv as int)) >= 30 and (cast(tilv as int) - cast(syntv as int)) <= 34) then '5v30'
		when ((cast(tilv as int) - cast(syntv as int)) >= 35 and (cast(tilv as int) - cast(syntv as int)) <= 39) then '5v35'
		when ((cast(tilv as int) - cast(syntv as int)) >= 40 and (cast(tilv as int) - cast(syntv as int)) <= 44) then '5v40'
		when ((cast(tilv as int) - cast(syntv as int)) >= 45 and (cast(tilv as int) - cast(syntv as int)) <= 49) then '5v45'
		when ((cast(tilv as int) - cast(syntv as int)) >= 50 and (cast(tilv as int) - cast(syntv as int)) <= 54) then '5v50'
		when ((cast(tilv as int) - cast(syntv as int)) >= 55 and (cast(tilv as int) - cast(syntv as int)) <= 59) then '5v55'
		when ((cast(tilv as int) - cast(syntv as int)) >= 60 and (cast(tilv as int) - cast(syntv as int)) <= 64) then '5v60'
		when ((cast(tilv as int) - cast(syntv as int)) >= 65 and (cast(tilv as int) - cast(syntv as int)) <= 69) then '5v65'
		when ((cast(tilv as int) - cast(syntv as int)) >= 70 and (cast(tilv as int) - cast(syntv as int)) <= 74) then '5v70'
		when ((cast(tilv as int) - cast(syntv as int)) >= 75 and (cast(tilv as int) - cast(syntv as int)) <= 79) then '5v75'
		when ((cast(tilv as int) - cast(syntv as int)) >= 80 and (cast(tilv as int) - cast(syntv as int)) <= 84) then '5v80'
		when ((cast(tilv as int) - cast(syntv as int)) >= 85 and (cast(tilv as int) - cast(syntv as int)) <= 89) then '5v85'
		when ((cast(tilv as int) - cast(syntv as int)) >= 90 and (cast(tilv as int) - cast(syntv as int)) <= 94) then '5v90'
		when ((cast(tilv as int) - cast(syntv as int)) >= 95) then '5v95'
		
		end
	   ) as nvarchar (10))

  ,ika_1v_suorv = cast(
					(case 
						when syntv = '' then '-1' 
						else ((cast(suorv as int) - cast(syntv as int))) 
					end)  
	as nvarchar(10))




--uudet muuttujat 03/2018

----OPISKELUT KYLLÄ/EI
--Opiskellut lukiokoulutuksessa
,case
	when  l.suorlk = '1' and (l.luopiskkoulk_1 <> '' or l.luopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.luopiskkoulk_6 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.luopiskkoulk_6 <> '' or l.luopiskkoulk2010 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.luopiskkoulk_6 <> '' or l.luopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.luopiskkoulk_6 <> '' or l.luopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk_5 <> '' or l.luopiskkoulk_6 <> '' or l.luopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk_6 <> '' or l.luopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '' or l.luopiskkoulk2014 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '' or l.luopiskkoulk2014 <> '' or l.luopiskkoulk2015 <> '') then 1*/
	else 0
end as opisk_lu
--Opiskellut ammatillisessa peruskoulutuksessa
,case
	when  l.suorlk = '1' and (l.ammopiskkoulk_1 <> '' or l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk_6 <> '') and (d1c.Koulutusaste_taso2_koodi = '32' or d2c.Koulutusaste_taso2_koodi = '32' or d3c.Koulutusaste_taso2_koodi = '32' or d4c.Koulutusaste_taso2_koodi = '32' or d5c.Koulutusaste_taso2_koodi = '32' or d6c.Koulutusaste_taso2_koodi = '32') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk_6 <> '' or l.ammopiskkoulk2010 <> '') and (d2c.Koulutusaste_taso2_koodi = '32' or d3c.Koulutusaste_taso2_koodi = '32' or d4c.Koulutusaste_taso2_koodi = '32' or d5c.Koulutusaste_taso2_koodi = '32' or d6c.Koulutusaste_taso2_koodi = '32' or d7c.Koulutusaste_taso2_koodi = '32') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk_6 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '') and (d3c.Koulutusaste_taso2_koodi = '32' or d4c.Koulutusaste_taso2_koodi = '32' or d5c.Koulutusaste_taso2_koodi = '32' or d6c.Koulutusaste_taso2_koodi = '32' or d7c.Koulutusaste_taso2_koodi = '32' or d8c.Koulutusaste_taso2_koodi = '32') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk_6 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '') and (d4c.Koulutusaste_taso2_koodi = '32' or d5c.Koulutusaste_taso2_koodi = '32' or d6c.Koulutusaste_taso2_koodi = '32' or d7c.Koulutusaste_taso2_koodi = '32' or d8c.Koulutusaste_taso2_koodi = '32' or d9c.Koulutusaste_taso2_koodi = '32') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk_6 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '' or l.ammopiskkoulk2013 <> '') and (d5c.Koulutusaste_taso2_koodi = '32' or d6c.Koulutusaste_taso2_koodi = '32' or d7c.Koulutusaste_taso2_koodi = '32' or d8c.Koulutusaste_taso2_koodi = '32' or d9c.Koulutusaste_taso2_koodi = '32' or d10c.Koulutusaste_taso2_koodi = '32') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk_6 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '' or l.ammopiskkoulk2013 <> '' or l.ammopiskkoulk2014 <> '') and (d6c.Koulutusaste_taso2_koodi = '32' or d7c.Koulutusaste_taso2_koodi = '32' or d8c.Koulutusaste_taso2_koodi = '32' or d9c.Koulutusaste_taso2_koodi = '32' or d10c.Koulutusaste_taso2_koodi = '32' or d11c.Koulutusaste_taso2_koodi = '32') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '' or l.ammopiskkoulk2013 <> '' or l.ammopiskkoulk2014 <> '' or l.ammopiskkoulk2015 <> '') and (d7c.Koulutusaste_taso2_koodi = '32' or d8c.Koulutusaste_taso2_koodi = '32' or d9c.Koulutusaste_taso2_koodi = '32' or d10c.Koulutusaste_taso2_koodi = '32' or d11c.Koulutusaste_taso2_koodi = '32' or d12c.Koulutusaste_taso2_koodi = '32') then 1*/
	else 0
end as opisk_amm_pk
--Opiskellut ammattitutkintokoulutuksessa
,case
	when  l.suorlk = '1' and (l.ammopiskkoulk_1 <> '' or l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk_6 <> '') and (d1c.Koulutusaste_taso2_koodi = '33' or d2c.Koulutusaste_taso2_koodi = '33' or d3c.Koulutusaste_taso2_koodi = '33' or d4c.Koulutusaste_taso2_koodi = '33' or d5c.Koulutusaste_taso2_koodi = '33' or d6c.Koulutusaste_taso2_koodi = '33') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk_6 <> '' or l.ammopiskkoulk2010 <> '') and (d2c.Koulutusaste_taso2_koodi = '33' or d3c.Koulutusaste_taso2_koodi = '33' or d4c.Koulutusaste_taso2_koodi = '33' or d5c.Koulutusaste_taso2_koodi = '33' or d6c.Koulutusaste_taso2_koodi = '33' or d7c.Koulutusaste_taso2_koodi = '33') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk_6 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '') and (d3c.Koulutusaste_taso2_koodi = '33' or d4c.Koulutusaste_taso2_koodi = '33' or d5c.Koulutusaste_taso2_koodi = '33' or d6c.Koulutusaste_taso2_koodi = '33' or d7c.Koulutusaste_taso2_koodi = '33' or d8c.Koulutusaste_taso2_koodi = '33') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk_6 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '') and (d4c.Koulutusaste_taso2_koodi = '33' or d5c.Koulutusaste_taso2_koodi = '33' or d6c.Koulutusaste_taso2_koodi = '33' or d7c.Koulutusaste_taso2_koodi = '33' or d8c.Koulutusaste_taso2_koodi = '33' or d9c.Koulutusaste_taso2_koodi = '33') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk_6 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '' or l.ammopiskkoulk2013 <> '') and (d5c.Koulutusaste_taso2_koodi = '33' or d6c.Koulutusaste_taso2_koodi = '33' or d7c.Koulutusaste_taso2_koodi = '33' or d8c.Koulutusaste_taso2_koodi = '33' or d9c.Koulutusaste_taso2_koodi = '33' or d10c.Koulutusaste_taso2_koodi = '33') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk_6 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '' or l.ammopiskkoulk2013 <> '' or l.ammopiskkoulk2014 <> '') and (d6c.Koulutusaste_taso2_koodi = '33' or d7c.Koulutusaste_taso2_koodi = '33' or d8c.Koulutusaste_taso2_koodi = '33' or d9c.Koulutusaste_taso2_koodi = '33' or d10c.Koulutusaste_taso2_koodi = '33' or d11c.Koulutusaste_taso2_koodi = '33') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '' or l.ammopiskkoulk2013 <> '' or l.ammopiskkoulk2014 <> '' or l.ammopiskkoulk2015 <> '') and (d7c.Koulutusaste_taso2_koodi = '33' or d8c.Koulutusaste_taso2_koodi = '33' or d9c.Koulutusaste_taso2_koodi = '33' or d10c.Koulutusaste_taso2_koodi = '33' or d11c.Koulutusaste_taso2_koodi = '33' or d12c.Koulutusaste_taso2_koodi = '33') then 1*/
	else 0
end as opisk_amm_at
--Opiskellut erikoisammattitutkintokoulutuksessa
,case
	when  l.suorlk = '1' and (l.ammopiskkoulk_1 <> '' or l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk_6 <> '') and (d1c.Koulutusaste_taso2_koodi = '41' or d2c.Koulutusaste_taso2_koodi = '41' or d3c.Koulutusaste_taso2_koodi = '41' or d4c.Koulutusaste_taso2_koodi = '41' or d5c.Koulutusaste_taso2_koodi = '41' or d6c.Koulutusaste_taso2_koodi = '41') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk_6 <> '' or l.ammopiskkoulk2010 <> '') and (d2c.Koulutusaste_taso2_koodi = '41' or d3c.Koulutusaste_taso2_koodi = '41' or d4c.Koulutusaste_taso2_koodi = '41' or d5c.Koulutusaste_taso2_koodi = '41' or d6c.Koulutusaste_taso2_koodi = '41' or d7c.Koulutusaste_taso2_koodi = '41') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk_6 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '') and (d3c.Koulutusaste_taso2_koodi = '41' or d4c.Koulutusaste_taso2_koodi = '41' or d5c.Koulutusaste_taso2_koodi = '41' or d6c.Koulutusaste_taso2_koodi = '41' or d7c.Koulutusaste_taso2_koodi = '41' or d8c.Koulutusaste_taso2_koodi = '41') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk_6 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '') and (d4c.Koulutusaste_taso2_koodi = '41' or d5c.Koulutusaste_taso2_koodi = '41' or d6c.Koulutusaste_taso2_koodi = '41' or d7c.Koulutusaste_taso2_koodi = '41' or d8c.Koulutusaste_taso2_koodi = '41' or d9c.Koulutusaste_taso2_koodi = '41') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk_6 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '' or l.ammopiskkoulk2013 <> '') and (d5c.Koulutusaste_taso2_koodi = '41' or d6c.Koulutusaste_taso2_koodi = '41' or d7c.Koulutusaste_taso2_koodi = '41' or d8c.Koulutusaste_taso2_koodi = '41' or d9c.Koulutusaste_taso2_koodi = '41' or d10c.Koulutusaste_taso2_koodi = '41') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk_6 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '' or l.ammopiskkoulk2013 <> '' or l.ammopiskkoulk2014 <> '') and (d6c.Koulutusaste_taso2_koodi = '41' or d7c.Koulutusaste_taso2_koodi = '41' or d8c.Koulutusaste_taso2_koodi = '41' or d9c.Koulutusaste_taso2_koodi = '41' or d10c.Koulutusaste_taso2_koodi = '41' or d11c.Koulutusaste_taso2_koodi = '41') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '' or l.ammopiskkoulk2013 <> '' or l.ammopiskkoulk2014 <> '' or l.ammopiskkoulk2015 <> '') and (d7c.Koulutusaste_taso2_koodi = '41' or d8c.Koulutusaste_taso2_koodi = '41' or d9c.Koulutusaste_taso2_koodi = '41' or d10c.Koulutusaste_taso2_koodi = '41' or d11c.Koulutusaste_taso2_koodi = '41' or d12c.Koulutusaste_taso2_koodi = '41') then 1*/
	else 0
end as opisk_amm_eat
--Opiskellut ammatillisessa koulutuksessa
,case
	when  l.suorlk = '1' and (l.ammopiskkoulk_1 <> '' or l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk_6 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk_2 <> '' or l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk_6 <> '' or l.ammopiskkoulk2010 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk_3 <> '' or l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk_6 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk_4 <> '' or l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk_6 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk_5 <> '' or l.ammopiskkoulk_6 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '' or l.ammopiskkoulk2013 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk_6 <> '' or l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '' or l.ammopiskkoulk2013 <> '' or l.ammopiskkoulk2014 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.ammopiskkoulk2010 <> '' or l.ammopiskkoulk2011 <> '' or l.ammopiskkoulk2012 <> '' or l.ammopiskkoulk2013 <> '' or l.ammopiskkoulk2014 <> '' or l.ammopiskkoulk2015 <> '') then 1*/
	else 0
end as opisk_amm
--Opiskellut ammattikorkeakoulutuksessa
,case
	when  l.suorlk = '1' and (l.amkopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.amkopiskkoulk_6 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.amkopiskkoulk_6 <> '' or l.amkopiskkoulk2010 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.amkopiskkoulk_6 <> '' or l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.amkopiskkoulk_6 <> '' or l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk_5 <> '' or l.amkopiskkoulk_6 <> '' or l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk_6 <> '' or l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '' or l.amkopiskkoulk2014 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '' or l.amkopiskkoulk2014 <> '' or l.amkopiskkoulk2015 <> '') then 1*/
	else 0
end as opisk_amk
--Opiskellut yliopistokoulutuksessa
,case
	when  l.suorlk = '1' and (l.yoopiskkoulk_1 <> '' or l.yoopiskkoulk_2 <> '' or l.yoopiskkoulk_3 <> '' or l.yoopiskkoulk_4 <> '' or l.yoopiskkoulk_5 <> '' or l.yoopiskkoulk_6 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.yoopiskkoulk_2 <> '' or l.yoopiskkoulk_3 <> '' or l.yoopiskkoulk_4 <> '' or l.yoopiskkoulk_5 <> '' or l.yoopiskkoulk_6 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.yoopiskkoulk_3 <> '' or l.yoopiskkoulk_4 <> '' or l.yoopiskkoulk_5 <> '' or l.yoopiskkoulk_6 <> '' or l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.yoopiskkoulk_4 <> '' or l.yoopiskkoulk_5 <> '' or l.yoopiskkoulk_6 <> '' or l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '' or l.yoopiskkoulk2012 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.yoopiskkoulk_5 <> '' or l.yoopiskkoulk_6 <> '' or l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '' or l.yoopiskkoulk2012 <> '' or l.yoopiskkoulk2013 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.yoopiskkoulk_6 <> '' or l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '' or l.yoopiskkoulk2012 <> '' or l.yoopiskkoulk2013 <> '' or l.yoopiskkoulk2014 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '' or l.yoopiskkoulk2012 <> '' or l.yoopiskkoulk2013 <> '' or l.yoopiskkoulk2014 <> '' or l.yoopiskkoulk2015 <> '') then 1*/
	else 0
end as opisk_yo



----KOULUTUSALA, TASO 1 KYLLÄ/EI
--Opiskellut koulutusala1 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1a.iscfibroad2013_koodi = '01' or d2a.iscfibroad2013_koodi = '01' or d3a.iscfibroad2013_koodi = '01' or d4a.iscfibroad2013_koodi = '01' or d5a.iscfibroad2013_koodi = '01' or d6a.iscfibroad2013_koodi = '01') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2a.iscfibroad2013_koodi = '01' or d3a.iscfibroad2013_koodi = '01' or d4a.iscfibroad2013_koodi = '01' or d5a.iscfibroad2013_koodi = '01' or d6a.iscfibroad2013_koodi = '01' or d7a.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3a.iscfibroad2013_koodi = '01' or d4a.iscfibroad2013_koodi = '01' or d5a.iscfibroad2013_koodi = '01' or d6a.iscfibroad2013_koodi = '01' or d7a.iscfibroad2013_koodi = '01' or d8a.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4a.iscfibroad2013_koodi = '01' or d5a.iscfibroad2013_koodi = '01' or d6a.iscfibroad2013_koodi = '01' or d7a.iscfibroad2013_koodi = '01' or d8a.iscfibroad2013_koodi = '01' or d9a.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5a.iscfibroad2013_koodi = '01' or d6a.iscfibroad2013_koodi = '01' or d7a.iscfibroad2013_koodi = '01' or d8a.iscfibroad2013_koodi = '01' or d9a.iscfibroad2013_koodi = '01' or d10a.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6a.iscfibroad2013_koodi = '01' or d7a.iscfibroad2013_koodi = '01' or d8a.iscfibroad2013_koodi = '01' or d9a.iscfibroad2013_koodi = '01' or d10a.iscfibroad2013_koodi = '01' or d11a.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7a.iscfibroad2013_koodi = '01' or d8a.iscfibroad2013_koodi = '01' or d9a.iscfibroad2013_koodi = '01' or d10a.iscfibroad2013_koodi = '01' or d11a.iscfibroad2013_koodi = '01' or d12a.iscfibroad2013_koodi = '01') then 1*/
	else 0
end as opisk_amk_koulala1
--Opiskellut koulutusala2 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1a.iscfibroad2013_koodi = '02' or d2a.iscfibroad2013_koodi = '02' or d3a.iscfibroad2013_koodi = '02' or d4a.iscfibroad2013_koodi = '02' or d5a.iscfibroad2013_koodi = '02' or d6a.iscfibroad2013_koodi = '02') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2a.iscfibroad2013_koodi = '02' or d3a.iscfibroad2013_koodi = '02' or d4a.iscfibroad2013_koodi = '02' or d5a.iscfibroad2013_koodi = '02' or d6a.iscfibroad2013_koodi = '02' or d7a.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3a.iscfibroad2013_koodi = '02' or d4a.iscfibroad2013_koodi = '02' or d5a.iscfibroad2013_koodi = '02' or d6a.iscfibroad2013_koodi = '02' or d7a.iscfibroad2013_koodi = '02' or d8a.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4a.iscfibroad2013_koodi = '02' or d5a.iscfibroad2013_koodi = '02' or d6a.iscfibroad2013_koodi = '02' or d7a.iscfibroad2013_koodi = '02' or d8a.iscfibroad2013_koodi = '02' or d9a.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5a.iscfibroad2013_koodi = '02' or d6a.iscfibroad2013_koodi = '02' or d7a.iscfibroad2013_koodi = '02' or d8a.iscfibroad2013_koodi = '02' or d9a.iscfibroad2013_koodi = '02' or d10a.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6a.iscfibroad2013_koodi = '02' or d7a.iscfibroad2013_koodi = '02' or d8a.iscfibroad2013_koodi = '02' or d9a.iscfibroad2013_koodi = '02' or d10a.iscfibroad2013_koodi = '02' or d11a.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7a.iscfibroad2013_koodi = '02' or d8a.iscfibroad2013_koodi = '02' or d9a.iscfibroad2013_koodi = '02' or d10a.iscfibroad2013_koodi = '02' or d11a.iscfibroad2013_koodi = '02' or d12a.iscfibroad2013_koodi = '02') then 1*/
	else 0
end as opisk_amk_koulala2
--Opiskellut koulutusala3 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1a.iscfibroad2013_koodi = '03' or d2a.iscfibroad2013_koodi = '03' or d3a.iscfibroad2013_koodi = '03' or d4a.iscfibroad2013_koodi = '03' or d5a.iscfibroad2013_koodi = '03' or d6a.iscfibroad2013_koodi = '03') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2a.iscfibroad2013_koodi = '03' or d3a.iscfibroad2013_koodi = '03' or d4a.iscfibroad2013_koodi = '03' or d5a.iscfibroad2013_koodi = '03' or d6a.iscfibroad2013_koodi = '03' or d7a.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3a.iscfibroad2013_koodi = '03' or d4a.iscfibroad2013_koodi = '03' or d5a.iscfibroad2013_koodi = '03' or d6a.iscfibroad2013_koodi = '03' or d7a.iscfibroad2013_koodi = '03' or d8a.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4a.iscfibroad2013_koodi = '03' or d5a.iscfibroad2013_koodi = '03' or d6a.iscfibroad2013_koodi = '03' or d7a.iscfibroad2013_koodi = '03' or d8a.iscfibroad2013_koodi = '03' or d9a.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5a.iscfibroad2013_koodi = '03' or d6a.iscfibroad2013_koodi = '03' or d7a.iscfibroad2013_koodi = '03' or d8a.iscfibroad2013_koodi = '03' or d9a.iscfibroad2013_koodi = '03' or d10a.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6a.iscfibroad2013_koodi = '03' or d7a.iscfibroad2013_koodi = '03' or d8a.iscfibroad2013_koodi = '03' or d9a.iscfibroad2013_koodi = '03' or d10a.iscfibroad2013_koodi = '03' or d11a.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7a.iscfibroad2013_koodi = '03' or d8a.iscfibroad2013_koodi = '03' or d9a.iscfibroad2013_koodi = '03' or d10a.iscfibroad2013_koodi = '03' or d11a.iscfibroad2013_koodi = '03' or d12a.iscfibroad2013_koodi = '03') then 1*/
	else 0
end as opisk_amk_koulala3
--Opiskellut koulutusala4 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1a.iscfibroad2013_koodi = '04' or d2a.iscfibroad2013_koodi = '04' or d3a.iscfibroad2013_koodi = '04' or d4a.iscfibroad2013_koodi = '04' or d5a.iscfibroad2013_koodi = '04' or d6a.iscfibroad2013_koodi = '04') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2a.iscfibroad2013_koodi = '04' or d3a.iscfibroad2013_koodi = '04' or d4a.iscfibroad2013_koodi = '04' or d5a.iscfibroad2013_koodi = '04' or d6a.iscfibroad2013_koodi = '04' or d7a.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3a.iscfibroad2013_koodi = '04' or d4a.iscfibroad2013_koodi = '04' or d5a.iscfibroad2013_koodi = '04' or d6a.iscfibroad2013_koodi = '04' or d7a.iscfibroad2013_koodi = '04' or d8a.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4a.iscfibroad2013_koodi = '04' or d5a.iscfibroad2013_koodi = '04' or d6a.iscfibroad2013_koodi = '04' or d7a.iscfibroad2013_koodi = '04' or d8a.iscfibroad2013_koodi = '04' or d9a.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5a.iscfibroad2013_koodi = '04' or d6a.iscfibroad2013_koodi = '04' or d7a.iscfibroad2013_koodi = '04' or d8a.iscfibroad2013_koodi = '04' or d9a.iscfibroad2013_koodi = '04' or d10a.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6a.iscfibroad2013_koodi = '04' or d7a.iscfibroad2013_koodi = '04' or d8a.iscfibroad2013_koodi = '04' or d9a.iscfibroad2013_koodi = '04' or d10a.iscfibroad2013_koodi = '04' or d11a.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7a.iscfibroad2013_koodi = '04' or d8a.iscfibroad2013_koodi = '04' or d9a.iscfibroad2013_koodi = '04' or d10a.iscfibroad2013_koodi = '04' or d11a.iscfibroad2013_koodi = '04' or d12a.iscfibroad2013_koodi = '04') then 1*/
	else 0
end as opisk_amk_koulala4
--Opiskellut koulutusala5 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1a.iscfibroad2013_koodi = '05' or d2a.iscfibroad2013_koodi = '05' or d3a.iscfibroad2013_koodi = '05' or d4a.iscfibroad2013_koodi = '05' or d5a.iscfibroad2013_koodi = '05' or d6a.iscfibroad2013_koodi = '05') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2a.iscfibroad2013_koodi = '05' or d3a.iscfibroad2013_koodi = '05' or d4a.iscfibroad2013_koodi = '05' or d5a.iscfibroad2013_koodi = '05' or d6a.iscfibroad2013_koodi = '05' or d7a.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3a.iscfibroad2013_koodi = '05' or d4a.iscfibroad2013_koodi = '05' or d5a.iscfibroad2013_koodi = '05' or d6a.iscfibroad2013_koodi = '05' or d7a.iscfibroad2013_koodi = '05' or d8a.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4a.iscfibroad2013_koodi = '05' or d5a.iscfibroad2013_koodi = '05' or d6a.iscfibroad2013_koodi = '05' or d7a.iscfibroad2013_koodi = '05' or d8a.iscfibroad2013_koodi = '05' or d9a.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5a.iscfibroad2013_koodi = '05' or d6a.iscfibroad2013_koodi = '05' or d7a.iscfibroad2013_koodi = '05' or d8a.iscfibroad2013_koodi = '05' or d9a.iscfibroad2013_koodi = '05' or d10a.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6a.iscfibroad2013_koodi = '05' or d7a.iscfibroad2013_koodi = '05' or d8a.iscfibroad2013_koodi = '05' or d9a.iscfibroad2013_koodi = '05' or d10a.iscfibroad2013_koodi = '05' or d11a.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7a.iscfibroad2013_koodi = '05' or d8a.iscfibroad2013_koodi = '05' or d9a.iscfibroad2013_koodi = '05' or d10a.iscfibroad2013_koodi = '05' or d11a.iscfibroad2013_koodi = '05' or d12a.iscfibroad2013_koodi = '05') then 1*/
	else 0
end as opisk_amk_koulala5
--Opiskellut koulutusala6 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1a.iscfibroad2013_koodi = '06' or d2a.iscfibroad2013_koodi = '06' or d3a.iscfibroad2013_koodi = '06' or d4a.iscfibroad2013_koodi = '06' or d5a.iscfibroad2013_koodi = '06' or d6a.iscfibroad2013_koodi = '06') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2a.iscfibroad2013_koodi = '06' or d3a.iscfibroad2013_koodi = '06' or d4a.iscfibroad2013_koodi = '06' or d5a.iscfibroad2013_koodi = '06' or d6a.iscfibroad2013_koodi = '06' or d7a.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3a.iscfibroad2013_koodi = '06' or d4a.iscfibroad2013_koodi = '06' or d5a.iscfibroad2013_koodi = '06' or d6a.iscfibroad2013_koodi = '06' or d7a.iscfibroad2013_koodi = '06' or d8a.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4a.iscfibroad2013_koodi = '06' or d5a.iscfibroad2013_koodi = '06' or d6a.iscfibroad2013_koodi = '06' or d7a.iscfibroad2013_koodi = '06' or d8a.iscfibroad2013_koodi = '06' or d9a.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5a.iscfibroad2013_koodi = '06' or d6a.iscfibroad2013_koodi = '06' or d7a.iscfibroad2013_koodi = '06' or d8a.iscfibroad2013_koodi = '06' or d9a.iscfibroad2013_koodi = '06' or d10a.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6a.iscfibroad2013_koodi = '06' or d7a.iscfibroad2013_koodi = '06' or d8a.iscfibroad2013_koodi = '06' or d9a.iscfibroad2013_koodi = '06' or d10a.iscfibroad2013_koodi = '06' or d11a.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7a.iscfibroad2013_koodi = '06' or d8a.iscfibroad2013_koodi = '06' or d9a.iscfibroad2013_koodi = '06' or d10a.iscfibroad2013_koodi = '06' or d11a.iscfibroad2013_koodi = '06' or d12a.iscfibroad2013_koodi = '06') then 1*/
	else 0
end as opisk_amk_koulala6
--Opiskellut koulutusala7 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1a.iscfibroad2013_koodi = '07' or d2a.iscfibroad2013_koodi = '07' or d3a.iscfibroad2013_koodi = '07' or d4a.iscfibroad2013_koodi = '07' or d5a.iscfibroad2013_koodi = '07' or d6a.iscfibroad2013_koodi = '07') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2a.iscfibroad2013_koodi = '07' or d3a.iscfibroad2013_koodi = '07' or d4a.iscfibroad2013_koodi = '07' or d5a.iscfibroad2013_koodi = '07' or d6a.iscfibroad2013_koodi = '07' or d7a.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3a.iscfibroad2013_koodi = '07' or d4a.iscfibroad2013_koodi = '07' or d5a.iscfibroad2013_koodi = '07' or d6a.iscfibroad2013_koodi = '07' or d7a.iscfibroad2013_koodi = '07' or d8a.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4a.iscfibroad2013_koodi = '07' or d5a.iscfibroad2013_koodi = '07' or d6a.iscfibroad2013_koodi = '07' or d7a.iscfibroad2013_koodi = '07' or d8a.iscfibroad2013_koodi = '07' or d9a.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5a.iscfibroad2013_koodi = '07' or d6a.iscfibroad2013_koodi = '07' or d7a.iscfibroad2013_koodi = '07' or d8a.iscfibroad2013_koodi = '07' or d9a.iscfibroad2013_koodi = '07' or d10a.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6a.iscfibroad2013_koodi = '07' or d7a.iscfibroad2013_koodi = '07' or d8a.iscfibroad2013_koodi = '07' or d9a.iscfibroad2013_koodi = '07' or d10a.iscfibroad2013_koodi = '07' or d11a.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7a.iscfibroad2013_koodi = '07' or d8a.iscfibroad2013_koodi = '07' or d9a.iscfibroad2013_koodi = '07' or d10a.iscfibroad2013_koodi = '07' or d11a.iscfibroad2013_koodi = '07' or d12a.iscfibroad2013_koodi = '07') then 1*/
	else 0
end as opisk_amk_koulala7
--Opiskellut koulutusala8 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1a.iscfibroad2013_koodi = '08' or d2a.iscfibroad2013_koodi = '08' or d3a.iscfibroad2013_koodi = '08' or d4a.iscfibroad2013_koodi = '08' or d5a.iscfibroad2013_koodi = '08' or d6a.iscfibroad2013_koodi = '08') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2a.iscfibroad2013_koodi = '08' or d3a.iscfibroad2013_koodi = '08' or d4a.iscfibroad2013_koodi = '08' or d5a.iscfibroad2013_koodi = '08' or d6a.iscfibroad2013_koodi = '08' or d7a.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3a.iscfibroad2013_koodi = '08' or d4a.iscfibroad2013_koodi = '08' or d5a.iscfibroad2013_koodi = '08' or d6a.iscfibroad2013_koodi = '08' or d7a.iscfibroad2013_koodi = '08' or d8a.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4a.iscfibroad2013_koodi = '08' or d5a.iscfibroad2013_koodi = '08' or d6a.iscfibroad2013_koodi = '08' or d7a.iscfibroad2013_koodi = '08' or d8a.iscfibroad2013_koodi = '08' or d9a.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5a.iscfibroad2013_koodi = '08' or d6a.iscfibroad2013_koodi = '08' or d7a.iscfibroad2013_koodi = '08' or d8a.iscfibroad2013_koodi = '08' or d9a.iscfibroad2013_koodi = '08' or d10a.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6a.iscfibroad2013_koodi = '08' or d7a.iscfibroad2013_koodi = '08' or d8a.iscfibroad2013_koodi = '08' or d9a.iscfibroad2013_koodi = '08' or d10a.iscfibroad2013_koodi = '08' or d11a.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7a.iscfibroad2013_koodi = '08' or d8a.iscfibroad2013_koodi = '08' or d9a.iscfibroad2013_koodi = '08' or d10a.iscfibroad2013_koodi = '08' or d11a.iscfibroad2013_koodi = '08' or d12a.iscfibroad2013_koodi = '08') then 1*/
	else 0
end as opisk_amk_koulala8
--Opiskellut koulutusala9 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1a.iscfibroad2013_koodi = '09' or d2a.iscfibroad2013_koodi = '09' or d3a.iscfibroad2013_koodi = '09' or d4a.iscfibroad2013_koodi = '09' or d5a.iscfibroad2013_koodi = '09' or d6a.iscfibroad2013_koodi = '09') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2a.iscfibroad2013_koodi = '09' or d3a.iscfibroad2013_koodi = '09' or d4a.iscfibroad2013_koodi = '09' or d5a.iscfibroad2013_koodi = '09' or d6a.iscfibroad2013_koodi = '09' or d7a.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3a.iscfibroad2013_koodi = '09' or d4a.iscfibroad2013_koodi = '09' or d5a.iscfibroad2013_koodi = '09' or d6a.iscfibroad2013_koodi = '09' or d7a.iscfibroad2013_koodi = '09' or d8a.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4a.iscfibroad2013_koodi = '09' or d5a.iscfibroad2013_koodi = '09' or d6a.iscfibroad2013_koodi = '09' or d7a.iscfibroad2013_koodi = '09' or d8a.iscfibroad2013_koodi = '09' or d9a.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5a.iscfibroad2013_koodi = '09' or d6a.iscfibroad2013_koodi = '09' or d7a.iscfibroad2013_koodi = '09' or d8a.iscfibroad2013_koodi = '09' or d9a.iscfibroad2013_koodi = '09' or d10a.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6a.iscfibroad2013_koodi = '09' or d7a.iscfibroad2013_koodi = '09' or d8a.iscfibroad2013_koodi = '09' or d9a.iscfibroad2013_koodi = '09' or d10a.iscfibroad2013_koodi = '09' or d11a.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7a.iscfibroad2013_koodi = '09' or d8a.iscfibroad2013_koodi = '09' or d9a.iscfibroad2013_koodi = '09' or d10a.iscfibroad2013_koodi = '09' or d11a.iscfibroad2013_koodi = '09' or d12a.iscfibroad2013_koodi = '09') then 1*/
	else 0
end as opisk_amk_koulala9
--Opiskellut koulutusala10 (amk) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1a.iscfibroad2013_koodi = '10' or d2a.iscfibroad2013_koodi = '10' or d3a.iscfibroad2013_koodi = '10' or d4a.iscfibroad2013_koodi = '10' or d5a.iscfibroad2013_koodi = '10' or d6a.iscfibroad2013_koodi = '10') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2a.iscfibroad2013_koodi = '10' or d3a.iscfibroad2013_koodi = '10' or d4a.iscfibroad2013_koodi = '10' or d5a.iscfibroad2013_koodi = '10' or d6a.iscfibroad2013_koodi = '10' or d7a.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3a.iscfibroad2013_koodi = '10' or d4a.iscfibroad2013_koodi = '10' or d5a.iscfibroad2013_koodi = '10' or d6a.iscfibroad2013_koodi = '10' or d7a.iscfibroad2013_koodi = '10' or d8a.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4a.iscfibroad2013_koodi = '10' or d5a.iscfibroad2013_koodi = '10' or d6a.iscfibroad2013_koodi = '10' or d7a.iscfibroad2013_koodi = '10' or d8a.iscfibroad2013_koodi = '10' or d9a.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5a.iscfibroad2013_koodi = '10' or d6a.iscfibroad2013_koodi = '10' or d7a.iscfibroad2013_koodi = '10' or d8a.iscfibroad2013_koodi = '10' or d9a.iscfibroad2013_koodi = '10' or d10a.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6a.iscfibroad2013_koodi = '10' or d7a.iscfibroad2013_koodi = '10' or d8a.iscfibroad2013_koodi = '10' or d9a.iscfibroad2013_koodi = '10' or d10a.iscfibroad2013_koodi = '10' or d11a.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7a.iscfibroad2013_koodi = '10' or d8a.iscfibroad2013_koodi = '10' or d9a.iscfibroad2013_koodi = '10' or d10a.iscfibroad2013_koodi = '10' or d11a.iscfibroad2013_koodi = '10' or d12a.iscfibroad2013_koodi = '10') then 1*/
	else 0
end as opisk_amk_koulala10



--Opiskellut koulutusala1 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1b.iscfibroad2013_koodi = '01' or d2b.iscfibroad2013_koodi = '01' or d3b.iscfibroad2013_koodi = '01' or d4b.iscfibroad2013_koodi = '01' or d5b.iscfibroad2013_koodi = '01' or d6b.iscfibroad2013_koodi = '01') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2b.iscfibroad2013_koodi = '01' or d3b.iscfibroad2013_koodi = '01' or d4b.iscfibroad2013_koodi = '01' or d5b.iscfibroad2013_koodi = '01' or d6b.iscfibroad2013_koodi = '01' or d7b.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3b.iscfibroad2013_koodi = '01' or d4b.iscfibroad2013_koodi = '01' or d5b.iscfibroad2013_koodi = '01' or d6b.iscfibroad2013_koodi = '01' or d7b.iscfibroad2013_koodi = '01' or d8b.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4b.iscfibroad2013_koodi = '01' or d5b.iscfibroad2013_koodi = '01' or d6b.iscfibroad2013_koodi = '01' or d7b.iscfibroad2013_koodi = '01' or d8b.iscfibroad2013_koodi = '01' or d9b.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5b.iscfibroad2013_koodi = '01' or d6b.iscfibroad2013_koodi = '01' or d7b.iscfibroad2013_koodi = '01' or d8b.iscfibroad2013_koodi = '01' or d9b.iscfibroad2013_koodi = '01' or d10b.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6b.iscfibroad2013_koodi = '01' or d7b.iscfibroad2013_koodi = '01' or d8b.iscfibroad2013_koodi = '01' or d9b.iscfibroad2013_koodi = '01' or d10b.iscfibroad2013_koodi = '01' or d11b.iscfibroad2013_koodi = '01') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7b.iscfibroad2013_koodi = '01' or d8b.iscfibroad2013_koodi = '01' or d9b.iscfibroad2013_koodi = '01' or d10b.iscfibroad2013_koodi = '01' or d11b.iscfibroad2013_koodi = '01' or d12b.iscfibroad2013_koodi = '01') then 1*/
	else 0
end as opisk_yo_koulala1
--Opiskellut koulutusala2 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1b.iscfibroad2013_koodi = '02' or d2b.iscfibroad2013_koodi = '02' or d3b.iscfibroad2013_koodi = '02' or d4b.iscfibroad2013_koodi = '02' or d5b.iscfibroad2013_koodi = '02' or d6b.iscfibroad2013_koodi = '02') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2b.iscfibroad2013_koodi = '02' or d3b.iscfibroad2013_koodi = '02' or d4b.iscfibroad2013_koodi = '02' or d5b.iscfibroad2013_koodi = '02' or d6b.iscfibroad2013_koodi = '02' or d7b.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3b.iscfibroad2013_koodi = '02' or d4b.iscfibroad2013_koodi = '02' or d5b.iscfibroad2013_koodi = '02' or d6b.iscfibroad2013_koodi = '02' or d7b.iscfibroad2013_koodi = '02' or d8b.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4b.iscfibroad2013_koodi = '02' or d5b.iscfibroad2013_koodi = '02' or d6b.iscfibroad2013_koodi = '02' or d7b.iscfibroad2013_koodi = '02' or d8b.iscfibroad2013_koodi = '02' or d9b.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5b.iscfibroad2013_koodi = '02' or d6b.iscfibroad2013_koodi = '02' or d7b.iscfibroad2013_koodi = '02' or d8b.iscfibroad2013_koodi = '02' or d9b.iscfibroad2013_koodi = '02' or d10b.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6b.iscfibroad2013_koodi = '02' or d7b.iscfibroad2013_koodi = '02' or d8b.iscfibroad2013_koodi = '02' or d9b.iscfibroad2013_koodi = '02' or d10b.iscfibroad2013_koodi = '02' or d11b.iscfibroad2013_koodi = '02') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7b.iscfibroad2013_koodi = '02' or d8b.iscfibroad2013_koodi = '02' or d9b.iscfibroad2013_koodi = '02' or d10b.iscfibroad2013_koodi = '02' or d11b.iscfibroad2013_koodi = '02' or d12b.iscfibroad2013_koodi = '02') then 1*/
	else 0
end as opisk_yo_koulala2
--Opiskellut koulutusala3 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1b.iscfibroad2013_koodi = '03' or d2b.iscfibroad2013_koodi = '03' or d3b.iscfibroad2013_koodi = '03' or d4b.iscfibroad2013_koodi = '03' or d5b.iscfibroad2013_koodi = '03' or d6b.iscfibroad2013_koodi = '03') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2b.iscfibroad2013_koodi = '03' or d3b.iscfibroad2013_koodi = '03' or d4b.iscfibroad2013_koodi = '03' or d5b.iscfibroad2013_koodi = '03' or d6b.iscfibroad2013_koodi = '03' or d7b.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3b.iscfibroad2013_koodi = '03' or d4b.iscfibroad2013_koodi = '03' or d5b.iscfibroad2013_koodi = '03' or d6b.iscfibroad2013_koodi = '03' or d7b.iscfibroad2013_koodi = '03' or d8b.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4b.iscfibroad2013_koodi = '03' or d5b.iscfibroad2013_koodi = '03' or d6b.iscfibroad2013_koodi = '03' or d7b.iscfibroad2013_koodi = '03' or d8b.iscfibroad2013_koodi = '03' or d9b.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5b.iscfibroad2013_koodi = '03' or d6b.iscfibroad2013_koodi = '03' or d7b.iscfibroad2013_koodi = '03' or d8b.iscfibroad2013_koodi = '03' or d9b.iscfibroad2013_koodi = '03' or d10b.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6b.iscfibroad2013_koodi = '03' or d7b.iscfibroad2013_koodi = '03' or d8b.iscfibroad2013_koodi = '03' or d9b.iscfibroad2013_koodi = '03' or d10b.iscfibroad2013_koodi = '03' or d11b.iscfibroad2013_koodi = '03') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7b.iscfibroad2013_koodi = '03' or d8b.iscfibroad2013_koodi = '03' or d9b.iscfibroad2013_koodi = '03' or d10b.iscfibroad2013_koodi = '03' or d11b.iscfibroad2013_koodi = '03' or d12b.iscfibroad2013_koodi = '03') then 1*/
	else 0
end as opisk_yo_koulala3
--Opiskellut koulutusala4 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1b.iscfibroad2013_koodi = '04' or d2b.iscfibroad2013_koodi = '04' or d3b.iscfibroad2013_koodi = '04' or d4b.iscfibroad2013_koodi = '04' or d5b.iscfibroad2013_koodi = '04' or d6b.iscfibroad2013_koodi = '04') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2b.iscfibroad2013_koodi = '04' or d3b.iscfibroad2013_koodi = '04' or d4b.iscfibroad2013_koodi = '04' or d5b.iscfibroad2013_koodi = '04' or d6b.iscfibroad2013_koodi = '04' or d7b.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3b.iscfibroad2013_koodi = '04' or d4b.iscfibroad2013_koodi = '04' or d5b.iscfibroad2013_koodi = '04' or d6b.iscfibroad2013_koodi = '04' or d7b.iscfibroad2013_koodi = '04' or d8b.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4b.iscfibroad2013_koodi = '04' or d5b.iscfibroad2013_koodi = '04' or d6b.iscfibroad2013_koodi = '04' or d7b.iscfibroad2013_koodi = '04' or d8b.iscfibroad2013_koodi = '04' or d9b.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5b.iscfibroad2013_koodi = '04' or d6b.iscfibroad2013_koodi = '04' or d7b.iscfibroad2013_koodi = '04' or d8b.iscfibroad2013_koodi = '04' or d9b.iscfibroad2013_koodi = '04' or d10b.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6b.iscfibroad2013_koodi = '04' or d7b.iscfibroad2013_koodi = '04' or d8b.iscfibroad2013_koodi = '04' or d9b.iscfibroad2013_koodi = '04' or d10b.iscfibroad2013_koodi = '04' or d11b.iscfibroad2013_koodi = '04') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7b.iscfibroad2013_koodi = '04' or d8b.iscfibroad2013_koodi = '04' or d9b.iscfibroad2013_koodi = '04' or d10b.iscfibroad2013_koodi = '04' or d11b.iscfibroad2013_koodi = '04' or d12b.iscfibroad2013_koodi = '04') then 1*/
	else 0
end as opisk_yo_koulala4
--Opiskellut koulutusala5 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1b.iscfibroad2013_koodi = '05' or d2b.iscfibroad2013_koodi = '05' or d3b.iscfibroad2013_koodi = '05' or d4b.iscfibroad2013_koodi = '05' or d5b.iscfibroad2013_koodi = '05' or d6b.iscfibroad2013_koodi = '05') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2b.iscfibroad2013_koodi = '05' or d3b.iscfibroad2013_koodi = '05' or d4b.iscfibroad2013_koodi = '05' or d5b.iscfibroad2013_koodi = '05' or d6b.iscfibroad2013_koodi = '05' or d7b.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3b.iscfibroad2013_koodi = '05' or d4b.iscfibroad2013_koodi = '05' or d5b.iscfibroad2013_koodi = '05' or d6b.iscfibroad2013_koodi = '05' or d7b.iscfibroad2013_koodi = '05' or d8b.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4b.iscfibroad2013_koodi = '05' or d5b.iscfibroad2013_koodi = '05' or d6b.iscfibroad2013_koodi = '05' or d7b.iscfibroad2013_koodi = '05' or d8b.iscfibroad2013_koodi = '05' or d9b.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5b.iscfibroad2013_koodi = '05' or d6b.iscfibroad2013_koodi = '05' or d7b.iscfibroad2013_koodi = '05' or d8b.iscfibroad2013_koodi = '05' or d9b.iscfibroad2013_koodi = '05' or d10b.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6b.iscfibroad2013_koodi = '05' or d7b.iscfibroad2013_koodi = '05' or d8b.iscfibroad2013_koodi = '05' or d9b.iscfibroad2013_koodi = '05' or d10b.iscfibroad2013_koodi = '05' or d11b.iscfibroad2013_koodi = '05') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7b.iscfibroad2013_koodi = '05' or d8b.iscfibroad2013_koodi = '05' or d9b.iscfibroad2013_koodi = '05' or d10b.iscfibroad2013_koodi = '05' or d11b.iscfibroad2013_koodi = '05' or d12b.iscfibroad2013_koodi = '05') then 1*/
	else 0
end as opisk_yo_koulala5
--Opiskellut koulutusala6 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1b.iscfibroad2013_koodi = '06' or d2b.iscfibroad2013_koodi = '06' or d3b.iscfibroad2013_koodi = '06' or d4b.iscfibroad2013_koodi = '06' or d5b.iscfibroad2013_koodi = '06' or d6b.iscfibroad2013_koodi = '06') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2b.iscfibroad2013_koodi = '06' or d3b.iscfibroad2013_koodi = '06' or d4b.iscfibroad2013_koodi = '06' or d5b.iscfibroad2013_koodi = '06' or d6b.iscfibroad2013_koodi = '06' or d7b.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3b.iscfibroad2013_koodi = '06' or d4b.iscfibroad2013_koodi = '06' or d5b.iscfibroad2013_koodi = '06' or d6b.iscfibroad2013_koodi = '06' or d7b.iscfibroad2013_koodi = '06' or d8b.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4b.iscfibroad2013_koodi = '06' or d5b.iscfibroad2013_koodi = '06' or d6b.iscfibroad2013_koodi = '06' or d7b.iscfibroad2013_koodi = '06' or d8b.iscfibroad2013_koodi = '06' or d9b.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5b.iscfibroad2013_koodi = '06' or d6b.iscfibroad2013_koodi = '06' or d7b.iscfibroad2013_koodi = '06' or d8b.iscfibroad2013_koodi = '06' or d9b.iscfibroad2013_koodi = '06' or d10b.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6b.iscfibroad2013_koodi = '06' or d7b.iscfibroad2013_koodi = '06' or d8b.iscfibroad2013_koodi = '06' or d9b.iscfibroad2013_koodi = '06' or d10b.iscfibroad2013_koodi = '06' or d11b.iscfibroad2013_koodi = '06') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7b.iscfibroad2013_koodi = '06' or d8b.iscfibroad2013_koodi = '06' or d9b.iscfibroad2013_koodi = '06' or d10b.iscfibroad2013_koodi = '06' or d11b.iscfibroad2013_koodi = '06' or d12b.iscfibroad2013_koodi = '06') then 1*/
	else 0
end as opisk_yo_koulala6
--Opiskellut koulutusala7 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1b.iscfibroad2013_koodi = '07' or d2b.iscfibroad2013_koodi = '07' or d3b.iscfibroad2013_koodi = '07' or d4b.iscfibroad2013_koodi = '07' or d5b.iscfibroad2013_koodi = '07' or d6b.iscfibroad2013_koodi = '07') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2b.iscfibroad2013_koodi = '07' or d3b.iscfibroad2013_koodi = '07' or d4b.iscfibroad2013_koodi = '07' or d5b.iscfibroad2013_koodi = '07' or d6b.iscfibroad2013_koodi = '07' or d7b.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3b.iscfibroad2013_koodi = '07' or d4b.iscfibroad2013_koodi = '07' or d5b.iscfibroad2013_koodi = '07' or d6b.iscfibroad2013_koodi = '07' or d7b.iscfibroad2013_koodi = '07' or d8b.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4b.iscfibroad2013_koodi = '07' or d5b.iscfibroad2013_koodi = '07' or d6b.iscfibroad2013_koodi = '07' or d7b.iscfibroad2013_koodi = '07' or d8b.iscfibroad2013_koodi = '07' or d9b.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5b.iscfibroad2013_koodi = '07' or d6b.iscfibroad2013_koodi = '07' or d7b.iscfibroad2013_koodi = '07' or d8b.iscfibroad2013_koodi = '07' or d9b.iscfibroad2013_koodi = '07' or d10b.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6b.iscfibroad2013_koodi = '07' or d7b.iscfibroad2013_koodi = '07' or d8b.iscfibroad2013_koodi = '07' or d9b.iscfibroad2013_koodi = '07' or d10b.iscfibroad2013_koodi = '07' or d11b.iscfibroad2013_koodi = '07') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7b.iscfibroad2013_koodi = '07' or d8b.iscfibroad2013_koodi = '07' or d9b.iscfibroad2013_koodi = '07' or d10b.iscfibroad2013_koodi = '07' or d11b.iscfibroad2013_koodi = '07' or d12b.iscfibroad2013_koodi = '07') then 1*/
	else 0
end as opisk_yo_koulala7
--Opiskellut koulutusala8 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1b.iscfibroad2013_koodi = '08' or d2b.iscfibroad2013_koodi = '08' or d3b.iscfibroad2013_koodi = '08' or d4b.iscfibroad2013_koodi = '08' or d5b.iscfibroad2013_koodi = '08' or d6b.iscfibroad2013_koodi = '08') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2b.iscfibroad2013_koodi = '08' or d3b.iscfibroad2013_koodi = '08' or d4b.iscfibroad2013_koodi = '08' or d5b.iscfibroad2013_koodi = '08' or d6b.iscfibroad2013_koodi = '08' or d7b.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3b.iscfibroad2013_koodi = '08' or d4b.iscfibroad2013_koodi = '08' or d5b.iscfibroad2013_koodi = '08' or d6b.iscfibroad2013_koodi = '08' or d7b.iscfibroad2013_koodi = '08' or d8b.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4b.iscfibroad2013_koodi = '08' or d5b.iscfibroad2013_koodi = '08' or d6b.iscfibroad2013_koodi = '08' or d7b.iscfibroad2013_koodi = '08' or d8b.iscfibroad2013_koodi = '08' or d9b.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5b.iscfibroad2013_koodi = '08' or d6b.iscfibroad2013_koodi = '08' or d7b.iscfibroad2013_koodi = '08' or d8b.iscfibroad2013_koodi = '08' or d9b.iscfibroad2013_koodi = '08' or d10b.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6b.iscfibroad2013_koodi = '08' or d7b.iscfibroad2013_koodi = '08' or d8b.iscfibroad2013_koodi = '08' or d9b.iscfibroad2013_koodi = '08' or d10b.iscfibroad2013_koodi = '08' or d11b.iscfibroad2013_koodi = '08') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7b.iscfibroad2013_koodi = '08' or d8b.iscfibroad2013_koodi = '08' or d9b.iscfibroad2013_koodi = '08' or d10b.iscfibroad2013_koodi = '08' or d11b.iscfibroad2013_koodi = '08' or d12b.iscfibroad2013_koodi = '08') then 1*/
	else 0
end as opisk_yo_koulala8
--Opiskellut koulutusala9 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1b.iscfibroad2013_koodi = '09' or d2b.iscfibroad2013_koodi = '09' or d3b.iscfibroad2013_koodi = '09' or d4b.iscfibroad2013_koodi = '09' or d5b.iscfibroad2013_koodi = '09' or d6b.iscfibroad2013_koodi = '09') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2b.iscfibroad2013_koodi = '09' or d3b.iscfibroad2013_koodi = '09' or d4b.iscfibroad2013_koodi = '09' or d5b.iscfibroad2013_koodi = '09' or d6b.iscfibroad2013_koodi = '09' or d7b.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3b.iscfibroad2013_koodi = '09' or d4b.iscfibroad2013_koodi = '09' or d5b.iscfibroad2013_koodi = '09' or d6b.iscfibroad2013_koodi = '09' or d7b.iscfibroad2013_koodi = '09' or d8b.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4b.iscfibroad2013_koodi = '09' or d5b.iscfibroad2013_koodi = '09' or d6b.iscfibroad2013_koodi = '09' or d7b.iscfibroad2013_koodi = '09' or d8b.iscfibroad2013_koodi = '09' or d9b.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5b.iscfibroad2013_koodi = '09' or d6b.iscfibroad2013_koodi = '09' or d7b.iscfibroad2013_koodi = '09' or d8b.iscfibroad2013_koodi = '09' or d9b.iscfibroad2013_koodi = '09' or d10b.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6b.iscfibroad2013_koodi = '09' or d7b.iscfibroad2013_koodi = '09' or d8b.iscfibroad2013_koodi = '09' or d9b.iscfibroad2013_koodi = '09' or d10b.iscfibroad2013_koodi = '09' or d11b.iscfibroad2013_koodi = '09') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7b.iscfibroad2013_koodi = '09' or d8b.iscfibroad2013_koodi = '09' or d9b.iscfibroad2013_koodi = '09' or d10b.iscfibroad2013_koodi = '09' or d11b.iscfibroad2013_koodi = '09' or d12b.iscfibroad2013_koodi = '09') then 1*/
	else 0
end as opisk_yo_koulala9
--Opiskellut koulutusala10 (yo) (taso 1) (kyllä/ei)
,case
	when  l.suorlk = '1' and (d1b.iscfibroad2013_koodi = '10' or d2b.iscfibroad2013_koodi = '10' or d3b.iscfibroad2013_koodi = '10' or d4b.iscfibroad2013_koodi = '10' or d5b.iscfibroad2013_koodi = '10' or d6b.iscfibroad2013_koodi = '10') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (d2b.iscfibroad2013_koodi = '10' or d3b.iscfibroad2013_koodi = '10' or d4b.iscfibroad2013_koodi = '10' or d5b.iscfibroad2013_koodi = '10' or d6b.iscfibroad2013_koodi = '10' or d7b.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (d3b.iscfibroad2013_koodi = '10' or d4b.iscfibroad2013_koodi = '10' or d5b.iscfibroad2013_koodi = '10' or d6b.iscfibroad2013_koodi = '10' or d7b.iscfibroad2013_koodi = '10' or d8b.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (d4b.iscfibroad2013_koodi = '10' or d5b.iscfibroad2013_koodi = '10' or d6b.iscfibroad2013_koodi = '10' or d7b.iscfibroad2013_koodi = '10' or d8b.iscfibroad2013_koodi = '10' or d9b.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (d5b.iscfibroad2013_koodi = '10' or d6b.iscfibroad2013_koodi = '10' or d7b.iscfibroad2013_koodi = '10' or d8b.iscfibroad2013_koodi = '10' or d9b.iscfibroad2013_koodi = '10' or d10b.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (d6b.iscfibroad2013_koodi = '10' or d7b.iscfibroad2013_koodi = '10' or d8b.iscfibroad2013_koodi = '10' or d9b.iscfibroad2013_koodi = '10' or d10b.iscfibroad2013_koodi = '10' or d11b.iscfibroad2013_koodi = '10') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (d7b.iscfibroad2013_koodi = '10' or d8b.iscfibroad2013_koodi = '10' or d9b.iscfibroad2013_koodi = '10' or d10b.iscfibroad2013_koodi = '10' or d11b.iscfibroad2013_koodi = '10' or d12b.iscfibroad2013_koodi = '10') then 1*/
	else 0
end as opisk_yo_koulala10


--Opiskellut useampaa kuin yhtä alaa (taso 1) (kyllä/ei)
,case --ensimmäisenä vuotena on mahdollista olla vain yksi ala
	when  l.suorlk = '1' and m1.MinValue <> m1.MaxValue then 1 
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and m2.MinValue <> m2.MaxValue then 1 
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and m3.MinValue <> m3.MaxValue then 1 
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and m4.MinValue <> m4.MaxValue then 1 
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and m5.MinValue <> m5.MaxValue then 1 
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and m6.MinValue <> m6.MaxValue then 1 
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and m7.MinValue <> m7.MaxValue then 1 */
	else 0
end as opisk_vah2_koulala


----HAUT KYLLÄ/EI
--Hakenut ammatilliseen koulutukseen
,case
	when  l.suorlk = '1' and (l.monihaku_1 in (2,3,5) or l.monihaku_2 in (2,3,5) or l.monihaku_3 in (2,3,5) or l.monihaku_4 in (2,3,5) or l.monihaku_5 in (2,3,5) or l.monihaku_6 in (2,3,5)) then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.monihaku_2 in (2,3,5) or l.monihaku_3 in (2,3,5) or l.monihaku_4 in (2,3,5) or l.monihaku_5 in (2,3,5) or l.monihaku_6 in (2,3,5) or l.monihaku2010 in (2,3,5)) then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.monihaku_3 in (2,3,5) or l.monihaku_4 in (2,3,5) or l.monihaku_5 in (2,3,5) or l.monihaku_6 in (2,3,5) or l.monihaku2010 in (2,3,5) or l.monihaku2011 in (2,3,5)) then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.monihaku_4 in (2,3,5) or l.monihaku_5 in (2,3,5) or l.monihaku_6 in (2,3,5) or l.monihaku2010 in (2,3,5) or l.monihaku2011 in (2,3,5) or l.monihaku2012 in (2,3,5)) then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.monihaku_5 in (2,3,5) or l.monihaku_6 in (2,3,5) or l.monihaku2010 in (2,3,5) or l.monihaku2011 in (2,3,5) or l.monihaku2012 in (2,3,5) or l.monihaku2013 in (2,3,5)) then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.monihaku_6 in (2,3,5) or l.monihaku2010 in (2,3,5) or l.monihaku2011 in (2,3,5) or l.monihaku2012 in (2,3,5) or l.monihaku2013 in (2,3,5) or l.monihaku2014 in (2,3,5)) then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.monihaku2010 in (2,3,5) or l.monihaku2011 in (2,3,5) or l.monihaku2012 in (2,3,5) or l.monihaku2013 in (2,3,5) or l.monihaku2014 in (2,3,5) or l.monihaku2015 in (2,3,5)) then 1*/
	else 0
end as haku_amm
--Hakenut ammattikorkeakoulutukseen
,case
	when  l.suorlk = '1' and (l.monihaku_1 in (4,6) or l.monihaku_2 in (4,6) or l.monihaku_3 in (4,6) or l.monihaku_4 in (4,6) or l.monihaku_5 in (4,6) or l.monihaku_6 in (4,6)) then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.monihaku_2 in (4,6) or l.monihaku_3 in (4,6) or l.monihaku_4 in (4,6) or l.monihaku_5 in (4,6) or l.monihaku_6 in (4,6) or l.monihaku2010 in (4,6)) then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.monihaku_3 in (4,6) or l.monihaku_4 in (4,6) or l.monihaku_5 in (4,6) or l.monihaku_6 in (4,6) or l.monihaku2010 in (4,6) or l.monihaku2011 in (4,6)) then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.monihaku_4 in (4,6) or l.monihaku_5 in (4,6) or l.monihaku_6 in (4,6) or l.monihaku2010 in (4,6) or l.monihaku2011 in (4,6) or l.monihaku2012 in (4,6)) then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.monihaku_5 in (4,6) or l.monihaku_6 in (4,6) or l.monihaku2010 in (4,6) or l.monihaku2011 in (4,6) or l.monihaku2012 in (4,6) or l.monihaku2013 in (4,6)) then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.monihaku_6 in (4,6) or l.monihaku2010 in (4,6) or l.monihaku2011 in (4,6) or l.monihaku2012 in (4,6) or l.monihaku2013 in (4,6) or l.monihaku2014 in (4,6)) then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.monihaku2010 in (4,6) or l.monihaku2011 in (4,6) or l.monihaku2012 in (4,6) or l.monihaku2013 in (4,6) or l.monihaku2014 in (4,6) or l.monihaku2015 in (4,6)) then 1*/
	else 0
end as haku_amk
--Hakenut yliopistokoulutukseen
,case
	when  l.suorlk = '1' and (l.monihaku_1 in (6,7) or l.monihaku_2 in (6,7) or l.monihaku_3 in (6,7) or l.monihaku_4 in (6,7) or l.monihaku_5 in (6,7) or l.monihaku_6 in (6,7)) then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.monihaku_2 in (6,7) or l.monihaku_3 in (6,7) or l.monihaku_4 in (6,7) or l.monihaku_5 in (6,7) or l.monihaku_6 in (6,7) or l.monihaku2010 in (6,7)) then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.monihaku_3 in (6,7) or l.monihaku_4 in (6,7) or l.monihaku_5 in (6,7) or l.monihaku_6 in (6,7) or l.monihaku2010 in (6,7) or l.monihaku2011 in (6,7)) then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.monihaku_4 in (6,7) or l.monihaku_5 in (6,7) or l.monihaku_6 in (6,7) or l.monihaku2010 in (6,7) or l.monihaku2011 in (6,7) or l.monihaku2012 in (6,7)) then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.monihaku_5 in (6,7) or l.monihaku_6 in (6,7) or l.monihaku2010 in (6,7) or l.monihaku2011 in (6,7) or l.monihaku2012 in (6,7) or l.monihaku2013 in (6,7)) then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.monihaku_6 in (6,7) or l.monihaku2010 in (6,7) or l.monihaku2011 in (6,7) or l.monihaku2012 in (6,7) or l.monihaku2013 in (6,7) or l.monihaku2014 in (6,7)) then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.monihaku2010 in (6,7) or l.monihaku2011 in (6,7) or l.monihaku2012 in (6,7) or l.monihaku2013 in (6,7) or l.monihaku2014 in (6,7) or l.monihaku2015 in (6,7)) then 1*/
	else 0
end as haku_yo




----MITTARIT
--Ei hakenut eikä opiskellut mitään
,case
	when  l.suorlk = '1' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku_6 not in (4,5,6,7) and l.luopiskkoulk_1 = '' and l.ammopiskkoulk_1 = '' and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.luopiskkoulk_6 = '' and l.ammopiskkoulk_6 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku_6 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.luopiskkoulk_6 = '' and l.ammopiskkoulk_6 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku_6 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.luopiskkoulk_6 = '' and l.ammopiskkoulk_6 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku_6 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.luopiskkoulk_6 = '' and l.ammopiskkoulk_6 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and monihaku_5 not in (4,5,6,7) and monihaku_6 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.luopiskkoulk_6 = '' and l.ammopiskkoulk_6 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and monihaku_6 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and monihaku2014 not in (4,5,6,7) and l.luopiskkoulk_6 = '' and l.ammopiskkoulk_6 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and monihaku2014 not in (4,5,6,7) and monihaku2015 not in (4,5,6,7) and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' and l.luopiskkoulk2015 = '' and l.ammopiskkoulk2015 = '' and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' then 1*/
	else 0
end eihaku_kk_eiopisk

--Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa
,case 
	when  l.suorlk = '1' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku_6 not in (4,5,6,7) and (l.luopiskkoulk_1 <> '' or l.ammopiskkoulk_1 <> '' or l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.ammopiskkoulk_5 <> '' or l.luopiskkoulk_6 <> '' or l.ammopiskkoulk_6 <> '') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku_6 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and (l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.ammopiskkoulk_5 <> '' or l.luopiskkoulk_6 <> '' or l.ammopiskkoulk_6 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku_6 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and (l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.ammopiskkoulk_5 <> '' or l.luopiskkoulk_6 <> '' or l.ammopiskkoulk_6 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '') and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku_6 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and (l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.ammopiskkoulk_5 <> '' or l.luopiskkoulk_6 <> '' or l.ammopiskkoulk_6 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '') and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and monihaku_5 not in (4,5,6,7) and monihaku_6 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and (l.luopiskkoulk_5 <> '' or l.ammopiskkoulk_5 <> '' or l.luopiskkoulk_6 <> '' or l.ammopiskkoulk_6 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '' or l.ammopiskkoulk2013 <> '') and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and monihaku_6 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and monihaku2014 not in (4,5,6,7) and (l.luopiskkoulk_6 <> '' or l.ammopiskkoulk_6 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '' or l.ammopiskkoulk2013 <> '' or l.luopiskkoulk2014 <> '' or l.ammopiskkoulk2014 <> '') and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and monihaku2014 not in (4,5,6,7) and monihaku2015 not in (4,5,6,7) and (l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '' or l.ammopiskkoulk2013 <> '' or l.luopiskkoulk2014 <> '' or l.ammopiskkoulk2014 <> '' or l.luopiskkoulk2015 <> '' or l.ammopiskkoulk2015 <> '') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' then 1*/
	else 0
end eihaku_kk_eiopisk_kk_opisk_ta

----Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa, opiskellut lukiokoulutuksessa
,case 
	when  l.suorlk = '1' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku_6 not in (4,5,6,7) and (l.luopiskkoulk_1 <> '' or l.luopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.luopiskkoulk_6 <> '') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku_6 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and (l.luopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.luopiskkoulk_6 <> '' or l.luopiskkoulk2010 <> '') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku_6 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and (l.luopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.luopiskkoulk_6 <> '' or l.luopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '') and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku_6 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and (l.luopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.luopiskkoulk_6 <> '' or l.luopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '') and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and monihaku_5 not in (4,5,6,7) and monihaku_6 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and (l.luopiskkoulk_5 <> '' or l.luopiskkoulk_6 <> '' or l.luopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '') and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and monihaku_6 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and monihaku2014 not in (4,5,6,7) and (l.luopiskkoulk_6 <> '' or l.luopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '' or l.luopiskkoulk2014 <> '') and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and monihaku2014 not in (4,5,6,7) and monihaku2015 not in (4,5,6,7) and (l.luopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '' or l.luopiskkoulk2014 <> '' or l.luopiskkoulk2015 <> '') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' then 1*/
	else 0
end eihaku_kk_eiopisk_kk_opisk_lu

----Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa, opiskellut ammatillisessa peruskoulutuksessa
,case 
	when  l.suorlk = '1' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku_6 not in (4,5,6,7) and (d1c.Koulutusaste_taso2_koodi = '32' or d2c.Koulutusaste_taso2_koodi = '32' or d3c.Koulutusaste_taso2_koodi = '32' or d4c.Koulutusaste_taso2_koodi = '32' or d5c.Koulutusaste_taso2_koodi = '32' or d6c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku_6 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and (d2c.Koulutusaste_taso2_koodi = '32' or d3c.Koulutusaste_taso2_koodi = '32' or d4c.Koulutusaste_taso2_koodi = '32' or d5c.Koulutusaste_taso2_koodi = '32' or d6c.Koulutusaste_taso2_koodi = '32' or d7c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku_6 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and (d3c.Koulutusaste_taso2_koodi = '32' or d4c.Koulutusaste_taso2_koodi = '32' or d5c.Koulutusaste_taso2_koodi = '32' or d6c.Koulutusaste_taso2_koodi = '32' or d7c.Koulutusaste_taso2_koodi = '32' or d8c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku_6 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and (d4c.Koulutusaste_taso2_koodi = '32' or d5c.Koulutusaste_taso2_koodi = '32' or d6c.Koulutusaste_taso2_koodi = '32' or d7c.Koulutusaste_taso2_koodi = '32' or d8c.Koulutusaste_taso2_koodi = '32' or d9c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and monihaku_5 not in (4,5,6,7) and monihaku_6 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and (d5c.Koulutusaste_taso2_koodi = '32' or d6c.Koulutusaste_taso2_koodi = '32' or d7c.Koulutusaste_taso2_koodi = '32' or d8c.Koulutusaste_taso2_koodi = '32' or d9c.Koulutusaste_taso2_koodi = '32' or d10c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and monihaku_6 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and monihaku2014 not in (4,5,6,7) and (d6c.Koulutusaste_taso2_koodi = '32' or d7c.Koulutusaste_taso2_koodi = '32' or d8c.Koulutusaste_taso2_koodi = '32' or d9c.Koulutusaste_taso2_koodi = '32' or d10c.Koulutusaste_taso2_koodi = '32' or d11c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and monihaku2014 not in (4,5,6,7) and monihaku2015 not in (4,5,6,7) and (d7c.Koulutusaste_taso2_koodi = '32' or d8c.Koulutusaste_taso2_koodi = '32' or d9c.Koulutusaste_taso2_koodi = '32' or d10c.Koulutusaste_taso2_koodi = '32' or d11c.Koulutusaste_taso2_koodi = '32' or d12c.Koulutusaste_taso2_koodi = '32') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' then 1*/
	else 0
end eihaku_kk_eiopisk_kk_opisk_pk

------Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa, opiskellut ammattitutkintokoulutuksessa
,case 
	when  l.suorlk = '1' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku_6 not in (4,5,6,7) and (d1c.Koulutusaste_taso2_koodi = '33' or d2c.Koulutusaste_taso2_koodi = '33' or d3c.Koulutusaste_taso2_koodi = '33' or d4c.Koulutusaste_taso2_koodi = '33' or d5c.Koulutusaste_taso2_koodi = '33' or d6c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku_6 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and (d2c.Koulutusaste_taso2_koodi = '33' or d3c.Koulutusaste_taso2_koodi = '33' or d4c.Koulutusaste_taso2_koodi = '33' or d5c.Koulutusaste_taso2_koodi = '33' or d6c.Koulutusaste_taso2_koodi = '33' or d7c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku_6 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and (d3c.Koulutusaste_taso2_koodi = '33' or d4c.Koulutusaste_taso2_koodi = '33' or d5c.Koulutusaste_taso2_koodi = '33' or d6c.Koulutusaste_taso2_koodi = '33' or d7c.Koulutusaste_taso2_koodi = '33' or d8c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku_6 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and (d4c.Koulutusaste_taso2_koodi = '33' or d5c.Koulutusaste_taso2_koodi = '33' or d6c.Koulutusaste_taso2_koodi = '33' or d7c.Koulutusaste_taso2_koodi = '33' or d8c.Koulutusaste_taso2_koodi = '33' or d9c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and monihaku_5 not in (4,5,6,7) and monihaku_6 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and (d5c.Koulutusaste_taso2_koodi = '33' or d6c.Koulutusaste_taso2_koodi = '33' or d7c.Koulutusaste_taso2_koodi = '33' or d8c.Koulutusaste_taso2_koodi = '33' or d9c.Koulutusaste_taso2_koodi = '33' or d10c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and monihaku_6 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and monihaku2014 not in (4,5,6,7) and (d6c.Koulutusaste_taso2_koodi = '33' or d7c.Koulutusaste_taso2_koodi = '33' or d8c.Koulutusaste_taso2_koodi = '33' or d9c.Koulutusaste_taso2_koodi = '33' or d10c.Koulutusaste_taso2_koodi = '33' or d11c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and monihaku2014 not in (4,5,6,7) and monihaku2015 not in (4,5,6,7) and (d7c.Koulutusaste_taso2_koodi = '33' or d8c.Koulutusaste_taso2_koodi = '33' or d9c.Koulutusaste_taso2_koodi = '33' or d10c.Koulutusaste_taso2_koodi = '33' or d11c.Koulutusaste_taso2_koodi = '33' or d12c.Koulutusaste_taso2_koodi = '33') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' then 1*/
	else 0
end eihaku_kk_eiopisk_kk_opisk_at

------Ei hakenut eikä opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa, opiskellut erikoisammattitutkintokoulutuksessa
,case 
	when  l.suorlk = '1' and monihaku_1 not in (4,5,6,7) and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku_6 not in (4,5,6,7) and (d1c.Koulutusaste_taso2_koodi = '41' or d2c.Koulutusaste_taso2_koodi = '41' or d3c.Koulutusaste_taso2_koodi = '41' or d4c.Koulutusaste_taso2_koodi = '41' or d5c.Koulutusaste_taso2_koodi = '41' or d6c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and monihaku_2 not in (4,5,6,7) and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku_6 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and (d2c.Koulutusaste_taso2_koodi = '41' or d3c.Koulutusaste_taso2_koodi = '41' or d4c.Koulutusaste_taso2_koodi = '41' or d5c.Koulutusaste_taso2_koodi = '41' or d6c.Koulutusaste_taso2_koodi = '41' or d7c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and monihaku_3 not in (4,5,6,7) and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku_6 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and (d3c.Koulutusaste_taso2_koodi = '41' or d4c.Koulutusaste_taso2_koodi = '41' or d5c.Koulutusaste_taso2_koodi = '41' or d6c.Koulutusaste_taso2_koodi = '41' or d7c.Koulutusaste_taso2_koodi = '41' or d8c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and monihaku_4 not in (4,5,6,7) and monihaku_5 not in (4,5,6,7) and monihaku_6 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and (d4c.Koulutusaste_taso2_koodi = '41' or d5c.Koulutusaste_taso2_koodi = '41' or d6c.Koulutusaste_taso2_koodi = '41' or d7c.Koulutusaste_taso2_koodi = '41' or d8c.Koulutusaste_taso2_koodi = '41' or d9c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and monihaku_5 not in (4,5,6,7) and monihaku_6 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and (d5c.Koulutusaste_taso2_koodi = '41' or d6c.Koulutusaste_taso2_koodi = '41' or d7c.Koulutusaste_taso2_koodi = '41' or d8c.Koulutusaste_taso2_koodi = '41' or d9c.Koulutusaste_taso2_koodi = '41' or d10c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and monihaku_6 not in (4,5,6,7) and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and monihaku2014 not in (4,5,6,7) and (d6c.Koulutusaste_taso2_koodi = '41' or d7c.Koulutusaste_taso2_koodi = '41' or d8c.Koulutusaste_taso2_koodi = '41' or d9c.Koulutusaste_taso2_koodi = '41' or d10c.Koulutusaste_taso2_koodi = '41' or d11c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and monihaku2010 not in (4,5,6,7) and monihaku2011 not in (4,5,6,7) and monihaku2012 not in (4,5,6,7) and monihaku2013 not in (4,5,6,7) and monihaku2014 not in (4,5,6,7) and monihaku2015 not in (4,5,6,7) and (d7c.Koulutusaste_taso2_koodi = '41' or d8c.Koulutusaste_taso2_koodi = '41' or d9c.Koulutusaste_taso2_koodi = '41' or d10c.Koulutusaste_taso2_koodi = '41' or d11c.Koulutusaste_taso2_koodi = '41' or d12c.Koulutusaste_taso2_koodi = '41') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' then 1*/
	else 0
end eihaku_kk_eiopisk_kk_opisk_eat

--Hakenut korkea-asteelle, ei opiskellut korkea-asteella
,case 
	when  l.suorlk = '1' and (monihaku_1 in (4,5,6,7) or monihaku_2 in (4,5,6,7) or monihaku_3 in (4,5,6,7) or monihaku_4 in (4,5,6,7) or monihaku_5 in (4,5,6,7) or monihaku_6 in (4,5,6,7)) and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (monihaku_2 in (4,5,6,7) or monihaku_3 in (4,5,6,7) or monihaku_4 in (4,5,6,7) or monihaku_5 in (4,5,6,7) or monihaku_6 in (4,5,6,7) or monihaku2010 in (4,5,6,7)) and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (monihaku_3 in (4,5,6,7) or monihaku_4 in (4,5,6,7) or monihaku_5 in (4,5,6,7) or monihaku_6 in (4,5,6,7) or monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7)) and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (monihaku_4 in (4,5,6,7) or monihaku_5 in (4,5,6,7) or monihaku_6 in (4,5,6,7) or monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7) or monihaku2012 in (4,5,6,7)) and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (monihaku_5 in (4,5,6,7) or monihaku_6 in (4,5,6,7) or monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7) or monihaku2012 in (4,5,6,7) or monihaku2013 in (4,5,6,7)) and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (monihaku_6 in (4,5,6,7) or monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7) or monihaku2012 in (4,5,6,7) or monihaku2013 in (4,5,6,7) or monihaku2014 in (4,5,6,7)) and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7) or monihaku2012 in (4,5,6,7) or monihaku2013 in (4,5,6,7) or monihaku2014 in (4,5,6,7) or monihaku2015 in (4,5,6,7)) and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' then 1*/
	else 0
end haku_kk_eiopisk_kk
----Hakenut korkea-asteelle, ei opiskellut korkea-asteella, ei-opiskellut toisen asteen koulutuksessa
,case
	when  l.suorlk = '1' and (monihaku_1 in (4,5,6,7) or monihaku_2 in (4,5,6,7) or monihaku_3 in (4,5,6,7) or monihaku_4 in (4,5,6,7) or monihaku_5 in (4,5,6,7) or monihaku_6 in (4,5,6,7)) and l.luopiskkoulk_1 = '' and l.ammopiskkoulk_1 = '' and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.luopiskkoulk_6 = '' and l.ammopiskkoulk_6 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (monihaku_2 in (4,5,6,7) or monihaku_3 in (4,5,6,7) or monihaku_4 in (4,5,6,7) or monihaku_5 in (4,5,6,7) or monihaku_6 in (4,5,6,7) or monihaku2010 in (4,5,6,7)) and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.luopiskkoulk_6 = '' and l.ammopiskkoulk_6 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (monihaku_3 in (4,5,6,7) or monihaku_4 in (4,5,6,7) or monihaku_5 in (4,5,6,7) or monihaku_6 in (4,5,6,7) or monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7)) and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.luopiskkoulk_6 = '' and l.ammopiskkoulk_6 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (monihaku_4 in (4,5,6,7) or monihaku_5 in (4,5,6,7) or monihaku_6 in (4,5,6,7) or monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7) or monihaku2012 in (4,5,6,7)) and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.luopiskkoulk_6 = '' and l.ammopiskkoulk_6 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (monihaku_5 in (4,5,6,7) or monihaku_6 in (4,5,6,7) or monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7) or monihaku2012 in (4,5,6,7) or monihaku2013 in (4,5,6,7)) and l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.luopiskkoulk_6 = '' and l.ammopiskkoulk_6 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (monihaku_6 in (4,5,6,7) or monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7) or monihaku2012 in (4,5,6,7) or monihaku2013 in (4,5,6,7) or monihaku2014 in (4,5,6,7)) and l.luopiskkoulk_6 = '' and l.ammopiskkoulk_6 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7) or monihaku2012 in (4,5,6,7) or monihaku2013 in (4,5,6,7) or monihaku2014 in (4,5,6,7) or monihaku2015 in (4,5,6,7)) and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' and l.luopiskkoulk2015 = '' and l.ammopiskkoulk2015 = '' and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' then 1*/
	else 0
end haku_kk_eiopisk_kk_eiopisk_ta
----Hakenut korkea-asteelle, ei opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa
,case
	when  l.suorlk = '1' and (monihaku_1 in (4,5,6,7) or monihaku_2 in (4,5,6,7) or monihaku_3 in (4,5,6,7) or monihaku_4 in (4,5,6,7) or monihaku_5 in (4,5,6,7) or monihaku_6 in (4,5,6,7)) and (l.luopiskkoulk_1 <> '' or l.ammopiskkoulk_1 <> '' or l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.ammopiskkoulk_5 <> '' or l.luopiskkoulk_6 <> '' or l.ammopiskkoulk_6 <> '') and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (monihaku_2 in (4,5,6,7) or monihaku_3 in (4,5,6,7) or monihaku_4 in (4,5,6,7) or monihaku_5 in (4,5,6,7) or monihaku_6 in (4,5,6,7) or monihaku2010 in (4,5,6,7)) and (l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.ammopiskkoulk_5 <> '' or l.luopiskkoulk_6 <> '' or l.ammopiskkoulk_6 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '') and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (monihaku_3 in (4,5,6,7) or monihaku_4 in (4,5,6,7) or monihaku_5 in (4,5,6,7) or monihaku_6 in (4,5,6,7) or monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7)) and (l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.ammopiskkoulk_5 <> '' or l.luopiskkoulk_6 <> '' or l.ammopiskkoulk_6 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '') and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (monihaku_4 in (4,5,6,7) or monihaku_5 in (4,5,6,7) or monihaku_6 in (4,5,6,7) or monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7) or monihaku2012 in (4,5,6,7)) and (l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.ammopiskkoulk_5 <> '' or l.luopiskkoulk_6 <> '' or l.ammopiskkoulk_6 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '') and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (monihaku_5 in (4,5,6,7) or monihaku_6 in (4,5,6,7) or monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7) or monihaku2012 in (4,5,6,7) or monihaku2013 in (4,5,6,7)) and (l.luopiskkoulk_5 <> '' or l.ammopiskkoulk_5 <> '' or l.luopiskkoulk_6 <> '' or l.ammopiskkoulk_6 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '' or l.ammopiskkoulk2013 <> '') and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (monihaku_6 in (4,5,6,7) or monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7) or monihaku2012 in (4,5,6,7) or monihaku2013 in (4,5,6,7) or monihaku2014 in (4,5,6,7)) and (l.luopiskkoulk_6 <> '' or l.ammopiskkoulk_6 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '' or l.ammopiskkoulk2013 <> '' or l.luopiskkoulk2014 <> '' or l.ammopiskkoulk2014 <> '') and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (monihaku2010 in (4,5,6,7) or monihaku2011 in (4,5,6,7) or monihaku2012 in (4,5,6,7) or monihaku2013 in (4,5,6,7) or monihaku2014 in (4,5,6,7) or monihaku2015 in (4,5,6,7)) and (l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '' or l.ammopiskkoulk2013 <> '' or l.luopiskkoulk2014 <> '' or l.ammopiskkoulk2014 <> '' or l.luopiskkoulk2015 <> '' or l.ammopiskkoulk2015 <> '') and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' then 1*/
	else 0
end haku_kk_eiopisk_kk_opisk_ta
----Hakenut vain ammattikorkeakouluun, ei opiskellut korkea-asteella
,case
	when  l.suorlk = '1' and (monihaku_1 = 4 or monihaku_2 = 4 or monihaku_3 = 4 or monihaku_4 = 4 or monihaku_5 = 4 or monihaku_6 = 4) and (monihaku_1 not in (5,6,7) and monihaku_2 not in (5,6,7) and monihaku_3 not in (5,6,7) and monihaku_4 not in (5,6,7) and monihaku_5 not in (5,6,7) and monihaku_6 not in (5,6,7)) and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (monihaku_2 = 4 or monihaku_3 = 4 or monihaku_4 = 4 or monihaku_5 = 4 or monihaku_6 = 4 or monihaku2010 = 4) and (monihaku_2 not in (5,6,7) and monihaku_3 not in (5,6,7) and monihaku_4 not in (5,6,7) and monihaku_5 not in (5,6,7) and monihaku_6 not in (5,6,7) and monihaku2010 not in (5,6,7)) and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (monihaku_3 = 4 or monihaku_4 = 4 or monihaku_5 = 4 or monihaku_6 = 4 or monihaku2010 = 4 or monihaku2011 = 4) and (monihaku_3 not in (5,6,7) and monihaku_4 not in (5,6,7) and monihaku_5 not in (5,6,7) and monihaku_6 not in (5,6,7) and monihaku2010 not in (5,6,7) and monihaku2011 not in (5,6,7)) and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (monihaku_4 = 4 or monihaku_5 = 4 or monihaku_6 = 4 or monihaku2010 = 4 or monihaku2011 = 4 or monihaku2012 = 4) and (monihaku_4 not in (5,6,7) and monihaku_5 not in (5,6,7) and monihaku_6 not in (5,6,7) and monihaku2010 not in (5,6,7) and monihaku2011 not in (5,6,7) and monihaku2012 not in (5,6,7)) and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (monihaku_5 = 4 or monihaku_6 = 4 or monihaku2010 = 4 or monihaku2011 = 4 or monihaku2012 = 4 or monihaku2013 = 4) and (monihaku_5 not in (5,6,7) and monihaku_6 not in (5,6,7) and monihaku2010 not in (5,6,7) and monihaku2011 not in (5,6,7) and monihaku2012 not in (5,6,7) and monihaku2013 not in (5,6,7)) and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (monihaku_6 = 4 or monihaku2010 = 4 or monihaku2011 = 4 or monihaku2012 = 4 or monihaku2013 = 4 or monihaku2014 = 4) and (monihaku_6 not in (5,6,7) and monihaku2010 not in (5,6,7) and monihaku2011 not in (5,6,7) and monihaku2012 not in (5,6,7) and monihaku2013 not in (5,6,7) and monihaku2014 not in (5,6,7)) and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (monihaku2010 = 4 or monihaku2011 = 4 or monihaku2012 = 4 or monihaku2013 = 4 or monihaku2014 = 4 or monihaku2015 = 4) and (monihaku2010 not in (5,6,7) and monihaku2011 not in (5,6,7) and monihaku2012 not in (5,6,7) and monihaku2013 not in (5,6,7) and monihaku2014 not in (5,6,7) and monihaku2015 not in (5,6,7)) and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' then 1*/
	else 0
end haku_amk_eiopisk_kk
----Hakenut vain yliopistokoulutukseen, ei opiskellut korkea-asteella
,case
	when  l.suorlk = '1' and (monihaku_1 = 7 or monihaku_2 = 7 or monihaku_3 = 7 or monihaku_4 = 7 or monihaku_5 = 7 or monihaku_6 = 7) and (monihaku_1 not in (4,5,6) and monihaku_2 not in (4,5,6) and monihaku_3 not in (4,5,6) and monihaku_4 not in (4,5,6) and monihaku_5 not in (4,5,6) and monihaku_6 not in (4,5,6)) and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (monihaku_2 = 7 or monihaku_3 = 7 or monihaku_4 = 7 or monihaku_5 = 7 or monihaku_6 = 7 or monihaku2010 = 7) and (monihaku_2 not in (4,5,6) and monihaku_3 not in (4,5,6) and monihaku_4 not in (4,5,6) and monihaku_5 not in (4,5,6) and monihaku_6 not in (4,5,6) and monihaku2010 not in (4,5,6)) and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (monihaku_3 = 7 or monihaku_4 = 7 or monihaku_5 = 7 or monihaku_6 = 7 or monihaku2010 = 7 or monihaku2011 = 7) and (monihaku_3 not in (4,5,6) and monihaku_4 not in (4,5,6) and monihaku_5 not in (4,5,6) and monihaku_6 not in (4,5,6) and monihaku2010 not in (4,5,6) and monihaku2011 not in (4,5,6)) and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (monihaku_4 = 7 or monihaku_5 = 7 or monihaku_6 = 7 or monihaku2010 = 7 or monihaku2011 = 7 or monihaku2012 = 7) and (monihaku_4 not in (4,5,6) and monihaku_5 not in (4,5,6) and monihaku_6 not in (4,5,6) and monihaku2010 not in (4,5,6) and monihaku2011 not in (4,5,6) and monihaku2012 not in (4,5,6)) and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (monihaku_5 = 7 or monihaku_6 = 7 or monihaku2010 = 7 or monihaku2011 = 7 or monihaku2012 = 7 or monihaku2013 = 7) and (monihaku_5 not in (4,5,6) and monihaku_6 not in (4,5,6) and monihaku2010 not in (4,5,6) and monihaku2011 not in (4,5,6) and monihaku2012 not in (4,5,6) and monihaku2013 not in (4,5,6)) and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (monihaku_6 = 7 or monihaku2010 = 7 or monihaku2011 = 7 or monihaku2012 = 7 or monihaku2013 = 7 or monihaku2014 = 7) and (monihaku_6 not in (4,5,6) and monihaku2010 not in (4,5,6) and monihaku2011 not in (4,5,6) and monihaku2012 not in (4,5,6) and monihaku2013 not in (4,5,6) and monihaku2014 not in (4,5,6)) and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (monihaku2010 = 7 or monihaku2011 = 7 or monihaku2012 = 7 or monihaku2013 = 7 or monihaku2014 = 7 or monihaku2015 = 7) and (monihaku2010 not in (4,5,6) and monihaku2011 not in (4,5,6) and monihaku2012 not in (4,5,6) and monihaku2013 not in (4,5,6) and monihaku2014 not in (4,5,6) and monihaku2015 not in (4,5,6)) and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' then 1*/
	else 0
end haku_yo_eiopisk_kk
----Hakenut sekä amk- että yliopistokoulutukseen, ei opiskellut korkea-asteella
,case
	when  l.suorlk = '1' and (monihaku_1 = 6 or monihaku_2 = 6 or monihaku_3 = 6 or monihaku_4 = 6 or monihaku_5 = 6 or monihaku_6 = 6 or ((monihaku_1 = 4 or monihaku_2 = 4 or monihaku_3 = 4 or monihaku_4 = 4 or monihaku_5 = 4 or monihaku_6 = 4) and (monihaku_1 = 7 or monihaku_2 = 7 or monihaku_3 = 7 or monihaku_4 = 7 or monihaku_5 = 7 or monihaku_6 = 7))) and l.amkopiskkoulk_1 = '' and l.yoopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (monihaku_2 = 6 or monihaku_3 = 6 or monihaku_4 = 6 or monihaku_5 = 6 or monihaku_6 = 6 or monihaku2010 = 6 or ((monihaku_2 = 4 or monihaku_3 = 4 or monihaku_4 = 4 or monihaku_5 = 4 or monihaku_6 = 4 or monihaku2010 = 4) and (monihaku_2 = 7 or monihaku_3 = 7 or monihaku_4 = 7 or monihaku_5 = 7 or monihaku_6 = 7 or monihaku2010 = 7))) and l.amkopiskkoulk_2 = '' and l.yoopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (monihaku_3 = 6 or monihaku_4 = 6 or monihaku_5 = 6 or monihaku_6 = 6 or monihaku2010 = 6 or monihaku2011 = 6 or ((monihaku_3 = 4 or monihaku_4 = 4 or monihaku_5 = 4 or monihaku_6 = 4 or monihaku2010 = 4 or monihaku2011 = 4) and (monihaku_3 = 7 or monihaku_4 = 7 or monihaku_5 = 7 or monihaku_6 = 7 or monihaku2010 = 7 or monihaku2011 = 7))) and l.amkopiskkoulk_3 = '' and l.yoopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (monihaku_4 = 6 or monihaku_5 = 6 or monihaku_6 = 6 or monihaku2010 = 6 or monihaku2011 = 6 or monihaku2012 = 6 or ((monihaku_4 = 4 or monihaku_5 = 4 or monihaku_6 = 4 or monihaku2010 = 4 or monihaku2011 = 4 or monihaku2012 = 4) and (monihaku_4 = 7 or monihaku_5 = 7 or monihaku_6 = 7 or monihaku2010 = 7 or monihaku2011 = 7 or monihaku2012 = 7))) and l.amkopiskkoulk_4 = '' and l.yoopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (monihaku_5 = 6 or monihaku_6 = 6 or monihaku2010 = 6 or monihaku2011 = 6 or monihaku2012 = 6 or monihaku2013 = 6 or ((monihaku_5 = 4 or monihaku_6 = 4 or monihaku2010 = 4 or monihaku2011 = 4 or monihaku2012 = 4 or monihaku2013 = 4) and (monihaku_5 = 7 or monihaku_6 = 7 or monihaku2010 = 7 or monihaku2011 = 7 or monihaku2012 = 7 or monihaku2013 = 7))) and l.amkopiskkoulk_5 = '' and l.yoopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (monihaku_6 = 6 or monihaku2010 = 6 or monihaku2011 = 6 or monihaku2012 = 6 or monihaku2013 = 6 or monihaku2014 = 6 or ((monihaku_6 = 4 or monihaku2010 = 4 or monihaku2011 = 4 or monihaku2012 = 4 or monihaku2013 = 4 or monihaku2014 = 4) and (monihaku_6 = 7 or monihaku2010 = 7 or monihaku2011 = 7 or monihaku2012 = 7 or monihaku2013 = 7 or monihaku2014 = 7))) and l.amkopiskkoulk_6 = '' and l.yoopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (monihaku2010 = 6 or monihaku2011 = 6 or monihaku2012 = 6 or monihaku2013 = 6 or monihaku2014 = 6 or monihaku2015 = 6 or ((monihaku2010 = 4 or monihaku2011 = 4 or monihaku2012 = 4 or monihaku2013 = 4 or monihaku2014 = 4 or monihaku2015 = 4) and (monihaku2010 = 7 or monihaku2011 = 7 or monihaku2012 = 7 or monihaku2013 = 7 or monihaku2014 = 7 or monihaku2015 = 7))) and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' and l.amkopiskkoulk2015 = '' and l.yoopiskkoulk2015 = '' then 1*/
	else 0
end haku_amkyo_eiopisk_kk

--Opiskellut korkea-asteella
,case
	when  l.suorlk = '1' and (l.amkopiskkoulk_1 <> '' or l.yoopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.yoopiskkoulk_5 <> '' or l.amkopiskkoulk_6 <> '' or l.yoopiskkoulk_6 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.yoopiskkoulk_5 <> '' or l.amkopiskkoulk_6 <> '' or l.yoopiskkoulk_6 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.yoopiskkoulk_5 <> '' or l.amkopiskkoulk_6 <> '' or l.yoopiskkoulk_6 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.yoopiskkoulk_5 <> '' or l.amkopiskkoulk_6 <> '' or l.yoopiskkoulk_6 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk_5 <> '' or l.yoopiskkoulk_5 <> '' or l.amkopiskkoulk_6 <> '' or l.yoopiskkoulk_6 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '' or l.yoopiskkoulk2013 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk_6 <> '' or l.yoopiskkoulk_6 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '' or l.yoopiskkoulk2013 <> '' or l.amkopiskkoulk2014 <> '' or l.yoopiskkoulk2014 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '' or l.yoopiskkoulk2013 <> '' or l.amkopiskkoulk2014 <> '' or l.yoopiskkoulk2014 <> '' or l.amkopiskkoulk2015 <> '' or l.yoopiskkoulk2015 <> '') then 1*/
	else 0
end opisk_kk
----Opiskellut korkea-asteella, ei-opiskellut toisen asteen koulutuksessa
,case
	when  l.suorlk = '1' and l.luopiskkoulk_1 = '' and l.ammopiskkoulk_1 = '' and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = '' and l.luopiskkoulk_6 = '' and l.ammopiskkoulk_6 = '' and (l.amkopiskkoulk_1 <> '' or l.yoopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.yoopiskkoulk_5 <> '' or l.amkopiskkoulk_6 <> '' or l.yoopiskkoulk_6 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and l.luopiskkoulk_2 = '' and l.ammopiskkoulk_2 = '' and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = '' and l.luopiskkoulk_6 = '' and l.ammopiskkoulk_6 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and (l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.yoopiskkoulk_5 <> '' or l.amkopiskkoulk_6 <> '' or l.yoopiskkoulk_6 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and l.luopiskkoulk_3 = '' and l.ammopiskkoulk_3 = '' and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = '' and l.luopiskkoulk_6 = '' and l.ammopiskkoulk_6 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and (l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.yoopiskkoulk_5 <> '' or l.amkopiskkoulk_6 <> '' or l.yoopiskkoulk_6 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and l.luopiskkoulk_4 = '' and l.ammopiskkoulk_4 = '' and l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = '' and l.luopiskkoulk_6 = '' and l.ammopiskkoulk_6 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and (l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.yoopiskkoulk_5 <> '' or l.amkopiskkoulk_6 <> '' or l.yoopiskkoulk_6 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and l.luopiskkoulk_5 = '' and l.ammopiskkoulk_5 = '' and l.luopiskkoulk_6 = '' and l.ammopiskkoulk_6 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = '' and (l.amkopiskkoulk_5 <> '' or l.yoopiskkoulk_5 <> '' or l.amkopiskkoulk_6 <> '' or l.yoopiskkoulk_6 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '' or l.yoopiskkoulk2013 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and l.luopiskkoulk_6 = '' and l.ammopiskkoulk_6 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = '' and l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 = '' and (l.amkopiskkoulk_6 <> '' or l.yoopiskkoulk_6 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '' or l.yoopiskkoulk2013 <> '' or l.amkopiskkoulk2014 <> '' or l.yoopiskkoulk2014 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' and l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = '' and l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 = '' and l.luopiskkoulk2015 = '' and l.ammopiskkoulk2015 = '' and (l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '' or l.yoopiskkoulk2013 <> '' or l.amkopiskkoulk2014 <> '' or l.yoopiskkoulk2014 <> '' or l.amkopiskkoulk2015 <> '' or l.yoopiskkoulk2015 <> '') then 1*/
	else 0
end opisk_kk_eiopisk_ta
----Opiskellut korkea-asteella, opiskellut toisen asteen koulutuksessa
,case
	when  l.suorlk = '1' and (l.luopiskkoulk_1 <> '' or l.ammopiskkoulk_1 <> '' or l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.ammopiskkoulk_5 <> '' or l.luopiskkoulk_6 <> '' or l.ammopiskkoulk_6 <> '') and (l.amkopiskkoulk_1 <> '' or l.yoopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.yoopiskkoulk_5 <> '' or l.amkopiskkoulk_6 <> '' or l.yoopiskkoulk_6 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk_2 <> '' or l.ammopiskkoulk_2 <> '' or l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.ammopiskkoulk_5 <> '' or l.luopiskkoulk_6 <> '' or l.ammopiskkoulk_6 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '') and (l.amkopiskkoulk_2 <> '' or l.yoopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.yoopiskkoulk_5 <> '' or l.amkopiskkoulk_6 <> '' or l.yoopiskkoulk_6 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk_3 <> '' or l.ammopiskkoulk_3 <> '' or l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.ammopiskkoulk_5 <> '' or l.luopiskkoulk_6 <> '' or l.ammopiskkoulk_6 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '') and (l.amkopiskkoulk_3 <> '' or l.yoopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.yoopiskkoulk_5 <> '' or l.amkopiskkoulk_6 <> '' or l.yoopiskkoulk_6 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk_4 <> '' or l.ammopiskkoulk_4 <> '' or l.luopiskkoulk_5 <> '' or l.ammopiskkoulk_5 <> '' or l.luopiskkoulk_6 <> '' or l.ammopiskkoulk_6 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '') and (l.amkopiskkoulk_4 <> '' or l.yoopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.yoopiskkoulk_5 <> '' or l.amkopiskkoulk_6 <> '' or l.yoopiskkoulk_6 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk_5 <> '' or l.ammopiskkoulk_5 <> '' or l.luopiskkoulk_6 <> '' or l.ammopiskkoulk_6 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '' or l.ammopiskkoulk2013 <> '') and (l.amkopiskkoulk_5 <> '' or l.yoopiskkoulk_5 <> '' or l.amkopiskkoulk_6 <> '' or l.yoopiskkoulk_6 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '' or l.yoopiskkoulk2013 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk_6 <> '' or l.ammopiskkoulk_6 <> '' or l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '' or l.ammopiskkoulk2013 <> '' or l.luopiskkoulk2014 <> '' or l.ammopiskkoulk2014 <> '') and (l.amkopiskkoulk_6 <> '' or l.yoopiskkoulk_6 <> '' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '' or l.yoopiskkoulk2013 <> '' or l.amkopiskkoulk2014 <> '' or l.yoopiskkoulk2014 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010 <> '' or l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011 <> '' or l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012 <> '' or l.luopiskkoulk2013 <> '' or l.ammopiskkoulk2013 <> '' or l.luopiskkoulk2014 <> '' or l.ammopiskkoulk2014 <> '' or l.luopiskkoulk2015 <> '' or l.ammopiskkoulk2015 <> '') and (l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '' or l.yoopiskkoulk2013 <> '' or l.amkopiskkoulk2014 <> '' or l.yoopiskkoulk2014 <> '' or l.amkopiskkoulk2015 <> '' or l.yoopiskkoulk2015 <> '') then 1*/
	else 0
end opisk_kk_opisk_ta
----Opiskellut vain ammattikorkeakoulussa
,case
	when  l.suorlk = '1' and (l.amkopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.amkopiskkoulk_6 <> '') and l.yoopiskkoulk_1 = '' and l.yoopiskkoulk_2 = '' and l.yoopiskkoulk_3 = '' and l.yoopiskkoulk_4 = '' and l.yoopiskkoulk_5 = '' and l.yoopiskkoulk_6 = '' then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.amkopiskkoulk_6 <> '' or l.amkopiskkoulk2010 <> '') and l.yoopiskkoulk_2 = '' and l.yoopiskkoulk_3 = '' and l.yoopiskkoulk_4 = '' and l.yoopiskkoulk_5 = '' and l.yoopiskkoulk_6 = '' and l.yoopiskkoulk2010 = '' then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.amkopiskkoulk_6 <> '' or l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '') and l.yoopiskkoulk_3 = '' and l.yoopiskkoulk_4 = '' and l.yoopiskkoulk_5 = '' and l.yoopiskkoulk_6 = '' and l.yoopiskkoulk2010 = '' and l.yoopiskkoulk2011 = '' then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.amkopiskkoulk_6 <> '' or l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '') and l.yoopiskkoulk_4 = '' and l.yoopiskkoulk_5 = '' and l.yoopiskkoulk_6 = '' and l.yoopiskkoulk2010 = '' and l.yoopiskkoulk2011 = '' and l.yoopiskkoulk2012 = '' then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk_5 <> '' or l.amkopiskkoulk_6 <> '' or l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '') and l.yoopiskkoulk_5 = '' and l.yoopiskkoulk_6 = '' and l.yoopiskkoulk2010 = '' and l.yoopiskkoulk2011 = '' and l.yoopiskkoulk2012 = '' and l.yoopiskkoulk2013 = '' then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk_6 <> '' or l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '' or l.amkopiskkoulk2014 <> '') and l.yoopiskkoulk_6 = '' and l.yoopiskkoulk2010 = '' and l.yoopiskkoulk2011 = '' and l.yoopiskkoulk2012 = '' and l.yoopiskkoulk2013 = '' and l.yoopiskkoulk2014 = '' then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '' or l.amkopiskkoulk2014 <> '' or l.amkopiskkoulk2015 <> '') and l.yoopiskkoulk2010 = '' and l.yoopiskkoulk2011 = '' and l.yoopiskkoulk2012 = '' and l.yoopiskkoulk2013 = '' and l.yoopiskkoulk2014 = '' and l.yoopiskkoulk2015 = '' then 1*/
	else 0
end opisk_vain_amk
----Opiskellut vain yliopistokoulutuksessa
,case
	when  l.suorlk = '1' and l.amkopiskkoulk_1 = '' and l.amkopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and (l.yoopiskkoulk_1 <> '' or l.yoopiskkoulk_2 <> '' or l.yoopiskkoulk_3 <> '' or l.yoopiskkoulk_4 <> '' or l.yoopiskkoulk_5 <> '' or l.yoopiskkoulk_6 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and l.amkopiskkoulk_2 = '' and l.amkopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and (l.yoopiskkoulk_2 <> '' or l.yoopiskkoulk_3 <> '' or l.yoopiskkoulk_4 <> '' or l.yoopiskkoulk_5 <> '' or l.yoopiskkoulk_6 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and l.amkopiskkoulk_3 = '' and l.amkopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and (l.yoopiskkoulk_3 <> '' or l.yoopiskkoulk_4 <> '' or l.yoopiskkoulk_5 <> '' or l.yoopiskkoulk_6 <> '' or l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and l.amkopiskkoulk_4 = '' and l.amkopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and (l.yoopiskkoulk_4 <> '' or l.yoopiskkoulk_5 <> '' or l.yoopiskkoulk_6 <> '' or l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '' or l.yoopiskkoulk2012 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and l.amkopiskkoulk_5 = '' and l.amkopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and (l.yoopiskkoulk_5 <> '' or l.yoopiskkoulk_6 <> '' or l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '' or l.yoopiskkoulk2012 <> '' or l.yoopiskkoulk2013 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and l.amkopiskkoulk_6 = '' and l.amkopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and (l.yoopiskkoulk_6 <> '' or l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '' or l.yoopiskkoulk2012 <> '' or l.yoopiskkoulk2013 <> '' or l.yoopiskkoulk2014 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and l.amkopiskkoulk2010 = '' and l.amkopiskkoulk2011 = '' and l.amkopiskkoulk2012 = '' and l.amkopiskkoulk2013 = '' and l.amkopiskkoulk2014 = '' and l.amkopiskkoulk2015 = '' and (l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '' or l.yoopiskkoulk2012 <> '' or l.yoopiskkoulk2013 <> '' or l.yoopiskkoulk2014 <> '' or l.yoopiskkoulk2015 <> '') then 1*/
	else 0
end opisk_vain_yo
----Opiskellut sekä amk- että yliopistokoulutuksessa
,case
	when  l.suorlk = '1' and (l.amkopiskkoulk_1 <> '' or l.amkopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.amkopiskkoulk_6 <> '') and (l.yoopiskkoulk_1 <> '' or l.yoopiskkoulk_2 <> '' or l.yoopiskkoulk_3 <> '' or l.yoopiskkoulk_4 <> '' or l.yoopiskkoulk_5 <> '' or l.yoopiskkoulk_6 <> '') then 1
/*	when l.suorv = @toinen_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk_2 <> '' or l.amkopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.amkopiskkoulk_6 <> '' or l.amkopiskkoulk2010 <> '') and (l.yoopiskkoulk_2 <> '' or l.yoopiskkoulk_3 <> '' or l.yoopiskkoulk_4 <> '' or l.yoopiskkoulk_5 <> '' or l.yoopiskkoulk_6 <> '' or l.yoopiskkoulk2010 <> '') then 1
	when l.suorv = @kolmas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk_3 <> '' or l.amkopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.amkopiskkoulk_6 <> '' or l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '') and (l.yoopiskkoulk_3 <> '' or l.yoopiskkoulk_4 <> '' or l.yoopiskkoulk_5 <> '' or l.yoopiskkoulk_6 <> '' or l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '') then 1
	when l.suorv = @neljas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk_4 <> '' or l.amkopiskkoulk_5 <> '' or l.amkopiskkoulk_6 <> '' or l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '') and (l.yoopiskkoulk_4 <> '' or l.yoopiskkoulk_5 <> '' or l.yoopiskkoulk_6 <> '' or l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '' or l.yoopiskkoulk2012 <> '') then 1
	when l.suorv = @viides_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk_5 <> '' or l.amkopiskkoulk_6 <> '' or l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '') and (l.yoopiskkoulk_5 <> '' or l.yoopiskkoulk_6 <> '' or l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '' or l.yoopiskkoulk2012 <> '' or l.yoopiskkoulk2013 <> '') then 1
	when l.suorv = @kuudes_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk_6 <> '' or l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '' or l.amkopiskkoulk2014 <> '') and (l.yoopiskkoulk_6 <> '' or l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '' or l.yoopiskkoulk2012 <> '' or l.yoopiskkoulk2013 <> '' or l.yoopiskkoulk2014 <> '') then 1
	when l.suorv = @seitsemas_suoritusvuosi		and l.suorlk = '1' and (l.amkopiskkoulk2010 <> '' or l.amkopiskkoulk2011 <> '' or l.amkopiskkoulk2012 <> '' or l.amkopiskkoulk2013 <> '' or l.amkopiskkoulk2014 <> '' or l.amkopiskkoulk2015 <> '') and (l.yoopiskkoulk2010 <> '' or l.yoopiskkoulk2011 <> '' or l.yoopiskkoulk2012 <> '' or l.yoopiskkoulk2013 <> '' or l.yoopiskkoulk2014 <> '' or l.yoopiskkoulk2015 <> '') then 1*/
	else 0
end opisk_amkyo

FROM 
    (
	select * from [VipunenTK_SA].[dbo].[v_K3_13_Perusk_paattaneet_amm_tutk_suorittaneet]
	where suorlk = '1'
	
	) as l

LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d1a on d1a.koulutusluokitus_avain=l.amkopiskkoulk_1
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d2a on d2a.koulutusluokitus_avain=l.amkopiskkoulk_2
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d3a on d3a.koulutusluokitus_avain=l.amkopiskkoulk_3
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d4a on d4a.koulutusluokitus_avain=l.amkopiskkoulk_4
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d5a on d5a.koulutusluokitus_avain=l.amkopiskkoulk_5
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d6a on d6a.koulutusluokitus_avain=l.amkopiskkoulk_6
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d7a on d7a.koulutusluokitus_avain=l.amkopiskkoulk_6
/*LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d8a on d8a.koulutusluokitus_avain=l.amkopiskkoulk2011
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d9a on d9a.koulutusluokitus_avain=l.amkopiskkoulk2012
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d10a on d10a.koulutusluokitus_avain=l.amkopiskkoulk2013
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d11a on d11a.koulutusluokitus_avain=l.amkopiskkoulk2014
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d12a on d12a.koulutusluokitus_avain=l.amkopiskkoulk2015*/

LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d1b on d1b.koulutusluokitus_avain=l.yoopiskkoulk_1
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d2b on d2b.koulutusluokitus_avain=l.yoopiskkoulk_2
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d3b on d3b.koulutusluokitus_avain=l.yoopiskkoulk_3
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d4b on d4b.koulutusluokitus_avain=l.yoopiskkoulk_4
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d5b on d5b.koulutusluokitus_avain=l.yoopiskkoulk_5
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d6b on d6b.koulutusluokitus_avain=l.yoopiskkoulk_6
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d7b on d7b.koulutusluokitus_avain=l.yoopiskkoulk_6
/*LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d8b on d8b.koulutusluokitus_avain=l.yoopiskkoulk2011	
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d9b on d9b.koulutusluokitus_avain=l.yoopiskkoulk2012
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d10b on d10b.koulutusluokitus_avain=l.yoopiskkoulk2013
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d11b on d11b.koulutusluokitus_avain=l.yoopiskkoulk2014	
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d12b on d12b.koulutusluokitus_avain=l.yoopiskkoulk2015	*/

LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d1c on d1c.koulutusluokitus_avain=l.ammopiskkoulk_1
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d2c on d2c.koulutusluokitus_avain=l.ammopiskkoulk_2
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d3c on d3c.koulutusluokitus_avain=l.ammopiskkoulk_3
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d4c on d4c.koulutusluokitus_avain=l.ammopiskkoulk_4
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d5c on d5c.koulutusluokitus_avain=l.ammopiskkoulk_5
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d6c on d6c.koulutusluokitus_avain=l.ammopiskkoulk_6
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d7c on d7c.koulutusluokitus_avain=l.ammopiskkoulk_6
/*LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d8c on d8c.koulutusluokitus_avain=l.ammopiskkoulk2011
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d9c on d9c.koulutusluokitus_avain=l.ammopiskkoulk2012
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d10c on d10c.koulutusluokitus_avain=l.ammopiskkoulk2013
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d11c on d11c.koulutusluokitus_avain=l.ammopiskkoulk2014
LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d12c on d12c.koulutusluokitus_avain=l.ammopiskkoulk2015*/

CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d1a.iscfibroad2013_koodi),(d1b.iscfibroad2013_koodi), (d2a.iscfibroad2013_koodi),(d2b.iscfibroad2013_koodi), (d3a.iscfibroad2013_koodi),(d3b.iscfibroad2013_koodi), (d4a.iscfibroad2013_koodi),(d4b.iscfibroad2013_koodi), (d5a.iscfibroad2013_koodi),(d5b.iscfibroad2013_koodi), (d6a.iscfibroad2013_koodi),(d6b.iscfibroad2013_koodi)) AS a(d)) m1
CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d2a.iscfibroad2013_koodi),(d2b.iscfibroad2013_koodi), (d3a.iscfibroad2013_koodi),(d3b.iscfibroad2013_koodi), (d4a.iscfibroad2013_koodi),(d4b.iscfibroad2013_koodi), (d5a.iscfibroad2013_koodi),(d5b.iscfibroad2013_koodi), (d6a.iscfibroad2013_koodi),(d6b.iscfibroad2013_koodi), (d7a.iscfibroad2013_koodi),(d7b.iscfibroad2013_koodi)) AS a(d)) m2
/*CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d3a.iscfibroad2013_koodi),(d3b.iscfibroad2013_koodi), (d4a.iscfibroad2013_koodi),(d4b.iscfibroad2013_koodi), (d5a.iscfibroad2013_koodi),(d5b.iscfibroad2013_koodi), (d6a.iscfibroad2013_koodi),(d6b.iscfibroad2013_koodi), (d7a.iscfibroad2013_koodi),(d7b.iscfibroad2013_koodi), (d8a.iscfibroad2013_koodi),(d8b.iscfibroad2013_koodi)) AS a(d)) m3
CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d4a.iscfibroad2013_koodi),(d4b.iscfibroad2013_koodi), (d5a.iscfibroad2013_koodi),(d5b.iscfibroad2013_koodi), (d6a.iscfibroad2013_koodi),(d6b.iscfibroad2013_koodi), (d7a.iscfibroad2013_koodi),(d7b.iscfibroad2013_koodi), (d8a.iscfibroad2013_koodi),(d8b.iscfibroad2013_koodi), (d9a.iscfibroad2013_koodi),(d9b.iscfibroad2013_koodi)) AS a(d)) m4
CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d5a.iscfibroad2013_koodi),(d5b.iscfibroad2013_koodi), (d6a.iscfibroad2013_koodi),(d6b.iscfibroad2013_koodi), (d7a.iscfibroad2013_koodi),(d7b.iscfibroad2013_koodi), (d8a.iscfibroad2013_koodi),(d8b.iscfibroad2013_koodi), (d9a.iscfibroad2013_koodi),(d9b.iscfibroad2013_koodi), (d10a.iscfibroad2013_koodi),(d10b.iscfibroad2013_koodi)) AS a(d)) m5
CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d6a.iscfibroad2013_koodi),(d6b.iscfibroad2013_koodi), (d7a.iscfibroad2013_koodi),(d7b.iscfibroad2013_koodi), (d8a.iscfibroad2013_koodi),(d8b.iscfibroad2013_koodi), (d9a.iscfibroad2013_koodi),(d9b.iscfibroad2013_koodi), (d10a.iscfibroad2013_koodi),(d10b.iscfibroad2013_koodi), (d11a.iscfibroad2013_koodi),(d11b.iscfibroad2013_koodi)) AS a(d)) m6
CROSS APPLY (SELECT MIN(d) MinValue, MAX(d) MaxValue FROM (VALUES (d7a.iscfibroad2013_koodi),(d7b.iscfibroad2013_koodi), (d8a.iscfibroad2013_koodi),(d8b.iscfibroad2013_koodi), (d9a.iscfibroad2013_koodi),(d9b.iscfibroad2013_koodi), (d10a.iscfibroad2013_koodi),(d10b.iscfibroad2013_koodi), (d11a.iscfibroad2013_koodi),(d11b.iscfibroad2013_koodi), (d12a.iscfibroad2013_koodi),(d12b.iscfibroad2013_koodi)) AS a(d)) m7*/

	
	WHERE 1=1
--end;

--
-- TULOS
-- 
/*
if @debug_what_to_run>=3 begin
	if @debug_what_to_run>0 print 'querying result';
	select * from [VipunenTK_DW].[dbo].[_koulutukseen_sijoittuneet_6v]
	--select COUNT(*) from vipunen_tk.f_tyol_ja_jatko_opin_ where aineisto=(select id from vipunen_tk.d_aineisto where aineistokoodi='4.3' and @toinen_suoritusvuosi between alkaa and paattyy)
end;

if @debug_what_to_run>0 PRINT 'all done.';
*/

GO
USE [ANTERO]