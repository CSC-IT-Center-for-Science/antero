USE [VipunenTK]
GO
/****** Object:  View [dbo].[v_d_kieli_jarjestys_nimen_mukaan]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_d_kieli_jarjestys_nimen_mukaan]'))
EXEC dbo.sp_executesql @statement = N'


CREATE VIEW [dbo].[v_d_kieli_jarjestys_nimen_mukaan] AS
SELECT [id]
      ,[kieli]
      ,[kieli_SV]
      ,[kieli_EN], 1 AS jarjestys_kieli_fi, 1 AS jarjestys_kieli_se, 1 AS jarjestys_kieli_en
  FROM [VipunenTK].[dbo].[d_kieli]
WHERE kieli_koodi = ''fi''
UNION ALL
SELECT [id]
      ,[kieli]
      ,[kieli_SV]
      ,[kieli_EN], 2 AS jarjestys_kieli_fi, 2 AS jarjestys_kieli_se, 2 AS jarjestys_kieli_en
  FROM [VipunenTK].[dbo].[d_kieli]
WHERE kieli_koodi = ''sv''
UNION ALL
SELECT [id]
      ,[kieli]
      ,[kieli_SV]
      ,[kieli_EN], 3 AS jarjestys_kieli_fi, 3 AS jarjestys_kieli_se, 3 AS jarjestys_kieli_en
  FROM [VipunenTK].[dbo].[d_kieli]
WHERE kieli_koodi = ''se''
UNION ALL
SELECT [id]
      ,[kieli]
      ,[kieli_SV]
      ,[kieli_EN]
	  ,ROW_NUMBER() OVER (ORDER BY kieli) + 3 AS jarjestys_kieli_fi
	  ,ROW_NUMBER() OVER (ORDER BY kieli_SV) + 3 AS jarjestys_kieli_se
	  ,ROW_NUMBER() OVER (ORDER BY kieli_EN) + 3 AS jarjestys_kieli_en
  FROM [VipunenTK].[dbo].[d_kieli]
WHERE kieli_koodi NOT IN (''fi'', ''sv'', ''se'', ''99'') AND id > 0
UNION ALL
SELECT [id]
      ,[kieli]
      ,[kieli_SV]
      ,[kieli_EN], 999 AS jarjestys_kieli_fi, 999 AS jarjestys_kieli_se, 999 AS jarjestys_kieli_en
  FROM [VipunenTK].[dbo].[d_kieli]
WHERE kieli_koodi = ''99''
UNION ALL
SELECT [id]
      ,[kieli]
      ,[kieli_SV]
      ,[kieli_EN], 1000 AS jarjestys_kieli_fi, 1000 AS jarjestys_kieli_se, 1000 AS jarjestys_kieli_en
  FROM [VipunenTK].[dbo].[d_kieli]
WHERE id < 0



' 
GO
/****** Object:  View [dbo].[v_f_tab_yli_15-v_koul_kielen_ja_askunnan_mukaan]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_yli_15-v_koul_kielen_ja_askunnan_mukaan]'))
EXEC dbo.sp_executesql @statement = N'






CREATE VIEW [dbo].[v_f_tab_yli_15-v_koul_kielen_ja_askunnan_mukaan] AS
SELECT [tilv] AS Tilastovuosi
      ,CASE WHEN d1.aidinkieli_versio2_koodi in (''fi'', ''se'') THEN ''suomi (sis. saame)'' ELSE d1.aidinkieli_versio2 END AS [Äidinkieli I]
      ,d2.kieli AS [Äidinkieli II]
	  ,d3.kunta AS [Asuinkunta]
	  ,d3.maakunta AS [Asuinmaakunta]
	  ,d3.ely AS [Asuinalueen ELY]
	  ,d3.avi AS [Asuinalueen AVI]
      ,CASE WHEN d4.ika_int >= 70 THEN ''yli 70-vuotiaat'' ELSE d4.ika5v END AS [Ikäryhmä]
      ,d5.koulutusala AS [Koulutusala]
      ,CASE WHEN d6.koulutusaste_2002koodi = 90 THEN ''Ei perusasteen jälkeistä tutkintoa tai tutkinto tuntematon'' ELSE d6.koulutusaste_2002 END AS [Koulutusaste]
      ,[lkm] AS lkm_int2
	  ,d2.jarjestys_kieli_fi jarjestys_aidinkieli_II

	  --ruotsi
	  ,[tilv] AS [Statistikår]
      ,CASE WHEN d1.aidinkieli_versio2_koodi in (''fi'', ''se'') THEN ''finska (inn. samiska)'' ELSE d1.aidinkieli_versio2_SV END AS [Modersmål I]
      ,d2.kieli_SV AS [Modersmål II]
	  ,d3.kunta_SV AS [Bostadskommun]
	  ,d3.maakunta_SV AS [Bostadslandskap]
	  ,d3.ely_SV AS [Bostadsortens NTM-område]
	  ,d3.avi_SV AS [Bostadsortens RFV-område]
      ,CASE WHEN d4.ika_int >= 70 THEN ''mer än 70 år'' ELSE d4.ika5v_SV END AS [Åldersgrupp]
      ,d5.koulutusala_SV AS [Utbildningsområde]
      ,CASE WHEN d6.koulutusaste_2002koodi = 90 THEN ''Inget diplom efter grundutbildning eller diplom okänd'' ELSE d6.koulutusaste_2002_SV END AS [Utbildningsnivå]
	  ,d2.jarjestys_kieli_se AS jarjestys_aidinkieli_II_sv

	  --englanti
	  ,[tilv] AS [Statistical year]
      ,CASE WHEN d1.aidinkieli_versio2_koodi in (''fi'', ''se'') THEN ''Finnish (incl. Lapp, Saam)'' ELSE d1.aidinkieli_versio2_EN END AS [Mother tongue I]
      ,d2.kieli_EN AS [Mother tongue II]
	  ,d3.kunta_EN AS [Municipality of residence]
	  ,d3.maakunta_EN AS [Region of residence]
	  ,d3.ely_EN AS [ELY area of the place of residence]
	  ,d3.avi_EN AS [AVI area of the place of residence]
      ,CASE WHEN d4.ika_int >= 70 THEN ''over 70 year old'' ELSE d4.ika5v_EN END AS [Age group]
      ,d5.koulutusala_EN AS [Field of education]
      ,CASE WHEN d6.koulutusaste_2002koodi = 90 THEN ''No diploma after elementary education or diploma unknown'' ELSE d6.koulutusaste_2002_EN END AS [Level of education]
	  ,CASE WHEN d1.aidinkieli_versio2_koodi in (''fi'', ''se'') THEN 1 WHEN d1.aidinkieli_versio2_koodi = ''sv'' THEN 2 WHEN d1.aidinkieli_versio2_koodi = ''99'' THEN 3 ELSE d1.jarjestys END AS jarjestys_aidinkieli_I
	  ,d2.jarjestys_kieli_en AS jarjestys_aidinkieli_II_en
	  ,d3.jarjestys
	  ,d3.jarjestys_maakunta
	  ,d3.jarjestys_ely
	  ,d3.jarjestys_avi
	  ,d4.jarjestys_ika5v
	  ,d5.jarjestys AS jarjestys_koulutusala
	  ,d6.jarjestys AS jarjestys_koulutusaste
  FROM [VipunenTK].[dbo].[f_yli_15-vuotiaat_koulutuksen_kielen_ja_asuinkunnan_mukaan] f
  LEFT JOIN [VipunenTK].[dbo].[d_aidinkieli_versio2] d1 ON f.aidinkieli_I_id = d1.id
  LEFT JOIN [VipunenTK].[dbo].[v_d_kieli_jarjestys_nimen_mukaan] d2 ON f.aidinkieli_II_id = d2.id
  LEFT JOIN [VipunenTK].[dbo].[d_alueluokitus] d3 ON f.alueluokitus_id = d3.id
  LEFT JOIN [VipunenTK].[dbo].[d_ika] d4 ON f.ika_id = d4.id
  LEFT JOIN [VipunenTK].[dbo].[d_opetushallinnon_koulutusala] d5 ON f.koulutusala_id = d5.id
  LEFT JOIN [VipunenTK].[dbo].[d_koulutusaste_2002] d6 ON f.koulutusaste_id = d6.id







' 
GO
/****** Object:  View [dbo].[tabular_sosek]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[tabular_sosek]'))
EXEC dbo.sp_executesql @statement = N'CREATE VIEW [dbo].[tabular_sosek] AS

Select
      [Uudet opiskelijat2]
	  ,[Opiskelijat2]
	  ,[Tutkinnot2]
	  ,[Tilastovuosi]
	  ,[Koulutusala (opiskelija)]
	  ,[Opintoala (opiskelija)]
	  ,[Koulutusnimike (opiskelija)]
	  ,[Koulutusaste (opiskelija)]
	  ,[Koulutusala (95) (opiskelija)]
	  ,[Koulutusala (äiti)]
	  ,[Opintoala (äiti)]
	  ,[Koulutusnimike (äiti)]
	  ,[Koulutusaste (äiti)]
	  ,[Koulutusala (95) (äiti)]
	  ,[Koulutusala (isä)]
	  ,[Opintoala (isä)]
	  ,[Koulutusnimike (isä)]
	  ,[Koulutusaste (isä)]
	  ,[Koulutusala (95) (isä)]
	  ,[Koulutuslaji (opiskelija)]
	  ,[Sukupuoli (opiskelija)]
	  ,Hallinnonala
	  ,[Äidinkieli (opiskelija)]
	  ,[Syntymävuosi (opiskelija)]
	  ,[Koulutuksen kieli (opiskelija)]
	  ,[Koulutuksen AVI (opiskelija)]
	  ,[Koulutuksen ELY (opiskelija)]
	  ,[Koulutuksen maakunta (opiskelija)]
	  ,[Asuinalueen AVI (opiskelija)]
	  ,[Asuinalueen ELY (opiskelija)]
	  ,[Asuinmaakunta (opiskelija)]
	  ,[Til.v:tta edeltävän vuoden AVI (opiskelija)]
	  ,[Til.v:tta edeltävän vuoden ELY (opiskelija)]
	  ,[Til.v:tta edeltävän vuoden asuinmaakunta (opiskelija)]
	  ,[Tuloluokka (äiti)]
	  ,[Tuloluokka (isä)]
	  ,[Sos.ek. asema 1 (äiti)]
	  ,[Sos.ek. asema 2 (äiti)]
	  ,[Sos.ek. asema 1 (isä)]
	  ,[Sos.ek. asema 2 (isä)]
	  ,[Ikä (opiskelija)]
	  ,[Ikäryhmä (opiskelija)]
	  ,[Kirjoillaolo (opiskelija)]
	  ,[Kirjoihintulovuosi (opiskelija)]
	  ,koul02_op
	  ,op02_op
	  ,kast02_op
	  ,op95_op
	  ,koul02_ai
	  ,op02_ai
	  ,kast02_ai
	  ,op95_ai
	  ,koul02_is
	  ,op02_is
	  ,kast02_is
	  ,op95_is
	  ,koulaj_jarj
	  ,ophaljarj
	  ,aid_jarj
	  ,synt_jarj
	  ,kiel_jarj
	  ,koulavij
	  ,koulelyj
	  ,koulmaakj
	  ,asavij
	  ,aselyj
	  ,asmaakj
	  ,as2avij
	  ,as2elyj
	  ,as2maakj
	  ,tuljaiti
	  ,tuljisa
	  ,sosek1a_jarj
	  ,sosek2a_jarj
	  ,sosek1i_jarj
	  ,sosek2i_jarj
	  ,ikaopjarj
	  ,ikaryhopjarj
	  ,kirjjarj
	  ,kirjvjarj
      from (
Select [Uudet opiskelijat2] = coalesce (sum(uudet_opiskelijat),0),
[Opiskelijat2] = coalesce (sum(opiskelijat),0)
,[Tutkinnot2] = coalesce (sum(tutkinnot),0)
,[Tilastointivuosi] as Tilastovuosi
,d1.koulutusala2002 as "Koulutusala (opiskelija)"
,d1.jarjestys_koulutusala2002 as "koul02_op"
,d1.opintoala2002 as "Opintoala (opiskelija)"
,d1.jarjestys_opintoala2002 as "op02_op"
,d1.koulutus as "Koulutusnimike (opiskelija)"
,d1.koulutusaste2002 as "Koulutusaste (opiskelija)"
,d1.jarjestys_koulutusaste2002 as "kast02_op"
,d1.opintoala1995 as "Koulutusala (95) (opiskelija)"
,d1.jarjestys_opintoala1995 as "op95_op"
,d2.koulutusala2002 as "Koulutusala (äiti)"
,d2.jarjestys_koulutusala2002 as "koul02_ai"
,d2.opintoala2002 as "Opintoala (äiti)"
,d2.jarjestys_opintoala2002 as "op02_ai"
,d2.koulutus as "Koulutusnimike (äiti)"
,d2.koulutusaste2002 as "Koulutusaste (äiti)"
,d2.jarjestys_koulutusaste2002 as "kast02_ai"
,d2.opintoala1995 as "Koulutusala (95) (äiti)"
,d2.jarjestys_opintoala1995 as "op95_ai"
,d3.koulutusala2002 as "Koulutusala (isä)"
,d3.jarjestys_koulutusala2002 as "koul02_is"
,d3.opintoala2002 as "Opintoala (isä)"
,d3.jarjestys_opintoala2002 as "op02_is"
,d3.koulutus as "Koulutusnimike (isä)"
,d3.koulutusaste2002 as "Koulutusaste (isä)"
,d3.jarjestys_koulutusaste2002 as "kast02_is"
,d3.opintoala1995 as "Koulutusala (95) (isä)"
,d3.jarjestys_opintoala1995 as "op95_is"
,d4.koulutuslaji as "Koulutuslaji (opiskelija)"
,d4.jarjestys as "koulaj_jarj"
,d5.sukupuoli as "Sukupuoli (opiskelija)"
,d6.opetushallinnon_koulutus as "Hallinnonala"
,d6.jarjestys as "ophaljarj"
,d7.aidinkieli_versio1 as "Äidinkieli (opiskelija)"
,d7.jarjestys as "aid_jarj"
,d8.vuosiselite as "Syntymävuosi (opiskelija)"
,d8.jarjestys as "synt_jarj"
,d9.kieli as "Koulutuksen kieli (opiskelija)"
,d9.jarjestys as "kiel_jarj"
,d10.avi as "Koulutuksen AVI (opiskelija)"
,d10.jarjestys_avi as "koulavij"
,d10.ely as "Koulutuksen ELY (opiskelija)"
,d10.jarjestys_ely as "koulelyj"
,d10.maakunta as "Koulutuksen maakunta (opiskelija)"
,d10.jarjestys_maakunta as "koulmaakj"
,d11.avi as "Asuinalueen AVI (opiskelija)"
,d11.jarjestys_avi as "asavij"
,d11.ely as "Asuinalueen ELY (opiskelija)"
,d11.jarjestys_ely as "aselyj"
,d11.maakunta as "Asuinmaakunta (opiskelija)"
,d11.jarjestys_maakunta as "asmaakj"
,d12.avi as "Til.v:tta edeltävän vuoden AVI (opiskelija)"
,d12.jarjestys_avi as "as2avij"
,d12.ely as "Til.v:tta edeltävän vuoden ELY (opiskelija)"
,d12.jarjestys_ely as "as2elyj"
,d12.maakunta as "Til.v:tta edeltävän vuoden asuinmaakunta (opiskelija)"
,d12.jarjestys_maakunta as "as2maakj"
,d13.tulodesiili as "Tuloluokka (äiti)"
,d13.jarjestys as "tuljaiti"
,d14.tulodesiili as "Tuloluokka (isä)"
,d14.jarjestys as "tuljisa"
,d15.sosioekonominen_asema_ryhma as "Sos.ek. asema 1 (äiti)"
,d15.jarjestys_ryhma as "sosek1a_jarj"
,d16.sosioekonominen_asema as "Sos.ek. asema 2 (äiti)"
,d16.jarjestys_asema as "sosek2a_jarj"
,d17.sosioekonominen_asema_ryhma as "Sos.ek. asema 1 (isä)"
,d17.jarjestys_ryhma as "sosek1i_jarj"
,d18.sosioekonominen_asema as "Sos.ek. asema 2 (isä)"
,d18.jarjestys_asema as "sosek2i_jarj"
,d19.ika as "Ikä (opiskelija)"
,d19.jarjestys_ika as "ikaopjarj"
,d20.ika5v as "Ikäryhmä (opiskelija)"
,d20.jarjestys_ika5v as "ikaryhopjarj"
,d21.opiskelijan_olo as "Kirjoillaolo (opiskelija)"
,d21.jarjestys as "kirjjarj"
,d22.vuosiselite as "Kirjoihintulovuosi (opiskelija)"
,d22.jarjestys as "kirjvjarj"
FROM dbo.f_SA_2_23_Opisk_ja_tutksuor_vanh_aseman_muk
	  JOIN d_koulutusluokitus d1 on d1.id = koulutusluokitus_id
	  JOIN d_koulutusluokitus d2 on d2.id = koulutusluokitus_aiti_id
	  JOIN d_koulutusluokitus d3 on d3.id = koulutusluokitus_isa_id
	  JOIN d_koulutuslaji d4 on d4.id = koulutuslaji_id
	  JOIN d_sukupuoli d5 on d5.id = sukupuoli_id
	  JOIN d_opetushallinnon_koulutus d6 on d6.id = opetushallinnon_koulutus2_id
	  JOIN d_aidinkieli_versio1 d7 on d7.id = aidinkieli_versio1x_id
	  JOIN d_kausi d8 on d8.kausi_id = syntymavuosi_id
	  JOIN d_kieli d9 on d9.id = koulutuksen_kieli_id
	  JOIN d_alueluokitus d10 on d10.id = koulutuksen_maakunta_id
	  JOIN d_alueluokitus d11 on d11.id = kotikunta_id
	  JOIN d_alueluokitus d12 on d12.id = kotikunta1x_id
	  JOIN d_tulodesiili d13 on d13.id = tulodesiili_aiti_id
	  JOIN d_tulodesiili d14 on d14.id = tulodesiili_isa_id
	  JOIN d_sosioekonominen_asema d15 on d15.id = sosioekonominen_asema_1_aiti_id
	  JOIN d_sosioekonominen_asema d16 on d16.id = sosioekonominen_asema_2_aiti_id
	  JOIN d_sosioekonominen_asema d17 on d17.id = sosioekonominen_asema_1_isa_id
	  JOIN d_sosioekonominen_asema d18 on d18.id = sosioekonominen_asema_2_isa_id
	  JOIN d_ika d19 on d19.id = ika_1v_id
	  JOIN d_ika d20 on d20.id = ika_5v_id
	  JOIN d_opiskelijan_olo d21 on d21.id = opiskelijan_olo_syys_id
	  JOIN d_kausi d22 on d22.kausi_id = kirjoihintulovuosi_id
GROUP BY
	  [Tilastointivuosi]
	  ,d1.koulutusala2002
	  ,d1.opintoala2002
	  ,d1.koulutus
	  ,d1.koulutusaste2002
	  ,d1.opintoala1995
	  ,d2.koulutusala2002
	  ,d2.opintoala2002
	  ,d2.koulutus
	  ,d2.koulutusaste2002
	  ,d2.opintoala1995
	  ,d3.koulutusala2002
	  ,d3.opintoala2002
	  ,d3.koulutus
	  ,d3.koulutusaste2002
	  ,d3.opintoala1995
	  ,d4.koulutuslaji
	  ,d5.sukupuoli
	  ,d6.opetushallinnon_koulutus
	  ,d7.aidinkieli_versio1
	  ,d8.vuosiselite
	  ,d9.kieli
	  ,d10.avi
	  ,d10.ely
	  ,d10.maakunta
	  ,d11.avi
	  ,d11.ely
	  ,d11.maakunta
	  ,d12.avi
	  ,d12.ely
	  ,d12.maakunta
	  ,d13.tulodesiili
	  ,d14.tulodesiili
	  ,d15.sosioekonominen_asema_ryhma
	  ,d16.sosioekonominen_asema
	  ,d17.sosioekonominen_asema_ryhma
	  ,d18.sosioekonominen_asema
	  ,d19.ika
	  ,d20.ika5v
	  ,d21.opiskelijan_olo
	  ,d22.vuosiselite
	  ,d1.jarjestys_koulutusala2002
	  ,d1.jarjestys_opintoala2002
	  ,d1.jarjestys_koulutusaste2002
	  ,d1.jarjestys_opintoala1995
	  ,d2.jarjestys_koulutusala2002
	  ,d2.jarjestys_opintoala2002
	  ,d2.jarjestys_koulutusaste2002
	  ,d2.jarjestys_opintoala1995
	  ,d3.jarjestys_koulutusala2002
	  ,d3.jarjestys_opintoala2002
	  ,d3.jarjestys_koulutusaste2002
	  ,d3.jarjestys_opintoala1995
	  ,d4.jarjestys
	  ,d6.jarjestys
	  ,d7.jarjestys
	  ,d8.jarjestys
	  ,d9.jarjestys
	  ,d10.jarjestys_avi
	  ,d10.jarjestys_ely
	  ,d10.jarjestys_maakunta
	  ,d11.jarjestys_avi
	  ,d11.jarjestys_ely
	  ,d11.jarjestys_maakunta
	  ,d12.jarjestys_avi
	  ,d12.jarjestys_ely
	  ,d12.jarjestys_maakunta
	  ,d13.jarjestys
	  ,d14.jarjestys
	  ,d15.jarjestys_ryhma
	  ,d16.jarjestys_asema
	  ,d17.jarjestys_ryhma
	  ,d18.jarjestys_asema
	  ,d19.jarjestys_ika
	  ,d20.jarjestys_ika5v
	  ,d21.jarjestys
	  ,d22.jarjestys
) mdx
' 
GO
/****** Object:  View [dbo].[v_d_AL_aineisto]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_d_AL_aineisto]'))
EXEC dbo.sp_executesql @statement = N'CREATE VIEW [dbo].[v_d_AL_aineisto] AS
SELECT distinct 
	   [aineistokoodi]
      ,[aineistoselite_FI] = CAST([aineistokoodi] as varchar(150))
      ,[aineistoselite_SV] = CAST([aineistokoodi] as varchar(150))
      ,[aineistoselite_EN] = CAST([aineistokoodi] as varchar(150))
      ,[jarjestys] = Case when aineistokoodi=''K3.9'' then ''K3.09'' when aineistokoodi=''K3.10'' then ''K3.10'' else ''99999'' end
  FROM VipunenTK.dbo.f_aloittaneiden_lapaisy

' 
GO
/****** Object:  View [dbo].[v_d_AL_kausi]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_d_AL_kausi]'))
EXEC dbo.sp_executesql @statement = N'CREATE VIEW [dbo].[v_d_AL_kausi] AS

-- Select * from VipunenTK.dbo.v_d_AL_kausi
-- d_kausi 44110 rows 19000101 - 20151231
-- v_d_AL_kausi 45 rows 19832 - 20112, no dates, no old data

SELECT [kausi_id]
      ,[luotu]
      ,[alkaa]
      ,[paattyy]
      ,[vuosi]
      ,[vuosiselite]
      ,[vuosiselite_SV]
      ,[vuosiselite_EN]
      ,[lukukausi]
      ,[lukukausiselite]
      ,[lukukausiselite_SV]
      ,[lukukausiselite_EN]
      ,[kuukausi]
      ,[kuukausiselite]
      ,[kuukausiselite_SV]
      ,[kuukausiselite_EN]
      ,[paiva]
      ,[lukuvuosi]
      ,[jarjestys]
      ,[poistettu]
      ,[tietolahde]
      ,[kommentti]
      ,[lukuvuosikausiselite]
      ,[lukuvuosikausiselite_SV]
      ,[lukuvuosikausiselite_EN]
  FROM [VipunenTK].[dbo].[d_kausi]
JOIN ( --erikaudet
Select distinct kausikoodi from ( --kaudet
  Select distinct kausikoodi=aloituskausikoodi from VipunenTK.dbo.f_aloittaneiden_lapaisy
   union all
  Select distinct kausikoodi=aloituskausikoodi_kk from VipunenTK.dbo.f_aloittaneiden_lapaisy
   union all
  Select distinct kausikoodi=saavutettu_kausikoodi from VipunenTK.dbo.f_aloittaneiden_lapaisy
  ) kaudet
) erikaudet
	ON erikaudet.kausikoodi = kausi_id

' 
GO
/****** Object:  View [dbo].[v_d_AL_tilastovuosi]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_d_AL_tilastovuosi]'))
EXEC dbo.sp_executesql @statement = N'  
CREATE VIEW [dbo].[v_d_AL_tilastovuosi] AS
Select distinct 
	tilastovuosi=tilv
  FROM VipunenTK.dbo.f_aloittaneiden_lapaisy  

' 
GO
/****** Object:  View [dbo].[v_d_aloittaneiden_lapaisy_aikamuuttujat]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_d_aloittaneiden_lapaisy_aikamuuttujat]'))
EXEC dbo.sp_executesql @statement = N'CREATE VIEW [dbo].[v_d_aloittaneiden_lapaisy_aikamuuttujat]
AS
SELECT ROW_NUMBER() OVER (ORDER BY tilv, alvv, allk, tarkastelujakso) AS id, *
FROM
(
SELECT DISTINCT tilv, alvv, allk, tarkastelujakso
FROM            dbo.f_aloittaneiden_lapaisy) x



' 
GO
/****** Object:  View [dbo].[v_d_aloittaneiden_lapaisy_henkilomuuttujat]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_d_aloittaneiden_lapaisy_henkilomuuttujat]'))
EXEC dbo.sp_executesql @statement = N'CREATE VIEW [dbo].[v_d_aloittaneiden_lapaisy_henkilomuuttujat]
AS
SELECT        ROW_NUMBER() OVER (ORDER BY sukupuoli_koodi, aidinkieli_versio1_koodi, CAST(ika_avain AS int)) AS id, *
FROM            (SELECT DISTINCT 
                         ika.ika, ika.ika5v, ika.jarjestys_ika, ika.jarjestys_ika5v, sp.sukupuoli, sp.jarjestys AS sukupuoli_jarjestys, ak.aidinkieli_versio1, ak.jarjestys AS aidinkieli_jarjestys, sp.sukupuoli_koodi, 
                         ak.aidinkieli_versio1_koodi, ika.ika_avain
FROM                     dbo.d_sukupuoli AS sp CROSS JOIN
                         dbo.d_aidinkieli_versio1 AS ak CROSS JOIN
                         dbo.d_ika AS ika
WHERE ISNUMERIC(ika.ika_avain) = 1) x

' 
GO
/****** Object:  View [dbo].[v_d_Alueella_työssäkäyvät_tilastovuosi]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_d_Alueella_työssäkäyvät_tilastovuosi]'))
EXEC dbo.sp_executesql @statement = N'
CREATE VIEW [dbo].[v_d_Alueella_työssäkäyvät_tilastovuosi] AS

Select distinct tilastovuosi
from (
	Select distinct tilastovuosi=tilv from dbo.f_alueella_tyossakayvat
	UNION ALL
	Select distinct tilastovuosi=tilv from dbo.f_alueella_tyossakayvat_1v
	UNION ALL
	Select distinct tilastovuosi=tilv from dbo.f_tyossakayvat_ammateittain
) tilastovuodet


' 
GO
/****** Object:  View [dbo].[v_d_alueluokitus_kuntaryhma]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_d_alueluokitus_kuntaryhma]'))
EXEC dbo.sp_executesql @statement = N'


CREATE VIEW [dbo].[v_d_alueluokitus_kuntaryhma] AS
/*
Truncate table VipunenTK.dbo.d_kuntaryhma
Insert into VipunenTK.dbo.d_kuntaryhma
Select * from VipunenTK.[dbo].[v_d_alueluokitus_kuntaryhma]

Drop table VipunenTK.dbo.d_kuntaryhma
Select * into VipunenTK.dbo.d_kuntaryhma from VipunenTK.[dbo].[v_d_alueluokitus_kuntaryhma]
*/


SELECT distinct 
	   id = cast(kuntaryhma_koodi as int)
	  ,[kuntaryhma_koodi]
      ,[kuntaryhma]
      ,[kuntaryhma_SV]
      ,[kuntaryhma_EN]
	  ,jarjestys = Case when [kuntaryhma_koodi] = ''-1'' then 8 when [kuntaryhma_koodi] = ''-2'' then 9 else [kuntaryhma_koodi] end
	  ,tietolahde = Cast(''VipunenTK.[dbo].[v_d_alueluokitus_kuntaryhma]'' as nvarchar(50))
FROM [VipunenTK].[dbo].[d_alueluokitus]




' 
GO
/****** Object:  View [dbo].[v_d_AP_tilastointivuosi]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_d_AP_tilastointivuosi]'))
EXEC dbo.sp_executesql @statement = N'CREATE VIEW [dbo].[v_d_AP_tilastointivuosi] AS

Select distinct tilastointivuosi
from (
	Select distinct tilastointivuosi=tilv from dbo.f_ainevalinnat_perusopetuksessa
	UNION ALL
	Select distinct tilastointivuosi=tilv from dbo.f_perusopetuksen_kieltenmaara
	UNION ALL
	Select distinct tilastointivuosi=tilv from dbo.f_perusopetuksen_oppilasmaarat
) tilastovuodet

' 
GO
/****** Object:  View [dbo].[v_d_AVL_tilastointivuosi]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_d_AVL_tilastointivuosi]'))
EXEC dbo.sp_executesql @statement = N'CREATE VIEW [dbo].[v_d_AVL_tilastointivuosi] AS

Select distinct tilastointivuosi=tilastovuosi from 
(Select distinct tilastovuosi from VipunenTK.dbo.f_AVL_ainevalinnat
  union all
 Select distinct tilastovuosi from VipunenTK.dbo.f_AVL_kieltenmaarat) tilastovuodet

' 
GO
/****** Object:  View [dbo].[v_d_oppilaitoksen_taustatiedot_nykytila]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_d_oppilaitoksen_taustatiedot_nykytila]'))
EXEC dbo.sp_executesql @statement = N'CREATE VIEW [dbo].[v_d_oppilaitoksen_taustatiedot_nykytila] AS
SELECT [id]
      ,[oppilaitoskoodi]
      ,[oppilaitoksen_korvaavakoodi]
      --,[alkaa]
      --,[paattyy]
      ,[oppilaitos]
      ,[oppilaitos_SV]
      ,[oppilaitos_EN]
      ,[sairaalakoulukoodi]
      ,[sairaalakoulu]
      ,[sairaalakoulu_SV]
      ,[sairaalakoulu_EN]
      ,[oppilaitostyyppikoodi]
      ,[oppilaitostyyppi]
      ,[oppilaitostyyppi_SV]
      ,[oppilaitostyyppi_EN]
      ,[peruskoulujen_ryhmityskoodi]
      ,[peruskoulujen_ryhmitys]
      ,[peruskoulujen_ryhmitys_SV]
      ,[peruskoulujen_ryhmitys_EN]
      ,[peruskoulujen_vuosilkskoodi]
      ,[peruskoulujen_vuosilks]
      ,[peruskoulujen_vuosilks_SV]
      ,[peruskoulujen_vuosilks_EN]
      ,[oppilaitoksen_omistajatyyppikoodi]
      ,[oppilaitoksen_omistajatyyppi]
      ,[oppilaitoksen_omistajatyyppi_SV]
      ,[oppilaitoksen_omistajatyyppi_EN]
      ,[opetuskielikoodi]
      ,[opetuskieli]
      ,[opetuskieli_SV]
      ,[opetuskieli_EN]
      ,[sijaintikuntakoodi]
      ,[oppilaitoksen_sijaintikunta]
      ,[oppilaitoksen_sijaintikunta_SV]
      ,[oppilaitoksen_sijaintikunta_EN]
      ,[koordinaatti_itakoodi]
      ,[koordinaatti_pohjoiskoodi]
      ,[postinumerokoodi]
      ,[jarjestys_oppilaitos]
      ,[jarjestys_sairaalakoulu]
      ,[jarjestys_oppilaitostyyppi]
      ,[jarjestys_peruskoulujen_ryhmitys]
      ,[jarjestys_peruskoulujen_vuosilks]
      ,[jarjestys_omistajatyyppi]
      ,[jarjestys_opetuskieli]
      ,[jarjestys_koulutuksen_jarjestaja]
      ,[jarjestys_sijaintikunta]
      ,[jarjestys_koordinaatti_ita]
      ,[jarjestys_koordinaatti_pohjois]
      ,[jarjestys_postinumero]
      ,[tietolahde_oppilaitos]
      ,[koulutuksen_jarjestajakoodi]
      ,[koulutuksen_jarjestajan_korvaavakoodi]
      ,[koulutuksen_jarjestaja]
      ,[koulutuksen_jarjestaja_SV]
      ,[koulutuksen_jarjestaja_EN]
      ,[koulutuksen_jarjestajan_omistajatyyppikoodi]
      ,[koulutuksen_jarjestajan_omistajatyyppi]
      ,[koulutuksen_jarjestajan_omistajatyyppi_SV]
      ,[koulutuksen_jarjestajan_omistajatyyppi_EN]
      ,[koulutuksen_jarjestajan_kielikoodi]
      ,[koulutuksen_jarjestajan_kieli]
      ,[koulutuksen_jarjestajan_kieli_SV]
      ,[koulutuksen_jarjestajan_kieli_EN]
      ,[koulutuksen_jarjestajan_ksijaintikuntakoodi]
      ,[koulutuksen_jarjestajan_sijaintikunta]
      ,[koulutuksen_jarjestajan_sijaintikunta_SV]
      ,[koulutuksen_jarjestajan_sijaintikunta_EN]
      ,[jarjestys_koulutuksenjarjestaja]
      ,[jarjestys_koulutuksen_jarjestajan_kieli]
      ,[jarjestys_sijaintikunta_koulutuksenjarjestaja]
      ,[tietolahde_koulutuksenjarjestaja]
      ,[koulutuksen_jarjestajan_ainoa_oppilaitos]
  FROM [VipunenTK].[dbo].[d_oppilaitoksen_taustatiedot_historia]
  WHERE paattyy>''2999-01-01''

' 
GO
/****** Object:  View [dbo].[v_d_OTV_aineisto]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_d_OTV_aineisto]'))
EXEC dbo.sp_executesql @statement = N'CREATE VIEW [dbo].[v_d_OTV_aineisto] AS

Select distinct aineistotunnus
from (
	Select distinct aineistotunnus from dbo.f_OTV_2_1_R2_22_Peruskoulutiedosto_Oppilaitostason_oppil_ja_opisk
	UNION ALL
	Select distinct aineistotunnus from dbo.f_OTV_2_3_Lukiokoulutuksen_ja_ammatillisen_koulutuksen_opiskelijat
	UNION ALL
	Select distinct aineistotunnus from dbo.f_OTV_2_4_Ammatillisen_koulutuksen_tutkinnot
	UNION ALL
	Select distinct aineistotunnus from dbo.f_OTV_2_8_Korkeakouluopiskelijat
	UNION ALL
	Select distinct aineistotunnus from dbo.f_OTV_2_9_Korkeakoulututkinnot
	UNION ALL
	Select distinct aineistotunnus from dbo.f_OTV_3_14_Lukio_ja_ammatillisen_koulutuksen_opiskelijoiden_mediaani_iat
	UNION ALL
	Select distinct aineistotunnus from dbo.f_OTV_3_15_Lukio_ja_ammatillisen_koulutuksen_tutkintojen_mediaani_iat
	UNION ALL
	Select distinct aineistotunnus from dbo.f_OTV_3_4_Korkeakoulututkinnon_suorittaneiden_mediaani_iat_ja_tutkinnon_suorittamiseen_kuluneet_mediaaniajat
	UNION ALL
	Select distinct aineistotunnus from dbo.f_OTV_4_9_Vaestorakenne_kunnittain
) aineistotunnukset

' 
GO
/****** Object:  View [dbo].[v_d_OTV_suoritusaika]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_d_OTV_suoritusaika]'))
EXEC dbo.sp_executesql @statement = N'
CREATE VIEW [dbo].[v_d_OTV_suoritusaika] AS

Select distinct suoritusaika, jarjestys_suoritusaika
from (
	Select distinct suoritusaika, jarjestys_suoritusaika from dbo.f_OTV_3_15_Lukio_ja_ammatillisen_koulutuksen_tutkintojen_mediaani_iat
	UNION ALL
	Select distinct suoritusaika, jarjestys_suoritusaika from dbo.f_OTV_3_4_Korkeakoulututkinnon_suorittaneiden_mediaani_iat_ja_tutkinnon_suorittamiseen_kuluneet_mediaaniajat
) suoritusajat


' 
GO
/****** Object:  View [dbo].[v_d_OTV_suoritusaika_kk]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_d_OTV_suoritusaika_kk]'))
EXEC dbo.sp_executesql @statement = N'

CREATE VIEW [dbo].[v_d_OTV_suoritusaika_kk] AS

Select distinct suoritusaika_kk, jarjestys_suoritusaika_kk
from (

	Select distinct suoritusaika_kk, jarjestys_suoritusaika_kk from dbo.f_OTV_3_4_Korkeakoulututkinnon_suorittaneiden_mediaani_iat_ja_tutkinnon_suorittamiseen_kuluneet_mediaaniajat
) suoritusajat



' 
GO
/****** Object:  View [dbo].[v_d_OTV_suoritusika]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_d_OTV_suoritusika]'))
EXEC dbo.sp_executesql @statement = N'
CREATE VIEW [dbo].[v_d_OTV_suoritusika] AS

Select distinct suoritusika, jarjestys_suoritusika
from (
	Select distinct suoritusika, jarjestys_suoritusika from dbo.f_OTV_3_15_Lukio_ja_ammatillisen_koulutuksen_tutkintojen_mediaani_iat
	UNION ALL
	Select distinct suoritusika, jarjestys_suoritusika from dbo.f_OTV_3_4_Korkeakoulututkinnon_suorittaneiden_mediaani_iat_ja_tutkinnon_suorittamiseen_kuluneet_mediaaniajat
) suoritusiat


' 
GO
/****** Object:  View [dbo].[v_d_OTV_tilastointivuosi]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_d_OTV_tilastointivuosi]'))
EXEC dbo.sp_executesql @statement = N'CREATE VIEW [dbo].[v_d_OTV_tilastointivuosi] AS

Select distinct tilastointivuosi
from (
	Select distinct tilastointivuosi from dbo.f_OTV_2_1_R2_22_Peruskoulutiedosto_Oppilaitostason_oppil_ja_opisk
	UNION ALL
	Select distinct tilastointivuosi=tilv from dbo.f_OTV_2_3_Lukiokoulutuksen_ja_ammatillisen_koulutuksen_opiskelijat
	UNION ALL
	Select distinct tilastointivuosi from dbo.f_OTV_2_4_Ammatillisen_koulutuksen_tutkinnot
	UNION ALL
	Select distinct tilastointivuosi from dbo.f_OTV_2_8_Korkeakouluopiskelijat
	UNION ALL
	Select distinct tilastointivuosi from dbo.f_OTV_2_9_Korkeakoulututkinnot
	UNION ALL
	Select distinct tilastointivuosi from dbo.f_OTV_3_14_Lukio_ja_ammatillisen_koulutuksen_opiskelijoiden_mediaani_iat
	UNION ALL
	Select distinct tilastointivuosi from dbo.f_OTV_3_15_Lukio_ja_ammatillisen_koulutuksen_tutkintojen_mediaani_iat
	UNION ALL
	Select distinct tilastointivuosi from dbo.f_OTV_3_4_Korkeakoulututkinnon_suorittaneiden_mediaani_iat_ja_tutkinnon_suorittamiseen_kuluneet_mediaaniajat
	UNION ALL
	Select distinct tilastointivuosi from dbo.f_OTV_4_9_Vaestorakenne_kunnittain
) tilastovuodet

' 
GO
/****** Object:  View [dbo].[v_d_PAEO_tilastovuosi]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_d_PAEO_tilastovuosi]'))
EXEC dbo.sp_executesql @statement = N'CREATE VIEW [dbo].[v_d_PAEO_tilastovuosi] AS

Select distinct tilastovuosi
from (
	Select distinct tilastovuosi=tilv from dbo.f_Perusasteen_erityisopetus_erityisen_tuen_oppilaiden_opetus
	UNION ALL
	Select distinct tilastovuosi=tilv from dbo.f_Perusasteen_erityisopetus_erityisen_tuen_oppilaiden_oppimaara
	UNION ALL
	Select distinct tilastovuosi=tilv from dbo.f_Perusasteen_erityisopetus_jopo_oppilaat
	UNION ALL
	Select distinct tilastovuosi=tilv from dbo.f_Perusasteen_erityisopetus_kuljetusetuutta_saavien_oppilaiden_lkm
	UNION ALL
	Select distinct tilastovuosi=tilv from dbo.f_Perusasteen_erityisopetus_majoitusetuutta_saavien_oppilaiden_lkm
	UNION ALL
	Select distinct tilastovuosi=tilv from dbo.f_Perusasteen_erityisopetus_oppilaiden_lkm
	UNION ALL
	Select distinct tilastovuosi=tilv from dbo.f_Perusasteen_erityisopetus_peruskoulun_aloittaneiden_oppilaiden_lkm
	UNION ALL
	Select distinct tilastovuosi=tilv from dbo.f_Perusasteen_erityisopetus_peruskoulun_ilman_todistusta_paattaneiden_oppilaiden_lkm
	UNION ALL
	Select distinct tilastovuosi=tilv from dbo.f_Perusasteen_erityisopetus_tehostetun_tuen_oppilaiden_lkm
	UNION ALL
	Select distinct tilastovuosi=tilv from dbo.f_Perusasteen_erityisopetus_tukea_saavien_oppilaiden_lkm
	UNION ALL
	Select distinct tilastovuosi=tilv from dbo.f_Perusasteen_erityisopetus_vieraskielisten_tehostetun_tuen_oppilaiden_lkm
) tilastovuodet

' 
GO
/****** Object:  View [dbo].[v_d_TJK_tilastointivuosi]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_d_TJK_tilastointivuosi]'))
EXEC dbo.sp_executesql @statement = N'CREATE VIEW [dbo].[v_d_TJK_tilastointivuosi] AS

Select distinct tilastointivuosi
from (
	Select distinct tilastointivuosi from dbo.f_TJK_2_11_tutkintoon_johtamaton_koulutus
) tilastovuodet

' 
GO
/****** Object:  View [dbo].[v_f_aloittaneiden_lapaisy_K3_10_amk]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_aloittaneiden_lapaisy_K3_10_amk]'))
EXEC dbo.sp_executesql @statement = N'





















CREATE VIEW [dbo].[v_f_aloittaneiden_lapaisy_K3_10_amk]
AS
SELECT f.lkm_int AS lkm_int2, 
		d1.lukuvuosi AS Aloituslukuvuosi, 
		d1.vuosiselite AS Aloitusvuosi, 
		d1.lukukausiselite AS Aloituslukukausi, 
		d17.tarkastelujakso AS Tarkastelujakso, 
		d16.sukupuoli AS Sukupuoli, 
		d2.aidinkieli_versio1 AS Äidinkieli, 
		d5.ika AS Ikä, 
		d5.ika5v AS Ikäryhmä, 
		d6.koulutuslaji2 AS [Tavoitetutk. koulutustyyppi], 
		Case when d7.koulutusaste2002_koodi=''62'' 
		then ''Aloitus I syklin tutkinnossa'' 
			when d7.koulutusaste2002_koodi=''71'' then ''Aloitus II syklin tutkinnossa''  
			else ''Tuntematon'' end AS [Tavoitetutk. sykli], 
		d7.koulutusala2002 AS [Tavoitetutk. koulutusala], 
		d7.opintoala1995 AS [Tavoitetutk. koul.ala (95 luokitus)], 
		d7.opintoala2002 AS [Tavoitetutk. opintoala], 
		d7.koulutus AS [Tavoitetutk. koulutusnimike], 
		d8.koulutusaste2002 AS [Suor. tutkinnon koulutusaste], 
		d8.koulutusala2002 AS [Suor. tutkinnon koulutusala], 
		d8.opintoala1995 AS [Suor. tutkinnon koul.ala (95 luokitus)], 
		d8.opintoala2002 AS [Suor. tutkinnon opintoala], 
		d8.koulutus AS [Suor. tutkinnon koulutusnimike], 
		d9.koulutusaste2002 AS [Pohjakoul. koulutusaste], 
		d9.koulutusala2002 AS [Pohjakoul. koulutusala], 
		d9.opintoala1995 AS [Pohjakoul. koul.ala (95 luokitus)], 
		d9.opintoala2002 AS [Pohjakoul. opintoala], 
		d9.koulutus AS [Pohjakoul. koulutusnimike], 
		d3.maakunta AS [Tavoitetutk. maakunta], 
		d4.maakunta AS [Suor. tutkinnon maakunta], 
		d12.opiskelijan_olo AS Kirjoillaolo, 
		d13.oppilaitos AS [Tavoitetutk. amk], 
		d13.oppilaitostyyppi AS [Tavoitetutk. oppil.tyyppi], 
		d13.oppilaitoksen_omistajatyyppi AS [Tavoitetutk. oppil. omistajatyyppi],
		d13.koulutuksen_jarjestaja AS [Tavoitetutk. koul. järjestäjä],
		d14.oppilaitos AS [Suor. tutkinnon amk], 
		d14.oppilaitostyyppi AS [Suor. tutkinnon oppil.tyyppi], 
		d14.oppilaitoksen_omistajatyyppi AS [Suor. tutkinnon oppil. omistajatyyppi], 
		d15.rahoituslahde AS [Rahoituslähde],
		f.[1a Aloittaneiden opintojen kulku koulutuslajin mukaan prioriteettina mikä tahansa tutkinto] AS [Opintojen kulku], 
		f.[1b Aloittaneiden opintojen kulku koulutuslajin mukaan prioriteettina tutkinto ja opiskelu alkuperäisessä tutkintolajissa] AS [Opintojen kulku prioriteetti 2], 
		f.[1c Aloittaneista tutkinnon suorittaneet koulutuslajin mukaan] AS [Suoritettu tutkinto], 
		f.[1d Aloittaneista ilman tutkintoa opiskelua jatkavat koulutuslajin mukaan] AS [Opiskelua jatkavat tutk.lajin mukaan], 
		f.[1e Aloittaneista alkuperäisen koulutuslajin tutkinnon suorittaneet koulutuslajin mukaan] AS [Tutkinto tavoitet. tutkintolajissa], 
		f.[1f Aloittaneista muun kuin alkuperäisen tutkintolajin tutkinnon suorittaneet koulutuslajin mukaan] AS [Tutkinto muussa tutkintolajissa], 
		f.[1g Aloittaneista alkuperäisen tutkintolajin opiskelua jatkavat koulutuslajin mukaan] AS [Opiskelee tavoitet. tutkintolajissa], 
		f.[1h Aloittaneista muun tutkintolajin opiskelua jatkavat koulutuslajin mukaan] AS [Opiskelee muussa tutkintolajissa], 
		f.[2a Aloittaneiden opintojen kulku koulutusalan (2002) mukaan prioriteettina mikä tahansa tutkinto] AS [Opintojen kulku koulutusaloittain], 
		f.[2b Aloittaneiden opintojen kulku koulutusalan (2002) mukaan prioriteettina tutkinto ja opiskelu alkuperäisellä] AS [Opintojen kulku koulutusaloittain prioriteetti 2], 
		f.[2e Aloittaneista alkuperäisen koulutusalan (2002) tutkinnon suorittaneet koulutusalan mukaan] AS [Tutkinto tavoitet. koulutusalalla], 
		f.[2f Aloittaneista muun kuin alkuperäisen tutkintolajin tutkinnon suorittaneet koulutuslajin mukaan] AS [Tutkinto muulla koulutusalalla], 
		f.[2g Aloittaneista alkuperäisellä koulutusalalla opiskelua jatkavat koulutusalan mukaan] AS [Opiskelee tavoitet. koulutusalalla], 
		f.[2h Aloittaneista muulla koulutusalalla opiskelua jatkavat koulutusalan mukaan] AS [Opiskelee muulla koulutusalalla], 
		f.[3a Aloittaneiden opintojen kulku opintoalan (2002) mukaan prioriteettina mikä tahansa tutkinto] AS [Opintojen kulku opintoaloittain], 
		f.[3b Aloittaneiden opintojen kulku opintoalan (2002) mukaan prioriteettina tutkinto ja opiskelu alkuperäisellä] AS [Opintojen kulku opintoaloittain prioriteetti 2],
		f.[3e Aloittaneista alkuperäisen opintoalan (2002) tutkinnon suorittaneet opintoalan mukaan] AS [Tutkinto tavoitet. opintoalalla], 
		f.[3f Aloittaneista muun opintoalan (2002) tutkinnon suorittaneet opintoalan mukaan] AS [Tutkinto muulla opintoalalla], 
		f.[3g Aloittaneista alkuperäisellä opintoalalla (2002) opiskelua jatkavat opintoalan mukaan] AS [Opiskelee tavoitet. opintoalalla], 
		f.[3h Aloittaneista muulla opintoalalla (2002) opiskelua jatkavat opintoalan mukaan] AS [Opiskelee muulla opintoalalla], 
		f.[4a Aloittaneiden opintojen kulku koulutuksen järjestäjän mukaan, toinen aste prioriteettina tutkinto missä tahansa] AS [Opintojen kulku koul. järjestäjittäin], 
		f.[4b Aloittaneiden opintojen kulku koulutuksen järjestäjän mukaan, toinen aste prioriteettina tutkinto ja opiskelu alkuperäisellä] AS [Opintojen kulku koul. järjestäjittäin prioriteetti 2], 
		f.[4e Aloittaneista alkuperäisen koulutuksen järjestäjän tutkinnon suorittaneet järjestäjän mukaan] AS [Tutkinto tavoitet. koul. järjestäjällä], 
		f.[4f Aloittaneista muun koulutuksen järjestäjän tutkinnon suorittaneet järjestäjän mukaan] AS [Tutkinto muulla koul. järjestäjällä], 
		f.[4g Aloittaneista alkuperäisellä järjestäjällä opiskelua jatkavat järjestäjän mukaan] AS [Opiskelee tavoitet. koul. järjestäjällä], 
		f.[4h Aloittaneista muulla järjestäjällä opiskelua jatkavat järjestäjän mukaan] AS [Opiskelee muulla koul. järjestäjällä], 
		f.[5a Aloittaneiden opintojen kulku oppilaitoksen mukaan prioriteettina tutkinto missä tahansa] AS [Opintojen kulku oppilaitoksittain], 
		f.[5b Aloittaneiden opintojen kulku oppilaitoksen mukaan prioriteettina tutkinto ja opiskelu alkuperäisessä] AS [Opintojen kulku oppilaitoksittain prioriteetti 2], 
		f.[5e Aloittaneista alkuperäisessä oppilaitoksessa tutkinnon suorittaneet oppilaitoksen mukaan] AS [Tutkinto tavoitet. oppilaitoksessa], 
		f.[5f Aloittaneista muussa oppilaitoksessa tutkinnon suorittaneet oppilaitoksen mukaan] AS [Tutkinto muussa oppilaitoksessa], 
		f.[5g Aloittaneista alkuperäisessä oppilaitoksessa opiskelua jatkavat oppilaitoksen mukaan] AS [Opiskelee tavoitet. oppilaitoksessa], 
		f.[5h Aloittaneista muussa oppilaitoksessa opiskelua jatkavat oppilaitoksen mukaan] AS [Opiskelee muussa oppilaitoksessa], 
		f.[6a Aloittaneiden opintojen kulku maakunnan mukaan prioriteettina tutkinto missä tahansa] AS [Opintojen kulku maakunnittain], 
		f.[6b Aloittaneiden opintojen kulku maakunnan mukaan prioriteettina tutkinto ja opiskelu alkuperäisessä] AS [Opintojen kulku maakunnittain prioriteetti 2], 
		f.[6e Aloittaneista alkuperäisessä maakunnassa tutkinnon suorittaneet maakunnan mukaan] AS [Tutkinto tavoitet. maakunnassa], 
		f.[6f Aloittaneista muussa maakunnassa tutkinnon suorittaneet maakunnan mukaan] AS [Tutkinto muussa maakunnassa], 
		f.[6g Aloittaneista alkuperäisessä maakunnassa opiskelua jatkavat maakunnan mukaan] AS [Opiskelee tavoitet. maakunnassa], 
		f.[6h Aloittaneista muussa maakunnassa opiskelua jatkavat maakunnan mukaan] AS [Opiskelee muussa maakunnassa], 
		f.[7a Aloittaneiden opintojen kulku koulutussektorin mukaan prioriteettina tutkinto missä tahansa] AS [Opintojen kulku koul.sektoreittan], 
		f.[7b Aloittaneiden opintojen kulku koulutussektorin mukaan prioriteettina tutkinto ja opiskelu alkuperäisellä] AS [Opintojen kulku koul.sektoreittan prioriteetti 2], 
		f.[7e Aloittaneista alkuperäisen koulutussektorin tutkinnon suorittaneet koulutussektorin mukaan] AS [Tutkinto tavoitet. koulutussektorilla], 
		f.[7f Aloittaneista muun koulutussektorin tutkinnon suorittaneet koulutussektorin mukaan] AS [Tutkinto muulla koulutussektorilla], 
		f.[7g Aloittaneista alkuperäisellä koulutussektorilla opiskelua jatkavat koulutussektorin mukaan] AS [Opiskelee tavoitet. koulutussektorilla], 
		f.[7h Aloittaneista muulla koulutussektorilla opiskelua jatkavat koulutussektorin mukaan] AS [Opiskelee muulla koulutussektorilla], 
		f.[8a Aloittaneiden opintojen kulku opintoalan (1995) mukaan prioriteettina mikä tahansa tutkinto] AS [Opintojen kulku koul.aloittain (95)], 
		f.[8b Aloittaneiden opintojen kulku opintoalan (1995) mukaan prioriteettina tutkinto ja opiskelu alkuperäisellä] AS [Opintojen kulku koul.aloittain (95) prioriteetti 2], 
		f.[8e Aloittaneista alkuperäisen opintoalan (1995) tutkinnon suorittaneet opintoalan mukaan] AS [Tutkinto tavoitet. koulutusalalla (95)], 
		f.[8f Aloittaneista muun opintoalan (1995) tutkinnon suorittaneet opintoalan mukaan] AS [Tutkinto muulla koulutusalalla (95)], 
		f.[8g Aloittaneista alkuperäisellä opintoalalla (1995) opiskelua jatkavat opintoalan mukaan] AS [Opiskelee tavoitet. koulutusalalla (95)], 
		f.[8h Aloittaneista muulla opintoalalla (1995) opiskelua jatkavat opintoalan mukaan] AS [Opiskelee muulla koulutusalalla (95)], 
		f.aloitus_saavutus AS [Aloitus saavutus], 
		f.tarkastelujakso_tulevaisuus AS [Tarkastelujakson tulevaisuus], 
		f.tarkastelujakso_edustavuus AS [Tarkastelujakson edustavuus], 
		d10.lahde AS Lähde, 
		--ruotsi
		d1.lukuvuosi AS Begynnelseläsår, 
		d1.vuosiselite_SV AS Begynnelseår, 
		d1.lukukausiselite_SV AS Begynnelsetermin, 
		d17.tarkastelujakso_SV AS Granskningsperiod, 
		d16.sukupuoli_SV AS Kön, 
		d2.aidinkieli_versio1_SV AS Modersmål, 
		d5.ika_SV AS Ålder, 
		d5.ika5v_SV AS Åldersgrupp, 
		d6.koulutuslaji2_SV AS [Målexamens typ av utbildn.], 
		d7.koulutusaste2002_SV AS [Målexamens utbildn.nivå 2002], 
		Case when d7.koulutusaste2002_koodi=''63'' 
		Or (d7.koulutusaste2002_koodi=''72'' 
			and  d7.koulutus_koodi in (''772101'', ''772201'')) Or d7.koulutusaste2002_koodi=''62'' then ''Påbörjande i I-skedets examen'' 
			when d7.koulutusaste2002_koodi=''71'' Or d7.koulutusaste2002_koodi=''72'' then ''Påbörjande i II-skedets examen''  
			else ''Tuntematon'' end AS [Startskede], 
		d7.koulutusala2002_SV AS [Målexamens utbildn.område 02], 
		d7.opintoala2002_SV AS [Målexamens studieområde 02], 
		d7.koulutus_SV AS [Målexamens utbildn.benämning], 
		d8.koulutusaste2002_SV AS [Examens utbildn.nivå 2002], 
		d8.koulutusala2002_SV AS [Examens utbildn.område 2002], 
		d8.opintoala2002_SV AS [Examens studieområde 2002], 
		d8.koulutus_SV AS [Examens utbildn.benämning], 
		d9.koulutusaste2002_SV AS [Grundutb. utbildn.nivå 2002], 
		d9.koulutusala2002_SV AS [Grundutb. utbildn.område 2002], 
		d9.opintoala2002_SV AS [Grundutb. studieområde 2002], 
		d9.koulutus_SV AS [Grundutb. utbildn.benämning], 
		d3.maakunta_SV AS [Målexamens landskap], 
		d4.maakunta_SV AS [Examens landskap], 
		d12.opiskelijan_olo_SV AS Inskrivning, 
		d13.oppilaitos_SV AS [Målexamens yrkehögskola], 
		d13.koulutuksen_jarjestaja_SV AS [Målexamens utbildn.ordnare],
		d14.oppilaitos_SV AS [Examens yrkehögskola], 
		[Studieförlopp] = 
			case f.[1a Aloittaneiden opintojen kulku koulutuslajin mukaan prioriteettina mikä tahansa tutkinto]
				when ''Tutkinto alkuperäisessä tutkintolajissa'' then ''Examen i det ursprungliga examensslaget''
				when ''Tutkinto muussa tutkintolajissa'' then ''Examen i annat examensslag''
				when ''Tutkinto muussa tutkintolajissa, kandidaatin tutkinto'' then ''Examen i annat examensslag, lägre högskoleexamen''
				when ''Opiskelee alkuperäisessä tutkintolajissa'' then ''Studerar i det ursprungliga examensslaget''
				when ''Opiskelee muussa tutkintolajissa'' then ''Studerar i annat examensslag''
				when ''Ei tutkintoa, ei opiskele, työllinen'' then ''Ingen examen, inte studerar, sysselsatt''
				when ''Ei tutkintoa, ei opiskele, ei työllinen'' then ''Ingen examen, inte studerar, arbetslös''
				else  ''Information saknas''
			end , 
		[Studieförlopp prior. 2] =
			case f.[1b Aloittaneiden opintojen kulku koulutuslajin mukaan prioriteettina tutkinto ja opiskelu alkuperäisessä tutkintolajissa]
				when ''Tutkinto alkuperäisessä tutkintolajissa'' then ''Examen i det ursprungliga examensslaget''
				when ''Tutkinto muussa tutkintolajissa'' then ''Examen i annat examensslag''
				when ''Tutkinto muussa tutkintolajissa, kandidaatin tutkinto'' then ''Examen i annat examensslag, lägre högskoleexamen''
				when ''Opiskelee alkuperäisessä tutkintolajissa'' then ''Studerar i det ursprungliga examensslaget''
				when ''Opiskelee muussa tutkintolajissa'' then ''Studerar i annat examensslag''
				when ''Ei tutkintoa, ei opiskele, työllinen'' then ''Ingen examen, inte studerar, sysselsatt''
				when ''Ei tutkintoa, ei opiskele, ei työllinen'' then ''Ingen examen, inte studerar, arbetslös''
				else ''Information saknas''
			end			, 
		[Avlagt examen] =
			case f.[1c Aloittaneista tutkinnon suorittaneet koulutuslajin mukaan]
				when ''Tutkinto lukiokoulutuksesta'' then ''Studentexamen''
				when ''Ammatillinen perustutkinto'' then ''Grundläggande yrkesexamen''
				when ''Ammatillinen lisäkoulutus ammattitutkinto tai erikoisammattitutkinto'' then ''Yrkesinriktad tilläggsutbildning, yrkesexamen eller specialyrkesexamen''
				when ''Muu korkein ja viimeisimmäksi suoritettu tutkinto, toinen aste'' then ''Övrig högsta och senast avlagd examen, andra stadiet''
				when ''Ammattikorkeakoulututkinto'' then ''Yrkeshögskoleexamen''
				when ''Alempi korkeakoulututkinto'' then ''Lägre högskoleexamen''
				when ''Ylempi ammattikorkeakoulututkinto'' then ''Högre yrkeshögskoleexamen''
				when ''Ylempi korkeakoulututkinto'' then ''Högre högskoleexamen''
				when ''Tutkijakoulutusasteen tutkinto'' then ''Examen på forskarutbildningsnivå''
				when ''Muu korkein ja viimeisimmäksi suoritettu tutkinto, korkeakoulututkinto'' then ''Övrig högsta och senast avlagd examen, högskoleexamen''
				when ''Ei tutkintoa'' then ''Ingen examen''
				when ''Virhetilanne'' then ''Information saknas''
			end, 
		[Examen i målex. examensslag] = 
			case f.[1e Aloittaneista alkuperäisen koulutuslajin tutkinnon suorittaneet koulutuslajin mukaan]
				when ''Kyllä'' then ''Ja''
				when ''Ei'' then ''Inte''
				when ''Virhetilanne'' then ''Information saknas''
			end
		, 
		[Examen i annat examensslag] = 
			case [1f Aloittaneista muun kuin alkuperäisen tutkintolajin tutkinnon suorittaneet koulutuslajin mukaan]
				when ''Kyllä'' then ''Ja''
				when ''Ei'' then ''Inte''
				when ''Virhetilanne'' then ''Information saknas''
			end	
			, 
		[Examen i målex. utbildn.område 02] =
			case [2e Aloittaneista alkuperäisen koulutusalan (2002) tutkinnon suorittaneet koulutusalan mukaan]
				when ''Kyllä'' then ''Ja''
				when ''Ei'' then ''Inte''
				when ''Virhetilanne'' then ''Information saknas''
			end	
		, 
		[Examen i målex. studieområde 02] = 
			case [3e Aloittaneista alkuperäisen opintoalan (2002) tutkinnon suorittaneet opintoalan mukaan]
				when ''Kyllä'' then ''Ja''
				when ''Ei'' then ''Inte''
				when ''Virhetilanne'' then ''Information saknas''
			end	
		, 
		[Examen i målex. läroanstalt] = 
			case [5e Aloittaneista alkuperäisessä oppilaitoksessa tutkinnon suorittaneet oppilaitoksen mukaan] 
				when ''Kyllä'' then ''Ja''
				when ''Ei'' then ''Inte''
				when ''Virhetilanne'' then ''Information saknas''
			end	
		, 
		[Examen i målex. utbildn.område 95] = 
			case [8e Aloittaneista alkuperäisen opintoalan (1995) tutkinnon suorittaneet opintoalan mukaan]
				when ''Kyllä'' then ''Ja''
				when ''Ei'' then ''Inte''
				when ''Virhetilanne'' then ''Information saknas''
			end	
		, 
		--englanti
		d1.lukuvuosi AS [First academic year], 
		d1.vuosiselite_EN AS [First year of studies], 
		d1.lukukausiselite_EN AS [First term], 
		d17.tarkastelujakso_EN AS [Reference period], 
		d16.sukupuoli_EN AS Gender, 
		d2.aidinkieli_versio1_EN AS [Mother tongue], 
		d5.ika_EN AS Age, 
		d5.ika5v_EN AS [Age group], 
		d6.koulutuslaji2_EN AS [Target degree''s type of ed.], 
		d7.koulutusaste2002_EN AS [Target deg. level of ed. 02], 
		Case when d7.koulutusaste2002_koodi=''63'' 
		Or (d7.koulutusaste2002_koodi=''72'' 
			and  d7.koulutus_koodi in (''772101'', ''772201'')) Or d7.koulutusaste2002_koodi=''62'' then ''Beginning of studies in cycle I degree'' 
			when d7.koulutusaste2002_koodi=''71'' Or d7.koulutusaste2002_koodi=''72'' then ''Beginning of studies in cycle II degree''  
			else ''Tuntematon'' end AS [Beginning cycle of ed.], 
		d7.koulutusala2002_EN AS [Target deg. field of ed. 02], 
		d7.opintoala2002_EN AS [Target deg. subfield of ed. 02], 
		d7.koulutus_EN AS [Target deg. name of ed.], 
		d8.koulutusaste2002_EN AS [Degree''s level of ed. 02], 
		d8.koulutusala2002_EN AS [Degree''s field of ed. 02], 
		d8.opintoala2002_EN AS [Degree''s subfield of ed. 02], 
		d8.koulutus_EN AS [Degree''s name of ed.], 
		d9.koulutusaste2002_EN AS [Previous deg. level of ed. 02], 
		d9.koulutusala2002_EN AS [Previous deg. field of ed. 02], 
		d9.opintoala2002_EN AS [Previous deg. subfield of ed. 02], 
		d9.koulutus_EN AS [Previous deg. name of ed.], 
		d3.maakunta_EN AS [Target degree''s region], 
		d4.maakunta_EN AS [Degree''s region], 
		d12.opiskelijan_olo_EN AS [Enrollment status], 
		d13.oppilaitos_EN AS [Target deg. polytechnic], 
		d13.koulutuksen_jarjestaja_EN AS [Target deg. ed. provider],
		d14.oppilaitos_EN AS [Degree''s polytechnic], 
		[Study progress] =
			case f.[1a Aloittaneiden opintojen kulku koulutuslajin mukaan prioriteettina mikä tahansa tutkinto]
				when ''Tutkinto alkuperäisessä tutkintolajissa'' then ''Qualification in the original form of degree''
				when ''Tutkinto muussa tutkintolajissa'' then ''Qualification in another form of degree''
				when ''Tutkinto muussa tutkintolajissa, kandidaatin tutkinto'' then ''Qualification in another form of degree, Bachelor''''s degree''
				when ''Opiskelee alkuperäisessä tutkintolajissa'' then ''Studying in the original form of degree''
				when ''Opiskelee muussa tutkintolajissa'' then ''Studying in another form of degree''
				when ''Ei tutkintoa, ei opiskele, työllinen'' then ''No qualification, not studying, employed''
				when ''Ei tutkintoa, ei opiskele, ei työllinen'' then ''No qualification, not studying, unemployed''
				else  ''Missing data''
			end ,
		[Study progress prior. 2] = 
			case f.[1b Aloittaneiden opintojen kulku koulutuslajin mukaan prioriteettina tutkinto ja opiskelu alkuperäisessä tutkintolajissa]
				when ''Tutkinto alkuperäisessä tutkintolajissa'' then ''Qualification in the original form of degree''
				when ''Tutkinto muussa tutkintolajissa'' then ''Qualification in another form of degree''
				when ''Tutkinto muussa tutkintolajissa, kandidaatin tutkinto'' then ''Qualification in another form of degree, Bachelor''''s degree''
				when ''Opiskelee alkuperäisessä tutkintolajissa'' then ''Studying in the original form of degree''
				when ''Opiskelee muussa tutkintolajissa'' then ''Studying in another form of degree''
				when ''Ei tutkintoa, ei opiskele, työllinen'' then ''No qualification, not studying, employed''
				when ''Ei tutkintoa, ei opiskele, ei työllinen'' then ''No qualification, not studying, unemployed''
				else  ''Missing data''
			end , 
		[Completed degree] =
			case f.[1c Aloittaneista tutkinnon suorittaneet koulutuslajin mukaan]
				when ''Tutkinto lukiokoulutuksesta'' then ''Matriculation examination''
				when ''Ammatillinen perustutkinto'' then ''Vocational upper secondary qualification''
				when ''Ammatillinen lisäkoulutus ammattitutkinto tai erikoisammattitutkinto'' then ''Further vocational qualification or specialist vocational qualification''
				when ''Muu korkein ja viimeisimmäksi suoritettu tutkinto, toinen aste'' then ''Other highest and most recent degree, upper secondary education''
				when ''Ammattikorkeakoulututkinto'' then ''UAS degree''
				when ''Alempi korkeakoulututkinto'' then ''Bachelor''''s degree''
				when ''Ylempi ammattikorkeakoulututkinto'' then ''UAS Master''''s degree''
				when ''Ylempi korkeakoulututkinto'' then ''Master''''s degree''
				when ''Tutkijakoulutusasteen tutkinto'' then ''Research degree''
				when ''Muu korkein ja viimeisimmäksi suoritettu tutkinto, korkeakoulututkinto'' then ''Other highest and most recent degree, higher education''
				when ''Ei tutkintoa'' then ''No degree''
				when ''Virhetilanne'' then ''Missing data''
			end, 
		[Degree in target form of deg.] =
			case f.[1e Aloittaneista alkuperäisen koulutuslajin tutkinnon suorittaneet koulutuslajin mukaan]
				when ''Kyllä'' then ''Yes''
				when ''Ei'' then ''No''
				when ''Virhetilanne'' then ''Missing data''
			end, 
		[Degree in another form of deg.] =
			case f.[1f Aloittaneista muun kuin alkuperäisen tutkintolajin tutkinnon suorittaneet koulutuslajin mukaan]
				when ''Kyllä'' then ''Yes''
				when ''Ei'' then ''No''
				when ''Virhetilanne'' then ''Missing data''
			end, 
		 [Degree in target field of ed. 02] =
			case f.[2e Aloittaneista alkuperäisen koulutusalan (2002) tutkinnon suorittaneet koulutusalan mukaan]
				when ''Kyllä'' then ''Yes''
				when ''Ei'' then ''No''
				when ''Virhetilanne'' then ''Missing data''
			end, 
		[Degree in target subfield of ed. 02] =
			case f.[3e Aloittaneista alkuperäisen opintoalan (2002) tutkinnon suorittaneet opintoalan mukaan]
				when ''Kyllä'' then ''Yes''
				when ''Ei'' then ''No''
				when ''Virhetilanne'' then ''Missing data''
			end, 
		 [Degree in target ed. institution] =
			case f.[5e Aloittaneista alkuperäisessä oppilaitoksessa tutkinnon suorittaneet oppilaitoksen mukaan]
				when ''Kyllä'' then ''Yes''
				when ''Ei'' then ''No''
				when ''Virhetilanne'' then ''Missing data''
			end, 
		 [Degree in target field of ed. 95] =
			case f.[8e Aloittaneista alkuperäisen opintoalan (1995) tutkinnon suorittaneet opintoalan mukaan]
				when ''Kyllä'' then ''Yes''
				when ''Ei'' then ''No''
				when ''Virhetilanne'' then ''Missing data''
			end, 
		--koodit
		d7.koulutusaste2002_Koodi AS [Koodit Tavoitetutk. koulutusaste 2002], 
		d7.koulutusala2002_Koodi AS [Koodit Tavoitetutk. koul.ala 2002], 
		d7.opintoala1995_Koodi AS [Koodit Tavoitetutk. koul.ala 1995], 
		d7.opintoala2002_Koodi AS [Koodit Tavoitetutk. opintoala 2002], 
		d7.koulutus_Koodi AS [Koodit Tavoitetutk. koulutusnimike], 
		d8.koulutusaste2002_Koodi AS [Koodit Suor. tutkinnon koulutusaste 2002], 
		d8.koulutusala2002_Koodi AS [Koodit Suor. tutkinnon koul.ala 2002], 
		d8.opintoala1995_Koodi AS [Koodit Suor. tutkinnon koul.ala 1995], 
		d8.opintoala2002_Koodi AS [Koodit Suor. tutkinnon opintoala 2002], 
		d8.koulutus_Koodi AS [Koodit Suor. tutkinnon koulutusnimike], 
		d9.koulutusaste2002_Koodi AS [Koodit Pohjakoul. koulutusaste 2002], 
		d9.koulutusala2002_Koodi AS [Koodit Pohjakoul. koul.ala 2002], 
		d9.opintoala1995_Koodi AS [Koodit Pohjakoul. koul.ala 1995], 
		d9.opintoala2002_Koodi AS [Koodit Pohjakoul. opintoala 2002], 
		d9.koulutus_Koodi AS [Koodit Pohjakoul. koulutusnimike], 
		d3.maakunta_Koodi AS [Koodit Tavoitetutk. maakunta], 
		d4.maakunta_Koodi AS [Koodit Suor. tutkinnon maakunta], 
		coalesce(d13.oppilaitoksen_korvaavakoodi,d13.oppilaitoskoodi) AS [Koodit Tavoitetutk. oppilaitos], 
		coalesce(d13.oppilaitoksen_korvaavakoodi,d13.oppilaitoskoodi) AS [Koodit Tavoitetutk. yliopisto], 
		coalesce(d13.oppilaitoksen_korvaavakoodi,d13.oppilaitoskoodi) AS [Koodit Tavoitetutk. amk], 
		d13.koulutuksen_jarjestajakoodi AS [Koodit Tavoitetutk. koul. järjestäjä],
		coalesce(d14.oppilaitoksen_korvaavakoodi,d14.oppilaitoskoodi) AS [Koodit Suor. tutkinnon oppilaitos], 
		coalesce(d14.oppilaitoksen_korvaavakoodi,d14.oppilaitoskoodi) AS [Koodit Suor. tutkinnon yliopisto], 
		coalesce(d14.oppilaitoksen_korvaavakoodi,d14.oppilaitoskoodi) AS [Koodit Suor. tutkinnon amk], 
		d1.jarjestys AS lukukausi_jarjestys, 
		d17.jarjestys AS tarkastelujakso_jarjestys, 
		d16.jarjestys AS sukupuoli_jarjestys, 
		d2.jarjestys AS aidinkieli_jarjestys, 
		d5.jarjestys_ika, 
		d5.jarjestys_ika5v, 
		d6.jarjestys_koulutuslaji2 AS koulutuslaji_jarjestys, 
		d7.jarjestys_koulutusaste2002, 
		d7.jarjestys_koulutusala2002, 
		d7.jarjestys_opintoala1995 AS jarjestys_koulutusala1995, 
		d7.jarjestys_opintoala2002 AS jarjestys_opintoala, 
		d7.jarjestys AS jarjestys_koulutusnimike, 
		d8.jarjestys_koulutusaste2002 AS jarjestys_suor_koulutusaste2002, 
		d8.jarjestys_koulutusala2002 AS jarjestys_suor_koulutusala2002, 
		d8.jarjestys_opintoala1995 AS jarjestys_suor_koulutusala1995, 
		d8.jarjestys_opintoala2002 AS jarjestys_suor_opintoala, 
		d8.jarjestys AS jarjestys_suor_koulutusnimike, 
		d9.jarjestys_koulutusaste2002 AS jarjestys_pohj_koulutusaste2002, 
		d9.jarjestys_koulutusala2002 AS jarjestys_pohj_koulutusala2002, 
		d9.jarjestys_opintoala1995 AS jarjestys_pohj_koulutusala1995, 
		d9.jarjestys_opintoala2002 AS jarjestys_pohj_opintoala, 
		d9.jarjestys AS jarjestys_pohj_koulutusnimike, 
		d3.jarjestys_maakunta, 
		d4.jarjestys_maakunta AS saavutettu_al_jarjestys_maakunta, 
		d12.jarjestys AS opiskelijan_olo_jarjestys, 
		d13.jarjestys_oppilaitos, 
		d13.jarjestys_oppilaitostyyppi, 
		d13.jarjestys_omistajatyyppi, 
		d14.jarjestys_oppilaitos AS saavutettu_jarjestys_oppilaitos, 
		d14.jarjestys_oppilaitostyyppi AS saavutettu_jarjestys_oppilaitostyyppi, 
		d14.jarjestys_omistajatyyppi AS saavutettu_jarjestys_omistajatyyppi, 
		d15.jarjestys AS rahoituslahde_jarjestys, 
		f.[1a_jarjestys], f.[1b_jarjestys], f.[1c_jarjestys], 
		f.[1d_jarjestys], f.[1e_jarjestys], f.[1f_jarjestys], f.[1g_jarjestys], f.[1h_jarjestys], 
		f.[2a_jarjestys], f.[2b_jarjestys], f.[2e_jarjestys], f.[2f_jarjestys], f.[2g_jarjestys], 
		f.[2h_jarjestys], f.[3a_jarjestys], f.[3b_jarjestys], f.[3e_jarjestys], f.[3f_jarjestys], 
		f.[3g_jarjestys], f.[3h_jarjestys], f.[4a_jarjestys], f.[4b_jarjestys], f.[4e_jarjestys], 
		f.[4f_jarjestys], f.[4g_jarjestys], f.[4h_jarjestys], f.[5a_jarjestys], f.[5b_jarjestys], 
		f.[5e_jarjestys], f.[5f_jarjestys], f.[5g_jarjestys], f.[5h_jarjestys], f.[6a_jarjestys], 
		f.[6b_jarjestys], f.[6e_jarjestys], f.[6f_jarjestys], f.[6g_jarjestys], f.[6h_jarjestys], 
		f.[7a_jarjestys], f.[7b_jarjestys], f.[7e_jarjestys], f.[7f_jarjestys], f.[7g_jarjestys], 
		f.[7h_jarjestys], f.[8a_jarjestys], f.[8b_jarjestys], f.[8e_jarjestys], f.[8f_jarjestys], 
		f.[8g_jarjestys], f.[8h_jarjestys], 
		d10.lahde_koodi, 
		d6.koulutuslaji2_koodi
		--isced
		,d7.iscle2011 as "Tavoitetutk. koul.aste 1"
		,d7.Koulutusaste_taso2 as "Tavoitetutk. koul.aste 2"
		,d7.iscfibroad2013 as "Tavoitetutk. koul.ala 1"
		,d7.iscfinarrow2013 as "Tavoitetutk. koul.ala 2"
		,d7.iscfi2013 as "Tavoitetutk. koul.ala 3"
		,d7.OKM_ohjauksen_ala as "Tavoitetutk. OKM ohj. ala kk"
		,d7.iscle2011_SV as "Målexamens utbildn.nivå 1"
		,d7.Koulutusaste_taso2_SV as "Målexamens utbildn.nivå 2"
		,d7.iscfibroad2013_SV as "Målexamens utbildn.omr. 1"
		,d7.iscfinarrow2013_SV as "Målexamens utbildn.omr. 2"
		,d7.iscfi2013_SV as "Målexamens utbildn.omr. 3"
		,d7.OKM_ohjauksen_ala_SV as "Målexamens UKM-styrn.omr. hs"
		,d7.iscle2011_EN as "Target level of ed. 1"
		,d7.Koulutusaste_taso2_EN as "Target level of ed. 2"
		,d7.iscfibroad2013_EN as "Target field of ed. 1"
		,d7.iscfinarrow2013_EN as "Target field of ed. 2"
		,d7.iscfi2013_EN as "Target field of ed. 3"
		,d7.OKM_ohjauksen_ala_EN as "Target field of ed. HE ste."
		,d7.jarjestys_iscle2011 as jarj_isced_koulast1
		,d7.jarjestys_Koulutusaste_taso2 as jarj_isced_koulast2
		,d7.jarjestys_iscfibroad2013 as jarj_isced_koulala1
		,d7.jarjestys_iscfinarrow2013 as jarj_isced_koulala2
		,d7.jarjestys_iscfi2013 as jarj_isced_koulala3
		,d7.jarjestys_OKM_ohjauksen_ala as jarj_isced_okmohjaus1
		,d7.iscle2011_koodi as "Koodit Tavoitetutk. koul.aste 1"
		,d7.Koulutusaste_taso2_koodi as "Koodit Tavoitetutk. koul.aste 2"
		,d7.iscfibroad2013_koodi as "Koodit Tavoitetutk. koul.ala 1"
		,d7.iscfinarrow2013_koodi as "Koodit Tavoitetutk. koul.ala 2"
		,d7.iscfi2013_koodi as "Koodit Tavoitetutk. koul.ala 3"
		,d7.OKM_ohjauksen_ala_koodi as "Koodit Tavoitetutk. OKM ohjauksen ala kk"
		,d8.iscle2011 as "Suor. tutk. koul.aste 1"
		,d8.Koulutusaste_taso2 as "Suor. tutk. koul.aste 2"
		,d8.iscfibroad2013 as "Suor. tutk. koul.ala 1"
		,d8.iscfinarrow2013 as "Suor. tutk. koul.ala 2"
		,d8.iscfi2013 as "Suor. tutk. koul.ala 3"
		,d8.OKM_ohjauksen_ala as "Suor. tutk. OKM ohj. ala kk"
		,d8.iscle2011_SV as "Examens utbildn.nivå 1"
		,d8.Koulutusaste_taso2_SV as "Examens utbildn.nivå 2"
		,d8.iscfibroad2013_SV as "Examens utbildn.omr. 1"
		,d8.iscfinarrow2013_SV as "Examens utbildn.omr. 2"
		,d8.iscfi2013_SV as "Examens utbildn.omr. 3"
		,d8.OKM_ohjauksen_ala_SV as "Examens UKM-styrn.omr. hs"
		,d8.iscle2011_EN as "Degree''s level of ed. 1"
		,d8.Koulutusaste_taso2_EN as "Degree''s level of ed. 2"
		,d8.iscfibroad2013_EN as "Degree''s field of ed. 1"
		,d8.iscfinarrow2013_EN as "Degree''s field of ed. 2"
		,d8.iscfi2013_EN as "Degree''s field of ed. 3"
		,d8.OKM_ohjauksen_ala_EN as "Degree''s field of ed. HE ste."
		,d8.jarjestys_iscle2011 as jarj_isced2_koulast1
		,d8.jarjestys_Koulutusaste_taso2 as jarj_isced2_koulast2
		,d8.jarjestys_iscfibroad2013 as jarj_isced2_koulala1
		,d8.jarjestys_iscfinarrow2013 as jarj_isced2_koulala2
		,d8.jarjestys_iscfi2013 as jarj_isced2_koulala3
		,d8.jarjestys_OKM_ohjauksen_ala as jarj_isced2_okmohjaus1
		,d8.iscle2011_koodi as "Koodit Suor. tutk. koul.aste 1"
		,d8.Koulutusaste_taso2_koodi as "Koodit Suor. tutk. koul.aste 2"
		,d8.iscfibroad2013_koodi as "Koodit Suor. tutk. koul.ala 1"
		,d8.iscfinarrow2013_koodi as "Koodit Suor. tutk. koul.ala 2"
		,d8.iscfi2013_koodi as "Koodit Suor. tutk. koul.ala 3"
		,d8.OKM_ohjauksen_ala_koodi as "Koodit Suor. tutk. OKM ohjauksen ala kk"
		,d9.iscle2011 as "Pohjakoul. koul.aste 1"
		,d9.Koulutusaste_taso2 as "Pohjakoul. koul.aste 2"
		,d9.iscfibroad2013 as "Pohjakoul. koul.ala 1"
		,d9.iscfinarrow2013 as "Pohjakoul. koul.ala 2"
		,d9.iscfi2013 as "Pohjakoul. koul.ala 3"
		,d9.OKM_ohjauksen_ala as "Pohjakoul. OKM ohj. ala kk"
		,d9.iscle2011_SV as "Grundutb. utbildn.nivå 1"
		,d9.Koulutusaste_taso2_SV as "Grundutb. utbildn.nivå 2"
		,d9.iscfibroad2013_SV as "Grundutb. utbildn.omr. 1"
		,d9.iscfinarrow2013_SV as "Grundutb. utbildn.omr. 2"
		,d9.iscfi2013_SV as "Grundutb. utbildn.omr. 3"
		,d9.OKM_ohjauksen_ala_SV as "Grundutb. UKM-styrn.omr. hs"
		,d9.iscle2011_EN as "Previous deg. level of ed. 1"
		,d9.Koulutusaste_taso2_EN as "Previous deg. level of ed. 2"
		,d9.iscfibroad2013_EN as "Previous deg. field of ed. 1"
		,d9.iscfinarrow2013_EN as "Previous deg. field of ed. 2"
		,d9.iscfi2013_EN as "Previous deg. field of ed. 3"
		,d9.OKM_ohjauksen_ala_EN as "Previous deg. field of ed. HE ste."
		,d9.jarjestys_iscle2011 as jarj_isced3_koulast1
		,d9.jarjestys_Koulutusaste_taso2 as jarj_isced3_koulast2
		,d9.jarjestys_iscfibroad2013 as jarj_isced3_koulala1
		,d9.jarjestys_iscfinarrow2013 as jarj_isced3_koulala2
		,d9.jarjestys_iscfi2013 as jarj_isced3_koulala3
		,d9.jarjestys_OKM_ohjauksen_ala as jarj_isced3_okmohjaus1
		,d9.iscle2011_koodi as "Koodit Pohjakoul. koul.aste 1"
		,d9.Koulutusaste_taso2_koodi as "Koodit Pohjakoul. koul.aste 2"
		,d9.iscfibroad2013_koodi as "Koodit Pohjakoul. koul.ala 1"
		,d9.iscfinarrow2013_koodi as "Koodit Pohjakoul. koul.ala 2"
		,d9.iscfi2013_koodi as "Koodit Pohjakoul. koul.ala 3"
		,d9.OKM_ohjauksen_ala_koodi as "Koodit Pohjakoul. OKM ohjauksen ala kk"
FROM     dbo.f_aloittaneiden_lapaisy f INNER JOIN
			dbo.d_kausi AS d1 ON d1.kausi_id = f.aloituskausikoodi INNER JOIN
			dbo.d_aidinkieli_versio1 AS d2 ON d2.id = f.aikielir1_id INNER JOIN
			dbo.d_sukupuoli AS d16 ON d16.id = f.sp_id INNER JOIN
			dbo.d_tarkastelujakso AS d17 ON d17.id = f.tarkastelujakso_id INNER JOIN
			dbo.d_alueluokitus AS d3 ON d3.id = f.alueluokitus_id INNER JOIN
			dbo.d_alueluokitus AS d4 ON d4.id = f.saavutettu_alueluokitus_id INNER JOIN
			dbo.d_ika AS d5 ON d5.id = f.ika_id INNER JOIN
			dbo.d_koulutuslaji2 AS d6 ON d6.id = f.koulutuslaji2_id INNER JOIN
			dbo.d_koulutusluokitus AS d7 ON d7.id = f.koulk_id INNER JOIN
			dbo.d_koulutusluokitus AS d8 ON d8.id = f.saavutettu_koulk_id INNER JOIN
			dbo.d_koulutusluokitus AS d9 ON d9.id = f.pohjkoulk_id INNER JOIN
			dbo.d_lahde AS d10 ON d10.id = f.lahde_id INNER JOIN
			dbo.d_opiskelijan_olo AS d12 ON d12.id = f.ololk_id INNER JOIN
			dbo.d_oppilaitoksen_taustatiedot AS d13 ON d13.id = f.oppilaitoksen_taustatiedot_id INNER JOIN
			dbo.d_oppilaitoksen_taustatiedot AS d14 ON d14.id = f.saavutettu_oppilaitoksen_taustatiedot_id INNER JOIN
			dbo.d_rahoituslahde AS d15 ON d15.id = f.rahlahde_id
WHERE        aineistokoodi = ''K3.10'' AND d10.lahde_koodi = 41 AND d17.tarkastelujakso != ''0,5 vuotta'' AND d1.lukuvuosi != ''1999/2000'' AND d1.lukuvuosi != ''2000/2001'' AND d1.lukuvuosi != ''2001/2002'' 
				AND d6.koulutuslaji2_koodi != ''52'' AND [1a Aloittaneiden opintojen kulku koulutuslajin mukaan prioriteettina mikä tahansa tutkinto] != ''Virhetilanne''






















' 
GO
/****** Object:  View [dbo].[v_f_aloittaneiden_lapaisy_K3_10_yhteiset]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_aloittaneiden_lapaisy_K3_10_yhteiset]'))
EXEC dbo.sp_executesql @statement = N'















CREATE VIEW [dbo].[v_f_aloittaneiden_lapaisy_K3_10_yhteiset]
AS
SELECT f.lkm_int AS lkm_int2, 
		d1.lukuvuosi AS Aloituslukuvuosi, 
		d1.vuosiselite AS Aloitusvuosi, 
		d1.lukukausiselite AS Aloituslukukausi, 
		d17.tarkastelujakso AS Tarkastelujakso, 
		d16.sukupuoli AS Sukupuoli, 
		d2.aidinkieli_versio1 AS Äidinkieli, 
		d5.ika AS Ikä, 
		d5.ika5v AS Ikäryhmä, 
		d6.koulutuslaji2 AS [Tavoitetutk. koulutuslaji], 
		d6.koulutuslaji2 AS [Tavoitetutk. koulutustyyppi], 
		--d6.koodinselite AS [Tavoitetutk. koulutusaste], -- Tätä käytetään yo-raportilla
		d7.koulutusaste2002 AS [Tavoitetutk. koulutusaste], 
		Case when d7.koulutusaste2002_koodi=''63'' 
		Or (d7.koulutusaste2002_koodi=''72'' 
			and  d7.koulutus_koodi in (''772101'', ''772201'')) Or d7.koulutusaste2002_koodi=''62'' then ''Aloitus I syklin tutkinnossa'' 
			when d7.koulutusaste2002_koodi=''71'' Or d7.koulutusaste2002_koodi=''72'' then ''Aloitus II syklin tutkinnossa''  
			else ''Tuntematon'' end AS [Tavoitetutk. sykli], 
		d7.koulutusala2002 AS [Tavoitetutk. koulutusala], 
		d7.koulutusala2002 AS [Tavoitetutk. koul.ala (02 luokitus)], 
		d7.opintoala1995 AS [Tavoitetutk. koul.ala (95 luokitus)], 
		d7.opintoala2002 AS [Tavoitetutk. opintoala], 
		d7.opintoala2002 AS [Tavoitetutk. opintoala (02 luokitus)], 
		d7.koulutus AS [Tavoitetutk. koulutusnimike], 
		d8.koulutusaste2002 AS [Suor. tutkinnon koulutusaste], 
		d8.koulutusala2002 AS [Suor. tutkinnon koulutusala], 
		d8.koulutusala2002 AS [Suor. tutkinnon koul.ala (02 luokitus)], 
		d8.opintoala1995 AS [Suor. tutkinnon koul.ala (95 luokitus)], 
		d8.opintoala2002 AS [Suor. tutkinnon opintoala], 
		d8.opintoala2002 AS [Suor. tutkinnon opintoala (02 luokitus)], 
		d8.koulutus AS [Suor. tutkinnon koulutusnimike], 
		d9.koulutusaste2002 AS [Pohjakoul. koulutusaste], 
		d9.koulutusala2002 AS [Pohjakoul. koulutusala], 
		d9.koulutusala2002 AS [Pohjakoul. koul.ala (02 luokitus)], 
		d9.opintoala1995 AS [Pohjakoul. koul.ala (95 luokitus)], 
		d9.opintoala2002 AS [Pohjakoul. opintoala], 
		d9.opintoala2002 AS [Pohjakoul. opintoala (02 luokitus)], 
		d9.koulutus AS [Pohjakoul. koulutusnimike], 
		d3.maakunta AS [Tavoitetutk. maakunta], 
		d4.maakunta AS [Suor. tutkinnon maakunta], 
		d12.opiskelijan_olo AS Kirjoillaolo, 
		d13.oppilaitos AS [Tavoitetutk. oppilaitos], 
		d13.oppilaitos AS [Tavoitetutk. yliopisto], 
		d13.oppilaitos AS [Tavoitetutk. amk], 
		d13.oppilaitostyyppi AS [Tavoitetutk. oppil.tyyppi], 
		d13.oppilaitoksen_omistajatyyppi AS [Tavoitetutk. oppil. omistajatyyppi],
		d13.koulutuksen_jarjestaja AS [Tavoitetutk. koul. järjestäjä],
		d14.oppilaitos AS [Suor. tutkinnon oppilaitos], 
		d14.oppilaitos AS [Suor. tutkinnon yliopisto], 
		d14.oppilaitos AS [Suor. tutkinnon amk], 
		d14.oppilaitostyyppi AS [Suor. tutkinnon oppil.tyyppi], 
		d14.oppilaitoksen_omistajatyyppi AS [Suor. tutkinnon oppil. omistajatyyppi], 
		f.[1a Aloittaneiden opintojen kulku koulutuslajin mukaan prioriteettina mikä tahansa tutkinto] AS [Opintojen kulku], 
		f.[1b Aloittaneiden opintojen kulku koulutuslajin mukaan prioriteettina tutkinto ja opiskelu alkuperäisessä tutkintolajissa] AS [Opintojen kulku prioriteetti 2], 
		f.[1c Aloittaneista tutkinnon suorittaneet koulutuslajin mukaan] AS [Suoritettu tutkinto], 
		f.[1d Aloittaneista ilman tutkintoa opiskelua jatkavat koulutuslajin mukaan] AS [Opiskelua jatkavat tutk.lajin mukaan], 
		f.[1e Aloittaneista alkuperäisen koulutuslajin tutkinnon suorittaneet koulutuslajin mukaan] AS [Tutkinto tavoitet. tutkintolajissa], 
		f.[1f Aloittaneista muun kuin alkuperäisen tutkintolajin tutkinnon suorittaneet koulutuslajin mukaan] AS [Tutkinto muussa tutkintolajissa], 
		f.[1g Aloittaneista alkuperäisen tutkintolajin opiskelua jatkavat koulutuslajin mukaan] AS [Opiskelee tavoitet. tutkintolajissa], 
		f.[1h Aloittaneista muun tutkintolajin opiskelua jatkavat koulutuslajin mukaan] AS [Opiskelee muussa tutkintolajissa], 
		f.[2a Aloittaneiden opintojen kulku koulutusalan (2002) mukaan prioriteettina mikä tahansa tutkinto] AS [Opintojen kulku koulutusaloittain], 
		f.[2b Aloittaneiden opintojen kulku koulutusalan (2002) mukaan prioriteettina tutkinto ja opiskelu alkuperäisellä] AS [Opintojen kulku koulutusaloittain prioriteetti 2], 
		f.[2e Aloittaneista alkuperäisen koulutusalan (2002) tutkinnon suorittaneet koulutusalan mukaan] AS [Tutkinto tavoitet. koulutusalalla], 
		f.[2e Aloittaneista alkuperäisen koulutusalan (2002) tutkinnon suorittaneet koulutusalan mukaan] AS [Tutkinto tavoitet. koul.alalla (02 luokitus)], 
		f.[2f Aloittaneista muun kuin alkuperäisen tutkintolajin tutkinnon suorittaneet koulutuslajin mukaan] AS [Tutkinto muulla koulutusalalla], 
		f.[2g Aloittaneista alkuperäisellä koulutusalalla opiskelua jatkavat koulutusalan mukaan] AS [Opiskelee tavoitet. koulutusalalla], 
		f.[2h Aloittaneista muulla koulutusalalla opiskelua jatkavat koulutusalan mukaan] AS [Opiskelee muulla koulutusalalla], 
		f.[3a Aloittaneiden opintojen kulku opintoalan (2002) mukaan prioriteettina mikä tahansa tutkinto] AS [Opintojen kulku opintoaloittain], 
		f.[3b Aloittaneiden opintojen kulku opintoalan (2002) mukaan prioriteettina tutkinto ja opiskelu alkuperäisellä] AS [Opintojen kulku opintoaloittain prioriteetti 2],
		f.[3e Aloittaneista alkuperäisen opintoalan (2002) tutkinnon suorittaneet opintoalan mukaan] AS [Tutkinto tavoitet. opintoalalla], 
		f.[3e Aloittaneista alkuperäisen opintoalan (2002) tutkinnon suorittaneet opintoalan mukaan] AS [Tutkinto tavoitet. op.alalla (02 luokitus)], 
		f.[3f Aloittaneista muun opintoalan (2002) tutkinnon suorittaneet opintoalan mukaan] AS [Tutkinto muulla opintoalalla], 
		f.[3g Aloittaneista alkuperäisellä opintoalalla (2002) opiskelua jatkavat opintoalan mukaan] AS [Opiskelee tavoitet. opintoalalla], 
		f.[3h Aloittaneista muulla opintoalalla (2002) opiskelua jatkavat opintoalan mukaan] AS [Opiskelee muulla opintoalalla], 
		f.[4a Aloittaneiden opintojen kulku koulutuksen järjestäjän mukaan, toinen aste prioriteettina tutkinto missä tahansa] AS [Opintojen kulku koul. järjestäjittäin], 
		f.[4b Aloittaneiden opintojen kulku koulutuksen järjestäjän mukaan, toinen aste prioriteettina tutkinto ja opiskelu alkuperäisellä] AS [Opintojen kulku koul. järjestäjittäin prioriteetti 2], 
		f.[4e Aloittaneista alkuperäisen koulutuksen järjestäjän tutkinnon suorittaneet järjestäjän mukaan] AS [Tutkinto tavoitet. koul. järjestäjällä], 
		f.[4f Aloittaneista muun koulutuksen järjestäjän tutkinnon suorittaneet järjestäjän mukaan] AS [Tutkinto muulla koul. järjestäjällä], 
		f.[4g Aloittaneista alkuperäisellä järjestäjällä opiskelua jatkavat järjestäjän mukaan] AS [Opiskelee tavoitet. koul. järjestäjällä], 
		f.[4h Aloittaneista muulla järjestäjällä opiskelua jatkavat järjestäjän mukaan] AS [Opiskelee muulla koul. järjestäjällä], 
		f.[5a Aloittaneiden opintojen kulku oppilaitoksen mukaan prioriteettina tutkinto missä tahansa] AS [Opintojen kulku oppilaitoksittain], 
		f.[5b Aloittaneiden opintojen kulku oppilaitoksen mukaan prioriteettina tutkinto ja opiskelu alkuperäisessä] AS [Opintojen kulku oppilaitoksittain prioriteetti 2], 
		f.[5e Aloittaneista alkuperäisessä oppilaitoksessa tutkinnon suorittaneet oppilaitoksen mukaan] AS [Tutkinto tavoitet. oppilaitoksessa], 
		f.[5f Aloittaneista muussa oppilaitoksessa tutkinnon suorittaneet oppilaitoksen mukaan] AS [Tutkinto muussa oppilaitoksessa], 
		f.[5g Aloittaneista alkuperäisessä oppilaitoksessa opiskelua jatkavat oppilaitoksen mukaan] AS [Opiskelee tavoitet. oppilaitoksessa], 
		f.[5h Aloittaneista muussa oppilaitoksessa opiskelua jatkavat oppilaitoksen mukaan] AS [Opiskelee muussa oppilaitoksessa], 
		f.[6a Aloittaneiden opintojen kulku maakunnan mukaan prioriteettina tutkinto missä tahansa] AS [Opintojen kulku maakunnittain], 
		f.[6b Aloittaneiden opintojen kulku maakunnan mukaan prioriteettina tutkinto ja opiskelu alkuperäisessä] AS [Opintojen kulku maakunnittain prioriteetti 2], 
		f.[6e Aloittaneista alkuperäisessä maakunnassa tutkinnon suorittaneet maakunnan mukaan] AS [Tutkinto tavoitet. maakunnassa], 
		f.[6f Aloittaneista muussa maakunnassa tutkinnon suorittaneet maakunnan mukaan] AS [Tutkinto muussa maakunnassa], 
		f.[6g Aloittaneista alkuperäisessä maakunnassa opiskelua jatkavat maakunnan mukaan] AS [Opiskelee tavoitet. maakunnassa], 
		f.[6h Aloittaneista muussa maakunnassa opiskelua jatkavat maakunnan mukaan] AS [Opiskelee muussa maakunnassa], 
		f.[7a Aloittaneiden opintojen kulku koulutussektorin mukaan prioriteettina tutkinto missä tahansa] AS [Opintojen kulku koul.sektoreittan], 
		f.[7b Aloittaneiden opintojen kulku koulutussektorin mukaan prioriteettina tutkinto ja opiskelu alkuperäisellä] AS [Opintojen kulku koul.sektoreittan prioriteetti 2], 
		f.[7e Aloittaneista alkuperäisen koulutussektorin tutkinnon suorittaneet koulutussektorin mukaan] AS [Tutkinto tavoitet. koulutussektorilla], 
		f.[7f Aloittaneista muun koulutussektorin tutkinnon suorittaneet koulutussektorin mukaan] AS [Tutkinto muulla koulutussektorilla], 
		f.[7g Aloittaneista alkuperäisellä koulutussektorilla opiskelua jatkavat koulutussektorin mukaan] AS [Opiskelee tavoitet. koulutussektorilla], 
		f.[7h Aloittaneista muulla koulutussektorilla opiskelua jatkavat koulutussektorin mukaan] AS [Opiskelee muulla koulutussektorilla], 
		f.[8a Aloittaneiden opintojen kulku opintoalan (1995) mukaan prioriteettina mikä tahansa tutkinto] AS [Opintojen kulku koul.aloittain (95)], 
		f.[8b Aloittaneiden opintojen kulku opintoalan (1995) mukaan prioriteettina tutkinto ja opiskelu alkuperäisellä] AS [Opintojen kulku koul.aloittain (95) prioriteetti 2], 
		f.[8e Aloittaneista alkuperäisen opintoalan (1995) tutkinnon suorittaneet opintoalan mukaan] AS [Tutkinto tavoitet. koulutusalalla (95)], 
		f.[8f Aloittaneista muun opintoalan (1995) tutkinnon suorittaneet opintoalan mukaan] AS [Tutkinto muulla koulutusalalla (95)], 
		f.[8g Aloittaneista alkuperäisellä opintoalalla (1995) opiskelua jatkavat opintoalan mukaan] AS [Opiskelee tavoitet. koulutusalalla (95)], 
		f.[8h Aloittaneista muulla opintoalalla (1995) opiskelua jatkavat opintoalan mukaan] AS [Opiskelee muulla koulutusalalla (95)], 
		f.aloitus_saavutus AS [Aloitus saavutus], 
		f.tarkastelujakso_tulevaisuus AS [Tarkastelujakson tulevaisuus], 
		f.tarkastelujakso_edustavuus AS [Tarkastelujakson edustavuus], 
		d10.lahde AS Lähde, 
		--ruotsi
		d1.lukuvuosi AS Begynnelseläsår, 
		d1.vuosiselite_SV AS Begynnelseår, 
		d1.lukukausiselite_SV AS Begynnelsetermin, 
		d17.tarkastelujakso_SV AS Granskningsperiod, 
		d16.sukupuoli_SV AS Kön, 
		d2.aidinkieli_versio1_SV AS Modersmål, 
		d5.ika_SV AS Ålder, 
		d5.ika5v_SV AS Åldersgrupp, 
		d6.koulutuslaji2_SV AS [Målexamens examensslag], 
		d6.koulutuslaji2_SV AS [Målexamens typ av utbildn.], 
		d7.koulutusaste2002_SV AS [Målexamens utbildn.nivå 2002], 
		Case when d7.koulutusaste2002_koodi=''63'' 
		Or (d7.koulutusaste2002_koodi=''72'' 
			and  d7.koulutus_koodi in (''772101'', ''772201'')) Or d7.koulutusaste2002_koodi=''62'' then ''Påbörjande i I-skedets examen'' 
			when d7.koulutusaste2002_koodi=''71'' Or d7.koulutusaste2002_koodi=''72'' then ''Påbörjande i II-skedets examen''  
			else ''Tuntematon'' end AS [Startskede], 
		d7.koulutusala2002_SV AS [Målexamens utbildn.område 02], 
		d7.opintoala1995_SV AS [Målexamens utbildn.område 95], 
		d7.opintoala2002_SV AS [Målexamens studieområde 02], 
		d7.koulutus_SV AS [Målexamens utbildn.benämning], 
		d8.koulutusaste2002_SV AS [Examens utbildn.nivå 2002], 
		d8.koulutusala2002_SV AS [Examens utbildn.område 2002], 
		d8.opintoala1995_SV AS [Examens utbildn.område 1995], 
		d8.opintoala2002_SV AS [Examens studieområde 2002], 
		d8.koulutus_SV AS [Examens utbildn.benämning], 
		d9.koulutusaste2002_SV AS [Grundutb. utbildn.nivå 2002], 
		d9.koulutusala2002_SV AS [Grundutb. utbildn.område 2002], 
		d9.opintoala1995_SV AS [Grundutb. utbildn.område 1995], 
		d9.opintoala2002_SV AS [Grundutb. studieområde 2002], 
		d9.koulutus_SV AS [Grundutb. utbildn.benämning], 
		d3.maakunta_SV AS [Målexamens landskap], 
		d4.maakunta_SV AS [Examens landskap], 
		d12.opiskelijan_olo_SV AS Inskrivning, 
		d13.oppilaitos_SV AS [Målexamens läroanstalt], 
		d13.oppilaitos_SV AS [Målexamens universitet], 
		d13.oppilaitos_SV AS [Målexamens yrkehögskola], 
		d13.koulutuksen_jarjestaja_SV AS [Målexamens utbildn.ordnare],
		d14.oppilaitos_SV AS [Examens läroanstalt], 
		d14.oppilaitos_SV AS [Examens universitet], 
		d14.oppilaitos_SV AS [Examens yrkehögskola], 
		[Studieförlopp] = 
			case f.[1a Aloittaneiden opintojen kulku koulutuslajin mukaan prioriteettina mikä tahansa tutkinto]
				when ''Tutkinto alkuperäisessä tutkintolajissa'' then ''Examen i det ursprungliga examensslaget''
				when ''Tutkinto muussa tutkintolajissa'' then ''Examen i annat examensslag''
				when ''Tutkinto muussa tutkintolajissa, kandidaatin tutkinto'' then ''Examen i annat examensslag, lägre högskoleexamen''
				when ''Opiskelee alkuperäisessä tutkintolajissa'' then ''Studerar i det ursprungliga examensslaget''
				when ''Opiskelee muussa tutkintolajissa'' then ''Studerar i annat examensslag''
				when ''Ei tutkintoa, ei opiskele, työllinen'' then ''Ingen examen, inte studerar, sysselsatt''
				when ''Ei tutkintoa, ei opiskele, ei työllinen'' then ''Ingen examen, inte studerar, arbetslös''
				else  ''Information saknas''
			end , 
		[Studieförlopp prior. 2] =
			case f.[1b Aloittaneiden opintojen kulku koulutuslajin mukaan prioriteettina tutkinto ja opiskelu alkuperäisessä tutkintolajissa]
				when ''Tutkinto alkuperäisessä tutkintolajissa'' then ''Examen i det ursprungliga examensslaget''
				when ''Tutkinto muussa tutkintolajissa'' then ''Examen i annat examensslag''
				when ''Tutkinto muussa tutkintolajissa, kandidaatin tutkinto'' then ''Examen i annat examensslag, lägre högskoleexamen''
				when ''Opiskelee alkuperäisessä tutkintolajissa'' then ''Studerar i det ursprungliga examensslaget''
				when ''Opiskelee muussa tutkintolajissa'' then ''Studerar i annat examensslag''
				when ''Ei tutkintoa, ei opiskele, työllinen'' then ''Ingen examen, inte studerar, sysselsatt''
				when ''Ei tutkintoa, ei opiskele, ei työllinen'' then ''Ingen examen, inte studerar, arbetslös''
				else ''Information saknas''
			end			, 
		[Avlagt examen] =
			case f.[1c Aloittaneista tutkinnon suorittaneet koulutuslajin mukaan]
				when ''Tutkinto lukiokoulutuksesta'' then ''Studentexamen''
				when ''Ammatillinen perustutkinto'' then ''Grundläggande yrkesexamen''
				when ''Ammatillinen lisäkoulutus ammattitutkinto tai erikoisammattitutkinto'' then ''Yrkesinriktad tilläggsutbildning, yrkesexamen eller specialyrkesexamen''
				when ''Muu korkein ja viimeisimmäksi suoritettu tutkinto, toinen aste'' then ''Övrig högsta och senast avlagd examen, andra stadiet''
				when ''Ammattikorkeakoulututkinto'' then ''Yrkeshögskoleexamen''
				when ''Alempi korkeakoulututkinto'' then ''Lägre högskoleexamen''
				when ''Ylempi ammattikorkeakoulututkinto'' then ''Högre yrkeshögskoleexamen''
				when ''Ylempi korkeakoulututkinto'' then ''Högre högskoleexamen''
				when ''Tutkijakoulutusasteen tutkinto'' then ''Examen på forskarutbildningsnivå''
				when ''Muu korkein ja viimeisimmäksi suoritettu tutkinto, korkeakoulututkinto'' then ''Övrig högsta och senast avlagd examen, högskoleexamen''
				when ''Ei tutkintoa'' then ''Ingen examen''
				when ''Virhetilanne'' then ''Information saknas''
			end, 
		[Examen i målex. examensslag] = 
			case f.[1e Aloittaneista alkuperäisen koulutuslajin tutkinnon suorittaneet koulutuslajin mukaan]
				when ''Kyllä'' then ''Ja''
				when ''Ei'' then ''Inte''
				when ''Virhetilanne'' then ''Information saknas''
			end
		, 
		[Examen i annat examensslag] = 
			case [1f Aloittaneista muun kuin alkuperäisen tutkintolajin tutkinnon suorittaneet koulutuslajin mukaan]
				when ''Kyllä'' then ''Ja''
				when ''Ei'' then ''Inte''
				when ''Virhetilanne'' then ''Information saknas''
			end	
			, 
		[Examen i målex. utbildn.område 02] =
			case [2e Aloittaneista alkuperäisen koulutusalan (2002) tutkinnon suorittaneet koulutusalan mukaan]
				when ''Kyllä'' then ''Ja''
				when ''Ei'' then ''Inte''
				when ''Virhetilanne'' then ''Information saknas''
			end	
		, 
		[Examen i målex. studieområde 02] = 
			case [3e Aloittaneista alkuperäisen opintoalan (2002) tutkinnon suorittaneet opintoalan mukaan]
				when ''Kyllä'' then ''Ja''
				when ''Ei'' then ''Inte''
				when ''Virhetilanne'' then ''Information saknas''
			end	
		, 
		[Examen i målex. läroanstalt] = 
			case [5e Aloittaneista alkuperäisessä oppilaitoksessa tutkinnon suorittaneet oppilaitoksen mukaan] 
				when ''Kyllä'' then ''Ja''
				when ''Ei'' then ''Inte''
				when ''Virhetilanne'' then ''Information saknas''
			end	
		, 
		[Examen i målex. utbildn.område 95] = 
			case [8e Aloittaneista alkuperäisen opintoalan (1995) tutkinnon suorittaneet opintoalan mukaan]
				when ''Kyllä'' then ''Ja''
				when ''Ei'' then ''Inte''
				when ''Virhetilanne'' then ''Information saknas''
			end	
		, 
		--englanti
		d1.lukuvuosi AS [First academic year], 
		d1.vuosiselite_EN AS [First year of studies], 
		d1.lukukausiselite_EN AS [First term], 
		d17.tarkastelujakso_EN AS [Reference period], 
		d16.sukupuoli_EN AS Gender, 
		d2.aidinkieli_versio1_EN AS [Mother tongue], 
		d5.ika_EN AS Age, 
		d5.ika5v_EN AS [Age group], 
		d6.koulutuslaji2_EN AS [Target degree''s form of deg.], 
		d6.koulutuslaji2_EN AS [Target degree''s type of ed.], 
		d7.koulutusaste2002_EN AS [Target deg. level of ed. 02], 
		Case when d7.koulutusaste2002_koodi=''63'' 
		Or (d7.koulutusaste2002_koodi=''72'' 
			and  d7.koulutus_koodi in (''772101'', ''772201'')) Or d7.koulutusaste2002_koodi=''62'' then ''Beginning of studies in cycle I degree'' 
			when d7.koulutusaste2002_koodi=''71'' Or d7.koulutusaste2002_koodi=''72'' then ''Beginning of studies in cycle II degree''  
			else ''Tuntematon'' end AS [Beginning cycle of ed.], 
		d7.koulutusala2002_EN AS [Target deg. field of ed. 02], 
		d7.opintoala1995_EN AS [Target deg. field of ed. 95], 
		d7.opintoala2002_EN AS [Target deg. subfield of ed. 02], 
		d7.koulutus_EN AS [Target deg. name of ed.], 
		d8.koulutusaste2002_EN AS [Degree''s level of ed. 02], 
		d8.koulutusala2002_EN AS [Degree''s field of ed. 02], 
		d8.opintoala1995_EN AS [Degree''s field of ed. 95], 
		d8.opintoala2002_EN AS [Degree''s subfield of ed. 02], 
		d8.koulutus_EN AS [Degree''s name of ed.], 
		d9.koulutusaste2002_EN AS [Previous deg. level of ed. 02], 
		d9.koulutusala2002_EN AS [Previous deg. field of ed. 02], 
		d9.opintoala1995_EN AS [Previous deg. field of ed. 95], 
		d9.opintoala2002_EN AS [Previous deg. subfield of ed. 02], 
		d9.koulutus_EN AS [Previous deg. name of ed.], 
		d3.maakunta_EN AS [Target degree''s region], 
		d4.maakunta_EN AS [Degree''s region], 
		d12.opiskelijan_olo_EN AS [Enrollment status], 
		d13.oppilaitos_EN AS [Target deg. ed. institution], 
		d13.oppilaitos_EN AS [Target deg. university], 
		d13.oppilaitos_EN AS [Target deg. polytechnic], 
		d13.koulutuksen_jarjestaja_EN AS [Target deg. ed. provider],
		d14.oppilaitos_EN AS [Degree''s ed. institution], 
		d14.oppilaitos_EN AS [Degree''s university], 
		d14.oppilaitos_EN AS [Degree''s polytechnic], 
		[Study progress] =
			case f.[1a Aloittaneiden opintojen kulku koulutuslajin mukaan prioriteettina mikä tahansa tutkinto]
				when ''Tutkinto alkuperäisessä tutkintolajissa'' then ''Qualification in the original form of degree''
				when ''Tutkinto muussa tutkintolajissa'' then ''Qualification in another form of degree''
				when ''Tutkinto muussa tutkintolajissa, kandidaatin tutkinto'' then ''Qualification in another form of degree, Bachelor''''s degree''
				when ''Opiskelee alkuperäisessä tutkintolajissa'' then ''Studying in the original form of degree''
				when ''Opiskelee muussa tutkintolajissa'' then ''Studying in another form of degree''
				when ''Ei tutkintoa, ei opiskele, työllinen'' then ''No qualification, not studying, employed''
				when ''Ei tutkintoa, ei opiskele, ei työllinen'' then ''No qualification, not studying, unemployed''
				else  ''Missing data''
			end ,
		[Study progress prior. 2] = 
			case f.[1b Aloittaneiden opintojen kulku koulutuslajin mukaan prioriteettina tutkinto ja opiskelu alkuperäisessä tutkintolajissa]
				when ''Tutkinto alkuperäisessä tutkintolajissa'' then ''Qualification in the original form of degree''
				when ''Tutkinto muussa tutkintolajissa'' then ''Qualification in another form of degree''
				when ''Tutkinto muussa tutkintolajissa, kandidaatin tutkinto'' then ''Qualification in another form of degree, Bachelor''''s degree''
				when ''Opiskelee alkuperäisessä tutkintolajissa'' then ''Studying in the original form of degree''
				when ''Opiskelee muussa tutkintolajissa'' then ''Studying in another form of degree''
				when ''Ei tutkintoa, ei opiskele, työllinen'' then ''No qualification, not studying, employed''
				when ''Ei tutkintoa, ei opiskele, ei työllinen'' then ''No qualification, not studying, unemployed''
				else  ''Missing data''
			end , 
		[Completed degree] =
			case f.[1c Aloittaneista tutkinnon suorittaneet koulutuslajin mukaan]
				when ''Tutkinto lukiokoulutuksesta'' then ''Matriculation examination''
				when ''Ammatillinen perustutkinto'' then ''Vocational upper secondary qualification''
				when ''Ammatillinen lisäkoulutus ammattitutkinto tai erikoisammattitutkinto'' then ''Further vocational qualification or specialist vocational qualification''
				when ''Muu korkein ja viimeisimmäksi suoritettu tutkinto, toinen aste'' then ''Other highest and most recent degree, upper secondary education''
				when ''Ammattikorkeakoulututkinto'' then ''UAS degree''
				when ''Alempi korkeakoulututkinto'' then ''Bachelor''''s degree''
				when ''Ylempi ammattikorkeakoulututkinto'' then ''UAS Master''''s degree''
				when ''Ylempi korkeakoulututkinto'' then ''Master''''s degree''
				when ''Tutkijakoulutusasteen tutkinto'' then ''Research degree''
				when ''Muu korkein ja viimeisimmäksi suoritettu tutkinto, korkeakoulututkinto'' then ''Other highest and most recent degree, higher education''
				when ''Ei tutkintoa'' then ''No degree''
				when ''Virhetilanne'' then ''Missing data''
			end, 
		[Degree in target form of deg.] =
			case f.[1e Aloittaneista alkuperäisen koulutuslajin tutkinnon suorittaneet koulutuslajin mukaan]
				when ''Kyllä'' then ''Yes''
				when ''Ei'' then ''No''
				when ''Virhetilanne'' then ''Missing data''
			end, 
		[Degree in another form of deg.] =
			case f.[1f Aloittaneista muun kuin alkuperäisen tutkintolajin tutkinnon suorittaneet koulutuslajin mukaan]
				when ''Kyllä'' then ''Yes''
				when ''Ei'' then ''No''
				when ''Virhetilanne'' then ''Missing data''
			end, 
		 [Degree in target field of ed. 02] =
			case f.[2e Aloittaneista alkuperäisen koulutusalan (2002) tutkinnon suorittaneet koulutusalan mukaan]
				when ''Kyllä'' then ''Yes''
				when ''Ei'' then ''No''
				when ''Virhetilanne'' then ''Missing data''
			end, 
		[Degree in target subfield of ed. 02] =
			case f.[3e Aloittaneista alkuperäisen opintoalan (2002) tutkinnon suorittaneet opintoalan mukaan]
				when ''Kyllä'' then ''Yes''
				when ''Ei'' then ''No''
				when ''Virhetilanne'' then ''Missing data''
			end, 
		 [Degree in target ed. institution] =
			case f.[5e Aloittaneista alkuperäisessä oppilaitoksessa tutkinnon suorittaneet oppilaitoksen mukaan]
				when ''Kyllä'' then ''Yes''
				when ''Ei'' then ''No''
				when ''Virhetilanne'' then ''Missing data''
			end, 
		 [Degree in target field of ed. 95] =
			case f.[8e Aloittaneista alkuperäisen opintoalan (1995) tutkinnon suorittaneet opintoalan mukaan]
				when ''Kyllä'' then ''Yes''
				when ''Ei'' then ''No''
				when ''Virhetilanne'' then ''Missing data''
			end, 
		--koodit
		d7.koulutusaste2002_Koodi AS [Koodit Tavoitetutk. koulutusaste 2002], 
		d7.koulutusala2002_Koodi AS [Koodit Tavoitetutk. koul.ala 2002], 
		d7.opintoala1995_Koodi AS [Koodit Tavoitetutk. koul.ala 1995], 
		d7.opintoala2002_Koodi AS [Koodit Tavoitetutk. opintoala 2002], 
		d7.koulutus_Koodi AS [Koodit Tavoitetutk. koulutusnimike], 
		d8.koulutusaste2002_Koodi AS [Koodit Suor. tutkinnon koulutusaste 2002], 
		d8.koulutusala2002_Koodi AS [Koodit Suor. tutkinnon koul.ala 2002], 
		d8.opintoala1995_Koodi AS [Koodit Suor. tutkinnon koul.ala 1995], 
		d8.opintoala2002_Koodi AS [Koodit Suor. tutkinnon opintoala 2002], 
		d8.koulutus_Koodi AS [Koodit Suor. tutkinnon koulutusnimike], 
		d9.koulutusaste2002_Koodi AS [Koodit Pohjakoul. koulutusaste 2002], 
		d9.koulutusala2002_Koodi AS [Koodit Pohjakoul. koul.ala 2002], 
		d9.opintoala1995_Koodi AS [Koodit Pohjakoul. koul.ala 1995], 
		d9.opintoala2002_Koodi AS [Koodit Pohjakoul. opintoala 2002], 
		d9.koulutus_Koodi AS [Koodit Pohjakoul. koulutusnimike], 
		d3.maakunta_Koodi AS [Koodit Tavoitetutk. maakunta], 
		d4.maakunta_Koodi AS [Koodit Suor. tutkinnon maakunta], 
		coalesce(d13.oppilaitoksen_korvaavakoodi,d13.oppilaitoskoodi) AS [Koodit Tavoitetutk. oppilaitos], 
		coalesce(d13.oppilaitoksen_korvaavakoodi,d13.oppilaitoskoodi) AS [Koodit Tavoitetutk. yliopisto], 
		coalesce(d13.oppilaitoksen_korvaavakoodi,d13.oppilaitoskoodi) AS [Koodit Tavoitetutk. amk], 
		d13.koulutuksen_jarjestajakoodi AS [Koodit Tavoitetutk. koul. järjestäjä],
		coalesce(d14.oppilaitoksen_korvaavakoodi,d14.oppilaitoskoodi) AS [Koodit Suor. tutkinnon oppilaitos], 
		coalesce(d14.oppilaitoksen_korvaavakoodi,d14.oppilaitoskoodi) AS [Koodit Suor. tutkinnon yliopisto], 
		coalesce(d14.oppilaitoksen_korvaavakoodi,d14.oppilaitoskoodi) AS [Koodit Suor. tutkinnon amk], 
		--jarjestys
		d1.jarjestys AS lukukausi_jarjestys, 
		d17.jarjestys AS tarkastelujakso_jarjestys, 
		d16.jarjestys AS sukupuoli_jarjestys, 
		d2.jarjestys AS aidinkieli_jarjestys, 
		d5.jarjestys_ika, 
		d5.jarjestys_ika5v, 
		d6.jarjestys_koulutuslaji2 AS koulutuslaji_jarjestys, 
		d7.jarjestys_koulutusaste2002, 
		d7.jarjestys_koulutusala2002, 
		d7.jarjestys_opintoala1995 AS jarjestys_koulutusala1995, 
		d7.jarjestys_opintoala2002 AS jarjestys_opintoala, 
		d7.jarjestys AS jarjestys_koulutusnimike, 
		d8.jarjestys_koulutusaste2002 AS jarjestys_suor_koulutusaste2002, 
		d8.jarjestys_koulutusala2002 AS jarjestys_suor_koulutusala2002, 
		d8.jarjestys_opintoala1995 AS jarjestys_suor_koulutusala1995, 
		d8.jarjestys_opintoala2002 AS jarjestys_suor_opintoala, 
		d8.jarjestys AS jarjestys_suor_koulutusnimike, 
		d9.jarjestys_koulutusaste2002 AS jarjestys_pohj_koulutusaste2002, 
		d9.jarjestys_koulutusala2002 AS jarjestys_pohj_koulutusala2002, 
		d9.jarjestys_opintoala1995 AS jarjestys_pohj_koulutusala1995, 
		d9.jarjestys_opintoala2002 AS jarjestys_pohj_opintoala, 
		d9.jarjestys AS jarjestys_pohj_koulutusnimike, 
		d3.jarjestys_maakunta, 
		d4.jarjestys_maakunta AS saavutettu_al_jarjestys_maakunta, 
		d12.jarjestys AS opiskelijan_olo_jarjestys, 
		d13.jarjestys_oppilaitos, 
		d13.jarjestys_oppilaitostyyppi, 
		d13.jarjestys_omistajatyyppi, 
		d14.jarjestys_oppilaitos AS saavutettu_jarjestys_oppilaitos, 
		d14.jarjestys_oppilaitostyyppi AS saavutettu_jarjestys_oppilaitostyyppi, 
		d14.jarjestys_omistajatyyppi AS saavutettu_jarjestys_omistajatyyppi, 
		f.[1a_jarjestys], f.[1b_jarjestys], f.[1c_jarjestys], 
		f.[1d_jarjestys], f.[1e_jarjestys], f.[1f_jarjestys], f.[1g_jarjestys], f.[1h_jarjestys], 
		f.[2a_jarjestys], f.[2b_jarjestys], f.[2e_jarjestys], f.[2f_jarjestys], f.[2g_jarjestys], 
		f.[2h_jarjestys], f.[3a_jarjestys], f.[3b_jarjestys], f.[3e_jarjestys], f.[3f_jarjestys], 
		f.[3g_jarjestys], f.[3h_jarjestys], f.[4a_jarjestys], f.[4b_jarjestys], f.[4e_jarjestys], 
		f.[4f_jarjestys], f.[4g_jarjestys], f.[4h_jarjestys], f.[5a_jarjestys], f.[5b_jarjestys], 
		f.[5e_jarjestys], f.[5f_jarjestys], f.[5g_jarjestys], f.[5h_jarjestys], f.[6a_jarjestys], 
		f.[6b_jarjestys], f.[6e_jarjestys], f.[6f_jarjestys], f.[6g_jarjestys], f.[6h_jarjestys], 
		f.[7a_jarjestys], f.[7b_jarjestys], f.[7e_jarjestys], f.[7f_jarjestys], f.[7g_jarjestys], 
		f.[7h_jarjestys], f.[8a_jarjestys], f.[8b_jarjestys], f.[8e_jarjestys], f.[8f_jarjestys], 
		f.[8g_jarjestys], f.[8h_jarjestys], 
		d10.lahde_koodi, 
		d6.koulutuslaji2_koodi
		--isced
		,d7.iscle2011 as "Tavoitetutk. koul.aste 1"
		,d7.Koulutusaste_taso2 as "Tavoitetutk. koul.aste 2"
		,d7.iscfibroad2013 as "Tavoitetutk. koul.ala 1"
		,d7.iscfinarrow2013 as "Tavoitetutk. koul.ala 2"
		,d7.iscfi2013 as "Tavoitetutk. koul.ala 3"
		,d7.OKM_ohjauksen_ala as "Tavoitetutk. OKM ohj. ala kk"
		,d7.iscle2011_SV as "Målexamens utbildn.nivå 1"
		,d7.Koulutusaste_taso2_SV as "Målexamens utbildn.nivå 2"
		,d7.iscfibroad2013_SV as "Målexamens utbildn.omr. 1"
		,d7.iscfinarrow2013_SV as "Målexamens utbildn.omr. 2"
		,d7.iscfi2013_SV as "Målexamens utbildn.omr. 3"
		,d7.OKM_ohjauksen_ala_SV as "Målexamens UKM-styrn.omr. hs"
		,d7.iscle2011_EN as "Target level of ed. 1"
		,d7.Koulutusaste_taso2_EN as "Target level of ed. 2"
		,d7.iscfibroad2013_EN as "Target field of ed. 1"
		,d7.iscfinarrow2013_EN as "Target field of ed. 2"
		,d7.iscfi2013_EN as "Target field of ed. 3"
		,d7.OKM_ohjauksen_ala_EN as "Target field of ed. HE ste."
		,d7.jarjestys_iscle2011 as jarj_isced_koulast1
		,d7.jarjestys_Koulutusaste_taso2 as jarj_isced_koulast2
		,d7.jarjestys_iscfibroad2013 as jarj_isced_koulala1
		,d7.jarjestys_iscfinarrow2013 as jarj_isced_koulala2
		,d7.jarjestys_iscfi2013 as jarj_isced_koulala3
		,d7.jarjestys_OKM_ohjauksen_ala as jarj_isced_okmohjaus1
		,d7.iscle2011_koodi as "Koodit Tavoitetutk. koul.aste 1"
		,d7.Koulutusaste_taso2_koodi as "Koodit Tavoitetutk. koul.aste 2"
		,d7.iscfibroad2013_koodi as "Koodit Tavoitetutk. koul.ala 1"
		,d7.iscfinarrow2013_koodi as "Koodit Tavoitetutk. koul.ala 2"
		,d7.iscfi2013_koodi as "Koodit Tavoitetutk. koul.ala 3"
		,d7.OKM_ohjauksen_ala_koodi as "Koodit Tavoitetutk. OKM ohjauksen ala kk"
		,d8.iscle2011 as "Suor. tutk. koul.aste 1"
		,d8.Koulutusaste_taso2 as "Suor. tutk. koul.aste 2"
		,d8.iscfibroad2013 as "Suor. tutk. koul.ala 1"
		,d8.iscfinarrow2013 as "Suor. tutk. koul.ala 2"
		,d8.iscfi2013 as "Suor. tutk. koul.ala 3"
		,d8.OKM_ohjauksen_ala as "Suor. tutk. OKM ohj. ala kk"
		,d8.iscle2011_SV as "Examens utbildn.nivå 1"
		,d8.Koulutusaste_taso2_SV as "Examens utbildn.nivå 2"
		,d8.iscfibroad2013_SV as "Examens utbildn.omr. 1"
		,d8.iscfinarrow2013_SV as "Examens utbildn.omr. 2"
		,d8.iscfi2013_SV as "Examens utbildn.omr. 3"
		,d8.OKM_ohjauksen_ala_SV as "Examens UKM-styrn.omr. hs"
		,d8.iscle2011_EN as "Degree''s level of ed. 1"
		,d8.Koulutusaste_taso2_EN as "Degree''s level of ed. 2"
		,d8.iscfibroad2013_EN as "Degree''s field of ed. 1"
		,d8.iscfinarrow2013_EN as "Degree''s field of ed. 2"
		,d8.iscfi2013_EN as "Degree''s field of ed. 3"
		,d8.OKM_ohjauksen_ala_EN as "Degree''s field of ed. HE ste."
		,d8.jarjestys_iscle2011 as jarj_isced2_koulast1
		,d8.jarjestys_Koulutusaste_taso2 as jarj_isced2_koulast2
		,d8.jarjestys_iscfibroad2013 as jarj_isced2_koulala1
		,d8.jarjestys_iscfinarrow2013 as jarj_isced2_koulala2
		,d8.jarjestys_iscfi2013 as jarj_isced2_koulala3
		,d8.jarjestys_OKM_ohjauksen_ala as jarj_isced2_okmohjaus1
		,d8.iscle2011_koodi as "Koodit Suor. tutk. koul.aste 1"
		,d8.Koulutusaste_taso2_koodi as "Koodit Suor. tutk. koul.aste 2"
		,d8.iscfibroad2013_koodi as "Koodit Suor. tutk. koul.ala 1"
		,d8.iscfinarrow2013_koodi as "Koodit Suor. tutk. koul.ala 2"
		,d8.iscfi2013_koodi as "Koodit Suor. tutk. koul.ala 3"
		,d8.OKM_ohjauksen_ala_koodi as "Koodit Suor. tutk. OKM ohjauksen ala kk"
		,d9.iscle2011 as "Pohjakoul. koul.aste 1"
		,d9.Koulutusaste_taso2 as "Pohjakoul. koul.aste 2"
		,d9.iscfibroad2013 as "Pohjakoul. koul.ala 1"
		,d9.iscfinarrow2013 as "Pohjakoul. koul.ala 2"
		,d9.iscfi2013 as "Pohjakoul. koul.ala 3"
		,d9.OKM_ohjauksen_ala as "Pohjakoul. OKM ohj. ala kk"
		,d9.iscle2011_SV as "Grundutb. utbildn.nivå 1"
		,d9.Koulutusaste_taso2_SV as "Grundutb. utbildn.nivå 2"
		,d9.iscfibroad2013_SV as "Grundutb. utbildn.omr. 1"
		,d9.iscfinarrow2013_SV as "Grundutb. utbildn.omr. 2"
		,d9.iscfi2013_SV as "Grundutb. utbildn.omr. 3"
		,d9.OKM_ohjauksen_ala_SV as "Grundutb. UKM-styrn.omr. hs"
		,d9.iscle2011_EN as "Previous deg. level of ed. 1"
		,d9.Koulutusaste_taso2_EN as "Previous deg. level of ed. 2"
		,d9.iscfibroad2013_EN as "Previous deg. field of ed. 1"
		,d9.iscfinarrow2013_EN as "Previous deg. field of ed. 2"
		,d9.iscfi2013_EN as "Previous deg. field of ed. 3"
		,d9.OKM_ohjauksen_ala_EN as "Previous deg. field of ed. HE ste."
		,d9.jarjestys_iscle2011 as jarj_isced3_koulast1
		,d9.jarjestys_Koulutusaste_taso2 as jarj_isced3_koulast2
		,d9.jarjestys_iscfibroad2013 as jarj_isced3_koulala1
		,d9.jarjestys_iscfinarrow2013 as jarj_isced3_koulala2
		,d9.jarjestys_iscfi2013 as jarj_isced3_koulala3
		,d9.jarjestys_OKM_ohjauksen_ala as jarj_isced3_okmohjaus1
		,d9.iscle2011_koodi as "Koodit Pohjakoul. koul.aste 1"
		,d9.Koulutusaste_taso2_koodi as "Koodit Pohjakoul. koul.aste 2"
		,d9.iscfibroad2013_koodi as "Koodit Pohjakoul. koul.ala 1"
		,d9.iscfinarrow2013_koodi as "Koodit Pohjakoul. koul.ala 2"
		,d9.iscfi2013_koodi as "Koodit Pohjakoul. koul.ala 3"
		,d9.OKM_ohjauksen_ala_koodi as "Koodit Pohjakoul. OKM ohjauksen ala kk"
FROM     dbo.f_aloittaneiden_lapaisy f INNER JOIN
			dbo.d_kausi AS d1 ON d1.kausi_id = f.aloituskausikoodi INNER JOIN
			dbo.d_aidinkieli_versio1 AS d2 ON d2.id = f.aikielir1_id INNER JOIN
			dbo.d_sukupuoli AS d16 ON d16.id = f.sp_id INNER JOIN
			dbo.d_tarkastelujakso AS d17 ON d17.id = f.tarkastelujakso_id INNER JOIN
			dbo.d_alueluokitus AS d3 ON d3.id = f.alueluokitus_id INNER JOIN
			dbo.d_alueluokitus AS d4 ON d4.id = f.saavutettu_alueluokitus_id INNER JOIN
			dbo.d_ika AS d5 ON d5.id = f.ika_id INNER JOIN
			dbo.d_koulutuslaji2 AS d6 ON d6.id = f.koulutuslaji2_id INNER JOIN
			dbo.d_koulutusluokitus AS d7 ON d7.id = f.koulk_id INNER JOIN
			dbo.d_koulutusluokitus AS d8 ON d8.id = f.saavutettu_koulk_id INNER JOIN
			dbo.d_koulutusluokitus AS d9 ON d9.id = f.pohjkoulk_id INNER JOIN
			dbo.d_lahde AS d10 ON d10.id = f.lahde_id INNER JOIN
			dbo.d_opiskelijan_olo AS d12 ON d12.id = f.ololk_id INNER JOIN
			dbo.d_oppilaitoksen_taustatiedot AS d13 ON d13.id = f.oppilaitoksen_taustatiedot_id INNER JOIN
			dbo.d_oppilaitoksen_taustatiedot AS d14 ON d14.id = f.saavutettu_oppilaitoksen_taustatiedot_id
WHERE        (f.aineistokoodi = ''K3.10'') AND (d17.tarkastelujakso <> ''0,5 vuotta'') AND (d1.lukuvuosi <> ''1999/2000'') AND (d1.lukuvuosi <> ''2000/2001'') AND (d1.lukuvuosi <> ''2001/2002'') AND (d6.koulutuslaji2_koodi <> ''52'') AND 
                         (f.[1a Aloittaneiden opintojen kulku koulutuslajin mukaan prioriteettina mikä tahansa tutkinto] <> ''Virhetilanne'')
















' 
GO
/****** Object:  View [dbo].[v_f_aloittaneiden_lapaisy_K3_10_yo]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_aloittaneiden_lapaisy_K3_10_yo]'))
EXEC dbo.sp_executesql @statement = N'














CREATE VIEW [dbo].[v_f_aloittaneiden_lapaisy_K3_10_yo]
AS
SELECT  f.lkm_int AS lkm_int2, 
		d1.lukuvuosi AS Aloituslukuvuosi, 
		d1.vuosiselite AS Aloitusvuosi, 
		d1.lukukausiselite AS Aloituslukukausi, 
		d17.tarkastelujakso AS Tarkastelujakso, 
		d16.sukupuoli AS Sukupuoli, 
		d2.aidinkieli_versio1 AS Äidinkieli, 
		d5.ika AS Ikä, 
		d5.ika5v AS Ikäryhmä, 
		d6.koulutuslaji2 AS [Tavoitetutk. koulutuslaji],
		Case when d7.koulutusaste2002_koodi=''63'' 
		Or (d7.koulutusaste2002_koodi=''72'' 
			and  d7.koulutus_koodi in (''772101'', ''772201'')) then ''Aloitus I syklin tutkinnossa'' 
			when d7.koulutusaste2002_koodi=''72'' then ''Aloitus II syklin tutkinnossa''  
			else ''Tuntematon'' end AS [Tavoitetutk. sykli], 
		d7.koulutusala2002 AS [Tavoitetutk. koul.ala (02 luokitus)], 
		d7.opintoala1995 AS [Tavoitetutk. koul.ala (95 luokitus)], 
		d7.opintoala2002 AS [Tavoitetutk. opintoala (02 luokitus)], 
		d7.koulutus AS [Tavoitetutk. koulutusnimike], 
		d8.koulutusaste2002 AS [Suor. tutkinnon koulutusaste], 
		d8.koulutusala2002 AS [Suor. tutkinnon koul.ala (02 luokitus)], 
		d8.opintoala1995 AS [Suor. tutkinnon koul.ala (95 luokitus)], 
		d8.opintoala2002 AS [Suor. tutkinnon opintoala (02 luokitus)], 
		d8.koulutus AS [Suor. tutkinnon koulutusnimike], 
		d9.koulutusaste2002 AS [Pohjakoul. koulutusaste], 
		d9.koulutusala2002 AS [Pohjakoul. koul.ala (02 luokitus)], 
		d9.opintoala1995 AS [Pohjakoul. koul.ala (95 luokitus)], 
		d9.opintoala2002 AS [Pohjakoul. opintoala (02 luokitus)], 
		d9.koulutus AS [Pohjakoul. koulutusnimike], 
		d3.maakunta AS [Tavoitetutk. maakunta], 
		d4.maakunta AS [Suor. tutkinnon maakunta], 
		d12.opiskelijan_olo AS Kirjoillaolo, 
		d13.oppilaitos AS [Tavoitetutk. yliopisto], 
		d13.oppilaitostyyppi AS [Tavoitetutk. oppil.tyyppi], 
		d13.oppilaitoksen_omistajatyyppi AS [Tavoitetutk. oppil. omistajatyyppi], 
		d14.oppilaitos AS [Suor. tutkinnon yliopisto], 
		d14.oppilaitostyyppi AS [Suor. tutkinnon oppil.tyyppi], 
		d14.oppilaitoksen_omistajatyyppi AS [Suor. tutkinnon oppil. omistajatyyppi], 
		f.[1a Aloittaneiden opintojen kulku koulutuslajin mukaan prioriteettina mikä tahansa tutkinto] AS [Opintojen kulku], 
		f.[1b Aloittaneiden opintojen kulku koulutuslajin mukaan prioriteettina tutkinto ja opiskelu alkuperäisessä tutkintolajissa] AS [Opintojen kulku prioriteetti 2], 
		f.[1c Aloittaneista tutkinnon suorittaneet koulutuslajin mukaan] AS [Suoritettu tutkinto], 
		f.[1d Aloittaneista ilman tutkintoa opiskelua jatkavat koulutuslajin mukaan] AS [Opiskelua jatkavat tutk.lajin mukaan], 
		f.[1e Aloittaneista alkuperäisen koulutuslajin tutkinnon suorittaneet koulutuslajin mukaan] AS [Tutkinto tavoitet. tutkintolajissa], 
		f.[1f Aloittaneista muun kuin alkuperäisen tutkintolajin tutkinnon suorittaneet koulutuslajin mukaan] AS [Tutkinto muussa tutkintolajissa], 
		f.[1g Aloittaneista alkuperäisen tutkintolajin opiskelua jatkavat koulutuslajin mukaan] AS [Opiskelee tavoitet. tutkintolajissa], 
		f.[1h Aloittaneista muun tutkintolajin opiskelua jatkavat koulutuslajin mukaan] AS [Opiskelee muussa tutkintolajissa], 
		f.[2a Aloittaneiden opintojen kulku koulutusalan (2002) mukaan prioriteettina mikä tahansa tutkinto] AS [Opintojen kulku koulutusaloittain], 
		f.[2b Aloittaneiden opintojen kulku koulutusalan (2002) mukaan prioriteettina tutkinto ja opiskelu alkuperäisellä] AS [Opintojen kulku koulutusaloittain prioriteetti 2], 
		f.[2e Aloittaneista alkuperäisen koulutusalan (2002) tutkinnon suorittaneet koulutusalan mukaan] AS [Tutkinto tavoitet. koulutusalalla], 
		f.[2e Aloittaneista alkuperäisen koulutusalan (2002) tutkinnon suorittaneet koulutusalan mukaan] AS [Tutkinto tavoitet. koul.alalla (02 luokitus)], 
		f.[2f Aloittaneista muun kuin alkuperäisen tutkintolajin tutkinnon suorittaneet koulutuslajin mukaan] AS [Tutkinto muulla koulutusalalla], 
		f.[2g Aloittaneista alkuperäisellä koulutusalalla opiskelua jatkavat koulutusalan mukaan] AS [Opiskelee tavoitet. koulutusalalla], 
		f.[2h Aloittaneista muulla koulutusalalla opiskelua jatkavat koulutusalan mukaan] AS [Opiskelee muulla koulutusalalla], 
		f.[3a Aloittaneiden opintojen kulku opintoalan (2002) mukaan prioriteettina mikä tahansa tutkinto] AS [Opintojen kulku opintoaloittain], 
		f.[3b Aloittaneiden opintojen kulku opintoalan (2002) mukaan prioriteettina tutkinto ja opiskelu alkuperäisellä] AS [Opintojen kulku opintoaloittain prioriteetti 2],
		f.[3e Aloittaneista alkuperäisen opintoalan (2002) tutkinnon suorittaneet opintoalan mukaan] AS [Tutkinto tavoitet. opintoalalla], 
		f.[3e Aloittaneista alkuperäisen opintoalan (2002) tutkinnon suorittaneet opintoalan mukaan] AS [Tutkinto tavoitet. op.alalla (02 luokitus)], 
		f.[3f Aloittaneista muun opintoalan (2002) tutkinnon suorittaneet opintoalan mukaan] AS [Tutkinto muulla opintoalalla], 
		f.[3g Aloittaneista alkuperäisellä opintoalalla (2002) opiskelua jatkavat opintoalan mukaan] AS [Opiskelee tavoitet. opintoalalla], 
		f.[3h Aloittaneista muulla opintoalalla (2002) opiskelua jatkavat opintoalan mukaan] AS [Opiskelee muulla opintoalalla], 
		f.[4a Aloittaneiden opintojen kulku koulutuksen järjestäjän mukaan, toinen aste prioriteettina tutkinto missä tahansa] AS [Opintojen kulku koul. järjestäjittäin], 
		f.[4b Aloittaneiden opintojen kulku koulutuksen järjestäjän mukaan, toinen aste prioriteettina tutkinto ja opiskelu alkuperäisellä] AS [Opintojen kulku koul. järjestäjittäin prioriteetti 2], 
		f.[4e Aloittaneista alkuperäisen koulutuksen järjestäjän tutkinnon suorittaneet järjestäjän mukaan] AS [Tutkinto tavoitet. koul. järjestäjällä], 
		f.[4f Aloittaneista muun koulutuksen järjestäjän tutkinnon suorittaneet järjestäjän mukaan] AS [Tutkinto muulla koul. järjestäjällä], 
		f.[4g Aloittaneista alkuperäisellä järjestäjällä opiskelua jatkavat järjestäjän mukaan] AS [Opiskelee tavoitet. koul. järjestäjällä], 
		f.[4h Aloittaneista muulla järjestäjällä opiskelua jatkavat järjestäjän mukaan] AS [Opiskelee muulla koul. järjestäjällä], 
		f.[5a Aloittaneiden opintojen kulku oppilaitoksen mukaan prioriteettina tutkinto missä tahansa] AS [Opintojen kulku oppilaitoksittain], 
		f.[5b Aloittaneiden opintojen kulku oppilaitoksen mukaan prioriteettina tutkinto ja opiskelu alkuperäisessä] AS [Opintojen kulku oppilaitoksittain prioriteetti 2], 
		f.[5e Aloittaneista alkuperäisessä oppilaitoksessa tutkinnon suorittaneet oppilaitoksen mukaan] AS [Tutkinto tavoitet. oppilaitoksessa], 
		f.[5f Aloittaneista muussa oppilaitoksessa tutkinnon suorittaneet oppilaitoksen mukaan] AS [Tutkinto muussa oppilaitoksessa], 
		f.[5g Aloittaneista alkuperäisessä oppilaitoksessa opiskelua jatkavat oppilaitoksen mukaan] AS [Opiskelee tavoitet. oppilaitoksessa], 
		f.[5h Aloittaneista muussa oppilaitoksessa opiskelua jatkavat oppilaitoksen mukaan] AS [Opiskelee muussa oppilaitoksessa], 
		f.[6a Aloittaneiden opintojen kulku maakunnan mukaan prioriteettina tutkinto missä tahansa] AS [Opintojen kulku maakunnittain], 
		f.[6b Aloittaneiden opintojen kulku maakunnan mukaan prioriteettina tutkinto ja opiskelu alkuperäisessä] AS [Opintojen kulku maakunnittain prioriteetti 2], 
		f.[6e Aloittaneista alkuperäisessä maakunnassa tutkinnon suorittaneet maakunnan mukaan] AS [Tutkinto tavoitet. maakunnassa], 
		f.[6f Aloittaneista muussa maakunnassa tutkinnon suorittaneet maakunnan mukaan] AS [Tutkinto muussa maakunnassa], 
		f.[6g Aloittaneista alkuperäisessä maakunnassa opiskelua jatkavat maakunnan mukaan] AS [Opiskelee tavoitet. maakunnassa], 
		f.[6h Aloittaneista muussa maakunnassa opiskelua jatkavat maakunnan mukaan] AS [Opiskelee muussa maakunnassa], 
		f.[7a Aloittaneiden opintojen kulku koulutussektorin mukaan prioriteettina tutkinto missä tahansa] AS [Opintojen kulku koul.sektoreittan], 
		f.[7b Aloittaneiden opintojen kulku koulutussektorin mukaan prioriteettina tutkinto ja opiskelu alkuperäisellä] AS [Opintojen kulku koul.sektoreittan prioriteetti 2], 
		f.[7e Aloittaneista alkuperäisen koulutussektorin tutkinnon suorittaneet koulutussektorin mukaan] AS [Tutkinto tavoitet. koulutussektorilla], 
		f.[7f Aloittaneista muun koulutussektorin tutkinnon suorittaneet koulutussektorin mukaan] AS [Tutkinto muulla koulutussektorilla], 
		f.[7g Aloittaneista alkuperäisellä koulutussektorilla opiskelua jatkavat koulutussektorin mukaan] AS [Opiskelee tavoitet. koulutussektorilla], 
		f.[7h Aloittaneista muulla koulutussektorilla opiskelua jatkavat koulutussektorin mukaan] AS [Opiskelee muulla koulutussektorilla], 
		f.[8a Aloittaneiden opintojen kulku opintoalan (1995) mukaan prioriteettina mikä tahansa tutkinto] AS [Opintojen kulku koul.aloittain (95)], 
		f.[8b Aloittaneiden opintojen kulku opintoalan (1995) mukaan prioriteettina tutkinto ja opiskelu alkuperäisellä] AS [Opintojen kulku koul.aloittain (95) prioriteetti 2], 
		f.[8e Aloittaneista alkuperäisen opintoalan (1995) tutkinnon suorittaneet opintoalan mukaan] AS [Tutkinto tavoitet. koulutusalalla (95)], 
		f.[8f Aloittaneista muun opintoalan (1995) tutkinnon suorittaneet opintoalan mukaan] AS [Tutkinto muulla koulutusalalla (95)], 
		f.[8g Aloittaneista alkuperäisellä opintoalalla (1995) opiskelua jatkavat opintoalan mukaan] AS [Opiskelee tavoitet. koulutusalalla (95)], 
		f.[8h Aloittaneista muulla opintoalalla (1995) opiskelua jatkavat opintoalan mukaan] AS [Opiskelee muulla koulutusalalla (95)], 
		f.aloitus_saavutus AS [Aloitus saavutus], 
		f.tarkastelujakso_tulevaisuus AS [Tarkastelujakson tulevaisuus], 
		f.tarkastelujakso_edustavuus AS [Tarkastelujakson edustavuus], 
		d10.lahde AS Lähde, 
		--ruotsi
		d1.lukuvuosi AS Begynnelseläsår, 
		d1.vuosiselite_SV AS Begynnelseår, 
		d1.lukukausiselite_SV AS Begynnelsetermin, 
		d17.tarkastelujakso_SV AS Granskningsperiod, 
		d16.sukupuoli_SV AS Kön, 
		d2.aidinkieli_versio1_SV AS Modersmål, 
		d5.ika_SV AS Ålder, 
		d5.ika5v_SV AS Åldersgrupp, 
		d6.koulutuslaji2_SV AS [Målexamens examensslag], 
		d7.koulutusaste2002_SV AS [Målexamens utbildn.nivå 2002], 
		Case when d7.koulutusaste2002_koodi=''63'' 
		Or (d7.koulutusaste2002_koodi=''72'' 
			and  d7.koulutus_koodi in (''772101'', ''772201'')) Or d7.koulutusaste2002_koodi=''62'' then ''Påbörjande i I-skedets examen'' 
			when d7.koulutusaste2002_koodi=''71'' Or d7.koulutusaste2002_koodi=''72'' then ''Påbörjande i II-skedets examen''  
			else ''Tuntematon'' end AS [Startskede], 
		d7.koulutusala2002_SV AS [Målexamens utbildn.område 02], 
		d7.opintoala1995_SV AS [Målexamens utbildn.område 95], 
		d7.opintoala2002_SV AS [Målexamens studieområde 02], 
		d7.koulutus_SV AS [Målexamens utbildn.benämning], 
		d8.koulutusaste2002_SV AS [Examens utbildn.nivå 2002], 
		d8.koulutusala2002_SV AS [Examens utbildn.område 2002], 
		d8.opintoala1995_SV AS [Examens utbildn.område 1995], 
		d8.opintoala2002_SV AS [Examens studieområde 2002], 
		d8.koulutus_SV AS [Examens utbildn.benämning], 
		d9.koulutusaste2002_SV AS [Grundutb. utbildn.nivå 2002], 
		d9.koulutusala2002_SV AS [Grundutb. utbildn.område 2002], 
		d9.opintoala1995_SV AS [Grundutb. utbildn.område 1995], 
		d9.opintoala2002_SV AS [Grundutb. studieområde 2002], 
		d9.koulutus_SV AS [Grundutb. utbildn.benämning], 
		d3.maakunta_SV AS [Målexamens landskap], 
		d4.maakunta_SV AS [Examens landskap], 
		d12.opiskelijan_olo_SV AS Inskrivning, 
		d13.oppilaitos_SV AS [Målexamens universitet], 
		d13.koulutuksen_jarjestaja_SV AS [Målexamens utbildn.ordnare],
				[Studieförlopp] = 
			case f.[1a Aloittaneiden opintojen kulku koulutuslajin mukaan prioriteettina mikä tahansa tutkinto]
				when ''Tutkinto alkuperäisessä tutkintolajissa'' then ''Examen i det ursprungliga examensslaget''
				when ''Tutkinto muussa tutkintolajissa'' then ''Examen i annat examensslag''
				when ''Tutkinto muussa tutkintolajissa, kandidaatin tutkinto'' then ''Examen i annat examensslag, lägre högskoleexamen''
				when ''Opiskelee alkuperäisessä tutkintolajissa'' then ''Studerar i det ursprungliga examensslaget''
				when ''Opiskelee muussa tutkintolajissa'' then ''Studerar i annat examensslag''
				when ''Ei tutkintoa, ei opiskele, työllinen'' then ''Ingen examen, inte studerar, sysselsatt''
				when ''Ei tutkintoa, ei opiskele, ei työllinen'' then ''Ingen examen, inte studerar, arbetslös''
				else  ''Information saknas''
			end , 
		[Studieförlopp prior. 2] =
			case f.[1b Aloittaneiden opintojen kulku koulutuslajin mukaan prioriteettina tutkinto ja opiskelu alkuperäisessä tutkintolajissa]
				when ''Tutkinto alkuperäisessä tutkintolajissa'' then ''Examen i det ursprungliga examensslaget''
				when ''Tutkinto muussa tutkintolajissa'' then ''Examen i annat examensslag''
				when ''Tutkinto muussa tutkintolajissa, kandidaatin tutkinto'' then ''Examen i annat examensslag, lägre högskoleexamen''
				when ''Opiskelee alkuperäisessä tutkintolajissa'' then ''Studerar i det ursprungliga examensslaget''
				when ''Opiskelee muussa tutkintolajissa'' then ''Studerar i annat examensslag''
				when ''Ei tutkintoa, ei opiskele, työllinen'' then ''Ingen examen, inte studerar, sysselsatt''
				when ''Ei tutkintoa, ei opiskele, ei työllinen'' then ''Ingen examen, inte studerar, arbetslös''
				else ''Information saknas''
			end			, 
		[Avlagt examen] =
			case f.[1c Aloittaneista tutkinnon suorittaneet koulutuslajin mukaan]
				when ''Tutkinto lukiokoulutuksesta'' then ''Studentexamen''
				when ''Ammatillinen perustutkinto'' then ''Grundläggande yrkesexamen''
				when ''Ammatillinen lisäkoulutus ammattitutkinto tai erikoisammattitutkinto'' then ''Yrkesinriktad tilläggsutbildning, yrkesexamen eller specialyrkesexamen''
				when ''Muu korkein ja viimeisimmäksi suoritettu tutkinto, toinen aste'' then ''Övrig högsta och senast avlagd examen, andra stadiet''
				when ''Ammattikorkeakoulututkinto'' then ''Yrkeshögskoleexamen''
				when ''Alempi korkeakoulututkinto'' then ''Lägre högskoleexamen''
				when ''Ylempi ammattikorkeakoulututkinto'' then ''Högre yrkeshögskoleexamen''
				when ''Ylempi korkeakoulututkinto'' then ''Högre högskoleexamen''
				when ''Tutkijakoulutusasteen tutkinto'' then ''Examen på forskarutbildningsnivå''
				when ''Muu korkein ja viimeisimmäksi suoritettu tutkinto, korkeakoulututkinto'' then ''Övrig högsta och senast avlagd examen, högskoleexamen''
				when ''Ei tutkintoa'' then ''Ingen examen''
				when ''Virhetilanne'' then ''Information saknas''
			end, 
		[Examen i målex. examensslag] = 
			case f.[1e Aloittaneista alkuperäisen koulutuslajin tutkinnon suorittaneet koulutuslajin mukaan]
				when ''Kyllä'' then ''Ja''
				when ''Ei'' then ''Inte''
				when ''Virhetilanne'' then ''Information saknas''
			end
		, 
		[Examen i annat examensslag] = 
			case [1f Aloittaneista muun kuin alkuperäisen tutkintolajin tutkinnon suorittaneet koulutuslajin mukaan]
				when ''Kyllä'' then ''Ja''
				when ''Ei'' then ''Inte''
				when ''Virhetilanne'' then ''Information saknas''
			end	
			, 
		[Examen i målex. utbildn.område 02] =
			case [2e Aloittaneista alkuperäisen koulutusalan (2002) tutkinnon suorittaneet koulutusalan mukaan]
				when ''Kyllä'' then ''Ja''
				when ''Ei'' then ''Inte''
				when ''Virhetilanne'' then ''Information saknas''
			end	
		, 
		[Examen i målex. studieområde 02] = 
			case [3e Aloittaneista alkuperäisen opintoalan (2002) tutkinnon suorittaneet opintoalan mukaan]
				when ''Kyllä'' then ''Ja''
				when ''Ei'' then ''Inte''
				when ''Virhetilanne'' then ''Information saknas''
			end	
		, 
		[Examen i målex. läroanstalt] = 
			case [5e Aloittaneista alkuperäisessä oppilaitoksessa tutkinnon suorittaneet oppilaitoksen mukaan] 
				when ''Kyllä'' then ''Ja''
				when ''Ei'' then ''Inte''
				when ''Virhetilanne'' then ''Information saknas''
			end	
		, 
		[Examen i målex. utbildn.område 95] = 
			case [8e Aloittaneista alkuperäisen opintoalan (1995) tutkinnon suorittaneet opintoalan mukaan]
				when ''Kyllä'' then ''Ja''
				when ''Ei'' then ''Inte''
				when ''Virhetilanne'' then ''Information saknas''
			end	
		,
		--englanti
		d1.lukuvuosi AS [First academic year], 
		d1.vuosiselite_EN AS [First year of studies], 
		d1.lukukausiselite_EN AS [First term], 
		d17.tarkastelujakso_EN AS [Reference period], 
		d16.sukupuoli_EN AS Gender, 
		d2.aidinkieli_versio1_EN AS [Mother tongue], 
		d5.ika_EN AS Age, 
		d5.ika5v_EN AS [Age group], 
		d6.koulutuslaji2_EN AS [Target degree''s form of deg.], 
		d7.koulutusaste2002_EN AS [Target deg. level of ed. 02], 
		Case when d7.koulutusaste2002_koodi=''63'' 
		Or (d7.koulutusaste2002_koodi=''72'' 
			and  d7.koulutus_koodi in (''772101'', ''772201'')) Or d7.koulutusaste2002_koodi=''62'' then ''Beginning of studies in cycle I degree'' 
			when d7.koulutusaste2002_koodi=''71'' Or d7.koulutusaste2002_koodi=''72'' then ''Beginning of studies in cycle II degree''  
			else ''Tuntematon'' end AS [Beginning cycle of ed.], 
		d7.koulutusala2002_EN AS [Target deg. field of ed. 02], 
		d7.opintoala1995_EN AS [Target deg. field of ed. 95], 
		d7.opintoala2002_EN AS [Target deg. subfield of ed. 02], 
		d7.koulutus_EN AS [Target deg. name of ed.], 
		d8.koulutusaste2002_EN AS [Degree''s level of ed. 02], 
		d8.koulutusala2002_EN AS [Degree''s field of ed. 02], 
		d8.opintoala1995_EN AS [Degree''s field of ed. 95], 
		d8.opintoala2002_EN AS [Degree''s subfield of ed. 02], 
		d8.koulutus_EN AS [Degree''s name of ed.], 
		d9.koulutusaste2002_EN AS [Previous deg. level of ed. 02], 
		d9.koulutusala2002_EN AS [Previous deg. field of ed. 02], 
		d9.opintoala1995_EN AS [Previous deg. field of ed. 95], 
		d9.opintoala2002_EN AS [Previous deg. subfield of ed. 02], 
		d9.koulutus_EN AS [Previous deg. name of ed.], 
		d3.maakunta_EN AS [Target degree''s region], 
		d4.maakunta_EN AS [Degree''s region], 
		d12.opiskelijan_olo_EN AS [Enrollment status], 
		d13.oppilaitos_EN AS [Target deg. university], 
		d13.koulutuksen_jarjestaja_EN AS [Target deg. ed. provider],
		d14.oppilaitos_EN AS [Degree''s university], 
		[Study progress] =
			case f.[1a Aloittaneiden opintojen kulku koulutuslajin mukaan prioriteettina mikä tahansa tutkinto]
				when ''Tutkinto alkuperäisessä tutkintolajissa'' then ''Qualification in the original form of degree''
				when ''Tutkinto muussa tutkintolajissa'' then ''Qualification in another form of degree''
				when ''Tutkinto muussa tutkintolajissa, kandidaatin tutkinto'' then ''Qualification in another form of degree, Bachelor''''s degree''
				when ''Opiskelee alkuperäisessä tutkintolajissa'' then ''Studying in the original form of degree''
				when ''Opiskelee muussa tutkintolajissa'' then ''Studying in another form of degree''
				when ''Ei tutkintoa, ei opiskele, työllinen'' then ''No qualification, not studying, employed''
				when ''Ei tutkintoa, ei opiskele, ei työllinen'' then ''No qualification, not studying, unemployed''
				else  ''Missing data''
			end ,
		[Study progress prior. 2] = 
			case f.[1b Aloittaneiden opintojen kulku koulutuslajin mukaan prioriteettina tutkinto ja opiskelu alkuperäisessä tutkintolajissa]
				when ''Tutkinto alkuperäisessä tutkintolajissa'' then ''Qualification in the original form of degree''
				when ''Tutkinto muussa tutkintolajissa'' then ''Qualification in another form of degree''
				when ''Tutkinto muussa tutkintolajissa, kandidaatin tutkinto'' then ''Qualification in another form of degree, Bachelor''''s degree''
				when ''Opiskelee alkuperäisessä tutkintolajissa'' then ''Studying in the original form of degree''
				when ''Opiskelee muussa tutkintolajissa'' then ''Studying in another form of degree''
				when ''Ei tutkintoa, ei opiskele, työllinen'' then ''No qualification, not studying, employed''
				when ''Ei tutkintoa, ei opiskele, ei työllinen'' then ''No qualification, not studying, unemployed''
				else  ''Missing data''
			end , 
		[Completed degree] =
			case f.[1c Aloittaneista tutkinnon suorittaneet koulutuslajin mukaan]
				when ''Tutkinto lukiokoulutuksesta'' then ''Matriculation examination''
				when ''Ammatillinen perustutkinto'' then ''Vocational upper secondary qualification''
				when ''Ammatillinen lisäkoulutus ammattitutkinto tai erikoisammattitutkinto'' then ''Further vocational qualification or specialist vocational qualification''
				when ''Muu korkein ja viimeisimmäksi suoritettu tutkinto, toinen aste'' then ''Other highest and most recent degree, upper secondary education''
				when ''Ammattikorkeakoulututkinto'' then ''UAS degree''
				when ''Alempi korkeakoulututkinto'' then ''Bachelor''''s degree''
				when ''Ylempi ammattikorkeakoulututkinto'' then ''UAS Master''''s degree''
				when ''Ylempi korkeakoulututkinto'' then ''Master''''s degree''
				when ''Tutkijakoulutusasteen tutkinto'' then ''Research degree''
				when ''Muu korkein ja viimeisimmäksi suoritettu tutkinto, korkeakoulututkinto'' then ''Other highest and most recent degree, higher education''
				when ''Ei tutkintoa'' then ''No degree''
				when ''Virhetilanne'' then ''Missing data''
			end, 
		[Degree in target form of deg.] =
			case f.[1e Aloittaneista alkuperäisen koulutuslajin tutkinnon suorittaneet koulutuslajin mukaan]
				when ''Kyllä'' then ''Yes''
				when ''Ei'' then ''No''
				when ''Virhetilanne'' then ''Missing data''
			end, 
		[Degree in another form of deg.] =
			case f.[1f Aloittaneista muun kuin alkuperäisen tutkintolajin tutkinnon suorittaneet koulutuslajin mukaan]
				when ''Kyllä'' then ''Yes''
				when ''Ei'' then ''No''
				when ''Virhetilanne'' then ''Missing data''
			end, 
		 [Degree in target field of ed. 02] =
			case f.[2e Aloittaneista alkuperäisen koulutusalan (2002) tutkinnon suorittaneet koulutusalan mukaan]
				when ''Kyllä'' then ''Yes''
				when ''Ei'' then ''No''
				when ''Virhetilanne'' then ''Missing data''
			end, 
		[Degree in target subfield of ed. 02] =
			case f.[3e Aloittaneista alkuperäisen opintoalan (2002) tutkinnon suorittaneet opintoalan mukaan]
				when ''Kyllä'' then ''Yes''
				when ''Ei'' then ''No''
				when ''Virhetilanne'' then ''Missing data''
			end, 
		 [Degree in target ed. institution] =
			case f.[5e Aloittaneista alkuperäisessä oppilaitoksessa tutkinnon suorittaneet oppilaitoksen mukaan]
				when ''Kyllä'' then ''Yes''
				when ''Ei'' then ''No''
				when ''Virhetilanne'' then ''Missing data''
			end, 
		 [Degree in target field of ed. 95] =
			case f.[8e Aloittaneista alkuperäisen opintoalan (1995) tutkinnon suorittaneet opintoalan mukaan]
				when ''Kyllä'' then ''Yes''
				when ''Ei'' then ''No''
				when ''Virhetilanne'' then ''Missing data''
			end, 
		--koodit
		d7.koulutusaste2002_Koodi AS [Koodit Tavoitetutk. koulutusaste 2002], 
		d7.koulutusala2002_Koodi AS [Koodit Tavoitetutk. koul.ala 2002], 
		d7.opintoala1995_Koodi AS [Koodit Tavoitetutk. koul.ala 1995], 
		d7.opintoala2002_Koodi AS [Koodit Tavoitetutk. opintoala 2002], 
		d7.koulutus_Koodi AS [Koodit Tavoitetutk. koulutusnimike], 
		d8.koulutusaste2002_Koodi AS [Koodit Suor. tutkinnon koulutusaste 2002], 
		d8.koulutusala2002_Koodi AS [Koodit Suor. tutkinnon koul.ala 2002], 
		d8.opintoala1995_Koodi AS [Koodit Suor. tutkinnon koul.ala 1995], 
		d8.opintoala2002_Koodi AS [Koodit Suor. tutkinnon opintoala 2002], 
		d8.koulutus_Koodi AS [Koodit Suor. tutkinnon koulutusnimike], 
		d9.koulutusaste2002_Koodi AS [Koodit Pohjakoul. koulutusaste 2002], 
		d9.koulutusala2002_Koodi AS [Koodit Pohjakoul. koul.ala 2002], 
		d9.opintoala1995_Koodi AS [Koodit Pohjakoul. koul.ala 1995], 
		d9.opintoala2002_Koodi AS [Koodit Pohjakoul. opintoala 2002], 
		d9.koulutus_Koodi AS [Koodit Pohjakoul. koulutusnimike], 
		d3.maakunta_Koodi AS [Koodit Tavoitetutk. maakunta], 
		d4.maakunta_Koodi AS [Koodit Suor. tutkinnon maakunta], 
		d13.oppilaitoskoodi AS [Koodit Tavoitetutk. yliopisto], 
		d13.koulutuksen_jarjestajakoodi AS [Koodit Tavoitetutk. koul. järjestäjä],
		d14.oppilaitoskoodi AS [Koodit Suor. tutkinnon yliopisto], 
		d1.jarjestys AS lukukausi_jarjestys, 
		d17.jarjestys AS tarkastelujakso_jarjestys, 
		d16.jarjestys AS sukupuoli_jarjestys, 
		d2.jarjestys AS aidinkieli_jarjestys, 
		d5.jarjestys_ika, 
		d5.jarjestys_ika5v, 
		d6.jarjestys_koulutuslaji2 AS koulutuslaji_jarjestys, 
		d7.jarjestys_koulutusaste2002, 
		d7.jarjestys_koulutusala2002, 
		d7.jarjestys_opintoala1995 AS jarjestys_koulutusala1995, 
		d7.jarjestys_opintoala2002 AS jarjestys_opintoala, 
		d7.jarjestys AS jarjestys_koulutusnimike, 
		d8.jarjestys_koulutusaste2002 AS jarjestys_suor_koulutusaste2002, 
		d8.jarjestys_koulutusala2002 AS jarjestys_suor_koulutusala2002, 
		d8.jarjestys_opintoala1995 AS jarjestys_suor_koulutusala1995, 
		d8.jarjestys_opintoala2002 AS jarjestys_suor_opintoala, 
		d8.jarjestys AS jarjestys_suor_koulutusnimike, 
		d9.jarjestys_koulutusaste2002 AS jarjestys_pohj_koulutusaste2002, 
		d9.jarjestys_koulutusala2002 AS jarjestys_pohj_koulutusala2002, 
		d9.jarjestys_opintoala1995 AS jarjestys_pohj_koulutusala1995, 
		d9.jarjestys_opintoala2002 AS jarjestys_pohj_opintoala, 
		d9.jarjestys AS jarjestys_pohj_koulutusnimike, 
		d3.jarjestys_maakunta, 
		d4.jarjestys_maakunta AS saavutettu_al_jarjestys_maakunta, 
		d12.jarjestys AS opiskelijan_olo_jarjestys, 
		d13.jarjestys_oppilaitos, 
		d13.jarjestys_oppilaitostyyppi, 
		d13.jarjestys_omistajatyyppi, 
		d14.jarjestys_oppilaitos AS saavutettu_jarjestys_oppilaitos, 
		d14.jarjestys_oppilaitostyyppi AS saavutettu_jarjestys_oppilaitostyyppi, 
		d14.jarjestys_omistajatyyppi AS saavutettu_jarjestys_omistajatyyppi, 
		f.[1a_jarjestys], f.[1b_jarjestys], f.[1c_jarjestys], 
		f.[1d_jarjestys], f.[1e_jarjestys], f.[1f_jarjestys], f.[1g_jarjestys], f.[1h_jarjestys], 
		f.[2a_jarjestys], f.[2b_jarjestys], f.[2e_jarjestys], f.[2f_jarjestys], f.[2g_jarjestys], 
		f.[2h_jarjestys], f.[3a_jarjestys], f.[3b_jarjestys], f.[3e_jarjestys], f.[3f_jarjestys], 
		f.[3g_jarjestys], f.[3h_jarjestys], f.[4a_jarjestys], f.[4b_jarjestys], f.[4e_jarjestys], 
		f.[4f_jarjestys], f.[4g_jarjestys], f.[4h_jarjestys], f.[5a_jarjestys], f.[5b_jarjestys], 
		f.[5e_jarjestys], f.[5f_jarjestys], f.[5g_jarjestys], f.[5h_jarjestys], f.[6a_jarjestys], 
		f.[6b_jarjestys], f.[6e_jarjestys], f.[6f_jarjestys], f.[6g_jarjestys], f.[6h_jarjestys], 
		f.[7a_jarjestys], f.[7b_jarjestys], f.[7e_jarjestys], f.[7f_jarjestys], f.[7g_jarjestys], 
		f.[7h_jarjestys], f.[8a_jarjestys], f.[8b_jarjestys], f.[8e_jarjestys], f.[8f_jarjestys], 
		f.[8g_jarjestys], f.[8h_jarjestys], 
		d10.lahde_koodi, 
		d6.koulutuslaji2_koodi
		--isced
		,d7.iscle2011 as "Tavoitetutk. koul.aste 1"
		,d7.Koulutusaste_taso2 as "Tavoitetutk. koul.aste 2"
		,d7.iscfibroad2013 as "Tavoitetutk. koul.ala 1"
		,d7.iscfinarrow2013 as "Tavoitetutk. koul.ala 2"
		,d7.iscfi2013 as "Tavoitetutk. koul.ala 3"
		,d7.OKM_ohjauksen_ala as "Tavoitetutk. OKM ohj. ala kk"
		,d7.iscle2011_SV as "Målexamens utbildn.nivå 1"
		,d7.Koulutusaste_taso2_SV as "Målexamens utbildn.nivå 2"
		,d7.iscfibroad2013_SV as "Målexamens utbildn.omr. 1"
		,d7.iscfinarrow2013_SV as "Målexamens utbildn.omr. 2"
		,d7.iscfi2013_SV as "Målexamens utbildn.omr. 3"
		,d7.OKM_ohjauksen_ala_SV as "Målexamens UKM-styrn.omr. hs"
		,d7.iscle2011_EN as "Target level of ed. 1"
		,d7.Koulutusaste_taso2_EN as "Target level of ed. 2"
		,d7.iscfibroad2013_EN as "Target field of ed. 1"
		,d7.iscfinarrow2013_EN as "Target field of ed. 2"
		,d7.iscfi2013_EN as "Target field of ed. 3"
		,d7.OKM_ohjauksen_ala_EN as "Target field of ed. HE ste."
		,d7.jarjestys_iscle2011 as jarj_isced_koulast1
		,d7.jarjestys_Koulutusaste_taso2 as jarj_isced_koulast2
		,d7.jarjestys_iscfibroad2013 as jarj_isced_koulala1
		,d7.jarjestys_iscfinarrow2013 as jarj_isced_koulala2
		,d7.jarjestys_iscfi2013 as jarj_isced_koulala3
		,d7.jarjestys_OKM_ohjauksen_ala as jarj_isced_okmohjaus1
		,d7.iscle2011_koodi as "Koodit Tavoitetutk. koul.aste 1"
		,d7.Koulutusaste_taso2_koodi as "Koodit Tavoitetutk. koul.aste 2"
		,d7.iscfibroad2013_koodi as "Koodit Tavoitetutk. koul.ala 1"
		,d7.iscfinarrow2013_koodi as "Koodit Tavoitetutk. koul.ala 2"
		,d7.iscfi2013_koodi as "Koodit Tavoitetutk. koul.ala 3"
		,d7.OKM_ohjauksen_ala_koodi as "Koodit Tavoitetutk. OKM ohjauksen ala kk"
		,d8.iscle2011 as "Suor. tutk. koul.aste 1"
		,d8.Koulutusaste_taso2 as "Suor. tutk. koul.aste 2"
		,d8.iscfibroad2013 as "Suor. tutk. koul.ala 1"
		,d8.iscfinarrow2013 as "Suor. tutk. koul.ala 2"
		,d8.iscfi2013 as "Suor. tutk. koul.ala 3"
		,d8.OKM_ohjauksen_ala as "Suor. tutk. OKM ohj. ala kk"
		,d8.iscle2011_SV as "Examens utbildn.nivå 1"
		,d8.Koulutusaste_taso2_SV as "Examens utbildn.nivå 2"
		,d8.iscfibroad2013_SV as "Examens utbildn.omr. 1"
		,d8.iscfinarrow2013_SV as "Examens utbildn.omr. 2"
		,d8.iscfi2013_SV as "Examens utbildn.omr. 3"
		,d8.OKM_ohjauksen_ala_SV as "Examens UKM-styrn.omr. hs"
		,d8.iscle2011_EN as "Degree''s level of ed. 1"
		,d8.Koulutusaste_taso2_EN as "Degree''s level of ed. 2"
		,d8.iscfibroad2013_EN as "Degree''s field of ed. 1"
		,d8.iscfinarrow2013_EN as "Degree''s field of ed. 2"
		,d8.iscfi2013_EN as "Degree''s field of ed. 3"
		,d8.OKM_ohjauksen_ala_EN as "Degree''s field of ed. HE ste."
		,d8.jarjestys_iscle2011 as jarj_isced2_koulast1
		,d8.jarjestys_Koulutusaste_taso2 as jarj_isced2_koulast2
		,d8.jarjestys_iscfibroad2013 as jarj_isced2_koulala1
		,d8.jarjestys_iscfinarrow2013 as jarj_isced2_koulala2
		,d8.jarjestys_iscfi2013 as jarj_isced2_koulala3
		,d8.jarjestys_OKM_ohjauksen_ala as jarj_isced2_okmohjaus1
		,d8.iscle2011_koodi as "Koodit Suor. tutk. koul.aste 1"
		,d8.Koulutusaste_taso2_koodi as "Koodit Suor. tutk. koul.aste 2"
		,d8.iscfibroad2013_koodi as "Koodit Suor. tutk. koul.ala 1"
		,d8.iscfinarrow2013_koodi as "Koodit Suor. tutk. koul.ala 2"
		,d8.iscfi2013_koodi as "Koodit Suor. tutk. koul.ala 3"
		,d8.OKM_ohjauksen_ala_koodi as "Koodit Suor. tutk. OKM ohjauksen ala kk"
		,d9.iscle2011 as "Pohjakoul. koul.aste 1"
		,d9.Koulutusaste_taso2 as "Pohjakoul. koul.aste 2"
		,d9.iscfibroad2013 as "Pohjakoul. koul.ala 1"
		,d9.iscfinarrow2013 as "Pohjakoul. koul.ala 2"
		,d9.iscfi2013 as "Pohjakoul. koul.ala 3"
		,d9.OKM_ohjauksen_ala as "Pohjakoul. OKM ohj. ala kk"
		,d9.iscle2011_SV as "Grundutb. utbildn.nivå 1"
		,d9.Koulutusaste_taso2_SV as "Grundutb. utbildn.nivå 2"
		,d9.iscfibroad2013_SV as "Grundutb. utbildn.omr. 1"
		,d9.iscfinarrow2013_SV as "Grundutb. utbildn.omr. 2"
		,d9.iscfi2013_SV as "Grundutb. utbildn.omr. 3"
		,d9.OKM_ohjauksen_ala_SV as "Grundutb. UKM-styrn.omr. hs"
		,d9.iscle2011_EN as "Previous deg. level of ed. 1"
		,d9.Koulutusaste_taso2_EN as "Previous deg. level of ed. 2"
		,d9.iscfibroad2013_EN as "Previous deg. field of ed. 1"
		,d9.iscfinarrow2013_EN as "Previous deg. field of ed. 2"
		,d9.iscfi2013_EN as "Previous deg. field of ed. 3"
		,d9.OKM_ohjauksen_ala_EN as "Previous deg. field of ed. HE ste."
		,d9.jarjestys_iscle2011 as jarj_isced3_koulast1
		,d9.jarjestys_Koulutusaste_taso2 as jarj_isced3_koulast2
		,d9.jarjestys_iscfibroad2013 as jarj_isced3_koulala1
		,d9.jarjestys_iscfinarrow2013 as jarj_isced3_koulala2
		,d9.jarjestys_iscfi2013 as jarj_isced3_koulala3
		,d9.jarjestys_OKM_ohjauksen_ala as jarj_isced3_okmohjaus1
		,d9.iscle2011_koodi as "Koodit Pohjakoul. koul.aste 1"
		,d9.Koulutusaste_taso2_koodi as "Koodit Pohjakoul. koul.aste 2"
		,d9.iscfibroad2013_koodi as "Koodit Pohjakoul. koul.ala 1"
		,d9.iscfinarrow2013_koodi as "Koodit Pohjakoul. koul.ala 2"
		,d9.iscfi2013_koodi as "Koodit Pohjakoul. koul.ala 3"
		,d9.OKM_ohjauksen_ala_koodi as "Koodit Pohjakoul. OKM ohjauksen ala kk"
FROM     dbo.f_aloittaneiden_lapaisy f INNER JOIN
			dbo.d_kausi AS d1 ON d1.kausi_id = f.aloituskausikoodi INNER JOIN
			dbo.d_aidinkieli_versio1 AS d2 ON d2.id = f.aikielir1_id INNER JOIN
			dbo.d_sukupuoli AS d16 ON d16.id = f.sp_id INNER JOIN
			dbo.d_tarkastelujakso AS d17 ON d17.id = f.tarkastelujakso_id INNER JOIN
			dbo.d_alueluokitus AS d3 ON d3.id = f.alueluokitus_id INNER JOIN
			dbo.d_alueluokitus AS d4 ON d4.id = f.saavutettu_alueluokitus_id INNER JOIN
			dbo.d_ika AS d5 ON d5.id = f.ika_id INNER JOIN
			dbo.d_koulutuslaji2 AS d6 ON d6.id = f.koulutuslaji2_id INNER JOIN
			dbo.d_koulutusluokitus AS d7 ON d7.id = f.koulk_id INNER JOIN
			dbo.d_koulutusluokitus AS d8 ON d8.id = f.saavutettu_koulk_id INNER JOIN
			dbo.d_koulutusluokitus AS d9 ON d9.id = f.pohjkoulk_id INNER JOIN
			dbo.d_lahde AS d10 ON d10.id = f.lahde_id INNER JOIN
			dbo.d_opiskelijan_olo AS d12 ON d12.id = f.ololk_id INNER JOIN
			dbo.d_oppilaitoksen_taustatiedot AS d13 ON d13.id = f.oppilaitoksen_taustatiedot_id INNER JOIN
			dbo.d_oppilaitoksen_taustatiedot AS d14 ON d14.id = f.saavutettu_oppilaitoksen_taustatiedot_id
WHERE        (f.aineistokoodi = ''K3.10'') AND (d10.lahde_koodi = 51) AND (d17.tarkastelujakso <> ''0,5 vuotta'') AND (d1.lukuvuosi <> ''1999/2000'') AND (d1.lukuvuosi <> ''2000/2001'') AND (d6.koulutuslaji2_koodi <> ''52'') AND 
                         (f.[1a Aloittaneiden opintojen kulku koulutuslajin mukaan prioriteettina mikä tahansa tutkinto] <> ''Virhetilanne'')















' 
GO
/****** Object:  View [dbo].[v_f_aloittaneiden_lapaisy_K3_9_ammatillinen]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_aloittaneiden_lapaisy_K3_9_ammatillinen]'))
EXEC dbo.sp_executesql @statement = N'





























CREATE VIEW [dbo].[v_f_aloittaneiden_lapaisy_K3_9_ammatillinen]
AS
SELECT 
		f.lkm_int AS lkm_int2, 
		d1.lukuvuosi AS Aloituslukuvuosi, 
		d1.vuosiselite AS Aloitusvuosi, 
		d1.lukukausiselite AS Aloituslukukausi, 
		d17.tarkastelujakso AS Tarkastelujakso, 		
		--d11.opetushallinnon_koulutus AS Hallinnonala, 
		d18.hallinnonala AS Hallinnonala, 
		d16.sukupuoli AS Sukupuoli, 
		d2.aidinkieli_versio1 AS Äidinkieli, 
		d5.ika AS Ikä, 
		d5.ika5v AS Ikäryhmä, 
		d6.koulutuslaji2 AS [Tavoitetutk. koulutuslaji], -- nimetty koulutuslajiksi raportilla
		d6.jarjestamistapa AS [Tavoitetutk. järjestämistapa],
		d6.jarjestamismuoto AS [Tavoitetutk. järjestämismuoto],
		d6.tutkintotyyppi AS [Tavoitetutk. tutkintotyyppi],
		d7.koulutusaste2002 AS [Tavoitetutk. koulutusaste], 
		d7.koulutusala2002 AS [Tavoitetutk. koulutusala], 		
		d7.opintoala2002 AS [Tavoitetutk. opintoala], 
		d7.koulutus AS [Tavoitetutk. koulutusnimike], 
		d8.koulutusaste2002 AS [Suor. tutkinnon koulutusaste], 
		d8.koulutusala2002 AS [Suor. tutkinnon koulutusala], 		
		d8.opintoala2002 AS [Suor. tutkinnon opintoala], 
		d8.koulutus AS [Suor. tutkinnon koulutusnimike], 
		d9.koulutusaste2002 AS [Pohjakoul. koulutusaste], 
		d9.koulutusala2002 AS [Pohjakoul. koulutusala], 		
		d9.opintoala2002 AS [Pohjakoul. opintoala], 
		d9.koulutus AS [Pohjakoul. koulutusnimike], 
		d3.kunta AS [Tavoitetutk. kunta], 
		d3.maakunta AS [Tavoitetutk. maakunta], 
		d3.avi AS [Tavoitetutk. AVI], 		
		d3.ely AS [Tavoitetutk. ELY], 
		d3.seutukunta AS [Tavoitetutk. seutukunta], 
		d3.suuralue AS [Tavoitetutk. suuralue], 
		d3.kuntaryhma AS [Tavoitetutk. kuntaryhmä], 
		d3.laani AS [Tavoitetutk. lääni], 		
		d3.tyovoima_elinkeinokeskus AS [Tavoitetutk. työvoima ja elinkeinokeskus], 
		d3.kielisuhde AS [Tavoitetutk. kunnan kielisuhde], 
		d4.kunta AS [Suor. tutkinnon kunta], 
		d4.maakunta AS [Suor. tutkinnon maakunta], 		
		d4.avi AS [Suor. tutkinnon AVI], 
		d4.ely AS [Suor. tutkinnon ELY], 
		d4.seutukunta AS [Suor. tutkinnon seutukunta], 
		d4.suuralue AS [Suor. tutkinnon suuralue], 
		d4.kuntaryhma AS [Suor. tutkinnon kuntaryhmä], 		
		d4.laani AS [Suor. tutkinnon lääni], 
		d4.tyovoima_elinkeinokeskus AS [Suor. tutkinnon työvoima ja elinkeinokeskus], 
		d4.kielisuhde AS [Suor. tutkinnon kunnan kielisuhde], 
		d12.opiskelijan_olo AS Kirjoillaolo, 		
		d15.rahoituslahde AS [Tavoitetutk. rahoituslähde], 
		d13.oppilaitos AS [Tavoitetutk. oppilaitos], 
		d13.oppilaitostyyppi AS [Tavoitetutk. oppil.tyyppi], 		
		d13.oppilaitoksen_omistajatyyppi AS [Tavoitetutk. oppil. omistajatyyppi], 
		d13.opetuskieli AS [Tavoitetutk. oppil. opetuskieli], 
		d13.koulutuksen_jarjestaja AS [Tavoitetutk. koul. järjestäjä], 		
		d13.koulutuksen_jarjestajan_omistajatyyppi AS [Tavoitetutk. koul. järjestäjän omistajatyyppi], 
		d13.koulutuksen_jarjestajan_kieli AS [Tavoitetutk. koul. järjestäjän kieli], 		
		d14.oppilaitos AS [Suor. tutkinnon oppilaitos], 
		d14.oppilaitostyyppi AS [Suor. tutkinnon oppil.tyyppi], 
		d14.oppilaitoksen_omistajatyyppi AS [Suor. tutkinnon oppil. omistajatyyppi], 		
		d14.opetuskieli AS [Suor. tutkinnon oppil. opetuskieli], 
		d14.koulutuksen_jarjestaja AS [Suor. tutkinnon koul. järjestäjä], 		
		d14.koulutuksen_jarjestajan_omistajatyyppi AS [Suor. tutkinnon koul. järjestäjän omistajatyyppi], 
		d14.koulutuksen_jarjestajan_kieli AS [Suor. tutkinnon koul. järjestäjän kieli], 		
		f.[1a Aloittaneiden opintojen kulku koulutuslajin mukaan prioriteettina mikä tahansa tutkinto] AS [Opintojen kulku], 		
		f.[1b Aloittaneiden opintojen kulku koulutuslajin mukaan prioriteettina tutkinto ja opiskelu alkuperäisessä tutkintolajissa] AS [Opintojen kulku prioriteetti 2], 		
		f.[1c Aloittaneista tutkinnon suorittaneet koulutuslajin mukaan] AS [Suoritettu tutkinto], 
		f.[1d Aloittaneista ilman tutkintoa opiskelua jatkavat koulutuslajin mukaan] AS [Opiskelua jatkavat tutk.lajin mukaan], 		
		f.[1e Aloittaneista alkuperäisen koulutuslajin tutkinnon suorittaneet koulutuslajin mukaan] AS [Tutkinto tavoitet. tutkintolajissa], 		
		f.[1f Aloittaneista muun kuin alkuperäisen tutkintolajin tutkinnon suorittaneet koulutuslajin mukaan] AS [Tutkinto muussa tutkintolajissa], 		
		f.[1g Aloittaneista alkuperäisen tutkintolajin opiskelua jatkavat koulutuslajin mukaan] AS [Opiskelee tavoitet. tutkintolajissa], 		
		f.[1h Aloittaneista muun tutkintolajin opiskelua jatkavat koulutuslajin mukaan] AS [Opiskelee muussa tutkintolajissa], 		
		f.[2a Aloittaneiden opintojen kulku koulutusalan (2002) mukaan prioriteettina mikä tahansa tutkinto] AS [Opintojen kulku koulutusaloittain],
		f.[2b Aloittaneiden opintojen kulku koulutusalan (2002) mukaan prioriteettina tutkinto ja opiskelu alkuperäisellä] AS [Opintojen kulku koulutusaloittain prioriteetti 2], 		
		f.[2e Aloittaneista alkuperäisen koulutusalan (2002) tutkinnon suorittaneet koulutusalan mukaan] AS [Tutkinto tavoitet. koulutusalalla], 		
		f.[2f Aloittaneista muun kuin alkuperäisen tutkintolajin tutkinnon suorittaneet koulutuslajin mukaan] AS [Tutkinto muulla koulutusalalla], 		
		f.[2g Aloittaneista alkuperäisellä koulutusalalla opiskelua jatkavat koulutusalan mukaan] AS [Opiskelee tavoitet. koulutusalalla], 		
		f.[2h Aloittaneista muulla koulutusalalla opiskelua jatkavat koulutusalan mukaan] AS [Opiskelee muulla koulutusalalla], 		
		f.[3a Aloittaneiden opintojen kulku opintoalan (2002) mukaan prioriteettina mikä tahansa tutkinto] AS [Opintojen kulku opintoaloittain], 		
		f.[3b Aloittaneiden opintojen kulku opintoalan (2002) mukaan prioriteettina tutkinto ja opiskelu alkuperäisellä] AS [Opintojen kulku opintoaloittain prioriteetti 2], 		
		f.[3e Aloittaneista alkuperäisen opintoalan (2002) tutkinnon suorittaneet opintoalan mukaan] AS [Tutkinto tavoitet. opintoalalla], 		
		f.[3f Aloittaneista muun opintoalan (2002) tutkinnon suorittaneet opintoalan mukaan] AS [Tutkinto muulla opintoalalla], 		
		f.[3g Aloittaneista alkuperäisellä opintoalalla (2002) opiskelua jatkavat opintoalan mukaan] AS [Opiskelee tavoitet. opintoalalla], 		
		f.[3h Aloittaneista muulla opintoalalla (2002) opiskelua jatkavat opintoalan mukaan] AS [Opiskelee muulla opintoalalla], 		
		f.[4a Aloittaneiden opintojen kulku koulutuksen järjestäjän mukaan, toinen aste prioriteettina tutkinto missä tahansa] AS [Opintojen kulku koul. järjestäjittäin], 		
		f.[4b Aloittaneiden opintojen kulku koulutuksen järjestäjän mukaan, toinen aste prioriteettina tutkinto ja opiskelu alkuperäisellä] AS [Opintojen kulku koul. järjestäjittäin prioriteetti 2], 		
		f.[4e Aloittaneista alkuperäisen koulutuksen järjestäjän tutkinnon suorittaneet järjestäjän mukaan] AS [Tutkinto tavoitet. koul. järjestäjällä], 		
		f.[4f Aloittaneista muun koulutuksen järjestäjän tutkinnon suorittaneet järjestäjän mukaan] AS [Tutkinto muulla koul. järjestäjällä], 		
		f.[4g Aloittaneista alkuperäisellä järjestäjällä opiskelua jatkavat järjestäjän mukaan] AS [Opiskelee tavoitet. koul. järjestäjällä], 		
		f.[4h Aloittaneista muulla järjestäjällä opiskelua jatkavat järjestäjän mukaan] AS [Opiskelee muulla koul. järjestäjällä], 
		f.[5a Aloittaneiden opintojen kulku oppilaitoksen mukaan prioriteettina tutkinto missä tahansa] AS [Opintojen kulku oppilaitoksittain], 		
		f.[5b Aloittaneiden opintojen kulku oppilaitoksen mukaan prioriteettina tutkinto ja opiskelu alkuperäisessä] AS [Opintojen kulku oppilaitoksittain prioriteetti 2], 		
		f.[5e Aloittaneista alkuperäisessä oppilaitoksessa tutkinnon suorittaneet oppilaitoksen mukaan] AS [Tutkinto tavoitet. oppilaitoksessa], 		
		f.[5f Aloittaneista muussa oppilaitoksessa tutkinnon suorittaneet oppilaitoksen mukaan] AS [Tutkinto muussa oppilaitoksessa], 		
		f.[5g Aloittaneista alkuperäisessä oppilaitoksessa opiskelua jatkavat oppilaitoksen mukaan] AS [Opiskelee tavoitet. oppilaitoksessa], 		
		f.[5h Aloittaneista muussa oppilaitoksessa opiskelua jatkavat oppilaitoksen mukaan] AS [Opiskelee muussa oppilaitoksessa], 		
		f.[6a Aloittaneiden opintojen kulku maakunnan mukaan prioriteettina tutkinto missä tahansa] AS [Opintojen kulku maakunnittain], 		
		f.[6b Aloittaneiden opintojen kulku maakunnan mukaan prioriteettina tutkinto ja opiskelu alkuperäisessä] AS [Opintojen kulku maakunnittain prioriteetti 2], 		
		f.[6e Aloittaneista alkuperäisessä maakunnassa tutkinnon suorittaneet maakunnan mukaan] AS [Tutkinto tavoitet. maakunnassa], 		
		f.[6f Aloittaneista muussa maakunnassa tutkinnon suorittaneet maakunnan mukaan] AS [Tutkinto muussa maakunnassa], 		
		f.[6g Aloittaneista alkuperäisessä maakunnassa opiskelua jatkavat maakunnan mukaan] AS [Opiskelee tavoitet. maakunnassa], 		
		f.[6h Aloittaneista muussa maakunnassa opiskelua jatkavat maakunnan mukaan] AS [Opiskelee muussa maakunnassa], 		
		f.[7a Aloittaneiden opintojen kulku koulutussektorin mukaan prioriteettina tutkinto missä tahansa] AS [Opintojen kulku koul.sektoreittan], 		
		f.[7b Aloittaneiden opintojen kulku koulutussektorin mukaan prioriteettina tutkinto ja opiskelu alkuperäisellä] AS [Opintojen kulku koul.sektoreittan prioriteetti 2], 		
		f.[7e Aloittaneista alkuperäisen koulutussektorin tutkinnon suorittaneet koulutussektorin mukaan] AS [Tutkinto tavoitet. koulutussektorilla], 		
		f.[7f Aloittaneista muun koulutussektorin tutkinnon suorittaneet koulutussektorin mukaan] AS [Tutkinto muulla koulutussektorilla], 		
		f.[7g Aloittaneista alkuperäisellä koulutussektorilla opiskelua jatkavat koulutussektorin mukaan] AS [Opiskelee tavoitet. koulutussektorilla], 		
		f.[7h Aloittaneista muulla koulutussektorilla opiskelua jatkavat koulutussektorin mukaan] AS [Opiskelee muulla koulutussektorilla], 		
		f.[8a Aloittaneiden opintojen kulku opintoalan (1995) mukaan prioriteettina mikä tahansa tutkinto] AS [Opintojen kulku koul.aloittain (95)], 		
		f.[8b Aloittaneiden opintojen kulku opintoalan (1995) mukaan prioriteettina tutkinto ja opiskelu alkuperäisellä] AS [Opintojen kulku koul.aloittain (95) prioriteetti 2], 		
		f.[8e Aloittaneista alkuperäisen opintoalan (1995) tutkinnon suorittaneet opintoalan mukaan] AS [Tutkinto tavoitet. koulutusalalla (95)], 		
		f.[8f Aloittaneista muun opintoalan (1995) tutkinnon suorittaneet opintoalan mukaan] AS [Tutkinto muulla koulutusalalla (95)], 		
		f.[8g Aloittaneista alkuperäisellä opintoalalla (1995) opiskelua jatkavat opintoalan mukaan] AS [Opiskelee tavoitet. koulutusalalla (95)], 		
		f.[8h Aloittaneista muulla opintoalalla (1995) opiskelua jatkavat opintoalan mukaan] AS [Opiskelee muulla koulutusalalla (95)], 
		f.aloitus_saavutus AS [Aloitus saavutus], 		
		f.tarkastelujakso_tulevaisuus AS [Tarkastelujakson tulevaisuus], 
		f.tarkastelujakso_edustavuus AS [Tarkastelujakson edustavuus], 
		d10.lahde AS Lähde, 
		--ruotsi
		d1.lukuvuosi AS Begynnelseläsår, 
		d1.vuosiselite_SV AS Begynnelseår, 
		d1.lukukausiselite_SV AS Begynnelsetermin, 
		d17.tarkastelujakso_SV AS Granskningsperiod, 
		d16.sukupuoli_SV AS Kön, 
		--d11.opetushallinnon_koulutus_SV AS Förvaltningsområde, 
		d18.hallinnonala_SV  AS Förvaltningsområde, 
		d2.aidinkieli_versio1_SV AS Modersmål, 
		d5.ika_SV AS Ålder, 
		d5.ika5v_SV AS Åldersgrupp, 
		d6.koulutuslaji2_SV AS [Målexamens examensslag], 
		d6.koulutuslaji2_SV AS [Målexamens typ av utbildn.], 
		d6.jarjestamistapa_SV AS [Målexamens sättet],
		d6.jarjestamismuoto_SV AS [Målexamens formen],
		d6.tutkintotyyppi_SV AS [Målexamens typ],
		d7.koulutusaste2002_SV AS [Målexamens utbildn.nivå 2002], 
		d7.koulutusala2002_SV AS [Målexamens utbildn.område 02], 
		d7.opintoala2002_SV AS [Målexamens studieområde 02], 
		d7.koulutus_SV AS [Målexamens utbildn.benämning], 
		d8.koulutusaste2002_SV AS [Examens utbildn.nivå 2002], 
		d8.koulutusala2002_SV AS [Examens utbildn.område 2002], 
		d8.opintoala2002_SV AS [Examens studieområde 2002], 
		d8.koulutus_SV AS [Examens utbildn.benämning], 
		d9.koulutusaste2002_SV AS [Grundutb. utbildn.nivå 2002], 
		d9.koulutusala2002_SV AS [Grundutb. utbildn.område 2002], 
		d9.opintoala2002_SV AS [Grundutb. studieområde 2002], 
		d9.koulutus_SV AS [Grundutb. utbildn.benämning], 
		d3.maakunta_SV AS [Målexamens landskap], 
		d3.avi_SV AS [Målexamens RVF], 		
		d3.ely_SV AS [Målexamens NTM], 
		d3.kunta_SV AS [Målexamens kommun], 
		d4.maakunta_SV AS [Examens landskap], 
		d4.avi_SV AS [Examens RVF], 
		d4.ely_SV AS [Examens NTM], 
		d4.kunta_SV AS [Examens kommun], 
		d12.opiskelijan_olo_SV AS Inskrivning, 
		d13.koulutuksen_jarjestaja_SV AS [Målexamens utbildn.ordnare],
		d14.koulutuksen_jarjestaja_SV AS [Examens utbildn.ordnare], 
				[Studieförlopp] = 
			case f.[1a Aloittaneiden opintojen kulku koulutuslajin mukaan prioriteettina mikä tahansa tutkinto]
				when ''Tutkinto alkuperäisessä tutkintolajissa'' then ''Examen i det ursprungliga examensslaget''
				when ''Tutkinto muussa tutkintolajissa'' then ''Examen i annat examensslag''
				when ''Tutkinto muussa tutkintolajissa, kandidaatin tutkinto'' then ''Examen i annat examensslag, lägre högskoleexamen''
				when ''Opiskelee alkuperäisessä tutkintolajissa'' then ''Studerar i det ursprungliga examensslaget''
				when ''Opiskelee muussa tutkintolajissa'' then ''Studerar i annat examensslag''
				when ''Ei tutkintoa, ei opiskele, työllinen'' then ''Ingen examen, inte studerar, sysselsatt''
				when ''Ei tutkintoa, ei opiskele, ei työllinen'' then ''Ingen examen, inte studerar, arbetslös''
				else  ''Information saknas''
			end , 
		[Studieförlopp prior. 2] =
			case f.[1b Aloittaneiden opintojen kulku koulutuslajin mukaan prioriteettina tutkinto ja opiskelu alkuperäisessä tutkintolajissa]
				when ''Tutkinto alkuperäisessä tutkintolajissa'' then ''Examen i det ursprungliga examensslaget''
				when ''Tutkinto muussa tutkintolajissa'' then ''Examen i annat examensslag''
				when ''Tutkinto muussa tutkintolajissa, kandidaatin tutkinto'' then ''Examen i annat examensslag, lägre högskoleexamen''
				when ''Opiskelee alkuperäisessä tutkintolajissa'' then ''Studerar i det ursprungliga examensslaget''
				when ''Opiskelee muussa tutkintolajissa'' then ''Studerar i annat examensslag''
				when ''Ei tutkintoa, ei opiskele, työllinen'' then ''Ingen examen, inte studerar, sysselsatt''
				when ''Ei tutkintoa, ei opiskele, ei työllinen'' then ''Ingen examen, inte studerar, arbetslös''
				else ''Information saknas''
			end			, 
		[Avlagt examen] =
			case f.[1c Aloittaneista tutkinnon suorittaneet koulutuslajin mukaan]
				when ''Tutkinto lukiokoulutuksesta'' then ''Studentexamen''
				when ''Ammatillinen perustutkinto'' then ''Grundläggande yrkesexamen''
				when ''Ammatillinen lisäkoulutus ammattitutkinto tai erikoisammattitutkinto'' then ''Yrkesinriktad tilläggsutbildning, yrkesexamen eller specialyrkesexamen''
				when ''Muu korkein ja viimeisimmäksi suoritettu tutkinto, toinen aste'' then ''Övrig högsta och senast avlagd examen, andra stadiet''
				when ''Ammattikorkeakoulututkinto'' then ''Yrkeshögskoleexamen''
				when ''Alempi korkeakoulututkinto'' then ''Lägre högskoleexamen''
				when ''Ylempi ammattikorkeakoulututkinto'' then ''Högre yrkeshögskoleexamen''
				when ''Ylempi korkeakoulututkinto'' then ''Högre högskoleexamen''
				when ''Tutkijakoulutusasteen tutkinto'' then ''Examen på forskarutbildningsnivå''
				when ''Muu korkein ja viimeisimmäksi suoritettu tutkinto, korkeakoulututkinto'' then ''Övrig högsta och senast avlagd examen, högskoleexamen''
				when ''Ei tutkintoa'' then ''Ingen examen''
				when ''Virhetilanne'' then ''Information saknas''
			end, 
		[Examen i målex. examensslag] = 
			case f.[1e Aloittaneista alkuperäisen koulutuslajin tutkinnon suorittaneet koulutuslajin mukaan]
				when ''Kyllä'' then ''Ja''
				when ''Ei'' then ''Inte''
				when ''Virhetilanne'' then ''Information saknas''
			end
		, 
		[Examen i annat examensslag] = 
			case [1f Aloittaneista muun kuin alkuperäisen tutkintolajin tutkinnon suorittaneet koulutuslajin mukaan]
				when ''Kyllä'' then ''Ja''
				when ''Ei'' then ''Inte''
				when ''Virhetilanne'' then ''Information saknas''
			end	
			, 
		[Examen i målex. utbildn.område 02] =
			case [2e Aloittaneista alkuperäisen koulutusalan (2002) tutkinnon suorittaneet koulutusalan mukaan]
				when ''Kyllä'' then ''Ja''
				when ''Ei'' then ''Inte''
				when ''Virhetilanne'' then ''Information saknas''
			end	
		, 
		[Examen i målex. studieområde 02] = 
			case [3e Aloittaneista alkuperäisen opintoalan (2002) tutkinnon suorittaneet opintoalan mukaan]
				when ''Kyllä'' then ''Ja''
				when ''Ei'' then ''Inte''
				when ''Virhetilanne'' then ''Information saknas''
			end	
		, 
		[Examen i målex. läroanstalt] = 
			case [5e Aloittaneista alkuperäisessä oppilaitoksessa tutkinnon suorittaneet oppilaitoksen mukaan] 
				when ''Kyllä'' then ''Ja''
				when ''Ei'' then ''Inte''
				when ''Virhetilanne'' then ''Information saknas''
			end	
		, 
		[Examen i målex. utbildn.område 95] = 
			case [8e Aloittaneista alkuperäisen opintoalan (1995) tutkinnon suorittaneet opintoalan mukaan]
				when ''Kyllä'' then ''Ja''
				when ''Ei'' then ''Inte''
				when ''Virhetilanne'' then ''Information saknas''
			end	
		, 
		--englanti
		d1.lukuvuosi AS [First academic year], 
		d1.vuosiselite_EN AS [First year of studies], 
		d1.lukukausiselite_EN AS [First term], 
		d17.tarkastelujakso_EN AS [Reference period], 
		d16.sukupuoli_EN AS Gender, 
		--d11.opetushallinnon_koulutus_EN AS [Administrative sector], 
		d18.hallinnonala_EN AS [Administrative sector], 
		d2.aidinkieli_versio1_EN AS [Mother tongue], 
		d5.ika_EN AS Age, 
		d5.ika5v_EN AS [Age group], 
		d6.koulutuslaji2_EN AS [Target qualif. form of qual.], 
		d6.koulutuslaji2_EN AS [Target qualif. type of ed.], 
		d6.jarjestamistapa_EN AS [Target qualif. method],
		d6.jarjestamismuoto_EN AS [Target qualif. form],
		d6.tutkintotyyppi_EN AS [Target qualif. qual. type],
		d7.koulutusaste2002_EN AS [Target qual. level of ed. 02], 
		d7.koulutusala2002_EN AS [Target qual. field of ed. 02], 
		d7.opintoala2002_EN AS [Target qual. subfield of ed. 02], 
		d7.koulutus_EN AS [Target qual. name of ed.], 
		d8.koulutusaste2002_EN AS [Qualif. level of ed. 02], 
		d8.koulutusala2002_EN AS [Qualif. field of ed. 02], 
		d8.opintoala2002_EN AS [Qualif. subfield of ed. 02], 
		d8.koulutus_EN AS [Qualif. name of ed.], 
		d9.koulutusaste2002_EN AS [Previous qual. level of ed. 02], 
		d9.koulutusala2002_EN AS [Previous qual. field of ed. 02], 
		d9.opintoala2002_EN AS [Previous qual. subfield of ed. 02], 
		d9.koulutus_EN AS [Previous qual. name of ed.], 
		d3.maakunta_EN AS [Target qualif. region], 
		d3.avi_EN AS [Target qualif. AVI], 		
		d3.ely_EN AS [Target qualif. ELY], 
		d3.kunta_EN AS [Target qualif. municipal.], 
		d4.maakunta_EN AS [Qualifcation''s region], 
		d4.avi_EN AS [Qualifcation''s AVI], 
		d4.ely_EN AS [Qualifcation''s ELY], 
		d4.kunta_EN AS [Qualifcation''s municipality], 
		d12.opiskelijan_olo_EN AS [Enrollment status], 
		d13.koulutuksen_jarjestaja_EN AS [Target qual. ed. provider],
		d14.koulutuksen_jarjestaja_EN AS [Qualification''s ed. provider], 
		[Study progress] =
			case f.[1a Aloittaneiden opintojen kulku koulutuslajin mukaan prioriteettina mikä tahansa tutkinto]
				when ''Tutkinto alkuperäisessä tutkintolajissa'' then ''Qualification in the original form of degree''
				when ''Tutkinto muussa tutkintolajissa'' then ''Qualification in another form of degree''
				when ''Tutkinto muussa tutkintolajissa, kandidaatin tutkinto'' then ''Qualification in another form of degree, Bachelor''''s degree''
				when ''Opiskelee alkuperäisessä tutkintolajissa'' then ''Studying in the original form of degree''
				when ''Opiskelee muussa tutkintolajissa'' then ''Studying in another form of degree''
				when ''Ei tutkintoa, ei opiskele, työllinen'' then ''No qualification, not studying, employed''
				when ''Ei tutkintoa, ei opiskele, ei työllinen'' then ''No qualification, not studying, unemployed''
				else  ''Missing data''
			end ,
		[Study progress prior. 2] = 
			case f.[1b Aloittaneiden opintojen kulku koulutuslajin mukaan prioriteettina tutkinto ja opiskelu alkuperäisessä tutkintolajissa]
				when ''Tutkinto alkuperäisessä tutkintolajissa'' then ''Qualification in the original form of degree''
				when ''Tutkinto muussa tutkintolajissa'' then ''Qualification in another form of degree''
				when ''Tutkinto muussa tutkintolajissa, kandidaatin tutkinto'' then ''Qualification in another form of degree, Bachelor''''s degree''
				when ''Opiskelee alkuperäisessä tutkintolajissa'' then ''Studying in the original form of degree''
				when ''Opiskelee muussa tutkintolajissa'' then ''Studying in another form of degree''
				when ''Ei tutkintoa, ei opiskele, työllinen'' then ''No qualification, not studying, employed''
				when ''Ei tutkintoa, ei opiskele, ei työllinen'' then ''No qualification, not studying, unemployed''
				else  ''Missing data''
			end , 
		[Completed qualification] =
			case f.[1c Aloittaneista tutkinnon suorittaneet koulutuslajin mukaan]
				when ''Tutkinto lukiokoulutuksesta'' then ''Matriculation examination''
				when ''Ammatillinen perustutkinto'' then ''Vocational upper secondary qualification''
				when ''Ammatillinen lisäkoulutus ammattitutkinto tai erikoisammattitutkinto'' then ''Further vocational qualification or specialist vocational qualification''
				when ''Muu korkein ja viimeisimmäksi suoritettu tutkinto, toinen aste'' then ''Other highest and most recent degree, upper secondary education''
				when ''Ammattikorkeakoulututkinto'' then ''UAS degree''
				when ''Alempi korkeakoulututkinto'' then ''Bachelor''''s degree''
				when ''Ylempi ammattikorkeakoulututkinto'' then ''UAS Master''''s degree''
				when ''Ylempi korkeakoulututkinto'' then ''Master''''s degree''
				when ''Tutkijakoulutusasteen tutkinto'' then ''Research degree''
				when ''Muu korkein ja viimeisimmäksi suoritettu tutkinto, korkeakoulututkinto'' then ''Other highest and most recent degree, higher education''
				when ''Ei tutkintoa'' then ''No degree''
				when ''Virhetilanne'' then ''Missing data''
			end, 
		[Completed in target form of qual.] =
			case f.[1e Aloittaneista alkuperäisen koulutuslajin tutkinnon suorittaneet koulutuslajin mukaan]
				when ''Kyllä'' then ''Yes''
				when ''Ei'' then ''No''
				when ''Virhetilanne'' then ''Missing data''
			end, 
		[Completed in another form of qual.] =
			case f.[1f Aloittaneista muun kuin alkuperäisen tutkintolajin tutkinnon suorittaneet koulutuslajin mukaan]
				when ''Kyllä'' then ''Yes''
				when ''Ei'' then ''No''
				when ''Virhetilanne'' then ''Missing data''
			end, 
		 [Completed in target field of ed. 02] =
			case f.[2e Aloittaneista alkuperäisen koulutusalan (2002) tutkinnon suorittaneet koulutusalan mukaan]
				when ''Kyllä'' then ''Yes''
				when ''Ei'' then ''No''
				when ''Virhetilanne'' then ''Missing data''
			end, 
		[Completed in target subfield of ed. 02] =
			case f.[3e Aloittaneista alkuperäisen opintoalan (2002) tutkinnon suorittaneet opintoalan mukaan]
				when ''Kyllä'' then ''Yes''
				when ''Ei'' then ''No''
				when ''Virhetilanne'' then ''Missing data''
			end, 
		 [Completed in target ed. institution] =
			case f.[5e Aloittaneista alkuperäisessä oppilaitoksessa tutkinnon suorittaneet oppilaitoksen mukaan]
				when ''Kyllä'' then ''Yes''
				when ''Ei'' then ''No''
				when ''Virhetilanne'' then ''Missing data''
			end, 
		 [Completed in target field of ed. 95] =
			case f.[8e Aloittaneista alkuperäisen opintoalan (1995) tutkinnon suorittaneet opintoalan mukaan]
				when ''Kyllä'' then ''Yes''
				when ''Ei'' then ''No''
				when ''Virhetilanne'' then ''Missing data''
			end, 
		--koodit
		d7.koulutusaste2002_Koodi AS [Koodit Tavoitetutk. koulutusaste 2002], 
		d7.koulutusala2002_Koodi AS [Koodit Tavoitetutk. koul.ala 2002], 
		d7.opintoala2002_Koodi AS [Koodit Tavoitetutk. opintoala 2002], 
		d7.koulutus_Koodi AS [Koodit Tavoitetutk. koulutusnimike], 
		d8.koulutusaste2002_Koodi AS [Koodit Suor. tutkinnon koulutusaste 2002], 
		d8.koulutusala2002_Koodi AS [Koodit Suor. tutkinnon koul.ala 2002], 
		d8.opintoala2002_Koodi AS [Koodit Suor. tutkinnon opintoala 2002], 
		d8.koulutus_Koodi AS [Koodit Suor. tutkinnon koulutusnimike], 
		d9.koulutusaste2002_Koodi AS [Koodit Pohjakoul. koulutusaste 2002], 
		d9.koulutusala2002_Koodi AS [Koodit Pohjakoul. koul.ala 2002], 
		d9.opintoala2002_Koodi AS [Koodit Pohjakoul. opintoala 2002], 
		d9.koulutus_Koodi AS [Koodit Pohjakoul. koulutusnimike], 
		d3.maakunta_Koodi AS [Koodit Tavoitetutk. maakunta], 
		d4.maakunta_Koodi AS [Koodit Suor. tutkinnon maakunta], 
		d13.koulutuksen_jarjestajakoodi AS [Koodit Tavoitetutk. koul. järjestäjä],
		--jarjestys
		d1.jarjestys AS lukukausi_jarjestys, 		
		d17.jarjestys AS tarkastelujakso_jarjestys, 
		--d11.jarjestys AS opetushallinnon_koulutus_jarjestys, 
		d18.jarjestys AS opetushallinnon_koulutus_jarjestys, 
		d16.jarjestys AS sukupuoli_jarjestys, 
		d2.jarjestys AS aidinkieli_jarjestys, 
		d5.jarjestys_ika, 
		d5.jarjestys_ika5v, 		
		d6.jarjestys_koulutuslaji2 AS koulutuslaji_jarjestys,
		d6.jarjestys_jarjestamistapa,
		d6.jarjestys_jarjestamismuoto,
		d6.jarjestys_tutkintotyyppi,
		d7.jarjestys_koulutusaste2002, 
		d7.jarjestys_koulutusala2002, 
		d7.jarjestys_opintoala2002 AS jarjestys_opintoala, 
		d7.jarjestys AS jarjestys_koulutusnimike, 		
		d8.jarjestys_koulutusaste2002 AS jarjestys_suor_koulutusaste2002, 
		d8.jarjestys_koulutusala2002 AS jarjestys_suor_koulutusala2002, 
		d8.jarjestys_opintoala2002 AS jarjestys_suor_opintoala, 		
		d8.jarjestys AS jarjestys_suor_koulutusnimike, 
		d9.jarjestys_koulutusaste2002 AS jarjestys_pohj_koulutusaste2002, 
		d9.jarjestys_koulutusala2002 AS jarjestys_pohj_koulutusala2002, 		
		d9.jarjestys_opintoala2002 AS jarjestys_pohj_opintoala, 
		d9.jarjestys AS jarjestys_pohj_koulutusnimike, 
		d3.jarjestys AS alueluokitus_jarjestys, 
		d3.jarjestys_maakunta, 
		d3.jarjestys_avi, 
		d3.jarjestys_ely, 		
		d3.jarjestys_seutukunta, 
		d3.jarjestys_suuralue, 
		d3.jarjestys_kuntaryhma, 
		d3.jarjestys_laani, 
		d3.jarjestys_tyovoima_elinkeinokeskus, 
		d3.jarjestys_kielisuhde, 
		d4.jarjestys AS saavutettu_al_jarjestys, 		
		d4.jarjestys_maakunta AS saavutettu_al_jarjestys_maakunta, 
		d4.jarjestys_avi AS saavutettu_al_jarjestys_avi, 
		d4.jarjestys_ely AS saavutettu_al_jarjestys_ely, 		
		d4.jarjestys_seutukunta AS saavutettu_al_jarjestys_seutukunta, 
		d4.jarjestys_suuralue AS saavutettu_al_jarjestys_suuralue, 
		d4.jarjestys_kuntaryhma AS saavutettu_al_jarjestys_kuntaryhma, 		
		d4.jarjestys_laani AS saavutettu_al_jarjestys_laani, 
		d4.jarjestys_tyovoima_elinkeinokeskus AS saavutettu_al_jarjestys_tyovoima_elinkeinokeskus, 		
		d4.jarjestys_kielisuhde AS saavutettu_al_jarjestys_kielisuhde, 
		d12.jarjestys AS opiskelijan_olo_jarjestys, 
		d15.jarjestys AS rahoituslahde_jarjestys, 
		d13.jarjestys_oppilaitos, 
		d13.jarjestys_oppilaitostyyppi, 		
		d13.jarjestys_omistajatyyppi, 
		d13.jarjestys_opetuskieli, 
		d13.jarjestys_koulutuksen_jarjestaja, 
		d13.jarjestys_koulutuksenjarjestaja, 
		d13.jarjestys_koulutuksen_jarjestajan_kieli, 		
		d14.jarjestys_oppilaitos AS saavutettu_jarjestys_oppilaitos, 
		d14.jarjestys_oppilaitostyyppi AS saavutettu_jarjestys_oppilaitostyyppi, 
		d14.jarjestys_omistajatyyppi AS saavutettu_jarjestys_omistajatyyppi, 		
		d14.jarjestys_opetuskieli AS saavutettu_jarjestys_opetuskieli, 
		d14.jarjestys_koulutuksen_jarjestaja AS saavutettu_jarjestys_koulutuksen_jarjestaja, 		
		d14.jarjestys_koulutuksenjarjestaja AS saavutettu_jarjestys_koulutuksenjarjestaja, 
		d14.jarjestys_koulutuksen_jarjestajan_kieli AS saavutettu_jarjestys_koulutuksen_jarjestajan_kieli, 
		f.[1a_jarjestys], 
		f.[1b_jarjestys], f.[1c_jarjestys], f.[1d_jarjestys], f.[1e_jarjestys], f.[1f_jarjestys], f.[1g_jarjestys], f.[1h_jarjestys], f.[2a_jarjestys], f.[2b_jarjestys], f.[2e_jarjestys], f.[2f_jarjestys], f.[2g_jarjestys], f.[2h_jarjestys], 
		f.[3a_jarjestys], f.[3b_jarjestys], f.[3e_jarjestys], f.[3f_jarjestys], f.[3g_jarjestys], f.[3h_jarjestys], f.[4a_jarjestys], f.[4b_jarjestys], f.[4e_jarjestys], f.[4f_jarjestys], f.[4g_jarjestys], f.[4h_jarjestys], f.[5a_jarjestys], 
		f.[5b_jarjestys], f.[5e_jarjestys], f.[5f_jarjestys], f.[5g_jarjestys], f.[5h_jarjestys], f.[6a_jarjestys], f.[6b_jarjestys], f.[6e_jarjestys], f.[6f_jarjestys], f.[6g_jarjestys], f.[6h_jarjestys], f.[7a_jarjestys], f.[7b_jarjestys], 
		f.[7e_jarjestys], f.[7f_jarjestys], f.[7g_jarjestys], f.[7h_jarjestys], f.[8a_jarjestys], f.[8b_jarjestys], f.[8e_jarjestys], f.[8f_jarjestys], f.[8g_jarjestys], f.[8h_jarjestys], 
		d10.lahde_koodi, 
		d6.koulutuslaji2_koodi
		--isced
		,d7.iscle2011 as "Tavoitetutk. koul.aste 1"
		,d7.Koulutusaste_taso2 as "Tavoitetutk. koul.aste 2"
		,d7.iscfibroad2013 as "Tavoitetutk. koul.ala 1"
		,d7.iscfinarrow2013 as "Tavoitetutk. koul.ala 2"
		,d7.iscfi2013 as "Tavoitetutk. koul.ala 3"
		,d7.iscle2011_SV as "Målexamens utbildn.nivå 1"
		,d7.Koulutusaste_taso2_SV as "Målexamens utbildn.nivå 2"
		,d7.iscfibroad2013_SV as "Målexamens utbildn.omr. 1"
		,d7.iscfinarrow2013_SV as "Målexamens utbildn.omr. 2"
		,d7.iscfi2013_SV as "Målexamens utbildn.omr. 3"
		,d7.iscle2011_EN as "Target level of ed. 1"
		,d7.Koulutusaste_taso2_EN as "Target level of ed. 2"
		,d7.iscfibroad2013_EN as "Target field of ed. 1"
		,d7.iscfinarrow2013_EN as "Target field of ed. 2"
		,d7.iscfi2013_EN as "Target field of ed. 3"
		,d7.jarjestys_iscle2011 as jarj_isced_koulast1
		,d7.jarjestys_Koulutusaste_taso2 as jarj_isced_koulast2
		,d7.jarjestys_iscfibroad2013 as jarj_isced_koulala1
		,d7.jarjestys_iscfinarrow2013 as jarj_isced_koulala2
		,d7.jarjestys_iscfi2013 as jarj_isced_koulala3
		,d7.iscle2011_koodi as "Koodit Tavoitetutk. koul.aste 1"
		,d7.Koulutusaste_taso2_koodi as "Koodit Tavoitetutk. koul.aste 2"
		,d7.iscfibroad2013_koodi as "Koodit Tavoitetutk. koul.ala 1"
		,d7.iscfinarrow2013_koodi as "Koodit Tavoitetutk. koul.ala 2"
		,d7.iscfi2013_koodi as "Koodit Tavoitetutk. koul.ala 3"
		,d8.iscle2011 as "Suor. tutk. koul.aste 1"
		,d8.Koulutusaste_taso2 as "Suor. tutk. koul.aste 2"
		,d8.iscfibroad2013 as "Suor. tutk. koul.ala 1"
		,d8.iscfinarrow2013 as "Suor. tutk. koul.ala 2"
		,d8.iscfi2013 as "Suor. tutk. koul.ala 3"
		,d8.iscle2011_SV as "Examens utbildn.nivå 1"
		,d8.Koulutusaste_taso2_SV as "Examens utbildn.nivå 2"
		,d8.iscfibroad2013_SV as "Examens utbildn.omr. 1"
		,d8.iscfinarrow2013_SV as "Examens utbildn.omr. 2"
		,d8.iscfi2013_SV as "Examens utbildn.omr. 3"
		,d8.iscle2011_EN as "Qualif. level of ed. 1"
		,d8.Koulutusaste_taso2_EN as "Qualif. level of ed. 2"
		,d8.iscfibroad2013_EN as "Qualif. field of ed. 1"
		,d8.iscfinarrow2013_EN as "Qualif. field of ed. 2"
		,d8.iscfi2013_EN as "Qualif. field of ed. 3"
		,d8.jarjestys_iscle2011 as jarj_isced2_koulast1
		,d8.jarjestys_Koulutusaste_taso2 as jarj_isced2_koulast2
		,d8.jarjestys_iscfibroad2013 as jarj_isced2_koulala1
		,d8.jarjestys_iscfinarrow2013 as jarj_isced2_koulala2
		,d8.jarjestys_iscfi2013 as jarj_isced2_koulala3
		,d8.iscle2011_koodi as "Koodit Suor. tutk. koul.aste 1"
		,d8.Koulutusaste_taso2_koodi as "Koodit Suor. tutk. koul.aste 2"
		,d8.iscfibroad2013_koodi as "Koodit Suor. tutk. koul.ala 1"
		,d8.iscfinarrow2013_koodi as "Koodit Suor. tutk. koul.ala 2"
		,d8.iscfi2013_koodi as "Koodit Suor. tutk. koul.ala 3"
		,d9.iscle2011 as "Pohjakoul. koul.aste 1"
		,d9.Koulutusaste_taso2 as "Pohjakoul. koul.aste 2"
		,d9.iscfibroad2013 as "Pohjakoul. koul.ala 1"
		,d9.iscfinarrow2013 as "Pohjakoul. koul.ala 2"
		,d9.iscfi2013 as "Pohjakoul. koul.ala 3"
		,d9.iscle2011_SV as "Grundutb. utbildn.nivå 1"
		,d9.Koulutusaste_taso2_SV as "Grundutb. utbildn.nivå 2"
		,d9.iscfibroad2013_SV as "Grundutb. utbildn.omr. 1"
		,d9.iscfinarrow2013_SV as "Grundutb. utbildn.omr. 2"
		,d9.iscfi2013_SV as "Grundutb. utbildn.omr. 3"
		,d9.iscle2011_EN as "Previous qual. level of ed. 1"
		,d9.Koulutusaste_taso2_EN as "Previous qual. level of ed. 2"
		,d9.iscfibroad2013_EN as "Previous qual. field of ed. 1"
		,d9.iscfinarrow2013_EN as "Previous qual. field of ed. 2"
		,d9.iscfi2013_EN as "Previous qual. field of ed. 3"
		,d9.jarjestys_iscle2011 as jarj_isced3_koulast1
		,d9.jarjestys_Koulutusaste_taso2 as jarj_isced3_koulast2
		,d9.jarjestys_iscfibroad2013 as jarj_isced3_koulala1
		,d9.jarjestys_iscfinarrow2013 as jarj_isced3_koulala2
		,d9.jarjestys_iscfi2013 as jarj_isced3_koulala3
		,d9.iscle2011_koodi as "Koodit Pohjakoul. koul.aste 1"
		,d9.Koulutusaste_taso2_koodi as "Koodit Pohjakoul. koul.aste 2"
		,d9.iscfibroad2013_koodi as "Koodit Pohjakoul. koul.ala 1"
		,d9.iscfinarrow2013_koodi as "Koodit Pohjakoul. koul.ala 2"
		,d9.iscfi2013_koodi as "Koodit Pohjakoul. koul.ala 3"
FROM  dbo.f_aloittaneiden_lapaisy f INNER JOIN
        dbo.d_kausi AS d1 ON d1.kausi_id = f.aloituskausikoodi INNER JOIN
        dbo.d_aidinkieli_versio1 AS d2 ON d2.id = f.aikielir1_id INNER JOIN
        dbo.d_alueluokitus AS d3 ON d3.id = f.alueluokitus_id INNER JOIN
        dbo.d_alueluokitus AS d4 ON d4.id = f.saavutettu_alueluokitus_id INNER JOIN
        dbo.d_ika AS d5 ON d5.id = f.ika_id INNER JOIN
        dbo.d_koulutuslaji2 AS d6 ON d6.id = f.koulutuslaji2_id INNER JOIN
        dbo.d_koulutusluokitus AS d7 ON d7.id = f.koulk_id INNER JOIN
        dbo.d_koulutusluokitus AS d8 ON d8.id = f.saavutettu_koulk_id INNER JOIN
        dbo.d_koulutusluokitus AS d9 ON d9.id = f.pohjkoulk_id INNER JOIN
        dbo.d_lahde AS d10 ON d10.id = f.lahde_id INNER JOIN
        --dbo.d_opetushallinnon_koulutus AS d11 ON d11.id = f.ophal_id INNER JOIN
        dbo.d_opiskelijan_olo AS d12 ON d12.id = f.ololk_id INNER JOIN
        dbo.d_oppilaitoksen_taustatiedot AS d13 ON d13.id = f.oppilaitoksen_taustatiedot_id INNER JOIN
        dbo.d_oppilaitoksen_taustatiedot AS d14 ON d14.id = f.saavutettu_oppilaitoksen_taustatiedot_id INNER JOIN
        dbo.d_rahoituslahde AS d15 ON d15.id = f.rahlahde_id INNER JOIN
		dbo.d_sukupuoli AS d16 ON d16.id = f.sp_id INNER JOIN
        dbo.d_tarkastelujakso AS d17 ON d17.id = f.tarkastelujakso_id INNER JOIN
		dbo.d_hallinnonala2 AS d18 ON d18.hallinnonala_koodi = 
		CASE
			WHEN ophal=1 then 1
			WHEN ophal=2 and coalesce(coalesce(d13.koulutuksen_jarjestajan_korvaavakoodi,d13.koulutuksen_jarjestajakoodi),'''') not in (''0145076-7'',''2153105-4'',''150622-3'',''0909306-3'') then 2
			WHEN ophal=2 then 3
			ELSE -1
		END
			
WHERE   (f.aineistokoodi = ''K3.9'') AND (d10.lahde_koodi in (31, 33, 34)) AND (d17.tarkastelujakso <> ''0,5 vuotta'') 
		AND (f.[1a Aloittaneiden opintojen kulku koulutuslajin mukaan prioriteettina mikä tahansa tutkinto] <> ''Virhetilanne'')






























' 
GO
/****** Object:  View [dbo].[v_f_aloittaneiden_lapaisy_K3_9_lukio]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_aloittaneiden_lapaisy_K3_9_lukio]'))
EXEC dbo.sp_executesql @statement = N'










CREATE VIEW [dbo].[v_f_aloittaneiden_lapaisy_K3_9_lukio]
AS
SELECT f.lkm_int AS lkm_int2, 
		d1.lukuvuosi AS Aloituslukuvuosi, 
		d1.vuosiselite AS Aloitusvuosi, 
		d1.lukukausiselite AS Aloituslukukausi, 
		d17.tarkastelujakso AS Tarkastelujakso, 		
		d11.opetushallinnon_koulutus AS Hallinnonala, 
		d16.sukupuoli AS Sukupuoli, 
		d2.aidinkieli_versio1 AS Äidinkieli, 
		d5.ika AS Ikä, 
		d5.ika5v AS Ikäryhmä, 		
		d6.koulutuslaji2 AS [Tavoitetutk. koulutuslaji], 
		d7.koulutusaste2002 AS [Tavoitetutk. koulutusaste], 
		d7.koulutusala2002 AS [Tavoitetutk. koulutusala], 		
		d7.opintoala2002 AS [Tavoitetutk. opintoala], 
		d7.koulutus AS [Tavoitetutk. koulutusnimike], 
		d8.koulutusaste2002 AS [Suor. tutkinnon koulutusaste], 
		d8.koulutusala2002 AS [Suor. tutkinnon koulutusala], 		
		d8.opintoala2002 AS [Suor. tutkinnon opintoala], 
		d8.koulutus AS [Suor. tutkinnon koulutusnimike], 
		d9.koulutusaste2002 AS [Pohjakoul. koulutusaste], 
		d9.koulutusala2002 AS [Pohjakoul. koulutusala], 		
		d9.opintoala2002 AS [Pohjakoul. opintoala], 
		d9.koulutus AS [Pohjakoul. koulutusnimike], 
		d3.kunta AS [Tavoitetutk. kunta], 
		d3.maakunta AS [Tavoitetutk. maakunta], 
		d3.avi AS [Tavoitetutk. AVI], 		
		d3.ely AS [Tavoitetutk. ELY], 
		d3.seutukunta AS [Tavoitetutk. seutukunta], 
		d3.suuralue AS [Tavoitetutk. suuralue], 
		d3.kuntaryhma AS [Tavoitetutk. kuntaryhmä], 
		d3.laani AS [Tavoitetutk. lääni], 		
		d3.tyovoima_elinkeinokeskus AS [Tavoitetutk. työvoima ja elinkeinokeskus], 
		d3.kielisuhde AS [Tavoitetutk. kunnan kielisuhde], 
		d4.kunta AS [Suor. tutkinnon kunta], 
		d4.maakunta AS [Suor. tutkinnon maakunta], 		
		d4.avi AS [Suor. tutkinnon AVI], 
		d4.ely AS [Suor. tutkinnon ELY], 
		d4.seutukunta AS [Suor. tutkinnon seutukunta], 
		d4.suuralue AS [Suor. tutkinnon suuralue], 
		d4.kuntaryhma AS [Suor. tutkinnon kuntaryhmä], 		
		d4.laani AS [Suor. tutkinnon lääni], 
		d4.tyovoima_elinkeinokeskus AS [Suor. tutkinnon työvoima ja elinkeinokeskus], 
		d4.kielisuhde AS [Suor. tutkinnon kunnan kielisuhde], 
		d12.opiskelijan_olo AS Kirjoillaolo, 		
		d15.rahoituslahde AS [Tavoitetutk. rahoituslähde], 
		d13.oppilaitos AS [Tavoitetutk. oppilaitos], 
		d13.oppilaitostyyppi AS [Tavoitetutk. oppil.tyyppi], 		
		d13.oppilaitoksen_omistajatyyppi AS [Tavoitetutk. oppil. omistajatyyppi], 
		d13.opetuskieli AS [Tavoitetutk. oppil. opetuskieli], 
		d13.koulutuksen_jarjestaja AS [Tavoitetutk. koul. järjestäjä], 		
		d13.koulutuksen_jarjestajan_omistajatyyppi AS [Tavoitetutk. koul. järjestäjän omistajatyyppi], 
		d13.koulutuksen_jarjestajan_kieli AS [Tavoitetutk. koul. järjestäjän kieli], 		
		d14.oppilaitos AS [Suor. tutkinnon oppilaitos], 
		d14.oppilaitostyyppi AS [Suor. tutkinnon oppil.tyyppi], 
		d14.oppilaitoksen_omistajatyyppi AS [Suor. tutkinnon oppil. omistajatyyppi], 		
		d14.opetuskieli AS [Suor. tutkinnon oppil. opetuskieli], 
		d14.koulutuksen_jarjestaja AS [Suor. tutkinnon koul. järjestäjä], 		
		d14.koulutuksen_jarjestajan_omistajatyyppi AS [Suor. tutkinnon koul. järjestäjän omistajatyyppi], 
		d14.koulutuksen_jarjestajan_kieli AS [Suor. tutkinnon koul. järjestäjän kieli], 		
		f.[1a Aloittaneiden opintojen kulku koulutuslajin mukaan prioriteettina mikä tahansa tutkinto] AS [Opintojen kulku], 		
		f.[1b Aloittaneiden opintojen kulku koulutuslajin mukaan prioriteettina tutkinto ja opiskelu alkuperäisessä tutkintolajissa] AS [Opintojen kulku prioriteetti 2], 		
		f.[1c Aloittaneista tutkinnon suorittaneet koulutuslajin mukaan] AS [Suoritettu tutkinto], 
		f.[1d Aloittaneista ilman tutkintoa opiskelua jatkavat koulutuslajin mukaan] AS [Opiskelua jatkavat tutk.lajin mukaan], 		
		f.[1e Aloittaneista alkuperäisen koulutuslajin tutkinnon suorittaneet koulutuslajin mukaan] AS [Tutkinto tavoitet. tutkintolajissa], 		
		f.[1f Aloittaneista muun kuin alkuperäisen tutkintolajin tutkinnon suorittaneet koulutuslajin mukaan] AS [Tutkinto muussa tutkintolajissa], 		
		f.[1g Aloittaneista alkuperäisen tutkintolajin opiskelua jatkavat koulutuslajin mukaan] AS [Opiskelee tavoitet. tutkintolajissa], 		
		f.[1h Aloittaneista muun tutkintolajin opiskelua jatkavat koulutuslajin mukaan] AS [Opiskelee muussa tutkintolajissa], 		
		f.[2a Aloittaneiden opintojen kulku koulutusalan (2002) mukaan prioriteettina mikä tahansa tutkinto] AS [Opintojen kulku koulutusaloittain],
		f.[2b Aloittaneiden opintojen kulku koulutusalan (2002) mukaan prioriteettina tutkinto ja opiskelu alkuperäisellä] AS [Opintojen kulku koulutusaloittain prioriteetti 2], 		
		f.[2e Aloittaneista alkuperäisen koulutusalan (2002) tutkinnon suorittaneet koulutusalan mukaan] AS [Tutkinto tavoitet. koulutusalalla], 		
		f.[2f Aloittaneista muun kuin alkuperäisen tutkintolajin tutkinnon suorittaneet koulutuslajin mukaan] AS [Tutkinto muulla koulutusalalla], 		
		f.[2g Aloittaneista alkuperäisellä koulutusalalla opiskelua jatkavat koulutusalan mukaan] AS [Opiskelee tavoitet. koulutusalalla], 		
		f.[2h Aloittaneista muulla koulutusalalla opiskelua jatkavat koulutusalan mukaan] AS [Opiskelee muulla koulutusalalla], 		
		f.[3a Aloittaneiden opintojen kulku opintoalan (2002) mukaan prioriteettina mikä tahansa tutkinto] AS [Opintojen kulku opintoaloittain], 		
		f.[3b Aloittaneiden opintojen kulku opintoalan (2002) mukaan prioriteettina tutkinto ja opiskelu alkuperäisellä] AS [Opintojen kulku opintoaloittain prioriteetti 2], 		
		f.[3e Aloittaneista alkuperäisen opintoalan (2002) tutkinnon suorittaneet opintoalan mukaan] AS [Tutkinto tavoitet. opintoalalla], 		
		f.[3f Aloittaneista muun opintoalan (2002) tutkinnon suorittaneet opintoalan mukaan] AS [Tutkinto muulla opintoalalla], 		
		f.[3g Aloittaneista alkuperäisellä opintoalalla (2002) opiskelua jatkavat opintoalan mukaan] AS [Opiskelee tavoitet. opintoalalla], 		
		f.[3h Aloittaneista muulla opintoalalla (2002) opiskelua jatkavat opintoalan mukaan] AS [Opiskelee muulla opintoalalla], 		
		f.[4a Aloittaneiden opintojen kulku koulutuksen järjestäjän mukaan, toinen aste prioriteettina tutkinto missä tahansa] AS [Opintojen kulku koul. järjestäjittäin], 		
		f.[4b Aloittaneiden opintojen kulku koulutuksen järjestäjän mukaan, toinen aste prioriteettina tutkinto ja opiskelu alkuperäisellä] AS [Opintojen kulku koul. järjestäjittäin prioriteetti 2], 		
		f.[4e Aloittaneista alkuperäisen koulutuksen järjestäjän tutkinnon suorittaneet järjestäjän mukaan] AS [Tutkinto tavoitet. koul. järjestäjällä], 		
		f.[4f Aloittaneista muun koulutuksen järjestäjän tutkinnon suorittaneet järjestäjän mukaan] AS [Tutkinto muulla koul. järjestäjällä], 		
		f.[4g Aloittaneista alkuperäisellä järjestäjällä opiskelua jatkavat järjestäjän mukaan] AS [Opiskelee tavoitet. koul. järjestäjällä], 		
		f.[4h Aloittaneista muulla järjestäjällä opiskelua jatkavat järjestäjän mukaan] AS [Opiskelee muulla koul. järjestäjällä], 
		f.[5a Aloittaneiden opintojen kulku oppilaitoksen mukaan prioriteettina tutkinto missä tahansa] AS [Opintojen kulku oppilaitoksittain], 		
		f.[5b Aloittaneiden opintojen kulku oppilaitoksen mukaan prioriteettina tutkinto ja opiskelu alkuperäisessä] AS [Opintojen kulku oppilaitoksittain prioriteetti 2], 		
		f.[5e Aloittaneista alkuperäisessä oppilaitoksessa tutkinnon suorittaneet oppilaitoksen mukaan] AS [Tutkinto tavoitet. oppilaitoksessa], 		
		f.[5f Aloittaneista muussa oppilaitoksessa tutkinnon suorittaneet oppilaitoksen mukaan] AS [Tutkinto muussa oppilaitoksessa], 		
		f.[5g Aloittaneista alkuperäisessä oppilaitoksessa opiskelua jatkavat oppilaitoksen mukaan] AS [Opiskelee tavoitet. oppilaitoksessa], 		
		f.[5h Aloittaneista muussa oppilaitoksessa opiskelua jatkavat oppilaitoksen mukaan] AS [Opiskelee muussa oppilaitoksessa], 		
		f.[6a Aloittaneiden opintojen kulku maakunnan mukaan prioriteettina tutkinto missä tahansa] AS [Opintojen kulku maakunnittain], 		
		f.[6b Aloittaneiden opintojen kulku maakunnan mukaan prioriteettina tutkinto ja opiskelu alkuperäisessä] AS [Opintojen kulku maakunnittain prioriteetti 2], 		
		f.[6e Aloittaneista alkuperäisessä maakunnassa tutkinnon suorittaneet maakunnan mukaan] AS [Tutkinto tavoitet. maakunnassa], 		
		f.[6f Aloittaneista muussa maakunnassa tutkinnon suorittaneet maakunnan mukaan] AS [Tutkinto muussa maakunnassa], 		
		f.[6g Aloittaneista alkuperäisessä maakunnassa opiskelua jatkavat maakunnan mukaan] AS [Opiskelee tavoitet. maakunnassa], 		
		f.[6h Aloittaneista muussa maakunnassa opiskelua jatkavat maakunnan mukaan] AS [Opiskelee muussa maakunnassa], 		
		f.[7a Aloittaneiden opintojen kulku koulutussektorin mukaan prioriteettina tutkinto missä tahansa] AS [Opintojen kulku koul.sektoreittan], 		
		f.[7b Aloittaneiden opintojen kulku koulutussektorin mukaan prioriteettina tutkinto ja opiskelu alkuperäisellä] AS [Opintojen kulku koul.sektoreittan prioriteetti 2], 		
		f.[7e Aloittaneista alkuperäisen koulutussektorin tutkinnon suorittaneet koulutussektorin mukaan] AS [Tutkinto tavoitet. koulutussektorilla], 		
		f.[7f Aloittaneista muun koulutussektorin tutkinnon suorittaneet koulutussektorin mukaan] AS [Tutkinto muulla koulutussektorilla], 		
		f.[7g Aloittaneista alkuperäisellä koulutussektorilla opiskelua jatkavat koulutussektorin mukaan] AS [Opiskelee tavoitet. koulutussektorilla], 		
		f.[7h Aloittaneista muulla koulutussektorilla opiskelua jatkavat koulutussektorin mukaan] AS [Opiskelee muulla koulutussektorilla], 		
		f.[8a Aloittaneiden opintojen kulku opintoalan (1995) mukaan prioriteettina mikä tahansa tutkinto] AS [Opintojen kulku koul.aloittain (95)], 		
		f.[8b Aloittaneiden opintojen kulku opintoalan (1995) mukaan prioriteettina tutkinto ja opiskelu alkuperäisellä] AS [Opintojen kulku koul.aloittain (95) prioriteetti 2], 		
		f.[8e Aloittaneista alkuperäisen opintoalan (1995) tutkinnon suorittaneet opintoalan mukaan] AS [Tutkinto tavoitet. koulutusalalla (95)], 		
		f.[8f Aloittaneista muun opintoalan (1995) tutkinnon suorittaneet opintoalan mukaan] AS [Tutkinto muulla koulutusalalla (95)], 		
		f.[8g Aloittaneista alkuperäisellä opintoalalla (1995) opiskelua jatkavat opintoalan mukaan] AS [Opiskelee tavoitet. koulutusalalla (95)], 		
		f.[8h Aloittaneista muulla opintoalalla (1995) opiskelua jatkavat opintoalan mukaan] AS [Opiskelee muulla koulutusalalla (95)], 
		f.aloitus_saavutus AS [Aloitus saavutus], 		
		f.tarkastelujakso_tulevaisuus AS [Tarkastelujakson tulevaisuus], 
		f.tarkastelujakso_edustavuus AS [Tarkastelujakson edustavuus], 
		d10.lahde AS Lähde, 
		--ruotsi
		d1.lukuvuosi AS Begynnelseläsår, 
		d1.vuosiselite_SV AS Begynnelseår, 
		d1.lukukausiselite_SV AS Begynnelsetermin, 
		d17.tarkastelujakso_SV AS Granskningsperiod, 
		d16.sukupuoli_SV AS Kön, 
		d11.opetushallinnon_koulutus AS Förvaltningsområde, 
		d2.aidinkieli_versio1_SV AS Modersmål, 
		d5.ika_SV AS Ålder, 
		d5.ika5v_SV AS Åldersgrupp, 
		d6.koulutuslaji2_SV AS [Målexamens examensslag], 
		d7.koulutus_SV AS [Målexamens utbildn.benämning], 
		d8.koulutus_SV AS [Examens utbildn.benämning], 
		d9.koulutusaste2002_SV AS [Grundutb. utbildn.nivå 2002], 
		d9.koulutusala2002_SV AS [Grundutb. utbildn.område 2002], 
		d9.opintoala2002_SV AS [Grundutb. studieområde 2002], 
		d9.koulutus_SV AS [Grundutb. utbildn.benämning], 
		d3.maakunta_SV AS [Målexamens landskap], 
		d3.avi AS [Målexamens RVF], 		
		d3.ely AS [Målexamens NTM], 
		d3.kunta AS [Målexamens kommun], 
		d4.maakunta_SV AS [Examens landskap], 
		d4.avi AS [Examens RVF], 
		d4.ely AS [Examens NTM], 
		d4.kunta AS [Examens kommun], 
		d12.opiskelijan_olo_SV AS Inskrivning, 
		d13.koulutuksen_jarjestaja_SV AS [Målexamens utbildn.ordnare],
		d14.koulutuksen_jarjestaja AS [Examens utbildn.ordnare], 
				[Studieförlopp] = 
			case f.[1a Aloittaneiden opintojen kulku koulutuslajin mukaan prioriteettina mikä tahansa tutkinto]
				when ''Tutkinto alkuperäisessä tutkintolajissa'' then ''Examen i det ursprungliga examensslaget''
				when ''Tutkinto muussa tutkintolajissa'' then ''Examen i annat examensslag''
				when ''Tutkinto muussa tutkintolajissa, kandidaatin tutkinto'' then ''Examen i annat examensslag, lägre högskoleexamen''
				when ''Opiskelee alkuperäisessä tutkintolajissa'' then ''Studerar i det ursprungliga examensslaget''
				when ''Opiskelee muussa tutkintolajissa'' then ''Studerar i annat examensslag''
				when ''Ei tutkintoa, ei opiskele, työllinen'' then ''Ingen examen, inte studerar, sysselsatt''
				when ''Ei tutkintoa, ei opiskele, ei työllinen'' then ''Ingen examen, inte studerar, arbetslös''
				else  ''Information saknas''
			end , 
		[Studieförlopp prior. 2] =
			case f.[1b Aloittaneiden opintojen kulku koulutuslajin mukaan prioriteettina tutkinto ja opiskelu alkuperäisessä tutkintolajissa]
				when ''Tutkinto alkuperäisessä tutkintolajissa'' then ''Examen i det ursprungliga examensslaget''
				when ''Tutkinto muussa tutkintolajissa'' then ''Examen i annat examensslag''
				when ''Tutkinto muussa tutkintolajissa, kandidaatin tutkinto'' then ''Examen i annat examensslag, lägre högskoleexamen''
				when ''Opiskelee alkuperäisessä tutkintolajissa'' then ''Studerar i det ursprungliga examensslaget''
				when ''Opiskelee muussa tutkintolajissa'' then ''Studerar i annat examensslag''
				when ''Ei tutkintoa, ei opiskele, työllinen'' then ''Ingen examen, inte studerar, sysselsatt''
				when ''Ei tutkintoa, ei opiskele, ei työllinen'' then ''Ingen examen, inte studerar, arbetslös''
				else ''Information saknas''
			end			, 
		[Avlagt examen] =
			case f.[1c Aloittaneista tutkinnon suorittaneet koulutuslajin mukaan]
				when ''Tutkinto lukiokoulutuksesta'' then ''Studentexamen''
				when ''Ammatillinen perustutkinto'' then ''Grundläggande yrkesexamen''
				when ''Ammatillinen lisäkoulutus ammattitutkinto tai erikoisammattitutkinto'' then ''Yrkesinriktad tilläggsutbildning, yrkesexamen eller specialyrkesexamen''
				when ''Muu korkein ja viimeisimmäksi suoritettu tutkinto, toinen aste'' then ''Övrig högsta och senast avlagd examen, andra stadiet''
				when ''Ammattikorkeakoulututkinto'' then ''Yrkeshögskoleexamen''
				when ''Alempi korkeakoulututkinto'' then ''Lägre högskoleexamen''
				when ''Ylempi ammattikorkeakoulututkinto'' then ''Högre yrkeshögskoleexamen''
				when ''Ylempi korkeakoulututkinto'' then ''Högre högskoleexamen''
				when ''Tutkijakoulutusasteen tutkinto'' then ''Examen på forskarutbildningsnivå''
				when ''Muu korkein ja viimeisimmäksi suoritettu tutkinto, korkeakoulututkinto'' then ''Övrig högsta och senast avlagd examen, högskoleexamen''
				when ''Ei tutkintoa'' then ''Ingen examen''
				when ''Virhetilanne'' then ''Information saknas''
			end, 
		[Examen i målex. examensslag] = 
			case f.[1e Aloittaneista alkuperäisen koulutuslajin tutkinnon suorittaneet koulutuslajin mukaan]
				when ''Kyllä'' then ''Ja''
				when ''Ei'' then ''Inte''
				when ''Virhetilanne'' then ''Information saknas''
			end
		, 
		[Examen i annat examensslag] = 
			case [1f Aloittaneista muun kuin alkuperäisen tutkintolajin tutkinnon suorittaneet koulutuslajin mukaan]
				when ''Kyllä'' then ''Ja''
				when ''Ei'' then ''Inte''
				when ''Virhetilanne'' then ''Information saknas''
			end	
			, 
		[Examen i målex. utbildn.område 02] =
			case [2e Aloittaneista alkuperäisen koulutusalan (2002) tutkinnon suorittaneet koulutusalan mukaan]
				when ''Kyllä'' then ''Ja''
				when ''Ei'' then ''Inte''
				when ''Virhetilanne'' then ''Information saknas''
			end	
		, 
		[Examen i målex. studieområde 02] = 
			case [3e Aloittaneista alkuperäisen opintoalan (2002) tutkinnon suorittaneet opintoalan mukaan]
				when ''Kyllä'' then ''Ja''
				when ''Ei'' then ''Inte''
				when ''Virhetilanne'' then ''Information saknas''
			end	
		, 
		[Examen i målex. läroanstalt] = 
			case [5e Aloittaneista alkuperäisessä oppilaitoksessa tutkinnon suorittaneet oppilaitoksen mukaan] 
				when ''Kyllä'' then ''Ja''
				when ''Ei'' then ''Inte''
				when ''Virhetilanne'' then ''Information saknas''
			end	
		, 
		[Examen i målex. utbildn.område 95] = 
			case [8e Aloittaneista alkuperäisen opintoalan (1995) tutkinnon suorittaneet opintoalan mukaan]
				when ''Kyllä'' then ''Ja''
				when ''Ei'' then ''Inte''
				when ''Virhetilanne'' then ''Information saknas''
			end	
		, 
		--englanti
		d1.lukuvuosi AS [First academic year], 
		d1.vuosiselite_EN AS [First year of studies], 
		d1.lukukausiselite_EN AS [First term], 
		d17.tarkastelujakso_EN AS [Reference period], 
		d16.sukupuoli_EN AS Gender, 
		d11.opetushallinnon_koulutus AS [Administrative sector], 
		d2.aidinkieli_versio1_EN AS [Mother tongue], 
		d5.ika_EN AS Age, 
		d5.ika5v_EN AS [Age group], 
		d6.koulutuslaji2_EN AS [Target qualif. form of qual.], 
		d7.koulutus_EN AS [Target qual. name of ed.], 
		d8.koulutus_EN AS [Qualif. name of ed.], 
		d9.koulutusaste2002_EN AS [Previous qual. level of ed. 02], 
		d9.koulutusala2002_EN AS [Previous qual. field of ed. 02], 
		d9.opintoala2002_EN AS [Previous qual. subfield of ed. 02], 
		d9.koulutus_EN AS [Previous qual. name of ed.], 
		d3.maakunta_EN AS [Target qualif. region], 
		d3.avi AS [Target qualif. AVI], 		
		d3.ely AS [Target qualif. ELY], 
		d3.kunta AS [Target qualif. municipal.], 
		d4.maakunta_EN AS [Qualifcation''s region], 
		d4.avi AS [Qualifcation''s AVI], 
		d4.ely AS [Qualifcation''s ELY], 
		d4.kunta AS [Qualifcation''s municipality], 
		d12.opiskelijan_olo_EN AS [Enrollment status], 
		d13.koulutuksen_jarjestaja_EN AS [Target qual. ed. provider],
		d14.koulutuksen_jarjestaja AS [Qualification''s ed. provider], 
		[Study progress] =
			case f.[1a Aloittaneiden opintojen kulku koulutuslajin mukaan prioriteettina mikä tahansa tutkinto]
				when ''Tutkinto alkuperäisessä tutkintolajissa'' then ''Qualification in the original form of degree''
				when ''Tutkinto muussa tutkintolajissa'' then ''Qualification in another form of degree''
				when ''Tutkinto muussa tutkintolajissa, kandidaatin tutkinto'' then ''Qualification in another form of degree, Bachelor''''s degree''
				when ''Opiskelee alkuperäisessä tutkintolajissa'' then ''Studying in the original form of degree''
				when ''Opiskelee muussa tutkintolajissa'' then ''Studying in another form of degree''
				when ''Ei tutkintoa, ei opiskele, työllinen'' then ''No qualification, not studying, employed''
				when ''Ei tutkintoa, ei opiskele, ei työllinen'' then ''No qualification, not studying, unemployed''
				else  ''Missing data''
			end ,
		[Study progress prior. 2] = 
			case f.[1b Aloittaneiden opintojen kulku koulutuslajin mukaan prioriteettina tutkinto ja opiskelu alkuperäisessä tutkintolajissa]
				when ''Tutkinto alkuperäisessä tutkintolajissa'' then ''Qualification in the original form of degree''
				when ''Tutkinto muussa tutkintolajissa'' then ''Qualification in another form of degree''
				when ''Tutkinto muussa tutkintolajissa, kandidaatin tutkinto'' then ''Qualification in another form of degree, Bachelor''''s degree''
				when ''Opiskelee alkuperäisessä tutkintolajissa'' then ''Studying in the original form of degree''
				when ''Opiskelee muussa tutkintolajissa'' then ''Studying in another form of degree''
				when ''Ei tutkintoa, ei opiskele, työllinen'' then ''No qualification, not studying, employed''
				when ''Ei tutkintoa, ei opiskele, ei työllinen'' then ''No qualification, not studying, unemployed''
				else  ''Missing data''
			end , 
		[Completed qualification] =
			case f.[1c Aloittaneista tutkinnon suorittaneet koulutuslajin mukaan]
				when ''Tutkinto lukiokoulutuksesta'' then ''Matriculation examination''
				when ''Ammatillinen perustutkinto'' then ''Vocational upper secondary qualification''
				when ''Ammatillinen lisäkoulutus ammattitutkinto tai erikoisammattitutkinto'' then ''Further vocational qualification or specialist vocational qualification''
				when ''Muu korkein ja viimeisimmäksi suoritettu tutkinto, toinen aste'' then ''Other highest and most recent degree, upper secondary education''
				when ''Ammattikorkeakoulututkinto'' then ''UAS degree''
				when ''Alempi korkeakoulututkinto'' then ''Bachelor''''s degree''
				when ''Ylempi ammattikorkeakoulututkinto'' then ''UAS Master''''s degree''
				when ''Ylempi korkeakoulututkinto'' then ''Master''''s degree''
				when ''Tutkijakoulutusasteen tutkinto'' then ''Research degree''
				when ''Muu korkein ja viimeisimmäksi suoritettu tutkinto, korkeakoulututkinto'' then ''Other highest and most recent degree, higher education''
				when ''Ei tutkintoa'' then ''No degree''
				when ''Virhetilanne'' then ''Missing data''
			end, 
		[Completed in target form of qual.] =
			case f.[1e Aloittaneista alkuperäisen koulutuslajin tutkinnon suorittaneet koulutuslajin mukaan]
				when ''Kyllä'' then ''Yes''
				when ''Ei'' then ''No''
				when ''Virhetilanne'' then ''Missing data''
			end, 
		[Completed in another form of qual.] =
			case f.[1f Aloittaneista muun kuin alkuperäisen tutkintolajin tutkinnon suorittaneet koulutuslajin mukaan]
				when ''Kyllä'' then ''Yes''
				when ''Ei'' then ''No''
				when ''Virhetilanne'' then ''Missing data''
			end, 
		 [Completed in target field of ed. 02] =
			case f.[2e Aloittaneista alkuperäisen koulutusalan (2002) tutkinnon suorittaneet koulutusalan mukaan]
				when ''Kyllä'' then ''Yes''
				when ''Ei'' then ''No''
				when ''Virhetilanne'' then ''Missing data''
			end, 
		[Completed in target subfield of ed. 02] =
			case f.[3e Aloittaneista alkuperäisen opintoalan (2002) tutkinnon suorittaneet opintoalan mukaan]
				when ''Kyllä'' then ''Yes''
				when ''Ei'' then ''No''
				when ''Virhetilanne'' then ''Missing data''
			end, 
		 [Completed in target ed. institution] =
			case f.[5e Aloittaneista alkuperäisessä oppilaitoksessa tutkinnon suorittaneet oppilaitoksen mukaan]
				when ''Kyllä'' then ''Yes''
				when ''Ei'' then ''No''
				when ''Virhetilanne'' then ''Missing data''
			end, 
		 [Completed in target field of ed. 95] =
			case f.[8e Aloittaneista alkuperäisen opintoalan (1995) tutkinnon suorittaneet opintoalan mukaan]
				when ''Kyllä'' then ''Yes''
				when ''Ei'' then ''No''
				when ''Virhetilanne'' then ''Missing data''
			end, 
		--koodit
		d7.koulutus_Koodi AS [Koodit Tavoitetutk. koulutusnimike], 
		d8.koulutus_Koodi AS [Koodit Suor. tutkinnon koulutusnimike], 
		d9.koulutus_Koodi AS [Koodit Pohjakoul. koulutusnimike], 
		d3.maakunta_Koodi AS [Koodit Tavoitetutk. maakunta], 
		d4.maakunta_Koodi AS [Koodit Suor. tutkinnon maakunta], 
		d13.koulutuksen_jarjestajakoodi AS [Koodit Tavoitetutk. koul. järjestäjä],
		--jarjestys
		d1.jarjestys AS lukukausi_jarjestys, 		
		d17.jarjestys AS tarkastelujakso_jarjestys, 
		d11.jarjestys AS opetushallinnon_koulutus_jarjestys, 
		d16.jarjestys AS sukupuoli_jarjestys, 
		d2.jarjestys AS aidinkieli_jarjestys, 
		d5.jarjestys_ika, 
		d5.jarjestys_ika5v, 		
		d6.jarjestys_koulutuslaji2 AS koulutuslaji_jarjestys, 
		d7.jarjestys_koulutusaste2002, 
		d7.jarjestys_koulutusala2002, 
		d7.jarjestys_opintoala2002 AS jarjestys_opintoala, 
		d7.jarjestys AS jarjestys_koulutusnimike, 		
		d8.jarjestys_koulutusaste2002 AS jarjestys_suor_koulutusaste2002, 
		d8.jarjestys_koulutusala2002 AS jarjestys_suor_koulutusala2002, 
		d8.jarjestys_opintoala2002 AS jarjestys_suor_opintoala, 		
		d8.jarjestys AS jarjestys_suor_koulutusnimike, 
		d9.jarjestys_koulutusaste2002 AS jarjestys_pohj_koulutusaste2002, 
		d9.jarjestys_koulutusala2002 AS jarjestys_pohj_koulutusala2002, 		
		d9.jarjestys_opintoala2002 AS jarjestys_pohj_opintoala, 
		d9.jarjestys AS jarjestys_pohj_koulutusnimike, 
		d3.jarjestys AS alueluokitus_jarjestys, 
		d3.jarjestys_maakunta, 
		d3.jarjestys_avi, 
		d3.jarjestys_ely, 		
		d3.jarjestys_seutukunta, 
		d3.jarjestys_suuralue, 
		d3.jarjestys_kuntaryhma, 
		d3.jarjestys_laani, 
		d3.jarjestys_tyovoima_elinkeinokeskus, 
		d3.jarjestys_kielisuhde, 
		d4.jarjestys AS saavutettu_al_jarjestys, 		
		d4.jarjestys_maakunta AS saavutettu_al_jarjestys_maakunta, 
		d4.jarjestys_avi AS saavutettu_al_jarjestys_avi, 
		d4.jarjestys_ely AS saavutettu_al_jarjestys_ely, 		
		d4.jarjestys_seutukunta AS saavutettu_al_jarjestys_seutukunta, 
		d4.jarjestys_suuralue AS saavutettu_al_jarjestys_suuralue, 
		d4.jarjestys_kuntaryhma AS saavutettu_al_jarjestys_kuntaryhma, 		
		d4.jarjestys_laani AS saavutettu_al_jarjestys_laani, 
		d4.jarjestys_tyovoima_elinkeinokeskus AS saavutettu_al_jarjestys_tyovoima_elinkeinokeskus, 		
		d4.jarjestys_kielisuhde AS saavutettu_al_jarjestys_kielisuhde, 
		d12.jarjestys AS opiskelijan_olo_jarjestys, 
		d15.jarjestys AS rahoituslahde_jarjestys, 
		d13.jarjestys_oppilaitos, 
		d13.jarjestys_oppilaitostyyppi, 		
		d13.jarjestys_omistajatyyppi, 
		d13.jarjestys_opetuskieli, 
		d13.jarjestys_koulutuksen_jarjestaja, 
		d13.jarjestys_koulutuksenjarjestaja, 
		d13.jarjestys_koulutuksen_jarjestajan_kieli, 		
		d14.jarjestys_oppilaitos AS saavutettu_jarjestys_oppilaitos, 
		d14.jarjestys_oppilaitostyyppi AS saavutettu_jarjestys_oppilaitostyyppi, 
		d14.jarjestys_omistajatyyppi AS saavutettu_jarjestys_omistajatyyppi, 		
		d14.jarjestys_opetuskieli AS saavutettu_jarjestys_opetuskieli, 
		d14.jarjestys_koulutuksen_jarjestaja AS saavutettu_jarjestys_koulutuksen_jarjestaja, 		
		d14.jarjestys_koulutuksenjarjestaja AS saavutettu_jarjestys_koulutuksenjarjestaja, 
		d14.jarjestys_koulutuksen_jarjestajan_kieli AS saavutettu_jarjestys_koulutuksen_jarjestajan_kieli, 
		f.[1a_jarjestys], 
		f.[1b_jarjestys], f.[1c_jarjestys], f.[1d_jarjestys], f.[1e_jarjestys], f.[1f_jarjestys], f.[1g_jarjestys], f.[1h_jarjestys], f.[2a_jarjestys], f.[2b_jarjestys], f.[2e_jarjestys], f.[2f_jarjestys], f.[2g_jarjestys], f.[2h_jarjestys], 
		f.[3a_jarjestys], f.[3b_jarjestys], f.[3e_jarjestys], f.[3f_jarjestys], f.[3g_jarjestys], f.[3h_jarjestys], f.[4a_jarjestys], f.[4b_jarjestys], f.[4e_jarjestys], f.[4f_jarjestys], f.[4g_jarjestys], f.[4h_jarjestys], f.[5a_jarjestys], 
		f.[5b_jarjestys], f.[5e_jarjestys], f.[5f_jarjestys], f.[5g_jarjestys], f.[5h_jarjestys], f.[6a_jarjestys], f.[6b_jarjestys], f.[6e_jarjestys], f.[6f_jarjestys], f.[6g_jarjestys], f.[6h_jarjestys], f.[7a_jarjestys], f.[7b_jarjestys], 
		f.[7e_jarjestys], f.[7f_jarjestys], f.[7g_jarjestys], f.[7h_jarjestys], f.[8a_jarjestys], f.[8b_jarjestys], f.[8e_jarjestys], f.[8f_jarjestys], f.[8g_jarjestys], f.[8h_jarjestys], 
		d10.lahde_koodi, 
		d6.koulutuslaji2_koodi
FROM  dbo.f_aloittaneiden_lapaisy f INNER JOIN
        dbo.d_kausi AS d1 ON d1.kausi_id = f.aloituskausikoodi INNER JOIN
        dbo.d_aidinkieli_versio1 AS d2 ON d2.id = f.aikielir1_id INNER JOIN
        dbo.d_sukupuoli AS d16 ON d16.id = f.sp_id INNER JOIN
        dbo.d_tarkastelujakso AS d17 ON d17.id = f.tarkastelujakso_id INNER JOIN
        dbo.d_alueluokitus AS d3 ON d3.id = f.alueluokitus_id INNER JOIN
        dbo.d_alueluokitus AS d4 ON d4.id = f.saavutettu_alueluokitus_id INNER JOIN
        dbo.d_ika AS d5 ON d5.id = f.ika_id INNER JOIN
        dbo.d_koulutuslaji2 AS d6 ON d6.id = f.koulutuslaji2_id INNER JOIN
        dbo.d_koulutusluokitus AS d7 ON d7.id = f.koulk_id INNER JOIN
        dbo.d_koulutusluokitus AS d8 ON d8.id = f.saavutettu_koulk_id INNER JOIN
        dbo.d_koulutusluokitus AS d9 ON d9.id = f.pohjkoulk_id INNER JOIN
        dbo.d_lahde AS d10 ON d10.id = f.lahde_id INNER JOIN
        dbo.d_opetushallinnon_koulutus AS d11 ON d11.id = f.ophal_id INNER JOIN
        dbo.d_opiskelijan_olo AS d12 ON d12.id = f.ololk_id INNER JOIN
        dbo.d_oppilaitoksen_taustatiedot AS d13 ON d13.id = f.oppilaitoksen_taustatiedot_id INNER JOIN
        dbo.d_oppilaitoksen_taustatiedot AS d14 ON d14.id = f.saavutettu_oppilaitoksen_taustatiedot_id INNER JOIN
        dbo.d_rahoituslahde AS d15 ON d15.id = f.rahlahde_id
WHERE   (f.aineistokoodi = ''K3.9'') AND (d10.lahde_koodi = 21) AND (d17.tarkastelujakso <> ''0,5 vuotta'') AND 
		(f.[1a Aloittaneiden opintojen kulku koulutuslajin mukaan prioriteettina mikä tahansa tutkinto] <> ''Virhetilanne'')

















' 
GO
/****** Object:  View [dbo].[v_f_aloittaneiden_lapaisy_K3_9_yhteiset]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_aloittaneiden_lapaisy_K3_9_yhteiset]'))
EXEC dbo.sp_executesql @statement = N'


















CREATE VIEW [dbo].[v_f_aloittaneiden_lapaisy_K3_9_yhteiset]
AS
SELECT f.lkm_int AS lkm_int2, 
		d1.lukuvuosi AS Aloituslukuvuosi, 
		d1.vuosiselite AS Aloitusvuosi, 
		d1.lukukausiselite AS Aloituslukukausi, 
		d17.tarkastelujakso AS Tarkastelujakso, 		
		--d11.opetushallinnon_koulutus AS Hallinnonala, 
		d18.hallinnonala AS Hallinnonala, 
		d16.sukupuoli AS Sukupuoli, 
		d2.aidinkieli_versio1 AS Äidinkieli, 
		d5.ika AS Ikä, 
		d5.ika5v AS Ikäryhmä, 		
		d6.koulutuslaji2 AS [Tavoitetutk. koulutuslaji], 
		d6.koulutuslaji2 AS [Tavoitetutk. koulutustyyppi],
		d6.jarjestamistapa AS [Tavoitetutk. järjestämistapa],
		d6.jarjestamismuoto AS [Tavoitetutk. järjestämismuoto],
		d6.tutkintotyyppi AS [Tavoitetutk. tutkintotyyppi],
		d7.koulutusaste2002 AS [Tavoitetutk. koulutusaste], 
		d7.koulutusala2002 AS [Tavoitetutk. koulutusala], 		
		d7.opintoala2002 AS [Tavoitetutk. opintoala], 
		d7.koulutus AS [Tavoitetutk. koulutusnimike], 
		d8.koulutusaste2002 AS [Suor. tutkinnon koulutusaste], 
		d8.koulutusala2002 AS [Suor. tutkinnon koulutusala], 		
		d8.opintoala2002 AS [Suor. tutkinnon opintoala], 
		d8.koulutus AS [Suor. tutkinnon koulutusnimike], 
		d9.koulutusaste2002 AS [Pohjakoul. koulutusaste], 
		d9.koulutusala2002 AS [Pohjakoul. koulutusala], 		
		d9.opintoala2002 AS [Pohjakoul. opintoala], 
		d9.koulutus AS [Pohjakoul. koulutusnimike], 
		d3.kunta AS [Tavoitetutk. kunta], 
		d3.maakunta AS [Tavoitetutk. maakunta], 
		d3.avi AS [Tavoitetutk. AVI], 		
		d3.ely AS [Tavoitetutk. ELY], 
		d3.seutukunta AS [Tavoitetutk. seutukunta], 
		d3.suuralue AS [Tavoitetutk. suuralue], 
		d3.kuntaryhma AS [Tavoitetutk. kuntaryhmä], 
		d3.laani AS [Tavoitetutk. lääni], 		
		d3.tyovoima_elinkeinokeskus AS [Tavoitetutk. työvoima ja elinkeinokeskus], 
		d3.kielisuhde AS [Tavoitetutk. kunnan kielisuhde], 
		d4.kunta AS [Suor. tutkinnon kunta], 
		d4.maakunta AS [Suor. tutkinnon maakunta], 		
		d4.avi AS [Suor. tutkinnon AVI], 
		d4.ely AS [Suor. tutkinnon ELY], 
		d4.seutukunta AS [Suor. tutkinnon seutukunta], 
		d4.suuralue AS [Suor. tutkinnon suuralue], 
		d4.kuntaryhma AS [Suor. tutkinnon kuntaryhmä], 		
		d4.laani AS [Suor. tutkinnon lääni], 
		d4.tyovoima_elinkeinokeskus AS [Suor. tutkinnon työvoima ja elinkeinokeskus], 
		d4.kielisuhde AS [Suor. tutkinnon kunnan kielisuhde], 
		d12.opiskelijan_olo AS Kirjoillaolo, 		
		d15.rahoituslahde AS [Tavoitetutk. rahoituslähde], 
		d13.oppilaitos AS [Tavoitetutk. oppilaitos], 
		d13.oppilaitostyyppi AS [Tavoitetutk. oppil.tyyppi], 		
		d13.oppilaitoksen_omistajatyyppi AS [Tavoitetutk. oppil. omistajatyyppi], 
		d13.opetuskieli AS [Tavoitetutk. oppil. opetuskieli], 
		d13.koulutuksen_jarjestaja AS [Tavoitetutk. koul. järjestäjä], 		
		d13.koulutuksen_jarjestajan_omistajatyyppi AS [Tavoitetutk. koul. järjestäjän omistajatyyppi], 
		d13.koulutuksen_jarjestajan_kieli AS [Tavoitetutk. koul. järjestäjän kieli], 		
		d14.oppilaitos AS [Suor. tutkinnon oppilaitos], 
		d14.oppilaitostyyppi AS [Suor. tutkinnon oppil.tyyppi], 
		d14.oppilaitoksen_omistajatyyppi AS [Suor. tutkinnon oppil. omistajatyyppi], 		
		d14.opetuskieli AS [Suor. tutkinnon oppil. opetuskieli], 
		d14.koulutuksen_jarjestaja AS [Suor. tutkinnon koul. järjestäjä], 		
		d14.koulutuksen_jarjestajan_omistajatyyppi AS [Suor. tutkinnon koul. järjestäjän omistajatyyppi], 
		d14.koulutuksen_jarjestajan_kieli AS [Suor. tutkinnon koul. järjestäjän kieli], 		
		f.[1a Aloittaneiden opintojen kulku koulutuslajin mukaan prioriteettina mikä tahansa tutkinto] AS [Opintojen kulku], 		
		f.[1b Aloittaneiden opintojen kulku koulutuslajin mukaan prioriteettina tutkinto ja opiskelu alkuperäisessä tutkintolajissa] AS [Opintojen kulku prioriteetti 2], 		
		f.[1c Aloittaneista tutkinnon suorittaneet koulutuslajin mukaan] AS [Suoritettu tutkinto], 
		f.[1d Aloittaneista ilman tutkintoa opiskelua jatkavat koulutuslajin mukaan] AS [Opiskelua jatkavat tutk.lajin mukaan], 		
		f.[1e Aloittaneista alkuperäisen koulutuslajin tutkinnon suorittaneet koulutuslajin mukaan] AS [Tutkinto tavoitet. tutkintolajissa], 		
		f.[1f Aloittaneista muun kuin alkuperäisen tutkintolajin tutkinnon suorittaneet koulutuslajin mukaan] AS [Tutkinto muussa tutkintolajissa], 		
		f.[1g Aloittaneista alkuperäisen tutkintolajin opiskelua jatkavat koulutuslajin mukaan] AS [Opiskelee tavoitet. tutkintolajissa], 		
		f.[1h Aloittaneista muun tutkintolajin opiskelua jatkavat koulutuslajin mukaan] AS [Opiskelee muussa tutkintolajissa], 		
		f.[2a Aloittaneiden opintojen kulku koulutusalan (2002) mukaan prioriteettina mikä tahansa tutkinto] AS [Opintojen kulku koulutusaloittain],
		f.[2b Aloittaneiden opintojen kulku koulutusalan (2002) mukaan prioriteettina tutkinto ja opiskelu alkuperäisellä] AS [Opintojen kulku koulutusaloittain prioriteetti 2], 		
		f.[2e Aloittaneista alkuperäisen koulutusalan (2002) tutkinnon suorittaneet koulutusalan mukaan] AS [Tutkinto tavoitet. koulutusalalla], 		
		f.[2f Aloittaneista muun kuin alkuperäisen tutkintolajin tutkinnon suorittaneet koulutuslajin mukaan] AS [Tutkinto muulla koulutusalalla], 		
		f.[2g Aloittaneista alkuperäisellä koulutusalalla opiskelua jatkavat koulutusalan mukaan] AS [Opiskelee tavoitet. koulutusalalla], 		
		f.[2h Aloittaneista muulla koulutusalalla opiskelua jatkavat koulutusalan mukaan] AS [Opiskelee muulla koulutusalalla], 		
		f.[3a Aloittaneiden opintojen kulku opintoalan (2002) mukaan prioriteettina mikä tahansa tutkinto] AS [Opintojen kulku opintoaloittain], 		
		f.[3b Aloittaneiden opintojen kulku opintoalan (2002) mukaan prioriteettina tutkinto ja opiskelu alkuperäisellä] AS [Opintojen kulku opintoaloittain prioriteetti 2], 		
		f.[3e Aloittaneista alkuperäisen opintoalan (2002) tutkinnon suorittaneet opintoalan mukaan] AS [Tutkinto tavoitet. opintoalalla], 		
		f.[3f Aloittaneista muun opintoalan (2002) tutkinnon suorittaneet opintoalan mukaan] AS [Tutkinto muulla opintoalalla], 		
		f.[3g Aloittaneista alkuperäisellä opintoalalla (2002) opiskelua jatkavat opintoalan mukaan] AS [Opiskelee tavoitet. opintoalalla], 		
		f.[3h Aloittaneista muulla opintoalalla (2002) opiskelua jatkavat opintoalan mukaan] AS [Opiskelee muulla opintoalalla], 		
		f.[4a Aloittaneiden opintojen kulku koulutuksen järjestäjän mukaan, toinen aste prioriteettina tutkinto missä tahansa] AS [Opintojen kulku koul. järjestäjittäin], 		
		f.[4b Aloittaneiden opintojen kulku koulutuksen järjestäjän mukaan, toinen aste prioriteettina tutkinto ja opiskelu alkuperäisellä] AS [Opintojen kulku koul. järjestäjittäin prioriteetti 2], 		
		f.[4e Aloittaneista alkuperäisen koulutuksen järjestäjän tutkinnon suorittaneet järjestäjän mukaan] AS [Tutkinto tavoitet. koul. järjestäjällä], 		
		f.[4f Aloittaneista muun koulutuksen järjestäjän tutkinnon suorittaneet järjestäjän mukaan] AS [Tutkinto muulla koul. järjestäjällä], 		
		f.[4g Aloittaneista alkuperäisellä järjestäjällä opiskelua jatkavat järjestäjän mukaan] AS [Opiskelee tavoitet. koul. järjestäjällä], 		
		f.[4h Aloittaneista muulla järjestäjällä opiskelua jatkavat järjestäjän mukaan] AS [Opiskelee muulla koul. järjestäjällä], 
		f.[5a Aloittaneiden opintojen kulku oppilaitoksen mukaan prioriteettina tutkinto missä tahansa] AS [Opintojen kulku oppilaitoksittain], 		
		f.[5b Aloittaneiden opintojen kulku oppilaitoksen mukaan prioriteettina tutkinto ja opiskelu alkuperäisessä] AS [Opintojen kulku oppilaitoksittain prioriteetti 2], 		
		f.[5e Aloittaneista alkuperäisessä oppilaitoksessa tutkinnon suorittaneet oppilaitoksen mukaan] AS [Tutkinto tavoitet. oppilaitoksessa], 		
		f.[5f Aloittaneista muussa oppilaitoksessa tutkinnon suorittaneet oppilaitoksen mukaan] AS [Tutkinto muussa oppilaitoksessa], 		
		f.[5g Aloittaneista alkuperäisessä oppilaitoksessa opiskelua jatkavat oppilaitoksen mukaan] AS [Opiskelee tavoitet. oppilaitoksessa], 		
		f.[5h Aloittaneista muussa oppilaitoksessa opiskelua jatkavat oppilaitoksen mukaan] AS [Opiskelee muussa oppilaitoksessa], 		
		f.[6a Aloittaneiden opintojen kulku maakunnan mukaan prioriteettina tutkinto missä tahansa] AS [Opintojen kulku maakunnittain], 		
		f.[6b Aloittaneiden opintojen kulku maakunnan mukaan prioriteettina tutkinto ja opiskelu alkuperäisessä] AS [Opintojen kulku maakunnittain prioriteetti 2], 		
		f.[6e Aloittaneista alkuperäisessä maakunnassa tutkinnon suorittaneet maakunnan mukaan] AS [Tutkinto tavoitet. maakunnassa], 		
		f.[6f Aloittaneista muussa maakunnassa tutkinnon suorittaneet maakunnan mukaan] AS [Tutkinto muussa maakunnassa], 		
		f.[6g Aloittaneista alkuperäisessä maakunnassa opiskelua jatkavat maakunnan mukaan] AS [Opiskelee tavoitet. maakunnassa], 		
		f.[6h Aloittaneista muussa maakunnassa opiskelua jatkavat maakunnan mukaan] AS [Opiskelee muussa maakunnassa], 		
		f.[7a Aloittaneiden opintojen kulku koulutussektorin mukaan prioriteettina tutkinto missä tahansa] AS [Opintojen kulku koul.sektoreittan], 		
		f.[7b Aloittaneiden opintojen kulku koulutussektorin mukaan prioriteettina tutkinto ja opiskelu alkuperäisellä] AS [Opintojen kulku koul.sektoreittan prioriteetti 2], 		
		f.[7e Aloittaneista alkuperäisen koulutussektorin tutkinnon suorittaneet koulutussektorin mukaan] AS [Tutkinto tavoitet. koulutussektorilla], 		
		f.[7f Aloittaneista muun koulutussektorin tutkinnon suorittaneet koulutussektorin mukaan] AS [Tutkinto muulla koulutussektorilla], 		
		f.[7g Aloittaneista alkuperäisellä koulutussektorilla opiskelua jatkavat koulutussektorin mukaan] AS [Opiskelee tavoitet. koulutussektorilla], 		
		f.[7h Aloittaneista muulla koulutussektorilla opiskelua jatkavat koulutussektorin mukaan] AS [Opiskelee muulla koulutussektorilla], 		
		f.[8a Aloittaneiden opintojen kulku opintoalan (1995) mukaan prioriteettina mikä tahansa tutkinto] AS [Opintojen kulku koul.aloittain (95)], 		
		f.[8b Aloittaneiden opintojen kulku opintoalan (1995) mukaan prioriteettina tutkinto ja opiskelu alkuperäisellä] AS [Opintojen kulku koul.aloittain (95) prioriteetti 2], 		
		f.[8e Aloittaneista alkuperäisen opintoalan (1995) tutkinnon suorittaneet opintoalan mukaan] AS [Tutkinto tavoitet. koulutusalalla (95)], 		
		f.[8f Aloittaneista muun opintoalan (1995) tutkinnon suorittaneet opintoalan mukaan] AS [Tutkinto muulla koulutusalalla (95)], 		
		f.[8g Aloittaneista alkuperäisellä opintoalalla (1995) opiskelua jatkavat opintoalan mukaan] AS [Opiskelee tavoitet. koulutusalalla (95)], 		
		f.[8h Aloittaneista muulla opintoalalla (1995) opiskelua jatkavat opintoalan mukaan] AS [Opiskelee muulla koulutusalalla (95)], 
		f.aloitus_saavutus AS [Aloitus saavutus], 		
		f.tarkastelujakso_tulevaisuus AS [Tarkastelujakson tulevaisuus], 
		f.tarkastelujakso_edustavuus AS [Tarkastelujakson edustavuus], 
		d10.lahde AS Lähde, 
		--ruotsi
		d1.lukuvuosi AS Begynnelseläsår, 
		d1.vuosiselite_SV AS Begynnelseår, 
		d1.lukukausiselite_SV AS Begynnelsetermin, 
		d17.tarkastelujakso_SV AS Granskningsperiod, 
		d16.sukupuoli_SV AS Kön, 
		--d11.opetushallinnon_koulutus_SV AS Förvaltningsområde, 
		d18.hallinnonala_SV  AS Förvaltningsområde, 
		d2.aidinkieli_versio1_SV AS Modersmål, 
		d5.ika_SV AS Ålder, 
		d5.ika5v_SV AS Åldersgrupp, 
		d6.koulutuslaji2_SV AS [Målexamens examensslag], 
		d6.koulutuslaji2_SV AS [Målexamens typ av utbildn.], 
		d6.jarjestamistapa_SV AS [Målexamens sättet],
		d6.jarjestamismuoto_SV AS [Målexamens formen],
		d6.tutkintotyyppi_SV AS [Målexamens typ],
		d7.koulutusaste2002_SV AS [Målexamens utbildn.nivå 2002], 
		d7.koulutusala2002_SV AS [Målexamens utbildn.område 02], 
		d7.opintoala2002_SV AS [Målexamens studieområde 02], 
		d7.koulutus_SV AS [Målexamens utbildn.benämning], 
		d8.koulutusaste2002_SV AS [Examens utbildn.nivå 2002], 
		d8.koulutusala2002_SV AS [Examens utbildn.område 2002], 
		d8.opintoala2002_SV AS [Examens studieområde 2002], 
		d8.koulutus_SV AS [Examens utbildn.benämning], 
		d9.koulutusaste2002_SV AS [Grundutb. utbildn.nivå 2002], 
		d9.koulutusala2002_SV AS [Grundutb. utbildn.område 2002], 
		d9.opintoala2002_SV AS [Grundutb. studieområde 2002], 
		d9.koulutus_SV AS [Grundutb. utbildn.benämning], 
		d3.maakunta_SV AS [Målexamens landskap], 
		d3.avi_SV AS [Målexamens RVF], 		
		d3.ely_SV AS [Målexamens NTM], 
		d3.kunta_SV AS [Målexamens kommun], 
		d4.maakunta_SV AS [Examens landskap], 
		d4.avi_SV AS [Examens RVF], 
		d4.ely_SV AS [Examens NTM], 
		d4.kunta_SV AS [Examens kommun], 
		d12.opiskelijan_olo_SV AS Inskrivning, 
		d13.koulutuksen_jarjestaja_SV AS [Målexamens utbildn.ordnare],
		d14.koulutuksen_jarjestaja_SV AS [Examens utbildn.ordnare], 
		[Studieförlopp] = 
			case f.[1a Aloittaneiden opintojen kulku koulutuslajin mukaan prioriteettina mikä tahansa tutkinto]
				when ''Tutkinto alkuperäisessä tutkintolajissa'' then ''Examen i det ursprungliga examensslaget''
				when ''Tutkinto muussa tutkintolajissa'' then ''Examen i annat examensslag''
				when ''Tutkinto muussa tutkintolajissa, kandidaatin tutkinto'' then ''Examen i annat examensslag, lägre högskoleexamen''
				when ''Opiskelee alkuperäisessä tutkintolajissa'' then ''Studerar i det ursprungliga examensslaget''
				when ''Opiskelee muussa tutkintolajissa'' then ''Studerar i annat examensslag''
				when ''Ei tutkintoa, ei opiskele, työllinen'' then ''Ingen examen, inte studerar, sysselsatt''
				when ''Ei tutkintoa, ei opiskele, ei työllinen'' then ''Ingen examen, inte studerar, arbetslös''
				else  ''Information saknas''
			end , 
		[Studieförlopp prior. 2] =
			case f.[1b Aloittaneiden opintojen kulku koulutuslajin mukaan prioriteettina tutkinto ja opiskelu alkuperäisessä tutkintolajissa]
				when ''Tutkinto alkuperäisessä tutkintolajissa'' then ''Examen i det ursprungliga examensslaget''
				when ''Tutkinto muussa tutkintolajissa'' then ''Examen i annat examensslag''
				when ''Tutkinto muussa tutkintolajissa, kandidaatin tutkinto'' then ''Examen i annat examensslag, lägre högskoleexamen''
				when ''Opiskelee alkuperäisessä tutkintolajissa'' then ''Studerar i det ursprungliga examensslaget''
				when ''Opiskelee muussa tutkintolajissa'' then ''Studerar i annat examensslag''
				when ''Ei tutkintoa, ei opiskele, työllinen'' then ''Ingen examen, inte studerar, sysselsatt''
				when ''Ei tutkintoa, ei opiskele, ei työllinen'' then ''Ingen examen, inte studerar, arbetslös''
				else ''Information saknas''
			end			, 
		[Avlagt examen] =
			case f.[1c Aloittaneista tutkinnon suorittaneet koulutuslajin mukaan]
				when ''Tutkinto lukiokoulutuksesta'' then ''Studentexamen''
				when ''Ammatillinen perustutkinto'' then ''Grundläggande yrkesexamen''
				when ''Ammatillinen lisäkoulutus ammattitutkinto tai erikoisammattitutkinto'' then ''Yrkesinriktad tilläggsutbildning, yrkesexamen eller specialyrkesexamen''
				when ''Muu korkein ja viimeisimmäksi suoritettu tutkinto, toinen aste'' then ''Övrig högsta och senast avlagd examen, andra stadiet''
				when ''Ammattikorkeakoulututkinto'' then ''Yrkeshögskoleexamen''
				when ''Alempi korkeakoulututkinto'' then ''Lägre högskoleexamen''
				when ''Ylempi ammattikorkeakoulututkinto'' then ''Högre yrkeshögskoleexamen''
				when ''Ylempi korkeakoulututkinto'' then ''Högre högskoleexamen''
				when ''Tutkijakoulutusasteen tutkinto'' then ''Examen på forskarutbildningsnivå''
				when ''Muu korkein ja viimeisimmäksi suoritettu tutkinto, korkeakoulututkinto'' then ''Övrig högsta och senast avlagd examen, högskoleexamen''
				when ''Ei tutkintoa'' then ''Ingen examen''
				when ''Virhetilanne'' then ''Information saknas''
			end, 
		[Examen i målex. examensslag] = 
			case f.[1e Aloittaneista alkuperäisen koulutuslajin tutkinnon suorittaneet koulutuslajin mukaan]
				when ''Kyllä'' then ''Ja''
				when ''Ei'' then ''Inte''
				when ''Virhetilanne'' then ''Information saknas''
			end
		, 
		[Examen i annat examensslag] = 
			case [1f Aloittaneista muun kuin alkuperäisen tutkintolajin tutkinnon suorittaneet koulutuslajin mukaan]
				when ''Kyllä'' then ''Ja''
				when ''Ei'' then ''Inte''
				when ''Virhetilanne'' then ''Information saknas''
			end	
			, 
		[Examen i målex. utbildn.område 02] =
			case [2e Aloittaneista alkuperäisen koulutusalan (2002) tutkinnon suorittaneet koulutusalan mukaan]
				when ''Kyllä'' then ''Ja''
				when ''Ei'' then ''Inte''
				when ''Virhetilanne'' then ''Information saknas''
			end	
		, 
		[Examen i målex. studieområde 02] = 
			case [3e Aloittaneista alkuperäisen opintoalan (2002) tutkinnon suorittaneet opintoalan mukaan]
				when ''Kyllä'' then ''Ja''
				when ''Ei'' then ''Inte''
				when ''Virhetilanne'' then ''Information saknas''
			end	
		, 
		[Examen i målex. läroanstalt] = 
			case [5e Aloittaneista alkuperäisessä oppilaitoksessa tutkinnon suorittaneet oppilaitoksen mukaan] 
				when ''Kyllä'' then ''Ja''
				when ''Ei'' then ''Inte''
				when ''Virhetilanne'' then ''Information saknas''
			end	
		, 
		[Examen i målex. utbildn.område 95] = 
			case [8e Aloittaneista alkuperäisen opintoalan (1995) tutkinnon suorittaneet opintoalan mukaan]
				when ''Kyllä'' then ''Ja''
				when ''Ei'' then ''Inte''
				when ''Virhetilanne'' then ''Information saknas''
			end	
		, 
		--englanti
		d1.lukuvuosi AS [First academic year], 
		d1.vuosiselite_EN AS [First year of studies], 
		d1.lukukausiselite_EN AS [First term], 
		d17.tarkastelujakso_EN AS [Reference period], 
		d16.sukupuoli_EN AS Gender, 
		--d11.opetushallinnon_koulutus_EN AS [Administrative sector], 
		d18.hallinnonala_EN AS [Administrative sector],
		d2.aidinkieli_versio1_EN AS [Mother tongue], 
		d5.ika_EN AS Age, 
		d5.ika5v_EN AS [Age group], 
		d6.koulutuslaji2_EN AS [Target qualif. form of qual.], 
		d6.koulutuslaji2_EN AS [Target qualif. type of ed.], 
		d6.jarjestamistapa_EN AS [Target qualif. method],
		d6.jarjestamismuoto_EN AS [Target qualif. form],
		d6.tutkintotyyppi_EN AS [Target qualif. qual. type],
		d7.koulutusaste2002_EN AS [Target qual. level of ed. 02], 
		d7.koulutusala2002_EN AS [Target qual. field of ed. 02], 
		d7.opintoala2002_EN AS [Target qual. subfield of ed. 02], 
		d7.koulutus_EN AS [Target qual. name of ed.], 
		d8.koulutusaste2002_EN AS [Qualif. level of ed. 02], 
		d8.koulutusala2002_EN AS [Qualif. field of ed. 02], 
		d8.opintoala2002_EN AS [Qualif. subfield of ed. 02], 
		d8.koulutus_EN AS [Qualif. name of ed.], 
		d9.koulutusaste2002_EN AS [Previous qual. level of ed. 02], 
		d9.koulutusala2002_EN AS [Previous qual. field of ed. 02], 
		d9.opintoala2002_EN AS [Previous qual. subfield of ed. 02], 
		d9.koulutus_EN AS [Previous qual. name of ed.], 
		d3.maakunta_EN AS [Target qualif. region], 
		d3.avi_EN AS [Target qualif. AVI], 		
		d3.ely_EN AS [Target qualif. ELY], 
		d3.kunta_EN AS [Target qualif. municipal.], 
		d4.maakunta_EN AS [Qualifcation''s region], 
		d4.avi_EN AS [Qualifcation''s AVI], 
		d4.ely_EN AS [Qualifcation''s ELY], 
		d4.kunta_EN AS [Qualifcation''s municipality], 
		d12.opiskelijan_olo_EN AS [Enrollment status], 
		d13.koulutuksen_jarjestaja_EN AS [Target qual. ed. provider],
		d14.koulutuksen_jarjestaja_EN AS [Qualification''s ed. provider], 
		[Study progress] =
			case f.[1a Aloittaneiden opintojen kulku koulutuslajin mukaan prioriteettina mikä tahansa tutkinto]
				when ''Tutkinto alkuperäisessä tutkintolajissa'' then ''Qualification in the original form of degree''
				when ''Tutkinto muussa tutkintolajissa'' then ''Qualification in another form of degree''
				when ''Tutkinto muussa tutkintolajissa, kandidaatin tutkinto'' then ''Qualification in another form of degree, Bachelor''''s degree''
				when ''Opiskelee alkuperäisessä tutkintolajissa'' then ''Studying in the original form of degree''
				when ''Opiskelee muussa tutkintolajissa'' then ''Studying in another form of degree''
				when ''Ei tutkintoa, ei opiskele, työllinen'' then ''No qualification, not studying, employed''
				when ''Ei tutkintoa, ei opiskele, ei työllinen'' then ''No qualification, not studying, unemployed''
				else  ''Missing data''
			end ,
		[Study progress prior. 2] = 
			case f.[1b Aloittaneiden opintojen kulku koulutuslajin mukaan prioriteettina tutkinto ja opiskelu alkuperäisessä tutkintolajissa]
				when ''Tutkinto alkuperäisessä tutkintolajissa'' then ''Qualification in the original form of degree''
				when ''Tutkinto muussa tutkintolajissa'' then ''Qualification in another form of degree''
				when ''Tutkinto muussa tutkintolajissa, kandidaatin tutkinto'' then ''Qualification in another form of degree, Bachelor''''s degree''
				when ''Opiskelee alkuperäisessä tutkintolajissa'' then ''Studying in the original form of degree''
				when ''Opiskelee muussa tutkintolajissa'' then ''Studying in another form of degree''
				when ''Ei tutkintoa, ei opiskele, työllinen'' then ''No qualification, not studying, employed''
				when ''Ei tutkintoa, ei opiskele, ei työllinen'' then ''No qualification, not studying, unemployed''
				else  ''Missing data''
			end , 
		[Completed qualification] =
			case f.[1c Aloittaneista tutkinnon suorittaneet koulutuslajin mukaan]
				when ''Tutkinto lukiokoulutuksesta'' then ''Matriculation examination''
				when ''Ammatillinen perustutkinto'' then ''Vocational upper secondary qualification''
				when ''Ammatillinen lisäkoulutus ammattitutkinto tai erikoisammattitutkinto'' then ''Further vocational qualification or specialist vocational qualification''
				when ''Muu korkein ja viimeisimmäksi suoritettu tutkinto, toinen aste'' then ''Other highest and most recent degree, upper secondary education''
				when ''Ammattikorkeakoulututkinto'' then ''UAS degree''
				when ''Alempi korkeakoulututkinto'' then ''Bachelor''''s degree''
				when ''Ylempi ammattikorkeakoulututkinto'' then ''UAS Master''''s degree''
				when ''Ylempi korkeakoulututkinto'' then ''Master''''s degree''
				when ''Tutkijakoulutusasteen tutkinto'' then ''Research degree''
				when ''Muu korkein ja viimeisimmäksi suoritettu tutkinto, korkeakoulututkinto'' then ''Other highest and most recent degree, higher education''
				when ''Ei tutkintoa'' then ''No degree''
				when ''Virhetilanne'' then ''Missing data''
			end, 
		[Completed in target form of qual.] =
			case f.[1e Aloittaneista alkuperäisen koulutuslajin tutkinnon suorittaneet koulutuslajin mukaan]
				when ''Kyllä'' then ''Yes''
				when ''Ei'' then ''No''
				when ''Virhetilanne'' then ''Missing data''
			end, 
		[Completed in another form of qual.] =
			case f.[1f Aloittaneista muun kuin alkuperäisen tutkintolajin tutkinnon suorittaneet koulutuslajin mukaan]
				when ''Kyllä'' then ''Yes''
				when ''Ei'' then ''No''
				when ''Virhetilanne'' then ''Missing data''
			end, 
		 [Completed in target field of ed. 02] =
			case f.[2e Aloittaneista alkuperäisen koulutusalan (2002) tutkinnon suorittaneet koulutusalan mukaan]
				when ''Kyllä'' then ''Yes''
				when ''Ei'' then ''No''
				when ''Virhetilanne'' then ''Missing data''
			end, 
		[Completed in target subfield of ed. 02] =
			case f.[3e Aloittaneista alkuperäisen opintoalan (2002) tutkinnon suorittaneet opintoalan mukaan]
				when ''Kyllä'' then ''Yes''
				when ''Ei'' then ''No''
				when ''Virhetilanne'' then ''Missing data''
			end, 
		 [Completed in target ed. institution] =
			case f.[5e Aloittaneista alkuperäisessä oppilaitoksessa tutkinnon suorittaneet oppilaitoksen mukaan]
				when ''Kyllä'' then ''Yes''
				when ''Ei'' then ''No''
				when ''Virhetilanne'' then ''Missing data''
			end, 
		 [Completed in target field of ed. 95] =
			case f.[8e Aloittaneista alkuperäisen opintoalan (1995) tutkinnon suorittaneet opintoalan mukaan]
				when ''Kyllä'' then ''Yes''
				when ''Ei'' then ''No''
				when ''Virhetilanne'' then ''Missing data''
			end,  
		--koodit
		d7.koulutusaste2002_Koodi AS [Koodit Tavoitetutk. koulutusaste 2002], 
		d7.koulutusala2002_Koodi AS [Koodit Tavoitetutk. koul.ala 2002], 
		d7.opintoala2002_Koodi AS [Koodit Tavoitetutk. opintoala 2002], 
		d7.koulutus_Koodi AS [Koodit Tavoitetutk. koulutusnimike], 
		d8.koulutusaste2002_Koodi AS [Koodit Suor. tutkinnon koulutusaste 2002], 
		d8.koulutusala2002_Koodi AS [Koodit Suor. tutkinnon koul.ala 2002], 
		d8.opintoala2002_Koodi AS [Koodit Suor. tutkinnon opintoala 2002], 
		d8.koulutus_Koodi AS [Koodit Suor. tutkinnon koulutusnimike], 
		d9.koulutusaste2002_Koodi AS [Koodit Pohjakoul. koulutusaste 2002], 
		d9.koulutusala2002_Koodi AS [Koodit Pohjakoul. koul.ala 2002], 
		d9.opintoala2002_Koodi AS [Koodit Pohjakoul. opintoala 2002], 
		d9.koulutus_Koodi AS [Koodit Pohjakoul. koulutusnimike], 
		d3.maakunta_Koodi AS [Koodit Tavoitetutk. maakunta], 
		d4.maakunta_Koodi AS [Koodit Suor. tutkinnon maakunta], 
		d13.koulutuksen_jarjestajakoodi AS [Koodit Tavoitetutk. koul. järjestäjä],
		--jarjestys
		d1.jarjestys AS lukukausi_jarjestys, 		
		d17.jarjestys AS tarkastelujakso_jarjestys, 
		--d11.jarjestys AS opetushallinnon_koulutus_jarjestys, 
		d18.jarjestys AS opetushallinnon_koulutus_jarjestys, 
		d16.jarjestys AS sukupuoli_jarjestys, 
		d2.jarjestys AS aidinkieli_jarjestys, 
		d5.jarjestys_ika, 
		d5.jarjestys_ika5v, 		
		d6.jarjestys_koulutuslaji2 AS koulutuslaji_jarjestys,
		d6.jarjestys_jarjestamistapa,
		d6.jarjestys_jarjestamismuoto,
		d6.jarjestys_tutkintotyyppi,
		d7.jarjestys_koulutusaste2002, 
		d7.jarjestys_koulutusala2002, 
		d7.jarjestys_opintoala2002 AS jarjestys_opintoala, 
		d7.jarjestys AS jarjestys_koulutusnimike, 		
		d8.jarjestys_koulutusaste2002 AS jarjestys_suor_koulutusaste2002, 
		d8.jarjestys_koulutusala2002 AS jarjestys_suor_koulutusala2002, 
		d8.jarjestys_opintoala2002 AS jarjestys_suor_opintoala, 		
		d8.jarjestys AS jarjestys_suor_koulutusnimike, 
		d9.jarjestys_koulutusaste2002 AS jarjestys_pohj_koulutusaste2002, 
		d9.jarjestys_koulutusala2002 AS jarjestys_pohj_koulutusala2002, 		
		d9.jarjestys_opintoala2002 AS jarjestys_pohj_opintoala, 
		d9.jarjestys AS jarjestys_pohj_koulutusnimike, 
		d3.jarjestys AS alueluokitus_jarjestys, 
		d3.jarjestys_maakunta, 
		d3.jarjestys_avi, 
		d3.jarjestys_ely, 		
		d3.jarjestys_seutukunta, 
		d3.jarjestys_suuralue, 
		d3.jarjestys_kuntaryhma, 
		d3.jarjestys_laani, 
		d3.jarjestys_tyovoima_elinkeinokeskus, 
		d3.jarjestys_kielisuhde, 
		d4.jarjestys AS saavutettu_al_jarjestys, 		
		d4.jarjestys_maakunta AS saavutettu_al_jarjestys_maakunta, 
		d4.jarjestys_avi AS saavutettu_al_jarjestys_avi, 
		d4.jarjestys_ely AS saavutettu_al_jarjestys_ely, 		
		d4.jarjestys_seutukunta AS saavutettu_al_jarjestys_seutukunta, 
		d4.jarjestys_suuralue AS saavutettu_al_jarjestys_suuralue, 
		d4.jarjestys_kuntaryhma AS saavutettu_al_jarjestys_kuntaryhma, 		
		d4.jarjestys_laani AS saavutettu_al_jarjestys_laani, 
		d4.jarjestys_tyovoima_elinkeinokeskus AS saavutettu_al_jarjestys_tyovoima_elinkeinokeskus, 		
		d4.jarjestys_kielisuhde AS saavutettu_al_jarjestys_kielisuhde, 
		d12.jarjestys AS opiskelijan_olo_jarjestys, 
		d15.jarjestys AS rahoituslahde_jarjestys, 
		d13.jarjestys_oppilaitos, 
		d13.jarjestys_oppilaitostyyppi, 		
		d13.jarjestys_omistajatyyppi, 
		d13.jarjestys_opetuskieli, 
		d13.jarjestys_koulutuksen_jarjestaja, 
		d13.jarjestys_koulutuksenjarjestaja, 
		d13.jarjestys_koulutuksen_jarjestajan_kieli, 		
		d14.jarjestys_oppilaitos AS saavutettu_jarjestys_oppilaitos, 
		d14.jarjestys_oppilaitostyyppi AS saavutettu_jarjestys_oppilaitostyyppi, 
		d14.jarjestys_omistajatyyppi AS saavutettu_jarjestys_omistajatyyppi, 		
		d14.jarjestys_opetuskieli AS saavutettu_jarjestys_opetuskieli, 
		d14.jarjestys_koulutuksen_jarjestaja AS saavutettu_jarjestys_koulutuksen_jarjestaja, 		
		d14.jarjestys_koulutuksenjarjestaja AS saavutettu_jarjestys_koulutuksenjarjestaja, 
		d14.jarjestys_koulutuksen_jarjestajan_kieli AS saavutettu_jarjestys_koulutuksen_jarjestajan_kieli, 
		f.[1a_jarjestys], 
		f.[1b_jarjestys], f.[1c_jarjestys], f.[1d_jarjestys], f.[1e_jarjestys], f.[1f_jarjestys], f.[1g_jarjestys], f.[1h_jarjestys], f.[2a_jarjestys], f.[2b_jarjestys], f.[2e_jarjestys], f.[2f_jarjestys], f.[2g_jarjestys], f.[2h_jarjestys], 
		f.[3a_jarjestys], f.[3b_jarjestys], f.[3e_jarjestys], f.[3f_jarjestys], f.[3g_jarjestys], f.[3h_jarjestys], f.[4a_jarjestys], f.[4b_jarjestys], f.[4e_jarjestys], f.[4f_jarjestys], f.[4g_jarjestys], f.[4h_jarjestys], f.[5a_jarjestys], 
		f.[5b_jarjestys], f.[5e_jarjestys], f.[5f_jarjestys], f.[5g_jarjestys], f.[5h_jarjestys], f.[6a_jarjestys], f.[6b_jarjestys], f.[6e_jarjestys], f.[6f_jarjestys], f.[6g_jarjestys], f.[6h_jarjestys], f.[7a_jarjestys], f.[7b_jarjestys], 
		f.[7e_jarjestys], f.[7f_jarjestys], f.[7g_jarjestys], f.[7h_jarjestys], f.[8a_jarjestys], f.[8b_jarjestys], f.[8e_jarjestys], f.[8f_jarjestys], f.[8g_jarjestys], f.[8h_jarjestys], 
		d10.lahde_koodi, 
		d6.koulutuslaji2_koodi
		--isced
		,d7.iscle2011 as "Tavoitetutk. koul.aste 1"
		,d7.Koulutusaste_taso2 as "Tavoitetutk. koul.aste 2"
		,d7.iscfibroad2013 as "Tavoitetutk. koul.ala 1"
		,d7.iscfinarrow2013 as "Tavoitetutk. koul.ala 2"
		,d7.iscfi2013 as "Tavoitetutk. koul.ala 3"
		,d7.iscle2011_SV as "Målexamens utbildn.nivå 1"
		,d7.Koulutusaste_taso2_SV as "Målexamens utbildn.nivå 2"
		,d7.iscfibroad2013_SV as "Målexamens utbildn.omr. 1"
		,d7.iscfinarrow2013_SV as "Målexamens utbildn.omr. 2"
		,d7.iscfi2013_SV as "Målexamens utbildn.omr. 3"
		,d7.iscle2011_EN as "Target level of ed. 1"
		,d7.Koulutusaste_taso2_EN as "Target level of ed. 2"
		,d7.iscfibroad2013_EN as "Target field of ed. 1"
		,d7.iscfinarrow2013_EN as "Target field of ed. 2"
		,d7.iscfi2013_EN as "Target field of ed. 3"
		,d7.jarjestys_iscle2011 as jarj_isced_koulast1
		,d7.jarjestys_Koulutusaste_taso2 as jarj_isced_koulast2
		,d7.jarjestys_iscfibroad2013 as jarj_isced_koulala1
		,d7.jarjestys_iscfinarrow2013 as jarj_isced_koulala2
		,d7.jarjestys_iscfi2013 as jarj_isced_koulala3
		,d7.iscle2011_koodi as "Koodit Tavoitetutk. koul.aste 1"
		,d7.Koulutusaste_taso2_koodi as "Koodit Tavoitetutk. koul.aste 2"
		,d7.iscfibroad2013_koodi as "Koodit Tavoitetutk. koul.ala 1"
		,d7.iscfinarrow2013_koodi as "Koodit Tavoitetutk. koul.ala 2"
		,d7.iscfi2013_koodi as "Koodit Tavoitetutk. koul.ala 3"
		,d8.iscle2011 as "Suor. tutk. koul.aste 1"
		,d8.Koulutusaste_taso2 as "Suor. tutk. koul.aste 2"
		,d8.iscfibroad2013 as "Suor. tutk. koul.ala 1"
		,d8.iscfinarrow2013 as "Suor. tutk. koul.ala 2"
		,d8.iscfi2013 as "Suor. tutk. koul.ala 3"
		,d8.iscle2011_SV as "Examens utbildn.nivå 1"
		,d8.Koulutusaste_taso2_SV as "Examens utbildn.nivå 2"
		,d8.iscfibroad2013_SV as "Examens utbildn.omr. 1"
		,d8.iscfinarrow2013_SV as "Examens utbildn.omr. 2"
		,d8.iscfi2013_SV as "Examens utbildn.omr. 3"
		,d8.iscle2011_EN as "Qualif. level of ed. 1"
		,d8.Koulutusaste_taso2_EN as "Qualif. level of ed. 2"
		,d8.iscfibroad2013_EN as "Qualif. field of ed. 1"
		,d8.iscfinarrow2013_EN as "Qualif. field of ed. 2"
		,d8.iscfi2013_EN as "Qualif. field of ed. 3"
		,d8.jarjestys_iscle2011 as jarj_isced2_koulast1
		,d8.jarjestys_Koulutusaste_taso2 as jarj_isced2_koulast2
		,d8.jarjestys_iscfibroad2013 as jarj_isced2_koulala1
		,d8.jarjestys_iscfinarrow2013 as jarj_isced2_koulala2
		,d8.jarjestys_iscfi2013 as jarj_isced2_koulala3
		,d8.iscle2011_koodi as "Koodit Suor. tutk. koul.aste 1"
		,d8.Koulutusaste_taso2_koodi as "Koodit Suor. tutk. koul.aste 2"
		,d8.iscfibroad2013_koodi as "Koodit Suor. tutk. koul.ala 1"
		,d8.iscfinarrow2013_koodi as "Koodit Suor. tutk. koul.ala 2"
		,d8.iscfi2013_koodi as "Koodit Suor. tutk. koul.ala 3"
		,d9.iscle2011 as "Pohjakoul. koul.aste 1"
		,d9.Koulutusaste_taso2 as "Pohjakoul. koul.aste 2"
		,d9.iscfibroad2013 as "Pohjakoul. koul.ala 1"
		,d9.iscfinarrow2013 as "Pohjakoul. koul.ala 2"
		,d9.iscfi2013 as "Pohjakoul. koul.ala 3"
		,d9.iscle2011_SV as "Grundutb. utbildn.nivå 1"
		,d9.Koulutusaste_taso2_SV as "Grundutb. utbildn.nivå 2"
		,d9.iscfibroad2013_SV as "Grundutb. utbildn.omr. 1"
		,d9.iscfinarrow2013_SV as "Grundutb. utbildn.omr. 2"
		,d9.iscfi2013_SV as "Grundutb. utbildn.omr. 3"
		,d9.iscle2011_EN as "Previous qual. level of ed. 1"
		,d9.Koulutusaste_taso2_EN as "Previous qual. level of ed. 2"
		,d9.iscfibroad2013_EN as "Previous qual. field of ed. 1"
		,d9.iscfinarrow2013_EN as "Previous qual. field of ed. 2"
		,d9.iscfi2013_EN as "Previous qual. field of ed. 3"
		,d9.jarjestys_iscle2011 as jarj_isced3_koulast1
		,d9.jarjestys_Koulutusaste_taso2 as jarj_isced3_koulast2
		,d9.jarjestys_iscfibroad2013 as jarj_isced3_koulala1
		,d9.jarjestys_iscfinarrow2013 as jarj_isced3_koulala2
		,d9.jarjestys_iscfi2013 as jarj_isced3_koulala3
		,d9.iscle2011_koodi as "Koodit Pohjakoul. koul.aste 1"
		,d9.Koulutusaste_taso2_koodi as "Koodit Pohjakoul. koul.aste 2"
		,d9.iscfibroad2013_koodi as "Koodit Pohjakoul. koul.ala 1"
		,d9.iscfinarrow2013_koodi as "Koodit Pohjakoul. koul.ala 2"
		,d9.iscfi2013_koodi as "Koodit Pohjakoul. koul.ala 3"
FROM dbo.f_aloittaneiden_lapaisy f INNER JOIN
        dbo.d_kausi AS d1 ON d1.kausi_id = f.aloituskausikoodi INNER JOIN
        dbo.d_aidinkieli_versio1 AS d2 ON d2.id = f.aikielir1_id INNER JOIN
        dbo.d_sukupuoli AS d16 ON d16.id = f.sp_id INNER JOIN
        dbo.d_tarkastelujakso AS d17 ON d17.id = f.tarkastelujakso_id INNER JOIN
        dbo.d_alueluokitus AS d3 ON d3.id = f.alueluokitus_id INNER JOIN
        dbo.d_alueluokitus AS d4 ON d4.id = f.saavutettu_alueluokitus_id INNER JOIN
        dbo.d_ika AS d5 ON d5.id = f.ika_id INNER JOIN
        dbo.d_koulutuslaji2 AS d6 ON d6.id = f.koulutuslaji2_id INNER JOIN
        dbo.d_koulutusluokitus AS d7 ON d7.id = f.koulk_id INNER JOIN
        dbo.d_koulutusluokitus AS d8 ON d8.id = f.saavutettu_koulk_id INNER JOIN
        dbo.d_koulutusluokitus AS d9 ON d9.id = f.pohjkoulk_id INNER JOIN
        dbo.d_lahde AS d10 ON d10.id = f.lahde_id INNER JOIN
        --dbo.d_opetushallinnon_koulutus AS d11 ON d11.id = f.ophal_id INNER JOIN
        dbo.d_opiskelijan_olo AS d12 ON d12.id = f.ololk_id INNER JOIN
        dbo.d_oppilaitoksen_taustatiedot AS d13 ON d13.id = f.oppilaitoksen_taustatiedot_id INNER JOIN
        dbo.d_oppilaitoksen_taustatiedot AS d14 ON d14.id = f.saavutettu_oppilaitoksen_taustatiedot_id INNER JOIN
        dbo.d_rahoituslahde AS d15 ON d15.id = f.rahlahde_id INNER JOIN
		dbo.d_hallinnonala2 AS d18 ON d18.hallinnonala_koodi = 
		CASE
			WHEN ophal=1 then 1
			WHEN ophal=2 and coalesce(coalesce(d13.koulutuksen_jarjestajan_korvaavakoodi,d13.koulutuksen_jarjestajakoodi),'''') not in (''0145076-7'',''2153105-4'',''150622-3'',''0909306-3'') then 2
			WHEN ophal=2 then 3
			ELSE -1
		END
WHERE   (f.aineistokoodi = ''K3.9'') AND (d17.tarkastelujakso <> ''0,5 vuotta'') AND (f.[1a Aloittaneiden opintojen kulku koulutuslajin mukaan prioriteettina mikä tahansa tutkinto] <> ''Virhetilanne'')



















' 
GO
/****** Object:  View [dbo].[v_f_koulutukseen_sijoittuneet_2v_lukumaara]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_koulutukseen_sijoittuneet_2v_lukumaara]'))
EXEC dbo.sp_executesql @statement = N'
CREATE VIEW [dbo].[v_f_koulutukseen_sijoittuneet_2v_lukumaara] AS 

SELECT 
       [lkm]
      ,[rivinumero]
  FROM [VipunenTK].[dbo].[f_koulutukseen_sijoittuneet_2v]

' 
GO
/****** Object:  View [dbo].[v_f_koulutukseen_sijoittuneet_6v_lukumaara]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_koulutukseen_sijoittuneet_6v_lukumaara]'))
EXEC dbo.sp_executesql @statement = N'
CREATE VIEW [dbo].[v_f_koulutukseen_sijoittuneet_6v_lukumaara] AS 

SELECT 
       [lkm]
      ,[rivinumero]
  FROM [VipunenTK].[dbo].[f_koulutukseen_sijoittuneet_6v]

' 
GO
/****** Object:  View [dbo].[v_f_tab_ainevalinnat_lukio]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_ainevalinnat_lukio]'))
EXEC dbo.sp_executesql @statement = N'

CREATE view [dbo].[v_f_tab_ainevalinnat_lukio] AS
/*
CSC Jarmo 9.2.2016

Select * from [VipunenTK].[dbo].[v_f_tab_ainevalinnat_lukio]
*/

SELECT 
       [ainevalintojen_lkm]
	   ,[opiskelijat_lkm] = 0

	  --suomi
	  ,[Tilastovuosi] = f.tilastovuosi
	  ,[Aine] = d2.aine
	  ,[Aineryhmä] = d2.aineryhmä
	  ,[Laajuus] = d2.laajuus
      ,[Oppilaitos] = d3.oppilaitos
	  ,[Oppilaitoksen kunta] = d1.kunta
	  ,[Oppilaitoksen maakunta] = d1.maakunta
	  ,[Oppilaitoksen AVI] = d1.avi
	  ,[Oppilaitostyyppi] = d3.oppilaitostyyppi
	  ,[Oppilaitoksen opetuskieli] = d3.opetuskieli
	  ,[Oppilaitoksen omistajatyyppi] = d3.oppilaitoksen_omistajatyyppi
      ,[Koulutuksen järjestäjä] = d3.koulutuksen_jarjestaja
	  ,[Sukupuoli] = d4.sukupuoli

	  --englanti
	  ,[Statistical year] = f.tilastovuosi
	  ,[Subject] = d2.aine_EN
	  ,[Subject group] = d2.aineryhmä_EN
	  ,[Scope] = d2.laajuus_EN
      ,[Educational institution] = d3.oppilaitos_EN
	  ,[Municipality of the institution] = d1.kunta_EN
	  ,[Region of the institution] = d1.maakunta_EN
	  ,[AVI area of the institution] = d1.avi_EN
	  ,[Type of institution] = d3.oppilaitostyyppi_EN
	  ,[Language of the institution] = d3.opetuskieli_EN
	  ,[Type of institution owner] = d3.oppilaitoksen_omistajatyyppi_EN
      ,[Education provider] = d3.koulutuksen_jarjestaja_EN
	  ,[Gender] = d4.sukupuoli_EN

	  --ruotsi
	  ,[Statistikår] = f.tilastovuosi
	  ,[Ämne] = d2.aine_SV
	  ,[Ämnesgrupp] = d2.aineryhmä_SV
	  ,[Omfattning] = d2.laajuus_SV
      ,[Läroanstalt] = d3.oppilaitos_SV
	  ,[Läroanstaltens kommun] = d1.kunta_SV
	  ,[Läroanstaltens landskap] = d1.maakunta_SV
	  ,[Läroanstaltens RFV-område] = d1.avi_SV
	  ,[Läroanstaltstyp] = d3.oppilaitostyyppi_SV
	  ,[Läroanstaltens undervisningsspråk] = d3.opetuskieli_SV
	  ,[Läroanstaltens ägartyp] = d3.oppilaitoksen_omistajatyyppi_SV
      ,[Utbildningsanordnare] = d3.koulutuksen_jarjestaja_SV
	  ,[Kön] = d4.sukupuoli_SV


	  --koodimuuttujat
	  ,"Koodit Oppilaitos" = d3.oppilaitoskoodi
	  ,"Koodit Oppilaitoksen kunta" = d1.kunta_koodi
	  ,"Koodit Oppilaitoksen maakunta" = d1.maakunta_koodi
	  ,"Koodit Koulutuksen järjestäjä" = d3.koulutuksen_jarjestajakoodi

	  --järjestys
	  ,[jarjestys_kunta] = d1.jarjestys
	  ,d1.jarjestys_maakunta
	  ,d1.jarjestys_avi
	  ,[jarjestys_aine] = d2.aine_jarjestys
	  ,[jarjestys_aineryhma] = d2.aineryhmä_jarjestys
	  ,[jarjestys_laajuus] = d2.laajuus_jarjestys
	  ,d3.jarjestys_oppilaitos
	  ,d3.jarjestys_oppilaitostyyppi
	  ,d3.jarjestys_opetuskieli
	  ,d3.jarjestys_omistajatyyppi
	  ,d3.jarjestys_koulutuksen_jarjestaja
	  ,[jarjestys_sukupuoli] = d4.jarjestys

FROM [VipunenTK].[dbo].[f_AVL_ainevalinnat] f
LEFT JOIN [VipunenTK].[dbo].[d_alueluokitus] d1
	ON d1.id = f.oppilaitoksensijainti_id
LEFT JOIN [VipunenTK].[dbo].[d_lukion_ainevalinnat] d2
	ON d2.id = f.ainevalinta_id
LEFT JOIN [VipunenTK].[dbo].[d_oppilaitoksen_taustatiedot] d3
	ON d3.id = f.oppilaitos_id
LEFT JOIN [VipunenTK].[dbo].[d_sukupuoli] d4
	ON d4.id = f.sukupuoli_id

UNION ALL

SELECT 
       [ainevalintojen_lkm] = 0
	   ,[opiskelijat_lkm] = f.opiskelijoiden_lkm

	  --suomi
	  ,[Tilastovuosi] = f.tilastovuosi
	  ,[Aine] = ''englanti''
	  ,[Aineryhmä] = null
	  ,[Laajuus] = null
      ,[Oppilaitos] = d3.oppilaitos
	  ,[Oppilaitoksen kunta] = d1.kunta
	  ,[Oppilaitoksen maakunta] = d1.maakunta
	  ,[Oppilaitoksen AVI] = d1.avi
	  ,[Oppilaitostyyppi] = d3.oppilaitostyyppi
	  ,[Oppilaitoksen opetuskieli] = d3.opetuskieli
	  ,[Oppilaitoksen omistajatyyppi] = d3.oppilaitoksen_omistajatyyppi
      ,[Koulutuksen järjestäjä] = d3.koulutuksen_jarjestaja
	  ,[Sukupuoli] = d4.sukupuoli

	  --englanti
	  ,[Statistical year] = f.tilastovuosi
	  ,[Subject] = ''english''
	  ,[Subject group] = null
	  ,[Scope] = null
      ,[Educational institution] = d3.oppilaitos_EN
	  ,[Municipality of the institution] = d1.kunta_EN
	  ,[Region of the institution] = d1.maakunta_EN
	  ,[AVI area of the institution] = d1.avi_EN
	  ,[Type of institution] = d3.oppilaitostyyppi_EN
	  ,[Language of the institution] = d3.opetuskieli_EN
	  ,[Type of institution owner] = d3.oppilaitoksen_omistajatyyppi_EN
      ,[Education provider] = d3.koulutuksen_jarjestaja_EN
	  ,[Gender] = d4.sukupuoli_EN

	  --ruotsi
	  ,[Statistikår] = f.tilastovuosi
	  ,[Ämne] = ''engelska''
	  ,[Ämnesgrupp] = null
	  ,[Omfattning] = null
      ,[Läroanstalt] = d3.oppilaitos_SV
	  ,[Läroanstaltens kommun] = d1.kunta_SV
	  ,[Läroanstaltens landskap] = d1.maakunta_SV
	  ,[Läroanstaltens RFV-område] = d1.avi_SV
	  ,[Läroanstaltstyp] = d3.oppilaitostyyppi_SV
	  ,[Läroanstaltens undervisningsspråk] = d3.opetuskieli_SV
	  ,[Läroanstaltens ägartyp] = d3.oppilaitoksen_omistajatyyppi_SV
      ,[Utbildningsanordnare] = d3.koulutuksen_jarjestaja_SV
	  ,[Kön] = d4.sukupuoli_SV


	  --koodimuuttujat
	  ,"Koodit Oppilaitos" = d3.oppilaitoskoodi
	  ,"Koodit Oppilaitoksen kunta" = d1.kunta_koodi
	  ,"Koodit Oppilaitoksen maakunta" = d1.maakunta_koodi
	  ,"Koodit Koulutuksen järjestäjä" = d3.koulutuksen_jarjestajakoodi

	  --järjestys
	  ,[jarjestys_kunta] = d1.jarjestys
	  ,d1.jarjestys_maakunta
	  ,d1.jarjestys_avi
	  ,[jarjestys_aine] = 99999
	  ,[jarjestys_aineryhma] = 99999
	  ,[jarjestys_laajuus] = 99999
	  ,d3.jarjestys_oppilaitos
	  ,d3.jarjestys_oppilaitostyyppi
	  ,d3.jarjestys_opetuskieli
	  ,d3.jarjestys_omistajatyyppi
	  ,d3.jarjestys_koulutuksen_jarjestaja
	  ,[jarjestys_sukupuoli] = d4.jarjestys

FROM [VipunenTK].[dbo].[f_AVL_kieltenmaarat] f
LEFT JOIN [VipunenTK].[dbo].[d_alueluokitus] d1
	ON d1.id = f.oppilaitoksensijainti_id
LEFT JOIN [VipunenTK].[dbo].[d_oppilaitoksen_taustatiedot] d3
	ON d3.id = f.oppilaitos_id
LEFT JOIN [VipunenTK].[dbo].[d_sukupuoli] d4
	ON d4.id = f.sukupuoli_id

' 
GO
/****** Object:  View [dbo].[v_f_tab_ainevalinnat_lukio_kieltenmaarat]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_ainevalinnat_lukio_kieltenmaarat]'))
EXEC dbo.sp_executesql @statement = N'

CREATE view [dbo].[v_f_tab_ainevalinnat_lukio_kieltenmaarat] AS
/*
CSC Jarmo 9.2.2016

Select * from [VipunenTK].[dbo].[v_f_tab_ainevalinnat_lukio_kieltenmaarat]
*/

SELECT 
       [opiskelijoiden_lkm]

	  --suomi
	  ,[Tilastovuosi] = f.tilastovuosi
	  ,[Opiskeltujen kielten määrä] = d2.kieltenmaara
      ,[Oppilaitos] = d3.oppilaitos
	  ,[Oppilaitoksen kunta] = d1.kunta
	  ,[Oppilaitoksen maakunta] = d1.maakunta
	  ,[Oppilaitoksen AVI] = d1.avi
	  ,[Oppilaitostyyppi] = d3.oppilaitostyyppi
	  ,[Oppilaitoksen opetuskieli] = d3.opetuskieli
	  ,[Oppilaitoksen omistajatyyppi] = d3.oppilaitoksen_omistajatyyppi
      ,[Koulutuksen järjestäjä] = d3.koulutuksen_jarjestaja
	  ,[Sukupuoli] = d4.sukupuoli

	  --englanti
	  ,[Statistical year] = f.tilastovuosi
	  ,[Number of languages studied] = d2.kieltenmaara_EN
      ,[Educational institution] = d3.oppilaitos_EN
	  ,[Municipality of the institution] = d1.kunta_EN
	  ,[Region of the institution] = d1.maakunta_EN
	  ,[AVI area of the institution] = d1.avi_EN
	  ,[Type of institution] = d3.oppilaitostyyppi_EN
	  ,[Language of the institution] = d3.opetuskieli_EN
	  ,[Type of institution owner] = d3.oppilaitoksen_omistajatyyppi_EN
      ,[Education provider] = d3.koulutuksen_jarjestaja_EN
	  ,[Gender] = d4.sukupuoli_EN

	  --ruotsi
	  ,[Statistikår] = f.tilastovuosi
	  ,[Antal studerade språk] = d2.kieltenmaara_SV
      ,[Läroanstalt] = d3.oppilaitos_SV
	  ,[Läroanstaltens kommun] = d1.kunta_SV
	  ,[Läroanstaltens landskap] = d1.maakunta_SV
	  ,[Läroanstaltens RFV-område] = d1.avi_SV
	  ,[Läroanstaltstyp] = d3.oppilaitostyyppi_SV
	  ,[Läroanstaltens undervisningsspråk] = d3.opetuskieli_SV
	  ,[Läroanstaltens ägartyp] = d3.oppilaitoksen_omistajatyyppi_SV
      ,[Utbildningsanordnare] = d3.koulutuksen_jarjestaja_SV
	  ,[Kön] = d4.sukupuoli_SV


	  --koodimuuttujat
	  ,"Koodit Oppilaitos" = d3.oppilaitoskoodi
	  ,"Koodit Oppilaitoksen kunta" = d1.kunta_koodi
	  ,"Koodit Oppilaitoksen maakunta" = d1.maakunta_koodi
	  ,"Koodit Koulutuksen järjestäjä" = d3.koulutuksen_jarjestajakoodi

	  --järjestys
	  ,[jarjestys_kunta] = d1.jarjestys
	  ,d1.jarjestys_maakunta
	  ,d1.jarjestys_avi
	  ,[jarjestys_kieltenmaara] = d2.kieltenmaara_jarjestys
	  ,d3.jarjestys_oppilaitos
	  ,d3.jarjestys_oppilaitostyyppi
	  ,d3.jarjestys_opetuskieli
	  ,d3.jarjestys_omistajatyyppi
	  ,d3.jarjestys_koulutuksen_jarjestaja
	  ,[jarjestys_sukupuoli] = d4.jarjestys

FROM [VipunenTK].[dbo].[f_AVL_kieltenmaarat] f
LEFT JOIN [VipunenTK].[dbo].[d_alueluokitus] d1
	ON d1.id = f.oppilaitoksensijainti_id
LEFT JOIN [VipunenTK].[dbo].[d_lukion_kieltenmaara] d2
	ON d2.id = f.kieltenmaara_id
LEFT JOIN [VipunenTK].[dbo].[d_oppilaitoksen_taustatiedot] d3
	ON d3.id = f.oppilaitos_id
LEFT JOIN [VipunenTK].[dbo].[d_sukupuoli] d4
	ON d4.id = f.sukupuoli_id



' 
GO
/****** Object:  View [dbo].[v_f_tab_ainevalinnat_perusopetus]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_ainevalinnat_perusopetus]'))
EXEC dbo.sp_executesql @statement = N'










CREATE view [dbo].[v_f_tab_ainevalinnat_perusopetus] as

select 
	[Tilastovuosi] = f.tilv

	,[Sukupuoli] = ''Pojat''

	,[Aine] = d1.aine
	,[Aineryhmä] = d1.aineryhmä
	,[Kielen taso] = case when d1.kielen_taso=''A1'' and tilv<2010 then ''A-kieli (A1 ja A2)'' else d1.kielen_taso end
	,[Vuosiluokat] = d2.luokkajako_16_79
	,[Vuosiluokka] = d2.vuosiluokka

	,[Opetuksen järjestäjä] = d3.koulutuksen_jarjestaja
	,[Oppilaitoksen omistajatyyppi] = d3.oppilaitoksen_omistajatyyppi
	,[Oppilaitostyyppi] = d3.oppilaitostyyppi
	,[Oppilaitoksen maakunta] = d4.maakunta
	,[Oppilaitoksen kunta] = d4.kunta
	,[Oppilaitos] = d3.oppilaitos + '' ('' + d3.oppilaitoskoodi + '')''
	,[Oppilaitoksen opetuskieli] = d3.opetuskieli

	--,[ainevalinnat pojat] = f.lkm_pojat
	--,[ainevalinnat tytöt] = f.lkm_tytot
	,[ainevalinnat yht] = f.lkm_pojat
	--,[pojat lkm] = 0
	--,[tytöt lkm] = 0
	,[yht lkm] = 0

	--ruotsi
	,[Statistikår] = f.tilv
	,[Kön] = ''Pojkar''
	,[Ämne] = d1.aine_SV
	,[Ämnesgrupp] = d1.aineryhmä_SV
	,[Språknivå] = d1.kielen_taso_SV
	,[Årsklasser] = d2.luokkajako_16_79_SV
	,[Årsklass] = d2.vuosiluokka_SV
	,[Utbildningsanordnare] = d3.koulutuksen_jarjestaja_SV
	,[Läroanstaltens ägartyp] = d3.oppilaitoksen_omistajatyyppi_SV
	,[Läroanstaltstyp] = d3.oppilaitostyyppi_SV
	,[Läroanstaltens landskap] = d4.maakunta_SV
	,[Läroanstaltens kommun] = d4.kunta_SV
	,[Läroanstalt] = d3.oppilaitos_SV + '' ('' + d3.oppilaitoskoodi + '')'' + '' ('' + d3.oppilaitoskoodi + '')''
	,[Läroanstaltens undervisningsspråk] = d3.opetuskieli_SV

	--englanti
	,[Statistical year] = f.tilv
	,[Gender] = ''Boys''
	,[Subject] = d1.aine_EN
	,[Subject group] = d1.aineryhmä_EN
	,[Language level] = d1.kielen_taso_EN
	,[Year groups] = d2.luokkajako_16_79_EN
	,[Year group] = d2.vuosiluokka_EN
	,[Education provider] = d3.koulutuksen_jarjestaja_EN
	,[Type of institution owner] = d3.oppilaitoksen_omistajatyyppi_EN
	,[Type of institution] = d3.oppilaitostyyppi_EN
	,[Region of the institution] = d4.maakunta_EN
	,[Municipality of the institution] = d4.kunta_EN
	,[Educational institution] = d3.oppilaitos_EN + '' ('' + d3.oppilaitoskoodi + '')'' + '' ('' + d3.oppilaitoskoodi + '')''
	,[Language of the institution] = d3.opetuskieli_EN

	--koodit
	,[Koodit Opetuksen järjestäjä] = d3.koulutuksen_jarjestajakoodi
	,[Koodit Oppilaitos] = d3.oppilaitoskoodi
	,[Koodit Oppilaitoksen maakunta] = d4.maakunta_koodi
	,[Koodit Oppilaitoksen kunta] = d4.kunta_koodi

	--järjestys
	,[Sukupuoli järj] = 1
	,[Aine järj] = case d1.aine when ''Elämänkatsomustieto'' then 4034 else d1.aine_jarjestys end
	,[Aineryhmä järj] = d1.aineryhmä_jarjestys
	,[Kielen taso järj] = d1.kielen_taso_jarjestys
	,[Vuosiluokka järj] = d2.jarjestys
	,[Vuosiluokat järj] = d2.luokkajako_16_79_jarjestys
	,[Oppilaitoksen omistajatyyppi järj] = d3.jarjestys_omistajatyyppi
	,[Oppilaitostyyppi järj] = d3.jarjestys_oppilaitostyyppi
	,[Oppilaitoksen maakunta järj] = d4.jarjestys_maakunta
	,[Oppilaitoksen opetuskieli järj] = d3.jarjestys_opetuskieli
	

from dbo.f_ainevalinnat_perusopetuksessa f
inner join d_perusopetuksen_ainevalinnat d1 on d1.id=f.ainevalinta_id
inner join d_perusopetuksen_vuosiluokat d2 on d2.id=f.vuosiluokka_id
inner join d_oppilaitoksen_taustatiedot d3 on d3.id=f.oppilaitos_id
inner join d_alueluokitus d4 on d4.id=f.oppilaitoksensijainti_id
where f.lkm_pojat>0 and d1.aine<>''ei yhtään kieltä''

UNION ALL

select 
	[Tilastovuosi] = f.tilv

	,[Sukupuoli] = ''Tytöt''

	,[Aine] = d1.aine
	,[Aineryhmä] = d1.aineryhmä
	,[Kielen taso] = case when d1.kielen_taso=''A1'' and tilv<2010 then ''A-kieli (A1 ja A2)'' else d1.kielen_taso end
	,[Vuosiluokat] = d2.luokkajako_16_79
	,[Vuosiluokka] = d2.vuosiluokka

	,[Opetuksen järjestäjä] = d3.koulutuksen_jarjestaja
	,[Oppilaitoksen omistajatyyppi] = d3.oppilaitoksen_omistajatyyppi
	,[Oppilaitostyyppi] = d3.oppilaitostyyppi
	,[Oppilaitoksen maakunta] = d4.maakunta
	,[Oppilaitoksen kunta] = d4.kunta
	,[Oppilaitos] = d3.oppilaitos + '' ('' + d3.oppilaitoskoodi + '')''
	,[Oppilaitoksen opetuskieli] = d3.opetuskieli

	--,[ainevalinnat pojat] = f.lkm_pojat
	--,[ainevalinnat tytöt] = f.lkm_tytot
	,[ainevalinnat yht] = f.lkm_tytot
	--,[pojat lkm] = 0
	--,[tytöt lkm] = 0
	,[yht lkm] = 0

	--ruotsi
	,[Statistikår] = f.tilv
	,[Kön] = ''Flickor''
	,[Ämne] = d1.aine_SV
	,[Ämnesgrupp] = d1.aineryhmä_SV
	,[Språknivå] = d1.kielen_taso_SV
	,[Årsklasser] = d2.luokkajako_16_79_SV
	,[Årsklass] = d2.vuosiluokka_SV
	,[Utbildningsanordnare] = d3.koulutuksen_jarjestaja_SV
	,[Läroanstaltens ägartyp] = d3.oppilaitoksen_omistajatyyppi_SV
	,[Läroanstaltstyp] = d3.oppilaitostyyppi_SV
	,[Läroanstaltens landskap] = d4.maakunta_SV
	,[Läroanstaltens kommun] = d4.kunta_SV
	,[Läroanstalt] = d3.oppilaitos_SV + '' ('' + d3.oppilaitoskoodi + '')''
	,[Läroanstaltens undervisningsspråk] = d3.opetuskieli_SV

	--englanti
	,[Statistical year] = f.tilv
	,[Gender] = ''Girls''
	,[Subject] = d1.aine_EN
	,[Subject group] = d1.aineryhmä_EN
	,[Language level] = d1.kielen_taso_EN
	,[Year groups] = d2.luokkajako_16_79_EN
	,[Year group] = d2.vuosiluokka_EN
	,[Education provider] = d3.koulutuksen_jarjestaja_EN
	,[Type of institution owner] = d3.oppilaitoksen_omistajatyyppi_EN
	,[Type of institution] = d3.oppilaitostyyppi_EN
	,[Region of the institution] = d4.maakunta_EN
	,[Municipality of the institution] = d4.kunta_EN
	,[Educational institution] = d3.oppilaitos_EN + '' ('' + d3.oppilaitoskoodi + '')''
	,[Language of the institution] = d3.opetuskieli_EN

	--koodit
	,[Koodit Opetuksen järjestäjä] = d3.koulutuksen_jarjestajakoodi
	,[Koodit Oppilaitos] = d3.oppilaitoskoodi
	,[Koodit Oppilaitoksen maakunta] = d4.maakunta_koodi
	,[Koodit Oppilaitoksen kunta] = d4.kunta_koodi

	--järjestys
	,[Sukupuoli järj] = 2
	,[Aine järj] = case d1.aine when ''Elämänkatsomustieto'' then 4034 else d1.aine_jarjestys end
	,[Aineryhmä järj] = d1.aineryhmä_jarjestys
	,[Kielen taso järj] = d1.kielen_taso_jarjestys
	,[Vuosiluokka järj] = d2.jarjestys
	,[Vuosiluokat järj] = d2.luokkajako_16_79_jarjestys
	,[Oppilaitoksen omistajatyyppi järj] = d3.jarjestys_omistajatyyppi
	,[Oppilaitostyyppi järj] = d3.jarjestys_oppilaitostyyppi
	,[Oppilaitoksen maakunta järj] = d4.jarjestys_maakunta
	,[Oppilaitoksen opetuskieli järj] = d3.jarjestys_opetuskieli
	

from dbo.f_ainevalinnat_perusopetuksessa f
inner join d_perusopetuksen_ainevalinnat d1 on d1.id=f.ainevalinta_id
inner join d_perusopetuksen_vuosiluokat d2 on d2.id=f.vuosiluokka_id
inner join d_oppilaitoksen_taustatiedot d3 on d3.id=f.oppilaitos_id
inner join d_alueluokitus d4 on d4.id=f.oppilaitoksensijainti_id
where f.lkm_tytot>0 and d1.aine<>''ei yhtään kieltä''

UNION ALL
--sukupuoli tuntematon
select 
	[Tilastovuosi] = f.tilv

	,[Sukupuoli] = ''Tuntematon''

	,[Aine] = d1.aine
	,[Aineryhmä] = d1.aineryhmä
	,[Kielen taso] = d1.kielen_taso
	,[Vuosiluokat] = d2.luokkajako_16_79
	,[Vuosiluokka] = d2.vuosiluokka

	,[Opetuksen järjestäjä] = d3.koulutuksen_jarjestaja
	,[Oppilaitoksen omistajatyyppi] = d3.oppilaitoksen_omistajatyyppi
	,[Oppilaitostyyppi] = d3.oppilaitostyyppi
	,[Oppilaitoksen maakunta] = d4.maakunta
	,[Oppilaitoksen kunta] = d4.kunta
	,[Oppilaitos] = d3.oppilaitos + '' ('' + d3.oppilaitoskoodi + '')''
	,[Oppilaitoksen opetuskieli] = d3.opetuskieli

	--,[ainevalinnat pojat] = f.lkm_pojat
	--,[ainevalinnat tytöt] = f.lkm_tytot
	,[ainevalinnat yht] = f.lkm_yht
	--,[pojat lkm] = 0
	--,[tytöt lkm] = 0
	,[yht lkm] = 0

	--ruotsi
	,[Statistikår] = f.tilv
	,[Kön] = ''Okänd''
	,[Ämne] = d1.aine_SV
	,[Ämnesgrupp] = d1.aineryhmä_SV
	,[Språknivå] = d1.kielen_taso_SV
	,[Årsklasser] = d2.luokkajako_16_79_SV
	,[Årsklass] = d2.vuosiluokka_SV
	,[Utbildningsanordnare] = d3.koulutuksen_jarjestaja_SV
	,[Läroanstaltens ägartyp] = d3.oppilaitoksen_omistajatyyppi_SV
	,[Läroanstaltstyp] = d3.oppilaitostyyppi_SV
	,[Läroanstaltens landskap] = d4.maakunta_SV
	,[Läroanstaltens kommun] = d4.kunta_SV
	,[Läroanstalt] = d3.oppilaitos_SV + '' ('' + d3.oppilaitoskoodi + '')''
	,[Läroanstaltens undervisningsspråk] = d3.opetuskieli_SV

	--englanti
	,[Statistical year] = f.tilv
	,[Gender] = ''Unknown''
	,[Subject] = d1.aine_EN
	,[Subject group] = d1.aineryhmä_EN
	,[Language level] = d1.kielen_taso_EN
	,[Year groups] = d2.luokkajako_16_79_EN
	,[Year group] = d2.vuosiluokka_EN
	,[Education provider] = d3.koulutuksen_jarjestaja_EN
	,[Type of institution owner] = d3.oppilaitoksen_omistajatyyppi_EN
	,[Type of institution] = d3.oppilaitostyyppi_EN
	,[Region of the institution] = d4.maakunta_EN
	,[Municipality of the institution] = d4.kunta_EN
	,[Educational institution] = d3.oppilaitos_EN + '' ('' + d3.oppilaitoskoodi + '')''
	,[Language of the institution] = d3.opetuskieli_EN

	--koodit
	,[Koodit Opetuksen järjestäjä] = d3.koulutuksen_jarjestajakoodi
	,[Koodit Oppilaitos] = d3.oppilaitoskoodi
	,[Koodit Oppilaitoksen maakunta] = d4.maakunta_koodi
	,[Koodit Oppilaitoksen kunta] = d4.kunta_koodi

	--järjestys
	,[Sukupuoli järj] = 99
	,[Aine järj] = case d1.aine when ''Elämänkatsomustieto'' then 4034 else d1.aine_jarjestys end
	,[Aineryhmä järj] = d1.aineryhmä_jarjestys
	,[Kielen taso järj] = d1.kielen_taso_jarjestys
	,[Vuosiluokka järj] = d2.jarjestys
	,[Vuosiluokat järj] = d2.luokkajako_16_79_jarjestys
	,[Oppilaitoksen omistajatyyppi järj] = d3.jarjestys_omistajatyyppi
	,[Oppilaitostyyppi järj] = d3.jarjestys_oppilaitostyyppi
	,[Oppilaitoksen maakunta järj] = d4.jarjestys_maakunta
	,[Oppilaitoksen opetuskieli järj] = d3.jarjestys_opetuskieli
	

from dbo.f_ainevalinnat_perusopetuksessa f
inner join d_perusopetuksen_ainevalinnat d1 on d1.id=f.ainevalinta_id
inner join d_perusopetuksen_vuosiluokat d2 on d2.id=f.vuosiluokka_id
inner join d_oppilaitoksen_taustatiedot d3 on d3.id=f.oppilaitos_id
inner join d_alueluokitus d4 on d4.id=f.oppilaitoksensijainti_id
where (f.lkm_tytot is null or f.lkm_tytot=0) and 
	  (f.lkm_pojat is null or f.lkm_pojat=0) and 
	  f.lkm_yht>0 and 
	  (d1.aineryhmä in (''Suomi tai ruotsi toisena kielenä'',''Katsomusaineet'') and d1.aine<>''ei yhtään kieltä'')

UNION ALL

select 
	[Tilastovuosi] = f.tilv

	,[Sukupuoli] = ''Tuntematon''

	,[Aine] = d1.aine
	,[Aineryhmä] = d1.aineryhmä
	,[Kielen taso] = d1.kielen_taso
	,[Vuosiluokat] = d2.luokkajako_16_79
	,[Vuosiluokka] = d2.vuosiluokka

	,[Opetuksen järjestäjä] = d3.koulutuksen_jarjestaja
	,[Oppilaitoksen omistajatyyppi] = d3.oppilaitoksen_omistajatyyppi
	,[Oppilaitostyyppi] = d3.oppilaitostyyppi
	,[Oppilaitoksen maakunta] = d4.maakunta
	,[Oppilaitoksen kunta] = d4.kunta
	,[Oppilaitos] = d3.oppilaitos + '' ('' + d3.oppilaitoskoodi + '')''
	,[Oppilaitoksen opetuskieli] = d3.opetuskieli

	--,[ainevalinnat pojat] = f.lkm_pojat
	--,[ainevalinnat tytöt] = f.lkm_tytot
	,[ainevalinnat yht] = f.lkm_yht
	--,[pojat lkm] = 0
	--,[tytöt lkm] = 0
	,[yht lkm] = 0

	--ruotsi
	,[Statistikår] = f.tilv
	,[Kön] = ''Okänd''
	,[Ämne] = d1.aine_SV
	,[Ämnesgrupp] = d1.aineryhmä_SV
	,[Språknivå] = d1.kielen_taso_SV
	,[Årsklasser] = d2.luokkajako_16_79_SV
	,[Årsklass] = d2.vuosiluokka_SV
	,[Utbildningsanordnare] = d3.koulutuksen_jarjestaja_SV
	,[Läroanstaltens ägartyp] = d3.oppilaitoksen_omistajatyyppi_SV
	,[Läroanstaltstyp] = d3.oppilaitostyyppi_SV
	,[Läroanstaltens landskap] = d4.maakunta_SV
	,[Läroanstaltens kommun] = d4.kunta_SV
	,[Läroanstalt] = d3.oppilaitos_SV + '' ('' + d3.oppilaitoskoodi + '')''
	,[Läroanstaltens undervisningsspråk] = d3.opetuskieli_SV

	--englanti
	,[Statistical year] = f.tilv
	,[Gender] = ''Unknown''
	,[Subject] = d1.aine_EN
	,[Subject group] = d1.aineryhmä_EN
	,[Language level] = d1.kielen_taso_EN
	,[Year groups] = d2.luokkajako_16_79_EN
	,[Year group] = d2.vuosiluokka_EN
	,[Education provider] = d3.koulutuksen_jarjestaja_EN
	,[Type of institution owner] = d3.oppilaitoksen_omistajatyyppi_EN
	,[Type of institution] = d3.oppilaitostyyppi_EN
	,[Region of the institution] = d4.maakunta_EN
	,[Municipality of the institution] = d4.kunta_EN
	,[Educational institution] = d3.oppilaitos_EN + '' ('' + d3.oppilaitoskoodi + '')''
	,[Language of the institution] = d3.opetuskieli_EN

	--koodit
	,[Koodit Opetuksen järjestäjä] = d3.koulutuksen_jarjestajakoodi
	,[Koodit Oppilaitos] = d3.oppilaitoskoodi
	,[Koodit Oppilaitoksen maakunta] = d4.maakunta_koodi
	,[Koodit Oppilaitoksen kunta] = d4.kunta_koodi

	--järjestys
	,[Sukupuoli järj] = 99
	,[Aine järj] = case d1.aine when ''Elämänkatsomustieto'' then 4034 else d1.aine_jarjestys end
	,[Aineryhmä järj] = d1.aineryhmä_jarjestys
	,[Kielen taso järj] = d1.kielen_taso_jarjestys
	,[Vuosiluokka järj] = d2.jarjestys
	,[Vuosiluokat järj] = d2.luokkajako_16_79_jarjestys
	,[Oppilaitoksen omistajatyyppi järj] = d3.jarjestys_omistajatyyppi
	,[Oppilaitostyyppi järj] = d3.jarjestys_oppilaitostyyppi
	,[Oppilaitoksen maakunta järj] = d4.jarjestys_maakunta
	,[Oppilaitoksen opetuskieli järj] = d3.jarjestys_opetuskieli
	

from dbo.f_ainevalinnat_perusopetuksessa f
inner join d_perusopetuksen_ainevalinnat d1 on d1.id=f.ainevalinta_id
inner join d_perusopetuksen_vuosiluokat d2 on d2.id=f.vuosiluokka_id
inner join d_oppilaitoksen_taustatiedot d3 on d3.id=f.oppilaitos_id
inner join d_alueluokitus d4 on d4.id=f.oppilaitoksensijainti_id
where (f.lkm_tytot is null or f.lkm_tytot=0) and 
	  (f.lkm_pojat is null or f.lkm_pojat=0) and 
	  f.lkm_yht>0 and 
	  (d1.aineryhmä = ''Kielivalinnat'' and d2.luokkajako_16_79=''Luokat 1-6'' and d2.vuosiluokka<>''Tietoa ei kerätty (1-6)'' and d1.aine<>''ei yhtään kieltä'')

UNION ALL


/* Oppilaiden määrät */

select 
	[Tilastovuosi] = tilv

	,[Sukupuoli] = ''Pojat''

	,[Aine] = null
	,[Aineryhmä] = null
	,[Kielen taso] = null
	,[Vuosiluokat] = d2.luokkajako_16_79
	,[Vuosiluokka] = ''Tietoa ei kerätty (1-6)''

	,[Opetuksen järjestäjä] = d3.koulutuksen_jarjestaja
	,[Oppilaitoksen omistajatyyppi] = d3.oppilaitoksen_omistajatyyppi
	,[Oppilaitostyyppi] = d3.oppilaitostyyppi
	,[Oppilaitoksen maakunta] = d4.maakunta
	,[Oppilaitoksen kunta] = d4.kunta
	,[Oppilaitos] = d3.oppilaitos + '' ('' + d3.oppilaitoskoodi + '')''
	,[Oppilaitoksen opetuskieli] = d3.opetuskieli

	--,[ainevalinnat pojat] = 0
	--,[ainevalinnat tytöt] = 0
	,[ainevalinnat yht] = 0
	--,[pojat] = f.lkm_pojat
	--,[tytöt] = f.lkm_tytot
	,[yht] = f.lkm_pojat

	--ruotsi
	,[Statistikår] = tilv
	,[Kön] = ''Pojkar''
	,[Ämne] = null
	,[Ämnesgrupp] = null
	,[Språknivå] = null
	,[Årsklasser] = d2.luokkajako_16_79_SV
	,[Årsklass] = ''Uppgifter har inte samlats in (1–6)''
	,[Utbildningsanordnare] = d3.koulutuksen_jarjestaja_SV
	,[Läroanstaltens ägartyp] = d3.oppilaitoksen_omistajatyyppi_SV
	,[Läroanstaltstyp] = d3.oppilaitostyyppi_SV
	,[Läroanstaltens landskap] = d4.maakunta_SV
	,[Läroanstaltens kommun] = d4.kunta_SV
	,[Läroanstalt] = d3.oppilaitos_SV + '' ('' + d3.oppilaitoskoodi + '')''
	,[Läroanstaltens undervisningsspråk] = d3.opetuskieli_SV

	--englanti
	,[Statistical year] = tilv
	,[Gender] = ''Boys''
	,[Subject] = null
	,[Subject group] = null
	,[Language level] = null
	,[Year groups] = d2.luokkajako_16_79_EN
	,[Year group] = ''Data not collected (1-6)''
	,[Education provider] = d3.koulutuksen_jarjestaja_EN
	,[Type of institution owner] = d3.oppilaitoksen_omistajatyyppi_EN
	,[Type of institution] = d3.oppilaitostyyppi_EN
	,[Region of the institution] = d4.maakunta_EN
	,[Municipality of the institution] = d4.kunta_EN
	,[Educational institution] = d3.oppilaitos_EN + '' ('' + d3.oppilaitoskoodi + '')''
	,[Language of the institution] = d3.opetuskieli_EN

	--koodit
	,[Koodit Opetuksen järjestäjä] = d3.koulutuksen_jarjestajakoodi
	,[Koodit Oppilaitos] = d3.oppilaitoskoodi
	,[Koodit Oppilaitoksen maakunta] = d4.maakunta_koodi
	,[Koodit Oppilaitoksen kunta] = d4.kunta_koodi

	--järjestys
	,[Sukupuoli järj] = 1
	,[Aine järj] = 99999
	,[Aineryhmä järj] = 99999
	,[Kielen taso järj] = 99999
	,[Vuosiluokka järj] = d2.jarjestys
	,[Vuosiluokat järj] = d2.luokkajako_16_79_jarjestys
	,[Oppilaitoksen omistajatyyppi järj] = d3.jarjestys_omistajatyyppi
	,[Oppilaitostyyppi järj] = d3.jarjestys_oppilaitostyyppi
	,[Oppilaitoksen maakunta järj] = d4.jarjestys_maakunta
	,[Oppilaitoksen opetuskieli järj] = d3.jarjestys_opetuskieli
	

from dbo.f_perusopetuksen_oppilasmaarat f
inner join d_perusopetuksen_vuosiluokat d2 on d2.id=f.vuosiluokka_id
inner join d_oppilaitoksen_taustatiedot d3 on d3.id=f.oppilaitos_id
inner join d_alueluokitus d4 on d4.id=f.oppilaitoksensijainti_id
where f.lkm_pojat>0 and d2.luokkajako_16_79=''Luokat 1-6''

UNION ALL

select 
	[Tilastovuosi] = tilv

	,[Sukupuoli] = ''Tytöt''

	,[Aine] = null
	,[Aineryhmä] = null
	,[Kielen taso] = null
	,[Vuosiluokat] = d2.luokkajako_16_79
	,[Vuosiluokka] = ''Tietoa ei kerätty (1-6)''

	,[Opetuksen järjestäjä] = d3.koulutuksen_jarjestaja
	,[Oppilaitoksen omistajatyyppi] = d3.oppilaitoksen_omistajatyyppi
	,[Oppilaitostyyppi] = d3.oppilaitostyyppi
	,[Oppilaitoksen maakunta] = d4.maakunta
	,[Oppilaitoksen kunta] = d4.kunta
	,[Oppilaitos] = d3.oppilaitos + '' ('' + d3.oppilaitoskoodi + '')''
	,[Oppilaitoksen opetuskieli] = d3.opetuskieli

	--,[ainevalinnat pojat] = 0
	--,[ainevalinnat tytöt] = 0
	,[ainevalinnat yht] = 0
	--,[pojat] = f.lkm_pojat
	--,[tytöt] = f.lkm_tytot
	,[yht] = f.lkm_tytot

	--ruotsi
	,[Statistikår] = tilv
	,[Kön] = ''Flickor''
	,[Ämne] = null
	,[Ämnesgrupp] = null
	,[Språknivå] = null
	,[Årsklasser] = d2.luokkajako_16_79_SV
	,[Årsklass] = ''Uppgifter har inte samlats in (1–6)''
	,[Utbildningsanordnare] = d3.koulutuksen_jarjestaja_SV
	,[Läroanstaltens ägartyp] = d3.oppilaitoksen_omistajatyyppi_SV
	,[Läroanstaltstyp] = d3.oppilaitostyyppi_SV
	,[Läroanstaltens landskap] = d4.maakunta_SV
	,[Läroanstaltens kommun] = d4.kunta_SV
	,[Läroanstalt] = d3.oppilaitos_SV + '' ('' + d3.oppilaitoskoodi + '')''
	,[Läroanstaltens undervisningsspråk] = d3.opetuskieli_SV

	--englanti
	,[Statistical year] = tilv
	,[Gender] = ''Girls''
	,[Subject] = null
	,[Subject group] = null
	,[Language level] = null
	,[Year groups] = d2.luokkajako_16_79_EN
	,[Year group] = ''Data not collected (1-6)''
	,[Education provider] = d3.koulutuksen_jarjestaja_EN
	,[Type of institution owner] = d3.oppilaitoksen_omistajatyyppi_EN
	,[Type of institution] = d3.oppilaitostyyppi_EN
	,[Region of the institution] = d4.maakunta_EN
	,[Municipality of the institution] = d4.kunta_EN
	,[Educational institution] = d3.oppilaitos_EN + '' ('' + d3.oppilaitoskoodi + '')''
	,[Language of the institution] = d3.opetuskieli_EN

	--koodit
	,[Koodit Opetuksen järjestäjä] = d3.koulutuksen_jarjestajakoodi
	,[Koodit Oppilaitos] = d3.oppilaitoskoodi
	,[Koodit Oppilaitoksen maakunta] = d4.maakunta_koodi
	,[Koodit Oppilaitoksen kunta] = d4.kunta_koodi

	--järjestys
	,[Sukupuoli järj] = 2
	,[Aine järj] = 99999
	,[Aineryhmä järj] = 99999
	,[Kielen taso järj] = 99999
	,[Vuosiluokka järj] = d2.jarjestys
	,[Vuosiluokat järj] = d2.luokkajako_16_79_jarjestys
	,[Oppilaitoksen omistajatyyppi järj] = d3.jarjestys_omistajatyyppi
	,[Oppilaitostyyppi järj] = d3.jarjestys_oppilaitostyyppi
	,[Oppilaitoksen maakunta järj] = d4.jarjestys_maakunta
	,[Oppilaitoksen opetuskieli järj] = d3.jarjestys_opetuskieli
	

from dbo.f_perusopetuksen_oppilasmaarat f
inner join d_perusopetuksen_vuosiluokat d2 on d2.id=f.vuosiluokka_id
inner join d_oppilaitoksen_taustatiedot d3 on d3.id=f.oppilaitos_id
inner join d_alueluokitus d4 on d4.id=f.oppilaitoksensijainti_id
where f.lkm_tytot>0 and d2.luokkajako_16_79=''Luokat 1-6''

UNION ALL
--1-6 luokkien kielivalintoja varten, sukupuoli asetetaan tuntemattomaksi
select 
	[Tilastovuosi] = tilv

	,[Sukupuoli] = ''Tuntematon''

	,[Aine] = null
	,[Aineryhmä] = ''Kielivalinnat''
	,[Kielen taso] = null
	,[Vuosiluokat] = ''Luokat 1–6''
	,[Vuosiluokka] = d2.vuosiluokka

	,[Opetuksen järjestäjä] = d3.koulutuksen_jarjestaja
	,[Oppilaitoksen omistajatyyppi] = d3.oppilaitoksen_omistajatyyppi
	,[Oppilaitostyyppi] = d3.oppilaitostyyppi
	,[Oppilaitoksen maakunta] = d4.maakunta
	,[Oppilaitoksen kunta] = d4.kunta
	,[Oppilaitos] = d3.oppilaitos + '' ('' + d3.oppilaitoskoodi + '')''
	,[Oppilaitoksen opetuskieli] = d3.opetuskieli

	--,[ainevalinnat pojat] = 0
	--,[ainevalinnat tytöt] = 0
	,[ainevalinnat yht] = 0
	--,[pojat] = f.lkm_pojat
	--,[tytöt] = f.lkm_tytot
	,[yht] = isnull(f.lkm_pojat,0)+isnull(f.lkm_tytot,0)

	--ruotsi
	,[Statistikår] = tilv
	,[Kön] = ''Okänd''
	,[Ämne] = null
	,[Ämnesgrupp] = ''Språkval''
	,[Språknivå] = null
	,[Årsklasser] = ''Årskurserna 1–6''
	,[Årsklass] = d2.vuosiluokka_SV
	,[Utbildningsanordnare] = d3.koulutuksen_jarjestaja_SV
	,[Läroanstaltens ägartyp] = d3.oppilaitoksen_omistajatyyppi_SV
	,[Läroanstaltstyp] = d3.oppilaitostyyppi_SV
	,[Läroanstaltens landskap] = d4.maakunta_SV
	,[Läroanstaltens kommun] = d4.kunta_SV
	,[Läroanstalt] = d3.oppilaitos_SV + '' ('' + d3.oppilaitoskoodi + '')''
	,[Läroanstaltens undervisningsspråk] = d3.opetuskieli_SV

	--englanti
	,[Statistical year] = tilv
	,[Gender] = ''Unknown''
	,[Subject] = null
	,[Subject group] = ''Language choices''
	,[Language level] = null
	,[Year groups] = ''Grades 1-6''
	,[Year group] = d2.vuosiluokka_EN
	,[Education provider] = d3.koulutuksen_jarjestaja_EN
	,[Type of institution owner] = d3.oppilaitoksen_omistajatyyppi_EN
	,[Type of institution] = d3.oppilaitostyyppi_EN
	,[Region of the institution] = d4.maakunta_EN
	,[Municipality of the institution] = d4.kunta_EN
	,[Educational institution] = d3.oppilaitos_EN + '' ('' + d3.oppilaitoskoodi + '')''
	,[Language of the institution] = d3.opetuskieli_EN

	--koodit
	,[Koodit Opetuksen järjestäjä] = d3.koulutuksen_jarjestajakoodi
	,[Koodit Oppilaitos] = d3.oppilaitoskoodi
	,[Koodit Oppilaitoksen maakunta] = d4.maakunta_koodi
	,[Koodit Oppilaitoksen kunta] = d4.kunta_koodi

	--järjestys
	,[Sukupuoli järj] = 1
	,[Aine järj] = 99999
	,[Aineryhmä järj] = 99999
	,[Kielen taso järj] = 99999
	,[Vuosiluokka järj] = d2.jarjestys
	,[Vuosiluokat järj] = d2.luokkajako_16_79_jarjestys
	,[Oppilaitoksen omistajatyyppi järj] = d3.jarjestys_omistajatyyppi
	,[Oppilaitostyyppi järj] = d3.jarjestys_oppilaitostyyppi
	,[Oppilaitoksen maakunta järj] = d4.jarjestys_maakunta
	,[Oppilaitoksen opetuskieli järj] = d3.jarjestys_opetuskieli
	

from dbo.f_perusopetuksen_oppilasmaarat f
inner join d_perusopetuksen_vuosiluokat d2 on d2.id=f.vuosiluokka_id
inner join d_oppilaitoksen_taustatiedot d3 on d3.id=f.oppilaitos_id
inner join d_alueluokitus d4 on d4.id=f.oppilaitoksensijainti_id
where (f.lkm_pojat>0 or f.lkm_tytot>0) and d2.luokkajako_16_79=''Luokat 1-6''

UNION ALL
--7-9 luokkien katsomus ja suomi/ruotsi -valintoja varten, sukupuoli asetetaan tuntemattomaksi
select 
	[Tilastovuosi] = tilv

	,[Sukupuoli] = ''Tuntematon''

	,[Aine] = null
	,[Aineryhmä] = ''Katsomusaineet''
	,[Kielen taso] = null
	,[Vuosiluokat] = ''Luokat 7-9''
	,[Vuosiluokka] = ''Tietoa ei kerätty (7-9)''

	,[Opetuksen järjestäjä] = d3.koulutuksen_jarjestaja
	,[Oppilaitoksen omistajatyyppi] = d3.oppilaitoksen_omistajatyyppi
	,[Oppilaitostyyppi] = d3.oppilaitostyyppi
	,[Oppilaitoksen maakunta] = d4.maakunta
	,[Oppilaitoksen kunta] = d4.kunta
	,[Oppilaitos] = d3.oppilaitos + '' ('' + d3.oppilaitoskoodi + '')''
	,[Oppilaitoksen opetuskieli] = d3.opetuskieli

	--,[ainevalinnat pojat] = 0
	--,[ainevalinnat tytöt] = 0
	,[ainevalinnat yht] = 0
	--,[pojat] = f.lkm_pojat
	--,[tytöt] = f.lkm_tytot
	,[yht] = isnull(f.lkm_pojat,0)+isnull(f.lkm_tytot,0)

	--ruotsi
	,[Statistikår] = tilv
	,[Kön] = ''Okänd''
	,[Ämne] = null
	,[Ämnesgrupp] = ''Åskådningsämnen''
	,[Språknivå] = null
	,[Årsklasser] = ''Årskurserna 7–9''
	,[Årsklass] = ''Uppgifter har inte samlats in (7–9)''
	,[Utbildningsanordnare] = d3.koulutuksen_jarjestaja_SV
	,[Läroanstaltens ägartyp] = d3.oppilaitoksen_omistajatyyppi_SV
	,[Läroanstaltstyp] = d3.oppilaitostyyppi_SV
	,[Läroanstaltens landskap] = d4.maakunta_SV
	,[Läroanstaltens kommun] = d4.kunta_SV
	,[Läroanstalt] = d3.oppilaitos_SV + '' ('' + d3.oppilaitoskoodi + '')''
	,[Läroanstaltens undervisningsspråk] = d3.opetuskieli_SV

	--englanti
	,[Statistical year] = tilv
	,[Gender] = ''Unknown''
	,[Subject] = null
	,[Subject group] = ''Ethical subjects''
	,[Language level] = null
	,[Year groups] = ''Grades 7-9''
	,[Year group] = ''Data not collected (7-9)''
	,[Education provider] = d3.koulutuksen_jarjestaja_EN
	,[Type of institution owner] = d3.oppilaitoksen_omistajatyyppi_EN
	,[Type of institution] = d3.oppilaitostyyppi_EN
	,[Region of the institution] = d4.maakunta_EN
	,[Municipality of the institution] = d4.kunta_EN
	,[Educational institution] = d3.oppilaitos_EN + '' ('' + d3.oppilaitoskoodi + '')''
	,[Language of the institution] = d3.opetuskieli_EN

	--koodit
	,[Koodit Opetuksen järjestäjä] = d3.koulutuksen_jarjestajakoodi
	,[Koodit Oppilaitos] = d3.oppilaitoskoodi
	,[Koodit Oppilaitoksen maakunta] = d4.maakunta_koodi
	,[Koodit Oppilaitoksen kunta] = d4.kunta_koodi

	--järjestys
	,[Sukupuoli järj] = 1
	,[Aine järj] = 99999
	,[Aineryhmä järj] = 99999
	,[Kielen taso järj] = 99999
	,[Vuosiluokka järj] = d2.jarjestys
	,[Vuosiluokat järj] = d2.luokkajako_16_79_jarjestys
	,[Oppilaitoksen omistajatyyppi järj] = d3.jarjestys_omistajatyyppi
	,[Oppilaitostyyppi järj] = d3.jarjestys_oppilaitostyyppi
	,[Oppilaitoksen maakunta järj] = d4.jarjestys_maakunta
	,[Oppilaitoksen opetuskieli järj] = d3.jarjestys_opetuskieli
	

from dbo.f_perusopetuksen_oppilasmaarat f
inner join d_perusopetuksen_vuosiluokat d2 on d2.id=f.vuosiluokka_id
inner join d_oppilaitoksen_taustatiedot d3 on d3.id=f.oppilaitos_id
inner join d_alueluokitus d4 on d4.id=f.oppilaitoksensijainti_id
where (f.lkm_pojat>0 or f.lkm_tytot>0) and d2.luokkajako_16_79=''Luokat 7-9''

union all
--lisäopetuksen oppilaiden määrä katsomus ja suomi/ruotsi valintoja varten, vuosi 2010
select 
	[Tilastovuosi] = tilv

	,[Sukupuoli] = ''Tuntematon''

	,[Aine] = null
	,[Aineryhmä] = ''Katsomusaineet''
	,[Kielen taso] = null
	,[Vuosiluokat] = ''Lisäopetus''
	,[Vuosiluokka] = ''Tietoa ei kerätty (7-9 ja 10)''

	,[Opetuksen järjestäjä] = d3.koulutuksen_jarjestaja
	,[Oppilaitoksen omistajatyyppi] = d3.oppilaitoksen_omistajatyyppi
	,[Oppilaitostyyppi] = d3.oppilaitostyyppi
	,[Oppilaitoksen maakunta] = d4.maakunta
	,[Oppilaitoksen kunta] = d4.kunta
	,[Oppilaitos] = d3.oppilaitos + '' ('' + d3.oppilaitoskoodi + '')''
	,[Oppilaitoksen opetuskieli] = d3.opetuskieli

	--,[ainevalinnat pojat] = 0
	--,[ainevalinnat tytöt] = 0
	,[ainevalinnat yht] = 0
	--,[pojat] = f.lkm_pojat
	--,[tytöt] = f.lkm_tytot
	,[yht] = isnull(f.lkm_pojat,0)+isnull(f.lkm_tytot,0)

	--ruotsi
	,[Statistikår] = tilv
	,[Kön] = ''Okänd''
	,[Ämne] = null
	,[Ämnesgrupp] = ''Åskådningsämnen''
	,[Språknivå] = null
	,[Årsklasser] = ''Tilläggsundervisning''
	,[Årsklass] = ''Uppgifter har inte samlats in (7–9 och 10)''
	,[Utbildningsanordnare] = d3.koulutuksen_jarjestaja_SV
	,[Läroanstaltens ägartyp] = d3.oppilaitoksen_omistajatyyppi_SV
	,[Läroanstaltstyp] = d3.oppilaitostyyppi_SV
	,[Läroanstaltens landskap] = d4.maakunta_SV
	,[Läroanstaltens kommun] = d4.kunta_SV
	,[Läroanstalt] = d3.oppilaitos_SV + '' ('' + d3.oppilaitoskoodi + '')''
	,[Läroanstaltens undervisningsspråk] = d3.opetuskieli_SV

	--englanti
	,[Statistical year] = tilv
	,[Gender] = ''Unknown''
	,[Subject] = null
	,[Subject group] = ''Ethical subjects''
	,[Language level] = null
	,[Year groups] = ''Voluntary additional basic education''
	,[Year group] = ''Data not collected (7-9 and 10)''
	,[Education provider] = d3.koulutuksen_jarjestaja_EN
	,[Type of institution owner] = d3.oppilaitoksen_omistajatyyppi_EN
	,[Type of institution] = d3.oppilaitostyyppi_EN
	,[Region of the institution] = d4.maakunta_EN
	,[Municipality of the institution] = d4.kunta_EN
	,[Educational institution] = d3.oppilaitos_EN + '' ('' + d3.oppilaitoskoodi + '')''
	,[Language of the institution] = d3.opetuskieli_EN

	--koodit
	,[Koodit Opetuksen järjestäjä] = d3.koulutuksen_jarjestajakoodi
	,[Koodit Oppilaitos] = d3.oppilaitoskoodi
	,[Koodit Oppilaitoksen maakunta] = d4.maakunta_koodi
	,[Koodit Oppilaitoksen kunta] = d4.kunta_koodi

	--järjestys
	,[Sukupuoli järj] = 1
	,[Aine järj] = 99999
	,[Aineryhmä järj] = 99999
	,[Kielen taso järj] = 99999
	,[Vuosiluokka järj] = d2.jarjestys
	,[Vuosiluokat järj] = d2.luokkajako_16_79_jarjestys
	,[Oppilaitoksen omistajatyyppi järj] = d3.jarjestys_omistajatyyppi
	,[Oppilaitostyyppi järj] = d3.jarjestys_oppilaitostyyppi
	,[Oppilaitoksen maakunta järj] = d4.jarjestys_maakunta
	,[Oppilaitoksen opetuskieli järj] = d3.jarjestys_opetuskieli
	

from dbo.f_perusopetuksen_oppilasmaarat f
inner join d_perusopetuksen_vuosiluokat d2 on d2.id=f.vuosiluokka_id
inner join d_oppilaitoksen_taustatiedot d3 on d3.id=f.oppilaitos_id
inner join d_alueluokitus d4 on d4.id=f.oppilaitoksensijainti_id
where (f.lkm_pojat>0 or f.lkm_tytot>0) and d2.vuosiluokka=''Lisäopetus'' and tilv=2010


UNION ALL
--8-9 luokkien valinnaisainevalintoja varten, pojat
select 
	[Tilastovuosi] = tilv

	,[Sukupuoli] = ''Pojat''

	,[Aine] = null
	,[Aineryhmä] = ''Valinnaisaineet''
	,[Kielen taso] = null
	,[Vuosiluokat] = ''Luokat 7-9''
	,[Vuosiluokka] = ''Tietoa ei kerätty (8-9)''

	,[Opetuksen järjestäjä] = d3.koulutuksen_jarjestaja
	,[Oppilaitoksen omistajatyyppi] = d3.oppilaitoksen_omistajatyyppi
	,[Oppilaitostyyppi] = d3.oppilaitostyyppi
	,[Oppilaitoksen maakunta] = d4.maakunta
	,[Oppilaitoksen kunta] = d4.kunta
	,[Oppilaitos] = d3.oppilaitos + '' ('' + d3.oppilaitoskoodi + '')''
	,[Oppilaitoksen opetuskieli] = d3.opetuskieli

	--,[ainevalinnat pojat] = 0
	--,[ainevalinnat tytöt] = 0
	,[ainevalinnat yht] = 0
	--,[pojat] = f.lkm_pojat
	--,[tytöt] = f.lkm_tytot
	,[yht] = f.lkm_pojat

	--ruotsi
	,[Statistikår] = tilv
	,[Kön] = ''Pojkar''
	,[Ämne] = null
	,[Ämnesgrupp] = ''Övriga tillvalsämnen''
	,[Språknivå] = null
	,[Årsklasser] = ''Årskurserna 7–9''
	,[Årsklass] = ''Uppgifter har inte samlats in (8–9)''
	,[Utbildningsanordnare] = d3.koulutuksen_jarjestaja_SV
	,[Läroanstaltens ägartyp] = d3.oppilaitoksen_omistajatyyppi_SV
	,[Läroanstaltstyp] = d3.oppilaitostyyppi_SV
	,[Läroanstaltens landskap] = d4.maakunta_SV
	,[Läroanstaltens kommun] = d4.kunta_SV
	,[Läroanstalt] = d3.oppilaitos_SV + '' ('' + d3.oppilaitoskoodi + '')''
	,[Läroanstaltens undervisningsspråk] = d3.opetuskieli_SV

	--englanti
	,[Statistical year] = tilv
	,[Gender] = ''Boys''
	,[Subject] = null
	,[Subject group] = ''Other optional subjects''
	,[Language level] = null
	,[Year groups] = ''Grades 7-9''
	,[Year group] = ''Data not collected (8-9)''
	,[Education provider] = d3.koulutuksen_jarjestaja_EN
	,[Type of institution owner] = d3.oppilaitoksen_omistajatyyppi_EN
	,[Type of institution] = d3.oppilaitostyyppi_EN
	,[Region of the institution] = d4.maakunta_EN
	,[Municipality of the institution] = d4.kunta_EN
	,[Educational institution] = d3.oppilaitos_EN + '' ('' + d3.oppilaitoskoodi + '')''
	,[Language of the institution] = d3.opetuskieli_EN

	--koodit
	,[Koodit Opetuksen järjestäjä] = d3.koulutuksen_jarjestajakoodi
	,[Koodit Oppilaitos] = d3.oppilaitoskoodi
	,[Koodit Oppilaitoksen maakunta] = d4.maakunta_koodi
	,[Koodit Oppilaitoksen kunta] = d4.kunta_koodi

	--järjestys
	,[Sukupuoli järj] = 1
	,[Aine järj] = 99999
	,[Aineryhmä järj] = 99999
	,[Kielen taso järj] = 99999
	,[Vuosiluokka järj] = d2.jarjestys
	,[Vuosiluokat järj] = d2.luokkajako_16_79_jarjestys
	,[Oppilaitoksen omistajatyyppi järj] = d3.jarjestys_omistajatyyppi
	,[Oppilaitostyyppi järj] = d3.jarjestys_oppilaitostyyppi
	,[Oppilaitoksen maakunta järj] = d4.jarjestys_maakunta
	,[Oppilaitoksen opetuskieli järj] = d3.jarjestys_opetuskieli
	

from dbo.f_perusopetuksen_oppilasmaarat f
inner join d_perusopetuksen_vuosiluokat d2 on d2.id=f.vuosiluokka_id
inner join d_oppilaitoksen_taustatiedot d3 on d3.id=f.oppilaitos_id
inner join d_alueluokitus d4 on d4.id=f.oppilaitoksensijainti_id
where f.lkm_pojat>0 and (d2.vuosiluokka in (''8. luokka'',''9. luokka''))

UNION ALL
--8-9 luokkien valinnaisainevalintoja varten, tytöt
select 
	[Tilastovuosi] = tilv

	,[Sukupuoli] = ''Tytöt''

	,[Aine] = null
	,[Aineryhmä] = ''Valinnaisaineet''
	,[Kielen taso] = null
	,[Vuosiluokat] = ''Luokat 7-9''
	,[Vuosiluokka] = ''Tietoa ei kerätty (8-9)''

	,[Opetuksen järjestäjä] = d3.koulutuksen_jarjestaja
	,[Oppilaitoksen omistajatyyppi] = d3.oppilaitoksen_omistajatyyppi
	,[Oppilaitostyyppi] = d3.oppilaitostyyppi
	,[Oppilaitoksen maakunta] = d4.maakunta
	,[Oppilaitoksen kunta] = d4.kunta
	,[Oppilaitos] = d3.oppilaitos + '' ('' + d3.oppilaitoskoodi + '')''
	,[Oppilaitoksen opetuskieli] = d3.opetuskieli

	--,[ainevalinnat pojat] = 0
	--,[ainevalinnat tytöt] = 0
	,[ainevalinnat yht] = 0
	--,[pojat] = f.lkm_pojat
	--,[tytöt] = f.lkm_tytot
	,[yht] = f.lkm_tytot

	--ruotsi
	,[Statistikår] = tilv
	,[Kön] = ''Flickor''
	,[Ämne] = null
	,[Ämnesgrupp] = ''Övriga tillvalsämnen''
	,[Språknivå] = null
	,[Årsklasser] = ''Årskurserna 7–9''
	,[Årsklass] = ''Uppgifter har inte samlats in (8–9)''
	,[Utbildningsanordnare] = d3.koulutuksen_jarjestaja_SV
	,[Läroanstaltens ägartyp] = d3.oppilaitoksen_omistajatyyppi_SV
	,[Läroanstaltstyp] = d3.oppilaitostyyppi_SV
	,[Läroanstaltens landskap] = d4.maakunta_SV
	,[Läroanstaltens kommun] = d4.kunta_SV
	,[Läroanstalt] = d3.oppilaitos_SV + '' ('' + d3.oppilaitoskoodi + '')''
	,[Läroanstaltens undervisningsspråk] = d3.opetuskieli_SV

	--englanti
	,[Statistical year] = tilv
	,[Gender] = ''Girls''
	,[Subject] = null
	,[Subject group] = ''Other optional subjects''
	,[Language level] = null
	,[Year groups] = ''Grades 7-9''
	,[Year group] = ''Data not collected (8-9)''
	,[Education provider] = d3.koulutuksen_jarjestaja_EN
	,[Type of institution owner] = d3.oppilaitoksen_omistajatyyppi_EN
	,[Type of institution] = d3.oppilaitostyyppi_EN
	,[Region of the institution] = d4.maakunta_EN
	,[Municipality of the institution] = d4.kunta_EN
	,[Educational institution] = d3.oppilaitos_EN + '' ('' + d3.oppilaitoskoodi + '')''
	,[Language of the institution] = d3.opetuskieli_EN

	--koodit
	,[Koodit Opetuksen järjestäjä] = d3.koulutuksen_jarjestajakoodi
	,[Koodit Oppilaitos] = d3.oppilaitoskoodi
	,[Koodit Oppilaitoksen maakunta] = d4.maakunta_koodi
	,[Koodit Oppilaitoksen kunta] = d4.kunta_koodi

	--järjestys
	,[Sukupuoli järj] = 1
	,[Aine järj] = 99999
	,[Aineryhmä järj] = 99999
	,[Kielen taso järj] = 99999
	,[Vuosiluokka järj] = d2.jarjestys
	,[Vuosiluokat järj] = d2.luokkajako_16_79_jarjestys
	,[Oppilaitoksen omistajatyyppi järj] = d3.jarjestys_omistajatyyppi
	,[Oppilaitostyyppi järj] = d3.jarjestys_oppilaitostyyppi
	,[Oppilaitoksen maakunta järj] = d4.jarjestys_maakunta
	,[Oppilaitoksen opetuskieli järj] = d3.jarjestys_opetuskieli
	

from dbo.f_perusopetuksen_oppilasmaarat f
inner join d_perusopetuksen_vuosiluokat d2 on d2.id=f.vuosiluokka_id
inner join d_oppilaitoksen_taustatiedot d3 on d3.id=f.oppilaitos_id
inner join d_alueluokitus d4 on d4.id=f.oppilaitoksensijainti_id
where f.lkm_tytot>0 and (d2.vuosiluokka in (''8. luokka'',''9. luokka''))








' 
GO
/****** Object:  View [dbo].[v_f_tab_ainevalinnat_perusopetus_kieltenmaarat]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_ainevalinnat_perusopetus_kieltenmaarat]'))
EXEC dbo.sp_executesql @statement = N'







CREATE view [dbo].[v_f_tab_ainevalinnat_perusopetus_kieltenmaarat] as

select 
	[Tilastovuosi] = f.tilv

	,[Kielten määrä] = 
		case d1.kieltenmäärä
			when ''nolla'' then ''ei yhtään kieltä''
			when ''yksi'' then ''1 kieli''
			when ''kaksi'' then ''2 kieltä''
			when ''kolme'' then ''3 kieltä''
			when ''neljä'' then ''4 kieltä''
			when ''viisi'' then ''5 kieltä''
			else ''tuntematon''
		end
	,[Vuosiluokat] = d2.luokkajako_16_79
	--,[Vuosiluokka] = d2.vuosiluokka

	,[Opetuksen järjestäjä] = d3.koulutuksen_jarjestaja
	,[Oppilaitoksen omistajatyyppi] = d3.oppilaitoksen_omistajatyyppi
	,[Oppilaitostyyppi] = d3.oppilaitostyyppi
	,[Oppilaitoksen maakunta] = d4.maakunta
	,[Oppilaitoksen kunta] = d4.kunta
	,[Oppilaitos] = d3.oppilaitos + '' ('' + d3.oppilaitoskoodi + '')''
	,[Oppilaitoksen opetuskieli] = d3.opetuskieli

	,[Oppilaat] = f.lkm_kielivalinnat


	--ruotsi
	,[Statistikår] = f.tilv
	,[Antal språk] = 
		case d1.kieltenmäärä
			when ''nolla'' then ''inget språk''
			when ''yksi'' then ''1 språk''
			when ''kaksi'' then ''2 språk''
			when ''kolme'' then ''3 språk''
			when ''neljä'' then ''4 språk''
			when ''viisi'' then ''5 språk''
			else ''tuntematon''
		end
	,[Årsklasser] = d2.luokkajako_16_79_SV
	--,[Årsklass] = d2.vuosiluokka_SV
	,[Utbildningsanordnare] = d3.koulutuksen_jarjestaja_SV
	,[Läroanstaltens ägartyp] = d3.oppilaitoksen_omistajatyyppi_SV
	,[Läroanstaltstyp] = d3.oppilaitostyyppi_SV
	,[Läroanstaltens landskap] = d4.maakunta_SV
	,[Läroanstaltens kommun] = d4.kunta_SV
	,[Läroanstalt] = d3.oppilaitos_SV + '' ('' + d3.oppilaitoskoodi + '')''
	,[Läroanstaltens undervisningsspråk] = d3.opetuskieli_SV

	--englanti
	,[Statistical year] = f.tilv
	,[Number of languages] = 
		case d1.kieltenmäärä
			when ''nolla'' then ''no languages''
			when ''yksi'' then ''1 language''
			when ''kaksi'' then ''2 languages''
			when ''kolme'' then ''3 languages''
			when ''neljä'' then ''4 languages''
			when ''viisi'' then ''5 languages''
			else ''tuntematon''
		end
	,[Year groups] = d2.luokkajako_16_79_EN
	--,[Year group] = d2.vuosiluokka_EN
	,[Education provider] = d3.koulutuksen_jarjestaja_EN
	,[Type of institution owner] = d3.oppilaitoksen_omistajatyyppi_EN
	,[Type of institution] = d3.oppilaitostyyppi_EN
	,[Region of the institution] = d4.maakunta_EN
	,[Municipality of the institution] = d4.kunta_EN
	,[Educational institution] = d3.oppilaitos_EN + '' ('' + d3.oppilaitoskoodi + '')''
	,[Language of the institution] = d3.opetuskieli_EN

	--koodit
	,[Koodit Opetuksen järjestäjä] = d3.koulutuksen_jarjestajakoodi
	,[Koodit Oppilaitos] = d3.oppilaitoskoodi
	,[Koodit Oppilaitoksen maakunta] = d4.maakunta_koodi
	,[Koodit Oppilaitoksen kunta] = d4.kunta_koodi

	--järjestys
	,[Kielten määrä järj] = d1.jarjestys
	,[Vuosiluokat järj] = d2.luokkajako_16_79_jarjestys
	,[Oppilaitoksen omistajatyyppi järj] = d3.jarjestys_omistajatyyppi
	,[Oppilaitostyyppi järj] = d3.jarjestys_oppilaitostyyppi
	,[Oppilaitoksen maakunta järj] = d4.jarjestys_maakunta
	,[Oppilaitoksen opetuskieli järj] = d3.jarjestys_opetuskieli
	

from dbo.f_perusopetuksen_kieltenmaara f
inner join d_perusopetuksen_kieltenmaara d1 on d1.id=f.kieltenmaara_id
inner join d_perusopetuksen_vuosiluokat d2 on d2.id=f.vuosiluokka_id
inner join d_oppilaitoksen_taustatiedot d3 on d3.id=f.oppilaitos_id
inner join d_alueluokitus d4 on d4.id=f.oppilaitoksensijainti_id
where luokkajako_16_79=''Luokat 7-9'' and d4.kunta<>''Ulkomaat''




' 
GO
/****** Object:  View [dbo].[v_f_tab_alueella_tyossakayvat]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_alueella_tyossakayvat]'))
EXEC dbo.sp_executesql @statement = N'






CREATE VIEW [dbo].[v_f_tab_alueella_tyossakayvat] AS

SELECT 
	   [Tilastovuosi] = [tilv]
      ,[lkm]
      ,[Ammattiryhmä (1.taso)] = d1.mitenna_ammattiryhma1
      ,[Ammattiryhmä (2.taso)] = d1.mitenna_ammattiryhma2
      ,[Toimiala (1.taso)] = d2.mitenna_toimiala1
      ,[Toimiala (2.taso)] = d2.mitenna_toimiala2
      ,[Sukupuoli] = d3.sukupuoli
      ,[Äidinkieli] = d4.aidinkieli_versio1
      ,[Ikäryhmä] = d5.ika
      ,[Koulutusaste] = d6.koulutusaste2002
      ,[Tutkintotyyppi] = d7.ammatillisen_koulutuksen_koulutuslaji
      ,[Opintoala] = d8.opintoala2002
	  ,[Koulutusala] = d8.koulutusala2002
      ,[Asuinmaakunta] = d9.maakunta
      ,[Työnantajasektori] = d10.tyonantajasektori
      ,[Työpaikan sijaintimaakunta] = d11.maakunta
      ,[Sosioekonominen asema] = d12.sosioekonominen_asema_ryhma

	  --Ruotsi
	  ,[Statistikår] = [tilv]
      ,[Yrkesgrupp, nivå 1] = d1.mitenna_ammattiryhma1_SV
      ,[Yrkesgrupp, nivå 2] = d1.mitenna_ammattiryhma2_SV
      ,[Bransch, nivå 1] = d2.mitenna_toimiala1_SV
      ,[Bransch, nivå 2] = d2.mitenna_toimiala2_SV
      ,[Kön] = d3.sukupuoli_SV
      ,[Modersmål] = d4.aidinkieli_versio1_SV
      ,[Åldersgrupp] = d5.ika_SV
      ,[Utbildningsnivå] = d6.koulutusaste2002_SV
      ,[Typ av examen] = d7.ammatillisen_koulutuksen_koulutuslaji_SV
      ,[Studieområde] = d8.opintoala2002_SV
	  ,[Utbildningsområde] = d8.koulutusala2002_SV
      ,[Bostadslandskap] = d9.maakunta_SV
      ,[Arbetsgivarens sektor] = d10.tyonantajasektori_SV
      ,[Arbetsplatsens landskap] = d11.maakunta_SV
      ,[Socioekonomisk ställning] = d12.sosioekonominen_asema_ryhma_SV

	  --Englanti
	  ,[Statistical year] = [tilv]
      ,[Profession group, level 1] = d1.mitenna_ammattiryhma1_EN
      ,[Profession group, level 2] = d1.mitenna_ammattiryhma2_EN
      ,[Industry, level 1] = d2.mitenna_toimiala1_EN
      ,[Industry, level 2] = d2.mitenna_toimiala2_EN
      ,[Gender] = d3.sukupuoli_EN
      ,[Mother tongue] = d4.aidinkieli_versio1_EN
      ,[Age group] = d5.ika_EN
      ,[Level of education] = d6.koulutusaste2002_EN
      ,[Qualification type] = d7.ammatillisen_koulutuksen_koulutuslaji_EN
      ,[Subfield of education] = d8.opintoala2002_EN
	  ,[Field of education] = d8.koulutusala2002_EN
      ,[Region of residence] = d9.maakunta_EN
      ,[Employer sector] = d10.tyonantajasektori_EN
      ,[Region where the job is located] = d11.maakunta_EN
      ,[Socio-economic group] = d12.sosioekonominen_asema_ryhma_EN

	--koodimuuttujat
	  ,d8.koulutusala2002_koodi as "Koodit Koulutusala"
	  ,d8.opintoala2002_koodi as "Koodit Opintoala"
	  ,d8.koulutusaste2002_koodi as "Koodit Koulutusaste"
	  ,d9.maakunta_koodi as "Koodit Asuinmaakunta"
	  ,d11.maakunta_koodi as "Koodit Työpaikan maakunta"
	  ,d8.iscle2011_koodi as "Koodit Koulutusaste, taso 1"
	  ,d8.Koulutusaste_taso2_koodi as "Koodit Koulutusaste, taso 2"
	  ,d8.iscfibroad2013_koodi as "Koodit Koulutusala, taso 1"
	  ,d8.iscfinarrow2013_koodi as "Koodit Koulutusala, taso 2"
	  ,d8.iscfi2013_koodi as "Koodit Koulutusala, taso 3"

	--isced
	  ,d8.iscle2011 as "Koulutusaste, taso 1"
	  ,d8.Koulutusaste_taso2 as "Koulutusaste, taso 2"
	  ,d8.iscfibroad2013 as "Koulutusala, taso 1"
	  ,d8.iscfinarrow2013 as "Koulutusala, taso 2"
	  ,d8.iscfi2013 as "Koulutusala, taso 3"
	  ,d8.OKM_ohjauksen_ala as "OKM ohjauksen ala, korkeak."
	  ,d8.iscle2011_SV as "Utbildn.nivå, nivå 1"
	  ,d8.Koulutusaste_taso2_SV as "Utbildn.nivå, nivå 2"
	  ,d8.iscfibroad2013_SV as "Utbildn.område, nivå 1"
	  ,d8.iscfinarrow2013_SV as "Utbildn.område, nivå 2"
	  ,d8.iscfi2013_SV as "Utbildn.område, nivå 3"
	  ,d8.OKM_ohjauksen_ala_SV as "UKM-styrningsområde, högskolor"
	  ,d8.iscle2011_EN as "Level of education, tier 1"
	  ,d8.Koulutusaste_taso2_EN as "Level of education, tier 2"
	  ,d8.iscfibroad2013_EN as "Field of education, tier 1"
	  ,d8.iscfinarrow2013_EN as "Field of education, tier 2"
	  ,d8.iscfi2013_EN as "Field of education, tier 3"
	  ,d8.OKM_ohjauksen_ala_EN as "Field of ed., HE steering"

	  --järjestyskentät
	  ,[Ammattiryhmä (1.taso) järjestys] = d1.jarjestys_ammattiryhma1
      ,[Ammattiryhmä (2.taso) järjestys] = d1.jarjestys_ammattiryhma2
      ,[Toimiala (1.taso) järjestys] = d2.jarjestys_mitenna_toimiala1
      ,[Toimiala (2.taso) järjestys] = d2.jarjestys_mitenna_toimiala2
      ,[Sukupuoli järjestys] = d3.jarjestys
      ,[Äidinkieli järjestys] = d4.jarjestys
      ,[Ikäryhmä järjestys] = d5.jarjestys_ika
      ,[Koulutusaste järjestys] = d6.jarjestys_koulutusaste2002
      ,[Tutkintotyyppi järjestys] = d7.jarjestys
      ,[Opintoala järjestys] = d8.jarjestys_opintoala2002
	  ,[koulutusala järjestys] = d8.jarjestys_koulutusala2002
      ,[Asuinmaakunta järjestys] = d9.jarjestys_maakunta
      ,[Työnantajasektori järjestys] = d10.jarjestys
      ,[Työpaikan sijaintimaakunta järjestys] = d11.jarjestys_maakunta
      ,[Sosioekonominen asema järjestys] = d12.jarjestys_ryhma
	  ,d8.jarjestys_iscle2011 as jarj_isced_koulast1
	  ,d8.jarjestys_Koulutusaste_taso2 as jarj_isced_koulast2
	  ,d8.jarjestys_iscfibroad2013 as jarj_isced_koulala1
	  ,d8.jarjestys_iscfinarrow2013 as jarj_isced_koulala2
	  ,d8.jarjestys_iscfi2013 as jarj_isced_koulala3
	  ,d8.jarjestys_OKM_ohjauksen_ala as jarj_isced_okmohjaus1

  FROM [VipunenTK].[dbo].[f_alueella_tyossakayvat] f
  LEFT JOIN VipunenTK.dbo.d_mitenna_ammatti d1 on d1.id=f.mitenna_ammatti_id
  LEFT JOIN VipunenTK.dbo.d_mitenna_toimiala d2 on d2.id=f.mitenna_toimiala_id
  LEFT JOIN VipunenTK.dbo.d_sukupuoli d3 on d3.id=f.sukupuoli_id
  LEFT JOIN VipunenTK.dbo.d_aidinkieli_versio1 d4 on d4.id=f.aikielir1_id
  LEFT JOIN VipunenTK.dbo.d_ika d5 on d5.id=f.ika_id
  LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d6 on d6.id=f.koulutusaste_id
  LEFT JOIN VipunenTK.dbo.d_ammatillisen_koulutuksen_koulutuslaji d7 on d7.id=f.tutkintolaji_id
  LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d8 on d8.id=f.opintoala_id
  LEFT JOIN VipunenTK.dbo.d_alueluokitus d9 on d9.id=f.asuinmaakunta_id
  LEFT JOIN VipunenTK.dbo.d_tyonantajasektori d10 on d10.id=f.tyonantajasektori_id
  LEFT JOIN VipunenTK.dbo.d_alueluokitus d11 on d11.id=f.tyomaakunta_id
  LEFT JOIN VipunenTK.dbo.d_sosioekonominen_asema d12 on d12.id=f.sosioekonominen_asema_id







' 
GO
/****** Object:  View [dbo].[v_f_tab_alueella_tyossakayvat_ammateittain]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_alueella_tyossakayvat_ammateittain]'))
EXEC dbo.sp_executesql @statement = N'





CREATE VIEW [dbo].[v_f_tab_alueella_tyossakayvat_ammateittain] AS

SELECT [Tilastovuosi] = [tilv]
      ,[lkm]
      ,[Ammattiryhmä 1. taso] = d1.mitenna_ammattiryhma1
      ,[Ammattiryhmä 2. taso] = d1.mitenna_ammattiryhma2
	  ,[Ammatti] = d1.mitenna_ammatti
	  ,[Sukupuoli] = d2.sukupuoli
	  ,[Äidinkieli] = d4.aidinkieli_versio1
      ,[Ikäryhmä] = d3.ika5v
	  ,[Koulutusaste] = d5.koulutusaste2002
	  ,[Ammatillisen koulutuksen koulutuslaji] = d6.ammatillisen_koulutuksen_koulutuslaji
	  ,[Opintoala] = d8.opintoala2002
	  ,[Koulutusala] = d8.koulutusala2002
      ,[Työpaikan sijaintimaakunta] = d7.maakunta

	  --Ruotsi
	  ,[Statistikår] = [tilv]
      ,[Yrkesgrupp, nivå 1] = d1.mitenna_ammattiryhma1_SV
      ,[Yrkesgrupp, nivå 2] = d1.mitenna_ammattiryhma2_SV
	  ,[Yrke] = d1.mitenna_ammatti_SV
	  ,[Kön] = d2.sukupuoli_SV
	  ,[Modersmål] = d4.aidinkieli_versio1_SV
      ,[Åldersgrupp] = d3.ika5v_SV
	  ,[Utbildningsnivå] = d5.koulutusaste2002_SV
	  ,[Utbildningsslag] = d6.ammatillisen_koulutuksen_koulutuslaji_SV
	  ,[Studieområde] = d8.opintoala2002_SV
	  ,[Utbildningsområde] = d8.koulutusala2002_SV
      ,[Arbetsplatsens landskap] = d7.maakunta_SV

	  --Englanti
	  ,[Statistical year] = [tilv]
      ,[Profession group, level 1] = d1.mitenna_ammattiryhma1_EN
      ,[Profession group, level 2] = d1.mitenna_ammattiryhma2_EN
	  ,[Profession] = d1.mitenna_ammatti_EN
	  ,[Gender] = d2.sukupuoli_EN
	  ,[Mother tongue] = d4.aidinkieli_versio1_EN
      ,[Age group] = d3.ika5v_EN
	  ,[Level of education] = d5.koulutusaste2002_EN
	  ,[Form of education and training] = d6.ammatillisen_koulutuksen_koulutuslaji_EN
	  ,[Subfield of education] = d8.opintoala2002_EN
	  ,[Field of education] = d8.koulutusala2002_EN
      ,[Region where the job is located] = d7.maakunta_EN

	  --koodimuuttujat
	  ,d8.koulutusala2002_koodi as "Koodit Koulutusala"
	  ,d8.opintoala2002_koodi as "Koodit Opintoala"
	  ,d8.koulutusaste2002_koodi as "Koodit Koulutusaste"
	  ,d8.iscle2011_koodi as "Koodit Koulutusaste, taso 1"
	  ,d7.maakunta_koodi as "Koodit Työpaikan maakunta"
	  ,d8.Koulutusaste_taso2_koodi as "Koodit Koulutusaste, taso 2"
	  ,d8.iscfibroad2013_koodi as "Koodit Koulutusala, taso 1"
	  ,d8.iscfinarrow2013_koodi as "Koodit Koulutusala, taso 2"
	  ,d8.iscfi2013_koodi as "Koodit Koulutusala, taso 3"

	  --isced
	  ,d8.iscle2011 as "Koulutusaste, taso 1"
	  ,d8.Koulutusaste_taso2 as "Koulutusaste, taso 2"
	  ,d8.iscfibroad2013 as "Koulutusala, taso 1"
	  ,d8.iscfinarrow2013 as "Koulutusala, taso 2"
	  ,d8.iscfi2013 as "Koulutusala, taso 3"
	  ,d8.OKM_ohjauksen_ala as "OKM ohjauksen ala, korkeak."
	  ,d8.iscle2011_SV as "Utbildn.nivå, nivå 1"
	  ,d8.Koulutusaste_taso2_SV as "Utbildn.nivå, nivå 2"
	  ,d8.iscfibroad2013_SV as "Utbildn.område, nivå 1"
	  ,d8.iscfinarrow2013_SV as "Utbildn.område, nivå 2"
	  ,d8.iscfi2013_SV as "Utbildn.område, nivå 3"
	  ,d8.OKM_ohjauksen_ala_SV as "UKM-styrningsområde, högskolor"
	  ,d8.iscle2011_EN as "Level of education, tier 1"
	  ,d8.Koulutusaste_taso2_EN as "Level of education, tier 2"
	  ,d8.iscfibroad2013_EN as "Field of education, tier 1"
	  ,d8.iscfinarrow2013_EN as "Field of education, tier 2"
	  ,d8.iscfi2013_EN as "Field of education, tier 3"
	  ,d8.OKM_ohjauksen_ala_EN as "Field of ed., HE steering"

	  --järjestyskentät
	  ,[Ammattiryhmä 1. taso järj] = RIGHT(d1.jarjestys_ammattiryhma1,2)
      ,[Ammattiryhmä 2. taso järj] = CASE RIGHT(d1.jarjestys_ammattiryhma2,5) when ''010.2'' then ''01.02'' when ''020.9'' then ''02.09'' else RIGHT(d1.jarjestys_ammattiryhma2,5) end
	  ,[Ammatti järj] = RIGHT(d1.jarjestys_ammatti,5)
	  ,[Sukupuoli järj] = d2.jarjestys
	  ,[Äidinkieli järj] = d4.jarjestys
      ,[Ikäryhmä järj] = d3.jarjestys_ika5v
	  ,[Koulutusaste järj] = d5.jarjestys_koulutusaste2002
	  ,[Ammatillisen koulutuksen koulutuslaji järj] = d6.jarjestys
	  ,[Opintoala järj] = d8.jarjestys_opintoala2002
	  ,[Koulutusala järj] = d8.jarjestys_koulutusala2002
      ,[Työpaikan sijaintimaakunta järj] = d7.jarjestys_maakunta
	  ,d8.jarjestys_iscle2011 as jarj_isced_koulast1
	  ,d8.jarjestys_Koulutusaste_taso2 as jarj_isced_koulast2
	  ,d8.jarjestys_iscfibroad2013 as jarj_isced_koulala1
	  ,d8.jarjestys_iscfinarrow2013 as jarj_isced_koulala2
	  ,d8.jarjestys_iscfi2013 as jarj_isced_koulala3
	  ,d8.jarjestys_OKM_ohjauksen_ala as jarj_isced_okmohjaus1

  FROM [VipunenTK].[dbo].[f_tyossakayvat_ammateittain] f
  LEFT JOIN dbo.d_mitenna_ammatti d1 on d1.id=f.mitenna_ammatti_id
  LEFT JOIN dbo.d_sukupuoli d2 on d2.id=f.sukupuoli_id
  LEFT JOIN dbo.d_ika d3 on d3.id=f.ika_id
  LEFT JOIN dbo.d_aidinkieli_versio1 d4 on d4.id=f.aikielir1_id
  LEFT JOIN dbo.d_koulutusluokitus d5 on d5.id=f.koulutusaste_id
  LEFT JOIN dbo.d_ammatillisen_koulutuksen_koulutuslaji d6 on d6.id=f.tutkintolaji_id
  LEFT JOIN dbo.d_alueluokitus d7 on d7.id=f.tyomaakunta_id
  LEFT JOIN dbo.d_koulutusluokitus d8 on d8.id=f.koulutusluokitus_id






' 
GO
/****** Object:  View [dbo].[v_f_tab_alueella_tyossakayvat_ika1v]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_alueella_tyossakayvat_ika1v]'))
EXEC dbo.sp_executesql @statement = N'





CREATE VIEW [dbo].[v_f_tab_alueella_tyossakayvat_ika1v] AS

SELECT [Tilastovuosi] = [tilv]
      ,[lkm]
      ,[Ammattiryhmä 1. taso] = d1.mitenna_ammattiryhma1
      ,[Ammattiryhmä 2. taso] = d1.mitenna_ammattiryhma2
      ,[Toimiala 1. taso] = d8.mitenna_toimiala1
      ,[Toimiala 2. taso] = d8.mitenna_toimiala2
	  ,[Äidinkieli] = d4.aidinkieli_versio1
      ,[Ikäryhmä] = d3.ika5v
	  ,[Ikä] = d3.ika
	  ,[Asuinmaakunta] = d5.maakunta
      ,[Työpaikan sijaintimaakunta] = d7.maakunta

	  --Ruotsi
	  ,[Statistikår] = [tilv]
      ,[Yrkesgrupp, nivå 1] = d1.mitenna_ammattiryhma1_SV
      ,[Yrkesgrupp, nivå 2] = d1.mitenna_ammattiryhma2_SV
      ,[Bransch, nivå 1] = d8.mitenna_toimiala1_SV
      ,[Bransch, nivå 2] = d8.mitenna_toimiala2_SV
	  ,[Modersmål] = d4.aidinkieli_versio1_SV
      ,[Åldersgrupp] = d3.ika5v_SV
	  ,[Ålder] = d3.ika_SV
	  ,[Bostadslandskap] = d5.maakunta_SV
      ,[Arbetsplatsens landskap] = d7.maakunta_SV

	  --Englanti
	  ,[Statistical year] = [tilv]
      ,[Profession group, level 1] = d1.mitenna_ammattiryhma1_EN
      ,[Profession group, level 2] = d1.mitenna_ammattiryhma2_EN
      ,[Industry, level 1] = d8.mitenna_toimiala1_EN
      ,[Industry, level 2] = d8.mitenna_toimiala2_EN
	  ,[Mother tongue] = d4.aidinkieli_versio1_EN
      ,[Age group] = d3.ika5v_EN
	  ,[Age] = d3.ika_EN
	  ,[Region of residence] = d5.maakunta_EN
      ,[Region where the job is located] = d7.maakunta_EN

	  --koodimuuttujat
	  ,[Koodit Työpaikan maakunta] = d7.maakunta_koodi

	  --järjestyskentät
	  ,[Ammattiryhmä 1. taso järj] = d1.jarjestys_ammattiryhma1
      ,[Ammattiryhmä 2. taso järj] = d1.jarjestys_ammattiryhma2
      ,[Toimiala 1. taso järj] = d8.jarjestys_mitenna_toimiala1
      ,[Toimiala 2. taso järj] = d8.jarjestys_mitenna_toimiala2
	  ,[Äidinkieli järj] = d4.jarjestys
      ,[Ikäryhmä järj] = d3.jarjestys_ika5v
	  ,[Ikä järj] = d3.jarjestys_ika
	  ,[Asuinmaakunta järj] = d5.jarjestys_maakunta
      ,[Työpaikan sijaintimaakunta järj] = d7.jarjestys_maakunta


  FROM [VipunenTK].[dbo].[f_alueella_tyossakayvat_1v] f
  LEFT JOIN dbo.d_mitenna_ammatti d1 on d1.id=f.mitenna_ammatti_id
  LEFT JOIN dbo.d_mitenna_toimiala d2 on d2.id=f.mitenna_toimiala_id
  LEFT JOIN dbo.d_ika d3 on d3.id=f.ika_id
  LEFT JOIN dbo.d_aidinkieli_versio1 d4 on d4.id=f.aikielir1_id
  LEFT JOIN dbo.d_alueluokitus d5 on d5.id=f.asuinmaakunta_id
  LEFT JOIN dbo.d_alueluokitus d7 on d7.id=f.tyomaakunta_id
  LEFT JOIN dbo.d_mitenna_toimiala d8 on d8.id=f.mitenna_toimiala_id





' 
GO
/****** Object:  View [dbo].[v_f_tab_alueella_tyossakayvat_toimialoittain]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_alueella_tyossakayvat_toimialoittain]'))
EXEC dbo.sp_executesql @statement = N'




CREATE VIEW [dbo].[v_f_tab_alueella_tyossakayvat_toimialoittain] AS

SELECT [Tilastovuosi] = [tilv]
      ,[lkm]
      ,[Ammattiryhmä 1. taso] = d1.mitenna_ammattiryhma1
      ,[Ammattiryhmä 2. taso] = d1.mitenna_ammattiryhma2
      ,[Toimiala 1. taso] = d8.mitenna_toimiala1
      ,[Toimiala 2. taso] = d8.mitenna_toimiala2
      ,[Toimiala Tilastokeskus] = d2.toimiala1
      ,[Ikäryhmä] = d3.ika5v
      ,[Koulutusaste] = d4.koulutusaste2002
	  ,[Ammatillisen koulutuksen koulutuslaji] = d5.ammatillisen_koulutuksen_koulutuslaji
      ,[Opintoala] = d6.opintoala2002
	  ,[Koulutusala] = d6.koulutusala2002
      ,[Työpaikan sijaintimaakunta] = d7.maakunta

	  --Ruotsi
	  ,[Statistikår] = [tilv]
      ,[Yrkesgrupp, nivå 1] = d1.mitenna_ammattiryhma1_SV
      ,[Yrkesgrupp, nivå 2] = d1.mitenna_ammattiryhma2_SV
      ,[Bransch, nivå 1] = d8.mitenna_toimiala1_SV
      ,[Bransch, nivå 2] = d8.mitenna_toimiala2_SV
      ,[Bransch] = d2.toimiala1_SV
      ,[Åldersgrupp] = d3.ika5v_SV
      ,[Utbildningsnivå] = d4.koulutusaste2002_SV
	  ,[Utbildningsslag] = d5.ammatillisen_koulutuksen_koulutuslaji_SV
      ,[Studieområde] = d6.opintoala2002_SV
	  ,[Utbildningsområde] = d6.koulutusala2002_SV
      ,[Arbetsplatsens landskap] = d7.maakunta_SV

	  --Englanti
	  ,[Statistical year] = [tilv]
      ,[Profession group, level 1] = d1.mitenna_ammattiryhma1_EN
      ,[Profession group, level 2] = d1.mitenna_ammattiryhma2_EN
      ,[Industry, level 1] = d8.mitenna_toimiala1_EN
      ,[Industry, level 2] = d8.mitenna_toimiala2_EN
      ,[Industry] = d2.toimiala1_EN
      ,[Age group] = d3.ika5v_EN
      ,[Level of education] = d4.koulutusaste2002_EN
	  ,[Form of education and training] = d5.ammatillisen_koulutuksen_koulutuslaji_EN
      ,[Subfield of education] = d6.opintoala2002_EN
	  ,[Field of education] = d6.koulutusala2002_EN
      ,[Region where the job is located] = d7.maakunta_EN

	  --koodimuuttujat
	  ,d6.koulutusala2002_koodi as "Koodit Koulutusala"
	  ,d6.opintoala2002_koodi as "Koodit Opintoala"
	  ,d6.koulutusaste2002_koodi as "Koodit Koulutusaste"
	  ,d6.iscle2011_koodi as "Koodit Koulutusaste, taso 1"
	  ,d7.maakunta_koodi as "Koodit Työpaikan maakunta"
	  ,d6.Koulutusaste_taso2_koodi as "Koodit Koulutusaste, taso 2"
	  ,d6.iscfibroad2013_koodi as "Koodit Koulutusala, taso 1"
	  ,d6.iscfinarrow2013_koodi as "Koodit Koulutusala, taso 2"
	  ,d6.iscfi2013_koodi as "Koodit Koulutusala, taso 3"

	  --isced
	  ,d6.iscle2011 as "Koulutusaste, taso 1"
	  ,d6.Koulutusaste_taso2 as "Koulutusaste, taso 2"
	  ,d6.iscfibroad2013 as "Koulutusala, taso 1"
	  ,d6.iscfinarrow2013 as "Koulutusala, taso 2"
	  ,d6.iscfi2013 as "Koulutusala, taso 3"
	  ,d6.OKM_ohjauksen_ala as "OKM ohjauksen ala, korkeak."
	  ,d6.iscle2011_SV as "Utbildn.nivå, nivå 1"
	  ,d6.Koulutusaste_taso2_SV as "Utbildn.nivå, nivå 2"
	  ,d6.iscfibroad2013_SV as "Utbildn.område, nivå 1"
	  ,d6.iscfinarrow2013_SV as "Utbildn.område, nivå 2"
	  ,d6.iscfi2013_SV as "Utbildn.område, nivå 3"
	  ,d6.OKM_ohjauksen_ala_SV as "UKM-styrningsområde, högskolor"
	  ,d6.iscle2011_EN as "Level of education, tier 1"
	  ,d6.Koulutusaste_taso2_EN as "Level of education, tier 2"
	  ,d6.iscfibroad2013_EN as "Field of education, tier 1"
	  ,d6.iscfinarrow2013_EN as "Field of education, tier 2"
	  ,d6.iscfi2013_EN as "Field of education, tier 3"
	  ,d6.OKM_ohjauksen_ala_EN as "Field of ed., HE steering"

	  --järjestyskentät
	  ,[Ammattiryhmä 1. taso järj] = d1.jarjestys_ammattiryhma1
      ,[Ammattiryhmä 2. taso järj] = d1.jarjestys_ammattiryhma2
      ,[Toimiala 1. taso järj] = d8.jarjestys_mitenna_toimiala1
      ,[Toimiala 2. taso järj] = d8.jarjestys_mitenna_toimiala2
      ,[Toimiala Tilastokeskus järj] = d2.jarjestys_toimiala1
      ,[Ikäryhmä järj] = d3.jarjestys_ika5v
      ,[Koulutusaste järj] = d4.jarjestys_koulutusaste2002
	  ,[Ammatillisen_koulutuksen_koulutuslaji järj] = d5.jarjestys
      ,[Opintoala järj] = d6.jarjestys_opintoala2002
	  ,[Koulutusala järj] = d6.jarjestys_koulutusala2002
      ,[Työpaikan sijaintimaakunta järj] = d7.jarjestys_maakunta
	  ,d6.jarjestys_iscle2011 as jarj_isced_koulast1
	  ,d6.jarjestys_Koulutusaste_taso2 as jarj_isced_koulast2
	  ,d6.jarjestys_iscfibroad2013 as jarj_isced_koulala1
	  ,d6.jarjestys_iscfinarrow2013 as jarj_isced_koulala2
	  ,d6.jarjestys_iscfi2013 as jarj_isced_koulala3
	  ,d6.jarjestys_OKM_ohjauksen_ala as jarj_isced_okmohjaus1

  FROM [VipunenTK].[dbo].[f_alueella_tyossakayvat_toimialoittain] f
  LEFT JOIN dbo.d_mitenna_ammatti d1 on d1.id=f.mitenna_ammatti_id
  LEFT JOIN dbo.d_toimiala_tk d2 on d2.id=f.tol2008_id
  LEFT JOIN dbo.d_ika d3 on d3.id=f.ika_id
  LEFT JOIN dbo.d_koulutusluokitus d4 on d4.id=f.koulutusaste_id
  LEFT JOIN dbo.d_ammatillisen_koulutuksen_koulutuslaji d5 on d5.id=tutkintolaji_id
  LEFT JOIN dbo.d_koulutusluokitus d6 on d6.id=opintoala_id
  LEFT JOIN dbo.d_alueluokitus d7 on d7.id=f.tyomaakunta_id
  LEFT JOIN dbo.d_mitenna_toimiala d8 on d8.id=f.mitenna_toimiala_id




' 
GO
/****** Object:  View [dbo].[v_f_tab_amk_tutkimus_kehitys]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_amk_tutkimus_kehitys]'))
EXEC dbo.sp_executesql @statement = N'





CREATE VIEW [dbo].[v_f_tab_amk_tutkimus_kehitys] AS

SELECT 
--Aikamuuttyjat
		  ''Tilastovuosi'' = [tilastovuosi]
--Aluemuuttujat
		  ,''AVI-alue (tutkimusmenot)'' = d_alueluokitus_historia.avi
		  ,''ELY-alue (tutkimusmenot)'' = d_alueluokitus_historia.ely
		  ,''Maakunta (tutkimusmenot)'' = d_alueluokitus_historia.maakunta
		  ,''Kunta (tutkimusmenot)'' = d_alueluokitus_historia.kunta
--Henkilömuuttujat
          ,''Sukupuoli'' = d_sukupuoli.sukupuoli
          ,''Tutkintotaso'' = d_tutkintotaso.tutkintotaso
		  ,''Tutkimustehtävä'' = d_tutkimus_tehtava.tutkimus_tehtava
		  ,''AVI-alue (T&K henkilökunta)'' = d_alueluokitus_historia.avi
		  ,''ELY-alue (T&K henkilökunta)'' = d_alueluokitus_historia.ely
		  ,''Maakunta (T&K henkilökunta)'' = d_alueluokitus_historia.maakunta
		  ,''Kunta (T&K henkilökunta)'' = d_alueluokitus_historia.kunta
--Organisaatiomuuttujat
          ,''Ammattikorkeakoulu'' = d_oppilaitoksen_taustatiedot.oppilaitos
--Tieteenalamuuttujat
          ,''Päätieteenala (2007 luokitus)'' = d_tieteenala.paatieteenala2007
          ,''Päätieteenala (2010 luokitus)'' = d_tieteenala.paatieteenala2010
          ,''Tieteenala (2007 luokitus)'' = d_tieteenala.tieteenala2007
          ,''Tieteenala (2010 luokitus)'' = d_tieteenala.tieteenala2010
--Rahoitus- ja menomuuttujat
          ,''Rahoituslähde'' = d_tutkimuksen_rahoituslahde.rahoituslahde
          ,''Rahoituksen laatu'' = d_tutkimuksen_rahoituslahde.rahoituksen_laatu
          ,''Rahoituslähteen tyyppi'' = d_tutkimuksen_rahoituslahde.rahoituslahteen_tyyppi
          ,''Ulkop. rahoituksen kansainvälisyys'' = d_tutkimuksen_rahoituslahde.ulkopuolisen_rahoituksen_kansainvalisyys
          ,''Rahoituslähdetarkennus'' = d_tutkimuksen_rahoituslahde.rahoituslahdetarkennus
          ,''Tutkimusmenojen kohde'' = d_tutkimusmenojen_kohde.menokohde
          ,''Tutkimusmenotyyppi'' = d_tutkimusmenojen_kohde.menotyyppi
--Järjestykset
          ,jarjestys_amk = d_oppilaitoksen_taustatiedot.jarjestys_oppilaitos
          ,jarjestys_sukupuoli = d_sukupuoli.jarjestys
		  ,jarjestys_tutkimustehtava = d_tutkimus_tehtava.jarjestys
		  ,jarjestys_avi = d_alueluokitus_historia.jarjestys_avi
		  ,jarjestys_ely = d_alueluokitus_historia.jarjestys_ely
		  ,jarjestys_maakunta = d_alueluokitus_historia.jarjestys_maakunta
          ,d_tieteenala.jarjestys_paatieteenala2007
          ,d_tieteenala.jarjestys_paatieteenala2010
          ,d_tieteenala.jarjestys_tieteenala2007
          ,d_tieteenala.jarjestys_tieteenala2010
          ,jarjestys_tutkintotaso = d_tutkintotaso.jarjestys
          ,d_tutkimuksen_rahoituslahde.jarjestys_rahoituslahde
          ,d_tutkimuksen_rahoituslahde.jarjestys_rahoituksen_laatu
          ,d_tutkimuksen_rahoituslahde.jarjestys_rahoituslahteen_tyyppi
          ,d_tutkimuksen_rahoituslahde.jarjestys_ulkopuolisen_rahoituksen_kansainvalisyys
          ,d_tutkimuksen_rahoituslahde.jarjestys_rahoituslahdetarkennus
          ,d_tutkimusmenojen_kohde.jarjestys_menokohde
          ,d_tutkimusmenojen_kohde.jarjestys_menotyyppi
--Lukumäärämuuttujat
      ,''Tutkimusrahoitus (1000 euroa)2'' = [tutkimusrahoitus]
      ,''Tutkimushenkilökunnan lkm (alueittain)2'' = lkm_tutkimushenkilokunta_alueittain
	  ,''Tutkimushenkilökunnan lkm (tehtävittäin)2'' = lkm_tutkimushenkilokunta_paatieteenaloittain_tehtavittain
	  ,''Tutkimushenkilökunnan lkm (tutkintotasoittain)2'' = lkm_tutkimushenkilokunta_tutkintotasoittain
	  ,''Tutkimusmenot (1000 euroa)2'' = [tutkimusmenot]
	  ,''Tutkimusmenot (1000 euroa) arvio seuraavasta tilastovuodesta2'' = [tutkimusmenot_arvio_seuraavatilastovuosi]
	  ,''Tutkimusmenot (1000 euroa) (alueittain)2'' = [tutkimusmenot_alueittain]
	  ,''Tutkimusmenot (1000 euroa) (tieteenaloittain)2'' = [tutkimusmenot_tieteenaloittain]
	  ,''Tutkimustyövuodet (alueittain)2'' = [lkm_tutkimustyovuodet_alueittain]
	  ,''Tutkimustyövuodet (tehtävittäin)2'' = [lkm_tutkimustyovuodet_tehtavittain]
	  ,''Tutkimustyövuodet (tutkintotasoittain)2'' = [lkm_tutkimustyovuodet_tutkintotasoittain]

--RUOTSI
--Aikamuuttyjat
		  ,''Statistikår'' = [tilastovuosi]
--Aluemuuttujat
		  ,''RFV-område (forskningsutgifter)'' = d_alueluokitus_historia.avi_SV
		  ,''NTM-område (forskningsutgifter)'' = d_alueluokitus_historia.ely_SV
		  ,''Landskap (forskningsutgifter)'' = d_alueluokitus_historia.maakunta_SV
		  ,''Kommun (forskningsutgifter)'' = d_alueluokitus_historia.kunta_SV
--Henkilömuuttujat
          ,''Kön'' = d_sukupuoli.sukupuoli_SV
          ,''Examensnivå'' = d_tutkintotaso.tutkintotaso_SV
		  ,''Forskningsuppgift'' = d_tutkimus_tehtava.tutkimus_tehtava_SV
		  ,''RFV-område (F&U personal)'' = d_alueluokitus_historia.avi_SV
		  ,''NTM-område (F&U personal)'' = d_alueluokitus_historia.ely_SV
		  ,''Landskap (F&U personal)'' = d_alueluokitus_historia.maakunta_SV
		  ,''Kommun (F&U personal)'' = d_alueluokitus_historia.kunta_SV
--Organisaatiomuuttujat
          ,''Yrkehögskola'' = d_oppilaitoksen_taustatiedot.oppilaitos_SV
--Tieteenalamuuttujat
          ,''Huvudvetenskapsgren (2007)'' = d_tieteenala.paatieteenala2007_SV
          ,''Huvudvetenskapsgren (2010)'' = d_tieteenala.paatieteenala2010_SV
          ,''Vetenskapsgren (2007)'' = d_tieteenala.tieteenala2007_SV
          ,''Vetenskapsgren (2010)'' = d_tieteenala.tieteenala2010_SV
--Rahoitus- ja menomuuttujat
          ,''Finansieringskälla'' = d_tutkimuksen_rahoituslahde.rahoituslahde_SV
          ,''Finansieringstyp'' = d_tutkimuksen_rahoituslahde.rahoituksen_laatu_SV
          ,''Finansieringskällans typ'' = d_tutkimuksen_rahoituslahde.rahoituslahteen_tyyppi_SV
          ,''Externa finansieringens internat.'' = d_tutkimuksen_rahoituslahde.ulkopuolisen_rahoituksen_kansainvalisyys_SV
          ,''Spec. av finansieringskällan'' = d_tutkimuksen_rahoituslahde.rahoituslahdetarkennus_SV
          ,''Forskningsutgifternas mål'' = d_tutkimusmenojen_kohde.menokohde_SV
          ,''Typ av forskningsutgifter'' = d_tutkimusmenojen_kohde.menotyyppi_SV

--ENGLANTI
--Aikamuuttyjat
		  ,''Statistical year'' = [tilastovuosi]
--Aluemuuttujat
		  ,''AVI area (R&D budget funds)'' = d_alueluokitus_historia.avi_EN
		  ,''ELY area (R&D budget funds)'' = d_alueluokitus_historia.ely_EN
		  ,''Region (R&D budget funds)'' = d_alueluokitus_historia.maakunta_EN
		  ,''Municipality (R&D budget funds)'' = d_alueluokitus_historia.kunta_EN
--Henkilömuuttujat
          ,''Gender'' = d_sukupuoli.sukupuoli_EN
          ,''Level of degree'' = d_tutkintotaso.tutkintotaso_EN
		  ,''R&D task'' = d_tutkimus_tehtava.tutkimus_tehtava_EN
		  ,''AVI area (R&D personnel)'' = d_alueluokitus_historia.avi_EN
		  ,''ELY area (R&D personnel)'' = d_alueluokitus_historia.ely_EN
		  ,''Region (R&D personnel)'' = d_alueluokitus_historia.maakunta_EN
		  ,''Municipality (R&D personnel)'' = d_alueluokitus_historia.kunta_EN
--Organisaatiomuuttujat
          ,''Univ. of applied sciences'' = d_oppilaitoksen_taustatiedot.oppilaitos_EN
--Tieteenalamuuttujat
          ,''Main discipline (2007)'' = d_tieteenala.paatieteenala2007_EN
          ,''Main discipline (2010)'' = d_tieteenala.paatieteenala2010_EN
          ,''Discipline (2007)'' = d_tieteenala.tieteenala2007_EN
          ,''Discipline (2010)'' = d_tieteenala.tieteenala2010_EN
--Rahoitus- ja menomuuttujat
          ,''Source of funding I'' = d_tutkimuksen_rahoituslahde.rahoituslahde_EN
          ,''Type of funding II'' = d_tutkimuksen_rahoituslahde.rahoituksen_laatu_EN
          ,''Type of funding I'' = d_tutkimuksen_rahoituslahde.rahoituslahteen_tyyppi_EN
          ,''External funding (internat.)'' = d_tutkimuksen_rahoituslahde.ulkopuolisen_rahoituksen_kansainvalisyys_EN
          ,''Source of funding II'' = d_tutkimuksen_rahoituslahde.rahoituslahdetarkennus_EN
          ,''Target of budget funds'' = d_tutkimusmenojen_kohde.menokohde_EN
          ,''Type of budget funds'' = d_tutkimusmenojen_kohde.menotyyppi_EN

FROM (
SELECT [tilastovuosi]
	  ,oppilaitos_id
	  ,rahoituslahde_id
	  ,alueluokitus_id = -1
	  ,sukupuoli_id = -1
	  ,tehtava_id = -1
	  ,tieteenala_id = -1
	  ,tutkintotaso_id = -1
	  ,menokohde_id = -1
      ,tutkimusrahoitus
	  ,lkm_tutkimushenkilokunta_alueittain = NULL
	  ,lkm_tutkimushenkilokunta_paatieteenaloittain_tehtavittain = NULL
	  ,lkm_tutkimushenkilokunta_tutkintotasoittain = NULL
	  ,tutkimusmenot = NULL
	  ,tutkimusmenot_arvio_seuraavatilastovuosi = NULL
	  ,tutkimusmenot_alueittain = NULL
	  ,tutkimusmenot_tieteenaloittain = NULL
	  ,lkm_tutkimustyovuodet_alueittain = NULL
	  ,lkm_tutkimustyovuodet_tehtavittain = NULL
	  ,lkm_tutkimustyovuodet_tutkintotasoittain = NULL
  FROM [dbo].[f_Ammattikorkeakoulujen_tutkimus_ja_kehitys_rahoitus]

UNION ALL
SELECT [tilastovuosi]
	  ,oppilaitos_id
	  ,rahoituslahde_id = -1
	  ,alueluokitus_id
	  ,sukupuoli_id = -1
	  ,tehtava_id = -1
	  ,tieteenala_id = -1
	  ,tutkintotaso_id = -1
	  ,menokohde_id = -1
      ,tutkimusrahoitus = NULL
	  ,lkm_tutkimushenkilokunta_alueittain
	  ,lkm_tutkimushenkilokunta_paatieteenaloittain_tehtavittain = NULL
	  ,lkm_tutkimushenkilokunta_tutkintotasoittain = NULL
	  ,tutkimusmenot = NULL
	  ,tutkimusmenot_arvio_seuraavatilastovuosi = NULL
	  ,tutkimusmenot_alueittain = NULL
	  ,tutkimusmenot_tieteenaloittain = NULL
	  ,lkm_tutkimustyovuodet_alueittain = NULL
	  ,lkm_tutkimustyovuodet_tehtavittain = NULL
	  ,lkm_tutkimustyovuodet_tutkintotasoittain = NULL
  FROM VipunenTK.[dbo].[f_Ammattikorkeakoulujen_tutkimus_ja_kehitys_tutkimushenkilokunta_alueittain]

UNION ALL
SELECT [tilastovuosi]
	  ,oppilaitos_id
	  ,rahoituslahde_id = -1
	  ,alueluokitus_id = -1
	  ,sukupuoli_id
	  ,tehtava_id
	  ,tieteenala_id
	  ,tutkintotaso_id = -1
	  ,menokohde_id = -1
      ,tutkimusrahoitus = NULL
	  ,lkm_tutkimushenkilokunta_alueittain = NULL
	  ,lkm_tutkimushenkilokunta_paatieteenaloittain_tehtavittain
	  ,lkm_tutkimushenkilokunta_tutkintotasoittain = NULL
	  ,tutkimusmenot = NULL
	  ,tutkimusmenot_arvio_seuraavatilastovuosi = NULL
	  ,tutkimusmenot_alueittain = NULL
	  ,tutkimusmenot_tieteenaloittain = NULL
	  ,lkm_tutkimustyovuodet_alueittain = NULL
	  ,lkm_tutkimustyovuodet_tehtavittain = NULL
	  ,lkm_tutkimustyovuodet_tutkintotasoittain = NULL
  FROM VipunenTK.[dbo].[f_Ammattikorkeakoulujen_tutkimus_ja_kehitys_tutkimushenkilokunta_paatieteenaloittain_tehtavittain]

UNION ALL
SELECT [tilastovuosi]
	  ,oppilaitos_id
	  ,rahoituslahde_id = -1
	  ,alueluokitus_id = -1
	  ,sukupuoli_id
	  ,tehtava_id = -1
	  ,tieteenala_id = -1
	  ,tutkintotaso_id
	  ,menokohde_id = -1
      ,tutkimusrahoitus = NULL
	  ,lkm_tutkimushenkilokunta_alueittain = NULL
	  ,lkm_tutkimushenkilokunta_paatieteenaloittain_tehtavittain = NULL
	  ,lkm_tutkimushenkilokunta_tutkintotasoittain
	  ,tutkimusmenot = NULL
	  ,tutkimusmenot_arvio_seuraavatilastovuosi = NULL
	  ,tutkimusmenot_alueittain = NULL
	  ,tutkimusmenot_tieteenaloittain = NULL
	  ,lkm_tutkimustyovuodet_alueittain = NULL
	  ,lkm_tutkimustyovuodet_tehtavittain = NULL
	  ,lkm_tutkimustyovuodet_tutkintotasoittain = NULL
  FROM VipunenTK.[dbo].[f_Ammattikorkeakoulujen_tutkimus_ja_kehitys_tutkimushenkilokunta_tutkintotasoittain]

UNION ALL
SELECT [tilastovuosi]
	  ,oppilaitos_id
	  ,rahoituslahde_id = -1
	  ,alueluokitus_id = -1
	  ,sukupuoli_id = -1
	  ,tehtava_id = -1
	  ,tieteenala_id = -1
	  ,tutkintotaso_id = -1
	  ,menokohde_id
      ,tutkimusrahoitus = NULL
	  ,lkm_tutkimushenkilokunta_alueittain = NULL
	  ,lkm_tutkimushenkilokunta_paatieteenaloittain_tehtavittain = NULL
	  ,lkm_tutkimushenkilokunta_tutkintotasoittain = NULL
	  ,tutkimusmenot
	  ,tutkimusmenot_arvio_seuraavatilastovuosi
	  ,tutkimusmenot_alueittain = NULL
	  ,tutkimusmenot_tieteenaloittain = NULL
	  ,lkm_tutkimustyovuodet_alueittain = NULL
	  ,lkm_tutkimustyovuodet_tehtavittain = NULL
	  ,lkm_tutkimustyovuodet_tutkintotasoittain = NULL
  FROM VipunenTK.[dbo].[f_Ammattikorkeakoulujen_tutkimus_ja_kehitys_tutkimusmenot]

UNION ALL
SELECT [tilastovuosi]
	  ,oppilaitos_id
	  ,rahoituslahde_id = -1
	  ,alueluokitus_id
	  ,sukupuoli_id = -1
	  ,tehtava_id = -1
	  ,tieteenala_id = -1
	  ,tutkintotaso_id = -1
	  ,menokohde_id = -1
      ,tutkimusrahoitus = NULL
	  ,lkm_tutkimushenkilokunta_alueittain = NULL
	  ,lkm_tutkimushenkilokunta_paatieteenaloittain_tehtavittain = NULL
	  ,lkm_tutkimushenkilokunta_tutkintotasoittain = NULL
	  ,tutkimusmenot = NULL
	  ,tutkimusmenot_arvio_seuraavatilastovuosi = NULL
	  ,tutkimusmenot_alueittain
	  ,tutkimusmenot_tieteenaloittain = NULL
	  ,lkm_tutkimustyovuodet_alueittain = NULL
	  ,lkm_tutkimustyovuodet_tehtavittain = NULL
	  ,lkm_tutkimustyovuodet_tutkintotasoittain = NULL
  FROM VipunenTK.[dbo].[f_Ammattikorkeakoulujen_tutkimus_ja_kehitys_tutkimusmenot_alueittain]

UNION ALL
SELECT [tilastovuosi]
	  ,oppilaitos_id
	  ,rahoituslahde_id = -1
	  ,alueluokitus_id = -1
	  ,sukupuoli_id = -1
	  ,tehtava_id = -1
	  ,tieteenala_id
	  ,tutkintotaso_id = -1
	  ,menokohde_id = -1
      ,tutkimusrahoitus = NULL
	  ,lkm_tutkimushenkilokunta_alueittain = NULL
	  ,lkm_tutkimushenkilokunta_paatieteenaloittain_tehtavittain = NULL
	  ,lkm_tutkimushenkilokunta_tutkintotasoittain = NULL
	  ,tutkimusmenot = NULL
	  ,tutkimusmenot_arvio_seuraavatilastovuosi = NULL
	  ,tutkimusmenot_alueittain = NULL
	  ,tutkimusmenot_tieteenaloittain
	  ,lkm_tutkimustyovuodet_alueittain = NULL
	  ,lkm_tutkimustyovuodet_tehtavittain = NULL
	  ,lkm_tutkimustyovuodet_tutkintotasoittain = NULL
  FROM VipunenTK.[dbo].[f_Ammattikorkeakoulujen_tutkimus_ja_kehitys_tutkimusmenot_tieteenaloittain]

UNION ALL
SELECT [tilastovuosi]
	  ,oppilaitos_id
	  ,rahoituslahde_id = -1
	  ,alueluokitus_id
	  ,sukupuoli_id = -1
	  ,tehtava_id = -1
	  ,tieteenala_id = -1
	  ,tutkintotaso_id = -1
	  ,menokohde_id = -1
      ,tutkimusrahoitus = NULL
	  ,lkm_tutkimushenkilokunta_alueittain = NULL
	  ,lkm_tutkimushenkilokunta_paatieteenaloittain_tehtavittain = NULL
	  ,lkm_tutkimushenkilokunta_tutkintotasoittain = NULL
	  ,tutkimusmenot = NULL
	  ,tutkimusmenot_arvio_seuraavatilastovuosi = NULL
	  ,tutkimusmenot_alueittain = NULL
	  ,tutkimusmenot_tieteenaloittain = NULL
	  ,lkm_tutkimustyovuodet_alueittain
	  ,lkm_tutkimustyovuodet_tehtavittain = NULL
	  ,lkm_tutkimustyovuodet_tutkintotasoittain = NULL
  FROM VipunenTK.[dbo].[f_Ammattikorkeakoulujen_tutkimus_ja_kehitys_tutkimustyovuodet_alueittain]

UNION ALL
SELECT [tilastovuosi]
	  ,oppilaitos_id
	  ,rahoituslahde_id = -1
	  ,alueluokitus_id = -1
	  ,sukupuoli_id = -1
	  ,tehtava_id
	  ,tieteenala_id = -1
	  ,tutkintotaso_id = -1
	  ,menokohde_id = -1
      ,tutkimusrahoitus = NULL
	  ,lkm_tutkimushenkilokunta_alueittain = NULL
	  ,lkm_tutkimushenkilokunta_paatieteenaloittain_tehtavittain = NULL
	  ,lkm_tutkimushenkilokunta_tutkintotasoittain = NULL
	  ,tutkimusmenot = NULL
	  ,tutkimusmenot_arvio_seuraavatilastovuosi = NULL
	  ,tutkimusmenot_alueittain = NULL
	  ,tutkimusmenot_tieteenaloittain = NULL
	  ,lkm_tutkimustyovuodet_alueittain = NULL
	  ,lkm_tutkimustyovuodet_tehtavittain
	  ,lkm_tutkimustyovuodet_tutkintotasoittain = NULL
  FROM VipunenTK.[dbo].[f_Ammattikorkeakoulujen_tutkimus_ja_kehitys_tutkimustyovuodet_tehtavittain]

UNION ALL
SELECT [tilastovuosi]
	  ,oppilaitos_id
	  ,rahoituslahde_id = -1
	  ,alueluokitus_id = -1
	  ,sukupuoli_id = -1
	  ,tehtava_id = -1
	  ,tieteenala_id = -1
	  ,tutkintotaso_id
	  ,menokohde_id = -1
      ,tutkimusrahoitus = NULL
	  ,lkm_tutkimushenkilokunta_alueittain = NULL
	  ,lkm_tutkimushenkilokunta_paatieteenaloittain_tehtavittain = NULL
	  ,lkm_tutkimushenkilokunta_tutkintotasoittain = NULL
	  ,tutkimusmenot = NULL
	  ,tutkimusmenot_arvio_seuraavatilastovuosi = NULL
	  ,tutkimusmenot_alueittain = NULL
	  ,tutkimusmenot_tieteenaloittain = NULL
	  ,lkm_tutkimustyovuodet_alueittain = NULL
	  ,lkm_tutkimustyovuodet_tehtavittain = NULL
	  ,lkm_tutkimustyovuodet_tutkintotasoittain
  FROM VipunenTK.[dbo].[f_Ammattikorkeakoulujen_tutkimus_ja_kehitys_tutkimustyovuodet_tutkintotasoittain]

  ) f
  INNER JOIN VipunenTK.[dbo].d_oppilaitoksen_taustatiedot
	ON d_oppilaitoksen_taustatiedot.id = f.oppilaitos_id
  INNER JOIN VipunenTK.[dbo].d_tutkimuksen_rahoituslahde
	ON d_tutkimuksen_rahoituslahde.id = f.rahoituslahde_id
  INNER JOIN VipunenTK.[dbo].d_alueluokitus_historia
    ON d_alueluokitus_historia.id = f.alueluokitus_id
  INNER JOIN VipunenTK.[dbo].d_sukupuoli
	ON d_sukupuoli.id = f.sukupuoli_id
  INNER JOIN VipunenTK.[dbo].d_tutkimus_tehtava
    ON d_tutkimus_tehtava.id = f.tehtava_id
  INNER JOIN VipunenTK.[dbo].d_tieteenala
	ON d_tieteenala.id = f.tieteenala_id
  INNER JOIN VipunenTK.[dbo].d_tutkintotaso
	ON d_tutkintotaso.id = f.tutkintotaso_id
  INNER JOIN VipunenTK.[dbo].d_tutkimusmenojen_kohde
	ON d_tutkimusmenojen_kohde.id = f.menokohde_id
WHERE oppilaitoskoodi <> 02557 AND oppilaitoskoodi <> 10031 AND ((Tilastovuosi in (2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020) AND d_tutkimuksen_rahoituslahde.rahoituslahde <> ''EU yhteensä'') OR Tilastovuosi = ''2011'')





' 
GO
/****** Object:  View [dbo].[v_f_tab_amm_koul_erityisopetuksen_opisk_ja_tutk_suorit]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_amm_koul_erityisopetuksen_opisk_ja_tutk_suorit]'))
EXEC dbo.sp_executesql @statement = N'




CREATE VIEW [dbo].[v_f_tab_amm_koul_erityisopetuksen_opisk_ja_tutk_suorit] AS
SELECT [tilv] AS Tilastovuosi
      ,d4.lahde AS [Lähde]
      ,d13.koulutuksen_jarjestamismuoto AS [Järjestämismuoto]
      ,d12.perusjoukko AS [Perusjoukko]
      ,d1.koulutus AS [Koulutusnimike]
	  ,d1.opintoala2002 AS [Opintoala]
	  ,d1.koulutusala2002 AS [Koulutusala]
	  ,d1.koulutusaste2002 AS [Koulutusaste]
      ,d6.ammatillisen_koulutuksen_koulutuslaji AS [Tutkintotyyppi]
      ,d7.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus AS [Järjestämistapa]
      ,d3.kieli AS [Koulutuksen kieli]
      ,COALESCE((SELECT TOP 1 [maakunta] FROM [VipunenTK].[dbo].[d_alueluokitus] WHERE [alueluokitus_avain] = ''MAAK'' + [kmaak]), (SELECT TOP 1 [maakunta] FROM [VipunenTK].[dbo].[d_alueluokitus] WHERE [alueluokitus_avain] = -1)) AS [Koulutuksen maakunta]
      ,(SELECT TOP 1 [suuralue] FROM [VipunenTK].[dbo].[d_alueluokitus] WHERE [suuralue_koodi] = [knuts2u]) AS [Koulutuksen suuralue]
      ,(SELECT TOP 1 [kuntaryhma] FROM [VipunenTK].[dbo].[d_alueluokitus] WHERE [kuntaryhma_koodi] = [kkunryh]) AS [Koulutuksen sijaintikunnan kuntaryhmä]
      ,(SELECT TOP 1 [ely] FROM [VipunenTK].[dbo].[d_alueluokitus] WHERE [ely_koodi] = [kely]) AS [Koulutuksen ELY]
      ,(SELECT TOP 1 [avi] FROM [VipunenTK].[dbo].[d_alueluokitus] WHERE [avi_koodi] = [kavi]) AS [Koulutuksen AVI]
      ,d8.sukupuoli AS [Sukupuoli]
      ,d2.aidinkieli_versio1 AS [Äidinkieli]
      ,d9.kansalaisuus_versio2 AS [Kansalaisuus]
      ,[alvv] AS [Aloituslukuvuosi]
      ,[allk] AS [Aloituslukukausi]
      ,d14.[opiskelijan_olo] AS [Kirjoillaolo syksy]
      ,d15.[opiskelijan_olo] AS [Kirjoillaolo talvi]
      ,d10.aikuisopiskelija AS [Aikuisopiskelija]
      ,d5.erityisopetuksen_peruste AS [Erityisopetuksen peruste]
      ,d11.erityisoppilaan_opetusryhma AS [Opetusryhmä]
      ,[erityisopetus]
      ,[ammos]
      ,[opintokok]
      ,[lkm]
      ,[opiskelijat]
      ,[opiskelijat_lasna]

	  --Ruotsi
	  ,[tilv] AS Statistikår
      ,d13.koulutuksen_jarjestamismuoto_SV AS [Formen i vilken utbildningen ordnas]
      ,d1.koulutus_SV AS [Utbildningsbenämning]
	  ,d1.opintoala2002_SV AS [Studieområde]
	  ,d1.koulutusala2002_SV AS [Utbildningsområde]
	  ,d1.koulutusaste2002_SV AS [Utbildningsnivå]
      ,d6.ammatillisen_koulutuksen_koulutuslaji_SV AS [Typ av examen]
      ,d7.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_SV AS [Sättet på vilket utbildningen ordnas]
      ,d3.kieli_SV AS [Utbildningens språk]
      ,COALESCE((SELECT TOP 1 maakunta_SV FROM [VipunenTK].[dbo].[d_alueluokitus] WHERE [alueluokitus_avain] = ''MAAK'' + [kmaak]), (SELECT TOP 1 maakunta_SV FROM [VipunenTK].[dbo].[d_alueluokitus] WHERE [alueluokitus_avain] = -1)) AS [Utbildningens landskap]
      ,(SELECT TOP 1 suuralue_SV FROM [VipunenTK].[dbo].[d_alueluokitus] WHERE [suuralue_koodi] = [knuts2u]) AS [Utbildningens storområde]
      ,(SELECT TOP 1 kuntaryhma_SV FROM [VipunenTK].[dbo].[d_alueluokitus] WHERE [kuntaryhma_koodi] = [kkunryh]) AS [Utbildningens kommungruppen]
      ,(SELECT TOP 1 ely_SV FROM [VipunenTK].[dbo].[d_alueluokitus] WHERE [ely_koodi] = [kely]) AS [Utbildningens NTM-område]
      ,(SELECT TOP 1 avi_SV FROM [VipunenTK].[dbo].[d_alueluokitus] WHERE [avi_koodi] = [kavi]) AS [Utbildningens RFV-område]
      ,d8.sukupuoli_SV AS [Kön]
      ,d2.aidinkieli_versio1_SV AS [Modersmål]
      ,d9.kansalaisuus_versio2_SV AS [Medborgarskap]
      ,[alvv] AS [Begynnelseläsår]
      ,[allk] AS [Begynnelsetermin]
      ,d10.aikuisopiskelija_SV AS [Ungdoms-/vuxenstuderande]
--käännökset puuttuu
      ,d5.erityisopetuksen_peruste_SV AS [Grund för specialundervisning]
      ,d11.erityisoppilaan_opetusryhma_SV AS [Undervisningsgruppen]

	  --Englanti
	  ,[tilv] AS [Statistical year]
      ,d13.koulutuksen_jarjestamismuoto_EN AS [Form of vocational education and training]
      ,d1.koulutus_EN AS [Name of education]
	  ,d1.opintoala2002_EN AS [Subfield of education]
	  ,d1.koulutusala2002_EN AS [Field of education]
	  ,d1.koulutusaste2002_EN AS [Level of education]
      ,d6.ammatillisen_koulutuksen_koulutuslaji_EN AS [Qualification type]
      ,d7.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_EN AS [Method of vocational education and training]
      ,d3.kieli_EN AS [Language of education]
      ,COALESCE((SELECT TOP 1 maakunta_EN FROM [VipunenTK].[dbo].[d_alueluokitus] WHERE [alueluokitus_avain] = ''MAAK'' + [kmaak]), (SELECT TOP 1 maakunta_EN FROM [VipunenTK].[dbo].[d_alueluokitus] WHERE [alueluokitus_avain] = -1)) AS [Region of education]
      ,(SELECT TOP 1 suuralue_EN FROM [VipunenTK].[dbo].[d_alueluokitus] WHERE [suuralue_koodi] = [knuts2u]) AS [Major region of education]
      ,(SELECT TOP 1 kuntaryhma_EN FROM [VipunenTK].[dbo].[d_alueluokitus] WHERE [kuntaryhma_koodi] = [kkunryh]) AS [Municipality types in education]
      ,(SELECT TOP 1 ely_EN FROM [VipunenTK].[dbo].[d_alueluokitus] WHERE [ely_koodi] = [kely]) AS [ELY area of education]
      ,(SELECT TOP 1 avi_EN FROM [VipunenTK].[dbo].[d_alueluokitus] WHERE [avi_koodi] = [kavi]) AS [AVI area of education]
      ,d8.sukupuoli_EN AS [Gender]
      ,d2.aidinkieli_versio1_EN AS [Mother tongue]
      ,d9.kansalaisuus_versio2_EN AS [Nationality]
      ,[alvv] AS [First academic year]
      ,[allk] AS [First academic term]
      ,d10.aikuisopiskelija_EN AS [Young person/adult student]
      ,d5.erityisopetuksen_peruste_EN AS [Grounds for special education]
      ,d11.erityisoppilaan_opetusryhma_EN AS [Teaching group]

	  --isced
	  ,d1.iscle2011 as "Koulutusaste, taso 1"
	  ,d1.Koulutusaste_taso2 as "Koulutusaste, taso 2"
	  ,d1.iscfibroad2013 as "Koulutusala, taso 1"
	  ,d1.iscfinarrow2013 as "Koulutusala, taso 2"
	  ,d1.iscfi2013 as "Koulutusala, taso 3"
	  ,d1.OKM_ohjauksen_ala as "OKM ohjauksen ala, korkeak."
	  ,d1.iscle2011_SV as "Utbildn.nivå, nivå 1"
	  ,d1.Koulutusaste_taso2_SV as "Utbildn.nivå, nivå 2"
	  ,d1.iscfibroad2013_SV as "Utbildn.område, nivå 1"
	  ,d1.iscfinarrow2013_SV as "Utbildn.område, nivå 2"
	  ,d1.iscfi2013_SV as "Utbildn.område, nivå 3"
	  ,d1.OKM_ohjauksen_ala_SV as "UKM-styrningsområde, högskolor"
	  ,d1.iscle2011_EN as "Level of education, tier 1"
	  ,d1.Koulutusaste_taso2_EN as "Level of education, tier 2"
	  ,d1.iscfibroad2013_EN as "Field of education, tier 1"
	  ,d1.iscfinarrow2013_EN as "Field of education, tier 2"
	  ,d1.iscfi2013_EN as "Field of education, tier 3"
	  ,d1.OKM_ohjauksen_ala_EN as "Field of ed., HE steering"

	  --koodimuuttujat
	  ,d1.koulutusala2002_koodi as "Koodit Koulutusala 2002"
	  ,d1.opintoala2002_koodi as "Koodit Opintoala 2002"
	  ,d1.koulutus_koodi as "Koodit Koulutusnimike"
	  ,d1.koulutusaste2002_koodi as "Koodit Koulutusaste 2002"
	  ,COALESCE((SELECT TOP 1 maakunta_koodi FROM [VipunenTK].[dbo].[d_alueluokitus] WHERE [alueluokitus_avain] = ''MAAK'' + [kmaak]), (SELECT TOP 1 maakunta_koodi FROM [VipunenTK].[dbo].[d_alueluokitus] WHERE [alueluokitus_avain] = -1)) as "Koodit Koulutuksen maakunta"
	  ,d1.iscle2011_koodi as "Koodit Koulutusaste, taso 1"
	  ,d1.Koulutusaste_taso2_koodi as "Koodit Koulutusaste, taso 2"
	  ,d1.iscfibroad2013_koodi as "Koodit Koulutusala, taso 1"
	  ,d1.iscfinarrow2013_koodi as "Koodit Koulutusala, taso 2"
	  ,d1.iscfi2013_koodi as "Koodit Koulutusala, taso 3"
	  ,d1.OKM_ohjauksen_ala_koodi as "Koodit OKM ohjauksen ala, korkeak."

	  --järjestys
	  ,d4.jarjestys AS jarjestys_lahde
	  ,d13.jarjestys AS jarjestys_koulutuksen_jarjestamismuoto
	  ,d12.jarjestys AS jarjestys_perusjoukko
	  ,d1.jarjestys AS jarjestys_koulutus
	  ,d1.jarjestys_opintoala2002
	  ,d1.jarjestys_koulutusala2002
	  ,d1.jarjestys_koulutusaste2002
	  ,d1.jarjestys_iscde
	  ,d6.jarjestys AS jarjestys_ammatillisen_koulutuksen_koulutuslaji
	  ,d7.jarjestys AS jarjestys_opetussuunnitelmaperusteinen
	  ,d3.jarjestys AS jarjestys_kieli
      ,COALESCE((SELECT TOP 1 jarjestys_maakunta FROM [VipunenTK].[dbo].[d_alueluokitus] WHERE [maakunta_koodi] = [kmaak]), (SELECT TOP 1 [maakunta] FROM [VipunenTK].[dbo].[d_alueluokitus] WHERE [alueluokitus_avain] = -1)) AS jarjestys_maakunta
      ,(SELECT TOP 1 jarjestys_suuralue FROM [VipunenTK].[dbo].[d_alueluokitus] WHERE [suuralue_koodi] = [knuts2u]) AS jarjestys_suuralue
      ,(SELECT TOP 1 jarjestys_kuntaryhma FROM [VipunenTK].[dbo].[d_alueluokitus] WHERE [kuntaryhma_koodi] = [kkunryh]) AS jarjestys_kuntaryhma
      ,(SELECT TOP 1 jarjestys_ely FROM [VipunenTK].[dbo].[d_alueluokitus] WHERE [ely_koodi] = [kely]) AS jarjestys_ely
      ,(SELECT TOP 1 jarjestys_avi FROM [VipunenTK].[dbo].[d_alueluokitus] WHERE [avi_koodi] = [kavi]) AS jarjestys_avi
	  ,d8.jarjestys AS jarjestys_sukupuoli
	  ,d2.jarjestys AS jarjestys_aidinkieli
	  ,d9.jarjestys AS jarjestys_kansalaisuus
	  ,d14.jarjestys AS jarjestys_olosyys
	  ,d15.jarjestys AS jarjestys_olotamm
	  ,d10.jarjestys AS jarjestys_aikuisopiskelija
	  ,d5.jarjestys AS jarjestys_erityisopetuksen_peruste
	  ,d11.jarjestys AS jarjestys_erityisoppilaan_opetusryhma
	  ,d1.jarjestys_iscle2011 as jarj_isced_koulast1
	  ,d1.jarjestys_Koulutusaste_taso2 as jarj_isced_koulast2
	  ,d1.jarjestys_iscfibroad2013 as jarj_isced_koulala1
	  ,d1.jarjestys_iscfinarrow2013 as jarj_isced_koulala2
	  ,d1.jarjestys_iscfi2013 as jarj_isced_koulala3
	  ,d1.jarjestys_OKM_ohjauksen_ala as jarj_isced_okmohjaus1
  FROM [VipunenTK].[dbo].[f_ammatillisen_koulutuksen_erityisopetuksen_opiskelijat_ja_tutkinnon_suorittaneet] f
  INNER JOIN [VipunenTK].[dbo].[d_koulutusluokitus] d1 ON d1.id = f.koulutusluokitus_id
  INNER JOIN [VipunenTK].[dbo].[d_aidinkieli_versio1] d2 ON d2.id = f.aidinkielir1_id
  INNER JOIN [VipunenTK].[dbo].[d_kieli] d3 ON d3.id = f.kieli_id
  INNER JOIN [VipunenTK].[dbo].[d_lahde] d4 ON d4.id = f.lahde_id
  INNER JOIN [VipunenTK].[dbo].[d_erityisopetuksen_peruste] d5 ON d5.id = f.erityisopetuksen_peruste_id
  INNER JOIN [VipunenTK].[dbo].[d_ammatillisen_koulutuksen_koulutuslaji] d6 ON d6.id = f.ammatillisen_koulutuksen_koulutuslaji_id
  INNER JOIN [VipunenTK].[dbo].[d_opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus] d7 ON d7.id = f.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_id
  INNER JOIN [VipunenTK].[dbo].[d_sukupuoli] d8 ON d8.id = f.sukupuoli_id
  INNER JOIN [VipunenTK].[dbo].[d_kansalaisuus_versio2] d9 ON d9.id = f.kansalaisuus_versio2_id
  INNER JOIN [VipunenTK].[dbo].[d_aikuisopiskelija] d10 ON d10.id = f.aikuisopiskelija_id
  INNER JOIN [VipunenTK].[dbo].[d_erityisoppilaan_opetusryhma] d11 ON d11.id = f.erityisoppilaan_opetusryhma_id
  INNER JOIN [VipunenTK].[dbo].[d_perusjoukko] d12 ON d12.id = f.perusjoukko_id
  INNER JOIN [VipunenTK].[dbo].[d_koulutuksen_jarjestamismuoto] d13 ON d13.id = f.koulutuksen_jarjestamismuoto_id
  INNER JOIN [VipunenTK].[dbo].[d_opiskelijan_olo] d14 ON d14.id = f.olosyys_id
  INNER JOIN [VipunenTK].[dbo].[d_opiskelijan_olo] d15 ON d15.id = f.olotamm_id





' 
GO
/****** Object:  View [dbo].[v_f_tab_amm_koul_erityisopetuksen_opisk_ja_tutk_suorit_jarj]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_amm_koul_erityisopetuksen_opisk_ja_tutk_suorit_jarj]'))
EXEC dbo.sp_executesql @statement = N'










CREATE VIEW [dbo].[v_f_tab_amm_koul_erityisopetuksen_opisk_ja_tutk_suorit_jarj] AS
SELECT [tilv] AS Tilastovuosi
      ,d1.lahde AS [Lähde]
	  ,d2.perusjoukko AS [Perusjoukko]
      ,d3.oppilaitos AS Oppilaitos
	  ,d3.oppilaitostyyppi AS Oppilaitostyyppi
	  ,d3.oppilaitoksen_omistajatyyppi AS [Oppilaitoksen omistajatyyppi]
	  ,d3.opetuskieli AS Opetuskieli
	  ,d3.oppilaitoksen_sijaintikunta AS [Oppilaitoksen sijaintikunta]
      ,d4.kunta AS [Oppilaitoksen kunta]
	  ,d4.maakunta AS [Oppilaitoksen maakunta]
	  ,d4.suuralue AS [Oppilaitoksen suuralue]
      ,d4.kuntaryhma AS [Oppilaitoksen kuntaryhmitys]
	  ,d4.ely AS [Oppilaitoksen ELY]
	  ,d4.avi AS [Oppilaitoksen AVI]
	  ,d5.koulutuksen_jarjestaja AS [Koulutuksen järjestäjä]
	  ,d5.koulutuksen_jarjestajan_omistajatyyppi AS [Koulutuksen järjestäjän omistajatyyppi]
	  ,d5.koulutuksen_jarjestajan_kieli AS [Koulutuksen järjestäjän kieli]
	  ,d6.maakunta as [Koulutuksen järjestäjän maakunta]
	  ,d6.kunta as [Koulutuksen järjestäjän kunta]
   --   ,d7.koulutuksen_jarjestaja AS [Oppisopimusoppilaitos]
	  --,d7.koulutuksen_jarjestajan_omistajatyyppi AS [Oppisopimusoppilaitoksen omistajatyyppi]
	  --,d7.koulutuksen_jarjestajan_kieli AS [Oppisopimus opetuskieli]
	  --,d7.koulutuksen_jarjestajan_sijaintikunta AS [Oppisopimuksen kunta]
      ,d8.kunta AS [Oppisopimus kunta]
	  ,d8.maakunta AS [Oppisopimus maakunta]
	  ,d8.suuralue AS [Oppisopimus suuralue]
      ,d8.kuntaryhma AS [Oppisopimus kuntaryhmä]
	  ,d8.ely AS [Oppisopimus ELY]
	  ,d8.avi AS [Oppisopimus AVI]
      ,d9.koulutus AS [Koulutusnimike]
	  ,d9.koulutus_koodi
	  ,d9.opintoala2002 AS [Opintoala]
	  ,d9.opintoala2002_koodi
	  ,d9.koulutusala2002 AS [Koulutusala]
	  ,d9.koulutusaste2002 AS [Koulutusaste]
	  ,d9.iscde AS [Isced]
      ,d10.ammatillisen_koulutuksen_koulutuslaji AS [Ammatillisen koulutuksen koulutuslaji]
      ,d11.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus AS [Opetussuunnitelmaperusteinen koulutus/näyttötutkintoon valmistava koulutus]
      ,d12.kieli AS [Koulutuksen kieli]
      ,(SELECT [maakunta] FROM [VipunenTK].[dbo].[d_alueluokitus] WHERE [alueluokitus_avain] = ''MAAK'' + [kmaak] OR ([kmaak] = -1 AND [alueluokitus_avain] = [kmaak])) AS [Koulutuksen maakunta]
      ,[lkm]
	  ,[opiskelijat]
	  ,[opiskelijat_lasna]
   --   ,d13.oppilaitos AS [Opiskelijan oppilaitos]
	  --,d13.oppilaitostyyppi AS [Opiskelijan oppilaitostyyppi]
	  --,d13.oppilaitoksen_omistajatyyppi AS [Opiskelijan oppilaitoksen omistajatyyppi]
	  --,d13.opetuskieli AS [Opiskelijan opetuskieli]
	  --,d13.oppilaitoksen_sijaintikunta AS [Opiskelijan oppilaitoksen sijaintikunta]
   --   ,d14.kunta AS [Opiskelijan kunta]
	  --,d14.maakunta AS [Opiskelijan maakunta]
	  --,d14.suuralue AS [Opiskelijan suuralue]
   --   ,d14.kuntaryhma AS [Opiskelijan kuntaryhmä]
	  --,d14.ely AS [Opiskelijan ELY]
	  --,d14.avi AS [Opiskelijan AVI]
	  --,d13.koulutuksen_jarjestaja AS [Opiskelijan koulutuksen järjestäjä]
	  --,d13.koulutuksen_jarjestajan_omistajatyyppi AS [Opiskelijan koulutuksen järjestäjän omistajatyyppi]
	  --,d13.koulutuksen_jarjestajan_kieli AS [Opiskelijan koulutuksen järjestäjän kieli]
	  --,d13.koulutuksen_jarjestajan_sijaintikunta AS [Opiskelijan koulutuksen järjestäjän sijaintikunta]
      ,d17.opiskelijan_olo AS [Kirjoillaolo syksy]
	  ,d18.koulutuksen_jarjestamismuoto AS [Järjestämismuoto]

	  --Ruotsi
	  ,[tilv] AS [Statistikår]
      ,d3.oppilaitos_SV AS Läroanstalt
	  ,d3.oppilaitostyyppi_SV AS Läroanstaltstyp
	  ,d3.oppilaitoksen_omistajatyyppi_SV AS [Läroanstaltens ägartyp]
	  ,d3.opetuskieli_SV AS [Läroanstaltens undervisningsspråk]
      ,d4.kunta_SV AS [Läroanstaltens kommun]
	  ,d4.maakunta_SV AS [Läroanstaltens landskap]
	  ,d4.suuralue_SV AS [Läroanstaltens storområde]
      ,d4.kuntaryhma_SV AS [Läroanstaltens kommungruppering]
	  ,d4.ely_SV AS [Läroanstaltens NMT-område]
	  ,d4.avi_SV AS [Läroanstaltens RFV-område]
	  ,d5.koulutuksen_jarjestaja_SV AS [Utbildningsanordnare]
	  ,d5.koulutuksen_jarjestajan_omistajatyyppi_SV AS [Utbildningsanordnarens ägartyp]
	  ,d5.koulutuksen_jarjestajan_kieli_SV AS [Utbildningsanordnarens språk]
	  ,d6.maakunta_SV as [Utbildningsanordnarens landskap]
	  ,d6.kunta_SV as [Utbildningsanordnarens kommun]
      ,d8.kunta_SV AS [Läroavtalsutbildningens kommun]
	  ,d8.maakunta_SV AS [Läroavtalsutbildningens landskap]
	  ,d8.suuralue_SV AS [Läroavtalsutbildningens storområde]
      ,d8.kuntaryhma_SV AS [Läroavtalsutbildningens kommungruppering]
	  ,d8.ely_SV AS [Läroavtalsutbildningens NMT-område]
	  ,d8.avi_SV AS [Läroavtalsutbildningens RFV-område]
      ,d9.koulutus_SV AS [Utbildningsbenämning]
	  ,d9.opintoala2002_SV AS [Studieområde]
	  ,d9.koulutusala2002_SV AS [Utbildningsområde]
	  ,d9.koulutusaste2002_SV AS [Utbildningsnivå]
      ,d10.ammatillisen_koulutuksen_koulutuslaji_SV AS [Typ av examen]
      ,d11.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_SV AS [Sättet på vilket utbildningen ordnas]
      ,d12.kieli_SV AS [Utbildningens språk]
      ,(SELECT [maakunta_SV] FROM [VipunenTK].[dbo].[d_alueluokitus] WHERE [alueluokitus_avain] = ''MAAK'' + [kmaak] OR ([kmaak] = -1 AND [alueluokitus_avain] = [kmaak])) AS [Utbildningens landskap]
	  ,d18.koulutuksen_jarjestamismuoto_SV AS [Formen i vilken utbildningen ordnas]

	  --Englanti
	  ,[tilv] AS [Statistical year]
      ,d3.oppilaitos_EN AS [Educational institution]
	  ,d3.oppilaitostyyppi_EN AS [Type of institution]
	  ,d3.oppilaitoksen_omistajatyyppi_EN AS [Type of institution owner]
	  ,d3.opetuskieli_EN AS [Language of the institution]
      ,d4.kunta_EN AS [Municipality of the institution]
	  ,d4.maakunta_EN AS [Region of the institution]
	  ,d4.suuralue_EN AS [Major region of the institution]
      ,d4.kuntaryhma_EN AS [Municipality type of the institution]
	  ,d4.ely_EN AS [ELY area of the institution]
	  ,d4.avi_EN AS [AVI area of the institution]
	  ,d5.koulutuksen_jarjestaja_EN AS [Education provider]
	  ,d5.koulutuksen_jarjestajan_omistajatyyppi_EN AS [Type of education provider owner]
	  ,d5.koulutuksen_jarjestajan_kieli_EN AS [Language of the education provider]
	  ,d6.maakunta_EN as [Region of education provider]
	  ,d6.kunta_EN as [Municipality of education provider]
	  ,d6.kunta_EN as [Municipality of the education provider]
      ,d8.kunta_EN AS [Municipality of apprenticeship training]
	  ,d8.maakunta_EN AS [Region of apprenticeship training]
	  ,d8.suuralue_EN AS [Major region of apprenticeship training]
      ,d8.kuntaryhma_EN AS [Municipality type of apprenticeship training]
	  ,d8.ely_EN AS [ELY area of apprenticeship training]
	  ,d8.avi_EN AS [AVI area of apprenticeship training]
      ,d9.koulutus_EN AS [Name of education]
	  ,d9.opintoala2002_EN AS [Subfield of education]
	  ,d9.koulutusala2002_EN AS [Field of education]
	  ,d9.koulutusaste2002_EN AS [Level of education]
      ,d10.ammatillisen_koulutuksen_koulutuslaji_EN AS [Qualification type]
      ,d11.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_EN AS [Method of vocational education and training]
      ,d12.kieli_EN AS [Language of education]
      ,(SELECT maakunta_EN FROM [VipunenTK].[dbo].[d_alueluokitus] WHERE [alueluokitus_avain] = ''MAAK'' + [kmaak] OR ([kmaak] = -1 AND [alueluokitus_avain] = [kmaak])) AS [Region of education]
	  ,d18.koulutuksen_jarjestamismuoto_EN AS [Form of vocational education and training]

	  --isced
	  ,d9.iscle2011 as "Koulutusaste, taso 1"
	  ,d9.Koulutusaste_taso2 as "Koulutusaste, taso 2"
	  ,d9.iscfibroad2013 as "Koulutusala, taso 1"
	  ,d9.iscfinarrow2013 as "Koulutusala, taso 2"
	  ,d9.iscfi2013 as "Koulutusala, taso 3"
	  ,d9.OKM_ohjauksen_ala as "OKM ohjauksen ala, korkeak."
	  ,d9.iscle2011_SV as "Utbildn.nivå, nivå 1"
	  ,d9.Koulutusaste_taso2_SV as "Utbildn.nivå, nivå 2"
	  ,d9.iscfibroad2013_SV as "Utbildn.område, nivå 1"
	  ,d9.iscfinarrow2013_SV as "Utbildn.område, nivå 2"
	  ,d9.iscfi2013_SV as "Utbildn.område, nivå 3"
	  ,d9.OKM_ohjauksen_ala_SV as "UKM-styrningsområde, högskolor"
	  ,d9.iscle2011_EN as "Level of education, tier 1"
	  ,d9.Koulutusaste_taso2_EN as "Level of education, tier 2"
	  ,d9.iscfibroad2013_EN as "Field of education, tier 1"
	  ,d9.iscfinarrow2013_EN as "Field of education, tier 2"
	  ,d9.iscfi2013_EN as "Field of education, tier 3"
	  ,d9.OKM_ohjauksen_ala_EN as "Field of ed., HE steering"

	  --koodimuuttujat
	  ,d9.koulutusala2002_koodi as "Koodit Koulutusala 2002"
	  ,d9.opintoala2002_koodi as "Koodit Opintoala 2002"
	  ,d9.koulutus_koodi as "Koodit Koulutusnimike"
	  ,d9.koulutusaste2002_koodi as "Koodit Koulutusaste 2002"
	  ,d4.kunta_koodi AS [Koodit Oppilaitoksen kunta]
	  ,d4.maakunta_koodi AS [Koodit Oppilaitoksen maakunta]
	  ,d6.maakunta_koodi as [Koodit Koulutuksen järjestäjän maakunta]
	  ,d6.kunta_koodi as [Koodit Koulutuksen järjestäjän kunta]
	  ,d9.iscle2011_koodi as "Koodit Koulutusaste, taso 1"
	  ,d9.Koulutusaste_taso2_koodi as "Koodit Koulutusaste, taso 2"
	  ,d9.iscfibroad2013_koodi as "Koodit Koulutusala, taso 1"
	  ,d9.iscfinarrow2013_koodi as "Koodit Koulutusala, taso 2"
	  ,d9.iscfi2013_koodi as "Koodit Koulutusala, taso 3"
	  ,d9.OKM_ohjauksen_ala_koodi as "Koodit OKM ohjauksen ala, korkeak."

	  --järjestys
	  ,d1.jarjestys AS jarjestys_lahde
	  ,d2.jarjestys AS jarjestys_perusjoukko
      ,d3.jarjestys_oppilaitos
	  ,d3.jarjestys_oppilaitostyyppi
	  ,d3.jarjestys_omistajatyyppi
	  ,d3.jarjestys_opetuskieli
	  ,d3.jarjestys_sijaintikunta
      ,d4.jarjestys AS jarjestys_kunta
	  ,d4.jarjestys_maakunta
	  ,d4.jarjestys_suuralue
      ,d4.jarjestys_kuntaryhma
	  ,d4.jarjestys_ely
	  ,d4.jarjestys_avi
	  ,d3.jarjestys_koulutuksen_jarjestaja
	  ,d3.jarjestys_koulutuksen_jarjestajan_kieli
	  ,d3.jarjestys_sijaintikunta_koulutuksenjarjestaja
	  ,d6.jarjestys_maakunta as [jarjestys_koulutuksen_jarjestajan_maakunta]
	  ,d6.jarjestys as [jarjestys_koulutuksen_jarjestajan_kunta]
      ,d7.jarjestys_koulutuksenjarjestaja AS jarjestys_oppisopimusoppilaitos
	  ,d7.jarjestys_koulutuksen_jarjestajan_kieli AS jarjestys_oppisopimus_koulutuksen_jarjestajan_kieli_oppisopimus
	  ,d7.jarjestys_sijaintikunta_koulutuksenjarjestaja AS jarjestys_oppisopimus_sijaintikunta
      ,d8.jarjestys AS jarjestys_oppisopimus_kunta
	  ,d8.jarjestys_maakunta AS jarjestys_oppisopimus_maakunta
	  ,d8.jarjestys_suuralue AS jarjestys_oppisopimus_suuralue
      ,d8.jarjestys_kuntaryhma AS jarjestys_oppisopimus_kuntaryhma
	  ,d8.jarjestys_ely AS jarjestys_oppisopimus_ely
	  ,d8.jarjestys_avi AS jarjestys_oppisopimus_avi
      ,d9.jarjestys AS jarjestys_tutkintonimike
	  ,d9.jarjestys_opintoala2002
	  ,d9.jarjestys_koulutusala2002
	  ,d9.jarjestys_koulutusaste2002
	  ,d9.jarjestys_iscde
      ,d10.jarjestys AS jarjestys_ammatillisen_koulutuksen_koulutuslaji
	  ,d11.jarjestys AS jarjestys_opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus
	  ,d12.jarjestys AS jarjestys_kieli
	  ,(SELECT jarjestys_maakunta FROM [VipunenTK].[dbo].[d_alueluokitus] WHERE [alueluokitus_avain] = ''MAAK'' + [kmaak] OR ([kmaak] = -1 AND [alueluokitus_avain] = [kmaak])) AS [jarjestys_koulutuksen_maakunta]
      ,d13.jarjestys_oppilaitos AS jarjestys_opiskelijan_oppilaitos
	  ,d13.jarjestys_oppilaitostyyppi AS jarjestys_opiskelijan_oppilaitostyyppi
	  ,d13.jarjestys_omistajatyyppi AS jarjestys_opiskelijan_oppilaitoksen_omistajatyyppi
	  ,d13.jarjestys_opetuskieli AS jarjestys_opiskelijan_oppilaitoksen_opetuskieli
	  ,d13.jarjestys_sijaintikunta AS jarjestys_opiskelijan_oppilaitoksen_sijaintikunta
      ,d14.jarjestys AS jarjestys_opiskelijan_kunta
	  ,d14.jarjestys_maakunta AS jarjestys_opiskelijan_maakunta
	  ,d14.jarjestys_suuralue AS jarjestys_opiskelijan_suuralue
      ,d14.jarjestys_kuntaryhma AS jarjestys_opiskelijan_kuntaryhmä
	  ,d14.jarjestys_ely AS jarjestys_opiskelijan_ely
	  ,d14.jarjestys_avi AS jarjestys_opiskelijan_avi
	  ,d13.jarjestys_koulutuksen_jarjestaja AS jarjestys_opiskelijan_koulutuksen_jarjestaja
	  ,d13.jarjestys_koulutuksen_jarjestajan_kieli AS jarjestys_opiskelijan_koulutuksen_jarjestajan_kieli
	  ,d13.jarjestys_sijaintikunta_koulutuksenjarjestaja AS jarjestys_opiskelijan_koulutuksen_jarjestajan_sijaintikunta
      ,d17.jarjestys AS jarjestys_opiskelijan_olo
	  ,d18.jarjestys AS jarjestys_koulutuksen_jarjestamismuoto
	  ,d9.jarjestys_iscle2011 as jarj_isced_koulast1
	  ,d9.jarjestys_Koulutusaste_taso2 as jarj_isced_koulast2
	  ,d9.jarjestys_iscfibroad2013 as jarj_isced_koulala1
	  ,d9.jarjestys_iscfinarrow2013 as jarj_isced_koulala2
	  ,d9.jarjestys_iscfi2013 as jarj_isced_koulala3
	  ,d9.jarjestys_OKM_ohjauksen_ala as jarj_isced_okmohjaus1
  FROM [VipunenTK].[dbo].[f_ammatillisen_koulutuksen_erityisopetuksen_opiskelijat_ja_tutkinnon_suorittaneet_jarjestajittain] f
  INNER JOIN [VipunenTK].[dbo].[d_lahde] d1 ON d1.id = f.lahde_id
  INNER JOIN [VipunenTK].[dbo].[d_perusjoukko] d2 ON d2.id = f.perusjoukko_id
  INNER JOIN [VipunenTK].[dbo].[d_oppilaitoksen_taustatiedot] d3 ON d3.id = f.oppilaitoksen_taustatiedot_id
  INNER JOIN [VipunenTK].[dbo].[d_alueluokitus] d4 ON d4.id = f.alueluokitus_id
  INNER JOIN [VipunenTK].[dbo].[d_oppilaitoksen_taustatiedot] d5 ON d5.id = f.koulutuksen_jarjestajan_oppilaitoksen_taustatiedot_id
  INNER JOIN [VipunenTK].[dbo].[d_alueluokitus] d6 ON d6.id = f.koulutuksen_jarjestajan_alueluokitus_id
  INNER JOIN [VipunenTK].[dbo].[d_oppilaitoksen_taustatiedot] d7 ON d7.id = f.oppisopimus_oppilaitoksen_taustatiedot_id
  INNER JOIN [VipunenTK].[dbo].[d_alueluokitus] d8 ON d8.id = f.oppisopimus_alueluokitus_id
  INNER JOIN [VipunenTK].[dbo].[d_koulutusluokitus] d9 ON d9.id = f.koulutusluokitus_id
  INNER JOIN [VipunenTK].[dbo].[d_ammatillisen_koulutuksen_koulutuslaji] d10 ON d10.id = f.ammatillisen_koulutuksen_koulutuslaji_id
  INNER JOIN [VipunenTK].[dbo].[d_opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus] d11 ON d11.id = f.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_id
  INNER JOIN [VipunenTK].[dbo].[d_kieli] d12 ON d12.id = f.kieli_id
  INNER JOIN [VipunenTK].[dbo].[d_oppilaitoksen_taustatiedot] d13 ON d13.id = f.opiskelijan_oppilaitoksen_taustatiedot_id
  INNER JOIN [VipunenTK].[dbo].[d_alueluokitus] d14 ON d14.id = f.opiskelijan_alueluokitus_id
  INNER JOIN [VipunenTK].[dbo].[d_oppilaitoksen_taustatiedot] d15 ON d15.id = f.opiskelijan_oppilaitoksen_oppilaitoksen_taustatiedot_id
  INNER JOIN [VipunenTK].[dbo].[d_alueluokitus] d16 ON d16.id = f.opiskelijan_oppilaitoksen_alueluokitus_id
  INNER JOIN [VipunenTK].[dbo].[d_opiskelijan_olo] d17 ON d17.id = f.opiskelijan_olo_id
  INNER JOIN [VipunenTK].[dbo].[d_koulutuksen_jarjestamismuoto] d18 ON d18.id = f.koulutuksen_jarjestamismuoto_id










' 
GO
/****** Object:  View [dbo].[v_f_tab_ammatillinen_scorecard]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_ammatillinen_scorecard]'))
EXEC dbo.sp_executesql @statement = N'














CREATE VIEW [dbo].[v_f_tab_ammatillinen_scorecard] AS

SELECT 
--Aikamuuttujat
			
		  -- Aloittaneiden läpäisyä tarkastellaan aloituslukuvuoden ja tarkastelujakson mukaan. Alla on tuotettu tämän perusteella tilastovuositieto
		  -- läpäisystä. Tällölin läpäisyä voi tarkastella ajallisesti yhteismitallisesti muiden aineistojen kanssa.
		  -- Esimerkki logiikasta: "Jos opiskelija on aloittanut keväällä 2007 [d_kausi.vuosiselite = ''2007'' And d_kausi.lukuvuosi = ''2006/2007''], 
		  -- ja aikaa on kulunut 3 vuotta [And d_tarkastelujakso.tarkastelujakso = ''3 vuotta''], tilastovuosi on 2009. Tarkasteltava aikajakso on siis
		  -- 1.1.2007 - 31.12.2009"

		  ''Tilastovuosi'' = Case When d_kausi.vuosiselite = ''2006'' And d_kausi.lukuvuosi = ''2005/2006'' And d_tarkastelujakso.tarkastelujakso = ''3,5 vuotta''
							Then ''2009''

							When d_kausi.vuosiselite = ''2006'' And d_kausi.lukuvuosi = ''2006/2007''
							Then ''2009''
							When d_kausi.vuosiselite = ''2007'' And d_kausi.lukuvuosi = ''2006/2007'' And d_tarkastelujakso.tarkastelujakso = ''3 vuotta''
							Then ''2009''
							When d_kausi.vuosiselite = ''2007'' And d_kausi.lukuvuosi = ''2006/2007'' And d_tarkastelujakso.tarkastelujakso = ''3,5 vuotta''
							Then ''2010''

							When d_kausi.vuosiselite = ''2007'' And d_kausi.lukuvuosi = ''2007/2008''
							Then ''2010''
							When d_kausi.vuosiselite = ''2008'' And d_kausi.lukuvuosi = ''2007/2008'' And d_tarkastelujakso.tarkastelujakso = ''3 vuotta''
							Then ''2010''
							When d_kausi.vuosiselite = ''2008'' And d_kausi.lukuvuosi = ''2007/2008'' And d_tarkastelujakso.tarkastelujakso = ''3,5 vuotta''
							Then ''2011''
							
							When d_kausi.vuosiselite = ''2008'' And d_kausi.lukuvuosi = ''2008/2009''
							Then ''2011''
							When d_kausi.vuosiselite = ''2009'' And d_kausi.lukuvuosi = ''2008/2009'' And d_tarkastelujakso.tarkastelujakso = ''3 vuotta''
							Then ''2011''
							When d_kausi.vuosiselite = ''2009'' And d_kausi.lukuvuosi = ''2008/2009'' And d_tarkastelujakso.tarkastelujakso = ''3,5 vuotta''
							Then ''2012''
							
							When d_kausi.vuosiselite = ''2009'' And d_kausi.lukuvuosi = ''2009/2010''
							Then ''2012''
							When d_kausi.vuosiselite = ''2010'' And d_kausi.lukuvuosi = ''2009/2010'' And d_tarkastelujakso.tarkastelujakso = ''3 vuotta''
							Then ''2012''
							When d_kausi.vuosiselite = ''2010'' And d_kausi.lukuvuosi = ''2009/2010'' And d_tarkastelujakso.tarkastelujakso = ''3,5 vuotta''
							Then ''2013''
							
							When d_kausi.vuosiselite = ''2010'' And d_kausi.lukuvuosi = ''2010/2011''
							Then ''2013''
							When d_kausi.vuosiselite = ''2011'' And d_kausi.lukuvuosi = ''2010/2011'' And d_tarkastelujakso.tarkastelujakso = ''3 vuotta''
							Then ''2013''
							When d_kausi.vuosiselite = ''2011'' And d_kausi.lukuvuosi = ''2010/2011'' And d_tarkastelujakso.tarkastelujakso = ''3,5 vuotta''
							Then ''2014''
							
							When d_kausi.vuosiselite = ''2011'' And d_kausi.lukuvuosi = ''2011/2012''
							Then ''2014''
							When d_kausi.vuosiselite = ''2012'' And d_kausi.lukuvuosi = ''2011/2012'' And d_tarkastelujakso.tarkastelujakso = ''3 vuotta''
							Then ''2014''
							When d_kausi.vuosiselite = ''2012'' And d_kausi.lukuvuosi = ''2011/2012'' And d_tarkastelujakso.tarkastelujakso = ''3,5 vuotta''
							Then ''2015''
							
							When d_kausi.vuosiselite = ''2012'' And d_kausi.lukuvuosi = ''2012/2013''
							Then ''2015''
							When d_kausi.vuosiselite = ''2013'' And d_kausi.lukuvuosi = ''2012/2013'' And d_tarkastelujakso.tarkastelujakso = ''3 vuotta''
							Then ''2015''
							When d_kausi.vuosiselite = ''2013'' And d_kausi.lukuvuosi = ''2012/2013'' And d_tarkastelujakso.tarkastelujakso = ''3,5 vuotta''
							Then ''2016''
							
							When d_kausi.vuosiselite = ''2013'' And d_kausi.lukuvuosi = ''2013/2014''
							Then ''2016''
							When d_kausi.vuosiselite = ''2014'' And d_kausi.lukuvuosi = ''2013/2014'' And d_tarkastelujakso.tarkastelujakso = ''3 vuotta''
							Then ''2016''
							When d_kausi.vuosiselite = ''2014'' And d_kausi.lukuvuosi = ''2013/2014'' And d_tarkastelujakso.tarkastelujakso = ''3,5 vuotta''
							Then ''2017''
							
							When d_kausi.vuosiselite = ''2014'' And d_kausi.lukuvuosi = ''2014/2015''
							Then ''2017''
							When d_kausi.vuosiselite = ''2015'' And d_kausi.lukuvuosi = ''2014/2015'' And d_tarkastelujakso.tarkastelujakso = ''3 vuotta''
							Then ''2017''
							When d_kausi.vuosiselite = ''2015'' And d_kausi.lukuvuosi = ''2014/2015'' And d_tarkastelujakso.tarkastelujakso = ''3,5 vuotta''
							Then ''2018''
							
							When d_kausi.vuosiselite = ''2015'' And d_kausi.lukuvuosi = ''2015/2016''
							Then ''2018''
							When d_kausi.vuosiselite = ''2016'' And d_kausi.lukuvuosi = ''2015/2016'' And d_tarkastelujakso.tarkastelujakso = ''3 vuotta''
							Then ''2018''
							When d_kausi.vuosiselite = ''2016'' And d_kausi.lukuvuosi = ''2015/2016'' And d_tarkastelujakso.tarkastelujakso = ''3,5 vuotta''
							Then ''2019''
							
							When d_kausi.vuosiselite = ''2016'' And d_kausi.lukuvuosi = ''2016/2017''
							Then ''2019''
							When d_kausi.vuosiselite = ''2017'' And d_kausi.lukuvuosi = ''2016/2017'' And d_tarkastelujakso.tarkastelujakso = ''3 vuotta''
							Then ''2019''
							When d_kausi.vuosiselite = ''2017'' And d_kausi.lukuvuosi = ''2016/2017'' And d_tarkastelujakso.tarkastelujakso = ''3,5 vuotta''
							Then ''2020''
							
							When d_kausi.vuosiselite = ''2017'' And d_kausi.lukuvuosi = ''2017/2018''
							Then ''2020''
							When d_kausi.vuosiselite = ''2018'' And d_kausi.lukuvuosi = ''2017/2018'' And d_tarkastelujakso.tarkastelujakso = ''3 vuotta''
							Then ''2020''
							When d_kausi.vuosiselite = ''2018'' And d_kausi.lukuvuosi = ''2017/2018'' And d_tarkastelujakso.tarkastelujakso = ''3,5 vuotta''
							Then ''2021''

							When d_tutkintolaji_tyollistymiseen.tutkintolaji_tyollistymiseen_koodi in (''04'',''05'',''06'',''07'') OR [aineistotunnus] = ''2.4a-c''
							Then tilastointivuosi

							When [aineistotunnus] = ''2.3a-d''
							Then tilv

							Else tilastointivuosi

							End

		  ,''Aloituslukuvuosi'' = ISNULL(d_kausi.lukuvuosi, Case When d_kausi.lukuvuosi = ''-1'' Then ''Tuntematon'' Else ''Virhetilanne'' End)
		  ,''Aloitusvuosi'' = ISNULL(d_kausi.vuosiselite, Case When d_kausi.vuosiselite = ''-1'' Then ''Tuntematon'' Else ''Virhetilanne'' End)
		  ,''Aloituslukukausi'' = ISNULL(d_kausi.lukukausiselite, Case When d_kausi.lukukausiselite = ''-1'' Then ''Tuntematon'' Else ''Virhetilanne'' End)
		  ,''Tarkastelujakso'' = ISNULL(d_tarkastelujakso.tarkastelujakso, Case When d_tarkastelujakso.tarkastelujakso = ''-1'' Then ''Tuntematon'' Else ''Virhetilanne'' End)
--Henkilömuuttujat
		  ,''Pääasiallinen toiminta'' = ISNULL(d_paaasiallinen_toiminta_ja_maasta_muuttaneet.paaasiallinen_toiminta_ja_maasta_muuttaneet, Case When d_paaasiallinen_toiminta_ja_maasta_muuttaneet.paaasiallinen_toiminta_ja_maasta_muuttaneet = -1 Then ''Tuntematon'' Else ''Virhetilanne'' End)
--Koulutusmuuttujat
		  ,''Hallinnonala'' = ISNULL(d_opetushallinnon_koulutus.opetushallinnon_koulutus, Case When d_opetushallinnon_koulutus.opetushallinnon_koulutus = -1 Then ''Tuntematon'' Else ''Virhetilanne'' End)
		  ,''Koko tutkinto/tutkinnon osa'' = ISNULL(d_koulutuksen_tavoite_toteuma.koulutuksen_tavoite_toteuma, Case When d_koulutuksen_tavoite_toteuma.koulutuksen_tavoite_toteuma = -1 Then ''Tuntematon'' Else ''Virhetilanne'' End)
		  ,''Opintojen kulku'' = ISNULL([1a Aloittaneiden opintojen kulku koulutuslajin mukaan prioriteettina mikä tahansa tutkinto], Case When [1a Aloittaneiden opintojen kulku koulutuslajin mukaan prioriteettina mikä tahansa tutkinto] = -1 Then ''Tuntematon'' Else ''Virhetilanne'' End)
		  ,''Suoritettu tutkinto'' = ISNULL([1c Aloittaneista tutkinnon suorittaneet koulutuslajin mukaan], Case When [1c Aloittaneista tutkinnon suorittaneet koulutuslajin mukaan] = -1 Then ''Tuntematon'' Else ''Virhetilanne'' End)
		  ,''Koulutusala (2002)'' = d_koulutusluokitus.koulutusala2002
		  ,''Koulutusala, taso 1'' = d_koulutusluokitus.iscfibroad2013

		  -- Tieto järjestämistavasta, järjestämismuodosta ja tutkintotyypistä on kaikissa aineistossa kerätty eri tavoin. Alla kootaan näistä yhteiset
		  -- muuttujat, jotka toimivat kaikkien aineistojen kanssa.

		  ,''Järjestämistapa'' = Case When d_tutkintolaji_tyollistymiseen.tutkintolaji_tyollistymiseen_koodi = ''04'' OR d_koulutuslaji2.jarjestys_jarjestamistapa = ''1'' OR d_opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_koodi = ''1''
								Then ''opetussuunnitelmaperusteinen koulutus/tutkinto''
								When d_tutkintolaji_tyollistymiseen.tutkintolaji_tyollistymiseen_koodi in (''05'',''06'',''07'') OR d_koulutuslaji2.jarjestys_jarjestamistapa = ''2'' OR d_opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_koodi = ''2''
								Then ''näyttötutkintoon valmistava koulutus/tutkinto''
								Else ''Tuntematon''
								End
		  ,''Järjestämismuoto'' = Case When d_oppisopimuskoulutus.oppisopimuskoulutus_koodi = ''2'' OR d_koulutuslaji2.jarjestys_jarjestamismuoto = ''1'' OR d_koulutuksen_jarjestamismuoto.koulutuksen_jarjestamismuoto_koodi = ''1''
								Then ''Oppilaitosmuotoinen koulutus''
								When d_oppisopimuskoulutus.oppisopimuskoulutus_koodi = ''1'' OR d_koulutuslaji2.jarjestys_jarjestamismuoto = ''2'' OR d_koulutuksen_jarjestamismuoto.koulutuksen_jarjestamismuoto_koodi = ''2''
								Then ''Oppisopimuskoulutus''
								Else ''Tuntematon''
								End
		  ,''Tutkintotyyppi'' = Case When d_tutkintolaji_tyollistymiseen.tutkintolaji_tyollistymiseen_koodi in (''04'',''05'') OR d_koulutuslaji2.jarjestys_tutkintotyyppi = ''1'' OR d_ammatillisen_koulutuksen_koulutuslaji.ammatillisen_koulutuksen_koulutuslaji_koodi = ''1''
								Then ''ammatillinen perustutkinto''
								When d_tutkintolaji_tyollistymiseen.tutkintolaji_tyollistymiseen_koodi = ''06'' OR d_koulutuslaji2.jarjestys_tutkintotyyppi = ''2'' OR d_ammatillisen_koulutuksen_koulutuslaji.ammatillisen_koulutuksen_koulutuslaji_koodi = ''2''
								Then ''ammattitutkinto''
								When d_tutkintolaji_tyollistymiseen.tutkintolaji_tyollistymiseen_koodi = ''07'' OR d_koulutuslaji2.jarjestys_tutkintotyyppi = ''3'' OR d_ammatillisen_koulutuksen_koulutuslaji.ammatillisen_koulutuksen_koulutuslaji_koodi = ''3''
								Then ''erikoisammattitutkinto''
								Else ''Tuntematon''
								End

		  ,''Koulutuksen maakunta'' = d_alueluokitus.maakunta
--Organisaatiomuuttujat
          ,''Koulutuksen järjestäjä'' = d_oppilaitoksen_taustatiedot.koulutuksen_jarjestaja
--Järjestykset
		  ,''jarj_tarkastelujakso'' = ISNULL(d_tarkastelujakso.jarjestys, Case When d_tarkastelujakso.jarjestys = -1 Then ''98'' Else ''99'' End)
		  ,''jarj_paas'' = ISNULL(d_paaasiallinen_toiminta_ja_maasta_muuttaneet.jarjestys, Case When d_paaasiallinen_toiminta_ja_maasta_muuttaneet.jarjestys = -1 Then ''99'' Else ''98'' End)
		  ,''paaskoodi'' = ISNULL(d_paaasiallinen_toiminta_ja_maasta_muuttaneet.paaasiallinen_toiminta_ja_maasta_muuttaneet_koodi, Case When d_paaasiallinen_toiminta_ja_maasta_muuttaneet.paaasiallinen_toiminta_ja_maasta_muuttaneet_koodi = -1 Then ''-1'' Else ''-2'' End)
		  ,''jarj_hallinnonala'' = ISNULL(d_opetushallinnon_koulutus.jarjestys, Case When d_opetushallinnon_koulutus.jarjestys = -1 Then ''1980'' Else ''1990'' End)
		  ,''jarj_kokoosa'' = ISNULL(d_koulutuksen_tavoite_toteuma.jarjestys, Case When d_koulutuksen_tavoite_toteuma.jarjestys = -1 Then ''98'' Else ''99'' End)
		  ,''jarj_1a'' = ISNULL([1a_jarjestys], Case When [1a_jarjestys] = -1 Then ''99998'' Else ''99999'' End)
		  ,''jarj_1c'' = ISNULL([1c_jarjestys], Case When [1c_jarjestys] = -1 Then ''99998'' Else ''99999'' End)
		  ,''jarj_koulala2002'' = d_koulutusluokitus.koulutusala2002_koodi
		  ,''jarj_koulalataso1'' = d_koulutusluokitus.jarjestys_iscfibroad2013
		  ,''jarj_jarjestamistapa'' = Case When d_tutkintolaji_tyollistymiseen.tutkintolaji_tyollistymiseen_koodi = ''04'' OR d_koulutuslaji2.jarjestys_jarjestamistapa = ''1'' OR d_opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_koodi = ''1''
								Then ''1''
								When d_tutkintolaji_tyollistymiseen.tutkintolaji_tyollistymiseen_koodi in (''05'',''06'',''07'') OR d_koulutuslaji2.jarjestys_jarjestamistapa = ''2'' OR d_opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_koodi = ''2''
								Then ''2''
								Else ''3''
								End
		  ,''jarj_maakunta'' = d_alueluokitus.jarjestys_maakunta
		  ,''kouljarjkoodi'' = d_oppilaitoksen_taustatiedot.koulutuksen_jarjestajakoodi
--Lukumäärämuuttujat
		 ,''lkm_1vr2'' = [sijoittuminen_1v_tutkinnon_jalkeen]
		 ,''lkm_int2'' = [lkm_int]
		 ,''aloit2'' = [aloittaneet]
		 ,''opisk2'' = [opiskelijat]
		 ,''tutk2'' = [tutkinnot]


FROM (
SELECT [tilastointivuosi]
	  ,[tilv] = ''Tuntematon''
	  ,[1a Aloittaneiden opintojen kulku koulutuslajin mukaan prioriteettina mikä tahansa tutkinto] = ''Tuntematon''
	  ,[1a_jarjestys] =''99998''
	  ,[1c Aloittaneista tutkinnon suorittaneet koulutuslajin mukaan] = ''Tuntematon''
	  ,[1c_jarjestys] =''99998''
	  ,[aineistotunnus] = ''Tuntematon''
	  ,oppilaitoksen_taustatiedot_id =''-1''
	  ,koulutuksen_jarjestaja_id
	  ,yht_koulutuksen_jarjestaja_id =''-1''
	  ,lahde_id = ''-1''
	  ,aloituskausikoodi = ''-1''
	  ,tarkastelujakso_id = ''-1''
	  ,paaasiallinen_toiminta_ja_maasta_muuttaneet_id
	  ,ophal_id = ''-1''
	  ,opetushallinnon_koulutus_id = ''-1''
	  ,koulutuksen_tavoite_toteuma_id = ''-1''
	  ,koulutusluokitus_id
	  ,koulk_id = ''-1''
	  ,opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_id = ''-1''
	  ,koulutuksen_jarjestamismuoto_id = ''-1''
	  ,ammatillisen_koulutuksen_koulutuslaji_id = ''-1''
	  ,tutkintolaji_tyollistymiseen_id
	  ,oppisopimuskoulutus_id
	  ,koulutuslaji2_id = ''-1''
	  ,tutkinnon_suorittamismaakunta_id
	  ,alueluokitus_id = ''-1''
	  ,yht_koulutuksen_kunta_id = ''-1''
	  ,sijoittuminen_1v_tutkinnon_jalkeen
	  ,lkm_int = NULL
	  ,aloittaneet = NULL
	  ,opiskelijat = NULL
	  ,tutkinnot = NULL
  FROM VipunenTK.[dbo].[f_TJ_4_3_Tutkinnon_suorittaneiden_paaasiallinen_toiminta]

UNION ALL
SELECT [tilastointivuosi] = ''Tuntematon''
	  ,[tilv] = ''Tuntematon''
	  ,[1a Aloittaneiden opintojen kulku koulutuslajin mukaan prioriteettina mikä tahansa tutkinto]
	  ,[1a_jarjestys]
	  ,[1c Aloittaneista tutkinnon suorittaneet koulutuslajin mukaan]
	  ,[1c_jarjestys]
	  ,[aineistotunnus] = ''Tuntematon''
	  ,oppilaitoksen_taustatiedot_id
	  ,koulutuksen_jarjestaja_id =''-1''
	  ,yht_koulutuksen_jarjestaja_id = ''-1''
	  ,lahde_id
	  ,aloituskausikoodi
	  ,tarkastelujakso_id
	  ,paaasiallinen_toiminta_ja_maasta_muuttaneet_id = ''-1''
	  ,ophal_id
	  ,opetushallinnon_koulutus_id = ''-1''
	  ,koulutuksen_tavoite_toteuma_id = ''-1''
	  ,koulutusluokitus_id = ''-1''
	  ,koulk_id
	  ,opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_id = ''-1''
	  ,koulutuksen_jarjestamismuoto_id = ''-1''
	  ,ammatillisen_koulutuksen_koulutuslaji_id = ''-1''
	  ,tutkintolaji_tyollistymiseen_id = ''-1''
	  ,oppisopimuskoulutus_id = ''-1''
	  ,koulutuslaji2_id
	  ,tutkinnon_suorittamismaakunta_id = ''-1''
	  ,alueluokitus_id
	  ,yht_koulutuksen_kunta_id = ''-1''
	  ,sijoittuminen_1v_tutkinnon_jalkeen = NULL
	  ,lkm_int
	  ,aloittaneet = NULL
	  ,opiskelijat = NULL
	  ,tutkinnot = NULL
  FROM [dbo].[f_aloittaneiden_lapaisy]

UNION ALL
SELECT [tilastointivuosi] = ''Tuntematon''
	  ,[tilv]
	  ,[1a Aloittaneiden opintojen kulku koulutuslajin mukaan prioriteettina mikä tahansa tutkinto] = ''Tuntematon''
	  ,[1a_jarjestys] =''99998''
	  ,[1c Aloittaneista tutkinnon suorittaneet koulutuslajin mukaan] = ''Tuntematon''
	  ,[1c_jarjestys] =''99998''
	  ,[aineistotunnus]
	  ,oppilaitoksen_taustatiedot_id =''-1''
	  ,koulutuksen_jarjestaja_id =''-1''
	  ,yht_koulutuksen_jarjestaja_id
	  ,lahde_id = ''-1''
	  ,aloituskausikoodi = ''-1''
	  ,tarkastelujakso_id = ''-1''
	  ,paaasiallinen_toiminta_ja_maasta_muuttaneet_id = ''-1''
	  ,ophal_id = ''-1''
	  ,opetushallinnon_koulutus_id
	  ,koulutuksen_tavoite_toteuma_id
	  ,koulutusluokitus_id
	  ,koulk_id = ''-1''
	  ,opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_id
	  ,koulutuksen_jarjestamismuoto_id
	  ,ammatillisen_koulutuksen_koulutuslaji_id
	  ,tutkintolaji_tyollistymiseen_id = ''-1''
	  ,oppisopimuskoulutus_id = ''-1''
	  ,koulutuslaji2_id = ''-1''
	  ,tutkinnon_suorittamismaakunta_id = ''-1''
	  ,alueluokitus_id = ''-1''
	  ,yht_koulutuksen_kunta_id
	  ,sijoittuminen_1v_tutkinnon_jalkeen = NULL
	  ,lkm_int = NULL
	  ,aloittaneet
	  ,opiskelijat
	  ,tutkinnot = NULL
  FROM [dbo].[f_OTV_2_3_Lukiokoulutuksen_ja_ammatillisen_koulutuksen_opiskelijat]

UNION ALL
SELECT [tilastointivuosi]
	  ,[tilv] = ''Tuntematon''
	  ,[1a Aloittaneiden opintojen kulku koulutuslajin mukaan prioriteettina mikä tahansa tutkinto] = ''Tuntematon''
	  ,[1a_jarjestys] =''99998''
	  ,[1c Aloittaneista tutkinnon suorittaneet koulutuslajin mukaan] = ''Tuntematon''
	  ,[1c_jarjestys] =''99998''
	  ,[aineistotunnus]
	  ,oppilaitoksen_taustatiedot_id =''-1''
	  ,koulutuksen_jarjestaja_id =''-1''
	  ,yht_koulutuksen_jarjestaja_id
	  ,lahde_id = ''-1''
	  ,aloituskausikoodi = ''-1''
	  ,tarkastelujakso_id = ''-1''
	  ,paaasiallinen_toiminta_ja_maasta_muuttaneet_id = ''-1''
	  ,ophal_id = ''-1''
	  ,opetushallinnon_koulutus_id
	  ,koulutuksen_tavoite_toteuma_id
	  ,koulutusluokitus_id
	  ,koulk_id = ''-1''
	  ,opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_id
	  ,koulutuksen_jarjestamismuoto_id
	  ,ammatillisen_koulutuksen_koulutuslaji_id
	  ,tutkintolaji_tyollistymiseen_id = ''-1''
	  ,oppisopimuskoulutus_id = ''-1''
	  ,koulutuslaji2_id = ''-1''
	  ,tutkinnon_suorittamismaakunta_id = ''-1''
	  ,alueluokitus_id = ''-1''
	  ,yht_koulutuksen_kunta_id
	  ,sijoittuminen_1v_tutkinnon_jalkeen = NULL
	  ,lkm_int = NULL
	  ,aloittaneet = NULL
	  ,opiskelijat = NULL
	  ,tutkinnot
  FROM [dbo].[f_OTV_2_4_Ammatillisen_koulutuksen_tutkinnot]

  ) f
  INNER JOIN VipunenTK.[dbo].d_oppilaitoksen_taustatiedot
	ON d_oppilaitoksen_taustatiedot.id = f.oppilaitoksen_taustatiedot_id & f.koulutuksen_jarjestaja_id & f.yht_koulutuksen_jarjestaja_id
  INNER JOIN VipunenTK.[dbo].d_lahde
    ON d_lahde.id = f.lahde_id
  INNER JOIN VipunenTK.[dbo].d_kausi
    ON d_kausi.kausi_id = f.aloituskausikoodi
  INNER JOIN VipunenTK.[dbo].d_tarkastelujakso
    ON d_tarkastelujakso.id = f.tarkastelujakso_id
  INNER JOIN VipunenTK.[dbo].d_paaasiallinen_toiminta_ja_maasta_muuttaneet
    ON d_paaasiallinen_toiminta_ja_maasta_muuttaneet.id = f.paaasiallinen_toiminta_ja_maasta_muuttaneet_id
  INNER JOIN VipunenTK.[dbo].d_opetushallinnon_koulutus
    ON d_opetushallinnon_koulutus.id = f.ophal_id & f.opetushallinnon_koulutus_id
  INNER JOIN VipunenTK.[dbo].d_koulutuksen_tavoite_toteuma
    ON d_koulutuksen_tavoite_toteuma.id = f.koulutuksen_tavoite_toteuma_id
  INNER JOIN VipunenTK.[dbo].d_koulutusluokitus
    ON d_koulutusluokitus.id = f.koulutusluokitus_id & f.koulk_id
  INNER JOIN VipunenTK.[dbo].d_tutkintolaji_tyollistymiseen
    ON d_tutkintolaji_tyollistymiseen.id = f.tutkintolaji_tyollistymiseen_id
  INNER JOIN VipunenTK.[dbo].d_opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus
    ON d_opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus.id = f.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_id
  INNER JOIN VipunenTK.[dbo].d_koulutuksen_jarjestamismuoto
    ON d_koulutuksen_jarjestamismuoto.id = f.koulutuksen_jarjestamismuoto_id
  INNER JOIN VipunenTK.[dbo].d_ammatillisen_koulutuksen_koulutuslaji
    ON d_ammatillisen_koulutuksen_koulutuslaji.id = f.ammatillisen_koulutuksen_koulutuslaji_id
  INNER JOIN VipunenTK.[dbo].d_oppisopimuskoulutus
    ON d_oppisopimuskoulutus.id = f.oppisopimuskoulutus_id
  INNER JOIN VipunenTK.[dbo].d_koulutuslaji2
    ON d_koulutuslaji2.id = f.koulutuslaji2_id
  INNER JOIN VipunenTK.[dbo].d_alueluokitus
    ON d_alueluokitus.id = f.tutkinnon_suorittamismaakunta_id & f.alueluokitus_id & f.yht_koulutuksen_kunta_id

	--Rajataan mukaan kaikista aineistosta koulutusaste 32 (Ammatillinen koulutus) AND Poistetaan aloittaneiden läpäisyssä ylimääräiset tarkastelujaksot AND Poistetaan aloittaneiden läpäisyssä ylimääräisiä aloitusvuosia/kausia (sis. 2 x AND NOT komentoa) AND Poistetaan työllistymisessä ja opiskelijoissa ja tutkinnoissa ylimääräisiä tilastovuosia AND Poistetaan Virhetilanne läpäisyssä AND Poistetaan turhat nollarivit työllistymisessä

WHERE (koulutusaste2002_koodi = 32) AND (tarkastelujakso NOT in (''0,5 vuotta'', ''1 vuosi'', ''1,5 vuotta'', ''2 vuotta'', ''2,5 vuotta'', ''4 vuotta'', ''4,5 vuotta'', ''5 vuotta'', ''5,5 vuotta'',''6 vuotta'',''6,5 vuotta'',''7 vuotta'',''7,5 vuotta'',''8 vuotta'',''8,5 vuotta'',''9 vuotta'',''9,5 vuotta'',''10 vuotta'',''10,5 vuotta'',''11 vuotta'',''11,5 vuotta'',''12 vuotta'',''12,5 vuotta'')) AND (lukuvuosi NOT in (''2003/2004'', ''2004/2005'')) AND NOT (lukuvuosi = ''2005/2006'' AND vuosiselite = ''2005'') AND NOT (lukuvuosi = ''2005/2006'' AND vuosiselite = ''2006'' AND tarkastelujakso = ''3 vuotta'') AND (tilv NOT in (''1999'',''2000'',''2001'',''2002'',''2003'',''2004'',''2005'',''2006'',''2007'',''2008'')) AND (tilastointivuosi NOT in (''1999'',''2000'',''2001'',''2002'',''2003'',''2004'',''2005'',''2006'',''2007'',''2008'')) AND ([1a Aloittaneiden opintojen kulku koulutuslajin mukaan prioriteettina mikä tahansa tutkinto] <> ''Virhetilanne'') AND (((tutkintolaji_tyollistymiseen_koodi in (''04'',''05'',''06'',''07'') AND NOT (sijoittuminen_1v_tutkinnon_jalkeen = 0)) OR tutkintolaji_tyollistymiseen_koodi = -1))










' 
GO
/****** Object:  View [dbo].[v_f_tab_elakkeelle_siirtyneet_ja_kuolleet]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_elakkeelle_siirtyneet_ja_kuolleet]'))
EXEC dbo.sp_executesql @statement = N'







CREATE VIEW [dbo].[v_f_tab_elakkeelle_siirtyneet_ja_kuolleet] AS

SELECT 
	   [Tilastovuosi] = tilv
	   ,[Tietojen ajankohta] = d2.tietojen_ajankohta

      ,[Sukupuoli] = d3.sukupuoli
      ,[Äidinkieli] = d4.aidinkieli_versio1
      ,[Ikäryhmä] = d5.ika5v
	  ,[Ikä] = d5.ika
	  ,[Eläkelaji] = d6.elakkeelle_siirtynyt_tai_kuollut
      ,[Eläkkeelle siirtynyt tai kuollut] = d6.elakkeelle_siirtynyt_tai_kuollut_ryhma
      ,[Pääasiallinen toiminta] = d7.paaasiallinen_toiminta
      ,[Ammattiryhmä 1. taso] = d1.mitenna_ammattiryhma1
	  ,[Ammattiryhmä 2. taso] = d1.mitenna_ammattiryhma2

	  ,[Työpaikan maakunta] = d9.maakunta
      
      ,[lkm_yht]
      ,[lkm_elakkeelle_siirtyneet]
      ,[lkm_kuolleet]

	  ,[järj Sukupuoli] = d3.jarjestys
      ,[järj Äidinkieli] = d4.jarjestys
      ,[järj Ikäryhmä] = d5.jarjestys_ika5v
	  ,[järj Eläkelaji] = d6.jarjestys
      ,[järj Pääasiallinen toiminta] = d7.jarjestys
      ,[järj Ammattiryhmä 1. taso] = d1.jarjestys_ammattiryhma1
	  ,[järj Ammattiryhmä 2. taso] = d1.jarjestys_ammattiryhma2
	  ,[järj Työpaikan maakunta] = d9.jarjestys_maakunta

  FROM [VipunenTK].[dbo].[f_elakkeelle_siirtyneet_ja_kuolleet] f
  LEFT JOIN VipunenTK.dbo.d_mitenna_ammatti d1 on d1.id=f.mitenna_ammatti_id
  LEFT JOIN VipunenTK.dbo.d_tietojen_ajankohta d2 on d2.id=f.tietojen_ajankohta_id
  LEFT JOIN VipunenTK.dbo.d_sukupuoli d3 on d3.id=f.sukupuoli_id
  LEFT JOIN VipunenTK.dbo.d_aidinkieli_versio1 d4 on d4.id=f.aidinkieli_versio1_id
  LEFT JOIN VipunenTK.dbo.d_ika d5 on d5.id=f.ika_id
  LEFT JOIN VipunenTK.dbo.d_elakkeelle_siirtynyt_tai_kuollut d6 on d6.id=f.elakkeelle_siirtynyt_tai_kuollut_id
  LEFT JOIN VipunenTK.dbo.d_paaasiallinen_toiminta d7 on d7.id=f.paaasiallinen_toiminta_id
  LEFT JOIN VipunenTK.dbo.d_alueluokitus d9 on d9.id=f.alueluokitus_id









' 
GO
/****** Object:  View [dbo].[v_f_tab_indikaattorit_kunta]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_indikaattorit_kunta]'))
EXEC dbo.sp_executesql @statement = N'












CREATE VIEW [dbo].[v_f_tab_indikaattorit_kunta] AS

Select 
[Tilastovuosi]
,d1.aineisto as Aineisto
,d2.aidinkieli_versio1 as Äidinkieli
,d3.avi as "Asuinalueen AVI"
,d3.ely as "Asuinalueen ELY"
,d3.kielisuhde as "Asuinkunnan kielisuhde"
,d3.maakunta as Asuinmaakunta
,d3.kunta as Asuinkunta
,d3b.avi as "Edeltävän vuoden AVI"
,d3b.ely as "Edeltävän vuoden ELY"
,d3b.kielisuhde as "Edeltävän vuoden asuinkunnan kielisuhde"
,d3b.maakunta as "Edeltävän vuoden asuinmaakunta"
,d3b.kunta as "Edeltävän vuoden asuinkunta"
,d3c.avi as "2v til.v:tta ed. AVI"
,d3c.ely as "2v til.v:tta ed. ELY"
,d3c.kielisuhde as "2v til.v:tta ed. asuinkunnan kielisuhde"
,d3c.maakunta as "2v til.v:tta ed. asuinmaakunta"
,d3c.kunta as "2v til.v:tta ed. asuinkunta"
,d4.sukupuoli as Sukupuoli
,d5.ika as Ikä
,d5.ika5v as Ikäryhmä
,d5b.vuosiselite as Syntymävuosi
,d6a.tutkinto_amk as "Tutkinto (amk)"
,d6b.tutkinto_yo as "Tutkinto (yo)"
,d7.koulutustyyppi as Koulutustyyppi
,d8.kansalaisuus_versio2 as Kansalaisuus
,d9.oppilaitos as Oppilaitos
,d9.opetuskieli as Opetuskieli
,d9.oppilaitoksen_omistajatyyppi as "Oppil. omistajatyyppi"
,d9.oppilaitostyyppi as Oppilaitostyyppi
,d9b.koulutuksen_jarjestaja as "Koulutuksen järjestäjä"
,d9b.koulutuksen_jarjestajan_omistajatyyppi as "Koul. järj. omistajatyyppi"
,d10.lahde as Lähde
,d11.koulutusohjelma_amk as Koulutusohjelma
,d12.opiskelijan_olo as "Kirjoillaolo (syys)"
,d12b.opiskelijan_olo_tamm as "Kirjoillaolo (tammi)"
,d13.rahoituslahde as Rahoituslähde
,d15.suuntautumisvaihtoehto_amk as Suuntautumisvaihtoehto
,d16.kieli as "Koulutuksen kieli"
,d17.ensisijainen_opintooikeus as "Ensisijainen opinto-oikeus"
,d18.tilauskoulutuksen_sijaintimaa as "Tilauskoulutuksen sijaintimaa"
,d19.koulutussektori as Koulutussektori
,CASE WHEN d21b.jarjestys in (12,13) Then ''Opetushallinnon alainen koulutus'' Else d20.opetushallinnon_koulutus End as Hallinnonala
,d21.koulutusaste2002 as "Koulutusaste (2002)"
,d21.koulutusala2002 as "Koulutusala (2002)"
,d21.opintoala1995 as "Koulutusala (1995)"
,d21.opintoala2002 as "Opintoala (2002)"
,d21.koulutus as Koulutusnimike
,d21b.koulutuslaji_okm as Koulutuslaji
,d21b.koulutuslaji_okm2 as Koulutuslaji2
,d22.avi as "Koulutuksen AVI"
,d22.ely as "Koulutuksen ELY"
,d22.maakunta as "Koulutuksen maakunta"
,d22.kielisuhde as "Koul. kunnan kielisuhde"
,d22.kunta as "Koulutuksen kunta"
,d22b.avi as "Koul. järjestäjän AVI"
,d22b.ely as "Koul. järjestäjän ELY"
,d22b.maakunta as "Koul. järjestäjän maakunta"
,d22b.kielisuhde as "Koul. järj. kunnan kielisuhde"
,d22b.kunta as "Koul. järjestäjän kunta"
,d22c.avi as "Oppilaitoksen AVI"
,d22c.ely as "Oppilaitoksen ELY"
,d22c.maakunta as "Oppilaitoksen maakunta"
,d22c.kielisuhde as "Oppil. kunnan kielisuhde"
,d22c.kunta as "Oppilaitoksen kunta"
,d23.vuosiselite as "Kirjoihintulovuosi"
,d23b.lukukausiselite as "Kirjoihintulokausi"
,d24b.vuosiselite as "Kirjoihintulovuosi (kk-sek.)"
,d24c.vuosiselite as "Kirjoihintulovuosi (kk-sek. läsna)"
,d24d.vuosiselite as "Kirjoihintulovuosi (sek.)"
,d24e.vuosiselite as "Kirjoihintulovuosi (sek. läsnä)"
,d24f.vuosiselite as "Kirjoihintulovuosi (kk)"
,d24g.vuosiselite as "Kirjoihintulovuosi (kk läsnä)"
,d24h.vuosiselite as "Kirjoihintulovuosi (op.ala)"
,d24i.vuosiselite as "Kirjoihintulovuosi (op.ala läsnä)"
,d24j.vuosiselite as "Kirjoihintulovuosi (tutk.)"
,d24k.lukukausiselite as "Kirjoihintulokausi (tutk.)"
,d45.tutkinnon_tavoite as "Koulutuksen tavoite"
--jarjestysmuuttujat
,d2.jarjestys as jarj_aidinkieli
,d3.jarjestys_avi as jarj_as_avi
,d3.jarjestys_ely as jarj_as_ely
,d3.jarjestys_kielisuhde as jarj_as_kielisuhde
,d3.jarjestys_maakunta as jarj_as_maakunta
,d3.jarjestys as jarj_as_kunta
,d3b.jarjestys_avi as jarj_as_avi1x
,d3b.jarjestys_ely as jarj_as_ely1x
,d3b.jarjestys_kielisuhde as jarj_as_kielisuhde1x
,d3b.jarjestys_maakunta as jarj_as_maakunta1x
,d3b.jarjestys as jarj_as_kunta1x
,d3c.jarjestys_avi as jarj_as_avi2x
,d3c.jarjestys_ely as jarj_as_ely2x
,d3c.jarjestys_kielisuhde as jarj_as_kielisuhde2x
,d3c.jarjestys_maakunta as jarj_as_maakunta2x
,d3c.jarjestys as jarj_as_kunta2x
,d5.jarjestys_ika
,d5.jarjestys_ika5v as jarj_ika5v
,d5b.jarjestys as jarj_syntv
,d6a.jarjestys as jarj_tutk_amk
,d6b.jarjestys as jarj_tutk_yo
,d7.jarjestys as jarj_koultyyppi
,d8.jarjestys as jarj_kansalaisuus
,d9.jarjestys_oppilaitos
,d9.jarjestys_opetuskieli
,d9.jarjestys_omistajatyyppi
,d9.jarjestys_oppilaitostyyppi
,d11.jarjestys as jarj_koulohjelma_amk
,d12.jarjestys as jarj_kirjolosyys
,d12b.jarjestys as jarj_kirjolotammi
,d13.jarjestys as jarj_rahoitus
,d15.jarjestys as jarj_suunnvaiht
,d16.jarjestys as jarj_koulkiel
,d16.jarjestys_iso3kirjainta as jarj_koulkiel2
,d17.jarjestys as jarj_ensop
,d18.jarjestys as jarj_tilauskoul
,d19.jarjestys as jarj_koulsek
,d20.jarjestys as jarj_hallinnonala
,d21.jarjestys_koulutusaste2002
,d21.jarjestys_koulutusala2002
,d21.jarjestys_opintoala1995
,d21.jarjestys_opintoala2002
,d21.jarjestys as jarj_koulnimike
,d21b.jarjestys as jarj_koullaji
,d21b.jarjestys2 as jarj_koullaji2
,d22.jarjestys_avi
,d22.jarjestys_ely
,d22.jarjestys_maakunta
,d22.jarjestys_kielisuhde
,d22.jarjestys as jarj_kunta
,d22b.jarjestys_avi as jarjestys_avi2
,d22b.jarjestys_ely as jarjestys_ely2
,d22b.jarjestys_maakunta as jarjestys_maakunta2
,d22b.jarjestys_kielisuhde as jarjestys_kielisuhde2
,d22b.jarjestys as jarj_kunta2
,d22c.jarjestys_avi as jarjestys_avi3
,d22c.jarjestys_ely as jarjestys_ely3
,d22c.jarjestys_maakunta as jarjestys_maakunta3
,d22c.jarjestys_kielisuhde as jarjestys_kielisuhde3
,d22c.jarjestys as jarj_kunta3
,d23b.jarjestys as jarj_lukukausi
,d45.jarjestys as jarj_tavoite
--Koodimuuttujat
,d1.aineisto_koodi
,d2.aidinkieli_versio1_koodi as aidinkieli_koodi
,d3.maakunta_koodi as ''Koodit Asuinmaakunta''
,d3.kunta_koodi as ''Koodit Asuinkunta''
,d3b.maakunta_koodi as asmaak1xmk
,d3b.kunta_koodi as asmaak1xk
,d6a.tutkinto_amk_koodi as ''Koodit Tutkinto (amk)''
,d6b.tutkinto_yo_koodi as ''Koodit Tutkinto (yo)''
,d7.koulutustyyppi_koodi as ''Koodit Koulutustyyppi''
,d8.kansalaisuus_versio2_koodi as kansalaisuus_koodi
,d9.oppilaitoskoodi as ''Koodit Oppilaitos''
,d9b.koulutuksen_jarjestajakoodi as ''Koodit Koulutuksen järjestäjä''
,d10.lahde_koodi
,d11.koulutusohjelma_amk_koodi as ''Koodit Koulutusohjelma''
,d12.opiskelijan_olo_koodi as kirjoillaolosyys_koodi
,d12b.opiskelijan_olo_tamm_koodi as kirjoillaolotammi_koodi
,d17.ensisijainen_opintooikeus_koodi as ensiop
,d21.koulutusaste2002_koodi as ''Koodit Koulutusaste 2002''
,d21.koulutusala2002_koodi as ''Koodit Koulutusala 2002''
,d21.opintoala1995_koodi as ''Koodit Koulutusala 1995''
,d21.opintoala2002_koodi as ''Koodit Opintoala 2002''
,d21.koulutus_koodi as ''Koodit Koulutusnimike''
,d22.maakunta_koodi as ''Koodit Koulutuksen maakunta''
,d22.kunta_koodi as ''Koodit Koulutuksen kunta''
,d22b.maakunta_koodi as ''Koodit Koul. järj. maakunta''
,d22b.kunta_koodi as ''Koodit Koul. järj. kunta''
,d22c.maakunta_koodi as ''Koodit Oppil. maakunta''
,d22c.kunta_koodi as ''Koodit Oppil. kunta''
,d23.vuosi as alvv
,d23b.lukukausi as alkk
,d24b.vuosi as alvv_kksek
,d24c.vuosi as alvv_kksek_lasna
,d24d.vuosi as alvv_sek
,d24e.vuosi as alvv_sek_lasna
,d24f.vuosi as alvv_kk
,d24g.vuosi as alvv_kk_lasna
,d24h.vuosi as alvv_opa
,d24i.vuosi as alvv_opa_lasna
,d24j.vuosi as kirtu1v
,d24k.lukukausi as kirtu1k
--ruotsi
,[Tilastovuosi] as Statistikår
,d2.aidinkieli_versio1_SV as Modersmål
--,d3.avi_SV as "Asuinalueen AVISV"
--,d3.ely_SV as "Asuinalueen ELYSV"
--,d3.kielisuhde_SV as "Asuinkunnan kielisuhdeSV"
,d3.maakunta_SV as Bostadslandskap
,d3.kunta_SV as Bostadskommun
--,d3b.avi_SV as "Til.v:tta edeltävä AVISV"
--,d3b.ely_SV as "Til.v:tta edeltävä ELYSV"
--,d3b.kielisuhde_SV as "Til.v:tta ed. asuinkunnan kielisuhdeSV"
--,d3b.maakunta_SV as "Til.v:tta ed. asuinmaakuntaSV"
--,d3b.kunta_SV as "Til.v:tta ed. asuinkuntaSV"
--,d3c.avi_SV as "2v til.v:tta ed. AVISV"
--,d3c.ely_SV as "2v til.v:tta ed. ELYSV"
--,d3c.kielisuhde_SV as "2v til.v:tta ed. asuinkunnan kielisuhdeSV"
--,d3c.maakunta_SV as "2v til.v:tta ed. asuinmaakuntaSV"
--,d3c.kunta_SV as "2v til.v:tta ed. asuinkuntaSV"
,d4.sukupuoli_SV as Kön
,d5.ika_SV as Ålder
,d5.ika5v_SV as Åldersgrupp
,d5b.vuosiselite_SV as Födelseår
--,d5c.kuukausiselite_SV as SyntymäkuukausiSV
,d6a.tutkinto_amk_SV as "Examen (yrkehögskola)"
,d6b.tutkinto_yo_SV as "Examen (universitet)"
,d7.koulutustyyppi_SV as "Typ av utbildning"
,d8.kansalaisuus_versio2_SV as Medborgarskap
,d9.oppilaitos_SV as Läroanstalt
,d9.oppilaitos_SV as Universitet
,d9.oppilaitos_SV as Yrkeshögskola
--,d9.opetuskieli_SV as OpetuskieliSV
--,d9.oppilaitoksen_omistajatyyppi_SV as "Oppil. omistajatyyppiSV"
--,d9.oppilaitostyyppi_SV as OppilaitostyyppiSV
,d9b.koulutuksen_jarjestaja_SV as "Utbildningsanordnare"
--,d9b.koulutuksen_jarjestajan_omistajatyyppi_SV as "Koul. järj. omistajatyyppiSV"
--,d10.lahde_SV as LähdeSV
,d11.koulutusohjelma_amk_SV as Utbildningsprogram
,d12.opiskelijan_olo_SV as "Inskrivning (september)"
,d12b.opiskelijan_olo_tamm_SV as "Inskrivning (januari)"
,d13.rahoituslahde_SV as Finansieringskälla
--,d15.suuntautumisvaihtoehto_amk_SV as SuuntautumisvaihtoehtoSV
--,d16.kieli_SV as "Koulutuksen kieliSV"
--,d17.ensisijainen_opintooikeus_SV as "Ensisijainen opinto-oikeusSV"
--,d18.tilauskoulutuksen_sijaintimaa_SV as "Tilauskoulutuksen sijaintimaaSV"
,d19.koulutussektori_SV as Utbildningssektor
,CASE WHEN d21b.jarjestys in (12,13) Then ''Undervisningsförvaltn. utbildn.'' Else d20.opetushallinnon_koulutus_SV End as Förvaltningsområde
,d21.koulutusaste2002_SV as "Utbildningsnivå (2002)"
,d21.koulutusala2002_SV as "Utbildningsområde (2002)"
,d21.opintoala1995_SV as "Utbildningsområde (1995)"
,d21.opintoala2002_SV as "Studieområde (2002)"
,d21.koulutus_SV as Utbildningsbenämning
,d21b.koulutuslaji_okm_SV as Utbildningsslag
,d21b.koulutuslaji_okm2_SV as Utbildningsslag2
--,d22.avi_SV as "Koulutuksen AVISV"
--,d22.ely_SV as "Koulutuksen ELYSV"
,d22.maakunta_SV as "Utbildningens landskap"
--,d22.kielisuhde_SV as "Koul. kunnan kielisuhdeSV"
,d22.kunta_SV as "Utbildningens kommun"
--,d22b.avi_SV as "Koul. järjestäjän AVISV"
--,d22b.ely_SV as "Koul. järjestäjän ELYSV"
--,d22b.maakunta_SV as "Koul. järjestäjän maakuntaSV"
--,d22b.kielisuhde_SV as "Koul. järj. kunnan kielisuhdeSV"
--,d22b.kunta_SV as "Koul. järjestäjän kuntaSV"
--,d22c.avi_SV as "Oppilaitoksen AVISV"
--,d22c.ely_SV as "Oppilaitoksen ELYSV"
--,d22c.maakunta_SV as "Oppilaitoksen maakuntaSV"
--,d22c.kielisuhde_SV as "Oppil. kunnan kielisuhdeSV"
--,d22c.kunta_SV as "Oppilaitoksen kuntaSV"
--,d23.vuosiselite_SV as "KirjoihintulovuosiSV"
--,d23b.lukukausiselite_SV as "KirjoihintulokausiSV"
--,d24b.vuosiselite_SV as "Kirjoihintulovuosi (kk-sek.)SV"
--,d24c.vuosiselite_SV as "Kirjoihintulovuosi (kk-sek. läsna)SV"
--,d24d.vuosiselite_SV as "Kirjoihintulovuosi (sek.)SV"
--,d24e.vuosiselite_SV as "Kirjoihintulovuosi (sek. läsnä)SV"
--,d24f.vuosiselite_SV as "Kirjoihintulovuosi (kk)SV"
--,d24f2.lukukausiselite_SV as "Kirjoihintulokausi (kk)SV"
--,d24g.vuosiselite_SV as "Kirjoihintulovuosi (kk läsnä)SV"
--,d24h.vuosiselite_SV as "Kirjoihintulovuosi (op.ala)SV"
--,d24i.vuosiselite_SV as "Kirjoihintulovuosi (op.ala läsnä)SV"
--,d24j.vuosiselite_SV as "Kirjoihintulovuosi (tutk.)SV"
--,d24k.lukukausiselite_SV as "Kirjoihintulokausi (tutk.)SV"
,d45.tutkinnon_tavoite_SV as "Utbildningens mål"
--englanti
,[Tilastovuosi] as "Statistical year"
,d2.aidinkieli_versio1_EN as "Mother tongue"
--,d3.avi_EN as "Asuinalueen AVIEN"
--,d3.ely_EN as "Asuinalueen ELYEN"
--,d3.kielisuhde_EN as "Asuinkunnan kielisuhdeEN"
,d3.maakunta_EN as "Region of residence"
,d3.kunta_EN as "Municipality of residence"
--,d3b.avi_EN as "Til.v:tta edeltävä AVIEN"
--,d3b.ely_EN as "Til.v:tta edeltävä ELYEN"
--,d3b.kielisuhde_EN as "Til.v:tta ed. asuinkunnan kielisuhdeEN"
--,d3b.maakunta_EN as "Til.v:tta ed. asuinmaakuntaEN"
--,d3b.kunta_EN as "Til.v:tta ed. asuinkuntaEN"
--,d3c.avi_EN as "2v til.v:tta ed. AVIEN"
--,d3c.ely_EN as "2v til.v:tta ed. ELYEN"
--,d3c.kielisuhde_EN as "2v til.v:tta ed. asuinkunnan kielisuhdeEN"
--,d3c.maakunta_EN as "2v til.v:tta ed. asuinmaakuntaEN"
--,d3c.kunta_EN as "2v til.v:tta ed. asuinkuntaEN"
,d4.sukupuoli_EN as Gender
,d5.ika_EN as Age
,d5.ika5v_EN as Agegroup
,d5b.vuosiselite_EN as "Year of birth"
--,d5c.kuukausiselite_EN as SyntymäkuukausiEN
,d6a.tutkinto_amk_EN as "Degree (polytechnic)"
,d6b.tutkinto_yo_EN as "Degree (university)"
,d7.koulutustyyppi_EN as "Type of education"
,d8.kansalaisuus_versio2_EN as Nationality
,d9.oppilaitos_EN as "Educational institution"
,d9.oppilaitos_EN as University
,d9.oppilaitos_EN as Polytechnic
--,d9.opetuskieli_EN as OpetuskieliEN
--,d9.oppilaitoksen_omistajatyyppi_EN as "Oppil. omistajatyyppiEN"
--,d9.oppilaitostyyppi_EN as OppilaitostyyppiEN
,d9b.koulutuksen_jarjestaja_EN as "Education provider"
--,d9b.koulutuksen_jarjestajan_omistajatyyppi_EN as "Koul. järj. omistajatyyppiEN"
--,d10.lahde_EN as LähdeEN
,d11.koulutusohjelma_amk_EN as "Degree programme"
,d12.opiskelijan_olo_EN as "Enrollment status (sept.)"
,d12b.opiskelijan_olo_tamm_EN as "Enrollment status (jan.)"
,d13.rahoituslahde_EN as "Source of funding"
--,d15.suuntautumisvaihtoehto_amk_EN as SuuntautumisvaihtoehtoEN
--,d16.kieli_EN as "Koulutuksen kieliEN"
--,d17.ensisijainen_opintooikeus_EN as "Ensisijainen opinto-oikeusEN"
--,d18.tilauskoulutuksen_sijaintimaa_EN as "Tilauskoulutuksen sijaintimaaEN"
,d19.koulutussektori_EN as "Sector of education"
,CASE WHEN d21b.jarjestys in (12,13) Then ''Education under the education administration'' Else d20.opetushallinnon_koulutus_EN End as "Administrative sector"
,d21.koulutusaste2002_EN as "Level of education (2002)"
,d21.koulutusala2002_EN as "Field of education (2002)"
,d21.opintoala1995_EN as "Field of education (1995)"
,d21.opintoala2002_EN as "Subfield of ed. (2002)"
,d21.koulutus_EN as "Name of education"
,d21b.koulutuslaji_okm_EN as "Form of education"
,d21b.koulutuslaji_okm2_EN as "Form of education2"
--,d22.avi_EN as "Koulutuksen AVIEN"
--,d22.ely_EN as "Koulutuksen ELYEN"
,d22.maakunta_EN as "Region of education"
--,d22.kielisuhde_EN as "Koul. kunnan kielisuhdeEN"
,d22.kunta_EN as "Municipality of education"
--,d22b.avi_EN as "Koul. järjestäjän AVIEN"
--,d22b.ely_EN as "Koul. järjestäjän ELYEN"
--,d22b.maakunta_EN as "Koul. järjestäjän maakuntaEN"
--,d22b.kielisuhde_EN as "Koul. järj. kunnan kielisuhdeEN"
--,d22b.kunta_EN as "Koul. järjestäjän kuntaEN"
--,d22c.avi_EN as "Oppilaitoksen AVIEN"
--,d22c.ely_EN as "Oppilaitoksen ELYEN"
--,d22c.maakunta_EN as "Oppilaitoksen maakuntaEN"
--,d22c.kielisuhde_EN as "Oppil. kunnan kielisuhdeEN"
--,d22c.kunta_EN as "Oppilaitoksen kuntaEN"
,d23.vuosiselite_EN as "Year of enrollment"
,d23b.lukukausiselite_EN as "Term of enrollment"
,d24b.vuosiselite_EN as "Year of enrollment (HE sec.)"
,d24c.vuosiselite_EN as "Year of enrollment (HE sec. present)"
,d24d.vuosiselite_EN as "Year of enrollment (sec.)"
,d24e.vuosiselite_EN as "Year of enrollment (sec. present)"
,d24f.vuosiselite_EN as "Year of enrollment (ed. inst.)"
,d24g.vuosiselite_EN as "Year of enrollment (ed. inst. present)"
,d24h.vuosiselite_EN as "Year of enrollment (subfield of ed.)"
,d24i.vuosiselite_EN as "Year of enrollment (subfield of ed. present)"
,d24j.vuosiselite_EN as "Year of enrollment (degree)"
,d24k.lukukausiselite_EN as "Term of enrollment (degree)"
,d45.tutkinnon_tavoite_EN as "Objective of education"
--isced
,d21.iscle2011 as "Koulutusaste, taso 1"
,d21.Koulutusaste_taso2 as "Koulutusaste, taso 2"
,d21.iscfibroad2013 as "Koulutusala, taso 1"
,d21.iscfinarrow2013 as "Koulutusala, taso 2"
,d21.iscfi2013 as "Koulutusala, taso 3"
,d21.OKM_ohjauksen_ala as "OKM ohjauksen ala, korkeak."
,d21.iscle2011_SV as "Utbildn.nivå, nivå 1"
,d21.Koulutusaste_taso2_SV as "Utbildn.nivå, nivå 2"
,d21.iscfibroad2013_SV as "Utbildn.område, nivå 1"
,d21.iscfinarrow2013_SV as "Utbildn.område, nivå 2"
,d21.iscfi2013_SV as "Utbildn.område, nivå 3"
,d21.OKM_ohjauksen_ala_SV as "UKM-styrningsområde, högskolor"
,d21.iscle2011_EN as "Level of ed., tier 1"
,d21.Koulutusaste_taso2_EN as "Level of ed., tier 2"
,d21.iscfibroad2013_EN as "Field of education, tier 1"
,d21.iscfinarrow2013_EN as "Field of education, tier 2"
,d21.iscfi2013_EN as "Field of education, tier 3"
,d21.OKM_ohjauksen_ala_EN as "Field of ed., HE steering"
,d21.jarjestys_iscle2011 as jarj_isced_koulast1
,d21.jarjestys_Koulutusaste_taso2 as jarj_isced_koulast2
,d21.jarjestys_iscfibroad2013 as jarj_isced_koulala1
,d21.jarjestys_iscfinarrow2013 as jarj_isced_koulala2
,d21.jarjestys_iscfi2013 as jarj_isced_koulala3
,d21.jarjestys_OKM_ohjauksen_ala as jarj_isced_okmohjaus1
,d21.iscle2011_koodi as "Koodit Koulutusaste, taso 1"
,d21.Koulutusaste_taso2_koodi as "Koodit Koulutusaste, taso 2"
,d21.iscfibroad2013_koodi as "Koodit Koulutusala, taso 1"
,d21.iscfinarrow2013_koodi as "Koodit Koulutusala, taso 2"
,d21.iscfi2013_koodi as "Koodit Koulutusala, taso 3"
,d21.OKM_ohjauksen_ala_koodi as "Koodit OKM ohjauksen ala, korkeak."
--Lukumäärämuuttujat
,[Opisk2]
,[Aloit2]
,[opiskelijat_lasna]

FROM (
SELECT [tilastointivuosi] as Tilastovuosi
	  ,aineisto_id
	  ,aidinkieli_versio1_id
	  ,kotikunta_id
	  ,kotikunta1x_id
	  ,kotikunta_ed_id = -1
	  ,kotikunta2x_id
	  ,sukupuoli_id
	  ,ika_id
	  ,syntymavuosi_id
	  ,tutkinto_amk_id
	  ,tutkinto_yo_id
	  ,koulutustyyppi_id
	  ,kansalaisuus_versio2_id
	  ,oppilaitos_id
	  ,koulutuksen_jarjestaja_id
	  ,lahde_id
	  ,koulutusohjelma_amk_id
	  ,opiskelijan_olo_syys_id
	  ,opiskelijan_olo_tamm_id
	  ,rahoituslahde_id
	  ,suuntautumisvaihtoehto_amk_id
	  ,koulutuksen_kieli_id
	  ,ensisijainen_opintooikeus_id
	  ,tilauskoulutuksen_sijaintimaa_id
	  ,koulutussektori_id
	  ,opetushallinnon_koulutus_id
	  ,koulutusluokitus_id
	  ,koulutusala_id = -1
	  ,koulutuslaji_OKM_id
	  ,koulutuksen_kunta_id
	  ,koulutuksen_jarjestaja_kunta_id
	  ,oppilaitos_kunta_id
	  ,kirjoihintulovuosi_id
	  ,kirjoihintulokausi_id
	  ,kirjoihintulovuosi_korkeakoulusektori_id
	  ,kirjoihintulovuosi_korkeakoulusektori_lasnaoleva_id
	  ,kirjoihintulovuosi_sektori_id
	  ,kirjoihintulovuosi_sektori_lasnaoleva_id
	  ,kirjoihintulovuosi_korkeakoulu_id
	  ,kirjoihintulovuosi_korkeakoulu_lasnaoleva_id
	  ,kirjoihintulovuosi_opintoala_id
	  ,kirjoihintulovuosi_opintoala_lasnaoleva_id
	  ,kirjoihintulovuosi_tutkinto_id
	  ,kirjoihintulokausi_tutkinto_id
	  ,tutkinnon_tavoite_id = -1
	  ,[opiskelijat] as Opisk2
	  ,[aloittaneet] as Aloit2
	  ,[opiskelijat_lasna]
  FROM [dbo].[f_OTV_2_8_Korkeakouluopiskelijat]

UNION ALL
SELECT [tilastointivuosi] as Tilastovuosi
	  ,aineisto_id = -1
	  ,aidinkieli_versio1_id = -1
	  ,kotikunta_id
	  ,kotikunta1x_id = -1
	  ,kotikunta_ed_id
	  ,kotikunta2x_id = -1
	  ,sukupuoli_id = -1
	  ,ika_id
	  ,syntymavuosi_id = -1
	  ,tutkinto_amk_id = -1
	  ,tutkinto_yo_id = -1
	  ,koulutustyyppi_id = -1
	  ,kansalaisuus_versio2_id = -1
	  ,oppilaitos_id
	  ,koulutuksen_jarjestaja_id
	  ,lahde_id = -1
	  ,koulutusohjelma_amk_id = -1
	  ,opiskelijan_olo_syys_id = -1
	  ,opiskelijan_olo_tamm_id = -1
	  ,rahoituslahde_id = -1
	  ,suuntautumisvaihtoehto_amk_id = -1
	  ,koulutuksen_kieli_id
	  ,ensisijainen_opintooikeus_id = -1
	  ,tilauskoulutuksen_sijaintimaa_id = -1
	  ,koulutussektori_id = -1
	  ,opetushallinnon_koulutus_id
	  ,koulutusluokitus_id = -1
	  ,koulutusala_id
	  ,koulutuslaji_OKM_id
	  ,koulutuksen_kunta_id
	  ,koulutuksen_jarjestaja_kunta_id = -1
	  ,oppilaitos_kunta_id = -1
	  ,kirjoihintulovuosi_id = -1
	  ,kirjoihintulokausi_id = -1
	  ,kirjoihintulovuosi_korkeakoulusektori_id = -1
	  ,kirjoihintulovuosi_korkeakoulusektori_lasnaoleva_id = -1
	  ,kirjoihintulovuosi_sektori_id = -1
	  ,kirjoihintulovuosi_sektori_lasnaoleva_id = -1
	  ,kirjoihintulovuosi_korkeakoulu_id = -1
	  ,kirjoihintulovuosi_korkeakoulu_lasnaoleva_id = -1
	  ,kirjoihintulovuosi_opintoala_id = -1
	  ,kirjoihintulovuosi_opintoala_lasnaoleva_id = -1
	  ,kirjoihintulovuosi_tutkinto_id = -1
	  ,kirjoihintulokausi_tutkinto_id = -1
	  ,tutkinnon_tavoite_id
	  ,[opiskelijat] as Opisk2
	  ,[aloittaneet] as Aloit2
	  ,[opiskelijat_lasna]

  FROM [dbo].[f_2_3h_Lukiokoulutuksen_ja_ammatillisen_koulutuksen_opiskelijat]

  ) f
	LEFT JOIN [dbo].d_aineisto d1 ON d1.id = f.aineisto_id
	LEFT JOIN [dbo].d_aidinkieli_versio1 d2 ON d2.id = f.aidinkieli_versio1_id
	LEFT JOIN [dbo].d_alueluokitus d3 ON d3.id = f.kotikunta_id
	LEFT JOIN [dbo].d_alueluokitus d3b ON d3b.id = f.kotikunta1x_id & f.kotikunta_ed_id
	LEFT JOIN [dbo].d_alueluokitus d3c ON d3c.id = f.kotikunta2x_id
	LEFT JOIN [dbo].d_sukupuoli d4 ON d4.id = f.sukupuoli_id
	LEFT JOIN [dbo].d_ika d5 ON d5.id = f.ika_id
	LEFT JOIN [dbo].d_kausi d5b ON d5b.kausi_id = f.syntymavuosi_id
	LEFT JOIN [dbo].d_tutkinto_amk d6a ON d6a.id = f.tutkinto_amk_id
	LEFT JOIN [dbo].d_tutkinto_yo d6b ON d6b.id = f.tutkinto_yo_id
	LEFT JOIN [dbo].d_koulutustyyppi d7 ON d7.id = f.koulutustyyppi_id
	LEFT JOIN [dbo].d_kansalaisuus_versio2 d8 ON d8.id = f.kansalaisuus_versio2_id
	LEFT JOIN [dbo].d_oppilaitoksen_taustatiedot d9 ON d9.id = f.oppilaitos_id
	LEFT JOIN [dbo].d_oppilaitoksen_taustatiedot d9b ON d9b.id = f.koulutuksen_jarjestaja_id
	LEFT JOIN [dbo].d_lahde d10 ON d10.id = f.lahde_id
	LEFT JOIN [dbo].d_koulutusohjelma_amk d11 ON d11.id = f.koulutusohjelma_amk_id
	LEFT JOIN [dbo].d_opiskelijan_olo d12 ON d12.id = f.opiskelijan_olo_syys_id
	LEFT JOIN [dbo].d_opiskelijan_olo_tamm d12b ON d12b.id = f.opiskelijan_olo_tamm_id
	LEFT JOIN [dbo].d_rahoituslahde d13 ON d13.id = f.rahoituslahde_id
	LEFT JOIN [dbo].d_suuntautumisvaihtoehto_amk d15 ON d15.id = f.suuntautumisvaihtoehto_amk_id
	LEFT JOIN [dbo].d_kieli d16 ON d16.id = f.koulutuksen_kieli_id
	LEFT JOIN [dbo].d_ensisijainen_opintooikeus d17 ON d17.id = f.ensisijainen_opintooikeus_id
	LEFT JOIN [dbo].d_tilauskoulutuksen_sijaintimaa d18 ON d18.id = f.tilauskoulutuksen_sijaintimaa_id
	LEFT JOIN [dbo].d_koulutussektori d19 ON d19.id = f.koulutussektori_id
	LEFT JOIN [dbo].d_opetushallinnon_koulutus d20 ON d20.id = f.opetushallinnon_koulutus_id
	LEFT JOIN [dbo].d_koulutusluokitus d21 ON d21.id = f.koulutusluokitus_id & f.koulutusala_id
	LEFT JOIN [dbo].d_koulutuslaji_okm d21b ON d21b.id = f.koulutuslaji_OKM_id
	LEFT JOIN [dbo].d_alueluokitus d22 ON d22.id = f.koulutuksen_kunta_id
	LEFT JOIN [dbo].d_alueluokitus d22b ON d22b.id = f.koulutuksen_jarjestaja_kunta_id
	LEFT JOIN [dbo].d_alueluokitus d22c ON d22c.id = f.oppilaitos_kunta_id
	LEFT JOIN [dbo].d_kausi d23 ON d23.kausi_id = f.kirjoihintulovuosi_id
	LEFT JOIN [dbo].d_kausi d23b ON d23b.kausi_id = f.kirjoihintulokausi_id
	LEFT JOIN [dbo].d_kausi d24b ON d24b.kausi_id = f.kirjoihintulovuosi_korkeakoulusektori_id
	LEFT JOIN [dbo].d_kausi d24c ON d24c.kausi_id = f.kirjoihintulovuosi_korkeakoulusektori_lasnaoleva_id
	LEFT JOIN [dbo].d_kausi d24d ON d24d.kausi_id = f.kirjoihintulovuosi_sektori_id
	LEFT JOIN [dbo].d_kausi d24e ON d24e.kausi_id = f.kirjoihintulovuosi_sektori_lasnaoleva_id
	LEFT JOIN [dbo].d_kausi d24f ON d24f.kausi_id = f.kirjoihintulovuosi_korkeakoulu_id
	LEFT JOIN [dbo].d_kausi d24g ON d24g.kausi_id = f.kirjoihintulovuosi_korkeakoulu_lasnaoleva_id
	LEFT JOIN [dbo].d_kausi d24h ON d24h.kausi_id = f.kirjoihintulovuosi_opintoala_id
	LEFT JOIN [dbo].d_kausi d24i ON d24i.kausi_id = f.kirjoihintulovuosi_opintoala_lasnaoleva_id
	LEFT JOIN [dbo].d_kausi d24j ON d24j.kausi_id = f.kirjoihintulovuosi_tutkinto_id
	LEFT JOIN [dbo].d_kausi d24k ON d24k.kausi_id = f.kirjoihintulokausi_tutkinto_id
	left join VipunenTK.dbo.d_tutkinnon_tavoite d45 on d45.id=f.tutkinnon_tavoite_id
WHERE d1.aineisto_koodi in (''L'',''-1'') AND d9.oppilaitoskoodi <> ''02557'' AND d9.oppilaitoskoodi <> ''10031'' AND d9.oppilaitoskoodi <> ''02358''







' 
GO
/****** Object:  View [dbo].[v_f_tab_indikaattorit_opiskelijat_ikäluokka]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_indikaattorit_opiskelijat_ikäluokka]'))
EXEC dbo.sp_executesql @statement = N'











CREATE view [dbo].[v_f_tab_indikaattorit_opiskelijat_ikäluokka] as

--Esiopetus (päivähoito)
Select
       Tilastovuosi = f.tilv
	  ,[Kunta] = d1.kunta
	  ,[Maakunta] = d1.maakunta
	  ,[Sektori] = ''Esiopetus''
	  ,[Sukupuoli] = ''Tuntematon''
	  ,[Äidinkieli] = null
	  ,[Opetussuunnitelma] = null
	  ,[Koulutuslaji] = null
	  ,[Järjestämistapa] = null
	  ,[Järjestämismuoto] = null
	  ,[Koulutuksen kieli] = null

	  --Ruotsi
	  ,[Statistikår] = f.tilv
	  ,[Landskap] = d1.maakunta_SV
	  ,[Kön] = ''Okänd''

	  --Englanti
	  ,[Statistical year] = f.tilv
	  ,[Region] = d1.maakunta_EN
	  ,[Gender] = ''Unknown''

	  ,Aloittaneet = sum(convert(int,f.popy))
	  ,[Väestö 6] = null
	  ,[Väestö 7] = null
	  ,[Väestö 16-18] = null
	  ,[Väestö 19-21] = null
	  ,[Väestö 25-64] = null

	  ,[Maakunta järjestys] = d1.jarjestys_maakunta
	  ,[Sukupuoli järjestys] = 99
	  ,[Äidinkieli järjestys] = 99
      
FROM [dbo].[f_paivahoidon_yhteydessa_annettavan_esiopetuksen_aineisto] f
LEFT JOIN dbo.d_alueluokitus d1 on d1.id=f.alueluokitus_id
WHERE f.popy <> 0 and d1.maakunta<>''Tuntematon''
GROUP BY tilv,d1.kunta,d1.maakunta,d1.jarjestys_maakunta,d1.maakunta_SV,d1.maakunta_EN

UNION ALL

--Esiopetus (oppilaitokset)
Select
       Tilastovuosi = f.tilastointivuosi
	  ,[Kunta] = d1.kunta
	  ,[Maakunta] = d1.maakunta
	  ,[Sektori] = ''Esiopetus''
	  ,[Sukupuoli] = ''Tuntematon''
	  ,[Äidinkieli] = null
	  ,[Opetussuunnitelma] = null
	  ,[Koulutuslaji] = null
	  ,[Järjestämistapa] = null
	  ,[Järjestämismuoto] = null
	  ,[Koulutuksen kieli] = null

	  --Ruotsi
	  ,[Statistikår] = f.tilastointivuosi
	  ,[Landskap] = d1.maakunta_SV
	  ,[Kön] = ''Okänd''

	  --Englanti
	  ,[Statistical year] = f.tilastointivuosi
	  ,[Region] = d1.maakunta_EN
	  ,[Gender] = ''Unknown''

	  ,Aloittaneet = sum(f.ove)
	  ,[Väestö 6] = null
	  ,[Väestö 7] = null
	  ,[Väestö 16-18] = null
	  ,[Väestö 19-21] = null
	  ,[Väestö 25-64] = null

	  ,[Maakunta järjestys] = d1.jarjestys_maakunta
	  ,[Sukupuoli järjestys] = d4.jarjestys
	  ,[Äidinkieli järjestys] = 99
      
FROM [dbo].[f_OTV_2_1_R2_22_Peruskoulutiedosto_Oppilaitostason_oppil_ja_opisk] f
LEFT JOIN dbo.d_alueluokitus d1 on d1.id=f.oppilaitoksen_sijaintikunta_id
LEFT JOIN dbo.d_sukupuoli d4 on d4.id=f.sukupuoli_id
WHERE f.ove is not null and d1.maakunta<>''Tuntematon'' and tilastointivuosi<>''2010''
GROUP BY tilastointivuosi,d1.kunta,d1.maakunta,d4.sukupuoli,d1.jarjestys_maakunta,d4.jarjestys,d1.maakunta_SV,d1.maakunta_EN

UNION ALL

--Perusopetus
Select
       Tilastovuosi = f.tilastointivuosi
	  ,[Kunta] = d1.kunta
	  ,[Maakunta] = d1.maakunta
	  ,[Sektori] = ''Perusopetus''
	  ,[Sukupuoli] = d4.sukupuoli
	  ,[Äidinkieli] = null
	  ,[Opetussuunnitelma] = null
	  ,[Koulutuslaji] = null
	  ,[Järjestämistapa] = null
	  ,[Järjestämismuoto] = null
	  ,[Koulutuksen kieli] = null

	  	  --Ruotsi
	  ,[Statistikår] = f.tilastointivuosi
	  ,[Landskap] = d1.maakunta_SV
	  ,[Kön] = d4.sukupuoli_SV

	  --Englanti
	  ,[Statistical year] = f.tilastointivuosi
	  ,[Region] = d1.maakunta_EN
	  ,[Gender] = d4.sukupuoli_EN

	  ,Aloittaneet = sum(f.ov1)
	  ,[Väestö 6] = null
	  ,[Väestö 7] = null
	  ,[Väestö 16-18] = null
	  ,[Väestö 19-21] = null
	  ,[Väestö 25-64] = null

	  ,[Maakunta järjestys] = d1.jarjestys_maakunta
	  ,[Sukupuoli järjestys] = d4.jarjestys
	  ,[Äidinkieli järjestys] = 99
      
FROM [dbo].[f_OTV_2_1_R2_22_Peruskoulutiedosto_Oppilaitostason_oppil_ja_opisk] f
LEFT JOIN dbo.d_alueluokitus d1 on d1.id=f.oppilaitoksen_sijaintikunta_id
LEFT JOIN dbo.d_sukupuoli d4 on d4.id=f.sukupuoli_id
LEFT JOIN dbo.d_oppilaitoksen_taustatiedot d5 on d5.id=f.oppilaitos_id
WHERE aloittaneet is not null and d1.maakunta<>''Tuntematon'' and d5.oppilaitostyyppikoodi in (11,12,19)
GROUP BY tilastointivuosi,d1.kunta,d1.maakunta,d4.sukupuoli,d1.jarjestys_maakunta,d4.jarjestys,d1.maakunta_SV,d1.maakunta_EN,d4.sukupuoli_SV,d4.sukupuoli_EN

UNION ALL


--Lukio
SELECT
	   Tilastovuosi = f.tilv
	  ,[Kunta] = d9.kunta--case d6.koulutuksen_jarjestamismuoto when ''Oppilaitosmuotoinen koulutus'' then d1.kunta when ''Oppisopimuskoulutus'' then d7.kunta else d1.kunta end
	  ,[Maakunta] = d9.maakunta--case d6.koulutuksen_jarjestamismuoto when ''Oppilaitosmuotoinen koulutus'' then d1.maakunta when ''Oppisopimuskoulutus'' then d7.maakunta else d1.maakunta end
	  ,[Sektori] = d2.koulutussektori
	  ,[Sukupuoli] = d4.sukupuoli
	  ,[Äidinkieli] = d11.aidinkieli_versio1
	  ,[Opetussuunnitelma] = d3.nuorten_aikuisten_koulutus
	  ,[Koulutuslaji] = d8.ammatillisen_koulutuksen_koulutuslaji
	  ,[Järjestämistapa] = d5.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus
	  ,[Järjestämismuoto] = d6.koulutuksen_jarjestamismuoto
	  ,[Koulutuksen kieli] = null

	  --Ruotsi
	  ,[Statistikår] = f.tilv
	  ,[Landskap] = d9.maakunta_SV
	  ,[Kön] = d4.sukupuoli_SV

	  --Englanti
	  ,[Statistical year] = f.tilv
	  ,[Region] = d9.maakunta_EN
	  ,[Gender] = d4.sukupuoli_EN

	  ,Aloittaneet = sum(f.aloittaneet)
	  ,[Väestö 6] = null
	  ,[Väestö 7] = null
	  ,[Väestö 16-18] = null
	  ,[Väestö 19-21] = null
	  ,[Väestö 25-64] = null

	  ,[Maakunta järjestys] = d9.jarjestys_maakunta
	  ,[Sukupuoli järjestys] = d4.jarjestys
	  ,[Äidinkieli järjestys] = d11.jarjestys

FROM [dbo].[f_OTV_2_3_Lukiokoulutuksen_ja_ammatillisen_koulutuksen_opiskelijat] f
--LEFT JOIN dbo.d_alueluokitus d1 on d1.id=f.oppilaitos_kunta_id
LEFT JOIN dbo.d_koulutussektori d2 on d2.id=f.koulutussektori_id
LEFT JOIN dbo.d_nuorten_aikuisten_koulutus d3 on d3.id=f.nuorten_aikuisten_koulutus_id
LEFT JOIN dbo.d_sukupuoli d4 on d4.id=f.sukupuoli_id
LEFT JOIN dbo.d_opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus d5 on d5.id=f.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_id
LEFT JOIN dbo.d_koulutuksen_jarjestamismuoto d6 on d6.id=f.koulutuksen_jarjestamismuoto_id
--LEFT JOIN dbo.d_alueluokitus d7 on d7.id=f.yht_koulutuksen_jarjestaja_kunta_id
LEFT JOIN dbo.d_ammatillisen_koulutuksen_koulutuslaji d8 on d8.id=f.ammatillisen_koulutuksen_koulutuslaji_id
LEFT JOIN dbo.d_alueluokitus d9 on d9.id=koulutuksen_kunta_id
LEFT JOIN dbo.d_oppilaitoksen_taustatiedot d10 on d10.id=f.oppilaitos_id 
LEFT JOIN dbo.d_aidinkieli_versio1 d11 on d11.id=f.aidinkieli_versio1_id
where aloittaneet is not null and d9.maakunta<>''Tuntematon'' and d2.koulutussektori=''Lukiokoulutus'' and d10.oppilaitostyyppikoodi in (15,19,63)
group by tilv,d9.kunta,d9.maakunta,d2.koulutussektori,d3.nuorten_aikuisten_koulutus,d4.sukupuoli,d5.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus,d6.koulutuksen_jarjestamismuoto,
d8.ammatillisen_koulutuksen_koulutuslaji,d9.jarjestys_maakunta,d4.jarjestys,d11.aidinkieli_versio1,d11.jarjestys,d9.maakunta_SV,d9.maakunta_EN,d4.sukupuoli_SV,d4.sukupuoli_EN

UNION ALL

--Ammatillinen
SELECT
	   Tilastovuosi = f.tilv
	  ,[Kunta] = d9.kunta--case d6.koulutuksen_jarjestamismuoto when ''Oppilaitosmuotoinen koulutus'' then d1.kunta when ''Oppisopimuskoulutus'' then d7.kunta else d1.kunta end
	  ,[Maakunta] = d9.maakunta--case d6.koulutuksen_jarjestamismuoto when ''Oppilaitosmuotoinen koulutus'' then d1.maakunta when ''Oppisopimuskoulutus'' then d7.maakunta else d1.maakunta end
	  ,[Sektori] = d2.koulutussektori
	  ,[Sukupuoli] = d4.sukupuoli
	  ,[Äidinkieli] = d11.aidinkieli_versio1
	  ,[Opetussuunnitelma] = d3.nuorten_aikuisten_koulutus
	  ,[Koulutuslaji] = d8.ammatillisen_koulutuksen_koulutuslaji
	  ,[Järjestämistapa] = d5.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus
	  ,[Järjestämismuoto] = d6.koulutuksen_jarjestamismuoto
	  ,[Koulutuksen kieli] = null

	  --Ruotsi
	  ,[Statistikår] = f.tilv
	  ,[Landskap] = d9.maakunta_SV
	  ,[Kön] = d4.sukupuoli_SV

	  --Englanti
	  ,[Statistical year] = f.tilv
	  ,[Region] = d9.maakunta_EN
	  ,[Gender] = d4.sukupuoli_EN

	  ,Aloittaneet = sum(f.aloittaneet)
	  ,[Väestö 6] = null
	  ,[Väestö 7] = null
	  ,[Väestö 16-18] = null
	  ,[Väestö 19-21] = null
	  ,[Väestö 25-64] = null

	  ,[Maakunta järjestys] = d9.jarjestys_maakunta
	  ,[Sukupuoli järjestys] = d4.jarjestys
	  ,[Äidinkieli järjestys] = d11.jarjestys

FROM [dbo].[f_OTV_2_3_Lukiokoulutuksen_ja_ammatillisen_koulutuksen_opiskelijat] f
--LEFT JOIN dbo.d_alueluokitus d1 on d1.id=f.oppilaitos_kunta_id
LEFT JOIN dbo.d_koulutussektori d2 on d2.id=f.koulutussektori_id
LEFT JOIN dbo.d_nuorten_aikuisten_koulutus d3 on d3.id=f.nuorten_aikuisten_koulutus_id
LEFT JOIN dbo.d_sukupuoli d4 on d4.id=f.sukupuoli_id
LEFT JOIN dbo.d_opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus d5 on d5.id=f.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_id
LEFT JOIN dbo.d_koulutuksen_jarjestamismuoto d6 on d6.id=f.koulutuksen_jarjestamismuoto_id
--LEFT JOIN dbo.d_alueluokitus d7 on d7.id=f.yht_koulutuksen_jarjestaja_kunta_id
LEFT JOIN dbo.d_ammatillisen_koulutuksen_koulutuslaji d8 on d8.id=f.ammatillisen_koulutuksen_koulutuslaji_id
LEFT JOIN dbo.d_alueluokitus d9 on d9.id=koulutuksen_kunta_id
LEFT JOIN dbo.d_oppilaitoksen_taustatiedot d10 on d10.id=f.oppilaitos_id
LEFT JOIN dbo.d_aidinkieli_versio1 d11 on d11.id=f.aidinkieli_versio1_id
where aloittaneet is not null and d9.maakunta<>''Tuntematon'' and d2.koulutussektori=''Ammatillinen koulutus'' 
group by tilv,d9.kunta,d9.maakunta,d2.koulutussektori,d3.nuorten_aikuisten_koulutus,d4.sukupuoli,d5.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus,d6.koulutuksen_jarjestamismuoto,
d8.ammatillisen_koulutuksen_koulutuslaji,d9.jarjestys_maakunta,d4.jarjestys,d11.aidinkieli_versio1,d11.jarjestys,d9.maakunta_SV,d9.maakunta_EN,d4.sukupuoli_SV,d4.sukupuoli_EN

UNION ALL

--Korkea-aste
Select
       Tilastovuosi = f.tilastointivuosi
	  ,[Kunta] = d1.kunta
	  ,[Maakunta] = d1.maakunta
	  ,[Sektori] = ''Korkeakoulutus''
	  ,[Sukupuoli] = d4.sukupuoli
	  ,[Äidinkieli] = d10.aidinkieli_versio1
	  ,[Opetussuunnitelma] = null
	  ,[Koulutuslaji] = d8.koulutuslaji_okm
	  ,[Järjestämistapa] = null
	  ,[Järjestämismuoto] = null
	  ,[Koulutuksen kieli] = f.koulutuksen_kieli

	  	  --Ruotsi
	  ,[Statistikår] = f.tilastointivuosi
	  ,[Landskap] = d1.maakunta_SV
	  ,[Kön] = d4.sukupuoli_SV

	  --Englanti
	  ,[Statistical year] = f.tilastointivuosi
	  ,[Region] = d1.maakunta_EN
	  ,[Gender] = d4.sukupuoli_EN

	  ,Aloittaneet = sum(f.aloittaneet)
	  ,[Väestö 6] = null
	  ,[Väestö 7] = null
	  ,[Väestö 16-18] = null
	  ,[Väestö 19-21] = null
	  ,[Väestö 25-64] = null

	  ,[Maakunta järjestys] = d1.jarjestys_maakunta
	  ,[Sukupuoli järjestys] = d4.jarjestys
	  ,[Äidinkieli järjestys] = d10.jarjestys
      
FROM [dbo].[f_OTV_2_8_Korkeakouluopiskelijat] f
LEFT JOIN dbo.d_alueluokitus d1 on d1.id=f.oppilaitos_kunta_id
LEFT JOIN dbo.d_koulutussektori d2 on d2.id=f.koulutussektori_id
LEFT JOIN dbo.d_sukupuoli d4 on d4.id=f.sukupuoli_id
LEFT JOIN dbo.d_opiskelumuoto d6 on d6.id=f.opiskelumuoto_id
LEFT JOIN dbo.d_koulutustyyppi d7 on d7.id=f.koulutustyyppi_id
LEFT JOIN dbo.d_koulutuslaji_okm d8 on d8.id=f.koulutuslaji_OKM_id
LEFT JOIN dbo.d_koulutusluokitus d9 on d9.id=f.koulutusluokitus_id
LEFT JOIN dbo.d_aidinkieli_versio1 d10 on d10.id=f.aidinkieli_versio1_id
where aloittaneet is not null and d1.maakunta<>''Tuntematon'' and (d8.koulutuslaji_okm in (''Ammattikorkeakoulututkinto (nuorten koulutus)'' ,''Ammattikorkeakoulututkinto (aikuiskoulutus)'',''Ylempi ammattikorkeakoulututkinto'',''Alempi korkeakoulututkinto'') or (d8.koulutuslaji_okm = ''Ylempi korkeakoulututkinto'' and d9.opintoala1995 in (''Hammaslääketieteell. koulutus'',''Eläinlääketieteell. koulutus'',''Lääketieteellinen koulutus''))) and aineisto=''L''
group by tilastointivuosi,d1.kunta,d1.maakunta,d2.koulutussektori,d4.sukupuoli,d6.opiskelumuoto,d8.koulutuslaji_okm,f.koulutuksen_kieli,d1.jarjestys_maakunta,d4.jarjestys,d10.aidinkieli_versio1,d10.jarjestys,d1.maakunta_SV,d1.maakunta_EN,d4.sukupuoli_SV,d4.sukupuoli_EN

UNION ALL

--Väestötiedot
Select
       Tilastovuosi = f.tilastointivuosi
	  ,[Kunta] = d1.kunta
	  ,[Maakunta] = d1.maakunta
	  ,[Sektori] = null
	  ,[Sukupuoli] = case when ika6_lkm>0 then ''Tuntematon'' else d4.sukupuoli end--case when d4.sukupuoli=''Mies'' and sum(ika7_lkm)>0 then ''Pojat'' when d4.sukupuoli=''Nainen'' and sum(ika7_lkm)>0 then ''Tytöt'' else d4.sukupuoli end
	  ,[Äidinkieli] = case d5.aidinkieli_versio2 when ''saame'' then ''suomi (sis. saame)'' when ''suomi'' then ''suomi (sis. saame)'' else d5.aidinkieli_versio2 end
	  ,[Opetussuunnitelma] = null
	  ,[Koulutuslaji] = null
	  ,[Järjestämistapa] = null
	  ,[Järjestämismuoto] = null
	  ,[Koulutuksen kieli] = null

	  --Ruotsi
	  ,[Statistikår] = f.tilastointivuosi
	  ,[Landskap] = d1.maakunta_SV
	  ,[Kön] = case when ika6_lkm>0 then ''Okänd'' else d4.sukupuoli_SV end

	  --Englanti
	  ,[Statistical year] = f.tilastointivuosi
	  ,[Region] = d1.maakunta_EN
	  ,[Gender] = case when ika6_lkm>0 then ''Unknown'' else d4.sukupuoli_EN end

	  ,Aloittaneet = null
	  ,[Väestö 6] = ika6_lkm
	  ,[Väestö 7] = ika7_lkm
	  ,[Väestö 16-18] = ika16_18_ka
	  ,[Väestö 19-21] = ika19_21_ka
	  ,[Väestö 25-64] = ika25_64_ka

	  ,[Maakunta järjestys] = d1.jarjestys_maakunta
	  ,[Sukupuoli järjestys] = d4.jarjestys
	  ,[Äidinkieli järjestys] = case d5.aidinkieli_versio2 when ''saame'' then 1 when ''suomi'' then 1 when ''ruotsi'' then 2 when ''muut kielet ja tuntematon'' then 3 else 99998 end

      
FROM [dbo].[f_OTV_4_9_Vaestorakenne_kunnittain] f
LEFT JOIN dbo.d_alueluokitus d1 on d1.id=f.kotikunta_id
LEFT JOIN dbo.d_sukupuoli d4 on d4.id=f.sukupuoli_id
LEFT JOIN dbo.d_aidinkieli_versio2 d5 on d5.id=f.aidinkieli_versio2_id
where (f.ika6_lkm<>0 or f.ika7_lkm<>0 or f.ika16_18_ka<>0 or ika19_21_ka<>0 or ika25_64_ka<>0) and 
d1.maakunta<>''Tuntematon''
/*group by tilastointivuosi,d1.kunta,d1.maakunta,d4.sukupuoli,d1.jarjestys_maakunta,d4.jarjestys,
(case d5.aidinkieli_versio2 when ''saame'' then ''suomi (sis. saame)'' when ''suomi'' then ''suomi (sis. saame)'' else d5.aidinkieli_versio2 end),
(case d5.aidinkieli_versio2 when ''saame'' then 1 when ''suomi'' then 1 when ''ruotsi'' then 2 when ''muut kielet ja tuntematon'' then 3 else 99998 end)*/

























' 
GO
/****** Object:  View [dbo].[v_f_tab_indikaattorit_oppivelvolliset]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_indikaattorit_oppivelvolliset]'))
EXEC dbo.sp_executesql @statement = N'















CREATE VIEW [dbo].[v_f_tab_indikaattorit_oppivelvolliset] AS

Select 
[tilastointivuosi] as Tilastovuosi2
,case d9.sukupuoli when ''Mies'' then ''Pojat'' when ''Nainen'' then ''Tytöt'' else ''Tuntematon'' end as "Sukupuoli"
--jarjestysmuuttujat
,d9.jarjestys
--ruotsi
,[tilastointivuosi] as Statistikår2
,case d9.sukupuoli_SV when ''Man'' then ''Pojkar'' when ''Kvinna'' then ''Flickor'' else ''Information saknas'' end as "Kön"
--englanti
,[tilastointivuosi] as "Statistical year2"
,case d9.sukupuoli_EN when ''Male'' then ''Boys'' when ''Female'' then ''Girls'' else ''Missing data'' end as "Gender"
--Lukumäärämuuttujat
,[opiskelijat] as opisk2
,[tutkinnot] as tutk2
,[tod]
,[ilmtod]
,[kelaim]
,[tutkt]
,[suor10]
,[opiskelijat_1_9_luokka]
,[opiskelijat_1_10_luokka]
,[tutkinnot_9_luokka]

FROM dbo.f_OTV_2_1_R2_22_Peruskoulutiedosto_Oppilaitostason_oppil_ja_opisk

	JOIN d_sukupuoli d9 ON d9.id = sukupuoli_id

WHERE [tilastointivuosi] <> ''2010''




' 
GO
/****** Object:  View [dbo].[v_f_tab_indikaattorit_suoritusika_aika]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_indikaattorit_suoritusika_aika]'))
EXEC dbo.sp_executesql @statement = N'









CREATE VIEW [dbo].[v_f_tab_indikaattorit_suoritusika_aika] AS

Select 
[Tilastovuosi]
,[Statistical year]
,[Statistikår]
,d1.aineisto as Aineisto
,d1b.aineisto as Aineisto_OTV
,d1b.kaikkien_asteiden_koulutus as ''Kaikkien asteiden koulutus''
,d1b.tilastointivuosi as OTV_Tilv
,d2.aidinkieli_versio1 as Äidinkieli
,d4.sukupuoli as Sukupuoli
,d5b.vuosiselite as Syntymävuosi
,d5c.kuukausiselite as Syntymäkuukausi
,d7.koulutustyyppi as Koulutustyyppi
,d9.oppilaitos as Oppilaitos
,d9.opetuskieli as Opetuskieli
,d9.oppilaitoksen_omistajatyyppi as "Oppil. omistajatyyppi"
,d9.oppilaitostyyppi as Oppilaitostyyppi
,d9b.koulutuksen_jarjestaja as "Koulutuksen järjestäjä"
,d9b.koulutuksen_jarjestajan_omistajatyyppi as "Koul. järjestäjän omistajatyyppi"
,d10.lahde as Lähde
,d19.koulutussektori as Koulutussektori
,d20.opetushallinnon_koulutus as Hallinnonala
,d21.koulutusaste2002 as Koulutusaste
,d21.koulutusala2002 as "Koulutusala"
,d21.koulutusala2002 as "Koulutusala (02 luokitus)"
,d21.opintoala1995 as "Koulutusala (95 luokitus)"
,d21.opintoala2002 as Opintoala
,d21.koulutus as Koulutusnimike
,d21b.koulutuslaji_okm as Koulutuslaji
,d21b.koulutuslaji_okm2 as Koulutuslaji2
,d22b.avi as "Koul. järjestäjän AVI"
,d22b.ely as "Koul. järjestäjän ELY"
,d22b.maakunta as "Koul. järjestäjän maakunta"
,d22b.kielisuhde as "Koul. järjestäjän kunnan kielisuhde"
,d22b.kunta as "Koul. järjestäjän kunta"
,d22c.avi as "Oppilaitoksen AVI"
,d22c.ely as "Oppilaitoksen ELY"
,d22c.maakunta as "Oppilaitoksen maakunta"
,d22c.kielisuhde as "Oppil. kunnan kielisuhde"
,d22c.kunta as "Oppilaitoksen kunta"
,d23.vuosiselite as "Kirjoihintulovuosi"
,d23b.lukukausiselite as "Kirjoihintulokausi"
,d24f.vuosiselite as "Kirjoihintulovuosi (korkeakoulu)"
,d24f2.lukukausiselite as "Kirjoihintulokausi (korkeakoulu)"
,d37.vuosiselite as "Tutkinnon suoritusvuosi"
,d38.lukukausiselite as "Tutk. suorituslukukausi"
,d39.kuukausiselite as "Tutk. suorituskuukausi"
,d40.tutkinnon_toteuma as "Tutkinnon toteuma"
,d41.ammatillisen_koulutuksen_koulutuslaji as "Tutkintotyyppi"
,d42.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus as "Järjestämistapa"
,d43.nuorten_aikuisten_koulutus as "Nuorten/aikuisten koulutus"
,d44.koulutuksen_jarjestamismuoto as "Järjestämismuoto"
--Ruotsinkielinen käännös
,d2.aidinkieli_versio1_SV as Modersmål
,d4.sukupuoli_SV as Kön
,d7.koulutustyyppi_SV as "Typ av utbildning"
,d9.oppilaitos_SV as Läroanstalt
,d9.opetuskieli_SV as Undervisningsspråk
,d9.oppilaitoksen_omistajatyyppi_SV as "Läroanstaltens ägartyp"
,d9.oppilaitostyyppi_SV as Läroanstaltstyp
,d9b.koulutuksen_jarjestaja_SV as "Utbildningsanordnare"
,d9b.koulutuksen_jarjestajan_omistajatyyppi_SV as "Utbildningsanordnarens ägartyp"
,d19.koulutussektori_SV as Utbildningssektor
,d20.opetushallinnon_koulutus_SV as Förvaltningsområde
,d21.koulutusaste2002_SV as "Utbildningsnivå (2002)"
,d21.koulutusala2002_SV as "Utbildningsområde (2002)"
,d21.opintoala1995_SV as "Utbildningsområde (1995)"
,d21.opintoala2002_SV as Studieområde
,d21.koulutus_SV as Utbildningsbenämning
,d21b.koulutuslaji_okm_SV as Examensslag
,d21b.koulutuslaji_okm2_SV as Examensslag2
--,d22b.avi_SV as "Koul. järjestäjän AVISV"
--,d22b.ely_SV as "Koul. järjestäjän ELYSV"
--,d22b.maakunta_SV as "Koul. järjestäjän maakuntaSV"
--,d22b.kielisuhde_SV as "Koul. järjestäjän kunnan kielisuhdeSV"
--,d22b.kunta_SV as "Koul. järjestäjän kuntaSV"
--,d22c.avi_SV as "Oppilaitoksen AVISV"
--,d22c.ely_SV as "Oppilaitoksen ELYSV"
--,d22c.maakunta_SV as "Oppilaitoksen maakuntaSV"
--,d22c.kielisuhde_SV as "Oppil. kunnan kielisuhdeSV"
--,d22c.kunta_SV as "Oppilaitoksen kuntaSV"
--,d23.vuosiselite_SV as "KirjoihintulovuosiSV"
--,d23b.lukukausiselite_SV as "KirjoihintulokausiSV"
--,d24f.vuosiselite_SV as "Kirjoihintulovuosi (korkeakoulu)SV"
--,d24f2.lukukausiselite_SV as "Kirjoihintulokausi (korkeakoulu)SV"
--,d37.vuosiselite_SV as "Tutkinnon suoritusvuosiSV"
--,d38.lukukausiselite_SV as "Tutk. suorituslukukausiSV"
--,d39.kuukausiselite_SV as "Tutk. suorituskuukausiSV"
--,d40.tutkinnon_toteuma_SV as "Tutkinnon toteumaSV"
,d41.ammatillisen_koulutuksen_koulutuslaji_SV as "Typ av examen"
,d42.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_SV as "Sättet på vilket utbildn. ordnas"
,d43.nuorten_aikuisten_koulutus_SV as "Ungdoms-/vuxenutbildning"
,d44.koulutuksen_jarjestamismuoto_SV as "Formen i vilken utbildn. ordnas"
--Englanninkielinen käännös
,d2.aidinkieli_versio1_EN as "Mother tongue"
,d4.sukupuoli_EN as Gender
--,d5b.vuosiselite_EN as SyntymävuosiEN
--,d5c.kuukausiselite_EN as SyntymäkuukausiEN
,d7.koulutustyyppi_EN as "Education type"
,d9.oppilaitos_EN as "Educational institution"
,d9.opetuskieli_EN as "Language of education"
,d9.oppilaitoksen_omistajatyyppi_EN as "Type of ed. institution owner"
,d9.oppilaitostyyppi_EN as "Type of ed. institution"
,d9b.koulutuksen_jarjestaja_EN as "Education provider"
,d9b.koulutuksen_jarjestajan_omistajatyyppi_EN as "Type of ed. provider owner"
,d19.koulutussektori_EN as "Sector of education"
,d20.opetushallinnon_koulutus_EN as "Administrative sector"
,d21.koulutusaste2002_EN as "Level of education (2002)"
,d21.koulutusala2002_EN as "Field of education (2002)"
,d21.opintoala1995_EN as "Field of education (1995)"
,d21.opintoala2002_EN as "Subfield of education (2002)"
,d21.koulutus_EN as "Name of education"
,d21b.koulutuslaji_okm_EN as "Form of education"
,d21b.koulutuslaji_okm2_EN as "Form of education2"
--,d22b.avi_EN as "Koul. järjestäjän AVI"
--,d22b.ely_EN as "Koul. järjestäjän ELY"
--,d22b.maakunta_EN as "Koul. järjestäjän maakunta"
--,d22b.kielisuhde_EN as "Koul. järjestäjän kunnan kielisuhde"
--,d22b.kunta_EN as "Koul. järjestäjän kunta"
--,d22c.avi_EN as "Oppilaitoksen AVI"
--,d22c.ely_EN as "Oppilaitoksen ELY"
--,d22c.maakunta_EN as "Oppilaitoksen maakunta"
--,d22c.kielisuhde_EN as "Oppil. kunnan kielisuhde"
--,d22c.kunta_EN as "Oppilaitoksen kunta"
--,d23.vuosiselite_EN as "Kirjoihintulovuosi"
--,d23b.lukukausiselite_EN as "Kirjoihintulokausi"
--,d24f.vuosiselite_EN as "Kirjoihintulovuosi (korkeakoulu)"
--,d24f2.lukukausiselite_EN as "Kirjoihintulokausi (korkeakoulu)"
--,d37.vuosiselite_EN as "Tutkinnon suoritusvuosi"
--,d38.lukukausiselite_EN as "Tutk. suorituslukukausi"
--,d39.kuukausiselite_EN as "Tutk. suorituskuukausi"
--,d40.tutkinnon_toteuma_EN as "Tutkinnon toteuma"
,d41.ammatillisen_koulutuksen_koulutuslaji_EN as "Qualification type"
,d42.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_EN as "Method of voc. education"
,d43.nuorten_aikuisten_koulutus_EN as "Youth/adult education"
,d44.koulutuksen_jarjestamismuoto_EN as "Form of voc. education"
--Järjestysmuuttujat
,d1b.jarjestys as aineisto_otv_jarj
,d2.jarjestys as jarj_aidinkieli
,d5b.jarjestys as jarj_syntv
,d7.jarjestys as jarj_koultyyppi
,d9.jarjestys_oppilaitos
,d9.jarjestys_opetuskieli
,d9.jarjestys_omistajatyyppi
,d9.jarjestys_oppilaitostyyppi
,d19.jarjestys as jarj_koulsek
,d20.jarjestys as jarj_hallinnonala
,d21.jarjestys_koulutusaste2002
,d21.jarjestys_koulutusala2002
,d21.jarjestys_opintoala1995
,d21.jarjestys_opintoala2002
,d21.jarjestys as jarj_koulnimike
,d21b.jarjestys as jarj_koullaji
,d21b.jarjestys2 as jarj_koullaji2
,d22b.jarjestys_avi as jarjestys_avi2
,d22b.jarjestys_ely as jarjestys_ely2
,d22b.jarjestys_maakunta as jarjestys_maakunta2
,d22b.jarjestys_kielisuhde as jarjestys_kielisuhde2
,d22b.jarjestys as jarj_kunta2
,d22c.jarjestys_avi as jarjestys_avi3
,d22c.jarjestys_ely as jarjestys_ely3
,d22c.jarjestys_maakunta as jarjestys_maakunta3
,d22c.jarjestys_kielisuhde as jarjestys_kielisuhde3
,d22c.jarjestys as jarj_kunta3
,d23b.jarjestys as jarj_lukukausi
,d24f2.jarjestys as jarj_lukukausi_kk
,d39.jarjestys as jarj_suor_kk
,d40.jarjestys as jarj_tutktot
,d41.jarjestys as jarj_tutktyyppi
,d42.jarjestys as jarj_jarjtapa
,d43.jarjestys as jarj_nuoretaikuiset
,d44.jarjestys as jarj_jarjmuoto
--Koodimuuttujat
,d1.aineisto_koodi
,d1b.aineisto_koodi as ainesto_koodi_otv
,d2.aidinkieli_versio1_koodi as aidinkieli_koodi
,d5c.kuukausi as syntk
,d7.koulutustyyppi_koodi as ''Koodit Koulutustyyppi''
,d9.oppilaitoskoodi as ''Koodit Oppilaitos''
,d9b.koulutuksen_jarjestajan_omistajatyyppikoodi as ''Koodit Koul. järjestäjän omistajatyyppi''
,d9b.koulutuksen_jarjestajakoodi as ''Koodit Koulutuksen järjestäjä''
,d10.lahde_koodi
,d21.koulutusaste2002_koodi as ''Koodit Koulutusaste''
,d21.koulutusala2002_koodi as ''Koodit Koulutusala (02)''
,d21.opintoala1995_koodi as ''Koodit Koulutusala (95)''
,d21.opintoala2002_koodi as ''Koodit Opintoala (02)''
,d21.koulutus_koodi as ''Koodit Koulutusnimike''
,d22b.maakunta_koodi as ''Koodit Koul. järj. maakunta''
,d22b.kunta_koodi as ''Koodit Koul. järj. kunta''
,d22c.maakunta_koodi as ''Koodit Oppil. maakunta''
,d22c.kunta_koodi as ''Koodit Oppil. kunta''
,d23.vuosi as alvv
,d23b.lukukausi as alkk
,d24f.vuosi as alvv_kk
,d24f2.lukukausi as alkk_kk
,d37.vuosi as suorv
,d38.lukukausi as suor_lk
,d39.kuukausi as suor_kk
,d21.iscle2011_koodi as "Koodit Koulutusaste, taso 1"
,d21.Koulutusaste_taso2_koodi as "Koodit Koulutusaste, taso 2"
,d21.iscfibroad2013_koodi as "Koodit Koulutusala, taso 1"
,d21.iscfinarrow2013_koodi as "Koodit Koulutusala, taso 2"
,d21.iscfi2013_koodi as "Koodit Koulutusala, taso 3"
,d21.OKM_ohjauksen_ala_koodi as "Koodit OKM ohjauksen ala, korkeak."
--isced
,d21.iscle2011 as "Koulutusaste, taso 1"
,d21.Koulutusaste_taso2 as "Koulutusaste, taso 2"
,d21.iscfibroad2013 as "Koulutusala, taso 1"
,d21.iscfinarrow2013 as "Koulutusala, taso 2"
,d21.iscfi2013 as "Koulutusala, taso 3"
,d21.OKM_ohjauksen_ala as "OKM ohjauksen ala, korkeak."
,d21.iscle2011_SV as "Utbildn.nivå, nivå 1"
,d21.Koulutusaste_taso2_SV as "Utbildn.nivå, nivå 2"
,d21.iscfibroad2013_SV as "Utbildn.område, nivå 1"
,d21.iscfinarrow2013_SV as "Utbildn.område, nivå 2"
,d21.iscfi2013_SV as "Utbildn.område, nivå 3"
,d21.OKM_ohjauksen_ala_SV as "UKM-styrningsområde, högskolor"
,d21.iscle2011_EN as "Level of education, tier 1"
,d21.Koulutusaste_taso2_EN as "Level of education, tier 2"
,d21.iscfibroad2013_EN as "Field of education, tier 1"
,d21.iscfinarrow2013_EN as "Field of education, tier 2"
,d21.iscfi2013_EN as "Field of education, tier 3"
,d21.OKM_ohjauksen_ala_EN as "Field of ed., HE steering"
,d21.jarjestys_iscle2011 as jarj_isced_koulast1
,d21.jarjestys_Koulutusaste_taso2 as jarj_isced_koulast2
,d21.jarjestys_iscfibroad2013 as jarj_isced_koulala1
,d21.jarjestys_iscfinarrow2013 as jarj_isced_koulala2
,d21.jarjestys_iscfi2013 as jarj_isced_koulala3
,d21.jarjestys_OKM_ohjauksen_ala as jarj_isced_okmohjaus1
--Lukumäärämuuttujat
,[Tutk3]
,[suoritusika2]
,[jarjestys_suoritusika]
,[suoritusaika2]
,[jarjestys_suoritusaika]
,[suoritusaika_kk]
,[jarjestys_suoritusaika_kk]

FROM (
SELECT [tilastointivuosi] as Tilastovuosi
	  ,[tilastointivuosi] as "Statistical year"
	  ,[tilastointivuosi] as "Statistikår"
	  ,aineisto_id
	  ,aineisto_OTV_id
	  ,aidinkieli_versio1_id
	  ,sukupuoli_id
	  ,syntymavuosi_id
	  ,syntymakuukausi_id
	  ,koulutustyyppi_id
	  ,oppilaitos_id
	  ,koulutuksen_jarjestaja_id
	  ,lahde_id
	  ,koulutussektori_id
	  ,opetushallinnon_koulutus_id
	  ,koulutusluokitus_id
	  ,koulutuslaji_OKM_id
	  ,koulutuksen_jarjestaja_kunta_id
	  ,oppilaitos_kunta_id
	  ,kirjoihintulovuosi_id
	  ,kirjoihintulokausi_id
	  ,kirjoihintulovuosi_korkeakoulu_id
	  ,kirjoihintulokausi_korkeakoulu_id
	  ,tutkinnon_suoritusvuosi_id
	  ,tutkinnon_suorituslukukausi_id = ''-1''
	  ,tutkinnon_suorituskuukausi_id
	  ,tutkinnon_toteuma_id = ''-1''
	  ,ammatillisen_koulutuksen_koulutuslaji_id = ''-1''
	  ,opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_id = ''-1''
	  ,nuorten_aikuisten_koulutus_id = ''-1''
	  ,koulutuksen_jarjestamismuoto_id = ''-1''
	  ,[lukumaara] as Tutk3
	  ,[suoritusika] as suoritusika2
	  ,[jarjestys_suoritusika]
	  ,[suoritusaika] as suoritusaika2
	  ,[jarjestys_suoritusaika]
	  ,[suoritusaika_kk]
	  ,[jarjestys_suoritusaika_kk]
  FROM [dbo].[f_OTV_3_4_Korkeakoulututkinnon_suorittaneiden_mediaani_iat_ja_tutkinnon_suorittamiseen_kuluneet_mediaaniajat]

UNION ALL
SELECT [tilastointivuosi] as Tilastovuosi
	  ,[tilastointivuosi] as "Statistical year"
	  ,[tilastointivuosi] as "Statistikår"
	  ,aineisto_id
	  ,aineisto_OTV_id
	  ,aidinkieli_versio1_id
	  ,sukupuoli_id
	  ,syntymavuosi_id
	  ,syntymakuukausi_id
	  ,koulutustyyppi_id = ''-1''
	  ,oppilaitos_id
	  ,koulutuksen_jarjestaja_id
	  ,lahde_id
	  ,koulutussektori_id
	  ,opetushallinnon_koulutus_id
	  ,koulutusluokitus_id
	  ,koulutuslaji_OKM_id
	  ,koulutuksen_jarjestaja_kunta_id
	  ,oppilaitos_kunta_id
	  ,kirjoihintulovuosi_id
	  ,kirjoihintulokausi_id
	  ,kirjoihintulovuosi_korkeakoulu_id = ''-1''
	  ,kirjoihintulokausi_korkeakoulu_id = ''-1''
	  ,tutkinnon_suoritusvuosi_id
	  ,tutkinnon_suorituslukukausi_id = ''-1''
	  ,tutkinnon_suorituskuukausi_id
	  ,tutkinnon_toteuma_id
	  ,ammatillisen_koulutuksen_koulutuslaji_id
	  ,opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_id
	  ,nuorten_aikuisten_koulutus_id
	  ,koulutuksen_jarjestamismuoto_id
	  ,[lukumaara] as Tutk3
	  ,[suoritusika] as suoritusika2
	  ,[jarjestys_suoritusika]
	  ,[suoritusaika] as suoritusaika2
	  ,[jarjestys_suoritusaika]
	  ,[suoritusaika_kk] = NULL
	  ,[jarjestys_suoritusaika_kk] = NULL
  FROM [dbo].[f_OTV_3_15_Lukio_ja_ammatillisen_koulutuksen_tutkintojen_mediaani_iat]

  ) f
	INNER JOIN [dbo].d_aineisto d1 ON d1.id = f.aineisto_id
	INNER JOIN [dbo].d_aineisto_OTV d1b ON d1b.id = f.aineisto_OTV_id
	INNER JOIN [dbo].d_aidinkieli_versio1 d2 ON d2.id = f.aidinkieli_versio1_id
	INNER JOIN [dbo].d_sukupuoli d4 ON d4.id = f.sukupuoli_id
	INNER JOIN [dbo].d_kausi d5b ON d5b.kausi_id = f.syntymavuosi_id
	INNER JOIN [dbo].d_kausi d5c ON d5c.kausi_id = f.syntymakuukausi_id
	INNER JOIN [dbo].d_koulutustyyppi d7 ON d7.id = f.koulutustyyppi_id
	INNER JOIN [dbo].d_oppilaitoksen_taustatiedot d9 ON d9.id = f.oppilaitos_id
	INNER JOIN [dbo].d_oppilaitoksen_taustatiedot d9b ON d9b.id = f.koulutuksen_jarjestaja_id
	INNER JOIN [dbo].d_lahde d10 ON d10.id = f.lahde_id
	INNER JOIN [dbo].d_koulutussektori d19 ON d19.id = f.koulutussektori_id
	INNER JOIN [dbo].d_opetushallinnon_koulutus d20 ON d20.id = f.opetushallinnon_koulutus_id
	INNER JOIN [dbo].d_koulutusluokitus d21 ON d21.id = f.koulutusluokitus_id
	INNER JOIN [dbo].d_koulutuslaji_okm d21b ON d21b.id = f.koulutuslaji_OKM_id
	INNER JOIN [dbo].d_alueluokitus d22b ON d22b.id = f.koulutuksen_jarjestaja_kunta_id
	INNER JOIN [dbo].d_alueluokitus d22c ON d22c.id = f.oppilaitos_kunta_id
	INNER JOIN [dbo].d_kausi d23 ON d23.kausi_id = f.kirjoihintulovuosi_id
	INNER JOIN [dbo].d_kausi d23b ON d23b.kausi_id = f.kirjoihintulokausi_id
	INNER JOIN [dbo].d_kausi d24f ON d24f.kausi_id = f.kirjoihintulovuosi_korkeakoulu_id
	INNER JOIN [dbo].d_kausi d24f2 ON d24f2.kausi_id = f.kirjoihintulokausi_korkeakoulu_id
	INNER JOIN [dbo].d_kausi d37 ON d37.kausi_id = f.tutkinnon_suoritusvuosi_id
	INNER JOIN [dbo].d_kausi d38 ON d38.kausi_id = f.tutkinnon_suorituslukukausi_id
	INNER JOIN [dbo].d_kausi d39 ON d39.kausi_id = f.tutkinnon_suorituskuukausi_id
	INNER JOIN [dbo].d_tutkinnon_toteuma d40 ON d40.id = f.tutkinnon_toteuma_id
	INNER JOIN [dbo].d_ammatillisen_koulutuksen_koulutuslaji d41 ON d41.id = f.ammatillisen_koulutuksen_koulutuslaji_id
	INNER JOIN [dbo].d_opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus d42 ON d42.id = f.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_id
	INNER JOIN [dbo].d_nuorten_aikuisten_koulutus d43 ON d43.id = f.nuorten_aikuisten_koulutus_id
	INNER JOIN [dbo].d_koulutuksen_jarjestamismuoto d44 ON d44.id = f.koulutuksen_jarjestamismuoto_id
WHERE d9.oppilaitoskoodi <> ''02557'' AND d9.oppilaitoskoodi <> ''10031'' AND d9.oppilaitoskoodi <> ''02358'' AND suoritusika2 <> ''-1'' AND suoritusaika2 <> ''-1'' AND (NOT(d10.lahde_koodi in (''21'',''22'',''23'') AND Tilastovuosi = 2010))












' 
GO
/****** Object:  View [dbo].[v_f_tab_indikaattorit_vapaa_sivistystyö_väestö]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_indikaattorit_vapaa_sivistystyö_väestö]'))
EXEC dbo.sp_executesql @statement = N'












CREATE view [dbo].[v_f_tab_indikaattorit_vapaa_sivistystyö_väestö] as


--opetustunnit
Select
	  --Aika
      [Tilastovuosi] = f.tilastointivuosi

	  --Henkilö
	  ,[Maakunta] = d4.maakunta
	  ,[Kunta] = d4.kunta
	  
	  --Mittarit
	  ,Opetustunnit2 = f.[Opetustuntien lukumäärä]
	  ,Osallistuneet2 = f.[Osallistuneiden lukumäärä]
	  ,yli25v2 = null
	 
	  --Ruotsi
	  ,[Statistikår] = f.tilastointivuosi
	  ,[Landskap] = d4.maakunta_SV
	  ,[Kommun] = d4.kunta_SV
	  
	  --Englanti
	  ,[Statistical year] = f.tilastointivuosi
	  ,[Region] = d4.maakunta_EN
	  ,[Municipality] = d4.kunta_EN
	  
	  --Järjestys
	  ,[Maakunta jarj] = d4.jarjestys_maakunta
	  

FROM [dbo].[f_TJK_2_11_tutkintoon_johtamaton_koulutus] f
left join VipunenTK.dbo.d_opetustuntien_sisalto_ja_tavoiteluokitus d2 on d2.id=f.opetustunti_id
left join VipunenTK.dbo.d_alueluokitus d4 on d4.id=f.oppilaitoksen_sijaintikunta_id
where d2.Koulutustyyppi=''Vapaana sivistystyönä järjestetty koulutus''

UNION ALL

Select
	  --Aika
      Tilastovuosi = f.tilastointivuosi

	  --Henkilö
	  ,[Oppilaitoksen maakunta] = d4.maakunta
	  ,[Oppilaitoksen kunta] = d4.kunta
	  
	  --Mittarit
	  ,Opetustunnit2 = null
	  ,Osallistuneet2 = null
	  ,yli25v2 = sum(ika25_100_lkm)+sum(lkm_100v_ja_vanh)
	 
	  --Ruotsi
	  ,Statistikår = f.tilastointivuosi
	  ,[Läroanstaltens landskap] = d4.maakunta_SV
	  ,[Läroanstaltens kommun] = d4.kunta_SV
	  
	  --Englanti
	  ,[Statistical year] = f.tilastointivuosi
	  ,[Region of the institution ] = d4.maakunta_EN
	  ,[Municipality of the institution] = d4.kunta_EN
	  
	  --Järjestys
	  ,[Maakunta jarj] = d4.jarjestys_maakunta
	  

FROM [dbo].[f_OTV_4_9_Vaestorakenne_kunnittain] f
left join VipunenTK.dbo.d_alueluokitus d4 on d4.id=f.kotikunta_id
group by f.tilastointivuosi,d4.maakunta,d4.maakunta_SV,d4.maakunta_EN,d4.kunta,d4.kunta_SV,d4.kunta_EN,d4.jarjestys_maakunta





























' 
GO
/****** Object:  View [dbo].[v_f_tab_keskeytaneet]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_keskeytaneet]'))
EXEC dbo.sp_executesql @statement = N'








CREATE VIEW [dbo].[v_f_tab_keskeytaneet] AS

Select
[opiskelijat] AS lkm_int,
[tilastovuosi] AS Tilastovuosi
,d1.aineisto AS Aineisto
,d2.lahde AS Lähde
,d3.sukupuoli AS Sukupuoli
,d4.aidinkieli_versio1 AS Äidinkieli
,d5.ika AS Ikä
,d6.ika AS Ikäryhmä
,d7.kunta AS Asuinkunta
,d7.maakunta AS Asuinmaakunta
,d7.avi AS ''Asuinalueen AVI''
,d7.ely AS ''Asuinalueen ELY''
,d8.kansalaisuus_versio1 AS Kansalaisuus
,d9.eumaa AS ''EU-maan kansalainen''
,d10.etamaa AS ''ETA-maan kansalainen''
,d11.pohjoismaa AS ''Pohjoismaan kansalainen''
,d12.vuosiselite AS Aloitusvuosi
,d14.opiskelijan_olo AS Kirjoillaolo
,d15.oppilaitos as "Oppilaitos"
,d15.oppilaitostyyppi as "Oppilaitostyyppi"
,d15.opetuskieli as "Opetuskieli"
,d15.oppilaitoksen_omistajatyyppi as "Oppil. omistajatyyppi"
,d15.koulutuksen_jarjestaja as "Koulutuksen järjestäjä"
,d15.koulutuksen_jarjestajan_kieli as "Koul. järjestäjän kieli"
,d16.koulutus AS Koulutusnimike
,d16.koulutusala2002 AS Koulutusala
,d16.koulutusala2002 AS "Koulutusala (02 luokitus)"
,d16.opintoala1995 AS "Koulutusala (95 luokitus)"
,d16.opintoala2002 AS Opintoala
,Case when d16.koulutusaste2002_koodi in (''63'',''72'')
			then ''Alempi ja ylempi korkeakoulututkinto''
			else d16.koulutusaste2002 end AS Koulutusaste 
,d17.koulutuksen_kieli_versio1 AS ''Koulutuksen kieli''
,d18.kunta AS ''Koulutuksen kunta''
,d18.maakunta AS ''Koulutuksen maakunta''
,d18.avi AS "Koulutuksen AVI-alue"
,d18.ely AS "Koulutuksen ELY-alue"
,d19.opetushallinnon_koulutus AS Hallinnonala
,d20.koulutustyyppi AS Koulutustyyppi
,d21.maakunta AS ''Tutk. suoritusmaakunta''
,d22.koulutuksen_jarjestaja AS ''Tutkinnon koul. järjestäjä''
,d22.koulutuksen_jarjestajan_omistajatyyppi AS ''Tutkinnon koul. järjestäjän omistajatyyppi''
,d22.koulutuksen_jarjestajan_kieli ''Tutkinnon koul. järjestäjän kieli''
,d22.koulutuksen_jarjestajan_sijaintikunta AS ''Tutkinnon koul. järjestäjän sijaintikunta''
,d23.oppilaitos AS ''Tutkinnon oppilaitos''
,d23.oppilaitostyyppi as "Tutkinnon oppilaitostyyppi"
,d23.opetuskieli as "Tutkinnon opetuskieli"
,d23.oppilaitoksen_omistajatyyppi as "Tutkinnon oppil. omistajatyyppi"
,d24.koulutus AS ''Tutkinnon koulutusnimike''
,d24.koulutusala2002 AS ''Tutkinnon koulutusala''
,d24.koulutusala2002 AS ''Tutkinnon koulutusala (02 luokitus)''
,d24.opintoala1995 AS "Tutkinnon koulutusala (95 luokitus)"
,d24.opintoala2002 AS ''Tutkinnon opintoala''
,d24.koulutusaste2002 AS ''Tutkinnon koulutusaste''
,d25.koulutustyyppi AS ''Tutkinnon koulutustyyppi''
,d26.maakunta AS ''Seur. vuoden koul. maakunta''
,d27.koulutuksen_jarjestaja AS ''Seur. vuoden koul. järjestäjä''
,d27.koulutuksen_jarjestajan_omistajatyyppi AS ''Seur. vuoden koul. järjestäjän omistajatyyppi''
,d27.koulutuksen_jarjestajan_kieli ''Seur. vuoden koul. järjestäjän kieli''
,d27.koulutuksen_jarjestajan_sijaintikunta AS ''Seur. vuoden koul. järjestäjän sijaintikunta''
,d28.oppilaitos AS ''Seur. vuoden oppilaitos''
,d28.oppilaitostyyppi as "Seur. vuoden oppilaitostyyppi"
,d28.opetuskieli as "Seur. vuoden opetuskieli"
,d28.oppilaitoksen_omistajatyyppi as "Seur. vuoden oppil. omistajatyyppi"
,d29.koulutus AS ''Seur. vuoden koulutusnimike''
,d29.koulutusala2002 AS ''Seur. vuoden koulutusala''
,d29.koulutusala2002 AS ''Seur. vuoden koulutusala (02 luokitus)''
,d29.opintoala1995 AS "Seur. vuoden koulutusala (95 luokitus)"
,d29.opintoala2002 AS ''Seur. vuoden opintoala''
,d29.koulutusaste2002 AS ''Seur. vuoden koulutusaste''
,d30.koulutustyyppi  AS ''Seur. vuoden koulutustyyppi''
,d31.paaasiallinen_toiminta_versio2 AS ''Pääasiallinen toiminta''
,d32.ammattiasema AS Ammattiasema

,d33.opintojen_kulku_koulutusasteen_2002_mukaan AS ''Opintojen kulku 1a''
,d34.opintojen_kulku_koulutusasteen_2002_mukaan AS ''Opintojen kulku 1b''
,d35.tutkinto_alkuperaisella_koulutusasteella_2002 AS ''Tutk. suor. alkup. koul.asteella''
,d36.tutkinto_muulla_koulutusasteella_2002 AS ''Tutk. suor. muulla koul.asteella''
,d37.jatkaa_opiskelua_alkuperaisella_koulutusasteella_2002 AS ''Jatkaa opisk. alkup. koul.asteella''
,d38.jatkaa_opiskelua_muulla_koulutusasteella_2002 AS ''Jatkaa opisk. muulla koul.asteella''

,d39.opintojen_kulku_koulutusalan_2002_mukaan AS ''Opintojen kulku 2a''
,d40.opintojen_kulku_koulutusalan_2002_mukaan AS ''Opintojen kulku 2b''
,d41.tutkinto_alkuperaisella_koulutusalalla_2002 AS ''Tutk. suor. alkup. koul.alalla''
,d42.tutkinto_muulla_koulutusalalla_2002 AS ''Tutk. suor. muulla koul.alalla''
,d43.jatkaa_opiskelua_alkuperaisella_koulutusalalla_2002 AS ''Jatkaa opisk. alkup. koul.alalla''
,d44.jatkaa_opiskelua_muulla_koulutusalalla_2002 AS ''Jatkaa opisk. muulla koul.alalla''

,d45.opintojen_kulku_opintoala_2002_mukaan AS ''Opintojen kulku 3a''
,d46.opintojen_kulku_opintoala_2002_mukaan AS ''Opintojen kulku 3b''
,d47.tutkinto_alkuperaisella_opintoalalla_2002 AS ''Tutk. suor. alkup. opintoalalla''
,d48.tutkinto_muulla_opintoalalla_2002 AS ''Tutk. suor. muulla opintoalalla''
,d49.jatkaa_opiskelua_alkuperaisella_opintoalalla_2002 AS ''Jatkaa opisk. alkup. opintoalalla''
,d50.jatkaa_opiskelua_muulla_opintoalalla_2002 AS ''Jatkaa opisk. muulla opintoalalla''

,d51.opintojen_kulku_koulutuksen_jarjestajan_mukaan AS ''Opintojen kulku 4a''
,d52.opintojen_kulku_koulutuksen_jarjestajan_mukaan AS ''Opintojen kulku 4b''
,d53.tutkinto_alkuperaisella_koulutuksen_jarjestajalla AS ''Tutk. suor. alkup. koul. järjestäjällä''
,d54.tutkinto_muulla_koulutuksen_jarjestajalla AS ''Tutk. suor. muulla koul. järjestäjällä''
,d55.jatkaa_opiskelua_alkuperaisella_koulutuksen_jarjestajalla AS ''Jatkaa opisk. alkup. koul. järjestäjällä''
,d56.jatkaa_opiskelua_muulla_koulutuksen_jarjestajalla AS ''Jatkaa opisk. muulla koul. järjestäjällä''

,d57.opintojen_kulku_oppilaitoksen_mukaan AS ''Opintojen kulku 5a''
,d58.opintojen_kulku_oppilaitoksen_mukaan AS ''Opintojen kulku 5b''
,d59.tutkinto_alkuperaisessa_oppilaitoksessa AS ''Tutk. suor. alkup. oppilaitoksessa''
,d60.tutkinto_muussa_oppilaitoksessa AS ''Tutk. suor. muussa oppilaitoksessa''
,d61.jatkaa_opiskelua_alkuperaisessa_oppilaitoksessa AS ''Jatkaa opisk. alkup. oppilaitoksessa''
,d62.jatkaa_opiskelua_muussa_oppilaitoksessa AS ''Jatkaa opisk. muussa oppilaitoksessa''

,d63.opintojen_kulku_maakunnan_mukaan AS ''Opintojen kulku 6a''
,d64.opintojen_kulku_maakunnan_mukaan AS ''Opintojen kulku 6b''
,d65.tutkinto_alkuperaisessa_maakunnassa AS ''Tutk. suor. alkup. maakunnassa''
,d66.tutkinto_muussa_maakunnassa AS ''Tutk. suor. muussa maakunnassa''
,d67.jatkaa_opiskelua_alkuperaisessa_maakunnassa AS ''Jatkaa opisk. alkup. maakunnassa''
,d68.jatkaa_opiskelua_muussa_maakunnassa AS ''Jatkaa opisk. muussa maakunnassa''

,d69.opintojen_kulku_koulutussektorin_mukaan AS ''Opintojen kulku 7a''
,d70.opintojen_kulku_koulutussektorin_mukaan AS ''Opintojen kulku 7b''
,d71.tutkinto_alkuperaisella_koulutussektorilla AS ''Tutk. suor. alkup. koul.sektorilla''
,d72.tutkinto_muulla_koulutussektorilla AS ''Tutk. suor. muulla koul.sektorilla''
,d73.jatkaa_opiskelua_alkuperaisella_koulutussektorilla AS ''Jatkaa opisk. alkup. koul.sektorilla''
,d74.jatkaa_opiskelua_muulla_koulutussektorilla AS ''Jatkaa opisk. muulla koul.sektorilla''
,d75.opintojen_kulku_koulutusalan_2002_mukaan_versio2 AS ''Opintojen kulku 2bb''
,d76.opintojen_kulku_opintoala_2002_mukaan_versio2 AS ''Opintojen kulku 3bb''
,d77.opintojen_kulku_koulutuksen_jarjestajan_mukaan_versio2 AS ''Opintojen kulku 4bb''
,d78.opintojen_kulku_oppilaitoksen_mukaan_versio2 AS ''Opintojen kulku 5bb''

--järjestysmuuttujat
,d3.jarjestys AS jarj_Sukupuoli
,d4.jarjestys AS jarj_Äidinkieli
,d5.jarjestys_ika AS jarj_Ikä
,d6.jarjestys_ika5v AS jarj_Ikäryhmä
,d7.jarjestys AS jarj_Asuinkunta
,d7.jarjestys_maakunta AS jarj_Asuinmaakunta
,d7.jarjestys_avi AS jarj_AsuinalueenAVI
,d7.jarjestys_ely AS jarj_AsuinalueenELY
,d8.jarjestys AS jarj_Kansalaisuus
,d9.jarjestys_eumaa AS jarj_EU_maankansalainen
,d10.jarjestys_etamaa AS jarj_ETA_maankansalainen
,d11.jarjestys AS jarj_Pohjoismaankansalainen
,d14.jarjestys AS jarj_Kirjoillaolo
,d15.jarjestys_oppilaitostyyppi as jarj_Oppilaitostyyppi
,d15.jarjestys_opetuskieli as jarj_Opetuskieli
,d15.jarjestys_omistajatyyppi as jarj_Oppil_omistajatyyppi
,d15.jarjestys_koulutuksen_jarjestajan_kieli as jarj_Koul_järjestäjänkieli
,d16.jarjestys_koulutusala2002 AS jarj_Koulutusala
,d16.jarjestys_opintoala1995
,d16.jarjestys_opintoala2002 AS jarj_Opintoala
,Case when d16.koulutusaste2002_koodi in (''63'',''72'')

                                     then ''72''

                                     else d16.koulutusaste2002_koodi end AS jarj_Koulutusaste
,d17.jarjestys AS jarj_Koulutuksenkieli
,d18.jarjestys AS jarj_Koulutuksenkunta
,d18.jarjestys_maakunta AS jarj_Koulutuksenmaakunta
,d18.jarjestys_avi AS jarj_KoulutuksenAVI_alue
,d18.jarjestys_ely AS jarj_KoulutuksenELY_alue
,d19.jarjestys AS jarj_Hallinnonala
,d20.jarjestys AS jarj_Koulutustyyppi
,d21.jarjestys_maakunta AS jarj_Tutk_suoritusmaakunta
,d22.jarjestys_koulutuksenjarjestaja AS jarj_Tutkinnon_koul_järjestäjän_omistajatyyppi
,d22.jarjestys_koulutuksen_jarjestajan_kieli AS jarj_Tutkinnon_koul_järjestäjän_kieli
,d23.jarjestys_oppilaitostyyppi AS jarj_Tutkinnon_oppilaitostyyppi
,d23.jarjestys_opetuskieli AS jarj_Tutkinnon_opetuskieli
,d23.jarjestys_omistajatyyppi AS jarj_Tutkinnon_oppil_omistajatyyppi
,d24.jarjestys_koulutusala2002 AS jarj_Tutkinnon_koulutusala_02_luokitus
,d24.jarjestys_opintoala1995 AS jarj_Tutkinnon_koulutusala_95_luokitus
,d24.jarjestys_opintoala2002 AS jarj_Tutkinnon_opintoala
,d24.jarjestys_koulutusaste2002 AS jarj_Tutkinnon_koulutusaste
,d25.jarjestys AS jarj_Tutkinnon_koulutustyyppi
,d26.jarjestys_maakunta AS jarj_Seur_vuoden_koul_maakunta
,d27.jarjestys_koulutuksenjarjestaja AS jarj_Seur_vuoden_koul_järjestäjän_omistajatyyppi
,d27.jarjestys_koulutuksen_jarjestajan_kieli AS jarj_Seur_vuoden_koul_järjestäjän_kieli
,d28.jarjestys_oppilaitostyyppi AS jarj_Seur_vuoden_oppilaitostyyppi
,d28.jarjestys_opetuskieli AS jarj_Seur_vuoden_opetuskieli
,d28.jarjestys_omistajatyyppi AS jarj_Seur_vuoden_oppil_omistajatyyppi
,d29.jarjestys_koulutusala2002 AS jarj_Seur_vuoden_koulutusala_02_luokitus
,d29.jarjestys_opintoala1995 AS jarj_Seur_vuoden_koulutusala_95_luokitus
,d29.jarjestys_opintoala2002 AS jarj_Seur_vuoden_opintoala
,d29.jarjestys_koulutusaste2002 AS jarj_Seur_vuoden_koulutusaste
,d30.jarjestys AS jarj_Seur_vuoden_koulutustyyppi
,d31.jarjestys AS jarj_Pääasiallinen_toiminta
,d32.jarjestys AS jarj_Ammattiasema

,d33.jarjestys_1a
,d34.jarjestys_1b
,d35.jarjestys_1c
,d36.jarjestys_1d
,d37.jarjestys_1e
,d38.jarjestys_1f

,d39.jarjestys_2a
,d40.jarjestys_2b
,d41.jarjestys_2c
,d42.jarjestys_2d
,d43.jarjestys_2e
,d44.jarjestys_2f

,d45.jarjestys_3a
,d46.jarjestys_3b
,d47.jarjestys_3c
,d48.jarjestys_3d
,d49.jarjestys_3e
,d50.jarjestys_3f

,d51.jarjestys_4a
,d52.jarjestys_4b
,d53.jarjestys_4c
,d54.jarjestys_4d
,d55.jarjestys_4e
,d56.jarjestys_4f

,d57.jarjestys_5a
,d58.jarjestys_5b
,d59.jarjestys_5c
,d60.jarjestys_5d
,d61.jarjestys_5e
,d62.jarjestys_5f

,d63.jarjestys_6a
,d64.jarjestys_6b
,d65.jarjestys_6c
,d66.jarjestys_6d
,d67.jarjestys_6e
,d68.jarjestys_6f

,d69.jarjestys_7a
,d70.jarjestys_7b
,d71.jarjestys_7c
,d72.jarjestys_7d
,d73.jarjestys_7e
,d74.jarjestys_7f
,d75.jarjestys_2bb
,d76.jarjestys_3bb
,d77.jarjestys_4bb
,d78.jarjestys_5bb

--koodimuuttujat
,d1.aineisto_koodi AS ''Koodit Aineisto''
,d2.lahde_koodi AS ''Koodit Lähde''
,d7.kunta_koodi AS ''Koodit Asuinkunta''
,d7.maakunta_koodi AS ''Koodit Asuinmaakunta''
,d15.oppilaitoskoodi AS ''Koodit Oppilaitos''
,d15.koulutuksen_jarjestajakoodi AS ''Koodit Koulutuksen järjestäjä''
,d16.koulutus_koodi AS ''Koodit Koulutusnimike''
,d16.koulutusala2002_koodi AS ''Koodit Koulutusala (02 luokitus)''
,d16.opintoala1995_koodi AS ''Koodit Koulutusala (95 luokitus)''
,d16.opintoala2002_koodi AS ''Koodit Opintoala''
,Case when d16.koulutusaste2002_koodi in (''63'',''72'')

                                     then ''72''

                                     else d16.koulutusaste2002_koodi end AS ''Koodit Koulutusaste''
,d18.kunta_koodi AS ''Koodit Koulutuksen kunta''
,d18.maakunta_koodi AS ''Koodit Koulutuksen maakunta''
,d20.koulutustyyppi_koodi AS ''Koodit Koulutustyyppi''
,d21.maakunta_koodi AS ''Koodit Tutk. suoritusmaakunta''
,d22.koulutuksen_jarjestajakoodi AS ''Koodit Tutkinnon koul. järjestäjä''
,d23.oppilaitoskoodi AS ''Koodit Tutkinnon oppilaitos''
,d24.koulutus_koodi AS ''Koodit Tutkinnon koulutusnimike''
,d24.koulutusala2002_koodi AS ''Koodit Tutkinnon koulutusala (02 luokitus)''
,d24.opintoala1995_koodi AS ''Koodit Tutkinnon koulutusala (95 luokitus)''
,d24.opintoala2002_koodi AS ''Koodit Tutkinnon opintoala''
,d24.koulutusaste2002_koodi AS ''Koodit Tutkinnon koulutusaste''
,d25.koulutustyyppi_koodi AS ''Koodit Tutkinnon koulutustyyppi''
,d26.maakunta_koodi AS ''Koodit Seur. vuoden koul. maakunta''
,d27.koulutuksen_jarjestajakoodi AS ''Koodit Seur. vuoden koul. järjestäjä''
,d28.oppilaitoskoodi AS ''Koodit Seur. vuoden oppilaitos''
,d29.koulutus_koodi AS ''Koodit Seur. vuoden koulutusnimike''
,d29.koulutusala2002_koodi AS ''Koodit Seur. vuoden koulutusala (02 luokitus)''
,d29.opintoala1995_koodi AS ''Koodit Seur. vuoden koulutusala (95 luokitus)''
,d29.opintoala2002_koodi AS ''Koodit Seur. vuoden opintoala''
,d29.koulutusaste2002_koodi AS ''Koodit Seur. vuoden koulutusaste''
,d30.koulutustyyppi_koodi AS ''Koodit Seur. vuoden koulutustyyppi''

--Ruotsi
,[tilastovuosi] AS Statistikår
,d3.sukupuoli_SV AS Kön
,d4.aidinkieli_versio1_SV AS Modersmål
,d6.ika_SV AS Åldersgrupp
,d7.kunta_SV AS Bostadskommun
,d7.maakunta_SV AS Bostadslandskap
,d8.kansalaisuus_versio1_SV AS Medborgarskap
,d16.koulutus_SV AS Utbildningsbenämning
,d17.koulutuksen_kieli_versio1_SV AS [Utbildningens språk]
,d18.kunta_SV AS [Ubildningens kommun]
,d18.maakunta_SV AS [Utbildningens landskap]
,d21.maakunta_SV AS [Landskap där examen avlagts]
,d15.koulutuksen_jarjestaja_SV as [Utbildningsanordnare]
,d15.oppilaitos_SV as [Universitet]
,d75.opintojen_kulku_koulutusalan_2002_mukaan_versio2_SV AS ''Studieförlopp (utb.område)''
,d78.opintojen_kulku_oppilaitoksen_mukaan_versio2_SV AS ''Studieförlopp (läroanstalt)''
,Case when d16.koulutusaste2002_koodi in (''63'',''72'')
			then ''Lägre och högre högskoleexamen''
			else d16.koulutusaste2002_SV end AS Utbildningsnivå
,d20.koulutustyyppi_SV AS [Typ av utbildning]
,d16.koulutusala2002_SV AS [Utbildningsområde 2002]
,d16.opintoala2002_SV AS [Studieområde 2002]
,d28.oppilaitos_SV AS ''Nästä års läroanstalt''
,d23.oppilaitos_SV AS ''Läroanstalt där examen avlagts''
,d16.opintoala1995_SV AS [Studieområde 1995]

--Englanti
,[tilastovuosi] AS [Statistical year]
,d3.sukupuoli_EN AS Gender
,d4.aidinkieli_versio1_EN AS [Mother tongue]
,d6.ika_EN AS [Age group]
,d7.kunta_EN AS [Municipality of residence]
,d7.maakunta_EN AS [Region of residence]
,d8.kansalaisuus_versio1_EN AS Nationality
,d16.koulutus_EN AS [Name of education]
,d17.koulutuksen_kieli_versio1_EN AS [Language of education]
,d18.kunta_EN AS [Municipality of education]
,d18.maakunta_EN AS [Region of education]
,d21.maakunta_EN AS [Region of degree]
,d15.koulutuksen_jarjestaja_EN as [Education provider]
,d15.oppilaitos_EN as University
,d75.opintojen_kulku_koulutusalan_2002_mukaan_versio2_EN AS ''Progress of studies (field of ed.)''
,d78.opintojen_kulku_oppilaitoksen_mukaan_versio2_EN AS ''Progress of studies (ed. institution)''
,Case when d16.koulutusaste2002_koodi in (''63'',''72'')
			then ''Bachelor''''s and Master''''s degree''
			else d16.koulutusaste2002_EN end AS ''Level of education''
,d20.koulutustyyppi_EN AS [Type of education]
,d16.koulutusala2002_EN AS [Field of education 2002]
,d16.opintoala2002_EN AS [Subfield of education 2002]
,d28.oppilaitos_EN AS ''Next year''''s ed. institution''
,d23.oppilaitos_EN AS ''Ed. institution of degree''
,d16.opintoala1995_EN AS [Subfield of education 1995]

,d19.opetushallinnon_koulutus_SV AS Förvaltningsområde
,d19.opetushallinnon_koulutus_EN AS [Administrative sector]

--isced
,d16.iscle2011 as "Koulutusaste, taso 1"
,d16.Koulutusaste_taso2 as "Koulutusaste, taso 2"
,d16.iscfibroad2013 as "Koulutusala, taso 1"
,d16.iscfinarrow2013 as "Koulutusala, taso 2"
,d16.iscfi2013 as "Koulutusala, taso 3"
,d16.OKM_ohjauksen_ala as "OKM ohjauksen ala"
,d16.iscle2011_SV as "Utbildn.nivå, nivå 1"
,d16.Koulutusaste_taso2_SV as "Utbildn.nivå, nivå 2"
,d16.iscfibroad2013_SV as "Utbildn.område, nivå 1"
,d16.iscfinarrow2013_SV as "Utbildn.område, nivå 2"
,d16.iscfi2013_SV as "Utbildn.område, nivå 3"
,d16.OKM_ohjauksen_ala_SV as "UKM-styrningsområde"
,d16.iscle2011_EN as "Level of education, tier 1"
,d16.Koulutusaste_taso2_EN as "Level of education, tier 2"
,d16.iscfibroad2013_EN as "Field of education, tier 1"
,d16.iscfinarrow2013_EN as "Field of education, tier 2"
,d16.iscfi2013_EN as "Field of education, tier 3"
,d16.OKM_ohjauksen_ala_EN as "Field of ed., HE steering"
,d16.jarjestys_iscle2011 as jarj_isced_koulast1
,d16.jarjestys_Koulutusaste_taso2 as jarj_isced_koulast2
,d16.jarjestys_iscfibroad2013 as jarj_isced_koulala1
,d16.jarjestys_iscfinarrow2013 as jarj_isced_koulala2
,d16.jarjestys_iscfi2013 as jarj_isced_koulala3
,d16.jarjestys_OKM_ohjauksen_ala as jarj_isced_okmohjaus1
,d16.iscle2011_koodi as "Koodit Koulutusaste, taso 1"
,d16.Koulutusaste_taso2_koodi as "Koodit Koulutusaste, taso 2"
,d16.iscfibroad2013_koodi as "Koodit Koulutusala, taso 1"
,d16.iscfinarrow2013_koodi as "Koodit Koulutusala, taso 2"
,d16.iscfi2013_koodi as "Koodit Koulutusala, taso 3"
,d16.OKM_ohjauksen_ala_koodi as "Koodit OKM ohjauksen ala"

FROM dbo.f_keskeyttaneet
	JOIN d_aineisto d1 ON d1.id = aineisto_id
	JOIN d_lahde d2 ON d2.id = aineisto_id
	JOIN d_sukupuoli d3 ON d3.id = sukupuoli_id
	JOIN d_aidinkieli_versio1 d4 ON d4.id = aidinkieli_versio1x_id
	JOIN d_ika d5 ON d5.id = ika_1v_id
	JOIN d_ika d6 ON d6.id = ika_5v_id
	JOIN d_alueluokitus d7 ON d7.id= kotikunta_id
	JOIN d_kansalaisuus_versio1 d8 ON d8.id= kansalaisuus_versio1_id
	JOIN d_valtio d9 ON d9.id= eumaa_id
	JOIN d_valtio d10 ON d10.id= etamaa_id
	JOIN d_pohjoismaa d11 ON d11.id= pohjoismaa_id
	JOIN d_kausi d12 ON d12.kausi_id= kirjoihintulovuosi_id
	JOIN d_opiskelijan_olo d14 ON d14.id= opiskelijan_olo_lk_id
	JOIN d_oppilaitoksen_taustatiedot d15 ON d15.id= oppilaitoksen_taustatiedot_id
	JOIN d_koulutusluokitus d16 ON d16.id= koulutusluokitus_id
	JOIN d_koulutuksen_kieli_versio1 d17 ON d17.id= koulutuksen_kieli_versio1_id
	JOIN d_alueluokitus d18 ON d18.id= koulutuksen_kunta_id
	JOIN d_opetushallinnon_koulutus d19 ON d19.id= opetushallinnon_koulutus_id
	JOIN d_koulutustyyppi d20 ON d20.id= koulutustyyppi_id
	JOIN d_alueluokitus d21 ON d21.id= tutkinnon_suorittamismaakunta_id
	JOIN d_oppilaitoksen_taustatiedot d22 ON d22.id= tutkinnon_jarjestaja_id
	JOIN d_oppilaitoksen_taustatiedot d23 ON d23.id= tutkinnon_suorittamisoppilaitos_id
	JOIN d_koulutusluokitus d24 ON d24.id= tutkinnon_koulutusluokitus_id
	JOIN d_koulutustyyppi d25 ON d25.id= tutkinnon_koulutustyyppi_id
	JOIN d_alueluokitus d26 ON d26.id= seuraavan_vuoden_maakunta_id
	JOIN d_oppilaitoksen_taustatiedot d27 ON d27.id= seuraavan_vuoden_jarjestaja_id
	JOIN d_oppilaitoksen_taustatiedot d28 ON d28.id= seuraavan_vuoden_oppilaitos_id
	JOIN d_koulutusluokitus d29 ON d29.id= seuraavan_vuoden_koulutusluokitus_id
	JOIN d_koulutustyyppi d30 ON d30.id= seuraavan_vuoden_koulutustyyppi_id
	JOIN d_paaasiallinen_toiminta_versio2 d31 ON d31.id = paaasiallinen_toiminta_versio2_id
	JOIN d_ammattiasema d32 ON d32.id = ammattiasema_id
	JOIN d_opintojen_kulku_koulutusasteen_2002_mukaan  d33 ON d33.id = [1a_opiskelijoiden_opintojen_kulku_koulutusaste_2002_mukaan_id]
	JOIN d_opintojen_kulku_koulutusasteen_2002_mukaan  d34 ON d34.id = [1b_opiskelijoiden_opintojen_kulku_koulutusaste_2002_mukaan_id]
	JOIN d_tutkinto_alkuperaisella_koulutusasteella_2002  d35 ON d35.id = [1c_tutkinto_alkuperaisella_koulutusasteella_2002_id]
	JOIN d_tutkinto_muulla_koulutusasteella_2002  d36 ON d36.id = [1d_tutkinto_muulla_koulutusasteella_2002_id]
	JOIN d_jatkaa_opiskelua_alkuperaisella_koulutusasteella_2002 d37 ON d37.id = [1e_jatkaa_opiskelua_alkuperaisella_koulutusasteella_2002_id]
	JOIN d_jatkaa_opiskelua_muulla_koulutusasteella_2002 d38 ON d38.id = [1f_jatkaa_opiskelua_muulla_koulutusasteella_2002_id]
	JOIN d_opintojen_kulku_koulutusalan_2002_mukaan d39 ON d39.id = [2a_opiskelijoiden_opintojen_kulku_koulutusala_2002_mukaan_id]
	JOIN d_opintojen_kulku_koulutusalan_2002_mukaan d40 ON d40.id = [2b_opiskelijoiden_opintojen_kulku_koulutusala_2002_mukaan_id]
	JOIN d_tutkinto_alkuperaisella_koulutusalalla_2002  d41 ON d41.id = [2c_tutkinto_alkuperaisella_koulutusalalla_2002_id]
	JOIN d_tutkinto_muulla_koulutusalalla_2002  d42 ON d42.id = [2d_tutkinto_muulla_koulutusalalla_2002_id]
	JOIN d_jatkaa_opiskelua_alkuperaisella_koulutusalalla_2002  d43 ON d43.id = [2e_jatkaa_opiskelua_alkuperaisella_koulutusalalla_2002_id]
	JOIN d_jatkaa_opiskelua_muulla_koulutusalalla_2002  d44 ON d44.id = [2f_jatkaa_opiskelua_muulla_koulutusalalla_2002_id]

	JOIN d_opintojen_kulku_opintoalan_2002_mukaan d45 ON d45.id = [3a_opiskelijoiden_opintojen_kulku_opintoala_2002_mukaan_id]
	JOIN d_opintojen_kulku_opintoalan_2002_mukaan d46 ON d46.id = [3b_opiskelijoiden_opintojen_kulku_opintoala_2002_mukaan_id]
	JOIN d_tutkinto_alkuperaisella_opintoalalla_2002  d47 ON d47.id = [3c_tutkinto_alkuperaisella_opintoalalla_2002_id]
	JOIN d_tutkinto_muulla_opintoalalla_2002  d48 ON d48.id = [3d_tutkinto_muulla_opintoalalla_2002_id]
	JOIN d_jatkaa_opiskelua_alkuperaisella_opintoalalla_2002  d49 ON d49.id = [3e_jatkaa_opiskelua_alkuperaisella_opintoalalla_2002_id]
	JOIN d_jatkaa_opiskelua_muulla_opintoalalla_2002  d50 ON d50.id = [3f_jatkaa_opiskelua_muulla_opintoalalla_2002_id]

	JOIN d_opintojen_kulku_koulutuksen_jarjestajan_mukaan d51 ON d51.id = [4a_opiskelijoiden_opintojen_kulku_koul_jarjestajan_mukaan_id]
	JOIN d_opintojen_kulku_koulutuksen_jarjestajan_mukaan d52 ON d52.id = [4b_opiskelijoiden_opintojen_kulku_koul_jarjestajan_mukaan_id]
	JOIN d_tutkinto_alkuperaisella_koulutuksen_jarjestajalla  d53 ON d53.id = [4c_tutkinto_alkuperaisella_koulutuksen_jarjestajalla_id]
	JOIN d_tutkinto_muulla_koulutuksen_jarjestajalla  d54 ON d54.id = [4d_tutkinto_muulla_koulutuksen_jarjestajalla_id]
	JOIN d_jatkaa_opiskelua_alkuperaisella_koulutuksen_jarjestajalla  d55 ON d55.id = [4e_jatkaa_opiskelua_alkuperaisella_koulutuksen_jarjestajalla_id]
	JOIN d_jatkaa_opiskelua_muulla_koulutuksen_jarjestajalla  d56 ON d56.id = [4f_jatkaa_opiskelua_muulla_koulutuksen_jarjestajalla_id]


	JOIN d_opintojen_kulku_oppilaitoksen_mukaan d57 ON d57.id = [5a_opiskelijoiden_opintojen_kulku_oppilaitoksen_mukaan_id]
	JOIN d_opintojen_kulku_oppilaitoksen_mukaan d58 ON d58.id = [5b_opiskelijoiden_opintojen_kulku_oppilaitoksen_mukaan_id]
	JOIN d_tutkinto_alkuperaisessa_oppilaitoksessa  d59 ON d59.id = [5c_tutkinto_alkuperaisessa_oppilaitoksessa_id]
	JOIN d_tutkinto_muussa_oppilaitoksessa  d60 ON d60.id = [5d_tutkinto_muussa_oppilaitoksessa_id]
	JOIN d_jatkaa_opiskelua_alkuperaisessa_oppilaitoksessa  d61 ON d61.id = [5e_jatkaa_opiskelua_alkuperaisessa_oppilaitoksessa_id]
	JOIN d_jatkaa_opiskelua_muussa_oppilaitoksessa d62 ON d62.id = [5f_jatkaa_opiskelua_muussa_oppilaitoksessa_id]

	JOIN d_opintojen_kulku_maakunnan_mukaan d63 ON d63.id = [6a_opiskelijoiden_opintojen_kulku_maakunnan_mukaan_id]
	JOIN d_opintojen_kulku_maakunnan_mukaan d64 ON d64.id = [6b_opiskelijoiden_opintojen_kulku_maakunnan_mukaan_id]
	JOIN d_tutkinto_alkuperaisessa_maakunnassa  d65 ON d65.id = [6c_tutkinto_alkuperaisessa_maakunnassa_id]
	JOIN d_tutkinto_muussa_maakunnassa  d66 ON d66.id = [6d_tutkinto_muussa_maakunnassa_id]
	JOIN d_jatkaa_opiskelua_alkuperaisessa_maakunnassa  d67 ON d67.id = [6e_jatkaa_opiskelua_alkuperaisessa_maakunnassa_id]
	JOIN d_jatkaa_opiskelua_muussa_maakunnassa d68 ON d68.id = [6f_jatkaa_opiskelua_muussa_maakunnassa_id]

	JOIN d_opintojen_kulku_koulutussektorin_mukaan d69 ON d69.id = [7a_opiskelijoiden_opintojen_kulku_koulutussektorin_mukaan_id]
	JOIN d_opintojen_kulku_koulutussektorin_mukaan d70 ON d70.id = [7b_opiskelijoiden_opintojen_kulku_koulutussektorin_mukaan_id]
	JOIN d_tutkinto_alkuperaisella_koulutussektorilla d71 ON d71.id = [7c_tutkinto_alkuperaisella_koulutussektorilla_id]
	JOIN d_tutkinto_muulla_koulutussektorilla d72 ON d72.id = [7d_tutkinto_muulla_koulutussektorilla_id]
	JOIN d_jatkaa_opiskelua_alkuperaisella_koulutussektorilla d73 ON d73.id = [7e_jatkaa_opiskelua_alkuperaisella_koulutussektorilla_id]
	JOIN d_jatkaa_opiskelua_muulla_koulutussektorilla d74 ON d74.id = [7f_jatkaa_opiskelua_muulla_koulutussektorilla_id]

	JOIN d_opintojen_kulku_koulutusalan_2002_mukaan_versio2 d75 ON d75.id = [2bb_opiskelijoiden_opintojen_kulku_koulutusala_2002_mukaan_id]
	JOIN d_opintojen_kulku_opintoalan_2002_mukaan_versio2 d76 ON d76.id = [3bb_opiskelijoiden_opintojen_kulku_opintoala_2002_mukaan_id]
	JOIN d_opintojen_kulku_koulutuksen_jarjestajan_mukaan_versio2 d77 ON d77.id = [4bb_opiskelijoiden_opintojen_kulku_koul_jarjestajan_mukaan_id]
	JOIN d_opintojen_kulku_oppilaitoksen_mukaan_versio2 d78 ON d78.id = [5bb_opiskelijoiden_opintojen_kulku_oppilaitoksen_mukaan_id]










' 
GO
/****** Object:  View [dbo].[v_f_tab_keskeytaneet_amk]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_keskeytaneet_amk]'))
EXEC dbo.sp_executesql @statement = N'























CREATE VIEW [dbo].[v_f_tab_keskeytaneet_amk] AS

Select
[opiskelijat] AS lkm_int,
[tilastovuosi] AS Tilastovuosi
,d1.aineisto AS Aineisto
,d2.lahde AS Lähde
,d3.sukupuoli AS Sukupuoli
,d4.aidinkieli_versio1 AS Äidinkieli
,d5.ika AS Ikä
,d6.ika AS Ikäryhmä
,d7.kunta AS Asuinkunta
,d7.maakunta AS Asuinmaakunta
,d7.avi AS ''Asuinalueen AVI''
,d7.ely AS ''Asuinalueen ELY''
,d8.kansalaisuus_versio1 AS Kansalaisuus
,d9.eumaa AS ''EU-maan kansalainen''
,d10.etamaa AS ''ETA-maan kansalainen''
,d11.pohjoismaa AS ''Pohjoismaan kansalainen''
,d12.vuosiselite AS Aloitusvuosi
,d14.opiskelijan_olo AS Kirjoillaolo
,d15.oppilaitos as "Ammattikorkeakoulu"
,d15.oppilaitostyyppi as "Oppilaitostyyppi"
,d15.opetuskieli as "Opetuskieli"
,d15.oppilaitoksen_omistajatyyppi as "Oppil. omistajatyyppi"
,d15.koulutuksen_jarjestaja as "Koulutuksen järjestäjä"
,d15.koulutuksen_jarjestajan_kieli as "Koul. järjestäjän kieli"
,d16.koulutus AS Koulutusnimike
,d16.koulutusala2002 AS Koulutusala
,d16.koulutusala2002 AS "Koulutusala (02 luokitus)"
,d16.opintoala1995 AS "Koulutusala (95 luokitus)"
,d16.opintoala2002 AS Opintoala
,d16.koulutusaste2002 AS Koulutusaste
,d17.koulutuksen_kieli_versio1 AS ''Koulutuksen kieli''
,d18.kunta AS ''Koulutuksen kunta''
,d18.maakunta AS ''Koulutuksen maakunta''
,d18.avi AS "Koulutuksen AVI-alue"
,d18.ely AS "Koulutuksen ELY-alue"
,d19.opetushallinnon_koulutus AS Hallinnonala
,d20.koulutustyyppi AS Koulutustyyppi
,d21.maakunta AS ''Tutk. suoritusmaakunta''
,d22.koulutuksen_jarjestaja AS ''Tutkinnon koul. järjestäjä''
,d22.koulutuksen_jarjestajan_omistajatyyppi AS ''Tutkinnon koul. järjestäjän omistajatyyppi''
,d22.koulutuksen_jarjestajan_kieli ''Tutkinnon koul. järjestäjän kieli''
,d22.koulutuksen_jarjestajan_sijaintikunta AS ''Tutkinnon koul. järjestäjän sijaintikunta''
,d23.oppilaitos AS ''Tutkinnon oppilaitos''
,d23.oppilaitostyyppi as "Tutkinnon oppilaitostyyppi"
,d23.opetuskieli as "Tutkinnon opetuskieli"
,d23.oppilaitoksen_omistajatyyppi as "Tutkinnon oppil. omistajatyyppi"
,d24.koulutus AS ''Tutkinnon koulutusnimike''
,d24.koulutusala2002 AS ''Tutkinnon koulutusala''
,d24.koulutusala2002 AS ''Tutkinnon koulutusala (02 luokitus)''
,d24.opintoala1995 AS "Tutkinnon koulutusala (95 luokitus)"
,d24.opintoala2002 AS ''Tutkinnon opintoala''
,d24.koulutusaste2002 AS ''Tutkinnon koulutusaste''
,d25.koulutustyyppi AS ''Tutkinnon koulutustyyppi''
,d26.maakunta AS ''Seur. vuoden koul. maakunta''
,d27.koulutuksen_jarjestaja AS ''Seur. vuoden koul. järjestäjä''
,d27.koulutuksen_jarjestajan_omistajatyyppi AS ''Seur. vuoden koul. järjestäjän omistajatyyppi''
,d27.koulutuksen_jarjestajan_kieli ''Seur. vuoden koul. järjestäjän kieli''
,d27.koulutuksen_jarjestajan_sijaintikunta AS ''Seur. vuoden koul. järjestäjän sijaintikunta''
,d28.oppilaitos AS ''Seur. vuoden oppilaitos''
,d28.oppilaitostyyppi as "Seur. vuoden oppilaitostyyppi"
,d28.opetuskieli as "Seur. vuoden opetuskieli"
,d28.oppilaitoksen_omistajatyyppi as "Seur. vuoden oppil. omistajatyyppi"
,d29.koulutus AS ''Seur. vuoden koulutusnimike''
,d29.koulutusala2002 AS ''Seur. vuoden koulutusala''
,d29.koulutusala2002 AS ''Seur. vuoden koulutusala (02 luokitus)''
,d29.opintoala1995 AS "Seur. vuoden koulutusala (95 luokitus)"
,d29.opintoala2002 AS ''Seur. vuoden opintoala''
,d29.koulutusaste2002 AS ''Seur. vuoden koulutusaste''
,d30.koulutustyyppi  AS ''Seur. vuoden koulutustyyppi''
,d31.paaasiallinen_toiminta_versio2 AS ''Pääasiallinen toiminta''
,d32.ammattiasema AS Ammattiasema

--,d33.opintojen_kulku_koulutusasteen_2002_mukaan AS ''Opintojen kulku 1a''
--,d34.opintojen_kulku_koulutusasteen_2002_mukaan AS ''Opintojen kulku 1b''
--,d35.tutkinto_alkuperaisella_koulutusasteella_2002 AS ''Tutk. suor. alkup. koul.asteella''
--,d36.tutkinto_muulla_koulutusasteella_2002 AS ''Tutk. suor. muulla koul.asteella''
--,d37.jatkaa_opiskelua_alkuperaisella_koulutusasteella_2002 AS ''Jatkaa opisk. alkup. koul.asteella''
--,d38.jatkaa_opiskelua_muulla_koulutusasteella_2002 AS ''Jatkaa opisk. muulla koul.asteella''

--,d39.opintojen_kulku_koulutusalan_2002_mukaan AS ''Opintojen kulku 2a''
--,d40.opintojen_kulku_koulutusalan_2002_mukaan AS ''Opintojen kulku 2b''
--,d41.tutkinto_alkuperaisella_koulutusalalla_2002 AS ''Tutk. suor. alkup. koul.alalla''
--,d42.tutkinto_muulla_koulutusalalla_2002 AS ''Tutk. suor. muulla koul.alalla''
--,d43.jatkaa_opiskelua_alkuperaisella_koulutusalalla_2002 AS ''Jatkaa opisk. alkup. koul.alalla''
--,d44.jatkaa_opiskelua_muulla_koulutusalalla_2002 AS ''Jatkaa opisk. muulla koul.alalla''

--,d45.opintojen_kulku_opintoala_2002_mukaan AS ''Opintojen kulku 3a''
--,d46.opintojen_kulku_opintoala_2002_mukaan AS ''Opintojen kulku 3b''
--,d47.tutkinto_alkuperaisella_opintoalalla_2002 AS ''Tutk. suor. alkup. opintoalalla''
--,d48.tutkinto_muulla_opintoalalla_2002 AS ''Tutk. suor. muulla opintoalalla''
--,d49.jatkaa_opiskelua_alkuperaisella_opintoalalla_2002 AS ''Jatkaa opisk. alkup. opintoalalla''
--,d50.jatkaa_opiskelua_muulla_opintoalalla_2002 AS ''Jatkaa opisk. muulla opintoalalla''

--,d51.opintojen_kulku_koulutuksen_jarjestajan_mukaan AS ''Opintojen kulku 4a''
--,d52.opintojen_kulku_koulutuksen_jarjestajan_mukaan AS ''Opintojen kulku 4b''
--,d53.tutkinto_alkuperaisella_koulutuksen_jarjestajalla AS ''Tutk. suor. alkup. koul. järjestäjällä''
--,d54.tutkinto_muulla_koulutuksen_jarjestajalla AS ''Tutk. suor. muulla koul. järjestäjällä''
--,d55.jatkaa_opiskelua_alkuperaisella_koulutuksen_jarjestajalla AS ''Jatkaa opisk. alkup. koul. järjestäjällä''
--,d56.jatkaa_opiskelua_muulla_koulutuksen_jarjestajalla AS ''Jatkaa opisk. muulla koul. järjestäjällä''

--,d57.opintojen_kulku_oppilaitoksen_mukaan AS ''Opintojen kulku 5a''
--,d58.opintojen_kulku_oppilaitoksen_mukaan AS ''Opintojen kulku 5b''
--,d59.tutkinto_alkuperaisessa_oppilaitoksessa AS ''Tutk. suor. alkup. oppilaitoksessa''
--,d60.tutkinto_muussa_oppilaitoksessa AS ''Tutk. suor. muussa oppilaitoksessa''
--,d61.jatkaa_opiskelua_alkuperaisessa_oppilaitoksessa AS ''Jatkaa opisk. alkup. oppilaitoksessa''
--,d62.jatkaa_opiskelua_muussa_oppilaitoksessa AS ''Jatkaa opisk. muussa oppilaitoksessa''

--,d63.opintojen_kulku_maakunnan_mukaan AS ''Opintojen kulku 6a''
--,d64.opintojen_kulku_maakunnan_mukaan AS ''Opintojen kulku 6b''
--,d65.tutkinto_alkuperaisessa_maakunnassa AS ''Tutk. suor. alkup. maakunnassa''
--,d66.tutkinto_muussa_maakunnassa AS ''Tutk. suor. muussa maakunnassa''
--,d67.jatkaa_opiskelua_alkuperaisessa_maakunnassa AS ''Jatkaa opisk. alkup. maakunnassa''
--,d68.jatkaa_opiskelua_muussa_maakunnassa AS ''Jatkaa opisk. muussa maakunnassa''

--,d69.opintojen_kulku_koulutussektorin_mukaan AS ''Opintojen kulku 7a''
--,d70.opintojen_kulku_koulutussektorin_mukaan AS ''Opintojen kulku 7b''
--,d71.tutkinto_alkuperaisella_koulutussektorilla AS ''Tutk. suor. alkup. koul.sektorilla''
--,d72.tutkinto_muulla_koulutussektorilla AS ''Tutk. suor. muulla koul.sektorilla''
--,d73.jatkaa_opiskelua_alkuperaisella_koulutussektorilla AS ''Jatkaa opisk. alkup. koul.sektorilla''
--,d74.jatkaa_opiskelua_muulla_koulutussektorilla AS ''Jatkaa opisk. muulla koul.sektorilla''
,d75.opintojen_kulku_koulutusalan_2002_mukaan_versio2 AS ''Opintojen kulku (koulutusala)''
--,d76.opintojen_kulku_opintoala_2002_mukaan_versio2 AS ''Opintojen kulku 3bb''
--,d77.opintojen_kulku_koulutuksen_jarjestajan_mukaan_versio2 AS ''Opintojen kulku 4bb''
,d78.opintojen_kulku_oppilaitoksen_mukaan_versio2 AS ''Opintojen kulku (oppilaitos)''

--Ruotsi
,[tilastovuosi] AS Statistikår
,d3.sukupuoli_SV AS Kön
,d4.aidinkieli_versio1_SV AS Modersmål
,d6.ika_SV AS Åldersgrupp
,d7.kunta_SV AS Bostadskommun
,d7.maakunta_SV AS Bostadslandskap
,d8.kansalaisuus_versio1_SV AS Medborgarskap
,d16.koulutus_SV AS Utbildningsbenämning
,d17.koulutuksen_kieli_versio1_SV AS [Utbildningens språk]
,d18.kunta_SV AS [Ubildningens kommun]
,d18.maakunta_SV AS [Utbildningens landskap]
,d21.maakunta_SV AS [Landskap där examen avlagts]
,d15.koulutuksen_jarjestaja_SV as [Utbildningsanordnare]
,d15.oppilaitos_SV as [Läroanstalt]
,d75.opintojen_kulku_koulutusalan_2002_mukaan_versio2_SV AS ''Studieförlopp (utb.område)''
,d78.opintojen_kulku_oppilaitoksen_mukaan_versio2_SV AS ''Studieförlopp (läroanstalt)''
,d16.koulutusaste2002_SV AS Utbildningsnivå
,d20.koulutustyyppi_SV AS [Typ av utbildning]
,d16.koulutusala2002_SV AS [Utbildningsområde 2002]
,d16.opintoala2002_SV AS [Studieområde 2002]
,d28.oppilaitos_SV AS ''Nästä års läroanstalt''
,d23.oppilaitos_SV AS ''Läroanstalt där examen avlagts''

--Englanti
,[tilastovuosi] AS [Statistical year]
,d3.sukupuoli_EN AS Gender
,d4.aidinkieli_versio1_EN AS [Mother tongue]
,d6.ika_EN AS [Age group]
,d7.kunta_EN AS [Municipality of residence]
,d7.maakunta_EN AS [Region of residence]
,d8.kansalaisuus_versio1_EN AS Nationality
,d16.koulutus_EN AS [Name of education]
,d17.koulutuksen_kieli_versio1_EN AS [Language of education]
,d18.kunta_EN AS [Municipality of education]
,d18.maakunta_EN AS [Region of education]
,d21.maakunta_EN AS [Region of degree]
,d15.koulutuksen_jarjestaja_EN as [Education provider]
,d15.oppilaitos_EN as [Educational institution]
,d75.opintojen_kulku_koulutusalan_2002_mukaan_versio2_EN AS ''Progress of studies (field of ed.)''
,d78.opintojen_kulku_oppilaitoksen_mukaan_versio2_EN AS ''Progress of studies (ed. institution)''
,d16.koulutusaste2002_EN AS ''Level of education''
,d20.koulutustyyppi_EN AS [Type of education]
,d16.koulutusala2002_EN AS [Field of education 2002]
,d16.opintoala2002_EN AS [Subfield of education 2002]
,d28.oppilaitos_EN AS ''Next year''''s ed. institution''
,d23.oppilaitos_EN AS ''Ed. institution of degree''

--isced
,d16.iscle2011 as "Koulutusaste, taso 1"
,d16.Koulutusaste_taso2 as "Koulutusaste, taso 2"
,d16.iscfibroad2013 as "Koulutusala, taso 1"
,d16.iscfinarrow2013 as "Koulutusala, taso 2"
,d16.iscfi2013 as "Koulutusala, taso 3"
,d16.OKM_ohjauksen_ala as "OKM ohjauksen ala"
,d16.iscle2011_SV as "Utbildn.nivå, nivå 1"
,d16.Koulutusaste_taso2_SV as "Utbildn.nivå, nivå 2"
,d16.iscfibroad2013_SV as "Utbildn.område, nivå 1"
,d16.iscfinarrow2013_SV as "Utbildn.område, nivå 2"
,d16.iscfi2013_SV as "Utbildn.område, nivå 3"
,d16.OKM_ohjauksen_ala_SV as "UKM-styrningsområde"
,d16.iscle2011_EN as "Level of education, tier 1"
,d16.Koulutusaste_taso2_EN as "Level of education, tier 2"
,d16.iscfibroad2013_EN as "Field of education, tier 1"
,d16.iscfinarrow2013_EN as "Field of education, tier 2"
,d16.iscfi2013_EN as "Field of education, tier 3"
,d16.OKM_ohjauksen_ala_EN as "Field of ed., HE steering"
,d16.jarjestys_iscle2011 as jarj_isced_koulast1
,d16.jarjestys_Koulutusaste_taso2 as jarj_isced_koulast2
,d16.jarjestys_iscfibroad2013 as jarj_isced_koulala1
,d16.jarjestys_iscfinarrow2013 as jarj_isced_koulala2
,d16.jarjestys_iscfi2013 as jarj_isced_koulala3
,d16.jarjestys_OKM_ohjauksen_ala as jarj_isced_okmohjaus1
,d16.iscle2011_koodi as "Koodit Koulutusaste, taso 1"
,d16.Koulutusaste_taso2_koodi as "Koodit Koulutusaste, taso 2"
,d16.iscfibroad2013_koodi as "Koodit Koulutusala, taso 1"
,d16.iscfinarrow2013_koodi as "Koodit Koulutusala, taso 2"
,d16.iscfi2013_koodi as "Koodit Koulutusala, taso 3"
,d16.OKM_ohjauksen_ala_koodi as "Koodit OKM ohjauksen ala"
,d24.iscle2011 as "Tutkinnon koulutusaste 1"
,d24.Koulutusaste_taso2 as "Tutkinnon koulutusaste 2"
,d24.iscfibroad2013 as "Tutkinnon koulutusala 1"
,d24.iscfinarrow2013 as "Tutkinnon koulutusala 2"
,d24.iscfi2013 as "Tutkinnon koulutusala 3"
,d24.OKM_ohjauksen_ala as "Tutkinnon OKM ohjauksen ala"
,d24.jarjestys_iscle2011 as jarj_isced2_koulast1
,d24.jarjestys_Koulutusaste_taso2 as jarj_isced2_koulast2
,d24.jarjestys_iscfibroad2013 as jarj_isced2_koulala1
,d24.jarjestys_iscfinarrow2013 as jarj_isced2_koulala2
,d24.jarjestys_iscfi2013 as jarj_isced2_koulala3
,d24.jarjestys_OKM_ohjauksen_ala as jarj_isced2_okmohjaus1
,d24.iscle2011_koodi as "Koodit Tutkinnon koulutusaste 1"
,d24.Koulutusaste_taso2_koodi as "Koodit Tutkinnon koulutusaste 2"
,d24.iscfibroad2013_koodi as "Koodit Tutkinnon koulutusala 1"
,d24.iscfinarrow2013_koodi as "Koodit Tutkinnon koulutusala 2"
,d24.iscfi2013_koodi as "Koodit Tutkinnon koulutusala 3"
,d24.OKM_ohjauksen_ala_koodi as "Koodit Tutkinnon OKM ohjauksen ala"
,d29.iscle2011 as "Seur. vuoden koulutusaste 1"
,d29.Koulutusaste_taso2 as "Seur. vuoden koulutusaste 2"
,d29.iscfibroad2013 as "Seur. vuoden koulutusala 1"
,d29.iscfinarrow2013 as "Seur. vuoden koulutusala 2"
,d29.iscfi2013 as "Seur. vuoden koulutusala 3"
,d29.OKM_ohjauksen_ala as "Seur. vuoden OKM ohjauksen ala"
,d29.jarjestys_iscle2011 as jarj_isced3_koulast1
,d29.jarjestys_Koulutusaste_taso2 as jarj_isced3_koulast2
,d29.jarjestys_iscfibroad2013 as jarj_isced3_koulala1
,d29.jarjestys_iscfinarrow2013 as jarj_isced3_koulala2
,d29.jarjestys_iscfi2013 as jarj_isced3_koulala3
,d29.jarjestys_OKM_ohjauksen_ala as jarj_isced3_okmohjaus1
,d29.iscle2011_koodi as "Koodit Seur. vuoden koulutusaste 1"
,d29.Koulutusaste_taso2_koodi as "Koodit Seur. vuoden koulutusaste 2"
,d29.iscfibroad2013_koodi as "Koodit Seur. vuoden koulutusala 1"
,d29.iscfinarrow2013_koodi as "Koodit Seur. vuoden koulutusala 2"
,d29.iscfi2013_koodi as "Koodit Seur. vuoden koulutusala 3"
,d29.OKM_ohjauksen_ala_koodi as "Koodit Seur. vuoden OKM ohjauksen ala"

--järjestysmuuttujat
,d3.jarjestys AS jarj_Sukupuoli
,d4.jarjestys AS jarj_Äidinkieli
,d5.jarjestys_ika AS jarj_Ikä
,d6.jarjestys_ika5v AS jarj_Ikäryhmä
,d7.jarjestys AS jarj_Asuinkunta
,d7.jarjestys_maakunta AS jarj_Asuinmaakunta
,d7.jarjestys_avi AS jarj_AsuinalueenAVI
,d7.jarjestys_ely AS jarj_AsuinalueenELY
,d8.jarjestys AS jarj_Kansalaisuus
,d9.jarjestys_eumaa AS jarj_EU_maankansalainen
,d10.jarjestys_etamaa AS jarj_ETA_maankansalainen
,d11.jarjestys AS jarj_Pohjoismaankansalainen
,d14.jarjestys AS jarj_Kirjoillaolo
,d15.jarjestys_oppilaitostyyppi as jarj_Oppilaitostyyppi
,d15.jarjestys_opetuskieli as jarj_Opetuskieli
,d15.jarjestys_omistajatyyppi as jarj_Oppil_omistajatyyppi
,d15.jarjestys_koulutuksen_jarjestajan_kieli as jarj_Koul_järjestäjänkieli
,d16.jarjestys_koulutusala2002 AS jarj_Koulutusala
,d16.jarjestys_opintoala1995
,d16.jarjestys_opintoala2002 AS jarj_Opintoala
,d16.jarjestys_koulutusaste2002 AS jarj_Koulutusaste
,d17.jarjestys AS jarj_Koulutuksenkieli
,d18.jarjestys AS jarj_Koulutuksenkunta
,d18.jarjestys_maakunta AS jarj_Koulutuksenmaakunta
,d18.jarjestys_avi AS jarj_KoulutuksenAVI_alue
,d18.jarjestys_ely AS jarj_KoulutuksenELY_alue
,d19.jarjestys AS jarj_Hallinnonala
,d20.jarjestys AS jarj_Koulutustyyppi
,d21.jarjestys_maakunta AS jarj_Tutk_suoritusmaakunta
,d22.jarjestys_koulutuksenjarjestaja AS jarj_Tutkinnon_koul_järjestäjän_omistajatyyppi
,d22.jarjestys_koulutuksen_jarjestajan_kieli AS jarj_Tutkinnon_koul_järjestäjän_kieli
,d23.jarjestys_oppilaitostyyppi AS jarj_Tutkinnon_oppilaitostyyppi
,d23.jarjestys_opetuskieli AS jarj_Tutkinnon_opetuskieli
,d23.jarjestys_omistajatyyppi AS jarj_Tutkinnon_oppil_omistajatyyppi
,d24.jarjestys_koulutusala2002 AS jarj_Tutkinnon_koulutusala_02_luokitus
,d24.jarjestys_opintoala1995 AS jarj_Tutkinnon_koulutusala_95_luokitus
,d24.jarjestys_opintoala2002 AS jarj_Tutkinnon_opintoala
,d24.jarjestys_koulutusaste2002 AS jarj_Tutkinnon_koulutusaste
,d25.jarjestys AS jarj_Tutkinnon_koulutustyyppi
,d26.jarjestys_maakunta AS jarj_Seur_vuoden_koul_maakunta
,d27.jarjestys_koulutuksenjarjestaja AS jarj_Seur_vuoden_koul_järjestäjän_omistajatyyppi
,d27.jarjestys_koulutuksen_jarjestajan_kieli AS jarj_Seur_vuoden_koul_järjestäjän_kieli
,d28.jarjestys_oppilaitostyyppi AS jarj_Seur_vuoden_oppilaitostyyppi
,d28.jarjestys_opetuskieli AS jarj_Seur_vuoden_opetuskieli
,d28.jarjestys_omistajatyyppi AS jarj_Seur_vuoden_oppil_omistajatyyppi
,d29.jarjestys_koulutusala2002 AS jarj_Seur_vuoden_koulutusala_02_luokitus
,d29.jarjestys_opintoala1995 AS jarj_Seur_vuoden_koulutusala_95_luokitus
,d29.jarjestys_opintoala2002 AS jarj_Seur_vuoden_opintoala
,d29.jarjestys_koulutusaste2002 AS jarj_Seur_vuoden_koulutusaste
,d30.jarjestys AS jarj_Seur_vuoden_koulutustyyppi
,d31.jarjestys AS jarj_Pääasiallinen_toiminta
,d32.jarjestys AS jarj_Ammattiasema

--,d33.jarjestys_1a
--,d34.jarjestys_1b
--,d35.jarjestys_1c
--,d36.jarjestys_1d
--,d37.jarjestys_1e
--,d38.jarjestys_1f

--,d39.jarjestys_2a
--,d40.jarjestys_2b
--,d41.jarjestys_2c
--,d42.jarjestys_2d
--,d43.jarjestys_2e
--,d44.jarjestys_2f

--,d45.jarjestys_3a
--,d46.jarjestys_3b
--,d47.jarjestys_3c
--,d48.jarjestys_3d
--,d49.jarjestys_3e
--,d50.jarjestys_3f

--,d51.jarjestys_4a
--,d52.jarjestys_4b
--,d53.jarjestys_4c
--,d54.jarjestys_4d
--,d55.jarjestys_4e
--,d56.jarjestys_4f

--,d57.jarjestys_5a
--,d58.jarjestys_5b
--,d59.jarjestys_5c
--,d60.jarjestys_5d
--,d61.jarjestys_5e
--,d62.jarjestys_5f

--,d63.jarjestys_6a
--,d64.jarjestys_6b
--,d65.jarjestys_6c
--,d66.jarjestys_6d
--,d67.jarjestys_6e
--,d68.jarjestys_6f

--,d69.jarjestys_7a
--,d70.jarjestys_7b
--,d71.jarjestys_7c
--,d72.jarjestys_7d
--,d73.jarjestys_7e
--,d74.jarjestys_7f
,d75.jarjestys_2bb
--,d76.jarjestys_3bb
--,d77.jarjestys_4bb
,d78.jarjestys_5bb

--koodimuuttujat
,d1.aineisto_koodi AS ''Koodit Aineisto''
,d2.lahde_koodi AS ''Koodit Lähde''
,d7.kunta_koodi AS ''Koodit Asuinkunta''
,d7.maakunta_koodi AS ''Koodit Asuinmaakunta''
,d15.oppilaitoskoodi AS ''Koodit Oppilaitos''
,d15.koulutuksen_jarjestajakoodi AS ''Koodit Koulutuksen järjestäjä''
,d16.koulutus_koodi AS ''Koodit Koulutusnimike''
,d16.koulutusala2002_koodi AS ''Koodit Koulutusala (02 luokitus)''
,d16.opintoala1995_koodi AS ''Koodit Koulutusala (95 luokitus)''
,d16.opintoala2002_koodi AS ''Koodit Opintoala''
,d16.koulutusaste2002_koodi AS ''Koodit Koulutusaste''
,d18.kunta_koodi AS ''Koodit Koulutuksen kunta''
,d18.maakunta_koodi AS ''Koodit Koulutuksen maakunta''
,d20.koulutustyyppi_koodi AS ''Koodit Koulutustyyppi''
,d21.maakunta_koodi AS ''Koodit Tutk. suoritusmaakunta''
,d22.koulutuksen_jarjestajakoodi AS ''Koodit Tutkinnon koul. järjestäjä''
,d23.oppilaitoskoodi AS ''Koodit Tutkinnon oppilaitos''
,d24.koulutus_koodi AS ''Koodit Tutkinnon koulutusnimike''
,d24.koulutusala2002_koodi AS ''Koodit Tutkinnon koulutusala (02 luokitus)''
,d24.opintoala1995_koodi AS ''Koodit Tutkinnon koulutusala (95 luokitus)''
,d24.opintoala2002_koodi AS ''Koodit Tutkinnon opintoala''
,d24.koulutusaste2002_koodi AS ''Koodit Tutkinnon koulutusaste''
,d25.koulutustyyppi_koodi AS ''Koodit Tutkinnon koulutustyyppi''
,d26.maakunta_koodi AS ''Koodit Seur. vuoden koul. maakunta''
,d27.koulutuksen_jarjestajakoodi AS ''Koodit Seur. vuoden koul. järjestäjä''
,d28.oppilaitoskoodi AS ''Koodit Seur. vuoden oppilaitos''
,d29.koulutus_koodi AS ''Koodit Seur. vuoden koulutusnimike''
,d29.koulutusala2002_koodi AS ''Koodit Seur. vuoden koulutusala (02 luokitus)''
,d29.opintoala1995_koodi AS ''Koodit Seur. vuoden koulutusala (95 luokitus)''
,d29.opintoala2002_koodi AS ''Koodit Seur. vuoden opintoala''
,d29.koulutusaste2002_koodi AS ''Koodit Seur. vuoden koulutusaste''
,d30.koulutustyyppi_koodi AS ''Koodit Seur. vuoden koulutustyyppi''

FROM dbo.f_keskeyttaneet
	JOIN d_aineisto d1 ON d1.id = aineisto_id
	JOIN d_lahde d2 ON d2.id = lahde_id
	JOIN d_sukupuoli d3 ON d3.id = sukupuoli_id
	JOIN d_aidinkieli_versio1 d4 ON d4.id = aidinkieli_versio1x_id
	JOIN d_ika d5 ON d5.id = ika_1v_id
	JOIN d_ika d6 ON d6.id = ika_5v_id
	JOIN d_alueluokitus d7 ON d7.id= kotikunta_id
	JOIN d_kansalaisuus_versio1 d8 ON d8.id= kansalaisuus_versio1_id
	JOIN d_valtio d9 ON d9.id= eumaa_id
	JOIN d_valtio d10 ON d10.id= etamaa_id
	JOIN d_pohjoismaa d11 ON d11.id= pohjoismaa_id
	JOIN d_kausi d12 ON d12.kausi_id= kirjoihintulovuosi_id
	JOIN d_opiskelijan_olo d14 ON d14.id= opiskelijan_olo_lk_id
	JOIN d_oppilaitoksen_taustatiedot d15 ON d15.id= oppilaitoksen_taustatiedot_id
	JOIN d_koulutusluokitus d16 ON d16.id= koulutusluokitus_id
	JOIN d_koulutuksen_kieli_versio1 d17 ON d17.id= koulutuksen_kieli_versio1_id
	JOIN d_alueluokitus d18 ON d18.id= koulutuksen_kunta_id
	JOIN d_opetushallinnon_koulutus d19 ON d19.id= opetushallinnon_koulutus_id
	JOIN d_koulutustyyppi d20 ON d20.id= koulutustyyppi_id
	JOIN d_alueluokitus d21 ON d21.id= tutkinnon_suorittamismaakunta_id
	JOIN d_oppilaitoksen_taustatiedot d22 ON d22.id= tutkinnon_jarjestaja_id
	JOIN d_oppilaitoksen_taustatiedot d23 ON d23.id= tutkinnon_suorittamisoppilaitos_id
	JOIN d_koulutusluokitus d24 ON d24.id= tutkinnon_koulutusluokitus_id
	JOIN d_koulutustyyppi d25 ON d25.id= tutkinnon_koulutustyyppi_id
	JOIN d_alueluokitus d26 ON d26.id= seuraavan_vuoden_maakunta_id
	JOIN d_oppilaitoksen_taustatiedot d27 ON d27.id= seuraavan_vuoden_jarjestaja_id
	JOIN d_oppilaitoksen_taustatiedot d28 ON d28.id= seuraavan_vuoden_oppilaitos_id
	JOIN d_koulutusluokitus d29 ON d29.id= seuraavan_vuoden_koulutusluokitus_id
	JOIN d_koulutustyyppi d30 ON d30.id= seuraavan_vuoden_koulutustyyppi_id
	JOIN d_paaasiallinen_toiminta_versio2 d31 ON d31.id = paaasiallinen_toiminta_versio2_id
	JOIN d_ammattiasema d32 ON d32.id = ammattiasema_id
	--JOIN d_opintojen_kulku_koulutusasteen_2002_mukaan  d33 ON d33.id = [1a_opiskelijoiden_opintojen_kulku_koulutusaste_2002_mukaan_id]
	--JOIN d_opintojen_kulku_koulutusasteen_2002_mukaan  d34 ON d34.id = [1b_opiskelijoiden_opintojen_kulku_koulutusaste_2002_mukaan_id]
	--JOIN d_tutkinto_alkuperaisella_koulutusasteella_2002  d35 ON d35.id = [1c_tutkinto_alkuperaisella_koulutusasteella_2002_id]
	--JOIN d_tutkinto_muulla_koulutusasteella_2002  d36 ON d36.id = [1d_tutkinto_muulla_koulutusasteella_2002_id]
	--JOIN d_jatkaa_opiskelua_alkuperaisella_koulutusasteella_2002 d37 ON d37.id = [1e_jatkaa_opiskelua_alkuperaisella_koulutusasteella_2002_id]
	--JOIN d_jatkaa_opiskelua_muulla_koulutusasteella_2002 d38 ON d38.id = [1f_jatkaa_opiskelua_muulla_koulutusasteella_2002_id]
	--JOIN d_opintojen_kulku_koulutusalan_2002_mukaan d39 ON d39.id = [2a_opiskelijoiden_opintojen_kulku_koulutusala_2002_mukaan_id]
	--JOIN d_opintojen_kulku_koulutusalan_2002_mukaan d40 ON d40.id = [2b_opiskelijoiden_opintojen_kulku_koulutusala_2002_mukaan_id]
	--JOIN d_tutkinto_alkuperaisella_koulutusalalla_2002  d41 ON d41.id = [2c_tutkinto_alkuperaisella_koulutusalalla_2002_id]
	--JOIN d_tutkinto_muulla_koulutusalalla_2002  d42 ON d42.id = [2d_tutkinto_muulla_koulutusalalla_2002_id]
	--JOIN d_jatkaa_opiskelua_alkuperaisella_koulutusalalla_2002  d43 ON d43.id = [2e_jatkaa_opiskelua_alkuperaisella_koulutusalalla_2002_id]
	--JOIN d_jatkaa_opiskelua_muulla_koulutusalalla_2002  d44 ON d44.id = [2f_jatkaa_opiskelua_muulla_koulutusalalla_2002_id]

	--JOIN d_opintojen_kulku_opintoalan_2002_mukaan d45 ON d45.id = [3a_opiskelijoiden_opintojen_kulku_opintoala_2002_mukaan_id]
	--JOIN d_opintojen_kulku_opintoalan_2002_mukaan d46 ON d46.id = [3b_opiskelijoiden_opintojen_kulku_opintoala_2002_mukaan_id]
	--JOIN d_tutkinto_alkuperaisella_opintoalalla_2002  d47 ON d47.id = [3c_tutkinto_alkuperaisella_opintoalalla_2002_id]
	--JOIN d_tutkinto_muulla_opintoalalla_2002  d48 ON d48.id = [3d_tutkinto_muulla_opintoalalla_2002_id]
	--JOIN d_jatkaa_opiskelua_alkuperaisella_opintoalalla_2002  d49 ON d49.id = [3e_jatkaa_opiskelua_alkuperaisella_opintoalalla_2002_id]
	--JOIN d_jatkaa_opiskelua_muulla_opintoalalla_2002  d50 ON d50.id = [3f_jatkaa_opiskelua_muulla_opintoalalla_2002_id]

	--JOIN d_opintojen_kulku_koulutuksen_jarjestajan_mukaan d51 ON d51.id = [4a_opiskelijoiden_opintojen_kulku_koul_jarjestajan_mukaan_id]
	--JOIN d_opintojen_kulku_koulutuksen_jarjestajan_mukaan d52 ON d52.id = [4b_opiskelijoiden_opintojen_kulku_koul_jarjestajan_mukaan_id]
	--JOIN d_tutkinto_alkuperaisella_koulutuksen_jarjestajalla  d53 ON d53.id = [4c_tutkinto_alkuperaisella_koulutuksen_jarjestajalla_id]
	--JOIN d_tutkinto_muulla_koulutuksen_jarjestajalla  d54 ON d54.id = [4d_tutkinto_muulla_koulutuksen_jarjestajalla_id]
	--JOIN d_jatkaa_opiskelua_alkuperaisella_koulutuksen_jarjestajalla  d55 ON d55.id = [4e_jatkaa_opiskelua_alkuperaisella_koulutuksen_jarjestajalla_id]
	--JOIN d_jatkaa_opiskelua_muulla_koulutuksen_jarjestajalla  d56 ON d56.id = [4f_jatkaa_opiskelua_muulla_koulutuksen_jarjestajalla_id]


	--JOIN d_opintojen_kulku_oppilaitoksen_mukaan d57 ON d57.id = [5a_opiskelijoiden_opintojen_kulku_oppilaitoksen_mukaan_id]
	--JOIN d_opintojen_kulku_oppilaitoksen_mukaan d58 ON d58.id = [5b_opiskelijoiden_opintojen_kulku_oppilaitoksen_mukaan_id]
	--JOIN d_tutkinto_alkuperaisessa_oppilaitoksessa  d59 ON d59.id = [5c_tutkinto_alkuperaisessa_oppilaitoksessa_id]
	--JOIN d_tutkinto_muussa_oppilaitoksessa  d60 ON d60.id = [5d_tutkinto_muussa_oppilaitoksessa_id]
	--JOIN d_jatkaa_opiskelua_alkuperaisessa_oppilaitoksessa  d61 ON d61.id = [5e_jatkaa_opiskelua_alkuperaisessa_oppilaitoksessa_id]
	--JOIN d_jatkaa_opiskelua_muussa_oppilaitoksessa d62 ON d62.id = [5f_jatkaa_opiskelua_muussa_oppilaitoksessa_id]

	--JOIN d_opintojen_kulku_maakunnan_mukaan d63 ON d63.id = [6a_opiskelijoiden_opintojen_kulku_maakunnan_mukaan_id]
	--JOIN d_opintojen_kulku_maakunnan_mukaan d64 ON d64.id = [6b_opiskelijoiden_opintojen_kulku_maakunnan_mukaan_id]
	--JOIN d_tutkinto_alkuperaisessa_maakunnassa  d65 ON d65.id = [6c_tutkinto_alkuperaisessa_maakunnassa_id]
	--JOIN d_tutkinto_muussa_maakunnassa  d66 ON d66.id = [6d_tutkinto_muussa_maakunnassa_id]
	--JOIN d_jatkaa_opiskelua_alkuperaisessa_maakunnassa  d67 ON d67.id = [6e_jatkaa_opiskelua_alkuperaisessa_maakunnassa_id]
	--JOIN d_jatkaa_opiskelua_muussa_maakunnassa d68 ON d68.id = [6f_jatkaa_opiskelua_muussa_maakunnassa_id]

	--JOIN d_opintojen_kulku_koulutussektorin_mukaan d69 ON d69.id = [7a_opiskelijoiden_opintojen_kulku_koulutussektorin_mukaan_id]
	--JOIN d_opintojen_kulku_koulutussektorin_mukaan d70 ON d70.id = [7b_opiskelijoiden_opintojen_kulku_koulutussektorin_mukaan_id]
	--JOIN d_tutkinto_alkuperaisella_koulutussektorilla d71 ON d71.id = [7c_tutkinto_alkuperaisella_koulutussektorilla_id]
	--JOIN d_tutkinto_muulla_koulutussektorilla d72 ON d72.id = [7d_tutkinto_muulla_koulutussektorilla_id]
	--JOIN d_jatkaa_opiskelua_alkuperaisella_koulutussektorilla d73 ON d73.id = [7e_jatkaa_opiskelua_alkuperaisella_koulutussektorilla_id]
	--JOIN d_jatkaa_opiskelua_muulla_koulutussektorilla d74 ON d74.id = [7f_jatkaa_opiskelua_muulla_koulutussektorilla_id]

	JOIN d_opintojen_kulku_koulutusalan_2002_mukaan_versio2 d75 ON d75.id = [2bb_opiskelijoiden_opintojen_kulku_koulutusala_2002_mukaan_id]
	--JOIN d_opintojen_kulku_opintoalan_2002_mukaan_versio2 d76 ON d76.id = [3bb_opiskelijoiden_opintojen_kulku_opintoala_2002_mukaan_id]
	--JOIN d_opintojen_kulku_koulutuksen_jarjestajan_mukaan_versio2 d77 ON d77.id = [4bb_opiskelijoiden_opintojen_kulku_koul_jarjestajan_mukaan_id]
	JOIN d_opintojen_kulku_oppilaitoksen_mukaan_versio2 d78 ON d78.id = [5bb_opiskelijoiden_opintojen_kulku_oppilaitoksen_mukaan_id]

WHERE d28.oppilaitoskoodi <> 02557 AND d28.oppilaitoskoodi <> 10031 AND (d16.koulutusaste2002_koodi = 62 OR d16.koulutusaste2002_koodi = 71) and ((tilastovuosi = ''2015'' And d1.aineisto_koodi = ''E'') Or (d1.aineisto_koodi = ''L''))











' 
GO
/****** Object:  View [dbo].[v_f_tab_keskeytaneet_amm]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_keskeytaneet_amm]'))
EXEC dbo.sp_executesql @statement = N'






CREATE VIEW [dbo].[v_f_tab_keskeytaneet_amm] AS

Select
[opiskelijat] AS lkm_int,
[tilastovuosi] AS Tilastovuosi
,d1.aineisto AS Aineisto
,d2.lahde AS Lähde
,d3.sukupuoli AS Sukupuoli
,d4.aidinkieli_versio1 AS Äidinkieli
,d5.ika AS Ikä
,d6.ika AS Ikäryhmä
,d7.kunta AS Asuinkunta
,d7.maakunta AS Asuinmaakunta
,d7.avi AS ''Asuinalueen AVI''
,d7.ely AS ''Asuinalueen ELY''
,d8.kansalaisuus_versio1 AS Kansalaisuus
,d9.eumaa AS ''EU-maan kansalainen''
,d10.etamaa AS ''ETA-maan kansalainen''
,d11.pohjoismaa AS ''Pohjoismaan kansalainen''
,d12.vuosiselite AS Aloitusvuosi
,d13.lukukausiselite AS Aloituslukukausi
,d14.opiskelijan_olo AS Kirjoillaolo
,d15.oppilaitos as "Oppilaitos"
,d15.oppilaitostyyppi as "Oppilaitostyyppi"
,d15.opetuskieli as "Opetuskieli"
,d15.oppilaitoksen_omistajatyyppi as "Oppil. omistajatyyppi"
,d15.koulutuksen_jarjestaja as "Koulutuksen järjestäjä"
,d15.koulutuksen_jarjestajan_kieli as "Koul. järjestäjän kieli"
,d16.koulutus AS Koulutusnimike
,d16.koulutusala2002 AS Koulutusala
,d16.koulutusala2002 AS "Koulutusala (02 luokitus)"
,d16.opintoala1995 AS "Koulutusala (95 luokitus)"
,d16.opintoala2002 AS Opintoala
,d16.koulutusaste2002 AS Koulutusaste
,d17.koulutuksen_kieli_versio1 AS ''Koulutuksen kieli''
,d18.kunta AS ''Koulutuksen kunta''
,d18.maakunta AS ''Koulutuksen maakunta''
,d18.avi AS "Koulutuksen AVI-alue"
,d18.ely AS "Koulutuksen ELY-alue"
,d19.opetushallinnon_koulutus AS Hallinnonala
,d20.koulutustyyppi AS Koulutustyyppi
,d21.maakunta AS ''Tutk. suoritusmaakunta''
,d22.koulutuksen_jarjestaja AS ''Tutkinnon koul. järjestäjä''
,d22.koulutuksen_jarjestajan_omistajatyyppi AS ''Tutkinnon koul. järjestäjän omistajatyyppi''
,d22.koulutuksen_jarjestajan_kieli ''Tutkinnon koul. järjestäjän kieli''
,d22.koulutuksen_jarjestajan_sijaintikunta AS ''Tutkinnon koul. järjestäjän sijaintikunta''
,d23.oppilaitos AS ''Tutkinnon oppilaitos''
,d23.oppilaitostyyppi as "Tutkinnon oppilaitostyyppi"
,d23.opetuskieli as "Tutkinnon opetuskieli"
,d23.oppilaitoksen_omistajatyyppi as "Tutkinnon oppil. omistajatyyppi"
,d24.koulutus AS ''Tutkinnon koulutusnimike''
,d24.koulutusala2002 AS ''Tutkinnon koulutusala''
,d24.koulutusala2002 AS ''Tutkinnon koulutusala (02 luokitus)''
,d24.opintoala1995 AS "Tutkinnon koulutusala (95 luokitus)"
,d24.opintoala2002 AS ''Tutkinnon opintoala''
,d24.koulutusaste2002 AS ''Tutkinnon koulutusaste''
,d25.koulutustyyppi AS ''Tutkinnon koulutustyyppi''
,d26.maakunta AS ''Seur. vuoden koul. maakunta''
,d27.koulutuksen_jarjestaja AS ''Seur. vuoden koul. järjestäjä''
,d27.koulutuksen_jarjestajan_omistajatyyppi AS ''Seur. vuoden koul. järjestäjän omistajatyyppi''
,d27.koulutuksen_jarjestajan_kieli ''Seur. vuoden koul. järjestäjän kieli''
,d27.koulutuksen_jarjestajan_sijaintikunta AS ''Seur. vuoden koul. järjestäjän sijaintikunta''
,d28.oppilaitos AS ''Seur. vuoden oppilaitos''
,d28.oppilaitostyyppi as "Seur. vuoden oppilaitostyyppi"
,d28.opetuskieli as "Seur. vuoden opetuskieli"
,d28.oppilaitoksen_omistajatyyppi as "Seur. vuoden oppil. omistajatyyppi"
,d29.koulutus AS ''Seur. vuoden koulutusnimike''
,d29.koulutusala2002 AS ''Seur. vuoden koulutusala''
,d29.koulutusala2002 AS ''Seur. vuoden koulutusala (02 luokitus)''
,d29.opintoala1995 AS "Seur. vuoden koulutusala (95 luokitus)"
,d29.opintoala2002 AS ''Seur. vuoden opintoala''
,d29.koulutusaste2002 AS ''Seur. vuoden koulutusaste''
,d30.koulutustyyppi  AS ''Seur. vuoden koulutustyyppi''
,d31.paaasiallinen_toiminta_versio2 AS ''Pääasiallinen toiminta''
,d32.ammattiasema AS Ammattiasema

,d33.opintojen_kulku_koulutusasteen_2002_mukaan AS ''1a Opintojen kulku (koulutusaste)''
,d34.opintojen_kulku_koulutusasteen_2002_mukaan AS ''1b Opintojen kulku (koulutusaste)''
,d35.tutkinto_alkuperaisella_koulutusasteella_2002 AS ''Tutk. suor. alkup. koul.asteella''
,d36.tutkinto_muulla_koulutusasteella_2002 AS ''Tutk. suor. muulla koul.asteella''
,d37.jatkaa_opiskelua_alkuperaisella_koulutusasteella_2002 AS ''Jatkaa opisk. alkup. koul.asteella''
,d38.jatkaa_opiskelua_muulla_koulutusasteella_2002 AS ''Jatkaa opisk. muulla koul.asteella''

,d39.opintojen_kulku_koulutusalan_2002_mukaan AS ''2a Opintojen kulku (koulutusala)''
,d40.opintojen_kulku_koulutusalan_2002_mukaan AS ''2b Opintojen kulku (koulutusala)''
,d41.tutkinto_alkuperaisella_koulutusalalla_2002 AS ''Tutk. suor. alkup. koul.alalla''
,d42.tutkinto_muulla_koulutusalalla_2002 AS ''Tutk. suor. muulla koul.alalla''
,d43.jatkaa_opiskelua_alkuperaisella_koulutusalalla_2002 AS ''Jatkaa opisk. alkup. koul.alalla''
,d44.jatkaa_opiskelua_muulla_koulutusalalla_2002 AS ''Jatkaa opisk. muulla koul.alalla''

,d45.opintojen_kulku_opintoala_2002_mukaan AS ''3a Opintojen kulku (opintoala)''
,d46.opintojen_kulku_opintoala_2002_mukaan AS ''3b Opintojen kulku (opintoala)''
,d47.tutkinto_alkuperaisella_opintoalalla_2002 AS ''Tutk. suor. alkup. opintoalalla''
,d48.tutkinto_muulla_opintoalalla_2002 AS ''Tutk. suor. muulla opintoalalla''
,d49.jatkaa_opiskelua_alkuperaisella_opintoalalla_2002 AS ''Jatkaa opisk. alkup. opintoalalla''
,d50.jatkaa_opiskelua_muulla_opintoalalla_2002 AS ''Jatkaa opisk. muulla opintoalalla''

,d51.opintojen_kulku_koulutuksen_jarjestajan_mukaan AS ''4a Opintojen kulku (koulutuksen jarjestaja)''
,d52.opintojen_kulku_koulutuksen_jarjestajan_mukaan AS ''4b Opintojen kulku (koulutuksen jarjestaja)''
,d53.tutkinto_alkuperaisella_koulutuksen_jarjestajalla AS ''Tutk. suor. alkup. koul. järjestäjällä''
,d54.tutkinto_muulla_koulutuksen_jarjestajalla AS ''Tutk. suor. muulla koul. järjestäjällä''
,d55.jatkaa_opiskelua_alkuperaisella_koulutuksen_jarjestajalla AS ''Jatkaa opisk. alkup. koul. järjestäjällä''
,d56.jatkaa_opiskelua_muulla_koulutuksen_jarjestajalla AS ''Jatkaa opisk. muulla koul. järjestäjällä''

,d57.opintojen_kulku_oppilaitoksen_mukaan AS ''5a Opintojen kulku (oppilaitos)''
,d58.opintojen_kulku_oppilaitoksen_mukaan AS ''5b Opintojen kulku (oppilaitos)''
,d59.tutkinto_alkuperaisessa_oppilaitoksessa AS ''Tutk. suor. alkup. oppilaitoksessa''
,d60.tutkinto_muussa_oppilaitoksessa AS ''Tutk. suor. muussa oppilaitoksessa''
,d61.jatkaa_opiskelua_alkuperaisessa_oppilaitoksessa AS ''Jatkaa opisk. alkup. oppilaitoksessa''
,d62.jatkaa_opiskelua_muussa_oppilaitoksessa AS ''Jatkaa opisk. muussa oppilaitoksessa''

,d63.opintojen_kulku_maakunnan_mukaan AS ''6a Opintojen kulku (maakunta)''
,d64.opintojen_kulku_maakunnan_mukaan AS ''6b Opintojen kulku (maakunta)''
,d65.tutkinto_alkuperaisessa_maakunnassa AS ''Tutk. suor. alkup. maakunnassa''
,d66.tutkinto_muussa_maakunnassa AS ''Tutk. suor. muussa maakunnassa''
,d67.jatkaa_opiskelua_alkuperaisessa_maakunnassa AS ''Jatkaa opisk. alkup. maakunnassa''
,d68.jatkaa_opiskelua_muussa_maakunnassa AS ''Jatkaa opisk. muussa maakunnassa''

,d69.opintojen_kulku_koulutussektorin_mukaan AS ''7a Opintojen kulku (koulutussektori)''
,d70.opintojen_kulku_koulutussektorin_mukaan AS ''7b Opintojen kulku (koulutussektori)''
,d71.tutkinto_alkuperaisella_koulutussektorilla AS ''Tutk. suor. alkup. koul.sektorilla''
,d72.tutkinto_muulla_koulutussektorilla AS ''Tutk. suor. muulla koul.sektorilla''
,d73.jatkaa_opiskelua_alkuperaisella_koulutussektorilla AS ''Jatkaa opisk. alkup. koul.sektorilla''
,d74.jatkaa_opiskelua_muulla_koulutussektorilla AS ''Jatkaa opisk. muulla koul.sektorilla''


--Ruotsi
,[tilastovuosi] AS Statistikår
,d19.opetushallinnon_koulutus_SV AS Förvaltningsområde
,d3.sukupuoli_SV AS Kön
,d4.aidinkieli_versio1_SV AS Modersmål
,d6.ika_SV AS Åldersgrupp
,d7.kunta_SV AS Bostadskommun
,d7.maakunta_SV AS Bostadslandskap
,d8.kansalaisuus_versio1_SV AS Medborgarskap
,d17.koulutuksen_kieli_versio1_SV AS [Utbildningens språk]
,d18.kunta_SV AS [Ubildningens kommun]
,d18.maakunta_SV AS [Utbildningens landskap]
,d21.maakunta_SV AS [Landskap där examen avlagts]
,d15.koulutuksen_jarjestaja_SV as [Utbildningsanordnare]
,d15.oppilaitos_SV as [Läroanstalt]
,d33.opintojen_kulku_koulutusasteen_2002_mukaan_SV AS ''Studieförlopp (utb.nivå)''
,d39.opintojen_kulku_koulutusalan_2002_mukaan_SV AS ''Studieförlopp (utb.område)''
,d51.opintojen_kulku_koulutuksen_jarjestajan_mukaan_SV AS ''Studieförlopp (utb.anordnare)''
,d63.opintojen_kulku_maakunnan_mukaan_SV AS ''Studieförlopp (landskap)''
,d16.koulutus_SV AS [Utbildningsbenämning (2002)]
,d16.opintoala2002_SV AS [Studieområde (2002)]
,d16.koulutusala2002_SV AS  [Utbildningsområde (2002)]
,d16.koulutusaste2002_SV AS [Utbildningsnivå (2002)]

--Englanti
,[tilastovuosi] AS [Statistical year]
,d19.opetushallinnon_koulutus_EN AS [Administrative sector]
,d3.sukupuoli_EN AS Gender
,d4.aidinkieli_versio1_EN AS [Mother tongue]
,d6.ika_EN AS [Age group]
,d7.kunta_EN AS [Municipality of residence]
,d7.maakunta_EN AS [Region of residence]
,d8.kansalaisuus_versio1_EN AS Nationality
,d17.koulutuksen_kieli_versio1_EN AS [Language of education]
,d18.kunta_EN AS [Municipality of education]
,d18.maakunta_EN AS [Region of education]
,d21.maakunta_EN AS [Region of degree]
,d15.koulutuksen_jarjestaja_EN as [Education provider]
,d15.oppilaitos_EN as [Educational institution]
,d33.opintojen_kulku_koulutusasteen_2002_mukaan_EN AS ''Progress of studies (level of ed.)''
,d39.opintojen_kulku_koulutusalan_2002_mukaan_EN AS ''Progress of studies (field of ed.)''
,d51.opintojen_kulku_koulutuksen_jarjestajan_mukaan_EN AS ''Progress of studies (ed. provider)''
,d63.opintojen_kulku_maakunnan_mukaan_EN AS ''Progress of studies (region)''
,d16.koulutus_EN AS [Name of education (2002)]
,d16.opintoala2002_EN AS [Subfield of education (2002)]
,d16.koulutusala2002_EN AS "Field of education (2002)"
,d16.koulutusaste2002_EN AS [Level of education (2002)]

--isced
,d16.iscle2011 as "Koulutusaste, taso 1"
,d16.Koulutusaste_taso2 as "Koulutusaste, taso 2"
,d16.iscfibroad2013 as "Koulutusala, taso 1"
,d16.iscfinarrow2013 as "Koulutusala, taso 2"
,d16.iscfi2013 as "Koulutusala, taso 3"
,d16.OKM_ohjauksen_ala as "OKM ohjauksen ala"
,d16.iscle2011_SV as "Utbildn.nivå, nivå 1"
,d16.Koulutusaste_taso2_SV as "Utbildn.nivå, nivå 2"
,d16.iscfibroad2013_SV as "Utbildn.område, nivå 1"
,d16.iscfinarrow2013_SV as "Utbildn.område, nivå 2"
,d16.iscfi2013_SV as "Utbildn.område, nivå 3"
,d16.OKM_ohjauksen_ala_SV as "UKM-styrningsområde"
,d16.iscle2011_EN as "Level of education, tier 1"
,d16.Koulutusaste_taso2_EN as "Level of education, tier 2"
,d16.iscfibroad2013_EN as "Field of education, tier 1"
,d16.iscfinarrow2013_EN as "Field of education, tier 2"
,d16.iscfi2013_EN as "Field of education, tier 3"
,d16.OKM_ohjauksen_ala_EN as "Field of ed., HE steering"
,d16.jarjestys_iscle2011 as jarj_isced_koulast1
,d16.jarjestys_Koulutusaste_taso2 as jarj_isced_koulast2
,d16.jarjestys_iscfibroad2013 as jarj_isced_koulala1
,d16.jarjestys_iscfinarrow2013 as jarj_isced_koulala2
,d16.jarjestys_iscfi2013 as jarj_isced_koulala3
,d16.jarjestys_OKM_ohjauksen_ala as jarj_isced_okmohjaus1
,d16.iscle2011_koodi as "Koodit Koulutusaste, taso 1"
,d16.Koulutusaste_taso2_koodi as "Koodit Koulutusaste, taso 2"
,d16.iscfibroad2013_koodi as "Koodit Koulutusala, taso 1"
,d16.iscfinarrow2013_koodi as "Koodit Koulutusala, taso 2"
,d16.iscfi2013_koodi as "Koodit Koulutusala, taso 3"
,d16.OKM_ohjauksen_ala_koodi as "Koodit OKM ohjauksen ala"
,d24.iscle2011 as "Tutkinnon koulutusaste 1"
,d24.Koulutusaste_taso2 as "Tutkinnon koulutusaste 2"
,d24.iscfibroad2013 as "Tutkinnon koulutusala 1"
,d24.iscfinarrow2013 as "Tutkinnon koulutusala 2"
,d24.iscfi2013 as "Tutkinnon koulutusala 3"
,d24.OKM_ohjauksen_ala as "Tutkinnon OKM ohjauksen ala"
,d24.jarjestys_iscle2011 as jarj_isced2_koulast1
,d24.jarjestys_Koulutusaste_taso2 as jarj_isced2_koulast2
,d24.jarjestys_iscfibroad2013 as jarj_isced2_koulala1
,d24.jarjestys_iscfinarrow2013 as jarj_isced2_koulala2
,d24.jarjestys_iscfi2013 as jarj_isced2_koulala3
,d24.jarjestys_OKM_ohjauksen_ala as jarj_isced2_okmohjaus1
,d24.iscle2011_koodi as "Koodit Tutkinnon koulutusaste 1"
,d24.Koulutusaste_taso2_koodi as "Koodit Tutkinnon koulutusaste 2"
,d24.iscfibroad2013_koodi as "Koodit Tutkinnon koulutusala 1"
,d24.iscfinarrow2013_koodi as "Koodit Tutkinnon koulutusala 2"
,d24.iscfi2013_koodi as "Koodit Tutkinnon koulutusala 3"
,d24.OKM_ohjauksen_ala_koodi as "Koodit Tutkinnon OKM ohjauksen ala"
,d29.iscle2011 as "Seur. vuoden koulutusaste 1"
,d29.Koulutusaste_taso2 as "Seur. vuoden koulutusaste 2"
,d29.iscfibroad2013 as "Seur. vuoden koulutusala 1"
,d29.iscfinarrow2013 as "Seur. vuoden koulutusala 2"
,d29.iscfi2013 as "Seur. vuoden koulutusala 3"
,d29.OKM_ohjauksen_ala as "Seur. vuoden OKM ohjauksen ala"
,d29.jarjestys_iscle2011 as jarj_isced3_koulast1
,d29.jarjestys_Koulutusaste_taso2 as jarj_isced3_koulast2
,d29.jarjestys_iscfibroad2013 as jarj_isced3_koulala1
,d29.jarjestys_iscfinarrow2013 as jarj_isced3_koulala2
,d29.jarjestys_iscfi2013 as jarj_isced3_koulala3
,d29.jarjestys_OKM_ohjauksen_ala as jarj_isced3_okmohjaus1
,d29.iscle2011_koodi as "Koodit Seur. vuoden koulutusaste 1"
,d29.Koulutusaste_taso2_koodi as "Koodit Seur. vuoden koulutusaste 2"
,d29.iscfibroad2013_koodi as "Koodit Seur. vuoden koulutusala 1"
,d29.iscfinarrow2013_koodi as "Koodit Seur. vuoden koulutusala 2"
,d29.iscfi2013_koodi as "Koodit Seur. vuoden koulutusala 3"
,d29.OKM_ohjauksen_ala_koodi as "Koodit Seur. vuoden OKM ohjauksen ala"

--järjestysmuuttujat
,d3.jarjestys AS jarj_Sukupuoli
,d4.jarjestys AS jarj_Äidinkieli
,d5.jarjestys_ika AS jarj_Ikä
,d6.jarjestys_ika5v AS jarj_Ikäryhmä
,d7.jarjestys AS jarj_Asuinkunta
,d7.jarjestys_maakunta AS jarj_Asuinmaakunta
,d7.jarjestys_avi AS jarj_AsuinalueenAVI
,d7.jarjestys_ely AS jarj_AsuinalueenELY
,d8.jarjestys AS jarj_Kansalaisuus
,d9.jarjestys_eumaa AS jarj_EU_maankansalainen
,d10.jarjestys_etamaa AS jarj_ETA_maankansalainen
,d11.jarjestys AS jarj_Pohjoismaankansalainen
,d14.jarjestys AS jarj_Kirjoillaolo
,d15.jarjestys_oppilaitostyyppi as jarj_Oppilaitostyyppi
,d15.jarjestys_opetuskieli as jarj_Opetuskieli
,d15.jarjestys_omistajatyyppi as jarj_Oppil_omistajatyyppi
,d15.jarjestys_koulutuksen_jarjestajan_kieli as jarj_Koul_järjestäjänkieli
,d16.jarjestys_koulutusala2002 AS jarj_Koulutusala
,d16.jarjestys_opintoala1995
,d16.jarjestys_opintoala2002 AS jarj_Opintoala
,d16.jarjestys_koulutusaste2002 AS jarj_Koulutusaste
,d17.jarjestys AS jarj_Koulutuksenkieli
,d18.jarjestys AS jarj_Koulutuksenkunta
,d18.jarjestys_maakunta AS jarj_Koulutuksenmaakunta
,d18.jarjestys_avi AS jarj_KoulutuksenAVI_alue
,d18.jarjestys_ely AS jarj_KoulutuksenELY_alue
,d19.jarjestys AS jarj_Hallinnonala
,d20.jarjestys AS jarj_Koulutustyyppi
,d21.jarjestys_maakunta AS jarj_Tutk_suoritusmaakunta
,d22.jarjestys_koulutuksenjarjestaja AS jarj_Tutkinnon_koul_järjestäjän_omistajatyyppi
,d22.jarjestys_koulutuksen_jarjestajan_kieli AS jarj_Tutkinnon_koul_järjestäjän_kieli
,d23.jarjestys_oppilaitostyyppi AS jarj_Tutkinnon_oppilaitostyyppi
,d23.jarjestys_opetuskieli AS jarj_Tutkinnon_opetuskieli
,d23.jarjestys_omistajatyyppi AS jarj_Tutkinnon_oppil_omistajatyyppi
,d24.jarjestys_koulutusala2002 AS jarj_Tutkinnon_koulutusala_02_luokitus
,d24.jarjestys_opintoala1995 AS jarj_Tutkinnon_koulutusala_95_luokitus
,d24.jarjestys_opintoala2002 AS jarj_Tutkinnon_opintoala
,d24.jarjestys_koulutusaste2002 AS jarj_Tutkinnon_koulutusaste
,d25.jarjestys AS jarj_Tutkinnon_koulutustyyppi
,d26.jarjestys_maakunta AS jarj_Seur_vuoden_koul_maakunta
,d27.jarjestys_koulutuksenjarjestaja AS jarj_Seur_vuoden_koul_järjestäjän_omistajatyyppi
,d27.jarjestys_koulutuksen_jarjestajan_kieli AS jarj_Seur_vuoden_koul_järjestäjän_kieli
,d28.jarjestys_oppilaitostyyppi AS jarj_Seur_vuoden_oppilaitostyyppi
,d28.jarjestys_opetuskieli AS jarj_Seur_vuoden_opetuskieli
,d28.jarjestys_omistajatyyppi AS jarj_Seur_vuoden_oppil_omistajatyyppi
,d29.jarjestys_koulutusala2002 AS jarj_Seur_vuoden_koulutusala_02_luokitus
,d29.jarjestys_opintoala1995 AS jarj_Seur_vuoden_koulutusala_95_luokitus
,d29.jarjestys_opintoala2002 AS jarj_Seur_vuoden_opintoala
,d29.jarjestys_koulutusaste2002 AS jarj_Seur_vuoden_koulutusaste
,d30.jarjestys AS jarj_Seur_vuoden_koulutustyyppi
,d31.jarjestys AS jarj_Pääasiallinen_toiminta
,d32.jarjestys AS jarj_Ammattiasema

,d33.jarjestys_1a
,d34.jarjestys_1b
,d35.jarjestys_1c
,d36.jarjestys_1d
,d37.jarjestys_1e
,d38.jarjestys_1f

,d39.jarjestys_2a
,d40.jarjestys_2b
,d41.jarjestys_2c
,d42.jarjestys_2d
,d43.jarjestys_2e
,d44.jarjestys_2f

,d45.jarjestys_3a
,d46.jarjestys_3b
,d47.jarjestys_3c
,d48.jarjestys_3d
,d49.jarjestys_3e
,d50.jarjestys_3f

,d51.jarjestys_4a
,d52.jarjestys_4b
,d53.jarjestys_4c
,d54.jarjestys_4d
,d55.jarjestys_4e
,d56.jarjestys_4f

,d57.jarjestys_5a
,d58.jarjestys_5b
,d59.jarjestys_5c
,d60.jarjestys_5d
,d61.jarjestys_5e
,d62.jarjestys_5f

,d63.jarjestys_6a
,d64.jarjestys_6b
,d65.jarjestys_6c
,d66.jarjestys_6d
,d67.jarjestys_6e
,d68.jarjestys_6f

,d69.jarjestys_7a
,d70.jarjestys_7b
,d71.jarjestys_7c
,d72.jarjestys_7d
,d73.jarjestys_7e
,d74.jarjestys_7f


--koodimuuttujat
,d1.aineisto_koodi AS ''Koodit Aineisto''
,d2.lahde_koodi AS ''Koodit Lähde''
,d7.kunta_koodi AS ''Koodit Asuinkunta''
,d7.maakunta_koodi AS ''Koodit Asuinmaakunta''
,d15.oppilaitoskoodi AS ''Koodit Oppilaitos''
,d15.koulutuksen_jarjestajakoodi AS ''Koodit Koulutuksen järjestäjä''
,d16.koulutus_koodi AS ''Koodit Koulutusnimike''
,d16.koulutusala2002_koodi AS ''Koodit Koulutusala (02 luokitus)''
,d16.opintoala1995_koodi AS ''Koodit Koulutusala (95 luokitus)''
,d16.opintoala2002_koodi AS ''Koodit Opintoala''
,d16.koulutusaste2002_koodi AS ''Koodit Koulutusaste''
,d18.kunta_koodi AS ''Koodit Koulutuksen kunta''
,d18.maakunta_koodi AS ''Koodit Koulutuksen maakunta''
,d20.koulutustyyppi_koodi AS ''Koodit Koulutustyyppi''
,d21.maakunta_koodi AS ''Koodit Tutk. suoritusmaakunta''
,d22.koulutuksen_jarjestajakoodi AS ''Koodit Tutkinnon koul. järjestäjä''
,d23.oppilaitoskoodi AS ''Koodit Tutkinnon oppilaitos''
,d24.koulutus_koodi AS ''Koodit Tutkinnon koulutusnimike''
,d24.koulutusala2002_koodi AS ''Koodit Tutkinnon koulutusala (02 luokitus)''
,d24.opintoala1995_koodi AS ''Koodit Tutkinnon koulutusala (95 luokitus)''
,d24.opintoala2002_koodi AS ''Koodit Tutkinnon opintoala''
,d24.koulutusaste2002_koodi AS ''Koodit Tutkinnon koulutusaste''
,d25.koulutustyyppi_koodi AS ''Koodit Tutkinnon koulutustyyppi''
,d26.maakunta_koodi AS ''Koodit Seur. vuoden koul. maakunta''
,d27.koulutuksen_jarjestajakoodi AS ''Koodit Seur. vuoden koul. järjestäjä''
,d28.oppilaitoskoodi AS ''Koodit Seur. vuoden oppilaitos''
,d29.koulutus_koodi AS ''Koodit Seur. vuoden koulutusnimike''
,d29.koulutusala2002_koodi AS ''Koodit Seur. vuoden koulutusala (02 luokitus)''
,d29.opintoala1995_koodi AS ''Koodit Seur. vuoden koulutusala (95 luokitus)''
,d29.opintoala2002_koodi AS ''Koodit Seur. vuoden opintoala''
,d29.koulutusaste2002_koodi AS ''Koodit Seur. vuoden koulutusaste''
,d30.koulutustyyppi_koodi AS ''Koodit Seur. vuoden koulutustyyppi''

FROM dbo.f_keskeyttaneet
	JOIN d_aineisto d1 ON d1.id = aineisto_id
	JOIN d_lahde d2 ON d2.id = lahde_id
	JOIN d_sukupuoli d3 ON d3.id = sukupuoli_id
	JOIN d_aidinkieli_versio1 d4 ON d4.id = aidinkieli_versio1x_id
	JOIN d_ika d5 ON d5.id = ika_1v_id
	JOIN d_ika d6 ON d6.id = ika_5v_id
	JOIN d_alueluokitus d7 ON d7.id= kotikunta_id
	JOIN d_kansalaisuus_versio1 d8 ON d8.id= kansalaisuus_versio1_id
	JOIN d_valtio d9 ON d9.id= eumaa_id
	JOIN d_valtio d10 ON d10.id= etamaa_id
	JOIN d_pohjoismaa d11 ON d11.id= pohjoismaa_id
	JOIN d_kausi d12 ON d12.kausi_id= kirjoihintulovuosi_id
	JOIN d_kausi d13 ON d13.kausi_id= kirjoihintulolukukausi_id
	JOIN d_opiskelijan_olo d14 ON d14.id= opiskelijan_olo_lk_id
	JOIN d_oppilaitoksen_taustatiedot d15 ON d15.id= oppilaitoksen_taustatiedot_id
	JOIN d_koulutusluokitus d16 ON d16.id= koulutusluokitus_id
	JOIN d_koulutuksen_kieli_versio1 d17 ON d17.id= koulutuksen_kieli_versio1_id
	JOIN d_alueluokitus d18 ON d18.id= koulutuksen_kunta_id
	JOIN d_opetushallinnon_koulutus d19 ON d19.id= opetushallinnon_koulutus_id
	JOIN d_koulutustyyppi d20 ON d20.id= koulutustyyppi_id
	JOIN d_alueluokitus d21 ON d21.id= tutkinnon_suorittamismaakunta_id
	JOIN d_oppilaitoksen_taustatiedot d22 ON d22.id= tutkinnon_jarjestaja_id
	JOIN d_oppilaitoksen_taustatiedot d23 ON d23.id= tutkinnon_suorittamisoppilaitos_id
	JOIN d_koulutusluokitus d24 ON d24.id= tutkinnon_koulutusluokitus_id
	JOIN d_koulutustyyppi d25 ON d25.id= tutkinnon_koulutustyyppi_id
	JOIN d_alueluokitus d26 ON d26.id= seuraavan_vuoden_maakunta_id
	JOIN d_oppilaitoksen_taustatiedot d27 ON d27.id= seuraavan_vuoden_jarjestaja_id
	JOIN d_oppilaitoksen_taustatiedot d28 ON d28.id= seuraavan_vuoden_oppilaitos_id
	JOIN d_koulutusluokitus d29 ON d29.id= seuraavan_vuoden_koulutusluokitus_id
	JOIN d_koulutustyyppi d30 ON d30.id= seuraavan_vuoden_koulutustyyppi_id
	JOIN d_paaasiallinen_toiminta_versio2 d31 ON d31.id = paaasiallinen_toiminta_versio2_id
	JOIN d_ammattiasema d32 ON d32.id = ammattiasema_id
	JOIN d_opintojen_kulku_koulutusasteen_2002_mukaan  d33 ON d33.id = [1a_opiskelijoiden_opintojen_kulku_koulutusaste_2002_mukaan_id]
	JOIN d_opintojen_kulku_koulutusasteen_2002_mukaan  d34 ON d34.id = [1b_opiskelijoiden_opintojen_kulku_koulutusaste_2002_mukaan_id]
	JOIN d_tutkinto_alkuperaisella_koulutusasteella_2002  d35 ON d35.id = [1c_tutkinto_alkuperaisella_koulutusasteella_2002_id]
	JOIN d_tutkinto_muulla_koulutusasteella_2002  d36 ON d36.id = [1d_tutkinto_muulla_koulutusasteella_2002_id]
	JOIN d_jatkaa_opiskelua_alkuperaisella_koulutusasteella_2002 d37 ON d37.id = [1e_jatkaa_opiskelua_alkuperaisella_koulutusasteella_2002_id]
	JOIN d_jatkaa_opiskelua_muulla_koulutusasteella_2002 d38 ON d38.id = [1f_jatkaa_opiskelua_muulla_koulutusasteella_2002_id]
	JOIN d_opintojen_kulku_koulutusalan_2002_mukaan d39 ON d39.id = [2a_opiskelijoiden_opintojen_kulku_koulutusala_2002_mukaan_id]
	JOIN d_opintojen_kulku_koulutusalan_2002_mukaan d40 ON d40.id = [2b_opiskelijoiden_opintojen_kulku_koulutusala_2002_mukaan_id]
	JOIN d_tutkinto_alkuperaisella_koulutusalalla_2002  d41 ON d41.id = [2c_tutkinto_alkuperaisella_koulutusalalla_2002_id]
	JOIN d_tutkinto_muulla_koulutusalalla_2002  d42 ON d42.id = [2d_tutkinto_muulla_koulutusalalla_2002_id]
	JOIN d_jatkaa_opiskelua_alkuperaisella_koulutusalalla_2002  d43 ON d43.id = [2e_jatkaa_opiskelua_alkuperaisella_koulutusalalla_2002_id]
	JOIN d_jatkaa_opiskelua_muulla_koulutusalalla_2002  d44 ON d44.id = [2f_jatkaa_opiskelua_muulla_koulutusalalla_2002_id]

	JOIN d_opintojen_kulku_opintoalan_2002_mukaan d45 ON d45.id = [3a_opiskelijoiden_opintojen_kulku_opintoala_2002_mukaan_id]
	JOIN d_opintojen_kulku_opintoalan_2002_mukaan d46 ON d46.id = [3b_opiskelijoiden_opintojen_kulku_opintoala_2002_mukaan_id]
	JOIN d_tutkinto_alkuperaisella_opintoalalla_2002  d47 ON d47.id = [3c_tutkinto_alkuperaisella_opintoalalla_2002_id]
	JOIN d_tutkinto_muulla_opintoalalla_2002  d48 ON d48.id = [3d_tutkinto_muulla_opintoalalla_2002_id]
	JOIN d_jatkaa_opiskelua_alkuperaisella_opintoalalla_2002  d49 ON d49.id = [3e_jatkaa_opiskelua_alkuperaisella_opintoalalla_2002_id]
	JOIN d_jatkaa_opiskelua_muulla_opintoalalla_2002  d50 ON d50.id = [3f_jatkaa_opiskelua_muulla_opintoalalla_2002_id]

	JOIN d_opintojen_kulku_koulutuksen_jarjestajan_mukaan d51 ON d51.id = [4a_opiskelijoiden_opintojen_kulku_koul_jarjestajan_mukaan_id]
	JOIN d_opintojen_kulku_koulutuksen_jarjestajan_mukaan d52 ON d52.id = [4b_opiskelijoiden_opintojen_kulku_koul_jarjestajan_mukaan_id]
	JOIN d_tutkinto_alkuperaisella_koulutuksen_jarjestajalla  d53 ON d53.id = [4c_tutkinto_alkuperaisella_koulutuksen_jarjestajalla_id]
	JOIN d_tutkinto_muulla_koulutuksen_jarjestajalla  d54 ON d54.id = [4d_tutkinto_muulla_koulutuksen_jarjestajalla_id]
	JOIN d_jatkaa_opiskelua_alkuperaisella_koulutuksen_jarjestajalla  d55 ON d55.id = [4e_jatkaa_opiskelua_alkuperaisella_koulutuksen_jarjestajalla_id]
	JOIN d_jatkaa_opiskelua_muulla_koulutuksen_jarjestajalla  d56 ON d56.id = [4f_jatkaa_opiskelua_muulla_koulutuksen_jarjestajalla_id]


	JOIN d_opintojen_kulku_oppilaitoksen_mukaan d57 ON d57.id = [5a_opiskelijoiden_opintojen_kulku_oppilaitoksen_mukaan_id]
	JOIN d_opintojen_kulku_oppilaitoksen_mukaan d58 ON d58.id = [5b_opiskelijoiden_opintojen_kulku_oppilaitoksen_mukaan_id]
	JOIN d_tutkinto_alkuperaisessa_oppilaitoksessa  d59 ON d59.id = [5c_tutkinto_alkuperaisessa_oppilaitoksessa_id]
	JOIN d_tutkinto_muussa_oppilaitoksessa  d60 ON d60.id = [5d_tutkinto_muussa_oppilaitoksessa_id]
	JOIN d_jatkaa_opiskelua_alkuperaisessa_oppilaitoksessa  d61 ON d61.id = [5e_jatkaa_opiskelua_alkuperaisessa_oppilaitoksessa_id]
	JOIN d_jatkaa_opiskelua_muussa_oppilaitoksessa d62 ON d62.id = [5f_jatkaa_opiskelua_muussa_oppilaitoksessa_id]

	JOIN d_opintojen_kulku_maakunnan_mukaan d63 ON d63.id = [6a_opiskelijoiden_opintojen_kulku_maakunnan_mukaan_id]
	JOIN d_opintojen_kulku_maakunnan_mukaan d64 ON d64.id = [6b_opiskelijoiden_opintojen_kulku_maakunnan_mukaan_id]
	JOIN d_tutkinto_alkuperaisessa_maakunnassa  d65 ON d65.id = [6c_tutkinto_alkuperaisessa_maakunnassa_id]
	JOIN d_tutkinto_muussa_maakunnassa  d66 ON d66.id = [6d_tutkinto_muussa_maakunnassa_id]
	JOIN d_jatkaa_opiskelua_alkuperaisessa_maakunnassa  d67 ON d67.id = [6e_jatkaa_opiskelua_alkuperaisessa_maakunnassa_id]
	JOIN d_jatkaa_opiskelua_muussa_maakunnassa d68 ON d68.id = [6f_jatkaa_opiskelua_muussa_maakunnassa_id]

	JOIN d_opintojen_kulku_koulutussektorin_mukaan d69 ON d69.id = [7a_opiskelijoiden_opintojen_kulku_koulutussektorin_mukaan_id]
	JOIN d_opintojen_kulku_koulutussektorin_mukaan d70 ON d70.id = [7b_opiskelijoiden_opintojen_kulku_koulutussektorin_mukaan_id]
	JOIN d_tutkinto_alkuperaisella_koulutussektorilla d71 ON d71.id = [7c_tutkinto_alkuperaisella_koulutussektorilla_id]
	JOIN d_tutkinto_muulla_koulutussektorilla d72 ON d72.id = [7d_tutkinto_muulla_koulutussektorilla_id]
	JOIN d_jatkaa_opiskelua_alkuperaisella_koulutussektorilla d73 ON d73.id = [7e_jatkaa_opiskelua_alkuperaisella_koulutussektorilla_id]
	JOIN d_jatkaa_opiskelua_muulla_koulutussektorilla d74 ON d74.id = [7f_jatkaa_opiskelua_muulla_koulutussektorilla_id]




WHERE d16.koulutusaste2002_koodi = 32 










' 
GO
/****** Object:  View [dbo].[v_f_tab_keskeytaneet_lukio]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_keskeytaneet_lukio]'))
EXEC dbo.sp_executesql @statement = N'





















CREATE VIEW [dbo].[v_f_tab_keskeytaneet_lukio] AS

Select
[opiskelijat] AS lkm_int,
[tilastovuosi] AS Tilastovuosi
,d1.aineisto AS Aineisto
,d2.lahde AS Lähde
,d3.sukupuoli AS Sukupuoli
,d4.aidinkieli_versio1 AS Äidinkieli
,d5.ika AS Ikä
,d6.ika AS Ikäryhmä
,d7.kunta AS Asuinkunta
,d7.maakunta AS Asuinmaakunta
,d7.avi AS ''Asuinalueen AVI''
,d7.ely AS ''Asuinalueen ELY''
,d8.kansalaisuus_versio1 AS Kansalaisuus
,d9.eumaa AS ''EU-maan kansalainen''
,d10.etamaa AS ''ETA-maan kansalainen''
,d11.pohjoismaa AS ''Pohjoismaan kansalainen''
,d12.vuosiselite AS Aloitusvuosi
,d14.opiskelijan_olo AS Kirjoillaolo
,d15.oppilaitos as "Oppilaitos"
,d15.oppilaitostyyppi as "Oppilaitostyyppi"
,d15.opetuskieli as "Opetuskieli"
,d15.oppilaitoksen_omistajatyyppi as "Oppil. omistajatyyppi"
,d15.koulutuksen_jarjestaja as "Koulutuksen järjestäjä"
,d15.koulutuksen_jarjestajan_kieli as "Koul. järjestäjän kieli"
,d16.koulutus AS Koulutusnimike
,d16.koulutusala2002 AS Koulutusala
,d16.koulutusala2002 AS "Koulutusala (02 luokitus)"
,d16.opintoala1995 AS "Koulutusala (95 luokitus)"
,d16.opintoala2002 AS Opintoala
,d16.koulutusaste2002 AS Koulutusaste
,d17.koulutuksen_kieli_versio1 AS ''Koulutuksen kieli''
,d18.kunta AS ''Koulutuksen kunta''
,d18.maakunta AS ''Koulutuksen maakunta''
,d18.avi AS "Koulutuksen AVI-alue"
,d18.ely AS "Koulutuksen ELY-alue"
,d19.opetushallinnon_koulutus AS Hallinnonala
,d20.koulutustyyppi AS Koulutustyyppi
,d21.maakunta AS ''Tutk. suoritusmaakunta''
,d22.koulutuksen_jarjestaja AS ''Tutkinnon koul. järjestäjä''
,d22.koulutuksen_jarjestajan_omistajatyyppi AS ''Tutkinnon koul. järjestäjän omistajatyyppi''
,d22.koulutuksen_jarjestajan_kieli ''Tutkinnon koul. järjestäjän kieli''
,d22.koulutuksen_jarjestajan_sijaintikunta AS ''Tutkinnon koul. järjestäjän sijaintikunta''
,d23.oppilaitos AS ''Tutkinnon oppilaitos''
,d23.oppilaitostyyppi as "Tutkinnon oppilaitostyyppi"
,d23.opetuskieli as "Tutkinnon opetuskieli"
,d23.oppilaitoksen_omistajatyyppi as "Tutkinnon oppil. omistajatyyppi"
,d24.koulutus AS ''Tutkinnon koulutusnimike''
,d24.koulutusala2002 AS ''Tutkinnon koulutusala''
,d24.koulutusala2002 AS ''Tutkinnon koulutusala (02 luokitus)''
,d24.opintoala1995 AS "Tutkinnon koulutusala (95 luokitus)"
,d24.opintoala2002 AS ''Tutkinnon opintoala''
,d24.koulutusaste2002 AS ''Tutkinnon koulutusaste''
,d25.koulutustyyppi AS ''Tutkinnon koulutustyyppi''
,d26.maakunta AS ''Seur. vuoden koul. maakunta''
,d27.koulutuksen_jarjestaja AS ''Seur. vuoden koul. järjestäjä''
,d27.koulutuksen_jarjestajan_omistajatyyppi AS ''Seur. vuoden koul. järjestäjän omistajatyyppi''
,d27.koulutuksen_jarjestajan_kieli ''Seur. vuoden koul. järjestäjän kieli''
,d27.koulutuksen_jarjestajan_sijaintikunta AS ''Seur. vuoden koul. järjestäjän sijaintikunta''
,d28.oppilaitos AS ''Seur. vuoden oppilaitos''
,d28.oppilaitostyyppi as "Seur. vuoden oppilaitostyyppi"
,d28.opetuskieli as "Seur. vuoden opetuskieli"
,d28.oppilaitoksen_omistajatyyppi as "Seur. vuoden oppil. omistajatyyppi"
,d29.koulutus AS ''Seur. vuoden koulutusnimike''
,d29.koulutusala2002 AS ''Seur. vuoden koulutusala''
,d29.koulutusala2002 AS ''Seur. vuoden koulutusala (02 luokitus)''
,d29.opintoala1995 AS "Seur. vuoden koulutusala (95 luokitus)"
,d29.opintoala2002 AS ''Seur. vuoden opintoala''
,d29.koulutusaste2002 AS ''Seur. vuoden koulutusaste''
,d30.koulutustyyppi  AS ''Seur. vuoden koulutustyyppi''
,d31.paaasiallinen_toiminta_versio2 AS ''Pääasiallinen toiminta''
,d32.ammattiasema AS Ammattiasema

,d33.opintojen_kulku_koulutusasteen_2002_mukaan AS ''Opintojen kulku 1a''
,d34.opintojen_kulku_koulutusasteen_2002_mukaan AS ''Opintojen kulku 1b''
,d35.tutkinto_alkuperaisella_koulutusasteella_2002 AS ''Tutk. suor. alkup. koul.asteella''
,d36.tutkinto_muulla_koulutusasteella_2002 AS ''Tutk. suor. muulla koul.asteella''
,d37.jatkaa_opiskelua_alkuperaisella_koulutusasteella_2002 AS ''Jatkaa opisk. alkup. koul.asteella''
,d38.jatkaa_opiskelua_muulla_koulutusasteella_2002 AS ''Jatkaa opisk. muulla koul.asteella''

,d39.opintojen_kulku_koulutusalan_2002_mukaan AS ''Opintojen kulku 2a''
,d40.opintojen_kulku_koulutusalan_2002_mukaan AS ''Opintojen kulku 2b''
,d41.tutkinto_alkuperaisella_koulutusalalla_2002 AS ''Tutk. suor. alkup. koul.alalla''
,d42.tutkinto_muulla_koulutusalalla_2002 AS ''Tutk. suor. muulla koul.alalla''
,d43.jatkaa_opiskelua_alkuperaisella_koulutusalalla_2002 AS ''Jatkaa opisk. alkup. koul.alalla''
,d44.jatkaa_opiskelua_muulla_koulutusalalla_2002 AS ''Jatkaa opisk. muulla koul.alalla''

,d45.opintojen_kulku_opintoala_2002_mukaan AS ''Opintojen kulku 3a''
,d46.opintojen_kulku_opintoala_2002_mukaan AS ''Opintojen kulku 3b''
,d47.tutkinto_alkuperaisella_opintoalalla_2002 AS ''Tutk. suor. alkup. opintoalalla''
,d48.tutkinto_muulla_opintoalalla_2002 AS ''Tutk. suor. muulla opintoalalla''
,d49.jatkaa_opiskelua_alkuperaisella_opintoalalla_2002 AS ''Jatkaa opisk. alkup. opintoalalla''
,d50.jatkaa_opiskelua_muulla_opintoalalla_2002 AS ''Jatkaa opisk. muulla opintoalalla''

,d51.opintojen_kulku_koulutuksen_jarjestajan_mukaan AS ''Opintojen kulku 4a''
,d52.opintojen_kulku_koulutuksen_jarjestajan_mukaan AS ''Opintojen kulku 4b''
,d53.tutkinto_alkuperaisella_koulutuksen_jarjestajalla AS ''Tutk. suor. alkup. koul. järjestäjällä''
,d54.tutkinto_muulla_koulutuksen_jarjestajalla AS ''Tutk. suor. muulla koul. järjestäjällä''
,d55.jatkaa_opiskelua_alkuperaisella_koulutuksen_jarjestajalla AS ''Jatkaa opisk. alkup. koul. järjestäjällä''
,d56.jatkaa_opiskelua_muulla_koulutuksen_jarjestajalla AS ''Jatkaa opisk. muulla koul. järjestäjällä''

,d57.opintojen_kulku_oppilaitoksen_mukaan AS ''Opintojen kulku 5a''
,d58.opintojen_kulku_oppilaitoksen_mukaan AS ''Opintojen kulku 5b''
,d59.tutkinto_alkuperaisessa_oppilaitoksessa AS ''Tutk. suor. alkup. oppilaitoksessa''
,d60.tutkinto_muussa_oppilaitoksessa AS ''Tutk. suor. muussa oppilaitoksessa''
,d61.jatkaa_opiskelua_alkuperaisessa_oppilaitoksessa AS ''Jatkaa opisk. alkup. oppilaitoksessa''
,d62.jatkaa_opiskelua_muussa_oppilaitoksessa AS ''Jatkaa opisk. muussa oppilaitoksessa''

,d63.opintojen_kulku_maakunnan_mukaan AS ''Opintojen kulku 6a''
,d64.opintojen_kulku_maakunnan_mukaan AS ''Opintojen kulku 6b''
,d65.tutkinto_alkuperaisessa_maakunnassa AS ''Tutk. suor. alkup. maakunnassa''
,d66.tutkinto_muussa_maakunnassa AS ''Tutk. suor. muussa maakunnassa''
,d67.jatkaa_opiskelua_alkuperaisessa_maakunnassa AS ''Jatkaa opisk. alkup. maakunnassa''
,d68.jatkaa_opiskelua_muussa_maakunnassa AS ''Jatkaa opisk. muussa maakunnassa''

,d69.opintojen_kulku_koulutussektorin_mukaan AS ''Opintojen kulku 7a''
,d70.opintojen_kulku_koulutussektorin_mukaan AS ''Opintojen kulku 7b''
,d71.tutkinto_alkuperaisella_koulutussektorilla AS ''Tutk. suor. alkup. koul.sektorilla''
,d72.tutkinto_muulla_koulutussektorilla AS ''Tutk. suor. muulla koul.sektorilla''
,d73.jatkaa_opiskelua_alkuperaisella_koulutussektorilla AS ''Jatkaa opisk. alkup. koul.sektorilla''
,d74.jatkaa_opiskelua_muulla_koulutussektorilla AS ''Jatkaa opisk. muulla koul.sektorilla''
,d75.opintojen_kulku_koulutusalan_2002_mukaan_versio2 AS ''Opintojen kulku 2bb''
,d76.opintojen_kulku_opintoala_2002_mukaan_versio2 AS ''Opintojen kulku 3bb''
,d77.opintojen_kulku_koulutuksen_jarjestajan_mukaan_versio2 AS ''Opintojen kulku 4bb''
,d78.opintojen_kulku_oppilaitoksen_mukaan_versio2 AS ''Opintojen kulku 5bb''

--Ruotsi
,[tilastovuosi] AS Statistikår
,d3.sukupuoli_SV AS Kön
,d4.aidinkieli_versio1_SV AS Modersmål
,d6.ika_SV AS Åldersgrupp
,d7.kunta_SV AS Bostadskommun
,d7.maakunta_SV AS Bostadslandskap
,d8.kansalaisuus_versio1_SV AS Medborgarskap
,d16.koulutus_SV AS Utbildningsbenämning
,d17.koulutuksen_kieli_versio1_SV AS [Utbildningens språk]
,d18.kunta_SV AS [Ubildningens kommun]
,d18.maakunta_SV AS [Utbildningens landskap]
,d21.maakunta_SV AS [Landskap där examen avlagts]
,d15.koulutuksen_jarjestaja_SV as [Utbildningsanordnare]
,d15.oppilaitos_SV as [Läroanstalt]
,d75.opintojen_kulku_koulutusalan_2002_mukaan_versio2_SV AS ''Studieförlopp''

--Englanti
,[tilastovuosi] AS [Statistical year]
,d3.sukupuoli_EN AS Gender
,d4.aidinkieli_versio1_EN AS [Mother tongue]
,d6.ika_EN AS [Age group]
,d7.kunta_EN AS [Municipality of residence]
,d7.maakunta_EN AS [Region of residence]
,d8.kansalaisuus_versio1_EN AS Nationality
,d16.koulutus_EN AS [Name of education]
,d17.koulutuksen_kieli_versio1_EN AS [Language of education]
,d18.kunta_EN AS [Municipality of education]
,d18.maakunta_EN AS [Region of education]
,d21.maakunta_EN AS [Region of degree]
,d15.koulutuksen_jarjestaja_EN as [Education provider]
,d15.oppilaitos_EN as [Educational institution]
,d75.opintojen_kulku_koulutusalan_2002_mukaan_versio2_EN AS ''Progress of studies''

--järjestysmuuttujat
,d3.jarjestys AS jarj_Sukupuoli
,d4.jarjestys AS jarj_Äidinkieli
,d5.jarjestys_ika AS jarj_Ikä
,d6.jarjestys_ika5v AS jarj_Ikäryhmä
,d7.jarjestys AS jarj_Asuinkunta
,d7.jarjestys_maakunta AS jarj_Asuinmaakunta
,d7.jarjestys_avi AS jarj_AsuinalueenAVI
,d7.jarjestys_ely AS jarj_AsuinalueenELY
,d8.jarjestys AS jarj_Kansalaisuus
,d9.jarjestys_eumaa AS jarj_EU_maankansalainen
,d10.jarjestys_etamaa AS jarj_ETA_maankansalainen
,d11.jarjestys AS jarj_Pohjoismaankansalainen
,d14.jarjestys AS jarj_Kirjoillaolo
,d15.jarjestys_oppilaitostyyppi as jarj_Oppilaitostyyppi
,d15.jarjestys_opetuskieli as jarj_Opetuskieli
,d15.jarjestys_omistajatyyppi as jarj_Oppil_omistajatyyppi
,d15.jarjestys_koulutuksen_jarjestajan_kieli as jarj_Koul_järjestäjänkieli
,d16.jarjestys_koulutusala2002 AS jarj_Koulutusala
,d16.jarjestys_opintoala1995
,d16.jarjestys_opintoala2002 AS jarj_Opintoala
,d16.jarjestys_koulutusaste2002 AS jarj_Koulutusaste
,d17.jarjestys AS jarj_Koulutuksenkieli
,d18.jarjestys AS jarj_Koulutuksenkunta
,d18.jarjestys_maakunta AS jarj_Koulutuksenmaakunta
,d18.jarjestys_avi AS jarj_KoulutuksenAVI_alue
,d18.jarjestys_ely AS jarj_KoulutuksenELY_alue
,d19.jarjestys AS jarj_Hallinnonala
,d20.jarjestys AS jarj_Koulutustyyppi
,d21.jarjestys_maakunta AS jarj_Tutk_suoritusmaakunta
,d22.jarjestys_koulutuksenjarjestaja AS jarj_Tutkinnon_koul_järjestäjän_omistajatyyppi
,d22.jarjestys_koulutuksen_jarjestajan_kieli AS jarj_Tutkinnon_koul_järjestäjän_kieli
,d23.jarjestys_oppilaitostyyppi AS jarj_Tutkinnon_oppilaitostyyppi
,d23.jarjestys_opetuskieli AS jarj_Tutkinnon_opetuskieli
,d23.jarjestys_omistajatyyppi AS jarj_Tutkinnon_oppil_omistajatyyppi
,d24.jarjestys_koulutusala2002 AS jarj_Tutkinnon_koulutusala_02_luokitus
,d24.jarjestys_opintoala1995 AS jarj_Tutkinnon_koulutusala_95_luokitus
,d24.jarjestys_opintoala2002 AS jarj_Tutkinnon_opintoala
,d24.jarjestys_koulutusaste2002 AS jarj_Tutkinnon_koulutusaste
,d25.jarjestys AS jarj_Tutkinnon_koulutustyyppi
,d26.jarjestys_maakunta AS jarj_Seur_vuoden_koul_maakunta
,d27.jarjestys_koulutuksenjarjestaja AS jarj_Seur_vuoden_koul_järjestäjän_omistajatyyppi
,d27.jarjestys_koulutuksen_jarjestajan_kieli AS jarj_Seur_vuoden_koul_järjestäjän_kieli
,d28.jarjestys_oppilaitostyyppi AS jarj_Seur_vuoden_oppilaitostyyppi
,d28.jarjestys_opetuskieli AS jarj_Seur_vuoden_opetuskieli
,d28.jarjestys_omistajatyyppi AS jarj_Seur_vuoden_oppil_omistajatyyppi
,d29.jarjestys_koulutusala2002 AS jarj_Seur_vuoden_koulutusala_02_luokitus
,d29.jarjestys_opintoala1995 AS jarj_Seur_vuoden_koulutusala_95_luokitus
,d29.jarjestys_opintoala2002 AS jarj_Seur_vuoden_opintoala
,d29.jarjestys_koulutusaste2002 AS jarj_Seur_vuoden_koulutusaste
,d30.jarjestys AS jarj_Seur_vuoden_koulutustyyppi
,d31.jarjestys AS jarj_Pääasiallinen_toiminta
,d32.jarjestys AS jarj_Ammattiasema

,d33.jarjestys_1a
,d34.jarjestys_1b
,d35.jarjestys_1c
,d36.jarjestys_1d
,d37.jarjestys_1e
,d38.jarjestys_1f

,d39.jarjestys_2a
,d40.jarjestys_2b
,d41.jarjestys_2c
,d42.jarjestys_2d
,d43.jarjestys_2e
,d44.jarjestys_2f

,d45.jarjestys_3a
,d46.jarjestys_3b
,d47.jarjestys_3c
,d48.jarjestys_3d
,d49.jarjestys_3e
,d50.jarjestys_3f

,d51.jarjestys_4a
,d52.jarjestys_4b
,d53.jarjestys_4c
,d54.jarjestys_4d
,d55.jarjestys_4e
,d56.jarjestys_4f

,d57.jarjestys_5a
,d58.jarjestys_5b
,d59.jarjestys_5c
,d60.jarjestys_5d
,d61.jarjestys_5e
,d62.jarjestys_5f

,d63.jarjestys_6a
,d64.jarjestys_6b
,d65.jarjestys_6c
,d66.jarjestys_6d
,d67.jarjestys_6e
,d68.jarjestys_6f

,d69.jarjestys_7a
,d70.jarjestys_7b
,d71.jarjestys_7c
,d72.jarjestys_7d
,d73.jarjestys_7e
,d74.jarjestys_7f
,d75.jarjestys_2bb
,d76.jarjestys_3bb
,d77.jarjestys_4bb
,d78.jarjestys_5bb

--koodimuuttujat
,d1.aineisto_koodi AS ''Koodit Aineisto''
,d2.lahde_koodi AS ''Koodit Lähde''
,d7.kunta_koodi AS ''Koodit Asuinkunta''
,d7.maakunta_koodi AS ''Koodit Asuinmaakunta''
,d15.oppilaitoskoodi AS ''Koodit Oppilaitos''
,d15.koulutuksen_jarjestajakoodi AS ''Koodit Koulutuksen järjestäjä''
,d16.koulutus_koodi AS ''Koodit Koulutusnimike''
,d16.koulutusala2002_koodi AS ''Koodit Koulutusala (02 luokitus)''
,d16.opintoala1995_koodi AS ''Koodit Koulutusala (95 luokitus)''
,d16.opintoala2002_koodi AS ''Koodit Opintoala''
,d16.koulutusaste2002_koodi AS ''Koodit Koulutusaste''
,d18.kunta_koodi AS ''Koodit Koulutuksen kunta''
,d18.maakunta_koodi AS ''Koodit Koulutuksen maakunta''
,d20.koulutustyyppi_koodi AS ''Koodit Koulutustyyppi''
,d21.maakunta_koodi AS ''Koodit Tutk. suoritusmaakunta''
,d22.koulutuksen_jarjestajakoodi AS ''Koodit Tutkinnon koul. järjestäjä''
,d23.oppilaitoskoodi AS ''Koodit Tutkinnon oppilaitos''
,d24.koulutus_koodi AS ''Koodit Tutkinnon koulutusnimike''
,d24.koulutusala2002_koodi AS ''Koodit Tutkinnon koulutusala (02 luokitus)''
,d24.opintoala1995_koodi AS ''Koodit Tutkinnon koulutusala (95 luokitus)''
,d24.opintoala2002_koodi AS ''Koodit Tutkinnon opintoala''
,d24.koulutusaste2002_koodi AS ''Koodit Tutkinnon koulutusaste''
,d25.koulutustyyppi_koodi AS ''Koodit Tutkinnon koulutustyyppi''
,d26.maakunta_koodi AS ''Koodit Seur. vuoden koul. maakunta''
,d27.koulutuksen_jarjestajakoodi AS ''Koodit Seur. vuoden koul. järjestäjä''
,d28.oppilaitoskoodi AS ''Koodit Seur. vuoden oppilaitos''
,d29.koulutus_koodi AS ''Koodit Seur. vuoden koulutusnimike''
,d29.koulutusala2002_koodi AS ''Koodit Seur. vuoden koulutusala (02 luokitus)''
,d29.opintoala1995_koodi AS ''Koodit Seur. vuoden koulutusala (95 luokitus)''
,d29.opintoala2002_koodi AS ''Koodit Seur. vuoden opintoala''
,d29.koulutusaste2002_koodi AS ''Koodit Seur. vuoden koulutusaste''
,d30.koulutustyyppi_koodi AS ''Koodit Seur. vuoden koulutustyyppi''

--isced
,d24.iscle2011 as "Tutkinnon koulutusaste 1"
,d24.Koulutusaste_taso2 as "Tutkinnon koulutusaste 2"
,d24.iscfibroad2013 as "Tutkinnon koulutusala 1"
,d24.iscfinarrow2013 as "Tutkinnon koulutusala 2"
,d24.iscfi2013 as "Tutkinnon koulutusala 3"
,d24.OKM_ohjauksen_ala as "Tutkinnon OKM ohjauksen ala"
,d24.jarjestys_iscle2011 as jarj_isced2_koulast1
,d24.jarjestys_Koulutusaste_taso2 as jarj_isced2_koulast2
,d24.jarjestys_iscfibroad2013 as jarj_isced2_koulala1
,d24.jarjestys_iscfinarrow2013 as jarj_isced2_koulala2
,d24.jarjestys_iscfi2013 as jarj_isced2_koulala3
,d24.jarjestys_OKM_ohjauksen_ala as jarj_isced2_okmohjaus1
,d24.iscle2011_koodi as "Koodit Tutkinnon koulutusaste 1"
,d24.Koulutusaste_taso2_koodi as "Koodit Tutkinnon koulutusaste 2"
,d24.iscfibroad2013_koodi as "Koodit Tutkinnon koulutusala 1"
,d24.iscfinarrow2013_koodi as "Koodit Tutkinnon koulutusala 2"
,d24.iscfi2013_koodi as "Koodit Tutkinnon koulutusala 3"
,d24.OKM_ohjauksen_ala_koodi as "Koodit Tutkinnon OKM ohjauksen ala"
,d29.iscle2011 as "Seur. vuoden koulutusaste 1"
,d29.Koulutusaste_taso2 as "Seur. vuoden koulutusaste 2"
,d29.iscfibroad2013 as "Seur. vuoden koulutusala 1"
,d29.iscfinarrow2013 as "Seur. vuoden koulutusala 2"
,d29.iscfi2013 as "Seur. vuoden koulutusala 3"
,d29.OKM_ohjauksen_ala as "Seur. vuoden OKM ohjauksen ala"
,d29.jarjestys_iscle2011 as jarj_isced3_koulast1
,d29.jarjestys_Koulutusaste_taso2 as jarj_isced3_koulast2
,d29.jarjestys_iscfibroad2013 as jarj_isced3_koulala1
,d29.jarjestys_iscfinarrow2013 as jarj_isced3_koulala2
,d29.jarjestys_iscfi2013 as jarj_isced3_koulala3
,d29.jarjestys_OKM_ohjauksen_ala as jarj_isced3_okmohjaus1
,d29.iscle2011_koodi as "Koodit Seur. vuoden koulutusaste 1"
,d29.Koulutusaste_taso2_koodi as "Koodit Seur. vuoden koulutusaste 2"
,d29.iscfibroad2013_koodi as "Koodit Seur. vuoden koulutusala 1"
,d29.iscfinarrow2013_koodi as "Koodit Seur. vuoden koulutusala 2"
,d29.iscfi2013_koodi as "Koodit Seur. vuoden koulutusala 3"
,d29.OKM_ohjauksen_ala_koodi as "Koodit Seur. vuoden OKM ohjauksen ala"

FROM dbo.f_keskeyttaneet
	JOIN d_aineisto d1 ON d1.id = aineisto_id
	JOIN d_lahde d2 ON d2.id = lahde_id
	JOIN d_sukupuoli d3 ON d3.id = sukupuoli_id
	JOIN d_aidinkieli_versio1 d4 ON d4.id = aidinkieli_versio1x_id
	JOIN d_ika d5 ON d5.id = ika_1v_id
	JOIN d_ika d6 ON d6.id = ika_5v_id
	JOIN d_alueluokitus d7 ON d7.id= kotikunta_id
	JOIN d_kansalaisuus_versio1 d8 ON d8.id= kansalaisuus_versio1_id
	JOIN d_valtio d9 ON d9.id= eumaa_id
	JOIN d_valtio d10 ON d10.id= etamaa_id
	JOIN d_pohjoismaa d11 ON d11.id= pohjoismaa_id
	JOIN d_kausi d12 ON d12.kausi_id= kirjoihintulovuosi_id
	JOIN d_opiskelijan_olo d14 ON d14.id= opiskelijan_olo_lk_id
	JOIN d_oppilaitoksen_taustatiedot d15 ON d15.id= oppilaitoksen_taustatiedot_id
	JOIN d_koulutusluokitus d16 ON d16.id= koulutusluokitus_id
	JOIN d_koulutuksen_kieli_versio1 d17 ON d17.id= koulutuksen_kieli_versio1_id
	JOIN d_alueluokitus d18 ON d18.id= koulutuksen_kunta_id
	JOIN d_opetushallinnon_koulutus d19 ON d19.id= opetushallinnon_koulutus_id
	JOIN d_koulutustyyppi d20 ON d20.id= koulutustyyppi_id
	JOIN d_alueluokitus d21 ON d21.id= tutkinnon_suorittamismaakunta_id
	JOIN d_oppilaitoksen_taustatiedot d22 ON d22.id= tutkinnon_jarjestaja_id
	JOIN d_oppilaitoksen_taustatiedot d23 ON d23.id= tutkinnon_suorittamisoppilaitos_id
	JOIN d_koulutusluokitus d24 ON d24.id= tutkinnon_koulutusluokitus_id
	JOIN d_koulutustyyppi d25 ON d25.id= tutkinnon_koulutustyyppi_id
	JOIN d_alueluokitus d26 ON d26.id= seuraavan_vuoden_maakunta_id
	JOIN d_oppilaitoksen_taustatiedot d27 ON d27.id= seuraavan_vuoden_jarjestaja_id
	JOIN d_oppilaitoksen_taustatiedot d28 ON d28.id= seuraavan_vuoden_oppilaitos_id
	JOIN d_koulutusluokitus d29 ON d29.id= seuraavan_vuoden_koulutusluokitus_id
	JOIN d_koulutustyyppi d30 ON d30.id= seuraavan_vuoden_koulutustyyppi_id
	JOIN d_paaasiallinen_toiminta_versio2 d31 ON d31.id = paaasiallinen_toiminta_versio2_id
	JOIN d_ammattiasema d32 ON d32.id = ammattiasema_id
	JOIN d_opintojen_kulku_koulutusasteen_2002_mukaan  d33 ON d33.id = [1a_opiskelijoiden_opintojen_kulku_koulutusaste_2002_mukaan_id]
	JOIN d_opintojen_kulku_koulutusasteen_2002_mukaan  d34 ON d34.id = [1b_opiskelijoiden_opintojen_kulku_koulutusaste_2002_mukaan_id]
	JOIN d_tutkinto_alkuperaisella_koulutusasteella_2002  d35 ON d35.id = [1c_tutkinto_alkuperaisella_koulutusasteella_2002_id]
	JOIN d_tutkinto_muulla_koulutusasteella_2002  d36 ON d36.id = [1d_tutkinto_muulla_koulutusasteella_2002_id]
	JOIN d_jatkaa_opiskelua_alkuperaisella_koulutusasteella_2002 d37 ON d37.id = [1e_jatkaa_opiskelua_alkuperaisella_koulutusasteella_2002_id]
	JOIN d_jatkaa_opiskelua_muulla_koulutusasteella_2002 d38 ON d38.id = [1f_jatkaa_opiskelua_muulla_koulutusasteella_2002_id]
	JOIN d_opintojen_kulku_koulutusalan_2002_mukaan d39 ON d39.id = [2a_opiskelijoiden_opintojen_kulku_koulutusala_2002_mukaan_id]
	JOIN d_opintojen_kulku_koulutusalan_2002_mukaan d40 ON d40.id = [2b_opiskelijoiden_opintojen_kulku_koulutusala_2002_mukaan_id]
	JOIN d_tutkinto_alkuperaisella_koulutusalalla_2002  d41 ON d41.id = [2c_tutkinto_alkuperaisella_koulutusalalla_2002_id]
	JOIN d_tutkinto_muulla_koulutusalalla_2002  d42 ON d42.id = [2d_tutkinto_muulla_koulutusalalla_2002_id]
	JOIN d_jatkaa_opiskelua_alkuperaisella_koulutusalalla_2002  d43 ON d43.id = [2e_jatkaa_opiskelua_alkuperaisella_koulutusalalla_2002_id]
	JOIN d_jatkaa_opiskelua_muulla_koulutusalalla_2002  d44 ON d44.id = [2f_jatkaa_opiskelua_muulla_koulutusalalla_2002_id]

	JOIN d_opintojen_kulku_opintoalan_2002_mukaan d45 ON d45.id = [3a_opiskelijoiden_opintojen_kulku_opintoala_2002_mukaan_id]
	JOIN d_opintojen_kulku_opintoalan_2002_mukaan d46 ON d46.id = [3b_opiskelijoiden_opintojen_kulku_opintoala_2002_mukaan_id]
	JOIN d_tutkinto_alkuperaisella_opintoalalla_2002  d47 ON d47.id = [3c_tutkinto_alkuperaisella_opintoalalla_2002_id]
	JOIN d_tutkinto_muulla_opintoalalla_2002  d48 ON d48.id = [3d_tutkinto_muulla_opintoalalla_2002_id]
	JOIN d_jatkaa_opiskelua_alkuperaisella_opintoalalla_2002  d49 ON d49.id = [3e_jatkaa_opiskelua_alkuperaisella_opintoalalla_2002_id]
	JOIN d_jatkaa_opiskelua_muulla_opintoalalla_2002  d50 ON d50.id = [3f_jatkaa_opiskelua_muulla_opintoalalla_2002_id]

	JOIN d_opintojen_kulku_koulutuksen_jarjestajan_mukaan d51 ON d51.id = [4a_opiskelijoiden_opintojen_kulku_koul_jarjestajan_mukaan_id]
	JOIN d_opintojen_kulku_koulutuksen_jarjestajan_mukaan d52 ON d52.id = [4b_opiskelijoiden_opintojen_kulku_koul_jarjestajan_mukaan_id]
	JOIN d_tutkinto_alkuperaisella_koulutuksen_jarjestajalla  d53 ON d53.id = [4c_tutkinto_alkuperaisella_koulutuksen_jarjestajalla_id]
	JOIN d_tutkinto_muulla_koulutuksen_jarjestajalla  d54 ON d54.id = [4d_tutkinto_muulla_koulutuksen_jarjestajalla_id]
	JOIN d_jatkaa_opiskelua_alkuperaisella_koulutuksen_jarjestajalla  d55 ON d55.id = [4e_jatkaa_opiskelua_alkuperaisella_koulutuksen_jarjestajalla_id]
	JOIN d_jatkaa_opiskelua_muulla_koulutuksen_jarjestajalla  d56 ON d56.id = [4f_jatkaa_opiskelua_muulla_koulutuksen_jarjestajalla_id]


	JOIN d_opintojen_kulku_oppilaitoksen_mukaan d57 ON d57.id = [5a_opiskelijoiden_opintojen_kulku_oppilaitoksen_mukaan_id]
	JOIN d_opintojen_kulku_oppilaitoksen_mukaan d58 ON d58.id = [5b_opiskelijoiden_opintojen_kulku_oppilaitoksen_mukaan_id]
	JOIN d_tutkinto_alkuperaisessa_oppilaitoksessa  d59 ON d59.id = [5c_tutkinto_alkuperaisessa_oppilaitoksessa_id]
	JOIN d_tutkinto_muussa_oppilaitoksessa  d60 ON d60.id = [5d_tutkinto_muussa_oppilaitoksessa_id]
	JOIN d_jatkaa_opiskelua_alkuperaisessa_oppilaitoksessa  d61 ON d61.id = [5e_jatkaa_opiskelua_alkuperaisessa_oppilaitoksessa_id]
	JOIN d_jatkaa_opiskelua_muussa_oppilaitoksessa d62 ON d62.id = [5f_jatkaa_opiskelua_muussa_oppilaitoksessa_id]

	JOIN d_opintojen_kulku_maakunnan_mukaan d63 ON d63.id = [6a_opiskelijoiden_opintojen_kulku_maakunnan_mukaan_id]
	JOIN d_opintojen_kulku_maakunnan_mukaan d64 ON d64.id = [6b_opiskelijoiden_opintojen_kulku_maakunnan_mukaan_id]
	JOIN d_tutkinto_alkuperaisessa_maakunnassa  d65 ON d65.id = [6c_tutkinto_alkuperaisessa_maakunnassa_id]
	JOIN d_tutkinto_muussa_maakunnassa  d66 ON d66.id = [6d_tutkinto_muussa_maakunnassa_id]
	JOIN d_jatkaa_opiskelua_alkuperaisessa_maakunnassa  d67 ON d67.id = [6e_jatkaa_opiskelua_alkuperaisessa_maakunnassa_id]
	JOIN d_jatkaa_opiskelua_muussa_maakunnassa d68 ON d68.id = [6f_jatkaa_opiskelua_muussa_maakunnassa_id]

	JOIN d_opintojen_kulku_koulutussektorin_mukaan d69 ON d69.id = [7a_opiskelijoiden_opintojen_kulku_koulutussektorin_mukaan_id]
	JOIN d_opintojen_kulku_koulutussektorin_mukaan d70 ON d70.id = [7b_opiskelijoiden_opintojen_kulku_koulutussektorin_mukaan_id]
	JOIN d_tutkinto_alkuperaisella_koulutussektorilla d71 ON d71.id = [7c_tutkinto_alkuperaisella_koulutussektorilla_id]
	JOIN d_tutkinto_muulla_koulutussektorilla d72 ON d72.id = [7d_tutkinto_muulla_koulutussektorilla_id]
	JOIN d_jatkaa_opiskelua_alkuperaisella_koulutussektorilla d73 ON d73.id = [7e_jatkaa_opiskelua_alkuperaisella_koulutussektorilla_id]
	JOIN d_jatkaa_opiskelua_muulla_koulutussektorilla d74 ON d74.id = [7f_jatkaa_opiskelua_muulla_koulutussektorilla_id]

	JOIN d_opintojen_kulku_koulutusalan_2002_mukaan_versio2 d75 ON d75.id = [2bb_opiskelijoiden_opintojen_kulku_koulutusala_2002_mukaan_id]
	JOIN d_opintojen_kulku_opintoalan_2002_mukaan_versio2 d76 ON d76.id = [3bb_opiskelijoiden_opintojen_kulku_opintoala_2002_mukaan_id]
	JOIN d_opintojen_kulku_koulutuksen_jarjestajan_mukaan_versio2 d77 ON d77.id = [4bb_opiskelijoiden_opintojen_kulku_koul_jarjestajan_mukaan_id]
	JOIN d_opintojen_kulku_oppilaitoksen_mukaan_versio2 d78 ON d78.id = [5bb_opiskelijoiden_opintojen_kulku_oppilaitoksen_mukaan_id]


WHERE d16.koulutusaste2002_koodi = 31








' 
GO
/****** Object:  View [dbo].[v_f_tab_keskeytaneet_talteen]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_keskeytaneet_talteen]'))
EXEC dbo.sp_executesql @statement = N'















CREATE VIEW [dbo].[v_f_tab_keskeytaneet_talteen] AS

Select
[opiskelijat] AS lkm_int,
[tilastovuosi] AS Tilastovuosi
,d1.aineisto AS Aineisto
,d2.lahde AS Lähde
,d3.sukupuoli AS Sukupuoli
,d4.aidinkieli_versio1 AS Äidinkieli
,d5.ika AS Ikä
,d6.ika AS Ikäryhmä
,d7.kunta AS Asuinkunta
,d7.maakunta AS Asuinmaakunta
,d7.avi AS ''Asuinalueen AVI''
,d7.ely AS ''Asuinalueen ELY''
,d8.kansalaisuus_versio1 AS Kansalaisuus
,d9.eumaa AS ''EU-maan kansalainen''
,d10.etamaa AS ''ETA-maan kansalainen''
,d11.pohjoismaa AS ''Pohjoismaan kansalainen''
,d12.vuosiselite AS Aloitusvuosi
,d14.opiskelijan_olo AS Kirjoillaolo
,d15.oppilaitos as "Oppilaitos"
,d15.oppilaitostyyppi as "Oppilaitostyyppi"
,d15.opetuskieli as "Opetuskieli"
,d15.oppilaitoksen_omistajatyyppi as "Oppil. omistajatyyppi"
,d15.koulutuksen_jarjestaja as "Koulutuksen järjestäjä"
,d15.koulutuksen_jarjestajan_kieli as "Koul. järjestäjän kieli"
,d16.koulutus AS Koulutusnimike
,d16.koulutusala2002 AS Koulutusala
,d16.koulutusala2002 AS "Koulutusala (02 luokitus)"
,d16.opintoala1995 AS "Koulutusala (95 luokitus)"
,d16.opintoala2002 AS Opintoala
,d16.koulutusaste2002 AS Koulutusaste
,d17.koulutuksen_kieli_versio1 AS ''Koulutuksen kieli''
,d18.kunta AS ''Koulutuksen kunta''
,d18.maakunta AS ''Koulutuksen maakunta''
,d18.avi AS "Koulutuksen AVI-alue"
,d18.ely AS "Koulutuksen ELY-alue"
,d19.opetushallinnon_koulutus AS Hallinnonala
,d20.koulutustyyppi AS Koulutustyyppi
,d21.maakunta AS ''Tutk. suoritusmaakunta''
,d22.koulutuksen_jarjestaja AS ''Tutkinnon koul. järjestäjä''
,d22.koulutuksen_jarjestajan_omistajatyyppi AS ''Tutkinnon koul. järjestäjän omistajatyyppi''
,d22.koulutuksen_jarjestajan_kieli ''Tutkinnon koul. järjestäjän kieli''
,d22.koulutuksen_jarjestajan_sijaintikunta AS ''Tutkinnon koul. järjestäjän sijaintikunta''
,d23.oppilaitos AS ''Tutkinnon oppilaitos''
,d23.oppilaitostyyppi as "Tutkinnon oppilaitostyyppi"
,d23.opetuskieli as "Tutkinnon opetuskieli"
,d23.oppilaitoksen_omistajatyyppi as "Tutkinnon oppil. omistajatyyppi"
,d24.koulutus AS ''Tutkinnon koulutusnimike''
,d24.koulutusala2002 AS ''Tutkinnon koulutusala''
,d24.koulutusala2002 AS ''Tutkinnon koulutusala (02 luokitus)''
,d24.opintoala1995 AS "Tutkinnon koulutusala (95 luokitus)"
,d24.opintoala2002 AS ''Tutkinnon opintoala''
,d24.koulutusaste2002 AS ''Tutkinnon koulutusaste''
,d25.koulutustyyppi AS ''Tutkinnon koulutustyyppi''
,d26.maakunta AS ''Seur. vuoden koul. maakunta''
,d27.koulutuksen_jarjestaja AS ''Seur. vuoden koul. järjestäjä''
,d27.koulutuksen_jarjestajan_omistajatyyppi AS ''Seur. vuoden koul. järjestäjän omistajatyyppi''
,d27.koulutuksen_jarjestajan_kieli ''Seur. vuoden koul. järjestäjän kieli''
,d27.koulutuksen_jarjestajan_sijaintikunta AS ''Seur. vuoden koul. järjestäjän sijaintikunta''
,d28.oppilaitos AS ''Seur. vuoden oppilaitos''
,d28.oppilaitostyyppi as "Seur. vuoden oppilaitostyyppi"
,d28.opetuskieli as "Seur. vuoden opetuskieli"
,d28.oppilaitoksen_omistajatyyppi as "Seur. vuoden oppil. omistajatyyppi"
,d29.koulutus AS ''Seur. vuoden koulutusnimike''
,d29.koulutusala2002 AS ''Seur. vuoden koulutusala''
,d29.koulutusala2002 AS ''Seur. vuoden koulutusala (02 luokitus)''
,d29.opintoala1995 AS "Seur. vuoden koulutusala (95 luokitus)"
,d29.opintoala2002 AS ''Seur. vuoden opintoala''
,d29.koulutusaste2002 AS ''Seur. vuoden koulutusaste''
,d30.koulutustyyppi  AS ''Seur. vuoden koulutustyyppi''
,d31.paaasiallinen_toiminta_versio2 AS ''Pääasiallinen toiminta''
,d32.ammattiasema AS Ammattiasema

,d33.opintojen_kulku_koulutusasteen_2002_mukaan AS ''Opintojen kulku 1a''
,d34.opintojen_kulku_koulutusasteen_2002_mukaan AS ''Opintojen kulku 1b''
,d35.tutkinto_alkuperaisella_koulutusasteella_2002 AS ''Tutk. suor. alkup. koul.asteella''
,d36.tutkinto_muulla_koulutusasteella_2002 AS ''Tutk. suor. muulla koul.asteella''
,d37.jatkaa_opiskelua_alkuperaisella_koulutusasteella_2002 AS ''Jatkaa opisk. alkup. koul.asteella''
,d38.jatkaa_opiskelua_muulla_koulutusasteella_2002 AS ''Jatkaa opisk. muulla koul.asteella''

,d39.opintojen_kulku_koulutusalan_2002_mukaan AS ''Opintojen kulku 2a''
,d40.opintojen_kulku_koulutusalan_2002_mukaan AS ''Opintojen kulku 2b''
,d41.tutkinto_alkuperaisella_koulutusalalla_2002 AS ''Tutk. suor. alkup. koul.alalla''
,d42.tutkinto_muulla_koulutusalalla_2002 AS ''Tutk. suor. muulla koul.alalla''
,d43.jatkaa_opiskelua_alkuperaisella_koulutusalalla_2002 AS ''Jatkaa opisk. alkup. koul.alalla''
,d44.jatkaa_opiskelua_muulla_koulutusalalla_2002 AS ''Jatkaa opisk. muulla koul.alalla''

,d45.opintojen_kulku_opintoala_2002_mukaan AS ''Opintojen kulku 3a''
,d46.opintojen_kulku_opintoala_2002_mukaan AS ''Opintojen kulku 3b''
,d47.tutkinto_alkuperaisella_opintoalalla_2002 AS ''Tutk. suor. alkup. opintoalalla''
,d48.tutkinto_muulla_opintoalalla_2002 AS ''Tutk. suor. muulla opintoalalla''
,d49.jatkaa_opiskelua_alkuperaisella_opintoalalla_2002 AS ''Jatkaa opisk. alkup. opintoalalla''
,d50.jatkaa_opiskelua_muulla_opintoalalla_2002 AS ''Jatkaa opisk. muulla opintoalalla''

,d51.opintojen_kulku_koulutuksen_jarjestajan_mukaan AS ''Opintojen kulku 4a''
,d52.opintojen_kulku_koulutuksen_jarjestajan_mukaan AS ''Opintojen kulku 4b''
,d53.tutkinto_alkuperaisella_koulutuksen_jarjestajalla AS ''Tutk. suor. alkup. koul. järjestäjällä''
,d54.tutkinto_muulla_koulutuksen_jarjestajalla AS ''Tutk. suor. muulla koul. järjestäjällä''
,d55.jatkaa_opiskelua_alkuperaisella_koulutuksen_jarjestajalla AS ''Jatkaa opisk. alkup. koul. järjestäjällä''
,d56.jatkaa_opiskelua_muulla_koulutuksen_jarjestajalla AS ''Jatkaa opisk. muulla koul. järjestäjällä''

,d57.opintojen_kulku_oppilaitoksen_mukaan AS ''Opintojen kulku 5a''
,d58.opintojen_kulku_oppilaitoksen_mukaan AS ''Opintojen kulku 5b''
,d59.tutkinto_alkuperaisessa_oppilaitoksessa AS ''Tutk. suor. alkup. oppilaitoksessa''
,d60.tutkinto_muussa_oppilaitoksessa AS ''Tutk. suor. muussa oppilaitoksessa''
,d61.jatkaa_opiskelua_alkuperaisessa_oppilaitoksessa AS ''Jatkaa opisk. alkup. oppilaitoksessa''
,d62.jatkaa_opiskelua_muussa_oppilaitoksessa AS ''Jatkaa opisk. muussa oppilaitoksessa''

,d63.opintojen_kulku_maakunnan_mukaan AS ''Opintojen kulku 6a''
,d64.opintojen_kulku_maakunnan_mukaan AS ''Opintojen kulku 6b''
,d65.tutkinto_alkuperaisessa_maakunnassa AS ''Tutk. suor. alkup. maakunnassa''
,d66.tutkinto_muussa_maakunnassa AS ''Tutk. suor. muussa maakunnassa''
,d67.jatkaa_opiskelua_alkuperaisessa_maakunnassa AS ''Jatkaa opisk. alkup. maakunnassa''
,d68.jatkaa_opiskelua_muussa_maakunnassa AS ''Jatkaa opisk. muussa maakunnassa''

,d69.opintojen_kulku_koulutussektorin_mukaan AS ''Opintojen kulku 7a''
,d70.opintojen_kulku_koulutussektorin_mukaan AS ''Opintojen kulku 7b''
,d71.tutkinto_alkuperaisella_koulutussektorilla AS ''Tutk. suor. alkup. koul.sektorilla''
,d72.tutkinto_muulla_koulutussektorilla AS ''Tutk. suor. muulla koul.sektorilla''
,d73.jatkaa_opiskelua_alkuperaisella_koulutussektorilla AS ''Jatkaa opisk. alkup. koul.sektorilla''
,d74.jatkaa_opiskelua_muulla_koulutussektorilla AS ''Jatkaa opisk. muulla koul.sektorilla''

--järjestysmuuttujat
,d3.jarjestys AS jarj_Sukupuoli
,d4.jarjestys AS jarj_Äidinkieli
,d5.jarjestys_ika AS jarj_Ikä
,d6.jarjestys_ika5v AS jarj_Ikäryhmä
,d7.jarjestys AS jarj_Asuinkunta
,d7.jarjestys_maakunta AS jarj_Asuinmaakunta
,d7.jarjestys_avi AS jarj_AsuinalueenAVI
,d7.jarjestys_ely AS jarj_AsuinalueenELY
,d8.jarjestys AS jarj_Kansalaisuus
,d9.jarjestys_eumaa AS jarj_EU_maankansalainen
,d10.jarjestys_etamaa AS jarj_ETA_maankansalainen
,d11.jarjestys AS jarj_Pohjoismaankansalainen
,d14.jarjestys AS jarj_Kirjoillaolo
,d15.jarjestys_oppilaitostyyppi as jarj_Oppilaitostyyppi
,d15.jarjestys_opetuskieli as jarj_Opetuskieli
,d15.jarjestys_omistajatyyppi as jarj_Oppil_omistajatyyppi
,d15.jarjestys_koulutuksen_jarjestajan_kieli as jarj_Koul_järjestäjänkieli
,d16.jarjestys_koulutusala2002 AS jarj_Koulutusala
,d16.jarjestys_opintoala1995
,d16.jarjestys_opintoala2002 AS jarj_Opintoala
,d16.jarjestys_koulutusaste2002 AS jarj_Koulutusaste
,d17.jarjestys AS jarj_Koulutuksenkieli
,d18.jarjestys AS jarj_Koulutuksenkunta
,d18.jarjestys_maakunta AS jarj_Koulutuksenmaakunta
,d18.jarjestys_avi AS jarj_KoulutuksenAVI_alue
,d18.jarjestys_ely AS jarj_KoulutuksenELY_alue
,d19.jarjestys AS jarj_Hallinnonala
,d20.jarjestys AS jarj_Koulutustyyppi
,d21.jarjestys_maakunta AS jarj_Tutk_suoritusmaakunta
,d22.jarjestys_koulutuksenjarjestaja AS jarj_Tutkinnon_koul_järjestäjän_omistajatyyppi
,d22.jarjestys_koulutuksen_jarjestajan_kieli AS jarj_Tutkinnon_koul_järjestäjän_kieli
,d23.jarjestys_oppilaitostyyppi AS jarj_Tutkinnon_oppilaitostyyppi
,d23.jarjestys_opetuskieli AS jarj_Tutkinnon_opetuskieli
,d23.jarjestys_omistajatyyppi AS jarj_Tutkinnon_oppil_omistajatyyppi
,d24.jarjestys_koulutusala2002 AS jarj_Tutkinnon_koulutusala_02_luokitus
,d24.jarjestys_opintoala1995 AS jarj_Tutkinnon_koulutusala_95_luokitus
,d24.jarjestys_opintoala2002 AS jarj_Tutkinnon_opintoala
,d24.jarjestys_koulutusaste2002 AS jarj_Tutkinnon_koulutusaste
,d25.jarjestys AS jarj_Tutkinnon_koulutustyyppi
,d26.jarjestys_maakunta AS jarj_Seur_vuoden_koul_maakunta
,d27.jarjestys_koulutuksenjarjestaja AS jarj_Seur_vuoden_koul_järjestäjän_omistajatyyppi
,d27.jarjestys_koulutuksen_jarjestajan_kieli AS jarj_Seur_vuoden_koul_järjestäjän_kieli
,d28.jarjestys_oppilaitostyyppi AS jarj_Seur_vuoden_oppilaitostyyppi
,d28.jarjestys_opetuskieli AS jarj_Seur_vuoden_opetuskieli
,d28.jarjestys_omistajatyyppi AS jarj_Seur_vuoden_oppil_omistajatyyppi
,d29.jarjestys_koulutusala2002 AS jarj_Seur_vuoden_koulutusala_02_luokitus
,d29.jarjestys_opintoala1995 AS jarj_Seur_vuoden_koulutusala_95_luokitus
,d29.jarjestys_opintoala2002 AS jarj_Seur_vuoden_opintoala
,d29.jarjestys_koulutusaste2002 AS jarj_Seur_vuoden_koulutusaste
,d30.jarjestys AS jarj_Seur_vuoden_koulutustyyppi
,d31.jarjestys AS jarj_Pääasiallinen_toiminta
,d32.jarjestys AS jarj_Ammattiasema

,d33.jarjestys_1a
,d34.jarjestys_1b
,d35.jarjestys_1c
,d36.jarjestys_1d
,d37.jarjestys_1e
,d38.jarjestys_1f

,d39.jarjestys_2a
,d40.jarjestys_2b
,d41.jarjestys_2c
,d42.jarjestys_2d
,d43.jarjestys_2e
,d44.jarjestys_2f

,d45.jarjestys_3a
,d46.jarjestys_3b
,d47.jarjestys_3c
,d48.jarjestys_3d
,d49.jarjestys_3e
,d50.jarjestys_3f

,d51.jarjestys_4a
,d52.jarjestys_4b
,d53.jarjestys_4c
,d54.jarjestys_4d
,d55.jarjestys_4e
,d56.jarjestys_4f

,d57.jarjestys_5a
,d58.jarjestys_5b
,d59.jarjestys_5c
,d60.jarjestys_5d
,d61.jarjestys_5e
,d62.jarjestys_5f

,d63.jarjestys_6a
,d64.jarjestys_6b
,d65.jarjestys_6c
,d66.jarjestys_6d
,d67.jarjestys_6e
,d68.jarjestys_6f

,d69.jarjestys_7a
,d70.jarjestys_7b
,d71.jarjestys_7c
,d72.jarjestys_7d
,d73.jarjestys_7e
,d74.jarjestys_7f

--koodimuuttujat
,d1.aineisto_koodi AS ''Koodit Aineisto''
,d2.lahde_koodi AS ''Koodit Lähde''
,d7.kunta_koodi AS ''Koodit Asuinkunta''
,d7.maakunta_koodi AS ''Koodit Asuinmaakunta''
,d15.oppilaitoskoodi AS ''Koodit Oppilaitos''
,d15.koulutuksen_jarjestajakoodi AS ''Koodit Koulutuksen järjestäjä''
,d16.koulutus_koodi AS ''Koodit Koulutusnimike''
,d16.koulutusala2002_koodi AS ''Koodit Koulutusala (02 luokitus)''
,d16.opintoala1995_koodi AS ''Koodit Koulutusala (95 luokitus)''
,d16.opintoala2002_koodi AS ''Koodit Opintoala''
,d16.koulutusaste2002_koodi AS ''Koodit Koulutusaste''
,d18.kunta_koodi AS ''Koodit Koulutuksen kunta''
,d18.maakunta_koodi AS ''Koodit Koulutuksen maakunta''
,d20.koulutustyyppi_koodi AS ''Koodit Koulutustyyppi''
,d21.maakunta_koodi AS ''Koodit Tutk. suoritusmaakunta''
,d22.koulutuksen_jarjestajakoodi AS ''Koodit Tutkinnon koul. järjestäjä''
,d23.oppilaitoskoodi AS ''Koodit Tutkinnon oppilaitos''
,d24.koulutus_koodi AS ''Koodit Tutkinnon koulutusnimike''
,d24.koulutusala2002_koodi AS ''Koodit Tutkinnon koulutusala (02 luokitus)''
,d24.opintoala1995_koodi AS ''Koodit Tutkinnon koulutusala (95 luokitus)''
,d24.opintoala2002_koodi AS ''Koodit Tutkinnon opintoala''
,d24.koulutusaste2002_koodi AS ''Koodit Tutkinnon koulutusaste''
,d25.koulutustyyppi_koodi AS ''Koodit Tutkinnon koulutustyyppi''
,d26.maakunta_koodi AS ''Koodit Seur. vuoden koul. maakunta''
,d27.koulutuksen_jarjestajakoodi AS ''Koodit Seur. vuoden koul. järjestäjä''
,d28.oppilaitoskoodi AS ''Koodit Seur. vuoden oppilaitos''
,d29.koulutus_koodi AS ''Koodit Seur. vuoden koulutusnimike''
,d29.koulutusala2002_koodi AS ''Koodit Seur. vuoden koulutusala (02 luokitus)''
,d29.opintoala1995_koodi AS ''Koodit Seur. vuoden koulutusala (95 luokitus)''
,d29.opintoala2002_koodi AS ''Koodit Seur. vuoden opintoala''
,d29.koulutusaste2002_koodi AS ''Koodit Seur. vuoden koulutusaste''
,d30.koulutustyyppi_koodi AS ''Koodit Seur. vuoden koulutustyyppi''

FROM dbo.f_keskeyttaneet
	JOIN d_aineisto d1 ON d1.id = aineisto_id
	JOIN d_lahde d2 ON d2.id = aineisto_id
	JOIN d_sukupuoli d3 ON d3.id = sukupuoli_id
	JOIN d_aidinkieli_versio1 d4 ON d4.id = aidinkieli_versio1x_id
	JOIN d_ika d5 ON d5.id = ika_1v_id
	JOIN d_ika d6 ON d6.id = ika_5v_id
	JOIN d_alueluokitus d7 ON d7.id= kotikunta_id
	JOIN d_kansalaisuus_versio1 d8 ON d8.id= kansalaisuus_versio1_id
	JOIN d_valtio d9 ON d9.id= eumaa_id
	JOIN d_valtio d10 ON d10.id= etamaa_id
	JOIN d_pohjoismaa d11 ON d11.id= pohjoismaa_id
	JOIN d_kausi d12 ON d12.kausi_id= kirjoihintulovuosi_id
	JOIN d_opiskelijan_olo d14 ON d14.id= opiskelijan_olo_lk_id
	JOIN d_oppilaitoksen_taustatiedot d15 ON d15.id= oppilaitoksen_taustatiedot_id
	JOIN d_koulutusluokitus d16 ON d16.id= koulutusluokitus_id
	JOIN d_koulutuksen_kieli_versio1 d17 ON d17.id= koulutuksen_kieli_versio1_id
	JOIN d_alueluokitus d18 ON d18.id= koulutuksen_kunta_id
	JOIN d_opetushallinnon_koulutus d19 ON d19.id= opetushallinnon_koulutus_id
	JOIN d_koulutustyyppi d20 ON d20.id= koulutustyyppi_id
	JOIN d_alueluokitus d21 ON d21.id= tutkinnon_suorittamismaakunta_id
	JOIN d_oppilaitoksen_taustatiedot d22 ON d22.id= tutkinnon_jarjestaja_id
	JOIN d_oppilaitoksen_taustatiedot d23 ON d23.id= tutkinnon_suorittamisoppilaitos_id
	JOIN d_koulutusluokitus d24 ON d24.id= tutkinnon_koulutusluokitus_id
	JOIN d_koulutustyyppi d25 ON d25.id= tutkinnon_koulutustyyppi_id
	JOIN d_alueluokitus d26 ON d26.id= seuraavan_vuoden_maakunta_id
	JOIN d_oppilaitoksen_taustatiedot d27 ON d27.id= seuraavan_vuoden_jarjestaja_id
	JOIN d_oppilaitoksen_taustatiedot d28 ON d28.id= seuraavan_vuoden_oppilaitos_id
	JOIN d_koulutusluokitus d29 ON d29.id= seuraavan_vuoden_koulutusluokitus_id
	JOIN d_koulutustyyppi d30 ON d30.id= seuraavan_vuoden_koulutustyyppi_id
	JOIN d_paaasiallinen_toiminta_versio2 d31 ON d31.id = paaasiallinen_toiminta_versio2_id
	JOIN d_ammattiasema d32 ON d32.id = ammattiasema_id
	JOIN d_opintojen_kulku_koulutusasteen_2002_mukaan  d33 ON d33.id = [1a_opiskelijoiden_opintojen_kulku_koulutusaste_2002_mukaan_id]
	JOIN d_opintojen_kulku_koulutusasteen_2002_mukaan  d34 ON d34.id = [1b_opiskelijoiden_opintojen_kulku_koulutusaste_2002_mukaan_id]
	JOIN d_tutkinto_alkuperaisella_koulutusasteella_2002  d35 ON d35.id = [1c_tutkinto_alkuperaisella_koulutusasteella_2002_id]
	JOIN d_tutkinto_muulla_koulutusasteella_2002  d36 ON d36.id = [1d_tutkinto_muulla_koulutusasteella_2002_id]
	JOIN d_jatkaa_opiskelua_alkuperaisella_koulutusasteella_2002 d37 ON d37.id = [1e_jatkaa_opiskelua_alkuperaisella_koulutusasteella_2002_id]
	JOIN d_jatkaa_opiskelua_muulla_koulutusasteella_2002 d38 ON d38.id = [1f_jatkaa_opiskelua_muulla_koulutusasteella_2002_id]
	JOIN d_opintojen_kulku_koulutusalan_2002_mukaan d39 ON d39.id = [2a_opiskelijoiden_opintojen_kulku_koulutusala_2002_mukaan_id]
	JOIN d_opintojen_kulku_koulutusalan_2002_mukaan d40 ON d40.id = [2b_opiskelijoiden_opintojen_kulku_koulutusala_2002_mukaan_id]
	JOIN d_tutkinto_alkuperaisella_koulutusalalla_2002  d41 ON d41.id = [2c_tutkinto_alkuperaisella_koulutusalalla_2002_id]
	JOIN d_tutkinto_muulla_koulutusalalla_2002  d42 ON d42.id = [2d_tutkinto_muulla_koulutusalalla_2002_id]
	JOIN d_jatkaa_opiskelua_alkuperaisella_koulutusalalla_2002  d43 ON d43.id = [2e_jatkaa_opiskelua_alkuperaisella_koulutusalalla_2002_id]
	JOIN d_jatkaa_opiskelua_muulla_koulutusalalla_2002  d44 ON d44.id = [2f_jatkaa_opiskelua_muulla_koulutusalalla_2002_id]

	JOIN d_opintojen_kulku_opintoalan_2002_mukaan d45 ON d45.id = [3a_opiskelijoiden_opintojen_kulku_opintoala_2002_mukaan_id]
	JOIN d_opintojen_kulku_opintoalan_2002_mukaan d46 ON d46.id = [3b_opiskelijoiden_opintojen_kulku_opintoala_2002_mukaan_id]
	JOIN d_tutkinto_alkuperaisella_opintoalalla_2002  d47 ON d47.id = [3c_tutkinto_alkuperaisella_opintoalalla_2002_id]
	JOIN d_tutkinto_muulla_opintoalalla_2002  d48 ON d48.id = [3d_tutkinto_muulla_opintoalalla_2002_id]
	JOIN d_jatkaa_opiskelua_alkuperaisella_opintoalalla_2002  d49 ON d49.id = [3e_jatkaa_opiskelua_alkuperaisella_opintoalalla_2002_id]
	JOIN d_jatkaa_opiskelua_muulla_opintoalalla_2002  d50 ON d50.id = [3f_jatkaa_opiskelua_muulla_opintoalalla_2002_id]

	JOIN d_opintojen_kulku_koulutuksen_jarjestajan_mukaan d51 ON d51.id = [4a_opiskelijoiden_opintojen_kulku_koul_jarjestajan_mukaan_id]
	JOIN d_opintojen_kulku_koulutuksen_jarjestajan_mukaan d52 ON d52.id = [4b_opiskelijoiden_opintojen_kulku_koul_jarjestajan_mukaan_id]
	JOIN d_tutkinto_alkuperaisella_koulutuksen_jarjestajalla  d53 ON d53.id = [4c_tutkinto_alkuperaisella_koulutuksen_jarjestajalla_id]
	JOIN d_tutkinto_muulla_koulutuksen_jarjestajalla  d54 ON d54.id = [4d_tutkinto_muulla_koulutuksen_jarjestajalla_id]
	JOIN d_jatkaa_opiskelua_alkuperaisella_koulutuksen_jarjestajalla  d55 ON d55.id = [4e_jatkaa_opiskelua_alkuperaisella_koulutuksen_jarjestajalla_id]
	JOIN d_jatkaa_opiskelua_muulla_koulutuksen_jarjestajalla  d56 ON d56.id = [4f_jatkaa_opiskelua_muulla_koulutuksen_jarjestajalla_id]


	JOIN d_opintojen_kulku_oppilaitoksen_mukaan d57 ON d57.id = [5a_opiskelijoiden_opintojen_kulku_oppilaitoksen_mukaan_id]
	JOIN d_opintojen_kulku_oppilaitoksen_mukaan d58 ON d58.id = [5b_opiskelijoiden_opintojen_kulku_oppilaitoksen_mukaan_id]
	JOIN d_tutkinto_alkuperaisessa_oppilaitoksessa  d59 ON d59.id = [5c_tutkinto_alkuperaisessa_oppilaitoksessa_id]
	JOIN d_tutkinto_muussa_oppilaitoksessa  d60 ON d60.id = [5d_tutkinto_muussa_oppilaitoksessa_id]
	JOIN d_jatkaa_opiskelua_alkuperaisessa_oppilaitoksessa  d61 ON d61.id = [5e_jatkaa_opiskelua_alkuperaisessa_oppilaitoksessa_id]
	JOIN d_jatkaa_opiskelua_muussa_oppilaitoksessa d62 ON d62.id = [5f_jatkaa_opiskelua_muussa_oppilaitoksessa_id]

	JOIN d_opintojen_kulku_maakunnan_mukaan d63 ON d63.id = [6a_opiskelijoiden_opintojen_kulku_maakunnan_mukaan_id]
	JOIN d_opintojen_kulku_maakunnan_mukaan d64 ON d64.id = [6b_opiskelijoiden_opintojen_kulku_maakunnan_mukaan_id]
	JOIN d_tutkinto_alkuperaisessa_maakunnassa  d65 ON d65.id = [6c_tutkinto_alkuperaisessa_maakunnassa_id]
	JOIN d_tutkinto_muussa_maakunnassa  d66 ON d66.id = [6d_tutkinto_muussa_maakunnassa_id]
	JOIN d_jatkaa_opiskelua_alkuperaisessa_maakunnassa  d67 ON d67.id = [6e_jatkaa_opiskelua_alkuperaisessa_maakunnassa_id]
	JOIN d_jatkaa_opiskelua_muussa_maakunnassa d68 ON d68.id = [6f_jatkaa_opiskelua_muussa_maakunnassa_id]

	JOIN d_opintojen_kulku_koulutussektorin_mukaan d69 ON d69.id = [7a_opiskelijoiden_opintojen_kulku_koulutussektorin_mukaan_id]
	JOIN d_opintojen_kulku_koulutussektorin_mukaan d70 ON d70.id = [7b_opiskelijoiden_opintojen_kulku_koulutussektorin_mukaan_id]
	JOIN d_tutkinto_alkuperaisella_koulutussektorilla d71 ON d71.id = [7c_tutkinto_alkuperaisella_koulutussektorilla_id]
	JOIN d_tutkinto_muulla_koulutussektorilla d72 ON d72.id = [7d_tutkinto_muulla_koulutussektorilla_id]
	JOIN d_jatkaa_opiskelua_alkuperaisella_koulutussektorilla d73 ON d73.id = [7e_jatkaa_opiskelua_alkuperaisella_koulutussektorilla_id]
	JOIN d_jatkaa_opiskelua_muulla_koulutussektorilla d74 ON d74.id = [7f_jatkaa_opiskelua_muulla_koulutussektorilla_id]





' 
GO
/****** Object:  View [dbo].[v_f_tab_keskeytaneet_yliopisto]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_keskeytaneet_yliopisto]'))
EXEC dbo.sp_executesql @statement = N'


























CREATE VIEW [dbo].[v_f_tab_keskeytaneet_yliopisto] AS

Select
[opiskelijat] AS lkm_int,
[tilastovuosi] AS Tilastovuosi
,d1.aineisto AS Aineisto
,d2.lahde AS Lähde
,d3.sukupuoli AS Sukupuoli
,d4.aidinkieli_versio1 AS Äidinkieli
,d5.ika AS Ikä
,d6.ika AS Ikäryhmä
,d7.kunta AS Asuinkunta
,d7.maakunta AS Asuinmaakunta
,d7.avi AS ''Asuinalueen AVI''
,d7.ely AS ''Asuinalueen ELY''
,d8.kansalaisuus_versio1 AS Kansalaisuus
,d9.eumaa AS ''EU-maan kansalainen''
,d10.etamaa AS ''ETA-maan kansalainen''
,d11.pohjoismaa AS ''Pohjoismaan kansalainen''
,d12.vuosiselite AS Aloitusvuosi
,d14.opiskelijan_olo AS Kirjoillaolo
,d15.oppilaitos as "Yliopisto"
,d15.oppilaitostyyppi as "Oppilaitostyyppi"
,d15.opetuskieli as "Opetuskieli"
,d15.oppilaitoksen_omistajatyyppi as "Oppil. omistajatyyppi"
,d15.koulutuksen_jarjestaja as "Koulutuksen järjestäjä"
,d15.koulutuksen_jarjestajan_kieli as "Koul. järjestäjän kieli"
,d16.koulutus AS Koulutusnimike
,d16.koulutusala2002 AS Koulutusala
,d16.koulutusala2002 AS "Koulutusala (02 luokitus)"
,d16.opintoala1995 AS "Koulutusala (95 luokitus)"
,d16.opintoala2002 AS Opintoala
,Case when d16.koulutusaste2002_koodi in (''63'',''72'')
			then ''Alempi ja ylempi korkeakoulututkinto''
			else d16.koulutusaste2002 end AS Koulutusaste 
,d17.koulutuksen_kieli_versio1 AS ''Koulutuksen kieli''
,d18.kunta AS ''Koulutuksen kunta''
,d18.maakunta AS ''Koulutuksen maakunta''
,d18.avi AS "Koulutuksen AVI-alue"
,d18.ely AS "Koulutuksen ELY-alue"
,d19.opetushallinnon_koulutus AS Hallinnonala
,d20.koulutustyyppi AS Koulutustyyppi
,d21.maakunta AS ''Tutk. suoritusmaakunta''
,d22.koulutuksen_jarjestaja AS ''Tutkinnon koul. järjestäjä''
,d22.koulutuksen_jarjestajan_omistajatyyppi AS ''Tutkinnon koul. järjestäjän omistajatyyppi''
,d22.koulutuksen_jarjestajan_kieli ''Tutkinnon koul. järjestäjän kieli''
,d22.koulutuksen_jarjestajan_sijaintikunta AS ''Tutkinnon koul. järjestäjän sijaintikunta''
,d23.oppilaitos AS ''Tutkinnon oppilaitos''
,d23.oppilaitostyyppi as "Tutkinnon oppilaitostyyppi"
,d23.opetuskieli as "Tutkinnon opetuskieli"
,d23.oppilaitoksen_omistajatyyppi as "Tutkinnon oppil. omistajatyyppi"
,d24.koulutus AS ''Tutkinnon koulutusnimike''
,d24.koulutusala2002 AS ''Tutkinnon koulutusala''
,d24.koulutusala2002 AS ''Tutkinnon koulutusala (02 luokitus)''
,d24.opintoala1995 AS "Tutkinnon koulutusala (95 luokitus)"
,d24.opintoala2002 AS ''Tutkinnon opintoala''
,d24.koulutusaste2002 AS ''Tutkinnon koulutusaste''
,d25.koulutustyyppi AS ''Tutkinnon koulutustyyppi''
,d26.maakunta AS ''Seur. vuoden koul. maakunta''
,d27.koulutuksen_jarjestaja AS ''Seur. vuoden koul. järjestäjä''
,d27.koulutuksen_jarjestajan_omistajatyyppi AS ''Seur. vuoden koul. järjestäjän omistajatyyppi''
,d27.koulutuksen_jarjestajan_kieli ''Seur. vuoden koul. järjestäjän kieli''
,d27.koulutuksen_jarjestajan_sijaintikunta AS ''Seur. vuoden koul. järjestäjän sijaintikunta''
,d28.oppilaitos AS ''Seur. vuoden oppilaitos''
,d28.oppilaitostyyppi as "Seur. vuoden oppilaitostyyppi"
,d28.opetuskieli as "Seur. vuoden opetuskieli"
,d28.oppilaitoksen_omistajatyyppi as "Seur. vuoden oppil. omistajatyyppi"
,d29.koulutus AS ''Seur. vuoden koulutusnimike''
,d29.koulutusala2002 AS ''Seur. vuoden koulutusala''
,d29.koulutusala2002 AS ''Seur. vuoden koulutusala (02 luokitus)''
,d29.opintoala1995 AS "Seur. vuoden koulutusala (95 luokitus)"
,d29.opintoala2002 AS ''Seur. vuoden opintoala''
,d29.koulutusaste2002 AS ''Seur. vuoden koulutusaste''
,d30.koulutustyyppi  AS ''Seur. vuoden koulutustyyppi''
,d31.paaasiallinen_toiminta_versio2 AS ''Pääasiallinen toiminta''
,d32.ammattiasema AS Ammattiasema

--,d33.opintojen_kulku_koulutusasteen_2002_mukaan AS ''Opintojen kulku 1a''
--,d34.opintojen_kulku_koulutusasteen_2002_mukaan AS ''Opintojen kulku 1b''
--,d35.tutkinto_alkuperaisella_koulutusasteella_2002 AS ''Tutk. suor. alkup. koul.asteella''
--,d36.tutkinto_muulla_koulutusasteella_2002 AS ''Tutk. suor. muulla koul.asteella''
--,d37.jatkaa_opiskelua_alkuperaisella_koulutusasteella_2002 AS ''Jatkaa opisk. alkup. koul.asteella''
--,d38.jatkaa_opiskelua_muulla_koulutusasteella_2002 AS ''Jatkaa opisk. muulla koul.asteella''

--,d39.opintojen_kulku_koulutusalan_2002_mukaan AS ''Opintojen kulku 2a''
--,d40.opintojen_kulku_koulutusalan_2002_mukaan AS ''Opintojen kulku 2b''
--,d41.tutkinto_alkuperaisella_koulutusalalla_2002 AS ''Tutk. suor. alkup. koul.alalla''
--,d42.tutkinto_muulla_koulutusalalla_2002 AS ''Tutk. suor. muulla koul.alalla''
--,d43.jatkaa_opiskelua_alkuperaisella_koulutusalalla_2002 AS ''Jatkaa opisk. alkup. koul.alalla''
--,d44.jatkaa_opiskelua_muulla_koulutusalalla_2002 AS ''Jatkaa opisk. muulla koul.alalla''

--,d45.opintojen_kulku_opintoala_2002_mukaan AS ''Opintojen kulku 3a''
--,d46.opintojen_kulku_opintoala_2002_mukaan AS ''Opintojen kulku 3b''
--,d47.tutkinto_alkuperaisella_opintoalalla_2002 AS ''Tutk. suor. alkup. opintoalalla''
--,d48.tutkinto_muulla_opintoalalla_2002 AS ''Tutk. suor. muulla opintoalalla''
--,d49.jatkaa_opiskelua_alkuperaisella_opintoalalla_2002 AS ''Jatkaa opisk. alkup. opintoalalla''
--,d50.jatkaa_opiskelua_muulla_opintoalalla_2002 AS ''Jatkaa opisk. muulla opintoalalla''

--,d51.opintojen_kulku_koulutuksen_jarjestajan_mukaan AS ''Opintojen kulku 4a''
--,d52.opintojen_kulku_koulutuksen_jarjestajan_mukaan AS ''Opintojen kulku 4b''
--,d53.tutkinto_alkuperaisella_koulutuksen_jarjestajalla AS ''Tutk. suor. alkup. koul. järjestäjällä''
--,d54.tutkinto_muulla_koulutuksen_jarjestajalla AS ''Tutk. suor. muulla koul. järjestäjällä''
--,d55.jatkaa_opiskelua_alkuperaisella_koulutuksen_jarjestajalla AS ''Jatkaa opisk. alkup. koul. järjestäjällä''
--,d56.jatkaa_opiskelua_muulla_koulutuksen_jarjestajalla AS ''Jatkaa opisk. muulla koul. järjestäjällä''

--,d57.opintojen_kulku_oppilaitoksen_mukaan AS ''Opintojen kulku 5a''
--,d58.opintojen_kulku_oppilaitoksen_mukaan AS ''Opintojen kulku 5b''
--,d59.tutkinto_alkuperaisessa_oppilaitoksessa AS ''Tutk. suor. alkup. oppilaitoksessa''
--,d60.tutkinto_muussa_oppilaitoksessa AS ''Tutk. suor. muussa oppilaitoksessa''
--,d61.jatkaa_opiskelua_alkuperaisessa_oppilaitoksessa AS ''Jatkaa opisk. alkup. oppilaitoksessa''
--,d62.jatkaa_opiskelua_muussa_oppilaitoksessa AS ''Jatkaa opisk. muussa oppilaitoksessa''

--,d63.opintojen_kulku_maakunnan_mukaan AS ''Opintojen kulku 6a''
--,d64.opintojen_kulku_maakunnan_mukaan AS ''Opintojen kulku 6b''
--,d65.tutkinto_alkuperaisessa_maakunnassa AS ''Tutk. suor. alkup. maakunnassa''
--,d66.tutkinto_muussa_maakunnassa AS ''Tutk. suor. muussa maakunnassa''
--,d67.jatkaa_opiskelua_alkuperaisessa_maakunnassa AS ''Jatkaa opisk. alkup. maakunnassa''
--,d68.jatkaa_opiskelua_muussa_maakunnassa AS ''Jatkaa opisk. muussa maakunnassa''

--,d69.opintojen_kulku_koulutussektorin_mukaan AS ''Opintojen kulku 7a''
--,d70.opintojen_kulku_koulutussektorin_mukaan AS ''Opintojen kulku 7b''
--,d71.tutkinto_alkuperaisella_koulutussektorilla AS ''Tutk. suor. alkup. koul.sektorilla''
--,d72.tutkinto_muulla_koulutussektorilla AS ''Tutk. suor. muulla koul.sektorilla''
--,d73.jatkaa_opiskelua_alkuperaisella_koulutussektorilla AS ''Jatkaa opisk. alkup. koul.sektorilla''
--,d74.jatkaa_opiskelua_muulla_koulutussektorilla AS ''Jatkaa opisk. muulla koul.sektorilla''
,d75.opintojen_kulku_koulutusalan_2002_mukaan_versio2 AS ''Opintojen kulku (koulutusala)''
--,d76.opintojen_kulku_opintoala_2002_mukaan_versio2 AS ''Opintojen kulku 3bb''
--,d77.opintojen_kulku_koulutuksen_jarjestajan_mukaan_versio2 AS ''Opintojen kulku 4bb''
,d78.opintojen_kulku_oppilaitoksen_mukaan_versio2 AS ''Opintojen kulku (oppilaitos)''

--Ruotsi
,[tilastovuosi] AS Statistikår
,d3.sukupuoli_SV AS Kön
,d4.aidinkieli_versio1_SV AS Modersmål
,d6.ika_SV AS Åldersgrupp
,d7.kunta_SV AS Bostadskommun
,d7.maakunta_SV AS Bostadslandskap
,d8.kansalaisuus_versio1_SV AS Medborgarskap
,d16.koulutus_SV AS Utbildningsbenämning
,d17.koulutuksen_kieli_versio1_SV AS [Utbildningens språk]
,d18.kunta_SV AS [Ubildningens kommun]
,d18.maakunta_SV AS [Utbildningens landskap]
,d21.maakunta_SV AS [Landskap där examen avlagts]
,d15.koulutuksen_jarjestaja_SV as [Utbildningsanordnare]
,d15.oppilaitos_SV as [Universitet]
,d75.opintojen_kulku_koulutusalan_2002_mukaan_versio2_SV AS ''Studieförlopp (utb.område)''
,d78.opintojen_kulku_oppilaitoksen_mukaan_versio2_SV AS ''Studieförlopp (läroanstalt)''
,d16.koulutusaste2002_SV AS Utbildningsnivå
,d20.koulutustyyppi_SV AS [Typ av utbildning]
,d16.koulutusala2002_SV AS [Utbildningsområde 2002]
,d16.opintoala2002_SV AS [Studieområde 2002]
,d28.oppilaitos_SV AS ''Nästä års läroanstalt''
,d23.oppilaitos_SV AS ''Läroanstalt där examen avlagts''
,d16.opintoala1995_SV AS [Studieområde 1995]

--Englanti
,[tilastovuosi] AS [Statistical year]
,d3.sukupuoli_EN AS Gender
,d4.aidinkieli_versio1_EN AS [Mother tongue]
,d6.ika_EN AS [Age group]
,d7.kunta_EN AS [Municipality of residence]
,d7.maakunta_EN AS [Region of residence]
,d8.kansalaisuus_versio1_EN AS Nationality
,d16.koulutus_EN AS [Name of education]
,d17.koulutuksen_kieli_versio1_EN AS [Language of education]
,d18.kunta_EN AS [Municipality of education]
,d18.maakunta_EN AS [Region of education]
,d21.maakunta_EN AS [Region of degree]
,d15.koulutuksen_jarjestaja_EN as [Education provider]
,d15.oppilaitos_EN as University
,d75.opintojen_kulku_koulutusalan_2002_mukaan_versio2_EN AS ''Progress of studies (field of ed.)''
,d78.opintojen_kulku_oppilaitoksen_mukaan_versio2_EN AS ''Progress of studies (ed. institution)''
,d16.koulutusaste2002_EN AS ''Level of education''
,d20.koulutustyyppi_EN AS [Type of education]
,d16.koulutusala2002_EN AS [Field of education 2002]
,d16.opintoala2002_EN AS [Subfield of education 2002]
,d28.oppilaitos_EN AS ''Next year''''s ed. institution''
,d23.oppilaitos_EN AS ''Ed. institution of degree''
,d16.opintoala1995_EN AS [Subfield of education 1995]

--isced
,d16.iscle2011 as "Koulutusaste, taso 1"
,d16.Koulutusaste_taso2 as "Koulutusaste, taso 2"
,d16.iscfibroad2013 as "Koulutusala, taso 1"
,d16.iscfinarrow2013 as "Koulutusala, taso 2"
,d16.iscfi2013 as "Koulutusala, taso 3"
,d16.OKM_ohjauksen_ala as "OKM ohjauksen ala"
,d16.iscle2011_SV as "Utbildn.nivå, nivå 1"
,d16.Koulutusaste_taso2_SV as "Utbildn.nivå, nivå 2"
,d16.iscfibroad2013_SV as "Utbildn.område, nivå 1"
,d16.iscfinarrow2013_SV as "Utbildn.område, nivå 2"
,d16.iscfi2013_SV as "Utbildn.område, nivå 3"
,d16.OKM_ohjauksen_ala_SV as "UKM-styrningsområde"
,d16.iscle2011_EN as "Level of education, tier 1"
,d16.Koulutusaste_taso2_EN as "Level of education, tier 2"
,d16.iscfibroad2013_EN as "Field of education, tier 1"
,d16.iscfinarrow2013_EN as "Field of education, tier 2"
,d16.iscfi2013_EN as "Field of education, tier 3"
,d16.OKM_ohjauksen_ala_EN as "Field of ed., HE steering"
,d16.jarjestys_iscle2011 as jarj_isced_koulast1
,d16.jarjestys_Koulutusaste_taso2 as jarj_isced_koulast2
,d16.jarjestys_iscfibroad2013 as jarj_isced_koulala1
,d16.jarjestys_iscfinarrow2013 as jarj_isced_koulala2
,d16.jarjestys_iscfi2013 as jarj_isced_koulala3
,d16.jarjestys_OKM_ohjauksen_ala as jarj_isced_okmohjaus1
,d16.iscle2011_koodi as "Koodit Koulutusaste, taso 1"
,d16.Koulutusaste_taso2_koodi as "Koodit Koulutusaste, taso 2"
,d16.iscfibroad2013_koodi as "Koodit Koulutusala, taso 1"
,d16.iscfinarrow2013_koodi as "Koodit Koulutusala, taso 2"
,d16.iscfi2013_koodi as "Koodit Koulutusala, taso 3"
,d16.OKM_ohjauksen_ala_koodi as "Koodit OKM ohjauksen ala"
,d24.iscle2011 as "Tutkinnon koulutusaste 1"
,d24.Koulutusaste_taso2 as "Tutkinnon koulutusaste 2"
,d24.iscfibroad2013 as "Tutkinnon koulutusala 1"
,d24.iscfinarrow2013 as "Tutkinnon koulutusala 2"
,d24.iscfi2013 as "Tutkinnon koulutusala 3"
,d24.OKM_ohjauksen_ala as "Tutkinnon OKM ohjauksen ala"
,d24.jarjestys_iscle2011 as jarj_isced2_koulast1
,d24.jarjestys_Koulutusaste_taso2 as jarj_isced2_koulast2
,d24.jarjestys_iscfibroad2013 as jarj_isced2_koulala1
,d24.jarjestys_iscfinarrow2013 as jarj_isced2_koulala2
,d24.jarjestys_iscfi2013 as jarj_isced2_koulala3
,d24.jarjestys_OKM_ohjauksen_ala as jarj_isced2_okmohjaus1
,d24.iscle2011_koodi as "Koodit Tutkinnon koulutusaste 1"
,d24.Koulutusaste_taso2_koodi as "Koodit Tutkinnon koulutusaste 2"
,d24.iscfibroad2013_koodi as "Koodit Tutkinnon koulutusala 1"
,d24.iscfinarrow2013_koodi as "Koodit Tutkinnon koulutusala 2"
,d24.iscfi2013_koodi as "Koodit Tutkinnon koulutusala 3"
,d24.OKM_ohjauksen_ala_koodi as "Koodit Tutkinnon OKM ohjauksen ala"
,d29.iscle2011 as "Seur. vuoden koulutusaste 1"
,d29.Koulutusaste_taso2 as "Seur. vuoden koulutusaste 2"
,d29.iscfibroad2013 as "Seur. vuoden koulutusala 1"
,d29.iscfinarrow2013 as "Seur. vuoden koulutusala 2"
,d29.iscfi2013 as "Seur. vuoden koulutusala 3"
,d29.OKM_ohjauksen_ala as "Seur. vuoden OKM ohjauksen ala"
,d29.jarjestys_iscle2011 as jarj_isced3_koulast1
,d29.jarjestys_Koulutusaste_taso2 as jarj_isced3_koulast2
,d29.jarjestys_iscfibroad2013 as jarj_isced3_koulala1
,d29.jarjestys_iscfinarrow2013 as jarj_isced3_koulala2
,d29.jarjestys_iscfi2013 as jarj_isced3_koulala3
,d29.jarjestys_OKM_ohjauksen_ala as jarj_isced3_okmohjaus1
,d29.iscle2011_koodi as "Koodit Seur. vuoden koulutusaste 1"
,d29.Koulutusaste_taso2_koodi as "Koodit Seur. vuoden koulutusaste 2"
,d29.iscfibroad2013_koodi as "Koodit Seur. vuoden koulutusala 1"
,d29.iscfinarrow2013_koodi as "Koodit Seur. vuoden koulutusala 2"
,d29.iscfi2013_koodi as "Koodit Seur. vuoden koulutusala 3"
,d29.OKM_ohjauksen_ala_koodi as "Koodit Seur. vuoden OKM ohjauksen ala"


--järjestysmuuttujat
,d3.jarjestys AS jarj_Sukupuoli
,d4.jarjestys AS jarj_Äidinkieli
,d5.jarjestys_ika AS jarj_Ikä
,d6.jarjestys_ika5v AS jarj_Ikäryhmä
,d7.jarjestys AS jarj_Asuinkunta
,d7.jarjestys_maakunta AS jarj_Asuinmaakunta
,d7.jarjestys_avi AS jarj_AsuinalueenAVI
,d7.jarjestys_ely AS jarj_AsuinalueenELY
,d8.jarjestys AS jarj_Kansalaisuus
,d9.jarjestys_eumaa AS jarj_EU_maankansalainen
,d10.jarjestys_etamaa AS jarj_ETA_maankansalainen
,d11.jarjestys AS jarj_Pohjoismaankansalainen
,d14.jarjestys AS jarj_Kirjoillaolo
,d15.jarjestys_oppilaitostyyppi as jarj_Oppilaitostyyppi
,d15.jarjestys_opetuskieli as jarj_Opetuskieli
,d15.jarjestys_omistajatyyppi as jarj_Oppil_omistajatyyppi
,d15.jarjestys_koulutuksen_jarjestajan_kieli as jarj_Koul_järjestäjänkieli
,d16.jarjestys_koulutusala2002 AS jarj_Koulutusala
,d16.jarjestys_opintoala1995
,d16.jarjestys_opintoala2002 AS jarj_Opintoala
,Case when d16.koulutusaste2002_koodi in (''63'',''72'')

                                     then ''72''

                                     else d16.koulutusaste2002_koodi end AS jarj_Koulutusaste
--,d16.jarjestys_koulutusaste2002 AS jarj_Koulutusaste
,d17.jarjestys AS jarj_Koulutuksenkieli
,d18.jarjestys AS jarj_Koulutuksenkunta
,d18.jarjestys_maakunta AS jarj_Koulutuksenmaakunta
,d18.jarjestys_avi AS jarj_KoulutuksenAVI_alue
,d18.jarjestys_ely AS jarj_KoulutuksenELY_alue
,d19.jarjestys AS jarj_Hallinnonala
,d20.jarjestys AS jarj_Koulutustyyppi
,d21.jarjestys_maakunta AS jarj_Tutk_suoritusmaakunta
,d22.jarjestys_koulutuksenjarjestaja AS jarj_Tutkinnon_koul_järjestäjän_omistajatyyppi
,d22.jarjestys_koulutuksen_jarjestajan_kieli AS jarj_Tutkinnon_koul_järjestäjän_kieli
,d23.jarjestys_oppilaitostyyppi AS jarj_Tutkinnon_oppilaitostyyppi
,d23.jarjestys_opetuskieli AS jarj_Tutkinnon_opetuskieli
,d23.jarjestys_omistajatyyppi AS jarj_Tutkinnon_oppil_omistajatyyppi
,d24.jarjestys_koulutusala2002 AS jarj_Tutkinnon_koulutusala_02_luokitus
,d24.jarjestys_opintoala1995 AS jarj_Tutkinnon_koulutusala_95_luokitus
,d24.jarjestys_opintoala2002 AS jarj_Tutkinnon_opintoala
,d24.jarjestys_koulutusaste2002 AS jarj_Tutkinnon_koulutusaste
,d25.jarjestys AS jarj_Tutkinnon_koulutustyyppi
,d26.jarjestys_maakunta AS jarj_Seur_vuoden_koul_maakunta
,d27.jarjestys_koulutuksenjarjestaja AS jarj_Seur_vuoden_koul_järjestäjän_omistajatyyppi
,d27.jarjestys_koulutuksen_jarjestajan_kieli AS jarj_Seur_vuoden_koul_järjestäjän_kieli
,d28.jarjestys_oppilaitostyyppi AS jarj_Seur_vuoden_oppilaitostyyppi
,d28.jarjestys_opetuskieli AS jarj_Seur_vuoden_opetuskieli
,d28.jarjestys_omistajatyyppi AS jarj_Seur_vuoden_oppil_omistajatyyppi
,d29.jarjestys_koulutusala2002 AS jarj_Seur_vuoden_koulutusala_02_luokitus
,d29.jarjestys_opintoala1995 AS jarj_Seur_vuoden_koulutusala_95_luokitus
,d29.jarjestys_opintoala2002 AS jarj_Seur_vuoden_opintoala
,d29.jarjestys_koulutusaste2002 AS jarj_Seur_vuoden_koulutusaste
,d30.jarjestys AS jarj_Seur_vuoden_koulutustyyppi
,d31.jarjestys AS jarj_Pääasiallinen_toiminta
,d32.jarjestys AS jarj_Ammattiasema

--,d33.jarjestys_1a
--,d34.jarjestys_1b
--,d35.jarjestys_1c
--,d36.jarjestys_1d
--,d37.jarjestys_1e
--,d38.jarjestys_1f

--,d39.jarjestys_2a
--,d40.jarjestys_2b
--,d41.jarjestys_2c
--,d42.jarjestys_2d
--,d43.jarjestys_2e
--,d44.jarjestys_2f

--,d45.jarjestys_3a
--,d46.jarjestys_3b
--,d47.jarjestys_3c
--,d48.jarjestys_3d
--,d49.jarjestys_3e
--,d50.jarjestys_3f

--,d51.jarjestys_4a
--,d52.jarjestys_4b
--,d53.jarjestys_4c
--,d54.jarjestys_4d
--,d55.jarjestys_4e
--,d56.jarjestys_4f

--,d57.jarjestys_5a
--,d58.jarjestys_5b
--,d59.jarjestys_5c
--,d60.jarjestys_5d
--,d61.jarjestys_5e
--,d62.jarjestys_5f

--,d63.jarjestys_6a
--,d64.jarjestys_6b
--,d65.jarjestys_6c
--,d66.jarjestys_6d
--,d67.jarjestys_6e
--,d68.jarjestys_6f

--,d69.jarjestys_7a
--,d70.jarjestys_7b
--,d71.jarjestys_7c
--,d72.jarjestys_7d
--,d73.jarjestys_7e
--,d74.jarjestys_7f
,d75.jarjestys_2bb
--,d76.jarjestys_3bb
--,d77.jarjestys_4bb
,d78.jarjestys_5bb

--koodimuuttujat
,d1.aineisto_koodi AS ''Koodit Aineisto''
,d2.lahde_koodi AS ''Koodit Lähde''
,d7.kunta_koodi AS ''Koodit Asuinkunta''
,d7.maakunta_koodi AS ''Koodit Asuinmaakunta''
,d15.oppilaitoskoodi AS ''Koodit Oppilaitos''
,d15.koulutuksen_jarjestajakoodi AS ''Koodit Koulutuksen järjestäjä''
,d16.koulutus_koodi AS ''Koodit Koulutusnimike''
,d16.koulutusala2002_koodi AS ''Koodit Koulutusala (02 luokitus)''
,d16.opintoala1995_koodi AS ''Koodit Koulutusala (95 luokitus)''
,d16.opintoala2002_koodi AS ''Koodit Opintoala''
,Case when d16.koulutusaste2002_koodi in (''63'',''72'')

                                     then ''72''

                                     else d16.koulutusaste2002_koodi end AS ''Koodit Koulutusaste''
--,d16.koulutusaste2002_koodi AS ''Koodit Koulutusaste''
,d18.kunta_koodi AS ''Koodit Koulutuksen kunta''
,d18.maakunta_koodi AS ''Koodit Koulutuksen maakunta''
,d20.koulutustyyppi_koodi AS ''Koodit Koulutustyyppi''
,d21.maakunta_koodi AS ''Koodit Tutk. suoritusmaakunta''
,d22.koulutuksen_jarjestajakoodi AS ''Koodit Tutkinnon koul. järjestäjä''
,d23.oppilaitoskoodi AS ''Koodit Tutkinnon oppilaitos''
,d24.koulutus_koodi AS ''Koodit Tutkinnon koulutusnimike''
,d24.koulutusala2002_koodi AS ''Koodit Tutkinnon koulutusala (02 luokitus)''
,d24.opintoala1995_koodi AS ''Koodit Tutkinnon koulutusala (95 luokitus)''
,d24.opintoala2002_koodi AS ''Koodit Tutkinnon opintoala''
,d24.koulutusaste2002_koodi AS ''Koodit Tutkinnon koulutusaste''
,d25.koulutustyyppi_koodi AS ''Koodit Tutkinnon koulutustyyppi''
,d26.maakunta_koodi AS ''Koodit Seur. vuoden koul. maakunta''
,d27.koulutuksen_jarjestajakoodi AS ''Koodit Seur. vuoden koul. järjestäjä''
,d28.oppilaitoskoodi AS ''Koodit Seur. vuoden oppilaitos''
,d29.koulutus_koodi AS ''Koodit Seur. vuoden koulutusnimike''
,d29.koulutusala2002_koodi AS ''Koodit Seur. vuoden koulutusala (02 luokitus)''
,d29.opintoala1995_koodi AS ''Koodit Seur. vuoden koulutusala (95 luokitus)''
,d29.opintoala2002_koodi AS ''Koodit Seur. vuoden opintoala''
,d29.koulutusaste2002_koodi AS ''Koodit Seur. vuoden koulutusaste''
,d30.koulutustyyppi_koodi AS ''Koodit Seur. vuoden koulutustyyppi''

FROM dbo.f_keskeyttaneet
	JOIN d_aineisto d1 ON d1.id = aineisto_id
	JOIN d_lahde d2 ON d2.id = lahde_id
	JOIN d_sukupuoli d3 ON d3.id = sukupuoli_id
	JOIN d_aidinkieli_versio1 d4 ON d4.id = aidinkieli_versio1x_id
	JOIN d_ika d5 ON d5.id = ika_1v_id
	JOIN d_ika d6 ON d6.id = ika_5v_id
	JOIN d_alueluokitus d7 ON d7.id= kotikunta_id
	JOIN d_kansalaisuus_versio1 d8 ON d8.id= kansalaisuus_versio1_id
	JOIN d_valtio d9 ON d9.id= eumaa_id
	JOIN d_valtio d10 ON d10.id= etamaa_id
	JOIN d_pohjoismaa d11 ON d11.id= pohjoismaa_id
	JOIN d_kausi d12 ON d12.kausi_id= kirjoihintulovuosi_id
	JOIN d_opiskelijan_olo d14 ON d14.id= opiskelijan_olo_lk_id
	JOIN d_oppilaitoksen_taustatiedot d15 ON d15.id= oppilaitoksen_taustatiedot_id
	JOIN d_koulutusluokitus d16 ON d16.id= koulutusluokitus_id
	JOIN d_koulutuksen_kieli_versio1 d17 ON d17.id= koulutuksen_kieli_versio1_id
	JOIN d_alueluokitus d18 ON d18.id= koulutuksen_kunta_id
	JOIN d_opetushallinnon_koulutus d19 ON d19.id= opetushallinnon_koulutus_id
	JOIN d_koulutustyyppi d20 ON d20.id= koulutustyyppi_id
	JOIN d_alueluokitus d21 ON d21.id= tutkinnon_suorittamismaakunta_id
	JOIN d_oppilaitoksen_taustatiedot d22 ON d22.id= tutkinnon_jarjestaja_id
	JOIN d_oppilaitoksen_taustatiedot d23 ON d23.id= tutkinnon_suorittamisoppilaitos_id
	JOIN d_koulutusluokitus d24 ON d24.id= tutkinnon_koulutusluokitus_id
	JOIN d_koulutustyyppi d25 ON d25.id= tutkinnon_koulutustyyppi_id
	JOIN d_alueluokitus d26 ON d26.id= seuraavan_vuoden_maakunta_id
	JOIN d_oppilaitoksen_taustatiedot d27 ON d27.id= seuraavan_vuoden_jarjestaja_id
	JOIN d_oppilaitoksen_taustatiedot d28 ON d28.id= seuraavan_vuoden_oppilaitos_id
	JOIN d_koulutusluokitus d29 ON d29.id= seuraavan_vuoden_koulutusluokitus_id
	JOIN d_koulutustyyppi d30 ON d30.id= seuraavan_vuoden_koulutustyyppi_id
	JOIN d_paaasiallinen_toiminta_versio2 d31 ON d31.id = paaasiallinen_toiminta_versio2_id
	JOIN d_ammattiasema d32 ON d32.id = ammattiasema_id
	--JOIN d_opintojen_kulku_koulutusasteen_2002_mukaan  d33 ON d33.id = [1a_opiskelijoiden_opintojen_kulku_koulutusaste_2002_mukaan_id]
	--JOIN d_opintojen_kulku_koulutusasteen_2002_mukaan  d34 ON d34.id = [1b_opiskelijoiden_opintojen_kulku_koulutusaste_2002_mukaan_id]
	--JOIN d_tutkinto_alkuperaisella_koulutusasteella_2002  d35 ON d35.id = [1c_tutkinto_alkuperaisella_koulutusasteella_2002_id]
	--JOIN d_tutkinto_muulla_koulutusasteella_2002  d36 ON d36.id = [1d_tutkinto_muulla_koulutusasteella_2002_id]
	--JOIN d_jatkaa_opiskelua_alkuperaisella_koulutusasteella_2002 d37 ON d37.id = [1e_jatkaa_opiskelua_alkuperaisella_koulutusasteella_2002_id]
	--JOIN d_jatkaa_opiskelua_muulla_koulutusasteella_2002 d38 ON d38.id = [1f_jatkaa_opiskelua_muulla_koulutusasteella_2002_id]
	--JOIN d_opintojen_kulku_koulutusalan_2002_mukaan d39 ON d39.id = [2a_opiskelijoiden_opintojen_kulku_koulutusala_2002_mukaan_id]
	--JOIN d_opintojen_kulku_koulutusalan_2002_mukaan d40 ON d40.id = [2b_opiskelijoiden_opintojen_kulku_koulutusala_2002_mukaan_id]
	--JOIN d_tutkinto_alkuperaisella_koulutusalalla_2002  d41 ON d41.id = [2c_tutkinto_alkuperaisella_koulutusalalla_2002_id]
	--JOIN d_tutkinto_muulla_koulutusalalla_2002  d42 ON d42.id = [2d_tutkinto_muulla_koulutusalalla_2002_id]
	--JOIN d_jatkaa_opiskelua_alkuperaisella_koulutusalalla_2002  d43 ON d43.id = [2e_jatkaa_opiskelua_alkuperaisella_koulutusalalla_2002_id]
	--JOIN d_jatkaa_opiskelua_muulla_koulutusalalla_2002  d44 ON d44.id = [2f_jatkaa_opiskelua_muulla_koulutusalalla_2002_id]

	--JOIN d_opintojen_kulku_opintoalan_2002_mukaan d45 ON d45.id = [3a_opiskelijoiden_opintojen_kulku_opintoala_2002_mukaan_id]
	--JOIN d_opintojen_kulku_opintoalan_2002_mukaan d46 ON d46.id = [3b_opiskelijoiden_opintojen_kulku_opintoala_2002_mukaan_id]
	--JOIN d_tutkinto_alkuperaisella_opintoalalla_2002  d47 ON d47.id = [3c_tutkinto_alkuperaisella_opintoalalla_2002_id]
	--JOIN d_tutkinto_muulla_opintoalalla_2002  d48 ON d48.id = [3d_tutkinto_muulla_opintoalalla_2002_id]
	--JOIN d_jatkaa_opiskelua_alkuperaisella_opintoalalla_2002  d49 ON d49.id = [3e_jatkaa_opiskelua_alkuperaisella_opintoalalla_2002_id]
	--JOIN d_jatkaa_opiskelua_muulla_opintoalalla_2002  d50 ON d50.id = [3f_jatkaa_opiskelua_muulla_opintoalalla_2002_id]

	--JOIN d_opintojen_kulku_koulutuksen_jarjestajan_mukaan d51 ON d51.id = [4a_opiskelijoiden_opintojen_kulku_koul_jarjestajan_mukaan_id]
	--JOIN d_opintojen_kulku_koulutuksen_jarjestajan_mukaan d52 ON d52.id = [4b_opiskelijoiden_opintojen_kulku_koul_jarjestajan_mukaan_id]
	--JOIN d_tutkinto_alkuperaisella_koulutuksen_jarjestajalla  d53 ON d53.id = [4c_tutkinto_alkuperaisella_koulutuksen_jarjestajalla_id]
	--JOIN d_tutkinto_muulla_koulutuksen_jarjestajalla  d54 ON d54.id = [4d_tutkinto_muulla_koulutuksen_jarjestajalla_id]
	--JOIN d_jatkaa_opiskelua_alkuperaisella_koulutuksen_jarjestajalla  d55 ON d55.id = [4e_jatkaa_opiskelua_alkuperaisella_koulutuksen_jarjestajalla_id]
	--JOIN d_jatkaa_opiskelua_muulla_koulutuksen_jarjestajalla  d56 ON d56.id = [4f_jatkaa_opiskelua_muulla_koulutuksen_jarjestajalla_id]


	--JOIN d_opintojen_kulku_oppilaitoksen_mukaan d57 ON d57.id = [5a_opiskelijoiden_opintojen_kulku_oppilaitoksen_mukaan_id]
	--JOIN d_opintojen_kulku_oppilaitoksen_mukaan d58 ON d58.id = [5b_opiskelijoiden_opintojen_kulku_oppilaitoksen_mukaan_id]
	--JOIN d_tutkinto_alkuperaisessa_oppilaitoksessa  d59 ON d59.id = [5c_tutkinto_alkuperaisessa_oppilaitoksessa_id]
	--JOIN d_tutkinto_muussa_oppilaitoksessa  d60 ON d60.id = [5d_tutkinto_muussa_oppilaitoksessa_id]
	--JOIN d_jatkaa_opiskelua_alkuperaisessa_oppilaitoksessa  d61 ON d61.id = [5e_jatkaa_opiskelua_alkuperaisessa_oppilaitoksessa_id]
	--JOIN d_jatkaa_opiskelua_muussa_oppilaitoksessa d62 ON d62.id = [5f_jatkaa_opiskelua_muussa_oppilaitoksessa_id]

	--JOIN d_opintojen_kulku_maakunnan_mukaan d63 ON d63.id = [6a_opiskelijoiden_opintojen_kulku_maakunnan_mukaan_id]
	--JOIN d_opintojen_kulku_maakunnan_mukaan d64 ON d64.id = [6b_opiskelijoiden_opintojen_kulku_maakunnan_mukaan_id]
	--JOIN d_tutkinto_alkuperaisessa_maakunnassa  d65 ON d65.id = [6c_tutkinto_alkuperaisessa_maakunnassa_id]
	--JOIN d_tutkinto_muussa_maakunnassa  d66 ON d66.id = [6d_tutkinto_muussa_maakunnassa_id]
	--JOIN d_jatkaa_opiskelua_alkuperaisessa_maakunnassa  d67 ON d67.id = [6e_jatkaa_opiskelua_alkuperaisessa_maakunnassa_id]
	--JOIN d_jatkaa_opiskelua_muussa_maakunnassa d68 ON d68.id = [6f_jatkaa_opiskelua_muussa_maakunnassa_id]

	--JOIN d_opintojen_kulku_koulutussektorin_mukaan d69 ON d69.id = [7a_opiskelijoiden_opintojen_kulku_koulutussektorin_mukaan_id]
	--JOIN d_opintojen_kulku_koulutussektorin_mukaan d70 ON d70.id = [7b_opiskelijoiden_opintojen_kulku_koulutussektorin_mukaan_id]
	--JOIN d_tutkinto_alkuperaisella_koulutussektorilla d71 ON d71.id = [7c_tutkinto_alkuperaisella_koulutussektorilla_id]
	--JOIN d_tutkinto_muulla_koulutussektorilla d72 ON d72.id = [7d_tutkinto_muulla_koulutussektorilla_id]
	--JOIN d_jatkaa_opiskelua_alkuperaisella_koulutussektorilla d73 ON d73.id = [7e_jatkaa_opiskelua_alkuperaisella_koulutussektorilla_id]
	--JOIN d_jatkaa_opiskelua_muulla_koulutussektorilla d74 ON d74.id = [7f_jatkaa_opiskelua_muulla_koulutussektorilla_id]

	JOIN d_opintojen_kulku_koulutusalan_2002_mukaan_versio2 d75 ON d75.id = [2bb_opiskelijoiden_opintojen_kulku_koulutusala_2002_mukaan_id]
	--JOIN d_opintojen_kulku_opintoalan_2002_mukaan_versio2 d76 ON d76.id = [3bb_opiskelijoiden_opintojen_kulku_opintoala_2002_mukaan_id]
	--JOIN d_opintojen_kulku_koulutuksen_jarjestajan_mukaan_versio2 d77 ON d77.id = [4bb_opiskelijoiden_opintojen_kulku_koul_jarjestajan_mukaan_id]
	JOIN d_opintojen_kulku_oppilaitoksen_mukaan_versio2 d78 ON d78.id = [5bb_opiskelijoiden_opintojen_kulku_oppilaitoksen_mukaan_id]


where d16.koulutusaste2002_koodi in (''63'',''72'',''73'',''81'',''82'') and ((tilastovuosi = ''2015'' And d1.aineisto_koodi = ''E'') Or (d1.aineisto_koodi = ''L''))













' 
GO
/****** Object:  View [dbo].[v_f_tab_korkeakoulujen_tutkimus_kehitys]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_korkeakoulujen_tutkimus_kehitys]'))
EXEC dbo.sp_executesql @statement = N'




CREATE VIEW [dbo].[v_f_tab_korkeakoulujen_tutkimus_kehitys] AS

--Select * from [VipunenTK].[dbo].[v_f_tab_korkeakoulujen_tutkimus_kehitys] 

SELECT 
--Aikamuuttyjat
		  ''Tilastovuosi'' = [tilastovuosi]
--Henkilömuuttujat
		  ,''Ikäryhmä'' = d_ika.ika5v
          ,''Sukupuoli'' = d_sukupuoli.sukupuoli
          ,''Tutkintotaso'' = d_tutkintotaso.tutkintotaso
          ,''Virkaryhmä'' = d_virkaryhma.virkaryhma
--Organisaatiomuuttujat
          ,''Yliopisto'' = d_oppilaitoksen_taustatiedot.oppilaitos
--Tieteenalamuuttujat
          ,''Päätieteenala (2007 luokitus)'' = d_tieteenala.paatieteenala2007
          ,''Päätieteenala (2010 luokitus)'' = d_tieteenala.paatieteenala2010
          ,''Tieteenala (2007 luokitus)'' = d_tieteenala.tieteenala2007
          ,''Tieteenala (2010 luokitus)'' = d_tieteenala.tieteenala2010
--Rahoitusmuuttujat
          ,''Rahoituslähde'' = d_tutkimuksen_rahoituslahde.rahoituslahde
          ,''Rahoituksen laatu'' = d_tutkimuksen_rahoituslahde.rahoituksen_laatu
          ,''Rahoituslähteen tyyppi'' = d_tutkimuksen_rahoituslahde.rahoituslahteen_tyyppi
          ,''Ulkop. rahoituksen kansainvälisyys'' = d_tutkimuksen_rahoituslahde.ulkopuolisen_rahoituksen_kansainvalisyys
          ,''Rahoituslähdetarkennus'' = d_tutkimuksen_rahoituslahde.rahoituslahdetarkennus
          ,''Tutkimusmenojen kohde'' = d_tutkimusmenojen_kohde.menokohde
          ,''Tutkimusmenotyyppi'' = d_tutkimusmenojen_kohde.menotyyppi
--Järjestykset
          ,d_ika.jarjestys_ika5v
          ,jarjestys_yliopisto = d_oppilaitoksen_taustatiedot.jarjestys_oppilaitos
          ,jarjestys_sukupuoli = d_sukupuoli.jarjestys
          ,d_tieteenala.jarjestys_paatieteenala2007
          ,d_tieteenala.jarjestys_paatieteenala2010
          ,d_tieteenala.jarjestys_tieteenala2007
          ,d_tieteenala.jarjestys_tieteenala2010
          ,jarjestys_tutkintotaso = d_tutkintotaso.jarjestys
          ,jarjestys_virkaryhma = d_virkaryhma.jarjestys
          ,d_tutkimuksen_rahoituslahde.jarjestys_rahoituslahde
          ,d_tutkimuksen_rahoituslahde.jarjestys_rahoituksen_laatu
          ,d_tutkimuksen_rahoituslahde.jarjestys_rahoituslahteen_tyyppi
          ,d_tutkimuksen_rahoituslahde.jarjestys_ulkopuolisen_rahoituksen_kansainvalisyys
          ,d_tutkimuksen_rahoituslahde.jarjestys_rahoituslahdetarkennus
          ,d_tutkimusmenojen_kohde.jarjestys_menokohde
          ,d_tutkimusmenojen_kohde.jarjestys_menotyyppi
--Muuttujat
      ,''Tutkimushenkilökunnan lkm'' = lkm_tutkimushenkilokunta
      ,''Tutkimustyövuosien määrä'' = lkm_tutkimustyovuodet
      ,''Tutkimusrahoitus (1000 euroa)'' = [tutkimusrahoitus]
      ,''Tutkimusmenot (1000 euroa)'' = [tutkimusmenot]

--RUOTSI
--Aikamuuttyjat
		  ,''Statistikår'' = [tilastovuosi]
--Henkilömuuttujat
		  ,''Åldersgrupp'' = d_ika.ika5v_SV
          ,''Kön'' = d_sukupuoli.sukupuoli_SV
          ,''Examensnivå'' = d_tutkintotaso.tutkintotaso_SV
          ,''Tjänstegrupp'' = d_virkaryhma.virkaryhma_SV
--Organisaatiomuuttujat
          ,''Universitet'' = d_oppilaitoksen_taustatiedot.oppilaitos_SV
--Tieteenalamuuttujat
          ,''Huvudvetenskapsgren (2007)'' = d_tieteenala.paatieteenala2007_SV
          ,''Huvudvetenskapsgren (2010)'' = d_tieteenala.paatieteenala2010_SV
          ,''Vetenskapsgren (2007)'' = d_tieteenala.tieteenala2007_SV
          ,''Vetenskapsgren (2010)'' = d_tieteenala.tieteenala2010_SV
--Rahoitusmuuttujat
          ,''Finansieringskälla'' = d_tutkimuksen_rahoituslahde.rahoituslahde_SV
          ,''Finansieringstyp'' = d_tutkimuksen_rahoituslahde.rahoituksen_laatu_SV
          ,''Finansieringskällans typ'' = d_tutkimuksen_rahoituslahde.rahoituslahteen_tyyppi_SV
          ,''Externa finansieringens internat.'' = d_tutkimuksen_rahoituslahde.ulkopuolisen_rahoituksen_kansainvalisyys_SV
          ,''Spec. av finansieringskällan'' = d_tutkimuksen_rahoituslahde.rahoituslahdetarkennus_SV
          ,''Forskningsutgifternas mål'' = d_tutkimusmenojen_kohde.menokohde_SV
          ,''Typ av forskningsutgifter'' = d_tutkimusmenojen_kohde.menotyyppi_SV

--ENGLANTI
--Aikamuuttyjat
		  ,''Statistical year'' = [tilastovuosi]
--Henkilömuuttujat
		  ,''Age group'' = d_ika.ika5v_EN
          ,''Gender'' = d_sukupuoli.sukupuoli_EN
          ,''Level of degree'' = d_tutkintotaso.tutkintotaso_EN
          ,''Position'' = d_virkaryhma.virkaryhma_EN
--Organisaatiomuuttujat
          ,''University'' = d_oppilaitoksen_taustatiedot.oppilaitos_EN
--Tieteenalamuuttujat
          ,''Main discipline (2007)'' = d_tieteenala.paatieteenala2007_EN
          ,''Main discipline (2010)'' = d_tieteenala.paatieteenala2010_EN
          ,''Discipline (2007)'' = d_tieteenala.tieteenala2007_EN
          ,''Discipline (2010)'' = d_tieteenala.tieteenala2010_EN
--Rahoitus- ja menomuuttujat
          ,''Source of funding I'' = d_tutkimuksen_rahoituslahde.rahoituslahde_EN
          ,''Type of funding II'' = d_tutkimuksen_rahoituslahde.rahoituksen_laatu_EN
          ,''Type of funding I'' = d_tutkimuksen_rahoituslahde.rahoituslahteen_tyyppi_EN
          ,''External funding (internat.)'' = d_tutkimuksen_rahoituslahde.ulkopuolisen_rahoituksen_kansainvalisyys_EN
          ,''Source of funding II'' = d_tutkimuksen_rahoituslahde.rahoituslahdetarkennus_EN
          ,''Target of budget funds'' = d_tutkimusmenojen_kohde.menokohde_EN
          ,''Type of budget funds'' = d_tutkimusmenojen_kohde.menotyyppi_EN

/*
SELECT [tilastovuosi]
      ,d_ika.ika5v
	  ,d_ika.jarjestys_ika5v
	  ,d_oppilaitoksen_taustatiedot.oppilaitos
	  ,d_oppilaitoksen_taustatiedot.jarjestys_oppilaitos
	  ,d_sukupuoli.sukupuoli
	  ,jarjestys_sukupuoli = d_sukupuoli.jarjestys
	  ,d_tieteenala.paatieteenala
	  ,d_tieteenala.tieteenala
	  ,d_tieteenala.jarjestys_paatieteenala
	  ,d_tieteenala.jarjestys_tieteenala
	  ,d_tutkintotaso.tutkintotaso
	  ,jarjestys_tutkintotaso = d_tutkintotaso.jarjestys
	  ,d_virkaryhma.virkaryhma
	  ,jarjestys_virkaryhma = d_virkaryhma.jarjestys
	  ,d_tutkimuksen_rahoituslahde.rahoituslahde
	  ,d_tutkimuksen_rahoituslahde.rahoituksen_laatu
	  ,d_tutkimuksen_rahoituslahde.rahoituslahteen_tyyppi
	  ,d_tutkimuksen_rahoituslahde.ulkopuolisen_rahoituksen_kansainvalisyys
	  ,d_tutkimuksen_rahoituslahde.rahoituslahdetarkennus
	  ,d_tutkimuksen_rahoituslahde.jarjestys_rahoituslahde
	  ,d_tutkimuksen_rahoituslahde.jarjestys_rahoituksen_laatu
	  ,d_tutkimuksen_rahoituslahde.jarjestys_rahoituslahteen_tyyppi
	  ,d_tutkimuksen_rahoituslahde.jarjestys_ulkopuolisen_rahoituksen_kansainvalisyys
	  ,d_tutkimuksen_rahoituslahde.jarjestys_rahoituslahdetarkennus
	  ,d_tutkimusmenojen_kohde.menokohde
	  ,d_tutkimusmenojen_kohde.menotyyppi
	  ,d_tutkimusmenojen_kohde.jarjestys_menokohde
	  ,d_tutkimusmenojen_kohde.jarjestys_menotyyppi
      ,''tutkimushenkilökunnan lkm'' = lkm_tutkimushenkilokunta
      ,''tutkimustyövuosien määrä'' = lkm_tutkimustyovuodet
      ,[tutkimusrahoitus]
      ,[tutkimusmenot]
	  */
FROM (
SELECT [tilastovuosi]
      ,ika_id
	  ,oppilaitos_id
	  ,sukupuoli_id
	  ,tieteenala_id
	  ,tutkintotaso_id
	  ,virkaryhma_id
	  ,rahoituslahde_id = -1
	  ,menokohde_id = -1
      ,lkm_tutkimushenkilokunta
      ,lkm_tutkimustyovuodet
      ,tutkimusrahoitus = NULL
      ,tutkimusmenot = NULL
  FROM [dbo].[f_korkeakoulujen_tutkimus_kehitys_5_1_henkilot_5_2_tyovuodet]

UNION ALL
SELECT [tilastovuosi]
      ,ika_id = -1
	  ,oppilaitos_id
	  ,sukupuoli_id = -1
	  ,tieteenala_id
	  ,tutkintotaso_id = -1
	  ,virkaryhma_id = -1
	  ,rahoituslahde_id
	  ,menokohde_id = -1
      ,lkm_tutkimushenkilokunta = NULL
      ,lkm_tutkimustyovuodet = NULL
      ,tutkimusrahoitus
      ,tutkimusmenot = NULL
  FROM VipunenTK.[dbo].[f_korkeakoulujen_tutkimus_kehitys_5_3_rahoitus]

UNION ALL
SELECT [tilastovuosi]
      ,ika_id = -1
	  ,oppilaitos_id
	  ,sukupuoli_id = -1
	  ,tieteenala_id
	  ,tutkintotaso_id = -1
	  ,virkaryhma_id = -1
	  ,rahoituslahde_id = -1
	  ,menokohde_id
      ,lkm_tutkimushenkilokunta = NULL
      ,lkm_tutkimustyovuodet = NULL
      ,tutkimusrahoitus = NULL
      ,tutkimusmenot
  FROM VipunenTK.[dbo].[f_korkeakoulujen_tutkimus_kehitys_5_3_menot]

  ) f
  INNER JOIN VipunenTK.[dbo].[d_ika]
	ON d_ika.id = f.ika_id
  INNER JOIN VipunenTK.[dbo].d_oppilaitoksen_taustatiedot
	ON d_oppilaitoksen_taustatiedot.id = f.oppilaitos_id
  INNER JOIN VipunenTK.[dbo].d_sukupuoli
	ON d_sukupuoli.id = f.sukupuoli_id
  INNER JOIN VipunenTK.[dbo].d_tieteenala
	ON d_tieteenala.id = f.tieteenala_id
  INNER JOIN VipunenTK.[dbo].d_tutkintotaso
	ON d_tutkintotaso.id = f.tutkintotaso_id
  INNER JOIN VipunenTK.[dbo].d_virkaryhma
	ON d_virkaryhma.id = f.virkaryhma_id
  INNER JOIN VipunenTK.[dbo].d_tutkimuksen_rahoituslahde
	ON d_tutkimuksen_rahoituslahde.id = f.rahoituslahde_id
  INNER JOIN VipunenTK.[dbo].d_tutkimusmenojen_kohde
	ON d_tutkimusmenojen_kohde.id = f.menokohde_id







' 
GO
/****** Object:  View [dbo].[v_f_tab_korkeakouluopiskelijoiden_aikaisempi_koulutus_amk]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_korkeakouluopiskelijoiden_aikaisempi_koulutus_amk]'))
EXEC dbo.sp_executesql @statement = N'










CREATE VIEW [dbo].[v_f_tab_korkeakouluopiskelijoiden_aikaisempi_koulutus_amk] AS

Select [Opisk2] = opiskelijat,
[Aloitt2] = coalesce(aloittaneet,0)
,[Ylempi_korkeakoulututkinto] = ylempi_korkeakoulututkinto
,[Ylempi_amk_tutkinto] = ylempi_amk_tutkinto
,[Alempi_korkeakoulututkinto] = alempi_korkeakoulututkinto
,[Amk_tutkinto] = amk_tutkinto
,[Ammatillinen_perustutkinto] = ammatillinen_perustutkinto
,[Ylioppilastutkinto] = ylioppilastutkinto
,[Ei_perusasteen_jalkeista_koulutusta] = ei_perusasteen_jalkeista_koulutusta
,[Tilastovuosi] AS Tilastovuosi
,d2.aidinkieli_versio1 AS Äidinkieli
,d3.avi AS "Asuinalueen AVI"
,d3.ely AS "Asuinalueen ELY"
,d3.kielisuhde AS "Asuinkunnan kielisuhde"
,d3.maakunta AS Asuinmaakunta
,d3.kunta AS Asuinkunta
,d4.sukupuoli AS Sukupuoli
,d5.ika AS Ikä
,d5.ika5v AS Ikäryhmä
,d5b.ika AS "Ikä 15-65"
,d5b.ika5v AS "Ikäryhmä 15-65"
,d5c.ika AS "Ikä 18-65"
,d5c.ika5v AS "Ikäryhmä 18-65"
,d6.ika5v AS Ikäryhmä2
,d7.koulutustyyppi AS Koulutustyyppi
,d8.kansalaisuus_versio2 AS Kansalaisuus
,d9.oppilaitos AS Oppilaitos
,d9.oppilaitos AS Yliopisto
,d9.oppilaitos AS Ammattikorkeakoulu
,d9.opetuskieli AS Opetuskieli
,d9.oppilaitoksen_omistajatyyppi AS "Oppilaitoksen omistajatyyppi"
,d9.oppilaitostyyppi AS Oppilaitostyyppi
,d10.lahde AS Lähde
,d12.opiskelijan_olo AS "Kirjoillaolo (syysk.)"
,d12b.opiskelijan_olo_tamm AS "Kirjoillaolo (tammik.)"
,d13.rahoituslahde AS Rahoituslähde
,d14a.oppilaitos AS "Pohjakoul. oppilaitos (lukio)"
,d14a.opetuskieli AS "Pohjakoul. oppil. opetuskieli (lukio)"
,d14a.oppilaitoksen_omistajatyyppi AS "Pohjakoul. oppil. omistajatyyppi (lukio)"
,d14a.oppilaitostyyppi AS "Pohjakoul. oppil.tyyppi (lukio)"
,d14b.oppilaitos AS "Pohjakoul. oppilaitos (amm)"
,d14b.opetuskieli AS "Pohjakoul. oppil. opetuskieli (amm)"
,d14b.oppilaitoksen_omistajatyyppi AS "Pohjakoul. oppil. omistajatyyppi (amm)"
,d14b.oppilaitostyyppi AS "Pohjakoul. oppil.tyyppi (amm)"
,d14c.oppilaitos AS "Pohjakoul. oppilaitos (amk)"
,d14c.opetuskieli AS "Pohjakoul. oppil. opetuskieli (amk)"
,d14c.oppilaitoksen_omistajatyyppi AS "Pohjakoul. oppil. omistajatyyppi (amk)"
,d14c.oppilaitostyyppi AS "Pohjakoul. oppil.tyyppi (amk)"
,d14d.oppilaitos AS "Pohjakoul. oppilaitos (ylempi amk)"
,d14d.opetuskieli AS "Pohjakoul. oppil. opetuskieli (ylempi amk)"
,d14d.oppilaitoksen_omistajatyyppi AS "Pohjakoul. oppil. omistajatyyppi (ylempi amk)"
,d14d.oppilaitostyyppi AS "Pohjakoul. oppil.tyyppi (ylempi amk)"
,d14e.oppilaitos AS "Pohjakoul. oppilaitos (alempi kk)"
,d14e.opetuskieli AS "Pohjakoul. oppil. opetuskieli (alempi kk)"
,d14e.oppilaitoksen_omistajatyyppi AS "Pohjakoul. oppil. omistajatyyppi (alempi kk)"
,d14e.oppilaitostyyppi AS "Pohjakoul. oppil.tyyppi (alempi kk)"
,d14f.oppilaitos AS "Pohjakoul. oppilaitos (ylempi kk)"
,d14f.opetuskieli AS "Pohjakoul. oppil. opetuskieli (ylempi kk)"
,d14f.oppilaitoksen_omistajatyyppi AS "Pohjakoul. oppil. omistajatyyppi (ylempi kk)"
,d14f.oppilaitostyyppi AS "Pohjakoul. oppil.tyyppi (ylempi kk)"
,d15a.opintoala1995 AS "Pohjakoul. koul.ala (95 luokitus) (lukio)"
,d15a.opintoala2002 AS "Pohjakoul. opintoala (lukio)"
,d15a.koulutusala2002 AS "Pohjakoul. koul.ala (02 luokitus) (lukio)"
,d15a.koulutus AS "Pohjakoul. koul.nimike (lukio)"
,d15a.koulutusaste2002 as "Pohjakoul. koul.aste (lukio)"
,d15b.opintoala1995 AS "Pohjakoul. koul.ala (95 luokitus) (amm)"
,d15b.opintoala2002 AS "Pohjakoul. opintoala (amm)"
,d15b.koulutusala2002 AS "Pohjakoul. koul.ala (02 luokitus) (amm)"
,d15b.koulutus AS "Pohjakoul. koul.nimike (amm)"
,d15b.koulutusaste2002 as "Pohjakoul. koul.aste (amm)"
,d15c.opintoala1995 AS "Pohjakoul. koul.ala (95 luokitus) (amk)"
,d15c.opintoala2002 AS "Pohjakoul. opintoala (amk)"
,d15c.koulutusala2002 AS "Pohjakoul. koul.ala (02 luokitus) (amk)"
,d15c.koulutus AS "Pohjakoul. koul.nimike (amk)"
,d15c.koulutusaste2002 as "Pohjakoul. koul.aste (amk)"
,d15d.opintoala1995 AS "Pohjakoul. koul.ala (95 luokitus) (ylempi amk)"
,d15d.opintoala2002 AS "Pohjakoul. opintoala (ylempi amk)"
,d15d.koulutusala2002 AS "Pohjakoul. koul.ala (02 luokitus) (ylempi amk)"
,d15d.koulutus AS "Pohjakoul. koul.nimike (ylempi amk)"
,d15d.koulutusaste2002 as "Pohjakoul. koul.aste (ylempi amk)"
,d15e.opintoala1995 AS "Pohjakoul. koul.ala (95 luokitus) (alempi kk)"
,d15e.opintoala2002 AS "Pohjakoul. opintoala (alempi kk)"
,d15e.koulutusala2002 AS "Pohjakoul. koul.ala (02 luokitus) (alempi kk)"
,d15e.koulutus AS "Pohjakoul. koul.nimike (alempi kk)"
,d15e.koulutusaste2002 as "Pohjakoul. koul.aste (alempi kk)"
,d15f.opintoala1995 AS "Pohjakoul. koul.ala (95 luokitus) (ylempi kk)"
,d15f.opintoala2002 AS "Pohjakoul. opintoala (ylempi kk)"
,d15f.koulutusala2002 AS "Pohjakoul. koul.ala (02 luokitus) (ylempi kk)"
,d15f.koulutus AS "Pohjakoul. koul.nimike (ylempi kk)"
,d15f.koulutusaste2002 as "Pohjakoul. koul.aste (ylempi kk)"
,d15g.opintoala1995 AS "Pohjakoul. koul.ala (95 luokitus)"
,d15g.opintoala2002 AS "Pohjakoul. opintoala"
,d15g.koulutusala2002 AS "Pohjakoul. koul.ala (02 luokitus)"
,d15g.koulutus AS "Pohjakoul. koul.nimike"
,d15g.koulutusaste2002 as "Pohjakoul. koul.aste"
,d15h.opintoala2002 as "Pohjakoul. opintoala2"
,d15i.opintoala1995 as "Pohjakoul. koul.ala (95 luokitus)2"
,d16a.vuosiselite AS "Pohjakoul. suoritusvuosi (lukio)"
,d16b.vuosiselite AS "Pohjakoul. suoritusvuosi (amm)"
,d16c.vuosiselite AS "Pohjakoul. suoritusvuosi (amk)"
,d16d.vuosiselite AS "Pohjakoul. suoritusvuosi (ylempi amk)"
,d16e.vuosiselite AS "Pohjakoul. suoritusvuosi (alempi kk)"
,d16f.vuosiselite AS "Pohjakoul. suoritusvuosi (ylempi kk)"
,d17a.koulutuksesta_kulunut_aika AS "Pohjakoulutuksesta kulunut aika (lukio)"
,d17b.koulutuksesta_kulunut_aika AS "Pohjakoulutuksesta kulunut aika (amm)"
,d17c.koulutuksesta_kulunut_aika AS "Pohjakoulutuksesta kulunut aika (amk)"
,d17d.koulutuksesta_kulunut_aika AS "Pohjakoulutuksesta kulunut aika (ylempi amk)"
,d17e.koulutuksesta_kulunut_aika AS "Pohjakoulutuksesta kulunut aika (alempi kk)"
,d17f.koulutuksesta_kulunut_aika AS "Pohjakoulutuksesta kulunut aika (ylempi kk)"
,d21.koulutusaste2002 as Koulutusaste
,d21.koulutusala2002 as "Koulutusala (02 luokitus)"
,d21.opintoala1995 as "Koulutusala (95 luokitus)"
,d21.opintoala2002 as Opintoala
,d21.koulutus as Koulutusnimike
,d22.avi as "Koulutuksen AVI"
,d22.ely as "Koulutuksen ELY"
,d22.maakunta as "Koulutuksen maakunta"
,d22.kielisuhde as "Koulutuksen kunnan kielisuhde"
,d22.kunta as "Koulutuksen kunta"
,d23.vuosiselite as "Kirjoihintulovuosi"
,d24.lukukausiselite as "Kirjoihintulolukukausi"
,d24b.vuosiselite as "Kirjoihintulovuosi (kk-sektori)"
,d24c.vuosiselite as "Kirjoihintulovuosi (kk-sektori läsna)"
,d24d.vuosiselite as "Kirjoihintulovuosi (sektori)"
,d24e.vuosiselite as "Kirjoihintulovuosi (sektori läsnä)"
,d24f.vuosiselite as "Kirjoihintulovuosi (korkeakoulu)"
,d24g.vuosiselite as "Kirjoihintulovuosi (korkeakoulu läsnä)"
,d24h.vuosiselite as "Kirjoihintulovuosi (opintoala)"
,d24i.vuosiselite as "Kirjoihintulovuosi (opintoala läsnä)"
,d25.aikaisempi_korkein_tutkinto as "Aikaisempi korkein tutkinto"
,d26.avoinvayla as "Avoin väylä"
,d27.vahintaan_45_op_suorittanut as "Suorittanut väh. 45 op"
,d28.vahintaan_55_op_suorittanut as "Suorittanut väh. 55 op"
,d29.opiskelijan_fte_tieto as "Opiskelijan FTE-tieto"
,d30.opiskelumuoto as Opiskelumuoto
,d31.pohjakoulutuksen_tila as "Pohjakoulutuksen tila"
,[aikaisemmin_suoritettu_yotutk] as jarj_aik_yo
,[aikaisemmin_suoritettu_yotutk_tarkempi] as "Aikaisempi lukiokoulutus"
,[yotutk_pohjakoulutuksen_tila] as "Aik. lukiokoul. tila"
,[aikaisemmin_suoritettu_ammtutk] as jarj_aik_amm
,[aikaisemmin_suoritettu_ammtutk_tarkempi] as "Aikaisempi amm. koulutus"
,[ammtutk_pohjakoulutuksen_tila] as "Aik. amm. koulutuksen tila"
,[aikaisemmin_suoritettu_amktutk] as jarj_aik_amk
,[aikaisemmin_suoritettu_amktutk_tarkempi] as "Aikaisempi amk-tutkinto"
,[amktutk_pohjakoulutuksen_tila] as "Aik. amk-tutkinnon tila"
,[aikaisemmin_suoritettu_ylempiamktutk] as jarj_aik_ylempiamk
,[aikaisemmin_suoritettu_ylempiamktutk_tarkempi] as "Aikaisempi ylempi amk-tutkinto"
,[ylempiamktutk_pohjakoulutuksen_tila] as "Aik. ylemmän amk-tutkinnon tila"
,[aikaisemmin_suoritettu_alempikktutk] as jarj_aik_alempikk
,[aikaisemmin_suoritettu_alempikktutk_tarkempi] as "Aikaisempi alempi kk-tutkinto"
,[alempikktutk_pohjakoulutuksen_tila] as "Aik. alemman kk-tutkinnon tila"
,[aikaisemmin_suoritettu_ylempikktutk] as jarj_aik_ylempikk
,[aikaisemmin_suoritettu_ylempikktutk_tarkempi] as "Aikaisempi ylempi kk-tukinto"
,[ylempikktutk_pohjakoulutuksen_tila] as "Aik. ylemmän kk-tutkinnon tila"
,[aiemman_tutkinnon_yotutk_opintoala1995_sama] as "Pohjakoul. koul.ala (95) sama (lukio)"
,[aiemman_tutkinnon_yotutk_opintoala2002_sama] as "Pohjakoul. op.ala sama (lukio)"
,[aiemman_tutkinnon_yotutk_koulutusala2002_sama] as "Pohjakoul. koul.ala (02) sama (lukio)"
,[aiemman_tutkinnon_yotutk_koulutusaste2002_sama] as "Pohjakoul. koul.aste sama (lukio)"
,[aiemman_tutkinnon_ammtutk_opintoala1995_sama] as "Pohjakoul. koul.ala (95) sama (amm)"
,[aiemman_tutkinnon_ammtutk_opintoala2002_sama] as "Pohjakoul. op.ala sama (amm)"
,[aiemman_tutkinnon_ammtutk_koulutusala2002_sama] as "Amm. tutk. sama koul.ala (02)"
,[aiemman_tutkinnon_ammtutk_koulutusaste2002_sama] as "Pohjakoul. koul.aste sama (amm)"
,[aiemman_tutkinnon_amktutk_opintoala1995_sama] as "Pohjakoul. koul.ala (95) sama (amk)"
,[aiemman_tutkinnon_amktutk_opintoala2002_sama] as "Pohjakoul. op.ala sama (amk)"
,[aiemman_tutkinnon_amktutk_koulutusala2002_sama] as "Amk-tutkinto sama koul.ala (02)"
,[aiemman_tutkinnon_amktutk_koulutusaste2002_sama] as "Pohjakoul. koul.aste sama (amk)"
,[aiemman_tutkinnon_ylempiamktutk_opintoala1995_sama] as "Pohjakoul. koul.ala (95) sama (ylempi amk)"
,[aiemman_tutkinnon_ylempiamktutk_opintoala2002_sama] as "Pohjakoul. op.ala sama (ylempi amk)"
,[aiemman_tutkinnon_ylempiamktutk_koulutusala2002_sama] as "Ylempi amk tutk. sama koul.ala (02)"
,[aiemman_tutkinnon_ylempiamktutk_koulutusaste2002_sama] as "Pohjakoul. koul.aste sama (ylempi amk)"
,[aiemman_tutkinnon_alempikktutk_opintoala1995_sama] as "Pohjakoul. koul.ala (95) sama (alempi kk)"
,[aiemman_tutkinnon_alempikktutk_opintoala2002_sama] as "Pohjakoul. op.ala sama (alempi kk)"
,[aiemman_tutkinnon_alempikktutk_koulutusala2002_sama] as "Alempi kk-tutk. sama koul.ala (02)"
,[aiemman_tutkinnon_alempikktutk_koulutusaste2002_sama] as "Pohjakoul. koul.aste sama (alempi kk)"
,[aiemman_tutkinnon_ylempikktutk_opintoala1995_sama] as "Pohjakoul. koul.ala (95) sama (ylempi kk)"
,[aiemman_tutkinnon_ylempikktutk_opintoala2002_sama] as "Pohjakoul. op.ala sama (ylempi kk)"
,[aiemman_tutkinnon_ylempikktutk_koulutusala2002_sama] as "Ylempi kk-tutk. sama koul.ala (02)"
,[aiemman_tutkinnon_ylempikktutk_koulutusaste2002_sama] as "Pohjakoul. koul.aste sama (ylempi kk)"
,[aiemman_tutkinnon_opintoala1995_sama] as "Pohjakoul. koul.ala (95) sama"
,[aiemman_tutkinnon_opintoala2002_sama] as "Pohjakoul. op.ala sama"
,[aiemman_tutkinnon_koulutusala2002_sama] as "Pohjakoul. koul.ala (02) sama"
,[aiemman_tutkinnon_koulutusaste2002_sama] as "Pohjakoul. koul.aste sama"
,d2.jarjestys AS jarj_aidinkieli
,d3.jarjestys_avi AS jarj_as_avi
,d3.jarjestys_ely AS jarj_as_ely
,d3.jarjestys_kielisuhde AS jarj_as_kielisuhde
,d3.jarjestys_maakunta AS jarj_as_maakunta
,d3.jarjestys AS jarj_as_kunta
,d5.jarjestys_ika
,d5.jarjestys_ika5v AS jarj_ika5v
,d5b.jarjestys_ika AS jarj_1565_1v
,d5b.jarjestys_ika5v AS jarj_1565_5v
,d5c.jarjestys_ika AS jarj_1865_1v
,d5c.jarjestys_ika5v AS jarj_1865_5v
,d6.jarjestys_ika5v AS jarj_ikaryhma2
,d7.jarjestys AS jarj_koultyyppi
,d7.koulutustyyppi_koodi
,d8.jarjestys AS jarj_kansalaisuus
,d9.jarjestys_oppilaitos
,d9.jarjestys_opetuskieli
,d9.jarjestys_omistajatyyppi
,d9.jarjestys_oppilaitostyyppi
,d10.lahde_koodi
,d12.jarjestys AS jarj_kirjolosyys
,d12b.jarjestys AS jarj_kirjolotammi
,d13.jarjestys AS jarj_rahoitus
,d14a.jarjestys_oppilaitos AS jarj_pohj_14a_oppil
,d14a.jarjestys_oppilaitostyyppi AS jarj_pohj_14a_oppiltyp
,d14a.jarjestys_opetuskieli AS jarj_pohj_14a_opkiel
,d14a.jarjestys_omistajatyyppi AS jarj_pohj_14a_oppilomist
,d14b.jarjestys_oppilaitos AS jarj_pohj_14b_oppil
,d14b.jarjestys_oppilaitostyyppi AS jarj_pohj_14b_oppiltyp
,d14b.jarjestys_opetuskieli AS jarj_pohj_14b_opkiel
,d14b.jarjestys_omistajatyyppi AS jarj_pohj_14b_oppilomist
,d14c.jarjestys_oppilaitos AS jarj_pohj_14c_oppil
,d14c.jarjestys_oppilaitostyyppi AS jarj_pohj_14c_oppiltyp
,d14c.jarjestys_opetuskieli AS jarj_pohj_14c_opkiel
,d14c.jarjestys_omistajatyyppi AS jarj_pohj_14c_oppilomist
,d14d.jarjestys_oppilaitos AS jarj_pohj_14d_oppil
,d14d.jarjestys_oppilaitostyyppi AS jarj_pohj_14d_oppiltyp
,d14d.jarjestys_opetuskieli AS jarj_pohj_14d_opkiel
,d14d.jarjestys_omistajatyyppi AS jarj_pohj_14d_oppilomist
,d14e.jarjestys_oppilaitos AS jarj_pohj_14e_oppil
,d14e.jarjestys_oppilaitostyyppi AS jarj_pohj_14e_oppiltyp
,d14e.jarjestys_opetuskieli AS jarj_pohj_14e_opkiel
,d14e.jarjestys_omistajatyyppi AS jarj_pohj_14e_oppilomist
,d14f.jarjestys_oppilaitos AS jarj_pohj_14f_oppil
,d14f.jarjestys_oppilaitostyyppi AS jarj_pohj_14f_oppiltyp
,d14f.jarjestys_opetuskieli AS jarj_pohj_14f_opkiel
,d14f.jarjestys_omistajatyyppi AS jarj_pohj_14f_oppilomist
,d15a.jarjestys_opintoala1995 AS jarj_15a_koulala95
,d15a.jarjestys_opintoala2002 AS jarj_15a_opala
,d15a.jarjestys_koulutusala2002 AS jarj_15a_koulala02
,d15a.jarjestys AS jarj_15a_koulnimike
,d15a.jarjestys_koulutusaste2002 AS jarj_15a_koulaste
,d15b.jarjestys_opintoala1995 AS jarj_15b_koulala95
,d15b.jarjestys_opintoala2002 AS jarj_15b_opala
,d15b.jarjestys_koulutusala2002 AS jarj_15b_koulala02
,d15b.jarjestys AS jarj_15b_koulnimike
,d15b.jarjestys_koulutusaste2002 AS jarj_15b_koulaste
,d15c.jarjestys_opintoala1995 AS jarj_15c_koulala95
,d15c.jarjestys_opintoala2002 AS jarj_15c_opala
,d15c.jarjestys_koulutusala2002 AS jarj_15c_koulala02
,d15c.jarjestys AS jarj_15c_koulnimike
,d15c.jarjestys_koulutusaste2002 AS jarj_15c_koulaste
,d15d.jarjestys_opintoala1995 AS jarj_15d_koulala95
,d15d.jarjestys_opintoala2002 AS jarj_15d_opala
,d15d.jarjestys_koulutusala2002 AS jarj_15d_koulala02
,d15d.jarjestys AS jarj_15d_koulnimike
,d15d.jarjestys_koulutusaste2002 AS jarj_15d_koulaste
,d15e.jarjestys_opintoala1995 AS jarj_15e_koulala95
,d15e.jarjestys_opintoala2002 AS jarj_15e_opala
,d15e.jarjestys_koulutusala2002 AS jarj_15e_koulala02
,d15e.jarjestys AS jarj_15e_koulnimike
,d15e.jarjestys_koulutusaste2002 AS jarj_15e_koulaste
,d15f.jarjestys_opintoala1995 AS jarj_15f_koulala95
,d15f.jarjestys_opintoala2002 AS jarj_15f_opala
,d15f.jarjestys_koulutusala2002 AS jarj_15f_koulala02
,d15f.jarjestys AS jarj_15f_koulnimike
,d15f.jarjestys_koulutusaste2002 AS jarj_15f_koulaste
,d15g.jarjestys_opintoala1995 AS jarj_15g_koulala95
,d15g.jarjestys_opintoala2002 AS jarj_15g_opala
,d15g.jarjestys_koulutusala2002 AS jarj_15g_koulala02
,d15g.jarjestys AS jarj_15g_koulnimike
,d15g.jarjestys_koulutusaste2002 AS jarj_15g_koulaste
,d15h.jarjestys_opintoala2002 AS jarj_15h_opala
,d15i.jarjestys_opintoala1995 AS jarj_15i_koulala95
,d17a.jarjestys AS jarj_yo_kulunutaika
,d17b.jarjestys AS jarj_amm_kulunutaika
,d17c.jarjestys AS jarj_amk_kulunutaika
,d17d.jarjestys AS jarj_ylempi_amk_kulunutaika
,d17e.jarjestys AS jarj_alempi_kk_kulunutaika
,d17f.jarjestys AS jarj_ylempi_kk_kulunutaika
,d21.jarjestys_koulutusaste2002
,d21.jarjestys_koulutusala2002
,d21.jarjestys_opintoala1995
,d21.jarjestys_opintoala2002
,d21.jarjestys as jarj_koulnimike
,d22.jarjestys_avi
,d22.jarjestys_ely
,d22.jarjestys_maakunta
,d22.jarjestys_kielisuhde
,d22.jarjestys as jarj_kunta
,d24.jarjestys as jarj_lukukausi
,d25.jarjestys as jarj_aikkorktutkinto
,d26.jarjestys as jarj_avoin
,d27.jarjestys as jarj_vah45
,d28.jarjestys as jarj_vah55
,d29.jarjestys as jarj_op_fte
,d30.jarjestys as jarj_opmuoto
,d31.jarjestys as jarj_pohjkoultila
FROM dbo.f_KAK_2_10_Korkeakouluopiskelijoiden_aikaisempi_koulutus
	JOIN d_aidinkieli_versio1 d2 ON d2.id = aidinkieli_versio1_id
	JOIN d_alueluokitus d3 ON d3.id = kotikunta_id
	JOIN d_sukupuoli d4 ON d4.id = sukupuoli_id
	JOIN d_ika d5 ON d5.id = ika_1v_id
	JOIN d_ika d5b ON d5b.id = ika_14_65_id
	JOIN d_ika d5c ON d5c.id = ika_18_65_id
	JOIN d_ika d6 ON d6.id = ika_5v_id
	JOIN d_koulutustyyppi d7 ON d7.id = koulutustyyppi_id
	JOIN d_kansalaisuus_versio2 d8 ON d8.id = kansalaisuus_versio2_id
	JOIN d_oppilaitoksen_taustatiedot d9 ON d9.id = oppilaitoksen_taustatiedot_id
	JOIN d_lahde d10 ON d10.id = lahde_id
	JOIN d_opiskelijan_olo d12 ON d12.id = opiskelijan_olo_syys_id
	JOIN d_opiskelijan_olo_tamm d12b ON d12b.id = opiskelijan_olo_tamm_id
	JOIN d_rahoituslahde d13 ON d13.id = rahoituslahde_id
	JOIN d_oppilaitoksen_taustatiedot d14a ON d14a.id = aikaisemmin_suoritetun_yotutk_oppilaitostiedot_id
	JOIN d_oppilaitoksen_taustatiedot d14b ON d14b.id = aikaisemmin_suoritetun_ammtutk_oppilaitostiedot_id
	JOIN d_oppilaitoksen_taustatiedot d14c ON d14c.id = aikaisemmin_suoritetun_amktutk_oppilaitostiedot_id
	JOIN d_oppilaitoksen_taustatiedot d14d ON d14d.id = aikaisemmin_suoritetun_ylempiamktutk_oppilaitostiedot_id
	JOIN d_oppilaitoksen_taustatiedot d14e ON d14e.id = aikaisemmin_suoritetun_alempikktutk_oppilaitostiedot_id
	JOIN d_oppilaitoksen_taustatiedot d14f ON d14f.id = aikaisemmin_suoritetun_ylempikktutk_oppilaitostiedot_id
	JOIN d_koulutusluokitus d15a ON d15a.id = aikaisemmin_suoritetun_yotutk_koulutustiedot_id
	JOIN d_koulutusluokitus d15b ON d15b.id = aikaisemmin_suoritetun_ammtutk_koulutustiedot_id
	JOIN d_koulutusluokitus d15c ON d15c.id = aikaisemmin_suoritetun_amktutk_koulutustiedot_id
	JOIN d_koulutusluokitus d15d ON d15d.id = aikaisemmin_suoritetun_ylempiamktutk_koulutustiedot_id
	JOIN d_koulutusluokitus d15e ON d15e.id = aikaisemmin_suoritetun_alempikktutk_koulutustiedot_id
	JOIN d_koulutusluokitus d15f ON d15f.id = aikaisemmin_suoritetun_ylempikktutk_koulutustiedot_id
	JOIN d_koulutusluokitus d15g ON d15g.id = opiskelijan_koulutus_edellisvuonna_id
	JOIN d_koulutusluokitus d15h ON d15h.id = opiskelijan_opintoala2002_edellisvuonna_id
	JOIN d_koulutusluokitus d15i ON d15i.id = opiskelijan_opintoala1995_edellisvuonna_id
	JOIN d_kausi d16a ON d16a.kausi_id = aikaisemmin_suoritetun_yotutk_suoritusvuosi_id
	JOIN d_kausi d16b ON d16b.kausi_id = aikaisemmin_suoritetun_ammtutk_suoritusvuosi_id
	JOIN d_kausi d16c ON d16c.kausi_id = aikaisemmin_suoritetun_amktutk_suoritusvuosi_id
	JOIN d_kausi d16d ON d16d.kausi_id = aikaisemmin_suoritetun_ylempiamktutk_suoritusvuosi_id
	JOIN d_kausi d16e ON d16e.kausi_id = aikaisemmin_suoritetun_alempikktutk_suoritusvuosi_id
	JOIN d_kausi d16f ON d16f.kausi_id = aikaisemmin_suoritetun_ylempikktutk_suoritusvuosi_id
	JOIN d_koulutuksesta_kulunut_aika d17a ON d17a.id = aikaisemmasta_koulutuksesta_yotutk_kulunut_aika_id
	JOIN d_koulutuksesta_kulunut_aika d17b ON d17b.id = aikaisemmasta_koulutuksesta_ammtutk_kulunut_aika_id
	JOIN d_koulutuksesta_kulunut_aika d17c ON d17c.id = aikaisemmasta_koulutuksesta_amktutk_kulunut_aika_id
	JOIN d_koulutuksesta_kulunut_aika d17d ON d17d.id = aikaisemmasta_koulutuksesta_ylamktutk_kulunut_aika_id
	JOIN d_koulutuksesta_kulunut_aika d17e ON d17e.id = aikaisemmasta_koulutuksesta_alkktutk_kulunut_aika_id
	JOIN d_koulutuksesta_kulunut_aika d17f ON d17f.id = aikaisemmasta_koulutuksesta_ylkktutk_kulunut_aika_id
	JOIN d_koulutusluokitus d21 ON d21.id = koulutusluokitus_id
	JOIN d_alueluokitus d22 ON d22.id = koulutuksen_kunta_id
	JOIN d_kausi d23 ON d23.kausi_id = kirjoihintulovuosi_id
	JOIN d_kausi d24 ON d24.kausi_id = kirjoihintulolukukausi_id
	JOIN d_kausi d24b ON d24b.kausi_id = kirjoihintulovuosi_korkeakoulusektori_id
	JOIN d_kausi d24c ON d24c.kausi_id = kirjoihintulovuosi_korkeakoulusektori_lasnaoleva_id
	JOIN d_kausi d24d ON d24d.kausi_id = kirjoihintulovuosi_sektori_id
	JOIN d_kausi d24e ON d24e.kausi_id = kirjoihintulovuosi_sektori_lasnaoleva_id
	JOIN d_kausi d24f ON d24f.kausi_id = kirjoihintulovuosi_korkeakoulu_id
	JOIN d_kausi d24g ON d24g.kausi_id = kirjoihintulovuosi_korkeakoulu_lasnaoleva_id
	JOIN d_kausi d24h ON d24h.kausi_id = kirjoihintulovuosi_opintoala_id
	JOIN d_kausi d24i ON d24i.kausi_id = kirjoihintulovuosi_opintoala_lasnaoleva_id
	JOIN d_aikaisempi_korkein_tutkinto d25 ON d25.id = aikaisempi_korkein_tutkinto_id
	JOIN d_avoinvayla d26 ON d26.id = avoinvayla_id
	JOIN d_vahintaan_45_op_suorittanut d27 ON d27.id = vahintaan_45_op_suorittanut_id
	JOIN d_vahintaan_55_op_suorittanut d28 ON d28.id = vahintaan_55_op_suorittanut_id
	JOIN d_opiskelijan_fte_tieto d29 ON d29.id = opiskelijan_fte_tieto_id
	JOIN d_opiskelumuoto d30 ON d30.id = opiskelumuoto_id
	JOIN d_pohjakoulutuksen_tila d31 ON d31.id = pohjakoulutuksen_tila_id
WHERE d10.lahde_koodi = ''41'' AND d9.oppilaitoskoodi <> ''02557'' AND d9.oppilaitoskoodi <> ''10031'' AND d9.oppilaitoskoodi <> ''02358''











' 
GO
/****** Object:  View [dbo].[v_f_tab_korkeakouluopiskelijoiden_aikaisempi_koulutus_yhteiset]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_korkeakouluopiskelijoiden_aikaisempi_koulutus_yhteiset]'))
EXEC dbo.sp_executesql @statement = N'











CREATE VIEW [dbo].[v_f_tab_korkeakouluopiskelijoiden_aikaisempi_koulutus_yhteiset] AS

Select [Opisk2] = opiskelijat,
[Aloitt2] = coalesce(aloittaneet,0)
,[Ylempi_korkeakoulututkinto] = ylempi_korkeakoulututkinto
,[Ylempi_amk_tutkinto] = ylempi_amk_tutkinto
,[Alempi_korkeakoulututkinto] = alempi_korkeakoulututkinto
,[Amk_tutkinto] = amk_tutkinto
,[Ammatillinen_perustutkinto] = ammatillinen_perustutkinto
,[Ylioppilastutkinto] = ylioppilastutkinto
,[Ei_perusasteen_jalkeista_koulutusta] = ei_perusasteen_jalkeista_koulutusta
,[Tilastovuosi] AS Tilastovuosi
,d2.aidinkieli_versio1 AS Äidinkieli
,d3.avi AS "Asuinalueen AVI"
,d3.ely AS "Asuinalueen ELY"
,d3.kielisuhde AS "Asuinkunnan kielisuhde"
,d3.maakunta AS Asuinmaakunta
,d3.kunta AS Asuinkunta
,d4.sukupuoli AS Sukupuoli
,d5.ika AS Ikä
,d5.ika5v AS Ikäryhmä
,d5b.ika AS "Ikä 15-65"
,d5b.ika5v AS "Ikäryhmä 15-65"
,d5c.ika AS "Ikä 18-65"
,d5c.ika5v AS "Ikäryhmä 18-65"
,d6.ika5v AS Ikäryhmä2
,d7.koulutustyyppi AS Koulutustyyppi
,d8.kansalaisuus_versio2 AS Kansalaisuus
,d9.oppilaitos AS Oppilaitos
,d9.oppilaitos AS Yliopisto
,d9.oppilaitos AS Ammattikorkeakoulu
,d9.opetuskieli AS Opetuskieli
,d9.oppilaitoksen_omistajatyyppi AS "Oppilaitoksen omistajatyyppi"
,d9.oppilaitostyyppi AS Oppilaitostyyppi
,d10.lahde AS Lähde
,d12.opiskelijan_olo AS "Kirjoillaolo (syysk.)"
,d12b.opiskelijan_olo_tamm AS "Kirjoillaolo (tammik.)"
,d13.rahoituslahde AS Rahoituslähde
,d14a.oppilaitos AS "Pohjakoul. oppilaitos (lukio)"
,d14a.opetuskieli AS "Pohjakoul. oppil. opetuskieli (lukio)"
,d14a.oppilaitoksen_omistajatyyppi AS "Pohjakoul. oppil. omistajatyyppi (lukio)"
,d14a.oppilaitostyyppi AS "Pohjakoul. oppil.tyyppi (lukio)"
,d14b.oppilaitos AS "Pohjakoul. oppilaitos (amm)"
,d14b.opetuskieli AS "Pohjakoul. oppil. opetuskieli (amm)"
,d14b.oppilaitoksen_omistajatyyppi AS "Pohjakoul. oppil. omistajatyyppi (amm)"
,d14b.oppilaitostyyppi AS "Pohjakoul. oppil.tyyppi (amm)"
,d14c.oppilaitos AS "Pohjakoul. oppilaitos (amk)"
,d14c.opetuskieli AS "Pohjakoul. oppil. opetuskieli (amk)"
,d14c.oppilaitoksen_omistajatyyppi AS "Pohjakoul. oppil. omistajatyyppi (amk)"
,d14c.oppilaitostyyppi AS "Pohjakoul. oppil.tyyppi (amk)"
,d14d.oppilaitos AS "Pohjakoul. oppilaitos (ylempi amk)"
,d14d.opetuskieli AS "Pohjakoul. oppil. opetuskieli (ylempi amk)"
,d14d.oppilaitoksen_omistajatyyppi AS "Pohjakoul. oppil. omistajatyyppi (ylempi amk)"
,d14d.oppilaitostyyppi AS "Pohjakoul. oppil.tyyppi (ylempi amk)"
,d14e.oppilaitos AS "Pohjakoul. oppilaitos (alempi kk)"
,d14e.opetuskieli AS "Pohjakoul. oppil. opetuskieli (alempi kk)"
,d14e.oppilaitoksen_omistajatyyppi AS "Pohjakoul. oppil. omistajatyyppi (alempi kk)"
,d14e.oppilaitostyyppi AS "Pohjakoul. oppil.tyyppi (alempi kk)"
,d14f.oppilaitos AS "Pohjakoul. oppilaitos (ylempi kk)"
,d14f.opetuskieli AS "Pohjakoul. oppil. opetuskieli (ylempi kk)"
,d14f.oppilaitoksen_omistajatyyppi AS "Pohjakoul. oppil. omistajatyyppi (ylempi kk)"
,d14f.oppilaitostyyppi AS "Pohjakoul. oppil.tyyppi (ylempi kk)"
,d15a.opintoala1995 AS "Pohjakoul. koul.ala (95 luokitus) (lukio)"
,d15a.opintoala2002 AS "Pohjakoul. opintoala (lukio)"
,d15a.koulutusala2002 AS "Pohjakoul. koul.ala (02 luokitus) (lukio)"
,d15a.koulutus AS "Pohjakoul. koul.nimike (lukio)"
,d15a.koulutusaste2002 as "Pohjakoul. koul.aste (lukio)"
,d15b.opintoala1995 AS "Pohjakoul. koul.ala (95 luokitus) (amm)"
,d15b.opintoala2002 AS "Pohjakoul. opintoala (amm)"
,d15b.koulutusala2002 AS "Pohjakoul. koul.ala (02 luokitus) (amm)"
,d15b.koulutus AS "Pohjakoul. koul.nimike (amm)"
,d15b.koulutusaste2002 as "Pohjakoul. koul.aste (amm)"
,d15c.opintoala1995 AS "Pohjakoul. koul.ala (95 luokitus) (amk)"
,d15c.opintoala2002 AS "Pohjakoul. opintoala (amk)"
,d15c.koulutusala2002 AS "Pohjakoul. koul.ala (02 luokitus) (amk)"
,d15c.koulutus AS "Pohjakoul. koul.nimike (amk)"
,d15c.koulutusaste2002 as "Pohjakoul. koul.aste (amk)"
,d15d.opintoala1995 AS "Pohjakoul. koul.ala (95 luokitus) (ylempi amk)"
,d15d.opintoala2002 AS "Pohjakoul. opintoala (ylempi amk)"
,d15d.koulutusala2002 AS "Pohjakoul. koul.ala (02 luokitus) (ylempi amk)"
,d15d.koulutus AS "Pohjakoul. koul.nimike (ylempi amk)"
,d15d.koulutusaste2002 as "Pohjakoul. koul.aste (ylempi amk)"
,d15e.opintoala1995 AS "Pohjakoul. koul.ala (95 luokitus) (alempi kk)"
,d15e.opintoala2002 AS "Pohjakoul. opintoala (alempi kk)"
,d15e.koulutusala2002 AS "Pohjakoul. koul.ala (02 luokitus) (alempi kk)"
,d15e.koulutus AS "Pohjakoul. koul.nimike (alempi kk)"
,d15e.koulutusaste2002 as "Pohjakoul. koul.aste (alempi kk)"
,d15f.opintoala1995 AS "Pohjakoul. koul.ala (95 luokitus) (ylempi kk)"
,d15f.opintoala2002 AS "Pohjakoul. opintoala (ylempi kk)"
,d15f.koulutusala2002 AS "Pohjakoul. koul.ala (02 luokitus) (ylempi kk)"
,d15f.koulutus AS "Pohjakoul. koul.nimike (ylempi kk)"
,d15f.koulutusaste2002 as "Pohjakoul. koul.aste (ylempi kk)"
,d15g.opintoala1995 AS "Pohjakoul. koul.ala (95 luokitus)"
,d15g.opintoala2002 AS "Pohjakoul. opintoala"
,d15g.koulutusala2002 AS "Pohjakoul. koul.ala (02 luokitus)"
,d15g.koulutus AS "Pohjakoul. koul.nimike"
,d15g.koulutusaste2002 as "Pohjakoul. koul.aste"
,d15h.opintoala2002 as "Pohjakoul. opintoala2"
,d15i.opintoala1995 as "Pohjakoul. koul.ala (95 luokitus)2"
,d16a.vuosiselite AS "Pohjakoul. suoritusvuosi (lukio)"
,d16b.vuosiselite AS "Pohjakoul. suoritusvuosi (amm)"
,d16c.vuosiselite AS "Pohjakoul. suoritusvuosi (amk)"
,d16d.vuosiselite AS "Pohjakoul. suoritusvuosi (ylempi amk)"
,d16e.vuosiselite AS "Pohjakoul. suoritusvuosi (alempi kk)"
,d16f.vuosiselite AS "Pohjakoul. suoritusvuosi (ylempi kk)"
,d17a.koulutuksesta_kulunut_aika AS "Pohjakoulutuksesta kulunut aika (lukio)"
,d17b.koulutuksesta_kulunut_aika AS "Pohjakoulutuksesta kulunut aika (amm)"
,d17c.koulutuksesta_kulunut_aika AS "Pohjakoulutuksesta kulunut aika (amk)"
,d17d.koulutuksesta_kulunut_aika AS "Pohjakoulutuksesta kulunut aika (ylempi amk)"
,d17e.koulutuksesta_kulunut_aika AS "Pohjakoulutuksesta kulunut aika (alempi kk)"
,d17f.koulutuksesta_kulunut_aika AS "Pohjakoulutuksesta kulunut aika (ylempi kk)"
,d21.koulutusaste2002 as Koulutusaste
,d21.koulutusala2002 as "Koulutusala (02 luokitus)"
,d21.opintoala1995 as "Koulutusala (95 luokitus)"
,d21.opintoala2002 as Opintoala
,d21.koulutus as Koulutusnimike
,d22.avi as "Koulutuksen AVI"
,d22.ely as "Koulutuksen ELY"
,d22.maakunta as "Koulutuksen maakunta"
,d22.kielisuhde as "Koulutuksen kunnan kielisuhde"
,d22.kunta as "Koulutuksen kunta"
,d23.vuosiselite as "Kirjoihintulovuosi"
,d24.lukukausiselite as "Kirjoihintulolukukausi"
,d24b.vuosiselite as "Kirjoihintulovuosi (kk-sektori)"
,d24c.vuosiselite as "Kirjoihintulovuosi (kk-sektori läsna)"
,d24d.vuosiselite as "Kirjoihintulovuosi (sektori)"
,d24e.vuosiselite as "Kirjoihintulovuosi (sektori läsnä)"
,d24f.vuosiselite as "Kirjoihintulovuosi (korkeakoulu)"
,d24g.vuosiselite as "Kirjoihintulovuosi (korkeakoulu läsnä)"
,d24h.vuosiselite as "Kirjoihintulovuosi (opintoala)"
,d24i.vuosiselite as "Kirjoihintulovuosi (opintoala läsnä)"
,d25.aikaisempi_korkein_tutkinto as "Aikaisempi korkein tutkinto"
,d26.avoinvayla as "Avoin väylä"
,d27.vahintaan_45_op_suorittanut as "Suorittanut väh. 45 op"
,d28.vahintaan_55_op_suorittanut as "Suorittanut väh. 55 op"
,d29.opiskelijan_fte_tieto as "Opiskelijan FTE-tieto"
,d30.opiskelumuoto as Opiskelumuoto
,d31.pohjakoulutuksen_tila as "Pohjakoulutuksen tila"
,[aikaisemmin_suoritettu_yotutk] as jarj_aik_yo
,[aikaisemmin_suoritettu_yotutk_tarkempi] as "Aikaisempi lukiokoulutus"
,[yotutk_pohjakoulutuksen_tila] as "Aik. lukiokoul. tila"
,[aikaisemmin_suoritettu_ammtutk] as jarj_aik_amm
,[aikaisemmin_suoritettu_ammtutk_tarkempi] as "Aikaisempi amm. koulutus"
,[ammtutk_pohjakoulutuksen_tila] as "Aik. amm. koulutuksen tila"
,[aikaisemmin_suoritettu_amktutk] as jarj_aik_amk
,[aikaisemmin_suoritettu_amktutk_tarkempi] as "Aikaisempi amk-tutkinto"
,[amktutk_pohjakoulutuksen_tila] as "Aik. amk-tutkinnon tila"
,[aikaisemmin_suoritettu_ylempiamktutk] as jarj_aik_ylempiamk
,[aikaisemmin_suoritettu_ylempiamktutk_tarkempi] as "Aikaisempi ylempi amk-tutkinto"
,[ylempiamktutk_pohjakoulutuksen_tila] as "Aik. ylemmän amk-tutkinnon tila"
,[aikaisemmin_suoritettu_alempikktutk] as jarj_aik_alempikk
,[aikaisemmin_suoritettu_alempikktutk_tarkempi] as "Aikaisempi alempi kk-tutkinto"
,[alempikktutk_pohjakoulutuksen_tila] as "Aik. alemman kk-tutkinnon tila"
,[aikaisemmin_suoritettu_ylempikktutk] as jarj_aik_ylempikk
,[aikaisemmin_suoritettu_ylempikktutk_tarkempi] as "Aikaisempi ylempi kk-tukinto"
,[ylempikktutk_pohjakoulutuksen_tila] as "Aik. ylemmän kk-tutkinnon tila"
,[aiemman_tutkinnon_yotutk_opintoala1995_sama] as "Pohjakoul. koul.ala (95) sama (lukio)"
,[aiemman_tutkinnon_yotutk_opintoala2002_sama] as "Pohjakoul. op.ala sama (lukio)"
,[aiemman_tutkinnon_yotutk_koulutusala2002_sama] as "Pohjakoul. koul.ala (02) sama (lukio)"
,[aiemman_tutkinnon_yotutk_koulutusaste2002_sama] as "Pohjakoul. koul.aste sama (lukio)"
,[aiemman_tutkinnon_ammtutk_opintoala1995_sama] as "Pohjakoul. koul.ala (95) sama (amm)"
,[aiemman_tutkinnon_ammtutk_opintoala2002_sama] as "Pohjakoul. op.ala sama (amm)"
,[aiemman_tutkinnon_ammtutk_koulutusala2002_sama] as "Pohjakoul. koul.ala sama (amm)"
,[aiemman_tutkinnon_ammtutk_koulutusaste2002_sama] as "Pohjakoul. koul.aste sama (amm)"
,[aiemman_tutkinnon_amktutk_opintoala1995_sama] as "Pohjakoul. koul.ala (95) sama (amk)"
,[aiemman_tutkinnon_amktutk_opintoala2002_sama] as "Pohjakoul. op.ala sama (amk)"
,[aiemman_tutkinnon_amktutk_koulutusala2002_sama] as "Pohjakoul. koul.ala (02) sama (amk)"
,[aiemman_tutkinnon_amktutk_koulutusaste2002_sama] as "Pohjakoul. koul.aste sama (amk)"
,[aiemman_tutkinnon_ylempiamktutk_opintoala1995_sama] as "Pohjakoul. koul.ala (95) sama (ylempi amk)"
,[aiemman_tutkinnon_ylempiamktutk_opintoala2002_sama] as "Pohjakoul. op.ala sama (ylempi amk)"
,[aiemman_tutkinnon_ylempiamktutk_koulutusala2002_sama] as "Pohjakoul. koul.ala (02) sama (ylempi amk)"
,[aiemman_tutkinnon_ylempiamktutk_koulutusaste2002_sama] as "Pohjakoul. koul.aste sama (ylempi amk)"
,[aiemman_tutkinnon_alempikktutk_opintoala1995_sama] as "Pohjakoul. koul.ala (95) sama (alempi kk)"
,[aiemman_tutkinnon_alempikktutk_opintoala2002_sama] as "Pohjakoul. op.ala sama (alempi kk)"
,[aiemman_tutkinnon_alempikktutk_koulutusala2002_sama] as "Pohjakoul. koul.ala (02) sama (alempi kk)"
,[aiemman_tutkinnon_alempikktutk_koulutusaste2002_sama] as "Pohjakoul. koul.aste sama (alempi kk)"
,[aiemman_tutkinnon_ylempikktutk_opintoala1995_sama] as "Pohjakoul. koul.ala (95) sama (ylempi kk)"
,[aiemman_tutkinnon_ylempikktutk_opintoala2002_sama] as "Pohjakoul. op.ala sama (ylempi kk)"
,[aiemman_tutkinnon_ylempikktutk_koulutusala2002_sama] as "Pohjakoul. koul.ala (02) sama (ylempi kk)"
,[aiemman_tutkinnon_ylempikktutk_koulutusaste2002_sama] as "Pohjakoul. koul.aste sama (ylempi kk)"
,[aiemman_tutkinnon_opintoala1995_sama] as "Pohjakoul. koul.ala (95) sama"
,[aiemman_tutkinnon_opintoala2002_sama] as "Pohjakoul. op.ala sama"
,[aiemman_tutkinnon_koulutusala2002_sama] as "Pohjakoul. koul.ala (02) sama"
,[aiemman_tutkinnon_koulutusaste2002_sama] as "Pohjakoul. koul.aste sama"

--Ruotsi
,[Statistikår] = tilastovuosi
,[Kön] = d4.sukupuoli_SV
,[Modersmål] = d2.aidinkieli_versio1_SV
,[Åldersgrupp] = d5.ika5v_SV
,[Högsta tidigare avlagd examen] = d25.aikaisempi_korkein_tutkinto_SV
,[Tidigare studentexamen] = null
,[Tidigare amm] = null
,[Tidigare amk] = null
,[Tidigare yl amk] = null
,[Tidigare al kk] = null
,[Tidigare yl kk] = null
,[Utbildningsnivå] = d21.koulutusaste2002_SV
,[Utbildningsområde (2002)] = d21.koulutusala2002_SV
,[Utbildningsområde (1995)] = d21.koulutusala1995_SV
,[Studieområde] = d21.opintoala2002_SV
,[Utbildningens landskap] = d22.maakunta_SV
,[Läroanstalt] = d9.oppilaitos_SV

--Englanti
,[Statistical year] = tilastovuosi
,[Gender] = d4.sukupuoli_EN
,[Mother tongue] = d2.aidinkieli_versio1_EN
,[Age group] = d5.ika5v_EN
,[Highest previous degree/qualification] = d25.aikaisempi_korkein_tutkinto_EN
,[Previous high school degree] = null
,[Previous amm] = null
,[Previous amk] = null
,[Previous yl amk] = null
,[Previous al kk] = null
,[Previous yl kk] = null
,[Level of education] = d21.koulutusaste2002_EN
,[Field of education (2002)] = d21.koulutusala2002_EN
,[Field of education (1995)] = d21.koulutusala1995_EN
,[Subfield of education] = d21.opintoala2002_EN
,[Region of education] = d22.maakunta_EN
,[Educational institution] = d9.oppilaitos_EN

--Järjestys
,d2.jarjestys AS jarj_aidinkieli
,d3.jarjestys_avi AS jarj_as_avi
,d3.jarjestys_ely AS jarj_as_ely
,d3.jarjestys_kielisuhde AS jarj_as_kielisuhde
,d3.jarjestys_maakunta AS jarj_as_maakunta
,d3.jarjestys AS jarj_as_kunta
,d5.jarjestys_ika
,d5.jarjestys_ika5v AS jarj_ika5v
,d5b.jarjestys_ika AS jarj_1565_1v
,d5b.jarjestys_ika5v AS jarj_1565_5v
,d5c.jarjestys_ika AS jarj_1865_1v
,d5c.jarjestys_ika5v AS jarj_1865_5v
,d6.jarjestys_ika5v AS jarj_ikaryhma2
,d7.jarjestys AS jarj_koultyyppi
,d7.koulutustyyppi_koodi
,d8.jarjestys AS jarj_kansalaisuus
,d9.jarjestys_oppilaitos
,d9.jarjestys_opetuskieli
,d9.jarjestys_omistajatyyppi
,d9.jarjestys_oppilaitostyyppi
,d10.lahde_koodi
,d12.jarjestys AS jarj_kirjolosyys
,d12b.jarjestys AS jarj_kirjolotammi
,d13.jarjestys AS jarj_rahoitus
,d14a.jarjestys_oppilaitos AS jarj_pohj_14a_oppil
,d14a.jarjestys_oppilaitostyyppi AS jarj_pohj_14a_oppiltyp
,d14a.jarjestys_opetuskieli AS jarj_pohj_14a_opkiel
,d14a.jarjestys_omistajatyyppi AS jarj_pohj_14a_oppilomist
,d14b.jarjestys_oppilaitos AS jarj_pohj_14b_oppil
,d14b.jarjestys_oppilaitostyyppi AS jarj_pohj_14b_oppiltyp
,d14b.jarjestys_opetuskieli AS jarj_pohj_14b_opkiel
,d14b.jarjestys_omistajatyyppi AS jarj_pohj_14b_oppilomist
,d14c.jarjestys_oppilaitos AS jarj_pohj_14c_oppil
,d14c.jarjestys_oppilaitostyyppi AS jarj_pohj_14c_oppiltyp
,d14c.jarjestys_opetuskieli AS jarj_pohj_14c_opkiel
,d14c.jarjestys_omistajatyyppi AS jarj_pohj_14c_oppilomist
,d14d.jarjestys_oppilaitos AS jarj_pohj_14d_oppil
,d14d.jarjestys_oppilaitostyyppi AS jarj_pohj_14d_oppiltyp
,d14d.jarjestys_opetuskieli AS jarj_pohj_14d_opkiel
,d14d.jarjestys_omistajatyyppi AS jarj_pohj_14d_oppilomist
,d14e.jarjestys_oppilaitos AS jarj_pohj_14e_oppil
,d14e.jarjestys_oppilaitostyyppi AS jarj_pohj_14e_oppiltyp
,d14e.jarjestys_opetuskieli AS jarj_pohj_14e_opkiel
,d14e.jarjestys_omistajatyyppi AS jarj_pohj_14e_oppilomist
,d14f.jarjestys_oppilaitos AS jarj_pohj_14f_oppil
,d14f.jarjestys_oppilaitostyyppi AS jarj_pohj_14f_oppiltyp
,d14f.jarjestys_opetuskieli AS jarj_pohj_14f_opkiel
,d14f.jarjestys_omistajatyyppi AS jarj_pohj_14f_oppilomist
,d15a.jarjestys_opintoala1995 AS jarj_15a_koulala95
,d15a.jarjestys_opintoala2002 AS jarj_15a_opala
,d15a.jarjestys_koulutusala2002 AS jarj_15a_koulala02
,d15a.jarjestys AS jarj_15a_koulnimike
,d15a.jarjestys_koulutusaste2002 AS jarj_15a_koulaste
,d15b.jarjestys_opintoala1995 AS jarj_15b_koulala95
,d15b.jarjestys_opintoala2002 AS jarj_15b_opala
,d15b.jarjestys_koulutusala2002 AS jarj_15b_koulala02
,d15b.jarjestys AS jarj_15b_koulnimike
,d15b.jarjestys_koulutusaste2002 AS jarj_15b_koulaste
,d15c.jarjestys_opintoala1995 AS jarj_15c_koulala95
,d15c.jarjestys_opintoala2002 AS jarj_15c_opala
,d15c.jarjestys_koulutusala2002 AS jarj_15c_koulala02
,d15c.jarjestys AS jarj_15c_koulnimike
,d15c.jarjestys_koulutusaste2002 AS jarj_15c_koulaste
,d15d.jarjestys_opintoala1995 AS jarj_15d_koulala95
,d15d.jarjestys_opintoala2002 AS jarj_15d_opala
,d15d.jarjestys_koulutusala2002 AS jarj_15d_koulala02
,d15d.jarjestys AS jarj_15d_koulnimike
,d15d.jarjestys_koulutusaste2002 AS jarj_15d_koulaste
,d15e.jarjestys_opintoala1995 AS jarj_15e_koulala95
,d15e.jarjestys_opintoala2002 AS jarj_15e_opala
,d15e.jarjestys_koulutusala2002 AS jarj_15e_koulala02
,d15e.jarjestys AS jarj_15e_koulnimike
,d15e.jarjestys_koulutusaste2002 AS jarj_15e_koulaste
,d15f.jarjestys_opintoala1995 AS jarj_15f_koulala95
,d15f.jarjestys_opintoala2002 AS jarj_15f_opala
,d15f.jarjestys_koulutusala2002 AS jarj_15f_koulala02
,d15f.jarjestys AS jarj_15f_koulnimike
,d15f.jarjestys_koulutusaste2002 AS jarj_15f_koulaste
,d15g.jarjestys_opintoala1995 AS jarj_15g_koulala95
,d15g.jarjestys_opintoala2002 AS jarj_15g_opala
,d15g.jarjestys_koulutusala2002 AS jarj_15g_koulala02
,d15g.jarjestys AS jarj_15g_koulnimike
,d15g.jarjestys_koulutusaste2002 AS jarj_15g_koulaste
,d15h.jarjestys_opintoala2002 AS jarj_15h_opala
,d15i.jarjestys_opintoala1995 AS jarj_15i_koulala95
,d17a.jarjestys AS jarj_yo_kulunutaika
,d17b.jarjestys AS jarj_amm_kulunutaika
,d17c.jarjestys AS jarj_amk_kulunutaika
,d17d.jarjestys AS jarj_ylempi_amk_kulunutaika
,d17e.jarjestys AS jarj_alempi_kk_kulunutaika
,d17f.jarjestys AS jarj_ylempi_kk_kulunutaika
,d21.jarjestys_koulutusaste2002
,d21.jarjestys_koulutusala2002
,d21.jarjestys_opintoala1995
,d21.jarjestys_opintoala2002
,d21.jarjestys as jarj_koulnimike
,d22.jarjestys_avi
,d22.jarjestys_ely
,d22.jarjestys_maakunta
,d22.jarjestys_kielisuhde
,d22.jarjestys as jarj_kunta
,d24.jarjestys as jarj_lukukausi
,d25.jarjestys as jarj_aikkorktutkinto
,d26.jarjestys as jarj_avoin
,d27.jarjestys as jarj_vah45
,d28.jarjestys as jarj_vah55
,d29.jarjestys as jarj_op_fte
,d30.jarjestys as jarj_opmuoto
,d31.jarjestys as jarj_pohjkoultila
FROM dbo.f_KAK_2_10_Korkeakouluopiskelijoiden_aikaisempi_koulutus
	JOIN d_aidinkieli_versio1 d2 ON d2.id = aidinkieli_versio1_id
	JOIN d_alueluokitus d3 ON d3.id = kotikunta_id
	JOIN d_sukupuoli d4 ON d4.id = sukupuoli_id
	JOIN d_ika d5 ON d5.id = ika_1v_id
	JOIN d_ika d5b ON d5b.id = ika_14_65_id
	JOIN d_ika d5c ON d5c.id = ika_18_65_id
	JOIN d_ika d6 ON d6.id = ika_5v_id
	JOIN d_koulutustyyppi d7 ON d7.id = koulutustyyppi_id
	JOIN d_kansalaisuus_versio2 d8 ON d8.id = kansalaisuus_versio2_id
	JOIN d_oppilaitoksen_taustatiedot d9 ON d9.id = oppilaitoksen_taustatiedot_id
	JOIN d_lahde d10 ON d10.id = lahde_id
	JOIN d_opiskelijan_olo d12 ON d12.id = opiskelijan_olo_syys_id
	JOIN d_opiskelijan_olo_tamm d12b ON d12b.id = opiskelijan_olo_tamm_id
	JOIN d_rahoituslahde d13 ON d13.id = rahoituslahde_id
	JOIN d_oppilaitoksen_taustatiedot d14a ON d14a.id = aikaisemmin_suoritetun_yotutk_oppilaitostiedot_id
	JOIN d_oppilaitoksen_taustatiedot d14b ON d14b.id = aikaisemmin_suoritetun_ammtutk_oppilaitostiedot_id
	JOIN d_oppilaitoksen_taustatiedot d14c ON d14c.id = aikaisemmin_suoritetun_amktutk_oppilaitostiedot_id
	JOIN d_oppilaitoksen_taustatiedot d14d ON d14d.id = aikaisemmin_suoritetun_ylempiamktutk_oppilaitostiedot_id
	JOIN d_oppilaitoksen_taustatiedot d14e ON d14e.id = aikaisemmin_suoritetun_alempikktutk_oppilaitostiedot_id
	JOIN d_oppilaitoksen_taustatiedot d14f ON d14f.id = aikaisemmin_suoritetun_ylempikktutk_oppilaitostiedot_id
	JOIN d_koulutusluokitus d15a ON d15a.id = aikaisemmin_suoritetun_yotutk_koulutustiedot_id
	JOIN d_koulutusluokitus d15b ON d15b.id = aikaisemmin_suoritetun_ammtutk_koulutustiedot_id
	JOIN d_koulutusluokitus d15c ON d15c.id = aikaisemmin_suoritetun_amktutk_koulutustiedot_id
	JOIN d_koulutusluokitus d15d ON d15d.id = aikaisemmin_suoritetun_ylempiamktutk_koulutustiedot_id
	JOIN d_koulutusluokitus d15e ON d15e.id = aikaisemmin_suoritetun_alempikktutk_koulutustiedot_id
	JOIN d_koulutusluokitus d15f ON d15f.id = aikaisemmin_suoritetun_ylempikktutk_koulutustiedot_id
	JOIN d_koulutusluokitus d15g ON d15g.id = opiskelijan_koulutus_edellisvuonna_id
	JOIN d_koulutusluokitus d15h ON d15h.id = opiskelijan_opintoala2002_edellisvuonna_id
	JOIN d_koulutusluokitus d15i ON d15i.id = opiskelijan_opintoala1995_edellisvuonna_id
	JOIN d_kausi d16a ON d16a.kausi_id = aikaisemmin_suoritetun_yotutk_suoritusvuosi_id
	JOIN d_kausi d16b ON d16b.kausi_id = aikaisemmin_suoritetun_ammtutk_suoritusvuosi_id
	JOIN d_kausi d16c ON d16c.kausi_id = aikaisemmin_suoritetun_amktutk_suoritusvuosi_id
	JOIN d_kausi d16d ON d16d.kausi_id = aikaisemmin_suoritetun_ylempiamktutk_suoritusvuosi_id
	JOIN d_kausi d16e ON d16e.kausi_id = aikaisemmin_suoritetun_alempikktutk_suoritusvuosi_id
	JOIN d_kausi d16f ON d16f.kausi_id = aikaisemmin_suoritetun_ylempikktutk_suoritusvuosi_id
	JOIN d_koulutuksesta_kulunut_aika d17a ON d17a.id = aikaisemmasta_koulutuksesta_yotutk_kulunut_aika_id
	JOIN d_koulutuksesta_kulunut_aika d17b ON d17b.id = aikaisemmasta_koulutuksesta_ammtutk_kulunut_aika_id
	JOIN d_koulutuksesta_kulunut_aika d17c ON d17c.id = aikaisemmasta_koulutuksesta_amktutk_kulunut_aika_id
	JOIN d_koulutuksesta_kulunut_aika d17d ON d17d.id = aikaisemmasta_koulutuksesta_ylamktutk_kulunut_aika_id
	JOIN d_koulutuksesta_kulunut_aika d17e ON d17e.id = aikaisemmasta_koulutuksesta_alkktutk_kulunut_aika_id
	JOIN d_koulutuksesta_kulunut_aika d17f ON d17f.id = aikaisemmasta_koulutuksesta_ylkktutk_kulunut_aika_id
	JOIN d_koulutusluokitus d21 ON d21.id = koulutusluokitus_id
	JOIN d_alueluokitus d22 ON d22.id = koulutuksen_kunta_id
	JOIN d_kausi d23 ON d23.kausi_id = kirjoihintulovuosi_id
	JOIN d_kausi d24 ON d24.kausi_id = kirjoihintulolukukausi_id
	JOIN d_kausi d24b ON d24b.kausi_id = kirjoihintulovuosi_korkeakoulusektori_id
	JOIN d_kausi d24c ON d24c.kausi_id = kirjoihintulovuosi_korkeakoulusektori_lasnaoleva_id
	JOIN d_kausi d24d ON d24d.kausi_id = kirjoihintulovuosi_sektori_id
	JOIN d_kausi d24e ON d24e.kausi_id = kirjoihintulovuosi_sektori_lasnaoleva_id
	JOIN d_kausi d24f ON d24f.kausi_id = kirjoihintulovuosi_korkeakoulu_id
	JOIN d_kausi d24g ON d24g.kausi_id = kirjoihintulovuosi_korkeakoulu_lasnaoleva_id
	JOIN d_kausi d24h ON d24h.kausi_id = kirjoihintulovuosi_opintoala_id
	JOIN d_kausi d24i ON d24i.kausi_id = kirjoihintulovuosi_opintoala_lasnaoleva_id
	JOIN d_aikaisempi_korkein_tutkinto d25 ON d25.id = aikaisempi_korkein_tutkinto_id
	JOIN d_avoinvayla d26 ON d26.id = avoinvayla_id
	JOIN d_vahintaan_45_op_suorittanut d27 ON d27.id = vahintaan_45_op_suorittanut_id
	JOIN d_vahintaan_55_op_suorittanut d28 ON d28.id = vahintaan_55_op_suorittanut_id
	JOIN d_opiskelijan_fte_tieto d29 ON d29.id = opiskelijan_fte_tieto_id
	JOIN d_opiskelumuoto d30 ON d30.id = opiskelumuoto_id
	JOIN d_pohjakoulutuksen_tila d31 ON d31.id = pohjakoulutuksen_tila_id
WHERE d9.oppilaitoskoodi <> ''02557'' AND d9.oppilaitoskoodi <> ''10031'' AND d9.oppilaitoskoodi <> ''02358'' AND d21.koulutusaste2002_koodi <> ''73'' AND d21.koulutusaste2002_koodi <> ''81'' AND d21.koulutusaste2002_koodi <> ''82''












' 
GO
/****** Object:  View [dbo].[v_f_tab_korkeakouluopiskelijoiden_aikaisempi_koulutus_yliopisto]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_korkeakouluopiskelijoiden_aikaisempi_koulutus_yliopisto]'))
EXEC dbo.sp_executesql @statement = N'













CREATE VIEW [dbo].[v_f_tab_korkeakouluopiskelijoiden_aikaisempi_koulutus_yliopisto] AS

Select [Opisk2] = opiskelijat,
[Aloitt2] = coalesce(aloittaneet,0)
,[Ylempi_korkeakoulututkinto] = ylempi_korkeakoulututkinto
,[Ylempi_amk_tutkinto] = ylempi_amk_tutkinto
,[Alempi_korkeakoulututkinto] = alempi_korkeakoulututkinto
,[Amk_tutkinto] = amk_tutkinto
,[Ammatillinen_perustutkinto] = ammatillinen_perustutkinto
,[Ylioppilastutkinto] = ylioppilastutkinto
,[Ei_perusasteen_jalkeista_koulutusta] = ei_perusasteen_jalkeista_koulutusta
,[Tilastovuosi] AS Tilastovuosi
,d2.aidinkieli_versio1 AS Äidinkieli
,d3.avi AS "Asuinalueen AVI"
,d3.ely AS "Asuinalueen ELY"
,d3.kielisuhde AS "Asuinkunnan kielisuhde"
,d3.maakunta AS Asuinmaakunta
,d3.kunta AS Asuinkunta
,d4.sukupuoli AS Sukupuoli
,d5.ika AS Ikä
,d5.ika5v AS Ikäryhmä
,d5b.ika AS "Ikä 15-65"
,d5b.ika5v AS "Ikäryhmä 15-65"
,d5c.ika AS "Ikä 18-65"
,d5c.ika5v AS "Ikäryhmä 18-65"
,d6.ika5v AS Ikäryhmä2
,d7.koulutustyyppi AS Koulutustyyppi
,d8.kansalaisuus_versio2 AS Kansalaisuus
,d9.oppilaitos AS Oppilaitos
,d9.oppilaitos AS Yliopisto
,d9.oppilaitos AS Ammattikorkeakoulu
,d9.opetuskieli AS Opetuskieli
,d9.oppilaitoksen_omistajatyyppi AS "Oppilaitoksen omistajatyyppi"
,d9.oppilaitostyyppi AS Oppilaitostyyppi
,d10.lahde AS Lähde
,d12.opiskelijan_olo AS "Kirjoillaolo (syysk.)"
,d12b.opiskelijan_olo_tamm AS "Kirjoillaolo (tammik.)"
,d13.rahoituslahde AS Rahoituslähde
,d14a.oppilaitos AS "Pohjakoul. oppilaitos (lukio)"
,d14a.opetuskieli AS "Pohjakoul. oppil. opetuskieli (lukio)"
,d14a.oppilaitoksen_omistajatyyppi AS "Pohjakoul. oppil. omistajatyyppi (lukio)"
,d14a.oppilaitostyyppi AS "Pohjakoul. oppil.tyyppi (lukio)"
,d14b.oppilaitos AS "Pohjakoul. oppilaitos (amm)"
,d14b.opetuskieli AS "Pohjakoul. oppil. opetuskieli (amm)"
,d14b.oppilaitoksen_omistajatyyppi AS "Pohjakoul. oppil. omistajatyyppi (amm)"
,d14b.oppilaitostyyppi AS "Pohjakoul. oppil.tyyppi (amm)"
,d14c.oppilaitos AS "Pohjakoul. oppilaitos (amk)"
,d14c.opetuskieli AS "Pohjakoul. oppil. opetuskieli (amk)"
,d14c.oppilaitoksen_omistajatyyppi AS "Pohjakoul. oppil. omistajatyyppi (amk)"
,d14c.oppilaitostyyppi AS "Pohjakoul. oppil.tyyppi (amk)"
,d14d.oppilaitos AS "Pohjakoul. oppilaitos (ylempi amk)"
,d14d.opetuskieli AS "Pohjakoul. oppil. opetuskieli (ylempi amk)"
,d14d.oppilaitoksen_omistajatyyppi AS "Pohjakoul. oppil. omistajatyyppi (ylempi amk)"
,d14d.oppilaitostyyppi AS "Pohjakoul. oppil.tyyppi (ylempi amk)"
,d14e.oppilaitos AS "Pohjakoul. oppilaitos (alempi kk)"
,d14e.opetuskieli AS "Pohjakoul. oppil. opetuskieli (alempi kk)"
,d14e.oppilaitoksen_omistajatyyppi AS "Pohjakoul. oppil. omistajatyyppi (alempi kk)"
,d14e.oppilaitostyyppi AS "Pohjakoul. oppil.tyyppi (alempi kk)"
,d14f.oppilaitos AS "Pohjakoul. oppilaitos (ylempi kk)"
,d14f.opetuskieli AS "Pohjakoul. oppil. opetuskieli (ylempi kk)"
,d14f.oppilaitoksen_omistajatyyppi AS "Pohjakoul. oppil. omistajatyyppi (ylempi kk)"
,d14f.oppilaitostyyppi AS "Pohjakoul. oppil.tyyppi (ylempi kk)"
,d15a.opintoala1995 AS "Pohjakoul. koul.ala (95 luokitus) (lukio)"
,d15a.opintoala2002 AS "Pohjakoul. opintoala (lukio)"
,d15a.koulutusala2002 AS "Pohjakoul. koul.ala (02 luokitus) (lukio)"
,d15a.koulutus AS "Pohjakoul. koul.nimike (lukio)"
,d15a.koulutusaste2002 as "Pohjakoul. koul.aste (lukio)"
,d15b.opintoala1995 AS "Pohjakoul. koul.ala (95 luokitus) (amm)"
,d15b.opintoala2002 AS "Pohjakoul. opintoala (amm)"
,d15b.koulutusala2002 AS "Pohjakoul. koul.ala (02 luokitus) (amm)"
,d15b.koulutus AS "Pohjakoul. koul.nimike (amm)"
,d15b.koulutusaste2002 as "Pohjakoul. koul.aste (amm)"
,d15c.opintoala1995 AS "Pohjakoul. koul.ala (95 luokitus) (amk)"
,d15c.opintoala2002 AS "Pohjakoul. opintoala (amk)"
,d15c.koulutusala2002 AS "Pohjakoul. koul.ala (02 luokitus) (amk)"
,d15c.koulutus AS "Pohjakoul. koul.nimike (amk)"
,d15c.koulutusaste2002 as "Pohjakoul. koul.aste (amk)"
,d15d.opintoala1995 AS "Pohjakoul. koul.ala (95 luokitus) (ylempi amk)"
,d15d.opintoala2002 AS "Pohjakoul. opintoala (ylempi amk)"
,d15d.koulutusala2002 AS "Pohjakoul. koul.ala (02 luokitus) (ylempi amk)"
,d15d.koulutus AS "Pohjakoul. koul.nimike (ylempi amk)"
,d15d.koulutusaste2002 as "Pohjakoul. koul.aste (ylempi amk)"
,d15e.opintoala1995 AS "Pohjakoul. koul.ala (95 luokitus) (alempi kk)"
,d15e.opintoala2002 AS "Pohjakoul. opintoala (alempi kk)"
,d15e.koulutusala2002 AS "Pohjakoul. koul.ala (02 luokitus) (alempi kk)"
,d15e.koulutus AS "Pohjakoul. koul.nimike (alempi kk)"
,d15e.koulutusaste2002 as "Pohjakoul. koul.aste (alempi kk)"
,d15f.opintoala1995 AS "Pohjakoul. koul.ala (95 luokitus) (ylempi kk)"
,d15f.opintoala2002 AS "Pohjakoul. opintoala (ylempi kk)"
,d15f.koulutusala2002 AS "Pohjakoul. koul.ala (02 luokitus) (ylempi kk)"
,d15f.koulutus AS "Pohjakoul. koul.nimike (ylempi kk)"
,d15f.koulutusaste2002 as "Pohjakoul. koul.aste (ylempi kk)"
,d15g.opintoala1995 AS "Pohjakoul. koul.ala (95 luokitus)"
,d15g.opintoala2002 AS "Pohjakoul. opintoala"
,d15g.koulutusala2002 AS "Pohjakoul. koul.ala (02 luokitus)"
,d15g.koulutus AS "Pohjakoul. koul.nimike"
,d15g.koulutusaste2002 as "Pohjakoul. koul.aste"
,d15h.opintoala2002 as "Pohjakoul. opintoala2"
,d15i.opintoala1995 as "Pohjakoul. koul.ala (95 luokitus)2"
,d16a.vuosiselite AS "Pohjakoul. suoritusvuosi (lukio)"
,d16b.vuosiselite AS "Pohjakoul. suoritusvuosi (amm)"
,d16c.vuosiselite AS "Pohjakoul. suoritusvuosi (amk)"
,d16d.vuosiselite AS "Pohjakoul. suoritusvuosi (ylempi amk)"
,d16e.vuosiselite AS "Pohjakoul. suoritusvuosi (alempi kk)"
,d16f.vuosiselite AS "Pohjakoul. suoritusvuosi (ylempi kk)"
,d17a.koulutuksesta_kulunut_aika AS "Pohjakoulutuksesta kulunut aika (lukio)"
,d17b.koulutuksesta_kulunut_aika AS "Pohjakoulutuksesta kulunut aika (amm)"
,d17c.koulutuksesta_kulunut_aika AS "Pohjakoulutuksesta kulunut aika (amk)"
,d17d.koulutuksesta_kulunut_aika AS "Pohjakoulutuksesta kulunut aika (ylempi amk)"
,d17e.koulutuksesta_kulunut_aika AS "Pohjakoulutuksesta kulunut aika (alempi kk)"
,d17f.koulutuksesta_kulunut_aika AS "Pohjakoulutuksesta kulunut aika (ylempi kk)"
,d21.koulutusaste2002 as Koulutusaste
,d21.koulutusala2002 as "Koulutusala (02 luokitus)"
,d21.opintoala1995 as "Koulutusala (95 luokitus)"
,d21.opintoala2002 as Opintoala
,d21.koulutus as Koulutusnimike
,d22.avi as "Koulutuksen AVI"
,d22.ely as "Koulutuksen ELY"
,d22.maakunta as "Koulutuksen maakunta"
,d22.kielisuhde as "Koulutuksen kunnan kielisuhde"
,d22.kunta as "Koulutuksen kunta"
,d23.vuosiselite as "Kirjoihintulovuosi"
,d24.lukukausiselite as "Kirjoihintulolukukausi"
,d24b.vuosiselite as "Kirjoihintulovuosi (kk-sektori)"
,d24c.vuosiselite as "Kirjoihintulovuosi (kk-sektori läsna)"
,d24d.vuosiselite as "Kirjoihintulovuosi (sektori)"
,d24e.vuosiselite as "Kirjoihintulovuosi (sektori läsnä)"
,d24f.vuosiselite as "Kirjoihintulovuosi (korkeakoulu)"
,d24g.vuosiselite as "Kirjoihintulovuosi (korkeakoulu läsnä)"
,d24h.vuosiselite as "Kirjoihintulovuosi (opintoala)"
,d24i.vuosiselite as "Kirjoihintulovuosi (opintoala läsnä)"
,d25.aikaisempi_korkein_tutkinto as "Aikaisempi korkein tutkinto"
,d26.avoinvayla as "Avoin väylä"
,d27.vahintaan_45_op_suorittanut as "Suorittanut väh. 45 op"
,d28.vahintaan_55_op_suorittanut as "Suorittanut väh. 55 op"
,d29.opiskelijan_fte_tieto as "Opiskelijan FTE-tieto"
,d30.opiskelumuoto as Opiskelumuoto
,d31.pohjakoulutuksen_tila as "Pohjakoulutuksen tila"
,[aikaisemmin_suoritettu_yotutk] as jarj_aik_yo
,[aikaisemmin_suoritettu_yotutk_tarkempi] as "Aikaisempi lukiokoulutus"
,[yotutk_pohjakoulutuksen_tila] as "Aik. lukiokoul. tila"
,[aikaisemmin_suoritettu_ammtutk] as jarj_aik_amm
,[aikaisemmin_suoritettu_ammtutk_tarkempi] as "Aikaisempi amm. koulutus"
,[ammtutk_pohjakoulutuksen_tila] as "Aik. amm. koulutuksen tila"
,[aikaisemmin_suoritettu_amktutk] as jarj_aik_amk
,[aikaisemmin_suoritettu_amktutk_tarkempi] as "Aikaisempi amk-tutkinto"
,[amktutk_pohjakoulutuksen_tila] as "Aik. amk-tutkinnon tila"
,[aikaisemmin_suoritettu_ylempiamktutk] as jarj_aik_ylempiamk
,[aikaisemmin_suoritettu_ylempiamktutk_tarkempi] as "Aikaisempi ylempi amk-tutkinto"
,[ylempiamktutk_pohjakoulutuksen_tila] as "Aik. ylemmän amk-tutkinnon tila"
,[aikaisemmin_suoritettu_alempikktutk] as jarj_aik_alempikk
,[aikaisemmin_suoritettu_alempikktutk_tarkempi] as "Aikaisempi alempi kk-tutkinto"
,[alempikktutk_pohjakoulutuksen_tila] as "Aik. alemman kk-tutkinnon tila"
,[aikaisemmin_suoritettu_ylempikktutk] as jarj_aik_ylempikk
,[aikaisemmin_suoritettu_ylempikktutk_tarkempi] as "Aikaisempi ylempi kk-tukinto"
,[ylempikktutk_pohjakoulutuksen_tila] as "Aik. ylemmän kk-tutkinnon tila"
,[aiemman_tutkinnon_yotutk_opintoala1995_sama] as "Pohjakoul. koul.ala (95) sama (lukio)"
,[aiemman_tutkinnon_yotutk_opintoala2002_sama] as "Pohjakoul. op.ala sama (lukio)"
,[aiemman_tutkinnon_yotutk_koulutusala2002_sama] as "Pohjakoul. koul.ala (02) sama (lukio)"
,[aiemman_tutkinnon_yotutk_koulutusaste2002_sama] as "Pohjakoul. koul.aste sama (lukio)"
,[aiemman_tutkinnon_ammtutk_opintoala1995_sama] as "Pohjakoul. koul.ala (95) sama (amm)"
,[aiemman_tutkinnon_ammtutk_opintoala2002_sama] as "Pohjakoul. op.ala sama (amm)"
,[aiemman_tutkinnon_ammtutk_koulutusala2002_sama] as "Amm. tutk. sama koul.ala (02)"
,[aiemman_tutkinnon_ammtutk_koulutusaste2002_sama] as "Pohjakoul. koul.aste sama (amm)"
,[aiemman_tutkinnon_amktutk_opintoala1995_sama] as "Pohjakoul. koul.ala (95) sama (amk)"
,[aiemman_tutkinnon_amktutk_opintoala2002_sama] as "Pohjakoul. op.ala sama (amk)"
,[aiemman_tutkinnon_amktutk_koulutusala2002_sama] as "Amk-tutkinto sama koul.ala (02)"
,[aiemman_tutkinnon_amktutk_koulutusaste2002_sama] as "Pohjakoul. koul.aste sama (amk)"
,[aiemman_tutkinnon_ylempiamktutk_opintoala1995_sama] as "Pohjakoul. koul.ala (95) sama (ylempi amk)"
,[aiemman_tutkinnon_ylempiamktutk_opintoala2002_sama] as "Pohjakoul. op.ala sama (ylempi amk)"
,[aiemman_tutkinnon_ylempiamktutk_koulutusala2002_sama] as "Ylempi amk tutk. sama koul.ala (02)"
,[aiemman_tutkinnon_ylempiamktutk_koulutusaste2002_sama] as "Pohjakoul. koul.aste sama (ylempi amk)"
,[aiemman_tutkinnon_alempikktutk_opintoala1995_sama] as "Pohjakoul. koul.ala (95) sama (alempi kk)"
,[aiemman_tutkinnon_alempikktutk_opintoala2002_sama] as "Pohjakoul. op.ala sama (alempi kk)"
,[aiemman_tutkinnon_alempikktutk_koulutusala2002_sama] as "Alempi kk-tutk. sama koul.ala (02)"
,[aiemman_tutkinnon_alempikktutk_koulutusaste2002_sama] as "Pohjakoul. koul.aste sama (alempi kk)"
,[aiemman_tutkinnon_ylempikktutk_opintoala1995_sama] as "Pohjakoul. koul.ala (95) sama (ylempi kk)"
,[aiemman_tutkinnon_ylempikktutk_opintoala2002_sama] as "Pohjakoul. op.ala sama (ylempi kk)"
,[aiemman_tutkinnon_ylempikktutk_koulutusala2002_sama] as "Ylempi kk-tutk. sama koul.ala (02)"
,[aiemman_tutkinnon_ylempikktutk_koulutusaste2002_sama] as "Pohjakoul. koul.aste sama (ylempi kk)"
,[aiemman_tutkinnon_opintoala1995_sama] as "Pohjakoul. koul.ala (95) sama"
,[aiemman_tutkinnon_opintoala2002_sama] as "Pohjakoul. op.ala sama"
,[aiemman_tutkinnon_koulutusala2002_sama] as "Pohjakoul. koul.ala (02) sama"
,[aiemman_tutkinnon_koulutusaste2002_sama] as "Pohjakoul. koul.aste sama"
,d2.jarjestys AS jarj_aidinkieli
,d3.jarjestys_avi AS jarj_as_avi
,d3.jarjestys_ely AS jarj_as_ely
,d3.jarjestys_kielisuhde AS jarj_as_kielisuhde
,d3.jarjestys_maakunta AS jarj_as_maakunta
,d3.jarjestys AS jarj_as_kunta
,d5.jarjestys_ika
,d5.jarjestys_ika5v AS jarj_ika5v
,d5b.jarjestys_ika AS jarj_1565_1v
,d5b.jarjestys_ika5v AS jarj_1565_5v
,d5c.jarjestys_ika AS jarj_1865_1v
,d5c.jarjestys_ika5v AS jarj_1865_5v
,d6.jarjestys_ika5v AS jarj_ikaryhma2
,d7.jarjestys AS jarj_koultyyppi
,d7.koulutustyyppi_koodi
,d8.jarjestys AS jarj_kansalaisuus
,d9.jarjestys_oppilaitos
,d9.jarjestys_opetuskieli
,d9.jarjestys_omistajatyyppi
,d9.jarjestys_oppilaitostyyppi
,d10.lahde_koodi
,d12.jarjestys AS jarj_kirjolosyys
,d12b.jarjestys AS jarj_kirjolotammi
,d13.jarjestys AS jarj_rahoitus
,d14a.jarjestys_oppilaitos AS jarj_pohj_14a_oppil
,d14a.jarjestys_oppilaitostyyppi AS jarj_pohj_14a_oppiltyp
,d14a.jarjestys_opetuskieli AS jarj_pohj_14a_opkiel
,d14a.jarjestys_omistajatyyppi AS jarj_pohj_14a_oppilomist
,d14b.jarjestys_oppilaitos AS jarj_pohj_14b_oppil
,d14b.jarjestys_oppilaitostyyppi AS jarj_pohj_14b_oppiltyp
,d14b.jarjestys_opetuskieli AS jarj_pohj_14b_opkiel
,d14b.jarjestys_omistajatyyppi AS jarj_pohj_14b_oppilomist
,d14c.jarjestys_oppilaitos AS jarj_pohj_14c_oppil
,d14c.jarjestys_oppilaitostyyppi AS jarj_pohj_14c_oppiltyp
,d14c.jarjestys_opetuskieli AS jarj_pohj_14c_opkiel
,d14c.jarjestys_omistajatyyppi AS jarj_pohj_14c_oppilomist
,d14d.jarjestys_oppilaitos AS jarj_pohj_14d_oppil
,d14d.jarjestys_oppilaitostyyppi AS jarj_pohj_14d_oppiltyp
,d14d.jarjestys_opetuskieli AS jarj_pohj_14d_opkiel
,d14d.jarjestys_omistajatyyppi AS jarj_pohj_14d_oppilomist
,d14e.jarjestys_oppilaitos AS jarj_pohj_14e_oppil
,d14e.jarjestys_oppilaitostyyppi AS jarj_pohj_14e_oppiltyp
,d14e.jarjestys_opetuskieli AS jarj_pohj_14e_opkiel
,d14e.jarjestys_omistajatyyppi AS jarj_pohj_14e_oppilomist
,d14f.jarjestys_oppilaitos AS jarj_pohj_14f_oppil
,d14f.jarjestys_oppilaitostyyppi AS jarj_pohj_14f_oppiltyp
,d14f.jarjestys_opetuskieli AS jarj_pohj_14f_opkiel
,d14f.jarjestys_omistajatyyppi AS jarj_pohj_14f_oppilomist
,d15a.jarjestys_opintoala1995 AS jarj_15a_koulala95
,d15a.jarjestys_opintoala2002 AS jarj_15a_opala
,d15a.jarjestys_koulutusala2002 AS jarj_15a_koulala02
,d15a.jarjestys AS jarj_15a_koulnimike
,d15a.jarjestys_koulutusaste2002 AS jarj_15a_koulaste
,d15b.jarjestys_opintoala1995 AS jarj_15b_koulala95
,d15b.jarjestys_opintoala2002 AS jarj_15b_opala
,d15b.jarjestys_koulutusala2002 AS jarj_15b_koulala02
,d15b.jarjestys AS jarj_15b_koulnimike
,d15b.jarjestys_koulutusaste2002 AS jarj_15b_koulaste
,d15c.jarjestys_opintoala1995 AS jarj_15c_koulala95
,d15c.jarjestys_opintoala2002 AS jarj_15c_opala
,d15c.jarjestys_koulutusala2002 AS jarj_15c_koulala02
,d15c.jarjestys AS jarj_15c_koulnimike
,d15c.jarjestys_koulutusaste2002 AS jarj_15c_koulaste
,d15d.jarjestys_opintoala1995 AS jarj_15d_koulala95
,d15d.jarjestys_opintoala2002 AS jarj_15d_opala
,d15d.jarjestys_koulutusala2002 AS jarj_15d_koulala02
,d15d.jarjestys AS jarj_15d_koulnimike
,d15d.jarjestys_koulutusaste2002 AS jarj_15d_koulaste
,d15e.jarjestys_opintoala1995 AS jarj_15e_koulala95
,d15e.jarjestys_opintoala2002 AS jarj_15e_opala
,d15e.jarjestys_koulutusala2002 AS jarj_15e_koulala02
,d15e.jarjestys AS jarj_15e_koulnimike
,d15e.jarjestys_koulutusaste2002 AS jarj_15e_koulaste
,d15f.jarjestys_opintoala1995 AS jarj_15f_koulala95
,d15f.jarjestys_opintoala2002 AS jarj_15f_opala
,d15f.jarjestys_koulutusala2002 AS jarj_15f_koulala02
,d15f.jarjestys AS jarj_15f_koulnimike
,d15f.jarjestys_koulutusaste2002 AS jarj_15f_koulaste
,d15g.jarjestys_opintoala1995 AS jarj_15g_koulala95
,d15g.jarjestys_opintoala2002 AS jarj_15g_opala
,d15g.jarjestys_koulutusala2002 AS jarj_15g_koulala02
,d15g.jarjestys AS jarj_15g_koulnimike
,d15g.jarjestys_koulutusaste2002 AS jarj_15g_koulaste
,d15h.jarjestys_opintoala2002 AS jarj_15h_opala
,d15i.jarjestys_opintoala1995 AS jarj_15i_koulala95
,d17a.jarjestys AS jarj_yo_kulunutaika
,d17b.jarjestys AS jarj_amm_kulunutaika
,d17c.jarjestys AS jarj_amk_kulunutaika
,d17d.jarjestys AS jarj_ylempi_amk_kulunutaika
,d17e.jarjestys AS jarj_alempi_kk_kulunutaika
,d17f.jarjestys AS jarj_ylempi_kk_kulunutaika
,d21.jarjestys_koulutusaste2002
,d21.jarjestys_koulutusala2002
,d21.jarjestys_opintoala1995
,d21.jarjestys_opintoala2002
,d21.jarjestys as jarj_koulnimike
,d22.jarjestys_avi
,d22.jarjestys_ely
,d22.jarjestys_maakunta
,d22.jarjestys_kielisuhde
,d22.jarjestys as jarj_kunta
,d24.jarjestys as jarj_lukukausi
,d25.jarjestys as jarj_aikkorktutkinto
,d26.jarjestys as jarj_avoin
,d27.jarjestys as jarj_vah45
,d28.jarjestys as jarj_vah55
,d29.jarjestys as jarj_op_fte
,d30.jarjestys as jarj_opmuoto
,d31.jarjestys as jarj_pohjkoultila
,d21.koulutusaste2002_koodi AS "Koodit Koulutusaste"
FROM dbo.f_KAK_2_10_Korkeakouluopiskelijoiden_aikaisempi_koulutus
	JOIN d_aidinkieli_versio1 d2 ON d2.id = aidinkieli_versio1_id
	JOIN d_alueluokitus d3 ON d3.id = kotikunta_id
	JOIN d_sukupuoli d4 ON d4.id = sukupuoli_id
	JOIN d_ika d5 ON d5.id = ika_1v_id
	JOIN d_ika d5b ON d5b.id = ika_14_65_id
	JOIN d_ika d5c ON d5c.id = ika_18_65_id
	JOIN d_ika d6 ON d6.id = ika_5v_id
	JOIN d_koulutustyyppi d7 ON d7.id = koulutustyyppi_id
	JOIN d_kansalaisuus_versio2 d8 ON d8.id = kansalaisuus_versio2_id
	JOIN d_oppilaitoksen_taustatiedot d9 ON d9.id = oppilaitoksen_taustatiedot_id
	JOIN d_lahde d10 ON d10.id = lahde_id
	JOIN d_opiskelijan_olo d12 ON d12.id = opiskelijan_olo_syys_id
	JOIN d_opiskelijan_olo_tamm d12b ON d12b.id = opiskelijan_olo_tamm_id
	JOIN d_rahoituslahde d13 ON d13.id = rahoituslahde_id
	JOIN d_oppilaitoksen_taustatiedot d14a ON d14a.id = aikaisemmin_suoritetun_yotutk_oppilaitostiedot_id
	JOIN d_oppilaitoksen_taustatiedot d14b ON d14b.id = aikaisemmin_suoritetun_ammtutk_oppilaitostiedot_id
	JOIN d_oppilaitoksen_taustatiedot d14c ON d14c.id = aikaisemmin_suoritetun_amktutk_oppilaitostiedot_id
	JOIN d_oppilaitoksen_taustatiedot d14d ON d14d.id = aikaisemmin_suoritetun_ylempiamktutk_oppilaitostiedot_id
	JOIN d_oppilaitoksen_taustatiedot d14e ON d14e.id = aikaisemmin_suoritetun_alempikktutk_oppilaitostiedot_id
	JOIN d_oppilaitoksen_taustatiedot d14f ON d14f.id = aikaisemmin_suoritetun_ylempikktutk_oppilaitostiedot_id
	JOIN d_koulutusluokitus d15a ON d15a.id = aikaisemmin_suoritetun_yotutk_koulutustiedot_id
	JOIN d_koulutusluokitus d15b ON d15b.id = aikaisemmin_suoritetun_ammtutk_koulutustiedot_id
	JOIN d_koulutusluokitus d15c ON d15c.id = aikaisemmin_suoritetun_amktutk_koulutustiedot_id
	JOIN d_koulutusluokitus d15d ON d15d.id = aikaisemmin_suoritetun_ylempiamktutk_koulutustiedot_id
	JOIN d_koulutusluokitus d15e ON d15e.id = aikaisemmin_suoritetun_alempikktutk_koulutustiedot_id
	JOIN d_koulutusluokitus d15f ON d15f.id = aikaisemmin_suoritetun_ylempikktutk_koulutustiedot_id
	JOIN d_koulutusluokitus d15g ON d15g.id = opiskelijan_koulutus_edellisvuonna_id
	JOIN d_koulutusluokitus d15h ON d15h.id = opiskelijan_opintoala2002_edellisvuonna_id
	JOIN d_koulutusluokitus d15i ON d15i.id = opiskelijan_opintoala1995_edellisvuonna_id
	JOIN d_kausi d16a ON d16a.kausi_id = aikaisemmin_suoritetun_yotutk_suoritusvuosi_id
	JOIN d_kausi d16b ON d16b.kausi_id = aikaisemmin_suoritetun_ammtutk_suoritusvuosi_id
	JOIN d_kausi d16c ON d16c.kausi_id = aikaisemmin_suoritetun_amktutk_suoritusvuosi_id
	JOIN d_kausi d16d ON d16d.kausi_id = aikaisemmin_suoritetun_ylempiamktutk_suoritusvuosi_id
	JOIN d_kausi d16e ON d16e.kausi_id = aikaisemmin_suoritetun_alempikktutk_suoritusvuosi_id
	JOIN d_kausi d16f ON d16f.kausi_id = aikaisemmin_suoritetun_ylempikktutk_suoritusvuosi_id
	JOIN d_koulutuksesta_kulunut_aika d17a ON d17a.id = aikaisemmasta_koulutuksesta_yotutk_kulunut_aika_id
	JOIN d_koulutuksesta_kulunut_aika d17b ON d17b.id = aikaisemmasta_koulutuksesta_ammtutk_kulunut_aika_id
	JOIN d_koulutuksesta_kulunut_aika d17c ON d17c.id = aikaisemmasta_koulutuksesta_amktutk_kulunut_aika_id
	JOIN d_koulutuksesta_kulunut_aika d17d ON d17d.id = aikaisemmasta_koulutuksesta_ylamktutk_kulunut_aika_id
	JOIN d_koulutuksesta_kulunut_aika d17e ON d17e.id = aikaisemmasta_koulutuksesta_alkktutk_kulunut_aika_id
	JOIN d_koulutuksesta_kulunut_aika d17f ON d17f.id = aikaisemmasta_koulutuksesta_ylkktutk_kulunut_aika_id
	JOIN d_koulutusluokitus d21 ON d21.id = koulutusluokitus_id
	JOIN d_alueluokitus d22 ON d22.id = koulutuksen_kunta_id
	JOIN d_kausi d23 ON d23.kausi_id = kirjoihintulovuosi_id
	JOIN d_kausi d24 ON d24.kausi_id = kirjoihintulolukukausi_id
	JOIN d_kausi d24b ON d24b.kausi_id = kirjoihintulovuosi_korkeakoulusektori_id
	JOIN d_kausi d24c ON d24c.kausi_id = kirjoihintulovuosi_korkeakoulusektori_lasnaoleva_id
	JOIN d_kausi d24d ON d24d.kausi_id = kirjoihintulovuosi_sektori_id
	JOIN d_kausi d24e ON d24e.kausi_id = kirjoihintulovuosi_sektori_lasnaoleva_id
	JOIN d_kausi d24f ON d24f.kausi_id = kirjoihintulovuosi_korkeakoulu_id
	JOIN d_kausi d24g ON d24g.kausi_id = kirjoihintulovuosi_korkeakoulu_lasnaoleva_id
	JOIN d_kausi d24h ON d24h.kausi_id = kirjoihintulovuosi_opintoala_id
	JOIN d_kausi d24i ON d24i.kausi_id = kirjoihintulovuosi_opintoala_lasnaoleva_id
	JOIN d_aikaisempi_korkein_tutkinto d25 ON d25.id = aikaisempi_korkein_tutkinto_id
	JOIN d_avoinvayla d26 ON d26.id = avoinvayla_id
	JOIN d_vahintaan_45_op_suorittanut d27 ON d27.id = vahintaan_45_op_suorittanut_id
	JOIN d_vahintaan_55_op_suorittanut d28 ON d28.id = vahintaan_55_op_suorittanut_id
	JOIN d_opiskelijan_fte_tieto d29 ON d29.id = opiskelijan_fte_tieto_id
	JOIN d_opiskelumuoto d30 ON d30.id = opiskelumuoto_id
	JOIN d_pohjakoulutuksen_tila d31 ON d31.id = pohjakoulutuksen_tila_id
WHERE d10.lahde_koodi = ''51'' AND d9.oppilaitoskoodi <> ''02557'' AND d9.oppilaitoskoodi <> ''10031'' AND d9.oppilaitoskoodi <> ''02358'' 
--AND d21.koulutusaste2002_koodi <> ''73'' AND d21.koulutusaste2002_koodi <> ''81'' AND d21.koulutusaste2002_koodi <> ''82''














' 
GO
/****** Object:  View [dbo].[v_f_tab_koulutukseen_sijoittuneet_2v_ammatillinen]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_koulutukseen_sijoittuneet_2v_ammatillinen]'))
EXEC dbo.sp_executesql @statement = N'









CREATE VIEW [dbo].[v_f_tab_koulutukseen_sijoittuneet_2v_ammatillinen] AS

Select 
[lkm_int2] = lkm
,[tilastovuosi] AS Tilastovuosi
,d17.tarkastelujakso AS Tarkastelujakso
,d16.sukupuoli AS Sukupuoli
,d2.aidinkieli_versio1 AS Äidinkieli
,d5.ika AS Ikä
,d5b.ika5v AS Ikäryhmä
,d6.tutkintoryhma AS "Tutkintoryhmä"
,d7.koulutus AS "Pohjakoulutus"
,d8.koulutusaste2002 AS "Koul. sijoittuneen koulutusaste"
,d8.koulutusala2002 AS "Koul. sijoittuneen koulutusala"
,d8.opintoala2002 AS "Koul. sijoittuneen opintoala"
,d8.koulutus AS "Koul. sijoittuneen koulutusnimike"
--,d3.kunta AS "Asuinkunta"
--,d3.maakunta AS "Asuinmaakunta"
--,d3.avi AS "Asuinpaikan AVI"
--,d3.ely AS "Asuinpaikan ELY"
--,d3.seutukunta AS "Asuinpaikan seutukunta"
--,d3.suuralue AS "Asuinpaikan suuralue"
--,d3.kuntaryhma AS "Asuinpaikan kuntaryhmä"
--,d3.laani AS "Asuinpaikan lääni"
--,d3.kielisuhde AS "Asuinpaikan kunnan kielisuhde"
,d4.maakunta AS "Koul. sijoittuneen opiskelumaakunta"
--,d4.avi AS "Koul. sijoittuneen opiskelupaikan AVI"
--,d4.ely AS "Koul. sijoittuneen opiskelupaikan ELY"
--,d4.seutukunta AS "Koul. sijoittuneen opiskelupaikan seutukunta"
--,d4.suuralue AS "Koul. sijoittuneen opiskelupaikan suuralue"
--,d4.kuntaryhma AS "Koul. sijoittuneen opiskelupaikan kuntaryhmä"
--,d4.laani AS "Koul. sijoittuneen opiskelupaikan lääni"
,d4b.maakunta AS "Tutkinnon suoritusmaakunta"
--,d4b.avi AS "Tutk. suorituspaikan AVI"
--,d4b.ely AS "Tutk. suorituspaikan ELY"
--,d4b.seutukunta AS "Tutk. suorituspaikan seutukunta"
--,d4b.suuralue AS "Tutk. suorituspaikan suuralue"
--,d4b.kuntaryhma AS "Tutk. suorituspaikan kuntaryhmä"
--,d4b.laani AS "Tutk. suorituspaikan lääni"
,d13.oppilaitos AS "Oppilaitos"
,d13.oppilaitostyyppi AS "Oppilaitostyyppi"
--,d13.oppilaitoksen_omistajatyyppi AS "Oppil. omistajatyyppi"
,d13.opetuskieli AS "Oppil. opetuskieli"
,d13.koulutuksen_jarjestaja AS "Koulutuksen järjestäjä"
--,d13.koulutuksen_jarjestajan_omistajatyyppi AS "Koul. järjestäjän omistajatyyppi"
--,d13.koulutuksen_jarjestajan_kieli AS "Koul. järjestäjän kieli"
--,d13.peruskoulujen_ryhmitys AS "Peruskoulujen ryhmitys"
--,d13.peruskoulujen_vuosilks AS "Peruskoulujen vuosiluokat"
,d14.oppilaitos AS "Koul. sijoittuneen oppilaitos"
--,d14.oppilaitostyyppi AS "Koul. sijoittuneen oppil.tyyppi"
--,d14.oppilaitoksen_omistajatyyppi AS "Koul. sijoittuneen oppil. omistajatyyppi"
--,d14.opetuskieli AS "Koul. sijoittuneen oppil. opetuskieli"
,d14.koulutuksen_jarjestaja AS "Koul. sijoittuneen koul. järjestäjä"
--,d14.koulutuksen_jarjestajan_omistajatyyppi AS "Koul. sijoittuneen koul. järjestäjän omistajatyyppi"
--,d14.koulutuksen_jarjestajan_kieli AS "Koul. sijoittuneen koul. järjestäjän kieli"
--,d14.peruskoulujen_ryhmitys AS "Koul. sijoittuneen peruskoulujen ryhmitys"
--,d14.peruskoulujen_vuosilks AS "Koul. sijoittuneen peruskoulujen vuosiluokat"
,d15.vuosiselite AS "Tutkinnon suoritusvuosi"
,d18.lukukausiselite AS "Tutkinnon suorituslukukausi"
--,d19.vuosiselite AS "Syntymävuosi"
--,d20.pohjoismaa AS "Pohjoismaan kansalainen"
,d21.kansalaisuus_versio1 AS "Kansalaisuus"
--,d22.opetuskieli AS "Opetuskieli"
--,d23.ammatillisen_koulutuksen_koulutuslaji AS "Tutkintotyyppi"
--,d24.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus AS "Järjestämistapa"
--,d25.nuorten_aikuisten_koulutus AS "Nuoret/aikuiset"
--,d26.moninkertainen_haku AS "Koul. sijoittuneiden haut"
--,d27.paaasiallinen_toiminta AS "Pääasiallinen toiminta"
--,d28.ammattiasema AS "Ammattiasema"
,d29.koulutuksen_paattaneiden_toiminta AS "Koul. päättäneiden toiminta"
--,d30.eumaa AS "EU-maan kansalainen"
--,d31.etamaa AS "ETA-maan kansalainen"


--Ruotsi
,[tilastovuosi] AS Statistikår
,d17.tarkastelujakso_SV AS Granskningsperiod
,d16.sukupuoli_SV AS Kön
,d2.aidinkieli_versio1_SV AS Modersmål
,d5.ika_SV AS Ålder
,d5b.ika5v_SV AS Åldersgrupp
,d6.tutkintoryhma_SV AS "Examenskategori"
,d7.koulutus_SV AS "Grundutbildning"
,d8.koulutusaste2002_SV AS "Placering i utbildning – utbildningsnivå"
,d8.koulutusala2002_SV AS "Placering i utbildning – utbildningsområde"
,d8.opintoala2002_SV AS "Placering i utbildning – studieområde"
,d8.koulutus_SV AS "Placering i utbildning – utbildningsbenämning"
--,d3.kunta_SV AS "Bostadskommun"
--,d3.maakunta_SV AS "Bostadslandskap"
--,d3.avi_SV AS "Bostadsortens RFV-område"
--,d3.ely_SV AS "Bostadsortens NTM-område"
--,d3.seutukunta_SV AS "Bostadsortens ekonomisk region"
--,d3.suuralue_SV AS "Bostadsortens storområde"
--,d3.kuntaryhma_SV AS "Bostadsortens kommungrupp"
--,d3.laani_SV AS "Bostadsortens län"
--,d3.kielisuhde_SV AS "Bostadskommuns språkliga indelning"
,d4.maakunta_SV AS "Placering i utbildning – landskapet för studieplatsen"
--,d4.avi_SV AS "RFV-område där studierna bedrivs"
--,d4.ely_SV AS "NTM-område där studierna bedrivs"
--,d4.seutukunta_SV AS "Ekonomisk region där studierna bedrivs"
--,d4.suuralue_SV AS "Storområde där studierna bedrivs"
--,d4.kuntaryhma_SV AS "Kommungruppen där studierna bedrivs"
--,d4.laani_SV AS "Län där studierna bedrivs"
,d4b.maakunta_SV AS "Landskap där examen avlagts"
--,d4b.avi_SV AS "RFV-område där examen avlagts"
--,d4b.ely_SV AS "NMT-område där examen avlagts"
--,d4b.seutukunta_SV AS "Ekonomisk region där examen avlagts"
--,d4b.suuralue_SV AS "Storområde där examen avlagts"
--,d4b.kuntaryhma_SV AS "Kommungrupp där examen avlagts"
--,d4b.laani_SV AS "Län där examen avlagts"
,d13.oppilaitos_SV AS "Läroanstalt"
,d13.oppilaitostyyppi_SV AS "Läroanstaltstyp"
--,d13.oppilaitoksen_omistajatyyppi_SV AS "Läroanstaltens ägartyp"
,d13.opetuskieli_SV AS "Läroanstaltens undervisningsspråk"
,d13.koulutuksen_jarjestaja_SV AS "Utbildningsordnare"
--,d13.koulutuksen_jarjestajan_omistajatyyppi_SV AS "Utbildningsanordnarens ägartyp"
--,d13.koulutuksen_jarjestajan_kieli_SV AS "Utbildningsanordnarens språk"
--,d13.peruskoulujen_ryhmitys_SV AS "Peruskoulujen ryhmitysSV"
--,d13.peruskoulujen_vuosilks_SV AS "Årsklasser"
,d14.oppilaitos_SV AS "Placering i utbildning – läroanstalt"
--,d14.oppilaitostyyppi_SV AS "Koul. sijoittuneen oppil.tyyppiSV"
--,d14.oppilaitoksen_omistajatyyppi_SV AS "Koul. sijoittuneen oppil. omistajatyyppiSV"
--,d14.opetuskieli_SV AS "Koul. sijoittuneen oppil. opetuskieliSV"
,d14.koulutuksen_jarjestaja_SV AS "Placering i utbildning – utbildningsanordnare"
--,d14.koulutuksen_jarjestajan_omistajatyyppi_SV AS "Koul. sijoittuneen koul. järjestäjän omistajatyyppiSV"
--,d14.koulutuksen_jarjestajan_kieli_SV AS "Koul. sijoittuneen koul. järjestäjän kieliSV"
--,d14.peruskoulujen_ryhmitys_SV AS "Koul. sijoittuneen peruskoulujen ryhmitysSV"
--,d14.peruskoulujen_vuosilks_SV AS "Koul. sijoittuneen peruskoulujen vuosiluokatSV"
,d15.vuosiselite_SV AS "År då utbildningen avlagts"
,d18.lukukausiselite_SV AS "Termin då utbildningen avlagts"
--,d19.vuosiselite_SV AS "Födelseår"
--,d20.pohjoismaa_SV AS "Medborgare i ett nordiskt land"
,d21.kansalaisuus_versio1_SV AS "Medborgarskap"
--,d22.opetuskieli_SV AS "Undervisningspråk"
--,d23.ammatillisen_koulutuksen_koulutuslaji_SV AS "Typ av examen"
--,d24.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_SV AS "Sättet på vilket utbildningen ordnas"
--,d25.nuorten_aikuisten_koulutus_SV AS "Ungdoms-/vuxenutbildning"
--,d26.moninkertainen_haku_SV AS "Koul. sijoittuneiden hautSV"
--,d27.paaasiallinen_toiminta_SV AS "Huvudsaklig verksamhet"
--,d28.ammattiasema_SV AS "Yrkesställning"
,d29.koulutuksen_paattaneiden_toiminta_SV AS "Sysselsättning av utexaminerade"
--,d30.eumaa_SV AS "Medborgare i ett EU-land"
--,d31.etamaa_SV AS "Medborgare i ett EES-land"

--Englanti
,[tilastovuosi] AS [Statistical year]
,d17.tarkastelujakso_EN AS [Reference period]
,d16.sukupuoli_EN AS Gender
,d2.aidinkieli_versio1_EN AS [Mother tongue]
,d5.ika_EN AS Age
,d5b.ika5v_EN AS [Age group]
,d6.tutkintoryhma_EN AS [Degree/Qualification group]
,d7.koulutus_EN AS [Previous education]
,d8.koulutusaste2002_EN AS "Placed in further ed. - level of education"
,d8.koulutusala2002_EN AS "Placed in further ed. - field of education"
,d8.opintoala2002_EN AS "Placed in further ed. - subfield of education"
,d8.koulutus_EN AS "Placed in further ed. - name of education"
--,d3.kunta_EN AS [Municipality of residence]
--,d3.maakunta_EN AS [Region of residence]
--,d3.avi_EN AS [AVI area of the place of residence]
--,d3.ely_EN AS [ELY area of the place of residence]
--,d3.seutukunta_EN AS [Subregion of the place of residence]
--,d3.suuralue_EN AS [Major region of the place of residence]
--,d3.kuntaryhma_EN AS [Municipality group of the place of residence]
--,d3.laani_EN AS [Province of the place of residence]
--,d3.kielisuhde_EN AS [Municipality''s lang. distribution of the place of residence]
,d4.maakunta_EN AS [Placed in further ed. - region]
--,d4.avi_EN AS [Placed in further ed. - AVI area]
--,d4.ely_EN AS [Placed in further ed. - ELY area]
--,d4.seutukunta_EN AS [Placed in further ed. - subregion]
--,d4.suuralue_EN AS [Placed in further ed. - major region]
--,d4.kuntaryhma_EN AS [Placed in further ed. - municipality group]
--,d4.laani_EN AS [Placed in further ed. - province]
,d4b.maakunta_EN AS [Region of degree/qualification]
--,d4b.avi_EN AS [AVI area of degree/qualification]
--,d4b.ely_EN AS [ELY area of degree/qualification]
--,d4b.seutukunta_EN AS [Subregion of degree/qualification]
--,d4b.suuralue_EN AS [Major region of degree/qualification]
--,d4b.kuntaryhma_EN AS [Municipality group of degree/qualification]
--,d4b.laani_EN AS [Province of degree/qualification]
,d13.oppilaitos_EN AS [Educational institution]
,d13.oppilaitostyyppi_EN AS [Type of institution]
--,d13.oppilaitoksen_omistajatyyppi_EN AS [Type of institution owner]
,d13.opetuskieli_EN AS [Language of the institution]
,d13.koulutuksen_jarjestaja_EN AS [Education provider]
--,d13.koulutuksen_jarjestajan_omistajatyyppi_EN AS [Type of education provider owner]
--,d13.koulutuksen_jarjestajan_kieli_EN AS [Language of the education provider]
--,d13.peruskoulujen_ryhmitys_EN AS [Peruskoulujen ryhmitysEN]
--,d13.peruskoulujen_vuosilks_EN AS [Year groups]
,d14.oppilaitos_EN AS "Placed in further ed. - ed. institution"
--,d14.oppilaitostyyppi_EN AS "Placed in further ed. - type of institution"
--,d14.oppilaitoksen_omistajatyyppi_EN AS "Placed in further ed. - type of institution owner"
--,d14.opetuskieli_EN AS "Placed in further ed. - language of institution"
,d14.koulutuksen_jarjestaja_EN AS "Placed in further ed. - education provider"
--,d14.koulutuksen_jarjestajan_omistajatyyppi_EN AS "Placed in further ed. - type of ed. provider owner"
--,d14.koulutuksen_jarjestajan_kieli_EN AS "Placed in further ed. - language of ed. provider"
--,d14.peruskoulujen_ryhmitys_EN AS "Koul. sijoittuneen peruskoulujen ryhmitysEN"
--,d14.peruskoulujen_vuosilks_EN AS "Koul. sijoittuneen peruskoulujen vuosiluokatEN"
,d15.vuosiselite_EN AS [Graduation year]
,d18.lukukausiselite_EN AS [Term of graduation]
--,d19.vuosiselite_EN AS [Birth year]
--,d20.pohjoismaa_EN AS [Citizen of a nordic nation]
,d21.kansalaisuus_versio1_EN AS Nationality
--,d22.opetuskieli_EN AS [Language of education]
--,d23.ammatillisen_koulutuksen_koulutuslaji_EN AS [Form of education and training]
--,d24.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_EN AS [Method of vocational education and training]
--,d25.nuorten_aikuisten_koulutus_EN AS "Youth/adult education"
--,d26.moninkertainen_haku_EN AS "Koul. sijoittuneiden hautEN"
--,d27.paaasiallinen_toiminta_EN AS [Main type of activity]
--,d28.ammattiasema_EN AS [Status in employment]
,d29.koulutuksen_paattaneiden_toiminta_EN AS [Completers'' activity]
--,d30.eumaa_EN AS [Citizen of EU nation]
--,d31.etamaa_EN AS [Citizen of EEA nation]

--isced
,d8.iscle2011 as "Koul. sijoittuneen koulutusaste, taso 1"
,d8.Koulutusaste_taso2 as "Koul. sijoittuneen koulutusaste, taso 2"
,d8.iscfibroad2013 as "Koul. sijoittuneen koulutusala, taso 1"
,d8.iscfinarrow2013 as "Koul. sijoittuneen koulutusala, taso 2"
,d8.iscfi2013 as "Koul. sijoittuneen koulutusala, taso 3"
,d8.OKM_ohjauksen_ala as "Koul. sijoittuneen OKM ohjauksen ala, korkeak."
,d8.iscle2011_SV as "Placering i utbildning – utbildn.nivå, nivå 1"
,d8.Koulutusaste_taso2_SV as "Placering i utbildning – utbildn.nivå, nivå 2"
,d8.iscfibroad2013_SV as "Placering i utbildning – utbildn.område, nivå 1"
,d8.iscfinarrow2013_SV as "Placering i utbildning – utbildn.område, nivå 2"
,d8.iscfi2013_SV as "Placering i utbildning – utbildn.område, nivå 3"
,d8.OKM_ohjauksen_ala_SV as "Placering i utbildning – UKM-styrningsområde, högskolor"
,d8.iscle2011_EN as "Placed in further ed. - level of education, tier 1"
,d8.Koulutusaste_taso2_EN as "Placed in further ed. - level of education, tier 2"
,d8.iscfibroad2013_EN as "Placed in further ed. - field of education, tier 1"
,d8.iscfinarrow2013_EN as "Placed in further ed. - field of education, tier 2"
,d8.iscfi2013_EN as "Placed in further ed. - field of education, tier 3"
,d8.OKM_ohjauksen_ala_EN as "Placed in further ed. - field of ed., HE steering"
,d8.jarjestys_iscle2011 as jarj_isced_koulast1
,d8.jarjestys_Koulutusaste_taso2 as jarj_isced_koulast2
,d8.jarjestys_iscfibroad2013 as jarj_isced_koulala1
,d8.jarjestys_iscfinarrow2013 as jarj_isced_koulala2
,d8.jarjestys_iscfi2013 as jarj_isced_koulala3
,d8.jarjestys_OKM_ohjauksen_ala as jarj_isced_okmohjaus1

--koodimuuttujat
,d8.koulutusala2002_koodi as "Koodit Koulutusala 2002"
,d8.opintoala1995_koodi as "Koodit Koulutusala 1995"
,d8.opintoala2002_koodi as "Koodit Opintoala 2002"
,d8.koulutus_koodi as "Koodit Koulutusnimike"
,d8.koulutusaste2002_koodi as "Koodit Koulutusaste 2002"
,d13.oppilaitoskoodi as "Koodit Oppilaitos"
,d14.oppilaitoskoodi as "Koodit Koul. sij. oppilaitos"
,d13.koulutuksen_jarjestajakoodi as "Koodit Koul. järjestäjä"
,d14.koulutuksen_jarjestajakoodi as "Koodit Koul. sij. koul. järjestäjä"
,d4.maakunta_koodi as "Koodit Koul. sij. opiskelumaakunta"
,d4b.maakunta_koodi as "Koodit Tutk. suor.maakunta"
,d8.iscle2011_koodi as "Koodit Koulutusaste, taso 1"
,d8.Koulutusaste_taso2_koodi as "Koodit Koulutusaste, taso 2"
,d8.iscfibroad2013_koodi as "Koodit Koulutusala, taso 1"
,d8.iscfinarrow2013_koodi as "Koodit Koulutusala, taso 2"
,d8.iscfi2013_koodi as "Koodit Koulutusala, taso 3"
,d8.OKM_ohjauksen_ala_koodi as "Koodit OKM ohjauksen ala, korkeak."

--Järjestys
,d17.jarjestys AS tarkastelujakso_jarjestys
,d16.jarjestys AS sukupuoli_jarjestys
,d2.jarjestys AS aidinkieli_jarjestys
,d5.jarjestys_ika
,d5b.jarjestys_ika5v
,d6.jarjestys AS tutkintoryhma_jarjestys
,d7.jarjestys AS jarjestys_pohjakoulutus
,d8.jarjestys_koulutusaste2002 AS jarjestys_sij_koulutusaste2002
,d8.jarjestys_koulutusala2002 AS jarjestys_sij_koulutusala2002
,d8.jarjestys_opintoala2002 AS jarjestys_sij_opintoala
,d8.jarjestys AS jarjestys_sij_koulutusnimike
,d8.koulutusaste2002_koodi AS koulsijka
--,d3.jarjestys AS alueluokitus_jarjestys
--,d3.jarjestys_maakunta
--,d3.jarjestys_avi
--,d3.jarjestys_ely
--,d3.jarjestys_seutukunta
--,d3.jarjestys_suuralue
--,d3.jarjestys_kuntaryhma
--,d3.jarjestys_laani
--,d3.jarjestys_kielisuhde
,d4.jarjestys_maakunta AS sijoittuneen_al_jarjestys_maakunta
--,d4.jarjestys_avi AS sijoittuneen_al_jarjestys_avi
--,d4.jarjestys_ely AS sijoittuneen_al_jarjestys_ely
--,d4.jarjestys_seutukunta AS sijoittuneen_al_jarjestys_seutukunta
--,d4.jarjestys_suuralue AS sijoittuneen_al_jarjestys_suuralue
--,d4.jarjestys_kuntaryhma AS sijoittuneen_al_jarjestys_kuntaryhma
--,d4.jarjestys_laani AS sijoittuneen_al_jarjestys_laani
--,d4.jarjestys_kielisuhde AS sijoittuneen_al_jarjestys_kielisuhde
,d4b.jarjestys_maakunta AS tutksuor_al_jarjestys_maakunta
--,d4b.jarjestys_avi AS tutksuor_al_jarjestys_avi
--,d4b.jarjestys_ely AS tutksuor_al_jarjestys_ely
--,d4b.jarjestys_seutukunta AS tutksuor_al_jarjestys_seutukunta
--,d4b.jarjestys_suuralue AS tutksuor_al_jarjestys_suuralue
--,d4b.jarjestys_kuntaryhma AS tutksuor_al_jarjestys_kuntaryhma
--,d4b.jarjestys_laani AS tutksuor_al_jarjestys_laani
--,d4b.jarjestys_kielisuhde AS tutksuor_al_jarjestys_kielisuhde
--,d13.jarjestys_oppilaitos
,d13.jarjestys_oppilaitostyyppi
--,d13.jarjestys_omistajatyyppi
,d13.jarjestys_opetuskieli
--,d13.jarjestys_koulutuksen_jarjestaja
--,d13.jarjestys_koulutuksen_jarjestajan_kieli
--,d13.jarjestys_peruskoulujen_ryhmitys
--,d13.jarjestys_peruskoulujen_vuosilks
--,d14.jarjestys_oppilaitos AS sijoittuneen_jarjestys_oppilaitos
--,d14.jarjestys_oppilaitostyyppi AS sijoittuneen_jarjestys_oppilaitostyyppi
--,d14.jarjestys_omistajatyyppi AS sijoittuneen_jarjestys_omistajatyyppi
--,d14.jarjestys_opetuskieli AS sijoittuneen_jarjestys_opetuskieli
--,d14.jarjestys_koulutuksen_jarjestaja AS sijoittuneen_jarjestys_koulutuksen_jarjestaja
--,d14.jarjestys_koulutuksen_jarjestajan_kieli AS sijoittuneen_jarjestys_koulutuksen_jarjestajan_kieli
--,d14.jarjestys_peruskoulujen_ryhmitys AS sijoittuneen_peruskoulujen_ryhmitys
--,d14.jarjestys_peruskoulujen_vuosilks AS sijoittuneen_peruskoulujen_vuosilks
,d18.lukukausi AS tutksuor_lukukausi_jarjestys
--,d20.jarjestys AS pohjoismaa_jarjestys
,d21.jarjestys AS kansalaisuus_jarjestys
--,d22.jarjestys AS opetuskieli_jarjestys
--,d23.jarjestys AS tutktyyppi_jarjestys
--,d24.jarjestys AS jarjestamistapa_jarjestys
,d25.jarjestys AS nuoraik_jarjestys
--,d26.jarjestys AS monihaku_jarjestys
--,d27.jarjestys AS paaastoim_jarjestys
--,d28.jarjestys AS ammasema_jarjestys
,d29.jarjestys AS koul_paattaneiden_toiminta_jarjestys
--,d30.jarjestys_eumaa
--,d31.jarjestys_etamaa
,d6.tutkintoryhma_koodi as ryhmakoodi
,d29.koulutuksen_paattaneiden_toiminta_koodi as paattkoodi
,d27.paaasiallinen_toiminta_koodi
,[lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa_ke] AS "Koul. sijoittuneet lukiokoulutuksessa ja ammatillisessa koulutuksessa"
,[lukiokoulutuksessa_ke] AS "Koul. sijoittuneet lukiokoulutuksessa"
,[ammatillisessa_koulutuksessa_ke] AS "Koul. sijoittuneet ammatillisessa koulutuksessa"
,[ammattikorkeakoulutuksessa_ke] AS "Koul. sijoittuneet ammattikorkeakoulutuksessa"
,[yliopistokoulutuksessa_ke] AS "Koul. sijoittuneet yliopistokoulutuksessa"
,[ammattikorkeakoulutuksessa_ja_yliopistokoulutuksessa_ke] AS "Koul. sijoittuneet ammattikorkeakoulutuksessa ja yliopistokoulutuksessa"
,[toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa_ke] AS "Koul. sijoittuneet toisen asteen ammatillisessa koulutuksessa ja korkeakoulutuksessa"
,[lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa]
,[lukiokoulutuksessa]
,[ammatillisessa_koulutuksessa]
,[ammattikorkeakoulutuksessa]
,[yliopistokoulutuksessa]
,[ammattikorkeakoulutuksessa_ja_yliopistokoulutuksessa]
,[toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa]
FROM            dbo.f_koulutukseen_sijoittuneet_2v
	JOIN d_aidinkieli_versio1 d2 ON d2.id = aidinkieli_versio_1_id
	JOIN d_sukupuoli d16 ON d16.id = sukupuoli_id
	JOIN d_tarkastelujakso d17 ON d17.id = tarkastelujakso_id
	JOIN d_alueluokitus d3 ON d3.id = asuinkunta_id
	JOIN d_alueluokitus d4 ON d4.id = koulutukseen_sijoittuneen_maakunta_id
	JOIN d_alueluokitus d4b ON d4b.id = pohjakoulutuksen_tutkinnon_suoritusmaakunta_id
	JOIN d_ika d5 ON d5.id = ika_1v_id
	JOIN d_ika d5b ON d5b.id = ika_5v_id
	JOIN d_tutkintoryhma d6 ON d6.id = tutkintoryhma_id
	JOIN d_koulutusluokitus d7 ON d7.id = pohjakoulutus_id
	JOIN d_koulutusluokitus d8 ON d8.id = koulutukseen_sijoittuneen_koulutus_id
	JOIN d_oppilaitoksen_taustatiedot d13 ON d13.id = pohjakoulutuksen_oppilaitos_id
	JOIN d_oppilaitoksen_taustatiedot d14 ON d14.id = koulutukseen_sijoittuneen_oppilaitos_id
	JOIN d_kausi d15 on d15.kausi_id = suoritusvuosi_id
	JOIN d_kausi d18 on d18.kausi_id = suorituslukukausi_id
	JOIN d_kausi d19 on d19.kausi_id = syntymavuosi_id
	JOIN d_pohjoismaa d20 on d20.id = pohjoismaa_id
	JOIN d_kansalaisuus_versio1 d21 on d21.id = kansalaisuus_id
	JOIN d_opetuskieli d22 on d22.id = pohjakoulutuksen_opetuskieli_id
	JOIN d_ammatillisen_koulutuksen_koulutuslaji d23 on d23.id = pohjakoulutuksen_koulutuslaji_id
	JOIN d_opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus d24 on d24.id = pohjakoulutuksen_tutktav_id
	JOIN d_nuorten_aikuisten_koulutus d25 on d25.id = pohjakoulutuksen_aikoul_id
	JOIN d_moninkertainen_haku d26 on d26.id = moninkertainen_haku_id
	JOIN d_paaasiallinen_toiminta d27 on d27.id = paaasiallinen_toiminta_id
	JOIN d_ammattiasema d28 on d28.id = ammattiasema_id
	JOIN d_koulutuksen_paattaneiden_toiminta d29 on d29.id = koulutuksen_paattaneiden_toiminta_id
	JOIN d_valtio d30 on d30.id = eumaa_id
	JOIN d_valtio d31 on d31.id = etamaa_id
WHERE tutkintoryhma_koodi = 3 AND (d24.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_koodi in (1, -1)) AND d15.vuosiselite <> ''2008''










' 
GO
/****** Object:  View [dbo].[v_f_tab_koulutukseen_sijoittuneet_2v_lukio]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_koulutukseen_sijoittuneet_2v_lukio]'))
EXEC dbo.sp_executesql @statement = N'









CREATE VIEW [dbo].[v_f_tab_koulutukseen_sijoittuneet_2v_lukio] AS

Select 
[lkm_int2] = lkm
,[tilastovuosi] AS Tilastovuosi
,d17.tarkastelujakso AS Tarkastelujakso
,d16.sukupuoli AS Sukupuoli
,d2.aidinkieli_versio1 AS Äidinkieli
,d5.ika AS Ikä
,d5b.ika5v AS Ikäryhmä
,d6.tutkintoryhma AS "Tutkintoryhmä"
,d7.koulutus AS "Pohjakoulutus"
,d8.koulutusaste2002 AS "Koul. sijoittuneen koulutusaste"
,d8.koulutusala2002 AS "Koul. sijoittuneen koulutusala"
,d8.opintoala2002 AS "Koul. sijoittuneen opintoala"
,d8.koulutus AS "Koul. sijoittuneen koulutusnimike"
--,d3.kunta AS "Asuinkunta"
--,d3.maakunta AS "Asuinmaakunta"
--,d3.avi AS "Asuinpaikan AVI"
--,d3.ely AS "Asuinpaikan ELY"
--,d3.seutukunta AS "Asuinpaikan seutukunta"
--,d3.suuralue AS "Asuinpaikan suuralue"
--,d3.kuntaryhma AS "Asuinpaikan kuntaryhmä"
--,d3.laani AS "Asuinpaikan lääni"
--,d3.kielisuhde AS "Asuinpaikan kunnan kielisuhde"
,d4.maakunta AS "Koul. sijoittuneen opiskelumaakunta"
--,d4.avi AS "Koul. sijoittuneen opiskelupaikan AVI"
--,d4.ely AS "Koul. sijoittuneen opiskelupaikan ELY"
--,d4.seutukunta AS "Koul. sijoittuneen opiskelupaikan seutukunta"
--,d4.suuralue AS "Koul. sijoittuneen opiskelupaikan suuralue"
--,d4.kuntaryhma AS "Koul. sijoittuneen opiskelupaikan kuntaryhmä"
--,d4.laani AS "Koul. sijoittuneen opiskelupaikan lääni"
,d4b.maakunta AS "Tutkinnon suoritusmaakunta"
--,d4b.avi AS "Tutk. suorituspaikan AVI"
--,d4b.ely AS "Tutk. suorituspaikan ELY"
--,d4b.seutukunta AS "Tutk. suorituspaikan seutukunta"
--,d4b.suuralue AS "Tutk. suorituspaikan suuralue"
--,d4b.kuntaryhma AS "Tutk. suorituspaikan kuntaryhmä"
--,d4b.laani AS "Tutk. suorituspaikan lääni"
,d13.oppilaitos AS "Oppilaitos"
,d13.oppilaitostyyppi AS "Oppilaitostyyppi"
--,d13.oppilaitoksen_omistajatyyppi AS "Oppil. omistajatyyppi"
,d13.opetuskieli AS "Oppil. opetuskieli"
,d13.koulutuksen_jarjestaja AS "Koulutuksen järjestäjä"
--,d13.koulutuksen_jarjestajan_omistajatyyppi AS "Koul. järjestäjän omistajatyyppi"
--,d13.koulutuksen_jarjestajan_kieli AS "Koul. järjestäjän kieli"
--,d13.peruskoulujen_ryhmitys AS "Peruskoulujen ryhmitys"
--,d13.peruskoulujen_vuosilks AS "Peruskoulujen vuosiluokat"
,d14.oppilaitos AS "Koul. sijoittuneen oppilaitos"
--,d14.oppilaitostyyppi AS "Koul. sijoittuneen oppil.tyyppi"
--,d14.oppilaitoksen_omistajatyyppi AS "Koul. sijoittuneen oppil. omistajatyyppi"
--,d14.opetuskieli AS "Koul. sijoittuneen oppil. opetuskieli"
,d14.koulutuksen_jarjestaja AS "Koul. sijoittuneen koul. järjestäjä"
--,d14.koulutuksen_jarjestajan_omistajatyyppi AS "Koul. sijoittuneen koul. järjestäjän omistajatyyppi"
--,d14.koulutuksen_jarjestajan_kieli AS "Koul. sijoittuneen koul. järjestäjän kieli"
--,d14.peruskoulujen_ryhmitys AS "Koul. sijoittuneen peruskoulujen ryhmitys"
--,d14.peruskoulujen_vuosilks AS "Koul. sijoittuneen peruskoulujen vuosiluokat"
,d15.vuosiselite AS "Tutkinnon suoritusvuosi"
,d18.lukukausiselite AS "Tutkinnon suorituslukukausi"
--,d19.vuosiselite AS "Syntymävuosi"
--,d20.pohjoismaa AS "Pohjoismaan kansalainen"
,d21.kansalaisuus_versio1 AS "Kansalaisuus"
--,d22.opetuskieli AS "Opetuskieli"
--,d23.ammatillisen_koulutuksen_koulutuslaji AS "Tutkintotyyppi"
--,d24.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus AS "Järjestämistapa"
,d25.nuorten_aikuisten_koulutus AS "Nuoret/aikuiset"
--,d26.moninkertainen_haku AS "Koul. sijoittuneiden haut"
--,d27.paaasiallinen_toiminta AS "Pääasiallinen toiminta"
--,d28.ammattiasema AS "Ammattiasema"
,d29.koulutuksen_paattaneiden_toiminta AS "Koul. päättäneiden toiminta"
--,d30.eumaa AS "EU-maan kansalainen"
--,d31.etamaa AS "ETA-maan kansalainen"


--Ruotsi
,[tilastovuosi] AS Statistikår
,d17.tarkastelujakso_SV AS Granskningsperiod
,d16.sukupuoli_SV AS Kön
,d2.aidinkieli_versio1_SV AS Modersmål
,d5.ika_SV AS Ålder
,d5b.ika5v_SV AS Åldersgrupp
,d6.tutkintoryhma_SV AS "Examenskategori"
,d7.koulutus_SV AS "Grundutbildning"
,d8.koulutusaste2002_SV AS "Placering i utbildning – utbildningsnivå"
,d8.koulutusala2002_SV AS "Placering i utbildning – utbildningsområde"
,d8.opintoala2002_SV AS "Placering i utbildning – studieområde"
,d8.koulutus_SV AS "Placering i utbildning – utbildningsbenämning"
--,d3.kunta_SV AS "Bostadskommun"
--,d3.maakunta_SV AS "Bostadslandskap"
--,d3.avi_SV AS "Bostadsortens RFV-område"
--,d3.ely_SV AS "Bostadsortens NTM-område"
--,d3.seutukunta_SV AS "Bostadsortens ekonomisk region"
--,d3.suuralue_SV AS "Bostadsortens storområde"
--,d3.kuntaryhma_SV AS "Bostadsortens kommungrupp"
--,d3.laani_SV AS "Bostadsortens län"
--,d3.kielisuhde_SV AS "Bostadskommuns språkliga indelning"
,d4.maakunta_SV AS "Placering i utbildning – landskapet för studieplatsen"
--,d4.avi_SV AS "RFV-område där studierna bedrivs"
--,d4.ely_SV AS "NTM-område där studierna bedrivs"
--,d4.seutukunta_SV AS "Ekonomisk region där studierna bedrivs"
--,d4.suuralue_SV AS "Storområde där studierna bedrivs"
--,d4.kuntaryhma_SV AS "Kommungruppen där studierna bedrivs"
--,d4.laani_SV AS "Län där studierna bedrivs"
,d4b.maakunta_SV AS "Landskap där examen avlagts"
--,d4b.avi_SV AS "RFV-område där examen avlagts"
--,d4b.ely_SV AS "NMT-område där examen avlagts"
--,d4b.seutukunta_SV AS "Ekonomisk region där examen avlagts"
--,d4b.suuralue_SV AS "Storområde där examen avlagts"
--,d4b.kuntaryhma_SV AS "Kommungrupp där examen avlagts"
--,d4b.laani_SV AS "Län där examen avlagts"
,d13.oppilaitos_SV AS "Läroanstalt"
,d13.oppilaitostyyppi_SV AS "Läroanstaltstyp"
--,d13.oppilaitoksen_omistajatyyppi_SV AS "Läroanstaltens ägartyp"
,d13.opetuskieli_SV AS "Läroanstaltens undervisningsspråk"
,d13.koulutuksen_jarjestaja_SV AS "Utbildningsordnare"
--,d13.koulutuksen_jarjestajan_omistajatyyppi_SV AS "Utbildningsanordnarens ägartyp"
--,d13.koulutuksen_jarjestajan_kieli_SV AS "Utbildningsanordnarens språk"
--,d13.peruskoulujen_ryhmitys_SV AS "Peruskoulujen ryhmitysSV"
--,d13.peruskoulujen_vuosilks_SV AS "Årsklasser"
,d14.oppilaitos_SV AS "Placering i utbildning – läroanstalt"
--,d14.oppilaitostyyppi_SV AS "Koul. sijoittuneen oppil.tyyppiSV"
--,d14.oppilaitoksen_omistajatyyppi_SV AS "Koul. sijoittuneen oppil. omistajatyyppiSV"
--,d14.opetuskieli_SV AS "Koul. sijoittuneen oppil. opetuskieliSV"
,d14.koulutuksen_jarjestaja_SV AS "Placering i utbildning – utbildningsanordnare"
--,d14.koulutuksen_jarjestajan_omistajatyyppi_SV AS "Koul. sijoittuneen koul. järjestäjän omistajatyyppiSV"
--,d14.koulutuksen_jarjestajan_kieli_SV AS "Koul. sijoittuneen koul. järjestäjän kieliSV"
--,d14.peruskoulujen_ryhmitys_SV AS "Koul. sijoittuneen peruskoulujen ryhmitysSV"
--,d14.peruskoulujen_vuosilks_SV AS "Koul. sijoittuneen peruskoulujen vuosiluokatSV"
,d15.vuosiselite_SV AS "År då utbildningen avlagts"
,d18.lukukausiselite_SV AS "Termin då utbildningen avlagts"
--,d19.vuosiselite_SV AS "Födelseår"
--,d20.pohjoismaa_SV AS "Medborgare i ett nordiskt land"
,d21.kansalaisuus_versio1_SV AS "Medborgarskap"
--,d22.opetuskieli_SV AS "Undervisningspråk"
--,d23.ammatillisen_koulutuksen_koulutuslaji_SV AS "Typ av examen"
--,d24.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_SV AS "Sättet på vilket utbildningen ordnas"
,d25.nuorten_aikuisten_koulutus_SV AS "Ungdoms-/vuxenutbildning"
--,d26.moninkertainen_haku_SV AS "Koul. sijoittuneiden hautSV"
--,d27.paaasiallinen_toiminta_SV AS "Huvudsaklig verksamhet"
--,d28.ammattiasema_SV AS "Yrkesställning"
,d29.koulutuksen_paattaneiden_toiminta_SV AS "Sysselsättning av utexaminerade"
--,d30.eumaa_SV AS "Medborgare i ett EU-land"
--,d31.etamaa_SV AS "Medborgare i ett EES-land"

--Englanti
,[tilastovuosi] AS [Statistical year]
,d17.tarkastelujakso_EN AS [Reference period]
,d16.sukupuoli_EN AS Gender
,d2.aidinkieli_versio1_EN AS [Mother tongue]
,d5.ika_EN AS Age
,d5b.ika5v_EN AS [Age group]
,d6.tutkintoryhma_EN AS [Degree/Qualification group]
,d7.koulutus_EN AS [Previous education]
,d8.koulutusaste2002_EN AS "Placed in further ed. - level of education"
,d8.koulutusala2002_EN AS "Placed in further ed. - field of education"
,d8.opintoala2002_EN AS "Placed in further ed. - subfield of education"
,d8.koulutus_EN AS "Placed in further ed. - name of education"
--,d3.kunta_EN AS [Municipality of residence]
--,d3.maakunta_EN AS [Region of residence]
--,d3.avi_EN AS [AVI area of the place of residence]
--,d3.ely_EN AS [ELY area of the place of residence]
--,d3.seutukunta_EN AS [Subregion of the place of residence]
--,d3.suuralue_EN AS [Major region of the place of residence]
--,d3.kuntaryhma_EN AS [Municipality group of the place of residence]
--,d3.laani_EN AS [Province of the place of residence]
--,d3.kielisuhde_EN AS [Municipality''s lang. distribution of the place of residence]
,d4.maakunta_EN AS [Placed in further ed. - region]
--,d4.avi_EN AS [Placed in further ed. - AVI area]
--,d4.ely_EN AS [Placed in further ed. - ELY area]
--,d4.seutukunta_EN AS [Placed in further ed. - subregion]
--,d4.suuralue_EN AS [Placed in further ed. - major region]
--,d4.kuntaryhma_EN AS [Placed in further ed. - municipality group]
--,d4.laani_EN AS [Placed in further ed. - province]
,d4b.maakunta_EN AS [Region of degree/qualification]
--,d4b.avi_EN AS [AVI area of degree/qualification]
--,d4b.ely_EN AS [ELY area of degree/qualification]
--,d4b.seutukunta_EN AS [Subregion of degree/qualification]
--,d4b.suuralue_EN AS [Major region of degree/qualification]
--,d4b.kuntaryhma_EN AS [Municipality group of degree/qualification]
--,d4b.laani_EN AS [Province of degree/qualification]
,d13.oppilaitos_EN AS [Educational institution]
,d13.oppilaitostyyppi_EN AS [Type of institution]
--,d13.oppilaitoksen_omistajatyyppi_EN AS [Type of institution owner]
,d13.opetuskieli_EN AS [Language of the institution]
,d13.koulutuksen_jarjestaja_EN AS [Education provider]
--,d13.koulutuksen_jarjestajan_omistajatyyppi_EN AS [Type of education provider owner]
--,d13.koulutuksen_jarjestajan_kieli_EN AS [Language of the education provider]
--,d13.peruskoulujen_ryhmitys_EN AS [Peruskoulujen ryhmitysEN]
--,d13.peruskoulujen_vuosilks_EN AS [Year groups]
,d14.oppilaitos_EN AS "Placed in further ed. - ed. institution"
--,d14.oppilaitostyyppi_EN AS "Placed in further ed. - type of institution"
--,d14.oppilaitoksen_omistajatyyppi_EN AS "Placed in further ed. - type of institution owner"
--,d14.opetuskieli_EN AS "Placed in further ed. - language of institution"
,d14.koulutuksen_jarjestaja_EN AS "Placed in further ed. - education provider"
--,d14.koulutuksen_jarjestajan_omistajatyyppi_EN AS "Placed in further ed. - type of ed. provider owner"
--,d14.koulutuksen_jarjestajan_kieli_EN AS "Placed in further ed. - language of ed. provider"
--,d14.peruskoulujen_ryhmitys_EN AS "Koul. sijoittuneen peruskoulujen ryhmitysEN"
--,d14.peruskoulujen_vuosilks_EN AS "Koul. sijoittuneen peruskoulujen vuosiluokatEN"
,d15.vuosiselite_EN AS [Graduation year]
,d18.lukukausiselite_EN AS [Term of graduation]
--,d19.vuosiselite_EN AS [Birth year]
--,d20.pohjoismaa_EN AS [Citizen of a nordic nation]
,d21.kansalaisuus_versio1_EN AS Nationality
--,d22.opetuskieli_EN AS [Language of education]
--,d23.ammatillisen_koulutuksen_koulutuslaji_EN AS [Form of education and training]
--,d24.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_EN AS [Method of vocational education and training]
,d25.nuorten_aikuisten_koulutus_EN AS "Youth/adult education"
--,d26.moninkertainen_haku_EN AS "Koul. sijoittuneiden hautEN"
--,d27.paaasiallinen_toiminta_EN AS [Main type of activity]
--,d28.ammattiasema_EN AS [Status in employment]
,d29.koulutuksen_paattaneiden_toiminta_EN AS [Completers'' activity]
--,d30.eumaa_EN AS [Citizen of EU nation]
--,d31.etamaa_EN AS [Citizen of EEA nation]

--isced
,d8.iscle2011 as "Koul. sijoittuneen koulutusaste, taso 1"
,d8.Koulutusaste_taso2 as "Koul. sijoittuneen koulutusaste, taso 2"
,d8.iscfibroad2013 as "Koul. sijoittuneen koulutusala, taso 1"
,d8.iscfinarrow2013 as "Koul. sijoittuneen koulutusala, taso 2"
,d8.iscfi2013 as "Koul. sijoittuneen koulutusala, taso 3"
,d8.OKM_ohjauksen_ala as "Koul. sijoittuneen OKM ohjauksen ala, korkeak."
,d8.iscle2011_SV as "Placering i utbildning – utbildn.nivå, nivå 1"
,d8.Koulutusaste_taso2_SV as "Placering i utbildning – utbildn.nivå, nivå 2"
,d8.iscfibroad2013_SV as "Placering i utbildning – utbildn.område, nivå 1"
,d8.iscfinarrow2013_SV as "Placering i utbildning – utbildn.område, nivå 2"
,d8.iscfi2013_SV as "Placering i utbildning – utbildn.område, nivå 3"
,d8.OKM_ohjauksen_ala_SV as "Placering i utbildning – UKM-styrningsområde, högskolor"
,d8.iscle2011_EN as "Placed in further ed. - level of education, tier 1"
,d8.Koulutusaste_taso2_EN as "Placed in further ed. - level of education, tier 2"
,d8.iscfibroad2013_EN as "Placed in further ed. - field of education, tier 1"
,d8.iscfinarrow2013_EN as "Placed in further ed. - field of education, tier 2"
,d8.iscfi2013_EN as "Placed in further ed. - field of education, tier 3"
,d8.OKM_ohjauksen_ala_EN as "Placed in further ed. - field of ed., HE steering"
,d8.jarjestys_iscle2011 as jarj_isced_koulast1
,d8.jarjestys_Koulutusaste_taso2 as jarj_isced_koulast2
,d8.jarjestys_iscfibroad2013 as jarj_isced_koulala1
,d8.jarjestys_iscfinarrow2013 as jarj_isced_koulala2
,d8.jarjestys_iscfi2013 as jarj_isced_koulala3
,d8.jarjestys_OKM_ohjauksen_ala as jarj_isced_okmohjaus1

--koodimuuttujat
,d8.koulutusala2002_koodi as "Koodit Koulutusala 2002"
,d8.opintoala1995_koodi as "Koodit Koulutusala 1995"
,d8.opintoala2002_koodi as "Koodit Opintoala 2002"
,d8.koulutus_koodi as "Koodit Koulutusnimike"
,d8.koulutusaste2002_koodi as "Koodit Koulutusaste 2002"
,d13.oppilaitoskoodi as "Koodit Oppilaitos"
,d14.oppilaitoskoodi as "Koodit Koul. sij. oppilaitos"
,d13.koulutuksen_jarjestajakoodi as "Koodit Koul. järjestäjä"
,d14.koulutuksen_jarjestajakoodi as "Koodit Koul. sij. koul. järjestäjä"
,d4.maakunta_koodi as "Koodit Koul. sij. opiskelumaakunta"
,d4b.maakunta_koodi as "Koodit Tutk. suor.maakunta"
,d8.iscle2011_koodi as "Koodit Koulutusaste, taso 1"
,d8.Koulutusaste_taso2_koodi as "Koodit Koulutusaste, taso 2"
,d8.iscfibroad2013_koodi as "Koodit Koulutusala, taso 1"
,d8.iscfinarrow2013_koodi as "Koodit Koulutusala, taso 2"
,d8.iscfi2013_koodi as "Koodit Koulutusala, taso 3"
,d8.OKM_ohjauksen_ala_koodi as "Koodit OKM ohjauksen ala, korkeak."

--Järjestys
,d17.jarjestys AS tarkastelujakso_jarjestys
,d16.jarjestys AS sukupuoli_jarjestys
,d2.jarjestys AS aidinkieli_jarjestys
,d5.jarjestys_ika
,d5b.jarjestys_ika5v
,d6.jarjestys AS tutkintoryhma_jarjestys
,d7.jarjestys AS jarjestys_pohjakoulutus
,d8.jarjestys_koulutusaste2002 AS jarjestys_sij_koulutusaste2002
,d8.jarjestys_koulutusala2002 AS jarjestys_sij_koulutusala2002
,d8.jarjestys_opintoala2002 AS jarjestys_sij_opintoala
,d8.jarjestys AS jarjestys_sij_koulutusnimike
,d8.koulutusaste2002_koodi AS koulsijka
--,d3.jarjestys AS alueluokitus_jarjestys
--,d3.jarjestys_maakunta
--,d3.jarjestys_avi
--,d3.jarjestys_ely
--,d3.jarjestys_seutukunta
--,d3.jarjestys_suuralue
--,d3.jarjestys_kuntaryhma
--,d3.jarjestys_laani
--,d3.jarjestys_kielisuhde
,d4.jarjestys_maakunta AS sijoittuneen_al_jarjestys_maakunta
--,d4.jarjestys_avi AS sijoittuneen_al_jarjestys_avi
--,d4.jarjestys_ely AS sijoittuneen_al_jarjestys_ely
--,d4.jarjestys_seutukunta AS sijoittuneen_al_jarjestys_seutukunta
--,d4.jarjestys_suuralue AS sijoittuneen_al_jarjestys_suuralue
--,d4.jarjestys_kuntaryhma AS sijoittuneen_al_jarjestys_kuntaryhma
--,d4.jarjestys_laani AS sijoittuneen_al_jarjestys_laani
--,d4.jarjestys_kielisuhde AS sijoittuneen_al_jarjestys_kielisuhde
,d4b.jarjestys_maakunta AS tutksuor_al_jarjestys_maakunta
--,d4b.jarjestys_avi AS tutksuor_al_jarjestys_avi
--,d4b.jarjestys_ely AS tutksuor_al_jarjestys_ely
--,d4b.jarjestys_seutukunta AS tutksuor_al_jarjestys_seutukunta
--,d4b.jarjestys_suuralue AS tutksuor_al_jarjestys_suuralue
--,d4b.jarjestys_kuntaryhma AS tutksuor_al_jarjestys_kuntaryhma
--,d4b.jarjestys_laani AS tutksuor_al_jarjestys_laani
--,d4b.jarjestys_kielisuhde AS tutksuor_al_jarjestys_kielisuhde
--,d13.jarjestys_oppilaitos
,d13.jarjestys_oppilaitostyyppi
--,d13.jarjestys_omistajatyyppi
,d13.jarjestys_opetuskieli
--,d13.jarjestys_koulutuksen_jarjestaja
--,d13.jarjestys_koulutuksen_jarjestajan_kieli
--,d13.jarjestys_peruskoulujen_ryhmitys
--,d13.jarjestys_peruskoulujen_vuosilks
--,d14.jarjestys_oppilaitos AS sijoittuneen_jarjestys_oppilaitos
--,d14.jarjestys_oppilaitostyyppi AS sijoittuneen_jarjestys_oppilaitostyyppi
--,d14.jarjestys_omistajatyyppi AS sijoittuneen_jarjestys_omistajatyyppi
--,d14.jarjestys_opetuskieli AS sijoittuneen_jarjestys_opetuskieli
--,d14.jarjestys_koulutuksen_jarjestaja AS sijoittuneen_jarjestys_koulutuksen_jarjestaja
--,d14.jarjestys_koulutuksen_jarjestajan_kieli AS sijoittuneen_jarjestys_koulutuksen_jarjestajan_kieli
--,d14.jarjestys_peruskoulujen_ryhmitys AS sijoittuneen_peruskoulujen_ryhmitys
--,d14.jarjestys_peruskoulujen_vuosilks AS sijoittuneen_peruskoulujen_vuosilks
,d18.lukukausi AS tutksuor_lukukausi_jarjestys
--,d20.jarjestys AS pohjoismaa_jarjestys
,d21.jarjestys AS kansalaisuus_jarjestys
--,d22.jarjestys AS opetuskieli_jarjestys
--,d23.jarjestys AS tutktyyppi_jarjestys
--,d24.jarjestys AS jarjestamistapa_jarjestys
,d25.jarjestys AS nuoraik_jarjestys
--,d26.jarjestys AS monihaku_jarjestys
--,d27.jarjestys AS paaastoim_jarjestys
--,d28.jarjestys AS ammasema_jarjestys
,d29.jarjestys AS koul_paattaneiden_toiminta_jarjestys
--,d30.jarjestys_eumaa
--,d31.jarjestys_etamaa
,d6.tutkintoryhma_koodi as ryhmakoodi
,d29.koulutuksen_paattaneiden_toiminta_koodi as paattkoodi
,d27.paaasiallinen_toiminta_koodi
,[lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa_ke] AS "Koul. sijoittuneet lukiokoulutuksessa ja ammatillisessa koulutuksessa"
,[lukiokoulutuksessa_ke] AS "Koul. sijoittuneet lukiokoulutuksessa"
,[ammatillisessa_koulutuksessa_ke] AS "Koul. sijoittuneet ammatillisessa koulutuksessa"
,[ammattikorkeakoulutuksessa_ke] AS "Koul. sijoittuneet ammattikorkeakoulutuksessa"
,[yliopistokoulutuksessa_ke] AS "Koul. sijoittuneet yliopistokoulutuksessa"
,[ammattikorkeakoulutuksessa_ja_yliopistokoulutuksessa_ke] AS "Koul. sijoittuneet ammattikorkeakoulutuksessa ja yliopistokoulutuksessa"
,[toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa_ke] AS "Koul. sijoittuneet toisen asteen ammatillisessa koulutuksessa ja korkeakoulutuksessa"
,[lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa]
,[lukiokoulutuksessa]
,[ammatillisessa_koulutuksessa]
,[ammattikorkeakoulutuksessa]
,[yliopistokoulutuksessa]
,[ammattikorkeakoulutuksessa_ja_yliopistokoulutuksessa]
,[toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa]
FROM            dbo.f_koulutukseen_sijoittuneet_2v
	JOIN d_aidinkieli_versio1 d2 ON d2.id = aidinkieli_versio_1_id
	JOIN d_sukupuoli d16 ON d16.id = sukupuoli_id
	JOIN d_tarkastelujakso d17 ON d17.id = tarkastelujakso_id
	JOIN d_alueluokitus d3 ON d3.id = asuinkunta_id
	JOIN d_alueluokitus d4 ON d4.id = koulutukseen_sijoittuneen_maakunta_id
	JOIN d_alueluokitus d4b ON d4b.id = pohjakoulutuksen_tutkinnon_suoritusmaakunta_id
	JOIN d_ika d5 ON d5.id = ika_1v_id
	JOIN d_ika d5b ON d5b.id = ika_5v_id
	JOIN d_tutkintoryhma d6 ON d6.id = tutkintoryhma_id
	JOIN d_koulutusluokitus d7 ON d7.id = pohjakoulutus_id
	JOIN d_koulutusluokitus d8 ON d8.id = koulutukseen_sijoittuneen_koulutus_id
	JOIN d_oppilaitoksen_taustatiedot d13 ON d13.id = pohjakoulutuksen_oppilaitos_id
	JOIN d_oppilaitoksen_taustatiedot d14 ON d14.id = koulutukseen_sijoittuneen_oppilaitos_id
	JOIN d_kausi d15 on d15.kausi_id = suoritusvuosi_id
	JOIN d_kausi d18 on d18.kausi_id = suorituslukukausi_id
	JOIN d_kausi d19 on d19.kausi_id = syntymavuosi_id
	JOIN d_pohjoismaa d20 on d20.id = pohjoismaa_id
	JOIN d_kansalaisuus_versio1 d21 on d21.id = kansalaisuus_id
	JOIN d_opetuskieli d22 on d22.id = pohjakoulutuksen_opetuskieli_id
	JOIN d_ammatillisen_koulutuksen_koulutuslaji d23 on d23.id = pohjakoulutuksen_koulutuslaji_id
	JOIN d_opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus d24 on d24.id = pohjakoulutuksen_tutktav_id
	JOIN d_nuorten_aikuisten_koulutus d25 on d25.id = pohjakoulutuksen_aikoul_id
	JOIN d_moninkertainen_haku d26 on d26.id = moninkertainen_haku_id
	JOIN d_paaasiallinen_toiminta d27 on d27.id = paaasiallinen_toiminta_id
	JOIN d_ammattiasema d28 on d28.id = ammattiasema_id
	JOIN d_koulutuksen_paattaneiden_toiminta d29 on d29.id = koulutuksen_paattaneiden_toiminta_id
	JOIN d_valtio d30 on d30.id = eumaa_id
	JOIN d_valtio d31 on d31.id = etamaa_id
WHERE tutkintoryhma_koodi = 2 AND d15.vuosiselite <> ''2008''










' 
GO
/****** Object:  View [dbo].[v_f_tab_koulutukseen_sijoittuneet_2v_peruskoulu]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_koulutukseen_sijoittuneet_2v_peruskoulu]'))
EXEC dbo.sp_executesql @statement = N'










CREATE VIEW [dbo].[v_f_tab_koulutukseen_sijoittuneet_2v_peruskoulu] AS

Select 
[lkm_int2] = lkm
,[tilastovuosi] AS Tilastovuosi
,d17.tarkastelujakso AS Tarkastelujakso
,d16.sukupuoli AS Sukupuoli
,d2.aidinkieli_versio1 AS Äidinkieli
,d5.ika AS Ikä
,d5b.ika5v AS Ikäryhmä
,d6.tutkintoryhma AS "Tutkintoryhmä"
,d7.koulutus AS "Pohjakoulutus"
,d8.koulutusaste2002 AS "Koul. sijoittuneen koulutusaste"
,d8.koulutusala2002 AS "Koul. sijoittuneen koulutusala"
,d8.opintoala2002 AS "Koul. sijoittuneen opintoala"
,d8.koulutus AS "Koul. sijoittuneen koulutusnimike"
--,d3.kunta AS "Asuinkunta"
--,d3.maakunta AS "Asuinmaakunta"
--,d3.avi AS "Asuinpaikan AVI"
--,d3.ely AS "Asuinpaikan ELY"
--,d3.seutukunta AS "Asuinpaikan seutukunta"
--,d3.suuralue AS "Asuinpaikan suuralue"
--,d3.kuntaryhma AS "Asuinpaikan kuntaryhmä"
--,d3.laani AS "Asuinpaikan lääni"
--,d3.kielisuhde AS "Asuinpaikan kunnan kielisuhde"
,d4.maakunta AS "Koul. sijoittuneen opiskelumaakunta"
--,d4.avi AS "Koul. sijoittuneen opiskelupaikan AVI"
--,d4.ely AS "Koul. sijoittuneen opiskelupaikan ELY"
--,d4.seutukunta AS "Koul. sijoittuneen opiskelupaikan seutukunta"
--,d4.suuralue AS "Koul. sijoittuneen opiskelupaikan suuralue"
--,d4.kuntaryhma AS "Koul. sijoittuneen opiskelupaikan kuntaryhmä"
--,d4.laani AS "Koul. sijoittuneen opiskelupaikan lääni"
,d4b.maakunta AS "Tutkinnon suoritusmaakunta"
--,d4b.avi AS "Tutk. suorituspaikan AVI"
--,d4b.ely AS "Tutk. suorituspaikan ELY"
--,d4b.seutukunta AS "Tutk. suorituspaikan seutukunta"
--,d4b.suuralue AS "Tutk. suorituspaikan suuralue"
--,d4b.kuntaryhma AS "Tutk. suorituspaikan kuntaryhmä"
--,d4b.laani AS "Tutk. suorituspaikan lääni"
,d13.oppilaitos AS "Oppilaitos"
,d13.oppilaitostyyppi AS "Oppilaitostyyppi"
--,d13.oppilaitoksen_omistajatyyppi AS "Oppil. omistajatyyppi"
,d13.opetuskieli AS "Oppil. opetuskieli"
,d13.koulutuksen_jarjestaja AS "Koulutuksen järjestäjä"
--,d13.koulutuksen_jarjestajan_omistajatyyppi AS "Koul. järjestäjän omistajatyyppi"
--,d13.koulutuksen_jarjestajan_kieli AS "Koul. järjestäjän kieli"
--,d13.peruskoulujen_ryhmitys AS "Peruskoulujen ryhmitys"
--,d13.peruskoulujen_vuosilks AS "Peruskoulujen vuosiluokat"
,d14.oppilaitos AS "Koul. sijoittuneen oppilaitos"
--,d14.oppilaitostyyppi AS "Koul. sijoittuneen oppil.tyyppi"
--,d14.oppilaitoksen_omistajatyyppi AS "Koul. sijoittuneen oppil. omistajatyyppi"
--,d14.opetuskieli AS "Koul. sijoittuneen oppil. opetuskieli"
,d14.koulutuksen_jarjestaja AS "Koul. sijoittuneen koul. järjestäjä"
--,d14.koulutuksen_jarjestajan_omistajatyyppi AS "Koul. sijoittuneen koul. järjestäjän omistajatyyppi"
--,d14.koulutuksen_jarjestajan_kieli AS "Koul. sijoittuneen koul. järjestäjän kieli"
--,d14.peruskoulujen_ryhmitys AS "Koul. sijoittuneen peruskoulujen ryhmitys"
--,d14.peruskoulujen_vuosilks AS "Koul. sijoittuneen peruskoulujen vuosiluokat"
,d15.vuosiselite AS "Tutkinnon suoritusvuosi"
,d18.lukukausiselite AS "Tutkinnon suorituslukukausi"
--,d19.vuosiselite AS "Syntymävuosi"
--,d20.pohjoismaa AS "Pohjoismaan kansalainen"
,d21.kansalaisuus_versio1 AS "Kansalaisuus"
--,d22.opetuskieli AS "Opetuskieli"
--,d23.ammatillisen_koulutuksen_koulutuslaji AS "Tutkintotyyppi"
--,d24.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus AS "Järjestämistapa"
--,d25.nuorten_aikuisten_koulutus AS "Nuoret/aikuiset"
--,d26.moninkertainen_haku AS "Koul. sijoittuneiden haut"
--,d27.paaasiallinen_toiminta AS "Pääasiallinen toiminta"
--,d28.ammattiasema AS "Ammattiasema"
,d29.koulutuksen_paattaneiden_toiminta AS "Koul. päättäneiden toiminta"
--,d30.eumaa AS "EU-maan kansalainen"
--,d31.etamaa AS "ETA-maan kansalainen"


--Ruotsi
,[tilastovuosi] AS Statistikår
,d17.tarkastelujakso_SV AS Granskningsperiod
,d16.sukupuoli_SV AS Kön
,d2.aidinkieli_versio1_SV AS Modersmål
,d5.ika_SV AS Ålder
,d5b.ika5v_SV AS Åldersgrupp
,d6.tutkintoryhma_SV AS "Examenskategori"
,d7.koulutus_SV AS "Grundutbildning"
,d8.koulutusaste2002_SV AS "Placering i utbildning – utbildningsnivå"
,d8.koulutusala2002_SV AS "Placering i utbildning – utbildningsområde"
,d8.opintoala2002_SV AS "Placering i utbildning – studieområde"
,d8.koulutus_SV AS "Placering i utbildning – utbildningsbenämning"
--,d3.kunta_SV AS "Bostadskommun"
--,d3.maakunta_SV AS "Bostadslandskap"
--,d3.avi_SV AS "Bostadsortens RFV-område"
--,d3.ely_SV AS "Bostadsortens NTM-område"
--,d3.seutukunta_SV AS "Bostadsortens ekonomisk region"
--,d3.suuralue_SV AS "Bostadsortens storområde"
--,d3.kuntaryhma_SV AS "Bostadsortens kommungrupp"
--,d3.laani_SV AS "Bostadsortens län"
--,d3.kielisuhde_SV AS "Bostadskommuns språkliga indelning"
,d4.maakunta_SV AS "Placering i utbildning – landskapet för studieplatsen"
--,d4.avi_SV AS "RFV-område där studierna bedrivs"
--,d4.ely_SV AS "NTM-område där studierna bedrivs"
--,d4.seutukunta_SV AS "Ekonomisk region där studierna bedrivs"
--,d4.suuralue_SV AS "Storområde där studierna bedrivs"
--,d4.kuntaryhma_SV AS "Kommungruppen där studierna bedrivs"
--,d4.laani_SV AS "Län där studierna bedrivs"
,d4b.maakunta_SV AS "Landskap där examen avlagts"
--,d4b.avi_SV AS "RFV-område där examen avlagts"
--,d4b.ely_SV AS "NMT-område där examen avlagts"
--,d4b.seutukunta_SV AS "Ekonomisk region där examen avlagts"
--,d4b.suuralue_SV AS "Storområde där examen avlagts"
--,d4b.kuntaryhma_SV AS "Kommungrupp där examen avlagts"
--,d4b.laani_SV AS "Län där examen avlagts"
,d13.oppilaitos_SV AS "Läroanstalt"
,d13.oppilaitostyyppi_SV AS "Läroanstaltstyp"
--,d13.oppilaitoksen_omistajatyyppi_SV AS "Läroanstaltens ägartyp"
,d13.opetuskieli_SV AS "Läroanstaltens undervisningsspråk"
,d13.koulutuksen_jarjestaja_SV AS "Utbildningsordnare"
--,d13.koulutuksen_jarjestajan_omistajatyyppi_SV AS "Utbildningsanordnarens ägartyp"
--,d13.koulutuksen_jarjestajan_kieli_SV AS "Utbildningsanordnarens språk"
--,d13.peruskoulujen_ryhmitys_SV AS "Peruskoulujen ryhmitysSV"
--,d13.peruskoulujen_vuosilks_SV AS "Årsklasser"
,d14.oppilaitos_SV AS "Placering i utbildning – läroanstalt"
--,d14.oppilaitostyyppi_SV AS "Koul. sijoittuneen oppil.tyyppiSV"
--,d14.oppilaitoksen_omistajatyyppi_SV AS "Koul. sijoittuneen oppil. omistajatyyppiSV"
--,d14.opetuskieli_SV AS "Koul. sijoittuneen oppil. opetuskieliSV"
,d14.koulutuksen_jarjestaja_SV AS "Placering i utbildning – utbildningsanordnare"
--,d14.koulutuksen_jarjestajan_omistajatyyppi_SV AS "Koul. sijoittuneen koul. järjestäjän omistajatyyppiSV"
--,d14.koulutuksen_jarjestajan_kieli_SV AS "Koul. sijoittuneen koul. järjestäjän kieliSV"
--,d14.peruskoulujen_ryhmitys_SV AS "Koul. sijoittuneen peruskoulujen ryhmitysSV"
--,d14.peruskoulujen_vuosilks_SV AS "Koul. sijoittuneen peruskoulujen vuosiluokatSV"
,d15.vuosiselite_SV AS "År då utbildningen avlagts"
,d18.lukukausiselite_SV AS "Termin då utbildningen avlagts"
--,d19.vuosiselite_SV AS "Födelseår"
--,d20.pohjoismaa_SV AS "Medborgare i ett nordiskt land"
,d21.kansalaisuus_versio1_SV AS "Medborgarskap"
--,d22.opetuskieli_SV AS "Undervisningspråk"
--,d23.ammatillisen_koulutuksen_koulutuslaji_SV AS "Typ av examen"
--,d24.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_SV AS "Sättet på vilket utbildningen ordnas"
--,d25.nuorten_aikuisten_koulutus_SV AS "Ungdoms-/vuxenutbildning"
--,d26.moninkertainen_haku_SV AS "Koul. sijoittuneiden hautSV"
--,d27.paaasiallinen_toiminta_SV AS "Huvudsaklig verksamhet"
--,d28.ammattiasema_SV AS "Yrkesställning"
,d29.koulutuksen_paattaneiden_toiminta_SV AS "Sysselsättning av utexaminerade"
--,d30.eumaa_SV AS "Medborgare i ett EU-land"
--,d31.etamaa_SV AS "Medborgare i ett EES-land"

--Englanti
,[tilastovuosi] AS [Statistical year]
,d17.tarkastelujakso_EN AS [Reference period]
,d16.sukupuoli_EN AS Gender
,d2.aidinkieli_versio1_EN AS [Mother tongue]
,d5.ika_EN AS Age
,d5b.ika5v_EN AS [Age group]
,d6.tutkintoryhma_EN AS [Degree/Qualification group]
,d7.koulutus_EN AS [Previous education]
,d8.koulutusaste2002_EN AS "Placed in further ed. - level of education"
,d8.koulutusala2002_EN AS "Placed in further ed. - field of education"
,d8.opintoala2002_EN AS "Placed in further ed. - subfield of education"
,d8.koulutus_EN AS "Placed in further ed. - name of education"
--,d3.kunta_EN AS [Municipality of residence]
--,d3.maakunta_EN AS [Region of residence]
--,d3.avi_EN AS [AVI area of the place of residence]
--,d3.ely_EN AS [ELY area of the place of residence]
--,d3.seutukunta_EN AS [Subregion of the place of residence]
--,d3.suuralue_EN AS [Major region of the place of residence]
--,d3.kuntaryhma_EN AS [Municipality group of the place of residence]
--,d3.laani_EN AS [Province of the place of residence]
--,d3.kielisuhde_EN AS [Municipality''s lang. distribution of the place of residence]
,d4.maakunta_EN AS [Placed in further ed. - region]
--,d4.avi_EN AS [Placed in further ed. - AVI area]
--,d4.ely_EN AS [Placed in further ed. - ELY area]
--,d4.seutukunta_EN AS [Placed in further ed. - subregion]
--,d4.suuralue_EN AS [Placed in further ed. - major region]
--,d4.kuntaryhma_EN AS [Placed in further ed. - municipality group]
--,d4.laani_EN AS [Placed in further ed. - province]
,d4b.maakunta_EN AS [Region of degree/qualification]
--,d4b.avi_EN AS [AVI area of degree/qualification]
--,d4b.ely_EN AS [ELY area of degree/qualification]
--,d4b.seutukunta_EN AS [Subregion of degree/qualification]
--,d4b.suuralue_EN AS [Major region of degree/qualification]
--,d4b.kuntaryhma_EN AS [Municipality group of degree/qualification]
--,d4b.laani_EN AS [Province of degree/qualification]
,d13.oppilaitos_EN AS [Educational institution]
,d13.oppilaitostyyppi_EN AS [Type of institution]
--,d13.oppilaitoksen_omistajatyyppi_EN AS [Type of institution owner]
,d13.opetuskieli_EN AS [Language of the institution]
,d13.koulutuksen_jarjestaja_EN AS [Education provider]
--,d13.koulutuksen_jarjestajan_omistajatyyppi_EN AS [Type of education provider owner]
--,d13.koulutuksen_jarjestajan_kieli_EN AS [Language of the education provider]
--,d13.peruskoulujen_ryhmitys_EN AS [Peruskoulujen ryhmitysEN]
--,d13.peruskoulujen_vuosilks_EN AS [Year groups]
,d14.oppilaitos_EN AS "Placed in further ed. - ed. institution"
--,d14.oppilaitostyyppi_EN AS "Placed in further ed. - type of institution"
--,d14.oppilaitoksen_omistajatyyppi_EN AS "Placed in further ed. - type of institution owner"
--,d14.opetuskieli_EN AS "Placed in further ed. - language of institution"
,d14.koulutuksen_jarjestaja_EN AS "Placed in further ed. - education provider"
--,d14.koulutuksen_jarjestajan_omistajatyyppi_EN AS "Placed in further ed. - type of ed. provider owner"
--,d14.koulutuksen_jarjestajan_kieli_EN AS "Placed in further ed. - language of ed. provider"
--,d14.peruskoulujen_ryhmitys_EN AS "Koul. sijoittuneen peruskoulujen ryhmitysEN"
--,d14.peruskoulujen_vuosilks_EN AS "Koul. sijoittuneen peruskoulujen vuosiluokatEN"
,d15.vuosiselite_EN AS [Graduation year]
,d18.lukukausiselite_EN AS [Term of graduation]
--,d19.vuosiselite_EN AS [Birth year]
--,d20.pohjoismaa_EN AS [Citizen of a nordic nation]
,d21.kansalaisuus_versio1_EN AS Nationality
--,d22.opetuskieli_EN AS [Language of education]
--,d23.ammatillisen_koulutuksen_koulutuslaji_EN AS [Form of education and training]
--,d24.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_EN AS [Method of vocational education and training]
--,d25.nuorten_aikuisten_koulutus_EN AS "Youth/adult education"
--,d26.moninkertainen_haku_EN AS "Koul. sijoittuneiden hautEN"
--,d27.paaasiallinen_toiminta_EN AS [Main type of activity]
--,d28.ammattiasema_EN AS [Status in employment]
,d29.koulutuksen_paattaneiden_toiminta_EN AS [Completers'' activity]
--,d30.eumaa_EN AS [Citizen of EU nation]
--,d31.etamaa_EN AS [Citizen of EEA nation]

--isced
,d8.iscle2011 as "Koul. sijoittuneen koulutusaste, taso 1"
,d8.Koulutusaste_taso2 as "Koul. sijoittuneen koulutusaste, taso 2"
,d8.iscfibroad2013 as "Koul. sijoittuneen koulutusala, taso 1"
,d8.iscfinarrow2013 as "Koul. sijoittuneen koulutusala, taso 2"
,d8.iscfi2013 as "Koul. sijoittuneen koulutusala, taso 3"
,d8.OKM_ohjauksen_ala as "Koul. sijoittuneen OKM ohjauksen ala, korkeak."
,d8.iscle2011_SV as "Placering i utbildning – utbildn.nivå, nivå 1"
,d8.Koulutusaste_taso2_SV as "Placering i utbildning – utbildn.nivå, nivå 2"
,d8.iscfibroad2013_SV as "Placering i utbildning – utbildn.område, nivå 1"
,d8.iscfinarrow2013_SV as "Placering i utbildning – utbildn.område, nivå 2"
,d8.iscfi2013_SV as "Placering i utbildning – utbildn.område, nivå 3"
,d8.OKM_ohjauksen_ala_SV as "Placering i utbildning – UKM-styrningsområde, högskolor"
,d8.iscle2011_EN as "Placed in further ed. - level of education, tier 1"
,d8.Koulutusaste_taso2_EN as "Placed in further ed. - level of education, tier 2"
,d8.iscfibroad2013_EN as "Placed in further ed. - field of education, tier 1"
,d8.iscfinarrow2013_EN as "Placed in further ed. - field of education, tier 2"
,d8.iscfi2013_EN as "Placed in further ed. - field of education, tier 3"
,d8.OKM_ohjauksen_ala_EN as "Placed in further ed. - field of ed., HE steering"
,d8.jarjestys_iscle2011 as jarj_isced_koulast1
,d8.jarjestys_Koulutusaste_taso2 as jarj_isced_koulast2
,d8.jarjestys_iscfibroad2013 as jarj_isced_koulala1
,d8.jarjestys_iscfinarrow2013 as jarj_isced_koulala2
,d8.jarjestys_iscfi2013 as jarj_isced_koulala3
,d8.jarjestys_OKM_ohjauksen_ala as jarj_isced_okmohjaus1

--koodimuuttujat
,d8.koulutusala2002_koodi as "Koodit Koulutusala 2002"
,d8.opintoala1995_koodi as "Koodit Koulutusala 1995"
,d8.opintoala2002_koodi as "Koodit Opintoala 2002"
,d8.koulutus_koodi as "Koodit Koulutusnimike"
,d8.koulutusaste2002_koodi as "Koodit Koulutusaste 2002"
,d13.oppilaitoskoodi as "Koodit Oppilaitos"
,d14.oppilaitoskoodi as "Koodit Koul. sij. oppilaitos"
,d13.koulutuksen_jarjestajakoodi as "Koodit Koul. järjestäjä"
,d14.koulutuksen_jarjestajakoodi as "Koodit Koul. sij. koul. järjestäjä"
,d4.maakunta_koodi as "Koodit Koul. sij. opiskelumaakunta"
,d4b.maakunta_koodi as "Koodit Tutk. suor.maakunta"
,d8.iscle2011_koodi as "Koodit Koulutusaste, taso 1"
,d8.Koulutusaste_taso2_koodi as "Koodit Koulutusaste, taso 2"
,d8.iscfibroad2013_koodi as "Koodit Koulutusala, taso 1"
,d8.iscfinarrow2013_koodi as "Koodit Koulutusala, taso 2"
,d8.iscfi2013_koodi as "Koodit Koulutusala, taso 3"
,d8.OKM_ohjauksen_ala_koodi as "Koodit OKM ohjauksen ala, korkeak."

--Järjestys
,d17.jarjestys AS tarkastelujakso_jarjestys
,d16.jarjestys AS sukupuoli_jarjestys
,d2.jarjestys AS aidinkieli_jarjestys
,d5.jarjestys_ika
,d5b.jarjestys_ika5v
,d6.jarjestys AS tutkintoryhma_jarjestys
,d7.jarjestys AS jarjestys_pohjakoulutus
,d8.jarjestys_koulutusaste2002 AS jarjestys_sij_koulutusaste2002
,d8.jarjestys_koulutusala2002 AS jarjestys_sij_koulutusala2002
,d8.jarjestys_opintoala2002 AS jarjestys_sij_opintoala
,d8.jarjestys AS jarjestys_sij_koulutusnimike
,d8.koulutusaste2002_koodi AS koulsijka
--,d3.jarjestys AS alueluokitus_jarjestys
--,d3.jarjestys_maakunta
--,d3.jarjestys_avi
--,d3.jarjestys_ely
--,d3.jarjestys_seutukunta
--,d3.jarjestys_suuralue
--,d3.jarjestys_kuntaryhma
--,d3.jarjestys_laani
--,d3.jarjestys_kielisuhde
,d4.jarjestys_maakunta AS sijoittuneen_al_jarjestys_maakunta
--,d4.jarjestys_avi AS sijoittuneen_al_jarjestys_avi
--,d4.jarjestys_ely AS sijoittuneen_al_jarjestys_ely
--,d4.jarjestys_seutukunta AS sijoittuneen_al_jarjestys_seutukunta
--,d4.jarjestys_suuralue AS sijoittuneen_al_jarjestys_suuralue
--,d4.jarjestys_kuntaryhma AS sijoittuneen_al_jarjestys_kuntaryhma
--,d4.jarjestys_laani AS sijoittuneen_al_jarjestys_laani
--,d4.jarjestys_kielisuhde AS sijoittuneen_al_jarjestys_kielisuhde
,d4b.jarjestys_maakunta AS tutksuor_al_jarjestys_maakunta
--,d4b.jarjestys_avi AS tutksuor_al_jarjestys_avi
--,d4b.jarjestys_ely AS tutksuor_al_jarjestys_ely
--,d4b.jarjestys_seutukunta AS tutksuor_al_jarjestys_seutukunta
--,d4b.jarjestys_suuralue AS tutksuor_al_jarjestys_suuralue
--,d4b.jarjestys_kuntaryhma AS tutksuor_al_jarjestys_kuntaryhma
--,d4b.jarjestys_laani AS tutksuor_al_jarjestys_laani
--,d4b.jarjestys_kielisuhde AS tutksuor_al_jarjestys_kielisuhde
--,d13.jarjestys_oppilaitos
,d13.jarjestys_oppilaitostyyppi
--,d13.jarjestys_omistajatyyppi
,d13.jarjestys_opetuskieli
--,d13.jarjestys_koulutuksen_jarjestaja
--,d13.jarjestys_koulutuksen_jarjestajan_kieli
--,d13.jarjestys_peruskoulujen_ryhmitys
--,d13.jarjestys_peruskoulujen_vuosilks
--,d14.jarjestys_oppilaitos AS sijoittuneen_jarjestys_oppilaitos
--,d14.jarjestys_oppilaitostyyppi AS sijoittuneen_jarjestys_oppilaitostyyppi
--,d14.jarjestys_omistajatyyppi AS sijoittuneen_jarjestys_omistajatyyppi
--,d14.jarjestys_opetuskieli AS sijoittuneen_jarjestys_opetuskieli
--,d14.jarjestys_koulutuksen_jarjestaja AS sijoittuneen_jarjestys_koulutuksen_jarjestaja
--,d14.jarjestys_koulutuksen_jarjestajan_kieli AS sijoittuneen_jarjestys_koulutuksen_jarjestajan_kieli
--,d14.jarjestys_peruskoulujen_ryhmitys AS sijoittuneen_peruskoulujen_ryhmitys
--,d14.jarjestys_peruskoulujen_vuosilks AS sijoittuneen_peruskoulujen_vuosilks
,d18.lukukausi AS tutksuor_lukukausi_jarjestys
--,d20.jarjestys AS pohjoismaa_jarjestys
,d21.jarjestys AS kansalaisuus_jarjestys
--,d22.jarjestys AS opetuskieli_jarjestys
--,d23.jarjestys AS tutktyyppi_jarjestys
--,d24.jarjestys AS jarjestamistapa_jarjestys
,d25.jarjestys AS nuoraik_jarjestys
--,d26.jarjestys AS monihaku_jarjestys
--,d27.jarjestys AS paaastoim_jarjestys
--,d28.jarjestys AS ammasema_jarjestys
,d29.jarjestys AS koul_paattaneiden_toiminta_jarjestys
--,d30.jarjestys_eumaa
--,d31.jarjestys_etamaa
,d6.tutkintoryhma_koodi as ryhmakoodi
,d29.koulutuksen_paattaneiden_toiminta_koodi as paattkoodi
,d27.paaasiallinen_toiminta_koodi
,[lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa_ke] AS "Koul. sijoittuneet lukiokoulutuksessa ja ammatillisessa koulutuksessa"
,[lukiokoulutuksessa_ke] AS "Koul. sijoittuneet lukiokoulutuksessa"
,[ammatillisessa_koulutuksessa_ke] AS "Koul. sijoittuneet ammatillisessa koulutuksessa"
,[ammattikorkeakoulutuksessa_ke] AS "Koul. sijoittuneet ammattikorkeakoulutuksessa"
,[yliopistokoulutuksessa_ke] AS "Koul. sijoittuneet yliopistokoulutuksessa"
,[ammattikorkeakoulutuksessa_ja_yliopistokoulutuksessa_ke] AS "Koul. sijoittuneet ammattikorkeakoulutuksessa ja yliopistokoulutuksessa"
,[toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa_ke] AS "Koul. sijoittuneet toisen asteen ammatillisessa koulutuksessa ja korkeakoulutuksessa"
,[lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa]
,[lukiokoulutuksessa]
,[ammatillisessa_koulutuksessa]
,[ammattikorkeakoulutuksessa]
,[yliopistokoulutuksessa]
,[ammattikorkeakoulutuksessa_ja_yliopistokoulutuksessa]
,[toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa]
FROM            dbo.f_koulutukseen_sijoittuneet_2v
	JOIN d_aidinkieli_versio1 d2 ON d2.id = aidinkieli_versio_1_id
	JOIN d_sukupuoli d16 ON d16.id = sukupuoli_id
	JOIN d_tarkastelujakso d17 ON d17.id = tarkastelujakso_id
	JOIN d_alueluokitus d3 ON d3.id = asuinkunta_id
	JOIN d_alueluokitus d4 ON d4.id = koulutukseen_sijoittuneen_maakunta_id
	JOIN d_alueluokitus d4b ON d4b.id = pohjakoulutuksen_tutkinnon_suoritusmaakunta_id
	JOIN d_ika d5 ON d5.id = ika_1v_id
	JOIN d_ika d5b ON d5b.id = ika_5v_id
	JOIN d_tutkintoryhma d6 ON d6.id = tutkintoryhma_id
	JOIN d_koulutusluokitus d7 ON d7.id = pohjakoulutus_id
	JOIN d_koulutusluokitus d8 ON d8.id = koulutukseen_sijoittuneen_koulutus_id
	JOIN d_oppilaitoksen_taustatiedot d13 ON d13.id = pohjakoulutuksen_oppilaitos_id
	JOIN d_oppilaitoksen_taustatiedot d14 ON d14.id = koulutukseen_sijoittuneen_oppilaitos_id
	JOIN d_kausi d15 on d15.kausi_id = suoritusvuosi_id
	JOIN d_kausi d18 on d18.kausi_id = suorituslukukausi_id
	JOIN d_kausi d19 on d19.kausi_id = syntymavuosi_id
	JOIN d_pohjoismaa d20 on d20.id = pohjoismaa_id
	JOIN d_kansalaisuus_versio1 d21 on d21.id = kansalaisuus_id
	JOIN d_opetuskieli d22 on d22.id = pohjakoulutuksen_opetuskieli_id
	JOIN d_ammatillisen_koulutuksen_koulutuslaji d23 on d23.id = pohjakoulutuksen_koulutuslaji_id
	JOIN d_opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus d24 on d24.id = pohjakoulutuksen_tutktav_id
	JOIN d_nuorten_aikuisten_koulutus d25 on d25.id = pohjakoulutuksen_aikoul_id
	JOIN d_moninkertainen_haku d26 on d26.id = moninkertainen_haku_id
	JOIN d_paaasiallinen_toiminta d27 on d27.id = paaasiallinen_toiminta_id
	JOIN d_ammattiasema d28 on d28.id = ammattiasema_id
	JOIN d_koulutuksen_paattaneiden_toiminta d29 on d29.id = koulutuksen_paattaneiden_toiminta_id
	JOIN d_valtio d30 on d30.id = eumaa_id
	JOIN d_valtio d31 on d31.id = etamaa_id
WHERE tutkintoryhma_koodi = 1 AND d15.vuosiselite <> ''2008''











' 
GO
/****** Object:  View [dbo].[v_f_tab_koulutukseen_sijoittuneet_2v_yhteiset]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_koulutukseen_sijoittuneet_2v_yhteiset]'))
EXEC dbo.sp_executesql @statement = N'


























/****** Script for SelectTopNRows command from SSMS  ******/
CREATE VIEW [dbo].[v_f_tab_koulutukseen_sijoittuneet_2v_yhteiset] AS
Select 
[lkm_int2] = lkm
,[tilastovuosi] AS Tilastovuosi
,d17.tarkastelujakso AS Tarkastelujakso
,d16.sukupuoli AS Sukupuoli
,d2.aidinkieli_versio1 AS Äidinkieli
,d5.ika AS Ikä
,d5b.ika5v AS Ikäryhmä
,d6.tutkintoryhma AS "Tutkintoryhmä"
,d7.koulutus AS "Pohjakoulutus"
,d8.koulutusaste2002 AS "Koul. sijoittuneen koulutusaste"
,d8.koulutusala2002 AS "Koul. sijoittuneen koulutusala"
,d8.opintoala2002 AS "Koul. sijoittuneen opintoala"
,d8.koulutus AS "Koul. sijoittuneen koulutusnimike"
--,d3.kunta AS "Asuinkunta"
--,d3.maakunta AS "Asuinmaakunta"
--,d3.avi AS "Asuinpaikan AVI"
--,d3.ely AS "Asuinpaikan ELY"
--,d3.seutukunta AS "Asuinpaikan seutukunta"
--,d3.suuralue AS "Asuinpaikan suuralue"
--,d3.kuntaryhma AS "Asuinpaikan kuntaryhmä"
--,d3.laani AS "Asuinpaikan lääni"
--,d3.kielisuhde AS "Asuinpaikan kunnan kielisuhde"
,d4.maakunta AS "Koul. sijoittuneen opiskelumaakunta"
--,d4.avi AS "Koul. sijoittuneen opiskelupaikan AVI"
--,d4.ely AS "Koul. sijoittuneen opiskelupaikan ELY"
--,d4.seutukunta AS "Koul. sijoittuneen opiskelupaikan seutukunta"
--,d4.suuralue AS "Koul. sijoittuneen opiskelupaikan suuralue"
--,d4.kuntaryhma AS "Koul. sijoittuneen opiskelupaikan kuntaryhmä"
--,d4.laani AS "Koul. sijoittuneen opiskelupaikan lääni"
,d4b.maakunta AS "Tutkinnon suoritusmaakunta"
--,d4b.avi AS "Tutk. suorituspaikan AVI"
--,d4b.ely AS "Tutk. suorituspaikan ELY"
--,d4b.seutukunta AS "Tutk. suorituspaikan seutukunta"
--,d4b.suuralue AS "Tutk. suorituspaikan suuralue"
--,d4b.kuntaryhma AS "Tutk. suorituspaikan kuntaryhmä"
--,d4b.laani AS "Tutk. suorituspaikan lääni"
,d13.oppilaitos AS "Oppilaitos"
,d13.oppilaitostyyppi AS "Oppilaitostyyppi"
--,d13.oppilaitoksen_omistajatyyppi AS "Oppil. omistajatyyppi"
,d13.opetuskieli AS "Oppil. opetuskieli"
,d13.koulutuksen_jarjestaja AS "Koulutuksen järjestäjä"
--,d13.koulutuksen_jarjestajan_omistajatyyppi AS "Koul. järjestäjän omistajatyyppi"
--,d13.koulutuksen_jarjestajan_kieli AS "Koul. järjestäjän kieli"
--,d13.peruskoulujen_ryhmitys AS "Peruskoulujen ryhmitys"
--,d13.peruskoulujen_vuosilks AS "Peruskoulujen vuosiluokat"
,d14.oppilaitos AS "Koul. sijoittuneen oppilaitos"
--,d14.oppilaitostyyppi AS "Koul. sijoittuneen oppil.tyyppi"
--,d14.oppilaitoksen_omistajatyyppi AS "Koul. sijoittuneen oppil. omistajatyyppi"
--,d14.opetuskieli AS "Koul. sijoittuneen oppil. opetuskieli"
,d14.koulutuksen_jarjestaja AS "Koul. sijoittuneen koul. järjestäjä"
--,d14.koulutuksen_jarjestajan_omistajatyyppi AS "Koul. sijoittuneen koul. järjestäjän omistajatyyppi"
--,d14.koulutuksen_jarjestajan_kieli AS "Koul. sijoittuneen koul. järjestäjän kieli"
--,d14.peruskoulujen_ryhmitys AS "Koul. sijoittuneen peruskoulujen ryhmitys"
--,d14.peruskoulujen_vuosilks AS "Koul. sijoittuneen peruskoulujen vuosiluokat"
,d15.vuosiselite AS "Tutkinnon suoritusvuosi"
,d18.lukukausiselite AS "Tutkinnon suorituslukukausi"
--,d19.vuosiselite AS "Syntymävuosi"
--,d20.pohjoismaa AS "Pohjoismaan kansalainen"
,d21.kansalaisuus_versio1 AS "Kansalaisuus"
--,d22.opetuskieli AS "Opetuskieli"
--,d23.ammatillisen_koulutuksen_koulutuslaji AS "Tutkintotyyppi"
--,d24.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus AS "Järjestämistapa"
,d25.nuorten_aikuisten_koulutus AS "Nuoret/aikuiset"
,d26.moninkertainen_haku AS "Haut koulutuksiin"
--,d27.paaasiallinen_toiminta AS "Pääasiallinen toiminta"
--,d28.ammattiasema AS "Ammattiasema"
,d29.koulutuksen_paattaneiden_toiminta AS "Koul. päättäneiden toiminta"
--,d30.eumaa AS "EU-maan kansalainen"
--,d31.etamaa AS "ETA-maan kansalainen"


--Ruotsi
,[tilastovuosi] AS Statistikår
,d17.tarkastelujakso_SV AS Granskningsperiod
,d16.sukupuoli_SV AS Kön
,d2.aidinkieli_versio1_SV AS Modersmål
,d5.ika_SV AS Ålder
,d5b.ika5v_SV AS Åldersgrupp
,d6.tutkintoryhma_SV AS "Examenskategori"
,d7.koulutus_SV AS "Grundutbildning"
,d8.koulutusaste2002_SV AS "Placering i utbildning – utbildningsnivå"
,d8.koulutusala2002_SV AS "Placering i utbildning – utbildningsområde"
,d8.opintoala2002_SV AS "Placering i utbildning – studieområde"
,d8.koulutus_SV AS "Placering i utbildning – utbildningsbenämning"
--,d3.kunta_SV AS "Bostadskommun"
--,d3.maakunta_SV AS "Bostadslandskap"
--,d3.avi_SV AS "Bostadsortens RFV-område"
--,d3.ely_SV AS "Bostadsortens NTM-område"
--,d3.seutukunta_SV AS "Bostadsortens ekonomisk region"
--,d3.suuralue_SV AS "Bostadsortens storområde"
--,d3.kuntaryhma_SV AS "Bostadsortens kommungrupp"
--,d3.laani_SV AS "Bostadsortens län"
--,d3.kielisuhde_SV AS "Bostadskommuns språkliga indelning"
,d4.maakunta_SV AS "Placering i utbildning – landskapet för studieplatsen"
--,d4.avi_SV AS "RFV-område där studierna bedrivs"
--,d4.ely_SV AS "NTM-område där studierna bedrivs"
--,d4.seutukunta_SV AS "Ekonomisk region där studierna bedrivs"
--,d4.suuralue_SV AS "Storområde där studierna bedrivs"
--,d4.kuntaryhma_SV AS "Kommungruppen där studierna bedrivs"
--,d4.laani_SV AS "Län där studierna bedrivs"
,d4b.maakunta_SV AS "Landskap där examen avlagts"
--,d4b.avi_SV AS "RFV-område där examen avlagts"
--,d4b.ely_SV AS "NMT-område där examen avlagts"
--,d4b.seutukunta_SV AS "Ekonomisk region där examen avlagts"
--,d4b.suuralue_SV AS "Storområde där examen avlagts"
--,d4b.kuntaryhma_SV AS "Kommungrupp där examen avlagts"
--,d4b.laani_SV AS "Län där examen avlagts"
,d13.oppilaitos_SV AS "Läroanstalt"
,d13.oppilaitostyyppi_SV AS "Läroanstaltstyp"
--,d13.oppilaitoksen_omistajatyyppi_SV AS "Läroanstaltens ägartyp"
,d13.opetuskieli_SV AS "Läroanstaltens undervisningsspråk"
,d13.koulutuksen_jarjestaja_SV AS "Utbildningsordnare"
--,d13.koulutuksen_jarjestajan_omistajatyyppi_SV AS "Utbildningsanordnarens ägartyp"
--,d13.koulutuksen_jarjestajan_kieli_SV AS "Utbildningsanordnarens språk"
--,d13.peruskoulujen_ryhmitys_SV AS "Peruskoulujen ryhmitysSV"
--,d13.peruskoulujen_vuosilks_SV AS "Årsklasser"
,d14.oppilaitos_SV AS "Placering i utbildning – läroanstalt"
--,d14.oppilaitostyyppi_SV AS "Koul. sijoittuneen oppil.tyyppiSV"
--,d14.oppilaitoksen_omistajatyyppi_SV AS "Koul. sijoittuneen oppil. omistajatyyppiSV"
--,d14.opetuskieli_SV AS "Koul. sijoittuneen oppil. opetuskieliSV"
,d14.koulutuksen_jarjestaja_SV AS "Placering i utbildning – utbildningsanordnare"
--,d14.koulutuksen_jarjestajan_omistajatyyppi_SV AS "Koul. sijoittuneen koul. järjestäjän omistajatyyppiSV"
--,d14.koulutuksen_jarjestajan_kieli_SV AS "Koul. sijoittuneen koul. järjestäjän kieliSV"
--,d14.peruskoulujen_ryhmitys_SV AS "Koul. sijoittuneen peruskoulujen ryhmitysSV"
--,d14.peruskoulujen_vuosilks_SV AS "Koul. sijoittuneen peruskoulujen vuosiluokatSV"
,d15.vuosiselite_SV AS "År då utbildningen avlagts"
,d18.lukukausiselite_SV AS "Termin då utbildningen avlagts"
--,d19.vuosiselite_SV AS "Födelseår"
--,d20.pohjoismaa_SV AS "Medborgare i ett nordiskt land"
,d21.kansalaisuus_versio1_SV AS "Medborgarskap"
--,d22.opetuskieli_SV AS "Undervisningspråk"
--,d23.ammatillisen_koulutuksen_koulutuslaji_SV AS "Typ av examen"
--,d24.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_SV AS "Sättet på vilket utbildningen ordnas"
,d25.nuorten_aikuisten_koulutus_SV AS "Ungdoms-/vuxenutbildning"
,d26.moninkertainen_haku_SV AS "Ansökan till utbildningar"
--,d27.paaasiallinen_toiminta_SV AS "Huvudsaklig verksamhet"
--,d28.ammattiasema_SV AS "Yrkesställning"
,d29.koulutuksen_paattaneiden_toiminta_SV AS "Sysselsättning av utexaminerade"
--,d30.eumaa_SV AS "Medborgare i ett EU-land"
--,d31.etamaa_SV AS "Medborgare i ett EES-land"

--Englanti
,[tilastovuosi] AS [Statistical year]
,d17.tarkastelujakso_EN AS [Reference period]
,d16.sukupuoli_EN AS Gender
,d2.aidinkieli_versio1_EN AS [Mother tongue]
,d5.ika_EN AS Age
,d5b.ika5v_EN AS [Age group]
,d6.tutkintoryhma_EN AS [Degree/Qualification group]
,d7.koulutus_EN AS [Previous education]
,d8.koulutusaste2002_EN AS "Placed in further ed. - level of education"
,d8.koulutusala2002_EN AS "Placed in further ed. - field of education"
,d8.opintoala2002_EN AS "Placed in further ed. - subfield of education"
,d8.koulutus_EN AS "Placed in further ed. - name of education"
--,d3.kunta_EN AS [Municipality of residence]
--,d3.maakunta_EN AS [Region of residence]
--,d3.avi_EN AS [AVI area of the place of residence]
--,d3.ely_EN AS [ELY area of the place of residence]
--,d3.seutukunta_EN AS [Subregion of the place of residence]
--,d3.suuralue_EN AS [Major region of the place of residence]
--,d3.kuntaryhma_EN AS [Municipality group of the place of residence]
--,d3.laani_EN AS [Province of the place of residence]
--,d3.kielisuhde_EN AS [Municipality''s lang. distribution of the place of residence]
,d4.maakunta_EN AS [Placed in further ed. - region]
--,d4.avi_EN AS [Placed in further ed. - AVI area]
--,d4.ely_EN AS [Placed in further ed. - ELY area]
--,d4.seutukunta_EN AS [Placed in further ed. - subregion]
--,d4.suuralue_EN AS [Placed in further ed. - major region]
--,d4.kuntaryhma_EN AS [Placed in further ed. - municipality group]
--,d4.laani_EN AS [Placed in further ed. - province]
,d4b.maakunta_EN AS [Region of degree/qualification]
--,d4b.avi_EN AS [AVI area of degree/qualification]
--,d4b.ely_EN AS [ELY area of degree/qualification]
--,d4b.seutukunta_EN AS [Subregion of degree/qualification]
--,d4b.suuralue_EN AS [Major region of degree/qualification]
--,d4b.kuntaryhma_EN AS [Municipality group of degree/qualification]
--,d4b.laani_EN AS [Province of degree/qualification]
,d13.oppilaitos_EN AS [Educational institution]
,d13.oppilaitostyyppi_EN AS [Type of institution]
--,d13.oppilaitoksen_omistajatyyppi_EN AS [Type of institution owner]
,d13.opetuskieli_EN AS [Language of the institution]
,d13.koulutuksen_jarjestaja_EN AS [Education provider]
--,d13.koulutuksen_jarjestajan_omistajatyyppi_EN AS [Type of education provider owner]
--,d13.koulutuksen_jarjestajan_kieli_EN AS [Language of the education provider]
--,d13.peruskoulujen_ryhmitys_EN AS [Peruskoulujen ryhmitysEN]
--,d13.peruskoulujen_vuosilks_EN AS [Year groups]
,d14.oppilaitos_EN AS "Placed in further ed. - ed. institution"
--,d14.oppilaitostyyppi_EN AS "Placed in further ed. - type of institution"
--,d14.oppilaitoksen_omistajatyyppi_EN AS "Placed in further ed. - type of institution owner"
--,d14.opetuskieli_EN AS "Placed in further ed. - language of institution"
,d14.koulutuksen_jarjestaja_EN AS "Placed in further ed. - education provider"
--,d14.koulutuksen_jarjestajan_omistajatyyppi_EN AS "Placed in further ed. - type of ed. provider owner"
--,d14.koulutuksen_jarjestajan_kieli_EN AS "Placed in further ed. - language of ed. provider"
--,d14.peruskoulujen_ryhmitys_EN AS "Koul. sijoittuneen peruskoulujen ryhmitysEN"
--,d14.peruskoulujen_vuosilks_EN AS "Koul. sijoittuneen peruskoulujen vuosiluokatEN"
,d15.vuosiselite_EN AS [Graduation year]
,d18.lukukausiselite_EN AS [Term of graduation]
--,d19.vuosiselite_EN AS [Birth year]
--,d20.pohjoismaa_EN AS [Citizen of a nordic nation]
,d21.kansalaisuus_versio1_EN AS Nationality
--,d22.opetuskieli_EN AS [Language of education]
--,d23.ammatillisen_koulutuksen_koulutuslaji_EN AS [Form of education and training]
--,d24.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_EN AS [Method of vocational education and training]
,d25.nuorten_aikuisten_koulutus_EN AS "Youth/adult education"
,d26.moninkertainen_haku_EN AS "Applications to further education"
--,d27.paaasiallinen_toiminta_EN AS [Main type of activity]
--,d28.ammattiasema_EN AS [Status in employment]
,d29.koulutuksen_paattaneiden_toiminta_EN AS [Completers'' activity]
--,d30.eumaa_EN AS [Citizen of EU nation]
--,d31.etamaa_EN AS [Citizen of EEA nation]

--isced
,d8.iscle2011 as "Koul. sijoittuneen koulutusaste, taso 1"
,d8.Koulutusaste_taso2 as "Koul. sijoittuneen koulutusaste, taso 2"
,d8.iscfibroad2013 as "Koul. sijoittuneen koulutusala, taso 1"
,d8.iscfinarrow2013 as "Koul. sijoittuneen koulutusala, taso 2"
,d8.iscfi2013 as "Koul. sijoittuneen koulutusala, taso 3"
,d8.OKM_ohjauksen_ala as "Koul. sijoittuneen OKM ohjauksen ala, korkeak."
,d8.iscle2011_SV as "Placering i utbildning – utbildn.nivå, nivå 1"
,d8.Koulutusaste_taso2_SV as "Placering i utbildning – utbildn.nivå, nivå 2"
,d8.iscfibroad2013_SV as "Placering i utbildning – utbildn.område, nivå 1"
,d8.iscfinarrow2013_SV as "Placering i utbildning – utbildn.område, nivå 2"
,d8.iscfi2013_SV as "Placering i utbildning – utbildn.område, nivå 3"
,d8.OKM_ohjauksen_ala_SV as "Placering i utbildning – UKM-styrningsområde, högskolor"
,d8.iscle2011_EN as "Placed in further ed. - level of education, tier 1"
,d8.Koulutusaste_taso2_EN as "Placed in further ed. - level of education, tier 2"
,d8.iscfibroad2013_EN as "Placed in further ed. - field of education, tier 1"
,d8.iscfinarrow2013_EN as "Placed in further ed. - field of education, tier 2"
,d8.iscfi2013_EN as "Placed in further ed. - field of education, tier 3"
,d8.OKM_ohjauksen_ala_EN as "Placed in further ed. - field of ed., HE steering"
,d8.jarjestys_iscle2011 as jarj_isced_koulast1
,d8.jarjestys_Koulutusaste_taso2 as jarj_isced_koulast2
,d8.jarjestys_iscfibroad2013 as jarj_isced_koulala1
,d8.jarjestys_iscfinarrow2013 as jarj_isced_koulala2
,d8.jarjestys_iscfi2013 as jarj_isced_koulala3
,d8.jarjestys_OKM_ohjauksen_ala as jarj_isced_okmohjaus1

--koodimuuttujat
,d8.koulutusala2002_koodi as "Koodit Koulutusala 2002"
,d8.opintoala1995_koodi as "Koodit Koulutusala 1995"
,d8.opintoala2002_koodi as "Koodit Opintoala 2002"
,d8.koulutus_koodi as "Koodit Koulutusnimike"
,d8.koulutusaste2002_koodi as "Koodit Koulutusaste 2002"
,d13.oppilaitoskoodi as "Koodit Oppilaitos"
,d14.oppilaitoskoodi as "Koodit Koul. sij. oppilaitos"
,d13.koulutuksen_jarjestajakoodi as "Koodit Koul. järjestäjä"
,d14.koulutuksen_jarjestajakoodi as "Koodit Koul. sij. koul. järjestäjä"
,d4.maakunta_koodi as "Koodit Koul. sij. opiskelumaakunta"
,d4b.maakunta_koodi as "Koodit Tutk. suor.maakunta"
,d8.iscle2011_koodi as "Koodit Koulutusaste, taso 1"
,d8.Koulutusaste_taso2_koodi as "Koodit Koulutusaste, taso 2"
,d8.iscfibroad2013_koodi as "Koodit Koulutusala, taso 1"
,d8.iscfinarrow2013_koodi as "Koodit Koulutusala, taso 2"
,d8.iscfi2013_koodi as "Koodit Koulutusala, taso 3"
,d8.OKM_ohjauksen_ala_koodi as "Koodit OKM ohjauksen ala, korkeak."

--Järjestys
,d17.jarjestys AS tarkastelujakso_jarjestys
,d16.jarjestys AS sukupuoli_jarjestys
,d2.jarjestys AS aidinkieli_jarjestys
,d5.jarjestys_ika
,d5b.jarjestys_ika5v
,d6.jarjestys AS tutkintoryhma_jarjestys
,d7.jarjestys AS jarjestys_pohjakoulutus
,d8.jarjestys_koulutusaste2002 AS jarjestys_sij_koulutusaste2002
,d8.jarjestys_koulutusala2002 AS jarjestys_sij_koulutusala2002
,d8.jarjestys_opintoala2002 AS jarjestys_sij_opintoala
,d8.jarjestys AS jarjestys_sij_koulutusnimike
,d8.koulutusaste2002_koodi AS koulsijka
--,d3.jarjestys AS alueluokitus_jarjestys
--,d3.jarjestys_maakunta
--,d3.jarjestys_avi
--,d3.jarjestys_ely
--,d3.jarjestys_seutukunta
--,d3.jarjestys_suuralue
--,d3.jarjestys_kuntaryhma
--,d3.jarjestys_laani
--,d3.jarjestys_kielisuhde
,d4.jarjestys_maakunta AS sijoittuneen_al_jarjestys_maakunta
--,d4.jarjestys_avi AS sijoittuneen_al_jarjestys_avi
--,d4.jarjestys_ely AS sijoittuneen_al_jarjestys_ely
--,d4.jarjestys_seutukunta AS sijoittuneen_al_jarjestys_seutukunta
--,d4.jarjestys_suuralue AS sijoittuneen_al_jarjestys_suuralue
--,d4.jarjestys_kuntaryhma AS sijoittuneen_al_jarjestys_kuntaryhma
--,d4.jarjestys_laani AS sijoittuneen_al_jarjestys_laani
--,d4.jarjestys_kielisuhde AS sijoittuneen_al_jarjestys_kielisuhde
,d4b.jarjestys_maakunta AS tutksuor_al_jarjestys_maakunta
--,d4b.jarjestys_avi AS tutksuor_al_jarjestys_avi
--,d4b.jarjestys_ely AS tutksuor_al_jarjestys_ely
--,d4b.jarjestys_seutukunta AS tutksuor_al_jarjestys_seutukunta
--,d4b.jarjestys_suuralue AS tutksuor_al_jarjestys_suuralue
--,d4b.jarjestys_kuntaryhma AS tutksuor_al_jarjestys_kuntaryhma
--,d4b.jarjestys_laani AS tutksuor_al_jarjestys_laani
--,d4b.jarjestys_kielisuhde AS tutksuor_al_jarjestys_kielisuhde
--,d13.jarjestys_oppilaitos
,d13.jarjestys_oppilaitostyyppi
--,d13.jarjestys_omistajatyyppi
,d13.jarjestys_opetuskieli
--,d13.jarjestys_koulutuksen_jarjestaja
--,d13.jarjestys_koulutuksen_jarjestajan_kieli
--,d13.jarjestys_peruskoulujen_ryhmitys
--,d13.jarjestys_peruskoulujen_vuosilks
--,d14.jarjestys_oppilaitos AS sijoittuneen_jarjestys_oppilaitos
--,d14.jarjestys_oppilaitostyyppi AS sijoittuneen_jarjestys_oppilaitostyyppi
--,d14.jarjestys_omistajatyyppi AS sijoittuneen_jarjestys_omistajatyyppi
--,d14.jarjestys_opetuskieli AS sijoittuneen_jarjestys_opetuskieli
--,d14.jarjestys_koulutuksen_jarjestaja AS sijoittuneen_jarjestys_koulutuksen_jarjestaja
--,d14.jarjestys_koulutuksen_jarjestajan_kieli AS sijoittuneen_jarjestys_koulutuksen_jarjestajan_kieli
--,d14.jarjestys_peruskoulujen_ryhmitys AS sijoittuneen_peruskoulujen_ryhmitys
--,d14.jarjestys_peruskoulujen_vuosilks AS sijoittuneen_peruskoulujen_vuosilks
,d18.lukukausi AS tutksuor_lukukausi_jarjestys
--,d20.jarjestys AS pohjoismaa_jarjestys
,d21.jarjestys AS kansalaisuus_jarjestys
--,d22.jarjestys AS opetuskieli_jarjestys
--,d23.jarjestys AS tutktyyppi_jarjestys
--,d24.jarjestys AS jarjestamistapa_jarjestys
,d25.jarjestys AS nuoraik_jarjestys
,d26.jarjestys AS monihaku_jarjestys
--,d27.jarjestys AS paaastoim_jarjestys
--,d28.jarjestys AS ammasema_jarjestys
,d29.jarjestys AS koul_paattaneiden_toiminta_jarjestys
--,d30.jarjestys_eumaa
--,d31.jarjestys_etamaa
,d6.tutkintoryhma_koodi as ryhmakoodi
,d29.koulutuksen_paattaneiden_toiminta_koodi as paattkoodi
,d27.paaasiallinen_toiminta_koodi
,[lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa_ke] AS "Koul. sijoittuneet lukiokoulutuksessa ja ammatillisessa koulutuksessa"
,[lukiokoulutuksessa_ke] AS "Koul. sijoittuneet lukiokoulutuksessa"
,[ammatillisessa_koulutuksessa_ke] AS "Koul. sijoittuneet ammatillisessa koulutuksessa"
,[ammattikorkeakoulutuksessa_ke] AS "Koul. sijoittuneet ammattikorkeakoulutuksessa"
,[yliopistokoulutuksessa_ke] AS "Koul. sijoittuneet yliopistokoulutuksessa"
,[ammattikorkeakoulutuksessa_ja_yliopistokoulutuksessa_ke] AS "Koul. sijoittuneet ammattikorkeakoulutuksessa ja yliopistokoulutuksessa"
,[toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa_ke] AS "Koul. sijoittuneet toisen asteen ammatillisessa koulutuksessa ja korkeakoulutuksessa"
,[lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa]
,[lukiokoulutuksessa]
,[ammatillisessa_koulutuksessa]
,[ammattikorkeakoulutuksessa]
,[yliopistokoulutuksessa]
,[ammattikorkeakoulutuksessa_ja_yliopistokoulutuksessa]
,[toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa]
FROM            dbo.f_koulutukseen_sijoittuneet_2v
	JOIN d_aidinkieli_versio1 d2 ON d2.id = aidinkieli_versio_1_id
	JOIN d_sukupuoli d16 ON d16.id = sukupuoli_id
	JOIN d_tarkastelujakso d17 ON d17.id = tarkastelujakso_id
	JOIN d_alueluokitus d3 ON d3.id = asuinkunta_id
	JOIN d_alueluokitus d4 ON d4.id = koulutukseen_sijoittuneen_maakunta_id
	JOIN d_alueluokitus d4b ON d4b.id = pohjakoulutuksen_tutkinnon_suoritusmaakunta_id
	JOIN d_ika d5 ON d5.id = ika_1v_id
	JOIN d_ika d5b ON d5b.id = ika_5v_id
	JOIN d_tutkintoryhma d6 ON d6.id = tutkintoryhma_id
	JOIN d_koulutusluokitus d7 ON d7.id = pohjakoulutus_id
	JOIN d_koulutusluokitus d8 ON d8.id = koulutukseen_sijoittuneen_koulutus_id
	JOIN d_oppilaitoksen_taustatiedot d13 ON d13.id = pohjakoulutuksen_oppilaitos_id
	JOIN d_oppilaitoksen_taustatiedot d14 ON d14.id = koulutukseen_sijoittuneen_oppilaitos_id
	JOIN d_kausi d15 on d15.kausi_id = suoritusvuosi_id
	JOIN d_kausi d18 on d18.kausi_id = suorituslukukausi_id
	JOIN d_kausi d19 on d19.kausi_id = syntymavuosi_id
	JOIN d_pohjoismaa d20 on d20.id = pohjoismaa_id
	JOIN d_kansalaisuus_versio1 d21 on d21.id = kansalaisuus_id
	JOIN d_opetuskieli d22 on d22.id = pohjakoulutuksen_opetuskieli_id
	JOIN d_ammatillisen_koulutuksen_koulutuslaji d23 on d23.id = pohjakoulutuksen_koulutuslaji_id
	JOIN d_opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus d24 on d24.id = pohjakoulutuksen_tutktav_id
	JOIN d_nuorten_aikuisten_koulutus d25 on d25.id = pohjakoulutuksen_aikoul_id
	JOIN d_moninkertainen_haku d26 on d26.id = moninkertainen_haku_id
	JOIN d_paaasiallinen_toiminta d27 on d27.id = paaasiallinen_toiminta_id
	JOIN d_ammattiasema d28 on d28.id = ammattiasema_id
	JOIN d_koulutuksen_paattaneiden_toiminta d29 on d29.id = koulutuksen_paattaneiden_toiminta_id
	JOIN d_valtio d30 on d30.id = eumaa_id
	JOIN d_valtio d31 on d31.id = etamaa_id
WHERE (d24.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_koodi in (1, -1)) AND d15.vuosiselite <> ''2008''



























' 
GO
/****** Object:  View [dbo].[v_f_tab_koulutukseen_sijoittuneet_6v_ammatillinen]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_koulutukseen_sijoittuneet_6v_ammatillinen]'))
EXEC dbo.sp_executesql @statement = N'








CREATE VIEW [dbo].[v_f_tab_koulutukseen_sijoittuneet_6v_ammatillinen] AS

Select 
 [lkm_int2] = lkm
,[tilastovuosi] AS Tilastovuosi
,d17.tarkastelujakso AS Tarkastelujakso
,d16.sukupuoli AS Sukupuoli
,d2.aidinkieli_versio1 AS Äidinkieli
,d5.ika AS Ikä
,d5b.ika5v AS Ikäryhmä
,d6.tutkintoryhma AS "Tutkintoryhmä"
,d7.koulutus AS "Pohjakoulutus"
,d8.koulutusaste2002 AS "Koul. sijoittuneen koulutusaste"
,d8.koulutusala2002 AS "Koul. sijoittuneen koulutusala"
,d8.opintoala2002 AS "Koul. sijoittuneen opintoala"
,d8.koulutus AS "Koul. sijoittuneen koulutusnimike"
--,d3.kunta AS "Asuinkunta"
--,d3.maakunta AS "Asuinmaakunta"
--,d3.avi AS "Asuinpaikan AVI"
--,d3.ely AS "Asuinpaikan ELY"
--,d3.seutukunta AS "Asuinpaikan seutukunta"
--,d3.suuralue AS "Asuinpaikan suuralue"
--,d3.kuntaryhma AS "Asuinpaikan kuntaryhmä"
--,d3.laani AS "Asuinpaikan lääni"
--,d3.kielisuhde AS "Asuinpaikan kunnan kielisuhde"
,d4.maakunta AS "Koul. sijoittuneen opiskelumaakunta"
--,d4.avi AS "Koul. sijoittuneen opiskelupaikan AVI"
--,d4.ely AS "Koul. sijoittuneen opiskelupaikan ELY"
--,d4.seutukunta AS "Koul. sijoittuneen opiskelupaikan seutukunta"
--,d4.suuralue AS "Koul. sijoittuneen opiskelupaikan suuralue"
--,d4.kuntaryhma AS "Koul. sijoittuneen opiskelupaikan kuntaryhmä"
--,d4.laani AS "Koul. sijoittuneen opiskelupaikan lääni"
,d4b.maakunta AS "Tutkinnon suoritusmaakunta"
--,d4b.avi AS "Tutk. suorituspaikan AVI"
--,d4b.ely AS "Tutk. suorituspaikan ELY"
--,d4b.seutukunta AS "Tutk. suorituspaikan seutukunta"
--,d4b.suuralue AS "Tutk. suorituspaikan suuralue"
--,d4b.kuntaryhma AS "Tutk. suorituspaikan kuntaryhmä"
--,d4b.laani AS "Tutk. suorituspaikan lääni"
,d13.oppilaitos AS "Oppilaitos"
,d13.oppilaitostyyppi AS "Oppilaitostyyppi"
--,d13.oppilaitoksen_omistajatyyppi AS "Oppil. omistajatyyppi"
,d13.opetuskieli AS "Oppil. opetuskieli"
,d13.koulutuksen_jarjestaja AS "Koulutuksen järjestäjä"
--,d13.koulutuksen_jarjestajan_omistajatyyppi AS "Koul. järjestäjän omistajatyyppi"
--,d13.koulutuksen_jarjestajan_kieli AS "Koul. järjestäjän kieli"
--,d13.peruskoulujen_ryhmitys AS "Peruskoulujen ryhmitys"
--,d13.peruskoulujen_vuosilks AS "Peruskoulujen vuosiluokat"
,d14.oppilaitos AS "Koul. sijoittuneen oppilaitos"
--,d14.oppilaitostyyppi AS "Koul. sijoittuneen oppil.tyyppi"
--,d14.oppilaitoksen_omistajatyyppi AS "Koul. sijoittuneen oppil. omistajatyyppi"
--,d14.opetuskieli AS "Koul. sijoittuneen oppil. opetuskieli"
,d14.koulutuksen_jarjestaja AS "Koul. sijoittuneen koul. järjestäjä"
--,d14.koulutuksen_jarjestajan_omistajatyyppi AS "Koul. sijoittuneen koul. järjestäjän omistajatyyppi"
--,d14.koulutuksen_jarjestajan_kieli AS "Koul. sijoittuneen koul. järjestäjän kieli"
--,d14.peruskoulujen_ryhmitys AS "Koul. sijoittuneen peruskoulujen ryhmitys"
--,d14.peruskoulujen_vuosilks AS "Koul. sijoittuneen peruskoulujen vuosiluokat"
,d15.vuosiselite AS "Tutkinnon suoritusvuosi"
,d18.lukukausiselite AS "Tutkinnon suorituslukukausi"
--,d19.vuosiselite AS "Syntymävuosi"
--,d20.pohjoismaa AS "Pohjoismaan kansalainen"
,d21.kansalaisuus_versio1 AS "Kansalaisuus"
--,d22.opetuskieli AS "Opetuskieli"
--,d23.ammatillisen_koulutuksen_koulutuslaji AS "Tutkintotyyppi"
--,d24.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus AS "Järjestämistapa"
--,d25.nuorten_aikuisten_koulutus AS "Nuoret/aikuiset"
--,d26.moninkertainen_haku AS "Koul. sijoittuneiden haut"
--,d27.paaasiallinen_toiminta AS "Pääasiallinen toiminta"
--,d28.ammattiasema AS "Ammattiasema"
,d29.koulutuksen_paattaneiden_toiminta AS "Koul. päättäneiden toiminta"
--,d30.eumaa AS "EU-maan kansalainen"
--,d31.etamaa AS "ETA-maan kansalainen"

--ruotsi
,[tilastovuosi] AS Statistikår
,d17.tarkastelujakso_SV AS Granskningsperiod
,d16.sukupuoli_SV AS Kön
,d2.aidinkieli_versio1_SV AS Modersmål
,d5.ika_SV AS Ålder
,d5b.ika5v_SV AS Åldersgrupp
,d6.tutkintoryhma_SV AS Examenskategori
,d7.koulutus_SV AS Grundutbildning
,d8.koulutusaste2002_SV AS "Placering i utbildning – utbildningsnivå"
,d8.koulutusala2002_SV AS "Placering i utbildning – utbildningsområde"
,d8.opintoala2002_SV AS "Placering i utbildning – studieområde"
,d8.koulutus_SV AS "Placering i utbildning – utbildningsbenämning"
,d4.maakunta_SV AS "Placering i utbildning – landskapet för studieplatsen"
,d4b.maakunta_SV AS [Landskap där examen avlagts]
,d13.oppilaitos AS "Läroanstalt"
,d13.oppilaitostyyppi_SV AS Läroanstaltstyp
,d13.opetuskieli_SV AS [Läroanstaltens undervisningsspråk]
,d13.koulutuksen_jarjestaja_SV AS Utbildningsanordnare
,d14.oppilaitos_SV AS "Placering i utbildning – läroanstalt"
,d14.koulutuksen_jarjestaja_SV AS "Placering i utbildning – utbildningsanordnare"
,d15.vuosiselite_SV AS [År då utbildningen avlagts]
,d18.lukukausiselite_SV AS [Termin då utbildningen avlagts]
,d21.kansalaisuus_versio1_SV AS Medborgaskap
--,d25.nuorten_aikuisten_koulutus_SV AS [Ungdoms-/vuxenutbildning]
,d29.koulutuksen_paattaneiden_toiminta_SV AS [Sysselsättning av utexaminerade]

--englanti
,[tilastovuosi] AS [Statistical year]
,d17.tarkastelujakso_EN AS [Reference period]
,d16.sukupuoli_EN AS Gender
,d2.aidinkieli_versio1_EN AS [Mother tongue]
,d5.ika_EN AS Age
,d5b.ika5v_EN AS [Age group]
,d6.tutkintoryhma_EN AS [Degree/Qualification group]
,d7.koulutus_EN AS [Previous education]
,d8.koulutusaste2002_EN AS [Placed in further ed. - level of education]
,d8.koulutusala2002_EN AS [Placed in further ed. - field of education]
,d8.opintoala2002_EN AS [Placed in further ed. - subfield of education]
,d8.koulutus_EN AS [Placed in further ed. - name of education]
,d4.maakunta_EN AS [Placed in further ed. - region]
,d4b.maakunta_EN AS [Region of degree/qualification]
,d13.oppilaitos AS "Educational institution"
,d13.oppilaitostyyppi_EN AS [Type of institution]
,d13.opetuskieli_EN AS [Language of the institution]
,d13.koulutuksen_jarjestaja_EN AS [Education provider]
,d14.oppilaitos_EN AS [Placed in further ed. - ed. institution]
,d14.koulutuksen_jarjestaja_EN AS [Placed in further ed. - education provider]
,d15.vuosiselite_EN AS [Graduation year]
,d18.lukukausiselite_EN AS [Term of graduation]
,d21.kansalaisuus_versio1_EN AS Nationality
--,d25.nuorten_aikuisten_koulutus_EN AS [Youth/adult education]
,d29.koulutuksen_paattaneiden_toiminta_EN AS [Completers'' activity]

--isced
,d8.iscle2011 as "Koul. sijoittuneen koulutusaste, taso 1"
,d8.Koulutusaste_taso2 as "Koul. sijoittuneen koulutusaste, taso 2"
,d8.iscfibroad2013 as "Koul. sijoittuneen koulutusala, taso 1"
,d8.iscfinarrow2013 as "Koul. sijoittuneen koulutusala, taso 2"
,d8.iscfi2013 as "Koul. sijoittuneen koulutusala, taso 3"
,d8.OKM_ohjauksen_ala as "Koul. sijoittuneen OKM ohjauksen ala, korkeak."

,d8.iscle2011_SV as "Placering i utbildning – utb.nivå, nivå 1"
,d8.Koulutusaste_taso2_SV as "Placering i utbildning – utb.nivå, nivå 2"
,d8.iscfibroad2013_SV as "Placering i utbildning – utb.område, nivå 1"
,d8.iscfinarrow2013_SV as "Placering i utbildning – utb.område, nivå 2"
,d8.iscfi2013_SV as "Placering i utbildning – utb.område, nivå 3"
,d8.OKM_ohjauksen_ala_SV as "Placering i utbildning – UKM-styrningsområde, högskolor"

,d8.iscle2011_EN as "Placed in further ed. - level of education, tier 1"
,d8.Koulutusaste_taso2_EN as "Placed in further ed. - level of education, tier 2"
,d8.iscfibroad2013_EN as "Placed in further ed. - field of education, tier 1"
,d8.iscfinarrow2013_EN as "Placed in further ed. - field of education, tier 2"
,d8.iscfi2013_EN as "Placed in further ed. - field of education, tier 3"
,d8.OKM_ohjauksen_ala_EN as "Placed in further ed. - field of ed., HE steering"

,d8.jarjestys_iscle2011 as jarj_isced_koulast1
,d8.jarjestys_Koulutusaste_taso2 as jarj_isced_koulast2
,d8.jarjestys_iscfibroad2013 as jarj_isced_koulala1
,d8.jarjestys_iscfinarrow2013 as jarj_isced_koulala2
,d8.jarjestys_iscfi2013 as jarj_isced_koulala3
,d8.jarjestys_OKM_ohjauksen_ala as jarj_isced_okmohjaus1

--koodit
,d8.koulutusala2002_koodi as "Koodit Koulutusala 2002"
,d8.opintoala1995_koodi as "Koodit Koulutusala 1995"
,d8.opintoala2002_koodi as "Koodit Opintoala 2002"
,d8.koulutus_koodi as "Koodit Koulutusnimike"
,d8.koulutusaste2002_koodi as "Koodit Koulutusaste 2002"
,d14.koulutuksen_jarjestajakoodi as "Koodit Koul. sij. koul. järjestäjä"
,d14.oppilaitoskoodi as "Koodit Koul. sij. oppilaitos"
,d13.koulutuksen_jarjestajakoodi as "Koodit Koul. järjestäjä"
,d4b.maakunta_koodi as "Koodit Tutk. suor.maakunta"
,d4.maakunta_koodi as "Koodit Opiskelumaakunta"
,d8.iscle2011_koodi as "Koodit Koulutusaste, taso 1"
,d8.Koulutusaste_taso2_koodi as "Koodit Koulutusaste, taso 2"
,d8.iscfibroad2013_koodi as "Koodit Koulutusala, taso 1"
,d8.iscfinarrow2013_koodi as "Koodit Koulutusala, taso 2"
,d8.iscfi2013_koodi as "Koodit Koulutusala, taso 3"
,d8.OKM_ohjauksen_ala_koodi as "Koodit OKM ohjauksen ala, korkeak."

--järjestys
,d17.jarjestys AS tarkastelujakso_jarjestys
,d16.jarjestys AS sukupuoli_jarjestys
,d2.jarjestys AS aidinkieli_jarjestys
,d5.jarjestys_ika
,d5b.jarjestys_ika5v
,d6.jarjestys AS tutkintoryhma_jarjestys
,d7.jarjestys AS jarjestys_pohjakoulutus
,d8.jarjestys_koulutusaste2002 AS jarjestys_sij_koulutusaste2002
,d8.jarjestys_koulutusala2002 AS jarjestys_sij_koulutusala2002
,d8.jarjestys_opintoala2002 AS jarjestys_sij_opintoala
,d8.jarjestys AS jarjestys_sij_koulutusnimike
--,d3.jarjestys AS alueluokitus_jarjestys
--,d3.jarjestys_maakunta
--,d3.jarjestys_avi
--,d3.jarjestys_ely
--,d3.jarjestys_seutukunta
--,d3.jarjestys_suuralue
--,d3.jarjestys_kuntaryhma
--,d3.jarjestys_laani
--,d3.jarjestys_kielisuhde
,d4.jarjestys_maakunta AS sijoittuneen_al_jarjestys_maakunta
--,d4.jarjestys_avi AS sijoittuneen_al_jarjestys_avi
--,d4.jarjestys_ely AS sijoittuneen_al_jarjestys_ely
--,d4.jarjestys_seutukunta AS sijoittuneen_al_jarjestys_seutukunta
--,d4.jarjestys_suuralue AS sijoittuneen_al_jarjestys_suuralue
--,d4.jarjestys_kuntaryhma AS sijoittuneen_al_jarjestys_kuntaryhma
--,d4.jarjestys_laani AS sijoittuneen_al_jarjestys_laani
--,d4.jarjestys_kielisuhde AS sijoittuneen_al_jarjestys_kielisuhde
,d4b.jarjestys_maakunta AS tutksuor_al_jarjestys_maakunta
--,d4b.jarjestys_avi AS tutksuor_al_jarjestys_avi
--,d4b.jarjestys_ely AS tutksuor_al_jarjestys_ely
--,d4b.jarjestys_seutukunta AS tutksuor_al_jarjestys_seutukunta
--,d4b.jarjestys_suuralue AS tutksuor_al_jarjestys_suuralue
--,d4b.jarjestys_kuntaryhma AS tutksuor_al_jarjestys_kuntaryhma
--,d4b.jarjestys_laani AS tutksuor_al_jarjestys_laani
--,d4b.jarjestys_kielisuhde AS tutksuor_al_jarjestys_kielisuhde
--,d13.jarjestys_oppilaitos
,d13.jarjestys_oppilaitostyyppi
--,d13.jarjestys_omistajatyyppi
,d13.jarjestys_opetuskieli
--,d13.jarjestys_koulutuksen_jarjestaja
--,d13.jarjestys_koulutuksen_jarjestajan_kieli
--,d13.jarjestys_peruskoulujen_ryhmitys
--,d13.jarjestys_peruskoulujen_vuosilks
--,d14.jarjestys_oppilaitos AS sijoittuneen_jarjestys_oppilaitos
--,d14.jarjestys_oppilaitostyyppi AS sijoittuneen_jarjestys_oppilaitostyyppi
--,d14.jarjestys_omistajatyyppi AS sijoittuneen_jarjestys_omistajatyyppi
--,d14.jarjestys_opetuskieli AS sijoittuneen_jarjestys_opetuskieli
--,d14.jarjestys_koulutuksen_jarjestaja AS sijoittuneen_jarjestys_koulutuksen_jarjestaja
--,d14.jarjestys_koulutuksen_jarjestajan_kieli AS sijoittuneen_jarjestys_koulutuksen_jarjestajan_kieli
--,d14.jarjestys_peruskoulujen_ryhmitys AS sijoittuneen_peruskoulujen_ryhmitys
--,d14.jarjestys_peruskoulujen_vuosilks AS sijoittuneen_peruskoulujen_vuosilks
,d18.lukukausi AS tutksuor_lukukausi_jarjestys
--,d20.jarjestys AS pohjoismaa_jarjestys
,d21.jarjestys AS kansalaisuus_jarjestys
--,d22.jarjestys AS opetuskieli_jarjestys
--,d23.jarjestys AS tutktyyppi_jarjestys
--,d24.jarjestys AS jarjestamistapa_jarjestys
,d25.jarjestys AS nuoraik_jarjestys
--,d26.jarjestys AS monihaku_jarjestys
--,d27.jarjestys AS paaastoim_jarjestys
--,d28.jarjestys AS ammasema_jarjestys
,d29.jarjestys AS koul_paattaneiden_toiminta_jarjestys
--,d30.jarjestys_eumaa
--,d31.jarjestys_etamaa
,[lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa_ke] AS "Koul. sijoittuneet lukiokoulutuksessa ja ammatillisessa koulutuksessa"
,[lukiokoulutuksessa_ke] AS "Koul. sijoittuneet lukiokoulutuksessa"
,[ammatillisessa_koulutuksessa_ke] AS "Koul. sijoittuneet ammatillisessa koulutuksessa"
,[ammattikorkeakoulutuksessa_ke] AS "Koul. sijoittuneet ammattikorkeakoulutuksessa"
,[yliopistokoulutuksessa_ke] AS "Koul. sijoittuneet yliopistokoulutuksessa"
,[ammattikorkeakoulutuksessa_ja_yliopistokoulutuksessa_ke] AS "Koul. sijoittuneet ammattikorkeakoulutuksessa ja yliopistokoulutuksessa"
,[toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa_ke] AS "Koul. sijoittuneet toisen asteen ammatillisessa koulutuksessa ja korkeakoulutuksessa"
,[lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa]
,[lukiokoulutuksessa]
,[ammatillisessa_koulutuksessa]
,[ammattikorkeakoulutuksessa]
,[yliopistokoulutuksessa]
,[ammattikorkeakoulutuksessa_ja_yliopistokoulutuksessa]
,[toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa]
FROM            dbo.f_koulutukseen_sijoittuneet_6v
	JOIN d_aidinkieli_versio1 d2 ON d2.id = aidinkieli_versio_1_id
	JOIN d_sukupuoli d16 ON d16.id = sukupuoli_id
	JOIN d_tarkastelujakso d17 ON d17.id = tarkastelujakso_id
	JOIN d_alueluokitus d3 ON d3.id = asuinkunta_id
	JOIN d_alueluokitus d4 ON d4.id = koulutukseen_sijoittuneen_maakunta_id
	JOIN d_alueluokitus d4b ON d4b.id = pohjakoulutuksen_tutkinnon_suoritusmaakunta_id
	JOIN d_ika d5 ON d5.id = ika_1v_id
	JOIN d_ika d5b ON d5b.id = ika_5v_id
	JOIN d_tutkintoryhma d6 ON d6.id = tutkintoryhma_id
	JOIN d_koulutusluokitus d7 ON d7.id = pohjakoulutus_id
	JOIN d_koulutusluokitus d8 ON d8.id = koulutukseen_sijoittuneen_koulutus_id
	JOIN d_oppilaitoksen_taustatiedot d13 ON d13.id = pohjakoulutuksen_oppilaitos_id
	JOIN d_oppilaitoksen_taustatiedot d14 ON d14.id = koulutukseen_sijoittuneen_oppilaitos_id
	JOIN d_kausi d15 on d15.kausi_id = suoritusvuosi_id
	JOIN d_kausi d18 on d18.kausi_id = suorituslukukausi_id
	JOIN d_kausi d19 on d19.kausi_id = syntymavuosi_id
	JOIN d_pohjoismaa d20 on d20.id = pohjoismaa_id
	JOIN d_kansalaisuus_versio1 d21 on d21.id = kansalaisuus_id
	JOIN d_opetuskieli d22 on d22.id = pohjakoulutuksen_opetuskieli_id
	JOIN d_ammatillisen_koulutuksen_koulutuslaji d23 on d23.id = pohjakoulutuksen_koulutuslaji_id
	JOIN d_opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus d24 on d24.id = pohjakoulutuksen_tutktav_id
	JOIN d_nuorten_aikuisten_koulutus d25 on d25.id = pohjakoulutuksen_aikoul_id
	JOIN d_moninkertainen_haku d26 on d26.id = moninkertainen_haku_id
	JOIN d_paaasiallinen_toiminta d27 on d27.id = paaasiallinen_toiminta_id
	JOIN d_ammattiasema d28 on d28.id = ammattiasema_id
	JOIN d_koulutuksen_paattaneiden_toiminta d29 on d29.id = koulutuksen_paattaneiden_toiminta_id
	JOIN d_valtio d30 on d30.id = eumaa_id
	JOIN d_valtio d31 on d31.id = etamaa_id
WHERE tutkintoryhma_koodi = 3 AND (d24.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_koodi in (1, -1))









' 
GO
/****** Object:  View [dbo].[v_f_tab_koulutukseen_sijoittuneet_6v_lukio]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_koulutukseen_sijoittuneet_6v_lukio]'))
EXEC dbo.sp_executesql @statement = N'








CREATE VIEW [dbo].[v_f_tab_koulutukseen_sijoittuneet_6v_lukio] AS

Select [lkm_int2] = lkm
,[tilastovuosi] AS Tilastovuosi
,d17.tarkastelujakso AS Tarkastelujakso
,d16.sukupuoli AS Sukupuoli
,d2.aidinkieli_versio1 AS Äidinkieli
,d5.ika AS Ikä
,d5b.ika5v AS Ikäryhmä
,d6.tutkintoryhma AS "Tutkintoryhmä"
,d7.koulutus AS "Pohjakoulutus"
,d8.koulutusaste2002 AS "Koul. sijoittuneen koulutusaste"
,d8.koulutusala2002 AS "Koul. sijoittuneen koulutusala"
,d8.opintoala2002 AS "Koul. sijoittuneen opintoala"
,d8.koulutus AS "Koul. sijoittuneen koulutusnimike"
--,d3.kunta AS "Asuinkunta"
--,d3.maakunta AS "Asuinmaakunta"
--,d3.avi AS "Asuinpaikan AVI"
--,d3.ely AS "Asuinpaikan ELY"
--,d3.seutukunta AS "Asuinpaikan seutukunta"
--,d3.suuralue AS "Asuinpaikan suuralue"
--,d3.kuntaryhma AS "Asuinpaikan kuntaryhmä"
--,d3.laani AS "Asuinpaikan lääni"
--,d3.kielisuhde AS "Asuinpaikan kunnan kielisuhde"
,d4.maakunta AS "Koul. sijoittuneen opiskelumaakunta"
--,d4.avi AS "Koul. sijoittuneen opiskelupaikan AVI"
--,d4.ely AS "Koul. sijoittuneen opiskelupaikan ELY"
--,d4.seutukunta AS "Koul. sijoittuneen opiskelupaikan seutukunta"
--,d4.suuralue AS "Koul. sijoittuneen opiskelupaikan suuralue"
--,d4.kuntaryhma AS "Koul. sijoittuneen opiskelupaikan kuntaryhmä"
--,d4.laani AS "Koul. sijoittuneen opiskelupaikan lääni"
,d4b.maakunta AS "Tutkinnon suoritusmaakunta"
--,d4b.avi AS "Tutk. suorituspaikan AVI"
--,d4b.ely AS "Tutk. suorituspaikan ELY"
--,d4b.seutukunta AS "Tutk. suorituspaikan seutukunta"
--,d4b.suuralue AS "Tutk. suorituspaikan suuralue"
--,d4b.kuntaryhma AS "Tutk. suorituspaikan kuntaryhmä"
--,d4b.laani AS "Tutk. suorituspaikan lääni"
,d13.oppilaitos AS "Oppilaitos"
,d13.oppilaitostyyppi AS "Oppilaitostyyppi"
--,d13.oppilaitoksen_omistajatyyppi AS "Oppil. omistajatyyppi"
,d13.opetuskieli AS "Oppil. opetuskieli"
,d13.koulutuksen_jarjestaja AS "Koulutuksen järjestäjä"
--,d13.koulutuksen_jarjestajan_omistajatyyppi AS "Koul. järjestäjän omistajatyyppi"
--,d13.koulutuksen_jarjestajan_kieli AS "Koul. järjestäjän kieli"
--,d13.peruskoulujen_ryhmitys AS "Peruskoulujen ryhmitys"
--,d13.peruskoulujen_vuosilks AS "Peruskoulujen vuosiluokat"
,d14.oppilaitos AS "Koul. sijoittuneen oppilaitos"
--,d14.oppilaitostyyppi AS "Koul. sijoittuneen oppil.tyyppi"
--,d14.oppilaitoksen_omistajatyyppi AS "Koul. sijoittuneen oppil. omistajatyyppi"
--,d14.opetuskieli AS "Koul. sijoittuneen oppil. opetuskieli"
,d14.koulutuksen_jarjestaja AS "Koul. sijoittuneen koul. järjestäjä"
--,d14.koulutuksen_jarjestajan_omistajatyyppi AS "Koul. sijoittuneen koul. järjestäjän omistajatyyppi"
--,d14.koulutuksen_jarjestajan_kieli AS "Koul. sijoittuneen koul. järjestäjän kieli"
--,d14.peruskoulujen_ryhmitys AS "Koul. sijoittuneen peruskoulujen ryhmitys"
--,d14.peruskoulujen_vuosilks AS "Koul. sijoittuneen peruskoulujen vuosiluokat"
,d15.vuosiselite AS "Tutkinnon suoritusvuosi"
,d18.lukukausiselite AS "Tutkinnon suorituslukukausi"
--,d19.vuosiselite AS "Syntymävuosi"
--,d20.pohjoismaa AS "Pohjoismaan kansalainen"
,d21.kansalaisuus_versio1 AS "Kansalaisuus"
--,d22.opetuskieli AS "Opetuskieli"
--,d23.ammatillisen_koulutuksen_koulutuslaji AS "Tutkintotyyppi"
--,d24.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus AS "Järjestämistapa"
,d25.nuorten_aikuisten_koulutus AS "Nuoret/aikuiset"
--,d26.moninkertainen_haku AS "Koul. sijoittuneiden haut"
--,d27.paaasiallinen_toiminta AS "Pääasiallinen toiminta"
--,d28.ammattiasema AS "Ammattiasema"
,d29.koulutuksen_paattaneiden_toiminta AS "Koul. päättäneiden toiminta"
--,d30.eumaa AS "EU-maan kansalainen"
--,d31.etamaa AS "ETA-maan kansalainen"

--ruotsi
,[tilastovuosi] AS Statistikår
,d17.tarkastelujakso_SV AS Granskningsperiod
,d16.sukupuoli_SV AS Kön
,d2.aidinkieli_versio1_SV AS Modersmål
,d5.ika_SV AS Ålder
,d5b.ika5v_SV AS Åldersgrupp
,d6.tutkintoryhma_SV AS Examenskategori
,d7.koulutus_SV AS Grundutbildning
,d8.koulutusaste2002_SV AS "Placering i utbildning – utbildningsnivå"
,d8.koulutusala2002_SV AS "Placering i utbildning – utbildningsområde"
,d8.opintoala2002_SV AS "Placering i utbildning – studieområde"
,d8.koulutus_SV AS "Placering i utbildning – utbildningsbenämning"
,d4.maakunta_SV AS "Placering i utbildning – landskapet för studieplatsen"
,d4b.maakunta_SV AS [Landskap där examen avlagts]
,d13.oppilaitos AS "Läroanstalt"
,d13.oppilaitostyyppi_SV AS Läroanstaltstyp
,d13.opetuskieli_SV AS [Läroanstaltens undervisningsspråk]
,d13.koulutuksen_jarjestaja_SV AS Utbildningsanordnare
,d14.oppilaitos_SV AS "Placering i utbildning – läroanstalt"
,d14.koulutuksen_jarjestaja_SV AS "Placering i utbildning – utbildningsanordnare"
,d15.vuosiselite_SV AS [År då utbildningen avlagts]
,d18.lukukausiselite_SV AS [Termin då utbildningen avlagts]
,d21.kansalaisuus_versio1_SV AS Medborgaskap
,d25.nuorten_aikuisten_koulutus_SV AS [Ungdoms-/vuxenutbildning]
,d29.koulutuksen_paattaneiden_toiminta_SV AS [Sysselsättning av utexaminerade]

--englanti
,[tilastovuosi] AS [Statistical year]
,d17.tarkastelujakso_EN AS [Reference period]
,d16.sukupuoli_EN AS Gender
,d2.aidinkieli_versio1_EN AS [Mother tongue]
,d5.ika_EN AS Age
,d5b.ika5v_EN AS [Age group]
,d6.tutkintoryhma_EN AS [Degree/Qualification group]
,d7.koulutus_EN AS [Previous education]
,d8.koulutusaste2002_EN AS [Placed in further ed. - level of education]
,d8.koulutusala2002_EN AS [Placed in further ed. - field of education]
,d8.opintoala2002_EN AS [Placed in further ed. - subfield of education]
,d8.koulutus_EN AS [Placed in further ed. - name of education]
,d4.maakunta_EN AS [Placed in further ed. - region]
,d4b.maakunta_EN AS [Region of degree/qualification]
,d13.oppilaitos AS "Educational institution"
,d13.oppilaitostyyppi_EN AS [Type of institution]
,d13.opetuskieli_EN AS [Language of the institution]
,d13.koulutuksen_jarjestaja_EN AS [Education provider]
,d14.oppilaitos_EN AS [Placed in further ed. - ed. institution]
,d14.koulutuksen_jarjestaja_EN AS [Placed in further ed. - education provider]
,d15.vuosiselite_EN AS [Graduation year]
,d18.lukukausiselite_EN AS [Term of graduation]
,d21.kansalaisuus_versio1_EN AS Nationality
,d25.nuorten_aikuisten_koulutus_EN AS [Youth/adult education]
,d29.koulutuksen_paattaneiden_toiminta_EN AS [Completers'' activity]

--isced
,d8.iscle2011 as "Koul. sijoittuneen koulutusaste, taso 1"
,d8.Koulutusaste_taso2 as "Koul. sijoittuneen koulutusaste, taso 2"
,d8.iscfibroad2013 as "Koul. sijoittuneen koulutusala, taso 1"
,d8.iscfinarrow2013 as "Koul. sijoittuneen koulutusala, taso 2"
,d8.iscfi2013 as "Koul. sijoittuneen koulutusala, taso 3"
,d8.OKM_ohjauksen_ala as "Koul. sijoittuneen OKM ohjauksen ala, korkeak."

,d8.iscle2011_SV as "Placering i utbildning – utb.nivå, nivå 1"
,d8.Koulutusaste_taso2_SV as "Placering i utbildning – utb.nivå, nivå 2"
,d8.iscfibroad2013_SV as "Placering i utbildning – utb.område, nivå 1"
,d8.iscfinarrow2013_SV as "Placering i utbildning – utb.område, nivå 2"
,d8.iscfi2013_SV as "Placering i utbildning – utb.område, nivå 3"
,d8.OKM_ohjauksen_ala_SV as "Placering i utbildning – UKM-styrningsområde, högskolor"

,d8.iscle2011_EN as "Placed in further ed. - level of education, tier 1"
,d8.Koulutusaste_taso2_EN as "Placed in further ed. - level of education, tier 2"
,d8.iscfibroad2013_EN as "Placed in further ed. - field of education, tier 1"
,d8.iscfinarrow2013_EN as "Placed in further ed. - field of education, tier 2"
,d8.iscfi2013_EN as "Placed in further ed. - field of education, tier 3"
,d8.OKM_ohjauksen_ala_EN as "Placed in further ed. - field of ed., HE steering"

,d8.jarjestys_iscle2011 as jarj_isced_koulast1
,d8.jarjestys_Koulutusaste_taso2 as jarj_isced_koulast2
,d8.jarjestys_iscfibroad2013 as jarj_isced_koulala1
,d8.jarjestys_iscfinarrow2013 as jarj_isced_koulala2
,d8.jarjestys_iscfi2013 as jarj_isced_koulala3
,d8.jarjestys_OKM_ohjauksen_ala as jarj_isced_okmohjaus1

--koodit
,d8.koulutusala2002_koodi as "Koodit Koulutusala 2002"
,d8.opintoala1995_koodi as "Koodit Koulutusala 1995"
,d8.opintoala2002_koodi as "Koodit Opintoala 2002"
,d8.koulutus_koodi as "Koodit Koulutusnimike"
,d8.koulutusaste2002_koodi as "Koodit Koulutusaste 2002"
,d14.koulutuksen_jarjestajakoodi as "Koodit Koul. sij. koul. järjestäjä"
,d14.oppilaitoskoodi as "Koodit Koul. sij. oppilaitos"
,d13.koulutuksen_jarjestajakoodi as "Koodit Koul. järjestäjä"
,d4b.maakunta_koodi as "Koodit Tutk. suor.maakunta"
,d4.maakunta_koodi as "Koodit Opiskelumaakunta"
,d8.iscle2011_koodi as "Koodit Koulutusaste, taso 1"
,d8.Koulutusaste_taso2_koodi as "Koodit Koulutusaste, taso 2"
,d8.iscfibroad2013_koodi as "Koodit Koulutusala, taso 1"
,d8.iscfinarrow2013_koodi as "Koodit Koulutusala, taso 2"
,d8.iscfi2013_koodi as "Koodit Koulutusala, taso 3"
,d8.OKM_ohjauksen_ala_koodi as "Koodit OKM ohjauksen ala, korkeak."

--järjestys
,d17.jarjestys AS tarkastelujakso_jarjestys
,d16.jarjestys AS sukupuoli_jarjestys
,d2.jarjestys AS aidinkieli_jarjestys
,d5.jarjestys_ika
,d5b.jarjestys_ika5v
,d6.jarjestys AS tutkintoryhma_jarjestys
,d7.jarjestys AS jarjestys_pohjakoulutus
,d8.jarjestys_koulutusaste2002 AS jarjestys_sij_koulutusaste2002
,d8.jarjestys_koulutusala2002 AS jarjestys_sij_koulutusala2002
,d8.jarjestys_opintoala2002 AS jarjestys_sij_opintoala
,d8.jarjestys AS jarjestys_sij_koulutusnimike
--,d3.jarjestys AS alueluokitus_jarjestys
--,d3.jarjestys_maakunta
--,d3.jarjestys_avi
--,d3.jarjestys_ely
--,d3.jarjestys_seutukunta
--,d3.jarjestys_suuralue
--,d3.jarjestys_kuntaryhma
--,d3.jarjestys_laani
--,d3.jarjestys_kielisuhde
,d4.jarjestys_maakunta AS sijoittuneen_al_jarjestys_maakunta
--,d4.jarjestys_avi AS sijoittuneen_al_jarjestys_avi
--,d4.jarjestys_ely AS sijoittuneen_al_jarjestys_ely
--,d4.jarjestys_seutukunta AS sijoittuneen_al_jarjestys_seutukunta
--,d4.jarjestys_suuralue AS sijoittuneen_al_jarjestys_suuralue
--,d4.jarjestys_kuntaryhma AS sijoittuneen_al_jarjestys_kuntaryhma
--,d4.jarjestys_laani AS sijoittuneen_al_jarjestys_laani
--,d4.jarjestys_kielisuhde AS sijoittuneen_al_jarjestys_kielisuhde
,d4b.jarjestys_maakunta AS tutksuor_al_jarjestys_maakunta
--,d4b.jarjestys_avi AS tutksuor_al_jarjestys_avi
--,d4b.jarjestys_ely AS tutksuor_al_jarjestys_ely
--,d4b.jarjestys_seutukunta AS tutksuor_al_jarjestys_seutukunta
--,d4b.jarjestys_suuralue AS tutksuor_al_jarjestys_suuralue
--,d4b.jarjestys_kuntaryhma AS tutksuor_al_jarjestys_kuntaryhma
--,d4b.jarjestys_laani AS tutksuor_al_jarjestys_laani
--,d4b.jarjestys_kielisuhde AS tutksuor_al_jarjestys_kielisuhde
--,d13.jarjestys_oppilaitos
,d13.jarjestys_oppilaitostyyppi
--,d13.jarjestys_omistajatyyppi
,d13.jarjestys_opetuskieli
--,d13.jarjestys_koulutuksen_jarjestaja
--,d13.jarjestys_koulutuksen_jarjestajan_kieli
--,d13.jarjestys_peruskoulujen_ryhmitys
--,d13.jarjestys_peruskoulujen_vuosilks
--,d14.jarjestys_oppilaitos AS sijoittuneen_jarjestys_oppilaitos
--,d14.jarjestys_oppilaitostyyppi AS sijoittuneen_jarjestys_oppilaitostyyppi
--,d14.jarjestys_omistajatyyppi AS sijoittuneen_jarjestys_omistajatyyppi
--,d14.jarjestys_opetuskieli AS sijoittuneen_jarjestys_opetuskieli
--,d14.jarjestys_koulutuksen_jarjestaja AS sijoittuneen_jarjestys_koulutuksen_jarjestaja
--,d14.jarjestys_koulutuksen_jarjestajan_kieli AS sijoittuneen_jarjestys_koulutuksen_jarjestajan_kieli
--,d14.jarjestys_peruskoulujen_ryhmitys AS sijoittuneen_peruskoulujen_ryhmitys
--,d14.jarjestys_peruskoulujen_vuosilks AS sijoittuneen_peruskoulujen_vuosilks
,d18.lukukausi AS tutksuor_lukukausi_jarjestys
--,d20.jarjestys AS pohjoismaa_jarjestys
,d21.jarjestys AS kansalaisuus_jarjestys
--,d22.jarjestys AS opetuskieli_jarjestys
--,d23.jarjestys AS tutktyyppi_jarjestys
--,d24.jarjestys AS jarjestamistapa_jarjestys
,d25.jarjestys AS nuoraik_jarjestys
--,d26.jarjestys AS monihaku_jarjestys
--,d27.jarjestys AS paaastoim_jarjestys
--,d28.jarjestys AS ammasema_jarjestys
,d29.jarjestys AS koul_paattaneiden_toiminta_jarjestys
--,d30.jarjestys_eumaa
--,d31.jarjestys_etamaa
,[lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa_ke] AS "Koul. sijoittuneet lukiokoulutuksessa ja ammatillisessa koulutuksessa"
,[lukiokoulutuksessa_ke] AS "Koul. sijoittuneet lukiokoulutuksessa"
,[ammatillisessa_koulutuksessa_ke] AS "Koul. sijoittuneet ammatillisessa koulutuksessa"
,[ammattikorkeakoulutuksessa_ke] AS "Koul. sijoittuneet ammattikorkeakoulutuksessa"
,[yliopistokoulutuksessa_ke] AS "Koul. sijoittuneet yliopistokoulutuksessa"
,[ammattikorkeakoulutuksessa_ja_yliopistokoulutuksessa_ke] AS "Koul. sijoittuneet ammattikorkeakoulutuksessa ja yliopistokoulutuksessa"
,[toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa_ke] AS "Koul. sijoittuneet toisen asteen ammatillisessa koulutuksessa ja korkeakoulutuksessa"
,[lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa]
,[lukiokoulutuksessa]
,[ammatillisessa_koulutuksessa]
,[ammattikorkeakoulutuksessa]
,[yliopistokoulutuksessa]
,[ammattikorkeakoulutuksessa_ja_yliopistokoulutuksessa]
,[toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa]
FROM            dbo.f_koulutukseen_sijoittuneet_6v
	JOIN d_aidinkieli_versio1 d2 ON d2.id = aidinkieli_versio_1_id
	JOIN d_sukupuoli d16 ON d16.id = sukupuoli_id
	JOIN d_tarkastelujakso d17 ON d17.id = tarkastelujakso_id
	JOIN d_alueluokitus d3 ON d3.id = asuinkunta_id
	JOIN d_alueluokitus d4 ON d4.id = koulutukseen_sijoittuneen_maakunta_id
	JOIN d_alueluokitus d4b ON d4b.id = pohjakoulutuksen_tutkinnon_suoritusmaakunta_id
	JOIN d_ika d5 ON d5.id = ika_1v_id
	JOIN d_ika d5b ON d5b.id = ika_5v_id
	JOIN d_tutkintoryhma d6 ON d6.id = tutkintoryhma_id
	JOIN d_koulutusluokitus d7 ON d7.id = pohjakoulutus_id
	JOIN d_koulutusluokitus d8 ON d8.id = koulutukseen_sijoittuneen_koulutus_id
	JOIN d_oppilaitoksen_taustatiedot d13 ON d13.id = pohjakoulutuksen_oppilaitos_id
	JOIN d_oppilaitoksen_taustatiedot d14 ON d14.id = koulutukseen_sijoittuneen_oppilaitos_id
	JOIN d_kausi d15 on d15.kausi_id = suoritusvuosi_id
	JOIN d_kausi d18 on d18.kausi_id = suorituslukukausi_id
	JOIN d_kausi d19 on d19.kausi_id = syntymavuosi_id
	JOIN d_pohjoismaa d20 on d20.id = pohjoismaa_id
	JOIN d_kansalaisuus_versio1 d21 on d21.id = kansalaisuus_id
	JOIN d_opetuskieli d22 on d22.id = pohjakoulutuksen_opetuskieli_id
	JOIN d_ammatillisen_koulutuksen_koulutuslaji d23 on d23.id = pohjakoulutuksen_koulutuslaji_id
	JOIN d_opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus d24 on d24.id = pohjakoulutuksen_tutktav_id
	JOIN d_nuorten_aikuisten_koulutus d25 on d25.id = pohjakoulutuksen_aikoul_id
	JOIN d_moninkertainen_haku d26 on d26.id = moninkertainen_haku_id
	JOIN d_paaasiallinen_toiminta d27 on d27.id = paaasiallinen_toiminta_id
	JOIN d_ammattiasema d28 on d28.id = ammattiasema_id
	JOIN d_koulutuksen_paattaneiden_toiminta d29 on d29.id = koulutuksen_paattaneiden_toiminta_id
	JOIN d_valtio d30 on d30.id = eumaa_id
	JOIN d_valtio d31 on d31.id = etamaa_id
WHERE tutkintoryhma_koodi = 2 AND [Tilastovuosi] <> ''2008''









' 
GO
/****** Object:  View [dbo].[v_f_tab_koulutukseen_sijoittuneet_6v_peruskoulu]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_koulutukseen_sijoittuneet_6v_peruskoulu]'))
EXEC dbo.sp_executesql @statement = N'










CREATE VIEW [dbo].[v_f_tab_koulutukseen_sijoittuneet_6v_peruskoulu] AS

Select
[lkm_int2] = lkm
,[tilastovuosi] AS Tilastovuosi
,d17.tarkastelujakso AS Tarkastelujakso
,d16.sukupuoli AS Sukupuoli
,d2.aidinkieli_versio1 AS Äidinkieli
,d5.ika AS Ikä
,d5b.ika5v AS Ikäryhmä
,d6.tutkintoryhma AS "Tutkintoryhmä"
,d7.koulutus AS "Pohjakoulutus"
,d8.koulutusaste2002 AS "Koul. sijoittuneen koulutusaste"
,d8.koulutusala2002 AS "Koul. sijoittuneen koulutusala"
,d8.opintoala2002 AS "Koul. sijoittuneen opintoala"
,d8.koulutus AS "Koul. sijoittuneen koulutusnimike"
--,d3.kunta AS "Asuinkunta"
--,d3.maakunta AS "Asuinmaakunta"
--,d3.avi AS "Asuinpaikan AVI"
--,d3.ely AS "Asuinpaikan ELY"
--,d3.seutukunta AS "Asuinpaikan seutukunta"
--,d3.suuralue AS "Asuinpaikan suuralue"
--,d3.kuntaryhma AS "Asuinpaikan kuntaryhmä"
--,d3.laani AS "Asuinpaikan lääni"
--,d3.kielisuhde AS "Asuinpaikan kunnan kielisuhde"
,d4.maakunta AS "Koul. sijoittuneen opiskelumaakunta"
--,d4.avi AS "Koul. sijoittuneen opiskelupaikan AVI"
--,d4.ely AS "Koul. sijoittuneen opiskelupaikan ELY"
--,d4.seutukunta AS "Koul. sijoittuneen opiskelupaikan seutukunta"
--,d4.suuralue AS "Koul. sijoittuneen opiskelupaikan suuralue"
--,d4.kuntaryhma AS "Koul. sijoittuneen opiskelupaikan kuntaryhmä"
--,d4.laani AS "Koul. sijoittuneen opiskelupaikan lääni"
,d4b.maakunta AS "Tutkinnon suoritusmaakunta"
--,d4b.avi AS "Tutk. suorituspaikan AVI"
--,d4b.ely AS "Tutk. suorituspaikan ELY"
--,d4b.seutukunta AS "Tutk. suorituspaikan seutukunta"
--,d4b.suuralue AS "Tutk. suorituspaikan suuralue"
--,d4b.kuntaryhma AS "Tutk. suorituspaikan kuntaryhmä"
--,d4b.laani AS "Tutk. suorituspaikan lääni"
,d13.oppilaitos AS "Oppilaitos"
,d13.oppilaitostyyppi AS "Oppilaitostyyppi"
--,d13.oppilaitoksen_omistajatyyppi AS "Oppil. omistajatyyppi"
,d13.opetuskieli AS "Oppil. opetuskieli"
,d13.koulutuksen_jarjestaja AS "Koulutuksen järjestäjä"
--,d13.koulutuksen_jarjestajan_omistajatyyppi AS "Koul. järjestäjän omistajatyyppi"
--,d13.koulutuksen_jarjestajan_kieli AS "Koul. järjestäjän kieli"
--,d13.peruskoulujen_ryhmitys AS "Peruskoulujen ryhmitys"
--,d13.peruskoulujen_vuosilks AS "Peruskoulujen vuosiluokat"
,d14.oppilaitos AS "Koul. sijoittuneen oppilaitos"
--,d14.oppilaitostyyppi AS "Koul. sijoittuneen oppil.tyyppi"
--,d14.oppilaitoksen_omistajatyyppi AS "Koul. sijoittuneen oppil. omistajatyyppi"
--,d14.opetuskieli AS "Koul. sijoittuneen oppil. opetuskieli"
,d14.koulutuksen_jarjestaja AS "Koul. sijoittuneen koul. järjestäjä"
--,d14.koulutuksen_jarjestajan_omistajatyyppi AS "Koul. sijoittuneen koul. järjestäjän omistajatyyppi"
--,d14.koulutuksen_jarjestajan_kieli AS "Koul. sijoittuneen koul. järjestäjän kieli"
--,d14.peruskoulujen_ryhmitys AS "Koul. sijoittuneen peruskoulujen ryhmitys"
--,d14.peruskoulujen_vuosilks AS "Koul. sijoittuneen peruskoulujen vuosiluokat"
,d15.vuosiselite AS "Tutkinnon suoritusvuosi"
,d18.lukukausiselite AS "Tutkinnon suorituslukukausi"
--,d19.vuosiselite AS "Syntymävuosi"
--,d20.pohjoismaa AS "Pohjoismaan kansalainen"
,d21.kansalaisuus_versio1 AS "Kansalaisuus"
--,d22.opetuskieli AS "Opetuskieli"
--,d23.ammatillisen_koulutuksen_koulutuslaji AS "Tutkintotyyppi"
--,d24.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus AS "Järjestämistapa"
--,d25.nuorten_aikuisten_koulutus AS "Nuoret/aikuiset"
--,d26.moninkertainen_haku AS "Koul. sijoittuneiden haut"
--,d27.paaasiallinen_toiminta AS "Pääasiallinen toiminta"
--,d28.ammattiasema AS "Ammattiasema"
,d29.koulutuksen_paattaneiden_toiminta AS "Koul. päättäneiden toiminta"
--,d30.eumaa AS "EU-maan kansalainen"
--,d31.etamaa AS "ETA-maan kansalainen"

--ruotsi
,[tilastovuosi] AS Statistikår
,d17.tarkastelujakso_SV AS Granskningsperiod
,d16.sukupuoli_SV AS Kön
,d2.aidinkieli_versio1_SV AS Modersmål
,d5.ika_SV AS Ålder
,d5b.ika5v_SV AS Åldersgrupp
,d6.tutkintoryhma_SV AS Examenskategori
,d7.koulutus_SV AS Grundutbildning
,d8.koulutusaste2002_SV AS "Placering i utbildning – utbildningsnivå"
,d8.koulutusala2002_SV AS "Placering i utbildning – utbildningsområde"
,d8.opintoala2002_SV AS "Placering i utbildning – studieområde"
,d8.koulutus_SV AS "Placering i utbildning – utbildningsbenämning"
,d4.maakunta_SV AS "Placering i utbildning – landskapet för studieplatsen"
,d4b.maakunta_SV AS [Landskap där examen avlagts]
,d13.oppilaitos AS "Läroanstalt"
,d13.oppilaitostyyppi_SV AS Läroanstaltstyp
,d13.opetuskieli_SV AS [Läroanstaltens undervisningsspråk]
,d13.koulutuksen_jarjestaja_SV AS Utbildningsanordnare
,d14.oppilaitos_SV AS "Placering i utbildning – läroanstalt"
,d14.koulutuksen_jarjestaja_SV AS "Placering i utbildning – utbildningsanordnare"
,d15.vuosiselite_SV AS [År då utbildningen avlagts]
,d18.lukukausiselite_SV AS [Termin då utbildningen avlagts]
,d21.kansalaisuus_versio1_SV AS Medborgaskap
--,d25.nuorten_aikuisten_koulutus_SV AS [Ungdoms-/vuxenutbildning]
,d29.koulutuksen_paattaneiden_toiminta_SV AS [Sysselsättning av utexaminerade]

--englanti
,[tilastovuosi] AS [Statistical year]
,d17.tarkastelujakso_EN AS [Reference period]
,d16.sukupuoli_EN AS Gender
,d2.aidinkieli_versio1_EN AS [Mother tongue]
,d5.ika_EN AS Age
,d5b.ika5v_EN AS [Age group]
,d6.tutkintoryhma_EN AS [Degree/Qualification group]
,d7.koulutus_EN AS [Previous education]
,d8.koulutusaste2002_EN AS [Placed in further ed. - level of education]
,d8.koulutusala2002_EN AS [Placed in further ed. - field of education]
,d8.opintoala2002_EN AS [Placed in further ed. - subfield of education]
,d8.koulutus_EN AS [Placed in further ed. - name of education]
,d4.maakunta_EN AS [Placed in further ed. - region]
,d4b.maakunta_EN AS [Region of degree/qualification]
,d13.oppilaitos AS "Educational institution"
,d13.oppilaitostyyppi_EN AS [Type of institution]
,d13.opetuskieli_EN AS [Language of the institution]
,d13.koulutuksen_jarjestaja_EN AS [Education provider]
,d14.oppilaitos_EN AS [Placed in further ed. - ed. institution]
,d14.koulutuksen_jarjestaja_EN AS [Placed in further ed. - education provider]
,d15.vuosiselite_EN AS [Graduation year]
,d18.lukukausiselite_EN AS [Term of graduation]
,d21.kansalaisuus_versio1_EN AS Nationality
--,d25.nuorten_aikuisten_koulutus_EN AS [Youth/adult education]
,d29.koulutuksen_paattaneiden_toiminta_EN AS [Completers'' activity]

--isced
,d8.iscle2011 as "Koul. sijoittuneen koulutusaste, taso 1"
,d8.Koulutusaste_taso2 as "Koul. sijoittuneen koulutusaste, taso 2"
,d8.iscfibroad2013 as "Koul. sijoittuneen koulutusala, taso 1"
,d8.iscfinarrow2013 as "Koul. sijoittuneen koulutusala, taso 2"
,d8.iscfi2013 as "Koul. sijoittuneen koulutusala, taso 3"
,d8.OKM_ohjauksen_ala as "Koul. sijoittuneen OKM ohjauksen ala, korkeak."

,d8.iscle2011_SV as "Placering i utbildning – utb.nivå, nivå 1"
,d8.Koulutusaste_taso2_SV as "Placering i utbildning – utb.nivå, nivå 2"
,d8.iscfibroad2013_SV as "Placering i utbildning – utb.område, nivå 1"
,d8.iscfinarrow2013_SV as "Placering i utbildning – utb.område, nivå 2"
,d8.iscfi2013_SV as "Placering i utbildning – utb.område, nivå 3"
,d8.OKM_ohjauksen_ala_SV as "Placering i utbildning – UKM-styrningsområde, högskolor"

,d8.iscle2011_EN as "Placed in further ed. - level of education, tier 1"
,d8.Koulutusaste_taso2_EN as "Placed in further ed. - level of education, tier 2"
,d8.iscfibroad2013_EN as "Placed in further ed. - field of education, tier 1"
,d8.iscfinarrow2013_EN as "Placed in further ed. - field of education, tier 2"
,d8.iscfi2013_EN as "Placed in further ed. - field of education, tier 3"
,d8.OKM_ohjauksen_ala_EN as "Placed in further ed. - field of ed., HE steering"

,d8.jarjestys_iscle2011 as jarj_isced_koulast1
,d8.jarjestys_Koulutusaste_taso2 as jarj_isced_koulast2
,d8.jarjestys_iscfibroad2013 as jarj_isced_koulala1
,d8.jarjestys_iscfinarrow2013 as jarj_isced_koulala2
,d8.jarjestys_iscfi2013 as jarj_isced_koulala3
,d8.jarjestys_OKM_ohjauksen_ala as jarj_isced_okmohjaus1

--koodit
,d8.koulutusala2002_koodi as "Koodit Koulutusala 2002"
,d8.opintoala1995_koodi as "Koodit Koulutusala 1995"
,d8.opintoala2002_koodi as "Koodit Opintoala 2002"
,d8.koulutus_koodi as "Koodit Koulutusnimike"
,d8.koulutusaste2002_koodi as "Koodit Koulutusaste 2002"
,d14.koulutuksen_jarjestajakoodi as "Koodit Koul. sij. koul. järjestäjä"
,d14.oppilaitoskoodi as "Koodit Koul. sij. oppilaitos"
,d13.koulutuksen_jarjestajakoodi as "Koodit Koul. järjestäjä"
,d4b.maakunta_koodi as "Koodit Tutk. suor.maakunta"
,d4.maakunta_koodi as "Koodit Opiskelumaakunta"
,d8.iscle2011_koodi as "Koodit Koulutusaste, taso 1"
,d8.Koulutusaste_taso2_koodi as "Koodit Koulutusaste, taso 2"
,d8.iscfibroad2013_koodi as "Koodit Koulutusala, taso 1"
,d8.iscfinarrow2013_koodi as "Koodit Koulutusala, taso 2"
,d8.iscfi2013_koodi as "Koodit Koulutusala, taso 3"
,d8.OKM_ohjauksen_ala_koodi as "Koodit OKM ohjauksen ala, korkeak."

--järjestys
,d17.jarjestys AS tarkastelujakso_jarjestys
,d16.jarjestys AS sukupuoli_jarjestys
,d2.jarjestys AS aidinkieli_jarjestys
,d5.jarjestys_ika
,d5b.jarjestys_ika5v
,d6.jarjestys AS tutkintoryhma_jarjestys
,d7.jarjestys AS jarjestys_pohjakoulutus
,d8.jarjestys_koulutusaste2002 AS jarjestys_sij_koulutusaste2002
,d8.jarjestys_koulutusala2002 AS jarjestys_sij_koulutusala2002
,d8.jarjestys_opintoala2002 AS jarjestys_sij_opintoala
,d8.jarjestys AS jarjestys_sij_koulutusnimike
--,d3.jarjestys AS alueluokitus_jarjestys
--,d3.jarjestys_maakunta
--,d3.jarjestys_avi
--,d3.jarjestys_ely
--,d3.jarjestys_seutukunta
--,d3.jarjestys_suuralue
--,d3.jarjestys_kuntaryhma
--,d3.jarjestys_laani
--,d3.jarjestys_kielisuhde
,d4.jarjestys_maakunta AS sijoittuneen_al_jarjestys_maakunta
--,d4.jarjestys_avi AS sijoittuneen_al_jarjestys_avi
--,d4.jarjestys_ely AS sijoittuneen_al_jarjestys_ely
--,d4.jarjestys_seutukunta AS sijoittuneen_al_jarjestys_seutukunta
--,d4.jarjestys_suuralue AS sijoittuneen_al_jarjestys_suuralue
--,d4.jarjestys_kuntaryhma AS sijoittuneen_al_jarjestys_kuntaryhma
--,d4.jarjestys_laani AS sijoittuneen_al_jarjestys_laani
--,d4.jarjestys_kielisuhde AS sijoittuneen_al_jarjestys_kielisuhde
,d4b.jarjestys_maakunta AS tutksuor_al_jarjestys_maakunta
--,d4b.jarjestys_avi AS tutksuor_al_jarjestys_avi
--,d4b.jarjestys_ely AS tutksuor_al_jarjestys_ely
--,d4b.jarjestys_seutukunta AS tutksuor_al_jarjestys_seutukunta
--,d4b.jarjestys_suuralue AS tutksuor_al_jarjestys_suuralue
--,d4b.jarjestys_kuntaryhma AS tutksuor_al_jarjestys_kuntaryhma
--,d4b.jarjestys_laani AS tutksuor_al_jarjestys_laani
--,d4b.jarjestys_kielisuhde AS tutksuor_al_jarjestys_kielisuhde
--,d13.jarjestys_oppilaitos
,d13.jarjestys_oppilaitostyyppi
--,d13.jarjestys_omistajatyyppi
,d13.jarjestys_opetuskieli
--,d13.jarjestys_koulutuksen_jarjestaja
--,d13.jarjestys_koulutuksen_jarjestajan_kieli
--,d13.jarjestys_peruskoulujen_ryhmitys
--,d13.jarjestys_peruskoulujen_vuosilks
--,d14.jarjestys_oppilaitos AS sijoittuneen_jarjestys_oppilaitos
--,d14.jarjestys_oppilaitostyyppi AS sijoittuneen_jarjestys_oppilaitostyyppi
--,d14.jarjestys_omistajatyyppi AS sijoittuneen_jarjestys_omistajatyyppi
--,d14.jarjestys_opetuskieli AS sijoittuneen_jarjestys_opetuskieli
--,d14.jarjestys_koulutuksen_jarjestaja AS sijoittuneen_jarjestys_koulutuksen_jarjestaja
--,d14.jarjestys_koulutuksen_jarjestajan_kieli AS sijoittuneen_jarjestys_koulutuksen_jarjestajan_kieli
--,d14.jarjestys_peruskoulujen_ryhmitys AS sijoittuneen_peruskoulujen_ryhmitys
--,d14.jarjestys_peruskoulujen_vuosilks AS sijoittuneen_peruskoulujen_vuosilks
,d18.lukukausi AS tutksuor_lukukausi_jarjestys
--,d20.jarjestys AS pohjoismaa_jarjestys
,d21.jarjestys AS kansalaisuus_jarjestys
--,d22.jarjestys AS opetuskieli_jarjestys
--,d23.jarjestys AS tutktyyppi_jarjestys
--,d24.jarjestys AS jarjestamistapa_jarjestys
,d25.jarjestys AS nuoraik_jarjestys
--,d26.jarjestys AS monihaku_jarjestys
--,d27.jarjestys AS paaastoim_jarjestys
--,d28.jarjestys AS ammasema_jarjestys
,d29.jarjestys AS koul_paattaneiden_toiminta_jarjestys
--,d30.jarjestys_eumaa
--,d31.jarjestys_etamaa
,[lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa_ke] AS "Koul. sijoittuneet lukiokoulutuksessa ja ammatillisessa koulutuksessa"
,[lukiokoulutuksessa_ke] AS "Koul. sijoittuneet lukiokoulutuksessa"
,[ammatillisessa_koulutuksessa_ke] AS "Koul. sijoittuneet ammatillisessa koulutuksessa"
,[ammattikorkeakoulutuksessa_ke] AS "Koul. sijoittuneet ammattikorkeakoulutuksessa"
,[yliopistokoulutuksessa_ke] AS "Koul. sijoittuneet yliopistokoulutuksessa"
,[ammattikorkeakoulutuksessa_ja_yliopistokoulutuksessa_ke] AS "Koul. sijoittuneet ammattikorkeakoulutuksessa ja yliopistokoulutuksessa"
,[toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa_ke] AS "Koul. sijoittuneet toisen asteen ammatillisessa koulutuksessa ja korkeakoulutuksessa"
,[lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa]
,[lukiokoulutuksessa]
,[ammatillisessa_koulutuksessa]
,[ammattikorkeakoulutuksessa]
,[yliopistokoulutuksessa]
,[ammattikorkeakoulutuksessa_ja_yliopistokoulutuksessa]
,[toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa]
FROM            dbo.f_koulutukseen_sijoittuneet_6v
	JOIN d_aidinkieli_versio1 d2 ON d2.id = aidinkieli_versio_1_id
	JOIN d_sukupuoli d16 ON d16.id = sukupuoli_id
	JOIN d_tarkastelujakso d17 ON d17.id = tarkastelujakso_id
	JOIN d_alueluokitus d3 ON d3.id = asuinkunta_id
	JOIN d_alueluokitus d4 ON d4.id = koulutukseen_sijoittuneen_maakunta_id
	JOIN d_alueluokitus d4b ON d4b.id = pohjakoulutuksen_tutkinnon_suoritusmaakunta_id
	JOIN d_ika d5 ON d5.id = ika_1v_id
	JOIN d_ika d5b ON d5b.id = ika_5v_id
	JOIN d_tutkintoryhma d6 ON d6.id = tutkintoryhma_id
	JOIN d_koulutusluokitus d7 ON d7.id = pohjakoulutus_id
	JOIN d_koulutusluokitus d8 ON d8.id = koulutukseen_sijoittuneen_koulutus_id
	JOIN d_oppilaitoksen_taustatiedot d13 ON d13.id = pohjakoulutuksen_oppilaitos_id
	JOIN d_oppilaitoksen_taustatiedot d14 ON d14.id = koulutukseen_sijoittuneen_oppilaitos_id
	JOIN d_kausi d15 on d15.kausi_id = suoritusvuosi_id
	JOIN d_kausi d18 on d18.kausi_id = suorituslukukausi_id
	JOIN d_kausi d19 on d19.kausi_id = syntymavuosi_id
	JOIN d_pohjoismaa d20 on d20.id = pohjoismaa_id
	JOIN d_kansalaisuus_versio1 d21 on d21.id = kansalaisuus_id
	JOIN d_opetuskieli d22 on d22.id = pohjakoulutuksen_opetuskieli_id
	JOIN d_ammatillisen_koulutuksen_koulutuslaji d23 on d23.id = pohjakoulutuksen_koulutuslaji_id
	JOIN d_opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus d24 on d24.id = pohjakoulutuksen_tutktav_id
	JOIN d_nuorten_aikuisten_koulutus d25 on d25.id = pohjakoulutuksen_aikoul_id
	JOIN d_moninkertainen_haku d26 on d26.id = moninkertainen_haku_id
	JOIN d_paaasiallinen_toiminta d27 on d27.id = paaasiallinen_toiminta_id
	JOIN d_ammattiasema d28 on d28.id = ammattiasema_id
	JOIN d_koulutuksen_paattaneiden_toiminta d29 on d29.id = koulutuksen_paattaneiden_toiminta_id
	JOIN d_valtio d30 on d30.id = eumaa_id
	JOIN d_valtio d31 on d31.id = etamaa_id
WHERE tutkintoryhma_koodi = 1











' 
GO
/****** Object:  View [dbo].[v_f_tab_koulutukseen_sijoittuneet_6v_yhteiset]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_koulutukseen_sijoittuneet_6v_yhteiset]'))
EXEC dbo.sp_executesql @statement = N'














/****** Script for SelectTopNRows command from SSMS  ******/
CREATE VIEW [dbo].[v_f_tab_koulutukseen_sijoittuneet_6v_yhteiset] AS
Select [lkm_int2] = lkm
,[tilastovuosi] AS Tilastovuosi
,d17.tarkastelujakso AS Tarkastelujakso
,d16.sukupuoli AS Sukupuoli
,d2.aidinkieli_versio1 AS Äidinkieli
,d5.ika AS Ikä
,d5b.ika5v AS Ikäryhmä
,d6.tutkintoryhma AS "Tutkintoryhmä"
,d7.koulutus AS "Pohjakoulutus"
,d8.koulutusaste2002 AS "Koul. sijoittuneen koulutusaste"
,d8.koulutusala2002 AS "Koul. sijoittuneen koulutusala"
,d8.opintoala2002 AS "Koul. sijoittuneen opintoala"
,d8.koulutus AS "Koul. sijoittuneen koulutusnimike"
--,d3.kunta AS "Asuinkunta"
--,d3.maakunta AS "Asuinmaakunta"
--,d3.avi AS "Asuinpaikan AVI"
--,d3.ely AS "Asuinpaikan ELY"
--,d3.seutukunta AS "Asuinpaikan seutukunta"
--,d3.suuralue AS "Asuinpaikan suuralue"
--,d3.kuntaryhma AS "Asuinpaikan kuntaryhmä"
--,d3.laani AS "Asuinpaikan lääni"
--,d3.kielisuhde AS "Asuinpaikan kunnan kielisuhde"
,d4.maakunta AS "Koul. sijoittuneen opiskelumaakunta"
--,d4.avi AS "Koul. sijoittuneen opiskelupaikan AVI"
--,d4.ely AS "Koul. sijoittuneen opiskelupaikan ELY"
--,d4.seutukunta AS "Koul. sijoittuneen opiskelupaikan seutukunta"
--,d4.suuralue AS "Koul. sijoittuneen opiskelupaikan suuralue"
--,d4.kuntaryhma AS "Koul. sijoittuneen opiskelupaikan kuntaryhmä"
--,d4.laani AS "Koul. sijoittuneen opiskelupaikan lääni"
,d4b.maakunta AS "Tutkinnon suoritusmaakunta"
--,d4b.avi AS "Tutk. suorituspaikan AVI"
--,d4b.ely AS "Tutk. suorituspaikan ELY"
--,d4b.seutukunta AS "Tutk. suorituspaikan seutukunta"
--,d4b.suuralue AS "Tutk. suorituspaikan suuralue"
--,d4b.kuntaryhma AS "Tutk. suorituspaikan kuntaryhmä"
--,d4b.laani AS "Tutk. suorituspaikan lääni"
--,d13.oppilaitos AS "Oppilaitos"
,d13.oppilaitostyyppi AS "Oppilaitostyyppi"
--,d13.oppilaitoksen_omistajatyyppi AS "Oppil. omistajatyyppi"
,d13.opetuskieli AS "Oppil. opetuskieli"
,d13.koulutuksen_jarjestaja AS "Koulutuksen järjestäjä"
--,d13.koulutuksen_jarjestajan_omistajatyyppi AS "Koul. järjestäjän omistajatyyppi"
--,d13.koulutuksen_jarjestajan_kieli AS "Koul. järjestäjän kieli"
--,d13.peruskoulujen_ryhmitys AS "Peruskoulujen ryhmitys"
--,d13.peruskoulujen_vuosilks AS "Peruskoulujen vuosiluokat"
,d14.oppilaitos AS "Koul. sijoittuneen oppilaitos"
--,d14.oppilaitostyyppi AS "Koul. sijoittuneen oppil.tyyppi"
--,d14.oppilaitoksen_omistajatyyppi AS "Koul. sijoittuneen oppil. omistajatyyppi"
--,d14.opetuskieli AS "Koul. sijoittuneen oppil. opetuskieli"
,d14.koulutuksen_jarjestaja AS "Koul. sijoittuneen koul. järjestäjä"
--,d14.koulutuksen_jarjestajan_omistajatyyppi AS "Koul. sijoittuneen koul. järjestäjän omistajatyyppi"
--,d14.koulutuksen_jarjestajan_kieli AS "Koul. sijoittuneen koul. järjestäjän kieli"
--,d14.peruskoulujen_ryhmitys AS "Koul. sijoittuneen peruskoulujen ryhmitys"
--,d14.peruskoulujen_vuosilks AS "Koul. sijoittuneen peruskoulujen vuosiluokat"
,d15.vuosiselite AS "Tutkinnon suoritusvuosi"
,d18.lukukausiselite AS "Tutkinnon suorituslukukausi"
--,d19.vuosiselite AS "Syntymävuosi"
--,d20.pohjoismaa AS "Pohjoismaan kansalainen"
,d21.kansalaisuus_versio1 AS "Kansalaisuus"
--,d22.opetuskieli AS "Opetuskieli"
--,d23.ammatillisen_koulutuksen_koulutuslaji AS "Tutkintotyyppi"
--,d24.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus AS "Järjestämistapa"
,d25.nuorten_aikuisten_koulutus AS "Nuoret/aikuiset"
,d26.moninkertainen_haku AS "Haut koulutuksiin"
--,d27.paaasiallinen_toiminta AS "Pääasiallinen toiminta"
--,d28.ammattiasema AS "Ammattiasema"
,d29.koulutuksen_paattaneiden_toiminta AS "Koul. päättäneiden toiminta"
--,d30.eumaa AS "EU-maan kansalainen"
--,d31.etamaa AS "ETA-maan kansalainen"

--ruotsi
,[tilastovuosi] AS Statistikår
,d17.tarkastelujakso_SV AS Granskningsperiod
,d16.sukupuoli_SV AS Kön
,d2.aidinkieli_versio1_SV AS Modersmål
,d5.ika_SV AS Ålder
,d5b.ika5v_SV AS Åldersgrupp
,d6.tutkintoryhma_SV AS Examenskategori
,d7.koulutus_SV AS Grundutbildning
,d8.koulutusaste2002_SV AS "Placering i utbildning – utbildningsnivå"
,d8.koulutusala2002_SV AS "Placering i utbildning – utbildningsområde"
,d8.opintoala2002_SV AS "Placering i utbildning – studieområde"
,d8.koulutus_SV AS "Placering i utbildning – utbildningsbenämning"
,d4.maakunta_SV AS "Placering i utbildning – landskapet för studieplatsen"
,d4b.maakunta_SV AS [Landskap där examen avlagts]
,d13.oppilaitostyyppi_SV AS Läroanstaltstyp
,d13.opetuskieli_SV AS [Läroanstaltens undervisningsspråk]
,d13.koulutuksen_jarjestaja_SV AS Utbildningsanordnare
,d14.oppilaitos_SV AS "Placering i utbildning – läroanstalt"
,d14.koulutuksen_jarjestaja_SV AS "Placering i utbildning – utbildningsanordnare"
,d15.vuosiselite_SV AS [År då utbildningen avlagts]
,d18.lukukausiselite_SV AS [Termin då utbildningen avlagts]
,d21.kansalaisuus_versio1_SV AS Medborgaskap
,d25.nuorten_aikuisten_koulutus_SV AS [Ungdoms-/vuxenutbildning]
,d26.moninkertainen_haku_SV AS [Ansökan till utbildningar]
,d29.koulutuksen_paattaneiden_toiminta_SV AS [Sysselsättning av utexaminerade]

--englanti
,[tilastovuosi] AS [Statistical year]
,d17.tarkastelujakso_EN AS [Reference period]
,d16.sukupuoli_EN AS Gender
,d2.aidinkieli_versio1_EN AS [Mother tongue]
,d5.ika_EN AS Age
,d5b.ika5v_EN AS [Age group]
,d6.tutkintoryhma_EN AS [Degree/Qualification group]
,d7.koulutus_EN AS [Previous education]
,d8.koulutusaste2002_EN AS [Placed in further ed. - level of education]
,d8.koulutusala2002_EN AS [Placed in further ed. - field of education]
,d8.opintoala2002_EN AS [Placed in further ed. - subfield of education]
,d8.koulutus_EN AS [Placed in further ed. - name of education]
,d4.maakunta_EN AS [Placed in further ed. - region]
,d4b.maakunta_EN AS [Region of degree/qualification]
,d13.oppilaitostyyppi_EN AS [Type of institution]
,d13.opetuskieli_EN AS [Language of the institution]
,d13.koulutuksen_jarjestaja_EN AS [Education provider]
,d14.oppilaitos_EN AS [Placed in further ed. - ed. institution]
,d14.koulutuksen_jarjestaja_EN AS [Placed in further ed. - education provider]
,d15.vuosiselite_EN AS [Graduation year]
,d18.lukukausiselite_EN AS [Term of graduation]
,d21.kansalaisuus_versio1_EN AS Nationality
,d25.nuorten_aikuisten_koulutus_EN AS [Youth/adult education]
,d26.moninkertainen_haku_EN AS [Applications to further education]
,d29.koulutuksen_paattaneiden_toiminta_EN AS [Completers'' activity]

--isced
,d8.iscle2011 as "Koul. sijoittuneen koulutusaste, taso 1"
,d8.Koulutusaste_taso2 as "Koul. sijoittuneen koulutusaste, taso 2"
,d8.iscfibroad2013 as "Koul. sijoittuneen koulutusala, taso 1"
,d8.iscfinarrow2013 as "Koul. sijoittuneen koulutusala, taso 2"
,d8.iscfi2013 as "Koul. sijoittuneen koulutusala, taso 3"
,d8.OKM_ohjauksen_ala as "Koul. sijoittuneen OKM ohjauksen ala, korkeak."

,d8.iscle2011_SV as "Placering i utbildning – utb.nivå, nivå 1"
,d8.Koulutusaste_taso2_SV as "Placering i utbildning – utb.nivå, nivå 2"
,d8.iscfibroad2013_SV as "Placering i utbildning – utb.område, nivå 1"
,d8.iscfinarrow2013_SV as "Placering i utbildning – utb.område, nivå 2"
,d8.iscfi2013_SV as "Placering i utbildning – utb.område, nivå 3"
,d8.OKM_ohjauksen_ala_SV as "Placering i utbildning – UKM-styrningsområde, högskolor"

,d8.iscle2011_EN as "Placed in further ed. - level of education, tier 1"
,d8.Koulutusaste_taso2_EN as "Placed in further ed. - level of education, tier 2"
,d8.iscfibroad2013_EN as "Placed in further ed. - field of education, tier 1"
,d8.iscfinarrow2013_EN as "Placed in further ed. - field of education, tier 2"
,d8.iscfi2013_EN as "Placed in further ed. - field of education, tier 3"
,d8.OKM_ohjauksen_ala_EN as "Placed in further ed. - field of ed., HE steering"

,d8.jarjestys_iscle2011 as jarj_isced_koulast1
,d8.jarjestys_Koulutusaste_taso2 as jarj_isced_koulast2
,d8.jarjestys_iscfibroad2013 as jarj_isced_koulala1
,d8.jarjestys_iscfinarrow2013 as jarj_isced_koulala2
,d8.jarjestys_iscfi2013 as jarj_isced_koulala3
,d8.jarjestys_OKM_ohjauksen_ala as jarj_isced_okmohjaus1

--koodit
,d8.koulutusala2002_koodi as "Koodit Koulutusala 2002"
,d8.opintoala1995_koodi as "Koodit Koulutusala 1995"
,d8.opintoala2002_koodi as "Koodit Opintoala 2002"
,d8.koulutus_koodi as "Koodit Koulutusnimike"
,d8.koulutusaste2002_koodi as "Koodit Koulutusaste 2002"
,d14.koulutuksen_jarjestajakoodi as "Koodit Koul. sij. koul. järjestäjä"
,d14.oppilaitoskoodi as "Koodit Koul. sij. oppilaitos"
,d13.koulutuksen_jarjestajakoodi as "Koodit Koul. järjestäjä"
,d4b.maakunta_koodi as "Koodit Tutk. suor.maakunta"
,d4.maakunta_koodi as "Koodit Opiskelumaakunta"
,d8.iscle2011_koodi as "Koodit Koulutusaste, taso 1"
,d8.Koulutusaste_taso2_koodi as "Koodit Koulutusaste, taso 2"
,d8.iscfibroad2013_koodi as "Koodit Koulutusala, taso 1"
,d8.iscfinarrow2013_koodi as "Koodit Koulutusala, taso 2"
,d8.iscfi2013_koodi as "Koodit Koulutusala, taso 3"
,d8.OKM_ohjauksen_ala_koodi as "Koodit OKM ohjauksen ala, korkeak."

--järjestys
,d17.jarjestys AS tarkastelujakso_jarjestys
,d16.jarjestys AS sukupuoli_jarjestys
,d2.jarjestys AS aidinkieli_jarjestys
,d5.jarjestys_ika
,d5b.jarjestys_ika5v
,d6.jarjestys AS tutkintoryhma_jarjestys
,d7.jarjestys AS jarjestys_pohjakoulutus
,d8.jarjestys_koulutusaste2002 AS jarjestys_sij_koulutusaste2002
,d8.jarjestys_koulutusala2002 AS jarjestys_sij_koulutusala2002
,d8.jarjestys_opintoala2002 AS jarjestys_sij_opintoala
,d8.jarjestys AS jarjestys_sij_koulutusnimike
--,d3.jarjestys AS alueluokitus_jarjestys
--,d3.jarjestys_maakunta
--,d3.jarjestys_avi
--,d3.jarjestys_ely
--,d3.jarjestys_seutukunta
--,d3.jarjestys_suuralue
--,d3.jarjestys_kuntaryhma
--,d3.jarjestys_laani
--,d3.jarjestys_kielisuhde
,d4.jarjestys_maakunta AS sijoittuneen_al_jarjestys_maakunta
--,d4.jarjestys_avi AS sijoittuneen_al_jarjestys_avi
--,d4.jarjestys_ely AS sijoittuneen_al_jarjestys_ely
--,d4.jarjestys_seutukunta AS sijoittuneen_al_jarjestys_seutukunta
--,d4.jarjestys_suuralue AS sijoittuneen_al_jarjestys_suuralue
--,d4.jarjestys_kuntaryhma AS sijoittuneen_al_jarjestys_kuntaryhma
--,d4.jarjestys_laani AS sijoittuneen_al_jarjestys_laani
--,d4.jarjestys_kielisuhde AS sijoittuneen_al_jarjestys_kielisuhde
,d4b.jarjestys_maakunta AS tutksuor_al_jarjestys_maakunta
--,d4b.jarjestys_avi AS tutksuor_al_jarjestys_avi
--,d4b.jarjestys_ely AS tutksuor_al_jarjestys_ely
--,d4b.jarjestys_seutukunta AS tutksuor_al_jarjestys_seutukunta
--,d4b.jarjestys_suuralue AS tutksuor_al_jarjestys_suuralue
--,d4b.jarjestys_kuntaryhma AS tutksuor_al_jarjestys_kuntaryhma
--,d4b.jarjestys_laani AS tutksuor_al_jarjestys_laani
--,d4b.jarjestys_kielisuhde AS tutksuor_al_jarjestys_kielisuhde
--,d13.jarjestys_oppilaitos
,d13.jarjestys_oppilaitostyyppi
--,d13.jarjestys_omistajatyyppi
,d13.jarjestys_opetuskieli
--,d13.jarjestys_koulutuksen_jarjestaja
--,d13.jarjestys_koulutuksen_jarjestajan_kieli
--,d13.jarjestys_peruskoulujen_ryhmitys
--,d13.jarjestys_peruskoulujen_vuosilks
--,d14.jarjestys_oppilaitos AS sijoittuneen_jarjestys_oppilaitos
--,d14.jarjestys_oppilaitostyyppi AS sijoittuneen_jarjestys_oppilaitostyyppi
--,d14.jarjestys_omistajatyyppi AS sijoittuneen_jarjestys_omistajatyyppi
--,d14.jarjestys_opetuskieli AS sijoittuneen_jarjestys_opetuskieli
--,d14.jarjestys_koulutuksen_jarjestaja AS sijoittuneen_jarjestys_koulutuksen_jarjestaja
--,d14.jarjestys_koulutuksen_jarjestajan_kieli AS sijoittuneen_jarjestys_koulutuksen_jarjestajan_kieli
--,d14.jarjestys_peruskoulujen_ryhmitys AS sijoittuneen_peruskoulujen_ryhmitys
--,d14.jarjestys_peruskoulujen_vuosilks AS sijoittuneen_peruskoulujen_vuosilks
,d18.lukukausi AS tutksuor_lukukausi_jarjestys
--,d20.jarjestys AS pohjoismaa_jarjestys
,d21.jarjestys AS kansalaisuus_jarjestys
--,d22.jarjestys AS opetuskieli_jarjestys
--,d23.jarjestys AS tutktyyppi_jarjestys
--,d24.jarjestys AS jarjestamistapa_jarjestys
,d25.jarjestys AS nuoraik_jarjestys
,d26.jarjestys AS monihaku_jarjestys
--,d27.jarjestys AS paaastoim_jarjestys
--,d28.jarjestys AS ammasema_jarjestys
,d29.jarjestys AS koul_paattaneiden_toiminta_jarjestys
--,d30.jarjestys_eumaa
--,d31.jarjestys_etamaa
,[lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa_ke] AS "Koul. sijoittuneet lukiokoulutuksessa ja ammatillisessa koulutuksessa"
,[lukiokoulutuksessa_ke] AS "Koul. sijoittuneet lukiokoulutuksessa"
,[ammatillisessa_koulutuksessa_ke] AS "Koul. sijoittuneet ammatillisessa koulutuksessa"
,[ammattikorkeakoulutuksessa_ke] AS "Koul. sijoittuneet ammattikorkeakoulutuksessa"
,[yliopistokoulutuksessa_ke] AS "Koul. sijoittuneet yliopistokoulutuksessa"
,[ammattikorkeakoulutuksessa_ja_yliopistokoulutuksessa_ke] AS "Koul. sijoittuneet ammattikorkeakoulutuksessa ja yliopistokoulutuksessa"
,[toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa_ke] AS "Koul. sijoittuneet toisen asteen ammatillisessa koulutuksessa ja korkeakoulutuksessa"
,[lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa]
,[lukiokoulutuksessa]
,[ammatillisessa_koulutuksessa]
,[ammattikorkeakoulutuksessa]
,[yliopistokoulutuksessa]
,[ammattikorkeakoulutuksessa_ja_yliopistokoulutuksessa]
,[toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa]
FROM            dbo.f_koulutukseen_sijoittuneet_6v
	JOIN d_aidinkieli_versio1 d2 ON d2.id = aidinkieli_versio_1_id
	JOIN d_sukupuoli d16 ON d16.id = sukupuoli_id
	JOIN d_tarkastelujakso d17 ON d17.id = tarkastelujakso_id
	JOIN d_alueluokitus d3 ON d3.id = asuinkunta_id
	JOIN d_alueluokitus d4 ON d4.id = koulutukseen_sijoittuneen_maakunta_id
	JOIN d_alueluokitus d4b ON d4b.id = pohjakoulutuksen_tutkinnon_suoritusmaakunta_id
	JOIN d_ika d5 ON d5.id = ika_1v_id
	JOIN d_ika d5b ON d5b.id = ika_5v_id
	JOIN d_tutkintoryhma d6 ON d6.id = tutkintoryhma_id
	JOIN d_koulutusluokitus d7 ON d7.id = pohjakoulutus_id
	JOIN d_koulutusluokitus d8 ON d8.id = koulutukseen_sijoittuneen_koulutus_id
	JOIN d_oppilaitoksen_taustatiedot d13 ON d13.id = pohjakoulutuksen_oppilaitos_id
	JOIN d_oppilaitoksen_taustatiedot d14 ON d14.id = koulutukseen_sijoittuneen_oppilaitos_id
	JOIN d_kausi d15 on d15.kausi_id = suoritusvuosi_id
	JOIN d_kausi d18 on d18.kausi_id = suorituslukukausi_id
	JOIN d_kausi d19 on d19.kausi_id = syntymavuosi_id
	JOIN d_pohjoismaa d20 on d20.id = pohjoismaa_id
	JOIN d_kansalaisuus_versio1 d21 on d21.id = kansalaisuus_id
	JOIN d_opetuskieli d22 on d22.id = pohjakoulutuksen_opetuskieli_id
	JOIN d_ammatillisen_koulutuksen_koulutuslaji d23 on d23.id = pohjakoulutuksen_koulutuslaji_id
	JOIN d_opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus d24 on d24.id = pohjakoulutuksen_tutktav_id
	JOIN d_nuorten_aikuisten_koulutus d25 on d25.id = pohjakoulutuksen_aikoul_id
	JOIN d_moninkertainen_haku d26 on d26.id = moninkertainen_haku_id
	JOIN d_paaasiallinen_toiminta d27 on d27.id = paaasiallinen_toiminta_id
	JOIN d_ammattiasema d28 on d28.id = ammattiasema_id
	JOIN d_koulutuksen_paattaneiden_toiminta d29 on d29.id = koulutuksen_paattaneiden_toiminta_id
	JOIN d_valtio d30 on d30.id = eumaa_id
	JOIN d_valtio d31 on d31.id = etamaa_id
WHERE (d24.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_koodi in (1, -1))














' 
GO
/****** Object:  View [dbo].[v_f_tab_lukio_ja_ammatillinen_2_3_h]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_lukio_ja_ammatillinen_2_3_h]'))
EXEC dbo.sp_executesql @statement = N'









CREATE VIEW [dbo].[v_f_tab_lukio_ja_ammatillinen_2_3_h] AS

SELECT [Tilastovuosi] = f.tilastointivuosi

	  ,[Ikäryhmä] = d1.ika5v
	  ,[Kotikunta] = d31.kunta
	  ,[Kotimaakunta] = d31.maakunta
	  ,[Edellisen vuoden kotikunta] = d32.kunta
	  ,[Edellisen vuoden kotimaakunta] = d32.maakunta
	  ,[Kotikunta sama kuin koulutuksen kunta] = case when d33.kylla_ei_koodi=1 then ''Kotikunta sama kuin koulutuksen kunta'' when d33.kylla_ei_koodi=0 then ''Kotikunta eri kuin koulutuksen kunta'' else d33.kylla_ei end
	  ,[Kotimaakunta sama kuin koulutuksen maakunta] = case when d34.kylla_ei_koodi=1 then ''Kotimaakunta sama kuin koulutuksen maakunta'' when d34.kylla_ei_koodi=0 then ''Kotimaakunta eri kuin koulutuksen maakunta'' else d34.kylla_ei end
	  ,[Kotikunta sama kuin ed. vuonna] = case when d35.kylla_ei_koodi=1 then ''Kotikunta sama kuin ed. vuonna'' when d35.kylla_ei_koodi=0 then ''Kotikunta eri kuin ed. vuonna'' else d35.kylla_ei end
	  ,[Kotimaakunta sama kuin ed. vuonna] = case when d36.kylla_ei_koodi=1 then ''Kotimaakunta sama kuin ed. vuonna'' when d36.kylla_ei_koodi=0 then ''Kotimaakunta eri kuin ed. vuonna'' else d36.kylla_ei end
	  ,[Ed. vuoden kotimaakunta sama kuin koulutuksen maakunta] = case when d37.kylla_ei_koodi=1 then ''Edellisen vuoden kotimaakunta sama kuin koulutuksen maakunta'' when d37.kylla_ei_koodi=0 then ''Edellisen vuoden kotimaakunta eri kuin koulutuksen maakunta'' else d37.kylla_ei end
	  ,[Ed. vuoden kotikunta sama kuin koulutuksen kunta] = case when d38.kylla_ei_koodi=1 then ''Edellisen vuoden kotikunta sama kuin koulutuksen kunta'' when d38.kylla_ei_koodi=0 then ''Edellisen vuoden kotikunta eri kuin koulutuksen kunta'' else d38.kylla_ei end

	  ,[Koulutusala] = d2.koulutusala2002
      ,[Koulutusaste] = d3.koulutusaste_2002
      ,[Koulutuksen kieli] = d4.kieli
      ,[Koulutuksen kunta] = d5.kunta
	  ,[Koulutuksen maakunta] = d5.maakunta
      ,[Hallinnonala] = d6.opetushallinnon_koulutus
	  ,[Koulutuslaji] = d7.lukiokoulutuksen_koulutuslaji
      ,[Nuorten/aikuisten koulutus] = d8.nuorten_aikuisten_koulutus
	  ,[Tutkintotyyppi] = d9.ammatillisen_koulutuksen_koulutuslaji
      ,[Järjestämistapa] = d10.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus
      ,[Työvoimapoliittinen koulutus] = d11.tyovoimapoliittinen
      ,[Rahoituslähde] = d12.rahoituslahde_amm
      ,[Koulutuksen tavoite] = d13.tutkinnon_tavoite
      ,[Yrittäjän oppisopimuskoulutus] = d14.yrittajan_oppisopimuskoulutus
      --,[Koulutussektori] = d15.koulutussektori
      --,[Hallinnonala II] = d16.hallinnonala
      ,[Järjestämismuoto] = d17.koulutuksen_jarjestamismuoto
      --,[Koulutuksen tavoite/toteuma] = d18.koulutuksen_tavoite_toteuma
	  ,[Nuorten/aikuisten koulutus amm] = d19.nuorten_aikuisten_koulutus_amm
      ,[Koulutuslaji (OKM)] = d20.koulutuslaji_okm
      --,[Koulutuksen kunta yht] = d21.kunta
	  --,[Koulutuksen maakunta yht] = d21.maakunta

      ,[Oppilaitos] = d22.oppilaitos
	  ,[Oppilaitoksen kunta] = d26.kunta
	  ,[Oppilaitoksen maakunta] = d26.maakunta
   --   ,[Koulutuksen järjestäjä] = d23.koulutuksen_jarjestaja
   --   ,[Koulutuksen järjestäjän kunta] = d25.kunta
	  --,[Koulutuksen järjestäjän maakunta] = d25.maakunta
	  --,[Oppisopimuskoulutuksen järjestäjä] = d24.koulutuksen_jarjestaja
      ,[Koulutuksen järjestäjä] = d27.koulutuksen_jarjestaja
      ,[Koulutuksen järjestäjän kunta] = d29.kunta
	  ,[Koulutuksen järjestäjän maakunta] = d29.maakunta
   --   ,[Oppilaitos yht] = d28.oppilaitos
   --   ,[Oppilaitoksen kunta yht] = d30.kunta
	  --,[Oppilaitoksen maakunta yht] = d30.maakunta
	  ,[Koulutuksen kuntakoodi] = d5.kunta_koodi
	  ,[Koulutuksen maakuntakoodi] = d5.maakunta_koodi
	  ,[Oppilaitoskoodi] = d22.oppilaitoskoodi
	  ,[Koulutuksen järjestäjäkoodi] = d27.koulutuksen_jarjestajakoodi
	  ,[Tutkintokoodi] = d9.ammatillisen_koulutuksen_koulutuslaji_koodi
	  ,[Koulutusalakoodi] = d2.koulutusala2002_koodi

      ,[aloittaneet]
      ,[opiskelijat]
      ,[opiskelijat_lasna]
	  ,[lukumaara]

	  --ruotsi
	  ,[Statistikår] = f.tilastointivuosi

	  ,[Åldersgrupp] = d1.ika5v_SV
	  ,[Hemkommun] = d31.kunta_SV
	  ,[Hemlandskap] = d31.maakunta_SV
	  ,[Hemkommun året innan] = d32.kunta_SV
	  ,[Hemlandskap året innan] = d32.maakunta_SV
	  ,[Hemkommun samma som utbildningens kommun] = case when d33.kylla_ei_koodi=1 then ''Hemkommun samma som utbildningens kommun'' when d33.kylla_ei_koodi=0 then ''Hemkommun annan som utbildningens kommun'' else d33.kylla_ei_SV end
	  ,[Hemlandskap samma som utbildningens landskap] = case when d34.kylla_ei_koodi=1 then ''Hemlandskap samma som utbildningens landskap'' when d34.kylla_ei_koodi=0 then ''Hemlandskap annan som utbildningens landskap'' else d34.kylla_ei_SV end
	  ,[Hemkommun samma som under föregående år] = case when d35.kylla_ei_koodi=1 then ''Hemkommun samma som under föregående år'' when d35.kylla_ei_koodi=0 then ''Hemkommun annan som under föregående år'' else d35.kylla_ei_SV end
	  ,[Hemlandskap samma som under föregående år] = case when d36.kylla_ei_koodi=1 then ''Hemlandskap samma som under föregående år'' when d36.kylla_ei_koodi=0 then ''Hemlandskap annan som under föregående år'' else d36.kylla_ei_SV end
	  ,[Föregående års hemlandskap samma som utbildningens landskap] = case when d37.kylla_ei_koodi=1 then ''Föregående års hemlandskap samma som utbildningens landskap'' when d37.kylla_ei_koodi=0 then ''Föregående års hemlandskap annan som utbildningens landskap'' else d37.kylla_ei_SV end
	  ,[Föregående års hemkommun samma som utbildningens kommun] = case when d38.kylla_ei_koodi=1 then ''Föregående års hemkommun samma som utbildningens kommun'' when d38.kylla_ei_koodi=0 then ''Föregående års hemkommun annan som utbildningens kommun'' else d38.kylla_ei_SV end

	  ,[Utbildningsområde] = d2.koulutusala2002_SV
      ,[Utbildningsnivå] = d3.koulutusaste_2002_SV
      ,[Utbildningens språk] = d4.kieli_SV
      ,[Utbildningens kommun] = d5.kunta_SV
	  ,[Utbildningens landskap] = d5.maakunta_SV
      ,[Förvaltningsområde] = d6.opetushallinnon_koulutus_SV
	  ,[Utbildningsslag] = d7.lukiokoulutuksen_koulutuslaji_SV
      ,[Ungdoms-/vuxenutbildning] = d8.nuorten_aikuisten_koulutus_SV
	  ,[Typ av examen] = d9.ammatillisen_koulutuksen_koulutuslaji_SV
      ,[Sättet på vilket utbildningen ordnas] = d10.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_SV
      ,[Arbetskraftspolitisk utbildning] = d11.tyovoimapoliittinen_SV
      ,[Finansieringskälla] = d12.rahoituslahde_amm_SV
      ,[Utbildningens mål] = d13.tutkinnon_tavoite_SV
      ,[Företagarens läroavtalsutbildning] = d14.yrittajan_oppisopimuskoulutus_SV
      --,[Koulutussektori] = d15.koulutussektori
      --,[Hallinnonala II] = d16.hallinnonala
      ,[Formen i vilken utbildningen ordnas] = d17.koulutuksen_jarjestamismuoto_SV
      --,[Koulutuksen tavoite/toteuma] = d18.koulutuksen_tavoite_toteuma
	  ,[Ungdoms-/vuxenutbildning yrkesskola] = d19.nuorten_aikuisten_koulutus_amm_SV
      ,[Utbildningsslag (UKM)] = d20.koulutuslaji_okm_SV
      --,[Koulutuksen kunta yht] = d21.kunta
	  --,[Koulutuksen maakunta yht] = d21.maakunta

      ,[Läroanstalt] = d22.oppilaitos_SV
	  ,[Läroanstaltens kommun] = d26.kunta_SV
	  ,[Läroanstaltens landskap] = d26.maakunta_SV
   --   ,[Koulutuksen järjestäjä] = d23.koulutuksen_jarjestaja
   --   ,[Koulutuksen järjestäjän kunta] = d25.kunta
	  --,[Koulutuksen järjestäjän maakunta] = d25.maakunta
	  --,[Oppisopimuskoulutuksen järjestäjä] = d24.koulutuksen_jarjestaja
      ,[Utbildningsanordnare] = d27.koulutuksen_jarjestaja_SV
      ,[Utbildningsanordnarens kommun] = d29.kunta_SV
	  ,[Utbildningsanordnarens landskap] = d29.maakunta_SV

	  --englanti
	  ,[Statistical year] = f.tilastointivuosi

	  ,[Age group] = d1.ika5v_EN
	  ,[Municipality of residence] = d31.kunta_EN
	  ,[Region of residence] = d31.maakunta_EN
	  ,[Last year''s municipality of residence] = d32.kunta_EN
	  ,[Last year''s region of residence] = d32.maakunta_EN
	  ,[Municipality of residence the same as municipality of education] = case when d33.kylla_ei_koodi=1 then ''Municipality of residence the same as municipality of education'' when d33.kylla_ei_koodi=0 then ''Municipality of residence other than municipality of education'' else d33.kylla_ei_EN end
	  ,[Region of residence the same as region of education] = case when d34.kylla_ei_koodi=1 then ''Region of residence the same as region of education'' when d34.kylla_ei_koodi=0 then ''Region of residence other than region of education'' else d34.kylla_ei_EN end
	  ,[Municipality of residence the same as last year''s] = case when d35.kylla_ei_koodi=1 then ''Municipality of residence the same as last year''''s'' when d35.kylla_ei_koodi=0 then ''Municipality of residence other than last year''''s'' else d35.kylla_ei_EN end
	  ,[Region of residence the same as last year''s] = case when d36.kylla_ei_koodi=1 then ''Region of residence the same as last year''''s'' when d36.kylla_ei_koodi=0 then ''Region of residence other than last year''''s'' else d36.kylla_ei_EN end
	  ,[Last year''s region of residence the same as region of education] = case when d37.kylla_ei_koodi=1 then ''Last year''''s region of residence the same as region of education'' when d37.kylla_ei_koodi=0 then ''Last year''''s region of residence other than region of education'' else d37.kylla_ei_EN end
	  ,[Last year''s municipality of residence the same as municipality of education] = case when d38.kylla_ei_koodi=1 then ''Last year''''s municipality of residence the same as municipality of education'' when d38.kylla_ei_koodi=0 then ''Last year''''s municipality of residence other than municipality of education'' else d38.kylla_ei_EN end

	  ,[Field of education] = d2.koulutusala2002_EN
      ,[Level of education] = d3.koulutusaste_2002_EN
      ,[Language of education] = d4.kieli_EN
      ,[Municipality of education] = d5.kunta_EN
	  ,[Region of education] = d5.maakunta_EN
      ,[Administrative sector] = d6.opetushallinnon_koulutus_EN
	  ,[Form of education and training] = d7.lukiokoulutuksen_koulutuslaji_EN
      ,[Youth/adult education] = d8.nuorten_aikuisten_koulutus_EN
	  ,[Qualification type] = d9.ammatillisen_koulutuksen_koulutuslaji_EN
      ,[Method of vocational education and training] = d10.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_EN
      ,[Labour policy education and training] = d11.tyovoimapoliittinen_EN
      ,[Source of funding] = d12.rahoituslahde_amm_EN
      ,[Objective of education] = d13.tutkinnon_tavoite_EN
      ,[Apprenticeship training for self-employed persons] = d14.yrittajan_oppisopimuskoulutus_EN
      --,[Koulutussektori] = d15.koulutussektori
      --,[Hallinnonala II] = d16.hallinnonala
      ,[Form of vocational education and training] = d17.koulutuksen_jarjestamismuoto_EN
      --,[Koulutuksen tavoite/toteuma] = d18.koulutuksen_tavoite_toteuma
	  ,[Youth/adult education voc. ed.] = d19.nuorten_aikuisten_koulutus_amm_EN
      ,[Form of education and training (MinEdu)] = d20.koulutuslaji_okm_EN
      --,[Koulutuksen kunta yht] = d21.kunta
	  --,[Koulutuksen maakunta yht] = d21.maakunta

      ,[Educational institution] = d22.oppilaitos_EN
	  ,[Municipality of the institution] = d26.kunta_EN
	  ,[Region of the institution] = d26.maakunta_EN
   --   ,[Koulutuksen järjestäjä] = d23.koulutuksen_jarjestaja
   --   ,[Koulutuksen järjestäjän kunta] = d25.kunta
	  --,[Koulutuksen järjestäjän maakunta] = d25.maakunta
	  --,[Oppisopimuskoulutuksen järjestäjä] = d24.koulutuksen_jarjestaja
      ,[Education provider] = d27.koulutuksen_jarjestaja_EN
      ,[Municipality of the education provider] = d29.kunta_EN
	  ,[Region of the education provider] = d29.maakunta_EN
  
	  --järjestys
	  ,[Ikä jarj] = d1.jarjestys_ika5v
	  ,[Kotimaakunta jarj] = d31.jarjestys_maakunta
	  ,[Kotimaakunta ed jarj] = d32.jarjestys_maakunta
	  ,[Koulutusala jarj] = d2.jarjestys_koulutusala2002
	  ,[Koulutuksen kieli jarj] = d4.jarjestys
	  ,[Koulutuksen maakunta jarj] = d5.jarjestys_maakunta
	  ,[Hallinnonala jarj] = d6.jarjestys
	  ,[Koulutuslaji jarj] = d7.jarjestys
	  ,[Nuorten/aikuisten jarj] = d8.jarjestys
	  ,[Tutkintotyyppi jarj] = d9.jarjestys
	  ,[Järjestämistapa jarj] = d10.jarjestys
	  ,[Työvoimapoliittinen jarj] = d11.jarjestys
	  ,[Rahoituslähde jarj] = d12.jarjestys
	  ,[Tavoite jarj] = d13.jarjestys
	  ,[Yrit oppis jarj] = d14.jarjestys
	  ,[Järjestämismuoto jarj] = d17.jarjestys
	  ,[Nuorten/aikuisten amm jarj] = d19.jarjestys
	  ,[Koulutuslaji okm jarj] = d20.jarjestys
	  ,[Oppilaitoksen maakunta jarj] = d26.jarjestys_maakunta
	  ,[Koul jarj yht jarj] = d29.jarjestys_maakunta
	  ,[Kotikunta sama kuin koulutuksen kunta jarj] = d33.jarjestys
	  ,[Kotimaakunta sama kuin koulutuksen maakunta jarj] = d34.jarjestys
	  ,[Kotikunta sama kuin ed. vuonna jarj] = d35.jarjestys
	  ,[Kotimaakunta sama kuin ed. vuonna jarj] = d36.jarjestys
	  ,[Ed. vuoden kotimaakunta sama kuin koulutuksen maakunta jarj] = d37.jarjestys
	  ,[Ed. vuoden kotikunta sama kuin koulutuksen kunta jarj] = d38.jarjestys

--isced
,d2.iscle2011 as "Koulutusaste, taso 1"
,d2.Koulutusaste_taso2 as "Koulutusaste, taso 2"
,d2.iscfibroad2013 as "Koulutusala, taso 1"
,d2.iscfinarrow2013 as "Koulutusala, taso 2"
,d2.iscfi2013 as "Koulutusala, taso 3"
,d2.iscle2011_SV as "Utbildn.nivå, nivå 1"
,d2.Koulutusaste_taso2_SV as "Utbildn.nivå, nivå 2"
,d2.iscfibroad2013_SV as "Utbildn.område, nivå 1"
,d2.iscfinarrow2013_SV as "Utbildn.område, nivå 2"
,d2.iscfi2013_SV as "Utbildn.område, nivå 3"
,d2.iscle2011_EN as "Level of education, tier 1"
,d2.Koulutusaste_taso2_EN as "Level of education, tier 2"
,d2.iscfibroad2013_EN as "Field of education, tier 1"
,d2.iscfinarrow2013_EN as "Field of education, tier 2"
,d2.iscfi2013_EN as "Field of education, tier 3"
,d2.jarjestys_iscle2011 as jarj_isced_koulast1
,d2.jarjestys_Koulutusaste_taso2 as jarj_isced_koulast2
,d2.jarjestys_iscfibroad2013 as jarj_isced_koulala1
,d2.jarjestys_iscfinarrow2013 as jarj_isced_koulala2
,d2.jarjestys_iscfi2013 as jarj_isced_koulala3


  FROM [VipunenTK].[dbo].[f_2_3h_Lukiokoulutuksen_ja_ammatillisen_koulutuksen_opiskelijat] f
  left join VipunenTK.dbo.d_ika d1 on d1.id=f.ika_id
  left join VipunenTK.dbo.d_koulutusluokitus d2 on d2.id=f.koulutusala_id
  left join VipunenTK.dbo.d_koulutusaste_2002 d3 on d3.id=f.koulutusaste_id
  left join VipunenTK.dbo.d_kieli d4 on d4.id=f.koulutuksen_kieli_id
  left join VipunenTK.dbo.d_alueluokitus d5 on d5.id=f.koulutuksen_kunta_id
  left join VipunenTK.dbo.d_opetushallinnon_koulutus d6 on d6.id=f.opetushallinnon_koulutus_id
  left join VipunenTK.dbo.d_lukiokoulutuksen_koulutuslaji d7 on d7.id=f.lukiokoulutuksen_koulutuslaji_id
  left join VipunenTK.dbo.d_nuorten_aikuisten_koulutus d8 on d8.id=f.nuorten_aikuisten_koulutus_id
  left join VipunenTK.dbo.d_ammatillisen_koulutuksen_koulutuslaji d9 on d9.id=f.ammatillisen_koulutuksen_koulutuslaji_id
  left join VipunenTK.dbo.d_opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus d10 on d10.id=f.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_id
  left join VipunenTK.dbo.d_tyovoimapoliittinen d11 on d11.id=f.tyovoimapoliittinen_id
  left join VipunenTK.dbo.d_rahoituslahde_amm d12 on d12.id=f.rahoituslahde_amm_id
  left join VipunenTK.dbo.d_tutkinnon_tavoite d13 on d13.id=f.tutkinnon_tavoite_id
  left join VipunenTK.dbo.d_yrittajan_oppisopimuskoulutus d14 on d14.id=f.yrittajan_oppisopimuskoulutus_id
  --left join VipunenTK.dbo.d_koulutussektori d15 on d15.id=f.koulutussektori_id
  --left join VipunenTK.dbo.d_hallinnonala d16 on d16.id=f.hallinnonala_id
  left join VipunenTK.dbo.d_koulutuksen_jarjestamismuoto d17 on d17.id=f.koulutuksen_jarjestamismuoto_id
  left join VipunenTK.dbo.d_koulutuksen_tavoite_toteuma d18 on d18.id=f.koulutuksen_tavoite_toteuma_id
  left join VipunenTK.dbo.d_nuorten_aikuisten_koulutus_amm d19 on d19.id=f.nuorten_aikuisten_koulutus_amm_id
  left join VipunenTK.dbo.d_koulutuslaji_okm d20 on d20.id=f.koulutuslaji_OKM_id
  --left join VipunenTK.dbo.d_alueluokitus d21 on d21.id=f.yht_koulutuksen_kunta_id
  left join VipunenTK.dbo.d_oppilaitoksen_taustatiedot d22 on d22.id=f.oppilaitos_id
  --left join VipunenTK.dbo.d_oppilaitoksen_taustatiedot d23 on d23.id=f.koulutuksen_jarjestaja_id
  --left join VipunenTK.dbo.d_oppilaitoksen_taustatiedot d24 on d24.id=f.oppisopimuskoulutuksen_jarjestaja_id
  --left join VipunenTK.dbo.d_alueluokitus d25 on d25.id=f.koulutuksen_jarjestaja_kunta_id
  left join VipunenTK.dbo.d_alueluokitus d26 on d26.id=f.oppilaitos_kunta_id
  left join VipunenTK.dbo.d_oppilaitoksen_taustatiedot d27 on d27.id=f.yht_koulutuksen_jarjestaja_id
  --left join VipunenTK.dbo.d_oppilaitoksen_taustatiedot d28 on d28.id=f.yht_oppilaitos_id
  left join VipunenTK.dbo.d_alueluokitus d29 on d29.id=f.yht_koulutuksen_jarjestaja_kunta_id
  --left join VipunenTK.dbo.d_alueluokitus d30 on d30.id=f.yht_oppilaitos_kunta_id
  left join VipunenTK.dbo.d_alueluokitus d31 on d31.id=f.kotikunta_id
  left join VipunenTK.dbo.d_alueluokitus d32 on d32.id=f.kotikunta_ed_id
  left join VipunenTK.dbo.d_kylla_ei d33 on d33.id=f.kotikunta_sama_kuin_koulutuksen_kunta_id
  left join VipunenTK.dbo.d_kylla_ei d34 on d34.id=f.kotimaakunta_sama_kuin_koulutuksen_maakunta_id
  left join VipunenTK.dbo.d_kylla_ei d35 on d35.id=f.kotikunta_sama_kuin_ed_vuonna_id
  left join VipunenTK.dbo.d_kylla_ei d36 on d36.id=f.kotimaakunta_sama_kuin_ed_vuonna_id
  left join VipunenTK.dbo.d_kylla_ei d37 on d37.id=f.ed_vuoden_kotimaakunta_sama_kuin_koulutuksen_maakunta_id
  left join VipunenTK.dbo.d_kylla_ei d38 on d38.id=f.ed_vuoden_kotikunta_sama_kuin_koulutuksen_kunta_id









' 
GO
/****** Object:  View [dbo].[v_f_tab_lukio_ja_ammpk_opiskelijat_tutkinnot]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_lukio_ja_ammpk_opiskelijat_tutkinnot]'))
EXEC dbo.sp_executesql @statement = N'







CREATE view [dbo].[v_f_tab_lukio_ja_ammpk_opiskelijat_tutkinnot] as


SELECT [Tilastovuosi] = f.tilastovuosi
      ,[Perusjoukko] = d1.perusjoukko
      ,[Äidinkieli] = d2.aidinkieli_versio1
      ,[Koulutusala] = d3.koulutusala2002
	  ,[Opintoala] = d3.opintoala2002
	  ,[Koulutusnimike] = d3.koulutus
      ,[Koulutuksen maakunta] = d4.maakunta
	  ,[Koulutuksen AVI] = d4.avi
	  ,[Koulutuksen ELY] = d4.ely
      ,[lkm]

	  --Ruotsi
	  ,[Statistikår] = f.tilastovuosi
      ,[Modersmål] = d2.aidinkieli_versio1_SV
      ,[Utbildningsområde] = d3.koulutusala2002_SV
	  ,[Studieområde] = d3.opintoala2002_SV
	  ,[Utbildningsbenämning] = d3.koulutus_SV
      ,[Utbildningens landskap] = d4.maakunta_SV
	  ,[Utbildningens RFV-område] = d4.avi_SV
	  ,[Utbildningens NTM-område] = d4.ely_SV

	  --Englanti
	  ,[Statistical year] = f.tilastovuosi
      ,[Mother tongue] = d2.aidinkieli_versio1_EN
      ,[Field of education] = d3.koulutusala2002_EN
	  ,[Subfield of education] = d3.opintoala2002_EN
	  ,[Name of education] = d3.koulutus_EN
      ,[Region of education] = d4.maakunta_EN
	  ,[AVI area of education] = d4.avi_EN
	  ,[ELY area of education] = d4.ely_EN

	  --isced
	  ,d3.iscle2011 as "Koulutusaste, taso 1"
	  ,d3.Koulutusaste_taso2 as "Koulutusaste, taso 2"
	  ,d3.iscfibroad2013 as "Koulutusala, taso 1"
	  ,d3.iscfinarrow2013 as "Koulutusala, taso 2"
	  ,d3.iscfi2013 as "Koulutusala, taso 3"
	  ,d3.OKM_ohjauksen_ala as "OKM ohjauksen ala, korkeak."
	  ,d3.iscle2011_SV as "Utbildn.nivå, nivå 1"
	  ,d3.Koulutusaste_taso2_SV as "Utbildn.nivå, nivå 2"
	  ,d3.iscfibroad2013_SV as "Utbildn.område, nivå 1"
	  ,d3.iscfinarrow2013_SV as "Utbildn.område, nivå 2"
	  ,d3.iscfi2013_SV as "Utbildn.område, nivå 3"
	  ,d3.OKM_ohjauksen_ala_SV as "UKM-styrningsområde, högskolor"
	  ,d3.iscle2011_EN as "Level of education, tier 1"
	  ,d3.Koulutusaste_taso2_EN as "Level of education, tier 2"
	  ,d3.iscfibroad2013_EN as "Field of education, tier 1"
	  ,d3.iscfinarrow2013_EN as "Field of education, tier 2"
	  ,d3.iscfi2013_EN as "Field of education, tier 3"
	  ,d3.OKM_ohjauksen_ala_EN as "Field of ed., HE steering"

	  --koodimuuttujat
	  ,d3.koulutusala2002_koodi as "Koodit Koulutusala 2002"
	  ,d3.opintoala2002_koodi as "Koodit Opintoala 2002"
	  ,d3.koulutus_koodi as "Koodit Koulutusnimike"
	  ,d4.maakunta_koodi as "Koodit Koulutuksen maakunta"
	  ,d3.iscle2011_koodi as "Koodit Koulutusaste, taso 1"
	  ,d3.Koulutusaste_taso2_koodi as "Koodit Koulutusaste, taso 2"
	  ,d3.iscfibroad2013_koodi as "Koodit Koulutusala, taso 1"
	  ,d3.iscfinarrow2013_koodi as "Koodit Koulutusala, taso 2"
	  ,d3.iscfi2013_koodi as "Koodit Koulutusala, taso 3"
	  ,d3.OKM_ohjauksen_ala_koodi as "Koodit OKM ohjauksen ala, korkeak."

	  --järjestys
	  ,[Äidinkieli järjestys] = d2.jarjestys
	  ,[Koulutusala järjestys] = d3.jarjestys_koulutusala2002
	  ,[Opintoala järjestys] = d3.jarjestys_opintoala2002
	  ,[Maakunta järjestys] = d4.jarjestys_maakunta
	  ,[AVI järjestys] = d4.jarjestys_avi
	  ,[ELY järjestys] = d4.jarjestys_ely
	  ,d3.jarjestys_iscle2011 as jarj_isced_koulast1
	  ,d3.jarjestys_Koulutusaste_taso2 as jarj_isced_koulast2
	  ,d3.jarjestys_iscfibroad2013 as jarj_isced_koulala1
	  ,d3.jarjestys_iscfinarrow2013 as jarj_isced_koulala2
	  ,d3.jarjestys_iscfi2013 as jarj_isced_koulala3
	  ,d3.jarjestys_OKM_ohjauksen_ala as jarj_isced_okmohjaus1
      


FROM VipunenTK.dbo.f_Lukion_ja_ammatillisen_peruskoulutuksen_opiskelijat_tutkinnot f

	LEFT JOIN VipunenTK.dbo.d_perusjoukko d1
	on d1.id=f.perusjoukko_id
 
	LEFT JOIN VipunenTK.dbo.d_aidinkieli_versio1 d2
	on d2.id=f.aidinkieli_id

	LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d3
	on d3.id=f.koulutusluokitus_id

	LEFT JOIN VipunenTK.dbo.d_alueluokitus d4
	on d4.id=f.koulutuksen_maakunta_id




















' 
GO
/****** Object:  View [dbo].[v_f_tab_Moninkertainen_haku_aiemmat_tutkinnot]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_Moninkertainen_haku_aiemmat_tutkinnot]'))
EXEC dbo.sp_executesql @statement = N'



CREATE VIEW [dbo].[v_f_tab_Moninkertainen_haku_aiemmat_tutkinnot] AS

--Select * from VipunenTK.dbo.v_f_tab_Moninkertainen_haku_hakijat

SELECT
--Organisaatiomuuttujat
      [Aik. tutkinnon oppilaitos] = d_ol.oppilaitos
      ,[Aik. tutkinnon oppil. kunta] = d_ol_al.kunta
      ,[Aik. tutkinnon oppil. maakunta] = d_ol_al.maakunta
--Koulutusmuuttujat
      ,[Aik. tutkinnon koul.aste] = d_koul.koulutusaste2002
      ,[Aik. tutkinnon opintoala] = d_koul.opintoala2002
      ,[Aik. tutkinnon koul.ala (95 luokitus)] = d_koul.opintoala1995
	  ,[Aik. tutkinnon koul.ala (02 luokitus)] = d_koul.koulutusala2002
	  ,[Aik. tutkinnon koul.nimike] = d_koul.koulutus
	  ,[Aik. tutkinnon sektori] = d_tutk.tutkinto
	  ,[Aik. tutkinnon suoritusvuosi] = [Aiemmin_suoritettu_tutkinto_suoritusvuosi]
	  ,[Aik. tutkinto tuorein] = [Aiemmin_suoritettu_tutkinto_tuorein]
	  ,[Aik. tutkinnon ajankohta] = d_ajkohta.suhteellinen_ajankohta
	  ,[Aik. tutkinnon ikä] = [Aiemmin_suoritettu_tutkinto_ika]
--Järjestyskentät
	  ,jarjestys_oppilaitos = d_ol.jarjestys_oppilaitos
	  ,jarjestys_oppilaitoskunta = d_ol_al.jarjestys
	  ,jarjestys_oppilaitosmaakunta = d_ol_al.jarjestys_maakunta
	  ,jarjestys_koulutusaste2002 = d_koul.jarjestys_koulutusaste2002
	  ,jarjestys_opintoala2002 = d_koul.jarjestys_opintoala2002
	  ,jarjestys_opintoala1995 = d_koul.jarjestys_opintoala1995
	  ,jarjestys_koulutusala2002 = d_koul.jarjestys_koulutusala2002
	  ,jarjestys_koulutus = d_koul.koulutus
	  ,jarjestys_tutk_sektori = d_tutk.jarjestys
	  ,jarjestys_ajankohta = d_ajkohta.jarjestys
--Lukumäärämuuttujat
      ,''lkm_edtutk2'' = [lkm]
--Faktat yhdistävä kenttä
      ,[rivinumero]
  FROM [dbo].[f_Moninkertainen_haku_aiemmat_tutkinnot] f
JOIN VipunenTK.dbo.d_oppilaitoksen_taustatiedot d_ol
	ON d_ol.id = f.Aiemmin_suoritettu_tutkinto_oppilaitos_id
JOIN VipunenTK.dbo.d_alueluokitus d_ol_al
	ON d_ol_al.id = f.Aiemmin_suoritettu_tutkinto_oppilaitoksen_alueluokitus_id
JOIN VipunenTK.dbo.d_koulutusluokitus d_koul
	ON d_koul.id = f.Aiemmin_suoritettu_tutkinto_koulutusluokitus_id
JOIN VipunenTK.dbo.d_tutkinto d_tutk
	ON d_tutk.id = f.Aiemmin_suoritettu_tutkinto_sektori_id
JOIN VipunenTK.dbo.d_suhteellinen_ajankohta d_ajkohta
	ON d_ajkohta.id = f.Aiemmin_suoritettu_tutkinto_ajankohta_id



' 
GO
/****** Object:  View [dbo].[v_f_tab_Moninkertainen_haku_edellisen_vuoden_opiskelut]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_Moninkertainen_haku_edellisen_vuoden_opiskelut]'))
EXEC dbo.sp_executesql @statement = N'




CREATE VIEW [dbo].[v_f_tab_Moninkertainen_haku_edellisen_vuoden_opiskelut] AS

--Select * from VipunenTK.dbo.v_f_tab_Moninkertainen_haku_hakijat

SELECT
--Organisaatiomuuttujat
      [Edellisen vuoden oppilaitos] = d_ol.oppilaitos
	  ,[Edellisen vuoden koul. järjestäjä] = d_ol.koulutuksen_jarjestaja
      ,[Edellisen vuoden oppil. kunta] = d_ol_al.kunta
      ,[Edellisen vuoden oppil. maakunta] = d_ol_al.maakunta
--Koulutusmuuttujat
      ,[Edellisen vuoden koul.aste] = d_koul.koulutusaste2002
      ,[Edellisen vuoden opintoala] = d_koul.opintoala2002
      ,[Edellisen vuoden koul.ala (95 luokitus)] = d_koul.opintoala1995
	  ,[Edellisen vuoden koul.ala (02 luokitus)] = d_koul.koulutusala2002
	  ,[Edellisen vuoden koul.nimike] = d_koul.koulutus
	  ,[Edellisen vuoden opiskelu] = d_ed.edellisen_vuoden_opiskelu_koulutus
	  ,[Edellisen vuoden opiskelu (tarkennus)] = d_ed.edellisen_vuoden_opiskelu_tarkennus
--Järjestyskentät
	  ,jarjestys_oppilaitos = d_ol.jarjestys_oppilaitos
	  ,jarjestys_oppilaitoskunta = d_ol_al.jarjestys
	  ,jarjestys_oppilaitosmaakunta = d_ol_al.jarjestys_maakunta
	  ,jarjestys_koulutusaste2002 = d_koul.jarjestys_koulutusaste2002
	  ,jarjestys_opintoala2002 = d_koul.jarjestys_opintoala2002
	  ,jarjestys_opintoala1995 = d_koul.jarjestys_opintoala1995
	  ,jarjestys_koulutusala2002 = d_koul.jarjestys_koulutusala2002
	  ,jarjestys_koulutus = d_koul.koulutus
	  ,jarjestys_ed_opiskelu = d_ed.jarjestys_koulutus
	  ,jarjestys_ed_opiskelu_tarkennus = d_ed.jarjestys_tarkennus
--Lukumäärämuuttujat
      ,''lkm_edop2'' = [lkm]
--Faktat yhdistävä kenttä
      ,[rivinumero]
  FROM [dbo].[f_Moninkertainen_haku_edellisen_vuoden_opiskelut] f
JOIN VipunenTK.dbo.d_oppilaitoksen_taustatiedot d_ol
	ON d_ol.id = f.Edellisen_vuoden_opiskelu_oppilaitos_id
JOIN VipunenTK.dbo.d_alueluokitus d_ol_al
	ON d_ol_al.id = f.Edellisen_vuoden_opiskelu_oppilaitoksen_alueluokitus_id
JOIN VipunenTK.dbo.d_koulutusluokitus d_koul
	ON d_koul.id = f.Edellisen_vuoden_opiskelu_koulutusluokitus_id
JOIN VipunenTK.dbo.d_edellisen_vuoden_opiskelu d_ed
	ON d_ed.id = f.Edellisen_vuoden_opiskelu_id
	



' 
GO
/****** Object:  View [dbo].[v_f_tab_Moninkertainen_haku_edelliset_haut]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_Moninkertainen_haku_edelliset_haut]'))
EXEC dbo.sp_executesql @statement = N'

CREATE VIEW [dbo].[v_f_tab_Moninkertainen_haku_edelliset_haut] AS

--Select * from VipunenTK.dbo.v_f_tab_Moninkertainen_haku_edelliset_haut

SELECT 
--Aikamuuttujat
       [Edellisen haun ajankohta] = d_sa.suhteellinen_ajankohta
--Hakukohdemuuttujat
      ,[Edellinen hakukohde] = d_hk.hakukohde
      ,''Hakenut toiselle asteelle'' = [Johdettu_Hakenut_toiselle_asteelle]
      ,''Hakenut korkeakoulutukseen'' = [Johdettu_Hakenut_korkeakoulutukseen]
      ,''Hakenut'' = [Johdettu_Hakenut]
--Järjestyskentät
	  ,jarjestys_hakukohde = d_hk.jarjestys
	  ,jarjestys_suhteellinen_ajankohta = d_sa.jarjestys
--Lukumäärämuuttujat
      ,''lkm_edhaut2'' = [lkm]
--Faktat yhdistävä kenttä
      ,[rivinumero]
  FROM [dbo].[f_Moninkertainen_haku_edelliset_haut] f
JOIN VipunenTK.dbo.d_hakukohde d_hk
	ON d_hk.id = f.Edellinen_haku_id
JOIN VipunenTK.dbo.d_suhteellinen_ajankohta d_sa
	ON d_sa.id = f.Edellinen_haku_ajankohta_id
	


' 
GO
/****** Object:  View [dbo].[v_f_tab_Moninkertainen_haku_hakijat]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_Moninkertainen_haku_hakijat]'))
EXEC dbo.sp_executesql @statement = N'

CREATE VIEW [dbo].[v_f_tab_Moninkertainen_haku_hakijat] AS

--Select * from VipunenTK.dbo.v_f_tab_Moninkertainen_haku_hakijat

SELECT
--Aikamuuttujat
	   [Tilastovuosi]
      ,Aloituslukuvuosi = d_kausi.lukuvuosi
	  ,Aloitusvuosi = d_kausi.vuosiselite
      ,Aloituslukukausi = d_kausi.lukukausiselite
--Henkilömuuttujat
	  ,''Sukupuoli'' = d_sp.sukupuoli
	  ,''Ikä'' = d_ika.ika
	  ,''Ikäryhmä'' = d_ika.ika5v
      ,''Syntymävuosi'' = [Syntymavuosi]
	  ,''Äidinkieli'' = d_ak.[aidinkieli_versio1]
      ,''Kotikunta vuotta aiemmin'' = d_al.[kunta]
      ,''Kotimaakunta vuotta aiemmin'' = d_al.[maakunta]
	  ,''Henkilötunnuksen oikeellisuus'' = d_ho.[hetu_ok]
      ,''Toiminta vuotta aiemmin'' = d_pt.[paaasiallinen_toiminta]
--Järjestyskentät
	  ,jarjestys_sukupuoli = d_sp.jarjestys
	  ,d_ika.jarjestys_ika
	  ,d_ika.jarjestys_ika5v
	  ,jarjestys_aidinkieli = d_ak.jarjestys
	  ,jarjestys_kotikunta = d_al.jarjestys
	  ,d_al.jarjestys_maakunta
	  ,jarjestys_hetuok = d_ho.jarjestys
	  ,jarjestys_paatoiminta = d_pt.jarjestys
--Lukumäärämuuttujat
      ,''lkm_hak2'' = [lkm]
--Faktat yhdistävä kenttä
      ,[rivinumero]
  FROM [dbo].[f_Moninkertainen_haku_hakijat] f
JOIN VipunenTK.dbo.d_kausi
	ON d_kausi.kausi_id = f.Koulutuksen_alkamislukukausi_avain
JOIN VipunenTK.dbo.d_sukupuoli d_sp
	ON d_sp.id = f.sukupuoli_id
JOIN VipunenTK.dbo.d_ika 
	ON d_ika.id = f.Ika_id
JOIN VipunenTK.dbo.d_aidinkieli_versio1 d_ak
	ON d_ak.id = f.Aidinkielir1_id
JOIN VipunenTK.dbo.d_alueluokitus d_al
	ON d_al.id = f.Kotikunta_vuotta_aiemmin_id
JOIN VipunenTK.dbo.d_hetu_ok d_ho
	ON d_ho.id = f.Hetuntila_id
JOIN VipunenTK.dbo.d_paaasiallinen_toiminta d_pt
	ON d_pt.id = f.Toiminta_vuotta_aiemmin_id
	



' 
GO
/****** Object:  View [dbo].[v_f_tab_Moninkertainen_haku_uudet_haut]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_Moninkertainen_haku_uudet_haut]'))
EXEC dbo.sp_executesql @statement = N'






CREATE VIEW [dbo].[v_f_tab_Moninkertainen_haku_uudet_haut] AS

--Select * from VipunenTK.dbo.v_f_tab_Moninkertainen_haku_uudet_haut

SELECT
--Aikamuuttujat
       ''Hakukohteen aloituslukuvuosi'' = d_kau.lukuvuosi
	  ,''Hakukohteen aloitusvuosi'' = d_kau.vuosiselite
      ,''Hakukohteen aloituslukukausi'' = d_kau.lukukausiselite
--Organisaatiomuuttujat
	  ,[Hakukohde] = d_hk.hakukohde
      ,[Hakukohteen oppilaitos] = d_ol.oppilaitos
	  ,[Hakukohteen koul. järjestäjä] = d_ol.koulutuksen_jarjestaja
      ,[Hakukohteen oppil. kunta] = d_ol_al.kunta
      ,[Hakukohteen oppil. maakunta] = d_ol_al.maakunta
--Hakukohdemuuttujat
      ,[Hakukohteen koulutusaste] = d_ka02.koulutusaste2002
      ,[Hakukohteen opintoala] = d_oa02.opintoala2002
	  ,[Hakukohteen koulutusala (02 luokitus)] = d_oa02.koulutusala2002
      ,[Hakukohteen koulutusala (95 luokitus)] = d_oa95.opintoala1995
      ,[Hakukohteen prioriteetti] = d_hp.hakukohteen_prioriteetti
      ,[Hakukohde hyväksytty] = d_ht.hakukohde_hyvaksytty
      ,[Hakukohde vastaanotettu] = d_ht.hakukohde_vastaanotettu
      ,[Hakukohteen tutkinnon taso] = d_htt.hakukohde_tutkinnon_taso
      ,[Hakukohteen tutk. taso tarkennus] = d_htt.hakukohde_tutkinnon_taso_tarkennus
      ,[Hakukohde erillisvalinta] = d_hev.hakukohde_erillisvalinta
      ,''Aik. tutkinto haun koul.asteella''= [Johdettu_Sama_koulutusaste02_Aiempi_tutkinto_Haku]
      ,''Opiskellut aik. haun koul.asteella''= [Johdettu_Sama_koulutusaste02_Aiempi_opiskelu_Haku]
      ,''Aik. tutkinto haun koul.alalla (95)''= [Johdettu_Sama_opintoala95_Aiempi_tutkinto_Haku]
      ,''Opiskellut aik. haun koul.alalla (95)''= [Johdettu_Sama_opintoala95_Aiempi_opiskelu_Haku]
      ,''Aik. tutkinto haun opintoalalla''= [Johdettu_Sama_opintoala02_Aiempi_tutkinto_Haku]
      ,''Opiskellut aik. haun opintoalalla''= [Johdettu_Sama_opintoala02_Aiempi_opiskelu_Haku]
      ,''Aik. tutkinto haun koul.alalla (02)''= [Johdettu_Sama_koulutusala02_Aiempi_tutkinto_Haku]
      ,''Opiskellut aik. haun koul.alalla (02)''= [Johdettu_Sama_koulutusala02_Aiempi_opiskelu_Haku]
      ,''Aik. tutkinto haun oppilaitoksessa''= [Johdettu_Sama_oppilaitos_Aiempi_tutkinto_Haku]
      ,''Opiskellut aik. haun oppilaitoksessa''= [Johdettu_Sama_oppilaitos_Aiempi_opiskelu_Haku]
      ,''Aik. tutkinto haun koul.sektorilla''= [Johdettu_Sama_sektori_Aiempi_tutkinto_Haku]
      ,''Opiskellut aik. haun koul.sektorilla''= [Johdettu_Sama_sektori_Aiempi_opiskelu_Haku]
      ,''Aik. tutkinto tai opiskelu haun sektorilla''= [Johdettu_Sama_sektori_Aiempi_tutkinto_tai_opiskelu_Haku]
      ,''Aik. tutkinto haun koul.sektorilla (laaja)''= [Johdettu_Sama_laaja_sektori_Aiempi_tutkinto_Haku]
      ,''Opiskellut aik. haun koul.sektorilla (laaja)''= [Johdettu_Sama_laaja_sektori_Aiempi_opiskelu_Haku]
      ,''Aik. tutkinto tai opiskelu haun sektorilla (laaja)''= [Johdettu_Sama_laaja_sektori_Aiempi_tutkinto_tai_opiskelu_Haku]
      ,''Hakenut amk ja yo''= [Johdettu_Hakenut_Amk_ja_Yo]
      ,''Hakenut toinen aste ja korkeakoulut''= [Johdettu_Hakenut_Korkea_aste_ja_Toinen_aste]
      ,''Hakenut lukio ja ammatillinen''= [Johdettu_Hakenut_Lukio_ja_Ammatillinen_koulutus]
--Järjestyskentät
	  ,jarjestys_hakukohde = d_hk.jarjestys
	  ,jarjestys_oppilaitos = d_ol.jarjestys_oppilaitos
	  ,jarjestys_oppilaitoskunta = d_ol_al.jarjestys
	  ,jarjestys_oppilaitosmaakunta = d_ol_al.jarjestys_maakunta
	  ,jarjestys_koulutusaste2002 = d_ka02.jarjestys_koulutusaste2002
	  ,jarjestys_opintoala2002 = d_oa02.jarjestys_opintoala2002
	  ,jarjestys_koulutusala2002 = d_oa02.jarjestys_koulutusala2002
	  ,jarjestys_opintoala1995 = d_oa95.jarjestys_opintoala1995
	  ,jarjestys_hakukohteen_prioriteetti = d_hp.jarjestys
	  ,jarjestys_hakukohde_hyvaksytty = d_ht.jarjestys_hyvaksytty
	  ,jarjestys_hakukohde_vastaanotettu = d_ht.jarjestys_vastaanotettu
	  ,jarjestys_hakukohde_tutkinnon_taso = d_htt.jarjestys_hakukohde_tutkinnon_taso
	  ,jarjestys_hakukohde_tutkinnon_taso_tarkennus = d_htt.jarjestys_hakukohde_tutkinnon_taso_tarkennus
	  ,jarjestys_hakukohde_erillisvalinta = d_hev.jarjestys
--Lukumäärämuuttujat
      ,''lkm_uusih2'' = [lkm]
--Faktat yhdistävä kenttä
      ,[rivinumero]
  FROM [dbo].[f_Moninkertainen_haku_uudet_haut] f
JOIN VipunenTK.dbo.d_hakukohde d_hk
	ON d_hk.id = f.hakukohde_id
JOIN VipunenTK.dbo.d_oppilaitoksen_taustatiedot d_ol
	ON d_ol.id = f.Hakukohde_oppilaitos_id
JOIN VipunenTK.dbo.d_alueluokitus d_ol_al
	ON d_ol_al.id = f.Hakukohde_oppilaitoksen_alueluokitus_id
JOIN VipunenTK.dbo.d_koulutusluokitus d_ka02
	ON d_ka02.id = f.Hakukohde_koulutusaste2002_id
JOIN VipunenTK.dbo.d_koulutusluokitus d_oa02
	ON d_oa02.id = f.Hakukohde_opintoala2002_id
JOIN VipunenTK.dbo.d_koulutusluokitus d_oa95
	ON d_oa95.id = f.Hakukohde_opintoala1995_id
JOIN VipunenTK.dbo.d_hakukohteen_prioriteetti d_hp
	ON d_hp.id = f.Hakukohde_prioriteetti_id
JOIN VipunenTK.dbo.d_hakukohteen_tulos d_ht
	ON d_ht.hakukohde_hyvaksytty_koodi = f.Hakukohde_hyvaksytty
	AND d_ht.hakukohde_vastaanotettu_koodi = f.Hakukohde_vastaanotettu
JOIN VipunenTK.dbo.d_hakukohteen_tutkinnon_taso d_htt
	ON d_htt.hakukohde_tutkinnon_taso_koodi = f.Hakukohde_tutkinnon_taso
	AND d_htt.Hakukohde_tutkinnon_taso_tarkennus_koodi = f.Hakukohde_tutkinnon_taso_tarkennus
JOIN VipunenTK.dbo.d_hakukohde_erillisvalinta d_hev
	ON d_hev.id = f.Hakukohde_erillisvalinta_id
JOIN VipunenTK.dbo.d_kausi d_kau
	ON d_kau.kausi_id = f.Hakukohde_koulutuksen_alkamislukukausi_id

WHERE d_hk.jarjestys in (13,14)




' 
GO
/****** Object:  View [dbo].[v_f_tab_Moninkertainen_haku_uudet_haut_toinen_aste]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_Moninkertainen_haku_uudet_haut_toinen_aste]'))
EXEC dbo.sp_executesql @statement = N'






CREATE VIEW [dbo].[v_f_tab_Moninkertainen_haku_uudet_haut_toinen_aste] AS

--Select * from VipunenTK.dbo.v_f_tab_Moninkertainen_haku_uudet_haut

SELECT
--Aikamuuttujat
       ''Hakukohteen aloituslukuvuosi'' = d_kau.lukuvuosi
	  ,''Hakukohteen aloitusvuosi'' = d_kau.vuosiselite
      ,''Hakukohteen aloituslukukausi'' = d_kau.lukukausiselite
--Organisaatiomuuttujat
	  ,[Hakukohde] = d_hk.hakukohde
      ,[Hakukohteen oppilaitos] = d_ol.oppilaitos
	  ,[Hakukohteen koul. järjestäjä] = d_ol.koulutuksen_jarjestaja
      ,[Hakukohteen oppil. kunta] = d_ol_al.kunta
      ,[Hakukohteen oppil. maakunta] = d_ol_al.maakunta
--Hakukohdemuuttujat
      ,[Hakukohteen koulutusaste] = d_ka02.koulutusaste2002
      ,[Hakukohteen opintoala] = d_oa02.opintoala2002
	  ,[Hakukohteen koulutusala (02 luokitus)] = d_oa02.koulutusala2002
      ,[Hakukohteen koulutusala (95 luokitus)] = d_oa95.opintoala1995
      ,[Hakukohteen prioriteetti] = d_hp.hakukohteen_prioriteetti
      ,[Hakukohde hyväksytty] = d_ht.hakukohde_hyvaksytty
      ,[Hakukohde vastaanotettu] = d_ht.hakukohde_vastaanotettu
      ,[Hakukohteen tutkinnon taso] = d_htt.hakukohde_tutkinnon_taso
      ,[Hakukohteen tutk. taso tarkennus] = d_htt.hakukohde_tutkinnon_taso_tarkennus
      ,[Hakukohde erillisvalinta] = d_hev.hakukohde_erillisvalinta
      ,''Aik. tutkinto haun koul.asteella''= [Johdettu_Sama_koulutusaste02_Aiempi_tutkinto_Haku]
      ,''Opiskellut aik. haun koul.asteella''= [Johdettu_Sama_koulutusaste02_Aiempi_opiskelu_Haku]
      ,''Aik. tutkinto haun koul.alalla (95)''= [Johdettu_Sama_opintoala95_Aiempi_tutkinto_Haku]
      ,''Opiskellut aik. haun koul.alalla (95)''= [Johdettu_Sama_opintoala95_Aiempi_opiskelu_Haku]
      ,''Aik. tutkinto haun opintoalalla''= [Johdettu_Sama_opintoala02_Aiempi_tutkinto_Haku]
      ,''Opiskellut aik. haun opintoalalla''= [Johdettu_Sama_opintoala02_Aiempi_opiskelu_Haku]
      ,''Aik. tutkinto haun koul.alalla (02)''= [Johdettu_Sama_koulutusala02_Aiempi_tutkinto_Haku]
      ,''Opiskellut aik. haun koul.alalla (02)''= [Johdettu_Sama_koulutusala02_Aiempi_opiskelu_Haku]
      ,''Aik. tutkinto haun oppilaitoksessa''= [Johdettu_Sama_oppilaitos_Aiempi_tutkinto_Haku]
      ,''Opiskellut aik. haun oppilaitoksessa''= [Johdettu_Sama_oppilaitos_Aiempi_opiskelu_Haku]
      ,''Aik. tutkinto haun koul.sektorilla''= [Johdettu_Sama_sektori_Aiempi_tutkinto_Haku]
      ,''Opiskellut aik. haun koul.sektorilla''= [Johdettu_Sama_sektori_Aiempi_opiskelu_Haku]
      ,''Aik. tutkinto tai opiskelu haun sektorilla''= [Johdettu_Sama_sektori_Aiempi_tutkinto_tai_opiskelu_Haku]
      ,''Aik. tutkinto haun koul.sektorilla (laaja)''= [Johdettu_Sama_laaja_sektori_Aiempi_tutkinto_Haku]
      ,''Opiskellut aik. haun koul.sektorilla (laaja)''= [Johdettu_Sama_laaja_sektori_Aiempi_opiskelu_Haku]
      ,''Aik. tutkinto tai opiskelu haun sektorilla (laaja)''= [Johdettu_Sama_laaja_sektori_Aiempi_tutkinto_tai_opiskelu_Haku]
      ,''Hakenut amk ja yo''= [Johdettu_Hakenut_Amk_ja_Yo]
      ,''Hakenut toinen aste ja korkeakoulut''= [Johdettu_Hakenut_Korkea_aste_ja_Toinen_aste]
      ,''Hakenut lukio ja ammatillinen''= [Johdettu_Hakenut_Lukio_ja_Ammatillinen_koulutus]
--Järjestyskentät
	  ,jarjestys_hakukohde = d_hk.jarjestys
	  ,jarjestys_oppilaitos = d_ol.jarjestys_oppilaitos
	  ,jarjestys_oppilaitoskunta = d_ol_al.jarjestys
	  ,jarjestys_oppilaitosmaakunta = d_ol_al.jarjestys_maakunta
	  ,jarjestys_koulutusaste2002 = d_ka02.jarjestys_koulutusaste2002
	  ,jarjestys_opintoala2002 = d_oa02.jarjestys_opintoala2002
	  ,jarjestys_koulutusala2002 = d_oa02.jarjestys_koulutusala2002
	  ,jarjestys_opintoala1995 = d_oa95.jarjestys_opintoala1995
	  ,jarjestys_hakukohteen_prioriteetti = d_hp.jarjestys
	  ,jarjestys_hakukohde_hyvaksytty = d_ht.jarjestys_hyvaksytty
	  ,jarjestys_hakukohde_vastaanotettu = d_ht.jarjestys_vastaanotettu
	  ,jarjestys_hakukohde_tutkinnon_taso = d_htt.jarjestys_hakukohde_tutkinnon_taso
	  ,jarjestys_hakukohde_tutkinnon_taso_tarkennus = d_htt.jarjestys_hakukohde_tutkinnon_taso_tarkennus
	  ,jarjestys_hakukohde_erillisvalinta = d_hev.jarjestys
--Lukumäärämuuttujat
      ,''lkm_uusih2'' = [lkm]
--Faktat yhdistävä kenttä
      ,[rivinumero]
  FROM [dbo].[f_Moninkertainen_haku_uudet_haut] f
JOIN VipunenTK.dbo.d_hakukohde d_hk
	ON d_hk.id = f.hakukohde_id
JOIN VipunenTK.dbo.d_oppilaitoksen_taustatiedot d_ol
	ON d_ol.id = f.Hakukohde_oppilaitos_id
JOIN VipunenTK.dbo.d_alueluokitus d_ol_al
	ON d_ol_al.id = f.Hakukohde_oppilaitoksen_alueluokitus_id
JOIN VipunenTK.dbo.d_koulutusluokitus d_ka02
	ON d_ka02.id = f.Hakukohde_koulutusaste2002_id
JOIN VipunenTK.dbo.d_koulutusluokitus d_oa02
	ON d_oa02.id = f.Hakukohde_opintoala2002_id
JOIN VipunenTK.dbo.d_koulutusluokitus d_oa95
	ON d_oa95.id = f.Hakukohde_opintoala1995_id
JOIN VipunenTK.dbo.d_hakukohteen_prioriteetti d_hp
	ON d_hp.id = f.Hakukohde_prioriteetti_id
JOIN VipunenTK.dbo.d_hakukohteen_tulos d_ht
	ON d_ht.hakukohde_hyvaksytty_koodi = f.Hakukohde_hyvaksytty
	AND d_ht.hakukohde_vastaanotettu_koodi = f.Hakukohde_vastaanotettu
JOIN VipunenTK.dbo.d_hakukohteen_tutkinnon_taso d_htt
	ON d_htt.hakukohde_tutkinnon_taso_koodi = f.Hakukohde_tutkinnon_taso
	AND d_htt.Hakukohde_tutkinnon_taso_tarkennus_koodi = f.Hakukohde_tutkinnon_taso_tarkennus
JOIN VipunenTK.dbo.d_hakukohde_erillisvalinta d_hev
	ON d_hev.id = f.Hakukohde_erillisvalinta_id
JOIN VipunenTK.dbo.d_kausi d_kau
	ON d_kau.kausi_id = f.Hakukohde_koulutuksen_alkamislukukausi_id

WHERE d_hk.jarjestys in (11,12)




' 
GO
/****** Object:  View [dbo].[v_f_tab_Moninkertainen_haku_uudet_haut_yliopisto]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_Moninkertainen_haku_uudet_haut_yliopisto]'))
EXEC dbo.sp_executesql @statement = N'







CREATE VIEW [dbo].[v_f_tab_Moninkertainen_haku_uudet_haut_yliopisto] AS

--Select * from VipunenTK.dbo.v_f_tab_Moninkertainen_haku_uudet_haut

SELECT
--Aikamuuttujat
       ''Hakukohteen aloituslukuvuosi'' = d_kau.lukuvuosi
	  ,''Hakukohteen aloitusvuosi'' = d_kau.vuosiselite
      ,''Hakukohteen aloituslukukausi'' = d_kau.lukukausiselite
--Organisaatiomuuttujat
	  ,[Hakukohde] = d_hk.hakukohde
      ,[Hakukohteen oppilaitos] = d_ol.oppilaitos
	  ,[Hakukohteen koul. järjestäjä] = d_ol.koulutuksen_jarjestaja
      ,[Hakukohteen oppil. kunta] = d_ol_al.kunta
      ,[Hakukohteen oppil. maakunta] = d_ol_al.maakunta
--Hakukohdemuuttujat
      ,[Hakukohteen koulutusaste] = d_ka02.koulutusaste2002
      ,[Hakukohteen opintoala] = d_oa02.opintoala2002
	  ,[Hakukohteen koulutusala (02 luokitus)] = d_oa02.koulutusala2002
      ,[Hakukohteen koulutusala (95 luokitus)] = d_oa95.opintoala1995
      ,[Hakukohteen prioriteetti] = d_hp.hakukohteen_prioriteetti
      ,[Hakukohde hyväksytty] = d_ht.hakukohde_hyvaksytty
      ,[Hakukohde vastaanotettu] = d_ht.hakukohde_vastaanotettu
      ,[Hakukohteen tutkinnon taso] = d_htt.hakukohde_tutkinnon_taso
      ,[Hakukohteen tutk. taso tarkennus] = d_htt.hakukohde_tutkinnon_taso_tarkennus
      ,[Hakukohde erillisvalinta] = d_hev.hakukohde_erillisvalinta
      ,''Aik. tutkinto haun koul.asteella''= [Johdettu_Sama_koulutusaste02_Aiempi_tutkinto_Haku]
      ,''Opiskellut aik. haun koul.asteella''= [Johdettu_Sama_koulutusaste02_Aiempi_opiskelu_Haku]
      ,''Aik. tutkinto haun koul.alalla (95)''= [Johdettu_Sama_opintoala95_Aiempi_tutkinto_Haku]
      ,''Opiskellut aik. haun koul.alalla (95)''= [Johdettu_Sama_opintoala95_Aiempi_opiskelu_Haku]
      ,''Aik. tutkinto haun opintoalalla''= [Johdettu_Sama_opintoala02_Aiempi_tutkinto_Haku]
      ,''Opiskellut aik. haun opintoalalla''= [Johdettu_Sama_opintoala02_Aiempi_opiskelu_Haku]
      ,''Aik. tutkinto haun koul.alalla (02)''= [Johdettu_Sama_koulutusala02_Aiempi_tutkinto_Haku]
      ,''Opiskellut aik. haun koul.alalla (02)''= [Johdettu_Sama_koulutusala02_Aiempi_opiskelu_Haku]
      ,''Aik. tutkinto haun oppilaitoksessa''= [Johdettu_Sama_oppilaitos_Aiempi_tutkinto_Haku]
      ,''Opiskellut aik. haun oppilaitoksessa''= [Johdettu_Sama_oppilaitos_Aiempi_opiskelu_Haku]
      ,''Aik. tutkinto haun koul.sektorilla''= [Johdettu_Sama_sektori_Aiempi_tutkinto_Haku]
      ,''Opiskellut aik. haun koul.sektorilla''= [Johdettu_Sama_sektori_Aiempi_opiskelu_Haku]
      ,''Aik. tutkinto tai opiskelu haun sektorilla''= [Johdettu_Sama_sektori_Aiempi_tutkinto_tai_opiskelu_Haku]
      ,''Aik. tutkinto haun koul.sektorilla (laaja)''= [Johdettu_Sama_laaja_sektori_Aiempi_tutkinto_Haku]
      ,''Opiskellut aik. haun koul.sektorilla (laaja)''= [Johdettu_Sama_laaja_sektori_Aiempi_opiskelu_Haku]
      ,''Aik. tutkinto tai opiskelu haun sektorilla (laaja)''= [Johdettu_Sama_laaja_sektori_Aiempi_tutkinto_tai_opiskelu_Haku]
      ,''Hakenut amk ja yo''= [Johdettu_Hakenut_Amk_ja_Yo]
      ,''Hakenut toinen aste ja korkeakoulut''= [Johdettu_Hakenut_Korkea_aste_ja_Toinen_aste]
      ,''Hakenut lukio ja ammatillinen''= [Johdettu_Hakenut_Lukio_ja_Ammatillinen_koulutus]
--Järjestyskentät
	  ,jarjestys_hakukohde = d_hk.jarjestys
	  ,jarjestys_oppilaitos = d_ol.jarjestys_oppilaitos
	  ,jarjestys_oppilaitoskunta = d_ol_al.jarjestys
	  ,jarjestys_oppilaitosmaakunta = d_ol_al.jarjestys_maakunta
	  ,jarjestys_koulutusaste2002 = d_ka02.jarjestys_koulutusaste2002
	  ,jarjestys_opintoala2002 = d_oa02.jarjestys_opintoala2002
	  ,jarjestys_koulutusala2002 = d_oa02.jarjestys_koulutusala2002
	  ,jarjestys_opintoala1995 = d_oa95.jarjestys_opintoala1995
	  ,jarjestys_hakukohteen_prioriteetti = d_hp.jarjestys
	  ,jarjestys_hakukohde_hyvaksytty = d_ht.jarjestys_hyvaksytty
	  ,jarjestys_hakukohde_vastaanotettu = d_ht.jarjestys_vastaanotettu
	  ,jarjestys_hakukohde_tutkinnon_taso = d_htt.jarjestys_hakukohde_tutkinnon_taso
	  ,jarjestys_hakukohde_tutkinnon_taso_tarkennus = d_htt.jarjestys_hakukohde_tutkinnon_taso_tarkennus
	  ,jarjestys_hakukohde_erillisvalinta = d_hev.jarjestys
--Lukumäärämuuttujat
      ,''lkm_uusih2'' = [lkm]
--Faktat yhdistävä kenttä
      ,[rivinumero]
  FROM [dbo].[f_Moninkertainen_haku_uudet_haut] f
JOIN VipunenTK.dbo.d_hakukohde d_hk
	ON d_hk.id = f.hakukohde_id
JOIN VipunenTK.dbo.d_oppilaitoksen_taustatiedot d_ol
	ON d_ol.id = f.Hakukohde_oppilaitos_id
JOIN VipunenTK.dbo.d_alueluokitus d_ol_al
	ON d_ol_al.id = f.Hakukohde_oppilaitoksen_alueluokitus_id
JOIN VipunenTK.dbo.d_koulutusluokitus d_ka02
	ON d_ka02.id = f.Hakukohde_koulutusaste2002_id
JOIN VipunenTK.dbo.d_koulutusluokitus d_oa02
	ON d_oa02.id = f.Hakukohde_opintoala2002_id
JOIN VipunenTK.dbo.d_koulutusluokitus d_oa95
	ON d_oa95.id = f.Hakukohde_opintoala1995_id
JOIN VipunenTK.dbo.d_hakukohteen_prioriteetti d_hp
	ON d_hp.id = f.Hakukohde_prioriteetti_id
JOIN VipunenTK.dbo.d_hakukohteen_tulos d_ht
	ON d_ht.hakukohde_hyvaksytty_koodi = f.Hakukohde_hyvaksytty
	AND d_ht.hakukohde_vastaanotettu_koodi = f.Hakukohde_vastaanotettu
JOIN VipunenTK.dbo.d_hakukohteen_tutkinnon_taso d_htt
	ON d_htt.hakukohde_tutkinnon_taso_koodi = f.Hakukohde_tutkinnon_taso
	AND d_htt.Hakukohde_tutkinnon_taso_tarkennus_koodi = f.Hakukohde_tutkinnon_taso_tarkennus
JOIN VipunenTK.dbo.d_hakukohde_erillisvalinta d_hev
	ON d_hev.id = f.Hakukohde_erillisvalinta_id
JOIN VipunenTK.dbo.d_kausi d_kau
	ON d_kau.kausi_id = f.Hakukohde_koulutuksen_alkamislukukausi_id

WHERE d_hk.jarjestys in (13,14) and hakukohde=''yliopisto''





' 
GO
/****** Object:  View [dbo].[v_f_tab_opettajat_7_1]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_opettajat_7_1]'))
EXEC dbo.sp_executesql @statement = N'


























CREATE view [dbo].[v_f_tab_opettajat_7_1] as

Select
      [Tilastovuosi] = f.tilastointivuosi
      ,[Oppilaitoksen opetuskieli] = d1.opetuskieli
      ,[Oppilaitostyyppi] = d2.oppilaitostyyppi
      --,[Vakinainen työsuhde] = case f.tyosuhde_vakinainen when ''1'' then ''Vakinainen työsuhde'' when ''0'' then ''Ei vakinainen työsuhde'' end
      --,[Määräaikainen työsuhde] = case f.tyosuhde_maara_aikainen when ''1'' then ''Määräaikainen työsuhde'' when ''0'' then ''Ei määräaikainen työsuhde'' end
      --,[Viransijainen/toimensijainen] = case f.tyosuhde_viransijainen when ''1'' then ''Viransijainen/toimensijainen työsuhde'' when ''0'' then ''Ei viransijainen/toimensijainen työsuhde'' else ''Tuntematon'' end
      --,[Virkavapaalla] = case f.tyosuhde_virkavapaa when ''1'' then ''Virkavapaalla'' when ''0'' then ''Ei virkavapaalla'' end
      --,[Osa-aikaeläkkeellä] = case f.tyosuhde_oa_elake when ''1'' then ''Osa-aikaeläkkeellä'' when ''0'' then ''Ei osa-aikaeläkkeellä'' end
      ,[Tehtävätyyppi] = d7.tehtavatyyppi
      ,[Pääasiallinen koulutusmuoto] = d8.koulutusaste
	  ,[Työsuhteen luonne] = d26.tyosuhteen_luonne
	  ,[Koko-/osa-aikainen] = d27.koko_osa_aikainen
	  ,[Osa-aikaisuuden syy] = d28.syy
      --,[Kelpoisuus esiopetuksen opettaja] = case f.kelp_esiopetus when ''1'' then ''Kelpoisuus'' when ''0'' then ''Ei kelpoisuutta'' end
      --,[Kelpoisuus luokanopettaja] = case f.kelp_luokanopettaja when ''1'' then ''Kelpoisuus'' when ''0'' then ''Ei kelpoisuutta'' end
      --,[Kelpoisuus aineenopettaja] = case f.kelp_aineenopettaja when ''1'' then ''Kelpoisuus'' when ''0'' then ''Ei kelpoisuutta'' end
      --,[Kelpoisuus aineenopettaja lukio] = case f.kelp_aineenopettaja_lukio when ''1'' then ''Kelpoisuus'' when ''0'' then ''Ei kelpoisuutta'' end
      --,[Kelpoisuus erityisluokan opettaja] = case f.kelp_erityisluokan_opettaja when ''1'' then ''Kelpoisuus'' when ''0'' then ''Ei kelpoisuutta'' end
      --,[Kelpoisuus osa-aikainen erityisopettaja] = case f.kelp_erityisopettaja_osa_aikainen when ''1'' then ''Kelpoisuus'' when ''0'' then ''Ei kelpoisuutta'' end
      --,[Kelpoisuus oppilaanohjaaja] = case f.kelp_oppilaanohjaaja when ''1'' then ''Kelpoisuus'' when ''0'' then ''Ei kelpoisuutta'' end
      --,[Kelpoisuus opinto-ohjaaja] = case f.kelp_opinto_ohjaaja when ''1'' then ''Kelpoisuus'' when ''0'' then ''Ei kelpoisuutta'' end
      ,[Muu opettajankelpoisuus] = coalesce(d29.kylla_ei,''Tieto puuttuu'')
      --,[Muodollinen kelpoisuus hoidettuun tehtävään] = case f.kelp_ei when ''1'' then ''Ei kelpoisuutta'' when ''0'' then ''Kelpoisuus'' end
      --,[Kelpoisuus kehitysvammaisille annettava erityisopetus] = case f.kelp_kehitysvammaiset when ''1'' then ''Kelpoisuus'' when ''0'' then ''Ei kelpoisuutta'' else ''Tuntematon'' end
      ,[Oman luokan aste] = d20.luokka_aste
      ,[Oman luokan oppilasmäärä] = f.oman_luokan_oppilasmäärä
	  ,[Oman luokan koko] = case 
							when f.oman_luokan_oppilasmäärä >= 30 then ''yli 30 oppilasta''
							when f.oman_luokan_oppilasmäärä >= 25 then ''25-29 oppilasta''
							when f.oman_luokan_oppilasmäärä >= 20 then ''20-24 oppilasta''
							when f.oman_luokan_oppilasmäärä >= 15 then ''15-19 oppilasta''
							when f.oman_luokan_oppilasmäärä >= 10 then ''10-14 oppilasta''
							when f.oman_luokan_oppilasmäärä >= 1 then ''1-9 oppilasta''
							else ''Ei oppilaita''
						end
	  ,[Oma luokka] = case f.oman_luokan_oppilasmäärä when 0 then ''Ei'' else ''Kyllä'' end
      ,[Eniten opettama aine] = d21.aine
      ,[Sukupuoli] = d22.sukupuoli
      ,[Oppilaitoksen maakunta] = (select top 1 maakunta from dbo.d_alueluokitus where maakunta_koodi=f.maakunta_oppilaitos)
      ,[Oppilaitoksen sijaintikunnan kuntaryhmitys] = (select top 1 kuntaryhma from dbo.d_alueluokitus where kuntaryhma_koodi=f.kuntaryhmitys_oppilaitos)
      ,[Ikäryhmä] = d23.ika5v
	  ,[Kelpoisuus] = d25.opettajankelpoisuus


	  --Ruotsi
	  ,[Statistikår] = f.tilastointivuosi
      ,[Läroanstaltens undervisningsspråk] = d1.opetuskieli_SV
      ,[Läroanstaltstyp] = d2.oppilaitostyyppi_SV
      ,[Uppgiftstyp] = d7.tehtavatyyppi_SV
      ,[Huvudsaklig utbildningsform] = d8.koulutusaste_SV
      ,[Den egna klassen, stadium] = d20.luokka_aste_SV
      ,[Den egna klassen, elevantal] = f.oman_luokan_oppilasmäärä
	  ,[Den egna klassen, storlek] = 
		case 
			when f.oman_luokan_oppilasmäärä >= 30 then ''över 30 elever''
			when f.oman_luokan_oppilasmäärä >= 25 then ''25-29 elever''
			when f.oman_luokan_oppilasmäärä >= 20 then ''20-24 elever''
			when f.oman_luokan_oppilasmäärä >= 15 then ''15-19 elever''
			when f.oman_luokan_oppilasmäärä >= 10 then ''10-14 elever''
			when f.oman_luokan_oppilasmäärä >= 1 then ''1-9 elever''
			else ''inga elever''
		end
      ,[Lärarens huvudsakliga ämne] = d21.aine_SV
      ,[Kön] = d22.sukupuoli_SV
      ,[Läroanstaltens landskap] = (select top 1 maakunta_SV from dbo.d_alueluokitus where maakunta_koodi=f.maakunta_oppilaitos)
      ,[Läroanstaltens kommungruppering] = (select top 1 kuntaryhma_SV from dbo.d_alueluokitus where kuntaryhma_koodi=f.kuntaryhmitys_oppilaitos)
      ,[Åldersgrupp] = d23.ika5v_SV


	  --Englanti
	  ,[Statistical year] = f.tilastointivuosi
      ,[Language of the institution] = d1.opetuskieli_EN
      ,[Type of institution] = d2.oppilaitostyyppi_EN
      ,[Type of task] = d7.tehtavatyyppi_EN
      ,[Main educational structure] = d8.koulutusaste_EN
      ,[The grade of the teacher''s own class] = d20.luokka_aste_EN
      ,[Number of students in the teacher''s own class] = f.oman_luokan_oppilasmäärä
	  ,[The size of the teacher''s own class] = case 
							when f.oman_luokan_oppilasmäärä >= 30 then ''over 30 pupils''
							when f.oman_luokan_oppilasmäärä >= 25 then ''25-29 pupils''
							when f.oman_luokan_oppilasmäärä >= 20 then ''20-24 pupils''
							when f.oman_luokan_oppilasmäärä >= 15 then ''15-19 pupils''
							when f.oman_luokan_oppilasmäärä >= 10 then ''10-14 pupils''
							when f.oman_luokan_oppilasmäärä >= 1 then ''1-9 pupils''
							else ''no pupils''
						end
      ,[Primary taught subject] = d21.aine_EN
      ,[Gender] = d22.sukupuoli_EN
      ,[Region of the institution] = (select top 1 maakunta_EN from dbo.d_alueluokitus where maakunta_koodi=f.maakunta_oppilaitos)
      ,[Municipality type of the institution] = (select top 1 kuntaryhma_EN from dbo.d_alueluokitus where kuntaryhma_koodi=f.kuntaryhmitys_oppilaitos)
      ,[Age group] = d23.ika5v_EN


	  --koodit
	  ,(select top 1 maakunta_koodi from dbo.d_alueluokitus where maakunta_koodi=f.maakunta_oppilaitos) as "Koodit Oppil. maakunta"

 
	  --järjestyskentät
	  ,[opetuskieli järjestys]= d1.jarjestys
	  ,[Oppilaitostyyppi järjestys] = d2.jarjestys
	  ,[tehtävätyyppi järjestys] = d7.jarjestys
	  ,[koulutusmuoto järjestys]= d8.jarjestys
	  ,[luokka-aste järjestys] = d20.jarjestys
	  ,[aine järjestys] = d21.jarjestys
	  ,[sukupuoli järjestys] = d22.jarjestys
	  ,[Oppilaitoksen maakunta järjestys] = (select top 1 jarjestys_maakunta from dbo.d_alueluokitus where maakunta_koodi=f.maakunta_oppilaitos)
	  ,[Oppilaitoksen kuntaryhmitys järjestys] = (select top 1 jarjestys_kuntaryhma from dbo.d_alueluokitus where kuntaryhma_koodi=f.kuntaryhmitys_oppilaitos)
	  ,[ikä järjestys] = d23.jarjestys_ika5v
	  ,[Oppilasmäärä järjestys] = case f.oman_luokan_oppilasmäärä when 0 then 999 else f.oman_luokan_oppilasmäärä end
	  ,[Oppilasmäärä2 järjestys] = case 
							when f.oman_luokan_oppilasmäärä >= 30 then 7
							when f.oman_luokan_oppilasmäärä >= 25 then 6
							when f.oman_luokan_oppilasmäärä >= 20 then 5
							when f.oman_luokan_oppilasmäärä >= 15 then 4
							when f.oman_luokan_oppilasmäärä >= 10 then 3
							when f.oman_luokan_oppilasmäärä >= 1 then 2
							else 1
						end
	   ,[kelpoisuus järjestys] = d25.jarjestys
	   ,[työsuhteen luonne järjestys] = d26.jarjestys
      
FROM [dbo].[f_Opettajat_perusopetus_kelpoisuus_opetusryhmakoot] f
LEFT JOIN dbo.d_opetuskieli2 d1 on d1.id=f.oppilaitoksen_kieli_id
LEFT JOIN dbo.d_oppilaitostyyppi d2 on d2.id=f.oppilaitostyyppi_id
LEFT JOIN dbo.d_opettajan_tehtavatyyppi_perusopetuksessa d7 on d7.id=f.tehtavatyyppi_perusopetuksessa_id
LEFT JOIN dbo.d_opettajat_koulutusaste d8 on d8.id=f.paaasiallinen_koulutusmuoto_id
LEFT JOIN dbo.d_opettajat_luokka_aste d20 on d20.id=f.oman_luokan_aste_id
LEFT JOIN dbo.d_opettajat_aine d21 on d21.id=f.opettajan_eniten_opettama_aine_id
LEFT JOIN dbo.d_sukupuoli d22 on d22.id=f.sukupuoli_id
LEFT JOIN dbo.d_ika d23 on d23.id=f.ika_id
LEFT JOIN dbo.d_opettajankelpoisuus2 d25 on d25.id=f.kelp_id
LEFT JOIN dbo.d_opettajat_tyosuhteen_luonne d26 on d26.id=f.tyosuhteen_luonne_id
LEFT JOIN dbo.d_opettajat_koko_osa_aikainen d27 on d27.id=f.koko_osa_aikainen_id
LEFT JOIN dbo.d_opettajat_osa_aikaisuuden_syy d28 on d28.id=f.osa_aikaisuuden_syy_id
LEFT JOIN dbo.d_kylla_ei d29 on d29.kylla_ei_koodi=f.kelp_muu



-- väliaikainen ratkaisu
where tilastointivuosi<2016

UNION ALL

Select
      [Tilastovuosi] = f.tilastointivuosi
      ,[Oppilaitoksen opetuskieli] = d1.opetuskieli
      ,[Oppilaitostyyppi] = d2.oppilaitostyyppi
      --,[Vakinainen työsuhde] = case f.tyosuhde_vakinainen when ''1'' then ''Vakinainen työsuhde'' when ''0'' then ''Ei vakinainen työsuhde'' end
      --,[Määräaikainen työsuhde] = case f.tyosuhde_maara_aikainen when ''1'' then ''Määräaikainen työsuhde'' when ''0'' then ''Ei määräaikainen työsuhde'' end
      --,[Viransijainen/toimensijainen] = case f.tyosuhde_viransijainen when ''1'' then ''Viransijainen/toimensijainen työsuhde'' when ''0'' then ''Ei viransijainen/toimensijainen työsuhde'' else ''Tuntematon'' end
      --,[Virkavapaalla] = case f.tyosuhde_virkavapaa when ''1'' then ''Virkavapaalla'' when ''0'' then ''Ei virkavapaalla'' end
      --,[Osa-aikaeläkkeellä] = case f.tyosuhde_oa_elake when ''1'' then ''Osa-aikaeläkkeellä'' when ''0'' then ''Ei osa-aikaeläkkeellä'' end
      ,[Tehtävätyyppi] = d7.tehtavatyyppi
      ,[Pääasiallinen koulutusmuoto] = d8.koulutusaste
	  ,[Työsuhteen luonne] = d26.tyosuhteen_luonne
	  ,[Koko-/osa-aikainen] = d27.koko_osa_aikainen
	  ,[Osa-aikaisuuden syy] = d28.syy
      --,[Kelpoisuus esiopetuksen opettaja] = case f.kelp_esiopetus when ''1'' then ''Kelpoisuus'' when ''0'' then ''Ei kelpoisuutta'' end
      --,[Kelpoisuus luokanopettaja] = case f.kelp_luokanopettaja when ''1'' then ''Kelpoisuus'' when ''0'' then ''Ei kelpoisuutta'' end
      --,[Kelpoisuus aineenopettaja] = case f.kelp_aineenopettaja when ''1'' then ''Kelpoisuus'' when ''0'' then ''Ei kelpoisuutta'' end
      --,[Kelpoisuus aineenopettaja lukio] = case f.kelp_aineenopettaja_lukio when ''1'' then ''Kelpoisuus'' when ''0'' then ''Ei kelpoisuutta'' end
      --,[Kelpoisuus erityisluokan opettaja] = case f.kelp_erityisluokan_opettaja when ''1'' then ''Kelpoisuus'' when ''0'' then ''Ei kelpoisuutta'' end
      --,[Kelpoisuus osa-aikainen erityisopettaja] = case f.kelp_erityisopettaja_osa_aikainen when ''1'' then ''Kelpoisuus'' when ''0'' then ''Ei kelpoisuutta'' end
      --,[Kelpoisuus oppilaanohjaaja] = case f.kelp_oppilaanohjaaja when ''1'' then ''Kelpoisuus'' when ''0'' then ''Ei kelpoisuutta'' end
      --,[Kelpoisuus opinto-ohjaaja] = case f.kelp_opinto_ohjaaja when ''1'' then ''Kelpoisuus'' when ''0'' then ''Ei kelpoisuutta'' end
      --,[Kelpoisuus muu] = case f.kelp_muu when ''1'' then ''Kelpoisuus'' when ''0'' then ''Ei kelpoisuutta'' end
      --,[Muodollinen kelpoisuus hoidettuun tehtävään] = case f.kelp_ei when ''1'' then ''Ei kelpoisuutta'' when ''0'' then ''Kelpoisuus'' end
      --,[Kelpoisuus kehitysvammaisille annettava erityisopetus] = case f.kelp_kehitysvammaiset when ''1'' then ''Kelpoisuus'' when ''0'' then ''Ei kelpoisuutta'' else ''Tuntematon'' end
	  ,[Muu opettajankelpoisuus] = d29.kylla_ei
      ,[Oman luokan aste] = d20.luokka_aste
      ,[Oman luokan oppilasmäärä] = f.oman_luokan_oppilasmäärä
	  ,[Oman luokan koko] = case 
							when f.oman_luokan_oppilasmäärä >= 30 then ''yli 30 oppilasta''
							when f.oman_luokan_oppilasmäärä >= 25 then ''25-29 oppilasta''
							when f.oman_luokan_oppilasmäärä >= 20 then ''20-24 oppilasta''
							when f.oman_luokan_oppilasmäärä >= 15 then ''15-19 oppilasta''
							when f.oman_luokan_oppilasmäärä >= 10 then ''10-14 oppilasta''
							when f.oman_luokan_oppilasmäärä >= 1 then ''1-9 oppilasta''
							else ''Ei oppilaita''
						end
	  ,[Oma luokka] = case f.oman_luokan_oppilasmäärä when 0 then ''Ei'' else ''Kyllä'' end
      ,[Eniten opettama aine] = d21.aine
      ,[Sukupuoli] = d22.sukupuoli
      ,[Oppilaitoksen maakunta] = (select top 1 maakunta from dbo.d_alueluokitus where maakunta_koodi=f.maakunta_oppilaitos)
      ,[Oppilaitoksen sijaintikunnan kuntaryhmitys] = (select top 1 kuntaryhma from dbo.d_alueluokitus where kuntaryhma_koodi=f.kuntaryhmitys_oppilaitos)
      ,[Ikäryhmä] = d23.ika5v
	  ,[Kelpoisuus] = d25.opettajankelpoisuus

	  --Ruotsi
	  ,[Statistikår] = f.tilastointivuosi
      ,[Läroanstaltens undervisningsspråk] = d1.opetuskieli_SV
      ,[Läroanstaltstyp] = d2.oppilaitostyyppi_SV
      ,[Uppgiftstyp] = d7.tehtavatyyppi_SV
      ,[Huvudsaklig utbildningsform] = d8.koulutusaste_SV
      ,[Den egna klassen, stadium] = d20.luokka_aste_SV
      ,[Den egna klassen, elevantal] = f.oman_luokan_oppilasmäärä
	  ,[Den egna klassen, storlek] = 
		case 
			when f.oman_luokan_oppilasmäärä >= 30 then ''över 30 elever''
			when f.oman_luokan_oppilasmäärä >= 25 then ''25-29 elever''
			when f.oman_luokan_oppilasmäärä >= 20 then ''20-24 elever''
			when f.oman_luokan_oppilasmäärä >= 15 then ''15-19 elever''
			when f.oman_luokan_oppilasmäärä >= 10 then ''10-14 elever''
			when f.oman_luokan_oppilasmäärä >= 1 then ''1-9 elever''
			else ''inga elever''
		end
      ,[Lärarens huvudsakliga ämne] = d21.aine_SV
      ,[Kön] = d22.sukupuoli_SV
      ,[Läroanstaltens landskap] = (select top 1 maakunta_SV from dbo.d_alueluokitus where maakunta_koodi=f.maakunta_oppilaitos)
      ,[Läroanstaltens kommungruppering] = (select top 1 kuntaryhma_SV from dbo.d_alueluokitus where kuntaryhma_koodi=f.kuntaryhmitys_oppilaitos)
      ,[Åldersgrupp] = d23.ika5v_SV


	  --Englanti
	  ,[Statistical year] = f.tilastointivuosi
      ,[Language of the institution] = d1.opetuskieli_EN
      ,[Type of institution] = d2.oppilaitostyyppi_EN
      ,[Type of task] = d7.tehtavatyyppi_EN
      ,[Main educational structure] = d8.koulutusaste_EN
      ,[The grade of the teacher''s own class] = d20.luokka_aste_EN
      ,[Number of students in the teacher''s own class] = f.oman_luokan_oppilasmäärä
	  ,[The size of the teacher''s own class] = case 
							when f.oman_luokan_oppilasmäärä >= 30 then ''over 30 pupils''
							when f.oman_luokan_oppilasmäärä >= 25 then ''25-29 pupils''
							when f.oman_luokan_oppilasmäärä >= 20 then ''20-24 pupils''
							when f.oman_luokan_oppilasmäärä >= 15 then ''15-19 pupils''
							when f.oman_luokan_oppilasmäärä >= 10 then ''10-14 pupils''
							when f.oman_luokan_oppilasmäärä >= 1 then ''1-9 pupils''
							else ''no pupils''
						end
      ,[Primary taught subject] = d21.aine_EN
      ,[Gender] = d22.sukupuoli_EN
      ,[Region of the institution] = (select top 1 maakunta_EN from dbo.d_alueluokitus where maakunta_koodi=f.maakunta_oppilaitos)
      ,[Municipality type of the institution] = (select top 1 kuntaryhma_EN from dbo.d_alueluokitus where kuntaryhma_koodi=f.kuntaryhmitys_oppilaitos)
      ,[Age group] = d23.ika5v_EN


	  --koodit
	  ,(select top 1 maakunta_koodi from dbo.d_alueluokitus where maakunta_koodi=f.maakunta_oppilaitos) as "Koodit Oppil. maakunta"

 
	  --järjestyskentät
	  ,[opetuskieli järjestys]= d1.jarjestys
	  ,[Oppilaitostyyppi järjestys] = d2.jarjestys
	  ,[tehtävätyyppi järjestys] = d7.jarjestys
	  ,[koulutusmuoto järjestys]= d8.jarjestys
	  ,[luokka-aste järjestys] = d20.jarjestys
	  ,[aine järjestys] = d21.jarjestys
	  ,[sukupuoli järjestys] = d22.jarjestys
	  ,[Oppilaitoksen maakunta järjestys] = (select top 1 jarjestys_maakunta from dbo.d_alueluokitus where maakunta_koodi=f.maakunta_oppilaitos)
	  ,[Oppilaitoksen kuntaryhmitys järjestys] = (select top 1 jarjestys_kuntaryhma from dbo.d_alueluokitus where kuntaryhma_koodi=f.kuntaryhmitys_oppilaitos)
	  ,[ikä järjestys] = d23.jarjestys_ika5v
	  ,[Oppilasmäärä järjestys] = case f.oman_luokan_oppilasmäärä when 0 then 999 else f.oman_luokan_oppilasmäärä end
	  ,[Oppilasmäärä2 järjestys] = case 
							when f.oman_luokan_oppilasmäärä >= 30 then 7
							when f.oman_luokan_oppilasmäärä >= 25 then 6
							when f.oman_luokan_oppilasmäärä >= 20 then 5
							when f.oman_luokan_oppilasmäärä >= 15 then 4
							when f.oman_luokan_oppilasmäärä >= 10 then 3
							when f.oman_luokan_oppilasmäärä >= 1 then 2
							else 1
						end
	   ,[kelpoisuus järjestys] = d25.jarjestys
	   ,[työsuhteen luonne järjestys] = d26.jarjestys
      
FROM [dbo].[f_Opettajat_perusopetus_kelpoisuus_opetusryhmakoot] f
LEFT JOIN dbo.d_opetuskieli2 d1 on d1.id=f.oppilaitoksen_kieli_id
LEFT JOIN dbo.d_oppilaitostyyppi d2 on d2.id=f.oppilaitostyyppi_id
LEFT JOIN dbo.d_opettajan_tehtavatyyppi_perusopetuksessa d7 on d7.id=f.tehtavatyyppi_perusopetuksessa_id
LEFT JOIN dbo.d_opettajat_koulutusaste d8 on d8.id=f.paaasiallinen_koulutusmuoto_id
LEFT JOIN dbo.d_opettajat_luokka_aste d20 on d20.id=f.oman_luokan_aste_id
LEFT JOIN dbo.d_opettajat_aine_2016 d21 on d21.aine_koodi=f.opettajan_eniten_opettama_aine_koodi
LEFT JOIN dbo.d_sukupuoli d22 on d22.id=f.sukupuoli_id
LEFT JOIN dbo.d_ika d23 on d23.id=f.ika_id
LEFt JOIN dbo.d_opettajankelpoisuus2 d25 on d25.id=f.kelp_id
LEFT JOIN dbo.d_opettajat_tyosuhteen_luonne d26 on d26.id=f.tyosuhteen_luonne_id
LEFT JOIN dbo.d_opettajat_koko_osa_aikainen d27 on d27.id=f.koko_osa_aikainen_id
LEFT JOIN dbo.d_opettajat_osa_aikaisuuden_syy d28 on d28.id=f.osa_aikaisuuden_syy_id
LEFT JOIN dbo.d_kylla_ei d29 on d29.kylla_ei_koodi=f.kelp_muu
where tilastointivuosi=2016


























' 
GO
/****** Object:  View [dbo].[v_f_tab_opettajat_7_10]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_opettajat_7_10]'))
EXEC dbo.sp_executesql @statement = N'








CREATE view [dbo].[v_f_tab_opettajat_7_10] as

Select
      [Tilastovuosi] = f.tilastointivuosi
	  ,[Oppilaitoksen opetuskieli] = d1.opetuskieli
      ,[Opettajan pääasiallinen koulutusaste] = d5.koulutusaste
      ,[Erityisopetus] = d3.kylla_ei
      --,[Opinto_ohjaus] = d6.kylla_ei
      ,[VALMA] = d7.kylla_ei
      ,[TELMA] = d8.kylla_ei 
      --,[Maahanmuuttajien valmistava koulutus] = d9.kylla_ei
      --,[Ammatilliseen peruskoulutukseen valmistava koulutus] = d10.kylla_ei 
      --,[Kotitalousopetus] = d11.kylla_ei
      ,[Ammatillisten opintojen kelpoisuus] = d12.kylla_ei 
      ,[Yhteisten opintojen kelpoisuus] = d13.kylla_ei
      ,[Opinto-ohjaajan kelpoisuus] = d14.kylla_ei 
      ,[Erityisopettajan kelpoisuus] = d15.kylla_ei
      ,[Muu opettajan kelpoisuus] = d16.kylla_ei 
      ,[Ei muodollista opettajan kelpoisuutta] = d17.kylla_ei
      ,[Päätehtävän tutkinto puuttuu] = d18.kylla_ei
      ,[Pedagogiset opinnot puuttuvat] = d19.kylla_ei
      ,[Vaadittava työkokemus puuttuu] = d20.kylla_ei 
      --,[Puuttuvien kelpoisuuksien tieto puuttuu] = d21.kylla_ei
	  ,[Kaikki kelpoisuudet] = d22.kylla_ei
	  ,[Opettajan eniten opettama ala] = case d24.koulutusala2002 when ''Yleissivistävä koulutus'' then ''Ammattitaitoa täydentävät tutkinnon osat (yhteiset opinnot)'' else d24.koulutusala2002 end
      ,[Opettajan eniten opettama aine] = d25.aine
	  ,[Opettajan toiseksi eniten opettama ala] = case d24b.koulutusala2002 when ''Yleissivistävä koulutus'' then ''Ammattitaitoa täydentävät tutkinnon osat (yhteiset opinnot)'' else d24b.koulutusala2002 end
      ,[Opettajan toiseksi eniten opettama aine] = d25b.aine
	  ,[Opettajan kolmanneksi eniten opettama ala] = case d24c.koulutusala2002 when ''Yleissivistävä koulutus'' then ''Ammattitaitoa täydentävät tutkinnon osat (yhteiset opinnot)'' else d24c.koulutusala2002 end
      ,[Opettajan kolmanneksi eniten opettama aine] = d25c.aine
	  ,[Työsuhteen luonne] = d35.tyosuhteen_luonne
	  ,[Koko-/osa-aikainen] = d36.koko_osa_aikainen
	  ,[Osa-aikaisuuden syy] = d37.syy
      --,[Opettajan koulutus] = d26.koulutus
      --,[a_oppil] 
      --,[Koulutuksen järjestäjän koko (ei oppisopimus)] = d27.koko
      --,[Koulutuksen järjestäjän koko (oppisopimus)] = d28.koko
      --,[Koulutuksen järjestäjän kieli] = d29.kieli
      --,[Koulutuksen järjestäjän maakunta] = d30.maakunta
      ,[Oppilaitoksen maakunta] = d31.maakunta
	  ,[Tehtävätyyppi] = d32.tehtavatyyppi
	  ,[Ikäryhmä] = d33.ika5v
	  ,[Sukupuoli] = d34.sukupuoli

	  --Ruotsi
	  ,[Statistikår] = f.tilastointivuosi
	  ,[Läroanstaltens undervisningsspråk] = d1.opetuskieli_SV
      ,[Huvudsaklig utbildningsform] = d5.koulutusaste_SV
	  ,[Lärarens huvudsakliga utb.område] = case d24.koulutusala2002 when ''Yleissivistävä koulutus'' then ''Examensdelar som kompletterar yrkeskompetensen (gemensammma studier)'' else d24.koulutusala2002_SV end
      ,[Lärarens huvudsakliga ämne] = d25.aine_SV
      ,[Läroanstaltens landskap] = d31.maakunta_SV
	  ,[Uppgiftstyp] = d32.tehtavatyyppi_SV
	  ,[Åldersgrupp] = d33.ika5v_SV
	  ,[Kön] = d34.sukupuoli_SV

	  --Englanti
	  ,[Statistical year] = f.tilastointivuosi
	  ,[Language of the institution] = d1.opetuskieli_EN
      ,[Teacher''s primary level] = d5.koulutusaste_EN
	  ,[Teacher''s primary field] = case d24.koulutusala2002 when ''Yleissivistävä koulutus'' then ''Core subjects'' else d24.koulutusala2002_EN end
      ,[Teacher''s primary subject] = d25.aine_EN
      ,[Region of the institution] = d31.maakunta_EN
	  ,[Type of task] = d32.tehtavatyyppi_EN
	  ,[Age group] = d33.ika5v_EN
	  ,[Gender] = d34.sukupuoli_EN

	  --koodit
	  ,[Koodit Oppil. maakunta] = d31.maakunta_koodi
      
 
	  --järjestyskentät
	  ,[Opetuskieli järjestys]= d1.jarjestys
	  ,[Opettajan koulutusaste järjestys] = d5.jarjestys
	  ,[Opettajan ala järjestys] = d24.jarjestys_koulutusala2002
	  ,[Opettajan aine järjestys] = d25.jarjestys
	  ,[Opettajan ala järjestys2] = d24b.jarjestys_koulutusala2002
	  ,[Opettajan aine järjestys2] = d25b.jarjestys
	  ,[Opettajan ala järjestys3] = d24c.jarjestys_koulutusala2002
	  ,[Opettajan aine järjestys3] = d25c.jarjestys
	  --,[Koul järj koko ei oppis järjestys] = d27.jarjestys
	  --,[Koul järj koko oppis järjestys] = d28.jarjestys
	  --,[Koul järj kieli järjestys] = d29.jarjestys
	  --,[Koul järj maakunta järjestys] = d30.jarjestys_maakunta
	  ,[Oppilaitoksen maakunta järjestys] = d31.jarjestys_maakunta
	  ,[Tehtävätyyppi järjestys] = d32.jarjestys
	  ,[Ikä järjestys] = d33.jarjestys_ika5v
	  ,[Sukupuoli järjestys] = d34.jarjestys
	  ,[työsuhteen luonne järjestys] = d35.jarjestys
	  

      
FROM [dbo].[f_Opettajat_ammatillinen_koulutus_kelpoisuus_koulutus] f
LEFT JOIN dbo.d_opetuskieli2 d1 on d1.id=f.oppilaitoksen_kieli_id
LEFT JOIN dbo.d_kylla_ei d3 on d3.id=f.erityisopetus
LEFT JOIN dbo.d_opettajat_koulutusaste_amm d5 on d5.id=pääasiallinen_koulutusaste_id
LEFT JOIN dbo.d_kylla_ei d6 on d6.id=f.opinto_ohjaus
LEFT JOIN dbo.d_kylla_ei d7 on d7.id=f.valma
LEFT JOIN dbo.d_kylla_ei d8 on d8.id=f.telma
LEFT JOIN dbo.d_kylla_ei d9 on d9.id=f.mamu
LEFT JOIN dbo.d_kylla_ei d10 on d10.id=f.ammpk_valmistava
LEFT JOIN dbo.d_kylla_ei d11 on d11.id=f.kotitalousopetus
LEFT JOIN dbo.d_kylla_ei d12 on d12.id=f.kelp_amm
LEFT JOIN dbo.d_kylla_ei d13 on d13.id=f.kelp_yht
LEFT JOIN dbo.d_kylla_ei d14 on d14.id=f.kelp_opo
LEFT JOIN dbo.d_kylla_ei d15 on d15.id=f.kelp_erope
LEFT JOIN dbo.d_kylla_ei d16 on d16.id=f.kelp_muu
LEFT JOIN dbo.d_kylla_ei d17 on d17.id=f.kelp_ei_muod
LEFT JOIN dbo.d_kylla_ei d18 on d18.id=f.eikelp_paa
LEFT JOIN dbo.d_kylla_ei d19 on d19.id=f.eikelp_pedag
LEFT JOIN dbo.d_kylla_ei d20 on d20.id=f.eikelp_tyokok
LEFT JOIN dbo.d_kylla_ei d21 on d21.id=f.eikelp_tieto_puuttuu
LEFT JOIN dbo.d_kylla_ei d22 on d22.id=f.kelp_kaikki
LEFT JOIN dbo.d_koulutusluokitus d24 on d24.id=f.opettajan_eniten_opettama_ala_id
LEFT JOIN dbo.d_koulutusluokitus d24b on d24b.id=f.opettajan_toiseksi_eniten_opettama_ala_id
LEFT JOIN dbo.d_koulutusluokitus d24c on d24c.id=f.opettajan_kolmanneksi_eniten_opettama_ala_id
LEFT JOIN dbo.d_opettajat_aine_amm d25 on d25.id=f.opettajan_eniten_opettama_aine_id
LEFT JOIN dbo.d_opettajat_aine_amm d25b on d25b.id=f.opettajan_toiseksi_eniten_opettama_aine_id
LEFT JOIN dbo.d_opettajat_aine_amm d25c on d25c.id=f.opettajan_kolmanneksi_eniten_opettama_aine_id
--LEFT JOIN dbo.d_koulutusluokitus d26 on d26.id=f.opettajan_koulutus_id
--LEFT JOIN dbo.d_koulutuksen_jarjestajan_koko d27 on d27.id=f.koul_jarj_koko_ei_oppis_id
--LEFT JOIN dbo.d_koulutuksen_jarjestajan_koko d28 on d28.id=f.koul_jarj_koko_oppis_id
--LEFT JOIN dbo.d_kieli2 d29 on d29.id=f.koul_jarj_kieli_id
--LEFT JOIN dbo.d_alueluokitus d30 on d30.id=f.koul_jarj_maakunta_id
LEFT JOIN dbo.d_alueluokitus d31 on d31.id=f.oppilaitoksen_maakunta_id
LEFT JOIN dbo.d_opettajan_tehtavatyyppi_ammatillisessa_koulutuksessa d32 on d32.id=f.tehtavatyyppi_ammatillisessa_id
LEFT JOIN dbo.d_ika d33 on d33.id=f.ika_id
LEFT JOIN dbo.d_sukupuoli d34 on d34.id=f.sukupuoli_id
LEFT JOIN dbo.d_opettajat_tyosuhteen_luonne d35 on d35.id=f.tyosuhteen_luonne_id
LEFT JOIN dbo.d_opettajat_koko_osa_aikainen d36 on d36.id=f.koko_osa_aikainen_id
LEFT JOIN dbo.d_opettajat_osa_aikaisuuden_syy d37 on d37.id=f.osa_aikaisuuden_syy_id

where f.tilastointivuosi >= 2013

















' 
GO
/****** Object:  View [dbo].[v_f_tab_opettajat_7_12]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_opettajat_7_12]'))
EXEC dbo.sp_executesql @statement = N'





















CREATE view [dbo].[v_f_tab_opettajat_7_12] as

Select
      [Tilastovuosi] = f.tilastointivuosi
	  ,[Oppilaitoksen opetuskieli] = d1.opetuskieli 
	  ,[Kelpoisuus kunnossa] = d17.kylla_ei
	  ,[Opettajan eniten opettama ala] = case d24.koulutusala2002 when ''Yleissivistävä koulutus'' then ''Maahanmuuttajien opetus'' else coalesce(d24.koulutusala2002,''Ei opetusta'') end
      ,[Opettajan eniten opettama aine] = d25.aine
	  ,[Työsuhteen luonne] = d26.tyosuhteen_luonne
	  ,[Koko-/osa-aikainen] = d36.koko_osa_aikainen
	  ,[Osa-aikaisuuden syy] = d37.syy
	  ,[Pedagogiset opinnot puuttuvat] = d38.kylla_ei
	  ,[Tutkinto puuttuu] = d39.kylla_ei
      --,[Opettajan koulutus] = d26.koulutus
      --,[a_oppil] 
      --,[Koulutuksen järjestäjän koko (ei oppisopimus)] = d27.koko
      --,[Koulutuksen järjestäjän koko (oppisopimus)] = d28.koko
      --,[Koulutuksen järjestäjän kieli] = d29.kieli
      --,[Koulutuksen järjestäjän maakunta] = d30.maakunta
	  ,[Oppilaitostyyppi] = (select top 1 oppilaitostyyppi from dbo.d_oppilaitoksen_taustatiedot where oppilaitostyyppikoodi=f.oppilaitostyyppi_id)
      ,[Oppilaitoksen maakunta] = d31.maakunta
	  ,[Oppilaitoksen sijaintikunnan kuntaryhmitys] = (select top 1 kuntaryhma from dbo.d_alueluokitus where kuntaryhma_koodi=f.oppilaitoksen_kuntaryhmitys)
	  ,[Tehtävätyyppi] = d32.tehtavatyyppi
	  ,[Ikäryhmä] = d33.ika5v
	  ,[Sukupuoli] = d34.sukupuoli

	  --Ruotsi
	  ,[Statistikår] = f.tilastointivuosi
	  ,[Läroanstaltens undervisningsspråk] = d1.opetuskieli_SV
	  ,[Opettajan eniten opettama alaSV] = case d24.koulutusala2002 when ''Yleissivistävä koulutus'' then ''Utbildning för invandrare'' else d24.koulutusala2002_SV end
      ,[Opettajan eniten opettama aineSV] = d25.aine_SV
	  ,[Läroanstaltstyp] = (select top 1 oppilaitostyyppi_SV from dbo.d_oppilaitoksen_taustatiedot where oppilaitostyyppikoodi=f.oppilaitostyyppi_id)
      ,[Läroanstaltens landskap] = d31.maakunta_SV
	  ,[Läroanstaltens kommungruppering] = (select top 1 kuntaryhma_SV from dbo.d_alueluokitus where kuntaryhma_koodi=f.oppilaitoksen_kuntaryhmitys)
	  ,[Uppgiftstyp] = d32.tehtavatyyppi_SV
	  ,[Åldersgrupp] = d33.ika5v_SV
	  ,[Kön] = d34.sukupuoli_SV

	  --Englanti
      ,[Statistical year] = f.tilastointivuosi
	  ,[Language of the institution] = d1.opetuskieli_EN
	  ,[Teacher''s primary field] = case d24.koulutusala2002 when ''Yleissivistävä koulutus'' then ''Immigrant education'' else d24.koulutusala2002_EN end
      ,[Teacher''s primary subject] = d25.aine_EN
	  ,[Type of institution] = (select top 1 oppilaitostyyppi_EN from dbo.d_oppilaitoksen_taustatiedot where oppilaitostyyppikoodi=f.oppilaitostyyppi_id)
      ,[Region of institution] = d31.maakunta_EN
	  ,[Municipality type of institution] = (select top 1 kuntaryhma_EN from dbo.d_alueluokitus where kuntaryhma_koodi=f.oppilaitoksen_kuntaryhmitys)
	  ,[Type of task] = d32.tehtavatyyppi_EN
	  ,[Age group] = d33.ika5v_EN
	  ,[Gender] = d34.sukupuoli_EN

	  --koodit
	   ,[Koodit Oppil. maakunta] = d31.maakunta_koodi
	   ,[Koodit Koulutusala] = d24.koulutusala2002_koodi
 
	  --järjestyskentät
	  ,[Opetuskieli järjestys]= d1.jarjestys
	  ,[Opettajan ala järjestys] = d24.jarjestys_koulutusala2002
	  ,[Opettajan aine järjestys] = d25.jarjestys
	  --,[Koul järj koko ei oppis järjestys] = d27.jarjestys
	  --,[Koul järj koko oppis järjestys] = d28.jarjestys
	  --,[Koul järj kieli järjestys] = d29.jarjestys
	  --,[Koul järj maakunta järjestys] = d30.jarjestys_maakunta
	  ,[Oppilaitostyyppi järjestys] = (select top 1 jarjestys_oppilaitostyyppi from dbo.d_oppilaitoksen_taustatiedot where oppilaitostyyppikoodi=f.oppilaitostyyppi_id)
	  ,[Oppilaitoksen maakunta järjestys] = d31.jarjestys_maakunta
	  ,[Oppilaitoksen kuntaryhmä järjestys] = (select top 1 jarjestys_kuntaryhma from dbo.d_alueluokitus where kuntaryhma_koodi=f.oppilaitoksen_kuntaryhmitys)
	  ,[Tehtävätyyppi järjestys] = d32.jarjestys
	  ,[Ikä järjestys] = d33.jarjestys_ika5v
	  ,[Sukupuoli järjestys] = d34.jarjestys
	  ,[työsuhteen luonne järjestys] = d26.jarjestys

      
FROM [dbo].[f_Opettajat_vapaa_sivistystyo_kelpoisuus_aine] f
LEFT JOIN dbo.d_opetuskieli2 d1 on d1.id=f.oppilaitoksen_kieli_id
LEFT JOIN dbo.d_kylla_ei d17 on d17.id=f.kelpoisuus_kunnossa_id
LEFT JOIN dbo.d_koulutusluokitus d24 on d24.id=f.opettajan_eniten_opettama_ala_id
LEFT JOIN dbo.d_opettajat_aine_vst d25 on d25.id=f.opettajan_eniten_opettama_aine_id
LEFT JOIN dbo.d_alueluokitus d31 on d31.id=f.oppilaitoksen_maakunta_id
LEFT JOIN dbo.d_opettajan_tehtavatyyppi_vapaassa_sivistystyossa d32 on d32.id=f.tehtavatyyppi_id
LEFT JOIN dbo.d_ika d33 on d33.id=f.ika_id
LEFT JOIN dbo.d_sukupuoli d34 on d34.id=f.sukupuoli_id
LEFT JOIN dbo.d_opettajat_tyosuhteen_luonne d26 on d26.id=f.tyosuhteen_luonne_id
LEFT JOIN dbo.d_opettajat_koko_osa_aikainen d36 on d36.id=f.koko_osa_aikainen_id
LEFT JOIN dbo.d_opettajat_osa_aikaisuuden_syy d37 on d37.id=f.osa_aikaisuuden_syy_id
LEFT JOIN dbo.d_kylla_ei d38 on d38.id=f.pedagogiset_opinnot_puuttuu_id
LEFT JOIN dbo.d_kylla_ei d39 on d39.id=f.tutkinto_puuttuu_id



















' 
GO
/****** Object:  View [dbo].[v_f_tab_opettajat_7_2]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_opettajat_7_2]'))
EXEC dbo.sp_executesql @statement = N'




CREATE view [dbo].[v_f_tab_opettajat_7_2] as

Select
      [Tilastovuosi] = f.tilastointivuosi
      ,[Oppilaitoksen opetuskieli] = d1.opetuskieli
      ,[Oman luokan aste] = d3.luokka_aste
      ,[Oman luokan oppilasmäärä] = f.oman_luokan_oppilasmäärä
      ,[Opetuksen järjestäjän koko] = d4.koko
      ,[Opetuksen järjestäjän kieli] = d5.kieli
	  ,[Opetuksen järjestäjän omistajatyyppi] = (select top 1 oppilaitoksen_omistajatyyppi from dbo.d_oppilaitoksen_taustatiedot where oppilaitoksen_omistajatyyppikoodi=f.koulutuksen_jarjestajan_omistajatyyppi)
      ,[Opetuksen järjestäjän maakunta] = (select top 1 maakunta from dbo.d_alueluokitus where maakunta_koodi=f.koulutuksen_jarjestajan_maakunta)
      ,[Opetuksen järjestäjän kuntaryhmitys] = (select top 1 kuntaryhma from dbo.d_alueluokitus where kuntaryhma_koodi=f.koulutuksen_jarjestajan_kuntaryhmitys)

	  --Ruotsi
	  ,[Statistikår] = f.tilastointivuosi
      ,[Läroanstaltens undervisningsspråk] = d1.opetuskieli_SV
      ,[Den egna klassen, stadium] = d3.luokka_aste_SV
      ,[Den egna klassen, elevental] = f.oman_luokan_oppilasmäärä
      ,[Utbildningsanordnarens storlek] = d4.koko_SV
      ,[Utbildningsanordnarens språk] = d5.kieli_SV
	  ,[Utbildningsanordnarens ägartyp] = (select top 1 oppilaitoksen_omistajatyyppi_SV from dbo.d_oppilaitoksen_taustatiedot where oppilaitoksen_omistajatyyppikoodi=f.koulutuksen_jarjestajan_omistajatyyppi)
      ,[Utbildningsanordnarens landskap] = (select top 1 maakunta_SV from dbo.d_alueluokitus where maakunta_koodi=f.koulutuksen_jarjestajan_maakunta)
      ,[Utbildningsanordnarens kommungruppering] = (select top 1 kuntaryhma_SV from dbo.d_alueluokitus where kuntaryhma_koodi=f.koulutuksen_jarjestajan_kuntaryhmitys)
	  
	  --Englanti
	  ,[Statistical year] = f.tilastointivuosi
      ,[Language of the institution] = d1.opetuskieli_EN
      ,[The grade of the teacher''s own class] = d3.luokka_aste_EN
      ,[The size of the teacher''s own class] = f.oman_luokan_oppilasmäärä
      ,[Size of the education provider] = d4.koko_EN
      ,[Language of the education provider] = d5.kieli_EN
	  ,[Type of education provider owner] = (select top 1 oppilaitoksen_omistajatyyppi_EN from dbo.d_oppilaitoksen_taustatiedot where oppilaitoksen_omistajatyyppikoodi=f.koulutuksen_jarjestajan_omistajatyyppi)
      ,[Region of the education provider] = (select top 1 maakunta_EN from dbo.d_alueluokitus where maakunta_koodi=f.koulutuksen_jarjestajan_maakunta)
      ,[Municipality type of the education provider] = (select top 1 kuntaryhma_EN from dbo.d_alueluokitus where kuntaryhma_koodi=f.koulutuksen_jarjestajan_kuntaryhmitys)

	  --koodit
	  ,(select top 1 maakunta_koodi from dbo.d_alueluokitus where maakunta_koodi=f.koulutuksen_jarjestajan_maakunta) as "Koodit Koul. järj. maakunta"
 
	  --järjestyskentät
	  ,[opetuskieli järjestys]= d1.jarjestys
	  ,[luokka-aste järjestys] = d3.jarjestys
	  ,[Opetuksen järjestäjän koko järjestys] = d4.jarjestys
      ,[Opetuksen järjestäjän kieli järjestys] = d5.jarjestys
	  ,[Opetuksen järjestäjän omistajatyyppi järjestys] = (select top 1 jarjestys_omistajatyyppi from dbo.d_oppilaitoksen_taustatiedot where oppilaitoksen_omistajatyyppikoodi=f.koulutuksen_jarjestajan_omistajatyyppi)
	  ,[Opetuksen järjestäjän maakunta järjestys] = (select top 1 jarjestys_maakunta from dbo.d_alueluokitus where maakunta_koodi=f.koulutuksen_jarjestajan_maakunta)
	  ,[Opetuksen järjestäjän kuntaryhmitys järjestys] = (select top 1 jarjestys_kuntaryhma from dbo.d_alueluokitus where kuntaryhma_koodi=f.koulutuksen_jarjestajan_kuntaryhmitys)

      
FROM [dbo].[f_Opettajat_perusopetus_koulutuksen_jarjestaja_opetusryhmakoot] f
LEFT JOIN dbo.d_opetuskieli2 d1 on d1.id=f.oppilaitoksen_kieli_id
LEFT JOIN dbo.d_opettajat_luokka_aste d3 on d3.id=f.oman_luokan_aste_id
LEFT JOIN dbo.d_koulutuksen_jarjestajan_koko d4 on d4.id=f.koulutuksen_jarjestajan_koko_id
LEFT JOIN dbo.d_kieli2 d5 on d5.id=f.koulutuksen_jarjestajan_kieli_id













' 
GO
/****** Object:  View [dbo].[v_f_tab_opettajat_7_3]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_opettajat_7_3]'))
EXEC dbo.sp_executesql @statement = N'
















CREATE view [dbo].[v_f_tab_opettajat_7_3] as

Select
      [Tilastovuosi] = f.tilastointivuosi
      ,[Oppilaitoksen opetuskieli] = d1.opetuskieli
      ,[Tehtavätyyppi perusopetuksessa] = d2.tehtavatyyppi
      --,[Täydennyskoulutustiedot] = case f.taydennyskoulutus_osallistuminen when ''1'' then ''Toisen oppilaitoksen yhteydessä'' when ''0'' then ''Ei toisen oppilaitoksen yhteydessä'' else '''' end
      --,[Täydennyskoulutukseen osallistuminen] = case f.taydennyskoulutus_ei_tietoa when ''1'' then ''Ei tietoa'' when ''0'' then ''Tieto saatu'' else '''' end
      --,[Täydennyskoulutus tilastovuonna] = case f.taydennyskoulutus_ei when ''1'' then ''Ei osallistunut'' when ''0'' then ''Osallistui'' else '''' end
      ,[Osallistuminen tutkintotavoitteeseen koulutukseen työajalla] = f.taydennyskoulutus_tyoaika
      ,[Osallistuminen tutkintotavoitteeseen omalla ajalla] = f.taydennyskoulutus_oma_aika 
      ,[Osallistuminen kelpoisuuden tai pätevyyden tuottavaan koulutukseen työajalla] = f.taydennyskoulutus_kelp_tyoaika 
      ,[Osallistuminen kelpoisuuden tai pätevyyden tuottavaan koulutukseen omalla ajalla] = f.taydennyskoulutus_kelp_oma_aika 
      ,[Osallistuminen työantajan järjestämään henkilöstökoulutukseen työajalla] = f.taydennyskoulutus_tantaja_tyoaika 
      ,[Osallistuminen työantajan järjestämään henkilöstökoulutukseen omalla ajalla] = f.taydennyskoulutus_tantaja_oma_aika
      ,[Osallistuminen muuhun toimintaan työajalla] = f.taydennyskoulutus_muu_tyoaika 
      ,[Osallistuminen muuhun toimintaan omalla ajalla] = f.taydennyskoulutus_muu_oma_aika 
      ,[Osallistuminen kotimaiseen tai kansainväliseen asiantuntijavaihtoon työajalla] = f.asiantuntijavaihto_tyoaika 
      ,[Osallistuminen kotimaiseen tai kansainväliseen asiantuntijavaihtoon omalla ajalla] = f.asiantuntijavaihto_oma_aika 
      ,[Koulutus- ja kehittämissuunnitelma] = d27.kylla_ei--case f.koulutussuunnitelma when ''1'' then ''On sovittu'' when ''0'' then ''Ei ole sovittu'' else '''' end
	  ,[Kouluttautunut mentoriksi] = d21.kylla_ei
	  ,[Toiminut mentorina] = d22.kylla_ei
	  ,[Ollut mentoroitavana] = d23.kylla_ei
	  ,[Kouluttautunut työnohjaajaksi] = d24.kylla_ei
	  ,[Toiminut työnohjaajana] = d25.kylla_ei
	  ,[Ollut työnohjauksessa] = d26.kylla_ei
      ,[Sukupuoli] = d3.sukupuoli
      ,[Oppilaitoksen maakunta] = (select top 1 maakunta from dbo.d_alueluokitus where maakunta_koodi=f.maakunta_oppilaitos)
	  ,[Ikäryhmä] = d4.ika5v
	  ,[Täydennyskoulutus tai asiantuntijavaihto] = case when f.taydennyskoulutus_ei=0 or f.asiantuntijavaihto_oma_aika>0 or f.asiantuntijavaihto_tyoaika>0 then 1 else 0 end

	  --Ruotsi
	  ,[Statistikår] = f.tilastointivuosi
      ,[Läroanstaltens undervisningsspråk] = d1.opetuskieli_SV
      ,[Uppgiftstyp] = d2.tehtavatyyppi_SV
      ,[Kön] = d3.sukupuoli_SV
      ,[Läroanstaltens landskap] = (select top 1 maakunta_SV from dbo.d_alueluokitus where maakunta_koodi=f.maakunta_oppilaitos)
	  ,[Åldersgrupp] = d4.ika5v_SV

	  --Englanti
	  ,[Statistical year] = f.tilastointivuosi
      ,[Language of the institution] = d1.opetuskieli_EN
      ,[Type of task] = d2.tehtavatyyppi_EN
      ,[Gender] = d3.sukupuoli_EN
      ,[Region of the institution] = (select top 1 maakunta_EN from dbo.d_alueluokitus where maakunta_koodi=f.maakunta_oppilaitos)
	  ,[Age group] = d4.ika5v_EN
      
	  --koodit
	  ,[Koodit Oppil. maakunta] = (select top 1 maakunta_koodi from dbo.d_alueluokitus where maakunta_koodi=f.maakunta_oppilaitos)
 
	  --järjestyskentät
	  ,[opetuskieli järjestys]= d1.jarjestys
	  ,[Tehtavätyyppi perusopetuksessa järjestys] = d2.jarjestys
	  ,[Sukupuoli järjestys] = d3.jarjestys
	  ,[Oppilaitoksen maakunta järjestys] = (select top 1 jarjestys_maakunta from dbo.d_alueluokitus where maakunta_koodi=f.maakunta_oppilaitos)
	  ,[Ikä järjestys] = d4.jarjestys_ika5v
	  

      
FROM [dbo].[f_Opettajat_perusopetus_osallistuminen_taydennyskoulutukseen] f
LEFT JOIN dbo.d_opetuskieli2 d1 on d1.id=f.oppilaitoksen_kieli_id
LEFT JOIN dbo.d_opettajan_tehtavatyyppi_perusopetuksessa d2 on d2.id=f.tehtavatyyppi_perusopetuksessa_id
LEFT JOIN dbo.d_sukupuoli d3 on d3.id=f.sukupuoli_id
LEFT JOIN dbo.d_ika d4 on d4.id=f.ika_id
LEFT JOIN dbo.d_kylla_ei d21 on d21.kylla_ei_koodi=f.kouluttautunut_mentoriksi
LEFT JOIN dbo.d_kylla_ei d22 on d22.kylla_ei_koodi=f.toiminut_mentorina
LEFT JOIN dbo.d_kylla_ei d23 on d23.kylla_ei_koodi=f.ollut_mentoroitavana
LEFT JOIN dbo.d_kylla_ei d24 on d24.kylla_ei_koodi=f.kouluttautunut_tyonohjaajaksi
LEFT JOIN dbo.d_kylla_ei d25 on d25.kylla_ei_koodi=f.toiminut_tyonohjaajana
LEFT JOIN dbo.d_kylla_ei d26 on d26.kylla_ei_koodi=f.ollut_tyonohjauksessa
LEFT JOIN dbo.d_kylla_ei d27 on d27.kylla_ei_koodi=f.koulutussuunnitelma





















' 
GO
/****** Object:  View [dbo].[v_f_tab_opettajat_7_4]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_opettajat_7_4]'))
EXEC dbo.sp_executesql @statement = N'

















CREATE view [dbo].[v_f_tab_opettajat_7_4] as

Select
      [Tilastovuosi] = f.tilastointivuosi
      ,[Oppilaitoksen opetuskieli] = d1.opetuskieli
      --,[Vakinainen työsuhde] = case f.tyosuhde_vakinainen when ''1'' then ''Vakinainen työsuhde'' when ''0'' then ''Ei vakinainen työsuhde'' end
      --,[Määräaikainen työsuhde] = case f.tyosuhde_maara_aikainen when ''1'' then ''Määräaikainen työsuhde'' when ''0'' then ''Ei määräaikainen työsuhde'' end
      --,[Viransijainen/toimensijainen] = case f.tyosuhde_viransijainen when ''1'' then ''Viransijainen/toimensijainen työsuhde'' when ''0'' then ''Ei viransijainen/toimensijainen työsuhde'' else ''Tuntematon'' end
      --,[Virkavapaalla] = case f.tyosuhde_virkavapaa when ''1'' then ''Virkavapaalla'' when ''0'' then ''Ei virkavapaalla'' end
      --,[Osa-aikaeläkkeellä] = case f.tyosuhde_oa_elake when ''1'' then ''Osa-aikaeläkkeellä'' when ''0'' then ''Ei osa-aikaeläkkeellä'' end
      ,[Tehtävätyyppi] = d7.tehtavatyyppi
      ,[Pääasiallinen koulutusmuoto] = d8.koulutusaste
	  ,[Työsuhteen luonne] = d26.tyosuhteen_luonne
	  ,[Koko-/osa-aikainen] = d27.koko_osa_aikainen
	  ,[Osa-aikaisuuden syy] = d28.syy
      --,[Kelpoisuus esiopetuksen opettaja] = case f.kelp_esiopetus when ''1'' then ''Kelpoisuus'' when ''0'' then ''Ei kelpoisuutta'' end
      --,[Kelpoisuus luokanopettaja] = case f.kelp_luokanopettaja when ''1'' then ''Kelpoisuus'' when ''0'' then ''Ei kelpoisuutta'' end
      --,[Kelpoisuus aineenopettaja] = case f.kelp_aineenopettaja when ''1'' then ''Kelpoisuus'' when ''0'' then ''Ei kelpoisuutta'' end
      --,[Kelpoisuus aineenopettaja lukio] = case f.kelp_aineenopettaja_lukio when ''1'' then ''Kelpoisuus'' when ''0'' then ''Ei kelpoisuutta'' end
      --,[Kelpoisuus erityisluokan opettaja] = case f.kelp_erityisluokan_opettaja when ''1'' then ''Kelpoisuus'' when ''0'' then ''Ei kelpoisuutta'' end
      --,[Kelpoisuus osa-aikainen erityisopettaja] = case f.kelp_erityisopettaja_osa_aikainen when ''1'' then ''Kelpoisuus'' when ''0'' then ''Ei kelpoisuutta'' end
      --,[Kelpoisuus oppilaanohjaaja] = case f.kelp_oppilaanohjaaja when ''1'' then ''Kelpoisuus'' when ''0'' then ''Ei kelpoisuutta'' end
      --,[Kelpoisuus opinto-ohjaaja] = case f.kelp_opinto_ohjaaja when ''1'' then ''Kelpoisuus'' when ''0'' then ''Ei kelpoisuutta'' end
      ,[Muu opettajankelpoisuus] = coalesce(d29.kylla_ei,''Tieto puuttuu'')
      --,[Muodollinen kelpoisuus hoidettuun tehtävään] = case f.kelp_ei when ''1'' then ''Ei kelpoisuutta'' when ''0'' then ''Kelpoisuus'' end
      --,[Kelpoisuus kehitysvammaisille annettava erityisopetus] = case f.kelp_kehitysvammaiset when ''1'' then ''Kelpoisuus'' when ''0'' then ''Ei kelpoisuutta'' else ''Tuntematon'' end
      ,[Eniten opettama aine] = d21.aine
      ,[Sukupuoli] = d22.sukupuoli
      ,[Oppilaitoksen maakunta] = (select top 1 maakunta from dbo.d_alueluokitus where maakunta_koodi=f.maakunta_oppilaitos)
      ,[Oppilaitoksen kuntaryhmitys] = (select top 1 kuntaryhma from dbo.d_alueluokitus where kuntaryhma_koodi=f.kuntaryhmitys_oppilaitos)
      ,[Ikäryhmä] = d23.ika5v
	  ,[Kelpoisuus] = d25.opettajankelpoisuus

	  --Ruotsi
	  ,[Statistikår] = f.tilastointivuosi
      ,[Läroanstaltens undervisningsspråk] = d1.opetuskieli_SV
      ,[Uppgiftstyp] = d7.tehtavatyyppi_SV
      ,[Huvudsaklig utbildningsform] = d8.koulutusaste_SV
      ,[Lärarens huvudsakliga ämne] = d21.aine_SV
      ,[Kön] = d22.sukupuoli_SV
      ,[Läroanstaltens landskap] = (select top 1 maakunta_SV from dbo.d_alueluokitus where maakunta_koodi=f.maakunta_oppilaitos)
      ,[Läroanstaltens kommungruppering] = (select top 1 kuntaryhma_SV from dbo.d_alueluokitus where kuntaryhma_koodi=f.kuntaryhmitys_oppilaitos)
      ,[Åldersgrupp] = d23.ika5v_SV

	  --Englanti
	  ,[Statistical year] = f.tilastointivuosi
      ,[Language of the institution] = d1.opetuskieli_EN
      ,[Type of task] = d7.tehtavatyyppi_EN
      ,[Main educational structure] = d8.koulutusaste_EN
      ,[Primary taught subject] = d21.aine_EN
      ,[Gender] = d22.sukupuoli_EN
      ,[Region of the institution] = (select top 1 maakunta_EN from dbo.d_alueluokitus where maakunta_koodi=f.maakunta_oppilaitos)
      ,[Municipality type of the institution] = (select top 1 kuntaryhma_EN from dbo.d_alueluokitus where kuntaryhma_koodi=f.kuntaryhmitys_oppilaitos)
      ,[Age group] = d23.ika5v_EN

	  --koodit
	  ,[Koodit Oppil. maakunta] = (select top 1 maakunta_koodi from dbo.d_alueluokitus where maakunta_koodi=f.maakunta_oppilaitos)
 
	  --järjestyskentät
	  ,[opetuskieli järjestys]= d1.jarjestys
	  ,[tehtävätyyppi järjestys] = d7.jarjestys
	  ,[koulutusmuoto järjestys]= d8.jarjestys
	  ,[aine järjestys] = d21.jarjestys
	  ,[sukupuoli järjestys] = d22.jarjestys
	  ,[Oppilaitoksen maakunta järjestys] = (select top 1 jarjestys_maakunta from dbo.d_alueluokitus where maakunta_koodi=f.maakunta_oppilaitos)
	  ,[Oppilaitoksen kuntaryhmitys järjestys] = (select top 1 jarjestys_kuntaryhma from dbo.d_alueluokitus where kuntaryhma_koodi=f.kuntaryhmitys_oppilaitos)
	  ,[ikä järjestys] = d23.jarjestys_ika5v
	  ,[kelpoisuus järjestys] = d25.jarjestys
	  ,[työsuhteen luonne järjestys] = d26.jarjestys

      
FROM [dbo].[f_Opettajat_lukiokoulutus_kelpoisuus_aine] f
LEFT JOIN dbo.d_opetuskieli2 d1 on d1.id=f.oppilaitoksen_kieli_id
LEFT JOIN dbo.d_opettajan_tehtavatyyppi_lukiokoulutuksessa d7 on d7.id=f.tehtavatyyppi_lukiokoulutuksessa_id
LEFT JOIN dbo.d_opettajat_koulutusaste d8 on d8.id=f.paaasiallinen_koulutusmuoto_id
LEFT JOIN dbo.d_opettajat_aine d21 on d21.id=f.opettajan_eniten_opettama_aine_id
LEFT JOIN dbo.d_sukupuoli d22 on d22.id=f.sukupuoli_id
LEFT JOIN dbo.d_ika d23 on d23.id=f.ika_id
LEFT JOIN dbo.d_opettajankelpoisuus2 d25 on d25.id=f.kelp_id
LEFT JOIN dbo.d_opettajat_tyosuhteen_luonne d26 on d26.id=f.tyosuhteen_luonne_id
LEFT JOIN dbo.d_opettajat_koko_osa_aikainen d27 on d27.id=f.koko_osa_aikainen_id
LEFT JOIN dbo.d_opettajat_osa_aikaisuuden_syy d28 on d28.id=f.osa_aikaisuuden_syy_id
LEFT JOIN dbo.d_kylla_ei d29 on d29.kylla_ei_koodi=f.kelp_muu


--väliaikainen ratkaisu
where tilastointivuosi<2016

UNION ALL


Select
      [Tilastovuosi] = f.tilastointivuosi
      ,[Oppilaitoksen opetuskieli] = d1.opetuskieli
      --,[Vakinainen työsuhde] = case f.tyosuhde_vakinainen when ''1'' then ''Vakinainen työsuhde'' when ''0'' then ''Ei vakinainen työsuhde'' end
      --,[Määräaikainen työsuhde] = case f.tyosuhde_maara_aikainen when ''1'' then ''Määräaikainen työsuhde'' when ''0'' then ''Ei määräaikainen työsuhde'' end
      --,[Viransijainen/toimensijainen] = case f.tyosuhde_viransijainen when ''1'' then ''Viransijainen/toimensijainen työsuhde'' when ''0'' then ''Ei viransijainen/toimensijainen työsuhde'' else ''Tuntematon'' end
      --,[Virkavapaalla] = case f.tyosuhde_virkavapaa when ''1'' then ''Virkavapaalla'' when ''0'' then ''Ei virkavapaalla'' end
      --,[Osa-aikaeläkkeellä] = case f.tyosuhde_oa_elake when ''1'' then ''Osa-aikaeläkkeellä'' when ''0'' then ''Ei osa-aikaeläkkeellä'' end
      ,[Tehtävätyyppi] = d7.tehtavatyyppi
      ,[Pääasiallinen koulutusmuoto] = d8.koulutusaste
	  ,[Työsuhteen luonne] = d26.tyosuhteen_luonne
	  ,[Koko-/osa-aikainen] = d27.koko_osa_aikainen
	  ,[Osa-aikaisuuden syy] = d28.syy
      --,[Kelpoisuus esiopetuksen opettaja] = case f.kelp_esiopetus when ''1'' then ''Kelpoisuus'' when ''0'' then ''Ei kelpoisuutta'' end
      --,[Kelpoisuus luokanopettaja] = case f.kelp_luokanopettaja when ''1'' then ''Kelpoisuus'' when ''0'' then ''Ei kelpoisuutta'' end
      --,[Kelpoisuus aineenopettaja] = case f.kelp_aineenopettaja when ''1'' then ''Kelpoisuus'' when ''0'' then ''Ei kelpoisuutta'' end
      --,[Kelpoisuus aineenopettaja lukio] = case f.kelp_aineenopettaja_lukio when ''1'' then ''Kelpoisuus'' when ''0'' then ''Ei kelpoisuutta'' end
      --,[Kelpoisuus erityisluokan opettaja] = case f.kelp_erityisluokan_opettaja when ''1'' then ''Kelpoisuus'' when ''0'' then ''Ei kelpoisuutta'' end
      --,[Kelpoisuus osa-aikainen erityisopettaja] = case f.kelp_erityisopettaja_osa_aikainen when ''1'' then ''Kelpoisuus'' when ''0'' then ''Ei kelpoisuutta'' end
      --,[Kelpoisuus oppilaanohjaaja] = case f.kelp_oppilaanohjaaja when ''1'' then ''Kelpoisuus'' when ''0'' then ''Ei kelpoisuutta'' end
      --,[Kelpoisuus opinto-ohjaaja] = case f.kelp_opinto_ohjaaja when ''1'' then ''Kelpoisuus'' when ''0'' then ''Ei kelpoisuutta'' end
      --,[Kelpoisuus muu] = case f.kelp_muu when ''1'' then ''Kelpoisuus'' when ''0'' then ''Ei kelpoisuutta'' end
      --,[Muodollinen kelpoisuus hoidettuun tehtävään] = case f.kelp_ei when ''1'' then ''Ei kelpoisuutta'' when ''0'' then ''Kelpoisuus'' end
      --,[Kelpoisuus kehitysvammaisille annettava erityisopetus] = case f.kelp_kehitysvammaiset when ''1'' then ''Kelpoisuus'' when ''0'' then ''Ei kelpoisuutta'' else ''Tuntematon'' end
	  ,[Muu opettajankelpoisuus] = d29.kylla_ei
      ,[Eniten opettama aine] = d21.aine
      ,[Sukupuoli] = d22.sukupuoli
      ,[Oppilaitoksen maakunta] = (select top 1 maakunta from dbo.d_alueluokitus where maakunta_koodi=f.maakunta_oppilaitos)
      ,[Oppilaitoksen kuntaryhmitys] = (select top 1 kuntaryhma from dbo.d_alueluokitus where kuntaryhma_koodi=f.kuntaryhmitys_oppilaitos)
      ,[Ikäryhmä] = d23.ika5v
	  ,[Kelpoisuus] = d25.opettajankelpoisuus

	  --Ruotsi
	  ,[Statistikår] = f.tilastointivuosi
      ,[Läroanstaltens undervisningsspråk] = d1.opetuskieli_SV
      ,[Uppgiftstyp] = d7.tehtavatyyppi_SV
      ,[Huvudsaklig utbildningsform] = d8.koulutusaste_SV
      ,[Lärarens huvudsakliga ämne] = d21.aine_SV
      ,[Kön] = d22.sukupuoli_SV
      ,[Läroanstaltens landskap] = (select top 1 maakunta_SV from dbo.d_alueluokitus where maakunta_koodi=f.maakunta_oppilaitos)
      ,[Läroanstaltens kommungruppering] = (select top 1 kuntaryhma_SV from dbo.d_alueluokitus where kuntaryhma_koodi=f.kuntaryhmitys_oppilaitos)
      ,[Åldersgrupp] = d23.ika5v_SV

	  --Englanti
	  ,[Statistical year] = f.tilastointivuosi
      ,[Language of the institution] = d1.opetuskieli_EN
      ,[Type of task] = d7.tehtavatyyppi_EN
      ,[Main educational structure] = d8.koulutusaste_EN
      ,[Primary taught subject] = d21.aine_EN
      ,[Gender] = d22.sukupuoli_EN
      ,[Region of the institution] = (select top 1 maakunta_EN from dbo.d_alueluokitus where maakunta_koodi=f.maakunta_oppilaitos)
      ,[Municipality type of the institution] = (select top 1 kuntaryhma_EN from dbo.d_alueluokitus where kuntaryhma_koodi=f.kuntaryhmitys_oppilaitos)
      ,[Age group] = d23.ika5v_EN

	  --koodit
	  ,[Koodit Oppil. maakunta] = (select top 1 maakunta_koodi from dbo.d_alueluokitus where maakunta_koodi=f.maakunta_oppilaitos)
 
	  --järjestyskentät
	  ,[opetuskieli järjestys]= d1.jarjestys
	  ,[tehtävätyyppi järjestys] = d7.jarjestys
	  ,[koulutusmuoto järjestys]= d8.jarjestys
	  ,[aine järjestys] = d21.jarjestys
	  ,[sukupuoli järjestys] = d22.jarjestys
	  ,[Oppilaitoksen maakunta järjestys] = (select top 1 jarjestys_maakunta from dbo.d_alueluokitus where maakunta_koodi=f.maakunta_oppilaitos)
	  ,[Oppilaitoksen kuntaryhmitys järjestys] = (select top 1 jarjestys_kuntaryhma from dbo.d_alueluokitus where kuntaryhma_koodi=f.kuntaryhmitys_oppilaitos)
	  ,[ikä järjestys] = d23.jarjestys_ika5v
	  ,[kelpoisuus järjestys] = d25.jarjestys
	  ,[työsuhteen luonne järjestys] = d26.jarjestys

      
FROM [dbo].[f_Opettajat_lukiokoulutus_kelpoisuus_aine] f
LEFT JOIN dbo.d_opetuskieli2 d1 on d1.id=f.oppilaitoksen_kieli_id
LEFT JOIN dbo.d_opettajan_tehtavatyyppi_lukiokoulutuksessa d7 on d7.id=f.tehtavatyyppi_lukiokoulutuksessa_id
LEFT JOIN dbo.d_opettajat_koulutusaste d8 on d8.id=f.paaasiallinen_koulutusmuoto_id
LEFT JOIN dbo.d_opettajat_aine_2016_lukio d21 on d21.aine_koodi=f.opettajan_eniten_opettama_aine_koodi
LEFT JOIN dbo.d_sukupuoli d22 on d22.id=f.sukupuoli_id
LEFT JOIN dbo.d_ika d23 on d23.id=f.ika_id
LEFT JOIN dbo.d_opettajankelpoisuus2 d25 on d25.id=f.kelp_id
LEFT JOIN dbo.d_opettajat_tyosuhteen_luonne d26 on d26.id=f.tyosuhteen_luonne_id
LEFT JOIN dbo.d_opettajat_koko_osa_aikainen d27 on d27.id=f.koko_osa_aikainen_id
LEFT JOIN dbo.d_opettajat_osa_aikaisuuden_syy d28 on d28.id=f.osa_aikaisuuden_syy_id
LEFT JOIN dbo.d_kylla_ei d29 on d29.kylla_ei_koodi=f.kelp_muu
where tilastointivuosi=2016














' 
GO
/****** Object:  View [dbo].[v_f_tab_opettajat_7_5]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_opettajat_7_5]'))
EXEC dbo.sp_executesql @statement = N'








CREATE view [dbo].[v_f_tab_opettajat_7_5] as

Select
      [Tilastovuosi] = f.tilastointivuosi
      ,[Oppilaitoksen opetuskieli] = d1.opetuskieli
      ,[Koulutuksen järjestäjän koko] = d4.koko
      ,[Koulutuksen järjestäjän kieli] = d5.kieli
	  ,[Koulutuksen järjestäjän omistajatyyppi] = (select top 1 oppilaitoksen_omistajatyyppi from dbo.d_oppilaitoksen_taustatiedot where oppilaitoksen_omistajatyyppikoodi=f.koulutuksen_jarjestajan_omistajatyyppi)
      ,[Koulutuksen järjestäjän maakunta] = (select top 1 maakunta from dbo.d_alueluokitus where maakunta_koodi=f.koulutuksen_jarjestajan_maakunta)
      ,[Koulutuksen järjestäjän kuntaryhmitys] = (select top 1 kuntaryhma from dbo.d_alueluokitus where kuntaryhma_koodi=f.koulutuksen_jarjestajan_kuntaryhmitys)

	  --Ruotsi
	  ,[Statistikår] = f.tilastointivuosi
      ,[Läroanstaltens undervisningsspråk] = d1.opetuskieli_SV
      ,[Koulutuksen järjestäjän kokoSV] = d4.koko_SV
      ,[Utbildningsanordnarens språk] = d5.kieli_SV
	  ,[Utbildningsanordnarens ägartyp] = (select top 1 oppilaitoksen_omistajatyyppi_SV from dbo.d_oppilaitoksen_taustatiedot where oppilaitoksen_omistajatyyppikoodi=f.koulutuksen_jarjestajan_omistajatyyppi)
      ,[Utbildningsanordnarens landskap] = (select top 1 maakunta_SV from dbo.d_alueluokitus where maakunta_koodi=f.koulutuksen_jarjestajan_maakunta)
      ,[Utbildningsanordnarens kommungruppering] = (select top 1 kuntaryhma_SV from dbo.d_alueluokitus where kuntaryhma_koodi=f.koulutuksen_jarjestajan_kuntaryhmitys)

	  --Englanti
	  ,[Statistical year] = f.tilastointivuosi
      ,[Language of the institution] = d1.opetuskieli_EN
      ,[The size of the education provider] = d4.koko_EN
      ,[Language of the education provider] = d5.kieli_EN
	  ,[Type of education provider owner] = (select top 1 oppilaitoksen_omistajatyyppi_EN from dbo.d_oppilaitoksen_taustatiedot where oppilaitoksen_omistajatyyppikoodi=f.koulutuksen_jarjestajan_omistajatyyppi)
      ,[Region of the education provider] = (select top 1 maakunta_EN from dbo.d_alueluokitus where maakunta_koodi=f.koulutuksen_jarjestajan_maakunta)
      ,[Municipality type of the education provider] = (select top 1 kuntaryhma_EN from dbo.d_alueluokitus where kuntaryhma_koodi=f.koulutuksen_jarjestajan_kuntaryhmitys)

	  --koodit
	  ,(select top 1 maakunta_koodi from dbo.d_alueluokitus where maakunta_koodi=f.koulutuksen_jarjestajan_maakunta) as "Koodit Koul. järj. maakunta"
 
	  --järjestyskentät
	  ,[opetuskieli järjestys]= d1.jarjestys
	  ,[Koulutuksen järjestäjän koko järjestys] = d4.jarjestys
      ,[Koulutuksen järjestäjän kieli järjestys] = d5.jarjestys
	  ,[Koulutuksen järjestäjän omistajatyyppi järjestys] = (select top 1 jarjestys_omistajatyyppi from dbo.d_oppilaitoksen_taustatiedot where oppilaitoksen_omistajatyyppikoodi=f.koulutuksen_jarjestajan_omistajatyyppi)
	  ,[Koulutuksen järjestäjän maakunta järjestys] = (select top 1 jarjestys_maakunta from dbo.d_alueluokitus where maakunta_koodi=f.koulutuksen_jarjestajan_maakunta)
	  ,[Koulutuksen järjestäjän kuntaryhmitys järjestys] = (select top 1 jarjestys_kuntaryhma from dbo.d_alueluokitus where kuntaryhma_koodi=f.koulutuksen_jarjestajan_kuntaryhmitys)

      
FROM [dbo].[f_Opettajat_lukiokoulutus_koulutuksen_jarjestaja] f
LEFT JOIN dbo.d_opetuskieli2 d1 on d1.id=f.oppilaitoksen_kieli_id
LEFT JOIN dbo.d_koulutuksen_jarjestajan_koko d4 on d4.id=f.koulutuksen_jarjestajan_koko_id
LEFT JOIN dbo.d_kieli2 d5 on d5.id=f.koulutuksen_jarjestajan_kieli_id












' 
GO
/****** Object:  View [dbo].[v_f_tab_opettajat_7_6]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_opettajat_7_6]'))
EXEC dbo.sp_executesql @statement = N'
















CREATE view [dbo].[v_f_tab_opettajat_7_6] as

Select
      [Tilastovuosi] = f.tilastointivuosi
      ,[Oppilaitoksen opetuskieli] = d1.opetuskieli
      ,[Tehtavätyyppi lukiokoulutuksessa] = d2.tehtavatyyppi
      --,[Täydennyskoulutustiedot] = case f.taydennyskoulutus_osallistuminen when ''1'' then ''Toisen oppilaitoksen yhteydessä'' when ''0'' then ''Ei toisen oppilaitoksen yhteydessä'' else '''' end
      --,[Täydennyskoulutukseen osallistuminen] = case f.taydennyskoulutus_ei_tietoa when ''1'' then ''Ei tietoa'' when ''0'' then ''Tieto saatu'' else '''' end
      --,[Täydennyskoulutus tilastovuonna] = case f.taydennyskoulutus_ei when ''1'' then ''Ei osallistunut'' when ''0'' then ''Osallistui'' else '''' end
      ,[Osallistuminen tutkintotavoitteeseen koulutukseen työajalla] = f.taydennyskoulutus_tyoaika
      ,[Osallistuminen tutkintotavoitteeseen omalla ajalla] = f.taydennyskoulutus_oma_aika 
      ,[Osallistuminen kelpoisuuden tai pätevyyden tuottavaan koulutukseen työajalla] = f.taydennyskoulutus_kelp_tyoaika 
      ,[Osallistuminen kelpoisuuden tai pätevyyden tuottavaan koulutukseen omalla ajalla] = f.taydennyskoulutus_kelp_oma_aika 
      ,[Osallistuminen työantajan järjestämään henkilöstökoulutukseen työajalla] = f.taydennyskoulutus_tantaja_tyoaika 
      ,[Osallistuminen työantajan järjestämään henkilöstökoulutukseen omalla ajalla] = f.taydennyskoulutus_tantaja_oma_aika
      ,[Osallistuminen muuhun toimintaan työajalla] = f.taydennyskoulutus_muu_tyoaika 
      ,[Osallistuminen muuhun toimintaan omalla ajalla] = f.taydennyskoulutus_muu_oma_aika 
      ,[Osallistuminen kotimaiseen tai kansainväliseen asiantuntijavaihtoon työajalla] = f.asiantuntijavaihto_tyoaika 
      ,[Osallistuminen kotimaiseen tai kansainväliseen asiantuntijavaihtoon omalla ajalla] = f.asiantuntijavaihto_oma_aika 
      ,[Koulutus- ja kehittämissuunnitelma] = d27.kylla_ei--case f.koulutussuunnitelma when ''1'' then ''On sovittu'' when ''0'' then ''Ei ole sovittu'' else '''' end
	  ,[Kouluttautunut mentoriksi] = d21.kylla_ei
	  ,[Toiminut mentorina] = d22.kylla_ei
	  ,[Ollut mentoroitavana] = d23.kylla_ei
	  ,[Kouluttautunut työnohjaajaksi] = d24.kylla_ei
	  ,[Toiminut työnohjaajana] = d25.kylla_ei
	  ,[Ollut työnohjauksessa] = d26.kylla_ei
      ,[Sukupuoli] = d3.sukupuoli
      ,[Oppilaitoksen maakunta] = (select top 1 maakunta from dbo.d_alueluokitus where maakunta_koodi=f.maakunta_oppilaitos)
	  ,[Ikäryhmä] = d4.ika5v
      ,[Täydennyskoulutus tai asiantuntijavaihto] = case when f.taydennyskoulutus_ei=0 or f.asiantuntijavaihto_oma_aika>0 or f.asiantuntijavaihto_tyoaika>0 then 1 else 0 end

	  --Ruotsi
	  ,[Statistikår] = f.tilastointivuosi
      ,[Läroanstaltens undervisningsspråk] = d1.opetuskieli_SV
      ,[Uppgiftstyp] = d2.tehtavatyyppi_SV
      ,[Kön] = d3.sukupuoli_SV
      ,[Läroanstaltens landskap] = (select top 1 maakunta_SV from dbo.d_alueluokitus where maakunta_koodi=f.maakunta_oppilaitos)
	  ,[Åldersgrupp] = d4.ika5v_SV

	  --Englanti
	  ,[Statistical year] = f.tilastointivuosi
      ,[Language of the institution] = d1.opetuskieli_EN
      ,[Type of task] = d2.tehtavatyyppi_EN
      ,[Gender] = d3.sukupuoli_EN
      ,[Region of the institution] = (select top 1 maakunta_EN from dbo.d_alueluokitus where maakunta_koodi=f.maakunta_oppilaitos)
	  ,[Age group] = d4.ika5v_EN

	  --koodit
	  ,[Koodit Oppil. maakunta] = (select top 1 maakunta_koodi from dbo.d_alueluokitus where maakunta_koodi=f.maakunta_oppilaitos)
 
 
	  --järjestyskentät
	  ,[opetuskieli järjestys]= d1.jarjestys
	  ,[Tehtavätyyppi lukiokoulutuksessa järjestys] = d2.jarjestys
	  ,[Sukupuoli järjestys] = d3.jarjestys
	  ,[Oppilaitoksen maakunta järjestys] = (select top 1 jarjestys_maakunta from dbo.d_alueluokitus where maakunta_koodi=f.maakunta_oppilaitos)
	  ,[Ikä järjestys] = d4.jarjestys_ika5v
	  

      
FROM [dbo].[f_Opettajat_lukiokoulutus_osallistuminen_taydennyskoulutukseen] f
LEFT JOIN dbo.d_opetuskieli2 d1 on d1.id=f.oppilaitoksen_kieli_id
LEFT JOIN dbo.d_opettajan_tehtavatyyppi_lukiokoulutuksessa d2 on d2.id=f.tehtavatyyppi_lukiokoulutuksessa_id
LEFT JOIN dbo.d_sukupuoli d3 on d3.id=f.sukupuoli_id
LEFT JOIN dbo.d_ika d4 on d4.id=f.ika_id
LEFT JOIN dbo.d_kylla_ei d21 on d21.kylla_ei_koodi=f.kouluttautunut_mentoriksi
LEFT JOIN dbo.d_kylla_ei d22 on d22.kylla_ei_koodi=f.toiminut_mentorina
LEFT JOIN dbo.d_kylla_ei d23 on d23.kylla_ei_koodi=f.ollut_mentoroitavana
LEFT JOIN dbo.d_kylla_ei d24 on d24.kylla_ei_koodi=f.kouluttautunut_tyonohjaajaksi
LEFT JOIN dbo.d_kylla_ei d25 on d25.kylla_ei_koodi=f.toiminut_tyonohjaajana
LEFT JOIN dbo.d_kylla_ei d26 on d26.kylla_ei_koodi=f.ollut_tyonohjauksessa
LEFT JOIN dbo.d_kylla_ei d27 on d27.kylla_ei_koodi=f.koulutussuunnitelma





















' 
GO
/****** Object:  View [dbo].[v_f_tab_opettajat_7_7]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_opettajat_7_7]'))
EXEC dbo.sp_executesql @statement = N'









CREATE view [dbo].[v_f_tab_opettajat_7_7] as

Select
      [Tilastovuosi] = f.tilastointivuosi
	  ,[Oppilaitoksen opetuskieli] = d1.opetuskieli
      ,[Opettajan pääasiallinen koulutusaste] = d5.koulutusaste
      ,[Erityisopetus] = d3.kylla_ei
      ,[Opinto_ohjaus] = d6.kylla_ei
      ,[VALMA] = d7.kylla_ei
      ,[TELMA] = d8.kylla_ei 
      ,[Maahanmuuttajien valmistava koulutus] = d9.kylla_ei
      ,[Ammatilliseen peruskoulutukseen valmistava koulutus] = d10.kylla_ei 
      ,[Kotitalousopetus] = d11.kylla_ei
      ,[Ammatillisten opintojen kelpoisuus] = d12.kylla_ei 
      ,[Yhteisten opintojen kelpoisuus] = d13.kylla_ei
      ,[Opinto-ohjaajan kelpoisuus] = d14.kylla_ei 
      ,[Erityisopettajan kelpoisuus] = d15.kylla_ei
      ,[Muu opettajan kelpoisuus] = d16.kylla_ei 
      ,[Ei muodollista opettajan kelpoisuutta] = d17.kylla_ei
      ,[Päätehtävän tutkinto puuttuu] = d18.kylla_ei
      ,[Pedagogiset opinnot puuttuvat] = d19.kylla_ei
      ,[Vaadittava työkokemus puuttuu] = d20.kylla_ei 
      --,[Puuttuvien kelpoisuuksien tieto puuttuu] = d21.kylla_ei
	  ,[Kaikki kelpoisuudet] = d22.kylla_ei
	  ,[Opettajan eniten opettama ala] = case d24.koulutusala2002 when ''Yleissivistävä koulutus'' then ''Ammattitaitoa täydentävät tutkinnon osat (yhteiset opinnot)'' else d24.koulutusala2002 end
      ,[Opettajan eniten opettama aine] = d25.aine



      ,[Opettajan koulutus] = d26.koulutus
      ,[Koulutuksen järjestäjän koko] = d27a.koko
      ,[Koulutuksen järjestäjän koko (ei oppisopimus)] = d27.koko
      ,[Koulutuksen järjestäjän koko (oppisopimus)] = d28.koko
      ,[Koulutuksen järjestäjän kieli] = d29.kieli
      ,[Koulutuksen järjestäjän maakunta] = d30.maakunta
      ,[Oppilaitoksen maakunta] = d31.maakunta
	 

	  --Ruotsi
	  ,[Statistikår] = f.tilastointivuosi
	  ,[Läroanstaltens undervisningsspråk] = d1.opetuskieli_SV
      ,[Huvudsaklig utbildningsform] = d5.koulutusaste_SV
	  ,[Lärarens huvudsakliga utb.område] = case d24.koulutusala2002 when ''Yleissivistävä koulutus'' then ''Examensdelar som kompletterar yrkeskompetensen (gemensammma studier)'' else d24.koulutusala2002_SV end
      ,[Lärarens huvudsakliga ämne] = d25.aine_SV
      ,[Läroanstaltens landskap] = d31.maakunta_SV


	  --Englanti
	  ,[Statistical year] = f.tilastointivuosi
	  ,[Language of the institution] = d1.opetuskieli_EN
      ,[Teacher''s primary level] = d5.koulutusaste_EN
	  ,[Teacher''s primary field] = case d24.koulutusala2002 when ''Yleissivistävä koulutus'' then ''Core subjects'' else d24.koulutusala2002_EN end
      ,[Teacher''s primary subject] = d25.aine_EN
      ,[Region of the institution] = d31.maakunta_EN


	  --koodit
	  ,[Koodit Oppil. maakunta] = d31.maakunta_koodi
      
 
	  --järjestyskentät
	  ,[Opetuskieli järjestys]= d1.jarjestys
	  ,[Opettajan koulutusaste järjestys] = d5.jarjestys
	  ,[Opettajan ala järjestys] = d24.jarjestys_koulutusala2002
	  ,[Opettajan aine järjestys] = d25.jarjestys
	  ,[Koul järj koko järjestys] = d27a.jarjestys
	  ,[Koul järj koko ei oppis järjestys] = d27.jarjestys
	  ,[Koul järj koko oppis järjestys] = d28.jarjestys
	  ,[Koul järj kieli järjestys] = d29.jarjestys
	  ,[Koul järj maakunta järjestys] = d30.jarjestys_maakunta
	  ,[Oppilaitoksen maakunta järjestys] = d31.jarjestys_maakunta

	    

      
FROM [dbo].[f_Opettajat_ammatillinen_koulutus_kelpoisuus_koulutus_jarjkieli] f
LEFT JOIN dbo.d_opetuskieli2 d1 on d1.id=f.oppilaitoksen_kieli_id
LEFT JOIN dbo.d_kylla_ei d3 on d3.id=f.erityisopetus_id
LEFT JOIN dbo.d_opettajat_koulutusaste_amm d5 on d5.id=pääasiallinen_koulutusaste_id
LEFT JOIN dbo.d_kylla_ei d6 on d6.id=f.opinto_ohjaus_id
LEFT JOIN dbo.d_kylla_ei d7 on d7.id=f.valma_id
LEFT JOIN dbo.d_kylla_ei d8 on d8.id=f.telma_id
LEFT JOIN dbo.d_kylla_ei d9 on d9.id=f.mamu_id
LEFT JOIN dbo.d_kylla_ei d10 on d10.id=f.ammpk_valmistava_id
LEFT JOIN dbo.d_kylla_ei d11 on d11.id=f.kotitalousopetus_id
LEFT JOIN dbo.d_kylla_ei d12 on d12.id=f.kelp_amm_id
LEFT JOIN dbo.d_kylla_ei d13 on d13.id=f.kelp_yht_id
LEFT JOIN dbo.d_kylla_ei d14 on d14.id=f.kelp_opo_id
LEFT JOIN dbo.d_kylla_ei d15 on d15.id=f.kelp_erope_id
LEFT JOIN dbo.d_kylla_ei d16 on d16.id=f.kelp_muu_id
LEFT JOIN dbo.d_kylla_ei d17 on d17.id=f.kelp_ei_muod_id
LEFT JOIN dbo.d_kylla_ei d18 on d18.id=f.eikelp_paa_id
LEFT JOIN dbo.d_kylla_ei d19 on d19.id=f.eikelp_pedag_id
LEFT JOIN dbo.d_kylla_ei d20 on d20.id=f.eikelp_tyokok_id
LEFT JOIN dbo.d_kylla_ei d21 on d21.id=f.eikelp_tieto_puuttuu_id
LEFT JOIN dbo.d_kylla_ei d22 on d22.id=f.kelp_kaikki_id
LEFT JOIN dbo.d_koulutusluokitus d24 on d24.id=f.opettajan_eniten_opettama_ala_id
LEFT JOIN dbo.d_opettajat_aine_amm d25 on d25.id=f.opettajan_eniten_opettama_aine_id
LEFT JOIN dbo.d_koulutusluokitus d26 on d26.id=f.opettajan_koulutus_id
LEFT JOIN dbo.d_koulutuksen_jarjestajan_koko d27a on d27a.id=f.koul_jarj_koko_id
LEFT JOIN dbo.d_koulutuksen_jarjestajan_koko d27 on d27.id=f.koul_jarj_koko_ei_oppis_id
LEFT JOIN dbo.d_koulutuksen_jarjestajan_koko d28 on d28.id=f.koul_jarj_koko_oppis_id
LEFT JOIN dbo.d_kieli2 d29 on d29.id=f.koul_jarj_kieli_id
LEFT JOIN dbo.d_alueluokitus d30 on d30.id=f.koul_jarj_maakunta_id
LEFT JOIN dbo.d_alueluokitus d31 on d31.id=f.oppilaitoksen_maakunta_id
--LEFT JOIN dbo.d_opettajan_tehtavatyyppi_ammatillisessa_koulutuksessa d32 on d32.id=f.tehtavatyyppi_ammatillisessa_id
--LEFT JOIN dbo.d_ika d33 on d33.id=f.ika_id
--LEFT JOIN dbo.d_sukupuoli d34 on d34.id=f.sukupuoli_id
--LEFT JOIN dbo.d_opettajat_tyosuhteen_luonne d35 on d35.id=f.tyosuhteen_luonne_id
--LEFT JOIN dbo.d_opettajat_koko_osa_aikainen d36 on d36.id=f.koko_osa_aikainen_id
--LEFT JOIN dbo.d_opettajat_osa_aikaisuuden_syy d37 on d37.id=f.osa_aikaisuuden_syy_id

where f.tilastointivuosi >= 2013


















' 
GO
/****** Object:  View [dbo].[v_f_tab_opettajat_7_8]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_opettajat_7_8]'))
EXEC dbo.sp_executesql @statement = N'









CREATE view [dbo].[v_f_tab_opettajat_7_8] as

Select
      [Tilastovuosi] = f.tilastointivuosi
	  ,[Oppilaitoksen kieli] = d1.opetuskieli
      ,[Tehtävätyyppi ammatillisessa koulutuksessa] = d2.tehtavatyyppi
      ,[Pääasiallinen koulutusaste] = d5.koulutusaste
      ,[Pääasiallinen koulutusala] = case d4.koulutusala2002 when ''Yleissivistävä koulutus'' then ''Ammattitaitoa täydentävät tutkinnon osat (yhteiset opinnot)'' else d4.koulutusala2002 end
      --,[Täydennyskoulutustiedot toisen oppilaitoksen yhteydessä] = d8.kylla_ei
      --,[Täydennyskoulutuksesta ei tietoa] = d9.kylla_ei
      --,[Ei ole osallistunut täydennyskoulutukseen] = d10.kylla_ei
      ,[Osallistuminen tutkintotavoitteeseen koulutukseen työajalla] = f.taydennyskoulutus_tyoaika
      ,[Osallistuminen tutkintotavoitteeseen omalla ajalla] = f.taydennyskoulutus_oma_aika 
      ,[Osallistuminen kelpoisuuden tai pätevyyden tuottavaan koulutukseen työajalla] = f.taydennyskoulutus_kelp_tyoaika 
      ,[Osallistuminen kelpoisuuden tai pätevyyden tuottavaan koulutukseen omalla ajalla] = f.taydennyskoulutus_kelp_oma_aika 
      ,[Osallistuminen työantajan järjestämään henkilöstökoulutukseen työajalla] = f.taydennyskoulutus_tantaja_tyoaika 
      ,[Osallistuminen työantajan järjestämään henkilöstökoulutukseen omalla ajalla] = f.taydennyskoulutus_tantaja_oma_aika
      ,[Osallistuminen muuhun toimintaan työajalla] = f.taydennyskoulutus_muu_tyoaika 
      ,[Osallistuminen muuhun toimintaan omalla ajalla] = f.taydennyskoulutus_muu_oma_aika 
      ,[Osallistuminen kotimaiseen tai kansainväliseen asiantuntijavaihtoon työajalla] = f.asiantuntijavaihto_tyoaika 
      ,[Osallistuminen kotimaiseen tai kansainväliseen asiantuntijavaihtoon omalla ajalla] = f.asiantuntijavaihto_oma_aika
      ,[Koulutus- ja kehittämissuunnitelma] = d11.kylla_ei
      --,[Työelämäjakso työpäivät] = f.tyoelamajakso_lkm
      --,[Ei ole osallistunut työelämäjaksolle] = d12.kylla_ei
      --,[Työelämäjaksolle osallistumisesta ei tietoa] = d13.kylla_ei
	  ,[Kouluttautunut mentoriksi] = d21.kylla_ei
	  ,[Toiminut mentorina] = d22.kylla_ei
	  ,[Ollut mentoroitavana] = d23.kylla_ei
	  ,[Kouluttautunut työnohjaajaksi] = d24.kylla_ei
	  ,[Toiminut työnohjaajana] = d25.kylla_ei
	  ,[Ollut työnohjauksessa] = d26.kylla_ei
	  ,[Osallistunut työelämäjaksolle] = d27.kylla_ei
	  ,[Työelämäjakso: opiskelijan ohjaamista työelämäjaksolla] = d28.kylla_ei
	  ,[Työelämäjakso: työpaikkaohjaajan/-kouluttajan ohjaamista] = d29.kylla_ei
	  ,[Työelämäjakso: opintojen sisällön ohjaamista] = d30.kylla_ei
	  ,[Työelämäjakso: oman osaamisen kasvattamista] = d32.kylla_ei
	  ,[Työpaikalla tapahtuva työ] = f.tyopaikoilla_tapahtuva_tyo
	  ,[Työpaikoilla tapahtuva työ: opiskelijan ohjaamista] = d33.kylla_ei
	  ,[Työpaikoilla tapahtuva työ: työpaikkaohjaajan/-kouluttajan ohjaamista] = d34.kylla_ei
	  ,[Työpaikoilla tapahtuva työ: opintojen sisällön ohjaamista] = d35.kylla_ei
	  ,[Työpaikoilla tapahtuva työ: oman osaamisen kasvattamista] = d36.kylla_ei

      ,[Sukupuoli] = d6.sukupuoli
      ,[Oppilaitoksen maakunta] = d31.maakunta
      ,[Ikäryhmä] = d7.ika5v
      ,[Täydennyskoulutus tai asiantuntijavaihto] = case when f.taydennyskoulutus_ei=4 or f.asiantuntijavaihto_oma_aika>0 or f.asiantuntijavaihto_tyoaika>0 then 1 else 0 end

	  --Ruotsi
	  ,[Statistikår] = f.tilastointivuosi
	  ,[Läroanstaltens undervisningsspråk] = d1.opetuskieli_SV
      ,[Uppgiftstyp] = d2.tehtavatyyppi_SV
      ,[Huvudsaklig utbildningsform] = d5.koulutusaste_SV
      ,[Lärarens huvudsakliga utb.område] = case d4.koulutusala2002 when ''Yleissivistävä koulutus'' then ''Examensdelar som kompletterar yrkeskompetensen (gemensammma studier)'' else d4.koulutusala2002_SV end
      ,[Kön] = d6.sukupuoli_SV
      ,[Läroanstaltens landskap] = d31.maakunta_SV
      ,[Åldersgrupp] = d7.ika5v_SV

	  --Englanti
	  ,[Statistical year] = f.tilastointivuosi
	  ,[Language of the institution] = d1.opetuskieli_EN
      ,[Type of task] = d2.tehtavatyyppi_EN
      ,[Teacher''s primary level] = d5.koulutusaste_EN
      ,[Teacher''s primary field] = case d4.koulutusala2002 when ''Yleissivistävä koulutus'' then ''Core subjects'' else d4.koulutusala2002_EN end
      ,[Gender] = d6.sukupuoli_EN
      ,[Region of the institution] = d31.maakunta_EN
      ,[Age group] = d7.ika5v_EN

	  --koodit
	  ,[Koodit Oppil. maakunta] = d31.maakunta_koodi

	  --järjestyskentät
	  ,[opetuskieli järjestys]= d1.jarjestys
	  ,[Tehtävätyyppi järjestys] = d2.jarjestys
	  ,[Koulutusaste järjestys] = d5.jarjestys
	  ,[Koulutusala järjestys] = d4.jarjestys_koulutusala2002
	  ,[Sukupuoli järjestys] = d6.jarjestys
	  ,[Oppilaitoksen maakunta järjestys] = d31.jarjestys_maakunta
	  ,[Ikä järjestys] = d7.jarjestys_ika5v
	  

      
FROM [dbo].[f_Opettajat_ammatillinen_koulutus_osallistuminen_taydennyskoulutukseen] f
LEFT JOIN dbo.d_opetuskieli2 d1 on d1.id=f.oppilaitoksen_kieli_id
LEFT JOIN dbo.d_opettajan_tehtavatyyppi_ammatillisessa_koulutuksessa d2 on d2.id=f.tehtävätyyppi_amm_koulutuksessa_id
LEFT JOIN dbo.d_koulutusluokitus d4 on d4.id=f.pääasiallinen_koulutusala_id
LEFT JOIN dbo.d_opettajat_koulutusaste_amm d5 on d5.id=pääasiallinen_koulutusaste_id
LEFT JOIN dbo.d_sukupuoli d6 on d6.id=f.sukupuoli_id
LEFT JOIN dbo.d_ika d7 on d7.id=f.ika_id
LEFT JOIN dbo.d_kylla_ei d8 on d8.id=f.taydennyskoulutus_osallistuminen
LEFT JOIN dbo.d_kylla_ei d9 on d9.id=f.taydennyskoulutus_ei_tietoa
LEFT JOIN dbo.d_kylla_ei d10 on d10.id=f.taydennyskoulutus_ei
LEFT JOIN dbo.d_kylla_ei d11 on d11.id=f.koulutussuunnitelma
LEFT JOIN dbo.d_kylla_ei d12 on d12.id=f.tyoelamajakso
LEFT JOIN dbo.d_kylla_ei d13 on d13.id=f.tyoelamajakso_ei_tietoa
LEFT JOIN dbo.d_alueluokitus d31 on d31.id=f.oppilaitoksen_maakunta_id
LEFT JOIN dbo.d_kylla_ei d21 on d21.kylla_ei_koodi=f.kouluttautunut_mentoriksi
LEFT JOIN dbo.d_kylla_ei d22 on d22.kylla_ei_koodi=f.toiminut_mentorina
LEFT JOIN dbo.d_kylla_ei d23 on d23.kylla_ei_koodi=f.ollut_mentoroitavana
LEFT JOIN dbo.d_kylla_ei d24 on d24.kylla_ei_koodi=f.kouluttautunut_tyonohjaajaksi
LEFT JOIN dbo.d_kylla_ei d25 on d25.kylla_ei_koodi=f.toiminut_tyonohjaajana
LEFT JOIN dbo.d_kylla_ei d26 on d26.kylla_ei_koodi=f.ollut_tyonohjauksessa
LEFT JOIN dbo.d_kylla_ei d27 on d27.kylla_ei_koodi=f.osallistunut_tyoelamajaksolle
LEFT JOIN dbo.d_kylla_ei d28 on d28.kylla_ei_koodi=f.opiskelijan_ohjaamista
LEFT JOIN dbo.d_kylla_ei d29 on d29.kylla_ei_koodi=f.tyopaikkaohjaajan_kouluttajan_ohjaamista
LEFT JOIN dbo.d_kylla_ei d30 on d30.kylla_ei_koodi=f.opintojen_sisallon_ohjaamista
LEFT JOIN dbo.d_kylla_ei d32 on d32.kylla_ei_koodi=f.oman_osaamisen_kasvattamista
LEFT JOIN dbo.d_kylla_ei d33 on d33.kylla_ei_koodi=f.opiskelijan_ohjaamista_tp
LEFT JOIN dbo.d_kylla_ei d34 on d34.kylla_ei_koodi=f.tyopaikkaohjaajan_kouluttajan_ohjaamista_tp
LEFT JOIN dbo.d_kylla_ei d35 on d35.kylla_ei_koodi=f.opintojen_sisallon_ohjaamista_tp
LEFT JOIN dbo.d_kylla_ei d36 on d36.kylla_ei_koodi=f.oman_osaamisen_kasvattamista_tp





























' 
GO
/****** Object:  View [dbo].[v_f_tab_opettajat_7_9]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_opettajat_7_9]'))
EXEC dbo.sp_executesql @statement = N'




















CREATE view [dbo].[v_f_tab_opettajat_7_9] as

Select
      [Tilastovuosi] = f.tilastointivuosi
      ,[Oppilaitoksen opetuskieli] = d1.opetuskieli
      ,[Tehtävätyyppi vapaassa sivistystyössä] = d2.tehtavatyyppi
      --,[Täydennyskoulutustiedot toisen oppilaitoksen yhteydessä] = d8.kylla_ei
      --,[Täydennyskoulutustietoja ei saatu] = d9.kylla_ei
      --,[Täydennyskoulutus ei osallistunut] = d10.kylla_ei
      ,[Osallistuminen tutkintotavoitteeseen koulutukseen työajalla] = f.taydennyskoulutus_tyoaika
      ,[Osallistuminen tutkintotavoitteeseen omalla ajalla] = f.taydennyskoulutus_oma_aika 
      ,[Osallistuminen kelpoisuuden tai pätevyyden tuottavaan koulutukseen työajalla] = f.taydennyskoulutus_kelp_tyoaika 
      ,[Osallistuminen kelpoisuuden tai pätevyyden tuottavaan koulutukseen omalla ajalla] = f.taydennyskoulutus_kelp_oma_aika 
      ,[Osallistuminen työantajan järjestämään henkilöstökoulutukseen työajalla] = f.taydennyskoulutus_tantaja_tyoaika 
      ,[Osallistuminen työantajan järjestämään henkilöstökoulutukseen omalla ajalla] = f.taydennyskoulutus_tantaja_oma_aika
      ,[Osallistuminen muuhun toimintaan työajalla] = f.taydennyskoulutus_muu_tyoaika 
      ,[Osallistuminen muuhun toimintaan omalla ajalla] = f.taydennyskoulutus_muu_oma_aika 
	  ,[Osallistuminen kotimaiseen tai kansainväliseen asiantuntijavaihtoon työajalla] = f.asiantuntijavaihto_tyoaika
	  ,[Osallistuminen kotimaiseen tai kansainväliseen asiantuntijavaihtoon omalla ajalla] = f.asiantuntijavaihto_oma_aika
      ,[Koulutus- ja kehittämissuunnitelma] = d11.kylla_ei
	  ,[Kouluttautunut mentoriksi] = d21.kylla_ei
	  ,[Toiminut mentorina] = d22.kylla_ei
	  ,[Ollut mentoroitavana] = d23.kylla_ei
	  ,[Kouluttautunut työnohjaajaksi] = d24.kylla_ei
	  ,[Toiminut työnohjaajana] = d25.kylla_ei
	  ,[Ollut työnohjauksessa] = d26.kylla_ei
      ,[Sukupuoli] = d3.sukupuoli
      ,[Oppilaitoksen maakunta] = d5.maakunta
	  ,[Ikäryhmä] = d4.ika5v
	  ,[Täydennyskoulutus tai asiantuntijavaihto] = case when f.taydennyskoulutus_ei=4 or f.asiantuntijavaihto_oma_aika>0 or f.asiantuntijavaihto_tyoaika>0 then 1 else 0 end
      

	  --Ruotsi
	  ,[Statistikår] = f.tilastointivuosi
      ,[Läroanstaltens undervisningsspråk] = d1.opetuskieli_SV
      ,[Uppgiftstyp] = d2.tehtavatyyppi_SV
      ,[Kön] = d3.sukupuoli_SV
      ,[Läroanstaltens landskap] = d5.maakunta_SV
	  ,[Åldersgrupp] = d4.ika5v_SV

	  --Englanti
	  ,[Statistical year] = f.tilastointivuosi
      ,[Language of the institution] = d1.opetuskieli_EN
      ,[Type of task] = d2.tehtavatyyppi_EN
      ,[Gender] = d3.sukupuoli_EN
      ,[Region of the institution] = d5.maakunta_EN
	  ,[Age group] = d4.ika5v_EN

	  --koodit
	  ,[Koodit Oppil. maakunta] = d5.maakunta_koodi
 
	  --järjestyskentät
	  ,[opetuskieli järjestys]= d1.jarjestys
	  ,[Tehtavätyyppi järjestys] = d2.jarjestys
	  ,[Sukupuoli järjestys] = d3.jarjestys
	  ,[Oppilaitoksen maakunta järjestys] = d5.jarjestys_maakunta
	  ,[Ikä järjestys] = d4.jarjestys_ika5v
	  

      
FROM [dbo].[f_Opettajat_vapaa_sivistystyo_osallistuminen_taydennyskoulutukseen] f
LEFT JOIN dbo.d_opetuskieli2 d1 on d1.id=f.oppilaitoksen_kieli_id
LEFT JOIN dbo.d_opettajan_tehtavatyyppi_vapaassa_sivistystyossa d2 on d2.id=f.tehtavatyyppi_vapaassa_sivistystyossa_id
LEFT JOIN dbo.d_sukupuoli d3 on d3.id=f.sukupuoli_id
LEFT JOIN dbo.d_ika d4 on d4.id=f.ika_id
LEFT JOIN d_alueluokitus d5 on d5.id=f.oppilaitoksen_maakunta_id
LEFT JOIN VipunenTK..d_kylla_ei d8 on d8.id=f.taydennyskoulutus_osallistuminen
LEFT JOIN VipunenTK..d_kylla_ei d9 on d9.id=f.taydennyskoulutus_ei_tietoa
LEFT JOIN VipunenTK..d_kylla_ei d10 on d10.id=f.taydennyskoulutus_ei
LEFT JOIN VipunenTK..d_kylla_ei d11 on d11.id=f.koulutussuunnitelma
LEFT JOIN dbo.d_kylla_ei d21 on d21.kylla_ei_koodi=f.kouluttautunut_mentoriksi
LEFT JOIN dbo.d_kylla_ei d22 on d22.kylla_ei_koodi=f.toiminut_mentorina
LEFT JOIN dbo.d_kylla_ei d23 on d23.kylla_ei_koodi=f.ollut_mentoroitavana
LEFT JOIN dbo.d_kylla_ei d24 on d24.kylla_ei_koodi=f.kouluttautunut_tyonohjaajaksi
LEFT JOIN dbo.d_kylla_ei d25 on d25.kylla_ei_koodi=f.toiminut_tyonohjaajana
LEFT JOIN dbo.d_kylla_ei d26 on d26.kylla_ei_koodi=f.ollut_tyonohjauksessa

























' 
GO
/****** Object:  View [dbo].[v_f_tab_opettajat_yhteinen]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_opettajat_yhteinen]'))
EXEC dbo.sp_executesql @statement = N'










CREATE view [dbo].[v_f_tab_opettajat_yhteinen] as



select 
	   [Tilastovuosi] 
      ,[Oppilaitoksen opetuskieli] 
      ,[Sukupuoli] 
      ,[Oppilaitoksen maakunta] 
      ,[Ikäryhmä] 
	  ,[Kelpoisuus] 
	  ,[Koulutusaste]
	  ,[Koulutusmuoto] 
	  ,[Tehtävätyyppi] 
	  ,[Päätoiminen] 

	  --Ruotsi
	  ,[Statistikår]
      ,[Läroanstaltens undervisningsspråk] 
      ,[Kön] 
      ,[Läroanstaltens landskap] 
      ,[Åldersgrupp]
	  ,[Utbildningsnivå] 
	  ,[Utbildningsform]
	  ,[Typ av uppgift​]

	  --Englanti
	  ,[Statistical year] 
      ,[Language of the institution]
      ,[Gender]
      ,[Region of the institution] 
      ,[Age group] 
	  ,[Level of education] 
	  ,[Form of education]
	  ,[Type of task]

	  --koodit
	  ,[Koodit Oppil. maakunta] 
 
	  --järjestyskentät
	  ,[Opetuskieli järjestys]
	  ,[sukupuoli järjestys] 
	  ,[Oppilaitoksen maakunta järjestys] 
	  ,[ikä järjestys] 
	  ,[Koulutusaste järjestys] 
	  ,[Tehtävätyyppi järjestys] 
	  ,[Koulutusmuoto järjestys] = 
		case ff.Koulutusmuoto 
			when ''Esiopetus'' then 1 
			when ''Perusopetus'' then 2  
			when ''Lukiokoulutus'' then 3
			when ''Ammatillinen peruskoulutus, opetussuunnitelmaperusteinen'' then 4
			when ''Ammatillinen peruskoulutus, näyttötutkintoon valmistava'' then 5
			when ''Ammatti- ja erikoisammattitutkintoon valmistava koulutus'' then 6
			when ''Vapaa sivistystyö'' then 7
			else 99
		end

from (

Select
      [Tilastovuosi] = f.tilastointivuosi
      ,[Oppilaitoksen opetuskieli] = d1.opetuskieli
      ,[Sukupuoli] = d22.sukupuoli
      ,[Oppilaitoksen maakunta] = (select top 1 maakunta from dbo.d_alueluokitus where maakunta_koodi=f.maakunta_oppilaitos)
    --  ,[Oppilaitoksen sijaintikunnan kuntaryhmitys] = (select top 1 kuntaryhma from dbo.d_alueluokitus where kuntaryhma_koodi=f.kuntaryhmitys_oppilaitos)
      ,[Ikäryhmä] = d23.ika5v
	  ,[Kelpoisuus] = case d25.opettajankelpoisuus when ''Kelpoinen antamaan opetusta'' then ''Kyllä'' else ''Ei'' end
	  ,[Koulutusaste] = ''Perusopetus''
	  ,[Koulutusmuoto] = case when d3.luokka_aste = ''esiopetus'' then ''Esiopetus'' else ''Perusopetus'' end
	  ,[Tehtävätyyppi] = d4.tehtavatyyppi
	  ,[Päätoiminen] = case when d4.tehtavatyyppi not in (''Sivutoimiset tuntiopettajat'') then 1 else 0 end

	  --Ruotsi
	  ,[Statistikår] = f.tilastointivuosi
      ,[Läroanstaltens undervisningsspråk] = d1.opetuskieli_SV
      ,[Kön] = d22.sukupuoli_SV
      ,[Läroanstaltens landskap] = (select top 1 maakunta_SV from dbo.d_alueluokitus where maakunta_koodi=f.maakunta_oppilaitos)
      ,[Åldersgrupp] = d23.ika5v_SV
	  ,[Utbildningsnivå] = ''Grundutbildning''
	  ,[Utbildningsform] = case when d3.luokka_aste = ''esiopetus'' then ''Förskoleundervisning'' else ''Grundläggande utbildning'' end
	  ,[Typ av uppgift​] = d4.tehtavatyyppi_SV

	  --Englanti
	  ,[Statistical year] = f.tilastointivuosi
      ,[Language of the institution] = d1.opetuskieli_EN
      ,[Gender] = d22.sukupuoli_EN
      ,[Region of the institution] = (select top 1 maakunta_EN from dbo.d_alueluokitus where maakunta_koodi=f.maakunta_oppilaitos)
      ,[Age group] = d23.ika5v_EN
	  ,[Level of education] = ''Basic education''
	  ,[Form of education] = case when d3.luokka_aste = ''esiopetus'' then ''Pre-primary education'' else ''Basic education'' end
	  ,[Type of task] = d4.tehtavatyyppi_EN

	  --koodit
	  ,[Koodit Oppil. maakunta] = (select top 1 maakunta_koodi from dbo.d_alueluokitus where maakunta_koodi=f.maakunta_oppilaitos)
 
	  --järjestyskentät
	  ,[Opetuskieli järjestys]= d1.jarjestys
	  ,[sukupuoli järjestys] = d22.jarjestys
	  ,[Oppilaitoksen maakunta järjestys] = (select top 1 jarjestys_maakunta from dbo.d_alueluokitus where maakunta_koodi=f.maakunta_oppilaitos)
	 -- ,[Oppilaitoksen kuntaryhmitys järjestys] = (select top 1 jarjestys_kuntaryhma from dbo.d_alueluokitus where kuntaryhma_koodi=f.kuntaryhmitys_oppilaitos)
	  ,[ikä järjestys] = d23.jarjestys_ika5v
	  ,[Koulutusaste järjestys] = 1
	  ,[Tehtävätyyppi järjestys] = case d4.tehtavatyyppi when ''Muu'' then 1080 when ''Päätoiminen tuntiopettaja'' then 1030 when ''Sivutoimiset tuntiopettajat'' then 1070 else d4.jarjestys end

      
FROM [dbo].[f_Opettajat_perusopetus_kelpoisuus_opetusryhmakoot] f
LEFT JOIN dbo.d_opetuskieli2 d1 on d1.id=f.oppilaitoksen_kieli_id
LEFT JOIN dbo.d_oppilaitostyyppi d2 on d2.id=f.oppilaitostyyppi_id
LEFT JOIN dbo.d_sukupuoli d22 on d22.id=f.sukupuoli_id
LEFT JOIN dbo.d_ika d23 on d23.id=f.ika_id
LEFt JOIN dbo.d_opettajankelpoisuus2 d25 on d25.id=f.kelp_id
LEFT JOIN dbo.d_opettajan_tehtavatyyppi_perusopetuksessa d4 on d4.id=f.tehtavatyyppi_perusopetuksessa_id
LEFT JOIN dbo.d_opettajat_luokka_aste d3 on d3.id=f.oman_luokan_aste_id
where f.tilastointivuosi >= 2013

UNION ALL



Select
      [Tilastovuosi] = f.tilastointivuosi
      ,[Oppilaitoksen opetuskieli] = d1.opetuskieli
      ,[Sukupuoli] = d22.sukupuoli
      ,[Oppilaitoksen maakunta] = (select top 1 maakunta from dbo.d_alueluokitus where maakunta_koodi=f.maakunta_oppilaitos)
      --,[Oppilaitoksen kuntaryhmitys] = (select top 1 kuntaryhma from dbo.d_alueluokitus where kuntaryhma_koodi=f.kuntaryhmitys_oppilaitos)
      ,[Ikä] = d23.ika5v
	  ,[Kelpoisuus] = case d25.opettajankelpoisuus when ''Kelpoinen antamaan opetusta'' then ''Kyllä'' else ''Ei'' end
	  ,[Koulutusaste] = ''Lukiokoulutus''
	  ,[Koulutusmuoto] = ''Lukiokoulutus''
	  ,[Tehtävätyyppi] = d4.tehtavatyyppi
	  ,[Päätoiminen] = case when d4.tehtavatyyppi not in (''Sivutoimiset tuntiopettajat'') then 1 else 0 end
 
	  --Ruotsi
	  ,[Statistikår] = f.tilastointivuosi
      ,[Läroanstaltens undervisningsspråk] = d1.opetuskieli_SV
      ,[Kön] = d22.sukupuoli_SV
      ,[Läroanstaltens landskap] = (select top 1 maakunta_SV from dbo.d_alueluokitus where maakunta_koodi=f.maakunta_oppilaitos)
      ,[Åldersgrupp] = d23.ika5v_SV
	  ,[Utbildningsnivå] = ''Gymnasietutbildning''
	  ,[Utbildningsform] = ''Gymnasietutbildning''
	  ,[Typ av uppgift​] = d4.tehtavatyyppi_SV

	  --Englanti
	  ,[Statistical year] = f.tilastointivuosi
      ,[Language of the institution] = d1.opetuskieli_EN
      ,[Gender] = d22.sukupuoli_EN
      ,[Region of the institution] = (select top 1 maakunta_EN from dbo.d_alueluokitus where maakunta_koodi=f.maakunta_oppilaitos)
      ,[Age group] = d23.ika5v_EN
	  ,[Level of education] = ''General upper secondary education''
	  ,[Form of education] = ''General upper secondary education''
	  ,[Type of task] = d4.tehtavatyyppi_EN


	  --koodit
	  ,[Koodit Oppil. maakunta] = (select top 1 maakunta_koodi from dbo.d_alueluokitus where maakunta_koodi=f.maakunta_oppilaitos)
 

 --järjestyskentät
	  ,[opetuskieli järjestys]= d1.jarjestys
	  ,[sukupuoli järjestys] = d22.jarjestys
	  ,[Oppilaitoksen maakunta järjestys] = (select top 1 jarjestys_maakunta from dbo.d_alueluokitus where maakunta_koodi=f.maakunta_oppilaitos)
	 -- ,[Oppilaitoksen kuntaryhmitys järjestys] = (select top 1 jarjestys_kuntaryhma from dbo.d_alueluokitus where kuntaryhma_koodi=f.kuntaryhmitys_oppilaitos)
	  ,[ikä järjestys] = d23.jarjestys_ika5v
	  ,[Koulutusaste järjestys] = 2
	  ,[Tehtävätyyppi järjestys] = case d4.tehtavatyyppi when ''Muu'' then 1080 when ''Päätoiminen tuntiopettaja'' then 1030 when ''Sivutoimiset tuntiopettajat'' then 1070 else d4.jarjestys end
	  

      
FROM [dbo].[f_Opettajat_lukiokoulutus_kelpoisuus_aine] f
LEFT JOIN dbo.d_opetuskieli2 d1 on d1.id=f.oppilaitoksen_kieli_id
LEFT JOIN dbo.d_opettajan_tehtavatyyppi_lukiokoulutuksessa d7 on d7.id=f.tehtavatyyppi_lukiokoulutuksessa_id
LEFT JOIN dbo.d_opettajat_koulutusaste d8 on d8.id=f.paaasiallinen_koulutusmuoto_id
LEFT JOIN dbo.d_opettajat_aine d21 on d21.id=f.opettajan_eniten_opettama_aine_id
LEFT JOIN dbo.d_sukupuoli d22 on d22.id=f.sukupuoli_id
LEFT JOIN dbo.d_ika d23 on d23.id=f.ika_id
LEFT JOIN dbo.d_opettajankelpoisuus2 d25 on d25.id=f.kelp_id
LEFT JOIN dbo.d_opettajan_tehtavatyyppi_lukiokoulutuksessa d4 on d4.id=f.tehtavatyyppi_lukiokoulutuksessa_id
where f.tilastointivuosi >= 2013

UNION ALL



Select
      [Tilastovuosi] = f.tilastointivuosi
	  ,[Oppilaitoksen opetuskieli] = d1.opetuskieli
	  ,[Sukupuoli] = d34.sukupuoli
	  ,[Oppilaitoksen maakunta] = d31.maakunta
	  ,[Ikä] = d33.ika5v
      ,[Kelpoisuus] = case d17.kylla_ei when ''Kyllä'' then ''Ei'' else ''Kyllä'' end
	  ,[Koulutusaste] = ''Ammatillinen koulutus''
	  ,[Koulutusmuoto] = 
		case 
			when d5.koulutusaste = ''opetussuunnitelmaperusteinen ammatillinen peruskoulutus, oppilaitosmuotoinen'' then ''Ammatillinen peruskoulutus, opetussuunnitelmaperusteinen''
			when d5.koulutusaste = ''näyttötutkintoon valmistava ammatillinen peruskoulutus, oppilaitosmuotoinen'' then ''Ammatillinen peruskoulutus, näyttötutkintoon valmistava''
			when d5.koulutusaste in (''ammattitutkintoon valmistava, oppilaitosmuotoinen'',''erikoisammattitutkintoon valmistava, oppilaitosmuotoinen'') then ''Ammatti- ja erikoisammattitutkintoon valmistava koulutus''
			else ''Tuntematon''
		end
	  ,[Tehtävätyyppi] = d4.tehtavatyyppi
	  ,[Päätoiminen] = case when d4.tehtavatyyppi not in (''Sivutoimiset tuntiopettajat'') then 1 else 0 end

  	  --Ruotsi
	  ,[Statistikår] = f.tilastointivuosi
      ,[Läroanstaltens undervisningsspråk] = d1.opetuskieli_SV
      ,[Kön] = d34.sukupuoli_SV
      ,[Läroanstaltens landskap] = d31.maakunta_SV
      ,[Åldersgrupp] = d33.ika5v_SV
	  ,[Utbildningsnivå] = ''Yrkesutbildning''
	  ,[Utbildningsform] =
		case 
			when d5.koulutusaste = ''opetussuunnitelmaperusteinen ammatillinen peruskoulutus, oppilaitosmuotoinen'' then ''Grundläggande yrkesutbildning, läroplansbaserad''
			when d5.koulutusaste = ''näyttötutkintoon valmistava ammatillinen peruskoulutus, oppilaitosmuotoinen'' then ''Grundläggande yrkesutbildning, förberedande för fristående examen''
			when d5.koulutusaste in (''ammattitutkintoon valmistava, oppilaitosmuotoinen'',''erikoisammattitutkintoon valmistava, oppilaitosmuotoinen'') then ''Förberedande utbildning för yrkes- och specialyrkesexamen''
			else ''Okänd''
		end
	  ,[Typ av uppgift​] = d4.tehtavatyyppi_SV

	  --Englanti
	  ,[Statistical year] = f.tilastointivuosi
      ,[Language of the institution] = d1.opetuskieli_EN
      ,[Gender] = d34.sukupuoli_EN
      ,[Region of the institution] = d31.maakunta_EN
      ,[Age group] = d33.ika5v_EN
	  ,[Level of education] = ''Vocational education and training''
	  ,[Form of education] = 
		case 
			when d5.koulutusaste = ''opetussuunnitelmaperusteinen ammatillinen peruskoulutus, oppilaitosmuotoinen'' then ''Vocational upper secondary education and training, curriculum-based''
			when d5.koulutusaste = ''näyttötutkintoon valmistava ammatillinen peruskoulutus, oppilaitosmuotoinen'' then ''Vocational upper secondary education and training, preparatory for competence-based qualifications''
			when d5.koulutusaste in (''ammattitutkintoon valmistava, oppilaitosmuotoinen'',''erikoisammattitutkintoon valmistava, oppilaitosmuotoinen'') then ''Preparatory training for further vocational and specialist vocational qualifications''
			else ''Unknown''
		end
	  ,[Type of task] = d4.tehtavatyyppi_EN

	  --koodit
	  ,[Koodit Oppil. maakunta] = d31.jarjestys_maakunta
 
 
 --järjestyskentät
	  ,[opetuskieli järjestys]= d1.jarjestys
	  ,[Sukupuoli järjestys] = d34.jarjestys
	  ,[Oppilaitoksen maakunta järjestys] = d31.jarjestys_maakunta
	  ,[Ikä järjestys] = d33.jarjestys_ika5v
	  ,[Koulutusaste järjestys] = 3
	  ,[Tehtävätyyppi järjestys] = case d4.tehtavatyyppi when ''Muu'' then 1080 when ''Päätoiminen tuntiopettaja'' then 1030 when ''Sivutoimiset tuntiopettajat'' then 1070 else d4.jarjestys end
	  

      
FROM [dbo].[f_Opettajat_ammatillinen_koulutus_kelpoisuus_koulutus] f
LEFT JOIN dbo.d_opetuskieli2 d1 on d1.id=f.oppilaitoksen_kieli_id
LEFT JOIN dbo.d_kylla_ei d17 on d17.id=f.kelp_ei_muod
LEFT JOIN dbo.d_alueluokitus d31 on d31.id=f.oppilaitoksen_maakunta_id
LEFT JOIN dbo.d_ika d33 on d33.id=f.ika_id
LEFT JOIN dbo.d_sukupuoli d34 on d34.id=f.sukupuoli_id
LEFT JOIN dbo.d_opettajan_tehtavatyyppi_ammatillisessa_koulutuksessa d4 on d4.id=f.tehtavatyyppi_ammatillisessa_id
left join VipunenTK.dbo.d_opettajat_koulutusaste_amm d5 on d5.id=f.pääasiallinen_koulutusaste_id
where f.tilastointivuosi >= 2013


UNION ALL



Select
      [Tilastovuosi] = f.tilastointivuosi
	  ,[Oppilaitoksen opetuskieli] = d1.opetuskieli 
	  ,[Sukupuoli] = d34.sukupuoli
      ,[Oppilaitoksen maakunta] = d31.maakunta
	  ,[Ikä] = d33.ika5v
	  ,[Kelpoisuus] = d17.kylla_ei
	  ,[Koulutusaste] = ''Vapaa sivistystyö''
	  ,[Koulutusmuoto] = ''Vapaa sivistystyö''
	  ,[Tehtävätyyppi] = d4.tehtavatyyppi    
	  ,[Päätoiminen] = case when d4.tehtavatyyppi not in (''Muu'') then 1 else 0 end
	  
	  --Ruotsi
	  ,[Statistikår] = f.tilastointivuosi
      ,[Läroanstaltens undervisningsspråk] = d1.opetuskieli_SV
      ,[Kön] = d34.sukupuoli_SV
      ,[Läroanstaltens landskap] = d31.maakunta_SV
      ,[Åldersgrupp] = d33.ika5v_SV
	  ,[Utbildningsnivå] = ''Utbildningar som ordnats som fritt bildningsarbete''
	  ,[Utbildningsform] = ''Utbildningar som ordnats som fritt bildningsarbete''
	  ,[Typ av uppgift​] = d4.tehtavatyyppi_SV

	  --Englanti
	  ,[Statistical year] = f.tilastointivuosi
      ,[Language of the institution] = d1.opetuskieli_EN
      ,[Gender] = d34.sukupuoli_EN
      ,[Region of the institution] = d31.maakunta_EN
      ,[Age group] = d33.ika5v_EN
	  ,[Level of education] = ''Liberal (non-formal) adult education''
	  ,[Form of education] = ''Liberal (non-formal) adult education''
	  ,[Type of task] = d4.tehtavatyyppi_EN

	  --koodit
	  ,[Koodit Oppil. maakunta] = d31.jarjestys_maakunta
   
 
 --järjestyskentät
	  ,[Opetuskieli järjestys]= d1.jarjestys
	  ,[Sukupuoli järjestys] = d34.jarjestys
	  ,[Oppilaitoksen maakunta järjestys] = d31.jarjestys_maakunta
	  ,[Ikä järjestys] = d33.jarjestys_ika5v
	  ,[Koulutusaste järjestys] = 4
	  ,[Tehtävätyyppi järjestys] = case d4.tehtavatyyppi when ''Muu'' then 1080 when ''Päätoiminen tuntiopettaja'' then 1030 when ''Sivutoimiset tuntiopettajat'' then 1070 else d4.jarjestys end
      
FROM [dbo].[f_Opettajat_vapaa_sivistystyo_kelpoisuus_aine] f
LEFT JOIN dbo.d_opetuskieli2 d1 on d1.id=f.oppilaitoksen_kieli_id
LEFT JOIN dbo.d_kylla_ei d17 on d17.id=f.kelpoisuus_kunnossa_id
LEFT JOIN dbo.d_alueluokitus d31 on d31.id=f.oppilaitoksen_maakunta_id
LEFT JOIN dbo.d_ika d33 on d33.id=f.ika_id
LEFT JOIN dbo.d_sukupuoli d34 on d34.id=f.sukupuoli_id
LEFT JOIN dbo.d_opettajan_tehtavatyyppi_vapaassa_sivistystyossa d4 on d4.id=f.tehtavatyyppi_id
where f.tilastointivuosi >= 2013


) ff





' 
GO
/****** Object:  View [dbo].[v_f_tab_oppisopimus_jatko_opinnot]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_oppisopimus_jatko_opinnot]'))
EXEC dbo.sp_executesql @statement = N'










CREATE view [dbo].[v_f_tab_oppisopimus_jatko_opinnot] as


SELECT [Tilastovuosi] = f.tilastovuosi
      ,[Oppisopimus_osallistuneet_ja_tutkinnon_suorittaneet] = d1.oppis_osallis_ja_tutk_suor
      ,[Sukupuoli] = d2.sukupuoli
      ,[Aidinkieli versio1] = d3.aidinkieli_versio1
	  ,[Ika] = d4.ika
	  ,[Opetushallinnon koulutusala] = d5.koulutusala2002
	  ,[Ammatillisen koulutuksen koulutuslaji] = d6.ammatillisen_koulutuksen_koulutuslaji
	  ,[Koulutuksen sijaintimaakunta] = d7.maakunta
	  ,[Jatko opintojen koulutusaste] = d8.koulutusaste2002
      ,[Opiskelijat]
	  ,[Jatko opiskelu] = d9.jatko_opiskelu
	  
	  --jarjestyskentät
	  ,[Oppisryh jarjestys]= d1.jarjestys
	  ,[Sukupuoli jarjestys] = d2.jarjestys
	  ,[Aidinkieli versio1 jarjestys] = d3.jarjestys
	  ,[Ika jarjestys] = d4.jarjestys_ika
	  ,[Opetushallinnon koulutusala jarjestys] = d5.jarjestys_koulutusala2002
	  ,[Ammatillisen koulutuksen koulutuslaji jarjestys] = d6.jarjestys
	  ,[Koulutuksen sijaintimaakunta jarjestys] = d7.jarjestys_maakunta
	  ,[Jatko opintojen jarjestys] = d8.jarjestys_koulutusaste2002
	  ,[jatko opinto jarjestys] = d9.jarjestys
	 

      


FROM [VipunenTK].[dbo].[f_3_2_Oppisopimus_jatko_opinnot] f

	LEFT JOIN VipunenTK.dbo.d_oppisopimuskoulutus_osallistuneet_ja_tutk_suorittaneet d1
	on d1.id=f.oppisryh_id
 
	LEFT JOIN VipunenTK.dbo.d_sukupuoli d2
	on d2.id=f.sukupuoli_id

	LEFT JOIN VipunenTK.dbo.d_aidinkieli_versio1 d3
	on d3.id=f.aidinkieli_versio1_id

	LEFT JOIN VipunenTK.dbo.d_ika d4
	on d4.id=f.ika_id

	LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d5
	on d5.id=f.opetushallinnon_koulutusala_id

	LEFT JOIN VipunenTK.dbo.d_ammatillisen_koulutuksen_koulutuslaji d6
	on d6.id=f.ammatillisen_koulutuksen_koulutuslaji_id

	LEFT JOIN VipunenTK.dbo.d_alueluokitus d7
	on d7.id=f.koulutuksen_sijaintimaakunta_id
 
 
	LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d8
	on d8.id=f.jatko_opintojen_koulutusaste_id

	LEFT JOIN VipunenTK.dbo.d_jatko_opiskelu d9
	on d9.id=f.jatko_opiskelu_id


















' 
GO
/****** Object:  View [dbo].[v_f_tab_oppisopimus_koulutuksen_kesto]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_oppisopimus_koulutuksen_kesto]'))
EXEC dbo.sp_executesql @statement = N'










CREATE view [dbo].[v_f_tab_oppisopimus_koulutuksen_kesto] as


SELECT [Tilastovuosi] = f.tilastovuosi
      ,[Oppisopimus_osallistuneet_ja_tutkinnon_suorittaneet] = d1.oppis_osallis_ja_tutk_suor
      ,[Sukupuoli] = d2.sukupuoli
      ,[Aidinkieli versio1] = d3.aidinkieli_versio1
	  ,[Ika] = d4.ika
	  ,[Opetushallinnon koulutusala] = d5.koulutusala2002
	  ,[Opetushallinnon koulutusaste] = d6.koulutusaste2002
	  ,[Ammatillisen koulutuksen koulutuslaji] = d7.ammatillisen_koulutuksen_koulutuslaji
	  ,[Koulutuksen sijaintimaakunta] = d8.maakunta
	  ,[Koulutuksen arvioitu kesto] = d9.koulutuksen_kesto
	  ,[Koulutuksen toteutunut kesto] = d10.koulutuksen_kesto

	  --Ruotsi
	  ,[Statistikår] = f.tilastovuosi
      ,[Oppisopimus_osallistuneet_ja_tutkinnon_suorittaneetSV] = d1.oppis_osallis_ja_tutk_suor_SV
      ,[Kön] = d2.sukupuoli_SV
      ,[Modersmål] = d3.aidinkieli_versio1_SV
	  ,[Ålder] = d4.ika_SV
	  ,[Utbildningsområde] = d5.koulutusala2002_SV
	  ,[Utbildningsnivå] = d6.koulutusaste2002_SV
	  ,[Typ av examen] = d7.ammatillisen_koulutuksen_koulutuslaji_SV
	  ,[Utbildningsanordnarens landskap] = d8.maakunta_SV
	  ,[Beräknad längd på utbildningen] = d9.koulutuksen_kesto_SV
	  ,[Utbildningens längd] = d10.koulutuksen_kesto_SV

	  --Englanti
	  ,[Statistical year] = f.tilastovuosi
      ,[Oppisopimus_osallistuneet_ja_tutkinnon_suorittaneetEN] = d1.oppis_osallis_ja_tutk_suor_EN
      ,[Gender] = d2.sukupuoli_EN
      ,[Mother tongue] = d3.aidinkieli_versio1_EN
	  ,[Age] = d4.ika_EN
	  ,[Field of education] = d5.koulutusala2002_EN
	  ,[Level of education] = d6.koulutusaste2002_EN
	  ,[Qualification type] = d7.ammatillisen_koulutuksen_koulutuslaji_EN
	  ,[Region of education provider] = d8.maakunta_EN
	  ,[Estimated duration of education] = d9.koulutuksen_kesto_EN
	  ,[Duration of education] = d10.koulutuksen_kesto_EN


	  --Mittari
      ,[Opiskelijat]
	  
	  --jarjestyskentät
	  ,[Oppisryh jarjestys]= d1.jarjestys
	  ,[Sukupuoli jarjestys] = d2.jarjestys
	  ,[Aidinkieli versio1 jarjestys] = d3.jarjestys
	  ,[Ika jarjestys] = d4.jarjestys_ika
	  ,[Opetushallinnon koulutusala jarjestys] = d5.jarjestys_koulutusala2002
	  ,[Opetushallinnon koulutusaste jarjestys] = d6.jarjestys_koulutusaste2002
	  ,[Ammatillisen koulutuksen koulutuslaji jarjestys] = d7.jarjestys
	  ,[Koulutuksen sijaintimaakunta jarjestys] = d8.jarjestys_maakunta
	  ,[Koulutuksen arvioitu kesto jarjestys] = d9.jarjestys
	  ,[Koulutuksen toteutunut kesto jarjestys] = d10.jarjestys

      


FROM [VipunenTK].[dbo].[f_3_1b_Oppisopimus_koulutuksen_kesto] f

	LEFT JOIN VipunenTK.dbo.d_oppisopimuskoulutus_osallistuneet_ja_tutk_suorittaneet d1
	on d1.id=f.oppisryh_id
 
	LEFT JOIN VipunenTK.dbo.d_sukupuoli d2
	on d2.id=f.sukupuoli_id

	LEFT JOIN VipunenTK.dbo.d_aidinkieli_versio1 d3
	on d3.id=f.aidinkieli_versio1_id

	LEFT JOIN VipunenTK.dbo.d_ika d4
	on d4.id=f.ika_id

	LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d5
	on d5.id=f.opetushallinnon_koulutusala_id

		LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d6
	on d6.id=f.opetushallinnon_koulutusaste_id

	LEFT JOIN VipunenTK.dbo.d_ammatillisen_koulutuksen_koulutuslaji d7
	on d7.id=f.ammatillisen_koulutuksen_koulutuslaji_id

	LEFT JOIN VipunenTK.dbo.d_alueluokitus d8
	on d8.id=f.koulutuksen_sijaintimaakunta_id

		LEFT JOIN VipunenTK.dbo.d_koulutuksen_kesto d9
	on d9.id=f.koulutuksen_arvioitu_kesto_id

	LEFT JOIN VipunenTK.dbo.d_koulutuksen_kesto d10
	on d10.id=f.koulutuksen_toteutunut_kesto_id














' 
GO
/****** Object:  View [dbo].[v_f_tab_oppisopimus_paaasiallinen_toiminta]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_oppisopimus_paaasiallinen_toiminta]'))
EXEC dbo.sp_executesql @statement = N'








CREATE view [dbo].[v_f_tab_oppisopimus_paaasiallinen_toiminta] as


SELECT [Tilastovuosi] = f.tilastovuosi
      ,[Oppisopimus_osallistuneet_ja_tutkinnon_suorittaneet] = d1.oppis_osallis_ja_tutk_suor
      ,[Sukupuoli] = d2.sukupuoli
      ,[Aidinkieli versio1] = d3.aidinkieli_versio1
	  ,[Ika] = d4.ika
	  ,[Opetushallinnon koulutusala] = d5.koulutusala2002
	  ,[Opetushallinnon koulutusaste] = d6.koulutusaste2002
	  ,[Ammatillisen koulutuksen koulutuslaji] = d7.ammatillisen_koulutuksen_koulutuslaji
	  ,[Koulutuksen sijaintimaakunta] = d8.maakunta
	  ,[Paaasiallinen toiminta_versio3] = d9.paaasiallinen_toiminta
	  ,[Ammattiasema] = d10.ammattiasema
      ,[Opiskelijat]
	  
	  --jarjestyskentät
	  ,[Oppisryh jarjestys]= d1.jarjestys
	  ,[Sukupuoli jarjestys] = d2.jarjestys
	  ,[Aidinkieli versio1 jarjestys] = d3.jarjestys
	  ,[Ika jarjestys] = d4.jarjestys_ika
	  ,[Opetushallinnon koulutusala jarjestys] = d5.jarjestys_koulutusala2002
	  ,[Opetushallinnon koulutusaste jarjestys] = d6.jarjestys_koulutusaste2002
	  ,[Ammatillisen koulutuksen koulutuslaji jarjestys] = d7.jarjestys
	  ,[Koulutuksen sijaintimaakunta jarjestys] = d8.jarjestys_maakunta
	  ,[Paaasiallinen toiminta versio3 jarjestys] = d9.jarjestys
	  ,[Ammattiasema jarjestys] = d10.jarjestys

      


FROM [VipunenTK].[dbo].[f_3_1a_Oppisopimus_paaasiallinen_toiminta] f

	LEFT JOIN VipunenTK.dbo.d_oppisopimuskoulutus_osallistuneet_ja_tutk_suorittaneet d1
	on d1.id=f.oppisryh_id
 
	LEFT JOIN VipunenTK.dbo.d_sukupuoli d2
	on d2.id=f.sukupuoli_id

	LEFT JOIN VipunenTK.dbo.d_aidinkieli_versio1 d3
	on d3.id=f.aidinkieli_versio1_id

	LEFT JOIN VipunenTK.dbo.d_ika d4
	on d4.id=f.ika_id

	LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d5
	on d5.id=f.opetushallinnon_koulutusala_id

		LEFT JOIN VipunenTK.dbo.d_koulutusluokitus d6
	on d6.id=f.opetushallinnon_koulutusaste_id

	LEFT JOIN VipunenTK.dbo.d_ammatillisen_koulutuksen_koulutuslaji d7
	on d7.id=f.ammatillisen_koulutuksen_koulutuslaji_id

	LEFT JOIN VipunenTK.dbo.d_alueluokitus d8
	on d8.id=f.koulutuksen_sijaintimaakunta_id

		LEFT JOIN VipunenTK.dbo.d_paaasiallinen_toiminta d9
	on d9.id=f.paaasiallinen_toiminta_versio3_id

	LEFT JOIN VipunenTK.dbo.d_ammattiasema d10
	on d10.id=f.ammattiasema_id












' 
GO
/****** Object:  View [dbo].[v_f_tab_otv_esi_ja_perus]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_otv_esi_ja_perus]'))
EXEC dbo.sp_executesql @statement = N'










CREATE VIEW [dbo].[v_f_tab_otv_esi_ja_perus] AS

select --top 0
	[Tilastovuosi] = tilastointivuosi
	,[Sukupuoli] = case d1.sukupuoli when ''Mies'' then ''Pojat'' when ''Nainen'' then ''Tytöt'' else ''Tuntematon'' end
	,[Oppilaitoksen omistajatyyppi] = d2.oppilaitoksen_omistajatyyppi
	,[Oppilaitostyyppi] = d2.oppilaitostyyppi
	,[Oppilaitos] = d2.oppilaitos + '' ('' + d2.oppilaitoskoodi + '')''
	,[Oppilaitoksen AVI] = d3.avi
	,[Oppilaitoksen ELY] = d3.ely
	,[Oppilaitoksen maakunta] = d3.maakunta
	,[Oppilaitoksen seutukunta] = d3.seutukunta
	,[Oppilaitoksen sijaintikunnan kuntaryhmä] = d3.kuntaryhma
	,[Oppilaitoksen kunta] = d3.kunta
	,[Oppilaitoksen opetuskieli] = d2.opetuskieli
	,[Opetuksen järjestäjä] = coalesce(nullif(d2a.koulutuksen_jarjestaja,''''),d2.koulutuksen_jarjestaja)
	--Historia
	,[Oppilaitoksen omistajatyyppi _] = d2b.oppilaitoksen_omistajatyyppi
	,[Oppilaitostyyppi _] = d2b.oppilaitostyyppi
	,[Oppilaitos _] =  d2b.oppilaitos + '' ('' + d2b.oppilaitoskoodi + '')''
	,[Oppilaitoskoodi] = d2b.oppilaitoskoodi
	,[Oppilaitoksen opetuskieli _] = d2b.opetuskieli
	,[Koulutuksen järjestäjä _] = d2b.koulutuksen_jarjestaja
	,[Opetuksen järjestäjä _] = d2b.koulutuksen_jarjestaja


	--mittarit
	,[Esiopetuksen oppilaat] = sum(f.ove)
	,[1. luokan oppilaat] = sum(f.ov1)
	,[2. luokan oppilaat] = sum(f.ov2)
	,[3. luokan oppilaat] = sum(f.ov3)
	,[4. luokan oppilaat] = sum(f.ov4)
	,[5. luokan oppilaat] = sum(f.ov5)
	,[6. luokan oppilaat] = sum(f.ov6)
	,[7. luokan oppilaat] = sum(f.ov7)
	,[8. luokan oppilaat] = sum(f.ov8)
	,[9. luokan oppilaat] = sum(f.ov9)
	,[Lisäopetuksen oppilaat] = sum(f.ov10)
	,[1.-6. luokkien oppilaat] = sum(isnull(f.ov1,0))+sum(isnull(f.ov2,0))+sum(isnull(f.ov3,0))+sum(isnull(f.ov4,0))+sum(isnull(f.ov5,0))+sum(isnull(f.ov6,0))
	,[7.-9. luokkien oppilaat] = sum(isnull(f.ov7,0))+sum(isnull(f.ov8,0))+sum(isnull(f.ov9,0))
	,[Perusopetuksen suorittaneet] = sum(isnull(f.tod,0))+sum(isnull(f.tutkt,0))
	,[1. luokalle jääneet] = sum(f.luok1)
	,[2. luokalle jääneet] = sum(f.luok2)
	,[3. luokalle jääneet] = sum(f.luok3)
	,[4. luokalle jääneet] = sum(f.luok4)
	,[5. luokalle jääneet] = sum(f.luok5)
	,[6. luokalle jääneet] = sum(f.luok6)
	,[7. luokalle jääneet] = sum(f.luok7)
	,[8. luokalle jääneet] = sum(f.luok8)
	,[9. luokalle jääneet] = sum(f.luok9)

	--Ruotsi
	,[Statistikår] = tilastointivuosi
	,[Kön] = case d1.sukupuoli_SV when ''Man'' then ''Pojkar'' when ''Kvinna'' then ''Flickor'' else ''Okänd'' end
	,[Läroanstaltens ägartyp] = d2.oppilaitoksen_omistajatyyppi_SV
	,[Läroanstaltstyp] = d2.oppilaitostyyppi_SV
	,[Läroanstalt] = d2.oppilaitos_SV + '' ('' + d2.oppilaitoskoodi + '')''
	,[Läroanstaltens RFV-område] = d3.avi_SV
	,[Läroanstaltens NMT-område] = d3.ely_SV
	,[Läroanstaltens landskap] = d3.maakunta_SV
	,[Läroanstaltens ekonomisk region] = d3.seutukunta_SV
	,[Läroanstaltens kommungrupp] = d3.kuntaryhma_SV
	,[Läroanstaltens kommun] = d3.kunta_SV
	,[Läroanstaltens undervisningsspråk] = d2.opetuskieli_SV
	,[Utbildningsordnare] = d2.koulutuksen_jarjestaja_SV --Utbildningsanordnare
	--Historia
	,[Läroanstaltens ägartyp _] = d2b.oppilaitoksen_omistajatyyppi_SV
	,[Läroanstaltstyp _] = d2b.oppilaitostyyppi_SV
	,[Läroanstalt _] = d2b.oppilaitos_SV + '' ('' + d2b.oppilaitoskoodi + '')''
	,[Läroanstaltens undervisningsspråk _] = d2b.opetuskieli_SV
	,[Utbildningsordnare _] = d2b.koulutuksen_jarjestaja_SV
	,[Undervisningsanordnare _] = d2b.koulutuksen_jarjestaja_SV

	--Englanti
	,[Statistical year] = tilastointivuosi
	,[Gender] = case d1.sukupuoli_EN when ''Male'' then ''Boys'' when ''Female'' then ''Girls'' else ''Unknown'' end
	,[Type of institution owner] = d2.oppilaitoksen_omistajatyyppi_EN
	,[Type of institution] = d2.oppilaitostyyppi_EN
	,[Educational institution] = d2.oppilaitos_EN + '' ('' + d2.oppilaitoskoodi + '')''
	,[AVI area of the institution] = d3.avi_EN
	,[ELY area of the institution] = d3.ely_EN
	,[Region of the institution] = d3.maakunta_EN
	,[Subregion of the institution] = d3.seutukunta_EN
	,[Municipality group of the institution] = d3.kuntaryhma_EN
	,[Municipality of the institution] = d3.kunta_EN
	,[Language of the institution] = d2.opetuskieli_EN
	,[Education provider] = d2.koulutuksen_jarjestaja_EN
	--Historia
	,[Type of institution owner _] = d2b.oppilaitoksen_omistajatyyppi_EN
	,[Type of institution _] = d2b.oppilaitostyyppi_EN
	,[Educational institution _] = d2b.oppilaitos_EN + '' ('' + d2b.oppilaitoskoodi + '')''
	,[Language of the institution _] = d2b.opetuskieli_EN
	,[Education provider _] = d2b.koulutuksen_jarjestaja_EN

	--koodimuuttujat
	,[Koodit Oppilaitoksen maakunta] = d3.maakunta_koodi
	,[Koodit Oppilaitoksen kunta] = d3.kunta_koodi

	--järjestys
	,[Sukupuoli jarj] = d1.jarjestys
	,[Oppilaitoksen omistajatyyppi jarj] = d2.jarjestys_omistajatyyppi
	,[Oppilaitostyyppi jarj] = d2.jarjestys_oppilaitostyyppi
	,[Oppilaitoksen AVI jarj] = d3.jarjestys_avi
	,[Oppilaitoksen maakunta jarj] = d3.jarjestys_maakunta
	,[Oppilaitoksen opetuskieli jarj] = d2.jarjestys_opetuskieli
	--Historia
	,[Oppil. omistajatyyppi jarj] = d2b.jarjestys_omistajatyyppi
	,[Oppilaitoksen tyyppi jarj] = d2b.jarjestys_oppilaitostyyppi
	,[Oppil. maakunta jarj] = d3b.jarjestys_maakunta
	,[Oppil. opetuskieli jarj] = d2b.jarjestys_opetuskieli

from [dbo].[f_OTV_2_1_R2_22_Peruskoulutiedosto_Oppilaitostason_oppil_ja_opisk] f
left join VipunenTK.dbo.d_sukupuoli d1 on d1.id=f.sukupuoli_id
left join VipunenTK.dbo.d_oppilaitoksen_taustatiedot d2 on d2.id=f.oppilaitos_id
left join VipunenTK.dbo.d_oppilaitoksen_taustatiedot d2a on d2a.oppilaitos_avain=d2.koulutuksen_jarjestajan_korvaavakoodi
left join VipunenTK.dbo.d_oppilaitoksen_taustatiedot_historia d2b on d2b.id=f.oppilaitos_historia_id
left join VipunenTK.dbo.d_alueluokitus d3 on d3.id=f.oppilaitoksen_sijaintikunta_id
left join VipunenTK.dbo.d_alueluokitus_historia d3b on d3b.id=f.oppilaitoksen_sijaintikunta_historia_id
where f.oppilaitoksen_sijaintikunta<>200 and d1.sukupuoli<>''Tuntematon''

group by tilastointivuosi
	,d1.sukupuoli
	,d2.oppilaitoksen_omistajatyyppi
	,d2.oppilaitostyyppi
	,d2.oppilaitos
	,d3.avi
	,d3.maakunta
	,d3.kunta
	,d2.opetuskieli
	,d1.jarjestys
	,d2.jarjestys_omistajatyyppi
	,d2.jarjestys_oppilaitostyyppi
	,d3.jarjestys_avi
	,d3.jarjestys_maakunta
	,d2.jarjestys_opetuskieli
	,d1.sukupuoli_SV
	,d2.oppilaitoksen_omistajatyyppi_SV 
	,d2.oppilaitostyyppi_SV
	,d2.oppilaitos_SV
	,d3.avi_SV
	,d3.maakunta_SV
	,d3.kunta_SV
	,d2.opetuskieli_SV
	,d1.sukupuoli_EN
	,d2.oppilaitoksen_omistajatyyppi_EN
	,d2.oppilaitostyyppi_EN
	,d2.oppilaitos_EN
	,d3.avi_EN
	,d3.maakunta_EN
	,d3.kunta_EN
	,d2.opetuskieli_EN
	,d3.maakunta_koodi
	,d3.kunta_koodi
	,d3.ely
	,d3.seutukunta
	,d3.kuntaryhma
	,d3.ely_SV
	,d3.seutukunta_SV
	,d3.kuntaryhma_SV
	,d3.ely_EN
	,d3.seutukunta_EN
	,d3.kuntaryhma_EN
	,d2.koulutuksen_jarjestaja
	,d2.koulutuksen_jarjestaja_SV
	,d2.koulutuksen_jarjestaja_EN
	,d2b.oppilaitoksen_omistajatyyppi_SV
	,d2b.oppilaitostyyppi_SV
	,d2b.oppilaitos_SV
	,d3b.avi_SV
	,d3b.ely_SV
	,d3b.maakunta_SV
	,d3b.seutukunta_SV
	,d3b.kuntaryhma_SV
	,d3b.kunta_SV
	,d2b.opetuskieli_SV
	,d2b.koulutuksen_jarjestaja_SV
	,d2b.oppilaitoksen_omistajatyyppi_EN
	,d2b.oppilaitostyyppi_EN
	,d2b.oppilaitos_EN
	,d3b.avi_EN
	,d3b.ely_EN
	,d3b.maakunta_EN
	,d3b.seutukunta_EN
	,d3b.kuntaryhma_EN
	,d3b.kunta_EN
	,d2b.opetuskieli_EN
	,d2b.koulutuksen_jarjestaja_EN
	,d2b.oppilaitoksen_omistajatyyppi
	,d2b.oppilaitostyyppi
	,d2b.oppilaitos
	,d2b.oppilaitoskoodi
	,d2b.opetuskieli
	,d2b.koulutuksen_jarjestaja
	,d2b.jarjestys_omistajatyyppi
	,d2b.jarjestys_oppilaitostyyppi
	,d3b.jarjestys_maakunta
	,d2b.jarjestys_opetuskieli
	,d2a.koulutuksen_jarjestaja
	,d2.oppilaitoskoodi

having sum(f.ove)>0 
	or sum(f.ov1)>0
	or sum(f.ov2)>0
	or sum(f.ov3)>0
	or sum(f.ov4)>0
	or sum(f.ov5)>0
	or sum(f.ov6)>0
	or sum(f.ov7)>0
	or sum(f.ov8)>0
	or sum(f.ov9)>0
	or sum(f.ov10)>0
	or sum(f.tod)>0
	or sum(f.tutkt)>0
	or sum(f.luok1)>0
	or sum(f.luok2)>0
	or sum(f.luok3)>0
	or sum(f.luok4)>0
	or sum(f.luok5)>0
	or sum(f.luok6)>0
	or sum(f.luok7)>0
	or sum(f.luok8)>0
	or sum(f.luok9)>0













' 
GO
/****** Object:  View [dbo].[v_f_tab_otv_esi_ja_perus_ulkomaat]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_otv_esi_ja_perus_ulkomaat]'))
EXEC dbo.sp_executesql @statement = N'







CREATE VIEW [dbo].[v_f_tab_otv_esi_ja_perus_ulkomaat] AS

select
	[Tilastovuosi] = tilastointivuosi
	,[Sukupuoli] = case d1.sukupuoli when ''Mies'' then ''Pojat'' when ''Nainen'' then ''Tytöt'' else ''Tuntematon'' end
	,[Oppilaitoksen omistajatyyppi] = d2.oppilaitoksen_omistajatyyppi
	,[Oppilaitostyyppi] = d2.oppilaitostyyppi
	,[Oppilaitos] = d2.oppilaitos
	,[Oppilaitoksen AVI] = d3.avi
	,[Oppilaitoksen ELY] = d3.ely
	,[Oppilaitoksen maakunta] = d3.maakunta
	,[Oppilaitoksen seutukunta] = d3.seutukunta
	,[Oppilaitoksen sijaintikunnan kuntaryhmä] = d3.kuntaryhma
	,[Oppilaitoksen kunta] = d3.kunta
	,[Oppilaitoksen opetuskieli] = d2.opetuskieli
	,[Opetuksen järjestäjä] = d2.koulutuksen_jarjestaja
	--Historia
	,[Oppilaitoksen omistajatyyppi _] = d2b.oppilaitoksen_omistajatyyppi
	,[Oppilaitostyyppi _] = d2b.oppilaitostyyppi
	,[Oppilaitos _] =  d2b.oppilaitos
	,[Oppilaitoskoodi] = d2b.oppilaitoskoodi
	,[Oppilaitoksen opetuskieli _] = d2b.opetuskieli
	,[Koulutuksen järjestäjä _] = d2b.koulutuksen_jarjestaja
	,[Opetuksen järjestäjä _] = d2b.koulutuksen_jarjestaja


	--mittarit
	,[Esiopetuksen oppilaat] = sum(f.ove)
	,[1. luokan oppilaat] = sum(f.ov1)
	,[2. luokan oppilaat] = sum(f.ov2)
	,[3. luokan oppilaat] = sum(f.ov3)
	,[4. luokan oppilaat] = sum(f.ov4)
	,[5. luokan oppilaat] = sum(f.ov5)
	,[6. luokan oppilaat] = sum(f.ov6)
	,[7. luokan oppilaat] = sum(f.ov7)
	,[8. luokan oppilaat] = sum(f.ov8)
	,[9. luokan oppilaat] = sum(f.ov9)
	,[Lisäopetuksen oppilaat] = sum(f.ov10)
	,[1.-6. luokkien oppilaat] = sum(isnull(f.ov1,0))+sum(isnull(f.ov2,0))+sum(isnull(f.ov3,0))+sum(isnull(f.ov4,0))+sum(isnull(f.ov5,0))+sum(isnull(f.ov6,0))
	,[7.-9. luokkien oppilaat] = sum(isnull(f.ov7,0))+sum(isnull(f.ov8,0))+sum(isnull(f.ov9,0))
	,[Perusopetuksen suorittaneet] = sum(isnull(f.tod,0))+sum(isnull(f.tutkt,0))

	--Ruotsi
	,[Statistikår] = tilastointivuosi
	,[Kön] = case d1.sukupuoli_SV when ''Man'' then ''Pojkar'' when ''Kvinna'' then ''Flickor'' else ''Okänd'' end
	,[Läroanstaltens ägartyp] = d2.oppilaitoksen_omistajatyyppi_SV
	,[Läroanstaltstyp] = d2.oppilaitostyyppi_SV
	,[Läroanstalt] = d2.oppilaitos_SV
	,[Läroanstaltens RFV-område] = d3.avi_SV
	,[Läroanstaltens NMT-område] = d3.ely_SV
	,[Läroanstaltens landskap] = d3.maakunta_SV
	,[Läroanstaltens ekonomisk region] = d3.seutukunta_SV
	,[Läroanstaltens kommungrupp] = d3.kuntaryhma_SV
	,[Läroanstaltens kommun] = d3.kunta_SV
	,[Läroanstaltens undervisningsspråk] = d2.opetuskieli_SV
	,[Utbildningsanordnare] = d2.koulutuksen_jarjestaja_SV --Utbildningsanordnare
	--Historia
	,[Läroanstaltens ägartyp _] = d2b.oppilaitoksen_omistajatyyppi_SV
	,[Läroanstaltstyp _] = d2b.oppilaitostyyppi_SV
	,[Läroanstalt _] = d2b.oppilaitos_SV
	,[Läroanstaltens undervisningsspråk _] = d2b.opetuskieli_SV
	,[Utbildningsanordnare _] = d2b.koulutuksen_jarjestaja_SV
	,[Undervisningsanordnare _] = d2b.koulutuksen_jarjestaja_SV

	--Englanti
	,[Statistical year] = tilastointivuosi
	,[Gender] = case d1.sukupuoli_EN when ''Male'' then ''Boys'' when ''Female'' then ''Girls'' else ''Unknown'' end
	,[Type of institution owner] = d2.oppilaitoksen_omistajatyyppi_EN
	,[Type of institution] = d2.oppilaitostyyppi_EN
	,[Educational institution] = d2.oppilaitos_EN
	,[AVI area of the institution] = d3.avi_EN
	,[ELY area of the institution] = d3.ely_EN
	,[Region of the institution] = d3.maakunta_EN
	,[Subregion of the institution] = d3.seutukunta_EN
	,[Municipality group of the institution] = d3.kuntaryhma_EN
	,[Municipality of the institution] = d3.kunta_EN
	,[Language of the institution] = d2.opetuskieli_EN
	,[Education provider] = d2.koulutuksen_jarjestaja_EN
	--Historia
	,[Type of institution owner _] = d2b.oppilaitoksen_omistajatyyppi_EN
	,[Type of institution _] = d2b.oppilaitostyyppi_EN
	,[Educational institution _] = d2b.oppilaitos_EN
	,[Language of the institution _] = d2b.opetuskieli_EN
	,[Education provider _] = d2b.koulutuksen_jarjestaja_EN

	--koodimuuttujat
	,[Koodit Oppilaitoksen maakunta] = d3.maakunta_koodi
	,[Koodit Oppilaitoksen kunta] = d3.kunta_koodi

	--järjestys
	,[Sukupuoli jarj] = d1.jarjestys
	,[Oppilaitoksen omistajatyyppi jarj] = d2.jarjestys_omistajatyyppi
	,[Oppilaitostyyppi jarj] = d2.jarjestys_oppilaitostyyppi
	,[Oppilaitoksen AVI jarj] = d3.jarjestys_avi
	,[Oppilaitoksen maakunta jarj] = d3.jarjestys_maakunta
	,[Oppilaitoksen opetuskieli jarj] = d2.jarjestys_opetuskieli
	--Historia
	,[Oppil. omistajatyyppi jarj] = d2b.jarjestys_omistajatyyppi
	,[Oppilaitoksen tyyppi jarj] = d2b.jarjestys_oppilaitostyyppi
	,[Oppil. maakunta jarj] = d3b.jarjestys_maakunta
	,[Oppil. opetuskieli jarj] = d2b.jarjestys_opetuskieli

from [dbo].[f_OTV_2_1_R2_22_Peruskoulutiedosto_Oppilaitostason_oppil_ja_opisk] f
left join VipunenTK.dbo.d_sukupuoli d1 on d1.id=f.sukupuoli_id
left join VipunenTK.dbo.d_oppilaitoksen_taustatiedot d2 on d2.id=f.oppilaitos_id
left join VipunenTK.dbo.d_oppilaitoksen_taustatiedot_historia d2b on d2b.id=f.oppilaitos_historia_id
left join VipunenTK.dbo.d_alueluokitus d3 on d3.id=f.oppilaitoksen_sijaintikunta_id
left join VipunenTK.dbo.d_alueluokitus_historia d3b on d3b.id=f.oppilaitoksen_sijaintikunta_historia_id
where f.oppilaitoksen_sijaintikunta=200 and d1.sukupuoli<>''Tuntematon''

group by tilastointivuosi
	,d1.sukupuoli
	,d2.oppilaitoksen_omistajatyyppi
	,d2.oppilaitostyyppi
	,d2.oppilaitos
	,d3.avi
	,d3.maakunta
	,d3.kunta
	,d2.opetuskieli
	,d1.jarjestys
	,d2.jarjestys_omistajatyyppi
	,d2.jarjestys_oppilaitostyyppi
	,d3.jarjestys_avi
	,d3.jarjestys_maakunta
	,d2.jarjestys_opetuskieli
	,d1.sukupuoli_SV
	,d2.oppilaitoksen_omistajatyyppi_SV 
	,d2.oppilaitostyyppi_SV
	,d2.oppilaitos_SV
	,d3.avi_SV
	,d3.maakunta_SV
	,d3.kunta_SV
	,d2.opetuskieli_SV
	,d1.sukupuoli_EN
	,d2.oppilaitoksen_omistajatyyppi_EN
	,d2.oppilaitostyyppi_EN
	,d2.oppilaitos_EN
	,d3.avi_EN
	,d3.maakunta_EN
	,d3.kunta_EN
	,d2.opetuskieli_EN
	,d3.maakunta_koodi
	,d3.kunta_koodi
	,d3.ely
	,d3.seutukunta
	,d3.kuntaryhma
	,d3.ely_SV
	,d3.seutukunta_SV
	,d3.kuntaryhma_SV
	,d3.ely_EN
	,d3.seutukunta_EN
	,d3.kuntaryhma_EN
	,d2.koulutuksen_jarjestaja
	,d2.koulutuksen_jarjestaja_SV
	,d2.koulutuksen_jarjestaja_EN
	,d2b.oppilaitoksen_omistajatyyppi_SV
	,d2b.oppilaitostyyppi_SV
	,d2b.oppilaitos_SV
	,d3b.avi_SV
	,d3b.ely_SV
	,d3b.maakunta_SV
	,d3b.seutukunta_SV
	,d3b.kuntaryhma_SV
	,d3b.kunta_SV
	,d2b.opetuskieli_SV
	,d2b.koulutuksen_jarjestaja_SV
	,d2b.oppilaitoksen_omistajatyyppi_EN
	,d2b.oppilaitostyyppi_EN
	,d2b.oppilaitos_EN
	,d3b.avi_EN
	,d3b.ely_EN
	,d3b.maakunta_EN
	,d3b.seutukunta_EN
	,d3b.kuntaryhma_EN
	,d3b.kunta_EN
	,d2b.opetuskieli_EN
	,d2b.koulutuksen_jarjestaja_EN
	,d2b.oppilaitoksen_omistajatyyppi
	,d2b.oppilaitostyyppi
	,d2b.oppilaitos
	,d2b.oppilaitoskoodi
	,d2b.opetuskieli
	,d2b.koulutuksen_jarjestaja
	,d2b.jarjestys_omistajatyyppi
	,d2b.jarjestys_oppilaitostyyppi
	,d3b.jarjestys_maakunta
	,d2b.jarjestys_opetuskieli

having sum(f.ove)>0 
	or sum(f.ov1)>0
	or sum(f.ov2)>0
	or sum(f.ov3)>0
	or sum(f.ov4)>0
	or sum(f.ov5)>0
	or sum(f.ov6)>0
	or sum(f.ov7)>0
	or sum(f.ov8)>0
	or sum(f.ov9)>0
	or sum(f.ov10)>0
	or sum(f.tod)>0
	or sum(f.tutkt)>0










' 
GO
/****** Object:  View [dbo].[v_f_tab_otv_korkeakoulut_amk]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_otv_korkeakoulut_amk]'))
EXEC dbo.sp_executesql @statement = N'









CREATE VIEW [dbo].[v_f_tab_otv_korkeakoulut_amk] AS

Select
[Tilastovuosi]
,Opiskeluvuosi = 
	CASE
		WHEN d23.kausi_id = -1 THEN d23.vuosiselite
		ELSE CAST(CAST(Tilastovuosi as int) - CAST(d23.vuosiselite as int) AS varchar(10))
	END
,jarj_opiskeluvuosi = 
	CASE
		WHEN d23.kausi_id = -1 THEN 999
		ELSE CAST(Tilastovuosi as int) - CAST(d23.vuosiselite as int)
	END
,d1.aineisto as Aineisto
,d1b.aineisto as Aineisto_OTV
,d1b.kaikkien_asteiden_koulutus as ''Kaikkien asteiden koulutus''
,d1b.tilastointivuosi as OTV_Tilv
,d2.aidinkieli_versio1 as Äidinkieli
,d2b.aidinkieli_versio2 as "Äidinkieli (väestörakenne)"
--luodaan yhdistetty äidinkieli-muuttuja, joka toimii aineistojen 2.8, 2.9, ja 4.9 välillä
,CASE WHEN d2.aidinkieli_versio1_koodi = ''fs'' Or d2b.aidinkieli_versio2_koodi = ''fi'' Or d2b.aidinkieli_versio2_koodi = ''se'' THEN
''suomi (sis. saame)'' When d2.aidinkieli_versio1_koodi = ''sv'' Or d2b.aidinkieli_versio2_koodi = ''sv'' THEN ''ruotsi''
 When d2.aidinkieli_versio1_koodi = ''99'' Or d2b.aidinkieli_versio2_koodi = ''99'' THEN ''muut kielet ja tuntematon'' Else ''Tuntematon'' End AS ''Äidinkieli (suomi/muu)''
--
,d3.avi as "Asuinalueen AVI"
,d3.ely as "Asuinalueen ELY"
,d3.kielisuhde as "Asuinkunnan kielisuhde"
,d3.maakunta as Asuinmaakunta
,d3.kunta as Asuinkunta
,d3b.avi as "Til.v:tta edeltävä AVI"
,d3b.ely as "Til.v:tta edeltävä ELY"
,d3b.kielisuhde as "Til.v:tta ed. asuinkunnan kielisuhde"
,d3b.maakunta as "Til.v:tta ed. asuinmaakunta"
,d3b.kunta as "Til.v:tta ed. asuinkunta"
,d3c.avi as "2v til.v:tta ed. AVI"
,d3c.ely as "2v til.v:tta ed. ELY"
,d3c.kielisuhde as "2v til.v:tta ed. asuinkunnan kielisuhde"
,d3c.maakunta as "2v til.v:tta ed. asuinmaakunta"
,d3c.kunta as "2v til.v:tta ed. asuinkunta"
,d4.sukupuoli as Sukupuoli
,d5.ika as Ikä
,d5.ika5v as Ikäryhmä
,d5b.vuosiselite as Syntymävuosi
--,d5c.kuukausiselite as Syntymäkuukausi
,d6a.tutkinto_amk as "Tutkinto (amk)"
,d7.koulutustyyppi as Koulutustyyppi
,d8.kansalaisuus_versio2 as Kansalaisuus
,d8b.kansalaisuus_versio1 as "Kansalaisuus (väestörakenne)"
--luodaan yhdistetty kansalaisuus-muuttuja, joka toimii aineistojen 2.8, 2.9, ja 4.9 välillä
,CASE WHEN d8.kansalaisuus_versio2_koodi = ''1'' Or d8b.kansalaisuus_versio1_koodi = ''1'' THEN
''suomi'' When d8.kansalaisuus_versio2_koodi = ''2'' Or d8.kansalaisuus_versio2_koodi = ''9'' Or d8b.kansalaisuus_versio1_koodi = ''2'' THEN ''muu''
 Else ''Tuntematon'' End AS ''Kansalaisuus (suomi/muu)''
--
,case f.oppilaitos 
	when ''02543'' then ''Pohjois-Pirkanmaan koulutusinstituutti'' 
	when ''02390'' then ''Pirkanmaan hotelli- ja ravintolaoppilaitos'' 
	when ''01088'' then ''Pirkanmaan ammattioppilaitos'' 
	else d9.oppilaitos end 
as Ammattikorkeakoulu
,d9.opetuskieli as Opetuskieli
,d9.oppilaitoksen_omistajatyyppi as "Oppil. omistajatyyppi"
,d9.oppilaitostyyppi as Oppilaitostyyppi
,case when d9.oppilaitostyyppikoodi <> ''41'' then ''Muu'' else ''Ammattikorkeakoulu'' end as ''Oppilaitoksen aste''
,d9b.koulutuksen_jarjestaja as "Koulutuksen järjestäjä"
,d9b.koulutuksen_jarjestajan_omistajatyyppi as "Koul. järj. omistajatyyppi"
,d10.lahde as Lähde
,d11.koulutusohjelma_amk as Koulutusohjelma
,d12.opiskelijan_olo as "Kirjoillaolo (syys)"
,d12b.opiskelijan_olo_tamm as "Kirjoillaolo (tammi)"
,d13.rahoituslahde as Rahoituslähde
,d15.suuntautumisvaihtoehto_amk as Suuntautumisvaihtoehto
,d16.kieli as "Koulutuksen kieli"
,d17.ensisijainen_opintooikeus as "Ensisijainen opinto-oikeus"
,d18.tilauskoulutuksen_sijaintimaa as "Tilauskoulutuksen sijaintimaa"
,d19.koulutussektori as Koulutussektori
,d20.opetushallinnon_koulutus as Hallinnonala
,d21.koulutusaste2002 as "Koulutusaste (2002)"
,d21.koulutusala2002 as "Koulutusala (2002)"
,d21.opintoala1995 as "Koulutusala (1995)"
,d21.opintoala2002 as "Opintoala (2002)"
,d21.koulutus as Koulutusnimike
,d21b.koulutuslaji_okm as Koulutuslaji
,d21b.koulutuslaji_okm2 as Koulutuslaji2
,d22.avi as "Koulutuksen AVI"
,d22.ely as "Koulutuksen ELY"
,d22.maakunta as "Koulutuksen maakunta"
,d22.kielisuhde as "Koul. kunnan kielisuhde"
,d22.kunta as "Koulutuksen kunta"
--luodaan yhdistetyt kunta-muuttujat, jotka toimivat aineistojen 2.8, 2.9, ja 4.9 välillä
,CASE WHEN d1b.aineisto_koodi <> ''4.9'' And d1b.aineisto_koodi <> ''3.4'' THEN
d22.maakunta When d1b.aineisto_koodi = ''4.9'' THEN d3.maakunta
 Else ''Tuntematon'' End AS ''Maakunta''
,CASE WHEN d1b.aineisto_koodi <> ''4.9'' And d1b.aineisto_koodi <> ''3.4'' THEN
d22.kunta When d1b.aineisto_koodi = ''4.9'' THEN d3.kunta
 Else ''Tuntematon'' End AS ''Kunta''
--
,d22b.avi as "Koul. järjestäjän AVI"
,d22b.ely as "Koul. järjestäjän ELY"
,d22b.maakunta as "Koul. järjestäjän maakunta"
,d22b.kielisuhde as "Koul. järj. kunnan kielisuhde"
,d22b.kunta as "Koul. järjestäjän kunta"
,d22c.avi as "Oppilaitoksen AVI"
,d22c.ely as "Oppilaitoksen ELY"
,d22c.maakunta as "Oppilaitoksen maakunta"
,d22c.kielisuhde as "Oppil. kunnan kielisuhde"
,d22c.kunta as "Oppilaitoksen kunta"
,d23.vuosiselite as "Kirjoihintulovuosi"
,d23b.lukukausiselite as "Kirjoihintulokausi"
,d24b.vuosiselite as "Kirjoihintulovuosi (kk-sek.)"
,d24c.vuosiselite as "Kirjoihintulovuosi (kk-sek. läsna)"
,d24d.vuosiselite as "Kirjoihintulovuosi (sek.)"
,d24e.vuosiselite as "Kirjoihintulovuosi (sek. läsnä)"
,d24f.vuosiselite as "Kirjoihintulovuosi (kk)"
,d24f2.lukukausiselite as "Kirjoihintulokausi (kk)"
,d24g.vuosiselite as "Kirjoihintulovuosi (kk läsnä)"
,d24h.vuosiselite as "Kirjoihintulovuosi (op.ala)"
,d24i.vuosiselite as "Kirjoihintulovuosi (op.ala läsnä)"
,d24j.vuosiselite as "Kirjoihintulovuosi (tutk.)"
,d24k.lukukausiselite as "Kirjoihintulokausi (tutk.)"
,d28.vahintaan_55_op_suorittanut as "Suorittanut väh. 55 op"
,d29.opiskelijan_fte_tieto as "Opiskelijan FTE-tieto"
--,d30.opiskelumuoto as Opiskelumuoto
,d31.yliopisto as Yliopistotunnus
,d32.tiedekunta_yo as Tiedekunta
,d33.uusi_vanha_opiskelija as "Uusi/vanha opiskelija"
,d35.opettajankelpoisuus as Opettajankelpoisuus
,d36.avoinvayla as "Hyväksytty avoimen yliop. suoritusten kautta"
,d37.vuosiselite as "Tutkinnon suoritusvuosi"
,d38.lukukausiselite as "Tutk. suorituslukukausi"
,d39.kuukausiselite as "Tutk. suorituskuukausi"
,d40.maanosa as "Kansalaisuus (maanosa)"
,d41.eumaa as "EU-maan kansalainen"
,d42.etamaa as "ETA-maan kansalainen"
,d43.pohjoismaa as "Pohjoismaan kansalainen"
--jarjestysmuuttujat
,d1b.jarjestys as aineisto_otv_jarj
,d2.jarjestys as jarj_aidinkieli
,d2b.jarjestys as jarj_aidinkieli2
--yhdistetyn muuttujan järjestys
,CASE WHEN d2.aidinkieli_versio1_koodi = ''fs'' Or d2b.aidinkieli_versio2_koodi = ''fi'' Or d2b.aidinkieli_versio2_koodi = ''se'' THEN
''1'' When d2.aidinkieli_versio1_koodi = ''sv'' Or d2b.aidinkieli_versio2_koodi = ''sv'' THEN ''2''
 When d2.aidinkieli_versio1_koodi = ''99'' Or d2b.aidinkieli_versio2_koodi = ''99'' THEN ''3'' Else ''4'' End AS ''jarj_aidinkieli3''
--
,d3.jarjestys_avi as jarj_as_avi
,d3.jarjestys_ely as jarj_as_ely
,d3.jarjestys_kielisuhde as jarj_as_kielisuhde
,d3.jarjestys_maakunta as jarj_as_maakunta
,d3.jarjestys as jarj_as_kunta
,d3b.jarjestys_avi as jarj_as_avi1x
,d3b.jarjestys_ely as jarj_as_ely1x
,d3b.jarjestys_kielisuhde as jarj_as_kielisuhde1x
,d3b.jarjestys_maakunta as jarj_as_maakunta1x
,d3b.jarjestys as jarj_as_kunta1x
,d3c.jarjestys_avi as jarj_as_avi2x
,d3c.jarjestys_ely as jarj_as_ely2x
,d3c.jarjestys_kielisuhde as jarj_as_kielisuhde2x
,d3c.jarjestys_maakunta as jarj_as_maakunta2x
,d3c.jarjestys as jarj_as_kunta2x
,d5.jarjestys_ika
,d5.jarjestys_ika5v as jarj_ika5v
,d5b.jarjestys as jarj_syntv
,d6a.jarjestys as jarj_tutk_amk
,d6b.jarjestys as jarj_tutk_yo
,d7.jarjestys as jarj_koultyyppi
,d8.jarjestys as jarj_kansalaisuus
,d8b.jarjestys as jarj_kansalaisuus2
--yhdistetyn muuttujan järjestys
,CASE WHEN d8.kansalaisuus_versio2_koodi = ''1'' Or d8b.kansalaisuus_versio1_koodi = ''1'' THEN
''1'' When d8.kansalaisuus_versio2_koodi = ''2'' Or d8.kansalaisuus_versio2_koodi = ''9'' Or d8b.kansalaisuus_versio1_koodi = ''2'' THEN ''2''
 Else ''99'' End AS ''jarj_kansalaisuus3''
--
,d9.jarjestys_oppilaitos
,d9.jarjestys_opetuskieli
,d9.jarjestys_omistajatyyppi
,d9.jarjestys_oppilaitostyyppi
,d11.jarjestys as jarj_koulohjelma_amk
,d12.jarjestys as jarj_kirjolosyys
,d12b.jarjestys as jarj_kirjolotammi
,d13.jarjestys as jarj_rahoitus
,d15.jarjestys as jarj_suunnvaiht
,d16.jarjestys as jarj_koulkiel
,d16.jarjestys_iso3kirjainta as jarj_koulkiel2
,d17.jarjestys as jarj_ensop
,d18.jarjestys as jarj_tilauskoul
,d19.jarjestys as jarj_koulsek
,d20.jarjestys as jarj_hallinnonala
,d21.jarjestys_koulutusaste2002
,d21.jarjestys_koulutusala2002
,d21.jarjestys_opintoala1995
,d21.jarjestys_opintoala2002
,d21.jarjestys as jarj_koulnimike
,d21b.jarjestys as jarj_koullaji
,d21b.jarjestys2 as jarj_koullaji2
,d22.jarjestys_avi
,d22.jarjestys_ely
,d22.jarjestys_maakunta
,d22.jarjestys_kielisuhde
,d22.jarjestys as jarj_kunta
--yhdistetyn muuttujan järjestys
,CASE WHEN d1b.aineisto_koodi <> ''4.9'' And d1b.aineisto_koodi <> ''3.4'' THEN
d22.jarjestys_maakunta When d1b.aineisto_koodi = ''4.9'' THEN d3.jarjestys_maakunta
 Else ''99'' End AS ''jarj_kmaakunta2''
,CASE WHEN d1b.aineisto_koodi <> ''4.9'' And d1b.aineisto_koodi <> ''3.4'' THEN
d22.jarjestys When d1b.aineisto_koodi = ''4.9'' THEN d3.jarjestys
 Else ''Tuntematon'' End AS ''jarj_kkunta2''
--
,d22b.jarjestys_avi as jarjestys_avi2
,d22b.jarjestys_ely as jarjestys_ely2
,d22b.jarjestys_maakunta as jarjestys_maakunta2
,d22b.jarjestys_kielisuhde as jarjestys_kielisuhde2
,d22b.jarjestys as jarj_kunta2
,d22c.jarjestys_avi as jarjestys_avi3
,d22c.jarjestys_ely as jarjestys_ely3
,d22c.jarjestys_maakunta as jarjestys_maakunta3
,d22c.jarjestys_kielisuhde as jarjestys_kielisuhde3
,d22c.jarjestys as jarj_kunta3
,d23b.jarjestys as jarj_lukukausi
,d24f2.jarjestys as jarj_lukukausi_kk
,d28.jarjestys as jarj_vah55
,d29.jarjestys as jarj_op_fte
--,d30.jarjestys as jarj_opmuoto
,d32.jarjestys as jarj_tiedekunta
,d33.jarjestys as jarj_uusivanha
,d35.jarjestys as jarj_opettajankelpoisuus
,d36.jarjestys as jarj_avoinvayla
,d39.jarjestys as jarj_suor_kk
,d40.jarjestys_maanosa as jarj_kans_maanosa
,d41.jarjestys_eumaa
,d42.jarjestys_etamaa
,d43.jarjestys as jarj_pohj_kans
--Koodimuuttujat
,d1.aineisto_koodi
,d1b.aineisto_koodi as ainesto_koodi_otv
,d2.aidinkieli_versio1_koodi as aidinkieli_koodi
,d2b.aidinkieli_versio2_koodi as aidinkieli2_koodi
--yhdistetyn muuttujan koodi
,CASE WHEN d2.aidinkieli_versio1_koodi = ''fs'' Or d2b.aidinkieli_versio2_koodi = ''fi'' Or d2b.aidinkieli_versio2_koodi = ''se'' THEN
''fs'' When d2.aidinkieli_versio1_koodi = ''sv'' Or d2b.aidinkieli_versio2_koodi = ''sv'' THEN ''sv''
 When d2.aidinkieli_versio1_koodi = ''99'' Or d2b.aidinkieli_versio2_koodi = ''99'' THEN ''99'' Else ''999'' End AS ''aidinkieli3_koodi''
--
,d3.maakunta_koodi as ''Koodit Asuinmaakunta''
,d3.kunta_koodi as ''Koodit Asuinkunta''
,d3b.maakunta_koodi as asmaak1xmk
,d3b.kunta_koodi as asmaak1xk
--,d5c.kuukausi as syntk
,d6a.tutkinto_amk_koodi as ''Koodit Tutkinto (amk)''
,d7.koulutustyyppi_koodi as ''Koodit Koulutustyyppi''
,d8.kansalaisuus_versio2_koodi as kansalaisuus_koodi
,d8b.kansalaisuus_versio1_koodi as kansalaisuus2_koodi
--yhdistetyn muuttujan koodi
,CASE WHEN d8.kansalaisuus_versio2_koodi = ''1'' Or d8b.kansalaisuus_versio1_koodi = ''1'' THEN
''1'' When d8.kansalaisuus_versio2_koodi = ''2'' Or d8.kansalaisuus_versio2_koodi = ''9'' Or d8b.kansalaisuus_versio1_koodi = ''2'' THEN ''2''
 Else ''-1'' End AS ''kansalaisuus3_koodi''
--
,case when coalesce(d9.oppilaitoksen_korvaavakoodi,d9.oppilaitoskoodi)=-1 then f.oppilaitos else coalesce(d9.oppilaitoksen_korvaavakoodi,d9.oppilaitoskoodi) end as ''Koodit Oppilaitos''
,d9b.koulutuksen_jarjestajakoodi as ''Koodit Koulutuksen järjestäjä''
,d10.lahde_koodi
,d11.koulutusohjelma_amk_koodi as ''Koodit Koulutusohjelma''
,d12.opiskelijan_olo_koodi as kirjoillaolosyys_koodi
,d12b.opiskelijan_olo_tamm_koodi as kirjoillaolotammi_koodi
,d17.ensisijainen_opintooikeus_koodi as ensiop
,d21.koulutusaste2002_koodi as ''Koodit Koulutusaste 2002''
,d21.koulutusala2002_koodi as ''Koodit Koulutusala 2002''
,d21.opintoala1995_koodi as ''Koodit Koulutusala 1995''
,d21.opintoala2002_koodi as ''Koodit Opintoala 2002''
,d21.koulutus_koodi as ''Koodit Koulutusnimike''
,d22.maakunta_koodi as ''Koodit Koulutuksen maakunta''
,d22.kunta_koodi as ''Koodit Koulutuksen kunta''
--yhdistetyn muuttujan koodi
,CASE WHEN d1b.aineisto_koodi <> ''4.9'' And d1b.aineisto_koodi <> ''3.4'' THEN
d22.maakunta_koodi When d1b.aineisto_koodi = ''4.9'' THEN d3.maakunta_koodi
 Else ''99'' End AS ''Koodit Maakunta''
,CASE WHEN d1b.aineisto_koodi <> ''4.9'' And d1b.aineisto_koodi <> ''3.4'' THEN
d22.kunta_koodi When d1b.aineisto_koodi = ''4.9'' THEN d3.kunta_koodi
 Else ''Tuntematon'' End AS ''Koodit Kunta''
--
,d22b.maakunta_koodi as ''Koodit Koul. järj. maakunta''
,d22b.kunta_koodi as ''Koodit Koul. järj. kunta''
,d22c.maakunta_koodi as ''Koodit Oppil. maakunta''
,d22c.kunta_koodi as ''Koodit Oppil. kunta''
,d23.vuosi as alvv
,d23b.lukukausi as alkk
,d24b.vuosi as alvv_kksek
,d24c.vuosi as alvv_kksek_lasna
,d24d.vuosi as alvv_sek
,d24e.vuosi as alvv_sek_lasna
,d24f.vuosi as alvv_kk
,d24f2.lukukausi as alkk_kk
,d24g.vuosi as alvv_kk_lasna
,d24h.vuosi as alvv_opa
,d24i.vuosi as alvv_opa_lasna
,d24j.vuosi as kirtu1v
,d24k.lukukausi as kirtu1k
,d28.vahintaan_55_op_suorittanut_koodi as op55_koodi
,d37.vuosi as suorv
,d38.lukukausi as suor_lk
,d39.kuukausi as suor_kk
--ruotsi

,[Tilastovuosi] as Statistikår
,Studieår = 
	CASE
		WHEN d23.kausi_id = -1 THEN d23.vuosiselite_SV
		ELSE CAST(CAST(Tilastovuosi as int) - CAST(d23.vuosiselite as int) AS varchar(10))
	END
,d2.aidinkieli_versio1_SV as Modersmål
,d2b.aidinkieli_versio2_SV as "Modersmål (utbildningsstruktur)"
--luodaan yhdistetty äidinkieli-muuttuja, joka toimii aineistojen 2.8, 2.9, ja 4.9 välillä
,CASE WHEN d2.aidinkieli_versio1_koodi = ''fs'' Or d2b.aidinkieli_versio2_koodi = ''fi'' Or d2b.aidinkieli_versio2_koodi = ''se'' THEN
''finska (inn. samiska)'' When d2.aidinkieli_versio1_koodi = ''sv'' Or d2b.aidinkieli_versio2_koodi = ''sv'' THEN ''svenska''
 When d2.aidinkieli_versio1_koodi = ''99'' Or d2b.aidinkieli_versio2_koodi = ''99'' THEN ''andra språk och okänd'' Else ''Okänd'' End as ''Modersmål (finska/andra)SV''
--
--,d3.avi_SV as "Asuinalueen AVISV"
--,d3.ely_SV as "Asuinalueen ELYSV"
--,d3.kielisuhde_SV as "Asuinkunnan kielisuhdeSV"
,d3.maakunta_SV as Bostadslandskap
,d3.kunta_SV as Bostadskommun
--,d3b.avi_SV as "Til.v:tta edeltävä AVISV"
--,d3b.ely_SV as "Til.v:tta edeltävä ELYSV"
--,d3b.kielisuhde_SV as "Til.v:tta ed. asuinkunnan kielisuhdeSV"
--,d3b.maakunta_SV as "Til.v:tta ed. asuinmaakuntaSV"
--,d3b.kunta_SV as "Til.v:tta ed. asuinkuntaSV"
--,d3c.avi_SV as "2v til.v:tta ed. AVISV"
--,d3c.ely_SV as "2v til.v:tta ed. ELYSV"
--,d3c.kielisuhde_SV as "2v til.v:tta ed. asuinkunnan kielisuhdeSV"
--,d3c.maakunta_SV as "2v til.v:tta ed. asuinmaakuntaSV"
--,d3c.kunta_SV as "2v til.v:tta ed. asuinkuntaSV"
,d4.sukupuoli_SV as Kön
,d5.ika_SV as Ålder
,d5.ika5v_SV as Åldersgrupp
,d5b.vuosiselite_SV as Födelseår
--,d5c.kuukausiselite_SV as SyntymäkuukausiSV
,d6a.tutkinto_amk_SV as "Examen (yrkehögskola)"
,d7.koulutustyyppi_SV as "Typ av utbildning"
,d8.kansalaisuus_versio2_SV as Medborgarskap
,d8b.kansalaisuus_versio1_SV as "Medborgarskap (utbildningsstruktur)"
--luodaan yhdistetty kansalaisuus-muuttuja, joka toimii aineistojen 2.8, 2.9, ja 4.9 välillä
,CASE WHEN d8.kansalaisuus_versio2_koodi = ''1'' Or d8b.kansalaisuus_versio1_koodi = ''1'' THEN
''finländare'' When d8.kansalaisuus_versio2_koodi = ''2'' Or d8.kansalaisuus_versio2_koodi = ''9'' Or d8b.kansalaisuus_versio1_koodi = ''2'' THEN ''andra''
 Else ''Okänd'' End as ''Medborgarskap (finska/andra)''
--
,case f.oppilaitos 
	when ''02543'' then ''Pohjois-Pirkanmaan koulutusinstituutti'' 
	when ''02390'' then ''Pirkanmaan hotelli- ja ravintolaoppilaitos'' 
	when ''01088'' then ''Pirkanmaan ammattioppilaitos'' 
	else d9.oppilaitos_SV end  as Yrkeshögskola
--,d9.opetuskieli_SV as OpetuskieliSV
--,d9.oppilaitoksen_omistajatyyppi_SV as "Oppil. omistajatyyppiSV"
--,d9.oppilaitostyyppi_SV as OppilaitostyyppiSV
--,d9b.koulutuksen_jarjestaja_SV as "Koulutuksen järjestäjäSV"
--,d9b.koulutuksen_jarjestajan_omistajatyyppi_SV as "Koul. järj. omistajatyyppiSV"
--,d10.lahde_SV as LähdeSV
,d11.koulutusohjelma_amk_SV as Utbildningsprogram
,d12.opiskelijan_olo_SV as "Inskrivning (september)"
,d12b.opiskelijan_olo_tamm_SV as "Inskrivning (januari)"
,d13.rahoituslahde_SV as Finansieringskälla
--,d15.suuntautumisvaihtoehto_amk_SV as SuuntautumisvaihtoehtoSV
--,d16.kieli_SV as "Koulutuksen kieliSV"
--,d17.ensisijainen_opintooikeus_SV as "Ensisijainen opinto-oikeusSV"
--,d18.tilauskoulutuksen_sijaintimaa_SV as "Tilauskoulutuksen sijaintimaaSV"
,d19.koulutussektori_SV as Utbildningssektor
--,d20.opetushallinnon_koulutus_SV as HallinnonalaSV
,d21.koulutusaste2002_SV as "Utbildningsnivå (2002)"
,d21.koulutusala2002_SV as "Utbildningsområde (2002)"
,d21.opintoala1995_SV as "Utbildningsområde (1995)"
,d21.opintoala2002_SV as "Studieområde (2002)"
,d21.koulutus_SV as Utbildningsbenämning
,d21b.koulutuslaji_okm_SV as Utbildningsslag
,d21b.koulutuslaji_okm2_SV as Utbildningsslag2
--,d22.avi_SV as "Koulutuksen AVISV"
--,d22.ely_SV as "Koulutuksen ELYSV"
,d22.maakunta_SV as "Utbildningens landskap"
--,d22.kielisuhde_SV as "Koul. kunnan kielisuhdeSV"
,d22.kunta_SV as "Utbildningens kommun"
--luodaan yhdistetyt kunta-muuttujat, jotka toimivat aineistojen 2.8, 2.9, ja 4.9 välillä
,CASE WHEN d1b.aineisto_koodi <> ''4.9'' And d1b.aineisto_koodi <> ''3.4'' THEN
d22.maakunta When d1b.aineisto_koodi = ''4.9'' THEN d3.maakunta
 Else ''Tuntematon'' End as ''Landskap''
,CASE WHEN d1b.aineisto_koodi <> ''4.9'' And d1b.aineisto_koodi <> ''3.4'' THEN
d22.kunta When d1b.aineisto_koodi = ''4.9'' THEN d3.kunta
 Else ''Tuntematon'' End as ''Kommun''
--
--,d22b.avi_SV as "Koul. järjestäjän AVISV"
--,d22b.ely_SV as "Koul. järjestäjän ELYSV"
--,d22b.maakunta_SV as "Koul. järjestäjän maakuntaSV"
--,d22b.kielisuhde_SV as "Koul. järj. kunnan kielisuhdeSV"
--,d22b.kunta_SV as "Koul. järjestäjän kuntaSV"
--,d22c.avi_SV as "Oppilaitoksen AVISV"
--,d22c.ely_SV as "Oppilaitoksen ELYSV"
--,d22c.maakunta_SV as "Oppilaitoksen maakuntaSV"
--,d22c.kielisuhde_SV as "Oppil. kunnan kielisuhdeSV"
--,d22c.kunta_SV as "Oppilaitoksen kuntaSV"
--,d23.vuosiselite_SV as "KirjoihintulovuosiSV"
--,d23b.lukukausiselite_SV as "KirjoihintulokausiSV"
--,d24b.vuosiselite_SV as "Kirjoihintulovuosi (kk-sek.)SV"
--,d24c.vuosiselite_SV as "Kirjoihintulovuosi (kk-sek. läsna)SV"
--,d24d.vuosiselite_SV as "Kirjoihintulovuosi (sek.)SV"
--,d24e.vuosiselite_SV as "Kirjoihintulovuosi (sek. läsnä)SV"
--,d24f.vuosiselite_SV as "Kirjoihintulovuosi (kk)SV"
--,d24f2.lukukausiselite_SV as "Kirjoihintulokausi (kk)SV"
--,d24g.vuosiselite_SV as "Kirjoihintulovuosi (kk läsnä)SV"
--,d24h.vuosiselite_SV as "Kirjoihintulovuosi (op.ala)SV"
--,d24i.vuosiselite_SV as "Kirjoihintulovuosi (op.ala läsnä)SV"
--,d24j.vuosiselite_SV as "Kirjoihintulovuosi (tutk.)SV"
--,d24k.lukukausiselite_SV as "Kirjoihintulokausi (tutk.)SV"
--,d28.vahintaan_55_op_suorittanut_SV as "Suorittanut väh. 55 opSV"
--,d29.opiskelijan_fte_tieto_SV as "Opiskelijan FTE-tietoSV"
--,d30.opiskelumuoto_SV as OpiskelumuotoSV
--,d31.yliopisto_SV as YliopistotunnusSV
--,d32.tiedekunta_yo_SV as TiedekuntaSV
--,d33.uusi_vanha_opiskelija_SV as "Uusi/vanha opiskelijaSV"
--,d35.opettajankelpoisuus_SV as OpettajankelpoisuusSV
--,d36.avoinvayla_SV as "Hyväksytty avoimen yliop. suoritusten kauttaSV"
,d37.vuosiselite_SV as "År då utbildningen avlagts"
--,d38.lukukausiselite_SV as "Tutk. suorituslukukausiSV"
--,d39.kuukausiselite_SV as "Tutk. suorituskuukausiSV"
,d40.maanosa_SV as "Medborgarskap (världsdel)"
,d41.eumaa_SV as "Medborgare i ett EU-land"
,d42.etamaa_SV as "Medborgare i ett EES-land"
,d43.pohjoismaa_SV as "Medborgare i ett nordiskt land"
--englanti

,[Tilastovuosi] as "Statistical year"
,[Study year] = 
	CASE
		WHEN d23.kausi_id = -1 THEN d23.vuosiselite_EN
		ELSE CAST(CAST(Tilastovuosi as int) - CAST(d23.vuosiselite as int) AS varchar(10))
	END
,d2.aidinkieli_versio1_EN as "Mother tongue"
,d2b.aidinkieli_versio2_EN as "Mother tongue (ed. structure)"
--luodaan yhdistetty äidinkieli-muuttuja, joka toimii aineistojen 2.8, 2.9, ja 4.9 välillä
,CASE WHEN d2.aidinkieli_versio1_koodi = ''fs'' Or d2b.aidinkieli_versio2_koodi = ''fi'' Or d2b.aidinkieli_versio2_koodi = ''se'' THEN
''Finnish (incl. Sami)'' When d2.aidinkieli_versio1_koodi = ''sv'' Or d2b.aidinkieli_versio2_koodi = ''sv'' THEN ''Swedish''
 When d2.aidinkieli_versio1_koodi = ''99'' Or d2b.aidinkieli_versio2_koodi = ''99'' THEN ''Other languages and unknown'' Else ''Unknown'' End as ''Mother tongue (Finnish/Other)''
--
--,d3.avi_EN as "Asuinalueen AVIEN"
--,d3.ely_EN as "Asuinalueen ELYEN"
--,d3.kielisuhde_EN as "Asuinkunnan kielisuhdeEN"
,d3.maakunta_EN as "Region of residence"
,d3.kunta_EN as "Municipality of residence"
--,d3b.avi_EN as "Til.v:tta edeltävä AVIEN"
--,d3b.ely_EN as "Til.v:tta edeltävä ELYEN"
--,d3b.kielisuhde_EN as "Til.v:tta ed. asuinkunnan kielisuhdeEN"
--,d3b.maakunta_EN as "Til.v:tta ed. asuinmaakuntaEN"
--,d3b.kunta_EN as "Til.v:tta ed. asuinkuntaEN"
--,d3c.avi_EN as "2v til.v:tta ed. AVIEN"
--,d3c.ely_EN as "2v til.v:tta ed. ELYEN"
--,d3c.kielisuhde_EN as "2v til.v:tta ed. asuinkunnan kielisuhdeEN"
--,d3c.maakunta_EN as "2v til.v:tta ed. asuinmaakuntaEN"
--,d3c.kunta_EN as "2v til.v:tta ed. asuinkuntaEN"
,d4.sukupuoli_EN as Gender
,d5.ika_EN as Age
,d5.ika5v_EN as Agegroup
,d5b.vuosiselite_EN as "Year of birth"
--,d5c.kuukausiselite_EN as SyntymäkuukausiEN
,d6a.tutkinto_amk_EN as "Degree (polytechnic)"
,d7.koulutustyyppi_EN as "Type of education"
,d8.kansalaisuus_versio2_EN as Nationality
,d8b.kansalaisuus_versio1_EN as "Nationality (ed. structure)"
--luodaan yhdistetty kansalaisuus-muuttuja, joka toimii aineistojen 2.8, 2.9, ja 4.9 välillä
,CASE WHEN d8.kansalaisuus_versio2_koodi = ''1'' Or d8b.kansalaisuus_versio1_koodi = ''1'' THEN
''Finn'' When d8.kansalaisuus_versio2_koodi = ''2'' Or d8.kansalaisuus_versio2_koodi = ''9'' Or d8b.kansalaisuus_versio1_koodi = ''2'' THEN ''Other''
 Else ''Unknown'' End as ''Nationality (Finn/Other)''
--
,case f.oppilaitos 
	when ''02543'' then ''Pohjois-Pirkanmaan koulutusinstituutti'' 
	when ''02390'' then ''Pirkanmaan hotelli- ja ravintolaoppilaitos'' 
	when ''01088'' then ''Pirkanmaan ammattioppilaitos'' 
	else d9.oppilaitos_EN end  as Polytechnic
--,d9.opetuskieli_EN as OpetuskieliEN
--,d9.oppilaitoksen_omistajatyyppi_EN as "Oppil. omistajatyyppiEN"
--,d9.oppilaitostyyppi_EN as OppilaitostyyppiEN
--,d9b.koulutuksen_jarjestaja_EN as "Koulutuksen järjestäjäEN"
--,d9b.koulutuksen_jarjestajan_omistajatyyppi_EN as "Koul. järj. omistajatyyppiEN"
--,d10.lahde_EN as LähdeEN
,d11.koulutusohjelma_amk_EN as "Degree programme"
,d12.opiskelijan_olo_EN as "Enrollment status (sept.)"
,d12b.opiskelijan_olo_tamm_EN as "Enrollment status (jan.)"
,d13.rahoituslahde_EN as "Source of funding"
--,d15.suuntautumisvaihtoehto_amk_EN as SuuntautumisvaihtoehtoEN
--,d16.kieli_EN as "Koulutuksen kieliEN"
--,d17.ensisijainen_opintooikeus_EN as "Ensisijainen opinto-oikeusEN"
--,d18.tilauskoulutuksen_sijaintimaa_EN as "Tilauskoulutuksen sijaintimaaEN"
,d19.koulutussektori_EN as "Sector of education"
--,d20.opetushallinnon_koulutus_EN as HallinnonalaEN
,d21.koulutusaste2002_EN as "Level of education (2002)"
,d21.koulutusala2002_EN as "Field of education (2002)"
,d21.opintoala1995_EN as "Field of education (1995)"
,d21.opintoala2002_EN as "Subfield of ed. (2002)"
,d21.koulutus_EN as "Name of education"
,d21b.koulutuslaji_okm_EN as "Form of education"
,d21b.koulutuslaji_okm2_EN as "Form of education2"
--,d22.avi_EN as "Koulutuksen AVIEN"
--,d22.ely_EN as "Koulutuksen ELYEN"
,d22.maakunta_EN as "Region of education"
--,d22.kielisuhde_EN as "Koul. kunnan kielisuhdeEN"
,d22.kunta_EN as "Municipality of education"
--luodaan yhdistetyt kunta-muuttujat, jotka toimivat aineistojen 2.8, 2.9, ja 4.9 välillä
,CASE WHEN d1b.aineisto_koodi <> ''4.9'' And d1b.aineisto_koodi <> ''3.4'' THEN
d22.maakunta When d1b.aineisto_koodi = ''4.9'' THEN d3.maakunta
 Else ''Tuntematon'' End as ''Region''
,CASE WHEN d1b.aineisto_koodi <> ''4.9'' And d1b.aineisto_koodi <> ''3.4'' THEN
d22.kunta When d1b.aineisto_koodi = ''4.9'' THEN d3.kunta
 Else ''Tuntematon'' End as ''Municipality''
--
--,d22b.avi_EN as "Koul. järjestäjän AVIEN"
--,d22b.ely_EN as "Koul. järjestäjän ELYEN"
--,d22b.maakunta_EN as "Koul. järjestäjän maakuntaEN"
--,d22b.kielisuhde_EN as "Koul. järj. kunnan kielisuhdeEN"
--,d22b.kunta_EN as "Koul. järjestäjän kuntaEN"
--,d22c.avi_EN as "Oppilaitoksen AVIEN"
--,d22c.ely_EN as "Oppilaitoksen ELYEN"
--,d22c.maakunta_EN as "Oppilaitoksen maakuntaEN"
--,d22c.kielisuhde_EN as "Oppil. kunnan kielisuhdeEN"
--,d22c.kunta_EN as "Oppilaitoksen kuntaEN"
,d23.vuosiselite_EN as "Year of enrollment"
,d23b.lukukausiselite_EN as "Term of enrollment"
,d24b.vuosiselite_EN as "Year of enrollment (HE sec.)"
,d24c.vuosiselite_EN as "Year of enrollment (HE sec. present)"
,d24d.vuosiselite_EN as "Year of enrollment (sec.)"
,d24e.vuosiselite_EN as "Year of enrollment (sec. present)"
,d24f.vuosiselite_EN as "Year of enrollment (ed. inst.)"
,d24f2.lukukausiselite_EN as "Term of enrollment (ed. inst.)"
,d24g.vuosiselite_EN as "Year of enrollment (ed. inst. present)"
,d24h.vuosiselite_EN as "Year of enrollment (subfield of ed.)"
,d24i.vuosiselite_EN as "Year of enrollment (subfield of ed. present)"
,d24j.vuosiselite_EN as "Year of enrollment (degree)"
,d24k.lukukausiselite_EN as "Term of enrollment (degree)"
--,d28.vahintaan_55_op_suorittanut_EN as "Suorittanut väh. 55 opEN"
--,d29.opiskelijan_fte_tieto_EN as "Opiskelijan FTE-tietoEN"
--,d30.opiskelumuoto_EN as OpiskelumuotoEN
--,d31.yliopisto_EN as YliopistotunnusEN
--,d32.tiedekunta_yo_EN as TiedekuntaEN
--,d33.uusi_vanha_opiskelija_EN as "Uusi/vanha opiskelijaEN"
--,d35.opettajankelpoisuus_EN as OpettajankelpoisuusEN
--,d36.avoinvayla_EN as "Hyväksytty avoimen yliop. suoritusten kauttaEN"
,d37.vuosiselite_EN as "Year of graduation"
,d38.lukukausiselite_EN as "Term of graduation"
,d39.kuukausiselite_EN as "Month of graduation"
,d40.maanosa_EN as "Nationality (continent)"
,d41.eumaa_EN as "Citizen of EU nation"
,d42.etamaa_EN as "Citizen of EEA nation"
,d43.pohjoismaa_EN as "Citizen of a nordic nation"
--isced
,d21.iscle2011 as "Koulutusaste, taso 1"
,d21.Koulutusaste_taso2 as "Koulutusaste, taso 2"
,d21.iscfibroad2013 as "Koulutusala, taso 1"
,d21.iscfinarrow2013 as "Koulutusala, taso 2"
,d21.iscfi2013 as "Koulutusala, taso 3"
,d21.OKM_ohjauksen_ala as "OKM ohjauksen ala, korkeak."
,d21.iscle2011_SV as "Utbildn.nivå, nivå 1"
,d21.Koulutusaste_taso2_SV as "Utbildn.nivå, nivå 2"
,d21.iscfibroad2013_SV as "Utbildn.område, nivå 1"
,d21.iscfinarrow2013_SV as "Utbildn.område, nivå 2"
,d21.iscfi2013_SV as "Utbildn.område, nivå 3"
,d21.OKM_ohjauksen_ala_SV as "UKM-styrningsområde, högskolor"
,d21.iscle2011_EN as "Level of ed., tier 1"
,d21.Koulutusaste_taso2_EN as "Level of ed., tier 2"
,d21.iscfibroad2013_EN as "Field of education, tier 1"
,d21.iscfinarrow2013_EN as "Field of education, tier 2"
,d21.iscfi2013_EN as "Field of education, tier 3"
,d21.OKM_ohjauksen_ala_EN as "Field of ed., HE steering"
,d21.jarjestys_iscle2011 as jarj_isced_koulast1
,d21.jarjestys_Koulutusaste_taso2 as jarj_isced_koulast2
,d21.jarjestys_iscfibroad2013 as jarj_isced_koulala1
,d21.jarjestys_iscfinarrow2013 as jarj_isced_koulala2
,d21.jarjestys_iscfi2013 as jarj_isced_koulala3
,d21.jarjestys_OKM_ohjauksen_ala as jarj_isced_okmohjaus1
,d21.iscle2011_koodi as "Koodit Koulutusaste, taso 1"
,d21.Koulutusaste_taso2_koodi as "Koodit Koulutusaste, taso 2"
,d21.iscfibroad2013_koodi as "Koodit Koulutusala, taso 1"
,d21.iscfinarrow2013_koodi as "Koodit Koulutusala, taso 2"
,d21.iscfi2013_koodi as "Koodit Koulutusala, taso 3"
,d21.OKM_ohjauksen_ala_koodi as "Koodit OKM ohjauksen ala, korkeak."
--Lukumäärämuuttujat
,[Opisk2]
,[Aloit2] = case when koulutusaste2002_koodi in(62,71) then Aloit2 else 0 end
,[lkm_op55] = CAST((case when d28.vahintaan_55_op_suorittanut_koodi = 1 then [Opisk2] end) as int)
,[lkm_op0]
,[lkm_op1_14]
,[lkm_op15_29]
,[lkm_op30_44]
,[lkm_op45_59]
,[lkm_op60_74]
,[lkm_op75_89]
,[lkm_op90_104]
,[lkm_op105_119]
,[lkm_op120_]
,[aloittaneet_kirjoihintulovuosi]
,[aloittaneet_korkeakoulusektori]
,[aloittaneet_korkeakoulusektori_lasnaoleva]
,[aloittaneet_sektori]
,[aloittaneet_sektori_lasnaoleva]
,[aloittaneet_korkeakoulu]
,[aloittaneet_korkeakoulu_lasnaoleva]
,[aloittaneet_opintoala]
,[aloittaneet_opintoala_lasnaoleva]
,[opiskelijat_lasna]
,[opiskelijat_fte]
,[lkm_lasnalk]
,[lkm_poissalk]
,[op_suoritettavien_laajuus]
,[op_edellinen_syksy]
,[op_edellinen_kevat]
,[op_kertyma_edel_lkv_loppu]
,[Tutk2]
,[op_amk_yhteensa]
,[op_amk_yleissiv_amm_opplait]
,[op_amk_muualla]
,[op_amk_oma_amk]
,[op_amk_muu_amk]
,[op_amk_yliopistoissa]
,[op_amk_ulkomailla]
,[op_yo_yhteensa]
,[op_yo_ulkomailla]
,[op_yo_muualla]
,[op_yo_oma_yo]
,[op_yo_avoimessa]
,[op_yo_muu_yo]
,[op_yo_ammattikorkeakouluissa]
,[ika19_21_lkm]
,[ika20_24_lkm]
,[ika25_34_lkm]
,[ika25_64_lkm]
,[Perusraportti] = case when Tilastovuosi>2000 then 1 else 0 end
FROM (
SELECT [tilastointivuosi] as Tilastovuosi
	  ,aineisto_id
	  ,aineisto_OTV_id
	  ,aidinkieli_versio1_id
	  ,aidinkieli_versio2_id = ''-1''
	  ,kotikunta_id
	  ,kotikunta1x_id
	  ,kotikunta2x_id
	  ,sukupuoli_id
	  ,ika_id
	  ,syntymavuosi_id
	  ,syntymakuukausi_id = ''-1''
	  ,tutkinto_amk_id
	  ,tutkinto_yo_id
	  ,koulutustyyppi_id
	  ,kansalaisuus_versio2_id
	  ,kansalaisuus_versio1_id = -1
	  ,oppilaitos_id
	  ,oppilaitos
	  ,koulutuksen_jarjestaja_id
	  ,lahde_id
	  ,koulutusohjelma_amk_id
	  ,opiskelijan_olo_syys_id
	  ,opiskelijan_olo_tamm_id
	  ,rahoituslahde_id
	  ,suuntautumisvaihtoehto_amk_id
	  ,koulutuksen_kieli_id
	  ,ensisijainen_opintooikeus_id
	  ,tilauskoulutuksen_sijaintimaa_id
	  ,koulutussektori_id
	  ,opetushallinnon_koulutus_id
	  ,koulutusluokitus_id
	  ,koulutuslaji_OKM_id
	  ,koulutuksen_kunta_id
	  ,koulutuksen_jarjestaja_kunta_id
	  ,oppilaitos_kunta_id
	  ,kirjoihintulovuosi_id
	  ,kirjoihintulokausi_id
	  ,kirjoihintulovuosi_korkeakoulusektori_id
	  ,kirjoihintulovuosi_korkeakoulusektori_lasnaoleva_id
	  ,kirjoihintulovuosi_sektori_id
	  ,kirjoihintulovuosi_sektori_lasnaoleva_id
	  ,kirjoihintulovuosi_korkeakoulu_id
	  ,kirjoihintulokausi_korkeakoulu_id = ''-1''
	  ,kirjoihintulovuosi_korkeakoulu_lasnaoleva_id
	  ,kirjoihintulovuosi_opintoala_id
	  ,kirjoihintulovuosi_opintoala_lasnaoleva_id
	  ,kirjoihintulovuosi_tutkinto_id
	  ,kirjoihintulokausi_tutkinto_id
	  ,vahintaan_55_op_suorittanut_id
	  ,opiskelijan_fte_tieto_id
	  --,opiskelumuoto_id
	  ,yliopisto_id
	  ,tiedekunta_yo_id
	  ,uusi_vanha_opiskelija_id
	  ,opettajankelpoisuus_id
	  ,avoinvayla_id
	  ,tutkinnon_suoritusvuosi_id = ''-1''
	  ,tutkinnon_suorituslukukausi_id = ''-1''
	  ,tutkinnon_suorituskuukausi_id = ''-1''
	  ,maanosa_id = -1
	  ,pohjoismaa_id = -1
	  ,eumaa_id = -1
	  ,etamaa_id = -1
	  ,[opiskelijat] as Opisk2
	  ,[aloittaneet] as Aloit2
	  ,[lkm_op0]
	  ,[lkm_op1_14]
	  ,[lkm_op15_29]
	  ,[lkm_op30_44]
	  ,[lkm_op45_59]
	  ,[lkm_op60_74]
	  ,[lkm_op75_89]
	  ,[lkm_op90_104]
	  ,[lkm_op105_119]
	  ,[lkm_op120_]
	  ,[aloittaneet_kirjoihintulovuosi]
	  ,[aloittaneet_korkeakoulusektori]
	  ,[aloittaneet_korkeakoulusektori_lasnaoleva]
	  ,[aloittaneet_sektori]
	  ,[aloittaneet_sektori_lasnaoleva]
	  ,[aloittaneet_korkeakoulu]
	  ,[aloittaneet_korkeakoulu_lasnaoleva]
	  ,[aloittaneet_opintoala]
	  ,[aloittaneet_opintoala_lasnaoleva]
	  ,[opiskelijat_lasna]
	  ,[opiskelijat_fte]
	  ,[lkm_lasnalk]
	  ,[lkm_poissalk]
	  ,[op_suoritettavien_laajuus]
	  ,[op_edellinen_syksy]
	  ,[op_edellinen_kevat]
	  ,[op_kertyma_edel_lkv_loppu]
	  ,[Tutk2] = NULL
	  ,[op_amk_yhteensa] = NULL
	  ,[op_amk_yleissiv_amm_opplait] = NULL
	  ,[op_amk_muualla] = NULL
	  ,[op_amk_oma_amk] = NULL
	  ,[op_amk_muu_amk] = NULL
	  ,[op_amk_yliopistoissa] = NULL
	  ,[op_amk_ulkomailla] = NULL
	  ,[op_yo_yhteensa] = NULL
	  ,[op_yo_ulkomailla] = NULL
	  ,[op_yo_muualla] = NULL
	  ,[op_yo_oma_yo] = NULL
	  ,[op_yo_avoimessa] = NULL
	  ,[op_yo_muu_yo] = NULL
	  ,[op_yo_ammattikorkeakouluissa] = NULL
	  ,[ika19_21_lkm] = NULL
	  ,[ika20_24_lkm] = NULL
	  ,[ika25_34_lkm] = NULL
	  ,[ika25_64_lkm] = NULL
  FROM [dbo].[f_OTV_2_8_Korkeakouluopiskelijat] f1

UNION ALL

SELECT [tilastointivuosi] as Tilastovuosi
	  ,aineisto_id
	  ,aineisto_OTV_id
	  ,aidinkieli_versio1_id
	  ,aidinkieli_versio2_id = ''-1''
	  ,kotikunta_id
	  ,kotikunta1x_id
	  ,kotikunta2x_id = -1
	  ,sukupuoli_id
	  ,ika_id
	  ,syntymavuosi_id
	  ,syntymakuukausi_id = ''-1''
	  ,tutkinto_amk_id
	  ,tutkinto_yo_id
	  ,koulutustyyppi_id
	  ,kansalaisuus_versio2_id
	  ,kansalaisuus_versio1_id = -1
	  ,oppilaitos_id
	  ,oppilaitos
	  ,koulutuksen_jarjestaja_id
	  ,lahde_id
	  ,koulutusohjelma_amk_id
	  ,opiskelijan_olo_syys_id = -1
	  ,opiskelijan_olo_tamm_id = -1
	  ,rahoituslahde_id
	  ,suuntautumisvaihtoehto_amk_id
	  ,koulutuksen_kieli_id
	  ,ensisijainen_opintooikeus_id = -1
	  ,tilauskoulutuksen_sijaintimaa_id
	  ,koulutussektori_id
	  ,opetushallinnon_koulutus_id
	  ,koulutusluokitus_id
	  ,koulutuslaji_OKM_id
	  ,koulutuksen_kunta_id
	  ,koulutuksen_jarjestaja_kunta_id
	  ,oppilaitos_kunta_id
	  ,kirjoihintulovuosi_id
	  ,kirjoihintulokausi_id
	  ,kirjoihintulovuosi_korkeakoulusektori_id
	  ,kirjoihintulovuosi_korkeakoulusektori_lasnaoleva_id
	  ,kirjoihintulovuosi_sektori_id
	  ,kirjoihintulovuosi_sektori_lasnaoleva_id
	  ,kirjoihintulovuosi_korkeakoulu_id
	  ,kirjoihintulokausi_korkeakoulu_id = ''-1''
	  ,kirjoihintulovuosi_korkeakoulu_lasnaoleva_id
	  ,kirjoihintulovuosi_opintoala_id
	  ,kirjoihintulovuosi_opintoala_lasnaoleva_id
	  ,kirjoihintulovuosi_tutkinto_id
	  ,kirjoihintulokausi_tutkinto_id
	  ,vahintaan_55_op_suorittanut_id = -1
	  ,opiskelijan_fte_tieto_id = -1
	  --,opiskelumuoto_id
	  ,yliopisto_id = -1
	  ,tiedekunta_yo_id
	  ,uusi_vanha_opiskelija_id = -1
	  ,opettajankelpoisuus_id
	  ,avoinvayla_id = -1
	  ,tutkinnon_suoritusvuosi_id
	  ,tutkinnon_suorituslukukausi_id
	  ,tutkinnon_suorituskuukausi_id = ''-1''
	  ,maanosa_id = -1
	  ,pohjoismaa_id = -1
	  ,eumaa_id = -1
	  ,etamaa_id = -1
	  ,[Opisk2] = NULL
	  ,[Aloit2] = NULL
	  ,[lkm_op0] = NULL
	  ,[lkm_op1_14] = NULL
	  ,[lkm_op15_29] = NULL
	  ,[lkm_op30_44] = NULL
	  ,[lkm_op45_59] = NULL
	  ,[lkm_op60_74] = NULL
	  ,[lkm_op75_89] = NULL
	  ,[lkm_op90_104] = NULL
	  ,[lkm_op105_119] = NULL
	  ,[lkm_op120_] = NULL
	  ,[aloittaneet_kirjoihintulovuosi] = NULL
	  ,[aloittaneet_korkeakoulusektori] = NULL
	  ,[aloittaneet_korkeakoulusektori_lasnaoleva] = NULL
	  ,[aloittaneet_sektori] = NULL
	  ,[aloittaneet_sektori_lasnaoleva] = NULL
	  ,[aloittaneet_korkeakoulu] = NULL
	  ,[aloittaneet_korkeakoulu_lasnaoleva] = NULL
	  ,[aloittaneet_opintoala] = NULL
	  ,[aloittaneet_opintoala_lasnaoleva] = NULL
	  ,[opiskelijat_lasna] = NULL
	  ,[opiskelijat_fte] = NULL
	  ,[lkm_lasnalk]
	  ,[lkm_poissalk]
	  ,[op_suoritettavien_laajuus]
	  ,[op_edellinen_syksy] = NULL
	  ,[op_edellinen_kevat] = NULL
	  ,[op_kertyma_edel_lkv_loppu] = NULL
	  ,[lukumaara] as Tutk2
	  ,[op_amk_yhteensa]
	  ,[op_amk_yleissiv_amm_opplait]
	  ,[op_amk_muualla]
	  ,[op_amk_oma_amk]
	  ,[op_amk_muu_amk]
	  ,[op_amk_yliopistoissa]
	  ,[op_amk_ulkomailla]
	  ,[op_yo_yhteensa]
	  ,[op_yo_ulkomailla]
	  ,[op_yo_muualla]
	  ,[op_yo_oma_yo]
	  ,[op_yo_avoimessa]
	  ,[op_yo_muu_yo]
	  ,[op_yo_ammattikorkeakouluissa]
	  ,[ika19_21_lkm] = NULL
	  ,[ika20_24_lkm] = NULL
	  ,[ika25_34_lkm] = NULL
	  ,[ika25_64_lkm] = NULL
  FROM [dbo].[f_OTV_2_9_Korkeakoulututkinnot]

UNION ALL
SELECT [tilastointivuosi] as Tilastovuosi
	  ,aineisto_id
	  ,aineisto_OTV_id
	  ,aidinkieli_versio1_id = -1
	  ,aidinkieli_versio2_id
	  ,kotikunta_id
	  ,kotikunta1x_id = -1
	  ,kotikunta2x_id = -1
	  ,sukupuoli_id
	  ,ika_id = ''-1''
	  ,syntymavuosi_id = ''-1''
	  ,syntymakuukausi_id = ''-1''
	  ,tutkinto_amk_id = -1
	  ,tutkinto_yo_id = -1
	  ,koulutustyyppi_id = -1
	  ,kansalaisuus_versio2_id = -1
	  ,kansalaisuus_versio1_id
	  ,oppilaitos_id = -1
	  ,oppilaitos = -1
	  ,koulutuksen_jarjestaja_id = -1
	  ,lahde_id = -1
	  ,koulutusohjelma_amk_id = -1
	  ,opiskelijan_olo_syys_id = -1
	  ,opiskelijan_olo_tamm_id = -1
	  ,rahoituslahde_id = -1
	  ,suuntautumisvaihtoehto_amk_id = -1
	  ,koulutuksen_kieli_id = -1
	  ,ensisijainen_opintooikeus_id = -1
	  ,tilauskoulutuksen_sijaintimaa_id = -1
	  ,koulutussektori_id = -1
	  ,opetushallinnon_koulutus_id = -1
	  ,koulutusluokitus_id = -1
	  ,koulutuslaji_OKM_id = -1
	  ,koulutuksen_kunta_id = -1
	  ,koulutuksen_jarjestaja_kunta_id = -1
	  ,oppilaitos_kunta_id = -1
	  ,kirjoihintulovuosi_id = ''-1''
	  ,kirjoihintulokausi_id = ''-1''
	  ,kirjoihintulovuosi_korkeakoulusektori_id = ''-1''
	  ,kirjoihintulovuosi_korkeakoulusektori_lasnaoleva_id = ''-1''
	  ,kirjoihintulovuosi_sektori_id = ''-1''
	  ,kirjoihintulovuosi_sektori_lasnaoleva_id = ''-1''
	  ,kirjoihintulovuosi_korkeakoulu_id = ''-1''
	  ,kirjoihintulokausi_korkeakoulu_id = ''-1''
	  ,kirjoihintulovuosi_korkeakoulu_lasnaoleva_id = ''-1''
	  ,kirjoihintulovuosi_opintoala_id = ''-1''
	  ,kirjoihintulovuosi_opintoala_lasnaoleva_id = ''-1''
	  ,kirjoihintulovuosi_tutkinto_id = ''-1''
	  ,kirjoihintulokausi_tutkinto_id = ''-1''
	  ,vahintaan_55_op_suorittanut_id = -1
	  ,opiskelijan_fte_tieto_id = -1
	  --,opiskelumuoto_id = -1
	  ,yliopisto_id = -1
	  ,tiedekunta_yo_id = -1
	  ,uusi_vanha_opiskelija_id = -1
	  ,opettajankelpoisuus_id = -1
	  ,avoinvayla_id = -1
	  ,tutkinnon_suoritusvuosi_id = ''-1''
	  ,tutkinnon_suorituslukukausi_id = ''-1''
	  ,tutkinnon_suorituskuukausi_id = ''-1''
	  ,maanosa_id
	  ,pohjoismaa_id
	  ,eumaa_id
	  ,etamaa_id
	  ,[Opisk2] = NULL
	  ,[Aloit2] = NULL
	  ,[lkm_op0] = NULL
	  ,[lkm_op1_14] = NULL
	  ,[lkm_op15_29] = NULL
	  ,[lkm_op30_44] = NULL
	  ,[lkm_op45_59] = NULL
	  ,[lkm_op60_74] = NULL
	  ,[lkm_op75_89] = NULL
	  ,[lkm_op90_104] = NULL
	  ,[lkm_op105_119] = NULL
	  ,[lkm_op120_] = NULL
	  ,[aloittaneet_kirjoihintulovuosi] = NULL
	  ,[aloittaneet_korkeakoulusektori] = NULL
	  ,[aloittaneet_korkeakoulusektori_lasnaoleva] = NULL
	  ,[aloittaneet_sektori] = NULL
	  ,[aloittaneet_sektori_lasnaoleva] = NULL
	  ,[aloittaneet_korkeakoulu] = NULL
	  ,[aloittaneet_korkeakoulu_lasnaoleva] = NULL
	  ,[aloittaneet_opintoala] = NULL
	  ,[aloittaneet_opintoala_lasnaoleva] = NULL
	  ,[opiskelijat_lasna] = NULL
	  ,[opiskelijat_fte] = NULL
	  ,[lkm_lasnalk] = NULL
	  ,[lkm_poissalk] = NULL
	  ,[op_suoritettavien_laajuus] = NULL
	  ,[op_edellinen_syksy] = NULL
	  ,[op_edellinen_kevat] = NULL
	  ,[op_kertyma_edel_lkv_loppu] = NULL
	  ,[Tutk2] = NULL
	  ,[op_amk_yhteensa] = NULL
	  ,[op_amk_yleissiv_amm_opplait] = NULL
	  ,[op_amk_muualla] = NULL
	  ,[op_amk_oma_amk] = NULL
	  ,[op_amk_muu_amk] = NULL
	  ,[op_amk_yliopistoissa] = NULL
	  ,[op_amk_ulkomailla] = NULL
	  ,[op_yo_yhteensa] = NULL
	  ,[op_yo_ulkomailla] = NULL
	  ,[op_yo_muualla] = NULL
	  ,[op_yo_oma_yo] = NULL
	  ,[op_yo_avoimessa] = NULL
	  ,[op_yo_muu_yo] = NULL
	  ,[op_yo_ammattikorkeakouluissa] = NULL
	  ,[ika19_21_lkm]
	  ,[ika20_24_lkm]
	  ,[ika25_34_lkm]
	  ,[ika25_64_lkm]
  FROM [dbo].[f_OTV_4_9_Vaestorakenne_kunnittain]

  ) f
	INNER JOIN [dbo].d_aineisto d1 ON d1.id = f.aineisto_id
	INNER JOIN [dbo].d_aineisto_OTV d1b ON d1b.id = f.aineisto_OTV_id
	INNER JOIN [dbo].d_aidinkieli_versio1 d2 ON d2.id = f.aidinkieli_versio1_id
	INNER JOIN [dbo].d_aidinkieli_versio2 d2b ON d2b.id = f.aidinkieli_versio2_id
	INNER JOIN [dbo].d_alueluokitus d3 ON d3.id = f.kotikunta_id
	INNER JOIN [dbo].d_alueluokitus d3b ON d3b.id = f.kotikunta1x_id
	INNER JOIN [dbo].d_alueluokitus d3c ON d3c.id = f.kotikunta2x_id
	INNER JOIN [dbo].d_sukupuoli d4 ON d4.id = f.sukupuoli_id
	INNER JOIN [dbo].d_ika d5 ON d5.id = f.ika_id
	INNER JOIN [dbo].d_kausi d5b ON d5b.kausi_id = f.syntymavuosi_id
	--INNER JOIN [dbo].d_kausi d5c ON d5c.kausi_id = f.syntymakuukausi_id
	INNER JOIN [dbo].d_tutkinto_amk d6a ON d6a.id = f.tutkinto_amk_id
	INNER JOIN [dbo].d_tutkinto_yo d6b ON d6b.id = f.tutkinto_yo_id
	INNER JOIN [dbo].d_koulutustyyppi d7 ON d7.id = f.koulutustyyppi_id
	INNER JOIN [dbo].d_kansalaisuus_versio2 d8 ON d8.id = f.kansalaisuus_versio2_id
	INNER JOIN [dbo].d_kansalaisuus_versio1 d8b ON d8b.id = f.kansalaisuus_versio1_id
	INNER JOIN [dbo].d_oppilaitoksen_taustatiedot d9 ON d9.id = f.oppilaitos_id
	INNER JOIN [dbo].d_oppilaitoksen_taustatiedot d9b ON d9b.id = f.koulutuksen_jarjestaja_id
	INNER JOIN [dbo].d_lahde d10 ON d10.id = f.lahde_id
	INNER JOIN [dbo].d_koulutusohjelma_amk d11 ON d11.id = f.koulutusohjelma_amk_id
	INNER JOIN [dbo].d_opiskelijan_olo d12 ON d12.id = f.opiskelijan_olo_syys_id
	INNER JOIN [dbo].d_opiskelijan_olo_tamm d12b ON d12b.id = f.opiskelijan_olo_tamm_id
	INNER JOIN [dbo].d_rahoituslahde d13 ON d13.id = f.rahoituslahde_id
	INNER JOIN [dbo].d_suuntautumisvaihtoehto_amk d15 ON d15.id = f.suuntautumisvaihtoehto_amk_id
	INNER JOIN [dbo].d_kieli d16 ON d16.id = f.koulutuksen_kieli_id
	INNER JOIN [dbo].d_ensisijainen_opintooikeus d17 ON d17.id = f.ensisijainen_opintooikeus_id
	INNER JOIN [dbo].d_tilauskoulutuksen_sijaintimaa d18 ON d18.id = f.tilauskoulutuksen_sijaintimaa_id
	INNER JOIN [dbo].d_koulutussektori d19 ON d19.id = f.koulutussektori_id
	INNER JOIN [dbo].d_opetushallinnon_koulutus d20 ON d20.id = f.opetushallinnon_koulutus_id
	INNER JOIN [dbo].d_koulutusluokitus d21 ON d21.id = f.koulutusluokitus_id
	INNER JOIN [dbo].d_koulutuslaji_okm d21b ON d21b.id = f.koulutuslaji_OKM_id
	INNER JOIN [dbo].d_alueluokitus d22 ON d22.id = f.koulutuksen_kunta_id
	INNER JOIN [dbo].d_alueluokitus d22b ON d22b.id = f.koulutuksen_jarjestaja_kunta_id
	INNER JOIN [dbo].d_alueluokitus d22c ON d22c.id = f.oppilaitos_kunta_id
	INNER JOIN [dbo].d_kausi d23 ON d23.kausi_id = f.kirjoihintulovuosi_id
	INNER JOIN [dbo].d_kausi d23b ON d23b.kausi_id = f.kirjoihintulokausi_id
	INNER JOIN [dbo].d_kausi d24b ON d24b.kausi_id = f.kirjoihintulovuosi_korkeakoulusektori_id
	INNER JOIN [dbo].d_kausi d24c ON d24c.kausi_id = f.kirjoihintulovuosi_korkeakoulusektori_lasnaoleva_id
	INNER JOIN [dbo].d_kausi d24d ON d24d.kausi_id = f.kirjoihintulovuosi_sektori_id
	INNER JOIN [dbo].d_kausi d24e ON d24e.kausi_id = f.kirjoihintulovuosi_sektori_lasnaoleva_id
	INNER JOIN [dbo].d_kausi d24f ON d24f.kausi_id = f.kirjoihintulovuosi_korkeakoulu_id
	INNER JOIN [dbo].d_kausi d24f2 ON d24f2.kausi_id = f.kirjoihintulokausi_korkeakoulu_id
	INNER JOIN [dbo].d_kausi d24g ON d24g.kausi_id = f.kirjoihintulovuosi_korkeakoulu_lasnaoleva_id
	INNER JOIN [dbo].d_kausi d24h ON d24h.kausi_id = f.kirjoihintulovuosi_opintoala_id
	INNER JOIN [dbo].d_kausi d24i ON d24i.kausi_id = f.kirjoihintulovuosi_opintoala_lasnaoleva_id
	INNER JOIN [dbo].d_kausi d24j ON d24j.kausi_id = f.kirjoihintulovuosi_tutkinto_id
	INNER JOIN [dbo].d_kausi d24k ON d24k.kausi_id = f.kirjoihintulokausi_tutkinto_id
	INNER JOIN [dbo].d_vahintaan_55_op_suorittanut d28 ON d28.id = f.vahintaan_55_op_suorittanut_id
	INNER JOIN [dbo].d_opiskelijan_fte_tieto d29 ON d29.id = f.opiskelijan_fte_tieto_id
	--INNER JOIN [dbo].d_opiskelumuoto d30 ON d30.id = f.opiskelumuoto_id
	INNER JOIN [dbo].d_yliopisto d31 ON d31.id = f.yliopisto_id
	INNER JOIN [dbo].d_tiedekunta_yo d32 ON d32.id = f.tiedekunta_yo_id
	INNER JOIN [dbo].d_uusi_vanha_opiskelija d33 ON d33.id = f.uusi_vanha_opiskelija_id
	--INNER JOIN [dbo].d_kausi d34 ON d34.kausi_id = f.tutkintooikeusvuosi_id
	INNER JOIN [dbo].d_opettajankelpoisuus d35 ON d35.id = f.opettajankelpoisuus_id
	INNER JOIN [dbo].d_avoinvayla d36 ON d36.id = f.avoinvayla_id
	INNER JOIN [dbo].d_kausi d37 ON d37.kausi_id = f.tutkinnon_suoritusvuosi_id
	INNER JOIN [dbo].d_kausi d38 ON d38.kausi_id = f.tutkinnon_suorituslukukausi_id
	INNER JOIN [dbo].d_kausi d39 ON d39.kausi_id = f.tutkinnon_suorituskuukausi_id
	INNER JOIN [dbo].d_valtio_historia d40 ON d40.id = f.maanosa_id
	INNER JOIN [dbo].d_valtio_historia d41 ON d41.id = f.eumaa_id
	INNER JOIN [dbo].d_valtio_historia d42 ON d42.id = f.etamaa_id
	INNER JOIN [dbo].d_pohjoismaa d43 ON d43.id = f.pohjoismaa_id
WHERE 
d1.aineisto_koodi=
(case
	when d1b.aineisto like ''2.8%'' then (case when NOT EXISTS (SELECT 1 FROM [dbo].[f_OTV_2_8_Korkeakouluopiskelijat] o WHERE o.lahde = ''41'' and o.aineisto=''L'' and o.tilastointivuosi=f.Tilastovuosi) then ''E'' else ''L'' end)
	when d1b.aineisto like ''2.9%'' then (case when NOT EXISTS (SELECT 1 FROM [dbo].[f_OTV_2_9_Korkeakoulututkinnot] o WHERE o.lahde = ''42'' and o.aineisto=''L'' and o.tilastointivuosi=f.Tilastovuosi) then ''E'' else ''L'' end)
	else ''-1''
end
)
AND d10.lahde_koodi in (''-1'',''41'',''42'') AND d9.oppilaitoskoodi <> ''02557'' AND d9.oppilaitoskoodi <> ''10031'' AND d9.oppilaitoskoodi <> ''02358''
AND coalesce(d9.oppilaitoksen_korvaavakoodi,d9.oppilaitoskoodi) not in (''01029'',''01569'',''10102'') --ahvenanmaan oppilaitokset pois


--(d1.aineisto_koodi in (''L'',''-1'') OR (d1.aineisto_koodi=''E'' and Tilastovuosi=2016))





























' 
GO
/****** Object:  View [dbo].[v_f_tab_otv_korkeakoulut_yhteiset]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_otv_korkeakoulut_yhteiset]'))
EXEC dbo.sp_executesql @statement = N'















CREATE VIEW [dbo].[v_f_tab_otv_korkeakoulut_yhteiset] AS

Select 
[Tilastovuosi]
,d1.aineisto as Aineisto
,d1b.aineisto as Aineisto_OTV
,d1b.kaikkien_asteiden_koulutus as ''Kaikkien asteiden koulutus''
,d1b.tilastointivuosi as OTV_Tilv
,d2.aidinkieli_versio1 as Äidinkieli
,d2b.aidinkieli_versio2 as "Äidinkieli (väestörakenne)"
--luodaan yhdistetty äidinkieli-muuttuja, joka toimii aineistojen 2.8, 2.9, ja 4.9 välillä
,CASE WHEN d2.aidinkieli_versio1_koodi = ''fs'' Or d2b.aidinkieli_versio2_koodi = ''fi'' Or d2b.aidinkieli_versio2_koodi = ''se'' THEN
''suomi (sis. saame)'' When d2.aidinkieli_versio1_koodi = ''sv'' Or d2b.aidinkieli_versio2_koodi = ''sv'' THEN ''ruotsi''
 When d2.aidinkieli_versio1_koodi = ''99'' Or d2b.aidinkieli_versio2_koodi = ''99'' THEN ''muut kielet ja tuntematon'' Else ''Tuntematon'' End AS ''Äidinkieli (suomi/muu)''
--
,d3.avi as "Asuinalueen AVI"
,d3.ely as "Asuinalueen ELY"
,d3.kielisuhde as "Asuinkunnan kielisuhde"
,d3.maakunta as Asuinmaakunta
,d3.kunta as Asuinkunta
,d3b.avi as "Til.v:tta edeltävä AVI"
,d3b.ely as "Til.v:tta edeltävä ELY"
,d3b.kielisuhde as "Til.v:tta ed. asuinkunnan kielisuhde"
,d3b.maakunta as "Til.v:tta ed. asuinmaakunta"
,d3b.kunta as "Til.v:tta ed. asuinkunta"
,d3c.avi as "2v til.v:tta ed. AVI"
,d3c.ely as "2v til.v:tta ed. ELY"
,d3c.kielisuhde as "2v til.v:tta ed. asuinkunnan kielisuhde"
,d3c.maakunta as "2v til.v:tta ed. asuinmaakunta"
,d3c.kunta as "2v til.v:tta ed. asuinkunta"
,d4.sukupuoli as Sukupuoli
,d5.ika as Ikä
,d5.ika5v as Ikäryhmä
,d5b.vuosiselite as Syntymävuosi
,d5c.kuukausiselite as Syntymäkuukausi
,d6a.tutkinto_amk as "Tutkinto (amk)"
,d6b.tutkinto_yo as "Tutkinto (yo)"
,d7.koulutustyyppi as Koulutustyyppi
,d8.kansalaisuus_versio2 as Kansalaisuus
,d8b.kansalaisuus_versio1 as "Kansalaisuus (väestörakenne)"
--luodaan yhdistetty kansalaisuus-muuttuja, joka toimii aineistojen 2.8, 2.9, ja 4.9 välillä
,CASE WHEN d8.kansalaisuus_versio2_koodi = ''1'' Or d8b.kansalaisuus_versio1_koodi = ''1'' THEN
''suomi'' When d8.kansalaisuus_versio2_koodi = ''2'' Or d8.kansalaisuus_versio2_koodi = ''9'' Or d8b.kansalaisuus_versio1_koodi = ''2'' THEN ''muu''
 Else ''Tuntematon'' End AS ''Kansalaisuus (suomi/muu)''
--
,case f.oppilaitos 
	when ''02543'' then ''Pohjois-Pirkanmaan koulutusinstituutti'' 
	when ''02390'' then ''Pirkanmaan hotelli- ja ravintolaoppilaitos'' 
	when ''01088'' then ''Pirkanmaan ammattioppilaitos'' 
	else d9.oppilaitos end 
as Oppilaitos
,d9.oppilaitos as Yliopisto
,case f.oppilaitos 
	when ''02543'' then ''Pohjois-Pirkanmaan koulutusinstituutti'' 
	when ''02390'' then ''Pirkanmaan hotelli- ja ravintolaoppilaitos'' 
	when ''01088'' then ''Pirkanmaan ammattioppilaitos'' 
	else d9.oppilaitos end
as Ammattikorkeakoulu
,d9.opetuskieli as Opetuskieli
,d9.oppilaitoksen_omistajatyyppi as "Oppil. omistajatyyppi"
,d9.oppilaitostyyppi as Oppilaitostyyppi
,d9b.koulutuksen_jarjestaja as "Koulutuksen järjestäjä"
,d9b.koulutuksen_jarjestajan_omistajatyyppi as "Koul. järj. omistajatyyppi"
,d10.lahde as Lähde
,d11.koulutusohjelma_amk as Koulutusohjelma
,d12.opiskelijan_olo as "Kirjoillaolo (syys)"
,d12b.opiskelijan_olo_tamm as "Kirjoillaolo (tammi)"
,d13.rahoituslahde as Rahoituslähde
,d15.suuntautumisvaihtoehto_amk as Suuntautumisvaihtoehto
,d16.kieli as "Koulutuksen kieli"
,d17.ensisijainen_opintooikeus as "Ensisijainen opinto-oikeus"
,d18.tilauskoulutuksen_sijaintimaa as "Tilauskoulutuksen sijaintimaa"
,d19.koulutussektori as Koulutussektori
,d20.opetushallinnon_koulutus as Hallinnonala
,d21.koulutusaste2002 as "Koulutusaste (2002)"
,d21.koulutusala2002 as "Koulutusala (2002)"
,d21.opintoala1995 as "Koulutusala (1995)"
,d21.opintoala2002 as "Opintoala (2002)"
,d21.koulutus as Koulutusnimike
,d21b.koulutuslaji_okm as Koulutuslaji
,d21b.koulutuslaji_okm2 as Koulutuslaji2
,d22.avi as "Koulutuksen AVI"
,d22.ely as "Koulutuksen ELY"
,d22.maakunta as "Koulutuksen maakunta"
,d22.kielisuhde as "Koul. kunnan kielisuhde"
,d22.kunta as "Koulutuksen kunta"
--luodaan yhdistetyt kunta-muuttujat, jotka toimivat aineistojen 2.8, 2.9, ja 4.9 välillä
,CASE WHEN d1b.aineisto_koodi <> ''4.9'' And d1b.aineisto_koodi <> ''3.4'' THEN
d22.maakunta When d1b.aineisto_koodi = ''4.9'' THEN d3.maakunta
 Else ''Tuntematon'' End AS ''Maakunta''
,CASE WHEN d1b.aineisto_koodi <> ''4.9'' And d1b.aineisto_koodi <> ''3.4'' THEN
d22.kunta When d1b.aineisto_koodi = ''4.9'' THEN d3.kunta
 Else ''Tuntematon'' End AS ''Kunta''
--
,d22b.avi as "Koul. järjestäjän AVI"
,d22b.ely as "Koul. järjestäjän ELY"
,d22b.maakunta as "Koul. järjestäjän maakunta"
,d22b.kielisuhde as "Koul. järj. kunnan kielisuhde"
,d22b.kunta as "Koul. järjestäjän kunta"
,d22c.avi as "Oppilaitoksen AVI"
,d22c.ely as "Oppilaitoksen ELY"
,d22c.maakunta as "Oppilaitoksen maakunta"
,d22c.kielisuhde as "Oppil. kunnan kielisuhde"
,d22c.kunta as "Oppilaitoksen kunta"
,d23.vuosiselite as "Kirjoihintulovuosi"
,d23b.lukukausiselite as "Kirjoihintulokausi"
,d24b.vuosiselite as "Kirjoihintulovuosi (kk-sek.)"
,d24c.vuosiselite as "Kirjoihintulovuosi (kk-sek. läsna)"
,d24d.vuosiselite as "Kirjoihintulovuosi (sek.)"
,d24e.vuosiselite as "Kirjoihintulovuosi (sek. läsnä)"
,d24f.vuosiselite as "Kirjoihintulovuosi (kk)"
,d24f2.lukukausiselite as "Kirjoihintulokausi (kk)"
,d24g.vuosiselite as "Kirjoihintulovuosi (kk läsnä)"
,d24h.vuosiselite as "Kirjoihintulovuosi (op.ala)"
,d24i.vuosiselite as "Kirjoihintulovuosi (op.ala läsnä)"
,d24j.vuosiselite as "Kirjoihintulovuosi (tutk.)"
,d24k.lukukausiselite as "Kirjoihintulokausi (tutk.)"
,d24l.vuosiselite as "Kirjoihintulovuosi (TK määritelmä)"
,d28.vahintaan_55_op_suorittanut as "Suorittanut väh. 55 op"
,d29.opiskelijan_fte_tieto as "Opiskelijan FTE-tieto"
--,d30.opiskelumuoto as Opiskelumuoto
,d31.yliopisto as Yliopistotunnus
,d32.tiedekunta_yo as Tiedekunta
,d33.uusi_vanha_opiskelija as "Uusi/vanha opiskelija"
,d35.opettajankelpoisuus as Opettajankelpoisuus
,d36.avoinvayla as "Hyväksytty avoimen yliop. suoritusten kautta"
,d37.vuosiselite as "Tutkinnon suoritusvuosi"
,d38.lukukausiselite as "Tutk. suorituslukukausi"
,d39.kuukausiselite as "Tutk. suorituskuukausi"
,d40.maanosa as "Kansalaisuus (maanosa)"
,d41.eumaa as "EU-maan kansalainen"
,d42.etamaa as "ETA-maan kansalainen"
,d43.pohjoismaa as "Pohjoismaan kansalainen"
--jarjestysmuuttujat
,d1b.jarjestys as aineisto_otv_jarj
,d2.jarjestys as jarj_aidinkieli
,d2b.jarjestys as jarj_aidinkieli2
--yhdistetyn muuttujan järjestys
,CASE WHEN d2.aidinkieli_versio1_koodi = ''fs'' Or d2b.aidinkieli_versio2_koodi = ''fi'' Or d2b.aidinkieli_versio2_koodi = ''se'' THEN
''1'' When d2.aidinkieli_versio1_koodi = ''sv'' Or d2b.aidinkieli_versio2_koodi = ''sv'' THEN ''2''
 When d2.aidinkieli_versio1_koodi = ''99'' Or d2b.aidinkieli_versio2_koodi = ''99'' THEN ''3'' Else ''4'' End AS ''jarj_aidinkieli3''
--
,d3.jarjestys_avi as jarj_as_avi
,d3.jarjestys_ely as jarj_as_ely
,d3.jarjestys_kielisuhde as jarj_as_kielisuhde
,d3.jarjestys_maakunta as jarj_as_maakunta
,d3.jarjestys as jarj_as_kunta
,d3b.jarjestys_avi as jarj_as_avi1x
,d3b.jarjestys_ely as jarj_as_ely1x
,d3b.jarjestys_kielisuhde as jarj_as_kielisuhde1x
,d3b.jarjestys_maakunta as jarj_as_maakunta1x
,d3b.jarjestys as jarj_as_kunta1x
,d3c.jarjestys_avi as jarj_as_avi2x
,d3c.jarjestys_ely as jarj_as_ely2x
,d3c.jarjestys_kielisuhde as jarj_as_kielisuhde2x
,d3c.jarjestys_maakunta as jarj_as_maakunta2x
,d3c.jarjestys as jarj_as_kunta2x
,d5.jarjestys_ika
,d5.jarjestys_ika5v as jarj_ika5v
,d5b.jarjestys as jarj_syntv
,d6a.jarjestys as jarj_tutk_amk
,d6b.jarjestys as jarj_tutk_yo
,d7.jarjestys as jarj_koultyyppi
,d8.jarjestys as jarj_kansalaisuus
,d8b.jarjestys as jarj_kansalaisuus2
--yhdistetyn muuttujan järjestys
,CASE WHEN d8.kansalaisuus_versio2_koodi = ''1'' Or d8b.kansalaisuus_versio1_koodi = ''1'' THEN
''1'' When d8.kansalaisuus_versio2_koodi = ''2'' Or d8.kansalaisuus_versio2_koodi = ''9'' Or d8b.kansalaisuus_versio1_koodi = ''2'' THEN ''2''
 Else ''99'' End AS ''jarj_kansalaisuus3''
--
,d9.jarjestys_oppilaitos
,d9.jarjestys_opetuskieli
,d9.jarjestys_omistajatyyppi
,d9.jarjestys_oppilaitostyyppi
,d11.jarjestys as jarj_koulohjelma_amk
,d12.jarjestys as jarj_kirjolosyys
,d12b.jarjestys as jarj_kirjolotammi
,d13.jarjestys as jarj_rahoitus
,d15.jarjestys as jarj_suunnvaiht
,d16.jarjestys as jarj_koulkiel
,d16.jarjestys_iso3kirjainta as jarj_koulkiel2
,d17.jarjestys as jarj_ensop
,d18.jarjestys as jarj_tilauskoul
,d19.jarjestys as jarj_koulsek
,d20.jarjestys as jarj_hallinnonala
,d21.jarjestys_koulutusaste2002
,d21.jarjestys_koulutusala2002
,d21.jarjestys_opintoala1995
,d21.jarjestys_opintoala2002
,d21.jarjestys as jarj_koulnimike
,d21b.jarjestys as jarj_koullaji
,d21b.jarjestys2 as jarj_koullaji2
,d22.jarjestys_avi
,d22.jarjestys_ely
,d22.jarjestys_maakunta
,d22.jarjestys_kielisuhde
,d22.jarjestys as jarj_kunta
--yhdistetyn muuttujan järjestys
,CASE WHEN d1b.aineisto_koodi <> ''4.9'' And d1b.aineisto_koodi <> ''3.4'' THEN
d22.jarjestys_maakunta When d1b.aineisto_koodi = ''4.9'' THEN d3.jarjestys_maakunta
 Else ''99'' End AS ''jarj_kmaakunta2''
,CASE WHEN d1b.aineisto_koodi <> ''4.9'' And d1b.aineisto_koodi <> ''3.4'' THEN
d22.jarjestys When d1b.aineisto_koodi = ''4.9'' THEN d3.jarjestys
 Else ''Tuntematon'' End AS ''jarj_kkunta2''
--
,d22b.jarjestys_avi as jarjestys_avi2
,d22b.jarjestys_ely as jarjestys_ely2
,d22b.jarjestys_maakunta as jarjestys_maakunta2
,d22b.jarjestys_kielisuhde as jarjestys_kielisuhde2
,d22b.jarjestys as jarj_kunta2
,d22c.jarjestys_avi as jarjestys_avi3
,d22c.jarjestys_ely as jarjestys_ely3
,d22c.jarjestys_maakunta as jarjestys_maakunta3
,d22c.jarjestys_kielisuhde as jarjestys_kielisuhde3
,d22c.jarjestys as jarj_kunta3
,d23b.jarjestys as jarj_lukukausi
,d24f2.jarjestys as jarj_lukukausi_kk
,d28.jarjestys as jarj_vah55
,d29.jarjestys as jarj_op_fte
--,d30.jarjestys as jarj_opmuoto
,d32.jarjestys as jarj_tiedekunta
,d33.jarjestys as jarj_uusivanha
,d35.jarjestys as jarj_opettajankelpoisuus
,d36.jarjestys as jarj_avoinvayla
,d39.jarjestys as jarj_suor_kk
,d40.jarjestys_maanosa as jarj_kans_maanosa
,d41.jarjestys_eumaa
,d42.jarjestys_etamaa
,d43.jarjestys as jarj_pohj_kans
--Koodimuuttujat
,d1.aineisto_koodi
,d1b.aineisto_koodi as ainesto_koodi_otv
,d2.aidinkieli_versio1_koodi as aidinkieli_koodi
,d2b.aidinkieli_versio2_koodi as aidinkieli2_koodi
--yhdistetyn muuttujan koodi
,CASE WHEN d2.aidinkieli_versio1_koodi = ''fs'' Or d2b.aidinkieli_versio2_koodi = ''fi'' Or d2b.aidinkieli_versio2_koodi = ''se'' THEN
''fs'' When d2.aidinkieli_versio1_koodi = ''sv'' Or d2b.aidinkieli_versio2_koodi = ''sv'' THEN ''sv''
 When d2.aidinkieli_versio1_koodi = ''99'' Or d2b.aidinkieli_versio2_koodi = ''99'' THEN ''99'' Else ''999'' End AS ''aidinkieli3_koodi''
--
,d3.maakunta_koodi as ''Koodit Asuinmaakunta''
,d3.kunta_koodi as ''Koodit Asuinkunta''
,d3b.maakunta_koodi as asmaak1xmk
,d3b.kunta_koodi as asmaak1xk
,d5c.kuukausi as syntk
,d6a.tutkinto_amk_koodi as ''Koodit Tutkinto (amk)''
,d6b.tutkinto_yo_koodi as ''Koodit Tutkinto (yo)''
,d7.koulutustyyppi_koodi as ''Koodit Koulutustyyppi''
,d8.kansalaisuus_versio2_koodi as kansalaisuus_koodi
,d8b.kansalaisuus_versio1_koodi as kansalaisuus2_koodi
--yhdistetyn muuttujan koodi
,CASE WHEN d8.kansalaisuus_versio2_koodi = ''1'' Or d8b.kansalaisuus_versio1_koodi = ''1'' THEN
''1'' When d8.kansalaisuus_versio2_koodi = ''2'' Or d8.kansalaisuus_versio2_koodi = ''9'' Or d8b.kansalaisuus_versio1_koodi = ''2'' THEN ''2''
 Else ''-1'' End AS ''kansalaisuus3_koodi''
--
,case when coalesce(d9.oppilaitoksen_korvaavakoodi,d9.oppilaitoskoodi)=-1 then f.oppilaitos else coalesce(d9.oppilaitoksen_korvaavakoodi,d9.oppilaitoskoodi) end as ''Koodit Oppilaitos''
,d9b.koulutuksen_jarjestajakoodi as ''Koodit Koulutuksen järjestäjä''
,d10.lahde_koodi
,d11.koulutusohjelma_amk_koodi as ''Koodit Koulutusohjelma''
,d12.opiskelijan_olo_koodi as kirjoillaolosyys_koodi
,d12b.opiskelijan_olo_tamm_koodi as kirjoillaolotammi_koodi
,d17.ensisijainen_opintooikeus_koodi as ensiop
,d21.koulutusaste2002_koodi as ''Koodit Koulutusaste 2002''
,d21.koulutusala2002_koodi as ''Koodit Koulutusala 2002''
,d21.opintoala1995_koodi as ''Koodit Koulutusala 1995''
,d21.opintoala2002_koodi as ''Koodit Opintoala 2002''
,d21.koulutus_koodi as ''Koodit Koulutusnimike''
,d22.maakunta_koodi as ''Koodit Koulutuksen maakunta''
,d22.kunta_koodi as ''Koodit Koulutuksen kunta''
--yhdistetyn muuttujan koodi
,CASE WHEN d1b.aineisto_koodi <> ''4.9'' And d1b.aineisto_koodi <> ''3.4'' THEN
d22.maakunta_koodi When d1b.aineisto_koodi = ''4.9'' THEN d3.maakunta_koodi
 Else ''99'' End AS ''Koodit Maakunta''
,CASE WHEN d1b.aineisto_koodi <> ''4.9'' And d1b.aineisto_koodi <> ''3.4'' THEN
d22.kunta_koodi When d1b.aineisto_koodi = ''4.9'' THEN d3.kunta_koodi
 Else ''Tuntematon'' End AS ''Koodit Kunta''
--
,d22b.maakunta_koodi as ''Koodit Koul. järj. maakunta''
,d22b.kunta_koodi as ''Koodit Koul. järj. kunta''
,d22c.maakunta_koodi as ''Koodit Oppil. maakunta''
,d22c.kunta_koodi as ''Koodit Oppil. kunta''
,d23.vuosi as alvv
,d23b.lukukausi as alkk
,d24b.vuosi as alvv_kksek
,d24c.vuosi as alvv_kksek_lasna
,d24d.vuosi as alvv_sek
,d24e.vuosi as alvv_sek_lasna
,d24f.vuosi as alvv_kk
,d24f2.lukukausi as alkk_kk
,d24g.vuosi as alvv_kk_lasna
,d24h.vuosi as alvv_opa
,d24i.vuosi as alvv_opa_lasna
,d24j.vuosi as kirtu1v
,d24k.lukukausi as kirtu1k
,d28.vahintaan_55_op_suorittanut_koodi as op55_koodi
,d37.vuosi as suorv
,d38.lukukausi as suor_lk
,d39.kuukausi as suor_kk
--ruotsi
,[Tilastovuosi] as Statistikår
,d2.aidinkieli_versio1_SV as Modersmål
,d2b.aidinkieli_versio2_SV as "Modersmål (utbildningsstruktur)"
--luodaan yhdistetty äidinkieli-muuttuja, joka toimii aineistojen 2.8, 2.9, ja 4.9 välillä
,CASE WHEN d2.aidinkieli_versio1_koodi = ''fs'' Or d2b.aidinkieli_versio2_koodi = ''fi'' Or d2b.aidinkieli_versio2_koodi = ''se'' THEN
''finska (inn. samiska)'' When d2.aidinkieli_versio1_koodi = ''sv'' Or d2b.aidinkieli_versio2_koodi = ''sv'' THEN ''svenska''
 When d2.aidinkieli_versio1_koodi = ''99'' Or d2b.aidinkieli_versio2_koodi = ''99'' THEN ''andra språk och okänd'' Else ''Okänd'' End as ''Modersmål (finska/andra)SV''
--
--,d3.avi_SV as "Asuinalueen AVISV"
--,d3.ely_SV as "Asuinalueen ELYSV"
--,d3.kielisuhde_SV as "Asuinkunnan kielisuhdeSV"
,d3.maakunta_SV as Bostadslandskap
,d3.kunta_SV as Bostadskommun
--,d3b.avi_SV as "Til.v:tta edeltävä AVISV"
--,d3b.ely_SV as "Til.v:tta edeltävä ELYSV"
--,d3b.kielisuhde_SV as "Til.v:tta ed. asuinkunnan kielisuhdeSV"
--,d3b.maakunta_SV as "Til.v:tta ed. asuinmaakuntaSV"
--,d3b.kunta_SV as "Til.v:tta ed. asuinkuntaSV"
--,d3c.avi_SV as "2v til.v:tta ed. AVISV"
--,d3c.ely_SV as "2v til.v:tta ed. ELYSV"
--,d3c.kielisuhde_SV as "2v til.v:tta ed. asuinkunnan kielisuhdeSV"
--,d3c.maakunta_SV as "2v til.v:tta ed. asuinmaakuntaSV"
--,d3c.kunta_SV as "2v til.v:tta ed. asuinkuntaSV"
,d4.sukupuoli_SV as Kön
,d5.ika_SV as Ålder
,d5.ika5v_SV as Åldersgrupp
,d5b.vuosiselite_SV as Födelseår
--,d5c.kuukausiselite_SV as SyntymäkuukausiSV
,d6a.tutkinto_amk_SV as "Examen (yrkehögskola)"
,d6b.tutkinto_yo_SV as "Examen (universitet)"
,d7.koulutustyyppi_SV as "Typ av utbildning"
,d8.kansalaisuus_versio2_SV as Medborgarskap
,d8b.kansalaisuus_versio1_SV as "Medborgarskap (utbildningsstruktur)"
--luodaan yhdistetty kansalaisuus-muuttuja, joka toimii aineistojen 2.8, 2.9, ja 4.9 välillä
,CASE WHEN d8.kansalaisuus_versio2_koodi = ''1'' Or d8b.kansalaisuus_versio1_koodi = ''1'' THEN
''finländare'' When d8.kansalaisuus_versio2_koodi = ''2'' Or d8.kansalaisuus_versio2_koodi = ''9'' Or d8b.kansalaisuus_versio1_koodi = ''2'' THEN ''andra''
 Else ''Okänd'' End as ''Medborgarskap (finska/andra)''
--
,case f.oppilaitos 
	when ''02543'' then ''Pohjois-Pirkanmaan koulutusinstituutti'' 
	when ''02390'' then ''Pirkanmaan hotelli- ja ravintolaoppilaitos'' 
	when ''01088'' then ''Pirkanmaan ammattioppilaitos'' 
	else d9.oppilaitos_SV end
as Läroanstalt
,d9.oppilaitos_SV as Universitet
,case f.oppilaitos 
	when ''02543'' then ''Pohjois-Pirkanmaan koulutusinstituutti'' 
	when ''02390'' then ''Pirkanmaan hotelli- ja ravintolaoppilaitos'' 
	when ''01088'' then ''Pirkanmaan ammattioppilaitos'' 
	else d9.oppilaitos_SV end
as Yrkeshögskola
--,d9.opetuskieli_SV as OpetuskieliSV
--,d9.oppilaitoksen_omistajatyyppi_SV as "Oppil. omistajatyyppiSV"
--,d9.oppilaitostyyppi_SV as OppilaitostyyppiSV
--,d9b.koulutuksen_jarjestaja_SV as "Koulutuksen järjestäjäSV"
--,d9b.koulutuksen_jarjestajan_omistajatyyppi_SV as "Koul. järj. omistajatyyppiSV"
--,d10.lahde_SV as LähdeSV
,d11.koulutusohjelma_amk_SV as Utbildningsprogram
,d12.opiskelijan_olo_SV as "Inskrivning (september)"
,d12b.opiskelijan_olo_tamm_SV as "Inskrivning (januari)"
,d13.rahoituslahde_SV as Finansieringskälla
--,d15.suuntautumisvaihtoehto_amk_SV as SuuntautumisvaihtoehtoSV
--,d16.kieli_SV as "Koulutuksen kieliSV"
--,d17.ensisijainen_opintooikeus_SV as "Ensisijainen opinto-oikeusSV"
--,d18.tilauskoulutuksen_sijaintimaa_SV as "Tilauskoulutuksen sijaintimaaSV"
,d19.koulutussektori_SV as Utbildningssektor
--,d20.opetushallinnon_koulutus_SV as HallinnonalaSV
,d21.koulutusaste2002_SV as "Utbildningsnivå (2002)"
,d21.koulutusala2002_SV as "Utbildningsområde (2002)"
,d21.opintoala1995_SV as "Utbildningsområde (1995)"
,d21.opintoala2002_SV as "Studieområde (2002)"
,d21.koulutus_SV as Utbildningsbenämning
,d21b.koulutuslaji_okm_SV as Utbildningsslag
,d21b.koulutuslaji_okm2_SV as Utbildningsslag2
--,d22.avi_SV as "Koulutuksen AVISV"
--,d22.ely_SV as "Koulutuksen ELYSV"
,d22.maakunta_SV as "Utbildningens landskap"
--,d22.kielisuhde_SV as "Koul. kunnan kielisuhdeSV"
,d22.kunta_SV as "Utbildningens kommun"
--luodaan yhdistetyt kunta-muuttujat, jotka toimivat aineistojen 2.8, 2.9, ja 4.9 välillä
,CASE WHEN d1b.aineisto_koodi <> ''4.9'' And d1b.aineisto_koodi <> ''3.4'' THEN
d22.maakunta When d1b.aineisto_koodi = ''4.9'' THEN d3.maakunta
 Else ''Tuntematon'' End as ''Landskap''
,CASE WHEN d1b.aineisto_koodi <> ''4.9'' And d1b.aineisto_koodi <> ''3.4'' THEN
d22.kunta When d1b.aineisto_koodi = ''4.9'' THEN d3.kunta
 Else ''Tuntematon'' End as ''Kommun''
--
--,d22b.avi_SV as "Koul. järjestäjän AVISV"
--,d22b.ely_SV as "Koul. järjestäjän ELYSV"
--,d22b.maakunta_SV as "Koul. järjestäjän maakuntaSV"
--,d22b.kielisuhde_SV as "Koul. järj. kunnan kielisuhdeSV"
--,d22b.kunta_SV as "Koul. järjestäjän kuntaSV"
--,d22c.avi_SV as "Oppilaitoksen AVISV"
--,d22c.ely_SV as "Oppilaitoksen ELYSV"
--,d22c.maakunta_SV as "Oppilaitoksen maakuntaSV"
--,d22c.kielisuhde_SV as "Oppil. kunnan kielisuhdeSV"
--,d22c.kunta_SV as "Oppilaitoksen kuntaSV"
--,d23.vuosiselite_SV as "KirjoihintulovuosiSV"
--,d23b.lukukausiselite_SV as "KirjoihintulokausiSV"
--,d24b.vuosiselite_SV as "Kirjoihintulovuosi (kk-sek.)SV"
--,d24c.vuosiselite_SV as "Kirjoihintulovuosi (kk-sek. läsna)SV"
--,d24d.vuosiselite_SV as "Kirjoihintulovuosi (sek.)SV"
--,d24e.vuosiselite_SV as "Kirjoihintulovuosi (sek. läsnä)SV"
--,d24f.vuosiselite_SV as "Kirjoihintulovuosi (kk)SV"
--,d24f2.lukukausiselite_SV as "Kirjoihintulokausi (kk)SV"
--,d24g.vuosiselite_SV as "Kirjoihintulovuosi (kk läsnä)SV"
--,d24h.vuosiselite_SV as "Kirjoihintulovuosi (op.ala)SV"
--,d24i.vuosiselite_SV as "Kirjoihintulovuosi (op.ala läsnä)SV"
--,d24j.vuosiselite_SV as "Kirjoihintulovuosi (tutk.)SV"
--,d24k.lukukausiselite_SV as "Kirjoihintulokausi (tutk.)SV"
--,d28.vahintaan_55_op_suorittanut_SV as "Suorittanut väh. 55 opSV"
--,d29.opiskelijan_fte_tieto_SV as "Opiskelijan FTE-tietoSV"
--,d30.opiskelumuoto_SV as OpiskelumuotoSV
--,d31.yliopisto_SV as YliopistotunnusSV
--,d32.tiedekunta_yo_SV as TiedekuntaSV
--,d33.uusi_vanha_opiskelija_SV as "Uusi/vanha opiskelijaSV"
--,d35.opettajankelpoisuus_SV as OpettajankelpoisuusSV
--,d36.avoinvayla_SV as "Hyväksytty avoimen yliop. suoritusten kauttaSV"
,d37.vuosiselite_SV as "År då utbildningen avlagts"
--,d38.lukukausiselite_SV as "Tutk. suorituslukukausiSV"
--,d39.kuukausiselite_SV as "Tutk. suorituskuukausiSV"
,d40.maanosa_SV as "Medborgarskap (världsdel)"
,d41.eumaa_SV as "Medborgare i ett EU-land"
,d42.etamaa_SV as "Medborgare i ett EES-land"
,d43.pohjoismaa_SV as "Medborgare i ett nordiskt land"
--englanti
,[Tilastovuosi] as "Statistical year"
,d2.aidinkieli_versio1_EN as "Mother tongue"
,d2b.aidinkieli_versio2_EN as "Mother tongue (ed. structure)"
--luodaan yhdistetty äidinkieli-muuttuja, joka toimii aineistojen 2.8, 2.9, ja 4.9 välillä
,CASE WHEN d2.aidinkieli_versio1_koodi = ''fs'' Or d2b.aidinkieli_versio2_koodi = ''fi'' Or d2b.aidinkieli_versio2_koodi = ''se'' THEN
''Finnish (incl. Sami)'' When d2.aidinkieli_versio1_koodi = ''sv'' Or d2b.aidinkieli_versio2_koodi = ''sv'' THEN ''Swedish''
 When d2.aidinkieli_versio1_koodi = ''99'' Or d2b.aidinkieli_versio2_koodi = ''99'' THEN ''Other languages and unknown'' Else ''Unknown'' End as ''Mother tongue (Finnish/Other)''
--
--,d3.avi_EN as "Asuinalueen AVIEN"
--,d3.ely_EN as "Asuinalueen ELYEN"
--,d3.kielisuhde_EN as "Asuinkunnan kielisuhdeEN"
,d3.maakunta_EN as "Region of residence"
,d3.kunta_EN as "Municipality of residence"
--,d3b.avi_EN as "Til.v:tta edeltävä AVIEN"
--,d3b.ely_EN as "Til.v:tta edeltävä ELYEN"
--,d3b.kielisuhde_EN as "Til.v:tta ed. asuinkunnan kielisuhdeEN"
--,d3b.maakunta_EN as "Til.v:tta ed. asuinmaakuntaEN"
--,d3b.kunta_EN as "Til.v:tta ed. asuinkuntaEN"
--,d3c.avi_EN as "2v til.v:tta ed. AVIEN"
--,d3c.ely_EN as "2v til.v:tta ed. ELYEN"
--,d3c.kielisuhde_EN as "2v til.v:tta ed. asuinkunnan kielisuhdeEN"
--,d3c.maakunta_EN as "2v til.v:tta ed. asuinmaakuntaEN"
--,d3c.kunta_EN as "2v til.v:tta ed. asuinkuntaEN"
,d4.sukupuoli_EN as Gender
,d5.ika_EN as Age
,d5.ika5v_EN as Agegroup
,d5b.vuosiselite_EN as "Year of birth"
--,d5c.kuukausiselite_EN as SyntymäkuukausiEN
,d6a.tutkinto_amk_EN as "Degree (polytechnic)"
,d6b.tutkinto_yo_EN as "Degree (university)"
,d7.koulutustyyppi_EN as "Type of education"
,d8.kansalaisuus_versio2_EN as Nationality
,d8b.kansalaisuus_versio1_EN as "Nationality (ed. structure)"
--luodaan yhdistetty kansalaisuus-muuttuja, joka toimii aineistojen 2.8, 2.9, ja 4.9 välillä
,CASE WHEN d8.kansalaisuus_versio2_koodi = ''1'' Or d8b.kansalaisuus_versio1_koodi = ''1'' THEN
''Finn'' When d8.kansalaisuus_versio2_koodi = ''2'' Or d8.kansalaisuus_versio2_koodi = ''9'' Or d8b.kansalaisuus_versio1_koodi = ''2'' THEN ''Other''
 Else ''Unknown'' End as ''Nationality (Finn/Other)''
--
,case f.oppilaitos 
	when ''02543'' then ''Pohjois-Pirkanmaan koulutusinstituutti'' 
	when ''02390'' then ''Pirkanmaan hotelli- ja ravintolaoppilaitos'' 
	when ''01088'' then ''Pirkanmaan ammattioppilaitos'' 
	else d9.oppilaitos_EN end
as "Educational institution"
,d9.oppilaitos_EN as University
,case f.oppilaitos 
	when ''02543'' then ''Pohjois-Pirkanmaan koulutusinstituutti'' 
	when ''02390'' then ''Pirkanmaan hotelli- ja ravintolaoppilaitos'' 
	when ''01088'' then ''Pirkanmaan ammattioppilaitos'' 
	else d9.oppilaitos_EN end
as Polytechnic
--,d9.opetuskieli_EN as OpetuskieliEN
--,d9.oppilaitoksen_omistajatyyppi_EN as "Oppil. omistajatyyppiEN"
--,d9.oppilaitostyyppi_EN as OppilaitostyyppiEN
--,d9b.koulutuksen_jarjestaja_EN as "Koulutuksen järjestäjäEN"
--,d9b.koulutuksen_jarjestajan_omistajatyyppi_EN as "Koul. järj. omistajatyyppiEN"
--,d10.lahde_EN as LähdeEN
,d11.koulutusohjelma_amk_EN as "Degree programme"
,d12.opiskelijan_olo_EN as "Enrollment status (sept.)"
,d12b.opiskelijan_olo_tamm_EN as "Enrollment status (jan.)"
,d13.rahoituslahde_EN as "Source of funding"
--,d15.suuntautumisvaihtoehto_amk_EN as SuuntautumisvaihtoehtoEN
--,d16.kieli_EN as "Koulutuksen kieliEN"
--,d17.ensisijainen_opintooikeus_EN as "Ensisijainen opinto-oikeusEN"
--,d18.tilauskoulutuksen_sijaintimaa_EN as "Tilauskoulutuksen sijaintimaaEN"
,d19.koulutussektori_EN as "Sector of education"
--,d20.opetushallinnon_koulutus_EN as HallinnonalaEN
,d21.koulutusaste2002_EN as "Level of education (2002)"
,d21.koulutusala2002_EN as "Field of education (2002)"
,d21.opintoala1995_EN as "Field of education (1995)"
,d21.opintoala2002_EN as "Subfield of ed. (2002)"
,d21.koulutus_EN as "Name of education"
,d21b.koulutuslaji_okm_EN as "Form of education"
,d21b.koulutuslaji_okm2_EN as "Form of education2"
--,d22.avi_EN as "Koulutuksen AVIEN"
--,d22.ely_EN as "Koulutuksen ELYEN"
,d22.maakunta_EN as "Region of education"
--,d22.kielisuhde_EN as "Koul. kunnan kielisuhdeEN"
,d22.kunta_EN as "Municipality of education"
--luodaan yhdistetyt kunta-muuttujat, jotka toimivat aineistojen 2.8, 2.9, ja 4.9 välillä
,CASE WHEN d1b.aineisto_koodi <> ''4.9'' And d1b.aineisto_koodi <> ''3.4'' THEN
d22.maakunta When d1b.aineisto_koodi = ''4.9'' THEN d3.maakunta
 Else ''Tuntematon'' End as ''Region''
,CASE WHEN d1b.aineisto_koodi <> ''4.9'' And d1b.aineisto_koodi <> ''3.4'' THEN
d22.kunta When d1b.aineisto_koodi = ''4.9'' THEN d3.kunta
 Else ''Tuntematon'' End as ''Municipality''
--
--,d22b.avi_EN as "Koul. järjestäjän AVIEN"
--,d22b.ely_EN as "Koul. järjestäjän ELYEN"
--,d22b.maakunta_EN as "Koul. järjestäjän maakuntaEN"
--,d22b.kielisuhde_EN as "Koul. järj. kunnan kielisuhdeEN"
--,d22b.kunta_EN as "Koul. järjestäjän kuntaEN"
--,d22c.avi_EN as "Oppilaitoksen AVIEN"
--,d22c.ely_EN as "Oppilaitoksen ELYEN"
--,d22c.maakunta_EN as "Oppilaitoksen maakuntaEN"
--,d22c.kielisuhde_EN as "Oppil. kunnan kielisuhdeEN"
--,d22c.kunta_EN as "Oppilaitoksen kuntaEN"
,d23.vuosiselite_EN as "Year of enrollment"
,d23b.lukukausiselite_EN as "Term of enrollment"
,d24b.vuosiselite_EN as "Year of enrollment (HE sec.)"
,d24c.vuosiselite_EN as "Year of enrollment (HE sec. present)"
,d24d.vuosiselite_EN as "Year of enrollment (sec.)"
,d24e.vuosiselite_EN as "Year of enrollment (sec. present)"
,d24f.vuosiselite_EN as "Year of enrollment (ed. inst.)"
,d24f2.lukukausiselite_EN as "Term of enrollment (ed. inst.)"
,d24g.vuosiselite_EN as "Year of enrollment (ed. inst. present)"
,d24h.vuosiselite_EN as "Year of enrollment (subfield of ed.)"
,d24i.vuosiselite_EN as "Year of enrollment (subfield of ed. present)"
,d24j.vuosiselite_EN as "Year of enrollment (degree)"
,d24k.lukukausiselite_EN as "Term of enrollment (degree)"
,d24l.vuosiselite as "Year of enrollment (Statistic Finland''s definition)"
--,d28.vahintaan_55_op_suorittanut_EN as "Suorittanut väh. 55 opEN"
--,d29.opiskelijan_fte_tieto_EN as "Opiskelijan FTE-tietoEN"
--,d30.opiskelumuoto_EN as OpiskelumuotoEN
--,d31.yliopisto_EN as YliopistotunnusEN
--,d32.tiedekunta_yo_EN as TiedekuntaEN
--,d33.uusi_vanha_opiskelija_EN as "Uusi/vanha opiskelijaEN"
--,d35.opettajankelpoisuus_EN as OpettajankelpoisuusEN
--,d36.avoinvayla_EN as "Hyväksytty avoimen yliop. suoritusten kauttaEN"
,d37.vuosiselite_EN as "Year of graduation"
,d38.lukukausiselite_EN as "Term of graduation"
,d39.kuukausiselite_EN as "Month of graduation"
,d40.maanosa_EN as "Nationality (continent)"
,d41.eumaa_EN as "Citizen of EU nation"
,d42.etamaa_EN as "Citizen of EEA nation"
,d43.pohjoismaa_EN as "Citizen of a nordic nation"
--isced
,d21.iscle2011 as "Koulutusaste, taso 1"
,d21.Koulutusaste_taso2 as "Koulutusaste, taso 2"
,d21.iscfibroad2013 as "Koulutusala, taso 1"
,d21.iscfinarrow2013 as "Koulutusala, taso 2"
,d21.iscfi2013 as "Koulutusala, taso 3"
,d21.OKM_ohjauksen_ala as "OKM ohjauksen ala, korkeak."
,d21.iscle2011_SV as "Utbildn.nivå, nivå 1"
,d21.Koulutusaste_taso2_SV as "Utbildn.nivå, nivå 2"
,d21.iscfibroad2013_SV as "Utbildn.område, nivå 1"
,d21.iscfinarrow2013_SV as "Utbildn.område, nivå 2"
,d21.iscfi2013_SV as "Utbildn.område, nivå 3"
,d21.OKM_ohjauksen_ala_SV as "UKM-styrningsområde, högskolor"
,d21.iscle2011_EN as "Level of ed., tier 1"
,d21.Koulutusaste_taso2_EN as "Level of ed., tier 2"
,d21.iscfibroad2013_EN as "Field of education, tier 1"
,d21.iscfinarrow2013_EN as "Field of education, tier 2"
,d21.iscfi2013_EN as "Field of education, tier 3"
,d21.OKM_ohjauksen_ala_EN as "Field of ed., HE steering"
,d21.jarjestys_iscle2011 as jarj_isced_koulast1
,d21.jarjestys_Koulutusaste_taso2 as jarj_isced_koulast2
,d21.jarjestys_iscfibroad2013 as jarj_isced_koulala1
,d21.jarjestys_iscfinarrow2013 as jarj_isced_koulala2
,d21.jarjestys_iscfi2013 as jarj_isced_koulala3
,d21.jarjestys_OKM_ohjauksen_ala as jarj_isced_okmohjaus1
,d21.iscle2011_koodi as "Koodit Koulutusaste, taso 1"
,d21.Koulutusaste_taso2_koodi as "Koodit Koulutusaste, taso 2"
,d21.iscfibroad2013_koodi as "Koodit Koulutusala, taso 1"
,d21.iscfinarrow2013_koodi as "Koodit Koulutusala, taso 2"
,d21.iscfi2013_koodi as "Koodit Koulutusala, taso 3"
,d21.OKM_ohjauksen_ala_koodi as "Koodit OKM ohjauksen ala, korkeak."
--Lukumäärämuuttujat
,[Opisk2]
,[Aloit2]
,[lkm_op55] = CAST((case when d28.vahintaan_55_op_suorittanut_koodi = 1 then [Opisk2] end) as int)
,[lkm_op0]
,[lkm_op1_14]
,[lkm_op15_29]
,[lkm_op30_44]
,[lkm_op45_59]
,[lkm_op60_74]
,[lkm_op75_89]
,[lkm_op90_104]
,[lkm_op105_119]
,[lkm_op120_]
,[aloittaneet_kirjoihintulovuosi]
,[aloittaneet_korkeakoulusektori]
,[aloittaneet_korkeakoulusektori_lasnaoleva]
,[aloittaneet_sektori]
,[aloittaneet_sektori_lasnaoleva]
,[aloittaneet_korkeakoulu]
,[aloittaneet_korkeakoulu_lasnaoleva]
,[aloittaneet_opintoala]
,[aloittaneet_opintoala_lasnaoleva]
,[opiskelijat_lasna]
,[opiskelijat_fte]
,[lkm_lasnalk]
,[lkm_poissalk]
,[op_suoritettavien_laajuus]
,[op_edellinen_syksy]
,[op_edellinen_kevat]
,[op_kertyma_edel_lkv_loppu]
,[Tutk2]
,[op_amk_yhteensa]
,[op_amk_yleissiv_amm_opplait]
,[op_amk_muualla]
,[op_amk_oma_amk]
,[op_amk_muu_amk]
,[op_amk_yliopistoissa]
,[op_amk_ulkomailla]
,[op_yo_yhteensa]
,[op_yo_ulkomailla]
,[op_yo_muualla]
,[op_yo_oma_yo]
,[op_yo_avoimessa]
,[op_yo_muu_yo]
,[op_yo_ammattikorkeakouluissa]
,[ika19_21_lkm]
,[ika20_24_lkm]
,[ika25_34_lkm]
,[ika25_64_lkm]

FROM (
SELECT [tilastointivuosi] as Tilastovuosi
	  ,aineisto_id
	  ,aineisto_OTV_id
	  ,aidinkieli_versio1_id
	  ,aidinkieli_versio2_id = ''-1''
	  ,kotikunta_id
	  ,kotikunta1x_id
	  ,kotikunta2x_id
	  ,sukupuoli_id
	  ,ika_id
	  ,syntymavuosi_id
	  ,syntymakuukausi_id = ''-1''
	  ,tutkinto_amk_id
	  ,tutkinto_yo_id
	  ,koulutustyyppi_id
	  ,kansalaisuus_versio2_id
	  ,kansalaisuus_versio1_id = -1
	  ,oppilaitos_id
	  ,oppilaitos
	  ,koulutuksen_jarjestaja_id
	  ,lahde_id
	  ,koulutusohjelma_amk_id
	  ,opiskelijan_olo_syys_id
	  ,opiskelijan_olo_tamm_id
	  ,rahoituslahde_id
	  ,suuntautumisvaihtoehto_amk_id
	  ,koulutuksen_kieli_id
	  ,ensisijainen_opintooikeus_id
	  ,tilauskoulutuksen_sijaintimaa_id
	  ,koulutussektori_id
	  ,opetushallinnon_koulutus_id
	  ,koulutusluokitus_id
	  ,koulutuslaji_OKM_id
	  ,koulutuksen_kunta_id
	  ,koulutuksen_jarjestaja_kunta_id
	  ,oppilaitos_kunta_id
	  ,kirjoihintulovuosi_id
	  ,kirjoihintulokausi_id
	  ,kirjoihintulovuosi_korkeakoulusektori_id
	  ,kirjoihintulovuosi_korkeakoulusektori_lasnaoleva_id
	  ,kirjoihintulovuosi_sektori_id
	  ,kirjoihintulovuosi_sektori_lasnaoleva_id
	  ,kirjoihintulovuosi_korkeakoulu_id
	  ,kirjoihintulokausi_korkeakoulu_id = ''-1''
	  ,kirjoihintulovuosi_korkeakoulu_lasnaoleva_id
	  ,kirjoihintulovuosi_opintoala_id
	  ,kirjoihintulovuosi_opintoala_lasnaoleva_id
	  ,kirjoihintulovuosi_tutkinto_id
	  ,kirjoihintulokausi_tutkinto_id
	  ,vahintaan_55_op_suorittanut_id
	  ,opiskelijan_fte_tieto_id
	  --,opiskelumuoto_id
	  ,yliopisto_id
	  ,tiedekunta_yo_id
	  ,uusi_vanha_opiskelija_id
	  ,opettajankelpoisuus_id
	  ,avoinvayla_id
	  ,tutkinnon_suoritusvuosi_id = ''-1''
	  ,tutkinnon_suorituslukukausi_id = ''-1''
	  ,tutkinnon_suorituskuukausi_id = ''-1''
	  ,tutkintooikeusvuosi_id
	  ,maanosa_id = -1
	  ,pohjoismaa_id = -1
	  ,eumaa_id = -1
	  ,etamaa_id = -1
	  ,[opiskelijat] as Opisk2
	  ,[aloittaneet] as Aloit2
	  ,[lkm_op0]
	  ,[lkm_op1_14]
	  ,[lkm_op15_29]
	  ,[lkm_op30_44]
	  ,[lkm_op45_59]
	  ,[lkm_op60_74]
	  ,[lkm_op75_89]
	  ,[lkm_op90_104]
	  ,[lkm_op105_119]
	  ,[lkm_op120_]
	  ,[aloittaneet_kirjoihintulovuosi]
	  ,[aloittaneet_korkeakoulusektori]
	  ,[aloittaneet_korkeakoulusektori_lasnaoleva]
	  ,[aloittaneet_sektori]
	  ,[aloittaneet_sektori_lasnaoleva]
	  ,[aloittaneet_korkeakoulu]
	  ,[aloittaneet_korkeakoulu_lasnaoleva]
	  ,[aloittaneet_opintoala]
	  ,[aloittaneet_opintoala_lasnaoleva]
	  ,[opiskelijat_lasna]
	  ,[opiskelijat_fte]
	  ,[lkm_lasnalk]
	  ,[lkm_poissalk]
	  ,[op_suoritettavien_laajuus]
	  ,[op_edellinen_syksy]
	  ,[op_edellinen_kevat]
	  ,[op_kertyma_edel_lkv_loppu]
	  ,[Tutk2] = NULL
	  ,[op_amk_yhteensa] = NULL
	  ,[op_amk_yleissiv_amm_opplait] = NULL
	  ,[op_amk_muualla] = NULL
	  ,[op_amk_oma_amk] = NULL
	  ,[op_amk_muu_amk] = NULL
	  ,[op_amk_yliopistoissa] = NULL
	  ,[op_amk_ulkomailla] = NULL
	  ,[op_yo_yhteensa] = NULL
	  ,[op_yo_ulkomailla] = NULL
	  ,[op_yo_muualla] = NULL
	  ,[op_yo_oma_yo] = NULL
	  ,[op_yo_avoimessa] = NULL
	  ,[op_yo_muu_yo] = NULL
	  ,[op_yo_ammattikorkeakouluissa] = NULL
	  ,[ika19_21_lkm] = NULL
	  ,[ika20_24_lkm] = NULL
	  ,[ika25_34_lkm] = NULL
	  ,[ika25_64_lkm] = NULL
  FROM [dbo].[f_OTV_2_8_Korkeakouluopiskelijat]

UNION ALL
SELECT [tilastointivuosi] as Tilastovuosi
	  ,aineisto_id
	  ,aineisto_OTV_id
	  ,aidinkieli_versio1_id
	  ,aidinkieli_versio2_id = ''-1''
	  ,kotikunta_id
	  ,kotikunta1x_id
	  ,kotikunta2x_id = -1
	  ,sukupuoli_id
	  ,ika_id
	  ,syntymavuosi_id
	  ,syntymakuukausi_id = ''-1''
	  ,tutkinto_amk_id
	  ,tutkinto_yo_id
	  ,koulutustyyppi_id
	  ,kansalaisuus_versio2_id
	  ,kansalaisuus_versio1_id = -1
	  ,oppilaitos_id
	  ,oppilaitos
	  ,koulutuksen_jarjestaja_id
	  ,lahde_id
	  ,koulutusohjelma_amk_id
	  ,opiskelijan_olo_syys_id = -1
	  ,opiskelijan_olo_tamm_id = -1
	  ,rahoituslahde_id
	  ,suuntautumisvaihtoehto_amk_id
	  ,koulutuksen_kieli_id
	  ,ensisijainen_opintooikeus_id = -1
	  ,tilauskoulutuksen_sijaintimaa_id
	  ,koulutussektori_id
	  ,opetushallinnon_koulutus_id
	  ,koulutusluokitus_id
	  ,koulutuslaji_OKM_id
	  ,koulutuksen_kunta_id
	  ,koulutuksen_jarjestaja_kunta_id
	  ,oppilaitos_kunta_id
	  ,kirjoihintulovuosi_id
	  ,kirjoihintulokausi_id
	  ,kirjoihintulovuosi_korkeakoulusektori_id
	  ,kirjoihintulovuosi_korkeakoulusektori_lasnaoleva_id
	  ,kirjoihintulovuosi_sektori_id
	  ,kirjoihintulovuosi_sektori_lasnaoleva_id
	  ,kirjoihintulovuosi_korkeakoulu_id
	  ,kirjoihintulokausi_korkeakoulu_id = ''-1''
	  ,kirjoihintulovuosi_korkeakoulu_lasnaoleva_id
	  ,kirjoihintulovuosi_opintoala_id
	  ,kirjoihintulovuosi_opintoala_lasnaoleva_id
	  ,kirjoihintulovuosi_tutkinto_id
	  ,kirjoihintulokausi_tutkinto_id
	  ,vahintaan_55_op_suorittanut_id = -1
	  ,opiskelijan_fte_tieto_id = -1
	  --,opiskelumuoto_id
	  ,yliopisto_id = -1
	  ,tiedekunta_yo_id
	  ,uusi_vanha_opiskelija_id = -1
	  ,opettajankelpoisuus_id
	  ,avoinvayla_id = -1
	  ,tutkinnon_suoritusvuosi_id
	  ,tutkinnon_suorituslukukausi_id
	  ,tutkinnon_suorituskuukausi_id = ''-1''
	  ,tutkintooikeusvuosi_id = ''-1''
	  ,maanosa_id = -1
	  ,pohjoismaa_id = -1
	  ,eumaa_id = -1
	  ,etamaa_id = -1
	  ,[Opisk2] = NULL
	  ,[Aloit2] = NULL
	  ,[lkm_op0] = NULL
	  ,[lkm_op1_14] = NULL
	  ,[lkm_op15_29] = NULL
	  ,[lkm_op30_44] = NULL
	  ,[lkm_op45_59] = NULL
	  ,[lkm_op60_74] = NULL
	  ,[lkm_op75_89] = NULL
	  ,[lkm_op90_104] = NULL
	  ,[lkm_op105_119] = NULL
	  ,[lkm_op120_] = NULL
	  ,[aloittaneet_kirjoihintulovuosi] = NULL
	  ,[aloittaneet_korkeakoulusektori] = NULL
	  ,[aloittaneet_korkeakoulusektori_lasnaoleva] = NULL
	  ,[aloittaneet_sektori] = NULL
	  ,[aloittaneet_sektori_lasnaoleva] = NULL
	  ,[aloittaneet_korkeakoulu] = NULL
	  ,[aloittaneet_korkeakoulu_lasnaoleva] = NULL
	  ,[aloittaneet_opintoala] = NULL
	  ,[aloittaneet_opintoala_lasnaoleva] = NULL
	  ,[opiskelijat_lasna] = NULL
	  ,[opiskelijat_fte] = NULL
	  ,[lkm_lasnalk]
	  ,[lkm_poissalk]
	  ,[op_suoritettavien_laajuus]
	  ,[op_edellinen_syksy] = NULL
	  ,[op_edellinen_kevat] = NULL
	  ,[op_kertyma_edel_lkv_loppu] = NULL
	  ,[lukumaara] as Tutk2
	  ,[op_amk_yhteensa]
	  ,[op_amk_yleissiv_amm_opplait]
	  ,[op_amk_muualla]
	  ,[op_amk_oma_amk]
	  ,[op_amk_muu_amk]
	  ,[op_amk_yliopistoissa]
	  ,[op_amk_ulkomailla]
	  ,[op_yo_yhteensa]
	  ,[op_yo_ulkomailla]
	  ,[op_yo_muualla]
	  ,[op_yo_oma_yo]
	  ,[op_yo_avoimessa]
	  ,[op_yo_muu_yo]
	  ,[op_yo_ammattikorkeakouluissa]
	  ,[ika19_21_lkm] = NULL
	  ,[ika20_24_lkm] = NULL
	  ,[ika25_34_lkm] = NULL
	  ,[ika25_64_lkm] = NULL
  FROM [dbo].[f_OTV_2_9_Korkeakoulututkinnot]

UNION ALL
SELECT [tilastointivuosi] as Tilastovuosi
	  ,aineisto_id
	  ,aineisto_OTV_id
	  ,aidinkieli_versio1_id = -1
	  ,aidinkieli_versio2_id
	  ,kotikunta_id
	  ,kotikunta1x_id = -1
	  ,kotikunta2x_id = -1
	  ,sukupuoli_id
	  ,ika_id = ''-1''
	  ,syntymavuosi_id = ''-1''
	  ,syntymakuukausi_id = ''-1''
	  ,tutkinto_amk_id = -1
	  ,tutkinto_yo_id = -1
	  ,koulutustyyppi_id = -1
	  ,kansalaisuus_versio2_id = -1
	  ,kansalaisuus_versio1_id
	  ,oppilaitos_id = -1
	  ,oppilaitos = -1
	  ,koulutuksen_jarjestaja_id = -1
	  ,lahde_id = -1
	  ,koulutusohjelma_amk_id = -1
	  ,opiskelijan_olo_syys_id = -1
	  ,opiskelijan_olo_tamm_id = -1
	  ,rahoituslahde_id = -1
	  ,suuntautumisvaihtoehto_amk_id = -1
	  ,koulutuksen_kieli_id = -1
	  ,ensisijainen_opintooikeus_id = -1
	  ,tilauskoulutuksen_sijaintimaa_id = -1
	  ,koulutussektori_id = -1
	  ,opetushallinnon_koulutus_id = -1
	  ,koulutusluokitus_id = -1
	  ,koulutuslaji_OKM_id = -1
	  ,koulutuksen_kunta_id = -1
	  ,koulutuksen_jarjestaja_kunta_id = -1
	  ,oppilaitos_kunta_id = -1
	  ,kirjoihintulovuosi_id = ''-1''
	  ,kirjoihintulokausi_id = ''-1''
	  ,kirjoihintulovuosi_korkeakoulusektori_id = ''-1''
	  ,kirjoihintulovuosi_korkeakoulusektori_lasnaoleva_id = ''-1''
	  ,kirjoihintulovuosi_sektori_id = ''-1''
	  ,kirjoihintulovuosi_sektori_lasnaoleva_id = ''-1''
	  ,kirjoihintulovuosi_korkeakoulu_id = ''-1''
	  ,kirjoihintulokausi_korkeakoulu_id = ''-1''
	  ,kirjoihintulovuosi_korkeakoulu_lasnaoleva_id = ''-1''
	  ,kirjoihintulovuosi_opintoala_id = ''-1''
	  ,kirjoihintulovuosi_opintoala_lasnaoleva_id = ''-1''
	  ,kirjoihintulovuosi_tutkinto_id = ''-1''
	  ,kirjoihintulokausi_tutkinto_id = ''-1''
	  ,vahintaan_55_op_suorittanut_id = -1
	  ,opiskelijan_fte_tieto_id = -1
	  --,opiskelumuoto_id = -1
	  ,yliopisto_id = -1
	  ,tiedekunta_yo_id = -1
	  ,uusi_vanha_opiskelija_id = -1
	  ,opettajankelpoisuus_id = -1
	  ,avoinvayla_id = -1
	  ,tutkinnon_suoritusvuosi_id = ''-1''
	  ,tutkinnon_suorituslukukausi_id = ''-1''
	  ,tutkinnon_suorituskuukausi_id = ''-1''
	  ,tutkintooikeusvuosi_id = ''-1''
	  ,maanosa_id
	  ,pohjoismaa_id
	  ,eumaa_id
	  ,etamaa_id
	  ,[Opisk2] = NULL
	  ,[Aloit2] = NULL
	  ,[lkm_op0] = NULL
	  ,[lkm_op1_14] = NULL
	  ,[lkm_op15_29] = NULL
	  ,[lkm_op30_44] = NULL
	  ,[lkm_op45_59] = NULL
	  ,[lkm_op60_74] = NULL
	  ,[lkm_op75_89] = NULL
	  ,[lkm_op90_104] = NULL
	  ,[lkm_op105_119] = NULL
	  ,[lkm_op120_] = NULL
	  ,[aloittaneet_kirjoihintulovuosi] = NULL
	  ,[aloittaneet_korkeakoulusektori] = NULL
	  ,[aloittaneet_korkeakoulusektori_lasnaoleva] = NULL
	  ,[aloittaneet_sektori] = NULL
	  ,[aloittaneet_sektori_lasnaoleva] = NULL
	  ,[aloittaneet_korkeakoulu] = NULL
	  ,[aloittaneet_korkeakoulu_lasnaoleva] = NULL
	  ,[aloittaneet_opintoala] = NULL
	  ,[aloittaneet_opintoala_lasnaoleva] = NULL
	  ,[opiskelijat_lasna] = NULL
	  ,[opiskelijat_fte] = NULL
	  ,[lkm_lasnalk] = NULL
	  ,[lkm_poissalk] = NULL
	  ,[op_suoritettavien_laajuus] = NULL
	  ,[op_edellinen_syksy] = NULL
	  ,[op_edellinen_kevat] = NULL
	  ,[op_kertyma_edel_lkv_loppu] = NULL
	  ,[Tutk2] = NULL
	  ,[op_amk_yhteensa] = NULL
	  ,[op_amk_yleissiv_amm_opplait] = NULL
	  ,[op_amk_muualla] = NULL
	  ,[op_amk_oma_amk] = NULL
	  ,[op_amk_muu_amk] = NULL
	  ,[op_amk_yliopistoissa] = NULL
	  ,[op_amk_ulkomailla] = NULL
	  ,[op_yo_yhteensa] = NULL
	  ,[op_yo_ulkomailla] = NULL
	  ,[op_yo_muualla] = NULL
	  ,[op_yo_oma_yo] = NULL
	  ,[op_yo_avoimessa] = NULL
	  ,[op_yo_muu_yo] = NULL
	  ,[op_yo_ammattikorkeakouluissa] = NULL
	  ,[ika19_21_lkm]
	  ,[ika20_24_lkm]
	  ,[ika25_34_lkm]
	  ,[ika25_64_lkm]
  FROM [dbo].[f_OTV_4_9_Vaestorakenne_kunnittain]

  ) f
	INNER JOIN [dbo].d_aineisto d1 ON d1.id = f.aineisto_id
	INNER JOIN [dbo].d_aineisto_OTV d1b ON d1b.id = f.aineisto_OTV_id
	INNER JOIN [dbo].d_aidinkieli_versio1 d2 ON d2.id = f.aidinkieli_versio1_id
	INNER JOIN [dbo].d_aidinkieli_versio2 d2b ON d2b.id = f.aidinkieli_versio2_id
	INNER JOIN [dbo].d_alueluokitus d3 ON d3.id = f.kotikunta_id
	INNER JOIN [dbo].d_alueluokitus d3b ON d3b.id = f.kotikunta1x_id
	INNER JOIN [dbo].d_alueluokitus d3c ON d3c.id = f.kotikunta2x_id
	INNER JOIN [dbo].d_sukupuoli d4 ON d4.id = f.sukupuoli_id
	INNER JOIN [dbo].d_ika d5 ON d5.id = f.ika_id
	INNER JOIN [dbo].d_kausi d5b ON d5b.kausi_id = f.syntymavuosi_id
	INNER JOIN [dbo].d_kausi d5c ON d5c.kausi_id = f.syntymakuukausi_id
	INNER JOIN [dbo].d_tutkinto_amk d6a ON d6a.id = f.tutkinto_amk_id
	INNER JOIN [dbo].d_tutkinto_yo d6b ON d6b.id = f.tutkinto_yo_id
	INNER JOIN [dbo].d_koulutustyyppi d7 ON d7.id = f.koulutustyyppi_id
	INNER JOIN [dbo].d_kansalaisuus_versio2 d8 ON d8.id = f.kansalaisuus_versio2_id
	INNER JOIN [dbo].d_kansalaisuus_versio1 d8b ON d8b.id = f.kansalaisuus_versio1_id
	INNER JOIN [dbo].d_oppilaitoksen_taustatiedot d9 ON d9.id = f.oppilaitos_id
	INNER JOIN [dbo].d_oppilaitoksen_taustatiedot d9b ON d9b.id = f.koulutuksen_jarjestaja_id
	INNER JOIN [dbo].d_lahde d10 ON d10.id = f.lahde_id
	INNER JOIN [dbo].d_koulutusohjelma_amk d11 ON d11.id = f.koulutusohjelma_amk_id
	INNER JOIN [dbo].d_opiskelijan_olo d12 ON d12.id = f.opiskelijan_olo_syys_id
	INNER JOIN [dbo].d_opiskelijan_olo_tamm d12b ON d12b.id = f.opiskelijan_olo_tamm_id
	INNER JOIN [dbo].d_rahoituslahde d13 ON d13.id = f.rahoituslahde_id
	INNER JOIN [dbo].d_suuntautumisvaihtoehto_amk d15 ON d15.id = f.suuntautumisvaihtoehto_amk_id
	INNER JOIN [dbo].d_kieli d16 ON d16.id = f.koulutuksen_kieli_id
	INNER JOIN [dbo].d_ensisijainen_opintooikeus d17 ON d17.id = f.ensisijainen_opintooikeus_id
	INNER JOIN [dbo].d_tilauskoulutuksen_sijaintimaa d18 ON d18.id = f.tilauskoulutuksen_sijaintimaa_id
	INNER JOIN [dbo].d_koulutussektori d19 ON d19.id = f.koulutussektori_id
	INNER JOIN [dbo].d_opetushallinnon_koulutus d20 ON d20.id = f.opetushallinnon_koulutus_id
	INNER JOIN [dbo].d_koulutusluokitus d21 ON d21.id = f.koulutusluokitus_id
	INNER JOIN [dbo].d_koulutuslaji_okm d21b ON d21b.id = f.koulutuslaji_OKM_id
	INNER JOIN [dbo].d_alueluokitus d22 ON d22.id = f.koulutuksen_kunta_id
	INNER JOIN [dbo].d_alueluokitus d22b ON d22b.id = f.koulutuksen_jarjestaja_kunta_id
	INNER JOIN [dbo].d_alueluokitus d22c ON d22c.id = f.oppilaitos_kunta_id
	INNER JOIN [dbo].d_kausi d23 ON d23.kausi_id = f.kirjoihintulovuosi_id
	INNER JOIN [dbo].d_kausi d23b ON d23b.kausi_id = f.kirjoihintulokausi_id
	INNER JOIN [dbo].d_kausi d24b ON d24b.kausi_id = f.kirjoihintulovuosi_korkeakoulusektori_id
	INNER JOIN [dbo].d_kausi d24c ON d24c.kausi_id = f.kirjoihintulovuosi_korkeakoulusektori_lasnaoleva_id
	INNER JOIN [dbo].d_kausi d24d ON d24d.kausi_id = f.kirjoihintulovuosi_sektori_id
	INNER JOIN [dbo].d_kausi d24e ON d24e.kausi_id = f.kirjoihintulovuosi_sektori_lasnaoleva_id
	INNER JOIN [dbo].d_kausi d24f ON d24f.kausi_id = f.kirjoihintulovuosi_korkeakoulu_id
	INNER JOIN [dbo].d_kausi d24f2 ON d24f2.kausi_id = f.kirjoihintulokausi_korkeakoulu_id
	INNER JOIN [dbo].d_kausi d24g ON d24g.kausi_id = f.kirjoihintulovuosi_korkeakoulu_lasnaoleva_id
	INNER JOIN [dbo].d_kausi d24h ON d24h.kausi_id = f.kirjoihintulovuosi_opintoala_id
	INNER JOIN [dbo].d_kausi d24i ON d24i.kausi_id = f.kirjoihintulovuosi_opintoala_lasnaoleva_id
	INNER JOIN [dbo].d_kausi d24j ON d24j.kausi_id = f.kirjoihintulovuosi_tutkinto_id
	INNER JOIN [dbo].d_kausi d24k ON d24k.kausi_id = f.kirjoihintulokausi_tutkinto_id
	INNER JOIN [dbo].d_kausi d24l ON d24l.kausi_id = f.tutkintooikeusvuosi_id
	INNER JOIN [dbo].d_vahintaan_55_op_suorittanut d28 ON d28.id = f.vahintaan_55_op_suorittanut_id
	INNER JOIN [dbo].d_opiskelijan_fte_tieto d29 ON d29.id = f.opiskelijan_fte_tieto_id
	--INNER JOIN [dbo].d_opiskelumuoto d30 ON d30.id = f.opiskelumuoto_id
	INNER JOIN [dbo].d_yliopisto d31 ON d31.id = f.yliopisto_id
	INNER JOIN [dbo].d_tiedekunta_yo d32 ON d32.id = f.tiedekunta_yo_id
	INNER JOIN [dbo].d_uusi_vanha_opiskelija d33 ON d33.id = f.uusi_vanha_opiskelija_id
	--INNER JOIN [dbo].d_kausi d34 ON d34.kausi_id = f.tutkintooikeusvuosi_id
	INNER JOIN [dbo].d_opettajankelpoisuus d35 ON d35.id = f.opettajankelpoisuus_id
	INNER JOIN [dbo].d_avoinvayla d36 ON d36.id = f.avoinvayla_id
	INNER JOIN [dbo].d_kausi d37 ON d37.kausi_id = f.tutkinnon_suoritusvuosi_id
	INNER JOIN [dbo].d_kausi d38 ON d38.kausi_id = f.tutkinnon_suorituslukukausi_id
	INNER JOIN [dbo].d_kausi d39 ON d39.kausi_id = f.tutkinnon_suorituskuukausi_id
	INNER JOIN [dbo].d_valtio_historia d40 ON d40.id = f.maanosa_id
	INNER JOIN [dbo].d_valtio_historia d41 ON d41.id = f.eumaa_id
	INNER JOIN [dbo].d_valtio_historia d42 ON d42.id = f.etamaa_id
	INNER JOIN [dbo].d_pohjoismaa d43 ON d43.id = f.pohjoismaa_id
WHERE 
d1.aineisto_koodi=
(case
	when d1b.aineisto like ''2.8%'' then (case when NOT EXISTS (SELECT 1 FROM [dbo].[f_OTV_2_8_Korkeakouluopiskelijat] o WHERE o.aineisto=''L'' and o.tilastointivuosi=f.Tilastovuosi) then ''E'' else ''L'' end)
	when d1b.aineisto like ''2.9%'' then (case when NOT EXISTS (SELECT 1 FROM [dbo].[f_OTV_2_9_Korkeakoulututkinnot] o WHERE o.aineisto=''L'' and o.tilastointivuosi=f.Tilastovuosi) then ''E'' else ''L'' end)
	else ''-1''
end
)
AND d9.oppilaitoskoodi <> ''02557'' AND d9.oppilaitoskoodi <> ''10031'' AND d9.oppilaitoskoodi <> ''02358''
AND coalesce(d9.oppilaitoksen_korvaavakoodi,d9.oppilaitoskoodi) not in (''01029'',''01569'',''10102'') --ahvenanmaan oppilaitokset pois


















' 
GO
/****** Object:  View [dbo].[v_f_tab_otv_korkeakoulut_yliopisto]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_otv_korkeakoulut_yliopisto]'))
EXEC dbo.sp_executesql @statement = N'




CREATE VIEW [dbo].[v_f_tab_otv_korkeakoulut_yliopisto] AS

Select
[Tilastovuosi]
,Opiskeluvuosi = 
	CASE
		WHEN d23.kausi_id = -1 THEN d23.vuosiselite
		ELSE CAST(CAST(Tilastovuosi as int) - CAST(d23.vuosiselite as int) AS varchar(10))
	END
,jarj_opiskeluvuosi = 
	CASE
		WHEN d23.kausi_id = -1 THEN 999
		ELSE CAST(Tilastovuosi as int) - CAST(d23.vuosiselite as int)
	END
,d1.aineisto as Aineisto
,d1b.aineisto as Aineisto_OTV
,d1b.kaikkien_asteiden_koulutus as ''Kaikkien asteiden koulutus''
,d1b.tilastointivuosi as OTV_Tilv
,d2.aidinkieli_versio1 as Äidinkieli
,d2b.aidinkieli_versio2 as "Äidinkieli (väestörakenne)"
--luodaan yhdistetty äidinkieli-muuttuja, joka toimii aineistojen 2.8, 2.9, ja 4.9 välillä
,CASE WHEN d2.aidinkieli_versio1_koodi = ''fs'' Or d2b.aidinkieli_versio2_koodi = ''fi'' Or d2b.aidinkieli_versio2_koodi = ''se'' THEN
''suomi (sis. saame)'' When d2.aidinkieli_versio1_koodi = ''sv'' Or d2b.aidinkieli_versio2_koodi = ''sv'' THEN ''ruotsi''
 When d2.aidinkieli_versio1_koodi = ''99'' Or d2b.aidinkieli_versio2_koodi = ''99'' THEN ''muut kielet ja tuntematon'' Else ''Tuntematon'' End AS ''Äidinkieli (suomi/muu)''
--
,d3.avi as "Asuinalueen AVI"
,d3.ely as "Asuinalueen ELY"
,d3.kielisuhde as "Asuinkunnan kielisuhde"
,d3.maakunta as Asuinmaakunta
,d3.kunta as Asuinkunta
,d3b.avi as "Til.v:tta edeltävä AVI"
,d3b.ely as "Til.v:tta edeltävä ELY"
,d3b.kielisuhde as "Til.v:tta ed. asuinkunnan kielisuhde"
,d3b.maakunta as "Til.v:tta ed. asuinmaakunta"
,d3b.kunta as "Til.v:tta ed. asuinkunta"
,d3c.avi as "2v til.v:tta ed. AVI"
,d3c.ely as "2v til.v:tta ed. ELY"
,d3c.kielisuhde as "2v til.v:tta ed. asuinkunnan kielisuhde"
,d3c.maakunta as "2v til.v:tta ed. asuinmaakunta"
,d3c.kunta as "2v til.v:tta ed. asuinkunta"
,d4.sukupuoli as Sukupuoli
,d5.ika as Ikä
,d5.ika5v as Ikäryhmä
,d5b.vuosiselite as Syntymävuosi
,d5c.kuukausiselite as Syntymäkuukausi
,d6b.tutkinto_yo as "Tutkinto (yo)"
,d7.koulutustyyppi as Koulutustyyppi
,d8.kansalaisuus_versio2 as Kansalaisuus
,d8b.kansalaisuus_versio1 as "Kansalaisuus (väestörakenne)"
--luodaan yhdistetty kansalaisuus-muuttuja, joka toimii aineistojen 2.8, 2.9, ja 4.9 välillä
,CASE WHEN d8.kansalaisuus_versio2_koodi = ''1'' Or d8b.kansalaisuus_versio1_koodi = ''1'' THEN
''suomi'' When d8.kansalaisuus_versio2_koodi = ''2'' Or d8.kansalaisuus_versio2_koodi = ''9'' Or d8b.kansalaisuus_versio1_koodi = ''2'' THEN ''muu''
 Else ''Tuntematon'' End AS ''Kansalaisuus (suomi/muu)''
--
,d9.oppilaitos as Yliopisto
,d9.opetuskieli as Opetuskieli
,d9.oppilaitoksen_omistajatyyppi as "Oppil. omistajatyyppi"
,d9.oppilaitostyyppi as Oppilaitostyyppi
,d9b.koulutuksen_jarjestaja as "Koulutuksen järjestäjä"
,d9b.koulutuksen_jarjestajan_omistajatyyppi as "Koul. järj. omistajatyyppi"
,d10.lahde as Lähde
,d11.koulutusohjelma_amk as Koulutusohjelma
,d12.opiskelijan_olo as "Kirjoillaolo (syys)"
,d12b.opiskelijan_olo_tamm as "Kirjoillaolo (tammi)"
,d13.rahoituslahde as Rahoituslähde
,d15.suuntautumisvaihtoehto_amk as Suuntautumisvaihtoehto
,d16.kieli as "Koulutuksen kieli"
,d17.ensisijainen_opintooikeus as "Ensisijainen opinto-oikeus"
,d18.tilauskoulutuksen_sijaintimaa as "Tilauskoulutuksen sijaintimaa"
,d19.koulutussektori as Koulutussektori
,d20.opetushallinnon_koulutus as Hallinnonala
,d21.koulutusaste2002 as "Koulutusaste (2002)"
,d21.koulutusala2002 as "Koulutusala (2002)"
,d21.opintoala1995 as "Koulutusala (1995)"
,d21.opintoala2002 as "Opintoala (2002)"
,d21.koulutus as Koulutusnimike
,d21b.koulutuslaji_okm as Koulutuslaji
,d21b.koulutuslaji_okm2 as Koulutuslaji2
,d22.avi as "Koulutuksen AVI"
,d22.ely as "Koulutuksen ELY"
,d22.maakunta as "Koulutuksen maakunta"
,d22.kielisuhde as "Koul. kunnan kielisuhde"
,d22.kunta as "Koulutuksen kunta"
--luodaan yhdistetyt kunta-muuttujat, jotka toimivat aineistojen 2.8, 2.9, ja 4.9 välillä
,CASE WHEN d1b.aineisto_koodi <> ''4.9'' And d1b.aineisto_koodi <> ''3.4'' THEN
d22.maakunta When d1b.aineisto_koodi = ''4.9'' THEN d3.maakunta
 Else ''Tuntematon'' End AS ''Maakunta''
,CASE WHEN d1b.aineisto_koodi <> ''4.9'' And d1b.aineisto_koodi <> ''3.4'' THEN
d22.kunta When d1b.aineisto_koodi = ''4.9'' THEN d3.kunta
 Else ''Tuntematon'' End AS ''Kunta''
--
,d22b.avi as "Koul. järjestäjän AVI"
,d22b.ely as "Koul. järjestäjän ELY"
,d22b.maakunta as "Koul. järjestäjän maakunta"
,d22b.kielisuhde as "Koul. järj. kunnan kielisuhde"
,d22b.kunta as "Koul. järjestäjän kunta"
,d22c.avi as "Oppilaitoksen AVI"
,d22c.ely as "Oppilaitoksen ELY"
,d22c.maakunta as "Oppilaitoksen maakunta"
,d22c.kielisuhde as "Oppil. kunnan kielisuhde"
,d22c.kunta as "Oppilaitoksen kunta"
,d23.vuosiselite as "Kirjoihintulovuosi"
,d23b.lukukausiselite as "Kirjoihintulokausi"
,d24b.vuosiselite as "Kirjoihintulovuosi (kk-sek.)"
,d24c.vuosiselite as "Kirjoihintulovuosi (kk-sek. läsna)"
,d24d.vuosiselite as "Kirjoihintulovuosi (sek.)"
,d24e.vuosiselite as "Kirjoihintulovuosi (sek. läsnä)"
,d24f.vuosiselite as "Kirjoihintulovuosi (kk)"
,d24f2.lukukausiselite as "Kirjoihintulokausi (kk)"
,d24g.vuosiselite as "Kirjoihintulovuosi (kk läsnä)"
,d24h.vuosiselite as "Kirjoihintulovuosi (op.ala)"
,d24i.vuosiselite as "Kirjoihintulovuosi (op.ala läsnä)"
,d24j.vuosiselite as "Kirjoihintulovuosi (tutk.)"
,d24k.lukukausiselite as "Kirjoihintulokausi (tutk.)"
,d24l.vuosiselite as "Kirjoihintulovuosi (TK määritelmä)"
,d28.vahintaan_55_op_suorittanut as "Suorittanut väh. 55 op"
,d29.opiskelijan_fte_tieto as "Opiskelijan FTE-tieto"
--,d30.opiskelumuoto as Opiskelumuoto
,d31.yliopisto as Yliopistotunnus
,d32.tiedekunta_yo as Tiedekunta
,d33.uusi_vanha_opiskelija as "Uusi/vanha opiskelija"
,d35.opettajankelpoisuus as Opettajankelpoisuus
,d36.avoinvayla as "Hyväksytty avoimen yliop. suoritusten kautta"
,d37.vuosiselite as "Tutkinnon suoritusvuosi"
,d38.lukukausiselite as "Tutk. suorituslukukausi"
,d39.kuukausiselite as "Tutk. suorituskuukausi"
,d40.maanosa as "Kansalaisuus (maanosa)"
,d41.eumaa as "EU-maan kansalainen"
,d42.etamaa as "ETA-maan kansalainen"
,d43.pohjoismaa as "Pohjoismaan kansalainen"
--jarjestysmuuttujat
,d1b.jarjestys as aineisto_otv_jarj
,d2.jarjestys as jarj_aidinkieli
,d2b.jarjestys as jarj_aidinkieli2
--yhdistetyn muuttujan järjestys
,CASE WHEN d2.aidinkieli_versio1_koodi = ''fs'' Or d2b.aidinkieli_versio2_koodi = ''fi'' Or d2b.aidinkieli_versio2_koodi = ''se'' THEN
''1'' When d2.aidinkieli_versio1_koodi = ''sv'' Or d2b.aidinkieli_versio2_koodi = ''sv'' THEN ''2''
 When d2.aidinkieli_versio1_koodi = ''99'' Or d2b.aidinkieli_versio2_koodi = ''99'' THEN ''3'' Else ''4'' End AS ''jarj_aidinkieli3''
--
,d3.jarjestys_avi as jarj_as_avi
,d3.jarjestys_ely as jarj_as_ely
,d3.jarjestys_kielisuhde as jarj_as_kielisuhde
,d3.jarjestys_maakunta as jarj_as_maakunta
,d3.jarjestys as jarj_as_kunta
,d3b.jarjestys_avi as jarj_as_avi1x
,d3b.jarjestys_ely as jarj_as_ely1x
,d3b.jarjestys_kielisuhde as jarj_as_kielisuhde1x
,d3b.jarjestys_maakunta as jarj_as_maakunta1x
,d3b.jarjestys as jarj_as_kunta1x
,d3c.jarjestys_avi as jarj_as_avi2x
,d3c.jarjestys_ely as jarj_as_ely2x
,d3c.jarjestys_kielisuhde as jarj_as_kielisuhde2x
,d3c.jarjestys_maakunta as jarj_as_maakunta2x
,d3c.jarjestys as jarj_as_kunta2x
,d5.jarjestys_ika
,d5.jarjestys_ika5v as jarj_ika5v
,d5b.jarjestys as jarj_syntv
,d6a.jarjestys as jarj_tutk_amk
,d6b.jarjestys as jarj_tutk_yo
,d7.jarjestys as jarj_koultyyppi
,d8.jarjestys as jarj_kansalaisuus
,d8b.jarjestys as jarj_kansalaisuus2
--yhdistetyn muuttujan järjestys
,CASE WHEN d8.kansalaisuus_versio2_koodi = ''1'' Or d8b.kansalaisuus_versio1_koodi = ''1'' THEN
''1'' When d8.kansalaisuus_versio2_koodi = ''2'' Or d8.kansalaisuus_versio2_koodi = ''9'' Or d8b.kansalaisuus_versio1_koodi = ''2'' THEN ''2''
 Else ''99'' End AS ''jarj_kansalaisuus3''
--
,d9.jarjestys_oppilaitos
,d9.jarjestys_opetuskieli
,d9.jarjestys_omistajatyyppi
,d9.jarjestys_oppilaitostyyppi
,d11.jarjestys as jarj_koulohjelma_amk
,d12.jarjestys as jarj_kirjolosyys
,d12b.jarjestys as jarj_kirjolotammi
,d13.jarjestys as jarj_rahoitus
,d15.jarjestys as jarj_suunnvaiht
,d16.jarjestys as jarj_koulkiel
,d16.jarjestys_iso3kirjainta as jarj_koulkiel2
,d17.jarjestys as jarj_ensop
,d18.jarjestys as jarj_tilauskoul
,d19.jarjestys as jarj_koulsek
,d20.jarjestys as jarj_hallinnonala
,d21.jarjestys_koulutusaste2002
,d21.jarjestys_koulutusala2002
,d21.jarjestys_opintoala1995
,d21.jarjestys_opintoala2002
,d21.jarjestys as jarj_koulnimike
,d21b.jarjestys as jarj_koullaji
,d21b.jarjestys2 as jarj_koullaji2
,d22.jarjestys_avi
,d22.jarjestys_ely
,d22.jarjestys_maakunta
,d22.jarjestys_kielisuhde
,d22.jarjestys as jarj_kunta
--yhdistetyn muuttujan järjestys
,CASE WHEN d1b.aineisto_koodi <> ''4.9'' And d1b.aineisto_koodi <> ''3.4'' THEN
d22.jarjestys_maakunta When d1b.aineisto_koodi = ''4.9'' THEN d3.jarjestys_maakunta
 Else ''99'' End AS ''jarj_kmaakunta2''
,CASE WHEN d1b.aineisto_koodi <> ''4.9'' And d1b.aineisto_koodi <> ''3.4'' THEN
d22.jarjestys When d1b.aineisto_koodi = ''4.9'' THEN d3.jarjestys
 Else ''Tuntematon'' End AS ''jarj_kkunta2''
--
,d22b.jarjestys_avi as jarjestys_avi2
,d22b.jarjestys_ely as jarjestys_ely2
,d22b.jarjestys_maakunta as jarjestys_maakunta2
,d22b.jarjestys_kielisuhde as jarjestys_kielisuhde2
,d22b.jarjestys as jarj_kunta2
,d22c.jarjestys_avi as jarjestys_avi3
,d22c.jarjestys_ely as jarjestys_ely3
,d22c.jarjestys_maakunta as jarjestys_maakunta3
,d22c.jarjestys_kielisuhde as jarjestys_kielisuhde3
,d22c.jarjestys as jarj_kunta3
,d23b.jarjestys as jarj_lukukausi
,d24f2.jarjestys as jarj_lukukausi_kk
,d28.jarjestys as jarj_vah55
,d29.jarjestys as jarj_op_fte
--,d30.jarjestys as jarj_opmuoto
,d32.jarjestys as jarj_tiedekunta
,d33.jarjestys as jarj_uusivanha
,d35.jarjestys as jarj_opettajankelpoisuus
,d36.jarjestys as jarj_avoinvayla
,d39.jarjestys as jarj_suor_kk
,d40.jarjestys_maanosa as jarj_kans_maanosa
,d41.jarjestys_eumaa
,d42.jarjestys_etamaa
,d43.jarjestys as jarj_pohj_kans
--Koodimuuttujat
,d1.aineisto_koodi
,d1b.aineisto_koodi as ainesto_koodi_otv
,d2.aidinkieli_versio1_koodi as aidinkieli_koodi
,d2b.aidinkieli_versio2_koodi as aidinkieli2_koodi
--yhdistetyn muuttujan koodi
,CASE WHEN d2.aidinkieli_versio1_koodi = ''fs'' Or d2b.aidinkieli_versio2_koodi = ''fi'' Or d2b.aidinkieli_versio2_koodi = ''se'' THEN
''fs'' When d2.aidinkieli_versio1_koodi = ''sv'' Or d2b.aidinkieli_versio2_koodi = ''sv'' THEN ''sv''
 When d2.aidinkieli_versio1_koodi = ''99'' Or d2b.aidinkieli_versio2_koodi = ''99'' THEN ''99'' Else ''999'' End AS ''aidinkieli3_koodi''
--
,d3.maakunta_koodi as ''Koodit Asuinmaakunta''
,d3.kunta_koodi as ''Koodit Asuinkunta''
,d3b.maakunta_koodi as asmaak1xmk
,d3b.kunta_koodi as asmaak1xk
,d5c.kuukausi as syntk
,d6a.tutkinto_amk_koodi as ''Koodit Tutkinto (amk)''
,d6b.tutkinto_yo_koodi as ''Koodit Tutkinto (yo)''
,d7.koulutustyyppi_koodi as ''Koodit Koulutustyyppi''
,d8.kansalaisuus_versio2_koodi as kansalaisuus_koodi
,d8b.kansalaisuus_versio1_koodi as kansalaisuus2_koodi
--yhdistetyn muuttujan koodi
,CASE WHEN d8.kansalaisuus_versio2_koodi = ''1'' Or d8b.kansalaisuus_versio1_koodi = ''1'' THEN
''1'' When d8.kansalaisuus_versio2_koodi = ''2'' Or d8.kansalaisuus_versio2_koodi = ''9'' Or d8b.kansalaisuus_versio1_koodi = ''2'' THEN ''2''
 Else ''-1'' End AS ''kansalaisuus3_koodi''
--
,coalesce(d9.oppilaitoksen_korvaavakoodi,d9.oppilaitoskoodi) as ''Koodit Oppilaitos''
,d9b.koulutuksen_jarjestajakoodi as ''Koodit Koulutuksen järjestäjä''
,d10.lahde_koodi
,d11.koulutusohjelma_amk_koodi as ''Koodit Koulutusohjelma''
,d12.opiskelijan_olo_koodi as kirjoillaolosyys_koodi
,d12b.opiskelijan_olo_tamm_koodi as kirjoillaolotammi_koodi
,d17.ensisijainen_opintooikeus_koodi as ensiop
,d21.koulutusaste2002_koodi as ''Koodit Koulutusaste 2002''
,d21.koulutusala2002_koodi as ''Koodit Koulutusala 2002''
,d21.opintoala1995_koodi as ''Koodit Koulutusala 1995''
,d21.opintoala2002_koodi as ''Koodit Opintoala 2002''
,d21.koulutus_koodi as ''Koodit Koulutusnimike''
,d22.maakunta_koodi as ''Koodit Koulutuksen maakunta''
,d22.kunta_koodi as ''Koodit Koulutuksen kunta''
--yhdistetyn muuttujan koodi
,CASE WHEN d1b.aineisto_koodi <> ''4.9'' And d1b.aineisto_koodi <> ''3.4'' THEN
d22.maakunta_koodi When d1b.aineisto_koodi = ''4.9'' THEN d3.maakunta_koodi
 Else ''99'' End AS ''Koodit Maakunta''
,CASE WHEN d1b.aineisto_koodi <> ''4.9'' And d1b.aineisto_koodi <> ''3.4'' THEN
d22.kunta_koodi When d1b.aineisto_koodi = ''4.9'' THEN d3.kunta_koodi
 Else ''Tuntematon'' End AS ''Koodit Kunta''
--
,d22b.maakunta_koodi as ''Koodit Koul. järj. maakunta''
,d22b.kunta_koodi as ''Koodit Koul. järj. kunta''
,d22c.maakunta_koodi as ''Koodit Oppil. maakunta''
,d22c.kunta_koodi as ''Koodit Oppil. kunta''
,d23.vuosi as alvv
,d23b.lukukausi as alkk
,d24b.vuosi as alvv_kksek
,d24c.vuosi as alvv_kksek_lasna
,d24d.vuosi as alvv_sek
,d24e.vuosi as alvv_sek_lasna
,d24f.vuosi as alvv_kk
,d24f2.lukukausi as alkk_kk
,d24g.vuosi as alvv_kk_lasna
,d24h.vuosi as alvv_opa
,d24i.vuosi as alvv_opa_lasna
,d24j.vuosi as kirtu1v
,d24k.lukukausi as kirtu1k
,d28.vahintaan_55_op_suorittanut_koodi as op55_koodi
,d37.vuosi as suorv
,d38.lukukausi as suor_lk
,d39.kuukausi as suor_kk

--ruotsi

,[Tilastovuosi] as Statistikår
,Studieår = 
	CASE
		WHEN d23.kausi_id = -1 THEN d23.vuosiselite_SV
		ELSE CAST(CAST(Tilastovuosi as int) - CAST(d23.vuosiselite as int) AS varchar(10))
	END
,d2.aidinkieli_versio1_SV as Modersmål
,d2b.aidinkieli_versio2_SV as "Modersmål (utbildningsstruktur)"
--luodaan yhdistetty äidinkieli-muuttuja, joka toimii aineistojen 2.8, 2.9, ja 4.9 välillä
,CASE WHEN d2.aidinkieli_versio1_koodi = ''fs'' Or d2b.aidinkieli_versio2_koodi = ''fi'' Or d2b.aidinkieli_versio2_koodi = ''se'' THEN
''finska (inn. samiska)'' When d2.aidinkieli_versio1_koodi = ''sv'' Or d2b.aidinkieli_versio2_koodi = ''sv'' THEN ''svenska''
 When d2.aidinkieli_versio1_koodi = ''99'' Or d2b.aidinkieli_versio2_koodi = ''99'' THEN ''andra språk och okänd'' Else ''Okänd'' End as ''Modersmål (finska/andra)SV''
--
--,d3.avi_SV as "Asuinalueen AVISV"
--,d3.ely_SV as "Asuinalueen ELYSV"
--,d3.kielisuhde_SV as "Asuinkunnan kielisuhdeSV"
,d3.maakunta_SV as Bostadslandskap
,d3.kunta_SV as Bostadskommun
--,d3b.avi_SV as "Til.v:tta edeltävä AVISV"
--,d3b.ely_SV as "Til.v:tta edeltävä ELYSV"
--,d3b.kielisuhde_SV as "Til.v:tta ed. asuinkunnan kielisuhdeSV"
--,d3b.maakunta_SV as "Til.v:tta ed. asuinmaakuntaSV"
--,d3b.kunta_SV as "Til.v:tta ed. asuinkuntaSV"
--,d3c.avi_SV as "2v til.v:tta ed. AVISV"
--,d3c.ely_SV as "2v til.v:tta ed. ELYSV"
--,d3c.kielisuhde_SV as "2v til.v:tta ed. asuinkunnan kielisuhdeSV"
--,d3c.maakunta_SV as "2v til.v:tta ed. asuinmaakuntaSV"
--,d3c.kunta_SV as "2v til.v:tta ed. asuinkuntaSV"
,d4.sukupuoli_SV as Kön
,d5.ika_SV as Ålder
,d5.ika5v_SV as Åldersgrupp
,d5b.vuosiselite_SV as Födelseår
--,d5c.kuukausiselite_SV as SyntymäkuukausiSV
,d6b.tutkinto_yo_SV as "Examen (universitet)"
,d7.koulutustyyppi_SV as "Typ av utbildning"
,d8.kansalaisuus_versio2_SV as Medborgarskap
,d8b.kansalaisuus_versio1_SV as "Medborgarskap (utbildningsstruktur)"
--luodaan yhdistetty kansalaisuus-muuttuja, joka toimii aineistojen 2.8, 2.9, ja 4.9 välillä
,CASE WHEN d8.kansalaisuus_versio2_koodi = ''1'' Or d8b.kansalaisuus_versio1_koodi = ''1'' THEN
''finländare'' When d8.kansalaisuus_versio2_koodi = ''2'' Or d8.kansalaisuus_versio2_koodi = ''9'' Or d8b.kansalaisuus_versio1_koodi = ''2'' THEN ''andra''
 Else ''Okänd'' End as ''Medborgarskap (finska/andra)''
--
,d9.oppilaitos_SV as Universitet
--,d9.opetuskieli_SV as OpetuskieliSV
--,d9.oppilaitoksen_omistajatyyppi_SV as "Oppil. omistajatyyppiSV"
--,d9.oppilaitostyyppi_SV as OppilaitostyyppiSV
--,d9b.koulutuksen_jarjestaja_SV as "Koulutuksen järjestäjäSV"
--,d9b.koulutuksen_jarjestajan_omistajatyyppi_SV as "Koul. järj. omistajatyyppiSV"
--,d10.lahde_SV as LähdeSV
,d11.koulutusohjelma_amk_SV as Utbildningsprogram
,d12.opiskelijan_olo_SV as "Inskrivning (september)"
,d12b.opiskelijan_olo_tamm_SV as "Inskrivning (januari)"
,d13.rahoituslahde_SV as Finansieringskälla
--,d15.suuntautumisvaihtoehto_amk_SV as SuuntautumisvaihtoehtoSV
--,d16.kieli_SV as "Koulutuksen kieliSV"
--,d17.ensisijainen_opintooikeus_SV as "Ensisijainen opinto-oikeusSV"
--,d18.tilauskoulutuksen_sijaintimaa_SV as "Tilauskoulutuksen sijaintimaaSV"
,d19.koulutussektori_SV as Utbildningssektor
--,d20.opetushallinnon_koulutus_SV as HallinnonalaSV
,d21.koulutusaste2002_SV as "Utbildningsnivå (2002)"
,d21.koulutusala2002_SV as "Utbildningsområde (2002)"
,d21.opintoala1995_SV as "Utbildningsområde (1995)"
,d21.opintoala2002_SV as "Studieområde (2002)"
,d21.koulutus_SV as Utbildningsbenämning
,d21b.koulutuslaji_okm_SV as Utbildningsslag
,d21b.koulutuslaji_okm2_SV as Utbildningsslag2
--,d22.avi_SV as "Koulutuksen AVISV"
--,d22.ely_SV as "Koulutuksen ELYSV"
,d22.maakunta_SV as "Utbildningens landskap"
--,d22.kielisuhde_SV as "Koul. kunnan kielisuhdeSV"
,d22.kunta_SV as "Utbildningens kommun"
--luodaan yhdistetyt kunta-muuttujat, jotka toimivat aineistojen 2.8, 2.9, ja 4.9 välillä
,CASE WHEN d1b.aineisto_koodi <> ''4.9'' And d1b.aineisto_koodi <> ''3.4'' THEN
d22.maakunta When d1b.aineisto_koodi = ''4.9'' THEN d3.maakunta
 Else ''Tuntematon'' End as ''Landskap''
,CASE WHEN d1b.aineisto_koodi <> ''4.9'' And d1b.aineisto_koodi <> ''3.4'' THEN
d22.kunta When d1b.aineisto_koodi = ''4.9'' THEN d3.kunta
 Else ''Tuntematon'' End as ''Kommun''
--
--,d22b.avi_SV as "Koul. järjestäjän AVISV"
--,d22b.ely_SV as "Koul. järjestäjän ELYSV"
--,d22b.maakunta_SV as "Koul. järjestäjän maakuntaSV"
--,d22b.kielisuhde_SV as "Koul. järj. kunnan kielisuhdeSV"
--,d22b.kunta_SV as "Koul. järjestäjän kuntaSV"
--,d22c.avi_SV as "Oppilaitoksen AVISV"
--,d22c.ely_SV as "Oppilaitoksen ELYSV"
--,d22c.maakunta_SV as "Oppilaitoksen maakuntaSV"
--,d22c.kielisuhde_SV as "Oppil. kunnan kielisuhdeSV"
--,d22c.kunta_SV as "Oppilaitoksen kuntaSV"
--,d23.vuosiselite_SV as "KirjoihintulovuosiSV"
--,d23b.lukukausiselite_SV as "KirjoihintulokausiSV"
--,d24b.vuosiselite_SV as "Kirjoihintulovuosi (kk-sek.)SV"
--,d24c.vuosiselite_SV as "Kirjoihintulovuosi (kk-sek. läsna)SV"
--,d24d.vuosiselite_SV as "Kirjoihintulovuosi (sek.)SV"
--,d24e.vuosiselite_SV as "Kirjoihintulovuosi (sek. läsnä)SV"
--,d24f.vuosiselite_SV as "Kirjoihintulovuosi (kk)SV"
--,d24f2.lukukausiselite_SV as "Kirjoihintulokausi (kk)SV"
--,d24g.vuosiselite_SV as "Kirjoihintulovuosi (kk läsnä)SV"
--,d24h.vuosiselite_SV as "Kirjoihintulovuosi (op.ala)SV"
--,d24i.vuosiselite_SV as "Kirjoihintulovuosi (op.ala läsnä)SV"
--,d24j.vuosiselite_SV as "Kirjoihintulovuosi (tutk.)SV"
--,d24k.lukukausiselite_SV as "Kirjoihintulokausi (tutk.)SV"
--,d28.vahintaan_55_op_suorittanut_SV as "Suorittanut väh. 55 opSV"
--,d29.opiskelijan_fte_tieto_SV as "Opiskelijan FTE-tietoSV"
--,d30.opiskelumuoto_SV as OpiskelumuotoSV
--,d31.yliopisto_SV as YliopistotunnusSV
--,d32.tiedekunta_yo_SV as TiedekuntaSV
--,d33.uusi_vanha_opiskelija_SV as "Uusi/vanha opiskelijaSV"
--,d35.opettajankelpoisuus_SV as OpettajankelpoisuusSV
--,d36.avoinvayla_SV as "Hyväksytty avoimen yliop. suoritusten kauttaSV"
,d37.vuosiselite_SV as "År då utbildningen avlagts"
--,d38.lukukausiselite_SV as "Tutk. suorituslukukausiSV"
--,d39.kuukausiselite_SV as "Tutk. suorituskuukausiSV"
,d40.maanosa_SV as "Medborgarskap (världsdel)"
,d41.eumaa_SV as "Medborgare i ett EU-land"
,d42.etamaa_SV as "Medborgare i ett EES-land"
,d43.pohjoismaa_SV as "Medborgare i ett nordiskt land"

--englanti

,[Tilastovuosi] as "Statistical year"
,[Study year] = 
	CASE
		WHEN d23.kausi_id = -1 THEN d23.vuosiselite_EN
		ELSE CAST(CAST(Tilastovuosi as int) - CAST(d23.vuosiselite as int) AS varchar(10))
	END
,d2.aidinkieli_versio1_EN as "Mother tongue"
,d2b.aidinkieli_versio2_EN as "Mother tongue (ed. structure)"
--luodaan yhdistetty äidinkieli-muuttuja, joka toimii aineistojen 2.8, 2.9, ja 4.9 välillä
,CASE WHEN d2.aidinkieli_versio1_koodi = ''fs'' Or d2b.aidinkieli_versio2_koodi = ''fi'' Or d2b.aidinkieli_versio2_koodi = ''se'' THEN
''Finnish (incl. Sami)'' When d2.aidinkieli_versio1_koodi = ''sv'' Or d2b.aidinkieli_versio2_koodi = ''sv'' THEN ''Swedish''
 When d2.aidinkieli_versio1_koodi = ''99'' Or d2b.aidinkieli_versio2_koodi = ''99'' THEN ''Other languages and unknown'' Else ''Unknown'' End as ''Mother tongue (Finnish/Other)''
--
--,d3.avi_EN as "Asuinalueen AVIEN"
--,d3.ely_EN as "Asuinalueen ELYEN"
--,d3.kielisuhde_EN as "Asuinkunnan kielisuhdeEN"
,d3.maakunta_EN as "Region of residence"
,d3.kunta_EN as "Municipality of residence"
--,d3b.avi_EN as "Til.v:tta edeltävä AVIEN"
--,d3b.ely_EN as "Til.v:tta edeltävä ELYEN"
--,d3b.kielisuhde_EN as "Til.v:tta ed. asuinkunnan kielisuhdeEN"
--,d3b.maakunta_EN as "Til.v:tta ed. asuinmaakuntaEN"
--,d3b.kunta_EN as "Til.v:tta ed. asuinkuntaEN"
--,d3c.avi_EN as "2v til.v:tta ed. AVIEN"
--,d3c.ely_EN as "2v til.v:tta ed. ELYEN"
--,d3c.kielisuhde_EN as "2v til.v:tta ed. asuinkunnan kielisuhdeEN"
--,d3c.maakunta_EN as "2v til.v:tta ed. asuinmaakuntaEN"
--,d3c.kunta_EN as "2v til.v:tta ed. asuinkuntaEN"
,d4.sukupuoli_EN as Gender
,d5.ika_EN as Age
,d5.ika5v_EN as Agegroup
,d5b.vuosiselite_EN as "Year of birth"
--,d5c.kuukausiselite_EN as SyntymäkuukausiEN
,d6b.tutkinto_yo_EN as "Degree (university)"
,d7.koulutustyyppi_EN as "Type of education"
,d8.kansalaisuus_versio2_EN as Nationality
,d8b.kansalaisuus_versio1_EN as "Nationality (ed. structure)"
--luodaan yhdistetty kansalaisuus-muuttuja, joka toimii aineistojen 2.8, 2.9, ja 4.9 välillä
,CASE WHEN d8.kansalaisuus_versio2_koodi = ''1'' Or d8b.kansalaisuus_versio1_koodi = ''1'' THEN
''Finn'' When d8.kansalaisuus_versio2_koodi = ''2'' Or d8.kansalaisuus_versio2_koodi = ''9'' Or d8b.kansalaisuus_versio1_koodi = ''2'' THEN ''Other''
 Else ''Unknown'' End as ''Nationality (Finn/Other)''
--
,d9.oppilaitos_EN as University
--,d9.opetuskieli_EN as OpetuskieliEN
--,d9.oppilaitoksen_omistajatyyppi_EN as "Oppil. omistajatyyppiEN"
--,d9.oppilaitostyyppi_EN as OppilaitostyyppiEN
--,d9b.koulutuksen_jarjestaja_EN as "Koulutuksen järjestäjäEN"
--,d9b.koulutuksen_jarjestajan_omistajatyyppi_EN as "Koul. järj. omistajatyyppiEN"
--,d10.lahde_EN as LähdeEN
,d11.koulutusohjelma_amk_EN as "Degree programme"
,d12.opiskelijan_olo_EN as "Enrollment status (sept.)"
,d12b.opiskelijan_olo_tamm_EN as "Enrollment status (jan.)"
,d13.rahoituslahde_EN as "Source of funding"
--,d15.suuntautumisvaihtoehto_amk_EN as SuuntautumisvaihtoehtoEN
--,d16.kieli_EN as "Koulutuksen kieliEN"
--,d17.ensisijainen_opintooikeus_EN as "Ensisijainen opinto-oikeusEN"
--,d18.tilauskoulutuksen_sijaintimaa_EN as "Tilauskoulutuksen sijaintimaaEN"
,d19.koulutussektori_EN as "Sector of education"
--,d20.opetushallinnon_koulutus_EN as HallinnonalaEN
,d21.koulutusaste2002_EN as "Level of education (2002)"
,d21.koulutusala2002_EN as "Field of education (2002)"
,d21.opintoala1995_EN as "Field of education (1995)"
,d21.opintoala2002_EN as "Subfield of ed. (2002)"
,d21.koulutus_EN as "Name of education"
,d21b.koulutuslaji_okm_EN as "Form of education"
,d21b.koulutuslaji_okm2_EN as "Form of education2"
--,d22.avi_EN as "Koulutuksen AVIEN"
--,d22.ely_EN as "Koulutuksen ELYEN"
,d22.maakunta_EN as "Region of education"
--,d22.kielisuhde_EN as "Koul. kunnan kielisuhdeEN"
,d22.kunta_EN as "Municipality of education"
--luodaan yhdistetyt kunta-muuttujat, jotka toimivat aineistojen 2.8, 2.9, ja 4.9 välillä
,CASE WHEN d1b.aineisto_koodi <> ''4.9'' And d1b.aineisto_koodi <> ''3.4'' THEN
d22.maakunta When d1b.aineisto_koodi = ''4.9'' THEN d3.maakunta
 Else ''Tuntematon'' End as ''Region''
,CASE WHEN d1b.aineisto_koodi <> ''4.9'' And d1b.aineisto_koodi <> ''3.4'' THEN
d22.kunta When d1b.aineisto_koodi = ''4.9'' THEN d3.kunta
 Else ''Tuntematon'' End as ''Municipality''
--
--,d22b.avi_EN as "Koul. järjestäjän AVIEN"
--,d22b.ely_EN as "Koul. järjestäjän ELYEN"
--,d22b.maakunta_EN as "Koul. järjestäjän maakuntaEN"
--,d22b.kielisuhde_EN as "Koul. järj. kunnan kielisuhdeEN"
--,d22b.kunta_EN as "Koul. järjestäjän kuntaEN"
--,d22c.avi_EN as "Oppilaitoksen AVIEN"
--,d22c.ely_EN as "Oppilaitoksen ELYEN"
--,d22c.maakunta_EN as "Oppilaitoksen maakuntaEN"
--,d22c.kielisuhde_EN as "Oppil. kunnan kielisuhdeEN"
--,d22c.kunta_EN as "Oppilaitoksen kuntaEN"
,d23.vuosiselite_EN as "Year of enrollment"
,d23b.lukukausiselite_EN as "Term of enrollment"
,d24b.vuosiselite_EN as "Year of enrollment (HE sec.)"
,d24c.vuosiselite_EN as "Year of enrollment (HE sec. present)"
,d24d.vuosiselite_EN as "Year of enrollment (sec.)"
,d24e.vuosiselite_EN as "Year of enrollment (sec. present)"
,d24f.vuosiselite_EN as "Year of enrollment (ed. inst.)"
,d24f2.lukukausiselite_EN as "Term of enrollment (ed. inst.)"
,d24g.vuosiselite_EN as "Year of enrollment (ed. inst. present)"
,d24h.vuosiselite_EN as "Year of enrollment (subfield of ed.)"
,d24i.vuosiselite_EN as "Year of enrollment (subfield of ed. present)"
,d24j.vuosiselite_EN as "Year of enrollment (degree)"
,d24k.lukukausiselite_EN as "Term of enrollment (degree)"
,d24l.vuosiselite as "Year of enrollment (Statistic Finland''s definition)"
--,d28.vahintaan_55_op_suorittanut_EN as "Suorittanut väh. 55 opEN"
--,d29.opiskelijan_fte_tieto_EN as "Opiskelijan FTE-tietoEN"
--,d30.opiskelumuoto_EN as OpiskelumuotoEN
--,d31.yliopisto_EN as YliopistotunnusEN
--,d32.tiedekunta_yo_EN as TiedekuntaEN
--,d33.uusi_vanha_opiskelija_EN as "Uusi/vanha opiskelijaEN"
--,d35.opettajankelpoisuus_EN as OpettajankelpoisuusEN
--,d36.avoinvayla_EN as "Hyväksytty avoimen yliop. suoritusten kauttaEN"
,d37.vuosiselite_EN as "Year of graduation"
,d38.lukukausiselite_EN as "Term of graduation"
,d39.kuukausiselite_EN as "Month of graduation"
,d40.maanosa_EN as "Nationality (continent)"
,d41.eumaa_EN as "Citizen of EU nation"
,d42.etamaa_EN as "Citizen of EEA nation"
,d43.pohjoismaa_EN as "Citizen of a nordic nation"
--isced
,d21.iscle2011 as "Koulutusaste, taso 1"
,d21.Koulutusaste_taso2 as "Koulutusaste, taso 2"
,d21.iscfibroad2013 as "Koulutusala, taso 1"
,d21.iscfinarrow2013 as "Koulutusala, taso 2"
,d21.iscfi2013 as "Koulutusala, taso 3"
,d21.OKM_ohjauksen_ala as "OKM ohjauksen ala, korkeak."
,d21.iscle2011_SV as "Utbildn.nivå, nivå 1"
,d21.Koulutusaste_taso2_SV as "Utbildn.nivå, nivå 2"
,d21.iscfibroad2013_SV as "Utbildn.område, nivå 1"
,d21.iscfinarrow2013_SV as "Utbildn.område, nivå 2"
,d21.iscfi2013_SV as "Utbildn.område, nivå 3"
,d21.OKM_ohjauksen_ala_SV as "UKM-styrningsområde, högskolor"
,d21.iscle2011_EN as "Level of ed., tier 1"
,d21.Koulutusaste_taso2_EN as "Level of ed., tier 2"
,d21.iscfibroad2013_EN as "Field of education, tier 1"
,d21.iscfinarrow2013_EN as "Field of education, tier 2"
,d21.iscfi2013_EN as "Field of education, tier 3"
,d21.OKM_ohjauksen_ala_EN as "Field of ed., HE steering"
,d21.jarjestys_iscle2011 as jarj_isced_koulast1
,d21.jarjestys_Koulutusaste_taso2 as jarj_isced_koulast2
,d21.jarjestys_iscfibroad2013 as jarj_isced_koulala1
,d21.jarjestys_iscfinarrow2013 as jarj_isced_koulala2
,d21.jarjestys_iscfi2013 as jarj_isced_koulala3
,d21.jarjestys_OKM_ohjauksen_ala as jarj_isced_okmohjaus1
,d21.iscle2011_koodi as "Koodit Koulutusaste, taso 1"
,d21.Koulutusaste_taso2_koodi as "Koodit Koulutusaste, taso 2"
,d21.iscfibroad2013_koodi as "Koodit Koulutusala, taso 1"
,d21.iscfinarrow2013_koodi as "Koodit Koulutusala, taso 2"
,d21.iscfi2013_koodi as "Koodit Koulutusala, taso 3"
,d21.OKM_ohjauksen_ala_koodi as "Koodit OKM ohjauksen ala, korkeak."
--Lukumäärämuuttujat
,[Opisk2]
,[Aloit2]
,[lkm_op55] = CAST((case when d28.vahintaan_55_op_suorittanut_koodi = 1 then [Opisk2] end) as int)
,[lkm_op0]
,[lkm_op1_14]
,[lkm_op15_29]
,[lkm_op30_44]
,[lkm_op45_59]
,[lkm_op60_74]
,[lkm_op75_89]
,[lkm_op90_104]
,[lkm_op105_119]
,[lkm_op120_]
,[aloittaneet_kirjoihintulovuosi]
,[aloittaneet_korkeakoulusektori]
,[aloittaneet_korkeakoulusektori_lasnaoleva]
,[aloittaneet_sektori]
,[aloittaneet_sektori_lasnaoleva]
,[aloittaneet_korkeakoulu]
,[aloittaneet_korkeakoulu_lasnaoleva]
,[aloittaneet_opintoala]
,[aloittaneet_opintoala_lasnaoleva]
,[opiskelijat_lasna]
,[opiskelijat_fte]
,[lkm_lasnalk]
,[lkm_poissalk]
,[op_suoritettavien_laajuus]
,[op_edellinen_syksy]
,[op_edellinen_kevat]
,[op_kertyma_edel_lkv_loppu]
,[Tutk2]
,[op_amk_yhteensa]
,[op_amk_yleissiv_amm_opplait]
,[op_amk_muualla]
,[op_amk_oma_amk]
,[op_amk_muu_amk]
,[op_amk_yliopistoissa]
,[op_amk_ulkomailla]
,[op_yo_yhteensa]
,[op_yo_ulkomailla]
,[op_yo_muualla]
,[op_yo_oma_yo]
,[op_yo_avoimessa]
,[op_yo_muu_yo]
,[op_yo_ammattikorkeakouluissa]
,[ika19_21_lkm]
,[ika20_24_lkm]
,[ika25_34_lkm]
,[ika25_64_lkm]

FROM (
SELECT [tilastointivuosi] as Tilastovuosi
	  ,aineisto_id
	  ,aineisto_OTV_id
	  ,aidinkieli_versio1_id
	  ,aidinkieli_versio2_id = ''-1''
	  ,kotikunta_id
	  ,kotikunta1x_id
	  ,kotikunta2x_id
	  ,sukupuoli_id
	  ,ika_id
	  ,syntymavuosi_id
	  ,syntymakuukausi_id = ''-1''
	  ,tutkinto_amk_id
	  ,tutkinto_yo_id
	  ,koulutustyyppi_id
	  ,kansalaisuus_versio2_id
	  ,kansalaisuus_versio1_id = -1
	  ,oppilaitos_id
	  ,koulutuksen_jarjestaja_id
	  ,lahde_id
	  ,koulutusohjelma_amk_id
	  ,opiskelijan_olo_syys_id
	  ,opiskelijan_olo_tamm_id
	  ,rahoituslahde_id
	  ,suuntautumisvaihtoehto_amk_id
	  ,koulutuksen_kieli_id
	  ,ensisijainen_opintooikeus_id
	  ,tilauskoulutuksen_sijaintimaa_id
	  ,koulutussektori_id
	  ,opetushallinnon_koulutus_id
	  ,koulutusluokitus_id
	  ,koulutuslaji_OKM_id
	  ,koulutuksen_kunta_id
	  ,koulutuksen_jarjestaja_kunta_id
	  ,oppilaitos_kunta_id
	  ,kirjoihintulovuosi_id
	  ,kirjoihintulokausi_id
	  ,kirjoihintulovuosi_korkeakoulusektori_id
	  ,kirjoihintulovuosi_korkeakoulusektori_lasnaoleva_id
	  ,kirjoihintulovuosi_sektori_id
	  ,kirjoihintulovuosi_sektori_lasnaoleva_id
	  ,kirjoihintulovuosi_korkeakoulu_id
	  ,kirjoihintulokausi_korkeakoulu_id = ''-1''
	  ,kirjoihintulovuosi_korkeakoulu_lasnaoleva_id
	  ,kirjoihintulovuosi_opintoala_id
	  ,kirjoihintulovuosi_opintoala_lasnaoleva_id
	  ,kirjoihintulovuosi_tutkinto_id
	  ,kirjoihintulokausi_tutkinto_id
	  ,vahintaan_55_op_suorittanut_id
	  ,opiskelijan_fte_tieto_id
	  --,opiskelumuoto_id
	  ,yliopisto_id
	  ,tiedekunta_yo_id
	  ,uusi_vanha_opiskelija_id
	  ,opettajankelpoisuus_id
	  ,avoinvayla_id
	  ,tutkinnon_suoritusvuosi_id = ''-1''
	  ,tutkinnon_suorituslukukausi_id = ''-1''
	  ,tutkinnon_suorituskuukausi_id = ''-1''
	  ,tutkintooikeusvuosi_id
	  ,maanosa_id = -1
	  ,pohjoismaa_id = -1
	  ,eumaa_id = -1
	  ,etamaa_id = -1
	  ,[opiskelijat] as Opisk2
	  ,[aloittaneet] as Aloit2
	  ,[lkm_op0]
	  ,[lkm_op1_14]
	  ,[lkm_op15_29]
	  ,[lkm_op30_44]
	  ,[lkm_op45_59]
	  ,[lkm_op60_74]
	  ,[lkm_op75_89]
	  ,[lkm_op90_104]
	  ,[lkm_op105_119]
	  ,[lkm_op120_]
	  ,[aloittaneet_kirjoihintulovuosi]
	  ,[aloittaneet_korkeakoulusektori]
	  ,[aloittaneet_korkeakoulusektori_lasnaoleva]
	  ,[aloittaneet_sektori]
	  ,[aloittaneet_sektori_lasnaoleva]
	  ,[aloittaneet_korkeakoulu]
	  ,[aloittaneet_korkeakoulu_lasnaoleva]
	  ,[aloittaneet_opintoala]
	  ,[aloittaneet_opintoala_lasnaoleva]
	  ,[opiskelijat_lasna]
	  ,[opiskelijat_fte]
	  ,[lkm_lasnalk]
	  ,[lkm_poissalk]
	  ,[op_suoritettavien_laajuus]
	  ,[op_edellinen_syksy]
	  ,[op_edellinen_kevat]
	  ,[op_kertyma_edel_lkv_loppu]
	  ,[Tutk2] = NULL
	  ,[op_amk_yhteensa] = NULL
	  ,[op_amk_yleissiv_amm_opplait] = NULL
	  ,[op_amk_muualla] = NULL
	  ,[op_amk_oma_amk] = NULL
	  ,[op_amk_muu_amk] = NULL
	  ,[op_amk_yliopistoissa] = NULL
	  ,[op_amk_ulkomailla] = NULL
	  ,[op_yo_yhteensa] = NULL
	  ,[op_yo_ulkomailla] = NULL
	  ,[op_yo_muualla] = NULL
	  ,[op_yo_oma_yo] = NULL
	  ,[op_yo_avoimessa] = NULL
	  ,[op_yo_muu_yo] = NULL
	  ,[op_yo_ammattikorkeakouluissa] = NULL
	  ,[ika19_21_lkm] = NULL
	  ,[ika20_24_lkm] = NULL
	  ,[ika25_34_lkm] = NULL
	  ,[ika25_64_lkm] = NULL
  FROM [dbo].[f_OTV_2_8_Korkeakouluopiskelijat]

UNION ALL
SELECT [tilastointivuosi] as Tilastovuosi
	  ,aineisto_id
	  ,aineisto_OTV_id
	  ,aidinkieli_versio1_id
	  ,aidinkieli_versio2_id = ''-1''
	  ,kotikunta_id
	  ,kotikunta1x_id
	  ,kotikunta2x_id = -1
	  ,sukupuoli_id
	  ,ika_id
	  ,syntymavuosi_id
	  ,syntymakuukausi_id = ''-1''
	  ,tutkinto_amk_id
	  ,tutkinto_yo_id
	  ,koulutustyyppi_id
	  ,kansalaisuus_versio2_id
	  ,kansalaisuus_versio1_id = -1
	  ,oppilaitos_id
	  ,koulutuksen_jarjestaja_id
	  ,lahde_id
	  ,koulutusohjelma_amk_id
	  ,opiskelijan_olo_syys_id = -1
	  ,opiskelijan_olo_tamm_id = -1
	  ,rahoituslahde_id
	  ,suuntautumisvaihtoehto_amk_id
	  ,koulutuksen_kieli_id
	  ,ensisijainen_opintooikeus_id = -1
	  ,tilauskoulutuksen_sijaintimaa_id
	  ,koulutussektori_id
	  ,opetushallinnon_koulutus_id
	  ,koulutusluokitus_id
	  ,koulutuslaji_OKM_id
	  ,koulutuksen_kunta_id
	  ,koulutuksen_jarjestaja_kunta_id
	  ,oppilaitos_kunta_id
	  ,kirjoihintulovuosi_id
	  ,kirjoihintulokausi_id
	  ,kirjoihintulovuosi_korkeakoulusektori_id
	  ,kirjoihintulovuosi_korkeakoulusektori_lasnaoleva_id
	  ,kirjoihintulovuosi_sektori_id
	  ,kirjoihintulovuosi_sektori_lasnaoleva_id
	  ,kirjoihintulovuosi_korkeakoulu_id
	  ,kirjoihintulokausi_korkeakoulu_id = ''-1''
	  ,kirjoihintulovuosi_korkeakoulu_lasnaoleva_id
	  ,kirjoihintulovuosi_opintoala_id
	  ,kirjoihintulovuosi_opintoala_lasnaoleva_id
	  ,kirjoihintulovuosi_tutkinto_id
	  ,kirjoihintulokausi_tutkinto_id
	  ,vahintaan_55_op_suorittanut_id = -1
	  ,opiskelijan_fte_tieto_id = -1
	  --,opiskelumuoto_id
	  ,yliopisto_id = -1
	  ,tiedekunta_yo_id
	  ,uusi_vanha_opiskelija_id = -1
	  ,opettajankelpoisuus_id
	  ,avoinvayla_id = -1
	  ,tutkinnon_suoritusvuosi_id
	  ,tutkinnon_suorituslukukausi_id
	  ,tutkinnon_suorituskuukausi_id = ''-1''
	  ,tutkintooikeusvuosi_id = ''-1''
	  ,maanosa_id = -1
	  ,pohjoismaa_id = -1
	  ,eumaa_id = -1
	  ,etamaa_id = -1
	  ,[Opisk2] = NULL
	  ,[Aloit2] = NULL
	  ,[lkm_op0] = NULL
	  ,[lkm_op1_14] = NULL
	  ,[lkm_op15_29] = NULL
	  ,[lkm_op30_44] = NULL
	  ,[lkm_op45_59] = NULL
	  ,[lkm_op60_74] = NULL
	  ,[lkm_op75_89] = NULL
	  ,[lkm_op90_104] = NULL
	  ,[lkm_op105_119] = NULL
	  ,[lkm_op120_] = NULL
	  ,[aloittaneet_kirjoihintulovuosi] = NULL
	  ,[aloittaneet_korkeakoulusektori] = NULL
	  ,[aloittaneet_korkeakoulusektori_lasnaoleva] = NULL
	  ,[aloittaneet_sektori] = NULL
	  ,[aloittaneet_sektori_lasnaoleva] = NULL
	  ,[aloittaneet_korkeakoulu] = NULL
	  ,[aloittaneet_korkeakoulu_lasnaoleva] = NULL
	  ,[aloittaneet_opintoala] = NULL
	  ,[aloittaneet_opintoala_lasnaoleva] = NULL
	  ,[opiskelijat_lasna] = NULL
	  ,[opiskelijat_fte] = NULL
	  ,[lkm_lasnalk]
	  ,[lkm_poissalk]
	  ,[op_suoritettavien_laajuus]
	  ,[op_edellinen_syksy] = NULL
	  ,[op_edellinen_kevat] = NULL
	  ,[op_kertyma_edel_lkv_loppu] = NULL
	  ,[lukumaara] as Tutk2
	  ,[op_amk_yhteensa]
	  ,[op_amk_yleissiv_amm_opplait]
	  ,[op_amk_muualla]
	  ,[op_amk_oma_amk]
	  ,[op_amk_muu_amk]
	  ,[op_amk_yliopistoissa]
	  ,[op_amk_ulkomailla]
	  ,[op_yo_yhteensa]
	  ,[op_yo_ulkomailla]
	  ,[op_yo_muualla]
	  ,[op_yo_oma_yo]
	  ,[op_yo_avoimessa]
	  ,[op_yo_muu_yo]
	  ,[op_yo_ammattikorkeakouluissa]
	  ,[ika19_21_lkm] = NULL
	  ,[ika20_24_lkm] = NULL
	  ,[ika25_34_lkm] = NULL
	  ,[ika25_64_lkm] = NULL
  FROM [dbo].[f_OTV_2_9_Korkeakoulututkinnot]

UNION ALL
SELECT [tilastointivuosi] as Tilastovuosi
	  ,aineisto_id
	  ,aineisto_OTV_id
	  ,aidinkieli_versio1_id = -1
	  ,aidinkieli_versio2_id
	  ,kotikunta_id
	  ,kotikunta1x_id = -1
	  ,kotikunta2x_id = -1
	  ,sukupuoli_id
	  ,ika_id = ''-1''
	  ,syntymavuosi_id = ''-1''
	  ,syntymakuukausi_id = ''-1''
	  ,tutkinto_amk_id = -1
	  ,tutkinto_yo_id = -1
	  ,koulutustyyppi_id = -1
	  ,kansalaisuus_versio2_id = -1
	  ,kansalaisuus_versio1_id
	  ,oppilaitos_id = -1
	  ,koulutuksen_jarjestaja_id = -1
	  ,lahde_id = -1
	  ,koulutusohjelma_amk_id = -1
	  ,opiskelijan_olo_syys_id = -1
	  ,opiskelijan_olo_tamm_id = -1
	  ,rahoituslahde_id = -1
	  ,suuntautumisvaihtoehto_amk_id = -1
	  ,koulutuksen_kieli_id = -1
	  ,ensisijainen_opintooikeus_id = -1
	  ,tilauskoulutuksen_sijaintimaa_id = -1
	  ,koulutussektori_id = -1
	  ,opetushallinnon_koulutus_id = -1
	  ,koulutusluokitus_id = -1
	  ,koulutuslaji_OKM_id = -1
	  ,koulutuksen_kunta_id = -1
	  ,koulutuksen_jarjestaja_kunta_id = -1
	  ,oppilaitos_kunta_id = -1
	  ,kirjoihintulovuosi_id = ''-1''
	  ,kirjoihintulokausi_id = ''-1''
	  ,kirjoihintulovuosi_korkeakoulusektori_id = ''-1''
	  ,kirjoihintulovuosi_korkeakoulusektori_lasnaoleva_id = ''-1''
	  ,kirjoihintulovuosi_sektori_id = ''-1''
	  ,kirjoihintulovuosi_sektori_lasnaoleva_id = ''-1''
	  ,kirjoihintulovuosi_korkeakoulu_id = ''-1''
	  ,kirjoihintulokausi_korkeakoulu_id = ''-1''
	  ,kirjoihintulovuosi_korkeakoulu_lasnaoleva_id = ''-1''
	  ,kirjoihintulovuosi_opintoala_id = ''-1''
	  ,kirjoihintulovuosi_opintoala_lasnaoleva_id = ''-1''
	  ,kirjoihintulovuosi_tutkinto_id = ''-1''
	  ,kirjoihintulokausi_tutkinto_id = ''-1''
	  ,vahintaan_55_op_suorittanut_id = -1
	  ,opiskelijan_fte_tieto_id = -1
	  --,opiskelumuoto_id = -1
	  ,yliopisto_id = -1
	  ,tiedekunta_yo_id = -1
	  ,uusi_vanha_opiskelija_id = -1
	  ,opettajankelpoisuus_id = -1
	  ,avoinvayla_id = -1
	  ,tutkinnon_suoritusvuosi_id = ''-1''
	  ,tutkinnon_suorituslukukausi_id = ''-1''
	  ,tutkinnon_suorituskuukausi_id = ''-1''
	  ,tutkintooikeusvuosi_id = ''-1''
	  ,maanosa_id
	  ,pohjoismaa_id
	  ,eumaa_id
	  ,etamaa_id
	  ,[Opisk2] = NULL
	  ,[Aloit2] = NULL
	  ,[lkm_op0] = NULL
	  ,[lkm_op1_14] = NULL
	  ,[lkm_op15_29] = NULL
	  ,[lkm_op30_44] = NULL
	  ,[lkm_op45_59] = NULL
	  ,[lkm_op60_74] = NULL
	  ,[lkm_op75_89] = NULL
	  ,[lkm_op90_104] = NULL
	  ,[lkm_op105_119] = NULL
	  ,[lkm_op120_] = NULL
	  ,[aloittaneet_kirjoihintulovuosi] = NULL
	  ,[aloittaneet_korkeakoulusektori] = NULL
	  ,[aloittaneet_korkeakoulusektori_lasnaoleva] = NULL
	  ,[aloittaneet_sektori] = NULL
	  ,[aloittaneet_sektori_lasnaoleva] = NULL
	  ,[aloittaneet_korkeakoulu] = NULL
	  ,[aloittaneet_korkeakoulu_lasnaoleva] = NULL
	  ,[aloittaneet_opintoala] = NULL
	  ,[aloittaneet_opintoala_lasnaoleva] = NULL
	  ,[opiskelijat_lasna] = NULL
	  ,[opiskelijat_fte] = NULL
	  ,[lkm_lasnalk] = NULL
	  ,[lkm_poissalk] = NULL
	  ,[op_suoritettavien_laajuus] = NULL
	  ,[op_edellinen_syksy] = NULL
	  ,[op_edellinen_kevat] = NULL
	  ,[op_kertyma_edel_lkv_loppu] = NULL
	  ,[Tutk2] = NULL
	  ,[op_amk_yhteensa] = NULL
	  ,[op_amk_yleissiv_amm_opplait] = NULL
	  ,[op_amk_muualla] = NULL
	  ,[op_amk_oma_amk] = NULL
	  ,[op_amk_muu_amk] = NULL
	  ,[op_amk_yliopistoissa] = NULL
	  ,[op_amk_ulkomailla] = NULL
	  ,[op_yo_yhteensa] = NULL
	  ,[op_yo_ulkomailla] = NULL
	  ,[op_yo_muualla] = NULL
	  ,[op_yo_oma_yo] = NULL
	  ,[op_yo_avoimessa] = NULL
	  ,[op_yo_muu_yo] = NULL
	  ,[op_yo_ammattikorkeakouluissa] = NULL
	  ,[ika19_21_lkm]
	  ,[ika20_24_lkm]
	  ,[ika25_34_lkm]
	  ,[ika25_64_lkm]
  FROM [dbo].[f_OTV_4_9_Vaestorakenne_kunnittain]

  ) f
	INNER JOIN [dbo].d_aineisto d1 ON d1.id = f.aineisto_id
	INNER JOIN [dbo].d_aineisto_OTV d1b ON d1b.id = f.aineisto_OTV_id
	INNER JOIN [dbo].d_aidinkieli_versio1 d2 ON d2.id = f.aidinkieli_versio1_id
	INNER JOIN [dbo].d_aidinkieli_versio2 d2b ON d2b.id = f.aidinkieli_versio2_id
	INNER JOIN [dbo].d_alueluokitus d3 ON d3.id = f.kotikunta_id
	INNER JOIN [dbo].d_alueluokitus d3b ON d3b.id = f.kotikunta1x_id
	INNER JOIN [dbo].d_alueluokitus d3c ON d3c.id = f.kotikunta2x_id
	INNER JOIN [dbo].d_sukupuoli d4 ON d4.id = f.sukupuoli_id
	INNER JOIN [dbo].d_ika d5 ON d5.id = f.ika_id
	INNER JOIN [dbo].d_kausi d5b ON d5b.kausi_id = f.syntymavuosi_id
	INNER JOIN [dbo].d_kausi d5c ON d5c.kausi_id = f.syntymakuukausi_id
	INNER JOIN [dbo].d_tutkinto_amk d6a ON d6a.id = f.tutkinto_amk_id
	INNER JOIN [dbo].d_tutkinto_yo d6b ON d6b.id = f.tutkinto_yo_id
	INNER JOIN [dbo].d_koulutustyyppi d7 ON d7.id = f.koulutustyyppi_id
	INNER JOIN [dbo].d_kansalaisuus_versio2 d8 ON d8.id = f.kansalaisuus_versio2_id
	INNER JOIN [dbo].d_kansalaisuus_versio1 d8b ON d8b.id = f.kansalaisuus_versio1_id
	INNER JOIN [dbo].d_oppilaitoksen_taustatiedot d9 ON d9.id = f.oppilaitos_id
	INNER JOIN [dbo].d_oppilaitoksen_taustatiedot d9b ON d9b.id = f.koulutuksen_jarjestaja_id
	INNER JOIN [dbo].d_lahde d10 ON d10.id = f.lahde_id
	INNER JOIN [dbo].d_koulutusohjelma_amk d11 ON d11.id = f.koulutusohjelma_amk_id
	INNER JOIN [dbo].d_opiskelijan_olo d12 ON d12.id = f.opiskelijan_olo_syys_id
	INNER JOIN [dbo].d_opiskelijan_olo_tamm d12b ON d12b.id = f.opiskelijan_olo_tamm_id
	INNER JOIN [dbo].d_rahoituslahde d13 ON d13.id = f.rahoituslahde_id
	INNER JOIN [dbo].d_suuntautumisvaihtoehto_amk d15 ON d15.id = f.suuntautumisvaihtoehto_amk_id
	INNER JOIN [dbo].d_kieli d16 ON d16.id = f.koulutuksen_kieli_id
	INNER JOIN [dbo].d_ensisijainen_opintooikeus d17 ON d17.id = f.ensisijainen_opintooikeus_id
	INNER JOIN [dbo].d_tilauskoulutuksen_sijaintimaa d18 ON d18.id = f.tilauskoulutuksen_sijaintimaa_id
	INNER JOIN [dbo].d_koulutussektori d19 ON d19.id = f.koulutussektori_id
	INNER JOIN [dbo].d_opetushallinnon_koulutus d20 ON d20.id = f.opetushallinnon_koulutus_id
	INNER JOIN [dbo].d_koulutusluokitus d21 ON d21.id = f.koulutusluokitus_id
	INNER JOIN [dbo].d_koulutuslaji_okm d21b ON d21b.id = f.koulutuslaji_OKM_id
	INNER JOIN [dbo].d_alueluokitus d22 ON d22.id = f.koulutuksen_kunta_id
	INNER JOIN [dbo].d_alueluokitus d22b ON d22b.id = f.koulutuksen_jarjestaja_kunta_id
	INNER JOIN [dbo].d_alueluokitus d22c ON d22c.id = f.oppilaitos_kunta_id
	INNER JOIN [dbo].d_kausi d23 ON d23.kausi_id = f.kirjoihintulovuosi_id
	INNER JOIN [dbo].d_kausi d23b ON d23b.kausi_id = f.kirjoihintulokausi_id
	INNER JOIN [dbo].d_kausi d24b ON d24b.kausi_id = f.kirjoihintulovuosi_korkeakoulusektori_id
	INNER JOIN [dbo].d_kausi d24c ON d24c.kausi_id = f.kirjoihintulovuosi_korkeakoulusektori_lasnaoleva_id
	INNER JOIN [dbo].d_kausi d24d ON d24d.kausi_id = f.kirjoihintulovuosi_sektori_id
	INNER JOIN [dbo].d_kausi d24e ON d24e.kausi_id = f.kirjoihintulovuosi_sektori_lasnaoleva_id
	INNER JOIN [dbo].d_kausi d24f ON d24f.kausi_id = f.kirjoihintulovuosi_korkeakoulu_id
	INNER JOIN [dbo].d_kausi d24f2 ON d24f2.kausi_id = f.kirjoihintulokausi_korkeakoulu_id
	INNER JOIN [dbo].d_kausi d24g ON d24g.kausi_id = f.kirjoihintulovuosi_korkeakoulu_lasnaoleva_id
	INNER JOIN [dbo].d_kausi d24h ON d24h.kausi_id = f.kirjoihintulovuosi_opintoala_id
	INNER JOIN [dbo].d_kausi d24i ON d24i.kausi_id = f.kirjoihintulovuosi_opintoala_lasnaoleva_id
	INNER JOIN [dbo].d_kausi d24j ON d24j.kausi_id = f.kirjoihintulovuosi_tutkinto_id
	INNER JOIN [dbo].d_kausi d24k ON d24k.kausi_id = f.kirjoihintulokausi_tutkinto_id
	INNER JOIN [dbo].d_kausi d24l ON d24l.kausi_id = f.tutkintooikeusvuosi_id
	INNER JOIN [dbo].d_vahintaan_55_op_suorittanut d28 ON d28.id = f.vahintaan_55_op_suorittanut_id
	INNER JOIN [dbo].d_opiskelijan_fte_tieto d29 ON d29.id = f.opiskelijan_fte_tieto_id
	--INNER JOIN [dbo].d_opiskelumuoto d30 ON d30.id = f.opiskelumuoto_id
	INNER JOIN [dbo].d_yliopisto d31 ON d31.id = f.yliopisto_id
	INNER JOIN [dbo].d_tiedekunta_yo d32 ON d32.id = f.tiedekunta_yo_id
	INNER JOIN [dbo].d_uusi_vanha_opiskelija d33 ON d33.id = f.uusi_vanha_opiskelija_id
	--INNER JOIN [dbo].d_kausi d34 ON d34.kausi_id = f.tutkintooikeusvuosi_id
	INNER JOIN [dbo].d_opettajankelpoisuus d35 ON d35.id = f.opettajankelpoisuus_id
	INNER JOIN [dbo].d_avoinvayla d36 ON d36.id = f.avoinvayla_id
	INNER JOIN [dbo].d_kausi d37 ON d37.kausi_id = f.tutkinnon_suoritusvuosi_id
	INNER JOIN [dbo].d_kausi d38 ON d38.kausi_id = f.tutkinnon_suorituslukukausi_id
	INNER JOIN [dbo].d_kausi d39 ON d39.kausi_id = f.tutkinnon_suorituskuukausi_id
	INNER JOIN [dbo].d_valtio_historia d40 ON d40.id = f.maanosa_id
	INNER JOIN [dbo].d_valtio_historia d41 ON d41.id = f.eumaa_id
	INNER JOIN [dbo].d_valtio_historia d42 ON d42.id = f.etamaa_id
	INNER JOIN [dbo].d_pohjoismaa d43 ON d43.id = f.pohjoismaa_id
WHERE 
d1.aineisto_koodi=
(case
	when d1b.aineisto like ''2.8%'' then (case when NOT EXISTS (SELECT 1 FROM [dbo].[f_OTV_2_8_Korkeakouluopiskelijat] o WHERE o.lahde = ''51'' and o.aineisto=''L'' and o.tilastointivuosi=f.Tilastovuosi) then ''E'' else ''L'' end)
	when d1b.aineisto like ''2.9%'' then (case when NOT EXISTS (SELECT 1 FROM [dbo].[f_OTV_2_9_Korkeakoulututkinnot] o WHERE o.lahde = ''52'' and o.aineisto=''L'' and o.tilastointivuosi=f.Tilastovuosi) then ''E'' else ''L'' end)
	else ''-1''
end
)
--(d1.aineisto_koodi in (''L'',''-1'') OR (d1.aineisto_koodi=''E'' and Tilastovuosi=2016))
AND d10.lahde_koodi in (''-1'',''51'',''52'') AND d9.oppilaitoskoodi <> ''02557'' AND d9.oppilaitoskoodi <> ''10031'' AND d9.oppilaitoskoodi <> ''02358''














' 
GO
/****** Object:  View [dbo].[v_f_tab_otv_toinen_aste]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_otv_toinen_aste]'))
EXEC dbo.sp_executesql @statement = N'



























CREATE VIEW [dbo].[v_f_tab_otv_toinen_aste] AS

--aloittaneet ja opiskelijat
select --top 100
	[Tilastovuosi] = f.tilv
	
	,[Sukupuoli] = d1.sukupuoli
	,[Äidinkieli] = d5.aidinkieli_versio1
	,[Ikäryhmä] = d9.ika5v
	,[Nuorten/aikuisten koul.] = d4.nuorten_aikuisten_koulutus
	,[Oppisopimus purkautunut] = d10.oppisopimus_purkautunut
	,[Todistus oppisopimuskoulutuksen suorittamisesta] = d11.todistus_oppisopimuskoulutuksen_suorittamisesta
	,[Yrittäjän oppisopimuskoulutus] = d12.yrittajan_oppisopimuskoulutus

	,[Koulutuslaji] = d6.lukiokoulutuksen_koulutuslaji
--	,[Hallinnonala] = d7.opetushallinnon_koulutus
	,[Hallinnonala] = d7.hallinnonala
	,[Koulutuksen tavoite] = d8.tutkinnon_tavoite
	,[Tutkinnon toteuma] = null
	,[Koko tutkinto / tutk. osa] = d27.koulutuksen_tavoite_toteuma
	,[Järjestämistapa] = d13.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus
	,[Järjestämismuoto] = d14.koulutuksen_jarjestamismuoto
	,[Tutkintotyyppi] = d15.ammatillisen_koulutuksen_koulutuslaji
	,[Koulutusala] = d16.koulutusala2002
	,[Opintoala] = d16.opintoala2002
	,[Koulutusnimike] = d16.koulutus
	,[Osaamisala] = d17.koulutusohjelma_ammpk
	,[Rahoituslähde] = d18.rahoituslahde_amm
	,[Tutkintonimike] = d19.tutkintonimike_ammpk
	,[Koulutuksen kieli] = d20.kieli
	,[Työvoimapoliittinen koulutus] = d21.tyovoimapoliittinen_koulutus
	,[Väylä näyttötutkintoon] = null	
	,[Koulutuksen suuralue] = d22.suuralue
	,[Koulutuksen kunnan kielisuhde] = d22.kielisuhde
	,[Koulutuksen AVI] = d22.avi
	,[Koulutuksen ELY] = d22.ely
	,[Koulutuksen maakunta] = d22.maakunta
	,[Koulutuksen seutukunta] = d22.seutukunta
	,[Koulutuksen sijaintikunnan kuntaryhmä] = d22.kuntaryhma
	,[Koulutuksen kunta] = d22.kunta
	,[Koulutussektori] = d26.koulutussektori

	,[Oppilaitoksen omistajatyyppi] = d2.oppilaitoksen_omistajatyyppi
	,[Oppilaitostyyppi] = d2.oppilaitostyyppi
	,[Oppilaitos] = d2.oppilaitos
	,[Oppilaitoksen suuralue] = d3.suuralue
	,[Oppilaitoksen kunnan kielisuhde] = d3.kielisuhde
	,[Oppilaitoksen AVI] = d3.avi
	,[Oppilaitoksen ELY] = d3.ely
	,[Oppilaitoksen maakunta] = d3.maakunta
	,[Oppilaitoksen seutukunta] = d3.seutukunta
	,[Oppilaitoksen sijaintikunnan kuntaryhmä] = d3.kuntaryhma
	,[Oppilaitoksen kunta] = d3.kunta
	,[Oppilaitoksen opetuskieli] = d2.opetuskieli
	--Historia
	,[Oppil. omistajatyyppi] = d2b.oppilaitoksen_omistajatyyppi
	,[Oppilaitoksen tyyppi] = d2b.oppilaitostyyppi
	,[Oppilaitos _] =  case when coalesce(nullif(d2b.oppilaitoksen_korvaavakoodi,null),'''') = '''' then d2b.oppilaitos else d2c.oppilaitos end --d2b.oppilaitos
	,[Oppilaitoskoodi] = case when coalesce(nullif(d2b.oppilaitoksen_korvaavakoodi,null),'''') = '''' then d2b.oppilaitoskoodi else right(''0000''+d2b.[oppilaitoksen_korvaavakoodi],5) end --case when d2b.oppilaitoksen_korvaavakoodi is null then d2b.oppilaitoskoodi else d2c.oppilaitoskoodi end
	,[Oppil. suuralue] = d3b.suuralue
	,[Oppil. kunnan kielisuhde] = d3b.kielisuhde
	,[Oppil. AVI] = d3b.avi
	,[Oppil. ELY] = d3b.ely
	,[Oppil. maakunta] = d3b.maakunta
	,[Oppil. seutukunta] = d3b.seutukunta
	,[Oppil. sijaintikunnan kuntaryhmä] = d3b.kuntaryhma
	,[Oppil. kunta] = d3b.kunta
	,[Oppil. opetuskieli] = d2b.opetuskieli
	,[Koul. järjestäjä] = d2b.koulutuksen_jarjestaja

	,[Koulutuksen järjestäjä] = coalesce(nullif(d2d.koulutuksen_jarjestaja,''Tuntematon''),d2.koulutuksen_jarjestaja)--oppilaitos-dimensiosta puuttuu ilmeisesti koulutuksen järjestäjä -avaimia, joten haetaan puuttuva tieto oppilaitoksen perusteella
	,[Koulutuksen järjestäjän omistajatyyppi] = d2d.koulutuksen_jarjestajan_omistajatyyppi
	,[Koulutuksen järjestäjän suuralue] = d24.suuralue
	,[Koulutuksen järjestäjän kunnan kielisuhde] = d24.kielisuhde
	,[Koulutuksen järjestäjän AVI] = d24.avi
	,[Koulutuksen järjestäjän ELY] = d24.ely
	,[Koulutuksen järjestäjän maakunta] = d24.maakunta
	,[Koulutuksen järjestäjän seutukunta] = d24.seutukunta
	,[Koulutuksen järjestäjän sijaintikunnan kuntaryhmä] = d24.kuntaryhma
	,[Koulutuksen järjestäjän kunta] = d24.kunta

	,[Toimiala] = d28.toimiala_2008
	,[Työnantajasektori] = d29.tyonantajasektori
	,[Yrityksen koko] = d30.oppisopimus_yrityksen_koko

	--mittarit
	,[Aloittaneet2] = f.aloittaneet
	,[Opiskelijat2] = f.opiskelijat
	,[Tutkinnot2] = null
	,[Ammattiosaamisen näyttöjen lukumäärä] = null
	,[Ennen koulutuksen alkua hyväksiluettujen opintoviikkojen määrä] = null
	,[Koulutuksen aikana hyväksiluettujen opintoviikkojen määrä] = null
	,[Koulutuksen aikana suoritettujen opintoviikkojen määrä] = null
	,[Tutkinnon opintoviikot yhteensä] = null
	,[Työssäoppimisen opintoviikkojen määrä] = null
	,[Tutkintojen osien lukumäärä] = null

	--Ruotsi
	,[Statistikår] = f.tilv
	,[Kön] = d1.sukupuoli_SV
	,[Modersmål] = d5.aidinkieli_versio1_SV
	,[Åldersgrupp] = d9.ika5v_SV
	,[Ungdoms-/vuxenutbildning] = d4.nuorten_aikuisten_koulutus_SV
	,[Oppisopimus purkautunutSV] = d10.oppisopimus_purkautunut_SV
	,[Todistus oppisopimuskoulutuksen suorittamisestaSV] = d11.todistus_oppisopimuskoulutuksen_suorittamisesta_SV
	,[Yrittäjän oppisopimuskoulutusSV] = d12.yrittajan_oppisopimuskoulutus_SV
	,[Utbildningsslag] = d6.lukiokoulutuksen_koulutuslaji_SV
--	,[Förvaltningsområde] = d7.opetushallinnon_koulutus_SV
	,[Förvaltningsområde] = d7.hallinnonala_SV
	,[Utbildningens mål (studerandens mål i utbildningen)] = d8.tutkinnon_tavoite_SV
	,[Hela examen/del av en examen] = d27.koulutuksen_tavoite_toteuma_SV
	,[Sättet på vilket utbildningen ordnas] = d13.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_SV
	,[Formen i vilken utbildningen ordnas] = d14.koulutuksen_jarjestamismuoto_SV
	,[Typ av examen] = d15.ammatillisen_koulutuksen_koulutuslaji_SV
	,[Utbildningsområde] = d16.koulutusala2002_SV
	,[Studieområde] = d16.opintoala2002_SV
	,[Utbildningsbenämning] = d16.koulutus_SV
	,[Kompetensområde] = d17.koulutusohjelma_ammpk_SV
	,[Finansieringskälla] = d18.rahoituslahde_amm_SV
	,[Examensbeteckning] = d19.tutkintonimike_ammpk_SV
	,[Utbildningens språk] = d20.kieli_SV
	,[Työvoimapoliittinen koulutusSV] = d21.tyovoimapoliittinen_koulutus_SV
	,[Väg till fristående examen] = null
	,[Utbildningens storområde] = d22.suuralue_SV
	,[Utbildningens kommunens språkliga indelning] = d22.kielisuhde_SV
	,[Utbildningens RFV-område] = d22.avi_SV
	,[Utbildningens NMT-område] = d22.ely_SV
	,[Utbildningens landskap] = d22.maakunta_SV
	,[Utbildningens ekonomisk region] = d22.seutukunta_SV
	,[Utbildningens kommungrupp] = d22.kuntaryhma_SV
	,[Utbildningens kommun] = d22.kunta_SV

	,[Läroanstaltens ägartyp] = d2.oppilaitoksen_omistajatyyppi_SV
	,[Läroanstaltstyp] = d2.oppilaitostyyppi_SV
	,[Läroanstalt] = d2.oppilaitos_SV
	,[Läroanstaltens storområde] = d3.suuralue_SV
	,[Läroanstaltens kommunens språkliga indelning] = d3.kielisuhde_SV
	,[Läroanstaltens RFV-område] = d3.avi_SV
	,[Läroanstaltens NMT-område] = d3.ely_SV
	,[Läroanstaltens landskap] = d3.maakunta_SV
	,[Läroanstaltens ekonomisk region] = d3.seutukunta_SV
	,[Läroanstaltens kommungrupp] = d3.kuntaryhma_SV
	,[Läroanstaltens kommun] = d3.kunta_SV
	,[Läroanstaltens undervisningsspråk] = d2.opetuskieli_SV
	--Historia
	,[Läroanstaltens ägartyp _] = d2b.oppilaitoksen_omistajatyyppi_SV
	,[Läroanstaltstyp _] = d2b.oppilaitostyyppi_SV
	,[Läroanstalt _] = d2b.oppilaitos_SV
	,[Läroanstaltens storområde _] = d3b.suuralue_SV
	,[Läroanstaltens kommunens språkliga indelning _] = d3b.kielisuhde_SV
	,[Läroanstaltens RFV-område _] = d3b.avi_SV
	,[Läroanstaltens NMT-område _] = d3b.ely_SV
	,[Läroanstaltens landskap _] = d3b.maakunta_SV
	,[Läroanstaltens ekonomisk region _] = d3b.seutukunta_SV
	,[Läroanstaltens kommungrupp _] = d3b.kuntaryhma_SV
	,[Läroanstaltens kommun _] = d3b.kunta_SV
	,[Läroanstaltens undervisningsspråk _] = d2b.opetuskieli_SV
	,[Utbildningsanordnare _] = d2b.koulutuksen_jarjestaja_SV
	--
	,[Utbildningsanordnare] = d2d.koulutuksen_jarjestaja_SV
	,[Utbildningsanordnarens ägartyp] = d2d.koulutuksen_jarjestajan_omistajatyyppi_SV
	,[Utbildningsanordnarens storområde] = d24.suuralue_SV
	,[Utbildningsanordnarens kommunens språkliga indelning] = d24.kielisuhde_SV
	,[Utbildningsanordnarens RFV-område] = d24.avi_SV
	,[Utbildningsanordnarens NMT-område] = d24.ely_SV
	,[Utbildningsanordnarens landskap] = d24.maakunta_SV
	,[Utbildningsanordnarens ekonomisk region] = d24.seutukunta_SV
	,[Utbildningsanordnarens kommungrupp] = d24.kuntaryhma_SV
	,[Utbildningsanordnarens kommun] = d24.kunta_SV

	,[Bransch] = d28.toimiala_2008_SV
	,[Arbetsgivarens sektor] = d29.tyonantajasektori_SV
	,[Företagets storlek] = d30.oppisopimus_yrityksen_koko_SV
	
	--Englanti
	,[Statistical year] = f.tilv
	,[Gender] = d1.sukupuoli_EN
	,[Mother tongue] = d5.aidinkieli_versio1_EN
	,[Age group] = d9.ika5v_EN
	,[Youth/adult education] = d4.nuorten_aikuisten_koulutus_EN
	,[Oppisopimus purkautunutEN] = d10.oppisopimus_purkautunut_EN
	,[Todistus oppisopimuskoulutuksen suorittamisestaEN] = d11.todistus_oppisopimuskoulutuksen_suorittamisesta_EN
	,[Yrittäjän oppisopimuskoulutusEN] = d12.yrittajan_oppisopimuskoulutus_EN
	,[Form of education and training] = d6.lukiokoulutuksen_koulutuslaji_EN
--	,[Administrative sector] = d7.opetushallinnon_koulutus_EN
	,[Administrative sector] = d7.hallinnonala_EN
	,[Objective of education (the student''s objective for attaining education)] = d8.tutkinnon_tavoite_EN
	,[Complete qualification/module] = d27.koulutuksen_tavoite_toteuma_EN
	,[Method of vocational education and training] = d13.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_EN
	,[Form of vocational education and training] = d14.koulutuksen_jarjestamismuoto_EN
	,[Qualification type] = d15.ammatillisen_koulutuksen_koulutuslaji_EN
	,[Field of education] = d16.koulutusala2002_EN
	,[Subfield of education] = d16.opintoala2002_EN
	,[Name of education] = d16.koulutus_EN
	,[Competence area] = d17.koulutusohjelma_ammpk_EN
	,[Source of funding] = d18.rahoituslahde_amm_EN
	,[Qualification title] = d19.tutkintonimike_ammpk_EN
	,[Language of education] = d20.kieli_EN
	,[Työvoimapoliittinen koulutusEN] = d21.tyovoimapoliittinen_koulutus_EN
	,[Route to competence-based qualification] = null
	,[Major region of education] = d22.suuralue_EN
	,[Lang. distribution of municipality of education] = d22.kielisuhde_EN
	,[AVI area of education] = d22.avi_EN
	,[ELY area of education] = d22.ely_EN
	,[Region of education] = d22.maakunta_EN
	,[Subregion of education] = d22.seutukunta_EN
	,[Municipality group of education] = d22.kuntaryhma_EN
	,[Municipality of education] = d22.kunta_EN

	,[Type of institution owner] = d2.oppilaitoksen_omistajatyyppi_EN
	,[Type of institution] = d2.oppilaitostyyppi_EN
	,[Educational institution] = d2.oppilaitos_EN
	,[Major region of the institution] = d3.suuralue_EN
	,[Lang. distribution of municipality of the institution] = d3.kielisuhde_EN
	,[AVI area of the institution] = d3.avi_EN
	,[ELY area of the institution] = d3.ely_EN
	,[Region of the institution] = d3.maakunta_EN
	,[Subregion of the institution] = d3.seutukunta_EN
	,[Municipality group of the institution] = d3.kuntaryhma_EN
	,[Municipality of the institution] = d3.kunta_EN
	,[Language of the institution] = d2.opetuskieli_EN
	--Historia
	,[Type of institution owner _] = d2b.oppilaitoksen_omistajatyyppi_EN
	,[Type of institution _] = d2b.oppilaitostyyppi_EN
	,[Educational institution _] = d2b.oppilaitos_EN
	,[Major region of the institution _] = d3b.suuralue_EN
	,[Langb. distribution of municipality of the institution _] = d3b.kielisuhde_EN
	,[AVI area of the institution _] = d3b.avi_EN
	,[ELY area of the institution _] = d3b.ely_EN
	,[Region of the institution _] = d3b.maakunta_EN
	,[Subregion of the institution _] = d3b.seutukunta_EN
	,[Municipality group of the institution _] = d3b.kuntaryhma_EN
	,[Municipality of the institution _] = d3b.kunta_EN
	,[Language of the institution _] = d2b.opetuskieli_EN
	,[Education provider _] = d2b.koulutuksen_jarjestaja_EN
	--
	,[Education provider] = d2d.koulutuksen_jarjestaja_EN
	,[Type of education provider owner] = d2d.koulutuksen_jarjestajan_omistajatyyppi_EN
	,[Major region of the education provider] = d24.suuralue_EN
	,[Lang. distribution of municipality of the education provider] = d24.kielisuhde_EN
	,[AVI area of the education provider] = d24.avi_EN
	,[ELY area of the education provider] = d24.ely_EN
	,[Region of the education provider] = d24.maakunta_EN
	,[Subregion of the education provider] = d24.seutukunta_EN
	,[Municipality group of the education provider] = d24.kuntaryhma_EN
	,[Municipality of the education provider] = d24.kunta_EN

	,[Industry] = d28.toimiala_2008_EN
	,[Employer sector] = d29.tyonantajasektori_EN
	,[Employer size] = d30.oppisopimus_yrityksen_koko_EN

	--koodimuuttujat
	,[Koodit Oppilaitoksen maakunta] = d3.maakunta_koodi
	,[Koodit Oppilaitoksen kunta] = d3.kunta_koodi
	,[Koodit Koulutuksen maakunta] = d22.maakunta_koodi
	,[Koodit Koulutuksen kunta] = d22.kunta_koodi
	,[Koodit Koulutuksen järjestäjän maakunta] = d24.maakunta_koodi
	,[Koodit Koulutuksen järjestäjän kunta] = d24.kunta_koodi
	,[Koodit Koulutusala] = d16.koulutusala2002_koodi
	,[Koodit Opintoala] = d16.opintoala2002_koodi
	,[Koodit Koulutusnimike] = d16.koulutus_koodi
	,[Koodit Osaamisala] = d17.koulutusohjelma_ammpk_koodi
	,[Koodit Koulutuksen järjestäjä] = d2d.koulutuksen_jarjestajakoodi
	,[Koodit Oppilaitos] = d2.oppilaitoskoodi
	,d16.iscle2011_koodi as "Koodit Koulutusaste, taso 1"
	,d16.Koulutusaste_taso2_koodi as "Koodit Koulutusaste, taso 2"
	,d16.iscfibroad2013_koodi as "Koodit Koulutusala, taso 1"
	,d16.iscfinarrow2013_koodi as "Koodit Koulutusala, taso 2"
	,d16.iscfi2013_koodi as "Koodit Koulutusala, taso 3"

	--isced
	,d16.iscle2011 as "Koulutusaste, taso 1"
	,d16.Koulutusaste_taso2 as "Koulutusaste, taso 2"
	,d16.iscfibroad2013 as "Koulutusala, taso 1"
	,d16.iscfinarrow2013 as "Koulutusala, taso 2"
	,d16.iscfi2013 as "Koulutusala, taso 3"
	,d16.iscle2011_SV as "Utbildn.nivå, nivå 1"
	,d16.Koulutusaste_taso2_SV as "Utbildn.nivå, nivå 2"
	,d16.iscfibroad2013_SV as "Utbildn.område, nivå 1"
	,d16.iscfinarrow2013_SV as "Utbildn.område, nivå 2"
	,d16.iscfi2013_SV as "Utbildn.område, nivå 3"
	,d16.iscle2011_EN as "Level of education, tier 1"
	,d16.Koulutusaste_taso2_EN as "Level of education, tier 2"
	,d16.iscfibroad2013_EN as "Field of education, tier 1"
	,d16.iscfinarrow2013_EN as "Field of education, tier 2"
	,d16.iscfi2013_EN as "Field of education, tier 3"
	,d16.jarjestys_iscle2011 as jarj_isced_koulast1
	,d16.jarjestys_Koulutusaste_taso2 as jarj_isced_koulast2
	,d16.jarjestys_iscfibroad2013 as jarj_isced_koulala1
	,d16.jarjestys_iscfinarrow2013 as jarj_isced_koulala2
	,d16.jarjestys_iscfi2013 as jarj_isced_koulala3

	--järjestys
	,[Sukupuoli jarj] = d1.jarjestys
	,[Äidinkieli jarj] = d5.jarjestys
	,[Ikäryhmä jarj] = d9.jarjestys_ika5v
	,[Nuorten/aikuisten jarj] = d4.jarjestys
	,[Oppisopimus purkautunut jarj] = d10.jarjestys
	,[Todistus oppisopimuskoulutuksen suorittamisesta jarj] = d11.jarjestys
	,[Yrittäjän oppisopimuskoulutus jarj] = d12.jarjestys
	,[Koulutuslaji jarj] = d6.jarjestys
	,[Hallinnonala jarj] = d7.jarjestys
	,[Koulutuksen tavoite jarj] = d8.jarjestys
	,[Koko tutkinto / tutk. osa jarj] = d27.jarjestys
	,[Järjestämistapa jarj] = d13.jarjestys
	,[Järjestämismuoto jarj] = d14.jarjestys
	,[Tutkintotyyppi jarj] = d15.jarjestys
	,[Koulutusala jarj] = d16.jarjestys_koulutusala2002
	,[Opintoala jarj] = d16.jarjestys_opintoala2002
	,[Koulutusnimike jarj] = d16.jarjestys
	,[Osaamisala jarj] = d17.jarjestys
	,[Rahoituslähde jarj] = d18.jarjestys
	,[Tutkintonimike jarj] = d19.jarjestys
	,[Koulutuksen kieli jarj] = d20.jarjestys
	,[Työvoimapoliittinen koulutus jarj] = d21.jarjestys
	,[Väylä näyttötutkintoon jarj] = null
	,[Koulutuksen suuralue jarj] = d22.jarjestys_suuralue
	,[Koulutuksen kunnan kielisuhde jarj] = d22.jarjestys_kielisuhde
	,[Koulutuksen AVI jarj] = d22.jarjestys_avi
	,[Koulutuksen ELY jarj] = d22.jarjestys_ely
	,[Koulutuksen maakunta jarj] = d22.jarjestys_maakunta
	,[Koulutuksen seutukunta jarj] = d22.jarjestys_seutukunta
	,[Koulutuksen sijaintikunnan kuntaryhmä jarj] = d22.jarjestys_kuntaryhma
	,[Oppilaitoksen omistajatyyppi jarj] = d2.jarjestys_omistajatyyppi
	,[Oppilaitostyyppi jarj] = d2.jarjestys_oppilaitostyyppi
	,[Oppilaitoksen suuralue jarj] = d3.jarjestys_suuralue
	,[Oppilaitoksen AVI jarj] = d3.jarjestys_avi
	,[Oppilaitoksen ELY jarj] = d3.jarjestys_ely
	,[Oppilaitoksen maakunta jarj] = d3.jarjestys_maakunta
	,[Oppilaitoksen seutukunta jarj] = d3.jarjestys_seutukunta
	,[Oppilaitoksen kuntaryhmä jarj] = d3.jarjestys_kuntaryhma
	,[Oppilaitoksen kielisuhde jarj] = d3.jarjestys_kielisuhde
	,[Oppilaitoksen opetuskieli jarj] = d2.jarjestys_opetuskieli
	,[Koulutuksen järjestäjän omistajatyyppi jarj] = d2.jarjestys_omistajatyyppi
	,[Koulutuksen järjestäjän suuralue jarj] = d24.jarjestys_suuralue
	,[Koulutuksen järjestäjän kunnan kielisuhde jarj] = d24.jarjestys_kielisuhde
	,[Koulutuksen järjestäjän AVI jarj] = d24.jarjestys_avi
	,[Koulutuksen järjestäjän ELY jarj] = d24.jarjestys_ely
	,[Koulutuksen järjestäjän maakunta jarj] = d24.jarjestys_maakunta
	,[Koulutuksen järjestäjän seutukunta jarj] = d24.jarjestys_seutukunta
	,[Koulutuksen järjestäjän sijaintikunnan kuntaryhmä jarj] = d24.jarjestys_kuntaryhma
	,[Toimiala jarj] = d28.jarjestys
	,[Työnantaja jarj] = d29.jarjestys
	,[Yrityksen koko jarj] = d30.jarjestys
	--Historia
	,[Oppil. omistajatyyppi jarj] = d2b.jarjestys_omistajatyyppi
	,[Oppilaitoksen tyyppi jarj] = d2b.jarjestys_oppilaitostyyppi
	,[Oppil. maakunta jarj] = d3b.jarjestys_maakunta
	,[Oppil. opetuskieli jarj] = d2b.jarjestys_opetuskieli
	


from [dbo].[f_OTV_2_3_Lukiokoulutuksen_ja_ammatillisen_koulutuksen_opiskelijat] f
left join VipunenTK.dbo.d_sukupuoli d1 on d1.id=f.sukupuoli_id
left join VipunenTK.dbo.d_oppilaitoksen_taustatiedot d2 on d2.id=f.yht_oppilaitos_id
left join VipunenTK.dbo.d_oppilaitoksen_taustatiedot_historia d2b on d2b.id=f.oppilaitos_historia_id
left join VipunenTK.dbo.d_oppilaitoksen_taustatiedot_historia d2c on SUBSTRING(d2c.oppilaitos_avain, PATINDEX(''%[^0]%'', d2c.oppilaitos_avain), LEN(d2c.oppilaitos_avain))=d2b.oppilaitoksen_korvaavakoodi and tilv between d2c.alkaa and d2c.paattyy
left join VipunenTK.dbo.d_alueluokitus d3 on d3.id=f.yht_oppilaitos_kunta_id
left join VipunenTK.dbo.d_alueluokitus_historia d3b on d3b.id=f.yht_oppilaitos_kunta_historia_id
left join VipunenTK.dbo.d_nuorten_aikuisten_koulutus d4 on d4.id=f.nuorten_aikuisten_koulutus_id
left join VipunenTK.dbo.d_aidinkieli_versio1 d5 on d5.id=f.aidinkieli_versio1_id
left join VipunenTK.dbo.d_lukiokoulutuksen_koulutuslaji d6 on d6.id=f.lukiokoulutuksen_koulutuslaji_id
left join VipunenTK.dbo.d_hallinnonala2 d7 on d7.id=f.hallinnonala2_id
--left join VipunenTK.dbo.d_opetushallinnon_koulutus d7 on d7.id=f.opetushallinnon_koulutus_id
left join VipunenTK.dbo.d_tutkinnon_tavoite d8 on d8.id=f.tutkinnon_tavoite_id
left join VipunenTK.dbo.d_ika d9 on d9.id=f.ika_id
left join VipunenTK.dbo.d_oppisopimus_purkautunut d10 on d10.id=f.oppisopimus_purkautunut_id
left join VipunenTK.dbo.d_todistus_oppisopimuskoulutuksen_suorittamisesta d11 on d11.id=f.todistus_oppisopimuskoulutuksen_suorittamisesta_id
left join VipunenTK.dbo.d_yrittajan_oppisopimuskoulutus d12 on d12.id=f.yrittajan_oppisopimuskoulutus_id
left join VipunenTK.dbo.d_opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus d13 on d13.id=f.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_id
left join VipunenTK.dbo.d_koulutuksen_jarjestamismuoto d14 on d14.id=f.koulutuksen_jarjestamismuoto_id
left join VipunenTK.dbo.d_ammatillisen_koulutuksen_koulutuslaji d15 on d15.id=f.ammatillisen_koulutuksen_koulutuslaji_id
left join VipunenTK.dbo.d_koulutusluokitus d16 on d16.id=f.koulutusluokitus_id
left join VipunenTK.dbo.d_koulutusohjelma_ammpk d17 on d17.id=f.koulutusohjelma_ammpk_id
left join VipunenTK.dbo.d_rahoituslahde_amm d18 on d18.id=f.rahoituslahde_amm_id
left join VipunenTK.dbo.d_tutkintonimike_ammpk d19 on d19.id=f.tutkintonimike_ammpk_id
left join VipunenTK.dbo.d_kieli d20 on d20.id=f.koulutuksen_kieli_id
left join VipunenTK.dbo.d_tyovoimapoliittinen_koulutus d21 on d21.id=f.tyovoimapoliittinen_id
left join VipunenTK.dbo.d_alueluokitus d22 on d22.id=f.yht_koulutuksen_kunta_id
left join VipunenTK.dbo.d_oppilaitoksen_taustatiedot d2d on d2d.id=f.yht_koulutuksen_jarjestaja_id
left join VipunenTK.dbo.d_alueluokitus d24 on d24.id=f.yht_koulutuksen_jarjestaja_kunta_id
left join VipunenTK.dbo.d_koulutussektori d26 on d26.id=f.koulutussektori_id
left join VipunenTK.dbo.d_koulutuksen_tavoite_toteuma d27 on d27.id=f.koulutuksen_tavoite_toteuma_id
left join VipunenTK.dbo.d_toimiala_2008 d28 on d28.id=f.toimiala_2008_id
left join VipunenTK.dbo.d_tyonantajasektori d29 on d29.id=f.tyonantajasektori_id
left join VipunenTK.dbo.d_oppisopimus_yrityksen_koko d30 on d30.id=f.oppisopimus_yrityksen_koko_id



UNION ALL

--tutkinnot
select
	[Tilastovuosi] = f.tilastointivuosi
	
	,[Sukupuoli] = d1.sukupuoli
	,[Äidinkieli] = d5.aidinkieli_versio1
	,[Ikäryhmä] = d9.ika5v
	,[Nuorten/aikuisten koul.] = d4.nuorten_aikuisten_koulutus
	,[Oppisopimus purkautunut] = d10.oppisopimus_purkautunut
	,[Todistus oppisopimuskoulutuksen suorittamisesta] = d11.todistus_oppisopimuskoulutuksen_suorittamisesta
	,[Yrittäjän oppisopimuskoulutus] = d12.yrittajan_oppisopimuskoulutus

	,[Koulutuslaji] = null
--	,[Hallinnonala] = d7.opetushallinnon_koulutus
	,[Hallinnonala] = d7.hallinnonala
	,[Koulutuksen tavoite] = null
	,[Tutkinnon toteuma] = d31.tutkinnon_toteuma
	,[Koko tutkinto / tutk. osa] = d27.koulutuksen_tavoite_toteuma
	,[Järjestämistapa] = d13.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus
	,[Järjestämismuoto] = d14.koulutuksen_jarjestamismuoto
	,[Tutkintotyyppi] = d15.ammatillisen_koulutuksen_koulutuslaji
	,[Koulutusala] = d16.koulutusala2002
	,[Opintoala] = d16.opintoala2002
	,[Koulutusnimike] = d16.koulutus
	,[Osaamisala] = d17.koulutusohjelma_ammpk
	,[Rahoituslähde] = d18.rahoituslahde_amm
	,[Tutkintonimike] = d19.tutkintonimike_ammpk
	,[Koulutuksen kieli] = d20.kieli
	,[Työvoimapoliittinen koulutus] = d21.tyovoimapoliittinen_koulutus
	,[Väylä näyttötutkintoon] = d25.vayla_nayttotutkintoon	
	,[Koulutuksen suuralue] = d22.suuralue
	,[Koulutuksen kunnan kielisuhde] = d22.kielisuhde
	,[Koulutuksen AVI] = d22.avi
	,[Koulutuksen ELY] = d22.ely
	,[Koulutuksen maakunta] = d22.maakunta
	,[Koulutuksen seutukunta] = d22.seutukunta
	,[Koulutuksen sijaintikunnan kuntaryhmä] = d22.kuntaryhma
	,[Koulutuksen kunta] = d22.kunta
	,[Koulutussektori] = d26.koulutussektori

	,[Oppilaitoksen omistajatyyppi] = d2.oppilaitoksen_omistajatyyppi
	,[Oppilaitostyyppi] = d2.oppilaitostyyppi
	,[Oppilaitos] = d2.oppilaitos
	,[Oppilaitoksen suuralue] = d3.suuralue
	,[Oppilaitoksen kunnan kielisuhde] = d3.kielisuhde
	,[Oppilaitoksen AVI] = d3.avi
	,[Oppilaitoksen ELY] = d3.ely
	,[Oppilaitoksen maakunta] = d3.maakunta
	,[Oppilaitoksen seutukunta] = d3.seutukunta
	,[Oppilaitoksen sijaintikunnan kuntaryhmä] = d3.kuntaryhma
	,[Oppilaitoksen kunta] = d3.kunta
	,[Oppilaitoksen opetuskieli] = d2.opetuskieli
	--Historia
	,[Oppil. omistajatyyppi] = d2b.oppilaitoksen_omistajatyyppi
	,[Oppilaitoksen tyyppi] = d2b.oppilaitostyyppi
	,[Oppilaitos _] =  case when coalesce(nullif(d2b.oppilaitoksen_korvaavakoodi,''''),'''') = '''' then d2b.oppilaitos else d2c.oppilaitos end --d2b.oppilaitos
	,[Oppilaitoskoodi] = case when coalesce(nullif(d2b.oppilaitoksen_korvaavakoodi,''''),'''') = '''' then d2b.oppilaitoskoodi else right(''0000''+d2b.[oppilaitoksen_korvaavakoodi],5) end --case when d2b.oppilaitoksen_korvaavakoodi is null then d2b.oppilaitoskoodi else d2c.oppilaitoskoodi end
	,[Oppil. suuralue] = d3b.suuralue
	,[Oppil. kunnan kielisuhde] = d3b.kielisuhde
	,[Oppil. AVI] = d3b.avi
	,[Oppil. ELY] = d3b.ely
	,[Oppil. maakunta] = d3b.maakunta
	,[Oppil. seutukunta] = d3b.seutukunta
	,[Oppil. sijaintikunnan kuntaryhmä] = d3b.kuntaryhma
	,[Oppil. kunta] = d3b.kunta
	,[Oppil. opetuskieli] = d2b.opetuskieli
	,[Koul. järjestäjä] = d2b.koulutuksen_jarjestaja

	,[Koulutuksen järjestäjä] = coalesce(nullif(d2d.koulutuksen_jarjestaja,''Tuntematon''),d2.koulutuksen_jarjestaja)--oppilaitos-dimensiosta puuttuu ilmeisesti koulutuksen järjestäjä -avaimia, joten haetaan puuttuva tieto oppilaitoksen perusteella
	,[Koulutuksen järjestäjän omistajatyyppi] = d2d.koulutuksen_jarjestajan_omistajatyyppi
	,[Koulutuksen järjestäjän suuralue] = d24.suuralue
	,[Koulutuksen järjestäjän kunnan kielisuhde] = d24.kielisuhde
	,[Koulutuksen järjestäjän AVI] = d24.avi
	,[Koulutuksen järjestäjän ELY] = d24.ely
	,[Koulutuksen järjestäjän maakunta] = d24.maakunta
	,[Koulutuksen järjestäjän seutukunta] = d24.seutukunta
	,[Koulutuksen järjestäjän sijaintikunnan kuntaryhmä] = d24.kuntaryhma
	,[Koulutuksen järjestäjän kunta] = d24.kunta

	,[Toimiala] = d28.toimiala_2008
	,[Työnantajasektori] = d29.tyonantajasektori
	,[Yrityksen koko] = d30.oppisopimus_yrityksen_koko

	--mittarit
	,[Aloittaneet2] = 0
	,[Opiskelijat2] = 0
	,[Tutkinnot2] = f.lukumaara
	,[Ammattiosaamisen näyttöjen lukumäärä] = f.lkm_ammattiosaaminen
	,[Ennen koulutuksen alkua hyväksiluettujen opintoviikkojen määrä] = f.ov_hyvaksiluettu_ennen
	,[Koulutuksen aikana hyväksiluettujen opintoviikkojen määrä] = f.ov_hyvaksiluettu_aikana
	,[Koulutuksen aikana suoritettujen opintoviikkojen määrä] = f.ov_suoritettu_koulutuksen_aikana
	,[Tutkinnon opintoviikot yhteensä] = f.ov_yhteensa
	,[Työssäoppimisen opintoviikkojen määrä] = f.ov_tyossaoppiminen
	,[Tutkintojen osien lukumäärä] = f.lkm_opintokokonaisuus

	--Ruotsi
	,[Statistikår] = f.tilastointivuosi
	,[Kön] = d1.sukupuoli_SV
	,[Modersmål] = d5.aidinkieli_versio1_SV
	,[Åldersgrupp] = d9.ika5v_SV
	,[Ungdoms-/vuxenutbildning] = d4.nuorten_aikuisten_koulutus_SV
	,[Oppisopimus purkautunutSV] = d10.oppisopimus_purkautunut_SV
	,[Todistus oppisopimuskoulutuksen suorittamisestaSV] = d11.todistus_oppisopimuskoulutuksen_suorittamisesta_SV
	,[Yrittäjän oppisopimuskoulutusSV] = d12.yrittajan_oppisopimuskoulutus_SV
	,[Utbildningsslag] = null
--	,[Förvaltningsområde] = d7.opetushallinnon_koulutus_SV
	,[Förvaltningsområde] = d7.hallinnonala_SV
	,[Utbildningens mål (studerandens mål i utbildningen)] = d8.tutkinnon_tavoite_SV
	,[Hela examen/del av en examen] = d27.koulutuksen_tavoite_toteuma_SV
	,[Sättet på vilket utbildningen ordnas] = d13.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_SV
	,[Formen i vilken utbildningen ordnas] = d14.koulutuksen_jarjestamismuoto_SV
	,[Typ av examen] = d15.ammatillisen_koulutuksen_koulutuslaji_SV
	,[Utbildningsområde] = d16.koulutusala2002_SV
	,[Studieområde] = d16.opintoala2002_SV
	,[Utbildningsbenämning] = d16.koulutus_SV
	,[Kompetensområde] = d17.koulutusohjelma_ammpk_SV
	,[Finansieringskälla] = d18.rahoituslahde_amm_SV
	,[Examensbeteckning] = d19.tutkintonimike_ammpk_SV
	,[Utbildningens språk] = d20.kieli_SV
	,[Työvoimapoliittinen koulutusSV] = d21.tyovoimapoliittinen_koulutus_SV
	,[Väg till fristående examen] = d25.vayla_nayttotutkintoon_SV
	,[Utbildningens område] = d22.suuralue_SV
	,[Utbildningens kommunens språkliga indelning] = d22.kielisuhde_SV
	,[Utbildningens RFV-område] = d22.avi_SV
	,[Utbildningens NMT-område] = d22.ely_SV
	,[Utbildningens landskap] = d22.maakunta_SV
	,[Utbildningens ekonomisk region] = d22.seutukunta_SV
	,[Utbildningens kommungrupp] = d22.kuntaryhma_SV
	,[Utbildningens kommun] = d22.kunta_SV

	,[Läroanstaltens ägartyp] = d2.oppilaitoksen_omistajatyyppi_SV
	,[Läroanstaltstyp] = d2.oppilaitostyyppi_SV
	,[Läroanstalt] = d2.oppilaitos_SV
	,[Läroanstaltens storområde] = d3.suuralue_SV
	,[Läroanstaltens kommunens språkliga indelning] = d3.kielisuhde_SV
	,[Läroanstaltens RFV-område] = d3.avi_SV
	,[Läroanstaltens NMT-område] = d3.ely_SV
	,[Läroanstaltens landskap] = d3.maakunta_SV
	,[Läroanstaltens ekonomisk region] = d3.seutukunta_SV
	,[Läroanstaltens kommungrupp] = d3.kuntaryhma_SV
	,[Läroanstaltens kommun] = d3.kunta_SV
	,[Läroanstaltens undervisningsspråk] = d2.opetuskieli_SV
	--Historia
	,[Läroanstaltens ägartyp _] = d2b.oppilaitoksen_omistajatyyppi_SV
	,[Läroanstaltstyp _] = d2b.oppilaitostyyppi_SV
	,[Läroanstalt _] = d2b.oppilaitos_SV
	,[Läroanstaltens storområde _] = d3b.suuralue_SV
	,[Läroanstaltens kommunens språkliga indelning _] = d3b.kielisuhde_SV
	,[Läroanstaltens RFV-område _] = d3b.avi_SV
	,[Läroanstaltens NMT-område _] = d3b.ely_SV
	,[Läroanstaltens landskap _] = d3b.maakunta_SV
	,[Läroanstaltens ekonomisk region _] = d3b.seutukunta_SV
	,[Läroanstaltens kommungrupp _] = d3b.kuntaryhma_SV
	,[Läroanstaltens kommun _] = d3b.kunta_SV
	,[Läroanstaltens undervisningsspråk _] = d2b.opetuskieli_SV
	,[Utbildningsanordnare _] = d2b.koulutuksen_jarjestaja_SV
	--
	,[Utbildningsordnare] = d2d.koulutuksen_jarjestaja_SV
	,[Utbildningsanordnarens ägartyp] = d2d.koulutuksen_jarjestajan_omistajatyyppi_SV
	,[Utbildningsordnarens storområde] = d24.suuralue_SV
	,[Utbildningsordnarens kommunens språkliga indelning] = d24.kielisuhde_SV
	,[Utbildningsordnarens RFV-område] = d24.avi_SV
	,[Utbildningsordnarens NMT-område] = d24.ely_SV
	,[Utbildningsordnarens landskap] = d24.maakunta_SV
	,[Utbildningsordnarens ekonomisk region] = d24.seutukunta_SV
	,[Utbildningsordnarens kommungrupp] = d24.kuntaryhma_SV
	,[Utbildningsordnarens kommun] = d24.kunta_SV

	,[Bransch] = d28.toimiala_2008_SV
	,[Arbetsgivarens sektor] = d29.tyonantajasektori_SV
	,[Företagets storlek] = d30.oppisopimus_yrityksen_koko_SV
	
	--Englanti
	,[Statistical year] = f.tilastointivuosi
	,[Gender] = d1.sukupuoli_EN
	,[Mother tongue] = d5.aidinkieli_versio1_EN
	,[Age group] = d9.ika5v_EN
	,[Youth/adult education] = d4.nuorten_aikuisten_koulutus_EN
	,[Oppisopimus purkautunutEN] = d10.oppisopimus_purkautunut_EN
	,[Todistus oppisopimuskoulutuksen suorittamisestaEN] = d11.todistus_oppisopimuskoulutuksen_suorittamisesta_EN
	,[Yrittäjän oppisopimuskoulutusEN] = d12.yrittajan_oppisopimuskoulutus_EN
	,[Form of education and training] = null
--	,[Administrative sector] = d7.opetushallinnon_koulutus_EN
	,[Administrative sector] = d7.hallinnonala_EN
	,[Objective of education (the student''s objective for attaining education)] = d8.tutkinnon_tavoite_EN
	,[Complete qualification/module] = d27.koulutuksen_tavoite_toteuma_EN
	,[Method of vocational education and training] = d13.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_EN
	,[Form of vocational education and training] = d14.koulutuksen_jarjestamismuoto_EN
	,[Qualification type] = d15.ammatillisen_koulutuksen_koulutuslaji_EN
	,[Field of education] = d16.koulutusala2002_EN
	,[Subfield of education] = d16.opintoala2002_EN
	,[Name of education] = d16.koulutus_EN
	,[OsaamisalaEN] = d17.koulutusohjelma_ammpk_EN
	,[Source of funding] = d18.rahoituslahde_amm_EN
	,[Qualification title] = d19.tutkintonimike_ammpk_EN
	,[Language of education] = d20.kieli_EN
	,[Työvoimapoliittinen koulutusEN] = d21.tyovoimapoliittinen_koulutus_EN
	,[Route to competence-based qualification] = d25.vayla_nayttotutkintoon_EN
	,[Major region of education] = d22.suuralue_EN
	,[Lang. distribution of municipality of education] = d22.kielisuhde_EN
	,[AVI area of education] = d22.avi_EN
	,[ELY area of education] = d22.ely_EN
	,[Region of education] = d22.maakunta_EN
	,[Subregion of education] = d22.seutukunta_EN
	,[Municipality group of education] = d22.kuntaryhma_EN
	,[Municipality of ecucation] = d22.kunta_EN

	,[Type of institution owner] = d2.oppilaitoksen_omistajatyyppi_EN
	,[Type of institution] = d2.oppilaitostyyppi_EN
	,[Educational institution] = d2.oppilaitos_EN
	,[Major region of the institution] = d3.suuralue_EN
	,[Lang. distribution of municipality of the institution] = d3.kielisuhde_EN
	,[AVI area of the institution] = d3.avi_EN
	,[ELY area of the institution] = d3.ely_EN
	,[Region of the institution] = d3.maakunta_EN
	,[Subregion of the institution] = d3.seutukunta_EN
	,[Municipality group of the institution] = d3.kuntaryhma_EN
	,[Municipality of the institution] = d3.kunta_EN
	,[Language of the institution] = d2.opetuskieli_EN
	--Historia
	,[Type of institution owner _] = d2b.oppilaitoksen_omistajatyyppi_EN
	,[Type of institution _] = d2b.oppilaitostyyppi_EN
	,[Educational institution _] = d2b.oppilaitos_EN
	,[Major region of the institution _] = d3b.suuralue_EN
	,[Langb. distribution of municipality of the institution _] = d3b.kielisuhde_EN
	,[AVI area of the institution _] = d3b.avi_EN
	,[ELY area of the institution _] = d3b.ely_EN
	,[Region of the institution _] = d3b.maakunta_EN
	,[Subregion of the institution _] = d3b.seutukunta_EN
	,[Municipality group of the institution _] = d3b.kuntaryhma_EN
	,[Municipality of the institution _] = d3b.kunta_EN
	,[Language of the institution _] = d2b.opetuskieli_EN
	,[Education provider _] = d2b.koulutuksen_jarjestaja_EN
	--
	,[Education provider] = d2d.koulutuksen_jarjestaja_EN
	,[Type of education provider owner] = d2d.koulutuksen_jarjestajan_omistajatyyppi_EN
	,[Major region of the education provider] = d24.suuralue_EN
	,[Lang. distribution of municipality of the education provider] = d24.kielisuhde_EN
	,[AVI area of the education provider] = d24.avi_EN
	,[ELY area of the education provider] = d24.ely_EN
	,[Region of the education provider] = d24.maakunta_EN
	,[Subregion of the education provider] = d24.seutukunta_EN
	,[Municipality group of the education provider] = d24.kuntaryhma_EN
	,[Municipality of the education provider] = d24.kunta_EN

	,[Industry] = d28.toimiala_2008_EN
	,[Employer sector] = d29.tyonantajasektori_EN
	,[Employer size] = d30.oppisopimus_yrityksen_koko_EN

	--koodimuuttujat
	,[Koodit Oppilaitoksen maakunta] = d3.maakunta_koodi
	,[Koodit Oppilaitoksen kunta] = d3.kunta_koodi
	,[Koodit Koulutuksen maakunta] = d22.maakunta_koodi
	,[Koodit Koulutuksen kunta] = d22.kunta_koodi
	,[Koodit Koulutuksen järjestäjän maakunta] = d24.maakunta_koodi
	,[Koodit Koulutuksen järjestäjän kunta] = d24.kunta_koodi
	,[Koodit Koulutusala] = d16.koulutusala2002_koodi
	,[Koodit Opintoala] = d16.opintoala2002_koodi
	,[Koodit Koulutusnimike] = d16.koulutus_koodi
	,[Koodit Osaamisala] = d17.koulutusohjelma_ammpk_koodi
	,[Koodit Koulutuksen järjestäjä] = d2d.koulutuksen_jarjestajakoodi
	,[Koodit Oppilaitos] = d2.oppilaitoskoodi
	,d16.iscle2011_koodi as "Koodit Koulutusaste, taso 1"
	,d16.Koulutusaste_taso2_koodi as "Koodit Koulutusaste, taso 2"
	,d16.iscfibroad2013_koodi as "Koodit Koulutusala, taso 1"
	,d16.iscfinarrow2013_koodi as "Koodit Koulutusala, taso 2"
	,d16.iscfi2013_koodi as "Koodit Koulutusala, taso 3"

	--isced
	,d16.iscle2011 as "Koulutusaste, taso 1"
	,d16.Koulutusaste_taso2 as "Koulutusaste, taso 2"
	,d16.iscfibroad2013 as "Koulutusala, taso 1"
	,d16.iscfinarrow2013 as "Koulutusala, taso 2"
	,d16.iscfi2013 as "Koulutusala, taso 3"
	,d16.iscle2011_SV as "Utbildn.nivå, nivå 1"
	,d16.Koulutusaste_taso2_SV as "Utbildn.nivå, nivå 2"
	,d16.iscfibroad2013_SV as "Utbildn.område, nivå 1"
	,d16.iscfinarrow2013_SV as "Utbildn.område, nivå 2"
	,d16.iscfi2013_SV as "Utbildn.område, nivå 3"
	,d16.iscle2011_EN as "Level of education, tier 1"
	,d16.Koulutusaste_taso2_EN as "Level of education, tier 2"
	,d16.iscfibroad2013_EN as "Field of education, tier 1"
	,d16.iscfinarrow2013_EN as "Field of education, tier 2"
	,d16.iscfi2013_EN as "Field of education, tier 3"
	,d16.jarjestys_iscle2011 as jarj_isced_koulast1
	,d16.jarjestys_Koulutusaste_taso2 as jarj_isced_koulast2
	,d16.jarjestys_iscfibroad2013 as jarj_isced_koulala1
	,d16.jarjestys_iscfinarrow2013 as jarj_isced_koulala2
	,d16.jarjestys_iscfi2013 as jarj_isced_koulala3

	--järjestys
	,[Sukupuoli jarj] = d1.jarjestys
	,[Äidinkieli jarj] = d5.jarjestys
	,[Ikäryhmä jarj] = d9.jarjestys_ika5v
	,[Nuorten/aikuisten jarj] = d4.jarjestys
	,[Oppisopimus purkautunut jarj] = d10.jarjestys
	,[Todistus oppisopimuskoulutuksen suorittamisesta jarj] = d11.jarjestys
	,[Yrittäjän oppisopimuskoulutus jarj] = d12.jarjestys
	,[Koulutuslaji jarj] = 99
	,[Hallinnonala jarj] = d7.jarjestys
	,[Koulutuksen tavoite jarj] = d8.jarjestys
	,[Koko tutkinto / tutk. osa jarj] = d27.jarjestys
	,[Järjestämistapa jarj] = d13.jarjestys
	,[Järjestämismuoto jarj] = d14.jarjestys
	,[Tutkintotyyppi jarj] = d15.jarjestys
	,[Koulutusala jarj] = d16.jarjestys_koulutusala2002
	,[Opintoala jarj] = d16.jarjestys_opintoala2002
	,[Koulutusnimike jarj] = d16.jarjestys
	,[Osaamisala jarj] = d17.jarjestys
	,[Rahoituslähde jarj] = d18.jarjestys
	,[Tutkintonimike jarj] = d19.jarjestys
	,[Koulutuksen kieli jarj] = d20.jarjestys
	,[Työvoimapoliittinen koulutus jarj] = d21.jarjestys
	,[Väylä näyttötutkintoon jarj] = d25.jarjestys
	,[Koulutuksen suuralue jarj] = d22.jarjestys_suuralue
	,[Koulutuksen kunnan kielisuhde jarj] = d22.jarjestys_kielisuhde
	,[Koulutuksen AVI jarj] = d22.jarjestys_avi
	,[Koulutuksen ELY jarj] = d22.jarjestys_ely
	,[Koulutuksen maakunta jarj] = d22.jarjestys_maakunta
	,[Koulutuksen seutukunta jarj] = d22.jarjestys_seutukunta
	,[Koulutuksen sijaintikunnan kuntaryhmä jarj] = d22.jarjestys_kuntaryhma
	,[Oppilaitoksen omistajatyyppi jarj] = d2.jarjestys_omistajatyyppi
	,[Oppilaitostyyppi jarj] = d2.jarjestys_oppilaitostyyppi
	,[Oppilaitoksen suuralue jarj] = d3.jarjestys_suuralue
	,[Oppilaitoksen AVI jarj] = d3.jarjestys_avi
	,[Oppilaitoksen ELY jarj] = d3.jarjestys_ely
	,[Oppilaitoksen maakunta jarj] = d3.jarjestys_maakunta
	,[Oppilaitoksen seutukunta jarj] = d3.jarjestys_seutukunta
	,[Oppilaitoksen kuntaryhmä jarj] = d3.jarjestys_kuntaryhma
	,[Oppilaitoksen kielisuhde jarj] = d3.jarjestys_kielisuhde
	,[Oppilaitoksen opetuskieli jarj] = d2.jarjestys_opetuskieli
	,[Koulutuksen järjestäjän omistajatyyppi jarj] = d2.jarjestys_omistajatyyppi
	,[Koulutuksen järjestäjän suuralue jarj] = d24.jarjestys_suuralue
	,[Koulutuksen järjestäjän kunnan kielisuhde jarj] = d24.jarjestys_kielisuhde
	,[Koulutuksen järjestäjän AVI jarj] = d24.jarjestys_avi
	,[Koulutuksen järjestäjän ELY jarj] = d24.jarjestys_ely
	,[Koulutuksen järjestäjän maakunta jarj] = d24.jarjestys_maakunta
	,[Koulutuksen järjestäjän seutukunta jarj] = d24.jarjestys_seutukunta
	,[Koulutuksen järjestäjän sijaintikunnan kuntaryhmä jarj] = d24.jarjestys_kuntaryhma
	,[Toimiala jarj] = d28.jarjestys
	,[Työnantaja jarj] = d29.jarjestys
	,[Yrityksen koko jarj] = d30.jarjestys
	--Historia
	,[Oppil. omistajatyyppi jarj] = d2b.jarjestys_omistajatyyppi
	,[Oppilaitoksen tyyppi jarj] = d2b.jarjestys_oppilaitostyyppi
	,[Oppil. maakunta jarj] = d3b.jarjestys_maakunta
	,[Oppil. opetuskieli jarj] = d2b.jarjestys_opetuskieli


from [dbo].[f_OTV_2_4_Ammatillisen_koulutuksen_tutkinnot] f
left join VipunenTK.dbo.d_sukupuoli d1 on d1.id=f.sukupuoli_id
left join VipunenTK.dbo.d_oppilaitoksen_taustatiedot d2 on d2.id=f.yht_oppilaitos_id
left join VipunenTK.dbo.d_oppilaitoksen_taustatiedot_historia d2b on d2b.id=f.oppilaitos_historia_id
left join VipunenTK.dbo.d_oppilaitoksen_taustatiedot_historia d2c on SUBSTRING(d2c.oppilaitos_avain, PATINDEX(''%[^0]%'', d2c.oppilaitos_avain), LEN(d2c.oppilaitos_avain))=d2b.oppilaitoksen_korvaavakoodi and tilastointivuosi between d2c.alkaa and d2c.paattyy
left join VipunenTK.dbo.d_alueluokitus d3 on d3.id=f.yht_oppilaitos_kunta_id
left join VipunenTK.dbo.d_alueluokitus_historia d3b on d3b.id=f.yht_oppilaitos_kunta_historia_id
left join VipunenTK.dbo.d_nuorten_aikuisten_koulutus d4 on d4.id=f.nuorten_aikuisten_koulutus_id
left join VipunenTK.dbo.d_aidinkieli_versio1 d5 on d5.id=f.aidinkieli_versio1_id
--left join VipunenTK.dbo.d_lukiokoulutuksen_koulutuslaji d6 on d6.id=f.lukiokoulutuksen_koulutuslaji_id
left join VipunenTK.dbo.d_hallinnonala2 d7 on d7.id=f.hallinnonala2_id
--left join VipunenTK.dbo.d_opetushallinnon_koulutus d7 on d7.id=f.opetushallinnon_koulutus_id
left join VipunenTK.dbo.d_tutkinnon_tavoite d8 on d8.id=f.tutkinnon_tavoite_id
left join VipunenTK.dbo.d_ika d9 on d9.id=f.ika_id
left join VipunenTK.dbo.d_oppisopimus_purkautunut d10 on d10.id=f.oppisopimus_purkautunut_id
left join VipunenTK.dbo.d_todistus_oppisopimuskoulutuksen_suorittamisesta d11 on d11.id=f.todistus_oppisopimuskoulutuksen_suorittamisesta_id
left join VipunenTK.dbo.d_yrittajan_oppisopimuskoulutus d12 on d12.id=f.yrittajan_oppisopimuskoulutus_id
left join VipunenTK.dbo.d_opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus d13 on d13.id=f.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_id
left join VipunenTK.dbo.d_koulutuksen_jarjestamismuoto d14 on d14.id=f.koulutuksen_jarjestamismuoto_id
left join VipunenTK.dbo.d_ammatillisen_koulutuksen_koulutuslaji d15 on d15.id=f.ammatillisen_koulutuksen_koulutuslaji_id
left join VipunenTK.dbo.d_koulutusluokitus d16 on d16.id=f.koulutusluokitus_id
left join VipunenTK.dbo.d_koulutusohjelma_ammpk d17 on d17.id=f.koulutusohjelma_ammpk_id
left join VipunenTK.dbo.d_rahoituslahde_amm d18 on d18.id=f.rahoituslahde_amm_id
left join VipunenTK.dbo.d_tutkintonimike_ammpk d19 on d19.id=f.tutkintonimike_ammpk_id
left join VipunenTK.dbo.d_kieli d20 on d20.id=f.koulutuksen_kieli_id
left join VipunenTK.dbo.d_tyovoimapoliittinen_koulutus d21 on d21.id=f.tyovoimapoliittinen_id
left join VipunenTK.dbo.d_alueluokitus d22 on d22.id=f.yht_koulutuksen_kunta_id
left join VipunenTK.dbo.d_oppilaitoksen_taustatiedot d2d on d2d.id=f.yht_koulutuksen_jarjestaja_id
left join VipunenTK.dbo.d_alueluokitus d24 on d24.id=f.yht_koulutuksen_jarjestaja_kunta_id
left join VipunenTK.dbo.d_vayla_nayttotutkintoon d25 on d25.id=f.vayla_nayttotutkintoon_id
left join VipunenTK.dbo.d_koulutussektori d26 on d26.id=f.koulutussektori_id
left join VipunenTK.dbo.d_koulutuksen_tavoite_toteuma d27 on d27.id=f.koulutuksen_tavoite_toteuma_id
left join VipunenTK.dbo.d_toimiala_2008 d28 on d28.id=f.toimiala_2008_id
left join VipunenTK.dbo.d_tyonantajasektori d29 on d29.id=f.tyonantajasektori_id
left join VipunenTK.dbo.d_oppisopimus_yrityksen_koko d30 on d30.id=f.oppisopimus_yrityksen_koko_id
left join VipunenTK.dbo.d_tutkinnon_toteuma d31 on d31.id=f.tutkinnon_toteuma_id

/*
UNION ALL


--Lukio tutkinnot 2010
Select 
		[Tilastovuosi] = f.tilastointivuosi
	
	,[Sukupuoli] = d1.sukupuoli
	,[Äidinkieli] = d5.aidinkieli_versio1
	,[Ikäryhmä] = d9.ika5v
	,[Nuorten/aikuisten koul.] = d4.nuorten_aikuisten_koulutus
	,[Oppisopimus purkautunut] = ''Tuntematon''--d10.oppisopimus_purkautunut
	,[Todistus oppisopimuskoulutuksen suorittamisesta] = ''Tuntematon''--d11.todistus_oppisopimuskoulutuksen_suorittamisesta
	,[Yrittäjän oppisopimuskoulutus] = ''Tuntematon''--d12.yrittajan_oppisopimuskoulutus

	,[Koulutuslaji] = null
	,[Hallinnonala] = d7.hallinnonala
	,[Koulutuksen tavoite] = ''Tuntematon''--d8.tutkinnon_tavoite
	,[Koko tutkinto / tutk. osa] = ''Tuntematon''--d27.koulutuksen_tavoite_toteuma
	,[Järjestämistapa] = d13.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus
	,[Järjestämismuoto] = d14.koulutuksen_jarjestamismuoto
	,[Tutkintotyyppi] = d15.ammatillisen_koulutuksen_koulutuslaji
	,[Koulutusala] = d16.koulutusala2002
	,[Opintoala] = d16.opintoala2002
	,[Koulutusnimike] = d16.koulutus
	,[Osaamisala] = ''Tuntematon''--d17.koulutusohjelma_ammpk
	,[Rahoituslähde] = ''Tuntematon''--d18.rahoituslahde_amm
	,[Tutkintonimike] = ''Tuntematon''--d19.tutkintonimike_ammpk
	,[Koulutuksen kieli] = ''Tuntematon''--d20.kieli
	,[Työvoimapoliittinen koulutus] = ''Tuntematon''--d21.tyovoimapoliittinen_koulutus
	,[Väylä näyttötutkintoon] = ''Tuntematon''--d25.vayla_nayttotutkintoon	
	,[Koulutuksen suuralue] = d22.suuralue
	,[Koulutuksen kunnan kielisuhde] = d22.kielisuhde
	,[Koulutuksen AVI] = d22.avi
	,[Koulutuksen ELY] = d22.ely
	,[Koulutuksen maakunta] = d22.maakunta
	,[Koulutuksen seutukunta] = d22.seutukunta
	,[Koulutuksen sijaintikunnan kuntaryhmä] = d22.kuntaryhma
	,[Koulutuksen kunta] = d22.kunta
	,[Koulutussektori] = d26.koulutussektori

	,[Oppilaitoksen omistajatyyppi] = d2.oppilaitoksen_omistajatyyppi
	,[Oppilaitostyyppi] = d2.oppilaitostyyppi
	,[Oppilaitos] = d2.oppilaitos
	,[Oppilaitoksen suuralue] = d3.suuralue
	,[Oppilaitoksen kunnan kielisuhde] = d3.kielisuhde
	,[Oppilaitoksen AVI] = d3.avi
	,[Oppilaitoksen ELY] = d3.ely
	,[Oppilaitoksen maakunta] = d3.maakunta
	,[Oppilaitoksen seutukunta] = d3.seutukunta
	,[Oppilaitoksen sijaintikunnan kuntaryhmä] = d3.kuntaryhma
	,[Oppilaitoksen kunta] = d3.kunta
	,[Oppilaitoksen opetuskieli] = d2.opetuskieli
	--Historia
	,[Oppil. omistajatyyppi] = d2b.oppilaitoksen_omistajatyyppi
	,[Oppilaitoksen tyyppi] = d2b.oppilaitostyyppi
	,[Oppilaitos _] =  case when coalesce(nullif(d2b.oppilaitoksen_korvaavakoodi,''''),'''') = '''' then d2b.oppilaitos else d2c.oppilaitos end --d2b.oppilaitos
	,[Oppilaitoskoodi] = case when coalesce(nullif(d2b.oppilaitoksen_korvaavakoodi,''''),'''') = '''' then d2b.oppilaitoskoodi else right(''0000''+d2b.[oppilaitoksen_korvaavakoodi],5) end --case when d2b.oppilaitoksen_korvaavakoodi is null then d2b.oppilaitoskoodi else d2c.oppilaitoskoodi end
	,[Oppil. suuralue] = d3b.suuralue
	,[Oppil. kunnan kielisuhde] = d3b.kielisuhde
	,[Oppil. AVI] = d3b.avi
	,[Oppil. ELY] = d3b.ely
	,[Oppil. maakunta] = d3b.maakunta
	,[Oppil. seutukunta] = d3b.seutukunta
	,[Oppil. sijaintikunnan kuntaryhmä] = d3b.kuntaryhma
	,[Oppil. kunta] = d3b.kunta
	,[Oppil. opetuskieli] = d2b.opetuskieli
	,[Koul. järjestäjä] = d2b.koulutuksen_jarjestaja

	,[Koulutuksen järjestäjä] = d2d.koulutuksen_jarjestaja
	,[Koulutuksen järjestäjän omistajatyyppi] = d2d.koulutuksen_jarjestajan_omistajatyyppi
	,[Koulutuksen järjestäjän suuralue] = d24.suuralue
	,[Koulutuksen järjestäjän kunnan kielisuhde] = d24.kielisuhde
	,[Koulutuksen järjestäjän AVI] = d24.avi
	,[Koulutuksen järjestäjän ELY] = d24.ely
	,[Koulutuksen järjestäjän maakunta] = d24.maakunta
	,[Koulutuksen järjestäjän seutukunta] = d24.seutukunta
	,[Koulutuksen järjestäjän sijaintikunnan kuntaryhmä] = d24.kuntaryhma
	,[Koulutuksen järjestäjän kunta] = d24.kunta

	,[Toimiala] = ''Tuntematon''--d28.toimiala_2008
	,[Työnantajasektori] = ''Tuntematon''--d29.tyonantajasektori
	,[Yrityksen koko] = ''Tuntematon''--d30.oppisopimus_yrityksen_koko

	--mittarit
	,[Aloittaneet2] = 0
	,[Opiskelijat2] = 0
	,[Tutkinnot2] = f.lukumaara
	,[Ammattiosaamisen näyttöjen lukumäärä] = 0
	,[Ennen koulutuksen alkua hyväksiluettujen opintoviikkojen määrä] = 0
	,[Koulutuksen aikana hyväksiluettujen opintoviikkojen määrä] = 0
	,[Koulutuksen aikana suoritettujen opintoviikkojen määrä] = 0
	,[Tutkinnon opintoviikot yhteensä] = 0
	,[Työssäoppimisen opintoviikkojen määrä] = 0
	,[Tutkintojen osien lukumäärä] = 0

	--Ruotsi
	,[Statistikår] = f.tilastointivuosi
	,[Kön] = d1.sukupuoli_SV
	,[Modersmål] = d5.aidinkieli_versio1_SV
	,[Åldersgrupp] = d9.ika5v_SV
	,[Ungdoms-/vuxenutbildning] = ''Okänd''--d4.nuorten_aikuisten_koulutus_SV
	,[Oppisopimus purkautunutSV] = ''Okänd''--d10.oppisopimus_purkautunut_SV
	,[Todistus oppisopimuskoulutuksen suorittamisestaSV] = ''Okänd''--d11.todistus_oppisopimuskoulutuksen_suorittamisesta_SV
	,[Yrittäjän oppisopimuskoulutusSV] = ''Okänd''--d12.yrittajan_oppisopimuskoulutus_SV
	,[Utbildningsslag] = null
	,[Förvaltningsområde] = d7.hallinnonala_SV
	,[Utbildningens mål (studerandens mål i utbildningen)] = ''Okänd''--d8.tutkinnon_tavoite_SV
	,[Hela examen/del av en examen] = ''Okänd''--d27.koulutuksen_tavoite_toteuma_SV
	,[Sättet på vilket utbildningen ordnas] = d13.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_SV
	,[Formen i vilken utbildningen ordnas] = d14.koulutuksen_jarjestamismuoto_SV
	,[Typ av examen] = d15.ammatillisen_koulutuksen_koulutuslaji_SV
	,[Utbildningsområde] = d16.koulutusala2002_SV
	,[Studieområde] = d16.opintoala2002_SV
	,[Utbildningsbenämning] = d16.koulutus_SV
	,[Kompetensområde] = ''Okänd''--d17.koulutusohjelma_ammpk_SV
	,[Finansieringskälla] = ''Okänd''--d18.rahoituslahde_amm_SV
	,[Examensbeteckning] = ''Okänd''--d19.tutkintonimike_ammpk_SV
	,[Utbildningens språk] = ''Okänd''--d20.kieli_SV
	,[Työvoimapoliittinen koulutusSV] = ''Okänd''--d21.tyovoimapoliittinen_koulutus_SV
	,[Väg till fristående examen] = ''Okänd''--d25.vayla_nayttotutkintoon_SV
	,[Utbildningens område] = d22.suuralue_SV
	,[Utbildningens kommunens språkliga indelning] = d22.kielisuhde_SV
	,[Utbildningens RFV-område] = d22.avi_SV
	,[Utbildningens NMT-område] = d22.ely_SV
	,[Utbildningens landskap] = d22.maakunta_SV
	,[Utbildningens ekonomisk region] = d22.seutukunta_SV
	,[Utbildningens kommungrupp] = d22.kuntaryhma_SV
	,[Utbildningens kommun] = d22.kunta_SV

	,[Läroanstaltens ägartyp] = d2.oppilaitoksen_omistajatyyppi_SV
	,[Läroanstaltstyp] = d2.oppilaitostyyppi_SV
	,[Läroanstalt] = d2.oppilaitos_SV
	,[Läroanstaltens storområde] = d3.suuralue_SV
	,[Läroanstaltens kommunens språkliga indelning] = d3.kielisuhde_SV
	,[Läroanstaltens RFV-område] = d3.avi_SV
	,[Läroanstaltens NMT-område] = d3.ely_SV
	,[Läroanstaltens landskap] = d3.maakunta_SV
	,[Läroanstaltens ekonomisk region] = d3.seutukunta_SV
	,[Läroanstaltens kommungrupp] = d3.kuntaryhma_SV
	,[Läroanstaltens kommun] = d3.kunta_SV
	,[Läroanstaltens undervisningsspråk] = d2.opetuskieli_SV
	--Historia
	,[Läroanstaltens ägartyp _] = d2b.oppilaitoksen_omistajatyyppi_SV
	,[Läroanstaltstyp _] = d2b.oppilaitostyyppi_SV
	,[Läroanstalt _] = d2b.oppilaitos_SV
	,[Läroanstaltens storområde _] = d3b.suuralue_SV
	,[Läroanstaltens kommunens språkliga indelning _] = d3b.kielisuhde_SV
	,[Läroanstaltens RFV-område _] = d3b.avi_SV
	,[Läroanstaltens NMT-område _] = d3b.ely_SV
	,[Läroanstaltens landskap _] = d3b.maakunta_SV
	,[Läroanstaltens ekonomisk region _] = d3b.seutukunta_SV
	,[Läroanstaltens kommungrupp _] = d3b.kuntaryhma_SV
	,[Läroanstaltens kommun _] = d3b.kunta_SV
	,[Läroanstaltens undervisningsspråk _] = d2b.opetuskieli_SV
	,[Utbildningsanordnare _] = d2b.koulutuksen_jarjestaja_SV
	--
	,[Utbildningsordnare] = d2d.koulutuksen_jarjestaja_SV
	,[Utbildningsanordnarens ägartyp] = d2d.koulutuksen_jarjestajan_omistajatyyppi_SV
	,[Utbildningsordnarens storområde] = d24.suuralue_SV
	,[Utbildningsordnarens kommunens språkliga indelning] = d24.kielisuhde_SV
	,[Utbildningsordnarens RFV-område] = d24.avi_SV
	,[Utbildningsordnarens NMT-område] = d24.ely_SV
	,[Utbildningsordnarens landskap] = d24.maakunta_SV
	,[Utbildningsordnarens ekonomisk region] = d24.seutukunta_SV
	,[Utbildningsordnarens kommungrupp] = d24.kuntaryhma_SV
	,[Utbildningsordnarens kommun] = d24.kunta_SV

	,[Bransch] = ''Okänd''--d28.toimiala_2008_SV
	,[Arbetsgivarens sektor] = ''Okänd''--d29.tyonantajasektori_SV
	,[Företagets storlek] = ''Okänd''--d30.oppisopimus_yrityksen_koko_SV
	
	--Englanti
	,[Statistical year] = f.tilastointivuosi
	,[Gender] = d1.sukupuoli_EN
	,[Mother tongue] = d5.aidinkieli_versio1_EN
	,[Age group] = d9.ika5v_EN
	,[Youth/adult education] = d4.nuorten_aikuisten_koulutus_EN
	,[Oppisopimus purkautunutEN] = ''Unknown''--d10.oppisopimus_purkautunut_EN
	,[Todistus oppisopimuskoulutuksen suorittamisestaEN] = ''Unknown''--d11.todistus_oppisopimuskoulutuksen_suorittamisesta_EN
	,[Yrittäjän oppisopimuskoulutusEN] = ''Unknown''--d12.yrittajan_oppisopimuskoulutus_EN
	,[Form of education and training] = null
	,[Administrative sector] = d7.hallinnonala_EN
	,[Objective of education (the student''s objective for attaining education)] = ''Unknown''--d8.tutkinnon_tavoite_EN
	,[Complete qualification/module] = ''Unknown''--d27.koulutuksen_tavoite_toteuma_EN
	,[Method of vocational education and training] = d13.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_EN
	,[Form of vocational education and training] = d14.koulutuksen_jarjestamismuoto_EN
	,[Qualification type] = d15.ammatillisen_koulutuksen_koulutuslaji_EN
	,[Field of education] = d16.koulutusala2002_EN
	,[Subfield of education] = d16.opintoala2002_EN
	,[Name of education] = d16.koulutus_EN
	,[OsaamisalaEN] = ''Unknown''--d17.koulutusohjelma_ammpk_EN
	,[Source of funding] = ''Unknown''--d18.rahoituslahde_amm_EN
	,[Qualification title] = ''Unknown''--d19.tutkintonimike_ammpk_EN
	,[Language of education] = ''Unknown''--d20.kieli_EN
	,[Työvoimapoliittinen koulutusEN] = ''Unknown''--d21.tyovoimapoliittinen_koulutus_EN
	,[Route to competence-based qualification] = ''Unknown''--d25.vayla_nayttotutkintoon_EN
	,[Major region of education] = d22.suuralue_EN
	,[Lang. distribution of municipality of education] = d22.kielisuhde_EN
	,[AVI area of education] = d22.avi_EN
	,[ELY area of education] = d22.ely_EN
	,[Region of education] = d22.maakunta_EN
	,[Subregion of education] = d22.seutukunta_EN
	,[Municipality group of education] = d22.kuntaryhma_EN
	,[Municipality of ecucation] = d22.kunta_EN

	,[Type of institution owner] = d2.oppilaitoksen_omistajatyyppi_EN
	,[Type of institution] = d2.oppilaitostyyppi_EN
	,[Educational institution] = d2.oppilaitos_EN
	,[Major region of the institution] = d3.suuralue_EN
	,[Lang. distribution of municipality of the institution] = d3.kielisuhde_EN
	,[AVI area of the institution] = d3.avi_EN
	,[ELY area of the institution] = d3.ely_EN
	,[Region of the institution] = d3.maakunta_EN
	,[Subregion of the institution] = d3.seutukunta_EN
	,[Municipality group of the institution] = d3.kuntaryhma_EN
	,[Municipality of the institution] = d3.kunta_EN
	,[Language of the institution] = d2.opetuskieli_EN
	--Historia
	,[Type of institution owner _] = d2b.oppilaitoksen_omistajatyyppi_EN
	,[Type of institution _] = d2b.oppilaitostyyppi_EN
	,[Educational institution _] = d2b.oppilaitos_EN
	,[Major region of the institution _] = d3b.suuralue_EN
	,[Langb. distribution of municipality of the institution _] = d3b.kielisuhde_EN
	,[AVI area of the institution _] = d3b.avi_EN
	,[ELY area of the institution _] = d3b.ely_EN
	,[Region of the institution _] = d3b.maakunta_EN
	,[Subregion of the institution _] = d3b.seutukunta_EN
	,[Municipality group of the institution _] = d3b.kuntaryhma_EN
	,[Municipality of the institution _] = d3b.kunta_EN
	,[Language of the institution _] = d2b.opetuskieli_EN
	,[Education provider _] = d2b.koulutuksen_jarjestaja_EN
	--
	,[Education provider] = d2d.koulutuksen_jarjestaja_EN
	,[Type of education provider owner] = d2d.koulutuksen_jarjestajan_omistajatyyppi_EN
	,[Major region of the education provider] = d24.suuralue_EN
	,[Lang. distribution of municipality of the education provider] = d24.kielisuhde_EN
	,[AVI area of the education provider] = d24.avi_EN
	,[ELY area of the education provider] = d24.ely_EN
	,[Region of the education provider] = d24.maakunta_EN
	,[Subregion of the education provider] = d24.seutukunta_EN
	,[Municipality group of the education provider] = d24.kuntaryhma_EN
	,[Municipality of the education provider] = d24.kunta_EN

	,[Industry] = ''Unknown''--d28.toimiala_2008_EN
	,[Employer sector] = ''Unknown''--d29.tyonantajasektori_EN
	,[Employer size] = ''Unknown''--d30.oppisopimus_yrityksen_koko_EN

	--koodimuuttujat
	,[Koodit Oppilaitoksen maakunta] = d3.maakunta_koodi
	,[Koodit Oppilaitoksen kunta] = d3.kunta_koodi
	,[Koodit Koulutuksen maakunta] = d22.maakunta_koodi
	,[Koodit Koulutuksen kunta] = d22.kunta_koodi
	,[Koodit Koulutuksen järjestäjän maakunta] = d24.maakunta_koodi
	,[Koodit Koulutuksen järjestäjän kunta] = d24.kunta_koodi
	,[Koodit Koulutusala] = d16.koulutusala2002_koodi
	,[Koodit Opintoala] = d16.opintoala2002_koodi
	,[Koodit Koulutusnimike] = d16.koulutus_koodi
	,[Koodit Osaamisala] = null--d17.koulutusohjelma_ammpk_koodi
	,[Koodit Koulutuksen järjestäjä] = d2d.koulutuksen_jarjestajakoodi
	,[Koodit Oppilaitos] = d2.oppilaitoskoodi
	,d16.iscle2011_koodi as "Koodit Koulutusaste, taso 1"
	,d16.Koulutusaste_taso2_koodi as "Koodit Koulutusaste, taso 2"
	,d16.iscfibroad2013_koodi as "Koodit Koulutusala, taso 1"
	,d16.iscfinarrow2013_koodi as "Koodit Koulutusala, taso 2"
	,d16.iscfi2013_koodi as "Koodit Koulutusala, taso 3"

	--isced
	,d16.iscle2011 as "Koulutusaste, taso 1"
	,d16.Koulutusaste_taso2 as "Koulutusaste, taso 2"
	,d16.iscfibroad2013 as "Koulutusala, taso 1"
	,d16.iscfinarrow2013 as "Koulutusala, taso 2"
	,d16.iscfi2013 as "Koulutusala, taso 3"
	,d16.iscle2011_SV as "Utbildn.nivå, nivå 1"
	,d16.Koulutusaste_taso2_SV as "Utbildn.nivå, nivå 2"
	,d16.iscfibroad2013_SV as "Utbildn.område, nivå 1"
	,d16.iscfinarrow2013_SV as "Utbildn.område, nivå 2"
	,d16.iscfi2013_SV as "Utbildn.område, nivå 3"
	,d16.iscle2011_EN as "Level of education, tier 1"
	,d16.Koulutusaste_taso2_EN as "Level of education, tier 2"
	,d16.iscfibroad2013_EN as "Field of education, tier 1"
	,d16.iscfinarrow2013_EN as "Field of education, tier 2"
	,d16.iscfi2013_EN as "Field of education, tier 3"
	,d16.jarjestys_iscle2011 as jarj_isced_koulast1
	,d16.jarjestys_Koulutusaste_taso2 as jarj_isced_koulast2
	,d16.jarjestys_iscfibroad2013 as jarj_isced_koulala1
	,d16.jarjestys_iscfinarrow2013 as jarj_isced_koulala2
	,d16.jarjestys_iscfi2013 as jarj_isced_koulala3

	--järjestys
	,[Sukupuoli jarj] = d1.jarjestys
	,[Äidinkieli jarj] = d5.jarjestys
	,[Ikäryhmä jarj] = d9.jarjestys_ika5v
	,[Nuorten/aikuisten jarj] = d4.jarjestys
	,[Oppisopimus purkautunut jarj] = 99999--d10.jarjestys
	,[Todistus oppisopimuskoulutuksen suorittamisesta jarj] = 99999--d11.jarjestys
	,[Yrittäjän oppisopimuskoulutus jarj] = 99999--d12.jarjestys
	,[Koulutuslaji jarj] = 99
	,[Hallinnonala jarj] = d7.jarjestys
	,[Koulutuksen tavoite jarj] = 99999--d8.jarjestys
	,[Koko tutkinto / tutk. osa jarj] = 99999--d27.jarjestys
	,[Järjestämistapa jarj] = d13.jarjestys
	,[Järjestämismuoto jarj] = d14.jarjestys
	,[Tutkintotyyppi jarj] = d15.jarjestys
	,[Koulutusala jarj] = d16.jarjestys_koulutusala2002
	,[Opintoala jarj] = d16.jarjestys_opintoala2002
	,[Koulutusnimike jarj] = d16.jarjestys
	,[Osaamisala jarj] = 99999--d17.jarjestys
	,[Rahoituslähde jarj] = 99999--d18.jarjestys
	,[Tutkintonimike jarj] = 99999--d19.jarjestys
	,[Koulutuksen kieli jarj] = 99999--d20.jarjestys
	,[Työvoimapoliittinen koulutus jarj] = 99999--d21.jarjestys
	,[Väylä näyttötutkintoon jarj] = 99999--d25.jarjestys
	,[Koulutuksen suuralue jarj] = d22.jarjestys_suuralue
	,[Koulutuksen kunnan kielisuhde jarj] = d22.jarjestys_kielisuhde
	,[Koulutuksen AVI jarj] = d22.jarjestys_avi
	,[Koulutuksen ELY jarj] = d22.jarjestys_ely
	,[Koulutuksen maakunta jarj] = d22.jarjestys_maakunta
	,[Koulutuksen seutukunta jarj] = d22.jarjestys_seutukunta
	,[Koulutuksen sijaintikunnan kuntaryhmä jarj] = d22.jarjestys_kuntaryhma
	,[Oppilaitoksen omistajatyyppi jarj] = d2.jarjestys_omistajatyyppi
	,[Oppilaitostyyppi jarj] = d2.jarjestys_oppilaitostyyppi
	,[Oppilaitoksen suuralue jarj] = d3.jarjestys_suuralue
	,[Oppilaitoksen AVI jarj] = d3.jarjestys_avi
	,[Oppilaitoksen ELY jarj] = d3.jarjestys_ely
	,[Oppilaitoksen maakunta jarj] = d3.jarjestys_maakunta
	,[Oppilaitoksen seutukunta jarj] = d3.jarjestys_seutukunta
	,[Oppilaitoksen kuntaryhmä jarj] = d3.jarjestys_kuntaryhma
	,[Oppilaitoksen kielisuhde jarj] = d3.jarjestys_kielisuhde
	,[Oppilaitoksen opetuskieli jarj] = d2.jarjestys_opetuskieli
	,[Koulutuksen järjestäjän omistajatyyppi jarj] = d2.jarjestys_omistajatyyppi
	,[Koulutuksen järjestäjän suuralue jarj] = d24.jarjestys_suuralue
	,[Koulutuksen järjestäjän kunnan kielisuhde jarj] = d24.jarjestys_kielisuhde
	,[Koulutuksen järjestäjän AVI jarj] = d24.jarjestys_avi
	,[Koulutuksen järjestäjän ELY jarj] = d24.jarjestys_ely
	,[Koulutuksen järjestäjän maakunta jarj] = d24.jarjestys_maakunta
	,[Koulutuksen järjestäjän seutukunta jarj] = d24.jarjestys_seutukunta
	,[Koulutuksen järjestäjän sijaintikunnan kuntaryhmä jarj] = d24.jarjestys_kuntaryhma
	,[Toimiala jarj] = 99999--d28.jarjestys
	,[Työnantaja jarj] = 99999--d29.jarjestys
	,[Yrityksen koko jarj] = 99999--d30.jarjestys
	--Historia
	,[Oppil. omistajatyyppi jarj] = d2b.jarjestys_omistajatyyppi
	,[Oppilaitoksen tyyppi jarj] = d2b.jarjestys_oppilaitostyyppi
	,[Oppil. maakunta jarj] = d3b.jarjestys_maakunta
	,[Oppil. opetuskieli jarj] = d2b.jarjestys_opetuskieli


From [dbo].[f_OTV_3_15_Lukio_ja_ammatillisen_koulutuksen_tutkintojen_mediaani_iat] f
left join VipunenTK.dbo.d_sukupuoli d1 on d1.id=f.sukupuoli_id
left join VipunenTK.dbo.d_oppilaitoksen_taustatiedot d2 on d2.id=f.oppilaitos_id
left join VipunenTK.dbo.d_oppilaitoksen_taustatiedot_historia d2b on d2b.id=f.oppilaitos_historia_id
left join VipunenTK.dbo.d_oppilaitoksen_taustatiedot_historia d2c on SUBSTRING(d2c.oppilaitos_avain, PATINDEX(''%[^0]%'', d2c.oppilaitos_avain), LEN(d2c.oppilaitos_avain))=d2b.oppilaitoksen_korvaavakoodi and tilastointivuosi between d2c.alkaa and d2c.paattyy
left join VipunenTK.dbo.d_alueluokitus d3 on d3.id=f.oppilaitos_kunta_id
left join VipunenTK.dbo.d_alueluokitus_historia d3b on d3b.id=f.oppilaitos_kunta_historia_id
left join VipunenTK.dbo.d_nuorten_aikuisten_koulutus d4 on d4.id=f.nuorten_aikuisten_koulutus_id
left join VipunenTK.dbo.d_aidinkieli_versio1 d5 on d5.id=f.aidinkieli_versio1_id
--left join VipunenTK.dbo.d_lukiokoulutuksen_koulutuslaji d6 on d6.id=f.lukiokoulutuksen_koulutuslaji_id
left join VipunenTK.dbo.d_hallinnonala2 d7 on d7.id=f.hallinnonala2_id
--left join VipunenTK.dbo.d_tutkinnon_tavoite d8 on d8.id=f.tutkinnon_tavoite_id
left join VipunenTK.dbo.d_ika d9 on d9.id=f.ika_1v_id
--left join VipunenTK.dbo.d_oppisopimus_purkautunut d10 on d10.id=f.oppisopimus_purkautunut_id
--left join VipunenTK.dbo.d_todistus_oppisopimuskoulutuksen_suorittamisesta d11 on d11.id=f.todistus_oppisopimuskoulutuksen_suorittamisesta_id
--left join VipunenTK.dbo.d_yrittajan_oppisopimuskoulutus d12 on d12.id=f.yrittajan_oppisopimuskoulutus_id
left join VipunenTK.dbo.d_opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus d13 on d13.id=f.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_id
left join VipunenTK.dbo.d_koulutuksen_jarjestamismuoto d14 on d14.id=f.koulutuksen_jarjestamismuoto_id
left join VipunenTK.dbo.d_ammatillisen_koulutuksen_koulutuslaji d15 on d15.id=f.ammatillisen_koulutuksen_koulutuslaji_id
left join VipunenTK.dbo.d_koulutusluokitus d16 on d16.id=f.koulutusluokitus_id
--left join VipunenTK.dbo.d_koulutusohjelma_ammpk d17 on d17.id=f.koulutusohjelma_ammpk_id
--left join VipunenTK.dbo.d_rahoituslahde_amm d18 on d18.id=f.rahoituslahde_amm_id
--left join VipunenTK.dbo.d_tutkintonimike_ammpk d19 on d19.id=f.tutkintonimike_ammpk_id
--left join VipunenTK.dbo.d_kieli d20 on d20.id=f.koulutuksen_kieli_id
--left join VipunenTK.dbo.d_tyovoimapoliittinen_koulutus d21 on d21.id=f.tyovoimapoliittinen_id
left join VipunenTK.dbo.d_alueluokitus d22 on d22.id=f.oppilaitos_kunta_id
left join VipunenTK.dbo.d_oppilaitoksen_taustatiedot d2d on d2d.id=f.koulutuksen_jarjestaja_id
left join VipunenTK.dbo.d_alueluokitus d24 on d24.id=f.koulutuksen_jarjestaja_kunta_id
--left join VipunenTK.dbo.d_vayla_nayttotutkintoon d25 on d25.id=f.vayla_nayttotutkintoon_id
left join VipunenTK.dbo.d_koulutussektori d26 on d26.id=f.koulutussektori_id
--left join VipunenTK.dbo.d_koulutuksen_tavoite_toteuma d27 on d27.id=f.koulutuksen_tavoite_toteuma_id
--left join VipunenTK.dbo.d_toimiala_2008 d28 on d28.id=f.toimiala_2008_id
--left join VipunenTK.dbo.d_tyonantajasektori d29 on d29.id=f.tyonantajasektori_id
--left join VipunenTK.dbo.d_oppisopimus_yrityksen_koko d30 on d30.id=f.oppisopimus_yrityksen_koko_id

where d2.oppilaitoksen_omistajatyyppi <> ''Ahvenanmaan maakunta'' and f.tilastointivuosi = 2010 and f.koulutussektori = 2



*/





















' 
GO
/****** Object:  View [dbo].[v_f_tab_otv_yhteiset]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_otv_yhteiset]'))
EXEC dbo.sp_executesql @statement = N'





















CREATE VIEW [dbo].[v_f_tab_otv_yhteiset] AS

--Esi- ja perusopetus
Select 
	 Tilastovuosi = f.tilastointivuosi
	,Sukupuoli = d1.sukupuoli
	,Koulutussektori = d2.koulutussektori
	,Koulutusaste = d4.koulutusaste2002
	,Koulutusala = d4.koulutusala2002
	,Opintoala = d4.opintoala2002
	,Koulutusnimike = d4.koulutus
	,Koulutuslaji = d3.koulutuslaji_okm
	--,[Koulutuksen maakunta] = d6.maakunta
	--,[Kotimaakunta] = null

	,aloittaneet_lkm = f.aloittaneet
	,opiskelijat_lkm = f.opiskelijat
	,tutkinnot_lkm = f.tutkinnot

	--Ruotsi
	,Statistikår = f.tilastointivuosi
	,Kön = d1.sukupuoli_SV
	,Utbildningssektor = d2.koulutussektori_SV
	,Utbildningsnivå = d4.koulutusaste2002_SV
	,Utbildningsområde = d4.koulutusala2002_SV
	,Studieområde = d4.opintoala2002_SV
	,Utbildningsbenämning = d4.koulutus_SV
	,Utbildningsslag = d3.koulutuslaji_okm_SV

	--Englanti
	,[Statistical year] = f.tilastointivuosi
	,Gender = d1.sukupuoli_EN
	,[Sector of education] = d2.koulutussektori_EN
	,[Level of education] = d4.koulutusaste2002_EN
	,[Field of education] = d4.koulutusala2002_EN
	,[Subfield of education] = d4.opintoala2002_EN
	,[Name of education] = d4.koulutus_EN
	,[Form of education and training] = d3.koulutuslaji_okm_EN

	--Järjestys
	,[Sukupuoli jarj] = d1.jarjestys
	,[Koulutussektori jarj] = d2.jarjestys
	,[Koulutusaste jarj] = d4.jarjestys_koulutusaste2002
	,[Koulutusala jarj] = d4.jarjestys_koulutusala2002
	,[Opintoala jarj] = d4.jarjestys_opintoala2002
	,[Koulutuslaji jarj] = d3.jarjestys

	--Isced
	,d4.iscle2011 as "Koulutusaste, taso 1"
	,d4.Koulutusaste_taso2 as "Koulutusaste, taso 2"
	,d4.iscfibroad2013 as "Koulutusala, taso 1"
	,d4.iscfinarrow2013 as "Koulutusala, taso 2"
	,d4.iscfi2013 as "Koulutusala, taso 3"
	,d4.iscle2011_SV as "Utbildn.nivå, nivå 1"
	,d4.Koulutusaste_taso2_SV as "Utbildn.nivå, nivå 2"
	,d4.iscfibroad2013_SV as "Utbildn.område, nivå 1"
	,d4.iscfinarrow2013_SV as "Utbildn.område, nivå 2"
	,d4.iscfi2013_SV as "Utbildn.område, nivå 3"
	,d4.iscle2011_EN as "Level of education, tier 1"
	,d4.Koulutusaste_taso2_EN as "Level of education, tier 2"
	,d4.iscfibroad2013_EN as "Field of education, tier 1"
	,d4.iscfinarrow2013_EN as "Field of education, tier 2"
	,d4.iscfi2013_EN as "Field of education, tier 3"
	,d4.jarjestys_iscle2011 as jarj_isced_koulast1
	,d4.jarjestys_Koulutusaste_taso2 as jarj_isced_koulast2
	,d4.jarjestys_iscfibroad2013 as jarj_isced_koulala1
	,d4.jarjestys_iscfinarrow2013 as jarj_isced_koulala2
	,d4.jarjestys_iscfi2013 as jarj_isced_koulala3

	--koodit
	,d4.koulutusala2002_koodi as "Koodit Koulutusala 2002"
	,d4.opintoala2002_koodi as "Koodit Opintoala 2002"
	,d4.koulutus_koodi as "Koodit Koulutusnimike"
	,d4.koulutusaste2002_koodi as "Koodit Koulutusaste 2002"
	,d4.iscle2011_koodi as "Koodit Koulutusaste, taso 1"
	,d4.Koulutusaste_taso2_koodi as "Koodit Koulutusaste, taso 2"
	,d4.iscfibroad2013_koodi as "Koodit Koulutusala, taso 1"
	,d4.iscfinarrow2013_koodi as "Koodit Koulutusala, taso 2"
	,d4.iscfi2013_koodi as "Koodit Koulutusala, taso 3"
	

From [dbo].[f_OTV_2_1_R2_22_Peruskoulutiedosto_Oppilaitostason_oppil_ja_opisk] f
left join VipunenTK.dbo.d_sukupuoli d1 on d1.id=f.sukupuoli_id
left join VipunenTK.dbo.d_koulutussektori d2 on d2.id=f.koulutussektori_id
left join VipunenTK.dbo.d_koulutuslaji_okm d3 on d3.id=f.koulutuslaji_OKM_id
left join VipunenTK.dbo.d_koulutusluokitus d4 on d4.id=f.koulutusluokitus_id
left join VipunenTK.dbo.d_oppilaitoksen_taustatiedot d5 on d5.id=f.oppilaitos_id
--left join VipunenTK.dbo.d_alueluokitus d6 on d6.id=f.oppilaitoksen_sijaintikunta_id
--left join VipunenTK.dbo.d_alueluokitus d7 on d7.id=f.
where d5.oppilaitoksen_omistajatyyppi <> ''Ahvenanmaan maakunta'' and (f.aloittaneet is not null or f.opiskelijat is not null or f.tutkinnot is not null)



UNION ALL

--Lukio ja ammatillinen opiskelijat
Select 
	 Tilastovuosi = f.tilv
	,Sukupuoli = d1.sukupuoli
	,Koulutussektori = d2.koulutussektori
	,Koulutusaste = d4.koulutusaste2002
	,Koulutusala = d4.koulutusala2002
	,Opintoala = d4.opintoala2002
	,Koulutusnimike = d4.koulutus
	,Koulutuslaji = d3.koulutuslaji_okm
	--,[Koulutuksen maakunta] = d6.maakunta
	--,[Kotimaakunta] = d7.maakunta

	,lkm = f.aloittaneet
	,opiskelijat_lkm = f.opiskelijat
	,tutkinnot_lkm = null

	--Ruotsi
	,Statistikår = f.tilv
	,Kön = d1.sukupuoli_SV
	,Utbildningssektor = d2.koulutussektori_SV
	,Utbildningsnivå = d4.koulutusaste2002_SV
	,Utbildningsområde = d4.koulutusala2002_SV
	,Studieområde = d4.opintoala2002_SV
	,Utbildningsbenämning = d4.koulutus_SV
	,Utbildningsslag = d3.koulutuslaji_okm_SV

	--Englanti
	,[Statistical year] = f.tilv
	,Gender = d1.sukupuoli_EN
	,[Sector of education] = d2.koulutussektori_EN
	,[Level of education] = d4.koulutusaste2002_EN
	,[Field of education] = d4.koulutusala2002_EN
	,[Subfield of education] = d4.opintoala2002_EN
	,[Name of education] = d4.koulutus_EN
	,[Form of education and training] = d3.koulutuslaji_okm_EN

	--Järjestys
	,[Sukupuoli jarj] = d1.jarjestys
	,[Koulutussektori jarj] = d2.jarjestys
	,[Koulutusaste jarj] = d4.jarjestys_koulutusaste2002
	,[Koulutusala jarj] = d4.jarjestys_koulutusala2002
	,[Opintoala jarj] = d4.jarjestys_opintoala2002
	,[Koulutuslaji jarj] = d3.jarjestys

	--Isced
	,d4.iscle2011 as "Koulutusaste, taso 1"
	,d4.Koulutusaste_taso2 as "Koulutusaste, taso 2"
	,d4.iscfibroad2013 as "Koulutusala, taso 1"
	,d4.iscfinarrow2013 as "Koulutusala, taso 2"
	,d4.iscfi2013 as "Koulutusala, taso 3"
	,d4.iscle2011_SV as "Utbildn.nivå, nivå 1"
	,d4.Koulutusaste_taso2_SV as "Utbildn.nivå, nivå 2"
	,d4.iscfibroad2013_SV as "Utbildn.område, nivå 1"
	,d4.iscfinarrow2013_SV as "Utbildn.område, nivå 2"
	,d4.iscfi2013_SV as "Utbildn.område, nivå 3"
	,d4.iscle2011_EN as "Level of education, tier 1"
	,d4.Koulutusaste_taso2_EN as "Level of education, tier 2"
	,d4.iscfibroad2013_EN as "Field of education, tier 1"
	,d4.iscfinarrow2013_EN as "Field of education, tier 2"
	,d4.iscfi2013_EN as "Field of education, tier 3"
	,d4.jarjestys_iscle2011 as jarj_isced_koulast1
	,d4.jarjestys_Koulutusaste_taso2 as jarj_isced_koulast2
	,d4.jarjestys_iscfibroad2013 as jarj_isced_koulala1
	,d4.jarjestys_iscfinarrow2013 as jarj_isced_koulala2
	,d4.jarjestys_iscfi2013 as jarj_isced_koulala3

	--koodit
	,d4.koulutusala2002_koodi as "Koodit Koulutusala 2002"
	,d4.opintoala2002_koodi as "Koodit Opintoala 2002"
	,d4.koulutus_koodi as "Koodit Koulutusnimike"
	,d4.koulutusaste2002_koodi as "Koodit Koulutusaste 2002"
	,d4.iscle2011_koodi as "Koodit Koulutusaste, taso 1"
	,d4.Koulutusaste_taso2_koodi as "Koodit Koulutusaste, taso 2"
	,d4.iscfibroad2013_koodi as "Koodit Koulutusala, taso 1"
	,d4.iscfinarrow2013_koodi as "Koodit Koulutusala, taso 2"
	,d4.iscfi2013_koodi as "Koodit Koulutusala, taso 3"
	


From [dbo].[f_OTV_2_3_Lukiokoulutuksen_ja_ammatillisen_koulutuksen_opiskelijat] f
left join VipunenTK.dbo.d_sukupuoli d1 on d1.id=f.sukupuoli_id
left join VipunenTK.dbo.d_koulutussektori d2 on d2.id=f.koulutussektori_id
left join VipunenTK.dbo.d_koulutuslaji_okm d3 on d3.id=f.koulutuslaji_OKM_id
left join VipunenTK.dbo.d_koulutusluokitus d4 on d4.id=f.koulutusluokitus_id
left join VipunenTK.dbo.d_oppilaitoksen_taustatiedot d5 on d5.id=f.yht_oppilaitos_id
--left join VipunenTK.dbo.d_alueluokitus d6 on d6.id=f.yht_koulutuksen_kunta_id
--left join VipunenTK.dbo.d_alueluokitus d7 on d7.id=f.asuinmaakunta_id
where opetushallinnon_koulutus in (-1,1) and d5.oppilaitoksen_omistajatyyppi <> ''Ahvenanmaan maakunta''

UNION ALL

--Lukio ja ammatillinen tutkinnot
Select 
	 Tilastovuosi = f.tilastointivuosi
	,Sukupuoli = d1.sukupuoli
	,Koulutussektori = d2.koulutussektori
	,Koulutusaste = d4.koulutusaste2002
	,Koulutusala = d4.koulutusala2002
	,Opintoala = d4.opintoala2002
	,Koulutusnimike = d4.koulutus
	,Koulutuslaji = d3.koulutuslaji_okm
	--,[Koulutuksen maakunta] = null
	--,[Kotimaakunta] = null

	,lkm = null
	,opiskelijat_lkm = null
	,tutkinnot_lkm = f.lukumaara

	--Ruotsi
	,Statistikår = f.tilastointivuosi
	,Kön = d1.sukupuoli_SV
	,Utbildningssektor = d2.koulutussektori_SV
	,Utbildningsnivå = d4.koulutusaste2002_SV
	,Utbildningsområde = d4.koulutusala2002_SV
	,Studieområde = d4.opintoala2002_SV
	,Utbildningsbenämning = d4.koulutus_SV
	,Utbildningsslag = d3.koulutuslaji_okm_SV

	--Englanti
	,[Statistical year] = f.tilastointivuosi
	,Gender = d1.sukupuoli_EN
	,[Sector of education] = d2.koulutussektori_EN
	,[Level of education] = d4.koulutusaste2002_EN
	,[Field of education] = d4.koulutusala2002_EN
	,[Subfield of education] = d4.opintoala2002_EN
	,[Name of education] = d4.koulutus_EN
	,[Form of education and training] = d3.koulutuslaji_okm_EN

	 --Järjestys
	,[Sukupuoli jarj] = d1.jarjestys
	,[Koulutussektori jarj] = d2.jarjestys
	,[Koulutusaste jarj] = d4.jarjestys_koulutusaste2002
	,[Koulutusala jarj] = d4.jarjestys_koulutusala2002
	,[Opintoala jarj] = d4.jarjestys_opintoala2002
	,[Koulutuslaji jarj] = d3.jarjestys

	--Isced
	,d4.iscle2011 as "Koulutusaste, taso 1"
	,d4.Koulutusaste_taso2 as "Koulutusaste, taso 2"
	,d4.iscfibroad2013 as "Koulutusala, taso 1"
	,d4.iscfinarrow2013 as "Koulutusala, taso 2"
	,d4.iscfi2013 as "Koulutusala, taso 3"
	,d4.iscle2011_SV as "Utbildn.nivå, nivå 1"
	,d4.Koulutusaste_taso2_SV as "Utbildn.nivå, nivå 2"
	,d4.iscfibroad2013_SV as "Utbildn.område, nivå 1"
	,d4.iscfinarrow2013_SV as "Utbildn.område, nivå 2"
	,d4.iscfi2013_SV as "Utbildn.område, nivå 3"
	,d4.iscle2011_EN as "Level of education, tier 1"
	,d4.Koulutusaste_taso2_EN as "Level of education, tier 2"
	,d4.iscfibroad2013_EN as "Field of education, tier 1"
	,d4.iscfinarrow2013_EN as "Field of education, tier 2"
	,d4.iscfi2013_EN as "Field of education, tier 3"
	,d4.jarjestys_iscle2011 as jarj_isced_koulast1
	,d4.jarjestys_Koulutusaste_taso2 as jarj_isced_koulast2
	,d4.jarjestys_iscfibroad2013 as jarj_isced_koulala1
	,d4.jarjestys_iscfinarrow2013 as jarj_isced_koulala2
	,d4.jarjestys_iscfi2013 as jarj_isced_koulala3

	--koodit
	,d4.koulutusala2002_koodi as "Koodit Koulutusala 2002"
	,d4.opintoala2002_koodi as "Koodit Opintoala 2002"
	,d4.koulutus_koodi as "Koodit Koulutusnimike"
	,d4.koulutusaste2002_koodi as "Koodit Koulutusaste 2002"
	,d4.iscle2011_koodi as "Koodit Koulutusaste, taso 1"
	,d4.Koulutusaste_taso2_koodi as "Koodit Koulutusaste, taso 2"
	,d4.iscfibroad2013_koodi as "Koodit Koulutusala, taso 1"
	,d4.iscfinarrow2013_koodi as "Koodit Koulutusala, taso 2"
	,d4.iscfi2013_koodi as "Koodit Koulutusala, taso 3"


From [dbo].[f_OTV_2_4_Ammatillisen_koulutuksen_tutkinnot] f
left join VipunenTK.dbo.d_sukupuoli d1 on d1.id=f.sukupuoli_id
left join VipunenTK.dbo.d_koulutussektori d2 on d2.id=f.koulutussektori_id
left join VipunenTK.dbo.d_koulutuslaji_okm d3 on d3.id=f.koulutuslaji_OKM_id
left join VipunenTK.dbo.d_koulutusluokitus d4 on d4.id=f.koulutusluokitus_id
left join VipunenTK.dbo.d_oppilaitoksen_taustatiedot d5 on d5.id=f.yht_oppilaitos_id
where opetushallinnon_koulutus_id <> 2 and tutkinnon_toteuma_id <> 47 and d5.oppilaitoksen_omistajatyyppi <> ''Ahvenanmaan maakunta''
/*
UNION ALL

--Lukio tutkinnot 2010
Select 
	 Tilastovuosi = f.tilastointivuosi
	,Sukupuoli = d1.sukupuoli
	,Koulutussektori = d2.koulutussektori
	,Koulutusaste = d4.koulutusaste2002
	,Koulutusala = d4.koulutusala2002
	,Opintoala = d4.opintoala2002
	,Koulutusnimike = d4.koulutus
	,Koulutuslaji = d3.koulutuslaji_okm
	--,[Koulutuksen maakunta] = null
	--,[Kotimaakunta] = null

	,lkm = null
	,opiskelijat_lkm = null
	,tutkinnot_lkm = f.lukumaara

	--Ruotsi
	,Statistikår = f.tilastointivuosi
	,Kön = d1.sukupuoli_SV
	,Utbildningssektor = d2.koulutussektori_SV
	,Utbildningsnivå = d4.koulutusaste2002_SV
	,Utbildningsområde = d4.koulutusala2002_SV
	,Studieområde = d4.opintoala2002_SV
	,Utbildningsbenämning = d4.koulutus_SV
	,Utbildningsslag = d3.koulutuslaji_okm_SV

	--Englanti
	,[Statistical year] = f.tilastointivuosi
	,Gender = d1.sukupuoli_EN
	,[Sector of education] = d2.koulutussektori_EN
	,[Level of education] = d4.koulutusaste2002_EN
	,[Field of education] = d4.koulutusala2002_EN
	,[Subfield of education] = d4.opintoala2002_EN
	,[Name of education] = d4.koulutus_EN
	,[Form of education and training] = d3.koulutuslaji_okm_EN

	 --Järjestys
	,[Sukupuoli jarj] = d1.jarjestys
	,[Koulutussektori jarj] = d2.jarjestys
	,[Koulutusaste jarj] = d4.jarjestys_koulutusaste2002
	,[Koulutusala jarj] = d4.jarjestys_koulutusala2002
	,[Opintoala jarj] = d4.jarjestys_opintoala2002
	,[Koulutuslaji jarj] = d3.jarjestys

	--Isced
	,d4.iscle2011 as "Koulutusaste, taso 1"
	,d4.Koulutusaste_taso2 as "Koulutusaste, taso 2"
	,d4.iscfibroad2013 as "Koulutusala, taso 1"
	,d4.iscfinarrow2013 as "Koulutusala, taso 2"
	,d4.iscfi2013 as "Koulutusala, taso 3"
	,d4.iscle2011_SV as "Utbildn.nivå, nivå 1"
	,d4.Koulutusaste_taso2_SV as "Utbildn.nivå, nivå 2"
	,d4.iscfibroad2013_SV as "Utbildn.område, nivå 1"
	,d4.iscfinarrow2013_SV as "Utbildn.område, nivå 2"
	,d4.iscfi2013_SV as "Utbildn.område, nivå 3"
	,d4.iscle2011_EN as "Level of education, tier 1"
	,d4.Koulutusaste_taso2_EN as "Level of education, tier 2"
	,d4.iscfibroad2013_EN as "Field of education, tier 1"
	,d4.iscfinarrow2013_EN as "Field of education, tier 2"
	,d4.iscfi2013_EN as "Field of education, tier 3"
	,d4.jarjestys_iscle2011 as jarj_isced_koulast1
	,d4.jarjestys_Koulutusaste_taso2 as jarj_isced_koulast2
	,d4.jarjestys_iscfibroad2013 as jarj_isced_koulala1
	,d4.jarjestys_iscfinarrow2013 as jarj_isced_koulala2
	,d4.jarjestys_iscfi2013 as jarj_isced_koulala3

	--koodit
	,d4.koulutusala2002_koodi as "Koodit Koulutusala 2002"
	,d4.opintoala2002_koodi as "Koodit Opintoala 2002"
	,d4.koulutus_koodi as "Koodit Koulutusnimike"
	,d4.koulutusaste2002_koodi as "Koodit Koulutusaste 2002"
	,d4.iscle2011_koodi as "Koodit Koulutusaste, taso 1"
	,d4.Koulutusaste_taso2_koodi as "Koodit Koulutusaste, taso 2"
	,d4.iscfibroad2013_koodi as "Koodit Koulutusala, taso 1"
	,d4.iscfinarrow2013_koodi as "Koodit Koulutusala, taso 2"
	,d4.iscfi2013_koodi as "Koodit Koulutusala, taso 3"


From [dbo].[f_OTV_3_15_Lukio_ja_ammatillisen_koulutuksen_tutkintojen_mediaani_iat] f
left join VipunenTK.dbo.d_sukupuoli d1 on d1.id=f.sukupuoli_id
left join VipunenTK.dbo.d_koulutussektori d2 on d2.id=f.koulutussektori_id
left join VipunenTK.dbo.d_koulutuslaji_okm d3 on d3.id=f.koulutuslaji_OKM_id
left join VipunenTK.dbo.d_koulutusluokitus d4 on d4.id=f.koulutusluokitus_id
left join VipunenTK.dbo.d_oppilaitoksen_taustatiedot d5 on d5.id=f.oppilaitos_id
where d5.oppilaitoksen_omistajatyyppi <> ''Ahvenanmaan maakunta'' and f.tilastointivuosi = 2010 and f.koulutussektori = 2
*/
UNION ALL

--Korkea-aste opiskelijat
Select 
	 Tilastovuosi = f.tilastointivuosi
	,Sukupuoli = d1.sukupuoli
	,Koulutussektori = d2.koulutussektori
	,Koulutusaste = d4.koulutusaste2002
	,Koulutusala = d4.koulutusala2002
	,Opintoala = d4.opintoala2002
	,Koulutusnimike = d4.koulutus
	,Koulutuslaji = d3.koulutuslaji_okm
	--,[Koulutuksen maakunta] = d6.maakunta
	--,[Kotikunta] = d7.maakunta
	
	,lkm = f.aloittaneet
	,opiskelijat_lkm = f.opiskelijat
	,tutkinnot_lkm = null

	--Ruotsi
	,Statistikår = f.tilastointivuosi
	,Kön = d1.sukupuoli_SV
	,Utbildningssektor = d2.koulutussektori_SV
	,Utbildningsnivå = d4.koulutusaste2002_SV
	,Utbildningsområde = d4.koulutusala2002_SV
	,Studieområde = d4.opintoala2002_SV
	,Utbildningsbenämning = d4.koulutus_SV
	,Utbildningsslag = d3.koulutuslaji_okm_SV

	--Englanti
	,[Statistical year] = f.tilastointivuosi
	,Gender = d1.sukupuoli_EN
	,[Sector of education] = d2.koulutussektori_EN
	,[Level of education] = d4.koulutusaste2002_EN
	,[Field of education] = d4.koulutusala2002_EN
	,[Subfield of education] = d4.opintoala2002_EN
	,[Name of education] = d4.koulutus_EN
	,[Form of education and training] = d3.koulutuslaji_okm_EN

	--Järjestys
	,[Sukupuoli jarj] = d1.jarjestys
	,[Koulutussektori jarj] = d2.jarjestys
	,[Koulutusaste jarj] = d4.jarjestys_koulutusaste2002
	,[Koulutusala jarj] = d4.jarjestys_koulutusala2002
	,[Opintoala jarj] = d4.jarjestys_opintoala2002
	,[Koulutuslaji jarj] = d3.jarjestys

	--Isced
	,d4.iscle2011 as "Koulutusaste, taso 1"
	,d4.Koulutusaste_taso2 as "Koulutusaste, taso 2"
	,d4.iscfibroad2013 as "Koulutusala, taso 1"
	,d4.iscfinarrow2013 as "Koulutusala, taso 2"
	,d4.iscfi2013 as "Koulutusala, taso 3"
	,d4.iscle2011_SV as "Utbildn.nivå, nivå 1"
	,d4.Koulutusaste_taso2_SV as "Utbildn.nivå, nivå 2"
	,d4.iscfibroad2013_SV as "Utbildn.område, nivå 1"
	,d4.iscfinarrow2013_SV as "Utbildn.område, nivå 2"
	,d4.iscfi2013_SV as "Utbildn.område, nivå 3"
	,d4.iscle2011_EN as "Level of education, tier 1"
	,d4.Koulutusaste_taso2_EN as "Level of education, tier 2"
	,d4.iscfibroad2013_EN as "Field of education, tier 1"
	,d4.iscfinarrow2013_EN as "Field of education, tier 2"
	,d4.iscfi2013_EN as "Field of education, tier 3"
	,d4.jarjestys_iscle2011 as jarj_isced_koulast1
	,d4.jarjestys_Koulutusaste_taso2 as jarj_isced_koulast2
	,d4.jarjestys_iscfibroad2013 as jarj_isced_koulala1
	,d4.jarjestys_iscfinarrow2013 as jarj_isced_koulala2
	,d4.jarjestys_iscfi2013 as jarj_isced_koulala3

	--Koodit
	,d4.koulutusala2002_koodi as "Koodit Koulutusala 2002"
	,d4.opintoala2002_koodi as "Koodit Opintoala 2002"
	,d4.koulutus_koodi as "Koodit Koulutusnimike"
	,d4.koulutusaste2002_koodi as "Koodit Koulutusaste 2002"
	,d4.iscle2011_koodi as "Koodit Koulutusaste, taso 1"
	,d4.Koulutusaste_taso2_koodi as "Koodit Koulutusaste, taso 2"
	,d4.iscfibroad2013_koodi as "Koodit Koulutusala, taso 1"
	,d4.iscfinarrow2013_koodi as "Koodit Koulutusala, taso 2"
	,d4.iscfi2013_koodi as "Koodit Koulutusala, taso 3"


From [dbo].[f_OTV_2_8_Korkeakouluopiskelijat] f
left join VipunenTK.dbo.d_sukupuoli d1 on d1.id=f.sukupuoli_id
left join VipunenTK.dbo.d_koulutussektori d2 on d2.id=f.koulutussektori_id
left join VipunenTK.dbo.d_koulutuslaji_okm d3 on d3.id=f.koulutuslaji_OKM_id
left join VipunenTK.dbo.d_koulutusluokitus d4 on d4.id=f.koulutusluokitus_id
--left join VipunenTK.dbo.d_oppilaitoksen_taustatiedot d5 on d5.id=f.oppilaitos_id
--left join VipunenTK.dbo.d_alueluokitus d6 on d6.id=f.koulutuksen_kunta_id
--left join VipunenTK.dbo.d_alueluokitus d7 on d7.id=f.kotikunta1x_id
left join VipunenTK.dbo.d_ensisijainen_opintooikeus d8 on d8.id=f.ensisijainen_opintooikeus_id

where 
f.koulutustyyppi not in (3,5) 
and f.aineisto <> ''E''
and d8.ensisijainen_opintooikeus_koodi <>  2
and f.oppilaitos <> ''02557'' AND f.oppilaitos <> ''10031'' AND f.oppilaitos <> ''02358''


UNION ALL

--Korkea-aste tutkinnot
Select 
	 Tilastovuosi = f.tilastointivuosi
	,Sukupuoli = d1.sukupuoli
	,Koulutussektori = d2.koulutussektori
	,Koulutusaste = d4.koulutusaste2002
	,Koulutusala = d4.koulutusala2002
	,Opintoala = d4.opintoala2002
	,Koulutusnimike = d4.koulutus
	,Koulutuslaji = d3.koulutuslaji_okm
	--,[Koulutuksen maakunta] = null
	--,[Kotikunta] = null

	,lkm = null
	,opiskelijat_lkm = null
	,tutkinnot_lkm = f.lukumaara

	--Ruotsi
	,Statistikår = f.tilastointivuosi
	,Kön = d1.sukupuoli_SV
	,Utbildningssektor = d2.koulutussektori_SV
	,Utbildningsnivå = d4.koulutusaste2002_SV
	,Utbildningsområde = d4.koulutusala2002_SV
	,Studieområde = d4.opintoala2002_SV
	,Utbildningsbenämning = d4.koulutus_SV
	,Utbildningsslag = d3.koulutuslaji_okm_SV

	--Englanti
	,[Statistical year] = f.tilastointivuosi
	,Gender = d1.sukupuoli_EN
	,[Sector of education] = d2.koulutussektori_EN
	,[Level of education] = d4.koulutusaste2002_EN
	,[Field of education] = d4.koulutusala2002_EN
	,[Subfield of education] = d4.opintoala2002_EN
	,[Name of education] = d4.koulutus_EN
	,[Form of education and training] = d3.koulutuslaji_okm_EN

	--Järjestys
	,[Sukupuoli jarj] = d1.jarjestys
	,[Koulutussektori jarj] = d2.jarjestys
	,[Koulutusaste jarj] = d4.jarjestys_koulutusaste2002
	,[Koulutusala jarj] = d4.jarjestys_koulutusala2002
	,[Opintoala jarj] = d4.jarjestys_opintoala2002
	,[Koulutuslaji jarj] = d3.jarjestys

	--Isced
	,d4.iscle2011 as "Koulutusaste, taso 1"
	,d4.Koulutusaste_taso2 as "Koulutusaste, taso 2"
	,d4.iscfibroad2013 as "Koulutusala, taso 1"
	,d4.iscfinarrow2013 as "Koulutusala, taso 2"
	,d4.iscfi2013 as "Koulutusala, taso 3"
	,d4.iscle2011_SV as "Utbildn.nivå, nivå 1"
	,d4.Koulutusaste_taso2_SV as "Utbildn.nivå, nivå 2"
	,d4.iscfibroad2013_SV as "Utbildn.område, nivå 1"
	,d4.iscfinarrow2013_SV as "Utbildn.område, nivå 2"
	,d4.iscfi2013_SV as "Utbildn.område, nivå 3"
	,d4.iscle2011_EN as "Level of education, tier 1"
	,d4.Koulutusaste_taso2_EN as "Level of education, tier 2"
	,d4.iscfibroad2013_EN as "Field of education, tier 1"
	,d4.iscfinarrow2013_EN as "Field of education, tier 2"
	,d4.iscfi2013_EN as "Field of education, tier 3"
	,d4.jarjestys_iscle2011 as jarj_isced_koulast1
	,d4.jarjestys_Koulutusaste_taso2 as jarj_isced_koulast2
	,d4.jarjestys_iscfibroad2013 as jarj_isced_koulala1
	,d4.jarjestys_iscfinarrow2013 as jarj_isced_koulala2
	,d4.jarjestys_iscfi2013 as jarj_isced_koulala3

	--Koodit
	,d4.koulutusala2002_koodi as "Koodit Koulutusala 2002"
	,d4.opintoala2002_koodi as "Koodit Opintoala 2002"
	,d4.koulutus_koodi as "Koodit Koulutusnimike"
	,d4.koulutusaste2002_koodi as "Koodit Koulutusaste 2002"
	,d4.iscle2011_koodi as "Koodit Koulutusaste, taso 1"
	,d4.Koulutusaste_taso2_koodi as "Koodit Koulutusaste, taso 2"
	,d4.iscfibroad2013_koodi as "Koodit Koulutusala, taso 1"
	,d4.iscfinarrow2013_koodi as "Koodit Koulutusala, taso 2"
	,d4.iscfi2013_koodi as "Koodit Koulutusala, taso 3"

From [dbo].[f_OTV_2_9_Korkeakoulututkinnot] f
left join VipunenTK.dbo.d_sukupuoli d1 on d1.id=f.sukupuoli_id
left join VipunenTK.dbo.d_koulutussektori d2 on d2.id=f.koulutussektori_id
left join VipunenTK.dbo.d_koulutuslaji_okm d3 on d3.id=f.koulutuslaji_OKM_id
left join VipunenTK.dbo.d_koulutusluokitus d4 on d4.id=f.koulutusluokitus_id
where 
--f.koulutustyyppi not in (3,5) 
f.aineisto <> ''E''
and f.oppilaitos <> ''02557'' AND f.oppilaitos <> ''10031'' AND f.oppilaitos <> ''02358''


















' 
GO
/****** Object:  View [dbo].[v_f_tab_paivahoidon_yhteydessa_annettavan_esiopetuksen_aineisto]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_paivahoidon_yhteydessa_annettavan_esiopetuksen_aineisto]'))
EXEC dbo.sp_executesql @statement = N'


CREATE VIEW [dbo].[v_f_tab_paivahoidon_yhteydessa_annettavan_esiopetuksen_aineisto]
AS
SELECT [tilv] AS Tilastovuosi
      ,d1.[koulutuksen_jarjestaja] AS [Opetuksen järjestäjä]
	  ,d1.[koulutuksen_jarjestajan_kieli] AS [Opetuksen järjestäjän kieli]
	  ,d1.[koulutuksen_jarjestajan_omistajatyyppi] AS [Opetuksen järjestäjän omistajatyyppi]
      ,d2.[kunta] AS [Opetuksen järjestäjän kunta]
	  ,d2.[maakunta] AS [Opetuksen järjestäjän maakunta]
	  ,d2.[ely] AS [Opetuksen järjestäjän ELY]
	  ,d2.[avi] AS [Opetuksen järjestäjän AVI]
      ,d3.[tiedonantajatyyppi] AS [Opetuksen järjestäjän tiedonantajatyyppi]
      ,[popy] AS [Oppilaat]
      ,[jmamu]
      ,[psisa]
      ,[jmamusisa]
      ,[pteho]
      ,[pertu]
      ,[pertuv]
      ,[pertum]
      ,[ptehoerop]
      ,[pviertu]
      ,[pviertuv]
      ,[pviertum]
      ,[pvimuut]
      ,[pviop]
      ,[pkuertu]
      ,[pkuertuv]
      ,[pkuertum]
      ,[pkumuut]
      ,[pkuop]
      ,[ppid5v]
      ,[pmuu5v]
      ,[pop5v]
      ,[apip1]
      ,[apip2]
      ,[apip39]
      ,[apipy]
      ,[oma3s]
      ,[osto3s]
      ,[avust3s]
      ,[syk3s]
      ,[oma4s]
      ,[osto4s]
      ,[avust4s]
      ,[syk4s]
      ,[omams]
      ,[ostoms]
      ,[avustms]
      ,[sykms]
      ,[omays]
      ,[ostoys]
      ,[avustys]
      ,[sykys]
      ,[oma3k]
      ,[osto3k]
      ,[avust3k]
      ,[kev3k]
      ,[oma4k]
      ,[osto4k]
      ,[avust4k]
      ,[kev4k]
      ,[omamk]
      ,[ostomk]
      ,[avustmk]
      ,[kevmk]
      ,[omayk]
      ,[ostoyk]
      ,[avustyk]
      ,[kevyk]
      ,(SELECT kylla_ei FROM d_kylla_ei WHERE id = [pesis_kylla_ei_id]) AS [Päivähoidon yhteydessä tapahtuva esiopetus siirretty]
      ,d4.[kunta] AS [Siirretyn päivähoidon esiopetuksen järjestäjän kunta]
	  ,d4.[maakunta] AS [Siirretyn päivähoidon esiopetuksen järjestäjän maakunta]
	  ,d4.[ely] AS [Siirretyn päivähoidon esiopetuksen järjestäjän ELY]
	  ,d4.[avi] AS [Siirretyn päivähoidon esiopetuksen järjestäjän AVI]
      ,(SELECT kylla_ei FROM d_kylla_ei WHERE id = [kesis_kylla_ei_id]) AS [Koulun yhteydessä tapahtuva esiopetus siirretty]
      ,d5.[kunta] AS [Siirretyn koulun esiopetuksen järjestäjän kunta]
	  ,d5.[maakunta] AS [Siirretyn koulun esiopetuksen järjestäjän maakunta]
	  ,d5.[ely] AS [Siirretyn koulun esiopetuksen järjestäjän ELY]
	  ,d5.[avi] AS [Siirretyn koulun esiopetuksen järjestäjän AVI]
      ,(SELECT kylla_ei FROM d_kylla_ei WHERE id = [perops_kylla_ei_id]) AS [Kunta siirtänyt perusopetuksen järjestämisen toiselle kunnalle]
      ,d6.[kunta] AS [Siirretyn perusopetuksen järjestäjän kunta]
	  ,d6.[maakunta] AS [Siirretyn perusopetuksen järjestäjän maakunta]
	  ,d6.[ely] AS [Siirretyn perusopetuksen järjestäjän ELY]
	  ,d6.[avi] AS [Siirretyn perusopetuksen järjestäjän AVI]
      ,(SELECT kylla_ei FROM d_kylla_ei WHERE id = [apips_kylla_ei_id]) AS [Aamu- ja iltapäivätoiminta siirretty]
      ,d7.[kunta] AS [Siirretyn aamu- ja iltapäivätoiminnan järjestäjän kunta]
	  ,d7.[maakunta] AS [Siirretyn aamu- ja iltapäivätoiminnan järjestäjän maakunta]
	  ,d7.[ely] AS [Siirretyn aamu- ja iltapäivätoiminnan järjestäjän ELY]
	  ,d7.[avi] AS [Siirretyn aamu- ja iltapäivätoiminnan järjestäjän AVI]
      ,[luontipvm]

	  --ruotsi
	  ,[tilv] AS Statistikår
	  ,d1.[koulutuksen_jarjestaja_SV] AS [Utbildningsanordnare]
	  ,d1.[koulutuksen_jarjestajan_kieli_SV] AS [Utbildningsanordnarens språk]
	  ,d1.[koulutuksen_jarjestajan_omistajatyyppi_SV] AS [Utbildningsanordnarens ägartyp]
      ,d2.[kunta_SV] AS [Utbildningsanordnarens kommun]
	  ,d2.[maakunta_SV] AS [Utbildningsanordnarens landskap]
      

	  --englanti
	  ,[tilv] AS [Statistical year]
	  ,d1.[koulutuksen_jarjestaja_EN] AS [Education provider]
	  ,d1.[koulutuksen_jarjestajan_kieli_EN] AS [Language of the education provider]
	  ,d1.[koulutuksen_jarjestajan_omistajatyyppi_EN] AS [Type of education provider owner]
      ,d2.[kunta_EN] AS [Municipality of the education provider]
	  ,d2.[maakunta_EN] AS [Region of the education provider]


	  --järjestys
	  ,d1.[jarjestys_koulutuksenjarjestaja]
	  ,d1.[jarjestys_koulutuksen_jarjestajan_kieli]
      ,d2.[jarjestys] AS [jarjestys_kunta]
      ,d2.[jarjestys_maakunta]
      ,d2.[jarjestys_avi]
      ,d2.[jarjestys_ely]
      ,d3.[jarjestys] AS [jarjestys_tiedonantajatyyppi]
      ,d4.[jarjestys] AS [jarjestys_pesis_kunta]
      ,d4.[jarjestys_maakunta] AS [jarjestys_pesis_maakunta]
      ,d4.[jarjestys_avi] AS [jarjestys_pesis_avi]
      ,d4.[jarjestys_ely] AS [jarjestys_pesis_ely]
      ,d5.[jarjestys] AS [jarjestys_kesis_kunta]
      ,d5.[jarjestys_maakunta] AS [jarjestys_kesis_maakunta]
      ,d5.[jarjestys_avi] AS [jarjestys_kesis_avi]
      ,d5.[jarjestys_ely] AS [jarjestys_kesis_ely]
      ,d6.[jarjestys] AS [jarjestys_perops_kunta]
      ,d6.[jarjestys_maakunta] AS [jarjestys_perops_maakunta]
      ,d6.[jarjestys_avi] AS [jarjestys_perops_avi]
      ,d6.[jarjestys_ely] AS [jarjestys_perops_ely]
      ,d7.[jarjestys] AS [jarjestys_apips_kunta]
      ,d7.[jarjestys_maakunta] AS [jarjestys_apips_maakunta]
      ,d7.[jarjestys_avi] AS [jarjestys_apips_avi]
      ,d7.[jarjestys_ely] AS [jarjestys_apips_ely]
  FROM [f_paivahoidon_yhteydessa_annettavan_esiopetuksen_aineisto] f
  INNER JOIN [d_oppilaitoksen_taustatiedot] d1 ON f.oppilaitoksen_taustatiedot_id = d1.id
  INNER JOIN [d_alueluokitus] d2 ON f.alueluokitus_id = d2.id
  INNER JOIN [d_opetuksen_jarjestajan_tiedoantajatyyppi] d3 ON f.tiedonantajatyyppi_id = d3.id
  INNER JOIN [d_alueluokitus] d4 ON f.pesis_alueluokitus_id = d4.id
  INNER JOIN [d_alueluokitus] d5 ON f.kesis_alueluokitus_id = d5.id
  INNER JOIN [d_alueluokitus] d6 ON f.perops_alueluokitus_id = d6.id
  INNER JOIN [d_alueluokitus] d7 ON f.apips_alueluokitus_id = d7.id




' 
GO
/****** Object:  View [dbo].[v_f_tab_perusopetuksen_erityisopetus]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_perusopetuksen_erityisopetus]'))
EXEC dbo.sp_executesql @statement = N'







CREATE VIEW [dbo].[v_f_tab_perusopetuksen_erityisopetus] AS
SELECT [Tilastovuosi]
      ,[Oppilaitos] = [Oppilaitos] + '' ('' + [Oppilaitoskoodi] + '')''
	  ,[Opetuksen järjestäjä]
	  ,[Oppilaitostyypi]
	  ,[Oppilaitoksen omistajatyyppi]
	  ,[Oppilaitoksen opetuskieli]
	  ,[Oppilaitoksen kunta]
	  ,[Oppilaitoksen maakunta]
      ,[Vuosiluokka]
	  ,[Erityisen tuen päätös]
	  ,[Opetuksen toteutuspaikka]
	  ,[Oppimäärän yksilöllistäminen]
	  ,[Pidennetty oppivelvollisuus]
	  ,[Joustava perusopetus]
	  ,[Kuljetusetuus]
	  ,[Majoitusetuus]
	  ,[Tehostettu tuki]
	  ,[Tukimuoto]
	  ,[Vieraskielisyys]
	  ,[Sukupuoli]
      ,[lkm]
	  ,[Faktataulu]

	  --ruotsi
	  ,[Statistikår]
      ,[Läroanstalt] = [Läroanstalt] + '' ('' + [Oppilaitoskoodi] + '')''
	  ,[Utbildningsanordnare]
	  ,[Läroanstaltstyp]
	  ,[Läroanstaltens ägartyp]
	  ,[Läroanstaltens undervisningsspråk]
	  ,[Läroanstaltens kommun] 
	  ,[Läroanstaltens landskap] 
      ,[Åldersklass] 
	  ,[Beslut om särskilt stöd]
	  ,[Undervisning plats]
	  ,[Individualiserad lärokurs]
	  ,[Förlängd läroplikt] 
	  ,[Flexibel grundläggande utbildning]
	  ,[Skolskjuts, förmån] 
	  ,[Inkvarteringsförmån] 
	  ,[Intensifierat stöd] 
	  ,[Form av stöd]
	  ,[Främmande modersmål] 
	  ,[Kön]

	  --englanti
	  ,[Statistical year] 
      ,[Educational institution] = [Educational institution] + '' ('' + [Oppilaitoskoodi] + '')''
	  ,[Education provider] 
	  ,[Type of institution] 
	  ,[Type of institution owner] 
	  ,[Language of the institution] 
	  ,[Municipality of the institution] 
	  ,[Region of the institution] 
      ,[Year class] 
	  ,[Resolution on special support] 
	  ,[Teaching location] 
	  ,[Individualization of curriculum] 
	  ,[Extended compulsory ed.] 
	  ,[Flexible basic education] 
	  ,[Transport benefit] 
	  ,[Accommodation benefit] 
	  ,[Intensified support] 
	  ,[Form of support] 
	  ,[Foreign language] 
	  ,[Gender]

	  ,[Oppilaitostyypi jarjestys]
	  ,[Oppilaitoksen omistajatyyppi jarjestys]
	  ,[Oppilaitoksen opetuskieli jarjestys]
	  ,[Oppilaitoksen kunta jarjestys]
	  ,[Oppilaitoksen maakunta jarjestys]
      ,[Vuosiluokka jarjestys]
	  ,[Erityisen tuen päätös jarjestys]
	  ,[Opetuksen toteutuspaikka jarjestys]
	  ,[Oppimäärän yksilöllistäminen jarjestys]
	  ,[Pidennetty oppivelvollisuus jarjestys]
	  ,[Joustava perusopetus jarjestys]
	  ,[Kuljetusetuus jarjestys]
	  ,[Majoitusetuus jarjestys]
	  ,[Tehostettu tuki jarjestys]
	  ,[Tukimuoto jarjestys]
	  ,[Vieraskielisyys jarjestys]
	  ,[Sukupuoli jarjestys]
FROM
(SELECT 
	   [Tilastovuosi] = f.tilv
      ,[Oppilaitos] = d1.oppilaitos, [Oppilaitoskoodi] = d1.oppilaitoskoodi
	  ,[Opetuksen järjestäjä] = d1.koulutuksen_jarjestaja
	  ,[Oppilaitostyypi] = d1.oppilaitostyyppi
	  ,[Oppilaitoksen omistajatyyppi] = d1.oppilaitoksen_omistajatyyppi
	  ,[Oppilaitoksen opetuskieli] = d1.opetuskieli
	  ,[Oppilaitoksen kunta] = d2.kunta
	  ,[Oppilaitoksen maakunta] = d2.maakunta
      ,[Vuosiluokka] = d3.luokkajako_16_79
	  ,[Erityisen tuen päätös] = d4.perusopetuksen_erityisen_tuen_paatos
	  ,[Opetuksen toteutuspaikka] = d5.perusopetuksen_yleisopetuksen_osuus
	  ,[Oppimäärän yksilöllistäminen] = null
	  ,[Pidennetty oppivelvollisuus] = null
	  ,[Joustava perusopetus] = null
	  ,[Kuljetusetuus] = null
	  ,[Majoitusetuus] = null
	  ,[Tehostettu tuki] = null
	  ,[Tukimuoto] = null
	  ,[Vieraskielisyys] = null
	  ,[Sukupuoli] = null
      ,[lkm] = f.erityisen_tuen_oppilaiden_opetus
	  ,[Faktataulu] = ''Opetuksen toteutuspaikka''

	  --ruotsi
	  ,[Statistikår] = f.tilv
      ,[Läroanstalt] = d1.oppilaitos_SV
	  ,[Utbildningsanordnare] = d1.koulutuksen_jarjestaja_SV
	  ,[Läroanstaltstyp] = d1.oppilaitostyyppi_SV
	  ,[Läroanstaltens ägartyp] = d1.oppilaitoksen_omistajatyyppi_SV
	  ,[Läroanstaltens undervisningsspråk] = d1.opetuskieli_SV
	  ,[Läroanstaltens kommun] = d2.kunta_SV
	  ,[Läroanstaltens landskap] = d2.maakunta_SV
      ,[Åldersklass] = d3.luokkajako_16_79_SV
	  ,[Beslut om särskilt stöd] = d4.perusopetuksen_erityisen_tuen_paatos_SV
	  ,[Undervisning plats] = d5.perusopetuksen_yleisopetuksen_osuus_SV
	  ,[Individualiserad lärokurs] = null
	  ,[Förlängd läroplikt] = null
	  ,[Flexibel grundläggande utbildning] = null
	  ,[Skolskjuts, förmån] = null
	  ,[Inkvarteringsförmån] = null
	  ,[Intensifierat stöd] = null
	  ,[Form av stöd] = null
	  ,[Främmande modersmål] = null
	  ,[Kön] = null

	  --englanti
	  ,[Statistical year] = f.tilv
      ,[Educational institution] = d1.oppilaitos_EN
	  ,[Education provider] = d1.koulutuksen_jarjestaja_EN
	  ,[Type of institution] = d1.oppilaitostyyppi_EN
	  ,[Type of institution owner] = d1.oppilaitoksen_omistajatyyppi_EN
	  ,[Language of the institution] = d1.opetuskieli_EN
	  ,[Municipality of the institution] = d2.kunta_EN
	  ,[Region of the institution] = d2.maakunta_EN
      ,[Year class] = d3.luokkajako_16_79_EN
	  ,[Resolution on special support] = d4.perusopetuksen_erityisen_tuen_paatos_EN
	  ,[Teaching location] = d5.perusopetuksen_yleisopetuksen_osuus_EN
	  ,[Individualization of curriculum] = null
	  ,[Extended compulsory ed.] = null
	  ,[Flexible basic education] = null
	  ,[Transport benefit] = null
	  ,[Accommodation benefit] = null
	  ,[Intensified support] = null
	  ,[Form of support] = null
	  ,[Foreign language] = null
	  ,[Gender] = null

	  ,[Oppilaitostyypi jarjestys] = d1.jarjestys_oppilaitostyyppi
	  ,[Oppilaitoksen omistajatyyppi jarjestys] = d1.jarjestys_omistajatyyppi
	  ,[Oppilaitoksen opetuskieli jarjestys] = d1.jarjestys_opetuskieli
	  ,[Oppilaitoksen kunta jarjestys] = d2.kunta
	  ,[Oppilaitoksen maakunta jarjestys] = d2.jarjestys_maakunta
      ,[Vuosiluokka jarjestys] = d3.luokkajako_16_79_jarjestys
	  ,[Erityisen tuen päätös jarjestys] = d4.jarjestys
	  ,[Opetuksen toteutuspaikka jarjestys] = d5.jarjestys
	  ,[Oppimäärän yksilöllistäminen jarjestys] = 99
	  ,[Pidennetty oppivelvollisuus jarjestys] = 99
	  ,[Joustava perusopetus jarjestys] = 99
	  ,[Kuljetusetuus jarjestys] = 99
	  ,[Majoitusetuus jarjestys] = 99
	  ,[Tehostettu tuki jarjestys] = 99
	  ,[Tukimuoto jarjestys] = 99
	  ,[Vieraskielisyys jarjestys] = 99
	  ,[Sukupuoli jarjestys] = 99
  FROM [VipunenTK].[dbo].[f_Perusasteen_erityisopetus_erityisen_tuen_oppilaiden_opetus] f
  LEFT JOIN dbo.d_oppilaitoksen_taustatiedot d1 on d1.id=f.oppilaitoksen_taustatiedot_id
  LEFT JOIN dbo.d_alueluokitus d2 on d2.id=f.oppilaitoksen_sijainti_id
  LEFT JOIN dbo.d_perusopetuksen_vuosiluokat d3 on d3.id=f.perusopetuksen_vuosiluokat_id
  LEFT JOIN dbo.d_perusopetuksen_erityisen_tuen_paatos d4 on d4.id=f.perusopetuksen_erityisen_tuen_paatos_id
  LEFT JOIN dbo.d_perusopetuksen_yleisopetuksen_osuus d5 on d5.id=f.perusopetuksen_yleisopetuksen_osuus_id

  UNION ALL

  SELECT 
	   [Tilastovuosi] = f.tilv
      ,[Oppilaitos] = d1.oppilaitos, [Oppilaitoskoodi] = d1.oppilaitoskoodi
	  ,[Opetuksen järjestäjä] = d1.koulutuksen_jarjestaja
	  ,[Oppilaitostyypi] = d1.oppilaitostyyppi
	  ,[Oppilaitoksen omistajatyyppi] = d1.oppilaitoksen_omistajatyyppi
	  ,[Oppilaitoksen opetuskieli] = d1.opetuskieli
	  ,[Oppilaitoksen kunta] = d2.kunta
	  ,[Oppilaitoksen maakunta] = d2.maakunta
      ,[Vuosiluokka] = d3.luokkajako_16_79
	  ,[Erityisen tuen päätös] = d4.perusopetuksen_erityisen_tuen_paatos
	  ,[Opetuksen toteutuspaikka] = null
	  ,[Oppimäärän yksilöllistäminen] = d6.perusopetuksen_oppimaaran_yksilollistaminen
	  ,[Pidennetty oppivelvollisuus] = null
	  ,[Joustava perusopetus] = null
	  ,[Kuljetusetuus] = null
	  ,[Majoitusetuus] = null
	  ,[Tehostettu tuki] = null
	  ,[Tukimuoto] = null
	  ,[Vieraskielisyys] = null
	  ,[Sukupuoli] = null
      ,[lkm] = f.erityisen_tuen_oppilaiden_oppimaara
	  ,[Osa] = ''Opetuksen yksilöllistäminen''

	  --ruotsi
	  ,[Statistikår] = f.tilv
      ,[Läroanstalt] = d1.oppilaitos_SV
	  ,[Utbildningsanordnare] = d1.koulutuksen_jarjestaja_SV
	  ,[Läroanstaltstyp] = d1.oppilaitostyyppi_SV
	  ,[Läroanstaltens ägartyp] = d1.oppilaitoksen_omistajatyyppi_SV
	  ,[Läroanstaltens undervisningsspråk] = d1.opetuskieli_SV
	  ,[Läroanstaltens kommun] = d2.kunta_SV
	  ,[Läroanstaltens landskap] = d2.maakunta_SV
      ,[Åldersklass] = d3.luokkajako_16_79_SV
	  ,[Beslut om särskilt stöd] = d4.perusopetuksen_erityisen_tuen_paatos_SV
	  ,[Undervisning plats] = null
	  ,[Individualiserad lärokurs] = d6.perusopetuksen_oppimaaran_yksilollistaminen_SV
	  ,[Förlängd läroplikt] = null
	  ,[Flexibel grundläggande utbildning] = null
	  ,[Skolskjuts, förmån] = null
	  ,[Inkvarteringsförmån] = null
	  ,[Intensifierat stöd] = null
	  ,[Form av stöd] = null
	  ,[Främmande modersmål] = null
	  ,[Kön] = null

	  --englanti
	  ,[Statistical year] = f.tilv
      ,[Educational institution] = d1.oppilaitos_EN
	  ,[Education provider] = d1.koulutuksen_jarjestaja_EN
	  ,[Type of institution] = d1.oppilaitostyyppi_EN
	  ,[Type of institution owner] = d1.oppilaitoksen_omistajatyyppi_EN
	  ,[Language of the institution] = d1.opetuskieli_EN
	  ,[Municipality of the institution] = d2.kunta_EN
	  ,[Region of the institution] = d2.maakunta_EN
      ,[Year class] = d3.luokkajako_16_79_EN
	  ,[Resolution on special support] = d4.perusopetuksen_erityisen_tuen_paatos_EN
	  ,[Teaching location] = null
	  ,[Individualization of curriculum] = d6.perusopetuksen_oppimaaran_yksilollistaminen_EN
	  ,[Extended compulsory ed.] = null
	  ,[Flexible basic education] = null
	  ,[Transport benefit] = null
	  ,[Accommodation benefit] = null
	  ,[Intensified support] = null
	  ,[Form of support] = null
	  ,[Foreign language] = null
	  ,[Gender] = null

	  ,[Oppilaitostyypi jarjestys] = d1.jarjestys_oppilaitostyyppi
	  ,[Oppilaitoksen omistajatyyppi jarjestys] = d1.jarjestys_omistajatyyppi
	  ,[Oppilaitoksen opetuskieli jarjestys] = d1.jarjestys_opetuskieli
	  ,[Oppilaitoksen kunta jarjestys] = d2.kunta
	  ,[Oppilaitoksen maakunta jarjestys] = d2.jarjestys_maakunta
      ,[Vuosiluokka jarjestys] = d3.luokkajako_16_79_jarjestys
	  ,[Erityisen tuen päätös jarjestys] = d4.jarjestys
	  ,[Opetuksen toteutuspaikka jarjestys] = 99
	  ,[Oppimäärän yksilöllistäminen jarjestys] = d6.jarjestys
	  ,[Pidennetty oppivelvollisuus jarjestys] = 99
	  ,[Joustava perusopetus jarjestys] = 99
	  ,[Kuljetusetuus jarjestys] = 99
	  ,[Majoitusetuus jarjestys] = 99
	  ,[Tehostettu tuki jarjestys] = 99
	  ,[Tukimuoto jarjestys] = 99
	  ,[Vieraskielisyys jarjestys] = 99
	  ,[Sukupuoli jarjestys] = 99
  FROM [VipunenTK].[dbo].[f_Perusasteen_erityisopetus_erityisen_tuen_oppilaiden_oppimaara] f
  LEFT JOIN dbo.d_oppilaitoksen_taustatiedot d1 on d1.id=f.oppilaitoksen_taustatiedot_id
  LEFT JOIN dbo.d_alueluokitus d2 on d2.id=f.oppilaitoksen_sijainti_id
  LEFT JOIN dbo.d_perusopetuksen_vuosiluokat d3 on d3.id=f.perusopetuksen_vuosiluokat_id
  LEFT JOIN dbo.d_perusopetuksen_erityisen_tuen_paatos d4 on d4.id=f.perusopetuksen_erityisen_tuen_paatos_id
  --LEFT JOIN dbo.d_perusopetuksen_yleisopetuksen_osuus d5 on d5.id=f.perusopetuksen_yleisopetuksen_osuus_id
  LEFT JOIN dbo.d_perusopetuksen_oppimaaran_yksilollistaminen d6 on d6.id=f.perusopetuksen_oppimaaran_yksilollistaminen_id

  UNION ALL

    SELECT 
	   [Tilastovuosi] = f.tilv
      ,[Oppilaitos] = d1.oppilaitos, [Oppilaitoskoodi] = d1.oppilaitoskoodi
	  ,[Opetuksen järjestäjä] = d1.koulutuksen_jarjestaja
	  ,[Oppilaitostyypi] = d1.oppilaitostyyppi
	  ,[Oppilaitoksen omistajatyyppi] = d1.oppilaitoksen_omistajatyyppi
	  ,[Oppilaitoksen opetuskieli] = d1.opetuskieli
	  ,[Oppilaitoksen kunta] = d2.kunta
	  ,[Oppilaitoksen maakunta] = d2.maakunta
      ,[Vuosiluokka] = d3.luokkajako_16_79
	  ,[Erityisen tuen päätös] = d4.perusopetuksen_erityisen_tuen_paatos
	  ,[Opetuksen toteutuspaikka] = null
	  ,[Oppimäärän yksilöllistäminen] = null
	  ,[Pidennetty oppivelvollisuus] = d7.perusopetuksen_pidennetty_oppivelvollisuus
	  ,[Joustava perusopetus] = d8.joustava_perusopetus
	  ,[Kuljetusetuus] = null
	  ,[Majoitusetuus] = null
	  ,[Tehostettu tuki] = null
	  ,[Tukimuoto] = null
	  ,[Vieraskielisyys] = null
	  ,[Sukupuoli] = case d11.sukupuoli when ''Mies'' then ''Pojat'' when ''Nainen'' then ''Tytöt'' else ''Tuntematon'' end
      ,[lkm] = f.jopo_oppilaat
	  ,[Osa] = ''Jopo''

	  --ruotsi
	  ,[Statistikår] = f.tilv
      ,[Läroanstalt] = d1.oppilaitos_SV
	  ,[Utbildningsanordnare] = d1.koulutuksen_jarjestaja_SV
	  ,[Läroanstaltstyp] = d1.oppilaitostyyppi_SV
	  ,[Läroanstaltens ägartyp] = d1.oppilaitoksen_omistajatyyppi_SV
	  ,[Läroanstaltens undervisningsspråk] = d1.opetuskieli_SV
	  ,[Läroanstaltens kommun] = d2.kunta_SV
	  ,[Läroanstaltens landskap] = d2.maakunta_SV
      ,[Åldersklass] = d3.luokkajako_16_79_SV
	  ,[Beslut om särskilt stöd] = d4.perusopetuksen_erityisen_tuen_paatos_SV
	  ,[Undervisning plats] = null
	  ,[Individualiserad lärokurs] = null
	  ,[Förlängd läroplikt] = d7.perusopetuksen_pidennetty_oppivelvollisuus_SV
	  ,[Flexibel grundläggande utbildning] = d8.joustava_perusopetus_SV
	  ,[Skolskjuts, förmån] = null
	  ,[Inkvarteringsförmån] = null
	  ,[Intensifierat stöd] = null
	  ,[Form av stöd] = null
	  ,[Främmande modersmål] = null
	  ,[Kön] = case d11.sukupuoli when ''Mies'' then ''Pojkar'' when ''Nainen'' then ''Flickor'' else ''Tuntematon'' end

	  --englanti
	  ,[Statistical year] = f.tilv
      ,[Educational institution] = d1.oppilaitos_EN
	  ,[Education provider] = d1.koulutuksen_jarjestaja_EN
	  ,[Type of institution] = d1.oppilaitostyyppi_EN
	  ,[Type of institution owner] = d1.oppilaitoksen_omistajatyyppi_EN
	  ,[Language of the institution] = d1.opetuskieli_EN
	  ,[Municipality of the institution] = d2.kunta_EN
	  ,[Region of the institution] = d2.maakunta_EN
      ,[Year class] = d3.luokkajako_16_79_EN
	  ,[Resolution on special support] = d4.perusopetuksen_erityisen_tuen_paatos_EN
	  ,[Teaching location] = null
	  ,[Individualization of curriculum] = null
	  ,[Extended compulsory ed.] = d7.perusopetuksen_pidennetty_oppivelvollisuus_EN
	  ,[Flexible basic education] = d8.joustava_perusopetus_EN
	  ,[Transport benefit] = null
	  ,[Accommodation benefit] = null
	  ,[Intensified support] = null
	  ,[Form of support] = null
	  ,[Foreign language] = null
	  ,[Gender] = case d11.sukupuoli when ''Mies'' then ''Boys'' when ''Nainen'' then ''Girls'' else ''Tuntematon'' end

	  ,[Oppilaitostyypi jarjestys] = d1.jarjestys_oppilaitostyyppi
	  ,[Oppilaitoksen omistajatyyppi jarjestys] = d1.jarjestys_omistajatyyppi
	  ,[Oppilaitoksen opetuskieli jarjestys] = d1.jarjestys_opetuskieli
	  ,[Oppilaitoksen kunta jarjestys] = d2.kunta
	  ,[Oppilaitoksen maakunta jarjestys] = d2.jarjestys_maakunta
      ,[Vuosiluokka jarjestys] = d3.luokkajako_16_79_jarjestys
	  ,[Erityisen tuen päätös jarjestys] = d4.jarjestys
	  ,[Opetuksen toteutuspaikka jarjestys] = 99
	  ,[Oppimäärän yksilöllistäminen jarjestys] = 99
	  ,[Pidennetty oppivelvollisuus jarjestys] = d7.jarjestys
	  ,[Joustava perusopetus jarjestys] = d8.jarjestys
	  ,[Kuljetusetuus jarjestys] = 99
	  ,[Majoitusetuus jarjestys] = 99
	  ,[Tehostettu tuki jarjestys] = 99
	  ,[Tukimuoto jarjestys] = 99
	  ,[Vieraskielisyys jarjestys] = 99
	  ,[Sukupuoli jarjestys] = d11.jarjestys
  FROM [VipunenTK].[dbo].[f_Perusasteen_erityisopetus_jopo_oppilaat] f
  LEFT JOIN dbo.d_oppilaitoksen_taustatiedot d1 on d1.id=f.oppilaitoksen_taustatiedot_id
  LEFT JOIN dbo.d_alueluokitus d2 on d2.id=f.oppilaitoksen_sijainti_id
  LEFT JOIN dbo.d_perusopetuksen_vuosiluokat d3 on d3.id=f.perusopetuksen_vuosiluokat_id
  LEFT JOIN dbo.d_perusopetuksen_erityisen_tuen_paatos d4 on d4.id=f.perusopetuksen_erityisen_tuen_paatos_id
  --LEFT JOIN dbo.d_perusopetuksen_yleisopetuksen_osuus d5 on d5.id=f.perusopetuksen_yleisopetuksen_osuus_id
  --LEFT JOIN dbo.d_perusopetuksen_oppimaaran_yksilollistaminen d6 on d6.id=f.perusopetuksen_oppimaaran_yksilollistaminen_id
  LEFT JOIN dbo.d_perusopetuksen_pidennetty_oppivelvollisuus d7 on d7.id=f.perusopetuksen_pidennetty_oppivelvollisuus_id
  LEFT JOIN dbo.d_joustava_perusopetus d8 on d8.id=f.joustava_perusopetus_id
  LEFT JOIN d_sukupuoli d11 on d11.id=f.sukupuoli_id
  where d2.kunta<>''Ulkomaat''
  
  UNION ALL

    SELECT 
	   [Tilastovuosi] = f.tilv
      ,[Oppilaitos] = d1.oppilaitos, [Oppilaitoskoodi] = d1.oppilaitoskoodi
	  ,[Opetuksen järjestäjä] = d1.koulutuksen_jarjestaja
	  ,[Oppilaitostyypi] = d1.oppilaitostyyppi
	  ,[Oppilaitoksen omistajatyyppi] = d1.oppilaitoksen_omistajatyyppi
	  ,[Oppilaitoksen opetuskieli] = d1.opetuskieli
	  ,[Oppilaitoksen kunta] = d2.kunta
	  ,[Oppilaitoksen maakunta] = d2.maakunta
      ,[Vuosiluokka] = d3.luokkajako_0_19_10
	  ,[Erityisen tuen päätös] = d4.perusopetuksen_erityisen_tuen_paatos
	  ,[Opetuksen toteutuspaikka] = null
	  ,[Oppimäärän yksilöllistäminen] = null
	  ,[Pidennetty oppivelvollisuus] = d7.perusopetuksen_pidennetty_oppivelvollisuus
	  ,[Joustava perusopetus] = null
	  ,[Kuljetusetuus] = d9.perusopetuksen_kuljetusetuus
	  ,[Majoitusetuus] = null
	  ,[Tehostettu tuki] = d10.perusopetuksen_tehostettu_tuki
	  ,[Tukimuoto] = null
	  ,[Vieraskielisyys] = null
	  ,[Sukupuoli] = null
      ,[lkm] = f.kuljetusetuutta_saavat_oppilaat
	  ,[Osa] = ''Kuljetusetuus''

	  --ruotsi
	  ,[Statistikår] = f.tilv
      ,[Läroanstalt] = d1.oppilaitos_SV
	  ,[Utbildningsanordnare] = d1.koulutuksen_jarjestaja_SV
	  ,[Läroanstaltstyp] = d1.oppilaitostyyppi_SV
	  ,[Läroanstaltens ägartyp] = d1.oppilaitoksen_omistajatyyppi_SV
	  ,[Läroanstaltens undervisningsspråk] = d1.opetuskieli_SV
	  ,[Läroanstaltens kommun] = d2.kunta_SV
	  ,[Läroanstaltens landskap] = d2.maakunta_SV
      ,[Åldersklass] = d3.luokkajako_0_19_10_SV
	  ,[Beslut om särskilt stöd] = d4.perusopetuksen_erityisen_tuen_paatos_SV
	  ,[Undervisning plats] = null
	  ,[Individualiserad lärokurs] = null
	  ,[Förlängd läroplikt] = d7.perusopetuksen_pidennetty_oppivelvollisuus_SV
	  ,[Flexibel grundläggande utbildning] = null
	  ,[Skolskjuts, förmån] = d9.perusopetuksen_kuljetusetuus_SV
	  ,[Inkvarteringsförmån] = null
	  ,[Intensifierat stöd] = d10.perusopetuksen_tehostettu_tuki_SV
	  ,[Form av stöd] = null
	  ,[Främmande modersmål] = null
	  ,[Kön] = null

	  --englanti
	  ,[Statistical year] = f.tilv
      ,[Educational institution] = d1.oppilaitos_EN
	  ,[Education provider] = d1.koulutuksen_jarjestaja_EN
	  ,[Type of institution] = d1.oppilaitostyyppi_EN
	  ,[Type of institution owner] = d1.oppilaitoksen_omistajatyyppi_EN
	  ,[Language of the institution] = d1.opetuskieli_EN
	  ,[Municipality of the institution] = d2.kunta_EN
	  ,[Region of the institution] = d2.maakunta_EN
      ,[Year class] = d3.luokkajako_0_19_10_EN
	  ,[Resolution on special support] = d4.perusopetuksen_erityisen_tuen_paatos_EN
	  ,[Teaching location] = null
	  ,[Individualization of curriculum] = null
	  ,[Extended compulsory ed.] = d7.perusopetuksen_pidennetty_oppivelvollisuus_EN
	  ,[Flexible basic education] = null
	  ,[Transport benefit] = d9.perusopetuksen_kuljetusetuus_EN
	  ,[Accommodation benefit] = null
	  ,[Intensified support] = d10.perusopetuksen_tehostettu_tuki_EN
	  ,[Form of support] = null
	  ,[Foreign language] = null
	  ,[Gender] = null

	  ,[Oppilaitostyypi jarjestys] = d1.jarjestys_oppilaitostyyppi
	  ,[Oppilaitoksen omistajatyyppi jarjestys] = d1.jarjestys_omistajatyyppi
	  ,[Oppilaitoksen opetuskieli jarjestys] = d1.jarjestys_opetuskieli
	  ,[Oppilaitoksen kunta jarjestys] = d2.kunta
	  ,[Oppilaitoksen maakunta jarjestys] = d2.jarjestys_maakunta
      ,[Vuosiluokka jarjestys] = d3.luokkajako_0_19_10_jarjestys
	  ,[Erityisen tuen päätös jarjestys] = d4.jarjestys
	  ,[Opetuksen toteutuspaikka jarjestys] = 99
	  ,[Oppimäärän yksilöllistäminen jarjestys] = 99
	  ,[Pidennetty oppivelvollisuus jarjestys] = d7.jarjestys
	  ,[Joustava perusopetus jarjestys] = 99
	  ,[Kuljetusetuus jarjestys] = d9.jarjestys
	  ,[Majoitusetuus jarjestys] = 99
	  ,[Tehostettu tuki jarjestys] = d10.jarjestys
	  ,[Tukimuoto jarjestys] = 99
	  ,[Vieraskielisyys jarjestys] = 99
	  ,[Sukupuoli jarjestys] = 99
  FROM [VipunenTK].[dbo].[f_Perusasteen_erityisopetus_kuljetusetuutta_saavien_oppilaiden_lkm] f
  LEFT JOIN dbo.d_oppilaitoksen_taustatiedot d1 on d1.id=f.oppilaitoksen_taustatiedot_id
  LEFT JOIN dbo.d_alueluokitus d2 on d2.id=f.oppilaitoksen_sijainti_id
  LEFT JOIN dbo.d_perusopetuksen_vuosiluokat d3 on d3.id=f.perusopetuksen_vuosiluokat_id
  LEFT JOIN dbo.d_perusopetuksen_erityisen_tuen_paatos d4 on d4.id=f.perusopetuksen_erityisen_tuen_paatos_id
  --LEFT JOIN dbo.d_perusopetuksen_yleisopetuksen_osuus d5 on d5.id=f.perusopetuksen_yleisopetuksen_osuus_id
  --LEFT JOIN dbo.d_perusopetuksen_oppimaaran_yksilollistaminen d6 on d6.id=f.perusopetuksen_oppimaaran_yksilollistaminen_id
  LEFT JOIN dbo.d_perusopetuksen_pidennetty_oppivelvollisuus d7 on d7.id=f.perusopetuksen_pidennetty_oppivelvollisuus_id
  --LEFT JOIN dbo.d_joustava_perusopetus d8 on d8.id=f.joustava_perusopetus_id
  LEFT JOIN dbo.d_perusopetuksen_kuljetusetuus d9 on d9.id=f.perusopetuksen_kuljetusetuus_id
  LEFT JOIN dbo.d_perusopetuksen_tehostettu_tuki d10 on d10.id=f.perusopetuksen_tehostettu_tuki_id
  where d2.kunta<>''Ulkomaat''
    
  UNION ALL

    SELECT 
	   [Tilastovuosi] = f.tilv
      ,[Oppilaitos] = d1.oppilaitos, [Oppilaitoskoodi] = d1.oppilaitoskoodi
	  ,[Opetuksen järjestäjä] = d1.koulutuksen_jarjestaja
	  ,[Oppilaitostyypi] = d1.oppilaitostyyppi
	  ,[Oppilaitoksen omistajatyyppi] = d1.oppilaitoksen_omistajatyyppi
	  ,[Oppilaitoksen opetuskieli] = d1.opetuskieli
	  ,[Oppilaitoksen kunta] = d2.kunta
	  ,[Oppilaitoksen maakunta] = d2.maakunta
      ,[Vuosiluokka] = d3.luokkajako_0_19_10
	  ,[Erityisen tuen päätös] = d4.perusopetuksen_erityisen_tuen_paatos
	  ,[Opetuksen toteutuspaikka] = null
	  ,[Oppimäärän yksilöllistäminen] = null
	  ,[Pidennetty oppivelvollisuus] = d7.perusopetuksen_pidennetty_oppivelvollisuus
	  ,[Joustava perusopetus] = null
	  ,[Kuljetusetuus] = null
	  ,[Majoitusetuus] = d9.perusopetuksen_majoitusetuus
	  ,[Tehostettu tuki] = d10.perusopetuksen_tehostettu_tuki
	  ,[Tukimuoto] = null
	  ,[Vieraskielisyys] = null
	  ,[Sukupuoli] = null
      ,[lkm] = f.majoitusetuutta_saavat_oppilaat
	  ,[Osa] = ''Majoitusetuus''

	  --ruotsi
	  ,[Statistikår] = f.tilv
      ,[Läroanstalt] = d1.oppilaitos_SV
	  ,[Utbildningsanordnare] = d1.koulutuksen_jarjestaja_SV
	  ,[Läroanstaltstyp] = d1.oppilaitostyyppi_SV
	  ,[Läroanstaltens ägartyp] = d1.oppilaitoksen_omistajatyyppi_SV
	  ,[Läroanstaltens undervisningsspråk] = d1.opetuskieli_SV
	  ,[Läroanstaltens kommun] = d2.kunta_SV
	  ,[Läroanstaltens landskap] = d2.maakunta_SV
      ,[Åldersklass] = d3.luokkajako_0_19_10_SV
	  ,[Beslut om särskilt stöd] = d4.perusopetuksen_erityisen_tuen_paatos_SV
	  ,[Undervisning plats] = null
	  ,[Individualiserad lärokurs] = null
	  ,[Förlängd läroplikt] = d7.perusopetuksen_pidennetty_oppivelvollisuus_SV
	  ,[Flexibel grundläggande utbildning] = null
	  ,[Skolskjuts, förmån] = null
	  ,[Inkvarteringsförmån] = d9.perusopetuksen_majoitusetuus_SV
	  ,[Intensifierat stöd] = d10.perusopetuksen_tehostettu_tuki_SV
	  ,[Form av stöd] = null
	  ,[Främmande modersmål] = null
	  ,[Kön] = null

	  --englanti
	  ,[Statistical year] = f.tilv
      ,[Educational institution] = d1.oppilaitos_EN
	  ,[Education provider] = d1.koulutuksen_jarjestaja_EN
	  ,[Type of institution] = d1.oppilaitostyyppi_EN
	  ,[Type of institution owner] = d1.oppilaitoksen_omistajatyyppi_EN
	  ,[Language of the institution] = d1.opetuskieli_EN
	  ,[Municipality of the institution] = d2.kunta_EN
	  ,[Region of the institution] = d2.maakunta_EN
      ,[Year class] = d3.luokkajako_0_19_10_EN
	  ,[Resolution on special support] = d4.perusopetuksen_erityisen_tuen_paatos_EN
	  ,[Teaching location] = null
	  ,[Individualization of curriculum] = null
	  ,[Extended compulsory ed.] = d7.perusopetuksen_pidennetty_oppivelvollisuus_EN
	  ,[Flexible basic education] = null
	  ,[Transport benefit] = null
	  ,[Accommodation benefit] = d9.perusopetuksen_majoitusetuus_EN
	  ,[Intensified support] = d10.perusopetuksen_tehostettu_tuki_EN
	  ,[Form of support] = null
	  ,[Foreign language] = null
	  ,[Gender] = null

	  ,[Oppilaitostyypi jarjestys] = d1.jarjestys_oppilaitostyyppi
	  ,[Oppilaitoksen omistajatyyppi jarjestys] = d1.jarjestys_omistajatyyppi
	  ,[Oppilaitoksen opetuskieli jarjestys] = d1.jarjestys_opetuskieli
	  ,[Oppilaitoksen kunta jarjestys] = d2.kunta
	  ,[Oppilaitoksen maakunta jarjestys] = d2.jarjestys_maakunta
      ,[Vuosiluokka jarjestys] = d3.luokkajako_0_19_10_jarjestys
	  ,[Erityisen tuen päätös jarjestys] = d4.jarjestys
	  ,[Opetuksen toteutuspaikka jarjestys] = 99
	  ,[Oppimäärän yksilöllistäminen jarjestys] = 99
	  ,[Pidennetty oppivelvollisuus jarjestys] = d7.jarjestys
	  ,[Joustava perusopetus jarjestys] = 99
	  ,[Kuljetusetuus jarjestys] = 99
	  ,[Majoitusetuus jarjestys] = d9.jarjestys
	  ,[Tehostettu tuki jarjestys] = d10.jarjestys
	  ,[Tukimuoto jarjestys] = 99
	  ,[Vieraskielisyys jarjestys] = 99
	  ,[Sukupuoli jarjestys] = 99
  FROM [VipunenTK].[dbo].[f_Perusasteen_erityisopetus_majoitusetuutta_saavien_oppilaiden_lkm] f
  LEFT JOIN dbo.d_oppilaitoksen_taustatiedot d1 on d1.id=f.oppilaitoksen_taustatiedot_id
  LEFT JOIN dbo.d_alueluokitus d2 on d2.id=f.oppilaitoksen_sijainti_id
  LEFT JOIN dbo.d_perusopetuksen_vuosiluokat d3 on d3.id=f.perusopetuksen_vuosiluokat_id
  LEFT JOIN dbo.d_perusopetuksen_erityisen_tuen_paatos d4 on d4.id=f.perusopetuksen_erityisen_tuen_paatos_id
  --LEFT JOIN dbo.d_perusopetuksen_yleisopetuksen_osuus d5 on d5.id=f.perusopetuksen_yleisopetuksen_osuus_id
  --LEFT JOIN dbo.d_perusopetuksen_oppimaaran_yksilollistaminen d6 on d6.id=f.perusopetuksen_oppimaaran_yksilollistaminen_id
  LEFT JOIN dbo.d_perusopetuksen_pidennetty_oppivelvollisuus d7 on d7.id=f.perusopetuksen_pidennetty_oppivelvollisuus_id
  --LEFT JOIN dbo.d_joustava_perusopetus d8 on d8.id=f.joustava_perusopetus_id
  LEFT JOIN dbo.d_perusopetuksen_majoitusetuus d9 on d9.id=f.perusopetuksen_majoitusetuus_id
  LEFT JOIN dbo.d_perusopetuksen_tehostettu_tuki d10 on d10.id=f.perusopetuksen_tehostettu_tuki_id
  where d2.kunta<>''Ulkomaat''

  UNION ALL

    SELECT 
	   [Tilastovuosi] = f.tilv
      ,[Oppilaitos] = d1.oppilaitos, [Oppilaitoskoodi] = d1.oppilaitoskoodi
	  ,[Opetuksen järjestäjä] = d1.koulutuksen_jarjestaja
	  ,[Oppilaitostyypi] = d1.oppilaitostyyppi
	  ,[Oppilaitoksen omistajatyyppi] = d1.oppilaitoksen_omistajatyyppi
	  ,[Oppilaitoksen opetuskieli] = d1.opetuskieli
	  ,[Oppilaitoksen kunta] = d2.kunta
	  ,[Oppilaitoksen maakunta] = d2.maakunta
      ,[Vuosiluokka] = d3.luokkajako_0_19_10
	  ,[Erityisen tuen päätös] = null
	  ,[Opetuksen toteutuspaikka] = null
	  ,[Oppimäärän yksilöllistäminen] = null
	  ,[Pidennetty oppivelvollisuus] = null
	  ,[Joustava perusopetus] = null
	  ,[Kuljetusetuus] = null
	  ,[Majoitusetuus] = null
	  ,[Tehostettu tuki] = null
	  ,[Tukimuoto] = null
	  ,[Vieraskielisyys] = null
	  ,[Sukupuoli] = case d11.sukupuoli when ''Mies'' then ''Pojat'' when ''Nainen'' then ''Tytöt'' else ''Tuntematon'' end
      ,[lkm] = f.oppilaiden_lkm
	  ,[Osa] = ''Oppilaat''

	  --ruotsi
	  ,[Statistikår] = f.tilv
      ,[Läroanstalt] = d1.oppilaitos_SV
	  ,[Utbildningsanordnare] = d1.koulutuksen_jarjestaja_SV
	  ,[Läroanstaltstyp] = d1.oppilaitostyyppi_SV
	  ,[Läroanstaltens ägartyp] = d1.oppilaitoksen_omistajatyyppi_SV
	  ,[Läroanstaltens undervisningsspråk] = d1.opetuskieli_SV
	  ,[Läroanstaltens kommun] = d2.kunta_SV
	  ,[Läroanstaltens landskap] = d2.maakunta_SV
      ,[Åldersklass] = d3.luokkajako_0_19_10_SV
	  ,[Beslut om särskilt stöd] = null
	  ,[Undervisning plats] = null
	  ,[Individualiserad lärokurs] = null
	  ,[Förlängd läroplikt] = null
	  ,[Flexibel grundläggande utbildning] = null
	  ,[Skolskjuts, förmån] = null
	  ,[Inkvarteringsförmån] = null
	  ,[Intensifierat stöd] = null
	  ,[Form av stöd] = null
	  ,[Främmande modersmål] = null
	  ,[Kön] = case d11.sukupuoli when ''Mies'' then ''Pojkar'' when ''Nainen'' then ''Flickor'' else ''Tuntematon'' end

	  --englanti
	  ,[Statistical year] = f.tilv
      ,[Educational institution] = d1.oppilaitos_EN
	  ,[Education provider] = d1.koulutuksen_jarjestaja_EN
	  ,[Type of institution] = d1.oppilaitostyyppi_EN
	  ,[Type of institution owner] = d1.oppilaitoksen_omistajatyyppi_EN
	  ,[Language of the institution] = d1.opetuskieli_EN
	  ,[Municipality of the institution] = d2.kunta_EN
	  ,[Region of the institution] = d2.maakunta_EN
      ,[Year class] = d3.luokkajako_0_19_10_EN
	  ,[Resolution on special support] = null
	  ,[Teaching location] = null
	  ,[Individualization of curriculum] = null
	  ,[Extended compulsory ed.] = null
	  ,[Flexible basic education] = null
	  ,[Transport benefit] = null
	  ,[Accommodation benefit] = null
	  ,[Intensified support] = null
	  ,[Form of support] = null
	  ,[Foreign language] = null
	  ,[Gender] = case d11.sukupuoli when ''Mies'' then ''Boys'' when ''Nainen'' then ''Girls'' else ''Tuntematon'' end

	  ,[Oppilaitostyypi jarjestys] = d1.jarjestys_oppilaitostyyppi
	  ,[Oppilaitoksen omistajatyyppi jarjestys] = d1.jarjestys_omistajatyyppi
	  ,[Oppilaitoksen opetuskieli jarjestys] = d1.jarjestys_opetuskieli
	  ,[Oppilaitoksen kunta jarjestys] = d2.kunta
	  ,[Oppilaitoksen maakunta jarjestys] = d2.jarjestys_maakunta
      ,[Vuosiluokka jarjestys] = d3.luokkajako_0_19_10_jarjestys
	  ,[Erityisen tuen päätös jarjestys] = 99
	  ,[Opetuksen toteutuspaikka jarjestys] = 99
	  ,[Oppimäärän yksilöllistäminen jarjestys] = 99
	  ,[Pidennetty oppivelvollisuus jarjestys] = 99
	  ,[Joustava perusopetus jarjestys] = 99
	  ,[Kuljetusetuus jarjestys] = 99
	  ,[Majoitusetuus jarjestys] = 99
	  ,[Tehostettu tuki jarjestys] = 99
	  ,[Tukimuoto jarjestys] = 99
	  ,[Vieraskielisyys jarjestys] = 99
	  ,[Sukupuoli jarjestys] = d11.jarjestys
  FROM [VipunenTK].[dbo].[f_Perusasteen_erityisopetus_oppilaiden_lkm] f
  LEFT JOIN dbo.d_oppilaitoksen_taustatiedot d1 on d1.id=f.oppilaitoksen_taustatiedot_id
  LEFT JOIN dbo.d_alueluokitus d2 on d2.id=f.oppilaitoksen_sijainti_id
  LEFT JOIN dbo.d_perusopetuksen_vuosiluokat d3 on d3.id=f.perusopetuksen_vuosiluokat_id
  --LEFT JOIN dbo.d_perusopetuksen_erityisen_tuen_paatos d4 on d4.id=f.perusopetuksen_erityisen_tuen_paatos_id
  --LEFT JOIN dbo.d_perusopetuksen_yleisopetuksen_osuus d5 on d5.id=f.perusopetuksen_yleisopetuksen_osuus_id
  --LEFT JOIN dbo.d_perusopetuksen_oppimaaran_yksilollistaminen d6 on d6.id=f.perusopetuksen_oppimaaran_yksilollistaminen_id
  --LEFT JOIN dbo.d_perusopetuksen_oppimaaran_yksilollistaminen d7 on d7.id=f.perusopetuksen_pidennetty_oppivelvollisuus_id
  --LEFT JOIN dbo.d_joustava_perusopetus d8 on d8.id=f.joustava_perusopetus_id
  --LEFT JOIN dbo.d_perusopetuksen_majoitusetuus d9 on d9.id=f.perusopetuksen_majoitusetuus_id
  --LEFT JOIN dbo.d_perusopetuksen_tehostettu_tuki d10 on d10.id=f.perusopetuksen_tehostettu_tuki_id
  LEFT JOIN d_sukupuoli d11 on d11.id=f.sukupuoli_id
  
  UNION ALL

    SELECT 
	   [Tilastovuosi] = f.tilv
      ,[Oppilaitos] = d1.oppilaitos, [Oppilaitoskoodi] = d1.oppilaitoskoodi
	  ,[Opetuksen järjestäjä] = d1.koulutuksen_jarjestaja
	  ,[Oppilaitostyypi] = d1.oppilaitostyyppi
	  ,[Oppilaitoksen omistajatyyppi] = d1.oppilaitoksen_omistajatyyppi
	  ,[Oppilaitoksen opetuskieli] = d1.opetuskieli
	  ,[Oppilaitoksen kunta] = d2.kunta
	  ,[Oppilaitoksen maakunta] = d2.maakunta
      ,[Vuosiluokka] = d3.vuosiluokka
	  ,[Erityisen tuen päätös] = d4.perusopetuksen_erityisen_tuen_paatos
	  ,[Opetuksen toteutuspaikka] = null
	  ,[Oppimäärän yksilöllistäminen] = null
	  ,[Pidennetty oppivelvollisuus] = d7.perusopetuksen_pidennetty_oppivelvollisuus
	  ,[Joustava perusopetus] = null
	  ,[Kuljetusetuus] = null
	  ,[Majoitusetuus] = null
	  ,[Tehostettu tuki] = d10.perusopetuksen_tehostettu_tuki
	  ,[Tukimuoto] = null
	  ,[Vieraskielisyys] = null
	  ,[Sukupuoli] = case d11.sukupuoli when ''Mies'' then ''Pojat'' when ''Nainen'' then ''Tytöt'' else ''Tuntematon'' end
      ,[lkm] = f.tehostetun_tuen_oppilaat
	  ,[Osa] = ''Tehostettu tuki''

	  --ruotsi
	  ,[Statistikår] = f.tilv
      ,[Läroanstalt] = d1.oppilaitos_SV
	  ,[Utbildningsanordnare] = d1.koulutuksen_jarjestaja_SV
	  ,[Läroanstaltstyp] = d1.oppilaitostyyppi_SV
	  ,[Läroanstaltens ägartyp] = d1.oppilaitoksen_omistajatyyppi_SV
	  ,[Läroanstaltens undervisningsspråk] = d1.opetuskieli_SV
	  ,[Läroanstaltens kommun] = d2.kunta_SV
	  ,[Läroanstaltens landskap] = d2.maakunta_SV
      ,[Åldersklass] = d3.vuosiluokka_SV
	  ,[Beslut om särskilt stöd] = d4.perusopetuksen_erityisen_tuen_paatos_SV
	  ,[Undervisning plats] = null
	  ,[Individualiserad lärokurs] = null
	  ,[Förlängd läroplikt] = d7.perusopetuksen_pidennetty_oppivelvollisuus_SV
	  ,[Flexibel grundläggande utbildning] = null
	  ,[Skolskjuts, förmån] = null
	  ,[Inkvarteringsförmån] = null
	  ,[Intensifierat stöd] = d10.perusopetuksen_tehostettu_tuki_SV
	  ,[Form av stöd] = null
	  ,[Främmande modersmål] = null
	  ,[Kön] = case d11.sukupuoli when ''Mies'' then ''Pojkar'' when ''Nainen'' then ''Flickor'' else ''Tuntematon'' end

	  --englanti
	  ,[Statistical year] = f.tilv
      ,[Educational institution] = d1.oppilaitos_EN
	  ,[Education provider] = d1.koulutuksen_jarjestaja_EN
	  ,[Type of institution] = d1.oppilaitostyyppi_EN
	  ,[Type of institution owner] = d1.oppilaitoksen_omistajatyyppi_EN
	  ,[Language of the institution] = d1.opetuskieli_EN
	  ,[Municipality of the institution] = d2.kunta_EN
	  ,[Region of the institution] = d2.maakunta_EN
      ,[Year class] = d3.vuosiluokka_EN
	  ,[Resolution on special support] = d4.perusopetuksen_erityisen_tuen_paatos_EN
	  ,[Teaching location] = null
	  ,[Individualization of curriculum] = null
	  ,[Extended compulsory ed.] = d7.perusopetuksen_pidennetty_oppivelvollisuus_EN
	  ,[Flexible basic education] = null
	  ,[Transport benefit] = null
	  ,[Accommodation benefit] = null
	  ,[Intensified support] = d10.perusopetuksen_tehostettu_tuki_EN
	  ,[Form of support] = null
	  ,[Foreign language] = null
	  ,[Gender] = case d11.sukupuoli when ''Mies'' then ''Boys'' when ''Nainen'' then ''Girls'' else ''Tuntematon'' end

	  ,[Oppilaitostyypi jarjestys] = d1.jarjestys_oppilaitostyyppi
	  ,[Oppilaitoksen omistajatyyppi jarjestys] = d1.jarjestys_omistajatyyppi
	  ,[Oppilaitoksen opetuskieli jarjestys] = d1.jarjestys_opetuskieli
	  ,[Oppilaitoksen kunta jarjestys] = d2.kunta
	  ,[Oppilaitoksen maakunta jarjestys] = d2.jarjestys_maakunta
      ,[Vuosiluokka jarjestys] = d3.jarjestys
	  ,[Erityisen tuen päätös jarjestys] = d4.jarjestys
	  ,[Opetuksen toteutuspaikka jarjestys] = 99
	  ,[Oppimäärän yksilöllistäminen jarjestys] = 99
	  ,[Pidennetty oppivelvollisuus jarjestys] = d7.jarjestys
	  ,[Joustava perusopetus jarjestys] = 99
	  ,[Kuljetusetuus jarjestys] = 99
	  ,[Majoitusetuus jarjestys] = 99
	  ,[Tehostettu tuki jarjestys] = d10.jarjestys
	  ,[Tukimuoto jarjestys] = 99
	  ,[Vieraskielisyys jarjestys] = 99
	  ,[Sukupuoli jarjestys] = d11.jarjestys
  FROM [VipunenTK].[dbo].[f_Perusasteen_erityisopetus_tehostetun_tuen_oppilaiden_lkm] f
  LEFT JOIN dbo.d_oppilaitoksen_taustatiedot d1 on d1.id=f.oppilaitoksen_taustatiedot_id
  LEFT JOIN dbo.d_alueluokitus d2 on d2.id=f.oppilaitoksen_sijainti_id
  LEFT JOIN dbo.d_perusopetuksen_vuosiluokat d3 on d3.id=f.perusopetuksen_vuosiluokat_id
  LEFT JOIN dbo.d_perusopetuksen_erityisen_tuen_paatos d4 on d4.id=f.perusopetuksen_erityisen_tuen_paatos_id
  --LEFT JOIN dbo.d_perusopetuksen_yleisopetuksen_osuus d5 on d5.id=f.perusopetuksen_yleisopetuksen_osuus_id
  --LEFT JOIN dbo.d_perusopetuksen_oppimaaran_yksilollistaminen d6 on d6.id=f.perusopetuksen_oppimaaran_yksilollistaminen_id
  LEFT JOIN dbo.d_perusopetuksen_pidennetty_oppivelvollisuus d7 on d7.id=f.perusopetuksen_pidennetty_oppivelvollisuus_id
  --LEFT JOIN dbo.d_joustava_perusopetus d8 on d8.id=f.joustava_perusopetus_id
  --LEFT JOIN dbo.d_perusopetuksen_majoitusetuus d9 on d9.id=f.perusopetuksen_majoitusetuus_id
  LEFT JOIN dbo.d_perusopetuksen_tehostettu_tuki d10 on d10.id=f.perusopetuksen_tehostettu_tuki_id
  LEFT JOIN d_sukupuoli d11 on d11.id=f.sukupuoli_id
  where f.tehostetun_tuen_oppilaat<>0 and f.tehostetun_tuen_oppilaat is not null
   
  UNION ALL

    SELECT 
	   [Tilastovuosi] = f.tilv
      ,[Oppilaitos] = d1.oppilaitos, [Oppilaitoskoodi] = d1.oppilaitoskoodi
	  ,[Opetuksen järjestäjä] = d1.koulutuksen_jarjestaja
	  ,[Oppilaitostyypi] = d1.oppilaitostyyppi
	  ,[Oppilaitoksen omistajatyyppi] = d1.oppilaitoksen_omistajatyyppi
	  ,[Oppilaitoksen opetuskieli] = d1.opetuskieli
	  ,[Oppilaitoksen kunta] = d2.kunta
	  ,[Oppilaitoksen maakunta] = d2.maakunta
      ,[Vuosiluokka] = null
	  ,[Erityisen tuen päätös] = d4.perusopetuksen_erityisen_tuen_paatos
	  ,[Opetuksen toteutuspaikka] = null
	  ,[Oppimäärän yksilöllistäminen] = null
	  ,[Pidennetty oppivelvollisuus] = null
	  ,[Joustava perusopetus] = null
	  ,[Kuljetusetuus] = null
	  ,[Majoitusetuus] = null
	  ,[Tehostettu tuki] = d10.perusopetuksen_tehostettu_tuki
	  ,[Tukimuoto] = d12.perusopetuksen_tukimuoto
	  ,[Vieraskielisyys] = null
	  ,[Sukupuoli] = null
      ,[lkm] = f.tukea_saavat_oppilaat
	  ,[Osa] = ''Tukea saavat''

	  --ruotsi
	  ,[Statistikår] = f.tilv
      ,[Läroanstalt] = d1.oppilaitos_SV
	  ,[Utbildningsanordnare] = d1.koulutuksen_jarjestaja_SV
	  ,[Läroanstaltstyp] = d1.oppilaitostyyppi_SV
	  ,[Läroanstaltens ägartyp] = d1.oppilaitoksen_omistajatyyppi_SV
	  ,[Läroanstaltens undervisningsspråk] = d1.opetuskieli_SV
	  ,[Läroanstaltens kommun] = d2.kunta_SV
	  ,[Läroanstaltens landskap] = d2.maakunta_SV
      ,[Åldersklass] = null
	  ,[Beslut om särskilt stöd] = d4.perusopetuksen_erityisen_tuen_paatos_SV
	  ,[Undervisning plats] = null
	  ,[Individualiserad lärokurs] = null
	  ,[Förlängd läroplikt] = null
	  ,[Flexibel grundläggande utbildning] = null
	  ,[Skolskjuts, förmån] = null
	  ,[Inkvarteringsförmån] = null
	  ,[Intensifierat stöd] = d10.perusopetuksen_tehostettu_tuki_SV
	  ,[Form av stöd] = d12.perusopetuksen_tukimuoto_SV
	  ,[Främmande modersmål] = null
	  ,[Kön] = null

	  --englanti
	  ,[Statistical year] = f.tilv
      ,[Educational institution] = d1.oppilaitos_EN
	  ,[Education provider] = d1.koulutuksen_jarjestaja_EN
	  ,[Type of institution] = d1.oppilaitostyyppi_EN
	  ,[Type of institution owner] = d1.oppilaitoksen_omistajatyyppi_EN
	  ,[Language of the institution] = d1.opetuskieli_EN
	  ,[Municipality of the institution] = d2.kunta_EN
	  ,[Region of the institution] = d2.maakunta_EN
      ,[Year class] = null
	  ,[Resolution on special support] = d4.perusopetuksen_erityisen_tuen_paatos_EN
	  ,[Teaching location] = null
	  ,[Individualization of curriculum] = null
	  ,[Extended compulsory ed.] = null
	  ,[Flexible basic education] = null
	  ,[Transport benefit] = null
	  ,[Accommodation benefit] = null
	  ,[Intensified support] = d10.perusopetuksen_tehostettu_tuki_EN
	  ,[Form of support] = d12.perusopetuksen_tukimuoto_EN
	  ,[Foreign language] = null
	  ,[Gender] = null

	  ,[Oppilaitostyypi jarjestys] = d1.jarjestys_oppilaitostyyppi
	  ,[Oppilaitoksen omistajatyyppi jarjestys] = d1.jarjestys_omistajatyyppi
	  ,[Oppilaitoksen opetuskieli jarjestys] = d1.jarjestys_opetuskieli
	  ,[Oppilaitoksen kunta jarjestys] = d2.kunta
	  ,[Oppilaitoksen maakunta jarjestys] = d2.jarjestys_maakunta
      ,[Vuosiluokka jarjestys] = 99
	  ,[Erityisen tuen päätös jarjestys] = d4.jarjestys
	  ,[Opetuksen toteutuspaikka jarjestys] = 99
	  ,[Oppimäärän yksilöllistäminen jarjestys] = 99
	  ,[Pidennetty oppivelvollisuus jarjestys] = 99
	  ,[Joustava perusopetus jarjestys] = 99
	  ,[Kuljetusetuus jarjestys] = 99
	  ,[Majoitusetuus jarjestys] = 99
	  ,[Tehostettu tuki jarjestys] = d10.jarjestys
	  ,[Tukimuoto jarjestys] = d12.jarjestys
	  ,[Vieraskielisyys jarjestys] = 99
	  ,[Sukupuoli jarjestys] = 99
  FROM [VipunenTK].[dbo].[f_Perusasteen_erityisopetus_tukea_saavien_oppilaiden_lkm] f
  LEFT JOIN dbo.d_oppilaitoksen_taustatiedot d1 on d1.id=f.oppilaitoksen_taustatiedot_id
  LEFT JOIN dbo.d_alueluokitus d2 on d2.id=f.oppilaitoksen_sijainti_id
  --LEFT JOIN dbo.d_perusopetuksen_vuosiluokat d3 on d3.id=f.perusopetuksen_vuosiluokat_id
  LEFT JOIN dbo.d_perusopetuksen_erityisen_tuen_paatos d4 on d4.id=f.perusopetuksen_erityisen_tuen_paatos_id
  --LEFT JOIN dbo.d_perusopetuksen_yleisopetuksen_osuus d5 on d5.id=f.perusopetuksen_yleisopetuksen_osuus_id
  --LEFT JOIN dbo.d_perusopetuksen_oppimaaran_yksilollistaminen d6 on d6.id=f.perusopetuksen_oppimaaran_yksilollistaminen_id
  --LEFT JOIN dbo.d_perusopetuksen_pidennetty_oppivelvollisuus d7 on d7.id=f.perusopetuksen_pidennetty_oppivelvollisuus_id
  --LEFT JOIN dbo.d_joustava_perusopetus d8 on d8.id=f.joustava_perusopetus_id
  --LEFT JOIN dbo.d_perusopetuksen_majoitusetuus d9 on d9.id=f.perusopetuksen_majoitusetuus_id
  LEFT JOIN dbo.d_perusopetuksen_tehostettu_tuki d10 on d10.id=f.perusopetuksen_tehostettu_tuki_id
  --LEFT JOIN d_sukupuoli d11 on d11.id=f.sukupuoli_id
  LEFT JOIN d_perusopetuksen_tukimuoto d12 on d12.id=f.perusopetuksen_tukimuoto_id
    
  UNION ALL

    SELECT 
	   [Tilastovuosi] = f.tilv
      ,[Oppilaitos] = d1.oppilaitos, [Oppilaitoskoodi] = d1.oppilaitoskoodi
	  ,[Opetuksen järjestäjä] = d1.koulutuksen_jarjestaja
	  ,[Oppilaitostyypi] = d1.oppilaitostyyppi
	  ,[Oppilaitoksen omistajatyyppi] = d1.oppilaitoksen_omistajatyyppi
	  ,[Oppilaitoksen opetuskieli] = d1.opetuskieli
	  ,[Oppilaitoksen kunta] = d2.kunta
	  ,[Oppilaitoksen maakunta] = d2.maakunta
      ,[Vuosiluokka] = d3.luokkajako_0_19_10
	  ,[Erityisen tuen päätös] = d4.perusopetuksen_erityisen_tuen_paatos
	  ,[Opetuksen toteutuspaikka] = null
	  ,[Oppimäärän yksilöllistäminen] = null
	  ,[Pidennetty oppivelvollisuus] = d7.perusopetuksen_pidennetty_oppivelvollisuus
	  ,[Joustava perusopetus] = null
	  ,[Kuljetusetuus] = null
	  ,[Majoitusetuus] = null
	  ,[Tehostettu tuki] = d10.perusopetuksen_tehostettu_tuki
	  ,[Tukimuoto] = null
	  ,[Vieraskielisyys] = d13.vieraskielisyys
	  ,[Sukupuoli] = null
      ,[lkm] = f.vieraskieliset_tehostetun_tuen_oppilaat
	  ,[Osa] = ''Vieraskieliset''

	  --ruotsi
	  ,[Statistikår] = f.tilv
      ,[Läroanstalt] = d1.oppilaitos_SV
	  ,[Utbildningsanordnare] = d1.koulutuksen_jarjestaja_SV
	  ,[Läroanstaltstyp] = d1.oppilaitostyyppi_SV
	  ,[Läroanstaltens ägartyp] = d1.oppilaitoksen_omistajatyyppi_SV
	  ,[Läroanstaltens undervisningsspråk] = d1.opetuskieli_SV
	  ,[Läroanstaltens kommun] = d2.kunta_SV
	  ,[Läroanstaltens landskap] = d2.maakunta_SV
      ,[Åldersklass] = d3.luokkajako_0_19_10_SV
	  ,[Beslut om särskilt stöd] = d4.perusopetuksen_erityisen_tuen_paatos_SV
	  ,[Undervisning plats] = null
	  ,[Individualiserad lärokurs] = null
	  ,[Förlängd läroplikt] = d7.perusopetuksen_pidennetty_oppivelvollisuus_SV
	  ,[Flexibel grundläggande utbildning] = null
	  ,[Skolskjuts, förmån] = null
	  ,[Inkvarteringsförmån] = null
	  ,[Intensifierat stöd] = d10.perusopetuksen_tehostettu_tuki_SV
	  ,[Form av stöd] = null
	  ,[Främmande modersmål] = d13.vieraskielisyys_SV
	  ,[Kön] = null

	  --englanti
	  ,[Statistical year] = f.tilv
      ,[Educational institution] = d1.oppilaitos_EN
	  ,[Education provider] = d1.koulutuksen_jarjestaja_EN
	  ,[Type of institution] = d1.oppilaitostyyppi_EN
	  ,[Type of institution owner] = d1.oppilaitoksen_omistajatyyppi_EN
	  ,[Language of the institution] = d1.opetuskieli_EN
	  ,[Municipality of the institution] = d2.kunta_EN
	  ,[Region of the institution] = d2.maakunta_EN
      ,[Year class] = d3.luokkajako_0_19_10_EN
	  ,[Resolution on special support] = d4.perusopetuksen_erityisen_tuen_paatos_EN
	  ,[Teaching location] = null
	  ,[Individualization of curriculum] = null
	  ,[Extended compulsory ed.] = d7.perusopetuksen_pidennetty_oppivelvollisuus_EN
	  ,[Flexible basic education] = null
	  ,[Transport benefit] = null
	  ,[Accommodation benefit] = null
	  ,[Intensified support] = d10.perusopetuksen_tehostettu_tuki_EN
	  ,[Form of support] = null
	  ,[Foreign language] = d13.vieraskielisyys_EN
	  ,[Gender] = null

	  ,[Oppilaitostyypi jarjestys] = d1.jarjestys_oppilaitostyyppi
	  ,[Oppilaitoksen omistajatyyppi jarjestys] = d1.jarjestys_omistajatyyppi
	  ,[Oppilaitoksen opetuskieli jarjestys] = d1.jarjestys_opetuskieli
	  ,[Oppilaitoksen kunta jarjestys] = d2.kunta
	  ,[Oppilaitoksen maakunta jarjestys] = d2.jarjestys_maakunta
      ,[Vuosiluokka jarjestys] = d3.luokkajako_0_19_10_jarjestys
	  ,[Erityisen tuen päätös jarjestys] = d4.jarjestys
	  ,[Opetuksen toteutuspaikka jarjestys] = 99
	  ,[Oppimäärän yksilöllistäminen jarjestys] = 99
	  ,[Pidennetty oppivelvollisuus jarjestys] = d7.jarjestys
	  ,[Joustava perusopetus jarjestys] = 99
	  ,[Kuljetusetuus jarjestys] = 99
	  ,[Majoitusetuus jarjestys] = 99
	  ,[Tehostettu tuki jarjestys] = d10.jarjestys
	  ,[Tukimuoto jarjestys] = 99
	  ,[Vieraskielisyys jarjestys] = d13.jarjestys
	  ,[Sukupuoli jarjestys] = 99
  FROM [VipunenTK].[dbo].[f_Perusasteen_erityisopetus_vieraskielisten_tehostetun_tuen_oppilaiden_lkm] f
  LEFT JOIN dbo.d_oppilaitoksen_taustatiedot d1 on d1.id=f.oppilaitoksen_taustatiedot_id
  LEFT JOIN dbo.d_alueluokitus d2 on d2.id=f.oppilaitoksen_sijainti_id
  LEFT JOIN dbo.d_perusopetuksen_vuosiluokat d3 on d3.id=f.perusopetuksen_vuosiluokat_id
  LEFT JOIN dbo.d_perusopetuksen_erityisen_tuen_paatos d4 on d4.id=f.perusopetuksen_erityisen_tuen_paatos_id
  --LEFT JOIN dbo.d_perusopetuksen_yleisopetuksen_osuus d5 on d5.id=f.perusopetuksen_yleisopetuksen_osuus_id
  --LEFT JOIN dbo.d_perusopetuksen_oppimaaran_yksilollistaminen d6 on d6.id=f.perusopetuksen_oppimaaran_yksilollistaminen_id
  LEFT JOIN dbo.d_perusopetuksen_pidennetty_oppivelvollisuus d7 on d7.id=f.perusopetuksen_pidennetty_oppivelvollisuus_id
  --LEFT JOIN dbo.d_joustava_perusopetus d8 on d8.id=f.joustava_perusopetus_id
  --LEFT JOIN dbo.d_perusopetuksen_majoitusetuus d9 on d9.id=f.perusopetuksen_majoitusetuus_id
  LEFT JOIN dbo.d_perusopetuksen_tehostettu_tuki d10 on d10.id=f.perusopetuksen_tehostettu_tuki_id
  --LEFT JOIN d_sukupuoli d11 on d11.id=f.sukupuoli_id
  --LEFT JOIN d_perusopetuksen_tukimuoto d12 on d12.id=f.perusopetuksen_tukimuoto_id
  LEFT JOIN d_vieraskielisyys d13 on d13.id=f.vieraskielisyys_id
  where d2.kunta<>''Ulkomaat''
  
  
  ) a
  where Tilastovuosi>2010








' 
GO
/****** Object:  View [dbo].[v_f_tab_perusopetuksen_lisaopetuksen_paattaneiden_sijoittuminen]    Script Date: 21.6.2017 10:17:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_perusopetuksen_lisaopetuksen_paattaneiden_sijoittuminen]'))
EXEC dbo.sp_executesql @statement = N'




CREATE VIEW [dbo].[v_f_tab_perusopetuksen_lisaopetuksen_paattaneiden_sijoittuminen] AS

SELECT 
--Aikamuuttyjat
		  ''Tilastovuosi'' = [tilastointivuosi]
		  ,''Seurantavuosi'' = [tilastointivuosi]+1
--Henkilömuuttujat
          ,''Sukupuoli'' = d_sukupuoli.sukupuoli
          ,''Äidinkieli'' = d_aidinkieli_versio1.aidinkieli_versio1
		  ,''Asuinalueen AVI'' = d_alueluokitus.avi
		  ,''Asuinalueen ELY'' = d_alueluokitus.ely
		  ,''Asuinmaakunta'' = d_alueluokitus.maakunta
		  ,''Opiskelu/toiminta'' = d_opiskelu_toiminta.opiskelu_toiminta
--Järjestykset
          ,jarjestys_sukupuoli = d_sukupuoli.jarjestys
          ,jarjestys_aidinkieli = d_aidinkieli_versio1.jarjestys
		  ,jarjestys_avi = d_alueluokitus.jarjestys_avi
		  ,jarjestys_ely = d_alueluokitus.jarjestys_ely
		  ,jarjestys_maakunta = d_alueluokitus.jarjestys_maakunta
		  ,jarjestys_opiskelu_toiminta = d_opiskelu_toiminta.jarjestys_opiskelu_toiminta

--Koodit
		  ,koodit_asuinmaakunta = d_alueluokitus.maakunta_koodi
		  ,koodit_aidinkieli = d_aidinkieli_versio1.aidinkieli_versio1_koodi
		  ,koodit_sukupuoli = d_sukupuoli.sukupuoli_koodi
		  ,koodit_opiskelu_toiminta= d_opiskelu_toiminta.opiskelu_toiminta_koodi

--Lukumäärämuuttujat
      ,''Lisäopetuksen suorittaneet'' = f.[lukumaara]

--RUOTSI
--Aikamuuttyjat
		  ,''Statistikår'' = [tilastointivuosi]
		  ,''Uppföljningsår'' = [tilastointivuosi]+1
--Henkilömuuttujat
          ,''Kön'' = d_sukupuoli.sukupuoli_SV
		  ,''Modersmål'' = d_aidinkieli_versio1.aidinkieli_versio1_SV
		  ,''Bostadsortens RFV-område'' = d_alueluokitus.avi_SV
		  ,''Bostadsortens NTM-område'' = d_alueluokitus.ely_SV
		  ,''Bostadslandskap'' = d_alueluokitus.maakunta_SV
		  ,''Studier/verksamhet'' = d_opiskelu_toiminta.opiskelu_toiminta_SV

--ENGLANTI
--Aikamuuttyjat
		  ,''Statistical year'' = [tilastointivuosi]
		  ,''Follow-up year'' = [tilastointivuosi]+1
--Henkilömuuttujat
          ,''Gender'' = d_sukupuoli.sukupuoli_EN
		  ,''Mother tongue'' = d_aidinkieli_versio1.aidinkieli_versio1_EN
		  ,''AVI area of the place of residence'' = d_alueluokitus.avi_EN
		  ,''ELY area of the place of residence'' = d_alueluokitus.ely_EN
		  ,''Region of residence '' = d_alueluokitus.maakunta_EN
		  ,''Studies/activity'' = d_opiskelu_toiminta.opiskelu_toiminta_EN

FROM VipunenTK.[dbo].[f_4_1_Perusopetuksen_lisaopetuksen_paattaneiden_sijoittuminen] f
  INNER JOIN VipunenTK.[dbo].d_aidinkieli_versio1
	ON d_aidinkieli_versio1.id = f.[aidinkieli_id]
  INNER JOIN VipunenTK.[dbo].d_alueluokitus
    ON d_alueluokitus.id = f.[asuinmaakunta_id]
  INNER JOIN VipunenTK.[dbo].d_sukupuoli
	ON d_sukupuoli.id = f.sukupuoli_id
  INNER JOIN VipunenTK.[dbo].d_opiskelu_toiminta
    ON d_opiskelu_toiminta.id = f.[opiskelu_toiminta_id]










' 
GO
/****** Object:  View [dbo].[v_f_tab_sekt_tutkimus_ja_kehitys]    Script Date: 21.6.2017 10:17:26 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_sekt_tutkimus_ja_kehitys]'))
EXEC dbo.sp_executesql @statement = N'



CREATE VIEW [dbo].[v_f_tab_sekt_tutkimus_ja_kehitys] AS

SELECT 
--Aikamuuttyjat
		  ''Tilastovuosi'' = [tilastovuosi]
--Aluemuuttujat
		  ,''AVI-alue (tutkimusmenot)'' = d_alueluokitus_historia.avi
		  ,''ELY-alue (tutkimusmenot)'' = d_alueluokitus_historia.ely
		  ,''Maakunta (tutkimusmenot)'' = d_alueluokitus_historia.maakunta
		  ,''Kunta (tutkimusmenot)'' = d_alueluokitus_historia.kunta
--Henkilömuuttujat
          ,''Sukupuoli'' = d_sukupuoli.sukupuoli
          ,''Tutkintotaso'' = d_tutkintotaso.tutkintotaso
		  ,''Tutkimustehtävä'' = d_tutkimus_tehtava.tutkimus_tehtava
		  ,''AVI-alue (T&K henkilökunta)'' = d_alueluokitus_historia.avi
		  ,''ELY-alue (T&K henkilökunta)'' = d_alueluokitus_historia.ely
		  ,''Maakunta (T&K henkilökunta)'' = d_alueluokitus_historia.maakunta
		  ,''Kunta (T&K henkilökunta)'' = d_alueluokitus_historia.kunta
--Organisaatiomuuttujat
          ,''Sektoritutkimuslaitos'' = d_sektoritutkimuslaitos.sektoritutkimuslaitos
--Tieteenalamuuttujat
          ,''Päätieteenala (2007 luokitus)'' = d_tieteenala.paatieteenala2007
          ,''Päätieteenala (2010 luokitus)'' = d_tieteenala.paatieteenala2010
          ,''Tieteenala (2007 luokitus)'' = d_tieteenala.tieteenala2007
          ,''Tieteenala (2010 luokitus)'' = d_tieteenala.tieteenala2010
--Rahoitus- ja menomuuttujat
          ,''Rahoituslähde'' = d_tutkimuksen_rahoituslahde.rahoituslahde
          ,''Rahoituksen laatu'' = d_tutkimuksen_rahoituslahde.rahoituksen_laatu
          ,''Rahoituslähteen tyyppi'' = d_tutkimuksen_rahoituslahde.rahoituslahteen_tyyppi
          ,''Ulkop. rahoituksen kansainvälisyys'' = d_tutkimuksen_rahoituslahde.ulkopuolisen_rahoituksen_kansainvalisyys
          ,''Rahoituslähdetarkennus'' = d_tutkimuksen_rahoituslahde.rahoituslahdetarkennus
          ,''Tutkimusmenojen kohde'' = d_tutkimusmenojen_kohde.menokohde
          ,''Tutkimusmenotyyppi'' = d_tutkimusmenojen_kohde.menotyyppi
--Järjestykset
          ,jarjestys_sekt = d_sektoritutkimuslaitos.jarjestys_sektoritutkimuslaitos
          ,jarjestys_sukupuoli = d_sukupuoli.jarjestys
		  ,jarjestys_tutkimustehtava = d_tutkimus_tehtava.jarjestys
		  ,jarjestys_avi = d_alueluokitus_historia.jarjestys_avi
		  ,jarjestys_ely = d_alueluokitus_historia.jarjestys_ely
		  ,jarjestys_maakunta = d_alueluokitus_historia.jarjestys_maakunta
          ,d_tieteenala.jarjestys_paatieteenala2007
          ,d_tieteenala.jarjestys_paatieteenala2010
          ,d_tieteenala.jarjestys_tieteenala2007
          ,d_tieteenala.jarjestys_tieteenala2010
          ,jarjestys_tutkintotaso = d_tutkintotaso.jarjestys
          ,d_tutkimuksen_rahoituslahde.jarjestys_rahoituslahde
          ,d_tutkimuksen_rahoituslahde.jarjestys_rahoituksen_laatu
          ,d_tutkimuksen_rahoituslahde.jarjestys_rahoituslahteen_tyyppi
          ,d_tutkimuksen_rahoituslahde.jarjestys_ulkopuolisen_rahoituksen_kansainvalisyys
          ,d_tutkimuksen_rahoituslahde.jarjestys_rahoituslahdetarkennus
          ,d_tutkimusmenojen_kohde.jarjestys_menokohde
          ,d_tutkimusmenojen_kohde.jarjestys_menotyyppi
--Lukumäärämuuttujat
      ,''Tutkimusrahoitus (1000 euroa)2'' = [tutkimusrahoitus]
      ,''Tutkimushenkilökunnan lkm (alueittain)2'' = lkm_tutkimushenkilokunta_alueittain
	  ,''Tutkimushenkilökunnan lkm (tehtävittäin)2'' = lkm_tutkimushenkilokunta_paatieteenaloittain_tehtavittain
	  ,''Tutkimushenkilökunnan lkm (tutkintotasoittain)2'' = lkm_tutkimushenkilokunta_tutkintotasoittain
	  ,''Tutkimusmenot (1000 euroa)2'' = [tutkimusmenot]
	  ,''Tutkimusmenot (1000 euroa) arvio seuraavasta tilastovuodesta2'' = [tutkimusmenot_arvio_seuraavatilastovuosi]
	  ,''Tutkimusmenot (1000 euroa) (alueittain)2'' = [tutkimusmenot_alueittain]
	  ,''Tutkimusmenot (1000 euroa) (tieteenaloittain)2'' = [tutkimusmenot_tieteenaloittain]
	  ,''Tutkimustyövuodet (alueittain)2'' = [lkm_tutkimustyovuodet_alueittain]
	  ,''Tutkimustyövuodet (tehtävittäin)2'' = [lkm_tutkimustyovuodet_tehtavittain]
	  ,''Tutkimustyövuodet (tutkintotasoittain)2'' = [lkm_tutkimustyovuodet_tutkintotasoittain]

--RUOTSI
--Aikamuuttyjat
		  ,''Statistikår'' = [tilastovuosi]
--Aluemuuttujat
		  ,''RFV-område (forskningsutgifter)'' = d_alueluokitus_historia.avi_SV
		  ,''NTM-område (forskningsutgifter)'' = d_alueluokitus_historia.ely_SV
		  ,''Landskap (forskningsutgifter)'' = d_alueluokitus_historia.maakunta_SV
		  ,''Kommun (forskningsutgifter)'' = d_alueluokitus_historia.kunta_SV
--Henkilömuuttujat
          ,''Kön'' = d_sukupuoli.sukupuoli_SV
          ,''Examensnivå'' = d_tutkintotaso.tutkintotaso_SV
		  ,''Forskningsuppgift'' = d_tutkimus_tehtava.tutkimus_tehtava_SV
		  ,''RFV-område (F&U personal)'' = d_alueluokitus_historia.avi_SV
		  ,''NTM-område (F&U personal)'' = d_alueluokitus_historia.ely_SV
		  ,''Landskap (F&U personal)'' = d_alueluokitus_historia.maakunta_SV
		  ,''Kommun (F&U personal)'' = d_alueluokitus_historia.kunta_SV
--Organisaatiomuuttujat
          ,''Sektorforskningsinstitution'' = d_sektoritutkimuslaitos.sektoritutkimuslaitos_SV
--Tieteenalamuuttujat
          ,''Huvudvetenskapsgren (2007)'' = d_tieteenala.paatieteenala2007_SV
          ,''Huvudvetenskapsgren (2010)'' = d_tieteenala.paatieteenala2010_SV
          ,''Vetenskapsgren (2007)'' = d_tieteenala.tieteenala2007_SV
          ,''Vetenskapsgren (2010)'' = d_tieteenala.tieteenala2010_SV
--Rahoitus- ja menomuuttujat
          ,''Finansieringskälla'' = d_tutkimuksen_rahoituslahde.rahoituslahde_SV
          ,''Finansieringstyp'' = d_tutkimuksen_rahoituslahde.rahoituksen_laatu_SV
          ,''Finansieringskällans typ'' = d_tutkimuksen_rahoituslahde.rahoituslahteen_tyyppi_SV
          ,''Externa finansieringens internat.'' = d_tutkimuksen_rahoituslahde.ulkopuolisen_rahoituksen_kansainvalisyys_SV
          ,''Spec. av finansieringskällan'' = d_tutkimuksen_rahoituslahde.rahoituslahdetarkennus_SV
          ,''Forskningsutgifternas mål'' = d_tutkimusmenojen_kohde.menokohde_SV
          ,''Typ av forskningsutgifter'' = d_tutkimusmenojen_kohde.menotyyppi_SV

--ENGLANTI
--Aikamuuttyjat
		  ,''Statistical year'' = [tilastovuosi]
--Aluemuuttujat
		  ,''AVI area (R&D budget funds)'' = d_alueluokitus_historia.avi_EN
		  ,''ELY area (R&D budget funds)'' = d_alueluokitus_historia.ely_EN
		  ,''Region (R&D budget funds)'' = d_alueluokitus_historia.maakunta_EN
		  ,''Municipality (R&D budget funds)'' = d_alueluokitus_historia.kunta_EN
--Henkilömuuttujat
          ,''Gender'' = d_sukupuoli.sukupuoli_EN
          ,''Level of degree'' = d_tutkintotaso.tutkintotaso_EN
		  ,''R&D task'' = d_tutkimus_tehtava.tutkimus_tehtava_EN
		  ,''AVI area (R&D personnel)'' = d_alueluokitus_historia.avi_EN
		  ,''ELY area (R&D personnel)'' = d_alueluokitus_historia.ely_EN
		  ,''Region (R&D personnel)'' = d_alueluokitus_historia.maakunta_EN
		  ,''Municipality (R&D personnel)'' = d_alueluokitus_historia.kunta_EN
--Organisaatiomuuttujat
          ,''Goverment research institute'' = d_sektoritutkimuslaitos.sektoritutkimuslaitos_EN
--Tieteenalamuuttujat
          ,''Main discipline (2007)'' = d_tieteenala.paatieteenala2007_EN
          ,''Main discipline (2010)'' = d_tieteenala.paatieteenala2010_EN
          ,''Discipline (2007)'' = d_tieteenala.tieteenala2007_EN
          ,''Discipline (2010)'' = d_tieteenala.tieteenala2010_EN
--Rahoitus- ja menomuuttujat
          ,''Source of funding I'' = d_tutkimuksen_rahoituslahde.rahoituslahde_EN
          ,''Type of funding II'' = d_tutkimuksen_rahoituslahde.rahoituksen_laatu_EN
          ,''Type of funding I'' = d_tutkimuksen_rahoituslahde.rahoituslahteen_tyyppi_EN
          ,''External funding (internat.)'' = d_tutkimuksen_rahoituslahde.ulkopuolisen_rahoituksen_kansainvalisyys_EN
          ,''Source of funding II'' = d_tutkimuksen_rahoituslahde.rahoituslahdetarkennus_EN
          ,''Target of budget funds'' = d_tutkimusmenojen_kohde.menokohde_EN
          ,''Type of budget funds'' = d_tutkimusmenojen_kohde.menotyyppi_EN

FROM (
SELECT [tilastovuosi]
	  ,sektoritutkimuslaitos_id
	  ,rahoituslahde_id
	  ,alueluokitus_id = -1
	  ,sukupuoli_id = -1
	  ,tehtava_id = -1
	  ,tieteenala_id = -1
	  ,tutkintotaso_id = -1
	  ,menokohde_id = -1
      ,tutkimusrahoitus
	  ,lkm_tutkimushenkilokunta_alueittain = NULL
	  ,lkm_tutkimushenkilokunta_paatieteenaloittain_tehtavittain = NULL
	  ,lkm_tutkimushenkilokunta_tutkintotasoittain = NULL
	  ,tutkimusmenot = NULL
	  ,tutkimusmenot_arvio_seuraavatilastovuosi = NULL
	  ,tutkimusmenot_alueittain = NULL
	  ,tutkimusmenot_tieteenaloittain = NULL
	  ,lkm_tutkimustyovuodet_alueittain = NULL
	  ,lkm_tutkimustyovuodet_tehtavittain = NULL
	  ,lkm_tutkimustyovuodet_tutkintotasoittain = NULL
  FROM [dbo].[f_Sektoritutkimuslaitosten_tutkimus_ja_kehitys_rahoitus]

UNION ALL
SELECT [tilastovuosi]
	  ,sektoritutkimuslaitos_id
	  ,rahoituslahde_id = -1
	  ,alueluokitus_id
	  ,sukupuoli_id = -1
	  ,tehtava_id = -1
	  ,tieteenala_id = -1
	  ,tutkintotaso_id = -1
	  ,menokohde_id = -1
      ,tutkimusrahoitus = NULL
	  ,lkm_tutkimushenkilokunta_alueittain
	  ,lkm_tutkimushenkilokunta_paatieteenaloittain_tehtavittain = NULL
	  ,lkm_tutkimushenkilokunta_tutkintotasoittain = NULL
	  ,tutkimusmenot = NULL
	  ,tutkimusmenot_arvio_seuraavatilastovuosi = NULL
	  ,tutkimusmenot_alueittain = NULL
	  ,tutkimusmenot_tieteenaloittain = NULL
	  ,lkm_tutkimustyovuodet_alueittain = NULL
	  ,lkm_tutkimustyovuodet_tehtavittain = NULL
	  ,lkm_tutkimustyovuodet_tutkintotasoittain = NULL
  FROM VipunenTK.[dbo].[f_Sektoritutkimuslaitosten_tutkimus_ja_kehitys_tutkimushenkilokunta_alueittain]

UNION ALL
SELECT [tilastovuosi]
	  ,sektoritutkimuslaitos_id
	  ,rahoituslahde_id = -1
	  ,alueluokitus_id = -1
	  ,sukupuoli_id
	  ,tehtava_id
	  ,tieteenala_id
	  ,tutkintotaso_id = -1
	  ,menokohde_id = -1
      ,tutkimusrahoitus = NULL
	  ,lkm_tutkimushenkilokunta_alueittain = NULL
	  ,lkm_tutkimushenkilokunta_paatieteenaloittain_tehtavittain
	  ,lkm_tutkimushenkilokunta_tutkintotasoittain = NULL
	  ,tutkimusmenot = NULL
	  ,tutkimusmenot_arvio_seuraavatilastovuosi = NULL
	  ,tutkimusmenot_alueittain = NULL
	  ,tutkimusmenot_tieteenaloittain = NULL
	  ,lkm_tutkimustyovuodet_alueittain = NULL
	  ,lkm_tutkimustyovuodet_tehtavittain = NULL
	  ,lkm_tutkimustyovuodet_tutkintotasoittain = NULL
  FROM VipunenTK.[dbo].[f_Sektoritutkimuslaitosten_tutkimus_ja_kehitys_tutkimushenkilokunta_paatieteenaloittain_tehtavittain]

UNION ALL
SELECT [tilastovuosi]
	  ,sektoritutkimuslaitos_id
	  ,rahoituslahde_id = -1
	  ,alueluokitus_id = -1
	  ,sukupuoli_id
	  ,tehtava_id = -1
	  ,tieteenala_id = -1
	  ,tutkintotaso_id
	  ,menokohde_id = -1
      ,tutkimusrahoitus = NULL
	  ,lkm_tutkimushenkilokunta_alueittain = NULL
	  ,lkm_tutkimushenkilokunta_paatieteenaloittain_tehtavittain = NULL
	  ,lkm_tutkimushenkilokunta_tutkintotasoittain
	  ,tutkimusmenot = NULL
	  ,tutkimusmenot_arvio_seuraavatilastovuosi = NULL
	  ,tutkimusmenot_alueittain = NULL
	  ,tutkimusmenot_tieteenaloittain = NULL
	  ,lkm_tutkimustyovuodet_alueittain = NULL
	  ,lkm_tutkimustyovuodet_tehtavittain = NULL
	  ,lkm_tutkimustyovuodet_tutkintotasoittain = NULL
  FROM VipunenTK.[dbo].[f_Sektoritutkimuslaitosten_tutkimus_ja_kehitys_tutkimushenkilokunta_tutkintotasoittain]

UNION ALL
SELECT [tilastovuosi]
	  ,sektoritutkimuslaitos_id
	  ,rahoituslahde_id = -1
	  ,alueluokitus_id = -1
	  ,sukupuoli_id = -1
	  ,tehtava_id = -1
	  ,tieteenala_id = -1
	  ,tutkintotaso_id = -1
	  ,menokohde_id
      ,tutkimusrahoitus = NULL
	  ,lkm_tutkimushenkilokunta_alueittain = NULL
	  ,lkm_tutkimushenkilokunta_paatieteenaloittain_tehtavittain = NULL
	  ,lkm_tutkimushenkilokunta_tutkintotasoittain = NULL
	  ,tutkimusmenot
	  ,tutkimusmenot_arvio_seuraavatilastovuosi
	  ,tutkimusmenot_alueittain = NULL
	  ,tutkimusmenot_tieteenaloittain = NULL
	  ,lkm_tutkimustyovuodet_alueittain = NULL
	  ,lkm_tutkimustyovuodet_tehtavittain = NULL
	  ,lkm_tutkimustyovuodet_tutkintotasoittain = NULL
  FROM VipunenTK.[dbo].[f_Sektoritutkimuslaitosten_tutkimus_ja_kehitys_tutkimusmenot]

UNION ALL
SELECT [tilastovuosi]
	  ,sektoritutkimuslaitos_id
	  ,rahoituslahde_id = -1
	  ,alueluokitus_id
	  ,sukupuoli_id = -1
	  ,tehtava_id = -1
	  ,tieteenala_id = -1
	  ,tutkintotaso_id = -1
	  ,menokohde_id = -1
      ,tutkimusrahoitus = NULL
	  ,lkm_tutkimushenkilokunta_alueittain = NULL
	  ,lkm_tutkimushenkilokunta_paatieteenaloittain_tehtavittain = NULL
	  ,lkm_tutkimushenkilokunta_tutkintotasoittain = NULL
	  ,tutkimusmenot = NULL
	  ,tutkimusmenot_arvio_seuraavatilastovuosi = NULL
	  ,tutkimusmenot_alueittain
	  ,tutkimusmenot_tieteenaloittain = NULL
	  ,lkm_tutkimustyovuodet_alueittain = NULL
	  ,lkm_tutkimustyovuodet_tehtavittain = NULL
	  ,lkm_tutkimustyovuodet_tutkintotasoittain = NULL
  FROM VipunenTK.[dbo].[f_Sektoritutkimuslaitosten_tutkimus_ja_kehitys_tutkimusmenot_alueittain]

UNION ALL
SELECT [tilastovuosi]
	  ,sektoritutkimuslaitos_id
	  ,rahoituslahde_id = -1
	  ,alueluokitus_id = -1
	  ,sukupuoli_id = -1
	  ,tehtava_id = -1
	  ,tieteenala_id
	  ,tutkintotaso_id = -1
	  ,menokohde_id = -1
      ,tutkimusrahoitus = NULL
	  ,lkm_tutkimushenkilokunta_alueittain = NULL
	  ,lkm_tutkimushenkilokunta_paatieteenaloittain_tehtavittain = NULL
	  ,lkm_tutkimushenkilokunta_tutkintotasoittain = NULL
	  ,tutkimusmenot = NULL
	  ,tutkimusmenot_arvio_seuraavatilastovuosi = NULL
	  ,tutkimusmenot_alueittain = NULL
	  ,tutkimusmenot_tieteenaloittain
	  ,lkm_tutkimustyovuodet_alueittain = NULL
	  ,lkm_tutkimustyovuodet_tehtavittain = NULL
	  ,lkm_tutkimustyovuodet_tutkintotasoittain = NULL
  FROM VipunenTK.[dbo].[f_Sektoritutkimuslaitosten_tutkimus_ja_kehitys_tutkimusmenot_tieteenaloittain]

UNION ALL
SELECT [tilastovuosi]
	  ,sektoritutkimuslaitos_id
	  ,rahoituslahde_id = -1
	  ,alueluokitus_id
	  ,sukupuoli_id = -1
	  ,tehtava_id = -1
	  ,tieteenala_id = -1
	  ,tutkintotaso_id = -1
	  ,menokohde_id = -1
      ,tutkimusrahoitus = NULL
	  ,lkm_tutkimushenkilokunta_alueittain = NULL
	  ,lkm_tutkimushenkilokunta_paatieteenaloittain_tehtavittain = NULL
	  ,lkm_tutkimushenkilokunta_tutkintotasoittain = NULL
	  ,tutkimusmenot = NULL
	  ,tutkimusmenot_arvio_seuraavatilastovuosi = NULL
	  ,tutkimusmenot_alueittain = NULL
	  ,tutkimusmenot_tieteenaloittain = NULL
	  ,lkm_tutkimustyovuodet_alueittain
	  ,lkm_tutkimustyovuodet_tehtavittain = NULL
	  ,lkm_tutkimustyovuodet_tutkintotasoittain = NULL
  FROM VipunenTK.[dbo].[f_Sektoritutkimuslaitosten_tutkimus_ja_kehitys_tutkimustyovuodet_alueittain]

UNION ALL
SELECT [tilastovuosi]
	  ,sektoritutkimuslaitos_id
	  ,rahoituslahde_id = -1
	  ,alueluokitus_id = -1
	  ,sukupuoli_id = -1
	  ,tehtava_id
	  ,tieteenala_id = -1
	  ,tutkintotaso_id = -1
	  ,menokohde_id = -1
      ,tutkimusrahoitus = NULL
	  ,lkm_tutkimushenkilokunta_alueittain = NULL
	  ,lkm_tutkimushenkilokunta_paatieteenaloittain_tehtavittain = NULL
	  ,lkm_tutkimushenkilokunta_tutkintotasoittain = NULL
	  ,tutkimusmenot = NULL
	  ,tutkimusmenot_arvio_seuraavatilastovuosi = NULL
	  ,tutkimusmenot_alueittain = NULL
	  ,tutkimusmenot_tieteenaloittain = NULL
	  ,lkm_tutkimustyovuodet_alueittain = NULL
	  ,lkm_tutkimustyovuodet_tehtavittain
	  ,lkm_tutkimustyovuodet_tutkintotasoittain = NULL
  FROM VipunenTK.[dbo].[f_Sektoritutkimuslaitosten_tutkimus_ja_kehitys_tutkimustyovuodet_tehtavittain]

UNION ALL
SELECT [tilastovuosi]
	  ,sektoritutkimuslaitos_id
	  ,rahoituslahde_id = -1
	  ,alueluokitus_id = -1
	  ,sukupuoli_id = -1
	  ,tehtava_id = -1
	  ,tieteenala_id = -1
	  ,tutkintotaso_id
	  ,menokohde_id = -1
      ,tutkimusrahoitus = NULL
	  ,lkm_tutkimushenkilokunta_alueittain = NULL
	  ,lkm_tutkimushenkilokunta_paatieteenaloittain_tehtavittain = NULL
	  ,lkm_tutkimushenkilokunta_tutkintotasoittain = NULL
	  ,tutkimusmenot = NULL
	  ,tutkimusmenot_arvio_seuraavatilastovuosi = NULL
	  ,tutkimusmenot_alueittain = NULL
	  ,tutkimusmenot_tieteenaloittain = NULL
	  ,lkm_tutkimustyovuodet_alueittain = NULL
	  ,lkm_tutkimustyovuodet_tehtavittain = NULL
	  ,lkm_tutkimustyovuodet_tutkintotasoittain
  FROM VipunenTK.[dbo].[f_Sektoritutkimuslaitosten_tutkimus_ja_kehitys_tutkimustyovuodet_tutkintotasoittain]

  ) f
  INNER JOIN VipunenTK.[dbo].d_sektoritutkimuslaitos
	ON d_sektoritutkimuslaitos.id = f.sektoritutkimuslaitos_id
  INNER JOIN VipunenTK.[dbo].d_tutkimuksen_rahoituslahde
	ON d_tutkimuksen_rahoituslahde.id = f.rahoituslahde_id
  INNER JOIN VipunenTK.[dbo].d_alueluokitus_historia
    ON d_alueluokitus_historia.id = f.alueluokitus_id
  INNER JOIN VipunenTK.[dbo].d_sukupuoli
	ON d_sukupuoli.id = f.sukupuoli_id
  INNER JOIN VipunenTK.[dbo].d_tutkimus_tehtava
    ON d_tutkimus_tehtava.id = f.tehtava_id
  INNER JOIN VipunenTK.[dbo].d_tieteenala
	ON d_tieteenala.id = f.tieteenala_id
  INNER JOIN VipunenTK.[dbo].d_tutkintotaso
	ON d_tutkintotaso.id = f.tutkintotaso_id
  INNER JOIN VipunenTK.[dbo].d_tutkimusmenojen_kohde
	ON d_tutkimusmenojen_kohde.id = f.menokohde_id



' 
GO
/****** Object:  View [dbo].[v_f_tab_sosioekonominen_tausta]    Script Date: 21.6.2017 10:17:26 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_sosioekonominen_tausta]'))
EXEC dbo.sp_executesql @statement = N'




CREATE view [dbo].[v_f_tab_sosioekonominen_tausta] as

Select
 [Uudet opiskelijat2] = coalesce (uudet_opiskelijat,0),
 [Opiskelijat2] = coalesce (opiskelijat,0)
,[Tutkinnot2] = coalesce (tutkinnot,0)
,[Tilastointivuosi] as Tilastovuosi
,d1.koulutusala2002 as "Koulutusala (opiskelija)"
,d1.jarjestys_koulutusala2002 as "koul02_op"
,d1.opintoala2002 as "Opintoala (opiskelija)"
,d1.jarjestys_opintoala2002 as "op02_op"
,d1.koulutus as "Koulutusnimike (opiskelija)"
,d1.koulutusaste2002 as "Koulutusaste (opiskelija)"
,d1.jarjestys_koulutusaste2002 as "kast02_op"
,d1.opintoala1995 as "Koulutusala (95) (opiskelija)"
,d1.jarjestys_opintoala1995 as "op95_op"
,d2.koulutusala2002 as "Koulutusala (äiti)"
,d2.jarjestys_koulutusala2002 as "koul02_ai"
,d2.opintoala2002 as "Opintoala (äiti)"
,d2.jarjestys_opintoala2002 as "op02_ai"
,d2.koulutus as "Koulutusnimike (äiti)"
,d2.koulutusaste2002 as "Koulutusaste (äiti)"
,d2.jarjestys_koulutusaste2002 as "kast02_ai"
,d2.opintoala1995 as "Koulutusala (95) (äiti)"
,d2.jarjestys_opintoala1995 as "op95_ai"
,d3.koulutusala2002 as "Koulutusala (isä)"
,d3.jarjestys_koulutusala2002 as "koul02_is"
,d3.opintoala2002 as "Opintoala (isä)"
,d3.jarjestys_opintoala2002 as "op02_is"
,d3.koulutus as "Koulutusnimike (isä)"
,d3.koulutusaste2002 as "Koulutusaste (isä)"
,d3.jarjestys_koulutusaste2002 as "kast02_is"
,d3.opintoala1995 as "Koulutusala (95) (isä)"
,d3.jarjestys_opintoala1995 as "op95_is"
,d4.koulutuslaji as "Koulutuslaji (opiskelija)"
,d4.jarjestys as "koulaj_jarj"
,d5.sukupuoli as "Sukupuoli (opiskelija)"
,d6.opetushallinnon_koulutus as "Hallinnonala"
,d6.jarjestys as "ophaljarj"
,d7.aidinkieli_versio1 as "Äidinkieli (opiskelija)"
,d7.jarjestys as "aid_jarj"
,d8.vuosiselite as "Syntymävuosi (opiskelija)"
,d8.jarjestys as "synt_jarj"
,d9.kieli as "Koulutuksen kieli (opiskelija)"
,d9.jarjestys as "kiel_jarj"
,d10.avi as "Koulutuksen AVI (opiskelija)"
,d10.jarjestys_avi as "koulavij"
,d10.ely as "Koulutuksen ELY (opiskelija)"
,d10.jarjestys_ely as "koulelyj"
,d10.maakunta as "Koulutuksen maakunta (opiskelija)"
,d10.jarjestys_maakunta as "koulmaakj"
,d11.avi as "Asuinalueen AVI (opiskelija)"
,d11.jarjestys_avi as "asavij"
,d11.ely as "Asuinalueen ELY (opiskelija)"
,d11.jarjestys_ely as "aselyj"
,d11.maakunta as "Asuinmaakunta (opiskelija)"
,d11.jarjestys_maakunta as "asmaakj"
,d12.avi as "Til.v:tta edeltävän vuoden AVI (opiskelija)"
,d12.jarjestys_avi as "as2avij"
,d12.ely as "Til.v:tta edeltävän vuoden ELY (opiskelija)"
,d12.jarjestys_ely as "as2elyj"
,d12.maakunta as "Til.v:tta edeltävän vuoden asuinmaakunta (opiskelija)"
,d12.jarjestys_maakunta as "as2maakj"
,d13.tulodesiili as "Tuloluokka (äiti)"
,d13.jarjestys as "tuljaiti"
,d14.tulodesiili as "Tuloluokka (isä)"
,d14.jarjestys as "tuljisa"
,d15.sosioekonominen_asema_ryhma as "Sos.ek. asema 1 (äiti)"
,d15.jarjestys_ryhma as "sosek1a_jarj"
,d16.sosioekonominen_asema as "Sos.ek. asema 2 (äiti)"
,d16.jarjestys_asema as "sosek2a_jarj"
,d17.sosioekonominen_asema_ryhma as "Sos.ek. asema 1 (isä)"
,d17.jarjestys_ryhma as "sosek1i_jarj"
,d18.sosioekonominen_asema as "Sos.ek. asema 2 (isä)"
,d18.jarjestys_asema as "sosek2i_jarj"
,d19.ika as "Ikä (opiskelija)"
,d19.jarjestys_ika as "ikaopjarj"
,d19.ika5v as "Ikäryhmä (opiskelija)"
,d19.jarjestys_ika5v as "ikaryhopjarj"
,d21.opiskelijan_olo as "Kirjoillaolo (opiskelija)"
,d21.jarjestys as "kirjjarj"
,d22.vuosiselite as "Kirjoihintulovuosi (opiskelija)"
,d22.jarjestys as "kirjvjarj"

--ruotsi
,[Tilastointivuosi] as Statistikår
,d1.koulutusala2002_SV as "Utbildn.omr. 2002 (stud.)"
,d1.opintoala2002_SV as "Studieomr. 2002 (stud.)"
,d1.koulutus_SV as "Utbildn.benämn. (stud.)"
,d1.koulutusaste2002_SV as "Utbildn.nivå 2002 (stud.)"
,d1.opintoala1995_SV as "Utbildn.omr. 1995 (stud.)"
,d2.koulutusala2002_SV as "Utbildn.omr. 2002 (modern)"
,d2.opintoala2002_SV as "Studieomr. 2002 (modern)"
,d2.koulutus_SV as "Utbildn.benämn. (modern)"
,d2.koulutusaste2002_SV as "Utbildn.nivå 2002 (modern)"
,d2.opintoala1995_SV as "Utbildn.omr. 1995 (modern)"
,d3.koulutusala2002_SV as "Utbildn.omr. 2002 (fadern)"
,d3.opintoala2002_SV as "Studieomr. 2002 (fadern)"
,d3.koulutus_SV as "Utbildn.benämn. (fadern)"
,d3.koulutusaste2002_SV as "Utbildn.nivå 2002 (fadern)"
,d3.opintoala1995_SV as "Utbildn.omr. 1995 (fadern)"
,d4.koulutuslaji_SV as "Examensslag (studerande)"
,d5.sukupuoli_SV as "Kön (studerande)"
,d6.opetushallinnon_koulutus_SV as "Förvaltningsområde"
,d7.aidinkieli_versio1_SV as "Modersmål (studerande)"
,d8.vuosiselite_SV as "Födelseår (studerande)"
,d9.kieli_SV as "Utbildn. språk (stud.)"
,d10.avi_SV as "Utbildn. RFV (studerande)"
,d10.ely_SV as "Utbildn. NTM (studerande)"
,d10.maakunta_SV as "Utbildn. landskap (stud.)"
,d11.avi_SV as "Bostadsortens RFV (stud.)"
,d11.ely_SV as "Bostadsortens NTM (stud.)"
,d11.maakunta_SV as "Bostadslandskap (stud.)"
,d12.avi_SV as "RFV före statistikåret (stud.)"
,d12.ely_SV as "NTM före statistikåret (stud.)"
,d12.maakunta_SV as "Landskap före stat.år. (stud.)"
,d13.tulodesiili_SV as "Inkomstklass (modern)"
,d14.tulodesiili_SV as "Inkomstklass (fadern)"
,d15.sosioekonominen_asema_ryhma_SV as "Soc.ek. ställn. 1 (modern)"
,d16.sosioekonominen_asema_SV as "Soc.ek. ställn. 2 (modern)"
,d17.sosioekonominen_asema_ryhma_SV as "Soc.ek. ställn. 1 (fadern)"
,d18.sosioekonominen_asema_SV as "Soc.ek. ställn. 2 (fadern)"
,d19.ika_SV as "Ålder (studerande)"
,d19.ika5v_SV as "Åldersgrupp (studerande)"
,d21.opiskelijan_olo_SV as "Inskrivning (studerande)"
,d22.vuosiselite_SV as "Inskrivningår (stud.)"

--englanti
,[Tilastointivuosi] as "Statistical year"
,d1.koulutusala2002_EN as "Field of ed. 2002 (stud.)"
,d1.opintoala2002_EN as "Subfield of ed. 2002 (stud.)"
,d1.koulutus_EN as "Name of ed. (stud.)"
,d1.koulutusaste2002_EN as "Level of ed. (stud.)"
,d1.opintoala1995_EN as "Field of ed. 1995 (stud.)"
,d2.koulutusala2002_EN as "Field of ed. 2002 (mother)"
,d2.opintoala2002_EN as "Subfield of ed. 2002 (mother)"
,d2.koulutus_EN as "Name of ed. (mother)"
,d2.koulutusaste2002_EN as "Level of ed. (mother)"
,d2.opintoala1995_EN as "Field of ed. 1995 (mother)"
,d3.koulutusala2002_EN as "Field of ed. 2002 (father)"
,d3.opintoala2002_EN as "Subfield of ed. 2002 (father)"
,d3.koulutus_EN as "Name of ed. (father)"
,d3.koulutusaste2002_EN as "Level of ed. (father)"
,d3.opintoala1995_EN as "Field of ed. 1995 (father)"
,d4.koulutuslaji_EN as "Form of ed. (student)"
,d5.sukupuoli_EN as "Gender (student)"
,d6.opetushallinnon_koulutus_EN as "Administrative sector"
,d7.aidinkieli_versio1_EN as "Mother tongue (student)"
,d8.vuosiselite_EN as "Birth year (student)"
,d9.kieli_EN as "Language of ed. (student)"
,d10.avi_EN as "AVI area of ed. (stud.)"
,d10.ely_EN as "ELY area of ed. (stud.)"
,d10.maakunta_EN as "Region of ed. (stud.)"
,d11.avi_EN as "AVI area of res. (stud.)"
,d11.ely_EN as "ELY area of res. (stud.)"
,d11.maakunta_EN as "Region of res. (stud.)"
,d12.avi_EN as "AVI preceding the stat. year (stud.)"
,d12.ely_EN as "ELY preceding the stat. year (stud.)"
,d12.maakunta_EN as "Region preceding the stat. year (stud.)"
,d13.tulodesiili_EN as "Income group (mother)"
,d14.tulodesiili_EN as "Income group (father)"
,d15.sosioekonominen_asema_ryhma_EN as "Soc.ec. group 1 (mother)"
,d16.sosioekonominen_asema_EN as "Soc.ec. group 2 (mother)"
,d17.sosioekonominen_asema_ryhma_EN as "Soc.ec. group 1 (father)"
,d18.sosioekonominen_asema_EN as "Soc.ec. group 2 (father)"
,d19.ika_EN as "Age (student)"
,d19.ika5v_EN as "Agegroup (student)"
,d21.opiskelijan_olo_EN as "Enrollment status (stud.)"
,d22.vuosiselite_EN as "Year of enrollment (stud.)"

--koodit
,d1.koulutusala2002_koodi as "Koodit Koulutusala 2002 (opisk)"
,d1.opintoala2002_koodi as "Koodit Opintoala 2002 (opisk)"
,d1.koulutus_koodi as "Koodit Koulutusnimike (opisk)"
,d1.koulutusaste2002_koodi as "Koodit Koulutusaste 2002 (opisk)"
,d1.opintoala1995_koodi as "Koodit Koulutusala 1995 (opisk)"
,d2.koulutusala2002_koodi as "Koodit Koulutusala 2002 (äiti)"
,d2.opintoala2002_koodi as "Koodit Opintoala 2002 (äiti)"
,d2.koulutus_koodi as "Koodit Koulutusnimike (äiti)"
,d2.koulutusaste2002_koodi as "Koodit Koulutusaste 2002 (äiti)"
,d2.opintoala1995_koodi as "Koodit Koulutusala 1995 (äiti)"
,d3.koulutusala2002_koodi as "Koodit Koulutusala 2002 (isä)"
,d3.opintoala2002_koodi as "Koodit Opintoala 2002 (isä)"
,d3.koulutus_koodi as "Koodit Koulutusnimike (isä)"
,d3.koulutusaste2002_koodi as "Koodit Koulutusaste 2002 (isä)"
,d3.opintoala1995_koodi as "Koodit Koulutusala 1995 (isä)"
,d4.koulutuslaji_koodi as "Koodit Koulutuslaji (opisk)"
,d10.maakunta_koodi as "Koodit Koulutuksen maakunta (opisk)"
,d11.maakunta_koodi as "Koodit Asuinmaakunta (opisk)"
,d12.maakunta_koodi as "Koodit Til.v:tta ed. asuinmaakunta (opisk)"

--isced
,d1.iscle2011 as "Koulutusaste 1 (opisk.)"
,d1.Koulutusaste_taso2 as "Koulutusaste 2 (opisk.)"
,d1.iscfibroad2013 as "Koulutusala 1 (opisk.)"
,d1.iscfinarrow2013 as "Koulutusala 2 (opisk.)"
,d1.iscfi2013 as "Koulutusala 3 (opisk.)"
,d1.OKM_ohjauksen_ala as "OKM ohjauksen ala, korkeak. (opisk.)"
,d1.iscle2011_SV as "Utbildn.nivå 1 (studerande)"
,d1.Koulutusaste_taso2_SV as "Utbildn.nivå 2 (studerande)"
,d1.iscfibroad2013_SV as "Utbildn.omr. 1 (studerande)"
,d1.iscfinarrow2013_SV as "Utbildn.omr. 2 (studerande)"
,d1.iscfi2013_SV as "Utbildn.omr. 3 (studerande)"
,d1.OKM_ohjauksen_ala_SV as "UKM-styrningsområde, högskolor (studerande)"
,d1.iscle2011_EN as "Level of ed. 1 (student)"
,d1.Koulutusaste_taso2_EN as "Level of ed. 2 (student)"
,d1.iscfibroad2013_EN as "Field of ed. 1 (student)"
,d1.iscfinarrow2013_EN as "Field of ed. 2 (student)"
,d1.iscfi2013_EN as "Field of ed. 3 (student)"
,d1.OKM_ohjauksen_ala_EN as "Field of ed., HE steering (student)"
,d1.jarjestys_iscle2011 as jarj_isced_koulast1
,d1.jarjestys_Koulutusaste_taso2 as jarj_isced_koulast2
,d1.jarjestys_iscfibroad2013 as jarj_isced_koulala1
,d1.jarjestys_iscfinarrow2013 as jarj_isced_koulala2
,d1.jarjestys_iscfi2013 as jarj_isced_koulala3
,d1.jarjestys_OKM_ohjauksen_ala as jarj_isced_okmohjaus1
,d1.iscle2011_koodi as "Koodit Koulutusaste 1 (opisk.)"
,d1.Koulutusaste_taso2_koodi as "Koodit Koulutusaste 2 (opisk.)"
,d1.iscfibroad2013_koodi as "Koodit Koulutusala 1 (opisk.)"
,d1.iscfinarrow2013_koodi as "Koodit Koulutusala 2 (opisk.)"
,d1.iscfi2013_koodi as "Koodit Koulutusala 3 (opisk.)"
,d1.OKM_ohjauksen_ala_koodi as "Koodit OKM ohjauksen ala, korkeak. (opisk.)"

,d2.iscle2011 as "Koulutusaste 1 (äiti)"
,d2.Koulutusaste_taso2 as "Koulutusaste 2 (äiti)"
,d2.iscfibroad2013 as "Koulutusala 1 (äiti)"
,d2.iscfinarrow2013 as "Koulutusala 2 (äiti)"
,d2.iscfi2013 as "Koulutusala 3 (äiti)"
,d2.OKM_ohjauksen_ala as "OKM ohjauksen ala, korkeak. (äiti)"
,d2.iscle2011_SV as "Utbildn.nivå 1 (modern)"
,d2.Koulutusaste_taso2_SV as "Utbildn.nivå 2 (modern)"
,d2.iscfibroad2013_SV as "Utbildn.område 1 (modern)"
,d2.iscfinarrow2013_SV as "Utbildn.område 2 (modern)"
,d2.iscfi2013_SV as "Utbildn.område 3 (modern)"
,d2.OKM_ohjauksen_ala_SV as "UKM-styrningsområde, högskolor (modern)"
,d2.iscle2011_EN as "Level of ed. 1 (mother)"
,d2.Koulutusaste_taso2_EN as "Level of ed. 2 (mother)"
,d2.iscfibroad2013_EN as "Field of ed. 1 (mother)"
,d2.iscfinarrow2013_EN as "Field of ed. 2 (mother)"
,d2.iscfi2013_EN as "Field of ed. 3 (mother)"
,d2.OKM_ohjauksen_ala_EN as "Field of ed., HE steering (mother)"
,d2.jarjestys_iscle2011 as jarj_isced_koulast1ai
,d2.jarjestys_Koulutusaste_taso2 as jarj_isced_koulast2ai
,d2.jarjestys_iscfibroad2013 as jarj_isced_koulala1ai
,d2.jarjestys_iscfinarrow2013 as jarj_isced_koulala2ai
,d2.jarjestys_iscfi2013 as jarj_isced_koulala3ai
,d2.jarjestys_OKM_ohjauksen_ala as jarj_isced_okmohjaus1ai
,d2.iscle2011_koodi as "Koodit Koulutusaste 1 (äiti)"
,d2.Koulutusaste_taso2_koodi as "Koodit Koulutusaste 2 (äiti)"
,d2.iscfibroad2013_koodi as "Koodit Koulutusala 1 (äiti)"
,d2.iscfinarrow2013_koodi as "Koodit Koulutusala 2 (äiti)"
,d2.iscfi2013_koodi as "Koodit Koulutusala 3 (äiti)"
,d2.OKM_ohjauksen_ala_koodi as "Koodit OKM ohjauksen ala, korkeak. (äiti)"

,d3.iscle2011 as "Koulutusaste 1 (isä)"
,d3.Koulutusaste_taso2 as "Koulutusaste 2 (isä)"
,d3.iscfibroad2013 as "Koulutusala 1 (isä)"
,d3.iscfinarrow2013 as "Koulutusala 2 (isä)"
,d3.iscfi2013 as "Koulutusala 3 (isä)"
,d3.OKM_ohjauksen_ala as "OKM ohjauksen ala, korkeak. (isä)"
,d3.iscle2011_SV as "Utbildn.nivå 1 (fadern)"
,d3.Koulutusaste_taso2_SV as "Utbildn.nivå 2 (fadern)"
,d3.iscfibroad2013_SV as "Utbildn.område 1 (fadern)"
,d3.iscfinarrow2013_SV as "Utbildn.område 2 (fadern)"
,d3.iscfi2013_SV as "Utbildn.område 3 (fadern)"
,d3.OKM_ohjauksen_ala_SV as "UKM-styrningsområde, högskolor (fadern)"
,d3.iscle2011_EN as "Level of ed. 1 (father)"
,d3.Koulutusaste_taso2_EN as "Level of ed. 2 (father)"
,d3.iscfibroad2013_EN as "Field of ed. 1 (father)"
,d3.iscfinarrow2013_EN as "Field of ed. 2 (father)"
,d3.iscfi2013_EN as "Field of ed. 3 (father)"
,d3.OKM_ohjauksen_ala_EN as "Field of ed., HE steering (father)"
,d3.jarjestys_iscle2011 as jarj_isced_koulast1is
,d3.jarjestys_Koulutusaste_taso2 as jarj_isced_koulast2is
,d3.jarjestys_iscfibroad2013 as jarj_isced_koulala1is
,d3.jarjestys_iscfinarrow2013 as jarj_isced_koulala2is
,d3.jarjestys_iscfi2013 as jarj_isced_koulala3is
,d3.jarjestys_OKM_ohjauksen_ala as jarj_isced_okmohjaus1is
,d3.iscle2011_koodi as "Koodit Koulutusaste 1 (isä)"
,d3.Koulutusaste_taso2_koodi as "Koodit Koulutusaste 2 (isä)"
,d3.iscfibroad2013_koodi as "Koodit Koulutusala 1 (isä)"
,d3.iscfinarrow2013_koodi as "Koodit Koulutusala 2 (isä)"
,d3.iscfi2013_koodi as "Koodit Koulutusala 3 (isä)"
,d3.OKM_ohjauksen_ala_koodi as "Koodit OKM ohjauksen ala, korkeak. (isä)"

,''Sosioekonominen tausta 0-6'' = Cast(''SES '' + Cast( 0
	+ Case when d2.koulutusaste2002_koodi in (''62'', ''63'', ''71'', ''72'', ''73'', ''81'', ''82'') then 1 else 0 end
	+ Case when d3.koulutusaste2002_koodi in (''62'', ''63'', ''71'', ''72'', ''73'', ''81'', ''82'') then 1 else 0 end
	+ Case when d13.tulodesiili_koodi in (''08'', ''09'', ''10'') then 1 else 0 end
	+ Case when d14.tulodesiili_koodi in (''08'', ''09'', ''10'') then 1 else 0 end
	+ Case when d16.sosioekonominen_asema_koodi in (''20'', ''31'', ''32'', ''33'', ''34'') then 1 else 0 end
	+ Case when d18.sosioekonominen_asema_koodi in (''20'', ''31'', ''32'', ''33'', ''34'') then 1 else 0 end
	 as nchar(1)) as nvarchar(10))

FROM dbo.f_SA_2_23_Opisk_ja_tutksuor_vanh_aseman_muk
	  JOIN d_koulutusluokitus d1 on d1.id = koulutusluokitus_id
	  JOIN d_koulutusluokitus d2 on d2.id = koulutusluokitus_aiti_id
	  JOIN d_koulutusluokitus d3 on d3.id = koulutusluokitus_isa_id
	  JOIN d_koulutuslaji d4 on d4.id = koulutuslaji_id
	  JOIN d_sukupuoli d5 on d5.id = sukupuoli_id
	  JOIN d_opetushallinnon_koulutus d6 on d6.id = opetushallinnon_koulutus2_id
	  JOIN d_aidinkieli_versio1 d7 on d7.id = aidinkieli_versio1x_id
	  JOIN d_kausi d8 on d8.kausi_id = syntymavuosi_id
	  JOIN d_kieli d9 on d9.id = koulutuksen_kieli_id
	  JOIN d_alueluokitus d10 on d10.id = koulutuksen_maakunta_id
	  JOIN d_alueluokitus d11 on d11.id = kotikunta_id
	  JOIN d_alueluokitus d12 on d12.id = kotikunta1x_id
	  JOIN d_tulodesiili d13 on d13.id = tulodesiili_aiti_id
	  JOIN d_tulodesiili d14 on d14.id = tulodesiili_isa_id
	  JOIN d_sosioekonominen_asema d15 on d15.id = sosioekonominen_asema_1_aiti_id
	  JOIN d_sosioekonominen_asema d16 on d16.id = sosioekonominen_asema_2_aiti_id
	  JOIN d_sosioekonominen_asema d17 on d17.id = sosioekonominen_asema_1_isa_id
	  JOIN d_sosioekonominen_asema d18 on d18.id = sosioekonominen_asema_2_isa_id
	  JOIN d_ika d19 on d19.id = ika_1v_id
	  --JOIN d_ika d20 on d20.id = ika_5v_id
	  JOIN d_opiskelijan_olo d21 on d21.id = opiskelijan_olo_syys_id
	  JOIN d_kausi d22 on d22.kausi_id = kirjoihintulovuosi_id





' 
GO
/****** Object:  View [dbo].[v_f_tab_tieteen_ja_teknologian_henkilovoimavarat_K5_5]    Script Date: 21.6.2017 10:17:26 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_tieteen_ja_teknologian_henkilovoimavarat_K5_5]'))
EXEC dbo.sp_executesql @statement = N'







CREATE VIEW [dbo].[v_f_tab_tieteen_ja_teknologian_henkilovoimavarat_K5_5] AS

-- Select * from VipunenTK..v_f_tab_tieteen_ja_teknologian_henkilovoimavarat_K5_5

SELECT --top 100000 --testausta
	  --Mittarit
       [lkm]

	  --Aika
	  ,[Tilastovuosi]
	  ,''Tutkinnon suorittamisesta kulunut aika'' = d14.koulutuksesta_kulunut_aika
	  ,''Tutkinnon suorittamisesta kulunut aika 5v'' = d14.koulutuksesta_kulunut_aika_5v
	  ,''Tutkinnon suorittamisesta kulunut aika TTHV'' = d14.koulutuksesta_kulunut_aika_tthv

	  --Henkilö
	  ,d3.sukupuoli AS ''Sukupuoli''
	  ,d4.ika AS ''Ikäryhmä''
	  ,d1.maa AS ''Syntymävaltio''
	  ,d1.maanosa AS ''Syntymävaltio (maanosa)''
	  ,''Syntymävaltio (Suomi maanosa)'' = Cast(
		Case when d1.maa_koodi=''246'' then d1.maa --Suomi 
			 when d1.maanosa = ''Muut'' then ''Tuntematon''
			 else d1.maanosa end as nvarchar(50))
	  ,d2.maa AS ''Kansalaisuus (maa)''
	  ,d2.maanosa AS ''Kansalaisuus (maanosa)''
	  ,''Kansalaisuus (Suomi maanosa)'' = Cast(
		Case when d2.maa_koodi=''246'' then d2.maa --Suomi 
			 when d2.maanosa = ''Muut'' then ''Tuntematon''
			 else d2.maanosa end as nvarchar(50))
	  ,d2.etamaa AS ''ETA-maan kansalainen''
	  ,d2.eumaa AS ''EU-maan kansalainen''
	  ,d5.maakunta AS ''Asuinmaakunta''
	  ,''Ammattiluokitus taso 1'' = d8.ammattiluokitus_2010_paataso
	  ,''Ammattiluokitus taso 2'' = d8.ammattiluokitus_2010_2_taso
	  ,''Ammattiluokitus taso 3'' = d8.ammattiluokitus_2010_3_taso
	  ,''Ammattiluokitus2001 taso1'' = d8_2001_1.ammattiluokitus_2001
	  ,''Ammattiluokitus2001 taso2'' = d8_2001_2.ammattiluokitus_2001
	  ,''Pääasiallinen toiminta'' = d15.paaasiallinen_toiminta_versio3
	  ,''Pääasiallinen toiminta TTHV'' = d15.paaasiallinen_toiminta_versio3_TTHV

	  --Koulutus
      ,d6.koulutus AS ''Koulutusnimike''
	  ,d6.opintoala2002 AS ''Opintoala (02 luokitus)''
	  ,d6.opintoala1995 AS ''Koulutusala (95 luok.)''
	  ,d6.koulutusala2002 AS ''Koulutusala (02 luok.)''
	  ,''Koulutusala, taso 1'' = d6.iscfibroad2013
	  ,''Koulutusala, taso 2'' = d6.iscfinarrow2013
	  ,''Koulutusala, taso 3'' = d6.iscfi2013
	  ,''Koulutusaste, taso 1'' = d6.iscle2011
	  ,''Koulutusaste, taso 2'' = d6.Koulutusaste_taso2
      ,[tutkinnon_suoritusvuosi] AS ''Tutkinnon suoritusvuosi''
	  ,''OKM ohjauksen ala'' = d6.OKM_ohjauksen_ala
	  ,d7.maakunta AS ''Tutkinnon suoritusmaakunta''

	  --Tieteenala
	  ,''Tieteenala TTHV'' = d13.tieteenala2010
	  ,''Päätieteenala TTHV'' = d13.paatieteenala2010

	  --Työnantaja
	  ,d9.maakunta AS ''Työpaikan sijaintimaakunta''
	  ,d10.toimiala_tthv AS ''Toimialaluokitus TTHV, taso 2''
	  ,d20.toimiala_tthv AS ''Toimialaluokitus TTHV, taso 2 edellinen vuosi''
	  ,d10.paatoimiala_tthv AS ''Toimialaluokitus TTHV, taso 1''
	  ,d20.paatoimiala_tthv AS ''Toimialaluokitus TTHV, taso 1 edellinen vuosi''
	  ,d22.toimiala_tthv1_sama_kuin_ed_vuonna AS ''Muuttunut toimiala TTHV 1''
	  ,d23.toimiala_tthv2_sama_kuin_ed_vuonna AS ''Muuttunut toimiala TTHV 2''
	  ,d11.tyonantajasektori2 AS ''Työnantajasektori''
	  ,d17.tyonantajasektori2 AS ''Työnantajasektori edellinen vuosi''
	  ,d18.tyonantajasektori2 AS ''Työnantajasektori TTHV''
	  ,d19.tyonantajasektori2 AS ''Työnantajasektori TTHV edellinen vuosi''
	  ,d21.tyonantajasektori_sama_kuin_ed_vuonna AS ''Muuttunut työnantajasektori''
      ,d12.asuinmaakunta_sama_kuin_tyopaikan AS ''Asuimaakunta sama vai eri kuin työpaikan sijaintimaakunta''
	  ,d16.yrityksen_koko AS ''Yrityksen koko''
	  ,d24.kylla_ei AS ''Työnantaja vaihtunut''

	  --Ruotsi
	  ,''Statistikår'' = [Tilastovuosi]
	  ,''Tid som förflutit sedan examen avlagts'' = d14.koulutuksesta_kulunut_aika_SV
	  ,''Tid som förflutit sedan examen avlagts 5år'' = d14.koulutuksesta_kulunut_aika_5v_SV
	  ,''Tid som förflutit sedan examen avlagts TTHV'' = d14.koulutuksesta_kulunut_aika_tthv_SV
	  ,d3.sukupuoli_SV AS ''Kön''
	  ,d4.ika_SV AS ''Åldersgrupp''
	  ,d1.maa_SV AS ''Födelseland''
	  ,d1.maanosa_SV AS ''Födelseland (världsdel)''
	  ,''Födelseland (Finland världsdel)'' = Cast(
		Case when d1.maa_koodi=''246'' then d1.maa_SV --Suomi 
			 else d1.maanosa_SV end as nvarchar(50))
	  ,d2.maa_SV AS ''Medborgarskap (land)''
	  ,d2.maanosa_SV AS ''Medborgarskap (världsdel)''
	  ,''Medborgarskap (Finland världsdel)'' = Cast(
		Case when d2.maa_koodi=''246'' then d2.maa_SV --Suomi 
			 when d2.maanosa_SV = ''Övrig'' then ''Information saknas''
			 else d2.maanosa_SV end as nvarchar(50))
	  ,d2.etamaa_SV AS ''Medborgare i ett EES-land''
	  ,d2.eumaa_SV AS ''Medborgare i ett EU-land''
	  ,d5.maakunta_SV AS ''Bostadslandskap''
	  --,d8.ammattiluokitus_2010_paataso_SV as ''Yrkesgrupp 1''
	  --,d8.ammattiluokitus_2010_2_taso_SV as ''Yrkesgrupp 2''
	  --,d8.ammattiluokitus_2010_3_taso_SV as ''Yrkesgrupp 3''
	  ,''Yrkesgrupp 1'' = case when f.tilastovuosi >= ''2011'' then d8.ammattiluokitus_2010_paataso_SV else coalesce(d8_2001_1.ammattiluokitus_2001_SV, d8_2001_tuntematon.ammattiluokitus_2001_SV) end
	  ,''Yrkesgrupp 2'' = case when f.tilastovuosi >= ''2011'' then d8.ammattiluokitus_2010_2_taso_SV else coalesce(d8_2001_2.ammattiluokitus_2001_SV, d8_2001_tuntematon.ammattiluokitus_2001_SV) end
	  ,''Yrkesgrupp 3'' = case when f.tilastovuosi >= ''2011'' then d8.ammattiluokitus_2010_3_taso_SV else coalesce(d8_2001_3.ammattiluokitus_2001_SV, d8_2001_tuntematon.ammattiluokitus_2001_SV) end
	  ,''Huvudsaklig verksamhet'' = d15.paaasiallinen_toiminta_versio3_SV
	  ,''Huvudsaklig verksamhet TTHV'' = d15.paaasiallinen_toiminta_versio3_TTHV_SV
      ,d6.koulutus_SV AS ''Utbildningsbenämning''
	  ,d6.opintoala2002_SV AS ''Studieområde (2002)''
	  ,d6.opintoala1995_SV AS ''Utbildningsområde (1995)''
	  ,d6.koulutusala2002_SV AS ''Utbildningsområde (2002)''
	  ,''Utbildn.område, nivå 1'' = d6.iscfibroad2013_SV
	  ,''Utbildn.område, nivå 2'' = d6.iscfinarrow2013_SV
	  ,''Utbildn.område, nivå 3'' = d6.iscfi2013_SV
	  ,''Utbildn.nivå, nivå 1'' = d6.iscle2011_SV
	  ,''Utbildn.nivå, nivå 2'' = d6.Koulutusaste_taso2_SV
	  ,''SV OKM ohjauksen ala'' = d6.OKM_ohjauksen_ala_SV
      ,[tutkinnon_suoritusvuosi] AS ''År då utbildningen avlagts''
	  ,d7.maakunta_SV AS ''Landskap där examen avlagts''
	  ,''Vetenskapsgren (2010)'' = d13.tieteenala2010_SV
	  ,''Huvudvetenskapsgren (2010)'' = d13.paatieteenala2010_SV
	  ,d9.maakunta_SV AS ''Arbetsplatsens landskap''
	  ,d10.toimiala_tthv_SV AS ''Bransch TTHV, nivå 2''
	  ,d10.paatoimiala_tthv_SV AS ''Bransch TTHV, nivå 1''
	  ,d11.tyonantajasektori2_SV AS ''Arbetsgivarens sektor''
      ,d12.asuinmaakunta_sama_kuin_tyopaikan_SV AS ''SV Asuimaakunta sama vai eri kuin työpaikan sijaintimaakunta''

	  --Englanti
	  ,''Statistical year '' = [Tilastovuosi]
	  ,''Time since attaining the qualification'' = d14.koulutuksesta_kulunut_aika_EN
	  ,''Time since attaining the qualification 5yr'' = d14.koulutuksesta_kulunut_aika_5v_EN
	  ,''Time since attaining the qualification TTHV'' = d14.koulutuksesta_kulunut_aika_tthv_EN
	  ,d3.sukupuoli_EN AS ''Gender''
	  ,d4.ika_EN AS ''Age group''
	  ,d1.maa_EN AS ''Country of birth''
	  ,d1.maanosa_EN AS ''Country of birth (continent)''
	  ,''Country of birth (Finland continent)'' = Cast(
		Case when d1.maa_koodi=''246'' then d1.maa_EN --Suomi 
			 else d1.maanosa_EN end as nvarchar(50))
	  ,d2.maa_EN AS ''Nationality (country)''
	  ,d2.maanosa_EN AS ''Nationality (continent)''
	  ,''Nationality (Finland continent)'' = Cast(
		Case when d2.maa_koodi=''246'' then d2.maa_EN --Suomi 
			 when d2.maanosa_EN = ''Other'' then ''Missing data''
			 else d2.maanosa_EN end as nvarchar(50))
	  ,d2.etamaa_EN AS ''Citizen of EEA nation''
	  ,d2.eumaa_EN AS ''Citizen of EU nation''
	  ,d5.maakunta_EN AS ''Region of residence ''
	  --,d8.ammattiluokitus_2010_paataso_EN as ''Profession group 1''
	  --,d8.ammattiluokitus_2010_2_taso_EN as ''Profession group 2''
	  --,d8.ammattiluokitus_2010_3_taso_EN as ''Profession group 3''
	  ,''Profession group 1'' = case when f.tilastovuosi >= ''2011'' then d8.ammattiluokitus_2010_paataso_EN else coalesce(d8_2001_1.ammattiluokitus_2001_EN, d8_2001_tuntematon.ammattiluokitus_2001_EN) end
	  ,''Profession group 2'' = case when f.tilastovuosi >= ''2011'' then d8.ammattiluokitus_2010_2_taso_EN else coalesce(d8_2001_2.ammattiluokitus_2001_EN, d8_2001_tuntematon.ammattiluokitus_2001_EN) end
	  ,''Profession group 3'' = case when f.tilastovuosi >= ''2011'' then d8.ammattiluokitus_2010_3_taso_EN else coalesce(d8_2001_3.ammattiluokitus_2001_EN, d8_2001_tuntematon.ammattiluokitus_2001_EN) end
	  ,''Main type of activity'' = d15.paaasiallinen_toiminta_versio3_EN
	  ,''Main type of activity TTHV'' = d15.paaasiallinen_toiminta_versio3_TTHV_EN
      ,d6.koulutus_EN AS ''Name of education''
	  ,d6.opintoala2002_EN AS ''Subfield of education (2002)''
	  ,d6.opintoala1995_EN AS ''Field of education (1995)''
	  ,d6.koulutusala2002_EN AS ''Field of education (2002)''
	  ,''Field of ed. tier 1'' = d6.iscfibroad2013_EN
	  ,''Field of ed. tier 2'' = d6.iscfinarrow2013_EN
	  ,''Field of ed. tier 3'' = d6.iscfi2013_EN
	  ,''Level of ed. tier 1'' = d6.iscle2011_EN
	  ,''Level of ed. tier 2'' = d6.Koulutusaste_taso2_EN
  	  ,''EN OKM ohjauksen ala'' = d6.OKM_ohjauksen_ala_EN
      ,[tutkinnon_suoritusvuosi] AS ''Graduation year''
	  ,d7.maakunta_EN AS ''Region of degree/qualification''
	  ,''Discipline (2010)'' = d13.tieteenala2010_EN
	  ,''Main discipline (2010)'' = d13.paatieteenala2010_EN
	  ,d9.maakunta_EN AS ''Region where the job is located''
	  ,d10.toimiala_tthv_EN AS ''Industry TTHV, level 2''
	  ,d10.paatoimiala_tthv_EN AS ''Industry TTHV, level 1''
	  ,d11.tyonantajasektori2_EN AS ''Employer sector''
      ,d12.asuinmaakunta_sama_kuin_tyopaikan_EN AS ''EN Asuimaakunta sama vai eri kuin työpaikan sijaintimaakunta''

	  --Koodit
	  ,[Koodit Syntymävaltio] = d1.maa_koodi
	  ,[Koodit Kansalaisuus (maa)] = d2.maa_koodi
	  ,[Koodit Asuinmaakunta] = d5.maakunta_koodi
	  --,[Koodit Ammattiluokitus taso 1] = d8.ammattiluokitus_2010_paataso_koodi
	  --,[Koodit Ammattiluokitus taso 2] = d8.ammattiluokitus_2010_2_taso_koodi
	  --,[Koodit Ammattiluokitus taso 3] = d8.ammattiluokitus_2010_3_taso_koodi
	  ,''Koodit Ammattiluokitus taso 1'' = case when f.tilastovuosi >= ''2011'' then d8.ammattiluokitus_2010_paataso_koodi else coalesce(d8_2001_1.ammattiluokitus_2001_koodi, d8_2001_tuntematon.ammattiluokitus_2001_koodi) end
	  ,''Koodit Ammattiluokitus taso 2'' = case when f.tilastovuosi >= ''2011'' then d8.ammattiluokitus_2010_2_taso_koodi else coalesce(d8_2001_2.ammattiluokitus_2001_koodi, d8_2001_tuntematon.ammattiluokitus_2001_koodi) end
	  ,''Koodit Ammattiluokitus taso 3'' = case when f.tilastovuosi >= ''2011'' then d8.ammattiluokitus_2010_3_taso_koodi else coalesce(d8_2001_3.ammattiluokitus_2001_koodi, d8_2001_tuntematon.ammattiluokitus_2001_koodi) end
	  ,[Koodit Pääasiallinen toiminta] = d15.paaasiallinen_toiminta_versio3_avain
	  ,[Koodit Koulutuskoodi] = d6.koulutus_koodi
	  ,[Koodit Opintoala (02 luokitus)] = d6.opintoala2002_koodi
	  ,[Koodit Koulutusala (95 luokitus)] = d6.opintoala1995_koodi
	  ,[Koodit Koulutusala (02 luokitus)] = d6.koulutusala2002_koodi
	  ,[Koodit Koulutusala taso 1] = d6.iscfibroad2013_koodi
	  ,[Koodit Koulutusala taso 2] = d6.iscfinarrow2013_koodi
	  ,[Koodit Koulutusala taso 3] = d6.iscfi2013_koodi
	  ,[Koodit Koulutusaste taso 1] = d6.iscle2011_koodi
	  ,[Koodit Koulutusaste taso 2] = d6.Koulutusaste_taso2_koodi
	  ,[Koodit OKM ohjauksen ala] = d6.OKM_ohjauksen_ala_koodi
	  ,[Koodit Tutkinnon suoritusmaakunta] = d7.maakunta_koodi
	  ,[Koodit Tieteenala TTHV] = d13.tieteenala_avain
	  ,[Koodit Työpaikan maakunta] = d9.maakunta_koodi
	  ,[Koodit Työnantajasektori] = d11.tyonantajasektori2_avain
	  
	  --Järjestys
	  ,jarj_syntymamaa = d1.jarjestys
	  ,jarj_syntymamaanosa = d1.jarjestys_maanosa 
	  ,jarj_syntyma_suomimaanosa = Cast(
		Case when d1.maa_koodi=''246'' then 0 --Suomi 
			 else d1.jarjestys_maanosa end as smallint)
	  ,jarj_kansalaisuus_maa = d2.jarjestys
	  ,jarj_kansalaisuus_maanosa = d2.jarjestys_maanosa
	  ,jarj_kansalaisuus_suomimaanosa = Cast(
		Case when d2.maa_koodi=''246'' then 0 --Suomi 
			 else d2.jarjestys_maanosa end as smallint)
	  ,jarj_kansalaisuus_ETA = d2.jarjestys_etamaa
	  ,jarj_kansalaisuus_EU = d2.jarjestys_eumaa
	  ,jarj_sukupuoli = d3.jarjestys
	  ,jarj_ika = d4.jarjestys_ika
	  ,jarj_asuinmaakunta = d5.jarjestys_maakunta
	  ,jarj_koulutus = d6.jarjestys
	  ,jarj_koulutus_SV = Cast(Case when d6.id = -1 then ''ööö1'' when d6.id = -2 then ''ööö2'' else left(d6.koulutus_SV,10) end as nvarchar(10))
	  ,jarj_koulutus_EN = Cast(Case when d6.id = -1 then ''ööö1'' when d6.id = -2 then ''ööö2'' else left(d6.koulutus_EN,10) end as nvarchar(10))
	  ,jarj_opintoala2002 = d6.jarjestys_opintoala2002
	  ,jarj_koulutusala1995 = d6.jarjestys_opintoala1995
	  ,jarj_koulutusala2002 = d6.jarjestys_koulutusala2002
	  ,jarj_Koulutusala_taso1 = d6.jarjestys_iscfibroad2013
	  ,jarj_Koulutusala_taso2 = d6.jarjestys_iscfinarrow2013
	  ,jarj_Koulutusala_taso3 = d6.jarjestys_iscfi2013
	  ,jarj_Koulutusaste_taso1 = d6.jarjestys_iscle2011
	  ,jarj_Koulutusaste_taso2 = d6.jarjestys_koulutusaste_taso2
	  ,jarj_okm_ohjauksen_ala = d6.jarjestys_OKM_ohjauksen_ala
 	  ,jarj_tieteenala_tthv = d13.jarjestys_tieteenala2010
	  ,jarj_paatieteenala_tthv = d13.jarjestys_paatieteenala2010
	  ,jarj_tutk_maakunta = d7.jarjestys_maakunta
	  --,jarj_ammattiluokitustaso1 = d8.[jarjestys_ammattiluokitus_2010_paataso]
	  --,jarj_ammattiluokitustaso2 = d8.[jarjestys_ammattiluokitus_2010_taso2]
	  --,jarj_ammattiluokitustaso3 = d8.[jarjestys_ammattiluokitus_2010_taso3]
	  ,jarj_ammattiluokitustaso1 = case when f.tilastovuosi >= ''2011'' then d8.jarjestys_ammattiluokitus_2010_paataso else coalesce(d8_2001_1.jarjestys, d8_2001_tuntematon.jarjestys) end
	  ,jarj_ammattiluokitustaso2 = case when f.tilastovuosi >= ''2011'' then d8.jarjestys_ammattiluokitus_2010_taso2 else coalesce(d8_2001_2.jarjestys, d8_2001_tuntematon.jarjestys) end
	  ,jarj_ammattiluokitustaso3 = case when f.tilastovuosi >= ''2011'' then d8.jarjestys_ammattiluokitus_2010_taso3 else coalesce(d8_2001_3.jarjestys, d8_2001_tuntematon.jarjestys) end
	  ,jarj_paaasiallinen_toiminta_versio3 = d15.[jarjestys_paaasiallinen_toiminta_versio3]
	  ,jarj_paaasiallinen_toiminta_versio3_TTHV = d15.[jarjestys_paaasiallinen_toiminta_versio3_TTHV]
	  ,jarj_tyopaikan_maakunta = d9.jarjestys_maakunta
	  ,jarj_toimiala_tthv = d10.jarjestys_toimiala_tthv
	  ,jarj_paatoimiala_tthv = d10.jarjestys_paatoimiala_tthv
	  ,jarj_tyonantajasektori = d11.jarjestys
	  ,jarj_asuinmaak_sama = d12.jarjestys
	  ,jarj_koulutuksesta_kulunut_aika_1v = d14.jarjestys
	  ,jarj_koulutuksesta_kulunut_aika_5v = d14.jarjestys_5v
	  ,jarj_koulutuksesta_kulunut_aika_tthv = d14.jarjestys_tthv
	  ,d20.toimiala_tthv AS ''jarj Toimialaluokitus TTHV, taso 2 edellinen vuosi''
	  ,d20.paatoimiala_tthv AS ''jarj Toimialaluokitus TTHV, taso 1 edellinen vuosi''
	  ,d22.jarjestys AS ''jarj Muuttunut toimiala TTHV 1''
	  ,d23.jarjestys AS ''jarj Muuttunut toimiala TTHV 2''
	  ,d17.jarjestys AS ''jarj Työnantajasektori edellinen vuosi''
	  ,d18.jarjestys AS ''jarj Työnantajasektori TTHV''
	  ,d19.jarjestys AS ''jarj Työnantajasektori TTHV edellinen vuosi''
	  ,d21.jarjestys AS ''jarj Muuttunut työnantajasektori''
	  ,d16.jarjestys AS ''jarj Yrityksen koko''
	  ,d24.jarjestys AS ''jarj Työnantaja vaihtunut''

	  --Muuta
	  ,''Ikä 25-64v'' = case when d4.[ika_avain] in (''ikar5_2'', ''ikar5_3'', ''ikar5_4'', ''ikar5_5'') then ''K'' else ''E'' end


  FROM [VipunenTK].[dbo].[f_K5_5_Tieteen_ja_teknologian_henkilovoimavarat] f
  inner join [VipunenTK].[dbo].d_valtio d1 on d1.id = f.syntymamaa_id
  inner join [VipunenTK].[dbo].d_valtio d2 on d2.id = f.kansalaisuus_valtio_id
  inner join [VipunenTK].[dbo].d_sukupuoli d3 on d3.id = f.sukupuoli_id
  inner join [VipunenTK].[dbo].d_ika d4 on d4.id = f.ika_id
  inner join [VipunenTK].[dbo].d_alueluokitus d5 on d5.id = f.asuinmaakunta_id
  inner join [VipunenTK].[dbo].d_koulutusluokitus d6 on d6.id = f.koulutusluokitus_id
  inner join [VipunenTK].[dbo].d_alueluokitus d7 on d7.id = f.tutkinnon_suoritusmaakunta_id
  inner join [VipunenTK].[dbo].d_ammattiluokitus_2001 d8_2001_3 on d8_2001_3.id = f.ammattiluokitus_2001_id
  left join [VipunenTK].[dbo].d_ammattiluokitus_2001 d8_2001_2 on d8_2001_2.ammattiluokitus_2001_avain = left(d8_2001_3.ammattiluokitus_2001_avain,2) and d8_2001_2.taso = 2
  left join [VipunenTK].[dbo].d_ammattiluokitus_2001 d8_2001_1 on d8_2001_1.ammattiluokitus_2001_avain = left(d8_2001_3.ammattiluokitus_2001_avain,1) and d8_2001_1.taso = 1
  left join [VipunenTK].[dbo].d_ammattiluokitus_2001 d8_2001_tuntematon on d8_2001_tuntematon.ammattiluokitus_2001_avain = ''-1''
  inner join [VipunenTK].[dbo].d_ammattiluokitus_2010 d8 on d8.id = f.ammattiluokitus_2010_id
  inner join [VipunenTK].[dbo].d_alueluokitus d9 on d9.id = f.tyopaikan_sijaintimaakunta_id
  inner join [VipunenTK].[dbo].d_toimiala_tthv d10 on d10.id = f.toimialaluokitus_tthv_id
  inner join [VipunenTK].[dbo].d_tyonantajasektori2 d11 on d11.id = f.tyonantajasektori2_id
  inner join [VipunenTK].[dbo].d_asuinmaakunta_sama_kuin_tyopaikan d12 on d12.id = f.asuinmaakunta_sama_kuin_tyopaikan_sijaintikunta_id
  inner join [VipunenTK].[dbo].d_tieteenala d13 on d13.id = f.tieteenala_id
  inner join [VipunenTK].[dbo].d_koulutuksesta_kulunut_aika d14 on d14.id = f.tutkinnosta_kulunut_aika_id
  inner join [VipunenTK].[dbo].d_paaasiallinen_toiminta_versio3 d15 on d15.id = f.paaasiallinen_toiminta_versio3_id
  inner join VipunenTK.dbo.d_yrityksen_koko_tthv d16 on d16.id=f.yrityksen_koko_id
  inner join VipunenTK.dbo.d_tyonantajasektori2 d17 on d17.id=f.tyonantajasektori2_ed_id
  inner join VipunenTK.dbo.d_tyonantajasektori2 d18 on d18.id=f.tyonantajasektori2_tthv_id
  inner join VipunenTK.dbo.d_tyonantajasektori2 d19 on d19.id=f.tyonantajasektori2_ed_tthv_id
  inner join VipunenTK.dbo.d_toimiala_tthv d20 on d20.id=f.toimialaluokitus_ed_tthv_id
  inner join VipunenTK.dbo.d_tyonantajasektori_sama_kuin_ed_vuonna d21 on d21.id=f.tyoantajasektori_sama_kuin_ed_vuonna_id
  inner join VipunenTK.dbo.d_toimiala_tthv1_sama_kuin_ed_vuonna d22 on d22.id=f.toimiala_tthv1_sama_kuin_ed_vuonna_id
  inner join VipunenTK.dbo.d_toimiala_tthv2_sama_kuin_ed_vuonna d23 on d23.id=f.toimiala_tthv2_sama_kuin_ed_vuonna_id
  inner join VipunenTK.dbo.d_kylla_ei d24 on d24.id = f.tyonantaja_vaihtunut_id

--Testausta
--WHERE [paaasiallinen_toiminta_versio3_id] > -1









' 
GO
/****** Object:  View [dbo].[v_f_tab_toisen_asteen_aikaisempi_koulutus_ammatillinen]    Script Date: 21.6.2017 10:17:26 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_toisen_asteen_aikaisempi_koulutus_ammatillinen]'))
EXEC dbo.sp_executesql @statement = N'







CREATE VIEW [dbo].[v_f_tab_toisen_asteen_aikaisempi_koulutus_ammatillinen] AS

Select [Opisk2] = lukumaara,
[Aloitt2] = coalesce(aloittaneet,0)
,[Tilastovuosi] AS Tilastovuosi
,d2.aidinkieli_versio1 AS Äidinkieli
,d3.avi AS "Asuinalueen AVI"
,d3.ely AS "Asuinalueen ELY"
,d3.kielisuhde AS "Asuinkunnan kielisuhde"
,d3.maakunta AS Asuinmaakunta
,d3.kunta AS Asuinkunta
,d4.sukupuoli AS Sukupuoli
,d5.ika AS Ikä
,d51.ika AS "Ikä 15-64"
,d51.ika5v AS "Ikäryhmä 15-64"
,d6.ika5v AS Ikäryhmä
,d7.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus AS Järjestämistapa
,d8.nuorten_aikuisten_koulutus AS "Nuorten/aikuisten"
,d9.nuorten_aikuisten_koulutus_amm AS "Nuoret/aikuiset"
,d10.lahde AS Lähde
,d11.opetushallinnon_koulutus AS Hallinnonala
,d12.opiskelijan_olo AS Kirjoillaolo
,d13.rahoituslahde_amm AS Rahoituslähde
,d14.oppilaitostyyppi AS Oppilaitostyyppi
,d15a.opintoala2002 AS "Pohjakoul. opintoala (ammpk)"
,d15b.koulutusala2002 AS "Pohjakoul. koulutusala (ammpk)"
,d15c.koulutusaste2002 AS "Pohjakoul. koulutusaste (ammpk)"
,d15d.opintoala2002 AS "Pohjakoul. opintoala (ammlisä)"
,d15e.koulutusala2002 AS "Pohjakoul. koulutusala (ammlisä)"
,d15f.koulutusaste2002 AS "Pohjakoul. koulutusaste (ammlisä)"
,d15g.opintoala1995 AS "Pohjakoul. koul.ala (95 luokitus) (alempi kk)"
,d15h.koulutusala1995 AS "Pohjakoul. koulutusala95 (alempi kk)"
,d15i.opintoala2002 AS "Pohjakoul. opintoala (alempi kk)"
,d15j.koulutusala2002 AS "Pohjakoul. koul.ala (02 luokitus) (alempi kk)"
,d15k.koulutusaste2002 AS "Pohjakoul. koulutusaste (alempi kk)"
,d15l.opintoala1995 AS "Pohjakoul. koul.ala (95 luokitus) (ylempi kk)"
,d15m.koulutusala1995 AS "Pohjakoul. koulutusala95 (ylempi kk)"
,d15n.opintoala2002 AS "Pohjakoul. opintoala (ylempi kk)"
,d15o.koulutusala2002 AS "Pohjakoul. koul.ala (02 luokitus) (ylempi kk)"
,d15p.koulutusaste2002 AS "Pohjakoul. koulutusaste (ylempi kk)"
,d16a.vuosiselite AS "Pohjakoul. suoritusvuosi (ammlisä)"
,d16b.vuosiselite AS "Pohjakoul. suoritusvuosi (ylempi kk)"
,d16c.vuosiselite AS "Pohjakoul. suoritusvuosi (alempi kk)"
,d16d.vuosiselite AS "Pohjakoul. suoritusvuosi"
,d16e.vuosiselite AS "Pohjakoul. suoritusvuosi (ammpk)"
,d17a.koulutuksesta_kulunut_aika AS "Pohjakoulutuksesta kulunut aika (ammpk)"
,d17b.koulutuksesta_kulunut_aika AS "Pohjakoulutuksesta kulunut aika (ammlisä)"
,d17c.koulutuksesta_kulunut_aika AS "Pohjakoulutuksesta kulunut aika (alempi kk)"
,d17d.koulutuksesta_kulunut_aika AS "Pohjakoulutuksesta kulunut aika (ylempi kk)"
,d17e.koulutuksesta_kulunut_aika AS "Pohjakoulutuksesta kulunut aika"
,d18.ammatillisen_koulutuksen_koulutuslaji AS "Tutkintotyyppi"
,d19.opiskelijan_aikaisempi_yleissivistava_koulutus "Opiskelijan aikaisempi yleissivistävä koulutus"
,d20.koulutuksen_jarjestamismuoto as Järjestämismuoto
,d21.koulutusaste2002 as Koulutusaste
,d21.koulutusala2002 as Koulutusala
,d21.opintoala1995 as "Koulutusala (95 luokitus)"
,d21.opintoala2002 as Opintoala
,d21.koulutus as Koulutusnimike
,d22.avi as "Koulutuksen AVI"
,d22.ely as "Koulutuksen ELY"
,d22.maakunta as "Koulutuksen maakunta"
,d22.kielisuhde as "Koulutuksen kunnan kielisuhde"
,d22.kunta as "Koulutuksen kunta"
,d23.vuosiselite as "Kirjoihintulovuosi"
,d24.lukukausiselite as "Kirjoihintulolukukausi"
,d25.aikaisempi_korkein_tutkinto as "Aikaisempi korkein tutkinto"
,d26.vuosiselite as "Viim. tutk. suoritusvuosi"
,d27.koulutuksesta_kulunut_aika as "Viim. tutk. kulunut aika"
,[aikaisempi_ammpk_tarkempi] as "Aikaisempi amm. peruskoulutus"
,[ammpk_pohjakoulutuksen_tila] as "Aik. amm. peruskoul. tila"
,[aikaisempi_ammpk_nayttotutkintona_tarkempi] as "Aik. amm. pk. näyttötutkintoon johtavana koulutuksena"
,[aikaisempi_ammpk_oppisopimuskoulutuksena_tarkempi] as "Aik. amm. pk. oppisopimuskoulutuksena"
,[aikaisempi_ammlisa_tarkempi] as "Aikaisempi amm. lisäkoulutus"
,[ammlisa_pohjakoulutuksen_tila] as "Aik. amm. lisäkoul. tila"
,[aikaisempi_ammlisa_oppisopimuskoulutuksena_tarkempi] as "Aik. amm. lisäkoul. oppisopimuskoulutuksena"
,[aikaisempi_alempi_kk_tarkempi] as "Aikaisempi alemman kk-asteen koulutus"
,[alempi_kk_pohjakoulutuksen_tila] as "Aik. alempi kk tila"
,[aikaisempi_ylempi_kk_tarkempi] as "Aikaisempi ylemmmän kk-asteen koulutus"
,[ylempi_kk_pohjakoulutuksen_tila] as "Aik. ylempi kk tila"
,[aiemman_tutkinnon_ammpk_opintoala_sama] as "Pohjakoul. op.ala sama (ammpk)"
,[aiemman_tutkinnon_ammpk_koulutusala_sama] as "Pohjakoul. koul.ala sama (ammpk)"
,[aiemman_tutkinnon_ammpk_koulutusaste_sama] as "Pohjakoul. koul.aste sama (ammpk)"
,[aiemman_tutkinnon_ammlisa_opintoala_sama] as "Pohjakoul. op.ala sama (ammlisä)"
,[aiemman_tutkinnon_ammlisa_koulutusala_sama] as "Pohjakoul. koul.ala sama (ammlisä)"
,[aiemman_tutkinnon_ammlisa_koulutusaste_sama] as "Pohjakoul. koul.aste sama (ammlisä)"
,[aiemman_tutkinnon_alempi_kk_opintoala_sama] as "Pohjakoul. op.ala sama (alempi kk)"
,[aiemman_tutkinnon_alempi_kk_koulutusala_sama] as "Pohjakoul. koul.ala sama (alempi kk)"
,[aiemman_tutkinnon_alempi_kk_koulutusaste_sama] as "Pohjakoul. koul.aste sama (alempi kk)"
,[aiemman_tutkinnon_ylempi_kk_opintoala_sama] as "Pohjakoul. op.ala sama (ylempi kk)"
,[aiemman_tutkinnon_ylempi_kk_koulutusala_sama] as "Pohjakoul. koul.ala sama (ylempi kk)"
,[aiemman_tutkinnon_ylempi_kk_koulutusaste_sama] as "Pohjakoul. koul.aste sama (ylempi kk)"
,[aiemman_tutkinnon_opintoala2002_sama] as "Pohjakoul. op.ala sama"
,[aiemman_tutkinnon_koulutusaste2002_sama] as "Pohjakoul. koul.ala sama"
,[aiemman_tutkinnon_koulutusala2002_sama] as "Pohjakoul. koul.aste sama"
,d2.jarjestys AS jarj_aidinkieli
,d3.jarjestys_avi AS jarj_as_avi
,d3.jarjestys_ely AS jarj_as_ely
,d3.jarjestys_kielisuhde AS jarj_as_kielisuhde
,d3.jarjestys_maakunta AS jarj_as_maakunta
,d3.jarjestys AS jarj_as_kunta
,d5.jarjestys_ika
,d51.jarjestys_ika AS jarj1564_1v
,d51.jarjestys_ika5v AS jarj1564_5v
,d6.jarjestys_ika5v
,d7.jarjestys AS jarj_jarjtapa
,d8.jarjestys AS jarj_nuoraik
,d9.jarjestys AS jarj_nuoraikamm
,d9.nuorten_aikuisten_koulutus_amm_koodi AS nuoraik_koodi
,d10.lahde_koodi
,d11.jarjestys AS jarj_ophal
,d12.jarjestys AS jarj_kirjolo
,d13.jarjestys AS jarj_rahoitus
,d14.jarjestys_oppilaitostyyppi
,d15a.jarjestys_opintoala2002 AS jarj_ammpk_opala
,d15b.jarjestys_koulutusala2002 AS jarj_ammpk_koulala
,d15c.jarjestys_koulutusaste2002 AS jarj_ammpk_koulaste
,d15d.jarjestys_opintoala2002 AS jarj_ammlisa_opala
,d15e.jarjestys_koulutusala2002 AS jarj_ammlisa_koulala
,d15f.jarjestys_koulutusaste2002 AS jarj_ammlisa_koulaste
,d15g.jarjestys_opintoala1995 AS jarj_alempkk_opala95
,d15h.jarjestys_koulutusala1995 AS jarj_alempkk_koulala95
,d15i.jarjestys_opintoala2002 AS jarj_alempkk_opala
,d15j.jarjestys_koulutusala2002 AS jarj_alempkk_koulala
,d15k.jarjestys_koulutusaste2002 AS jarj_alempkk_koulaste
,d15l.jarjestys_opintoala1995 AS jarj_ylempkk_opala95
,d15m.jarjestys_koulutusala1995 AS jarj_ylempkk_koulala95
,d15n.jarjestys_opintoala2002 AS jarj_ylempkk_opala
,d15o.jarjestys_koulutusala2002 AS jarj_ylempkk_koulala
,d15p.jarjestys_koulutusaste2002 AS jarj_ylempkk_koulaste
,d17a.jarjestys AS jarj_ammpk_kulunutaika
,d17b.jarjestys AS jarj_ammlisa_kulunutaika
,d17c.jarjestys AS jarj_alempi_kulunutaika
,d17d.jarjestys AS jarj_ylempi_kulunutaika
,d17e.jarjestys AS jarj_aiktutk_kulunutaika
,d18.jarjestys as jarj_tutkintotyyppi
,d19.jarjestys as jarj_opiskaikyleis
,d20.jarjestys as jarj_jarjestamismuoto
,d21.jarjestys_koulutusaste2002
,d21.jarjestys_koulutusala2002
,d21.jarjestys_opintoala1995
,d21.jarjestys_opintoala2002
,d21.jarjestys as jarj_koulnimike
,d22.jarjestys_avi
,d22.jarjestys_ely
,d22.jarjestys_maakunta
,d22.jarjestys_kielisuhde
,d22.jarjestys as jarj_kunta
,d24.jarjestys as jarj_lukukausi
,d25.jarjestys as jarj_aikkorktutkinto
,d27.jarjestys as viimtutk_jarj
FROM dbo.f_TOAK_2_20_Lukio_amm_oppis_opisk_ian_ja_aik_koul_mukaan
	JOIN d_aidinkieli_versio1 d2 ON d2.id = aidinkieli_versio1_id
	JOIN d_alueluokitus d3 ON d3.id = opiskelijan_asuinkunta_id
	JOIN d_sukupuoli d4 ON d4.id = sukupuoli_id
	JOIN d_ika d5 ON d5.id = ika1v_id
	JOIN d_ika d51 ON d51.id = ika_14_65_id
	JOIN d_ika d6 ON d6.id = ika5v_id
	JOIN d_opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus d7 ON d7.id = opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_id
	JOIN d_nuorten_aikuisten_koulutus d8 ON d8.id = nuorten_aikuisten_koulutus_id
	JOIN d_nuorten_aikuisten_koulutus_amm d9 ON d9.id = nuorten_aikuisten_koulutus_amm_id
	JOIN d_lahde d10 ON d10.id = lahde_id
	JOIN d_opetushallinnon_koulutus d11 ON d11.id = opetushallinnon_koulutus_id
	JOIN d_opiskelijan_olo d12 ON d12.id = opiskelijan_olo_syys_id
	JOIN d_rahoituslahde_amm d13 ON d13.id = rahoituslahde_id
	JOIN d_oppilaitoksen_taustatiedot d14 ON d14.id = oppilaitoksen_oppilaitostyyppi_id
	JOIN d_koulutusluokitus_historia d15a ON d15a.id = aikaisemman_ammpk_opintoala2002_id
	JOIN d_koulutusluokitus_historia d15b ON d15b.id = aikaisemman_ammpk_koulutusala2002_id
	JOIN d_koulutusluokitus_historia d15c ON d15c.id = aikaisemman_ammpk_koulutusaste2002_id
	JOIN d_koulutusluokitus_historia d15d ON d15d.id = aikaisemman_ammlisa_opintoala2002_id
	JOIN d_koulutusluokitus_historia d15e ON d15e.id = aikaisemman_ammlisa_koulutusala2002_id
	JOIN d_koulutusluokitus_historia d15f ON d15f.id = aikaisemman_ammlisa_koulutusaste2002_id
	JOIN d_koulutusluokitus_historia d15g ON d15g.id = aikaisemman_alemman_kk_opintoala1995_id
	JOIN d_koulutusluokitus_historia d15h ON d15h.id = aikaisemman_alemman_kk_koulutusala1995_id
	JOIN d_koulutusluokitus_historia d15i ON d15i.id = aikaisemman_alemman_kk_opintoala2002_id
	JOIN d_koulutusluokitus_historia d15j ON d15j.id = aikaisemman_alemman_kk_koulutusala2002_id
	JOIN d_koulutusluokitus_historia d15k ON d15k.id = aikaisemman_alemman_kk_koulutusaste2002_id
	JOIN d_koulutusluokitus_historia d15l ON d15l.id = aikasemman_ylemman_kk_opintoala1995_id
	JOIN d_koulutusluokitus_historia d15m ON d15m.id = aikasemman_ylemman_kk_koulutusala1995_id
	JOIN d_koulutusluokitus_historia d15n ON d15n.id = aikasemman_ylemman_kk_opintoala2002_id
	JOIN d_koulutusluokitus_historia d15o ON d15o.id = aikasemman_ylemman_kk_koulutusala2002_id
	JOIN d_koulutusluokitus_historia d15p ON d15p.id = aikasemman_ylemman_kk_koulutusaste2002_id
	JOIN d_kausi d16a ON d16a.kausi_id = aikaisemman_ammlisa_suoritusvuosi_id
	JOIN d_kausi d16b ON d16b.kausi_id = aikaisemman_ylemman_kk_suoritusvuosi_id
	JOIN d_kausi d16c ON d16c.kausi_id = aikaisemman_alemman_kk_suoritusvuosi_id
	JOIN d_kausi d16d ON d16d.kausi_id = viimeisimman_koulutuksen_suorituvuosi_id
	JOIN d_kausi d16e ON d16e.kausi_id = aikaisemman_ammpk_suoritusvuosi_id
	JOIN d_koulutuksesta_kulunut_aika d17a ON d17a.id = aikaisemmasta_koulutuksesta_ammpk_kulunut_aika_id
	JOIN d_koulutuksesta_kulunut_aika d17b ON d17b.id = aikaisemmasta_koulutuksesta_ammlisa_kulunut_aika_id
	JOIN d_koulutuksesta_kulunut_aika d17c ON d17c.id = aikaisemmasta_koulutuksesta_alempi_kk_kulunut_aika_id
	JOIN d_koulutuksesta_kulunut_aika d17d ON d17d.id = aikaisemmasta_koulutuksesta_ylempi_kk_kulunut_aika_id
	JOIN d_koulutuksesta_kulunut_aika d17e ON d17e.id = viimeisimmasta_koulutuksesta_kulunut_aika_id
	JOIN d_ammatillisen_koulutuksen_koulutuslaji d18 ON d18.id = ammatillisen_koulutuksen_koulutuslaji_id
	JOIN d_opiskelijan_aikaisempi_yleissivistava_koulutus d19 ON d19.id = aikaisempi_ylsk_koulutus_id
	JOIN d_koulutuksen_jarjestamismuoto d20 ON d20.id = koulutuksen_jarjestamismuoto_id
	JOIN d_koulutusluokitus d21 ON d21.id = koulutusluokitus_id
	JOIN d_alueluokitus d22 ON d22.id = koulutuksen_kunta_id
	JOIN d_kausi d23 ON d23.kausi_id = kirjoihintulovuosi_id
	JOIN d_kausi d24 ON d24.kausi_id = kirjoihintulolukukausi_id
	JOIN d_aikaisempi_korkein_tutkinto d25 ON d25.id = aikaisempi_korkein_tutkinto_id
	JOIN d_kausi d26 ON d26.kausi_id = viimeisimman_koulutuksen_suorituvuosi_id
	JOIN d_koulutuksesta_kulunut_aika d27 ON d27.id = viimeisimmasta_koulutuksesta_kulunut_aika_id
WHERE d10.lahde_koodi != ''21''








' 
GO
/****** Object:  View [dbo].[v_f_tab_toisen_asteen_aikaisempi_koulutus_lukio]    Script Date: 21.6.2017 10:17:26 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_toisen_asteen_aikaisempi_koulutus_lukio]'))
EXEC dbo.sp_executesql @statement = N'








CREATE VIEW [dbo].[v_f_tab_toisen_asteen_aikaisempi_koulutus_lukio] AS

Select [Opisk2] = lukumaara,
[Aloitt2] = coalesce(aloittaneet,0)
,[Tilastovuosi] AS Tilastovuosi
,d2.aidinkieli_versio1 AS Äidinkieli
,d3.avi AS "Asuinalueen AVI"
,d3.ely AS "Asuinalueen ELY"
,d3.kielisuhde AS "Asuinkunnan kielisuhde"
,d3.maakunta AS Asuinmaakunta
,d3.kunta AS Asuinkunta
,d4.sukupuoli AS Sukupuoli
,d5.ika AS Ikä
,d51.ika AS "Ikä 15-64"
,d51.ika5v AS "Ikäryhmä 15-64"
,d6.ika5v AS Ikäryhmä
,d7.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus AS Järjestämistapa
,d8.nuorten_aikuisten_koulutus AS "Nuorten/aikuisten"
,d9.nuorten_aikuisten_koulutus_amm AS "Nuoret/aikuiset"
,d10.lahde AS Lähde
,d11.opetushallinnon_koulutus AS Hallinnonala
,d12.opiskelijan_olo AS Kirjoillaolo
,d13.rahoituslahde_amm AS Rahoituslähde
,d14.oppilaitostyyppi AS Oppilaitostyyppi
,d15a.opintoala2002 AS "Pohjakoul. opintoala (ammpk)"
,d15b.koulutusala2002 AS "Pohjakoul. koulutusala (ammpk)"
,d15c.koulutusaste2002 AS "Pohjakoul. koulutusaste (ammpk)"
,d15d.opintoala2002 AS "Pohjakoul. opintoala (ammlisä)"
,d15e.koulutusala2002 AS "Pohjakoul. koulutusala (ammlisä)"
,d15f.koulutusaste2002 AS "Pohjakoul. koulutusaste (ammlisä)"
,d15g.opintoala1995 AS "Pohjakoul. koul.ala (95 luokitus) (alempi kk)"
,d15h.koulutusala1995 AS "Pohjakoul. koulutusala95 (alempi kk)"
,d15i.opintoala2002 AS "Pohjakoul. opintoala (alempi kk)"
,d15j.koulutusala2002 AS "Pohjakoul. koul.ala (02 luokitus) (alempi kk)"
,d15k.koulutusaste2002 AS "Pohjakoul. koulutusaste (alempi kk)"
,d15l.opintoala1995 AS "Pohjakoul. koul.ala (95 luokitus) (ylempi kk)"
,d15m.koulutusala1995 AS "Pohjakoul. koulutusala95 (ylempi kk)"
,d15n.opintoala2002 AS "Pohjakoul. opintoala (ylempi kk)"
,d15o.koulutusala2002 AS "Pohjakoul. koul.ala (02 luokitus) (ylempi kk)"
,d15p.koulutusaste2002 AS "Pohjakoul. koulutusaste (ylempi kk)"
,d16a.vuosiselite AS "Pohjakoul. suoritusvuosi (ammlisä)"
,d16b.vuosiselite AS "Pohjakoul. suoritusvuosi (ylempi kk)"
,d16c.vuosiselite AS "Pohjakoul. suoritusvuosi (alempi kk)"
,d16d.vuosiselite AS "Pohjakoul. suoritusvuosi"
,d16e.vuosiselite AS "Pohjakoul. suoritusvuosi (ammpk)"
,d17a.koulutuksesta_kulunut_aika AS "Pohjakoulutuksesta kulunut aika (ammpk)"
,d17b.koulutuksesta_kulunut_aika AS "Pohjakoulutuksesta kulunut aika (ammlisä)"
,d17c.koulutuksesta_kulunut_aika AS "Pohjakoulutuksesta kulunut aika (alempi kk)"
,d17d.koulutuksesta_kulunut_aika AS "Pohjakoulutuksesta kulunut aika (ylempi kk)"
,d17e.koulutuksesta_kulunut_aika AS "Pohjakoulutuksesta kulunut aika"
,d18.ammatillisen_koulutuksen_koulutuslaji AS "Tutkintotyyppi"
,d19.opiskelijan_aikaisempi_yleissivistava_koulutus "Opiskelijan aikaisempi yleissivistävä koulutus"
,d20.koulutuksen_jarjestamismuoto as Järjestämismuoto
,d21.koulutusaste2002 as Koulutusaste
,d21.koulutusala2002 as Koulutusala
,d21.opintoala1995 as "Koulutusala (95 luokitus)"
,d21.opintoala2002 as Opintoala
,d21.koulutus as Koulutusnimike
,d22.avi as "Koulutuksen AVI"
,d22.ely as "Koulutuksen ELY"
,d22.maakunta as "Koulutuksen maakunta"
,d22.kielisuhde as "Koulutuksen kunnan kielisuhde"
,d22.kunta as "Koulutuksen kunta"
,d23.vuosiselite as "Kirjoihintulovuosi"
,d24.lukukausiselite as "Kirjoihintulolukukausi"
,d25.aikaisempi_korkein_tutkinto as "Aikaisempi korkein tutkinto"
,d26.vuosiselite as "Viim. tutk. suoritusvuosi"
,d27.koulutuksesta_kulunut_aika as "Viim. tutk. kulunut aika"
,[aikaisempi_ammpk_tarkempi] as "Aikaisempi amm. peruskoulutus"
,[ammpk_pohjakoulutuksen_tila] as "Aik. amm. peruskoul. tila"
,[aikaisempi_ammpk_nayttotutkintona_tarkempi] as "Aik. amm. pk. näyttötutkintoon johtavana koulutuksena"
,[aikaisempi_ammpk_oppisopimuskoulutuksena_tarkempi] as "Aik. amm. pk. oppisopimuskoulutuksena"
,[aikaisempi_ammlisa_tarkempi] as "Aikaisempi amm. lisäkoulutus"
,[ammlisa_pohjakoulutuksen_tila] as "Aik. amm. lisäkoul. tila"
,[aikaisempi_ammlisa_oppisopimuskoulutuksena_tarkempi] as "Aik. amm. lisäkoul. oppisopimuskoulutuksena"
,[aikaisempi_alempi_kk_tarkempi] as "Aikaisempi alemman kk-asteen koulutus"
,[alempi_kk_pohjakoulutuksen_tila] as "Aik. alempi kk tila"
,[aikaisempi_ylempi_kk_tarkempi] as "Aikaisempi ylemmmän kk-asteen koulutus"
,[ylempi_kk_pohjakoulutuksen_tila] as "Aik. ylempi kk tila"
,[aiemman_tutkinnon_ammpk_opintoala_sama] as "Pohjakoul. op.ala sama (ammpk)"
,[aiemman_tutkinnon_ammpk_koulutusala_sama] as "Pohjakoul. koul.ala sama (ammpk)"
,[aiemman_tutkinnon_ammpk_koulutusaste_sama] as "Pohjakoul. koul.aste sama (ammpk)"
,[aiemman_tutkinnon_ammlisa_opintoala_sama] as "Pohjakoul. op.ala sama (ammlisä)"
,[aiemman_tutkinnon_ammlisa_koulutusala_sama] as "Pohjakoul. koul.ala sama (ammlisä)"
,[aiemman_tutkinnon_ammlisa_koulutusaste_sama] as "Pohjakoul. koul.aste sama (ammlisä)"
,[aiemman_tutkinnon_alempi_kk_opintoala_sama] as "Pohjakoul. op.ala sama (alempi kk)"
,[aiemman_tutkinnon_alempi_kk_koulutusala_sama] as "Pohjakoul. koul.ala sama (alempi kk)"
,[aiemman_tutkinnon_alempi_kk_koulutusaste_sama] as "Pohjakoul. koul.aste sama (alempi kk)"
,[aiemman_tutkinnon_ylempi_kk_opintoala_sama] as "Pohjakoul. op.ala sama (ylempi kk)"
,[aiemman_tutkinnon_ylempi_kk_koulutusala_sama] as "Pohjakoul. koul.ala sama (ylempi kk)"
,[aiemman_tutkinnon_ylempi_kk_koulutusaste_sama] as "Pohjakoul. koul.aste sama (ylempi kk)"
,[aiemman_tutkinnon_opintoala2002_sama] as "Pohjakoul. op.ala sama"
,[aiemman_tutkinnon_koulutusaste2002_sama] as "Pohjakoul. koul.ala sama"
,[aiemman_tutkinnon_koulutusala2002_sama] as "Pohjakoul. koul.aste sama"
,d2.jarjestys AS jarj_aidinkieli
,d3.jarjestys_avi AS jarj_as_avi
,d3.jarjestys_ely AS jarj_as_ely
,d3.jarjestys_kielisuhde AS jarj_as_kielisuhde
,d3.jarjestys_maakunta AS jarj_as_maakunta
,d3.jarjestys AS jarj_as_kunta
,d5.jarjestys_ika
,d51.jarjestys_ika AS jarj1564_1v
,d51.jarjestys_ika5v AS jarj1564_5v
,d6.jarjestys_ika5v
,d7.jarjestys AS jarj_jarjtapa
,d8.jarjestys AS jarj_nuoraik
,d8.nuorten_aikuisten_koulutus_koodi AS lukio_nuoraik_koodi
,d9.jarjestys AS jarj_nuoraikamm
,d9.nuorten_aikuisten_koulutus_amm_koodi AS nuoraik_koodi
,d10.lahde_koodi
,d11.jarjestys AS jarj_ophal
,d12.jarjestys AS jarj_kirjolo
,d13.jarjestys AS jarj_rahoitus
,d14.jarjestys_oppilaitostyyppi
,d15a.jarjestys_opintoala2002 AS jarj_ammpk_opala
,d15b.jarjestys_koulutusala2002 AS jarj_ammpk_koulala
,d15c.jarjestys_koulutusaste2002 AS jarj_ammpk_koulaste
,d15d.jarjestys_opintoala2002 AS jarj_ammlisa_opala
,d15e.jarjestys_koulutusala2002 AS jarj_ammlisa_koulala
,d15f.jarjestys_koulutusaste2002 AS jarj_ammlisa_koulaste
,d15g.jarjestys_opintoala1995 AS jarj_alempkk_opala95
,d15h.jarjestys_koulutusala1995 AS jarj_alempkk_koulala95
,d15i.jarjestys_opintoala2002 AS jarj_alempkk_opala
,d15j.jarjestys_koulutusala2002 AS jarj_alempkk_koulala
,d15k.jarjestys_koulutusaste2002 AS jarj_alempkk_koulaste
,d15l.jarjestys_opintoala1995 AS jarj_ylempkk_opala95
,d15m.jarjestys_koulutusala1995 AS jarj_ylempkk_koulala95
,d15n.jarjestys_opintoala2002 AS jarj_ylempkk_opala
,d15o.jarjestys_koulutusala2002 AS jarj_ylempkk_koulala
,d15p.jarjestys_koulutusaste2002 AS jarj_ylempkk_koulaste
,d17a.jarjestys AS jarj_ammpk_kulunutaika
,d17b.jarjestys AS jarj_ammlisa_kulunutaika
,d17c.jarjestys AS jarj_alempi_kulunutaika
,d17d.jarjestys AS jarj_ylempi_kulunutaika
,d17e.jarjestys AS jarj_aiktutk_kulunutaika
,d18.jarjestys as jarj_tutkintotyyppi
,d19.jarjestys as jarj_opiskaikyleis
,d20.jarjestys as jarj_jarjestamismuoto
,d21.jarjestys_koulutusaste2002
,d21.jarjestys_koulutusala2002
,d21.jarjestys_opintoala1995
,d21.jarjestys_opintoala2002
,d21.jarjestys as jarj_koulnimike
,d22.jarjestys_avi
,d22.jarjestys_ely
,d22.jarjestys_maakunta
,d22.jarjestys_kielisuhde
,d22.jarjestys as jarj_kunta
,d24.jarjestys as jarj_lukukausi
,d25.jarjestys as jarj_aikkorktutkinto
,d27.jarjestys as viimtutk_jarj
FROM dbo.f_TOAK_2_20_Lukio_amm_oppis_opisk_ian_ja_aik_koul_mukaan
	JOIN d_aidinkieli_versio1 d2 ON d2.id = aidinkieli_versio1_id
	JOIN d_alueluokitus d3 ON d3.id = opiskelijan_asuinkunta_id
	JOIN d_sukupuoli d4 ON d4.id = sukupuoli_id
	JOIN d_ika d5 ON d5.id = ika1v_id
	JOIN d_ika d51 ON d51.id = ika_14_65_id
	JOIN d_ika d6 ON d6.id = ika5v_id
	JOIN d_opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus d7 ON d7.id = opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_id
	JOIN d_nuorten_aikuisten_koulutus d8 ON d8.id = nuorten_aikuisten_koulutus_id
	JOIN d_nuorten_aikuisten_koulutus_amm d9 ON d9.id = nuorten_aikuisten_koulutus_amm_id
	JOIN d_lahde d10 ON d10.id = lahde_id
	JOIN d_opetushallinnon_koulutus d11 ON d11.id = opetushallinnon_koulutus_id
	JOIN d_opiskelijan_olo d12 ON d12.id = opiskelijan_olo_syys_id
	JOIN d_rahoituslahde_amm d13 ON d13.id = rahoituslahde_id
	JOIN d_oppilaitoksen_taustatiedot d14 ON d14.id = oppilaitoksen_oppilaitostyyppi_id
	JOIN d_koulutusluokitus_historia d15a ON d15a.id = aikaisemman_ammpk_opintoala2002_id
	JOIN d_koulutusluokitus_historia d15b ON d15b.id = aikaisemman_ammpk_koulutusala2002_id
	JOIN d_koulutusluokitus_historia d15c ON d15c.id = aikaisemman_ammpk_koulutusaste2002_id
	JOIN d_koulutusluokitus_historia d15d ON d15d.id = aikaisemman_ammlisa_opintoala2002_id
	JOIN d_koulutusluokitus_historia d15e ON d15e.id = aikaisemman_ammlisa_koulutusala2002_id
	JOIN d_koulutusluokitus_historia d15f ON d15f.id = aikaisemman_ammlisa_koulutusaste2002_id
	JOIN d_koulutusluokitus_historia d15g ON d15g.id = aikaisemman_alemman_kk_opintoala1995_id
	JOIN d_koulutusluokitus_historia d15h ON d15h.id = aikaisemman_alemman_kk_koulutusala1995_id
	JOIN d_koulutusluokitus_historia d15i ON d15i.id = aikaisemman_alemman_kk_opintoala2002_id
	JOIN d_koulutusluokitus_historia d15j ON d15j.id = aikaisemman_alemman_kk_koulutusala2002_id
	JOIN d_koulutusluokitus_historia d15k ON d15k.id = aikaisemman_alemman_kk_koulutusaste2002_id
	JOIN d_koulutusluokitus_historia d15l ON d15l.id = aikasemman_ylemman_kk_opintoala1995_id
	JOIN d_koulutusluokitus_historia d15m ON d15m.id = aikasemman_ylemman_kk_koulutusala1995_id
	JOIN d_koulutusluokitus_historia d15n ON d15n.id = aikasemman_ylemman_kk_opintoala2002_id
	JOIN d_koulutusluokitus_historia d15o ON d15o.id = aikasemman_ylemman_kk_koulutusala2002_id
	JOIN d_koulutusluokitus_historia d15p ON d15p.id = aikasemman_ylemman_kk_koulutusaste2002_id
	JOIN d_kausi d16a ON d16a.kausi_id = aikaisemman_ammlisa_suoritusvuosi_id
	JOIN d_kausi d16b ON d16b.kausi_id = aikaisemman_ylemman_kk_suoritusvuosi_id
	JOIN d_kausi d16c ON d16c.kausi_id = aikaisemman_alemman_kk_suoritusvuosi_id
	JOIN d_kausi d16d ON d16d.kausi_id = viimeisimman_koulutuksen_suorituvuosi_id
	JOIN d_kausi d16e ON d16e.kausi_id = aikaisemman_ammpk_suoritusvuosi_id
	JOIN d_koulutuksesta_kulunut_aika d17a ON d17a.id = aikaisemmasta_koulutuksesta_ammpk_kulunut_aika_id
	JOIN d_koulutuksesta_kulunut_aika d17b ON d17b.id = aikaisemmasta_koulutuksesta_ammlisa_kulunut_aika_id
	JOIN d_koulutuksesta_kulunut_aika d17c ON d17c.id = aikaisemmasta_koulutuksesta_alempi_kk_kulunut_aika_id
	JOIN d_koulutuksesta_kulunut_aika d17d ON d17d.id = aikaisemmasta_koulutuksesta_ylempi_kk_kulunut_aika_id
	JOIN d_koulutuksesta_kulunut_aika d17e ON d17e.id = viimeisimmasta_koulutuksesta_kulunut_aika_id
	JOIN d_ammatillisen_koulutuksen_koulutuslaji d18 ON d18.id = ammatillisen_koulutuksen_koulutuslaji_id
	JOIN d_opiskelijan_aikaisempi_yleissivistava_koulutus d19 ON d19.id = aikaisempi_ylsk_koulutus_id
	JOIN d_koulutuksen_jarjestamismuoto d20 ON d20.id = koulutuksen_jarjestamismuoto_id
	JOIN d_koulutusluokitus d21 ON d21.id = koulutusluokitus_id
	JOIN d_alueluokitus d22 ON d22.id = koulutuksen_kunta_id
	JOIN d_kausi d23 ON d23.kausi_id = kirjoihintulovuosi_id
	JOIN d_kausi d24 ON d24.kausi_id = kirjoihintulolukukausi_id
	JOIN d_aikaisempi_korkein_tutkinto d25 ON d25.id = aikaisempi_korkein_tutkinto_id
	JOIN d_kausi d26 ON d26.kausi_id = viimeisimman_koulutuksen_suorituvuosi_id
	JOIN d_koulutuksesta_kulunut_aika d27 ON d27.id = viimeisimmasta_koulutuksesta_kulunut_aika_id
WHERE d10.lahde_koodi = ''21''









' 
GO
/****** Object:  View [dbo].[v_f_tab_toisen_asteen_aikaisempi_koulutus_yhteiset]    Script Date: 21.6.2017 10:17:26 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_toisen_asteen_aikaisempi_koulutus_yhteiset]'))
EXEC dbo.sp_executesql @statement = N'







CREATE VIEW [dbo].[v_f_tab_toisen_asteen_aikaisempi_koulutus_yhteiset] AS

Select [Opisk2] = lukumaara,
[Aloitt2] = coalesce(aloittaneet,0)
,[Tilastovuosi] AS Tilastovuosi
,d2.aidinkieli_versio1 AS Äidinkieli
,d3.avi AS "Asuinalueen AVI"
,d3.ely AS "Asuinalueen ELY"
,d3.kielisuhde AS "Asuinkunnan kielisuhde"
,d3.maakunta AS Asuinmaakunta
,d3.kunta AS Asuinkunta
,d4.sukupuoli AS Sukupuoli
,d5.ika AS Ikä
,d51.ika AS "Ikä 15-64"
,d51.ika5v AS "Ikäryhmä 15-64"
,d6.ika5v AS Ikäryhmä
,d7.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus AS Järjestämistapa
,d8.nuorten_aikuisten_koulutus AS "Nuorten/aikuisten"
,d9.nuorten_aikuisten_koulutus_amm AS "Nuoret/aikuiset"
,d10.lahde AS Lähde
,d11.opetushallinnon_koulutus AS Hallinnonala
,d12.opiskelijan_olo AS Kirjoillaolo
,d13.rahoituslahde_amm AS Rahoituslähde
,d14.oppilaitostyyppi AS Oppilaitostyyppi
,d15a.opintoala2002 AS "Pohjakoul. opintoala (ammpk)"
,d15b.koulutusala2002 AS "Pohjakoul. koulutusala (ammpk)"
,d15c.koulutusaste2002 AS "Pohjakoul. koulutusaste (ammpk)"
,d15d.opintoala2002 AS "Pohjakoul. opintoala (ammlisä)"
,d15e.koulutusala2002 AS "Pohjakoul. koulutusala (ammlisä)"
,d15f.koulutusaste2002 AS "Pohjakoul. koulutusaste (ammlisä)"
,d15g.opintoala1995 AS "Pohjakoul. koul.ala (95 luokitus) (alempi kk)"
,d15h.koulutusala1995 AS "Pohjakoul. koulutusala95 (alempi kk)"
,d15i.opintoala2002 AS "Pohjakoul. opintoala (alempi kk)"
,d15j.koulutusala2002 AS "Pohjakoul. koul.ala (02 luokitus) (alempi kk)"
,d15k.koulutusaste2002 AS "Pohjakoul. koulutusaste (alempi kk)"
,d15l.opintoala1995 AS "Pohjakoul. koul.ala (95 luokitus) (ylempi kk)"
,d15m.koulutusala1995 AS "Pohjakoul. koulutusala95 (ylempi kk)"
,d15n.opintoala2002 AS "Pohjakoul. opintoala (ylempi kk)"
,d15o.koulutusala2002 AS "Pohjakoul. koul.ala (02 luokitus) (ylempi kk)"
,d15p.koulutusaste2002 AS "Pohjakoul. koulutusaste (ylempi kk)"
,d16a.vuosiselite AS "Pohjakoul. suoritusvuosi (ammlisä)"
,d16b.vuosiselite AS "Pohjakoul. suoritusvuosi (ylempi kk)"
,d16c.vuosiselite AS "Pohjakoul. suoritusvuosi (alempi kk)"
,d16d.vuosiselite AS "Pohjakoul. suoritusvuosi"
,d16e.vuosiselite AS "Pohjakoul. suoritusvuosi (ammpk)"
,d17a.koulutuksesta_kulunut_aika AS "Pohjakoulutuksesta kulunut aika (ammpk)"
,d17b.koulutuksesta_kulunut_aika AS "Pohjakoulutuksesta kulunut aika (ammlisä)"
,d17c.koulutuksesta_kulunut_aika AS "Pohjakoulutuksesta kulunut aika (alempi kk)"
,d17d.koulutuksesta_kulunut_aika AS "Pohjakoulutuksesta kulunut aika (ylempi kk)"
,d17e.koulutuksesta_kulunut_aika AS "Pohjakoulutuksesta kulunut aika"
,d18.ammatillisen_koulutuksen_koulutuslaji AS "Tutkintotyyppi"
,d19.opiskelijan_aikaisempi_yleissivistava_koulutus "Opiskelijan aikaisempi yleissivistävä koulutus"
,d20.koulutuksen_jarjestamismuoto as Järjestämismuoto
,d21.koulutusaste2002 as Koulutusaste
,d21.koulutusala2002 as Koulutusala
,d21.opintoala1995 as "Koulutusala (95 luokitus)"
,d21.opintoala2002 as Opintoala
,d21.koulutus as Koulutusnimike
,d22.avi as "Koulutuksen AVI"
,d22.ely as "Koulutuksen ELY"
,d22.maakunta as "Koulutuksen maakunta"
,d22.kielisuhde as "Koulutuksen kunnan kielisuhde"
,d22.kunta as "Koulutuksen kunta"
,d23.vuosiselite as "Kirjoihintulovuosi"
,d24.lukukausiselite as "Kirjoihintulolukukausi"
,d25.aikaisempi_korkein_tutkinto as "Aikaisempi korkein tutkinto"
,d26.vuosiselite as "Viim. tutk. suoritusvuosi"
,d27.koulutuksesta_kulunut_aika as "Viim. tutk. kulunut aika"
,[aikaisempi_ammpk_tarkempi] as "Aikaisempi amm. peruskoulutus"
,[ammpk_pohjakoulutuksen_tila] as "Aik. amm. peruskoul. tila"
,[aikaisempi_ammpk_nayttotutkintona_tarkempi] as "Aik. amm. pk. näyttötutkintoon johtavana koulutuksena"
,[aikaisempi_ammpk_oppisopimuskoulutuksena_tarkempi] as "Aik. amm. pk. oppisopimuskoulutuksena"
,[aikaisempi_ammlisa_tarkempi] as "Aikaisempi amm. lisäkoulutus"
,[ammlisa_pohjakoulutuksen_tila] as "Aik. amm. lisäkoul. tila"
,[aikaisempi_ammlisa_oppisopimuskoulutuksena_tarkempi] as "Aik. amm. lisäkoul. oppisopimuskoulutuksena"
,[aikaisempi_alempi_kk_tarkempi] as "Aikaisempi alemman kk-asteen koulutus"
,[alempi_kk_pohjakoulutuksen_tila] as "Aik. alempi kk tila"
,[aikaisempi_ylempi_kk_tarkempi] as "Aikaisempi ylemmmän kk-asteen koulutus"
,[ylempi_kk_pohjakoulutuksen_tila] as "Aik. ylempi kk tila"
,[aiemman_tutkinnon_ammpk_opintoala_sama] as "Pohjakoul. op.ala sama (ammpk)"
,[aiemman_tutkinnon_ammpk_koulutusala_sama] as "Pohjakoul. koul.ala sama (ammpk)"
,[aiemman_tutkinnon_ammpk_koulutusaste_sama] as "Pohjakoul. koul.aste sama (ammpk)"
,[aiemman_tutkinnon_ammlisa_opintoala_sama] as "Pohjakoul. op.ala sama (ammlisä)"
,[aiemman_tutkinnon_ammlisa_koulutusala_sama] as "Pohjakoul. koul.ala sama (ammlisä)"
,[aiemman_tutkinnon_ammlisa_koulutusaste_sama] as "Pohjakoul. koul.aste sama (ammlisä)"
,[aiemman_tutkinnon_alempi_kk_opintoala_sama] as "Pohjakoul. op.ala sama (alempi kk)"
,[aiemman_tutkinnon_alempi_kk_koulutusala_sama] as "Pohjakoul. koul.ala sama (alempi kk)"
,[aiemman_tutkinnon_alempi_kk_koulutusaste_sama] as "Pohjakoul. koul.aste sama (alempi kk)"
,[aiemman_tutkinnon_ylempi_kk_opintoala_sama] as "Pohjakoul. op.ala sama (ylempi kk)"
,[aiemman_tutkinnon_ylempi_kk_koulutusala_sama] as "Pohjakoul. koul.ala sama (ylempi kk)"
,[aiemman_tutkinnon_ylempi_kk_koulutusaste_sama] as "Pohjakoul. koul.aste sama (ylempi kk)"
,[aiemman_tutkinnon_opintoala2002_sama] as "Pohjakoul. op.ala sama"
,[aiemman_tutkinnon_koulutusaste2002_sama] as "Pohjakoul. koul.ala sama"
,[aiemman_tutkinnon_koulutusala2002_sama] as "Pohjakoul. koul.aste sama"

--Ruotsi
,[Statistikår] = tilastovuosi
,[Kön] = d4.sukupuoli_SV
,[Modersmål] = d2.aidinkieli_versio1_SV
,[Åldersgrupp] = d5.ika5v_SV
,[Högsta tidigare avlagd examen] = d25.aikaisempi_korkein_tutkinto_SV
,[Tidigare yleissiv] = null
,[Tidigare ammpk] = null
,[Tidigare ammpk näyttö] = null
,[Tidigare ammpk oppis] = null
,[Tidigare ammlisa] = null
,[Tidigare ammlisa oppis] = null
,[Tidigare al kk] = null
,[Tidigare yl kk] = null
,[Utbildningsnivå] = d21.koulutusaste2002_SV
,[Utbildningsområde (2002)] = d21.koulutusala2002_SV
,[Utbildningsområde (1995)] = d21.koulutusala1995_SV
,[Studieområde] = d21.opintoala2002_SV
,[Utbildningens landskap] = d22.maakunta_SV

--Englanti
,[Statistical year] = tilastovuosi
,[Gender] = d4.sukupuoli_EN
,[Mother tongue] = d2.aidinkieli_versio1_EN
,[Age group] = d5.ika5v_EN
,[Highest previous degree/qualification] = d25.aikaisempi_korkein_tutkinto_EN
,[Previous yleissiv] = null
,[Previous ammpk] = null
,[Previous ammpk näyttö] = null
,[Previous ammpk oppis] = null
,[Previous ammlisa] = null
,[Previous ammlisa oppis] = null
,[Previous al kk] = null
,[Previous yl kk] = null
,[Level of education] = d21.koulutusaste2002_EN
,[Field of education (2002)] = d21.koulutusala2002_EN
,[Field of education (1995)] = d21.koulutusala1995_EN
,[Subfield of education] = d21.opintoala2002_EN
,[Region of education] = d22.maakunta_EN

--Järjestys
,d2.jarjestys AS jarj_aidinkieli
,d3.jarjestys_avi AS jarj_as_avi
,d3.jarjestys_ely AS jarj_as_ely
,d3.jarjestys_kielisuhde AS jarj_as_kielisuhde
,d3.jarjestys_maakunta AS jarj_as_maakunta
,d3.jarjestys AS jarj_as_kunta
,d5.jarjestys_ika
,d51.jarjestys_ika AS jarj1564_1v
,d51.jarjestys_ika5v AS jarj1564_5v
,d6.jarjestys_ika5v
,d7.jarjestys AS jarj_jarjtapa
,d8.jarjestys AS jarj_nuoraik
,d9.jarjestys AS jarj_nuoraikamm
,d9.nuorten_aikuisten_koulutus_amm_koodi AS nuoraik_koodi
,d10.lahde_koodi
,d11.jarjestys AS jarj_ophal
,d12.jarjestys AS jarj_kirjolo
,d13.jarjestys AS jarj_rahoitus
,d14.jarjestys_oppilaitostyyppi
,d15a.jarjestys_opintoala2002 AS jarj_ammpk_opala
,d15b.jarjestys_koulutusala2002 AS jarj_ammpk_koulala
,d15c.jarjestys_koulutusaste2002 AS jarj_ammpk_koulaste
,d15d.jarjestys_opintoala2002 AS jarj_ammlisa_opala
,d15e.jarjestys_koulutusala2002 AS jarj_ammlisa_koulala
,d15f.jarjestys_koulutusaste2002 AS jarj_ammlisa_koulaste
,d15g.jarjestys_opintoala1995 AS jarj_alempkk_opala95
,d15h.jarjestys_koulutusala1995 AS jarj_alempkk_koulala95
,d15i.jarjestys_opintoala2002 AS jarj_alempkk_opala
,d15j.jarjestys_koulutusala2002 AS jarj_alempkk_koulala
,d15k.jarjestys_koulutusaste2002 AS jarj_alempkk_koulaste
,d15l.jarjestys_opintoala1995 AS jarj_ylempkk_opala95
,d15m.jarjestys_koulutusala1995 AS jarj_ylempkk_koulala95
,d15n.jarjestys_opintoala2002 AS jarj_ylempkk_opala
,d15o.jarjestys_koulutusala2002 AS jarj_ylempkk_koulala
,d15p.jarjestys_koulutusaste2002 AS jarj_ylempkk_koulaste
,d17a.jarjestys AS jarj_ammpk_kulunutaika
,d17b.jarjestys AS jarj_ammlisa_kulunutaika
,d17c.jarjestys AS jarj_alempi_kulunutaika
,d17d.jarjestys AS jarj_ylempi_kulunutaika
,d17e.jarjestys AS jarj_aiktutk_kulunutaika
,d18.jarjestys as jarj_tutkintotyyppi
,d19.jarjestys as jarj_opiskaikyleis
,d20.jarjestys as jarj_jarjestamismuoto
,d21.jarjestys_koulutusaste2002
,d21.jarjestys_koulutusala2002
,d21.jarjestys_opintoala1995
,d21.jarjestys_opintoala2002
,d21.jarjestys as jarj_koulnimike
,d22.jarjestys_avi
,d22.jarjestys_ely
,d22.jarjestys_maakunta
,d22.jarjestys_kielisuhde
,d22.jarjestys as jarj_kunta
,d24.jarjestys as jarj_lukukausi
,d25.jarjestys as jarj_aikkorktutkinto
,d27.jarjestys as viimtutk_jarj
FROM dbo.f_TOAK_2_20_Lukio_amm_oppis_opisk_ian_ja_aik_koul_mukaan
	JOIN d_aidinkieli_versio1 d2 ON d2.id = aidinkieli_versio1_id
	JOIN d_alueluokitus d3 ON d3.id = opiskelijan_asuinkunta_id
	JOIN d_sukupuoli d4 ON d4.id = sukupuoli_id
	JOIN d_ika d5 ON d5.id = ika1v_id
	JOIN d_ika d51 ON d51.id = ika_14_65_id
	JOIN d_ika d6 ON d6.id = ika5v_id
	JOIN d_opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus d7 ON d7.id = opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_id
	JOIN d_nuorten_aikuisten_koulutus d8 ON d8.id = nuorten_aikuisten_koulutus_id
	JOIN d_nuorten_aikuisten_koulutus_amm d9 ON d9.id = nuorten_aikuisten_koulutus_amm_id
	JOIN d_lahde d10 ON d10.id = lahde_id
	JOIN d_opetushallinnon_koulutus d11 ON d11.id = opetushallinnon_koulutus_id
	JOIN d_opiskelijan_olo d12 ON d12.id = opiskelijan_olo_syys_id
	JOIN d_rahoituslahde_amm d13 ON d13.id = rahoituslahde_id
	JOIN d_oppilaitoksen_taustatiedot d14 ON d14.id = oppilaitoksen_oppilaitostyyppi_id
	JOIN d_koulutusluokitus_historia d15a ON d15a.id = aikaisemman_ammpk_opintoala2002_id
	JOIN d_koulutusluokitus_historia d15b ON d15b.id = aikaisemman_ammpk_koulutusala2002_id
	JOIN d_koulutusluokitus_historia d15c ON d15c.id = aikaisemman_ammpk_koulutusaste2002_id
	JOIN d_koulutusluokitus_historia d15d ON d15d.id = aikaisemman_ammlisa_opintoala2002_id
	JOIN d_koulutusluokitus_historia d15e ON d15e.id = aikaisemman_ammlisa_koulutusala2002_id
	JOIN d_koulutusluokitus_historia d15f ON d15f.id = aikaisemman_ammlisa_koulutusaste2002_id
	JOIN d_koulutusluokitus_historia d15g ON d15g.id = aikaisemman_alemman_kk_opintoala1995_id
	JOIN d_koulutusluokitus_historia d15h ON d15h.id = aikaisemman_alemman_kk_koulutusala1995_id
	JOIN d_koulutusluokitus_historia d15i ON d15i.id = aikaisemman_alemman_kk_opintoala2002_id
	JOIN d_koulutusluokitus_historia d15j ON d15j.id = aikaisemman_alemman_kk_koulutusala2002_id
	JOIN d_koulutusluokitus_historia d15k ON d15k.id = aikaisemman_alemman_kk_koulutusaste2002_id
	JOIN d_koulutusluokitus_historia d15l ON d15l.id = aikasemman_ylemman_kk_opintoala1995_id
	JOIN d_koulutusluokitus_historia d15m ON d15m.id = aikasemman_ylemman_kk_koulutusala1995_id
	JOIN d_koulutusluokitus_historia d15n ON d15n.id = aikasemman_ylemman_kk_opintoala2002_id
	JOIN d_koulutusluokitus_historia d15o ON d15o.id = aikasemman_ylemman_kk_koulutusala2002_id
	JOIN d_koulutusluokitus_historia d15p ON d15p.id = aikasemman_ylemman_kk_koulutusaste2002_id
	JOIN d_kausi d16a ON d16a.kausi_id = aikaisemman_ammlisa_suoritusvuosi_id
	JOIN d_kausi d16b ON d16b.kausi_id = aikaisemman_ylemman_kk_suoritusvuosi_id
	JOIN d_kausi d16c ON d16c.kausi_id = aikaisemman_alemman_kk_suoritusvuosi_id
	JOIN d_kausi d16d ON d16d.kausi_id = viimeisimman_koulutuksen_suorituvuosi_id
	JOIN d_kausi d16e ON d16e.kausi_id = aikaisemman_ammpk_suoritusvuosi_id
	JOIN d_koulutuksesta_kulunut_aika d17a ON d17a.id = aikaisemmasta_koulutuksesta_ammpk_kulunut_aika_id
	JOIN d_koulutuksesta_kulunut_aika d17b ON d17b.id = aikaisemmasta_koulutuksesta_ammlisa_kulunut_aika_id
	JOIN d_koulutuksesta_kulunut_aika d17c ON d17c.id = aikaisemmasta_koulutuksesta_alempi_kk_kulunut_aika_id
	JOIN d_koulutuksesta_kulunut_aika d17d ON d17d.id = aikaisemmasta_koulutuksesta_ylempi_kk_kulunut_aika_id
	JOIN d_koulutuksesta_kulunut_aika d17e ON d17e.id = viimeisimmasta_koulutuksesta_kulunut_aika_id
	JOIN d_ammatillisen_koulutuksen_koulutuslaji d18 ON d18.id = ammatillisen_koulutuksen_koulutuslaji_id
	JOIN d_opiskelijan_aikaisempi_yleissivistava_koulutus d19 ON d19.id = aikaisempi_ylsk_koulutus_id
	JOIN d_koulutuksen_jarjestamismuoto d20 ON d20.id = koulutuksen_jarjestamismuoto_id
	JOIN d_koulutusluokitus d21 ON d21.id = koulutusluokitus_id
	JOIN d_alueluokitus d22 ON d22.id = koulutuksen_kunta_id
	JOIN d_kausi d23 ON d23.kausi_id = kirjoihintulovuosi_id
	JOIN d_kausi d24 ON d24.kausi_id = kirjoihintulolukukausi_id
	JOIN d_aikaisempi_korkein_tutkinto d25 ON d25.id = aikaisempi_korkein_tutkinto_id
	JOIN d_kausi d26 ON d26.kausi_id = viimeisimman_koulutuksen_suorituvuosi_id
	JOIN d_koulutuksesta_kulunut_aika d27 ON d27.id = viimeisimmasta_koulutuksesta_kulunut_aika_id







' 
GO
/****** Object:  View [dbo].[v_f_tab_toisen_asteen_opiskelijat_ja_tutkinnot_ika1v]    Script Date: 21.6.2017 10:17:26 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_toisen_asteen_opiskelijat_ja_tutkinnot_ika1v]'))
EXEC dbo.sp_executesql @statement = N'











CREATE VIEW [dbo].[v_f_tab_toisen_asteen_opiskelijat_ja_tutkinnot_ika1v] AS

--aloittaneet ja opiskelijat
select
	[Tilastovuosi] = f.tilastointivuosi
	
	,[Sukupuoli] = d1.sukupuoli
	,[Äidinkieli] = d5.aidinkieli_versio1
	,[Ikä kirjoihintulovuonna] = d9.ika
	,[Ikäryhmä I kirjoihintulovuonna] = d9.ika5v
	,[Ikäryhmä II kirjoihintulovuonna] = d10.ika
	,[Ikä] = d11.ika
	,[Ikäryhmä I] = d11.ika5v
	,[Ikäryhmä II] = d12.ika
	,[Nuorten/aikuisten koul.] = d4.nuorten_aikuisten_koulutus

	,[Hallinnonala] = d7.opetushallinnon_koulutus
	,[Koulutuksen tavoite] = d8.tutkinnon_tavoite
	,[Koko tutkinto / tutk. osa] = d27.koulutuksen_tavoite_toteuma
	,[Järjestämistapa] = d13.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus
	,[Järjestämismuoto] = d14.koulutuksen_jarjestamismuoto
	,[Tutkintotyyppi] = d15.ammatillisen_koulutuksen_koulutuslaji
	,[Koulutusala] = d16.koulutusala2002
	,[Opintoala] = d16.opintoala2002
	,[Koulutusnimike] = d16.koulutus
	,[Koulutuslaji] = d16.koulutus
	,[Osaamisala] = d17.koulutusohjelma_ammpk
	,[Rahoituslähde] = d18.rahoituslahde_amm
	,[Tutkintonimike] = d19.tutkintonimike_ammpk
	,[Koulutuksen kieli] = d20.kieli
	,[Väylä näyttötutkintoon] = ''Tuntematon''	
	,[Koulutuksen suuralue] = d22.suuralue
	,[Koulutuksen kunnan kielisuhde] = d22.kielisuhde
	,[Koulutuksen AVI] = d22.avi
	,[Koulutuksen ELY] = d22.ely
	,[Koulutuksen maakunta] = d22.maakunta
	,[Koulutuksen seutukunta] = d22.seutukunta
	,[Koulutuksen sijaintikunnan kuntaryhmä] = d22.kuntaryhma
	,[Koulutuksen kunta] = d22.kunta
	,[Koulutussektori] = d26.koulutussektori

	,[Koulutuksen järjestäjä] = coalesce(nullif(d23b.koulutuksen_jarjestaja,''''),d23.koulutuksen_jarjestaja)
	,[Koulutuksen järjestäjän omistajatyyppi] = d23.koulutuksen_jarjestajan_omistajatyyppi
	,[Koulutuksen järjestäjän suuralue] = d24.suuralue
	,[Koulutuksen järjestäjän kunnan kielisuhde] = d24.kielisuhde
	,[Koulutuksen järjestäjän AVI] = d24.avi
	,[Koulutuksen järjestäjän ELY] = d24.ely
	,[Koulutuksen järjestäjän maakunta] = d24.maakunta
	,[Koulutuksen järjestäjän seutukunta] = d24.seutukunta
	,[Koulutuksen järjestäjän sijaintikunnan kuntaryhmä] = d24.kuntaryhma
	,[Koulutuksen järjestäjän kunta] = d24.kunta

	--mittarit
	,[Aloittaneet2] = f.aloittaneet
	,[Opiskelijat2] = f.opiskelijat
	,[Tutkinnot2] = null
	,[Ammattiosaamisen näyttöjen lukumäärä] = null
	,[Ennen koulutuksen alkua hyväksiluettujen opintoviikkojen määrä] = null
	,[Koulutuksen aikana hyväksiluettujen opintoviikkojen määrä] = null
	,[Koulutuksen aikana suoritettujen opintoviikkojen määrä] = null
	,[Tutkinnon opintoviikot yhteensä] = null
	,[Työssäoppimisen opintoviikkojen määrä] = null
	,[Tutkintojen osien lukumäärä] = null

	--Ruotsi
	,[Statistikår] = f.tilastointivuosi
	,[Kön] = d1.sukupuoli_SV
	,[Modersmål] = d5.aidinkieli_versio1_SV
	,[Ålder (inskrivningsår)] = d9.ika_SV
	,[Åldersgrupp I (inskrivningsår)] = d9.ika5v_SV
	,[Åldersgrupp II (inskrivningsår)] = d10.ika_SV
	,[Ålder] = d11.ika_SV
	,[Åldersgrupp I] = d11.ika5v_SV
	,[Åldersgrupp II] = d12.ika_SV
	,[Ungdoms-/vuxenutbildning] = d4.nuorten_aikuisten_koulutus_SV
	,[Förvaltningsområde] = d7.opetushallinnon_koulutus_SV
	,[Utbildningens mål (studerandens mål i utbildningen)] = d8.tutkinnon_tavoite_SV
	,[Hela examen/del av en examen] = d27.koulutuksen_tavoite_toteuma_SV
	,[Sättet på vilket utbildningen ordnas] = d13.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_SV
	,[Formen i vilken utbildningen ordnas] = d14.koulutuksen_jarjestamismuoto_SV
	,[Typ av examen] = d15.ammatillisen_koulutuksen_koulutuslaji_SV
	,[Utbildningsområde] = d16.koulutusala2002_SV
	,[Studieområde] = d16.opintoala2002_SV
	,[Utbildningsbenämning] = d16.koulutus_SV
	,[Kompetensområde] = d17.koulutusohjelma_ammpk_SV
	,[Finansieringskälla] = d18.rahoituslahde_amm_SV
	,[Examensbeteckning] = d19.tutkintonimike_ammpk_SV
	,[Utbildningens språk] = d20.kieli_SV
	,[Väg till fristående examen] = null
	,[Utbildningens storområde] = d22.suuralue_SV
	,[Utbildningens kommunens språkliga indelning] = d22.kielisuhde_SV
	,[Utbildningens RFV-område] = d22.avi_SV
	,[Utbildningens NMT-område] = d22.ely_SV
	,[Utbildningens landskap] = d22.maakunta_SV
	,[Utbildningens ekonomisk region] = d22.seutukunta_SV
	,[Utbildningens kommungrupp] = d22.kuntaryhma_SV
	,[Utbildningens kommun] = d22.kunta_SV

	,[Utbildningsanordnare] = coalesce(nullif(d23b.koulutuksen_jarjestaja_SV,''''),d23.koulutuksen_jarjestaja_SV)
	,[Utbildningsanordnarens ägartyp] = d23.koulutuksen_jarjestajan_omistajatyyppi_SV
	,[Utbildningsanordnarens storområde] = d24.suuralue_SV
	,[Utbildningsanordnarens kommunens språkliga indelning] = d24.kielisuhde_SV
	,[Utbildningsanordnarens RFV-område] = d24.avi_SV
	,[Utbildningsanordnarens NMT-område] = d24.ely_SV
	,[Utbildningsanordnarens landskap] = d24.maakunta_SV
	,[Utbildningsanordnarens ekonomisk region] = d24.seutukunta_SV
	,[Utbildningsanordnarens kommungrupp] = d24.kuntaryhma_SV
	,[Utbildningsanordnarens kommun] = d24.kunta_SV

	--Englanti
	,[Statistical year] = f.tilastointivuosi
	,[Gender] = d1.sukupuoli_EN
	,[Mother tongue] = d5.aidinkieli_versio1_EN
	,[Age (year of entry)] = d9.ika_EN
	,[Age group I (year of entry)] = d9.ika5v_EN
	,[Age group II (year of entry)] = d10.ika_EN
	,[Age] = d11.ika_EN
	,[Age group I] = d11.ika5v_EN
	,[Age group II] = d12.ika_EN
	,[Youth/adult education] = d4.nuorten_aikuisten_koulutus_EN
	,[Administrative sector] = d7.opetushallinnon_koulutus_EN
	,[Objective of education (the student''s objective for attaining education)] = d8.tutkinnon_tavoite_EN
	,[Complete qualification/module] = d27.koulutuksen_tavoite_toteuma_EN
	,[Method of vocational education and training] = d13.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_EN
	,[Form of vocational education and training] = d14.koulutuksen_jarjestamismuoto_EN
	,[Qualification type] = d15.ammatillisen_koulutuksen_koulutuslaji_EN
	,[Field of education] = d16.koulutusala2002_EN
	,[Subfield of education] = d16.opintoala2002_EN
	,[Name of education] = d16.koulutus_EN
	,[Competence area] = d17.koulutusohjelma_ammpk_EN
	,[Source of funding] = d18.rahoituslahde_amm_EN
	,[Qualification title] = d19.tutkintonimike_ammpk_EN
	,[Language of education] = d20.kieli_EN
	,[Route to competence-based qualification] = null
	,[Major region of education] = d22.suuralue_EN
	,[Lang. distribution of municipality of education] = d22.kielisuhde_EN
	,[AVI area of education] = d22.avi_EN
	,[ELY area of education] = d22.ely_EN
	,[Region of education] = d22.maakunta_EN
	,[Subregion of education] = d22.seutukunta_EN
	,[Municipality group of education] = d22.kuntaryhma_EN
	,[Municipality of education] = d22.kunta_EN

	,[Education provider] = coalesce(nullif(d23b.koulutuksen_jarjestaja_EN,''''),d23.koulutuksen_jarjestaja_EN)
	,[Type of education provider owner] = d23.koulutuksen_jarjestajan_omistajatyyppi_EN
	,[Major region of the education provider] = d24.suuralue_EN
	,[Lang. distribution of municipality of the education provider] = d24.kielisuhde_EN
	,[AVI area of the education provider] = d24.avi_EN
	,[ELY area of the education provider] = d24.ely_EN
	,[Region of the education provider] = d24.maakunta_EN
	,[Subregion of the education provider] = d24.seutukunta_EN
	,[Municipality group of the education provider] = d24.kuntaryhma_EN
	,[Municipality of the education provider] = d24.kunta_EN

	--koodimuuttujat
	,[Koodit Koulutuksen maakunta] = d22.maakunta_koodi
	,[Koodit Koulutuksen kunta] = d22.kunta_koodi
	,[Koodit Koulutuksen järjestäjän maakunta] = d24.maakunta_koodi
	,[Koodit Koulutuksen järjestäjän kunta] = d24.kunta_koodi
	,[Koodit Koulutusala] = d16.koulutusala2002_koodi
	,[Koodit Opintoala] = d16.opintoala2002_koodi
	,[Koodit Koulutusnimike] = d16.koulutus_koodi
	,[Koodit Osaamisala] = d17.koulutusohjelma_ammpk_koodi
	,[Koodit Koulutuksen järjestäjä] = coalesce(nullif(d23b.koulutuksen_jarjestajakoodi,''''),d23.koulutuksen_jarjestajakoodi)
	,d16.iscle2011_koodi as "Koodit Koulutusaste, taso 1"
	,d16.Koulutusaste_taso2_koodi as "Koodit Koulutusaste, taso 2"
	,d16.iscfibroad2013_koodi as "Koodit Koulutusala, taso 1"
	,d16.iscfinarrow2013_koodi as "Koodit Koulutusala, taso 2"
	,d16.iscfi2013_koodi as "Koodit Koulutusala, taso 3"

	--isced
	,d16.iscle2011 as "Koulutusaste, taso 1"
	,d16.Koulutusaste_taso2 as "Koulutusaste, taso 2"
	,d16.iscfibroad2013 as "Koulutusala, taso 1"
	,d16.iscfinarrow2013 as "Koulutusala, taso 2"
	,d16.iscfi2013 as "Koulutusala, taso 3"
	,d16.iscle2011_SV as "Utbildn.nivå, nivå 1"
	,d16.Koulutusaste_taso2_SV as "Utbildn.nivå, nivå 2"
	,d16.iscfibroad2013_SV as "Utbildn.område, nivå 1"
	,d16.iscfinarrow2013_SV as "Utbildn.område, nivå 2"
	,d16.iscfi2013_SV as "Utbildn.område, nivå 3"
	,d16.iscle2011_EN as "Level of education, tier 1"
	,d16.Koulutusaste_taso2_EN as "Level of education, tier 2"
	,d16.iscfibroad2013_EN as "Field of education, tier 1"
	,d16.iscfinarrow2013_EN as "Field of education, tier 2"
	,d16.iscfi2013_EN as "Field of education, tier 3"
	,d16.jarjestys_iscle2011 as jarj_isced_koulast1
	,d16.jarjestys_Koulutusaste_taso2 as jarj_isced_koulast2
	,d16.jarjestys_iscfibroad2013 as jarj_isced_koulala1
	,d16.jarjestys_iscfinarrow2013 as jarj_isced_koulala2
	,d16.jarjestys_iscfi2013 as jarj_isced_koulala3

	--järjestys
	,[Sukupuoli jarj] = d1.jarjestys
	,[Äidinkieli jarj] = d5.jarjestys
	,[Ikä kirj jarj] = d9.jarjestys_ika
	,[Ikä5v kirj jarj] = d9.jarjestys_ika5v
	,[Ikäryhmä kirj jarj] = d10.jarjestys_ika
	,[Ikä jarj] = d11.jarjestys_ika
	,[Ikä5v jarj] = d11.jarjestys_ika5v
	,[Ikäryhmä jarj] = d12.jarjestys_ika
	,[Nuorten/aikuisten jarj] = d4.jarjestys
	,[Hallinnonala jarj] = d7.jarjestys
	,[Koulutuksen tavoite jarj] = d8.jarjestys
	,[Koko tutkinto / tutk. osa jarj] = d27.jarjestys
	,[Järjestämistapa jarj] = d13.jarjestys
	,[Järjestämismuoto jarj] = d14.jarjestys
	,[Tutkintotyyppi jarj] = d15.jarjestys
	,[Koulutusala jarj] = d16.jarjestys_koulutusala2002
	,[Opintoala jarj] = d16.jarjestys_opintoala2002
	,[Koulutusnimike jarj] = d16.jarjestys
	,[Osaamisala jarj] = d17.jarjestys
	,[Rahoituslähde jarj] = d18.jarjestys
	,[Tutkintonimike jarj] = d19.jarjestys
	,[Koulutuksen kieli jarj] = d20.jarjestys
	,[Väylä näyttötutkintoon jarj] = null
	,[Koulutuksen suuralue jarj] = d22.jarjestys_suuralue
	,[Koulutuksen kunnan kielisuhde jarj] = d22.jarjestys_kielisuhde
	,[Koulutuksen AVI jarj] = d22.jarjestys_avi
	,[Koulutuksen ELY jarj] = d22.jarjestys_ely
	,[Koulutuksen maakunta jarj] = d22.jarjestys_maakunta
	,[Koulutuksen seutukunta jarj] = d22.jarjestys_seutukunta
	,[Koulutuksen sijaintikunnan kuntaryhmä jarj] = d22.jarjestys_kuntaryhma
	,[Koulutuksen järjestäjän omistajatyyppi jarj] = d23.jarjestys_omistajatyyppi
	,[Koulutuksen järjestäjän suuralue jarj] = d24.jarjestys_suuralue
	,[Koulutuksen järjestäjän kunnan kielisuhde jarj] = d24.jarjestys_kielisuhde
	,[Koulutuksen järjestäjän AVI jarj] = d24.jarjestys_avi
	,[Koulutuksen järjestäjän ELY jarj] = d24.jarjestys_ely
	,[Koulutuksen järjestäjän maakunta jarj] = d24.jarjestys_maakunta
	,[Koulutuksen järjestäjän seutukunta jarj] = d24.jarjestys_seutukunta
	,[Koulutuksen järjestäjän sijaintikunnan kuntaryhmä jarj] = d24.jarjestys_kuntaryhma



from [dbo].[f_2_3efg_Lukiokoulutuksen_ja_ammatillisen_koulutuksen_opiskelijat] f
left join VipunenTK.dbo.d_sukupuoli d1 on d1.id=f.sukupuoli_id

left join VipunenTK.dbo.d_nuorten_aikuisten_koulutus d4 on d4.id=f.nuorten_aikuisten_koulutus_id
left join VipunenTK.dbo.d_aidinkieli_versio1 d5 on d5.id=f.aidinkieli_versio1_id

left join VipunenTK.dbo.d_opetushallinnon_koulutus d7 on d7.id=f.opetushallinnon_koulutus_id
left join VipunenTK.dbo.d_tutkinnon_tavoite d8 on d8.id=f.tutkinnon_tavoite_id
left join VipunenTK.dbo.d_ika d9 on d9.id=f.ika_kirjoihintulovuonna_id
left join VipunenTK.dbo.d_ika d10 on d10.id=f.ikaryhma_kirjoihintulovuonna_id
left join VipunenTK.dbo.d_ika d11 on d11.id=f.ika_id
left join VipunenTK.dbo.d_ika d12 on d12.id=f.ikaryhma_id

left join VipunenTK.dbo.d_opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus d13 on d13.id=f.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_id
left join VipunenTK.dbo.d_koulutuksen_jarjestamismuoto d14 on d14.id=f.koulutuksen_jarjestamismuoto_id
left join VipunenTK.dbo.d_ammatillisen_koulutuksen_koulutuslaji d15 on d15.id=f.ammatillisen_koulutuksen_koulutuslaji_id
left join VipunenTK.dbo.d_koulutusluokitus d16 on d16.id=f.koulutusluokitus_id
left join VipunenTK.dbo.d_koulutusohjelma_ammpk d17 on d17.id=f.koulutusohjelma_ammpk_id
left join VipunenTK.dbo.d_rahoituslahde_amm d18 on d18.id=f.rahoituslahde_amm_id
left join VipunenTK.dbo.d_tutkintonimike_ammpk d19 on d19.id=f.tutkintonimike_ammpk_id
left join VipunenTK.dbo.d_kieli d20 on d20.id=f.koulutuksen_kieli_id

left join VipunenTK.dbo.d_alueluokitus d22 on d22.id=f.koulutuksen_kunta_id
left join VipunenTK.dbo.d_oppilaitoksen_taustatiedot d23 on d23.id=f.yht_koulutuksen_jarjestaja_id
left join VipunenTK.dbo.d_oppilaitoksen_taustatiedot d23b on d23b.oppilaitos_avain=d23.koulutuksen_jarjestajan_korvaavakoodi
left join VipunenTK.dbo.d_alueluokitus d24 on d24.id=f.yht_koulutuksen_jarjestaja_kunta_id
left join VipunenTK.dbo.d_koulutussektori d26 on d26.id=f.koulutussektori_id
left join VipunenTK.dbo.d_koulutuksen_tavoite_toteuma d27 on d27.id=f.koulutuksen_tavoite_toteuma_id




UNION ALL

--tutkinnot
select
	[Tilastovuosi] = f.tilastointivuosi
	
	,[Sukupuoli] = d1.sukupuoli
	,[Äidinkieli] = d5.aidinkieli_versio1
	,[Ikä kirjoihintulovuonna] = d9.ika
	,[Ikäryhmä I kirjoihintulovuonna] = d9.ika5v
	,[Ikäryhmä II kirjoihintulovuonna] = d10.ika
	,[Ikä] = d11.ika
	,[Ikäryhmä I] = d11.ika5v
	,[Ikäryhmä II] = d12.ika
	,[Nuorten/aikuisten koul.] = d4.nuorten_aikuisten_koulutus

	,[Hallinnonala] = d7.opetushallinnon_koulutus
	,[Koulutuksen tavoite] = d8.tutkinnon_tavoite
	,[Koko tutkinto / tutk. osa] = d27.tutkinnon_toteuma
	,[Järjestämistapa] = d13.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus
	,[Järjestämismuoto] = d14.koulutuksen_jarjestamismuoto
	,[Tutkintotyyppi] = d15.ammatillisen_koulutuksen_koulutuslaji
	,[Koulutusala] = d16.koulutusala2002
	,[Opintoala] = d16.opintoala2002
	,[Koulutusnimike] = d16.koulutus
	,[Koulutuslaji] = d16.koulutus
	,[Osaamisala] = d17.koulutusohjelma_ammpk
	,[Rahoituslähde] = d18.rahoituslahde_amm
	,[Tutkintonimike] = d19.tutkintonimike_ammpk
	,[Koulutuksen kieli] = d20.kieli
	,[Väylä näyttötutkintoon] = d25.vayla_nayttotutkintoon	
	,[Koulutuksen suuralue] = d22.suuralue
	,[Koulutuksen kunnan kielisuhde] = d22.kielisuhde
	,[Koulutuksen AVI] = d22.avi
	,[Koulutuksen ELY] = d22.ely
	,[Koulutuksen maakunta] = d22.maakunta
	,[Koulutuksen seutukunta] = d22.seutukunta
	,[Koulutuksen sijaintikunnan kuntaryhmä] = d22.kuntaryhma
	,[Koulutuksen kunta] = d22.kunta
	,[Koulutussektori] = d26.koulutussektori

	,[Koulutuksen järjestäjä] = coalesce(nullif(d23b.koulutuksen_jarjestaja,''''),d23.koulutuksen_jarjestaja)
	,[Koulutuksen järjestäjän omistajatyyppi] = d23.koulutuksen_jarjestajan_omistajatyyppi
	,[Koulutuksen järjestäjän suuralue] = d24.suuralue
	,[Koulutuksen järjestäjän kunnan kielisuhde] = d24.kielisuhde
	,[Koulutuksen järjestäjän AVI] = d24.avi
	,[Koulutuksen järjestäjän ELY] = d24.ely
	,[Koulutuksen järjestäjän maakunta] = d24.maakunta
	,[Koulutuksen järjestäjän seutukunta] = d24.seutukunta
	,[Koulutuksen järjestäjän sijaintikunnan kuntaryhmä] = d24.kuntaryhma
	,[Koulutuksen järjestäjän kunta] = d24.kunta

	--mittarit
	,[Aloittaneet2] = null
	,[Opiskelijat2] = null
	,[Tutkinnot2] = f.lukumaara
	,[Ammattiosaamisen näyttöjen lukumäärä] = f.lkm_ammattiosaaminen
	,[Ennen koulutuksen alkua hyväksiluettujen opintoviikkojen määrä] = f.ov_hyvaksiluettu_ennen
	,[Koulutuksen aikana hyväksiluettujen opintoviikkojen määrä] = f.ov_hyvaksiluettu_aikana
	,[Koulutuksen aikana suoritettujen opintoviikkojen määrä] = f.ov_suoritettu_koulutuksen_aikana
	,[Tutkinnon opintoviikot yhteensä] = f.ov_yhteensa
	,[Työssäoppimisen opintoviikkojen määrä] = f.ov_tyossaoppiminen
	,[Tutkintojen osien lukumäärä] = f.lkm_opintokokonaisuus

	--Ruotsi
	,[Statistikår] = f.tilastointivuosi
	,[Kön] = d1.sukupuoli_SV
	,[Modersmål] = d5.aidinkieli_versio1_SV
	,[Ålder (inskrivningsår)] = d9.ika_SV
	,[Åldersgrupp I (inskrivningsår)] = d9.ika5v_SV
	,[Åldersgrupp II (inskrivningsår)] = d10.ika_SV
	,[Ålder] = d11.ika_SV
	,[Åldersgrupp I] = d11.ika5v_SV
	,[Åldersgrupp II] = d12.ika_SV
	,[Ungdoms-/vuxenutbildning] = d4.nuorten_aikuisten_koulutus_SV
	,[Förvaltningsområde] = d7.opetushallinnon_koulutus_SV
	,[Utbildningens mål (studerandens mål i utbildningen)] = d8.tutkinnon_tavoite_SV
	,[Hela examen/del av en examen] = d27.tutkinnon_toteuma_SV
	,[Sättet på vilket utbildningen ordnas] = d13.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_SV
	,[Formen i vilken utbildningen ordnas] = d14.koulutuksen_jarjestamismuoto_SV
	,[Typ av examen] = d15.ammatillisen_koulutuksen_koulutuslaji_SV
	,[Utbildningsområde] = d16.koulutusala2002_SV
	,[Studieområde] = d16.opintoala2002_SV
	,[Utbildningsbenämning] = d16.koulutus_SV
	,[Kompetensområde] = d17.koulutusohjelma_ammpk_SV
	,[Finansieringskälla] = d18.rahoituslahde_amm_SV
	,[Examensbeteckning] = d19.tutkintonimike_ammpk_SV
	,[Utbildningens språk] = d20.kieli_SV
	,[Väg till fristående examen] = d25.vayla_nayttotutkintoon_SV
	,[Utbildningens område] = d22.suuralue_SV
	,[Utbildningens kommunens språkliga indelning] = d22.kielisuhde_SV
	,[Utbildningens RFV-område] = d22.avi_SV
	,[Utbildningens NMT-område] = d22.ely_SV
	,[Utbildningens landskap] = d22.maakunta_SV
	,[Utbildningens ekonomisk region] = d22.seutukunta_SV
	,[Utbildningens kommungrupp] = d22.kuntaryhma_SV
	,[Utbildningens kommun] = d22.kunta_SV

	,[Utbildningsordnare] = coalesce(nullif(d23b.koulutuksen_jarjestaja_SV,''''),d23.koulutuksen_jarjestaja_SV)
	,[Utbildningsanordnarens ägartyp] = d23.koulutuksen_jarjestajan_omistajatyyppi_SV
	,[Utbildningsordnarens storområde] = d24.suuralue_SV
	,[Utbildningsordnarens kommunens språkliga indelning] = d24.kielisuhde_SV
	,[Utbildningsordnarens RFV-område] = d24.avi_SV
	,[Utbildningsordnarens NMT-område] = d24.ely_SV
	,[Utbildningsordnarens landskap] = d24.maakunta_SV
	,[Utbildningsordnarens ekonomisk region] = d24.seutukunta_SV
	,[Utbildningsordnarens kommungrupp] = d24.kuntaryhma_SV
	,[Utbildningsordnarens kommun] = d24.kunta_SV
	
	--Englanti
	,[Statistical year] = f.tilastointivuosi
	,[Gender] = d1.sukupuoli_EN
	,[Mother tongue] = d5.aidinkieli_versio1_EN
	,[Age (year of entry)] = d9.ika_EN
	,[Age group I (year of entry)] = d9.ika5v_EN
	,[Age group II (year of entry)] = d10.ika_EN
	,[Age] = d11.ika_EN
	,[Age group I] = d11.ika5v_EN
	,[Age group II] = d12.ika_EN
	,[Youth/adult education] = d4.nuorten_aikuisten_koulutus_EN
	,[Administrative sector] = d7.opetushallinnon_koulutus_EN
	,[Objective of education (the student''s objective for attaining education)] = d8.tutkinnon_tavoite_EN
	,[Complete qualification/module] = d27.tutkinnon_toteuma_EN
	,[Method of vocational education and training] = d13.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_EN
	,[Form of vocational education and training] = d14.koulutuksen_jarjestamismuoto_EN
	,[Qualification type] = d15.ammatillisen_koulutuksen_koulutuslaji_EN
	,[Field of education] = d16.koulutusala2002_EN
	,[Subfield of education] = d16.opintoala2002_EN
	,[Name of education] = d16.koulutus_EN
	,[OsaamisalaEN] = d17.koulutusohjelma_ammpk_EN
	,[Source of funding] = d18.rahoituslahde_amm_EN
	,[Qualification title] = d19.tutkintonimike_ammpk_EN
	,[Language of education] = d20.kieli_EN
	,[Route to competence-based qualification] = d25.vayla_nayttotutkintoon_EN
	,[Major region of education] = d22.suuralue_EN
	,[Lang. distribution of municipality of education] = d22.kielisuhde_EN
	,[AVI area of education] = d22.avi_EN
	,[ELY area of education] = d22.ely_EN
	,[Region of education] = d22.maakunta_EN
	,[Subregion of education] = d22.seutukunta_EN
	,[Municipality group of education] = d22.kuntaryhma_EN
	,[Municipality of ecucation] = d22.kunta_EN

	,[Education provider] = coalesce(nullif(d23b.koulutuksen_jarjestaja_EN,''''),d23.koulutuksen_jarjestaja_EN)
	,[Type of education provider owner] = d23.koulutuksen_jarjestajan_omistajatyyppi_EN
	,[Major region of the education provider] = d24.suuralue_EN
	,[Lang. distribution of municipality of the education provider] = d24.kielisuhde_EN
	,[AVI area of the education provider] = d24.avi_EN
	,[ELY area of the education provider] = d24.ely_EN
	,[Region of the education provider] = d24.maakunta_EN
	,[Subregion of the education provider] = d24.seutukunta_EN
	,[Municipality group of the education provider] = d24.kuntaryhma_EN
	,[Municipality of the education provider] = d24.kunta_EN


	--koodimuuttujat
	,[Koodit Koulutuksen maakunta] = d22.maakunta_koodi
	,[Koodit Koulutuksen kunta] = d22.kunta_koodi
	,[Koodit Koulutuksen järjestäjän maakunta] = d24.maakunta_koodi
	,[Koodit Koulutuksen järjestäjän kunta] = d24.kunta_koodi
	,[Koodit Koulutusala] = d16.koulutusala2002_koodi
	,[Koodit Opintoala] = d16.opintoala2002_koodi
	,[Koodit Koulutusnimike] = d16.koulutus_koodi
	,[Koodit Osaamisala] = d17.koulutusohjelma_ammpk_koodi
	,[Koodit Koulutuksen järjestäjä] = coalesce(nullif(d23b.koulutuksen_jarjestajakoodi,''''),d23.koulutuksen_jarjestajakoodi)
	,d16.iscle2011_koodi as "Koodit Koulutusaste, taso 1"
	,d16.Koulutusaste_taso2_koodi as "Koodit Koulutusaste, taso 2"
	,d16.iscfibroad2013_koodi as "Koodit Koulutusala, taso 1"
	,d16.iscfinarrow2013_koodi as "Koodit Koulutusala, taso 2"
	,d16.iscfi2013_koodi as "Koodit Koulutusala, taso 3"

	--isced
	,d16.iscle2011 as "Koulutusaste, taso 1"
	,d16.Koulutusaste_taso2 as "Koulutusaste, taso 2"
	,d16.iscfibroad2013 as "Koulutusala, taso 1"
	,d16.iscfinarrow2013 as "Koulutusala, taso 2"
	,d16.iscfi2013 as "Koulutusala, taso 3"
	,d16.iscle2011_SV as "Utbildn.nivå, nivå 1"
	,d16.Koulutusaste_taso2_SV as "Utbildn.nivå, nivå 2"
	,d16.iscfibroad2013_SV as "Utbildn.område, nivå 1"
	,d16.iscfinarrow2013_SV as "Utbildn.område, nivå 2"
	,d16.iscfi2013_SV as "Utbildn.område, nivå 3"
	,d16.iscle2011_EN as "Level of education, tier 1"
	,d16.Koulutusaste_taso2_EN as "Level of education, tier 2"
	,d16.iscfibroad2013_EN as "Field of education, tier 1"
	,d16.iscfinarrow2013_EN as "Field of education, tier 2"
	,d16.iscfi2013_EN as "Field of education, tier 3"
	,d16.jarjestys_iscle2011 as jarj_isced_koulast1
	,d16.jarjestys_Koulutusaste_taso2 as jarj_isced_koulast2
	,d16.jarjestys_iscfibroad2013 as jarj_isced_koulala1
	,d16.jarjestys_iscfinarrow2013 as jarj_isced_koulala2
	,d16.jarjestys_iscfi2013 as jarj_isced_koulala3

	--järjestys
	,[Sukupuoli jarj] = d1.jarjestys
	,[Äidinkieli jarj] = d5.jarjestys
	,[Ikä kirj jarj] = d9.jarjestys_ika
	,[Ikä5v kirj jarj] = d9.jarjestys_ika5v
	,[Ikäryhmä kirj jarj] = d10.jarjestys_ika
	,[Ikä jarj] = d11.jarjestys_ika
	,[Ikä5v jarj] = d11.jarjestys_ika5v
	,[Ikäryhmä jarj] = d12.jarjestys_ika
	,[Nuorten/aikuisten jarj] = d4.jarjestys
	,[Hallinnonala jarj] = d7.jarjestys
	,[Koulutuksen tavoite jarj] = d8.jarjestys
	,[Koko tutkinto / tutk. osa jarj] = d27.jarjestys
	,[Järjestämistapa jarj] = d13.jarjestys
	,[Järjestämismuoto jarj] = d14.jarjestys
	,[Tutkintotyyppi jarj] = d15.jarjestys
	,[Koulutusala jarj] = d16.jarjestys_koulutusala2002
	,[Opintoala jarj] = d16.jarjestys_opintoala2002
	,[Koulutusnimike jarj] = d16.jarjestys
	,[Osaamisala jarj] = d17.jarjestys
	,[Rahoituslähde jarj] = d18.jarjestys
	,[Tutkintonimike jarj] = d19.jarjestys
	,[Koulutuksen kieli jarj] = d20.jarjestys
	,[Väylä näyttötutkintoon jarj] = d25.jarjestys
	,[Koulutuksen suuralue jarj] = d22.jarjestys_suuralue
	,[Koulutuksen kunnan kielisuhde jarj] = d22.jarjestys_kielisuhde
	,[Koulutuksen AVI jarj] = d22.jarjestys_avi
	,[Koulutuksen ELY jarj] = d22.jarjestys_ely
	,[Koulutuksen maakunta jarj] = d22.jarjestys_maakunta
	,[Koulutuksen seutukunta jarj] = d22.jarjestys_seutukunta
	,[Koulutuksen sijaintikunnan kuntaryhmä jarj] = d22.jarjestys_kuntaryhma
	,[Koulutuksen järjestäjän omistajatyyppi jarj] = d23.jarjestys_omistajatyyppi
	,[Koulutuksen järjestäjän suuralue jarj] = d24.jarjestys_suuralue
	,[Koulutuksen järjestäjän kunnan kielisuhde jarj] = d24.jarjestys_kielisuhde
	,[Koulutuksen järjestäjän AVI jarj] = d24.jarjestys_avi
	,[Koulutuksen järjestäjän ELY jarj] = d24.jarjestys_ely
	,[Koulutuksen järjestäjän maakunta jarj] = d24.jarjestys_maakunta
	,[Koulutuksen järjestäjän seutukunta jarj] = d24.jarjestys_seutukunta
	,[Koulutuksen järjestäjän sijaintikunnan kuntaryhmä jarj] = d24.jarjestys_kuntaryhma



from [dbo].[f_2_4efg_Lukiokoulutuksen_ja_ammatillisen_koulutuksen_tutkinnot] f
left join VipunenTK.dbo.d_sukupuoli d1 on d1.id=f.sukupuoli_id
left join VipunenTK.dbo.d_nuorten_aikuisten_koulutus d4 on d4.id=f.nuorten_aikuisten_koulutus_id
left join VipunenTK.dbo.d_aidinkieli_versio1 d5 on d5.id=f.aidinkieli_versio1_id
--left join VipunenTK.dbo.d_lukiokoulutuksen_koulutuslaji d6 on d6.id=f.lukiokoulutuksen_koulutuslaji_id
left join VipunenTK.dbo.d_opetushallinnon_koulutus d7 on d7.id=f.opetushallinnon_koulutus_id
left join VipunenTK.dbo.d_tutkinnon_tavoite d8 on d8.id=f.tutkinnon_tavoite_id
left join VipunenTK.dbo.d_ika d9 on d9.id=f.ika_kirjoihintulovuonna_id
left join VipunenTK.dbo.d_ika d10 on d10.id=f.ikaryhma_kirjoihintulovuonna_id
left join VipunenTK.dbo.d_ika d11 on d11.id=f.ika_id
left join VipunenTK.dbo.d_ika d12 on d12.id=f.ikaryhma_id
left join VipunenTK.dbo.d_opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus d13 on d13.id=f.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_id
left join VipunenTK.dbo.d_koulutuksen_jarjestamismuoto d14 on d14.id=f.koulutuksen_jarjestamismuoto_id
left join VipunenTK.dbo.d_ammatillisen_koulutuksen_koulutuslaji d15 on d15.id=f.ammatillisen_koulutuksen_koulutuslaji_id
left join VipunenTK.dbo.d_koulutusluokitus d16 on d16.id=f.koulutusluokitus_id
left join VipunenTK.dbo.d_koulutusohjelma_ammpk d17 on d17.id=f.koulutusohjelma_ammpk_id
left join VipunenTK.dbo.d_rahoituslahde_amm d18 on d18.id=f.rahoituslahde_amm_id
left join VipunenTK.dbo.d_tutkintonimike_ammpk d19 on d19.id=f.tutkintonimike_ammpk_id
left join VipunenTK.dbo.d_kieli d20 on d20.id=f.koulutuksen_kieli_id
left join VipunenTK.dbo.d_alueluokitus d22 on d22.id=f.yht_koulutuksen_kunta_id
left join VipunenTK.dbo.d_oppilaitoksen_taustatiedot d23 on d23.id=f.yht_koulutuksen_jarjestaja_id
left join VipunenTK.dbo.d_oppilaitoksen_taustatiedot d23b on d23b.oppilaitos_avain=d23.koulutuksen_jarjestajan_korvaavakoodi
left join VipunenTK.dbo.d_alueluokitus d24 on d24.id=f.yht_koulutuksen_jarjestaja_kunta_id
left join VipunenTK.dbo.d_vayla_nayttotutkintoon d25 on d25.id=f.vayla_nayttotutkintoon_id
left join VipunenTK.dbo.d_koulutussektori d26 on d26.id=f.koulutussektori_id
left join VipunenTK.dbo.d_tutkinnon_toteuma d27 on d27.id=f.tutkinnon_toteuma_id
























' 
GO
/****** Object:  View [dbo].[v_f_tab_tutkinnon_suorittaneiden_aikaisempi_koulutus_yhteiset]    Script Date: 21.6.2017 10:17:26 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_tutkinnon_suorittaneiden_aikaisempi_koulutus_yhteiset]'))
EXEC dbo.sp_executesql @statement = N'

















CREATE VIEW [dbo].[v_f_tab_tutkinnon_suorittaneiden_aikaisempi_koulutus_yhteiset] AS

Select [henkiloiden_lkm]
,[lu_henkiloiden_lkm]
,[amm_henkiloiden_lkm]
,[opist_henkiloiden_lkm]
,[ammka_henkiloiden_lkm]
,[amk_henkiloiden_lkm]
,[akk_henkiloiden_lkm]
,[ylamklkm_henkiloiden_lkm]
,[ykk_henkiloiden_lkm]
,[laaker_henkiloiden_lkm]
,[lis_henkiloiden_lkm]
,[toht_henkiloiden_lkm]
,[Aiemman_yliopistotutkinnon_suorittaneiden_lkm] as ai_yliop_lkm
,[Aiemman_yo_jatkotutkinnon_suorittaneiden_lkm] as ai_yo_jatko_lkm
,[Aiemman_opisto_tai_ammatillisen_korkea_asteen_tutkinnon_suorittaneiden_lkm] as ai_opisto_ammkork_lkm
,[Aiemman_korkeakoulututkinnon_suorittaneiden_lkm] as ai_kork_lkm
,[Aiemman_toisen_asteen_tutkinnon_suorittaneiden_lkm] as ai_toinenaste_lkm
,[Aiemman_ammatillisen_tutkinnon_ryhma1_suorittaneiden_lkm] as ai_ammryhma1_lkm
,[Aiemman_ammatillisen_tutkinnon_ryhma2_suorittaneiden_lkm] as ai_ammryhma2_lkm
,[Aiemman_ammatillisen_tutkinnon_ryhma3_suorittaneiden_lkm] as ai_ammryhma3_lkm
,[Ei_aiempaa_perusasteen_jalkeista_tutkintoa_lkm]
,[Tilastovuosi] AS Tilastovuosi
,d1.tarkastelujakso AS Tarkastelujakso
,d2.aidinkieli_versio1 AS Äidinkieli
,d3.koulutusaste2002 as Koulutusaste
,d3.koulutusala2002 as "Koulutusala (02 luokitus)"
,d3.opintoala1995 as "Koulutusala (95 luokitus)"
,d3.opintoala2002 as Opintoala
,d3.koulutus as Koulutusnimike
,d4.sukupuoli AS Sukupuoli
,ISNULL(NULLIF([suorv],''''),''Tuntematon'') as "Tutkinnon suoritusvuosi"
,d5.lukukausiselite as "Tutkinnon suorituslukukausi"
,ISNULL(NULLIF([alvv],''''),''Tuntematon'') as "Aloitusvuosi"
,d6.lukukausiselite as "Aloituslukukausi"
,[syntv] as "Syntymävuosi"
,ISNULL(NULLIF([lusuorv],''''),''Tuntematon'') as "Yo-tutkinnon suoritusvuosi"
,ISNULL(NULLIF([ammsuorv],''''),''Tuntematon'') as "Amm. tutkinnon suoritusvuosi"
,ISNULL(NULLIF([opistsuorv],''''),''Tuntematon'') as "Opistoast. tutkinnon suoritusvuosi"
,ISNULL(NULLIF([ammkasuorv],''''),''Tuntematon'') as "Amm. kork.asteen tutk. suoritusvuosi"
,ISNULL(NULLIF([amksuorv],''''),''Tuntematon'') as "Amk-tutkinnon suoritusvuosi"
,ISNULL(NULLIF([akksuorv],''''),''Tuntematon'') as "Alemman kk-tutk. suoritusvuosi"
,ISNULL(NULLIF([ylamksuorv],''''),''Tuntematon'') as "Ylemmän amk-tutk. suoritusvuosi"
,ISNULL(NULLIF([ykksuorv],''''),''Tuntematon'')  as "Ylemmän kk-tutk. suoritusvuosi"
,ISNULL(NULLIF([laakersuorv],''''),''Tuntematon'') as "Lääk. erikois.tutk. suoritusvuosi"
,ISNULL(NULLIF([lissuorv],''''),''Tuntematon'')  as "Lisensiaatin tutk. suoritusvuosi"
,ISNULL(NULLIF([tohtsuorv],''''),''Tuntematon'') as "Tohtorin tutk. suorituvuosi"
,d7.oppisopimuskoulutus as "Oppisopimuskoulutus"
,d8.ammatillisen_koulutuksen_koulutuslaji as "Tutkintotyyppi"
,d9.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus as "Järjestämistapa"
,d10.nuorten_aikuisten_koulutus_amm as "Nuorten/aikuisten koulutus"
,d11.ika as Ikä
,d11.ika5v as Ikäryhmä
,d12.koulutus as "Yo-tutkinnon koulutusnimike"
,d13.tutkinto_suoritettu as "Aik. suoritettu yo-tutkinto"
,d14.koulutuksesta_kulunut_aika as "Yo-tutkinnosta kulunut aika"
,d141.nuorten_aikuisten_koulutus_amm as "Nuorten/aikuisten koulutus (yo)"
,d15.koulutusala2002 as "Amm. tutkinnon koulutusala"
,d15.opintoala2002 as "Amm. tutkinnon opintoala"
,d15.koulutus as "Amm. tutkinnon koulutusnimike"
,d16.tutkinto_suoritettu as "Aik. suoritettu amm. tutkinto"
,d17.koulutuksesta_kulunut_aika as "Amm. tutkinnosta kulunut aika"
,d171.ammatillisen_koulutuksen_koulutuslaji as "Amm. tutkinnon tutkintotyyppi"
,d172.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus as "Amm. tutkinnon järjestämistapa"
,d173.oppisopimuskoulutus as "Amm. tutkinto oppisopimuskoul."
,d174.tutkintojen_maara as "Amm. tutkintojen määrä"
,d175.ammatillisen_koulutuksen_luokittelu_4_7_4_8 as "Amm. koulutuksen ryhmät"
,d18.koulutusala2002 as "Opistoast. tutkinnon koulutusala"
,d18.opintoala2002 as "Opistoast. tutkinnon opintoala"
,d18.koulutus as "Opistoast. tutkinnon koulutusnimike"
,d19.tutkinto_suoritettu as "Aik. suoritettu opistoast. tutkinto"
,d20.koulutuksesta_kulunut_aika as "Opistoast. tutkinnosta kulunut aika"
,d21.koulutusala2002 as "Amm. kork.asteen tutk. koulutusala"
,d21.opintoala2002 as "Amm. kork.asteen tutk. opintoala"
,d21.koulutus as "Amm. kork.asteen tutk. koulutusnimike"
,d22.tutkinto_suoritettu as "Aik. suoritettu amm. kork.asteen tutkinto"
,d23.koulutuksesta_kulunut_aika as "Amm. kork.asteen tutk. kulunut aika"
,d24.koulutusala2002 as "Amk-tutkinnon koulutusala"
,d24.opintoala2002 as "Amk-tutkinnon opintoala"
,d24.koulutus as "Amk-tutkinnon koulutusnimike"
,d25.tutkinto_suoritettu as "Aik. suoritettu amk-tutkinto"
,d26.koulutuksesta_kulunut_aika as "Amk-tutkinnosta kulunut aika"
,d261.tutkintojen_maara as "Amk-tutkintojen määrä"
,d262.aikuisopiskelija as "Nuorten/aikuisten koulutus (amk)"
,d27.koulutusala2002 as "Alemman kk-tutk. koulutusala (02)"
,d27.opintoala1995 as "Alemman kk-tutk. koulutusala (95)"
,d27.opintoala2002 as "Alemman kk-tutk. opintoala"
,d27.koulutus as "Alemman kk-tutk. koulutusnimike"
,d28.tutkinto_suoritettu as "Aik. suoritettu alempi kk-tutkinto"
,d29.koulutuksesta_kulunut_aika as "Alemmasta kk-tutk. kulunut aika"
,d291.tutkintojen_maara as "Alempien kk-tutkintojen määrä"
,d30.koulutusala2002 as "Ylemmän amk-tutk. koulutusala"
,d30.opintoala2002 as "Ylemmän amk-tutk. opintoala"
,d30.koulutus as "Ylemmän amk-tutk. koulutusnimike"
,d31.tutkinto_suoritettu as "Aik. suoritettu ylempi amk-tutkinto"
,d32.koulutuksesta_kulunut_aika as "Ylemmästä amk-tutk. kulunut aika"
,d33.koulutusala2002 as "Ylemmän kk-tutk. koulutusala (02)"
,d33.opintoala1995 as "Ylemmän kk-tutk. koulutusala (95)"
,d33.opintoala2002 as "Ylemmän kk-tutk. opintoala"
,d33.koulutus as "Ylemmän kk-tutk. koulutusnimike"
,d34.tutkinto_suoritettu as "Aik. suoritettu ylempi kk-tutkinto"
,d35.koulutuksesta_kulunut_aika as "Ylemmästä kk-tutk. kulunut aika"
,d351.tutkintojen_maara as "Ylempien kk-tutkintojen määrä"
,d36.koulutus as "Lääk. erikois.tutk. koulutusnimike"
,d37.tutkinto_suoritettu as "Aik. suoritettu lääk. erikois.tutk."
,d38.koulutuksesta_kulunut_aika as "Lääk. erikois.tutk. kulunut aika"
,d39.koulutusala2002 as "Lisensiaatin tutk. koulutusala (02)"
,d39.opintoala1995 as "Lisensiaatin tutk. koulutusala (95)"
,d39.opintoala2002 as "Lisensiaatin tutk. opintoala"
,d39.koulutus as "Lisensiaatin tutk. koulutusnimike"
,d40.tutkinto_suoritettu as "Aik. suoritettu lisensiaatin tutk."
,d41.koulutuksesta_kulunut_aika as "Lisensiaatin tutk. kulunut aika"
,d42.koulutusala2002 as "Tohtorin tutk. koulutusala (02)"
,d42.opintoala1995 as "Tohtorin tutk. koulutusala (95)"
,d42.opintoala2002 as "Tohtorin tutk. opintoala"
,d42.koulutus as "Tohtorin tutk. koulutusnimike"
,d43.tutkinto_suoritettu as "Aik. suoritettu tohtorin tutk."
,d44.koulutuksesta_kulunut_aika as "Tohtorin tutk. kulunut aika"
,d45.tutkinto_suoritettu as "Aik. suoritettu yliopistotutkinto"
,d46.tutkinto_suoritettu as "Aik. suoritettu yo-jatkotutkinto"
,d47.tutkinto_suoritettu as "Aik. suoritettu opistoast. tai amm. kork.ast. tutkinto"
,d48.tutkinto_suoritettu as "Aik. suoritettu korkeakoulututkinto"
,d49.tutkinto_suoritettu as "Aik. suoritettu toisen asteen tutkinto"
,d50.tutkinto_suoritettu as "Aik. suoritettu amm. tutkinto (ryhmä 1)"
,d51.tutkinto_suoritettu as "Aik. suoritettu amm. tutkinto (ryhmä 2)"
,d52.tutkinto_suoritettu as "Aik. suoritettu amm. tutkinto (ryhmä 3)"
,d53.sama_koulutusala as "Yo-tutkinto samalla koul.alalla (02)"
,d54.sama_koulutusala as "Amm. tutk. samalla koul.alalla (02)"
,d55.sama_koulutusala as "Opistoast. tutk. samalla koul.alalla (02)"
,d56.sama_koulutusala as "Amm. ka. tutk. samalla koul.alalla (02)"
,d57.sama_koulutusala as "Amk-tutkinto samalla koul.alalla (02)"
,d58.sama_koulutusala as "Alempi kk-tutk. samalla koul.alalla (02)"
,d59.sama_koulutusala as "Ylempi amk-tutk. samalla koul.alalla (02)"
,d60.sama_koulutusala as "Ylempi kk-tutk. samalla koul.alalla (02)"
,d61.sama_koulutusala as "Laak. erik.tutk. samalla koul.alalla (02)"
,d62.sama_koulutusala as "Lis. tutkinto samalla koul.alalla (02)"
,d63.sama_koulutusala as "Toht. tutkinto samalla koul.alalla (02)"
,d64.sama_koulutusala as "Yliopistotutk. samalla koul.alalla (02)"
,d65.sama_koulutusala as "Yo-jatkotutk. samalla koul.alalla (02)"
,d66.sama_koulutusala as "Opisto/amm.ka. tutk. samalla koul.alalla (02)"
,d67.sama_koulutusala as "Korkeak.tutk. samalla koul.alalla (02)"
,d68.sama_koulutusala as "Toisen asteen tutk. samalla koul.alalla (02)"
,d69.sama_koulutusala as "Yo-tutkinto samalla op.alalla"
,d70.sama_koulutusala as "Amm. tutk. samalla op.alalla"
,d71.sama_koulutusala as "Opistoast. tutk. samalla op.alalla"
,d72.sama_koulutusala as "Amm. ka. tutk. samalla op.alalla"
,d73.sama_koulutusala as "Amk-tutkinto samalla op.alalla"
,d74.sama_koulutusala as "Alempi kk-tutk. samalla op.alalla"
,d75.sama_koulutusala as "Ylempi amk-tutk. samalla op.alalla"
,d76.sama_koulutusala as "Ylempi kk-tutk. samalla op.alalla"
,d77.sama_koulutusala as "Laak. erik.tutk. samalla op.alalla"
,d78.sama_koulutusala as "Lis. tutkinto samalla op.alalla"
,d79.sama_koulutusala as "Toht. tutkinto samalla op.alalla"
,d80.sama_koulutusala as "Yliopistotutk. samalla op.alalla"
,d81.sama_koulutusala as "Yo-jatkotutk. samalla op.alalla"
,d82.sama_koulutusala as "Opisto/amm.ka. tutk. samalla op.alalla"
,d83.sama_koulutusala as "Korkeak.tutk. samalla op.alalla"
,d84.sama_koulutusala as "Toisen asteen tutk. samalla op.alalla"
,d85.sama_koulutusala as "Yo-tutkinto samalla koul.alalla (95)"
,d86.sama_koulutusala as "Amm. tutk. samalla koul.alalla (95)"
,d87.sama_koulutusala as "Opistoast. tutk. samalla koul.alalla (95)"
,d88.sama_koulutusala as "Amm. ka. tutk. samalla koul.alalla (95)"
,d89.sama_koulutusala as "Amk-tutkinto samalla koul.alalla (95)"
,d90.sama_koulutusala as "Alempi kk-tutk. samalla koul.alalla (95)"
,d91.sama_koulutusala as "Ylempi amk-tutk. samalla koul.alalla (95)"
,d92.sama_koulutusala as "Ylempi kk-tutk. samalla koul.alalla (95)"
,d93.sama_koulutusala as "Laak. erik.tutk. samalla koul.alalla (95)"
,d94.sama_koulutusala as "Lis. tutkinto samalla koul.alalla (95)"
,d95.sama_koulutusala as "Toht. tutkinto samalla koul.alalla (95)"
,d96.sama_koulutusala as "Yliopistotutk. samalla koul.alalla (95)"
,d97.sama_koulutusala as "Yo-jatkotutk. samalla koul.alalla (95)"
,d98.sama_koulutusala as "Opisto/amm.ka. tutk. samalla koul.alalla (95)"
,d99.sama_koulutusala as "Korkeak.tutk. samalla koul.alalla (95)"
,d100.sama_koulutusala as "Toisen asteen tutk. samalla koul.alalla (95)"
,d101.sama_koulutusala as "Yo-tutkinto samalla koul.alalla 1"
,d102.sama_koulutusala as "Amm. tutk. samalla koul.alalla 1"
,d103.sama_koulutusala as "Opistoast. tutk. samalla koul.alalla 1"
,d104.sama_koulutusala as "Amm. ka. tutk. samalla koul.alalla 1"
,d105.sama_koulutusala as "Amk-tutkinto samalla koul.alalla 1"
,d106.sama_koulutusala as "Alempi kk-tutk. samalla koul.alalla 1"
,d107.sama_koulutusala as "Ylempi amk-tutk. samalla koul.alalla 1"
,d108.sama_koulutusala as "Ylempi kk-tutk. samalla koul.alalla 1"
,d109.sama_koulutusala as "Laak. erik.tutk. samalla koul.alalla 1"
,d110.sama_koulutusala as "Lis. tutkinto samalla koul.alalla 1"
,d111.sama_koulutusala as "Toht. tutkinto samalla koul.alalla 1"
,d112.sama_koulutusala as "Yliopistotutk. samalla koul.alalla 1"
,d113.sama_koulutusala as "Yo-jatkotutk. samalla koul.alalla 1"
,d114.sama_koulutusala as "Opisto/amm.ka. tutk. samalla koul.alalla 1"
,d115.sama_koulutusala as "Korkeak.tutk. samalla koul.alalla 1"
,d116.sama_koulutusala as "Toisen asteen tutk. samalla koul.alalla 1"
,d117.sama_koulutusala as "Yo-tutkinto samalla koul.alalla 2"
,d118.sama_koulutusala as "Amm. tutk. samalla koul.alalla 2"
,d119.sama_koulutusala as "Opistoast. tutk. samalla koul.alalla 2"
,d120.sama_koulutusala as "Amm. ka. tutk. samalla koul.alalla 2"
,d121.sama_koulutusala as "Amk-tutkinto samalla koul.alalla 2"
,d122.sama_koulutusala as "Alempi kk-tutk. samalla koul.alalla 2"
,d123.sama_koulutusala as "Ylempi amk-tutk. samalla koul.alalla 2"
,d124.sama_koulutusala as "Ylempi kk-tutk. samalla koul.alalla 2"
,d125.sama_koulutusala as "Laak. erik.tutk. samalla koul.alalla 2"
,d126.sama_koulutusala as "Lis. tutkinto samalla koul.alalla 2"
,d127.sama_koulutusala as "Toht. tutkinto samalla koul.alalla 2"
,d128.sama_koulutusala as "Yliopistotutk. samalla koul.alalla 2"
,d129.sama_koulutusala as "Yo-jatkotutk. samalla koul.alalla 2"
,d130.sama_koulutusala as "Opisto/amm.ka. tutk. samalla koul.alalla 2"
,d131.sama_koulutusala as "Korkeak.tutk. samalla koul.alalla 2"
,d132.sama_koulutusala as "Toisen asteen tutk. samalla koul.alalla 2"
--jarjestysmuuttujat
,d1.jarjestys AS jarj_tarkastelujakso
,d2.jarjestys AS jarj_aidinkieli
,d3.jarjestys_koulutusaste2002
,d3.jarjestys_koulutusala2002
,d3.jarjestys_opintoala1995
,d3.jarjestys_opintoala2002
,d3.jarjestys as jarj_koulnimike
,d7.jarjestys as jarj_oppis
,d8.jarjestys as jarj_tutktyyppi
,d9.jarjestys as jarj_jarjtapa
,d10.jarjestys as jarj_nuoretaikuisetamm
,d11.jarjestys_ika as jarj_ika
,d11.jarjestys_ika5v as jarj_ika5v
,d12.jarjestys as jarj_lukio_koulnimike
,d13.jarjestys as jarj_lukio_aiktutk
,d14.jarjestys as jarj_lukio_kulunutaika
,d141.jarjestys as jarj_lukio_nuoretaikuiset
,d15.jarjestys_koulutusala2002 as jarj_amm_koulala
,d15.jarjestys_opintoala2002 as jarj_amm_opala
,d15.jarjestys as jarj_amm_koulnimike
,d16.jarjestys as jarj_amm_aiktutk
,d17.jarjestys as jarj_amm_kulunutaika
,d171.jarjestys as jarj_amm_tutktyyppi
,d172.jarjestys as jarj_amm_jarjtapa
,d173.jarjestys as jarj_amm_oppis
,d174.jarjestys as jarj_amm_tutkmaara
,d175.jarjestys as jarj_amm_ryhma
,d18.jarjestys_koulutusala2002 as jarj_opisto_koulala
,d18.jarjestys_opintoala2002 as jarj_opisto_opala
,d18.jarjestys as jarj_opisto_koulnimike
,d19.jarjestys as jarj_opisto_aiktutk
,d20.jarjestys as jarj_opisto_kulunutaika
,d21.jarjestys_koulutusala2002 as jarj_amm_kork_aste_koulala
,d21.jarjestys_opintoala2002 as jarj_amm_kork_aste_opala
,d21.jarjestys as jarj_amm_kork_aste_koulnimike
,d22.jarjestys as jarj_amm_kork_aste_aiktutk
,d23.jarjestys as jarj_amm_kork_aste_kulunutaika
,d24.jarjestys_koulutusala2002 as jarj_amk_koulala
,d24.jarjestys_opintoala2002 as jarj_amk_opala
,d24.jarjestys as jarj_amk_koulnimike
,d25.jarjestys as jarj_amk_aiktutk
,d26.jarjestys as jarj_amk_kulunutaika
,d261.jarjestys as jarj_amk_tutkmaara
,d262.jarjestys as jarj_amk_nuoraik
,d27.jarjestys_koulutusala2002 as jarj_alempi_kk_koulala02
,d27.jarjestys_opintoala1995 as jarj_alempi_kk_koulala95
,d27.jarjestys_opintoala2002 as jarj_alempi_kk_opala
,d27.jarjestys as jarj_alempi_kk_koulnimike
,d28.jarjestys as jarj_alempi_kk_aiktutk
,d29.jarjestys as jarj_alempi_kk_kulunutaika
,d291.jarjestys as jarj_alempi_kk_tutkmaara
,d30.jarjestys_koulutusala2002 as jarj_ylempi_amk_koulala
,d30.jarjestys_opintoala2002 as jarj_ylempi_amk_opala
,d30.jarjestys as jarj_ylempi_amk_koulnimike
,d31.jarjestys as jarj_ylempi_amk_aiktutk
,d32.jarjestys as jarj_ylempi_amk_kulunutaika
,d33.jarjestys_koulutusala2002 as jarj_ylempi_kk_koulala02
,d33.jarjestys_opintoala1995 as jarj_ylempi_kk_koulala95
,d33.jarjestys_opintoala2002 as jarj_ylempi_kk_opala
,d33.jarjestys as jarj_ylempi_kk_koulnimike
,d34.jarjestys as jarj_ylempi_kk_aiktutk
,d35.jarjestys as jarj_ylempi_kk_kulunutaika
,d351.jarjestys as jarj_ylempi_kk_tutkmaara
,d36.jarjestys as jarj_laak_erik_koulnimike
,d37.jarjestys as jarj_laak_erik_aiktutk
,d38.jarjestys as jarj_laak_erik_kulunutaika
,d39.jarjestys_koulutusala2002 as jarj_lis_koulala02
,d39.jarjestys_opintoala1995 as jarj_lis_koulala95
,d39.jarjestys_opintoala2002 as jarj_lis_opala
,d39.jarjestys as jarj_lis_koulnimike
,d40.jarjestys as jarj_lis_aiktutk
,d41.jarjestys as jarj_lis_kulunutaika
,d42.jarjestys_koulutusala2002 as jarj_toht_koulala02
,d42.jarjestys_opintoala1995 as jarj_toht_koulala95
,d42.jarjestys_opintoala2002 as jarj_toht_opala
,d42.jarjestys as jarj_toht_koulnimike
,d43.jarjestys as jarj_toht_aiktutk
,d44.jarjestys as jarj_toht_kulunutaika
,d45.jarjestys as jarj_yliopisto_aiktutk
,d46.jarjestys as jarj_yojatko_aiktutk
,d47.jarjestys as jarj_opist_aiktutk
,d48.jarjestys as jarj_korkeakoulu_aiktutk
,d49.jarjestys as jarj_toinenaste_aiktutk
,d50.jarjestys as jarj_ammryhma1_aiktutk
,d51.jarjestys as jarj_ammryhma2_aiktutk
,d52.jarjestys as jarj_ammryhma3_aiktutk
,d55.jarjestys as jarj_samakoulutusala02_opisto
,d56.jarjestys as jarj_samakoulutusala02_ammka
,d57.jarjestys as jarj_samakoulutusala02_amk
,d58.jarjestys as jarj_samakoulutusala02_alempikk
,d59.jarjestys as jarj_samakoulutusala02_ylempiamk
,d60.jarjestys as jarj_samakoulutusala02_ylempikk
,d61.jarjestys as jarj_samakoulutusala02_laak
,d62.jarjestys as jarj_samakoulutusala02_lis
,d63.jarjestys as jarj_samakoulutusala02_toht
,d64.jarjestys as jarj_samakoulutusala02_yliopisto
,d65.jarjestys as jarj_samakoulutusala02_yojatko
,d66.jarjestys as jarj_samakoulutusala02_opistoammka
,d67.jarjestys as jarj_samakoulutusala02_korkeak
,d68.jarjestys as jarj_samakoulutusala02_toinenaste
,d69.jarjestys as jarj_samaopintoala02_lu
,d70.jarjestys as jarj_samaopintoala02_amm
,d71.jarjestys as jarj_samaopintoala02_opisto
,d72.jarjestys as jarj_samaopintoala02_ammka
,d73.jarjestys as jarj_samaopintoala02_amk
,d74.jarjestys as jarj_samaopintoala02_alempikk
,d75.jarjestys as jarj_samaopintoala02_ylempiamk
,d76.jarjestys as jarj_samaopintoala02_ylempikk
,d77.jarjestys as jarj_samaopintoala02_laak
,d78.jarjestys as jarj_samaopintoala02_lis
,d79.jarjestys as jarj_samaopintoala02_toht
,d80.jarjestys as jarj_samaopintoala02_yliopisto
,d81.jarjestys as jarj_samaopintoala02_yojatko
,d82.jarjestys as jarj_samaopintoala02_opistoammka
,d83.jarjestys as jarj_samaopintoala02_korkeak
,d84.jarjestys as jarj_samaopintoala02_toinenaste
,d85.jarjestys as jarj_samakoulutusala95_lu
,d86.jarjestys as jarj_samakoulutusala95_amm
,d87.jarjestys as jarj_samakoulutusala95_opisto
,d88.jarjestys as jarj_samakoulutusala95_ammka
,d89.jarjestys as jarj_samakoulutusala95_amk
,d90.jarjestys as jarj_samakoulutusala95_alempikk
,d91.jarjestys as jarj_samakoulutusala95_ylempiamk
,d92.jarjestys as jarj_samakoulutusala95_ylempikk
,d93.jarjestys as jarj_samakoulutusala95_laak
,d94.jarjestys as jarj_samakoulutusala95_lis
,d95.jarjestys as jarj_samakoulutusala95_toht
,d96.jarjestys as jarj_samakoulutusala95_yliopisto
,d97.jarjestys as jarj_samakoulutusala95_yojatko
,d98.jarjestys as jarj_samakoulutusala95_opistoammka
,d99.jarjestys as jarj_samakoulutusala95_korkeak
,d100.jarjestys as jarj_samakoulutusala95_toinenaste
,d101.jarjestys as jarj_samaiscbroad_lu
,d102.jarjestys as jarj_samaiscbroad_amm
,d103.jarjestys as jarj_samaiscbroad_opisto
,d104.jarjestys as jarj_samaiscbroad_ammka
,d105.jarjestys as jarj_samaiscbroad_amk
,d106.jarjestys as jarj_samaiscbroad_alempikk
,d107.jarjestys as jarj_samaiscbroad_ylempiamk
,d108.jarjestys as jarj_samaiscbroad_ylempikk
,d109.jarjestys as jarj_samaiscbroad_laak
,d110.jarjestys as jarj_samaiscbroad_lis
,d111.jarjestys as jarj_samaiscbroad_toht
,d112.jarjestys as jarj_samaiscbroad_yliopisto
,d113.jarjestys as jarj_samaiscbroad_yojatko
,d114.jarjestys as jarj_samaiscbroad_opistoammka
,d115.jarjestys as jarj_samaiscbroad_korkeak
,d116.jarjestys as jarj_samaiscbroad_toinenaste
,d117.jarjestys as jarj_samaiscnarrow_lu
,d118.jarjestys as jarj_samaiscnarrow_amm
,d119.jarjestys as jarj_samaiscnarrow_opisto
,d120.jarjestys as jarj_samaiscnarrow_ammka
,d121.jarjestys as jarj_samaiscnarrow_amk
,d122.jarjestys as jarj_samaiscnarrow_alempikk
,d123.jarjestys as jarj_samaiscnarrow_ylempiamk
,d124.jarjestys as jarj_samaiscnarrow_ylempikk
,d125.jarjestys as jarj_samaiscnarrow_laak
,d126.jarjestys as jarj_samaiscnarrow_lis
,d127.jarjestys as jarj_samaiscnarrow_toht
,d128.jarjestys as jarj_samaiscnarrow_yliopisto
,d129.jarjestys as jarj_samaiscnarrow_yojatko
,d130.jarjestys as jarj_samaiscnarrow_opistoammka
,d131.jarjestys as jarj_samaiscnarrow_korkeak
,d132.jarjestys as jarj_samaiscnarrow_toinenaste
--koodimuuttujat
,d3.koulutus_koodi as "Koodit Koulutusnimike"
,d3.koulutusaste2002_koodi as "Koodit Koulutusaste"
,d3.koulutusala2002_koodi as "Koodit Koulutusala 02"
,d3.opintoala1995_koodi as "Koodit Koulutusala 95"
,d3.opintoala2002_koodi as "Koodit Opintoala"
,d12.koulutus_koodi as "Koodit Yo-tutkinnon koulutusnimike"
,d15.koulutusala2002_koodi as "Koodit Amm. tutkinnon koulutusala"
,d15.opintoala2002_koodi as "Koodit Amm. tutkinnon opintoala"
,d15.koulutus_koodi as "Koodit Amm. tutkinnon koulutusnimike"
,d18.koulutusala2002_koodi as "Koodit Opistoast. tutkinnon koulutusala"
,d18.opintoala2002_koodi as "Koodit Opistoast. tutkinnon opintoala"
,d18.koulutus_koodi as "Koodit Opistoast. tutkinnon koulutusnimike"
,d21.koulutusala2002_koodi as "Koodit Amm. kork.asteen tutk. koulutusala"
,d21.opintoala2002_koodi as "Koodit Amm. kork.asteen tutk. opintoala"
,d21.koulutus_koodi as "Koodit Amm. kork.asteen tutk. koulutusnimike"
,d24.koulutusala2002_koodi as "Koodit Amk-tutkinnon koulutusala"
,d24.opintoala2002_koodi as "Koodit Amk-tutkinnon opintoala"
,d24.koulutus_koodi as "Koodit Amk-tutkinnon koulutusnimike"
,d27.koulutusala2002_koodi as "Koodit Alemman kk-tutk. koulutusala 02"
,d27.opintoala1995_koodi as "Koodit Alemman kk-tutk. koulutusala 95"
,d27.opintoala2002_koodi as "Koodit Alemman kk-tutk. opintoala"
,d27.koulutus_koodi as "Koodit Alemman kk-tutk. koulutusnimike"
,d30.koulutusala2002_koodi as "Koodit Ylemmän amk-tutk. koulutusala"
,d30.opintoala2002_koodi as "Koodit Ylemmän amk-tutk. opintoala"
,d30.koulutus_koodi as "Koodit Ylemmän amk-tutk. koulutusnimike"
,d33.koulutusala2002_koodi as "Koodit Ylemmän kk-tutk. koulutusala 02"
,d33.opintoala1995_koodi as "Koodit Ylemmän kk-tutk. koulutusala 95"
,d33.opintoala2002_koodi as "Koodit Ylemmän kk-tutk. opintoala"
,d33.koulutus_koodi as "Koodit Ylemmän kk-tutk. koulutusnimike"
,d36.koulutus_koodi as "Koodit Lääk. erikois.tutk. koulutusnimike"
,d39.koulutusala2002_koodi as "Koodit Lisensiaatin tutk. koulutusala 02"
,d39.opintoala1995_koodi as "Koodit Lisensiaatin tutk. koulutusala 95"
,d39.opintoala2002_koodi as "Koodit Lisensiaatin tutk. opintoala"
,d39.koulutus_koodi as "Koodit Lisensiaatin tutk. koulutusnimike"
,d42.koulutusala2002_koodi as "Koodit Tohtorin tutk. koulutusala 02"
,d42.opintoala1995_koodi as "Koodit Tohtorin tutk. koulutusala 95"
,d42.opintoala2002_koodi as "Koodit Tohtorin tutk. opintoala"
,d42.koulutus_koodi as "Koodit Tohtorin tutk. koulutusnimike"
,rivinumero
--isced
,d3.iscle2011 as "Koulutusaste, taso 1"
,d3.Koulutusaste_taso2 as "Koulutusaste, taso 2"
,d3.iscfibroad2013 as "Koulutusala, taso 1"
,d3.iscfinarrow2013 as "Koulutusala, taso 2"
,d3.iscfi2013 as "Koulutusala, taso 3"
,d3.OKM_ohjauksen_ala as "OKM ohjauksen ala"
,d3.jarjestys_iscle2011 as jarj_isced_koulast1
,d3.jarjestys_Koulutusaste_taso2 as jarj_isced_koulast2
,d3.jarjestys_iscfibroad2013 as jarj_isced_koulala1
,d3.jarjestys_iscfinarrow2013 as jarj_isced_koulala2
,d3.jarjestys_iscfi2013 as jarj_isced_koulala3
,d3.jarjestys_OKM_ohjauksen_ala as jarj_isced_okmohjaus1
,d3.iscle2011_koodi as "Koodit Koulutusaste, taso 1"
,d3.Koulutusaste_taso2_koodi as "Koodit Koulutusaste, taso 2"
,d3.iscfibroad2013_koodi as "Koodit Koulutusala, taso 1"
,d3.iscfinarrow2013_koodi as "Koodit Koulutusala, taso 2"
,d3.iscfi2013_koodi as "Koodit Koulutusala, taso 3"
,d3.OKM_ohjauksen_ala_koodi as "Koodit OKM ohjauksen ala"
,d12.iscfi2013 as "Yo-tutkinnon koulutusala 3"
,d15.iscfibroad2013 as "Amm. tutkinnon koulutusala 1"
,d15.iscfinarrow2013 as "Amm. tutkinnon koulutusala 2"
,d15.iscfi2013 as "Amm. tutkinnon koulutusala 3"
,d18.iscfibroad2013 as "Opistoast. tutkinnon koulutusala 1"
,d18.iscfinarrow2013 as "Opistoast. tutkinnon koulutusala 2"
,d18.iscfi2013 as "Opistoast. tutkinnon koulutusala 3"
,d21.iscfibroad2013 as "Amm. kork.asteen tutk. koulutusala 1"
,d21.iscfinarrow2013 as "Amm. kork.asteen tutk. koulutusala 2"
,d21.iscfi2013 as "Amm. kork.asteen tutk. koulutusala 3"
,d24.iscfibroad2013 as "Amk-tutkinnon koulutusala 1"
,d24.OKM_ohjauksen_ala as "Amk-tutkinnon OKM ohjauksen ala"
,d24.iscfinarrow2013 as "Amk-tutkinnon koulutusala 2"
,d24.iscfi2013 as "Amk-tutkinnon koulutusala 3"
,d27.iscfibroad2013 as "Alemman kk-tutk. koulutusala 1"
,d27.OKM_ohjauksen_ala as "Alemman kk-tutk. OKM ohjauksen ala"
,d27.iscfinarrow2013 as "Alemman kk-tutk. koulutusala 2"
,d27.iscfi2013 as "Alemman kk-tutk. koulutusala 3"
,d30.iscfibroad2013 as "Ylemmän amk-tutk. koulutusala 1"
,d30.OKM_ohjauksen_ala as "Ylemmän amk-tutk. OKM ohjauksen ala"
,d30.iscfinarrow2013 as "Ylemmän amk-tutk. koulutusala 2"
,d30.iscfi2013 as "Ylemmän amk-tutk. koulutusala 3"
,d33.iscfibroad2013 as "Ylemmän kk-tutk. koulutusala 1"
,d33.OKM_ohjauksen_ala as "Ylemmän kk-tutk. OKM ohjauksen ala"
,d33.iscfinarrow2013 as "Ylemmän kk-tutk. koulutusala 2"
,d33.iscfi2013 as "Ylemmän kk-tutk. koulutusala 3"
,d36.iscfi2013 as "Lääk. erikois.tutk. koulutusala 3"
,d39.iscfibroad2013 as "Lisensiaatin tutk. koulutusala 1"
,d39.OKM_ohjauksen_ala as "Lisensiaatin tutk. OKM ohjauksen ala"
,d39.iscfinarrow2013 as "Lisensiaatin tutk. koulutusala 2"
,d39.iscfi2013 as "Lisensiaatin tutk. koulutusala 3"
,d42.iscfibroad2013 as "Tohtorin tutk. koulutusala 1"
,d42.OKM_ohjauksen_ala as "Tohtorin tutk. OKM ohjauksen ala"
,d42.iscfinarrow2013 as "Tohtorin tutk. koulutusala 2"
,d42.iscfi2013 as "Tohtorin tutk. koulutusala 3"
,d12.jarjestys_iscfi2013 as jarj_lukio_iscfi2013
,d15.jarjestys_iscfibroad2013 as jarj_amm_iscfibroad2013
,d15.jarjestys_iscfinarrow2013 as jarj_amm_iscfinarrow2013
,d15.jarjestys_iscfi2013 as jarj_amm_iscfi2013
,d18.jarjestys_iscfibroad2013 as jarj_opisto_iscfibroad2013
,d18.jarjestys_iscfinarrow2013 as jarj_opisto_iscfinarrow2013
,d18.jarjestys_iscfi2013 as jarj_opisto_iscfi2013
,d21.jarjestys_iscfibroad2013 as jarj_amm_kork_aste_iscfibroad2013
,d21.jarjestys_iscfinarrow2013 as jarj_amm_kork_aste_iscfinarrow2013
,d21.jarjestys_iscfi2013 as jarj_amm_kork_aste_iscfi2013
,d24.jarjestys_iscfibroad2013 as jarj_amk_iscfibroad2013
,d24.jarjestys_OKM_ohjauksen_ala as jarj_amk_OKM_ohjauksen_ala
,d24.jarjestys_iscfinarrow2013 as jarj_amk_iscfinarrow2013
,d24.jarjestys_iscfi2013 as jarj_amk_iscfi2013
,d27.jarjestys_iscfibroad2013 as jarj_alempi_kk_iscfibroad2013
,d27.jarjestys_OKM_ohjauksen_ala as jarj_alempi_kk_OKM_ohjauksen_ala
,d27.jarjestys_iscfinarrow2013 as jarj_alempi_kk_iscfinarrow2013
,d27.jarjestys_iscfi2013 as jarj_alempi_kk_iscfi2013
,d30.jarjestys_iscfibroad2013 as jarj_ylempi_amk_iscfibroad2013
,d30.jarjestys_OKM_ohjauksen_ala as jarj_ylempi_amk_OKM_ohjauksen_ala
,d30.jarjestys_iscfinarrow2013 as jarj_ylempi_amk_iscfinarrow2013
,d30.jarjestys_iscfi2013 as jarj_ylempi_amk_iscfi2013
,d33.jarjestys_iscfibroad2013 as jarj_ylempi_kk_iscfibroad2013
,d33.jarjestys_OKM_ohjauksen_ala as jarj_ylempi_kk_OKM_ohjauksen_ala
,d33.jarjestys_iscfinarrow2013 as jarj_ylempi_kk_iscfinarrow2013
,d33.jarjestys_iscfi2013 as jarj_ylempi_kk_iscfi2013
,d36.jarjestys_iscfi2013 as jarj_laak_erik_iscfi2013
,d39.jarjestys_iscfibroad2013 as jarj_lis_iscfibroad2013
,d39.jarjestys_OKM_ohjauksen_ala as jarj_lis_OKM_ohjauksen_ala
,d39.jarjestys_iscfinarrow2013 as jarj_lis_iscfinarrow2013
,d39.jarjestys_iscfi2013 as jarj_lis_iscfi2013
,d42.jarjestys_iscfibroad2013 as jarj_toht_iscfibroad2013
,d42.jarjestys_OKM_ohjauksen_ala as jarj_toht_OKM_ohjauksen_ala
,d42.jarjestys_iscfinarrow2013 as jarj_toht_iscfinarrow2013
,d42.jarjestys_iscfi2013 as jarj_toht_iscfi2013
,d12.iscfi2013_koodi as "Koodit Yo-tutkinnon koulutusala 3"
,d15.iscfibroad2013_koodi as "Koodit Amm. tutkinnon koulutusala 1"
,d15.iscfinarrow2013_koodi as "Koodit Amm. tutkinnon koulutusala 2"
,d15.iscfi2013_koodi as "Koodit Amm. tutkinnon koulutusala 3"
,d18.iscfibroad2013_koodi as "Koodit Opistoast. tutkinnon koulutusala 1"
,d18.iscfinarrow2013_koodi as "Koodit Opistoast. tutkinnon koulutusala 2"
,d18.iscfi2013_koodi as "Koodit Opistoast. tutkinnon koulutusala 3"
,d21.iscfibroad2013_koodi as "Koodit Amm. kork.asteen tutk. koulutusala 1"
,d21.iscfinarrow2013_koodi as "Koodit Amm. kork.asteen tutk. koulutusala 2"
,d21.iscfi2013_koodi as "Koodit Amm. kork.asteen tutk. koulutusala 3"
,d24.iscfibroad2013_koodi as "Koodit Amk-tutkinnon koulutusala 1"
,d24.OKM_ohjauksen_ala_koodi as "Koodit Amk-tutkinnon OKM ohjauksen ala"
,d24.iscfinarrow2013_koodi as "Koodit Amk-tutkinnon koulutusala 2"
,d24.iscfi2013_koodi as "Koodit Amk-tutkinnon koulutusala 3"
,d27.iscfibroad2013_koodi as "Koodit Alemman kk-tutk. koulutusala 1"
,d27.OKM_ohjauksen_ala_koodi as "Koodit Alemman kk-tutk. OKM ohjauksen ala"
,d27.iscfinarrow2013_koodi as "Koodit Alemman kk-tutk. koulutusala 2"
,d27.iscfi2013_koodi as "Koodit Alemman kk-tutk. koulutusala 3"
,d30.iscfibroad2013_koodi as "Koodit Ylemmän amk-tutk. koulutusala 1"
,d30.OKM_ohjauksen_ala_koodi as "Koodit Ylemmän amk-tutk. OKM ohjauksen ala"
,d30.iscfinarrow2013_koodi as "Koodit Ylemmän amk-tutk. koulutusala 2"
,d30.iscfi2013_koodi as "Koodit Ylemmän amk-tutk. koulutusala 3"
,d33.iscfibroad2013_koodi as "Koodit Ylemmän kk-tutk. koulutusala 1"
,d33.OKM_ohjauksen_ala_koodi as "Koodit Ylemmän kk-tutk. OKM ohjauksen ala"
,d33.iscfinarrow2013_koodi as "Koodit Ylemmän kk-tutk. koulutusala 2"
,d33.iscfi2013_koodi as "Koodit Ylemmän kk-tutk. koulutusala 3"
,d36.iscfi2013_koodi as "Koodit Lääk. erikois.tutk. koulutusala 3"
,d39.iscfibroad2013_koodi as "Koodit Lisensiaatin tutk. koulutusala 1"
,d39.OKM_ohjauksen_ala_koodi as "Koodit Lisensiaatin tutk. OKM ohjauksen ala"
,d39.iscfinarrow2013_koodi as "Koodit Lisensiaatin tutk. koulutusala 2"
,d39.iscfi2013_koodi as "Koodit Lisensiaatin tutk. koulutusala 3"
,d42.iscfibroad2013_koodi as "Koodit Tohtorin tutk. koulutusala 1"
,d42.OKM_ohjauksen_ala_koodi as "Koodit Tohtorin tutk. OKM ohjauksen ala"
,d42.iscfinarrow2013_koodi as "Koodit Tohtorin tutk. koulutusala 2"
,d42.iscfi2013_koodi as "Koodit Tohtorin tutk. koulutusala 3"

FROM dbo.f_tutkinnon_suorittaneiden_aiempi_koulutus_4_7
	JOIN d_tarkastelujakso d1 ON d1.id = tarkastelujakso_id
	JOIN d_aidinkieli_versio1 d2 ON d2.id = aidinkieli_id
	JOIN d_koulutusluokitus d3 ON d3.id = koulutusluokitus_id
	JOIN d_sukupuoli d4 ON d4.id = sukupuoli_id
	JOIN d_kausi d5 ON d5.kausi_id = suorituskausi_id
	JOIN d_kausi d6 ON d6.kausi_id = aloituskausi_id
	JOIN d_oppisopimuskoulutus d7 ON d7.id = oppisopimuskoulutus_id
	JOIN d_ammatillisen_koulutuksen_koulutuslaji d8 ON d8.id = ammatillisen_koulutuksen_koulutuslaji_id
	JOIN d_opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus d9 ON d9.id = opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_id
	JOIN d_nuorten_aikuisten_koulutus_amm d10 ON d10.id = nuorten_aikuisten_koulutus_amm_id
	JOIN d_ika d11 ON d11.id = ika_id
	JOIN d_koulutusluokitus d12 ON d12.id = lu_aiempi_koulutusluokitus_id
	JOIN d_tutkinto_suoritettu d13 ON d13.id = lu_aiempi_tutkinto_suoritettu_id
	JOIN d_koulutuksesta_kulunut_aika d14 ON d14.id = lu_ika_id
	JOIN d_nuorten_aikuisten_koulutus_amm d141 ON d141.id = lu_nuorten_aikuisten_koulutus_amm_id
	JOIN d_koulutusluokitus d15 ON d15.id = amm_aiempi_koulutusluokitus_id
	JOIN d_tutkinto_suoritettu d16 ON d16.id = amm_aiempi_tutkinto_suoritettu_id
	JOIN d_koulutuksesta_kulunut_aika d17 ON d17.id = amm_ika_id
	JOIN d_ammatillisen_koulutuksen_koulutuslaji d171 ON d171.id = ammtutklaja_id
	JOIN d_opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus d172 ON d172.id = ammtutktav_id
	JOIN d_oppisopimuskoulutus d173 ON d173.id = ammoppis_id
	JOIN d_tutkintojen_maara d174 ON d174.id = ammlkm_id
	JOIN d_ammatillinen_koulutus_luokittelu d175 on d175.id = ammatillinen_koulutus_ryhma_id
	JOIN d_koulutusluokitus d18 ON d18.id = opist_aiempi_koulutusluokitus_id
	JOIN d_tutkinto_suoritettu d19 ON d19.id = opist_aiempi_tutkinto_suoritettu_id
	JOIN d_koulutuksesta_kulunut_aika d20 ON d20.id = opist_ika_id
	JOIN d_koulutusluokitus d21 ON d21.id = ammka_aiempi_koulutusluokitus_id
	JOIN d_tutkinto_suoritettu d22 ON d22.id = ammka_aiempi_tutkinto_suoritettu_id
	JOIN d_koulutuksesta_kulunut_aika d23 ON d23.id = ammka_ika_id
	JOIN d_koulutusluokitus d24 ON d24.id = amk_aiempi_koulutusluokitus_id
	JOIN d_tutkinto_suoritettu d25 ON d25.id = amk_aiempi_tutkinto_suoritettu_id
	JOIN d_koulutuksesta_kulunut_aika d26 ON d26.id = amk_ika_id
	JOIN d_tutkintojen_maara d261 ON d261.id = amklkm_id
	JOIN d_aikuisopiskelija d262 ON d262.id = amkaikoul_id
	JOIN d_koulutusluokitus d27 ON d27.id = akk_aiempi_koulutusluokitus_id
	JOIN d_tutkinto_suoritettu d28 ON d28.id = akk_aiempi_tutkinto_suoritettu_id
	JOIN d_koulutuksesta_kulunut_aika d29 ON d29.id = akk_ika_id
	JOIN d_tutkintojen_maara d291 ON d291.id = akklkm_id
	JOIN d_koulutusluokitus d30 ON d30.id = ylamk_aiempi_koulutusluokitus_id
	JOIN d_tutkinto_suoritettu d31 ON d31.id = ylamk_aiempi_tutkinto_suoritettu_id
	JOIN d_koulutuksesta_kulunut_aika d32 ON d32.id = ylamk_ika_id
	JOIN d_koulutusluokitus d33 ON d33.id = ykk_aiempi_koulutusluokitus_id
	JOIN d_tutkinto_suoritettu d34 ON d34.id = ykk_aiempi_tutkinto_suoritettu_id
	JOIN d_koulutuksesta_kulunut_aika d35 ON d35.id = ykk_ika_id
	JOIN d_tutkintojen_maara d351 ON d351.id = ykklkm_id
	JOIN d_koulutusluokitus d36 ON d36.id = laaker_aiempi_koulutusluokitus_id
	JOIN d_tutkinto_suoritettu d37 ON d37.id = laaker_aiempi_tutkinto_suoritettu_id
	JOIN d_koulutuksesta_kulunut_aika d38 ON d38.id = laaker_ika_id
	JOIN d_koulutusluokitus d39 ON d39.id = lis_aiempi_koulutusluokitus_id
	JOIN d_tutkinto_suoritettu d40 ON d40.id = lis_aiempi_tutkinto_suoritettu_id
	JOIN d_koulutuksesta_kulunut_aika d41 ON d41.id = lis_ika_id
	JOIN d_koulutusluokitus d42 ON d42.id = toht_aiempi_koulutusluokitus_id
	JOIN d_tutkinto_suoritettu d43 ON d43.id = toht_aiempi_tutkinto_suoritettu_id
	JOIN d_koulutuksesta_kulunut_aika d44 ON d44.id = toht_ika_id
	JOIN d_tutkinto_suoritettu d45 ON d45.id = yliopistotutkinto_aiempi_suoritettu_id
	JOIN d_tutkinto_suoritettu d46 ON d46.id = yo_jatkotutkinto_aiempi_suoritettu_id
	JOIN d_tutkinto_suoritettu d47 ON d47.id = opisto_tai_ammatillisen_korkea_asteen_tutkinto_aiempi_suoritettu_id
	JOIN d_tutkinto_suoritettu d48 ON d48.id = korkeakoulututkinto_aiempi_suoritettu_id
	JOIN d_tutkinto_suoritettu d49 ON d49.id = toisen_asteen_tutkinto_aiempi_suoritettu_id
	JOIN d_tutkinto_suoritettu d50 ON d50.id = ammatillisen_tutkinto_aiempi_suoritettu_ryhma1_id
	JOIN d_tutkinto_suoritettu d51 ON d51.id = ammatillisen_tutkinto_aiempi_suoritettu_ryhma2_id
	JOIN d_tutkinto_suoritettu d52 ON d52.id = ammatillisen_tutkinto_aiempi_suoritettu_ryhma3_id
	JOIN d_sama_koulutusala d53 ON d53.id = lu_sama_aiempi_koulutusala2002_id
	JOIN d_sama_koulutusala d54 ON d54.id = amm_sama_aiempi_koulutusala2002_id
	JOIN d_sama_koulutusala d55 ON d55.id = opist_sama_aiempi_koulutusala2002_id
	JOIN d_sama_koulutusala d56 ON d56.id = ammka_sama_aiempi_koulutusala2002_id
	JOIN d_sama_koulutusala d57 ON d57.id = amk_sama_aiempi_koulutusala2002_id
	JOIN d_sama_koulutusala d58 ON d58.id = akk_sama_aiempi_koulutusala2002_id
	JOIN d_sama_koulutusala d59 ON d59.id = ylamk_sama_aiempi_koulutusala2002_id
	JOIN d_sama_koulutusala d60 ON d60.id = ykk_sama_aiempi_koulutusala2002_id
	JOIN d_sama_koulutusala d61 ON d61.id = laaker_sama_aiempi_koulutusala2002_id
	JOIN d_sama_koulutusala d62 ON d62.id = lis_sama_aiempi_koulutusala2002_id
	JOIN d_sama_koulutusala d63 ON d63.id = toht_sama_aiempi_koulutusala2002_id
	JOIN d_sama_koulutusala d64 ON d64.id = yliopistotutkinto_sama_aiempi_koulutusala2002_id
	JOIN d_sama_koulutusala d65 ON d65.id = yo_jatkotutkinto_sama_aiempi_koulutusala2002_id
	JOIN d_sama_koulutusala d66 ON d66.id = opisto_tai_ammatillisen_korkea_asteen_tutkinto_sama_aiempi_koulutusala2002_id
	JOIN d_sama_koulutusala d67 ON d67.id = korkeakoulututkinto_sama_aiempi_koulutusala2002_id
	JOIN d_sama_koulutusala d68 ON d68.id = toisen_asteen_tutkinto_sama_aiempi_koulutusala2002_id
	JOIN d_sama_koulutusala d69 ON d69.id = lu_sama_aiempi_opintoala2002_id
	JOIN d_sama_koulutusala d70 ON d70.id = amm_sama_aiempi_opintoala2002_id
	JOIN d_sama_koulutusala d71 ON d71.id = opist_sama_aiempi_opintoala2002_id
	JOIN d_sama_koulutusala d72 ON d72.id = ammka_sama_aiempi_opintoala2002_id
	JOIN d_sama_koulutusala d73 ON d73.id = akk_sama_aiempi_opintoala2002_id
	JOIN d_sama_koulutusala d74 ON d74.id = amk_sama_aiempi_opintoala2002_id
	JOIN d_sama_koulutusala d75 ON d75.id = ylamk_sama_aiempi_opintoala2002_id
	JOIN d_sama_koulutusala d76 ON d76.id = ykk_sama_aiempi_opintoala2002_id
	JOIN d_sama_koulutusala d77 ON d77.id = laaker_sama_aiempi_opintoala2002_id
	JOIN d_sama_koulutusala d78 ON d78.id = lis_sama_aiempi_opintoala2002_id
	JOIN d_sama_koulutusala d79 ON d79.id = toht_sama_aiempi_opintoala2002_id
	JOIN d_sama_koulutusala d80 ON d80.id = yliopistotutkinto_sama_aiempi_opintoala2002_id
	JOIN d_sama_koulutusala d81 ON d81.id = yo_jatkotutkinto_sama_aiempi_opintoala2002_id
	JOIN d_sama_koulutusala d82 ON d82.id = opisto_tai_ammatillisen_korkea_asteen_tutkinto_sama_aiempi_opintoala2002_id
	JOIN d_sama_koulutusala d83 ON d83.id = korkeakoulututkinto_sama_aiempi_opintoala2002_id
	JOIN d_sama_koulutusala d84 ON d84.id = toisen_asteen_tutkinto_sama_aiempi_opintoala2002_id
	JOIN d_sama_koulutusala d85 ON d85.id = lu_sama_aiempi_opintoala1995_id
	JOIN d_sama_koulutusala d86 ON d86.id = amm_sama_aiempi_opintoala1995_id
	JOIN d_sama_koulutusala d87 ON d87.id = opist_sama_aiempi_opintoala1995_id
	JOIN d_sama_koulutusala d88 ON d88.id = ammka_sama_aiempi_opintoala1995_id
	JOIN d_sama_koulutusala d89 ON d89.id = akk_sama_aiempi_opintoala1995_id
	JOIN d_sama_koulutusala d90 ON d90.id = amk_sama_aiempi_opintoala1995_id
	JOIN d_sama_koulutusala d91 ON d91.id = ylamk_sama_aiempi_opintoala1995_id
	JOIN d_sama_koulutusala d92 ON d92.id = ykk_sama_aiempi_opintoala1995_id
	JOIN d_sama_koulutusala d93 ON d93.id = laaker_sama_aiempi_opintoala1995_id
	JOIN d_sama_koulutusala d94 ON d94.id = lis_sama_aiempi_opintoala1995_id
	JOIN d_sama_koulutusala d95 ON d95.id = toht_sama_aiempi_opintoala1995_id
	JOIN d_sama_koulutusala d96 ON d96.id = yliopistotutkinto_sama_aiempi_opintoala1995_id
	JOIN d_sama_koulutusala d97 ON d97.id = yo_jatkotutkinto_sama_aiempi_opintoala1995_id
	JOIN d_sama_koulutusala d98 ON d98.id = opisto_tai_ammatillisen_korkea_asteen_tutkinto_sama_aiempi_opintoala1995_id
	JOIN d_sama_koulutusala d99 ON d99.id = korkeakoulututkinto_sama_aiempi_opintoala1995_id
	JOIN d_sama_koulutusala d100 ON d100.id = toisen_asteen_tutkinto_sama_aiempi_opintoala1995_id
	JOIN d_sama_koulutusala d101 ON d101.id = lu_sama_aiempi_iscfibroad2013_id
	JOIN d_sama_koulutusala d102 ON d102.id = amm_sama_aiempi_iscfibroad2013_id
	JOIN d_sama_koulutusala d103 ON d103.id = opist_sama_aiempi_iscfibroad2013_id
	JOIN d_sama_koulutusala d104 ON d104.id = ammka_sama_aiempi_iscfibroad2013_id
	JOIN d_sama_koulutusala d105 ON d105.id = akk_sama_aiempi_iscfibroad2013_id
	JOIN d_sama_koulutusala d106 ON d106.id = amk_sama_aiempi_iscfibroad2013_id
	JOIN d_sama_koulutusala d107 ON d107.id = ylamk_sama_aiempi_iscfibroad2013_id
	JOIN d_sama_koulutusala d108 ON d108.id = ykk_sama_aiempi_iscfibroad2013_id
	JOIN d_sama_koulutusala d109 ON d109.id = laaker_sama_aiempi_iscfibroad2013_id
	JOIN d_sama_koulutusala d110 ON d110.id = lis_sama_aiempi_iscfibroad2013_id
	JOIN d_sama_koulutusala d111 ON d111.id = toht_sama_aiempi_iscfibroad2013_id
	JOIN d_sama_koulutusala d112 ON d112.id = yliopistotutkinto_sama_aiempi_iscfibroad2013_id
	JOIN d_sama_koulutusala d113 ON d113.id = yo_jatkotutkinto_sama_aiempi_iscfibroad2013_id
	JOIN d_sama_koulutusala d114 ON d114.id = opisto_tai_ammatillisen_korkea_asteen_tutkinto_sama_aiempi_iscfibroad2013_id
	JOIN d_sama_koulutusala d115 ON d115.id = korkeakoulututkinto_sama_aiempi_iscfibroad2013_id
	JOIN d_sama_koulutusala d116 ON d116.id = toisen_asteen_tutkinto_sama_aiempi_iscfibroad2013_id
	JOIN d_sama_koulutusala d117 ON d117.id = lu_sama_aiempi_iscfinarrow2013_id
	JOIN d_sama_koulutusala d118 ON d118.id = amm_sama_aiempi_iscfinarrow2013_id
	JOIN d_sama_koulutusala d119 ON d119.id = opist_sama_aiempi_iscfinarrow2013_id
	JOIN d_sama_koulutusala d120 ON d120.id = ammka_sama_aiempi_iscfinarrow2013_id
	JOIN d_sama_koulutusala d121 ON d121.id = akk_sama_aiempi_iscfinarrow2013_id
	JOIN d_sama_koulutusala d122 ON d122.id = amk_sama_aiempi_iscfinarrow2013_id
	JOIN d_sama_koulutusala d123 ON d123.id = ylamk_sama_aiempi_iscfinarrow2013_id
	JOIN d_sama_koulutusala d124 ON d124.id = ykk_sama_aiempi_iscfinarrow2013_id
	JOIN d_sama_koulutusala d125 ON d125.id = laaker_sama_aiempi_iscfinarrow2013_id
	JOIN d_sama_koulutusala d126 ON d126.id = lis_sama_aiempi_iscfinarrow2013_id
	JOIN d_sama_koulutusala d127 ON d127.id = toht_sama_aiempi_iscfinarrow2013_id
	JOIN d_sama_koulutusala d128 ON d128.id = yliopistotutkinto_sama_aiempi_iscfinarrow2013_id
	JOIN d_sama_koulutusala d129 ON d129.id = yo_jatkotutkinto_sama_aiempi_iscfinarrow2013_id
	JOIN d_sama_koulutusala d130 ON d130.id = opisto_tai_ammatillisen_korkea_asteen_tutkinto_sama_aiempi_iscfinarrow2013_id
	JOIN d_sama_koulutusala d131 ON d131.id = korkeakoulututkinto_sama_aiempi_iscfinarrow2013_id
	JOIN d_sama_koulutusala d132 ON d132.id = toisen_asteen_tutkinto_sama_aiempi_iscfinarrow2013_id















' 
GO
/****** Object:  View [dbo].[v_f_tab_tutkinnon_suorittaneiden_myohempi_koulutus_yhteiset]    Script Date: 21.6.2017 10:17:26 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_tutkinnon_suorittaneiden_myohempi_koulutus_yhteiset]'))
EXEC dbo.sp_executesql @statement = N'















CREATE VIEW [dbo].[v_f_tab_tutkinnon_suorittaneiden_myohempi_koulutus_yhteiset] AS

Select [henkiloiden_lkm]
,[lu_henkiloiden_lkm]
,[amm_henkiloiden_lkm]
,[opist_henkiloiden_lkm]
,[ammka_henkiloiden_lkm]
,[amk_henkiloiden_lkm]
,[akk_henkiloiden_lkm]
,[ylamklkm_henkiloiden_lkm]
,[ykk_henkiloiden_lkm]
,[laaker_henkiloiden_lkm]
,[lis_henkiloiden_lkm]
,[toht_henkiloiden_lkm]
,[Myohemman_yliopistotutkinnon_suorittaneiden_lkm] as myoh_yliop_lkm
,[Myohemman_yo_jatkotutkinnon_suorittaneiden_lkm] as myoh_yo_jatko_lkm
,[Myohemman_opisto_tai_ammatillisen_korkea_asteen_tutkinnon_suorittaneiden_lkm] as myoh_opisto_ammkork_lkm
,[Myohemman_korkeakoulututkinnon_suorittaneiden_lkm] as myoh_kork_lkm
,[Myohemman_toisen_asteen_tutkinnon_suorittaneiden_lkm] as myoh_toinenaste_lkm
,[Myohemman_ammatillisen_tutkinnon_ryhma1_suorittaneiden_lkm] as myoh_ammryhma1_lkm
,[Myohemman_ammatillisen_tutkinnon_ryhma2_suorittaneiden_lkm] as myoh_ammryhma2_lkm
,[Myohemman_ammatillisen_tutkinnon_ryhma3_suorittaneiden_lkm] as myoh_ammryhma3_lkm
,[Tilastovuosi] AS Tilastovuosi
,d1.tarkastelujakso AS Tarkastelujakso
,d2.aidinkieli_versio1 AS Äidinkieli
,d3.koulutusaste2002 as Koulutusaste
,d3.koulutusala2002 as "Koulutusala (02 luokitus)"
,d3.opintoala1995 as "Koulutusala (95 luokitus)"
,d3.opintoala2002 as Opintoala
,d3.koulutus as Koulutusnimike
,d4.sukupuoli AS Sukupuoli
,ISNULL(NULLIF([suorv],''''),''Tuntematon'') as "Tutkinnon suoritusvuosi"
,d5.lukukausiselite as "Tutkinnon suorituslukukausi"
,ISNULL(NULLIF([alvv],''''),''Tuntematon'') as "Aloitusvuosi"
,d6.lukukausiselite as "Aloituslukukausi"
,[syntv] as "Syntymävuosi"
,ISNULL(NULLIF([lusuorv],''''),''Tuntematon'') as "Yo-tutkinnon suoritusvuosi"
,ISNULL(NULLIF([ammsuorv],''''),''Tuntematon'') as "Amm. tutkinnon suoritusvuosi"
,ISNULL(NULLIF([opistsuorv],''''),''Tuntematon'') as "Opistoast. tutkinnon suoritusvuosi"
,ISNULL(NULLIF([ammkasuorv],''''),''Tuntematon'') as "Amm. kork.asteen tutk. suoritusvuosi"
,ISNULL(NULLIF([amksuorv],''''),''Tuntematon'') as "Amk-tutkinnon suoritusvuosi"
,ISNULL(NULLIF([akksuorv],''''),''Tuntematon'') as "Alemman kk-tutk. suoritusvuosi"
,ISNULL(NULLIF([ylamksuorv],''''),''Tuntematon'') as "Ylemmän amk-tutk. suoritusvuosi"
,ISNULL(NULLIF([ykksuorv],''''),''Tuntematon'')  as "Ylemmän kk-tutk. suoritusvuosi"
,ISNULL(NULLIF([laakersuorv],''''),''Tuntematon'') as "Lääk. erikois.tutk. suoritusvuosi"
,ISNULL(NULLIF([lissuorv],''''),''Tuntematon'')  as "Lisensiaatin tutk. suoritusvuosi"
,ISNULL(NULLIF([tohtsuorv],''''),''Tuntematon'') as "Tohtorin tutk. suorituvuosi"
,d7.oppisopimuskoulutus as "Oppisopimuskoulutus"
,d8.ammatillisen_koulutuksen_koulutuslaji as "Tutkintotyyppi"
,d9.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus as "Järjestämistapa"
,d10.nuorten_aikuisten_koulutus_amm as "Nuorten/aikuisten koulutus"
,d11.ika as Ikä
,d11.ika5v as Ikäryhmä
,d12.koulutus as "Yo-tutkinnon koulutusnimike"
,d13.tutkinto_suoritettu as "Myöh. suoritettu yo-tutkinto"
,d14.koulutuksesta_kulunut_aika as "Kulunut aika alkup. tutkinnosta (yo)"
,d141.nuorten_aikuisten_koulutus_amm as "Nuorten/aikuisten koulutus (yo)"
,d15.koulutusala2002 as "Amm. tutkinnon koulutusala"
,d15.opintoala2002 as "Amm. tutkinnon opintoala"
,d15.koulutus as "Amm. tutkinnon koulutusnimike"
,d16.tutkinto_suoritettu as "Myöh. suoritettu amm. tutkinto"
,d17.koulutuksesta_kulunut_aika as "Kulunut aika alkup. tutkinnosta (amm)"
,d171.ammatillisen_koulutuksen_koulutuslaji as "Amm. tutkinnon tutkintotyyppi"
,d172.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus as "Amm. tutkinnon järjestämistapa"
,d173.oppisopimuskoulutus as "Amm. tutkinto oppisopimuskoul."
,d174.tutkintojen_maara as "Amm. tutkintojen määrä"
,d175.ammatillisen_koulutuksen_luokittelu_4_7_4_8 as "Amm. koulutuksen ryhmät"
,d18.koulutusala2002 as "Opistoast. tutkinnon koulutusala"
,d18.opintoala2002 as "Opistoast. tutkinnon opintoala"
,d18.koulutus as "Opistoast. tutkinnon koulutusnimike"
,d19.tutkinto_suoritettu as "Myöh. suoritettu opistoast. tutkinto"
,d20.koulutuksesta_kulunut_aika as "Kulunut aika alkup. tutkinnosta (opisto)"
,d21.koulutusala2002 as "Amm. kork.asteen tutk. koulutusala"
,d21.opintoala2002 as "Amm. kork.asteen tutk. opintoala"
,d21.koulutus as "Amm. kork.asteen tutk. koulutusnimike"
,d22.tutkinto_suoritettu as "Myöh. suoritettu amm. kork.asteen tutkinto"
,d23.koulutuksesta_kulunut_aika as "Kulunut aika alkup. tutkinnosta (ammka)"
,d24.koulutusala2002 as "Amk-tutkinnon koulutusala"
,d24.opintoala2002 as "Amk-tutkinnon opintoala"
,d24.koulutus as "Amk-tutkinnon koulutusnimike"
,d25.tutkinto_suoritettu as "Myöh. suoritettu amk-tutkinto"
,d26.koulutuksesta_kulunut_aika as "Kulunut aika alkup. tutkinnosta (amk)"
,d261.tutkintojen_maara as "Amk-tutkintojen määrä"
,d262.aikuisopiskelija as "Nuorten/aikuisten koulutus (amk)"
,d27.koulutusala2002 as "Alemman kk-tutk. koulutusala (02)"
,d27.opintoala1995 as "Alemman kk-tutk. koulutusala (95)"
,d27.opintoala2002 as "Alemman kk-tutk. opintoala"
,d27.koulutus as "Alemman kk-tutk. koulutusnimike"
,d28.tutkinto_suoritettu as "Myöh. suoritettu alempi kk-tutkinto"
,d29.koulutuksesta_kulunut_aika as "Kulunut aika alkup. tutkinnosta (alempi kk)"
,d291.tutkintojen_maara as "Alempien kk-tutkintojen määrä"
,d30.koulutusala2002 as "Ylemmän amk-tutk. koulutusala"
,d30.opintoala2002 as "Ylemmän amk-tutk. opintoala"
,d30.koulutus as "Ylemmän amk-tutk. koulutusnimike"
,d31.tutkinto_suoritettu as "Myöh. suoritettu ylempi amk-tutkinto"
,d32.koulutuksesta_kulunut_aika as "Kulunut aika alkup. tutkinnosta (ylempi amk)"
,d33.koulutusala2002 as "Ylemmän kk-tutk. koulutusala (02)"
,d33.opintoala1995 as "Ylemmän kk-tutk. koulutusala (95)"
,d33.opintoala2002 as "Ylemmän kk-tutk. opintoala"
,d33.koulutus as "Ylemmän kk-tutk. koulutusnimike"
,d34.tutkinto_suoritettu as "Myöh. suoritettu ylempi kk-tutkinto"
,d35.koulutuksesta_kulunut_aika as "Kulunut aika alkup. tutkinnosta (ylempi kk)"
,d351.tutkintojen_maara as "Ylempien kk-tutkintojen määrä"
,d36.koulutus as "Lääk. erikois.tutk. koulutusnimike"
,d37.tutkinto_suoritettu as "Myöh. suoritettu lääk. erikois.tutk."
,d38.koulutuksesta_kulunut_aika as "Kulunut aika alkup. tutkinnosta (lääk. erik.)"
,d39.koulutusala2002 as "Lisensiaatin tutk. koulutusala (02)"
,d39.opintoala1995 as "Lisensiaatin tutk. koulutusala (95)"
,d39.opintoala2002 as "Lisensiaatin tutk. opintoala"
,d39.koulutus as "Lisensiaatin tutk. koulutusnimike"
,d40.tutkinto_suoritettu as "Myöh. suoritettu lisensiaatin tutk."
,d41.koulutuksesta_kulunut_aika as "Kulunut aika alkup. tutkinnosta (lis.)"
,d42.koulutusala2002 as "Tohtorin tutk. koulutusala (02)"
,d42.opintoala1995 as "Tohtorin tutk. koulutusala (95)"
,d42.opintoala2002 as "Tohtorin tutk. opintoala"
,d42.koulutus as "Tohtorin tutk. koulutusnimike"
,d43.tutkinto_suoritettu as "Myöh. suoritettu tohtorin tutk."
,d44.koulutuksesta_kulunut_aika as "Kulunut aika alkup. tutkinnosta (toht.)"
,d45.tutkinto_suoritettu as "Myöh. suoritettu yliopistotutkinto"
,d46.tutkinto_suoritettu as "Myöh. suoritettu yo-jatkotutkinto"
,d47.tutkinto_suoritettu as "Myöh. suoritettu opistoast. tai amm. kork.ast. tutkinto"
,d48.tutkinto_suoritettu as "Myöh. suoritettu korkeakoulututkinto"
,d49.tutkinto_suoritettu as "Myöh. suoritettu toisen asteen tutkinto"
,d50.tutkinto_suoritettu as "Myöh. suoritettu amm. tutkinto (ryhmä 1)"
,d51.tutkinto_suoritettu as "Myöh. suoritettu amm. tutkinto (ryhmä 2)"
,d52.tutkinto_suoritettu as "Myöh. suoritettu amm. tutkinto (ryhmä 3)"
,d53.sama_koulutusala as "Yo-tutkinto samalla koul.alalla (02)"
,d54.sama_koulutusala as "Amm. tutk. samalla koul.alalla (02)"
,d55.sama_koulutusala as "Opistoast. tutk. samalla koul.alalla (02)"
,d56.sama_koulutusala as "Amm. ka. tutk. samalla koul.alalla (02)"
,d57.sama_koulutusala as "Amk-tutkinto samalla koul.alalla (02)"
,d58.sama_koulutusala as "Alempi kk-tutk. samalla koul.alalla (02)"
,d59.sama_koulutusala as "Ylempi amk-tutk. samalla koul.alalla (02)"
,d60.sama_koulutusala as "Ylempi kk-tutk. samalla koul.alalla (02)"
,d61.sama_koulutusala as "Laak. erik.tutk. samalla koul.alalla (02)"
,d62.sama_koulutusala as "Lis. tutkinto samalla koul.alalla (02)"
,d63.sama_koulutusala as "Toht. tutkinto samalla koul.alalla (02)"
,d64.sama_koulutusala as "Yliopistotutk. samalla koul.alalla (02)"
,d65.sama_koulutusala as "Yo-jatkotutk. samalla koul.alalla (02)"
,d66.sama_koulutusala as "Opisto/amm.ka. tutk. samalla koul.alalla (02)"
,d67.sama_koulutusala as "Korkeak.tutk. samalla koul.alalla (02)"
,d68.sama_koulutusala as "Toisen asteen tutk. samalla koul.alalla (02)"
,d69.sama_koulutusala as "Yo-tutkinto samalla op.alalla"
,d70.sama_koulutusala as "Amm. tutk. samalla op.alalla"
,d71.sama_koulutusala as "Opistoast. tutk. samalla op.alalla"
,d72.sama_koulutusala as "Amm. ka. tutk. samalla op.alalla"
,d73.sama_koulutusala as "Amk-tutkinto samalla op.alalla"
,d74.sama_koulutusala as "Alempi kk-tutk. samalla op.alalla"
,d75.sama_koulutusala as "Ylempi amk-tutk. samalla op.alalla"
,d76.sama_koulutusala as "Ylempi kk-tutk. samalla op.alalla"
,d77.sama_koulutusala as "Laak. erik.tutk. samalla op.alalla"
,d78.sama_koulutusala as "Lis. tutkinto samalla op.alalla"
,d79.sama_koulutusala as "Toht. tutkinto samalla op.alalla"
,d80.sama_koulutusala as "Yliopistotutk. samalla op.alalla"
,d81.sama_koulutusala as "Yo-jatkotutk. samalla op.alalla"
,d82.sama_koulutusala as "Opisto/amm.ka. tutk. samalla op.alalla"
,d83.sama_koulutusala as "Korkeak.tutk. samalla op.alalla"
,d84.sama_koulutusala as "Toisen asteen tutk. samalla op.alalla"
,d85.sama_koulutusala as "Yo-tutkinto samalla koul.alalla (95)"
,d86.sama_koulutusala as "Amm. tutk. samalla koul.alalla (95)"
,d87.sama_koulutusala as "Opistoast. tutk. samalla koul.alalla (95)"
,d88.sama_koulutusala as "Amm. ka. tutk. samalla koul.alalla (95)"
,d89.sama_koulutusala as "Amk-tutkinto samalla koul.alalla (95)"
,d90.sama_koulutusala as "Alempi kk-tutk. samalla koul.alalla (95)"
,d91.sama_koulutusala as "Ylempi amk-tutk. samalla koul.alalla (95)"
,d92.sama_koulutusala as "Ylempi kk-tutk. samalla koul.alalla (95)"
,d93.sama_koulutusala as "Laak. erik.tutk. samalla koul.alalla (95)"
,d94.sama_koulutusala as "Lis. tutkinto samalla koul.alalla (95)"
,d95.sama_koulutusala as "Toht. tutkinto samalla koul.alalla (95)"
,d96.sama_koulutusala as "Yliopistotutk. samalla koul.alalla (95)"
,d97.sama_koulutusala as "Yo-jatkotutk. samalla koul.alalla (95)"
,d98.sama_koulutusala as "Opisto/amm.ka. tutk. samalla koul.alalla (95)"
,d99.sama_koulutusala as "Korkeak.tutk. samalla koul.alalla (95)"
,d100.sama_koulutusala as "Toisen asteen tutk. samalla koul.alalla (95)"
,d101.sama_koulutusala as "Yo-tutkinto samalla koul.alalla 1"
,d102.sama_koulutusala as "Amm. tutk. samalla koul.alalla 1"
,d103.sama_koulutusala as "Opistoast. tutk. samalla koul.alalla 1"
,d104.sama_koulutusala as "Amm. ka. tutk. samalla koul.alalla 1"
,d105.sama_koulutusala as "Amk-tutkinto samalla koul.alalla 1"
,d106.sama_koulutusala as "Alempi kk-tutk. samalla koul.alalla 1"
,d107.sama_koulutusala as "Ylempi amk-tutk. samalla koul.alalla 1"
,d108.sama_koulutusala as "Ylempi kk-tutk. samalla koul.alalla 1"
,d109.sama_koulutusala as "Laak. erik.tutk. samalla koul.alalla 1"
,d110.sama_koulutusala as "Lis. tutkinto samalla koul.alalla 1"
,d111.sama_koulutusala as "Toht. tutkinto samalla koul.alalla 1"
,d112.sama_koulutusala as "Yliopistotutk. samalla koul.alalla 1"
,d113.sama_koulutusala as "Yo-jatkotutk. samalla koul.alalla 1"
,d114.sama_koulutusala as "Opisto/amm.ka. tutk. samalla koul.alalla 1"
,d115.sama_koulutusala as "Korkeak.tutk. samalla koul.alalla 1"
,d116.sama_koulutusala as "Toisen asteen tutk. samalla koul.alalla 1"
,d117.sama_koulutusala as "Yo-tutkinto samalla koul.alalla 2"
,d118.sama_koulutusala as "Amm. tutk. samalla koul.alalla 2"
,d119.sama_koulutusala as "Opistoast. tutk. samalla koul.alalla 2"
,d120.sama_koulutusala as "Amm. ka. tutk. samalla koul.alalla 2"
,d121.sama_koulutusala as "Amk-tutkinto samalla koul.alalla 2"
,d122.sama_koulutusala as "Alempi kk-tutk. samalla koul.alalla 2"
,d123.sama_koulutusala as "Ylempi amk-tutk. samalla koul.alalla 2"
,d124.sama_koulutusala as "Ylempi kk-tutk. samalla koul.alalla 2"
,d125.sama_koulutusala as "Laak. erik.tutk. samalla koul.alalla 2"
,d126.sama_koulutusala as "Lis. tutkinto samalla koul.alalla 2"
,d127.sama_koulutusala as "Toht. tutkinto samalla koul.alalla 2"
,d128.sama_koulutusala as "Yliopistotutk. samalla koul.alalla 2"
,d129.sama_koulutusala as "Yo-jatkotutk. samalla koul.alalla 2"
,d130.sama_koulutusala as "Opisto/amm.ka. tutk. samalla koul.alalla 2"
,d131.sama_koulutusala as "Korkeak.tutk. samalla koul.alalla 2"
,d132.sama_koulutusala as "Toisen asteen tutk. samalla koul.alalla 2"
--jarjestysmuuttujat
,d1.jarjestys AS jarj_tarkastelujakso
,d2.jarjestys AS jarj_aidinkieli
,d3.jarjestys_koulutusaste2002
,d3.jarjestys_koulutusala2002
,d3.jarjestys_opintoala1995
,d3.jarjestys_opintoala2002
,d3.jarjestys as jarj_koulnimike
,d7.jarjestys as jarj_oppis
,d8.jarjestys as jarj_tutktyyppi
,d9.jarjestys as jarj_jarjtapa
,d10.jarjestys as jarj_nuoretaikuisetamm
,d11.jarjestys_ika as jarj_ika
,d11.jarjestys_ika5v as jarj_ika5v
,d12.jarjestys as jarj_lukio_koulnimike
,d13.jarjestys as jarj_lukio_myohtutk
,d14.jarjestys as jarj_lukio_kulunutaika
,d141.jarjestys as jarj_lukio_nuoretaikuiset
,d15.jarjestys_koulutusala2002 as jarj_amm_koulala
,d15.jarjestys_opintoala2002 as jarj_amm_opala
,d15.jarjestys as jarj_amm_koulnimike
,d16.jarjestys as jarj_amm_myohtutk
,d17.jarjestys as jarj_amm_kulunutaika
,d171.jarjestys as jarj_amm_tutktyyppi
,d172.jarjestys as jarj_amm_jarjtapa
,d173.jarjestys as jarj_amm_oppis
,d174.jarjestys as jarj_amm_tutkmaara
,d175.jarjestys as jarj_amm_ryhma
,d18.jarjestys_koulutusala2002 as jarj_opisto_koulala
,d18.jarjestys_opintoala2002 as jarj_opisto_opala
,d18.jarjestys as jarj_opisto_koulnimike
,d19.jarjestys as jarj_opisto_myohtutk
,d20.jarjestys as jarj_opisto_kulunutaika
,d21.jarjestys_koulutusala2002 as jarj_amm_kork_aste_koulala
,d21.jarjestys_opintoala2002 as jarj_amm_kork_aste_opala
,d21.jarjestys as jarj_amm_kork_aste_koulnimike
,d22.jarjestys as jarj_amm_kork_aste_myohtutk
,d23.jarjestys as jarj_amm_kork_aste_kulunutaika
,d24.jarjestys_koulutusala2002 as jarj_amk_koulala
,d24.jarjestys_opintoala2002 as jarj_amk_opala
,d24.jarjestys as jarj_amk_koulnimike
,d25.jarjestys as jarj_amk_myohtutk
,d26.jarjestys as jarj_amk_kulunutaika
,d261.jarjestys as jarj_amk_tutkmaara
,d262.jarjestys as jarj_amk_nuoraik
,d27.jarjestys_koulutusala2002 as jarj_alempi_kk_koulala02
,d27.jarjestys_opintoala1995 as jarj_alempi_kk_koulala95
,d27.jarjestys_opintoala2002 as jarj_alempi_kk_opala
,d27.jarjestys as jarj_alempi_kk_koulnimike
,d28.jarjestys as jarj_alempi_kk_myohtutk
,d29.jarjestys as jarj_alempi_kk_kulunutaika
,d291.jarjestys as jarj_alempi_kk_tutkmaara
,d30.jarjestys_koulutusala2002 as jarj_ylempi_amk_koulala
,d30.jarjestys_opintoala2002 as jarj_ylempi_amk_opala
,d30.jarjestys as jarj_ylempi_amk_koulnimike
,d31.jarjestys as jarj_ylempi_amk_myohtutk
,d32.jarjestys as jarj_ylempi_amk_kulunutaika
,d33.jarjestys_koulutusala2002 as jarj_ylempi_kk_koulala02
,d33.jarjestys_opintoala1995 as jarj_ylempi_kk_koulala95
,d33.jarjestys_opintoala2002 as jarj_ylempi_kk_opala
,d33.jarjestys as jarj_ylempi_kk_koulnimike
,d34.jarjestys as jarj_ylempi_kk_myohtutk
,d35.jarjestys as jarj_ylempi_kk_kulunutaika
,d351.jarjestys as jarj_ylempi_kk_tutkmaara
,d36.jarjestys as jarj_laak_erik_koulnimike
,d37.jarjestys as jarj_laak_erik_myohtutk
,d38.jarjestys as jarj_laak_erik_kulunutaika
,d39.jarjestys_koulutusala2002 as jarj_lis_koulala02
,d39.jarjestys_opintoala1995 as jarj_lis_koulala95
,d39.jarjestys_opintoala2002 as jarj_lis_opala
,d39.jarjestys as jarj_lis_koulnimike
,d40.jarjestys as jarj_lis_myohtutk
,d41.jarjestys as jarj_lis_kulunutaika
,d42.jarjestys_koulutusala2002 as jarj_toht_koulala02
,d42.jarjestys_opintoala1995 as jarj_toht_koulala95
,d42.jarjestys_opintoala2002 as jarj_toht_opala
,d42.jarjestys as jarj_toht_koulnimike
,d43.jarjestys as jarj_toht_myohtutk
,d44.jarjestys as jarj_toht_kulunutaika
,d45.jarjestys as jarj_yliopisto_myohtutk
,d46.jarjestys as jarj_yojatko_myohtutk
,d47.jarjestys as jarj_opist_myohtutk
,d48.jarjestys as jarj_korkeakoulu_myohtutk
,d49.jarjestys as jarj_toinenaste_myohtutk
,d50.jarjestys as jarj_ammryhma1_myohtutk
,d51.jarjestys as jarj_ammryhma2_myohtutk
,d52.jarjestys as jarj_ammryhma3_myohtutk
,d55.jarjestys as jarj_samakoulutusala02_opisto
,d56.jarjestys as jarj_samakoulutusala02_ammka
,d57.jarjestys as jarj_samakoulutusala02_amk
,d58.jarjestys as jarj_samakoulutusala02_alempikk
,d59.jarjestys as jarj_samakoulutusala02_ylempiamk
,d60.jarjestys as jarj_samakoulutusala02_ylempikk
,d61.jarjestys as jarj_samakoulutusala02_laak
,d62.jarjestys as jarj_samakoulutusala02_lis
,d63.jarjestys as jarj_samakoulutusala02_toht
,d64.jarjestys as jarj_samakoulutusala02_yliopisto
,d65.jarjestys as jarj_samakoulutusala02_yojatko
,d66.jarjestys as jarj_samakoulutusala02_opistoammka
,d67.jarjestys as jarj_samakoulutusala02_korkeak
,d68.jarjestys as jarj_samakoulutusala02_toinenaste
,d69.jarjestys as jarj_samaopintoala02_lu
,d70.jarjestys as jarj_samaopintoala02_amm
,d71.jarjestys as jarj_samaopintoala02_opisto
,d72.jarjestys as jarj_samaopintoala02_ammka
,d73.jarjestys as jarj_samaopintoala02_amk
,d74.jarjestys as jarj_samaopintoala02_alempikk
,d75.jarjestys as jarj_samaopintoala02_ylempiamk
,d76.jarjestys as jarj_samaopintoala02_ylempikk
,d77.jarjestys as jarj_samaopintoala02_laak
,d78.jarjestys as jarj_samaopintoala02_lis
,d79.jarjestys as jarj_samaopintoala02_toht
,d80.jarjestys as jarj_samaopintoala02_yliopisto
,d81.jarjestys as jarj_samaopintoala02_yojatko
,d82.jarjestys as jarj_samaopintoala02_opistoammka
,d83.jarjestys as jarj_samaopintoala02_korkeak
,d84.jarjestys as jarj_samaopintoala02_toinenaste
,d85.jarjestys as jarj_samakoulutusala95_lu
,d86.jarjestys as jarj_samakoulutusala95_amm
,d87.jarjestys as jarj_samakoulutusala95_opisto
,d88.jarjestys as jarj_samakoulutusala95_ammka
,d89.jarjestys as jarj_samakoulutusala95_amk
,d90.jarjestys as jarj_samakoulutusala95_alempikk
,d91.jarjestys as jarj_samakoulutusala95_ylempiamk
,d92.jarjestys as jarj_samakoulutusala95_ylempikk
,d93.jarjestys as jarj_samakoulutusala95_laak
,d94.jarjestys as jarj_samakoulutusala95_lis
,d95.jarjestys as jarj_samakoulutusala95_toht
,d96.jarjestys as jarj_samakoulutusala95_yliopisto
,d97.jarjestys as jarj_samakoulutusala95_yojatko
,d98.jarjestys as jarj_samakoulutusala95_opistoammka
,d99.jarjestys as jarj_samakoulutusala95_korkeak
,d100.jarjestys as jarj_samakoulutusala95_toinenaste
,d101.jarjestys as jarj_samaiscbroad_lu
,d102.jarjestys as jarj_samaiscbroad_amm
,d103.jarjestys as jarj_samaiscbroad_opisto
,d104.jarjestys as jarj_samaiscbroad_ammka
,d105.jarjestys as jarj_samaiscbroad_amk
,d106.jarjestys as jarj_samaiscbroad_alempikk
,d107.jarjestys as jarj_samaiscbroad_ylempiamk
,d108.jarjestys as jarj_samaiscbroad_ylempikk
,d109.jarjestys as jarj_samaiscbroad_laak
,d110.jarjestys as jarj_samaiscbroad_lis
,d111.jarjestys as jarj_samaiscbroad_toht
,d112.jarjestys as jarj_samaiscbroad_yliopisto
,d113.jarjestys as jarj_samaiscbroad_yojatko
,d114.jarjestys as jarj_samaiscbroad_opistoammka
,d115.jarjestys as jarj_samaiscbroad_korkeak
,d116.jarjestys as jarj_samaiscbroad_toinenaste
,d117.jarjestys as jarj_samaiscnarrow_lu
,d118.jarjestys as jarj_samaiscnarrow_amm
,d119.jarjestys as jarj_samaiscnarrow_opisto
,d120.jarjestys as jarj_samaiscnarrow_ammka
,d121.jarjestys as jarj_samaiscnarrow_amk
,d122.jarjestys as jarj_samaiscnarrow_alempikk
,d123.jarjestys as jarj_samaiscnarrow_ylempiamk
,d124.jarjestys as jarj_samaiscnarrow_ylempikk
,d125.jarjestys as jarj_samaiscnarrow_laak
,d126.jarjestys as jarj_samaiscnarrow_lis
,d127.jarjestys as jarj_samaiscnarrow_toht
,d128.jarjestys as jarj_samaiscnarrow_yliopisto
,d129.jarjestys as jarj_samaiscnarrow_yojatko
,d130.jarjestys as jarj_samaiscnarrow_opistoammka
,d131.jarjestys as jarj_samaiscnarrow_korkeak
,d132.jarjestys as jarj_samaiscnarrow_toinenaste
--koodimuuttujat
,d3.koulutus_koodi as "Koodit Koulutusnimike"
,d3.koulutusaste2002_koodi as "Koodit Koulutusaste"
,d3.koulutusala2002_koodi as "Koodit Koulutusala 02"
,d3.opintoala1995_koodi as "Koodit Koulutusala 95"
,d3.opintoala2002_koodi as "Koodit Opintoala"
,d12.koulutus_koodi as "Koodit Yo-tutkinnon koulutusnimike"
,d15.koulutusala2002_koodi as "Koodit Amm. tutkinnon koulutusala"
,d15.opintoala2002_koodi as "Koodit Amm. tutkinnon opintoala"
,d15.koulutus_koodi as "Koodit Amm. tutkinnon koulutusnimike"
,d18.koulutusala2002_koodi as "Koodit Opistoast. tutkinnon koulutusala"
,d18.opintoala2002_koodi as "Koodit Opistoast. tutkinnon opintoala"
,d18.koulutus_koodi as "Koodit Opistoast. tutkinnon koulutusnimike"
,d21.koulutusala2002_koodi as "Koodit Amm. kork.asteen tutk. koulutusala"
,d21.opintoala2002_koodi as "Koodit Amm. kork.asteen tutk. opintoala"
,d21.koulutus_koodi as "Koodit Amm. kork.asteen tutk. koulutusnimike"
,d24.koulutusala2002_koodi as "Koodit Amk-tutkinnon koulutusala"
,d24.opintoala2002_koodi as "Koodit Amk-tutkinnon opintoala"
,d24.koulutus_koodi as "Koodit Amk-tutkinnon koulutusnimike"
,d27.koulutusala2002_koodi as "Koodit Alemman kk-tutk. koulutusala 02"
,d27.opintoala1995_koodi as "Koodit Alemman kk-tutk. koulutusala 95"
,d27.opintoala2002_koodi as "Koodit Alemman kk-tutk. opintoala"
,d27.koulutus_koodi as "Koodit Alemman kk-tutk. koulutusnimike"
,d30.koulutusala2002_koodi as "Koodit Ylemmän amk-tutk. koulutusala"
,d30.opintoala2002_koodi as "Koodit Ylemmän amk-tutk. opintoala"
,d30.koulutus_koodi as "Koodit Ylemmän amk-tutk. koulutusnimike"
,d33.koulutusala2002_koodi as "Koodit Ylemmän kk-tutk. koulutusala 02"
,d33.opintoala1995_koodi as "Koodit Ylemmän kk-tutk. koulutusala 95"
,d33.opintoala2002_koodi as "Koodit Ylemmän kk-tutk. opintoala"
,d33.koulutus_koodi as "Koodit Ylemmän kk-tutk. koulutusnimike"
,d36.koulutus_koodi as "Koodit Lääk. erikois.tutk. koulutusnimike"
,d39.koulutusala2002_koodi as "Koodit Lisensiaatin tutk. koulutusala 02"
,d39.opintoala1995_koodi as "Koodit Lisensiaatin tutk. koulutusala 95"
,d39.opintoala2002_koodi as "Koodit Lisensiaatin tutk. opintoala"
,d39.koulutus_koodi as "Koodit Lisensiaatin tutk. koulutusnimike"
,d42.koulutusala2002_koodi as "Koodit Tohtorin tutk. koulutusala 02"
,d42.opintoala1995_koodi as "Koodit Tohtorin tutk. koulutusala 95"
,d42.opintoala2002_koodi as "Koodit Tohtorin tutk. opintoala"
,d42.koulutus_koodi as "Koodit Tohtorin tutk. koulutusnimike"
,rivinumero
--isced
,d3.iscle2011 as "Koulutusaste, taso 1"
,d3.Koulutusaste_taso2 as "Koulutusaste, taso 2"
,d3.iscfibroad2013 as "Koulutusala, taso 1"
,d3.iscfinarrow2013 as "Koulutusala, taso 2"
,d3.iscfi2013 as "Koulutusala, taso 3"
,d3.OKM_ohjauksen_ala as "OKM ohjauksen ala"
,d3.jarjestys_iscle2011 as jarj_isced_koulast1
,d3.jarjestys_Koulutusaste_taso2 as jarj_isced_koulast2
,d3.jarjestys_iscfibroad2013 as jarj_isced_koulala1
,d3.jarjestys_iscfinarrow2013 as jarj_isced_koulala2
,d3.jarjestys_iscfi2013 as jarj_isced_koulala3
,d3.jarjestys_OKM_ohjauksen_ala as jarj_isced_okmohjaus1
,d3.iscle2011_koodi as "Koodit Koulutusaste, taso 1"
,d3.Koulutusaste_taso2_koodi as "Koodit Koulutusaste, taso 2"
,d3.iscfibroad2013_koodi as "Koodit Koulutusala, taso 1"
,d3.iscfinarrow2013_koodi as "Koodit Koulutusala, taso 2"
,d3.iscfi2013_koodi as "Koodit Koulutusala, taso 3"
,d3.OKM_ohjauksen_ala_koodi as "Koodit OKM ohjauksen ala"
,d12.iscfi2013 as "Yo-tutkinnon koulutusala 3"
,d15.iscfibroad2013 as "Amm. tutkinnon koulutusala 1"
,d15.iscfinarrow2013 as "Amm. tutkinnon koulutusala 2"
,d15.iscfi2013 as "Amm. tutkinnon koulutusala 3"
,d18.iscfibroad2013 as "Opistoast. tutkinnon koulutusala 1"
,d18.iscfinarrow2013 as "Opistoast. tutkinnon koulutusala 2"
,d18.iscfi2013 as "Opistoast. tutkinnon koulutusala 3"
,d21.iscfibroad2013 as "Amm. kork.asteen tutk. koulutusala 1"
,d21.iscfinarrow2013 as "Amm. kork.asteen tutk. koulutusala 2"
,d21.iscfi2013 as "Amm. kork.asteen tutk. koulutusala 3"
,d24.iscfibroad2013 as "Amk-tutkinnon koulutusala 1"
,d24.OKM_ohjauksen_ala as "Amk-tutkinnon OKM ohjauksen ala"
,d24.iscfinarrow2013 as "Amk-tutkinnon koulutusala 2"
,d24.iscfi2013 as "Amk-tutkinnon koulutusala 3"
,d27.iscfibroad2013 as "Alemman kk-tutk. koulutusala 1"
,d27.OKM_ohjauksen_ala as "Alemman kk-tutk. OKM ohjauksen ala"
,d27.iscfinarrow2013 as "Alemman kk-tutk. koulutusala 2"
,d27.iscfi2013 as "Alemman kk-tutk. koulutusala 3"
,d30.iscfibroad2013 as "Ylemmän amk-tutk. koulutusala 1"
,d30.OKM_ohjauksen_ala as "Ylemmän amk-tutk. OKM ohjauksen ala"
,d30.iscfinarrow2013 as "Ylemmän amk-tutk. koulutusala 2"
,d30.iscfi2013 as "Ylemmän amk-tutk. koulutusala 3"
,d33.iscfibroad2013 as "Ylemmän kk-tutk. koulutusala 1"
,d33.OKM_ohjauksen_ala as "Ylemmän kk-tutk. OKM ohjauksen ala"
,d33.iscfinarrow2013 as "Ylemmän kk-tutk. koulutusala 2"
,d33.iscfi2013 as "Ylemmän kk-tutk. koulutusala 3"
,d36.iscfi2013 as "Lääk. erikois.tutk. koulutusala 3"
,d39.iscfibroad2013 as "Lisensiaatin tutk. koulutusala 1"
,d39.OKM_ohjauksen_ala as "Lisensiaatin tutk. OKM ohjauksen ala"
,d39.iscfinarrow2013 as "Lisensiaatin tutk. koulutusala 2"
,d39.iscfi2013 as "Lisensiaatin tutk. koulutusala 3"
,d42.iscfibroad2013 as "Tohtorin tutk. koulutusala 1"
,d42.OKM_ohjauksen_ala as "Tohtorin tutk. OKM ohjauksen ala"
,d42.iscfinarrow2013 as "Tohtorin tutk. koulutusala 2"
,d42.iscfi2013 as "Tohtorin tutk. koulutusala 3"
,d12.jarjestys_iscfi2013 as jarj_lukio_iscfi2013
,d15.jarjestys_iscfibroad2013 as jarj_amm_iscfibroad2013
,d15.jarjestys_iscfinarrow2013 as jarj_amm_iscfinarrow2013
,d15.jarjestys_iscfi2013 as jarj_amm_iscfi2013
,d18.jarjestys_iscfibroad2013 as jarj_opisto_iscfibroad2013
,d18.jarjestys_iscfinarrow2013 as jarj_opisto_iscfinarrow2013
,d18.jarjestys_iscfi2013 as jarj_opisto_iscfi2013
,d21.jarjestys_iscfibroad2013 as jarj_amm_kork_aste_iscfibroad2013
,d21.jarjestys_iscfinarrow2013 as jarj_amm_kork_aste_iscfinarrow2013
,d21.jarjestys_iscfi2013 as jarj_amm_kork_aste_iscfi2013
,d24.jarjestys_iscfibroad2013 as jarj_amk_iscfibroad2013
,d24.jarjestys_OKM_ohjauksen_ala as jarj_amk_OKM_ohjauksen_ala
,d24.jarjestys_iscfinarrow2013 as jarj_amk_iscfinarrow2013
,d24.jarjestys_iscfi2013 as jarj_amk_iscfi2013
,d27.jarjestys_iscfibroad2013 as jarj_alempi_kk_iscfibroad2013
,d27.jarjestys_OKM_ohjauksen_ala as jarj_alempi_kk_OKM_ohjauksen_ala
,d27.jarjestys_iscfinarrow2013 as jarj_alempi_kk_iscfinarrow2013
,d27.jarjestys_iscfi2013 as jarj_alempi_kk_iscfi2013
,d30.jarjestys_iscfibroad2013 as jarj_ylempi_amk_iscfibroad2013
,d30.jarjestys_OKM_ohjauksen_ala as jarj_ylempi_amk_OKM_ohjauksen_ala
,d30.jarjestys_iscfinarrow2013 as jarj_ylempi_amk_iscfinarrow2013
,d30.jarjestys_iscfi2013 as jarj_ylempi_amk_iscfi2013
,d33.jarjestys_iscfibroad2013 as jarj_ylempi_kk_iscfibroad2013
,d33.jarjestys_OKM_ohjauksen_ala as jarj_ylempi_kk_OKM_ohjauksen_ala
,d33.jarjestys_iscfinarrow2013 as jarj_ylempi_kk_iscfinarrow2013
,d33.jarjestys_iscfi2013 as jarj_ylempi_kk_iscfi2013
,d36.jarjestys_iscfi2013 as jarj_laak_erik_iscfi2013
,d39.jarjestys_iscfibroad2013 as jarj_lis_iscfibroad2013
,d39.jarjestys_OKM_ohjauksen_ala as jarj_lis_OKM_ohjauksen_ala
,d39.jarjestys_iscfinarrow2013 as jarj_lis_iscfinarrow2013
,d39.jarjestys_iscfi2013 as jarj_lis_iscfi2013
,d42.jarjestys_iscfibroad2013 as jarj_toht_iscfibroad2013
,d42.jarjestys_OKM_ohjauksen_ala as jarj_toht_OKM_ohjauksen_ala
,d42.jarjestys_iscfinarrow2013 as jarj_toht_iscfinarrow2013
,d42.jarjestys_iscfi2013 as jarj_toht_iscfi2013
,d12.iscfi2013_koodi as "Koodit Yo-tutkinnon koulutusala 3"
,d15.iscfibroad2013_koodi as "Koodit Amm. tutkinnon koulutusala 1"
,d15.iscfinarrow2013_koodi as "Koodit Amm. tutkinnon koulutusala 2"
,d15.iscfi2013_koodi as "Koodit Amm. tutkinnon koulutusala 3"
,d18.iscfibroad2013_koodi as "Koodit Opistoast. tutkinnon koulutusala 1"
,d18.iscfinarrow2013_koodi as "Koodit Opistoast. tutkinnon koulutusala 2"
,d18.iscfi2013_koodi as "Koodit Opistoast. tutkinnon koulutusala 3"
,d21.iscfibroad2013_koodi as "Koodit Amm. kork.asteen tutk. koulutusala 1"
,d21.iscfinarrow2013_koodi as "Koodit Amm. kork.asteen tutk. koulutusala 2"
,d21.iscfi2013_koodi as "Koodit Amm. kork.asteen tutk. koulutusala 3"
,d24.iscfibroad2013_koodi as "Koodit Amk-tutkinnon koulutusala 1"
,d24.OKM_ohjauksen_ala_koodi as "Koodit Amk-tutkinnon OKM ohjauksen ala"
,d24.iscfinarrow2013_koodi as "Koodit Amk-tutkinnon koulutusala 2"
,d24.iscfi2013_koodi as "Koodit Amk-tutkinnon koulutusala 3"
,d27.iscfibroad2013_koodi as "Koodit Alemman kk-tutk. koulutusala 1"
,d27.OKM_ohjauksen_ala_koodi as "Koodit Alemman kk-tutk. OKM ohjauksen ala"
,d27.iscfinarrow2013_koodi as "Koodit Alemman kk-tutk. koulutusala 2"
,d27.iscfi2013_koodi as "Koodit Alemman kk-tutk. koulutusala 3"
,d30.iscfibroad2013_koodi as "Koodit Ylemmän amk-tutk. koulutusala 1"
,d30.OKM_ohjauksen_ala_koodi as "Koodit Ylemmän amk-tutk. OKM ohjauksen ala"
,d30.iscfinarrow2013_koodi as "Koodit Ylemmän amk-tutk. koulutusala 2"
,d30.iscfi2013_koodi as "Koodit Ylemmän amk-tutk. koulutusala 3"
,d33.iscfibroad2013_koodi as "Koodit Ylemmän kk-tutk. koulutusala 1"
,d33.OKM_ohjauksen_ala_koodi as "Koodit Ylemmän kk-tutk. OKM ohjauksen ala"
,d33.iscfinarrow2013_koodi as "Koodit Ylemmän kk-tutk. koulutusala 2"
,d33.iscfi2013_koodi as "Koodit Ylemmän kk-tutk. koulutusala 3"
,d36.iscfi2013_koodi as "Koodit Lääk. erikois.tutk. koulutusala 3"
,d39.iscfibroad2013_koodi as "Koodit Lisensiaatin tutk. koulutusala 1"
,d39.OKM_ohjauksen_ala_koodi as "Koodit Lisensiaatin tutk. OKM ohjauksen ala"
,d39.iscfinarrow2013_koodi as "Koodit Lisensiaatin tutk. koulutusala 2"
,d39.iscfi2013_koodi as "Koodit Lisensiaatin tutk. koulutusala 3"
,d42.iscfibroad2013_koodi as "Koodit Tohtorin tutk. koulutusala 1"
,d42.OKM_ohjauksen_ala_koodi as "Koodit Tohtorin tutk. OKM ohjauksen ala"
,d42.iscfinarrow2013_koodi as "Koodit Tohtorin tutk. koulutusala 2"
,d42.iscfi2013_koodi as "Koodit Tohtorin tutk. koulutusala 3"

FROM dbo.f_tutkinnon_suorittaneiden_myohempi_koulutus_4_8
	JOIN d_tarkastelujakso d1 ON d1.id = tarkastelujakso_id
	JOIN d_aidinkieli_versio1 d2 ON d2.id = aidinkieli_id
	JOIN d_koulutusluokitus d3 ON d3.id = koulutusluokitus_id
	JOIN d_sukupuoli d4 ON d4.id = sukupuoli_id
	JOIN d_kausi d5 ON d5.kausi_id = suorituskausi_id
	JOIN d_kausi d6 ON d6.kausi_id = aloituskausi_id
	JOIN d_oppisopimuskoulutus d7 ON d7.id = oppisopimuskoulutus_id
	JOIN d_ammatillisen_koulutuksen_koulutuslaji d8 ON d8.id = ammatillisen_koulutuksen_koulutuslaji_id
	JOIN d_opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus d9 ON d9.id = opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_id
	JOIN d_nuorten_aikuisten_koulutus_amm d10 ON d10.id = nuorten_aikuisten_koulutus_amm_id
	JOIN d_ika d11 ON d11.id = ika_id
	JOIN d_koulutusluokitus d12 ON d12.id = lu_myohempi_koulutusluokitus_id
	JOIN d_tutkinto_suoritettu d13 ON d13.id = lu_myohempi_tutkinto_suoritettu_id
	JOIN d_koulutuksesta_kulunut_aika d14 ON d14.id = lu_ika_id
	JOIN d_nuorten_aikuisten_koulutus_amm d141 ON d141.id = lu_nuorten_aikuisten_koulutus_amm_id
	JOIN d_koulutusluokitus d15 ON d15.id = amm_myohempi_koulutusluokitus_id
	JOIN d_tutkinto_suoritettu d16 ON d16.id = amm_myohempi_tutkinto_suoritettu_id
	JOIN d_koulutuksesta_kulunut_aika d17 ON d17.id = amm_ika_id
	JOIN d_ammatillisen_koulutuksen_koulutuslaji d171 ON d171.id = ammtutklaja_id
	JOIN d_opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus d172 ON d172.id = ammtutktav_id
	JOIN d_oppisopimuskoulutus d173 ON d173.id = ammoppis_id
	JOIN d_tutkintojen_maara d174 ON d174.id = ammlkm_id
	JOIN d_ammatillinen_koulutus_luokittelu d175 on d175.id = ammatillinen_koulutus_ryhma_id
	JOIN d_koulutusluokitus d18 ON d18.id = opist_myohempi_koulutusluokitus_id
	JOIN d_tutkinto_suoritettu d19 ON d19.id = opist_myohempi_tutkinto_suoritettu_id
	JOIN d_koulutuksesta_kulunut_aika d20 ON d20.id = opist_ika_id
	JOIN d_koulutusluokitus d21 ON d21.id = ammka_myohempi_koulutusluokitus_id
	JOIN d_tutkinto_suoritettu d22 ON d22.id = ammka_myohempi_tutkinto_suoritettu_id
	JOIN d_koulutuksesta_kulunut_aika d23 ON d23.id = ammka_ika_id
	JOIN d_koulutusluokitus d24 ON d24.id = amk_myohempi_koulutusluokitus_id
	JOIN d_tutkinto_suoritettu d25 ON d25.id = amk_myohempi_tutkinto_suoritettu_id
	JOIN d_koulutuksesta_kulunut_aika d26 ON d26.id = amk_ika_id
	JOIN d_tutkintojen_maara d261 ON d261.id = amklkm_id
	JOIN d_aikuisopiskelija d262 ON d262.id = amkaikoul_id
	JOIN d_koulutusluokitus d27 ON d27.id = akk_myohempi_koulutusluokitus_id
	JOIN d_tutkinto_suoritettu d28 ON d28.id = akk_myohempi_tutkinto_suoritettu_id
	JOIN d_koulutuksesta_kulunut_aika d29 ON d29.id = akk_ika_id
	JOIN d_tutkintojen_maara d291 ON d291.id = akklkm_id
	JOIN d_koulutusluokitus d30 ON d30.id = ylamk_myohempi_koulutusluokitus_id
	JOIN d_tutkinto_suoritettu d31 ON d31.id = ylamk_myohempi_tutkinto_suoritettu_id
	JOIN d_koulutuksesta_kulunut_aika d32 ON d32.id = ylamk_ika_id
	JOIN d_koulutusluokitus d33 ON d33.id = ykk_myohempi_koulutusluokitus_id
	JOIN d_tutkinto_suoritettu d34 ON d34.id = ykk_myohempi_tutkinto_suoritettu_id
	JOIN d_koulutuksesta_kulunut_aika d35 ON d35.id = ykk_ika_id
	JOIN d_tutkintojen_maara d351 ON d351.id = ykklkm_id
	JOIN d_koulutusluokitus d36 ON d36.id = laaker_myohempi_koulutusluokitus_id
	JOIN d_tutkinto_suoritettu d37 ON d37.id = laaker_myohempi_tutkinto_suoritettu_id
	JOIN d_koulutuksesta_kulunut_aika d38 ON d38.id = laaker_ika_id
	JOIN d_koulutusluokitus d39 ON d39.id = lis_myohempi_koulutusluokitus_id
	JOIN d_tutkinto_suoritettu d40 ON d40.id = lis_myohempi_tutkinto_suoritettu_id
	JOIN d_koulutuksesta_kulunut_aika d41 ON d41.id = lis_ika_id
	JOIN d_koulutusluokitus d42 ON d42.id = toht_myohempi_koulutusluokitus_id
	JOIN d_tutkinto_suoritettu d43 ON d43.id = toht_myohempi_tutkinto_suoritettu_id
	JOIN d_koulutuksesta_kulunut_aika d44 ON d44.id = toht_ika_id
	JOIN d_tutkinto_suoritettu d45 ON d45.id = yliopistotutkinto_myohempi_suoritettu_id
	JOIN d_tutkinto_suoritettu d46 ON d46.id = yo_jatkotutkinto_myohempi_suoritettu_id
	JOIN d_tutkinto_suoritettu d47 ON d47.id = opisto_tai_ammatillisen_korkea_asteen_tutkinto_myohempi_suoritettu_id
	JOIN d_tutkinto_suoritettu d48 ON d48.id = korkeakoulututkinto_myohempi_suoritettu_id
	JOIN d_tutkinto_suoritettu d49 ON d49.id = toisen_asteen_tutkinto_myohempi_suoritettu_id
	JOIN d_tutkinto_suoritettu d50 ON d50.id = ammatillisen_tutkinto_myohempi_suoritettu_ryhma1_id
	JOIN d_tutkinto_suoritettu d51 ON d51.id = ammatillisen_tutkinto_myohempi_suoritettu_ryhma2_id
	JOIN d_tutkinto_suoritettu d52 ON d52.id = ammatillisen_tutkinto_myohempi_suoritettu_ryhma3_id
	JOIN d_sama_koulutusala d53 ON d53.id = lu_sama_myohempi_koulutusala2002_id
	JOIN d_sama_koulutusala d54 ON d54.id = amm_sama_myohempi_koulutusala2002_id
	JOIN d_sama_koulutusala d55 ON d55.id = opist_sama_myohempi_koulutusala2002_id
	JOIN d_sama_koulutusala d56 ON d56.id = ammka_sama_myohempi_koulutusala2002_id
	JOIN d_sama_koulutusala d57 ON d57.id = amk_sama_myohempi_koulutusala2002_id
	JOIN d_sama_koulutusala d58 ON d58.id = akk_sama_myohempi_koulutusala2002_id
	JOIN d_sama_koulutusala d59 ON d59.id = ylamk_sama_myohempi_koulutusala2002_id
	JOIN d_sama_koulutusala d60 ON d60.id = ykk_sama_myohempi_koulutusala2002_id
	JOIN d_sama_koulutusala d61 ON d61.id = laaker_sama_myohempi_koulutusala2002_id
	JOIN d_sama_koulutusala d62 ON d62.id = lis_sama_myohempi_koulutusala2002_id
	JOIN d_sama_koulutusala d63 ON d63.id = toht_sama_myohempi_koulutusala2002_id
	JOIN d_sama_koulutusala d64 ON d64.id = yliopistotutkinto_sama_myohempi_koulutusala2002_id
	JOIN d_sama_koulutusala d65 ON d65.id = yo_jatkotutkinto_sama_myohempi_koulutusala2002_id
	JOIN d_sama_koulutusala d66 ON d66.id = opisto_tai_ammatillisen_korkea_asteen_tutkinto_sama_myohempi_koulutusala2002_id
	JOIN d_sama_koulutusala d67 ON d67.id = korkeakoulututkinto_sama_myohempi_koulutusala2002_id
	JOIN d_sama_koulutusala d68 ON d68.id = toisen_asteen_tutkinto_sama_myohempi_koulutusala2002_id
	JOIN d_sama_koulutusala d69 ON d69.id = lu_sama_myohempi_opintoala2002_id
	JOIN d_sama_koulutusala d70 ON d70.id = amm_sama_myohempi_opintoala2002_id
	JOIN d_sama_koulutusala d71 ON d71.id = opist_sama_myohempi_opintoala2002_id
	JOIN d_sama_koulutusala d72 ON d72.id = ammka_sama_myohempi_opintoala2002_id
	JOIN d_sama_koulutusala d73 ON d73.id = akk_sama_myohempi_opintoala2002_id
	JOIN d_sama_koulutusala d74 ON d74.id = amk_sama_myohempi_opintoala2002_id
	JOIN d_sama_koulutusala d75 ON d75.id = ylamk_sama_myohempi_opintoala2002_id
	JOIN d_sama_koulutusala d76 ON d76.id = ykk_sama_myohempi_opintoala2002_id
	JOIN d_sama_koulutusala d77 ON d77.id = laaker_sama_myohempi_opintoala2002_id
	JOIN d_sama_koulutusala d78 ON d78.id = lis_sama_myohempi_opintoala2002_id
	JOIN d_sama_koulutusala d79 ON d79.id = toht_sama_myohempi_opintoala2002_id
	JOIN d_sama_koulutusala d80 ON d80.id = yliopistotutkinto_sama_myohempi_opintoala2002_id
	JOIN d_sama_koulutusala d81 ON d81.id = yo_jatkotutkinto_sama_myohempi_opintoala2002_id
	JOIN d_sama_koulutusala d82 ON d82.id = opisto_tai_ammatillisen_korkea_asteen_tutkinto_sama_myohempi_opintoala2002_id
	JOIN d_sama_koulutusala d83 ON d83.id = korkeakoulututkinto_sama_myohempi_opintoala2002_id
	JOIN d_sama_koulutusala d84 ON d84.id = toisen_asteen_tutkinto_sama_myohempi_opintoala2002_id
	JOIN d_sama_koulutusala d85 ON d85.id = lu_sama_myohempi_opintoala1995_id
	JOIN d_sama_koulutusala d86 ON d86.id = amm_sama_myohempi_opintoala1995_id
	JOIN d_sama_koulutusala d87 ON d87.id = opist_sama_myohempi_opintoala1995_id
	JOIN d_sama_koulutusala d88 ON d88.id = ammka_sama_myohempi_opintoala1995_id
	JOIN d_sama_koulutusala d89 ON d89.id = akk_sama_myohempi_opintoala1995_id
	JOIN d_sama_koulutusala d90 ON d90.id = amk_sama_myohempi_opintoala1995_id
	JOIN d_sama_koulutusala d91 ON d91.id = ylamk_sama_myohempi_opintoala1995_id
	JOIN d_sama_koulutusala d92 ON d92.id = ykk_sama_myohempi_opintoala1995_id
	JOIN d_sama_koulutusala d93 ON d93.id = laaker_sama_myohempi_opintoala1995_id
	JOIN d_sama_koulutusala d94 ON d94.id = lis_sama_myohempi_opintoala1995_id
	JOIN d_sama_koulutusala d95 ON d95.id = toht_sama_myohempi_opintoala1995_id
	JOIN d_sama_koulutusala d96 ON d96.id = yliopistotutkinto_sama_myohempi_opintoala1995_id
	JOIN d_sama_koulutusala d97 ON d97.id = yo_jatkotutkinto_sama_myohempi_opintoala1995_id
	JOIN d_sama_koulutusala d98 ON d98.id = opisto_tai_ammatillisen_korkea_asteen_tutkinto_sama_myohempi_opintoala1995_id
	JOIN d_sama_koulutusala d99 ON d99.id = korkeakoulututkinto_sama_myohempi_opintoala1995_id
	JOIN d_sama_koulutusala d100 ON d100.id = toisen_asteen_tutkinto_sama_myohempi_opintoala1995_id
	JOIN d_sama_koulutusala d101 ON d101.id = lu_sama_myohempi_iscfibroad2013_id
	JOIN d_sama_koulutusala d102 ON d102.id = amm_sama_myohempi_iscfibroad2013_id
	JOIN d_sama_koulutusala d103 ON d103.id = opist_sama_myohempi_iscfibroad2013_id
	JOIN d_sama_koulutusala d104 ON d104.id = ammka_sama_myohempi_iscfibroad2013_id
	JOIN d_sama_koulutusala d105 ON d105.id = akk_sama_myohempi_iscfibroad2013_id
	JOIN d_sama_koulutusala d106 ON d106.id = amk_sama_myohempi_iscfibroad2013_id
	JOIN d_sama_koulutusala d107 ON d107.id = ylamk_sama_myohempi_iscfibroad2013_id
	JOIN d_sama_koulutusala d108 ON d108.id = ykk_sama_myohempi_iscfibroad2013_id
	JOIN d_sama_koulutusala d109 ON d109.id = laaker_sama_myohempi_iscfibroad2013_id
	JOIN d_sama_koulutusala d110 ON d110.id = lis_sama_myohempi_iscfibroad2013_id
	JOIN d_sama_koulutusala d111 ON d111.id = toht_sama_myohempi_iscfibroad2013_id
	JOIN d_sama_koulutusala d112 ON d112.id = yliopistotutkinto_sama_myohempi_iscfibroad2013_id
	JOIN d_sama_koulutusala d113 ON d113.id = yo_jatkotutkinto_sama_myohempi_iscfibroad2013_id
	JOIN d_sama_koulutusala d114 ON d114.id = opisto_tai_ammatillisen_korkea_asteen_tutkinto_sama_myohempi_iscfibroad2013_id
	JOIN d_sama_koulutusala d115 ON d115.id = korkeakoulututkinto_sama_myohempi_iscfibroad2013_id
	JOIN d_sama_koulutusala d116 ON d116.id = toisen_asteen_tutkinto_sama_myohempi_iscfibroad2013_id
	JOIN d_sama_koulutusala d117 ON d117.id = lu_sama_myohempi_iscfinarrow2013_id
	JOIN d_sama_koulutusala d118 ON d118.id = amm_sama_myohempi_iscfinarrow2013_id
	JOIN d_sama_koulutusala d119 ON d119.id = opist_sama_myohempi_iscfinarrow2013_id
	JOIN d_sama_koulutusala d120 ON d120.id = ammka_sama_myohempi_iscfinarrow2013_id
	JOIN d_sama_koulutusala d121 ON d121.id = akk_sama_myohempi_iscfinarrow2013_id
	JOIN d_sama_koulutusala d122 ON d122.id = amk_sama_myohempi_iscfinarrow2013_id
	JOIN d_sama_koulutusala d123 ON d123.id = ylamk_sama_myohempi_iscfinarrow2013_id
	JOIN d_sama_koulutusala d124 ON d124.id = ykk_sama_myohempi_iscfinarrow2013_id
	JOIN d_sama_koulutusala d125 ON d125.id = laaker_sama_myohempi_iscfinarrow2013_id
	JOIN d_sama_koulutusala d126 ON d126.id = lis_sama_myohempi_iscfinarrow2013_id
	JOIN d_sama_koulutusala d127 ON d127.id = toht_sama_myohempi_iscfinarrow2013_id
	JOIN d_sama_koulutusala d128 ON d128.id = yliopistotutkinto_sama_myohempi_iscfinarrow2013_id
	JOIN d_sama_koulutusala d129 ON d129.id = yo_jatkotutkinto_sama_myohempi_iscfinarrow2013_id
	JOIN d_sama_koulutusala d130 ON d130.id = opisto_tai_ammatillisen_korkea_asteen_tutkinto_sama_myohempi_iscfinarrow2013_id
	JOIN d_sama_koulutusala d131 ON d131.id = korkeakoulututkinto_sama_myohempi_iscfinarrow2013_id
	JOIN d_sama_koulutusala d132 ON d132.id = toisen_asteen_tutkinto_sama_myohempi_iscfinarrow2013_id












' 
GO
/****** Object:  View [dbo].[v_f_tab_tutkinnon_suorittaneiden_osuus_aloittaneista_erityisopiskelijat]    Script Date: 21.6.2017 10:17:26 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_tutkinnon_suorittaneiden_osuus_aloittaneista_erityisopiskelijat]'))
EXEC dbo.sp_executesql @statement = N'













CREATE VIEW [dbo].[v_f_tab_tutkinnon_suorittaneiden_osuus_aloittaneista_erityisopiskelijat] AS
SELECT [tilv] AS Tilastovuosi
      ,d1.lahde AS [Lähde]
      ,[alvv] AS Aloitusvuosi
      ,d2.koulutuksen_jarjestaja AS [Koulutuksen järjestäjä]
	  ,d2.koulutuksen_jarjestajan_kieli AS [Koul. järjestäjän kieli]
	  ,d2.koulutuksen_jarjestajan_omistajatyyppi AS [Koul. järjestäjän omistajatyyppi]
	  ,d2.koulutuksen_jarjestajan_sijaintikunta AS [Koul. järjestäjän sijaintikunta]
	  ,d3.koulutusala AS Koulutusala
	  ,d4.maakunta AS [Koulutuksen maakunta]
	  ,d4.suuralue AS [Koulutuksen suuralue]
	  ,d4.ely AS [Koulutuksen ELY]
	  ,d4.avi AS [Koulutuksen AVI]
      ,CASE WHEN suorv = -1 THEN ''Tuntematon'' ELSE CAST([suorv] AS nvarchar(4)) END AS [Tutkinnon suoritusvuosi]
	  ,d5.koulutusala AS [Suor. tutkinnon koulutusala]
	  ,d6.suoritettu_tutkinto AS [Suoritettu tutkinto]
	  ,CASE WHEN d3.id = d5.id THEN ''Tutkinto alkuperäisellä koulutusalalla'' WHEN d3.id <> d5.id AND d5.id <> -1 THEN ''Tutkinto muulla koulutusalalla'' ELSE ''Ei suoritettua tutkintoa'' END AS [Tutk. suor. alkup. koulutusalalla]
	  ,d7.tarkastelujakso AS Tarkastelujakso

	  --ruotsi
	  ,[tilv] AS [Statistikår]
      ,d1.lahde_SV AS [Källa]
      ,[alvv] AS [Begynnelseläsår]
      ,d2.koulutuksen_jarjestaja_SV AS [Utbildningsanordnare]
	  ,d2.koulutuksen_jarjestajan_kieli_SV AS [Utbildningsanordnarens språk]
	  ,d2.koulutuksen_jarjestajan_omistajatyyppi_SV AS [Utbildningsanordnaren ägartyp]
	  ,d2.koulutuksen_jarjestajan_sijaintikunta_SV AS [Utbildningsanordnarens kommun]
	  ,d3.koulutusala_SV AS [Utbildningsområde]
	  ,d4.maakunta_SV AS [Utbildningens landskap]
	  ,d4.suuralue_SV AS [Utbildningens storområde]
	  ,d4.ely_SV AS [Utbildningens NTM-område]
	  ,d4.avi_SV AS [Utbildningens RFV-område]
      ,CASE WHEN suorv = -1 THEN ''Okänd'' ELSE CAST([suorv] AS nvarchar(4)) END AS [År då utbildningen avlagts]
	  ,d5.koulutusala_SV AS [Avl. examens utbildningsområde]
	  ,d6.suoritettu_tutkinto_SV AS [Avlagd examen]
	  ,CASE WHEN d3.id = d5.id THEN ''Examina i det ursprungliga utbildningsområde'' WHEN d3.id <> d5.id AND d5.id <> -1 THEN ''Examina på andra utbildningsområde'' ELSE ''Ingen examina'' END AS [Examen avl. på urspr. utbildningsområde]
	  ,d7.tarkastelujakso_SV AS Granskningsperiod

	  --englanti
	  ,[tilv] AS [Statistical year]
      ,d1.lahde_EN AS [Source]
      ,[alvv] AS [First academic year]
      ,d2.koulutuksen_jarjestaja_EN AS [Education provider]
	  ,d2.koulutuksen_jarjestajan_kieli_EN AS [Language of the education provider]
	  ,d2.koulutuksen_jarjestajan_omistajatyyppi_EN AS [Type of education provider]
	  ,d2.koulutuksen_jarjestajan_sijaintikunta_EN AS [Municipality of the education provider]
	  ,d3.koulutusala_EN AS [Field of education]
	  ,d4.maakunta_EN AS [Region of education]
	  ,d4.suuralue_EN AS [Major region of education]
	  ,d4.ely_EN AS [ELY area of education]
	  ,d4.avi_EN AS [AVI area of education]
      ,CASE WHEN suorv = -1 THEN ''Unknown'' ELSE CAST([suorv] AS nvarchar(4)) END AS [Graduation year]
	  ,d5.koulutusala_EN AS [Qualification''s field of education]
	  ,d6.suoritettu_tutkinto_EN AS [Completed qualification]
	  ,CASE WHEN d3.id = d5.id THEN ''Degree from the original field of education'' WHEN d3.id <> d5.id AND d5.id <> -1 THEN ''Degree from another field of education'' ELSE ''No attained degree'' END AS [Completed qualif. in orig. field of education]
	  ,d7.tarkastelujakso_EN AS [Reference period]

      ,[lkm] as lkm_int2
	  ,d1.jarjestys
      ,d2.jarjestys_koulutuksenjarjestaja
	  ,d2.jarjestys_koulutuksen_jarjestajan_kieli
	  ,d2.jarjestys_sijaintikunta_koulutuksenjarjestaja
	  ,d2.koulutuksen_jarjestajan_omistajatyyppikoodi
	  ,d3.jarjestys AS jarjestys_koulutusala
	  ,d4.jarjestys_maakunta
	  ,d4.jarjestys_suuralue
	  ,d4.jarjestys_ely
	  ,d4.jarjestys_avi
	  ,d5.jarjestys AS jarjestys_suoritettu_koulutusala
	  ,d6.jarjestys AS jarjestys_suoritettu_tutkinto
	  ,d7.jarjestys AS jarjestys_tarkastelujakso
	  ,CASE WHEN d3.id = d5.id THEN 0 WHEN d3.id <> d5.id AND d5.id <> -1 THEN 1 ELSE 2 END AS jarjestys_tutk_suor_alkup_koulutusalalla
  FROM [VipunenTK].[dbo].[f_tutkinnon_suorittaneiden_osuus_aloittaneista_erityisopiskelijat] f
  INNER JOIN [VipunenTK].[dbo].[d_lahde] d1 ON d1.id = f.lahde_id
  INNER JOIN [VipunenTK].[dbo].[d_oppilaitoksen_taustatiedot] d2 ON d2.id = f.oppilaitoksen_taustatiedot_id
  INNER JOIN [VipunenTK].[dbo].[d_opetushallinnon_koulutusala] d3 ON d3.id = f.koulutusala_id
  INNER JOIN [VipunenTK].[dbo].[d_alueluokitus] d4 ON d4.id = f.alueluokitus_id
  INNER JOIN [VipunenTK].[dbo].[d_opetushallinnon_koulutusala] d5 ON d5.id = f.suoritettu_koulutusala_id
  INNER JOIN [VipunenTK].[dbo].[d_suoritettu_tutkinto] d6 ON d6.id = f.suoritettu_tutkinto_id
  INNER JOIN [VipunenTK].[dbo].[d_tarkastelujakso] d7 ON d7.id = f.tarkastelujakso_id











' 
GO
/****** Object:  View [dbo].[v_f_tab_tutkinnon_suorittaneiden_osuus_poistumasta_erityisopiskelijat]    Script Date: 21.6.2017 10:17:26 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_tutkinnon_suorittaneiden_osuus_poistumasta_erityisopiskelijat]'))
EXEC dbo.sp_executesql @statement = N'

CREATE VIEW [dbo].[v_f_tab_tutkinnon_suorittaneiden_osuus_poistumasta_erityisopiskelijat] AS
SELECT [tilv] AS Tilastovuosi
      ,d1.lahde AS [Lähde]
	  ,d2.maakunta AS [Koulutuksen maakunta]
	  ,d2.suuralue AS [Koulutuksen suuralue]
	  ,d2.ely AS [Koulutuksen ELY]
	  ,d2.avi AS [Koulutuksen AVI]
      ,d3.koulutuksen_jarjestaja AS [Koulutuksen järjestäjä]
	  ,d3.koulutuksen_jarjestajan_kieli AS [Koul. järjestäjän kieli]
	  ,d3.koulutuksen_jarjestajan_omistajatyyppi AS [Koul. järjestäjän omistajatyyppi]
	  ,d3.koulutuksen_jarjestajan_sijaintikunta AS [Koul. järjestäjän sijaintikunta]
      ,d4.koulutus AS [Koulutusnimike]
	  ,d4.opintoala2002 AS [Opintoala]
	  ,d4.koulutusala2002 AS [Koulutusala]
	  ,d4.koulutusaste2002 AS [Koulutusaste]
      ,d5.opetushallinnon_koulutus AS [Hallinnonala]
	  ,d6.maakunta AS [Tutkinnon suoritusmaakunta]
	  ,d6.ely AS [Tutk. suorituspaikan ELY]
	  ,d6.avi AS [Tutk. suorituspaikan AVI]
      ,d7.koulutuksen_jarjestaja AS [Tutkinnon koul. järjestäjä]
	  ,d7.koulutuksen_jarjestajan_omistajatyyppi AS [Tutkinnon koul. järjestäjän omistajatyyppi]
	  ,d7.koulutuksen_jarjestajan_kieli [Tutkinnon koul. järjestäjän kieli]
	  ,d7.koulutuksen_jarjestajan_sijaintikunta AS [Tutkinnon koul. järjestäjän sijaintikunta]
      ,d8.koulutus AS [Tutkinnon koulutusnimike]
	  ,d8.opintoala2002 AS [Tutkinnon opintoala]
	  ,d8.koulutusala2002 AS [Tutkinnon koulutusala]
	  ,d8.koulutusaste2002 AS [Tutkinnon koulutusaste]
	  ,d9.maakunta AS [Seur. vuoden koul. maakunta]
	  ,d9.ely AS [Seur. vuoden koul. ELY]
	  ,d9.avi AS [Seur. vuoden koul. AVI]
      ,d10.koulutuksen_jarjestaja AS [Seur. vuoden koul. järjestäjä]
	  ,d10.koulutuksen_jarjestajan_omistajatyyppi AS [Seur. vuoden koul. järjestäjän omistajatyyppi]
	  ,d10.koulutuksen_jarjestajan_kieli AS [Seur. vuoden koul. järjestäjän kieli]
	  ,d10.koulutuksen_jarjestajan_sijaintikunta AS [Seur. vuoden koul. järjestäjän sijaintikunta]
      ,d11.koulutus AS [Seur. vuoden koulutusnimike]
	  ,d11.opintoala2002 AS [Seur. vuoden opintoala]
	  ,d11.koulutusala2002 AS [Seur. vuoden koulutusala]
	  ,d11.koulutusaste2002 AS [Seur. vuoden koulutusaste]
      ,d12.opintojen_kulku_koulutuksen_jarjestajan_mukaan AS [Opintojen kulku koul. järjestäjän mukaan (tutkinto priorisoitu)]
      ,d13.opintojen_kulku_koulutuksen_jarjestajan_mukaan AS [Opintojen kulku koul. järjestäjän mukaan (opiskelu priorisoitu)]
      ,d14.opintojen_kulku_maakunnan_mukaan AS [Opintojen kulku koul. maakunnan mukaan (tutkinto priorisoitu)]
      ,d15.opintojen_kulku_maakunnan_mukaan AS [Opintojen kulku koul. maakunnan mukaan (opiskelu priorisoitu)]
      ,d16.opintojen_kulku_koulutusasteen_2002_mukaan AS [Opintojen kulku koul.asteen mukaan (tutkinto priorisoitu)]
      ,d17.opintojen_kulku_koulutusasteen_2002_mukaan AS [Opintojen kulku koul.asteen mukaan (opiskelu priorisoitu)]
      ,d18.opintojen_kulku_koulutusalan_2002_mukaan AS [Opintojen kulku koul.alan mukaan (tutkinto priorisoitu)]
      ,d19.opintojen_kulku_koulutusalan_2002_mukaan AS [Opintojen kulku koul.alan mukaan (opiskelu priorisoitu)]
      ,d20.opintojen_kulku_opintoala_2002_mukaan AS [Opintojen kulku opintoalan mukaan (tutkinto priorisoitu)]
      ,d21.opintojen_kulku_opintoala_2002_mukaan AS [Opintojen kulku opintoalan mukaan (opiskelu priorisoitu)]
	  ,(SELECT kylla_ei FROM d_kylla_ei WHERE id = tutkinto_tavoitet_koul_järjeställä_tutkinto_priorisoitu_id) AS [Tutkinto tavoitet. koul. järjeställä (tutkinto priorisoitu)]
	  ,(SELECT kylla_ei FROM d_kylla_ei WHERE id = tutkinto_tavoitet_koul_järjeställä_opiskelu_priorisoitu_id) AS [Tutkinto tavoitet. koul. järjeställä (opiskelu priorisoitu)]
	  ,(SELECT kylla_ei FROM d_kylla_ei WHERE id = opiskelee_tavoitet_koul_järjeställä_tutkinto_priorisoitu_id) AS [Opiskelee tavoitet. koul. järjeställä (tutkinto priorisoitu)]
	  ,(SELECT kylla_ei FROM d_kylla_ei WHERE id = opiskelee_tavoitet_koul_järjeställä_opiskelu_priorisoitu_id) AS [Opiskelee tavoitet. koul. järjeställä (opiskelu priorisoitu)]
	  ,(SELECT kylla_ei FROM d_kylla_ei WHERE id = tutkinto_tavoitet_maakunnassa_tutkinto_priorisoitu_id) AS [Tutkinto tavoitet. maakunnassa (tutkinto priorisoitu)]
	  ,(SELECT kylla_ei FROM d_kylla_ei WHERE id = tutkinto_tavoitet_maakunnassa_opiskelu_priorisoitu_id) AS [Tutkinto tavoitet. maakunnassa (opiskelu priorisoitu)]
	  ,(SELECT kylla_ei FROM d_kylla_ei WHERE id = opiskelee_tavoitet_maakunnassa_tutkinto_priorisoitu_id) AS [Opiskelee tavoitet. maakunnassa (tutkinto priorisoitu)]
	  ,(SELECT kylla_ei FROM d_kylla_ei WHERE id = opiskelee_tavoitet_maakunnassa_opiskelu_priorisoitu_id) AS [Opiskelee tavoitet. maakunnassa (opiskelu priorisoitu)]
	  ,(SELECT kylla_ei FROM d_kylla_ei WHERE id = tutkinto_tavoitet_koul_asteella_tutkinto_priorisoitu_id) AS [Tutkinto tavoitet. koul.asteella (tutkinto priorisoitu)]
	  ,(SELECT kylla_ei FROM d_kylla_ei WHERE id = tutkinto_tavoitet_koul_asteella_opiskelu_priorisoitu_id) AS [Tutkinto tavoitet. koul.asteella (opiskelu priorisoitu)]
	  ,(SELECT kylla_ei FROM d_kylla_ei WHERE id = opiskelee_tavoitet_koul_asteella_tutkinto_priorisoitu_id) AS [Opiskelee tavoitet. koul.asteella (tutkinto priorisoitu)]
	  ,(SELECT kylla_ei FROM d_kylla_ei WHERE id = opiskelee_tavoitet_koul_asteella_opiskelu_priorisoitu_id) AS [Opiskelee tavoitet. koul.asteella (opiskelu priorisoitu)]
	  ,(SELECT kylla_ei FROM d_kylla_ei WHERE id = tutkinto_tavoitet_koul_alalla_tutkinto_priorisoitu_id) AS [Tutkinto tavoitet. koul.alalla (tutkinto priorisoitu)]
	  ,(SELECT kylla_ei FROM d_kylla_ei WHERE id = tutkinto_tavoitet_koul_alalla_opiskelu_priorisoitu_id) AS [Tutkinto tavoitet. koul.alalla (opiskelu priorisoitu)]
	  ,(SELECT kylla_ei FROM d_kylla_ei WHERE id = opiskelee_tavoitet_koul_alalla_tutkinto_priorisoitu_id) AS [Opiskelee tavoitet. koul.alalla (tutkinto priorisoitu)]
	  ,(SELECT kylla_ei FROM d_kylla_ei WHERE id = opiskelee_tavoitet_koul_alalla_opiskelu_priorisoitu_id) AS [Opiskelee tavoitet. koul.alalla (opiskelu priorisoitu)]
	  ,(SELECT kylla_ei FROM d_kylla_ei WHERE id = tutkinto_tavoitet_opintoalalla_tutkinto_priorisoitu_id) AS [Tutkinto tavoitet. opintoalalla (tutkinto priorisoitu)]
	  ,(SELECT kylla_ei FROM d_kylla_ei WHERE id = tutkinto_tavoitet_opintoalalla_opiskelu_priorisoitu_id) AS [Tutkinto tavoitet. opintoalalla (opiskelu priorisoitu)]
	  ,(SELECT kylla_ei FROM d_kylla_ei WHERE id = opiskelee_tavoitet_opintoalalla_tutkinto_priorisoitu_id) AS [Opiskelee tavoitet. opintoalalla (tutkinto priorisoitu)]
	  ,(SELECT kylla_ei FROM d_kylla_ei WHERE id = opiskelee_tavoitet_opintoalalla_opiskelu_priorisoitu_id) AS [Opiskelee tavoitet. opintoalalla (opiskelu priorisoitu)]


	  --ruotsi
	  ,[tilv] AS [Statistikår]
      ,d1.lahde_SV AS [Källa]
	  ,d2.maakunta_SV AS [Utbildningens landskap]
	  ,d2.suuralue_SV AS [Utbildningens storområde]
	  ,d2.ely_SV AS [Utbildningens NTM-område]
	  ,d2.avi_SV AS [Utbildningens RFV-område]
      ,d3.koulutuksen_jarjestaja_SV AS [Utbildningsanordnare]
	  ,d3.koulutuksen_jarjestajan_kieli_SV AS [Utbildningsanordnarens språk]
	  ,d3.koulutuksen_jarjestajan_omistajatyyppi_SV AS [Utbildningsanordnarens ägartyp]
	  ,d3.koulutuksen_jarjestajan_sijaintikunta_SV AS [Utbildningsanordnarens kommun]
      ,d4.koulutus_SV AS [Utbildningsbenämning]
	  ,d4.opintoala2002_SV AS [Studieområde]
	  ,d4.koulutusala2002_SV AS [Utbildningsområde]
	  ,d4.koulutusaste2002_SV AS [Utbildningsnivå]
      ,d5.opetushallinnon_koulutus_SV AS [Förvaltningsområde]
	  ,d6.maakunta_SV AS [Examens landskap]
	  ,d6.ely_SV AS [Examens NMT-område]
	  ,d6.avi_SV AS [Examens RFV-område]
      ,d7.koulutuksen_jarjestaja_SV AS [Examens utbildningsanordnare]
	  ,d7.koulutuksen_jarjestajan_omistajatyyppi_SV AS [Examens utbildningsanordnarens ägartyp]
	  ,d7.koulutuksen_jarjestajan_kieli_SV AS [Examens utbildningsanordnarens språk]
	  ,d7.koulutuksen_jarjestajan_sijaintikunta_SV AS [Examens utbildningsanordnarens kommun]
      ,d8.koulutus_SV AS [Examens utbildningsbenämning]
	  ,d8.opintoala2002_SV AS [Examens studieområde]
	  ,d8.koulutusala2002_SV AS [Examens utbildningsområde]
	  ,d8.koulutusaste2002_SV AS [Examens utbildningsnivå]
	  ,d9.maakunta_SV AS [Nästa års utbildningens landskap]
	  ,d9.ely_SV AS [Nästa års utbildningens NTM-område]
	  ,d9.avi_SV AS [Nästa års utbildningens RFV-område]
      ,d10.koulutuksen_jarjestaja_SV AS [Nästa års utbildningsanordnare]
	  ,d10.koulutuksen_jarjestajan_omistajatyyppi_SV AS [Nästa års utbildningsanordnarens ägartyp]
	  ,d10.koulutuksen_jarjestajan_kieli_SV AS [Nästa års utbildningsanordnarens språk]
	  ,d10.koulutuksen_jarjestajan_sijaintikunta_SV AS [Nästa års utbildningsanordnarens kommun]
      ,d11.koulutus_SV AS [Nästa års utbildningsbenämning]
	  ,d11.opintoala2002_SV AS [Nästa års studieområde]
	  ,d11.koulutusala2002_SV AS [Nästa års utbildningsområde]
	  ,d11.koulutusaste2002_SV AS [Nästa års utbildningsnivå]
      ,d12.opintojen_kulku_koulutuksen_jarjestajan_mukaan_SV AS [Studiernas framskridande enligt utbildningsanordnare (examen prioriterad)]
      ,d13.opintojen_kulku_koulutuksen_jarjestajan_mukaan_SV AS [Studiernas framskridande enligt utbildningsanordnare (studie prioriterad)]
      ,d14.opintojen_kulku_maakunnan_mukaan_SV AS [Studiernas framskridande enligt utbildningens landskap (examen prioriterad)]
      ,d15.opintojen_kulku_maakunnan_mukaan_SV AS [Studiernas framskridande enligt utbildningens landskap (studie prioriterad)]
      ,d16.opintojen_kulku_koulutusasteen_2002_mukaan_SV AS [Studiernas framskridande enligt utbildningsnivå (examen prioriterad)]
      ,d17.opintojen_kulku_koulutusasteen_2002_mukaan_SV AS [Studiernas framskridande enligt utbildningsnivå (studie prioriterad)]
      ,d18.opintojen_kulku_koulutusalan_2002_mukaan_SV AS [Studiernas framskridande enligt utbildningsområde (examen prioriterad)]
      ,d19.opintojen_kulku_koulutusalan_2002_mukaan_SV AS [Studiernas framskridande enligt utbildningsområde (studie prioriterad)]
      ,d20.opintojen_kulku_opintoala_2002_mukaan_SV AS [Studiernas framskridande enligt studieområde (examen prioriterad)]
      ,d21.opintojen_kulku_opintoala_2002_mukaan_SV AS [Studiernas framskridande enligt studieområde (studie prioriterad)]
	  ,(SELECT kylla_ei_SV FROM d_kylla_ei WHERE id = tutkinto_tavoitet_koul_järjeställä_tutkinto_priorisoitu_id) AS [Examen i målexamens utbildningsanordnare (examen prioriterad)]
	  ,(SELECT kylla_ei_SV FROM d_kylla_ei WHERE id = tutkinto_tavoitet_koul_järjeställä_opiskelu_priorisoitu_id) AS [Examen i målexamens utbildningsanordnare (studie prioriterad)]
	  ,(SELECT kylla_ei_SV FROM d_kylla_ei WHERE id = opiskelee_tavoitet_koul_järjeställä_tutkinto_priorisoitu_id) AS [Studerar i målexamens utbildningsanordnare (examen prioriterad)]
	  ,(SELECT kylla_ei_SV FROM d_kylla_ei WHERE id = opiskelee_tavoitet_koul_järjeställä_opiskelu_priorisoitu_id) AS [Studerar i målexamens utbildningsanordnare (studie prioriterad)]
	  ,(SELECT kylla_ei_SV FROM d_kylla_ei WHERE id = tutkinto_tavoitet_maakunnassa_tutkinto_priorisoitu_id) AS [Examen i målexamens landskap (examen prioriterad)]
	  ,(SELECT kylla_ei_SV FROM d_kylla_ei WHERE id = tutkinto_tavoitet_maakunnassa_opiskelu_priorisoitu_id) AS [Examen i målexamens landskap (studie prioriterad)]
	  ,(SELECT kylla_ei_SV FROM d_kylla_ei WHERE id = opiskelee_tavoitet_maakunnassa_tutkinto_priorisoitu_id) AS [Studerar i målexamens landskap (examen prioriterad)]
	  ,(SELECT kylla_ei_SV FROM d_kylla_ei WHERE id = opiskelee_tavoitet_maakunnassa_opiskelu_priorisoitu_id) AS [Studerar i målexamens landskap (studie prioriterad)]
	  ,(SELECT kylla_ei_SV FROM d_kylla_ei WHERE id = tutkinto_tavoitet_koul_asteella_tutkinto_priorisoitu_id) AS [Examen i målexamens utbildningsnivå (examen prioriterad)]
	  ,(SELECT kylla_ei_SV FROM d_kylla_ei WHERE id = tutkinto_tavoitet_koul_asteella_opiskelu_priorisoitu_id) AS [Examen i målexamens utbildningsnivå (studie prioriterad)]
	  ,(SELECT kylla_ei_SV FROM d_kylla_ei WHERE id = opiskelee_tavoitet_koul_asteella_tutkinto_priorisoitu_id) AS [Studerar i målexamens utbildningsnivå (examen prioriterad)]
	  ,(SELECT kylla_ei_SV FROM d_kylla_ei WHERE id = opiskelee_tavoitet_koul_asteella_opiskelu_priorisoitu_id) AS [Studerar i målexamens utbildningsnivå (studie prioriterad)]
	  ,(SELECT kylla_ei_SV FROM d_kylla_ei WHERE id = tutkinto_tavoitet_koul_alalla_tutkinto_priorisoitu_id) AS [Examen i målexamens utbildningsområde (examen prioriterad)]
	  ,(SELECT kylla_ei_SV FROM d_kylla_ei WHERE id = tutkinto_tavoitet_koul_alalla_opiskelu_priorisoitu_id) AS [Examen i målexamens utbildningsområde (studie prioriterad)]
	  ,(SELECT kylla_ei_SV FROM d_kylla_ei WHERE id = opiskelee_tavoitet_koul_alalla_tutkinto_priorisoitu_id) AS [Studerar i målexamens utbildningsområde (examen prioriterad)]
	  ,(SELECT kylla_ei_SV FROM d_kylla_ei WHERE id = opiskelee_tavoitet_koul_alalla_opiskelu_priorisoitu_id) AS [Studerar i målexamens utbildningsområde (studie prioriterad)]
	  ,(SELECT kylla_ei_SV FROM d_kylla_ei WHERE id = tutkinto_tavoitet_opintoalalla_tutkinto_priorisoitu_id) AS [Examen i målexamens studieområde (examen prioriterad)]
	  ,(SELECT kylla_ei_SV FROM d_kylla_ei WHERE id = tutkinto_tavoitet_opintoalalla_opiskelu_priorisoitu_id) AS [Examen i målexamens studieområde (studie prioriterad)]
	  ,(SELECT kylla_ei_SV FROM d_kylla_ei WHERE id = opiskelee_tavoitet_opintoalalla_tutkinto_priorisoitu_id) AS [Studerar i målexamens studieområde (examen prioriterad)]
	  ,(SELECT kylla_ei_SV FROM d_kylla_ei WHERE id = opiskelee_tavoitet_opintoalalla_opiskelu_priorisoitu_id) AS [Studerar i målexamens studieområde (studie prioriterad)]


	  --englanti
	  ,[tilv] AS [Statistical year]
      ,d1.lahde_EN AS [Source]
	  ,d2.maakunta_EN AS [Region of education]
	  ,d2.suuralue_EN AS [Major region of education]
	  ,d2.ely_EN AS [ELY area of education]
	  ,d2.avi_EN AS [AVI area of education]
      ,d3.koulutuksen_jarjestaja_EN AS [Education provider]
	  ,d3.koulutuksen_jarjestajan_kieli_EN AS [Language of the education provider]
	  ,d3.koulutuksen_jarjestajan_omistajatyyppi_EN AS [Type of the education provider owner]
	  ,d3.koulutuksen_jarjestajan_sijaintikunta_EN AS [Municipality of the education provider]
      ,d4.koulutus_EN AS [Name of education]
	  ,d4.opintoala2002_EN AS [Subfield of education]
	  ,d4.koulutusala2002_EN AS [Field of education]
	  ,d4.koulutusaste2002_EN AS [Level of education]
      ,d5.opetushallinnon_koulutus_EN AS [Administrative sector]
	  ,d6.maakunta_EN AS [Qualification''s region]
	  ,d6.ely_EN AS [Qualification''s ELY]
	  ,d6.avi_EN AS [Qualification''s AVI]
      ,d7.koulutuksen_jarjestaja_EN AS [Qualification''s edducation provider]
	  ,d7.koulutuksen_jarjestajan_omistajatyyppi_EN AS [Qualification''s type of the education provider owner]
	  ,d7.koulutuksen_jarjestajan_kieli_EN AS [Qualification''s language of the education provider]
	  ,d7.koulutuksen_jarjestajan_sijaintikunta_EN AS [Qualification''s municipality of the education provider]
      ,d8.koulutus_EN AS [Qualification''s name of education]
	  ,d8.opintoala2002_EN AS [Qualification''s subfield of education]
	  ,d8.koulutusala2002_EN AS [Qualification''s field of education]
	  ,d8.koulutusaste2002_EN AS [Qualification''s level of education]
	  ,d9.maakunta_EN AS [Next year''s region of education]
	  ,d9.ely_EN AS [Next year''s ELY area of education]
	  ,d9.avi_EN AS [Next year''s AVI area of education]
      ,d10.koulutuksen_jarjestaja_EN AS [Next year''s education provider]
	  ,d10.koulutuksen_jarjestajan_omistajatyyppi_EN AS [Next year''s type of the education provider owner]
	  ,d10.koulutuksen_jarjestajan_kieli_EN AS [Next year''s language of the education provider]
	  ,d10.koulutuksen_jarjestajan_sijaintikunta_EN AS [Next year''s municipality of the education provider]
      ,d11.koulutus_EN AS [Next year''s name of education]
	  ,d11.opintoala2002_EN AS [Next year''s subfield of education]
	  ,d11.koulutusala2002_EN AS [Next year''s field of education]
	  ,d11.koulutusaste2002_EN AS [Next year''s level of education]
      ,d12.opintojen_kulku_koulutuksen_jarjestajan_mukaan_EN AS [Study progress by education provider (qualification prioritized)]
      ,d13.opintojen_kulku_koulutuksen_jarjestajan_mukaan_EN AS [Study progress by education provider (studies prioritized)]
      ,d14.opintojen_kulku_maakunnan_mukaan_EN AS [Study progress by region of education (qualification prioritized)]
      ,d15.opintojen_kulku_maakunnan_mukaan_EN AS [Study progress by region of education (studies prioritized)]
      ,d16.opintojen_kulku_koulutusasteen_2002_mukaan_EN AS [Study progress by level of education (qualification prioritized)]
      ,d17.opintojen_kulku_koulutusasteen_2002_mukaan_EN AS [Study progress by level of education (studies prioritized)]
      ,d18.opintojen_kulku_koulutusalan_2002_mukaan_EN AS [Study progress by field of education (qualification prioritized)]
      ,d19.opintojen_kulku_koulutusalan_2002_mukaan_EN AS [Study progress by field of education (studies prioritized)]
      ,d20.opintojen_kulku_opintoala_2002_mukaan_EN AS [Study progress by subfield of education (qualification prioritized)]
      ,d21.opintojen_kulku_opintoala_2002_mukaan_EN AS [Study progress by subfield of education (studies prioritized)]
	  ,(SELECT kylla_ei_EN FROM d_kylla_ei WHERE id = tutkinto_tavoitet_koul_järjeställä_tutkinto_priorisoitu_id) AS [Qualification in target education provider (qualification prioritized)]
	  ,(SELECT kylla_ei_EN FROM d_kylla_ei WHERE id = tutkinto_tavoitet_koul_järjeställä_opiskelu_priorisoitu_id) AS [Qualification in target education provider (studies prioritized)]
	  ,(SELECT kylla_ei_EN FROM d_kylla_ei WHERE id = opiskelee_tavoitet_koul_järjeställä_tutkinto_priorisoitu_id) AS [Contin. studies in target education provider (qualification prioritized)]
	  ,(SELECT kylla_ei_EN FROM d_kylla_ei WHERE id = opiskelee_tavoitet_koul_järjeställä_opiskelu_priorisoitu_id) AS [Contin. studies in target education provider (studies prioritized)]
	  ,(SELECT kylla_ei_EN FROM d_kylla_ei WHERE id = tutkinto_tavoitet_maakunnassa_tutkinto_priorisoitu_id) AS [Qualification in target region (qualification prioritized)]
	  ,(SELECT kylla_ei_EN FROM d_kylla_ei WHERE id = tutkinto_tavoitet_maakunnassa_opiskelu_priorisoitu_id) AS [Qualification in target region (studies prioritized)]
	  ,(SELECT kylla_ei_EN FROM d_kylla_ei WHERE id = opiskelee_tavoitet_maakunnassa_tutkinto_priorisoitu_id) AS [Contin. studies in target region (qualification prioritized)]
	  ,(SELECT kylla_ei_EN FROM d_kylla_ei WHERE id = opiskelee_tavoitet_maakunnassa_opiskelu_priorisoitu_id) AS [Contin. studies in target region (studies prioritized)]
	  ,(SELECT kylla_ei_EN FROM d_kylla_ei WHERE id = tutkinto_tavoitet_koul_asteella_tutkinto_priorisoitu_id) AS [Qualification in target level of education (qualification prioritized)]
	  ,(SELECT kylla_ei_EN FROM d_kylla_ei WHERE id = tutkinto_tavoitet_koul_asteella_opiskelu_priorisoitu_id) AS [Qualification in target level of education (studies prioritized)]
	  ,(SELECT kylla_ei_EN FROM d_kylla_ei WHERE id = opiskelee_tavoitet_koul_asteella_tutkinto_priorisoitu_id) AS [Contin. studies in target level of education (qualification prioritized)]
	  ,(SELECT kylla_ei_EN FROM d_kylla_ei WHERE id = opiskelee_tavoitet_koul_asteella_opiskelu_priorisoitu_id) AS [Contin. studies in target level of education (studies prioritized)]
	  ,(SELECT kylla_ei_EN FROM d_kylla_ei WHERE id = tutkinto_tavoitet_koul_alalla_tutkinto_priorisoitu_id) AS [Qualification in target field of education (qualification prioritized)]
	  ,(SELECT kylla_ei_EN FROM d_kylla_ei WHERE id = tutkinto_tavoitet_koul_alalla_opiskelu_priorisoitu_id) AS [Qualification in target field of education (studies prioritized)]
	  ,(SELECT kylla_ei_EN FROM d_kylla_ei WHERE id = opiskelee_tavoitet_koul_alalla_tutkinto_priorisoitu_id) AS [Contin. studies in target field of education (qualification prioritized)]
	  ,(SELECT kylla_ei_EN FROM d_kylla_ei WHERE id = opiskelee_tavoitet_koul_alalla_opiskelu_priorisoitu_id) AS [Contin. studies in target field of education (studies prioritized)]
	  ,(SELECT kylla_ei_EN FROM d_kylla_ei WHERE id = tutkinto_tavoitet_opintoalalla_tutkinto_priorisoitu_id) AS [Qualification in target subfield of education (qualification prioritized)]
	  ,(SELECT kylla_ei_EN FROM d_kylla_ei WHERE id = tutkinto_tavoitet_opintoalalla_opiskelu_priorisoitu_id) AS [Qualification in target subfield of education (studies prioritized)]
	  ,(SELECT kylla_ei_EN FROM d_kylla_ei WHERE id = opiskelee_tavoitet_opintoalalla_tutkinto_priorisoitu_id) AS [Contin. studies in target subfield of education (qualification prioritized)]
	  ,(SELECT kylla_ei_EN FROM d_kylla_ei WHERE id = opiskelee_tavoitet_opintoalalla_opiskelu_priorisoitu_id) AS [Contin. studies in target subfield of education (studies prioritized)]
      ,[lkm] AS lkm_int2
	  ,d1.jarjestys AS jarjestys_lahde
	  ,d2.jarjestys_maakunta
	  ,d2.jarjestys_suuralue
	  ,d2.jarjestys_ely
	  ,d2.jarjestys_avi
      ,d3.jarjestys_koulutuksenjarjestaja
	  ,d3.jarjestys_koulutuksen_jarjestajan_kieli
	  ,d3.jarjestys_sijaintikunta_koulutuksenjarjestaja
	  ,d3.koulutuksen_jarjestajan_omistajatyyppikoodi
      ,d4.jarjestys AS jarjestys_tutkintonimike
	  ,d4.jarjestys_opintoala2002
	  ,d4.jarjestys_koulutusala2002
	  ,d4.jarjestys_koulutusaste2002
	  ,d5.jarjestys AS jarj_ophal
	  ,d6.jarjestys_maakunta AS jarjestys_tutkinnon_maakunta
	  ,d6.jarjestys_ely AS jarjestys_tutkinnon_ely
	  ,d6.jarjestys_avi AS jarjestys_tutkinnon_avi
      ,d7.jarjestys_koulutuksen_jarjestaja AS jarjestys_tutkinnon_koul_jarjestaja
	  ,d7.koulutuksen_jarjestajan_omistajatyyppikoodi AS jarjestys_tutkinnon_omistajatyyppi
	  ,d7.jarjestys_koulutuksen_jarjestajan_kieli AS jarjestys_tutkinnon_koul_jarj_kieli
	  ,d7.jarjestys_sijaintikunta_koulutuksenjarjestaja AS jarjestys_tutkinnon_koul_jarj_sijaintikunta
      ,d8.jarjestys AS jarjestys_tutkinnon_tutkintonimike
	  ,d8.jarjestys_opintoala2002 AS jarjestys_tutkinnon_opintoala2002
	  ,d8.jarjestys_koulutusala2002 AS jarjestys_tutkinnon_koulutusala2002
	  ,d8.jarjestys_koulutusaste2002 AS jarjestys_tutkinnon_koulutusaste2002
	  ,d9.jarjestys_maakunta AS jarjestys_svuoden_maakunta
	  ,d9.jarjestys_ely AS jarjestys_svuoden_ely
	  ,d9.jarjestys_avi AS jarjestys_svuoden_avi
      ,d10.jarjestys_koulutuksen_jarjestaja AS jarjestys_svuoden_koul_jarjestaja
	  ,d10.koulutuksen_jarjestajan_omistajatyyppikoodi AS jarjestys_svuoden_omistajatyyppi
	  ,d10.jarjestys_koulutuksen_jarjestajan_kieli AS jarjestys_svuoden_koul_jarj_kieli
	  ,d10.jarjestys_sijaintikunta_koulutuksenjarjestaja AS jarjestys_svuoden_koul_jarj_sijaintikunta
      ,d11.jarjestys AS jarjestys_svuoden_tutkintonimike
	  ,d11.jarjestys_opintoala2002 AS jarjestys_svuoden_opintoala2002
	  ,d11.jarjestys_koulutusala2002 AS jarjestys_svuoden_koulutusala2002
	  ,d11.jarjestys_koulutusaste2002 AS jarjestys_svuoden_koulutusaste2002
	  ,d12.jarjestys_4a AS jarjestys_Opintojen_kulku_koul_jarj_mukaan_tutkinto_priorisoitu
	  ,d13.jarjestys_4a AS jarjestys_Opintojen_kulku_koul_jarj_mukaan_opiskelu_priorisoitu
	  ,d14.jarjestys_6a AS jarjestys_Opintojen_kulku_koul_maakunnan_mukaan_tutkinto_priorisoitu
	  ,d15.jarjestys_6a AS jarjestys_Opintojen_kulku_koul_maakunnan_mukaan_opiskelu_priorisoitu
	  ,d16.jarjestys_1a AS jarjestys_Opintojen_kulku_koul_asteen_mukaan_tutkinto_priorisoitu
	  ,d17.jarjestys_1a AS jarjestys_Opintojen_kulku_koul_asteen_mukaan_opiskelu_priorisoitu
	  ,d18.jarjestys_2a AS jarjestys_Opintojen_kulku_koul_alan_mukaan_tutkinto_priorisoitu
	  ,d19.jarjestys_2a AS jarjestys_Opintojen_kulku_koul_alan_mukaan_opiskelu_priorisoitu
	  ,d20.jarjestys_3a AS jarjestys_Opintojen_kulku_opintoalan_mukaan_tutkinto_priorisoitu
	  ,d21.jarjestys_3a AS jarjestys_Opintojen_kulku_opintoalan_mukaan_opiskelu_priorisoitu
  FROM [VipunenTK].[dbo].[f_tutkinnon_suorittaneiden_osuus_poistumasta_erityisopiskelijat] f
  INNER JOIN [VipunenTK].[dbo].[d_lahde] d1 ON d1.id = f.lahde_id
  INNER JOIN [VipunenTK].[dbo].[d_alueluokitus] d2 ON d2.id = f.alueluokitus_id
  INNER JOIN [VipunenTK].[dbo].[d_oppilaitoksen_taustatiedot] d3 ON d3.id = f.oppilaitoksen_taustatiedot_id
  INNER JOIN [VipunenTK].[dbo].[d_koulutusluokitus] d4 ON d4.id = f.koulutusluokitus_id
  INNER JOIN [VipunenTK].[dbo].[d_opetushallinnon_koulutus] d5 ON d5.id = f.ophal_kylla_ei_id
  INNER JOIN [VipunenTK].[dbo].[d_alueluokitus] d6 ON d6.id = f.tutkinnon_alueluokitus_id
  INNER JOIN [VipunenTK].[dbo].[d_oppilaitoksen_taustatiedot] d7 ON d7.id = f.tutkinnon_oppilaitoksen_taustatiedot_id
  INNER JOIN [VipunenTK].[dbo].[d_koulutusluokitus] d8 ON d8.id = f.tutkinnon_koulutusluokitus_id
  INNER JOIN [VipunenTK].[dbo].[d_alueluokitus] d9 ON d9.id = f.seurv_alueluokitus_id
  INNER JOIN [VipunenTK].[dbo].[d_oppilaitoksen_taustatiedot] d10 ON d10.id = f.seurv_oppilaitoksen_taustatiedot_id
  INNER JOIN [VipunenTK].[dbo].[d_koulutusluokitus] d11 ON d11.id = f.seurv_koulutusluokitus_id
  INNER JOIN [VipunenTK].[dbo].[d_opintojen_kulku_koulutuksen_jarjestajan_mukaan] d12 ON d12.id = f.opintojen_kulku_koul_jarj_mukaan_tutkinto_priorisoitu_id
  INNER JOIN [VipunenTK].[dbo].[d_opintojen_kulku_koulutuksen_jarjestajan_mukaan] d13 ON d13.id = f.opintojen_kulku_koul_jarj_mukaan_opiskelu_priorisoitu_id
  INNER JOIN [VipunenTK].[dbo].[d_opintojen_kulku_maakunnan_mukaan] d14 ON d14.id = f.opintojen_kulku_koul_maakunnan_mukaan_tutkinto_priorisoitu_id
  INNER JOIN [VipunenTK].[dbo].[d_opintojen_kulku_maakunnan_mukaan] d15 ON d15.id = f.opintojen_kulku_koul_maakunnan_mukaan_opiskelu_priorisoitu_id
  INNER JOIN [VipunenTK].[dbo].[d_opintojen_kulku_koulutusasteen_2002_mukaan] d16 ON d16.id = f.opintojen_kulku_koul_asteen_mukaan_tutkinto_priorisoitu_id
  INNER JOIN [VipunenTK].[dbo].[d_opintojen_kulku_koulutusasteen_2002_mukaan] d17 ON d17.id = f.opintojen_kulku_koul_asteen_mukaan_opiskelu_priorisoitu_id
  INNER JOIN [VipunenTK].[dbo].[d_opintojen_kulku_koulutusalan_2002_mukaan] d18 ON d18.id = f.opintojen_kulku_koul_alan_mukaan_tutkinto_priorisoitu_id
  INNER JOIN [VipunenTK].[dbo].[d_opintojen_kulku_koulutusalan_2002_mukaan] d19 ON d19.id = f.opintojen_kulku_koul_alan_mukaan_opiskelu_priorisoitu_id
  INNER JOIN [VipunenTK].[dbo].[d_opintojen_kulku_opintoalan_2002_mukaan] d20 ON d20.id = f.opintojen_kulku_opintoalan_mukaan_tutkinto_priorisoitu_id
  INNER JOIN [VipunenTK].[dbo].[d_opintojen_kulku_opintoalan_2002_mukaan] d21 ON d21.id = f.opintojen_kulku_opintoalan_mukaan_opiskelu_priorisoitu_id


' 
GO
/****** Object:  View [dbo].[v_f_tab_tutkintoon_johtamaton_koulutus]    Script Date: 21.6.2017 10:17:26 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_tutkintoon_johtamaton_koulutus]'))
EXEC dbo.sp_executesql @statement = N'













CREATE view [dbo].[v_f_tab_tutkintoon_johtamaton_koulutus] as

Select
	  --Aika
      Tilastovuosi = f.tilastointivuosi

	  --Henkilö
	  ,Sukupuoli = d1.sukupuoli

	  --Koulutus
	  ,Koulutustyyppi = d2.Koulutustyyppi
	  ,Koulutusala = d2.Koulutusala
	  ,Opintoala = d2.Opintoala

	  --Organisaatio
	  ,[Koulutuksen järjestäjä] = d3.koulutuksen_jarjestaja
	  ,[Oppilaitoksen omistajatyyppi] = d3.oppilaitoksen_omistajatyyppi
	  ,[Oppilaitostyyppi] = d3.oppilaitostyyppi
	  ,[Oppilaitos] = d3.oppilaitos
	  ,[Oppilaitoksen maakunta] = d4.maakunta
	  ,[Oppilaitoksen kunta] = d4.kunta
	  ,[Oppilaitoksen opetuskieli] = d3.opetuskieli
	  ,[Oppilaitoskoodi] = coalesce(d3.oppilaitoksen_korvaavakoodi,d3.oppilaitoskoodi)

	  --Mittarit
	  ,Opetustunnit2 = f.[Opetustuntien lukumäärä]
	  ,Koulutukset2 = null
	  ,Osallistuneet2 = null

	  --Ruotsi
	  ,Statistikår = f.tilastointivuosi
	  ,Kön = d1.sukupuoli_SV
	  ,[Typ av utbildning] = d2.Koulutustyyppi_SV
	  ,Utbildningsområde = d2.Koulutusala_SV
	  ,Studieområde = d2.Opintoala_SV
	  ,Utbildningsanordnare = d3.koulutuksen_jarjestaja_SV
	  ,[Läroanstaltens ägartyp] = d3.oppilaitoksen_omistajatyyppi_SV
	  ,[Läroanstaltstyp] = d3.oppilaitostyyppi_SV
	  ,[Läroanstalt] = d3.oppilaitos_SV
	  ,[Läroanstaltens landskap] = d4.maakunta_SV
	  ,[Läroanstaltens kommun] = d4.kunta_SV
	  ,[Läroanstaltens undervisningsspråk] = d3.opetuskieli_SV

	  --Englanti
	  ,[Statistical year] = f.tilastointivuosi
	  ,Gender = d1.sukupuoli_EN
	  ,[Type of education] = d2.Koulutustyyppi_EN
	  ,[Field of education] = d2.Koulutusala_EN
	  ,[Subfield of education] = d2.Opintoala_EN
	  ,[Education provider] = d3.koulutuksen_jarjestaja_EN
	  ,[Type of institution owner] = d3.oppilaitoksen_omistajatyyppi_EN
	  ,[Type of institution] = d3.oppilaitostyyppi_EN
	  ,[Educational institution] = d3.oppilaitos_EN
	  ,[Region of the institution ] = d4.maakunta_EN
	  ,[Municipality of the institution] = d4.kunta_EN
	  ,[Language of the institution ] = d3.opetuskieli_EN

	  --Koodit
	  ,[Koodit Oppilaitoksen maakunta] = d4.maakunta_koodi
	  ,[Koodit Oppilaitoksen kunta] = d4.kunta_koodi
	  ,[Koodit Oppilaitos] = coalesce(d3.oppilaitoksen_korvaavakoodi,d3.oppilaitoskoodi)
	  ,[Koodit Koulutuksen järjestäjä] = d3.koulutuksen_jarjestajakoodi
	  --,[Koodit Koulutusala]
	  --,[Koodit Opintoala]

	  --Järjestys
	  ,[Sukupuoli jarj] = d1.jarjestys
	  ,[Koulutustyyppi jarj] = d2.Koulutustyyppi_lajittelu
	  ,[Koulutusala jarj] = d2.Koulutusala_lajittelu
	  ,[Opintoala jarj] = d2.Opintoala_lajittelu
	  ,[Omistajatyyppi jarj] = d3.jarjestys_omistajatyyppi
	  ,[Oppilaitostyyppi jarj] = d3.jarjestys_oppilaitostyyppi
	  ,[Maakunta jarj] = d4.jarjestys_maakunta
	  ,[Opetuskieli jarj] = d3.jarjestys_opetuskieli
	  

FROM [dbo].[f_TJK_2_11_tutkintoon_johtamaton_koulutus] f
left join VipunenTK.dbo.d_sukupuoli d1 on d1.id=f.sukupuoli_id
left join VipunenTK.dbo.d_opetustuntien_sisalto_ja_tavoiteluokitus d2 on d2.id=f.opetustunti_id
left join VipunenTK.dbo.d_oppilaitoksen_taustatiedot d3 on d3.id=f.oppilaitos_id
left join VipunenTK.dbo.d_alueluokitus d4 on d4.id=f.oppilaitoksen_sijaintikunta_id
where d2.Koulutusala!=''Muut mittarit''

UNION ALL

Select
	  --Aika
      Tilastovuosi = f.tilastointivuosi

	  --Henkilö
	  ,Sukupuoli = d1.sukupuoli

	  --Koulutus
	  ,Koulutustyyppi = d2.Koulutustyyppi
	  ,Koulutusala = d2.Koulutusala
	  ,Opintoala = d2.Opintoala

	  --Organisaatio
	  ,[Koulutuksen järjestäjä] = d3.koulutuksen_jarjestaja
	  ,[Oppilaitoksen omistajatyyppi] = d3.oppilaitoksen_omistajatyyppi
	  ,[Oppilaitostyyppi] = d3.oppilaitostyyppi
	  ,[Oppilaitos] = d3.oppilaitos
	  ,[Oppilaitoksen maakunta] = d4.maakunta
	  ,[Oppilaitoksen kunta] = d4.kunta
	  ,[Oppilaitoksen opetuskieli] = d3.opetuskieli
	  ,[Oppilaitoskoodi] = coalesce(d3.oppilaitoksen_korvaavakoodi,d3.oppilaitoskoodi)

	  --Mittarit
	  ,Opetustunnit2 = null
	  ,Koulutukset2 = f.[Koulutusten lukumäärä]
	  ,Osallistuneet2 = f.[Osallistuneiden lukumäärä]

	  --Ruotsi
	  ,Statistikår = f.tilastointivuosi
	  ,Kön = d1.sukupuoli_SV
	  ,[Typ av utbildning] = d2.Koulutustyyppi_SV
	  ,Utbildningsområde = d2.Koulutusala_SV
	  ,Studieområde = d2.Opintoala_SV
	  ,Utbildningsanordnare = d3.koulutuksen_jarjestaja_SV
	  ,[Läroanstaltens ägartyp] = d3.oppilaitoksen_omistajatyyppi_SV
	  ,[Läroanstaltstyp] = d3.oppilaitostyyppi_SV
	  ,[Läroanstalt] = d3.oppilaitos_SV
	  ,[Läroanstaltens landskap] = d4.maakunta_SV
	  ,[Läroanstaltens kommun] = d4.kunta_SV
	  ,[Läroanstaltens undervisningsspråk] = d3.opetuskieli_SV

	  --Englanti
	  ,[Statistical year] = f.tilastointivuosi
	  ,Gender = d1.sukupuoli_EN
	  ,[Type of education] = d2.Koulutustyyppi_EN
	  ,[Field of education] = d2.Koulutusala_EN
	  ,[Subfield of education] = d2.Opintoala_EN
	  ,[Education provider] = d3.koulutuksen_jarjestaja_EN
	  ,[Type of institution owner] = d3.oppilaitoksen_omistajatyyppi_EN
	  ,[Type of institution] = d3.oppilaitostyyppi_EN
	  ,[Educational institution] = d3.oppilaitos_EN
	  ,[Region of the institution ] = d4.maakunta_EN
	  ,[Municipality of the institution] = d4.kunta_EN
	  ,[Language of the institution ] = d3.opetuskieli_EN

	  --Koodit
	  ,[Koodit Oppilaitoksen maakunta] = d4.maakunta_koodi
	  ,[Koodit Oppilaitoksen kunta] = d4.kunta_koodi
	  ,[Koodit Oppilaitos] = coalesce(d3.oppilaitoksen_korvaavakoodi,d3.oppilaitoskoodi)
	  ,[Koodit Koulutuksen järjestäjä] = d3.koulutuksen_jarjestajakoodi
	  --,[Koodit Koulutusala]
	  --,[Koodit Opintoala]

	  --Järjestys
	  ,[Sukupuoli jarj] = d1.jarjestys
	  ,[Koulutustyyppi jarj] = d2.Koulutustyyppi_lajittelu
	  ,[Koulutusala jarj] = d2.Koulutusala_lajittelu
	  ,[Opintoala jarj] = d2.Opintoala_lajittelu
	  ,[Omistajatyyppi jarj] = d3.jarjestys_omistajatyyppi
	  ,[Oppilaitostyyppi jarj] = d3.jarjestys_oppilaitostyyppi
	  ,[Maakunta jarj] = d4.jarjestys_maakunta
	  ,[Opetuskieli jarj] = d3.jarjestys_opetuskieli
	  

FROM [dbo].[f_TJK_2_11_tutkintoon_johtamaton_koulutus] f
left join VipunenTK.dbo.d_sukupuoli d1 on d1.id=f.sukupuoli_id
left join VipunenTK.dbo.d_opetustuntien_sisalto_ja_tavoiteluokitus d2 on d2.id=f.opetustunti_id
left join VipunenTK.dbo.d_oppilaitoksen_taustatiedot d3 on d3.id=f.oppilaitos_id
left join VipunenTK.dbo.d_alueluokitus d4 on d4.id=f.oppilaitoksen_sijaintikunta_id
where d2.Opintoala=''Oppilaitosten tutkintoon johtamaton koulutus koulutustyypeittäin''






























' 
GO
/****** Object:  View [dbo].[v_f_tab_tyollisten_ammattisiirtymat]    Script Date: 21.6.2017 10:17:26 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_tyollisten_ammattisiirtymat]'))
EXEC dbo.sp_executesql @statement = N'

CREATE VIEW [dbo].[v_f_tab_tyollisten_ammattisiirtymat] AS

SELECT 
	  Tilastovuosi = f.tilastovuosi
      ,Sukupuoli = d1.sukupuoli
      ,Äidinkieli = d2.aidinkieli_versio1
      ,Ikäryhmä = d3.ika5v
      ,[Työpaikan sijaintimaakunta] = d4.maakunta
     -- ,[tyopaikan_sijaintimaakunta_historia_id]
     -- ,[Ammatti] = d5.mitenna_ammatti
	  ,[Ammattiryhmä 1.taso] = d5.mitenna_ammattiryhma1
	  ,[Ammattiryhmä 2.taso] = d5.mitenna_ammattiryhma2
      ,[Pääasiallinen toiminta siirtymän päässä] = d6.paaasiallinen_toiminta
      ,[Työpaikan sijainti siirtymän päässä] = d7.tyopaikan_sijainti_v_tilastovuonna
     -- ,[Ammatti siirtymän päässä] = d8.mitenna_ammatti
	  ,[Ammattiryhmä (1.taso) siirtymän päässä] = d8.mitenna_ammattiryhma1
	  ,[Ammattiryhmä (2.taso) siirtymän päässä] = d8.mitenna_ammattiryhma2
      ,[lkm]
      ,[Suhteellinen ajankohta] = d9.suhteellinen_ajankohta
      ,[Perusjoukko] = d10.perusjoukko_tyolliset
      ,[Siirtymän tarkastelusuunta] = case d11.siirtyman_tarkastelusuunta 
										when ''Siirtymän tarkastelusuunta ajassa eteenpäin'' then ''Ajassa eteenpäin''
										when ''Siirtymän tarkastelusuunta ajassa taaksepäin'' then ''Ajassa taaksepäin''
										else ''Tuntematon''
									  end
	  ,[Ammattiryhmä 1. taso sama kuin tilastovuonna] = case when d5.mitenna_ammattiryhma1=d8.mitenna_ammattiryhma1 then ''Ammattiryhmä 1. taso sama kuin tilastovuonna'' else ''Ammattiryhmä 1. taso eri kuin tilastovuonna'' end
	  ,[Ammattiryhmä 2. taso sama kuin tilastovuonna] = case when d5.mitenna_ammattiryhma2=d8.mitenna_ammattiryhma2 then ''Ammattiryhmä 2. taso sama kuin tilastovuonna'' else ''Ammattiryhmä 2. taso eri kuin tilastovuonna'' end

	  --järjestyskentät
	  ,[Sukupuoli järjestys] = d1.jarjestys
	  ,[Äidinkieli järjestys] = d2.jarjestys
	  ,[Ikä järjestys] = d3.jarjestys_ika5v
	  ,[Maakunta järjestys] = d4.jarjestys_maakunta
	  ,[Ammattiryhmä1 järjestys] = d5.jarjestys_ammattiryhma1
	  ,[Ammattiryhmä2 järjestys] = d5.jarjestys_ammattiryhma2
	  ,[Pääasiallinen toiminta järjestys] = d6.jarjestys
	  ,[Työpaikan sijainti järjestys] = d7.jarjestys
	  ,[Ammattiryhmä1 siirtymä järjestys] = d8.jarjestys_ammattiryhma1
	  ,[Ammattiryhmä2 siirtymä järjestys] = d8.jarjestys_ammattiryhma2
	  ,[Ajankohta järjestys] = d9.jarjestys
	  ,[Perusjoukko järjestys] = d10.jarjestys
	  ,[Siirtymä järjestys] = d11.jarjestys
	  ,[Ammattiryhmä 1. taso sama kuin tilastovuonna järjestys] = case when d5.mitenna_ammattiryhma1=d8.mitenna_ammattiryhma1 then 1 else 2 end
	  ,[Ammattiryhmä 2. taso sama kuin tilastovuonna järjestys] = case when d5.mitenna_ammattiryhma2=d8.mitenna_ammattiryhma2 then 1 else 2 end


  FROM [VipunenTK].[dbo].[f_tyollisten_ammattisiirtymat_ja_aiemmat_ammatit] f

  LEFT JOIN dbo.d_sukupuoli d1 on d1.id=f.sukupuoli_id
  LEFT JOIN dbo.d_aidinkieli_versio1 d2 on d2.id=f.aidinkieli_versio1_id
  LEFT JOIN dbo.d_ika d3 on d3.id=f.ika_id	
  LEFT JOIN dbo.d_alueluokitus d4 on d4.id=f.tyopaikan_sijaintimaakunta_id
  LEFT JOIN dbo.d_mitenna_ammatti d5 on d5.id=f.mitenna_ammatti_id
  LEFT JOIN dbo.d_paaasiallinen_toiminta d6 on d6.id=f.paaasiallinen_toiminta_siirtyman_paassa_id
  LEFT JOIN dbo.d_tyopaikan_sijainti_v_tilastovuonna d7 on d7.id=f.tyopaikan_sijainti_v_tilastovuonna_id
  LEFT JOIN dbo.d_mitenna_ammatti d8 on d8.id=f.mitenna_ammatti_siirtyman_paassa_id
  LEFT JOIN dbo.d_suhteellinen_ajankohta d9 on d9.id=f.suhteellinen_ajankohta_id
  LEFT JOIN dbo.d_perusjoukko_tyolliset d10 on d10.id=f.perusjoukko_tyolliset_id
  LEFT JOIN dbo.d_siirtyman_tarkastelusuunta d11 on d11.id=f.siirtyman_tarkastelusuunta_id

' 
GO
/****** Object:  View [dbo].[v_f_tab_tyollistyminen_amk]    Script Date: 21.6.2017 10:17:26 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_tyollistyminen_amk]'))
EXEC dbo.sp_executesql @statement = N'

















CREATE view [dbo].[v_f_tab_tyollistyminen_amk] as
Select [lkm_1vr2] = sijoittuminen_1v_tutkinnon_jalkeen
,[lkm_3vr2] = sijoittuminen_3v_tutkinnon_jalkeen
,[lkm_5vr2] = sijoittuminen_5v_tutkinnon_jalkeen
,[Tilastointivuosi] as Tilastovuosi
,d1.koulutusala2002 as "Koulutusala"
,d1.jarjestys_koulutusala2002
,d1.opintoala2002 as "Opintoala"
,d1.jarjestys_opintoala2002
,d1.koulutus as "Koulutusnimike"
,d1.koulutusaste2002 as "Koulutusaste"
,d1.jarjestys_koulutusaste2002
,d2.paaasiallinen_toiminta_ja_maasta_muuttaneet as "Pääasiallinen toiminta"
,d2.jarjestys as "p_toim_jarj"
,d2.paaasiallinen_toiminta_ja_maasta_muuttaneet_koodi as "paaskoodi"
,d3.tutkintolaji_tyollistymiseen as "Tutkintolaji"
,d3.tutkintolaji_tyollistymiseen_koodi as "tutklajikoodi"
,d4.ammattiluokitus_2010 as "Ammatti"
,d5.ammattiasema as "Ammattiasema"
,d5.jarjestys as "amas_jarj"
,d6.maassaolo as "Maassaolo"
--placeholder
/*
,Case when d6.maassaolo_koodi=''1'' Or d6.maassaolo_koodi=''2''
			then ''Tuntematon''
			else ''Tuntematon'' end AS "Kansalaisuus"
,Case when d6.maassaolo_koodi=''1'' Or d6.maassaolo_koodi=''2''
			then ''Information saknas''
			else ''Information saknas'' end AS "Medborgarskap"
,Case when d6.maassaolo_koodi=''1'' Or d6.maassaolo_koodi=''2''
			then ''Missing data''
			else ''Missing data'' end AS "Nationality"
,Case when d6.maassaolo_koodi=''1'' Or d6.maassaolo_koodi=''2''
			then ''-1''
			else ''-1'' end AS jarj_kansalaisuus
			*/
--
,d8.aikuisopiskelija as "Nuori/aikuisopiskelija"
,d8.jarjestys as "aik_jarj"
,d9.oppilaitos as "Ammattikorkeakoulu"
,d9.oppilaitostyyppi as "Oppilaitostyyppi"
,d9.jarjestys_oppilaitostyyppi
,d9.opetuskieli as "Opetuskieli"
,d9.jarjestys_opetuskieli
,d9.oppilaitoksen_omistajatyyppi as "Oppilaitoksen omistajatyyppi"
,d9.jarjestys_omistajatyyppi
,d11.avi as "Tutk. suorituspaikan AVI"
,d11.jarjestys_avi as "suorjavi"
,d11.ely as "Tutk. suorituspaikan ELY"
,d11.jarjestys_ely as "suorjely"
,d11.maakunta as "Tutk. suoritusmaakunta"
,d11.jarjestys_maakunta as "suorjmaak"
,d11.maakunta_koodi as "suormaakkoodi"
,d12.avi as "Asuinalueen AVI"
,d12.jarjestys_avi as "ajavi"
,d12.ely as "Asuinalueen ELY"
,d12.jarjestys_ely as "ajely"
,d12.maakunta as "Asuinmaakunta"
,d12.jarjestys_maakunta as "ajmaak"
,d12.maakunta_koodi as "asmaakkoodi"
,d13.valiaikainen_amk as "Väliaikainen amk"
,d13.jarjestys as "amkvaljarj"
,d25.paaasiallinen_toiminta_okm as "Pääasiallinen toiminta I"
,d25.jarjestys as paastoim2jarj

/* Uudet kentät 3.5.2016 -LR */
,d30.eu_etamaat as ''Kansalaisuus''
,d30.jarjestys as jarj_kansalaisuus
,d31.aidinkieli_versio1 as ''Äidinkieli''
,d31.jarjestys as jarj_aidinkieli
,d32.maanosa as ''Kansalaisuus (maanosa)''
,d32.jarjestys_maanosa as jarj_kans_maanosa
,d4.ammattiluokitus_2010_paataso as ''Ammattiluokitus taso 1''
,d4.ammattiluokitus_2010_2_taso as ''Ammattiluokitus taso 2''
,d4.[jarjestys_ammattiluokitus_2010_paataso] as ''jarj_ammattiluokitustaso1''
,d4.[jarjestys_ammattiluokitus_2010_taso2] as ''jarj_ammattiluokitustaso2''


--englanti
,[Tilastointivuosi] as "Statistical year"
,d1.koulutusala2002_EN as "Field of education (2002)"
,d1.opintoala2002_EN as "Subfield of ed. (2002)"
,d1.koulutus_EN as "Name of education"
,d1.koulutusaste2002_EN as "Level of education (2002)"
,d2.paaasiallinen_toiminta_ja_maasta_muuttaneet_EN as "Main type of activity II"
,d3.tutkintolaji_tyollistymiseen_EN as "Form of degree"
,d4.ammattiluokitus_2010_2_taso_EN as "Profession"
,d5.ammattiasema_EN as "Status in employment"
,d6.maassaolo_EN as "Residency in Finland"
,d8.aikuisopiskelija_EN as "Youth/adult student"
,d9.oppilaitos_EN as "University of applied sciences"
,d9.oppilaitostyyppi_EN as "Type of ed. institution"
,d9.opetuskieli_EN as "Language of the ed. institution"
,d9.oppilaitoksen_omistajatyyppi_EN as "Type of ed. institution owner"
,d11.avi_EN as "AVI area of degree"
,d11.ely_EN as "ELY area of degree"
,d11.maakunta_EN as "Region of degree"
,d12.avi_EN as "AVI area of residence"
,d12.ely_EN as "ELY area of residence"
,d12.maakunta_EN as "Region of residence"
,d25.paaasiallinen_toiminta_okm_EN as "Main type of activity I"


/* Uudet kentät 3.5.2016 -LR */
,d30.eu_etamaat_EN as ''Nationality''
,d31.aidinkieli_versio1_EN as ''Mother tongue''
,d32.maanosa_EN as ''Nationality (continent)''
,d4.ammattiluokitus_2010_paataso_EN as ''Profession group 1''
,d4.ammattiluokitus_2010_2_taso_EN as ''Profession group 2''


--ruotsi
,[Tilastointivuosi] as Statistikår
,d1.koulutusala2002_SV as "Utbildningsområde (2002)"
,d1.opintoala2002_SV as "Studieområde (2002)"
,d1.koulutus_SV as "Utbildningsbenämning"
,d1.koulutusaste2002_SV as "Utbildningsnivå (2002)"
,d2.paaasiallinen_toiminta_ja_maasta_muuttaneet_SV as "Huvudsaklig verksamhet II"
,d3.tutkintolaji_tyollistymiseen_SV as "Examensslag"
,d4.ammattiluokitus_2010_2_taso_SV as "Yrke"
,d5.ammattiasema_SV as "Yrkesställning"
,d6.maassaolo_SV as "Bosatt i Finland"
,d8.aikuisopiskelija_SV as "Ungdoms-/vuxenstuderande"
,d9.oppilaitos_SV as "Yrkehögskola"
,d9.oppilaitostyyppi_SV as "Läroanstaltstyp"
,d9.opetuskieli_SV as "Läroanstaltens undervis.språk"
,d9.oppilaitoksen_omistajatyyppi_SV as "Läroanstaltens ägartyp"
,d11.avi_SV as "RFV-område där examen avlagts"
,d11.ely_SV as "NMT-område där examen avlagts"
,d11.maakunta_SV as "Landskap där examen avlagts"
,d12.avi_SV as "Bostadsortens RFV-område"
,d12.ely_SV as "Bostadsortens NTM-område"
,d12.maakunta_SV as "Bostadslandskap"
,d25.paaasiallinen_toiminta_okm_SV as "Huvudsaklig verksamhet I"

/* Uudet kentät 3.5.2016 -LR */
,d30.eu_etamaat_SV as ''Medborgarskap''
,d31.aidinkieli_versio1_SV as ''Modersmål''
,d32.maanosa_SV as ''Medborgarskap (världsdel)''
,d4.ammattiluokitus_2010_paataso_SV as ''Yrkesgrupp 1''
,d4.ammattiluokitus_2010_2_taso_SV as ''Yrkesgrupp 2''


--koodimuuttujat
,d1.koulutusala2002_koodi as "Koodit Koulutusala 2002"
,d1.opintoala2002_koodi as "Koodit Opintoala 2002"
,d1.koulutus_koodi as "Koodit Koulutusnimike"
,d1.koulutusaste2002_koodi as "Koodit Koulutusaste 2002"
,d3.tutkintolaji_tyollistymiseen_koodi as "Koodit Tutkintolaji"
,coalesce(d9.oppilaitoksen_korvaavakoodi,d9.oppilaitoskoodi) as "Koodit Oppilaitos"
,d11.maakunta_koodi as "Koodit Tutk. suor.maakunta"
,d12.maakunta_koodi as "Koodit Asuinmaakunta"
,d1.iscle2011_koodi as "Koodit Koulutusaste, taso 1"
,d1.Koulutusaste_taso2_koodi as "Koodit Koulutusaste, taso 2"
,d1.iscfibroad2013_koodi as "Koodit Koulutusala, taso 1"
,d1.iscfinarrow2013_koodi as "Koodit Koulutusala, taso 2"
,d1.iscfi2013_koodi as "Koodit Koulutusala, taso 3"
,d1.OKM_ohjauksen_ala_koodi as "Koodit OKM ohjauksen ala, korkeak."

/* Uudet kentät 3.5.2016 -LR */
,d31.aidinkieli_versio1_koodi as ''Koodit Äidinkieli''
,d4.ammattiluokitus_2010_paataso_koodi as [Koodit Ammattiluokitus taso 1]
,d4.ammattiluokitus_2010_2_taso_koodi as [Koodit Ammattiluokitus taso 2]


--isced
,d1.iscle2011 as "Koulutusaste, taso 1"
,d1.Koulutusaste_taso2 as "Koulutusaste, taso 2"
,d1.iscfibroad2013 as "Koulutusala, taso 1"
,d1.iscfinarrow2013 as "Koulutusala, taso 2"
,d1.iscfi2013 as "Koulutusala, taso 3"
,d1.OKM_ohjauksen_ala as "OKM ohjauksen ala, korkeak."
,d1.iscle2011_SV as "Utbildn.nivå, nivå 1"
,d1.Koulutusaste_taso2_SV as "Utbildn.nivå, nivå 2"
,d1.iscfibroad2013_SV as "Utbildn.område, nivå 1"
,d1.iscfinarrow2013_SV as "Utbildn.område, nivå 2"
,d1.iscfi2013_SV as "Utbildn.område, nivå 3"
,d1.OKM_ohjauksen_ala_SV as "UKM-styrningsområde, högskolor"
,d1.iscle2011_EN as "Level of education, tier 1"
,d1.Koulutusaste_taso2_EN as "Level of education, tier 2"
,d1.iscfibroad2013_EN as "Field of education, tier 1"
,d1.iscfinarrow2013_EN as "Field of education, tier 2"
,d1.iscfi2013_EN as "Field of education, tier 3"
,d1.OKM_ohjauksen_ala_EN as "Field of ed., HE steering"
,d1.jarjestys_iscle2011 as jarj_isced_koulast1
,d1.jarjestys_Koulutusaste_taso2 as jarj_isced_koulast2
,d1.jarjestys_iscfibroad2013 as jarj_isced_koulala1
,d1.jarjestys_iscfinarrow2013 as jarj_isced_koulala2
,d1.jarjestys_iscfi2013 as jarj_isced_koulala3
,d1.jarjestys_OKM_ohjauksen_ala as jarj_isced_okmohjaus1
FROM dbo.f_TJ_4_3_Tutkinnon_suorittaneiden_paaasiallinen_toiminta f
	  JOIN d_koulutusluokitus d1 on d1.id = koulutusluokitus_id
	  JOIN d_paaasiallinen_toiminta_ja_maasta_muuttaneet d2 on d2.id = paaasiallinen_toiminta_ja_maasta_muuttaneet_id
	  JOIN d_tutkintolaji_tyollistymiseen d3 on d3.id = tutkintolaji_tyollistymiseen_id
	  JOIN d_ammattiluokitus_2010 d4 on d4.id = ammattiluokitus_2010_id
	  JOIN d_ammattiasema d5 on d5.id = ammattiasema_id
	  JOIN d_maassaolo d6 on d6.id = maassaolo_id
	  JOIN d_aikuisopiskelija d8 on d8.id = aikuisopiskelija_id
	  JOIN d_oppilaitoksen_taustatiedot d9 on d9.id = oppilaitos_id
	  JOIN d_alueluokitus d11 on d11.id = tutkinnon_suorittamismaakunta_id
	  JOIN d_alueluokitus d12 on d12.id = asuinmaakunta_id
	  JOIN d_valiaikainen_amk d13 on d13.id = valiaikainen_amk_id
	  JOIN d_paaasiallinen_toiminta_okm d25 on d25.id = paaasiallinen_toiminta_okm_id

/* uudet dimensiot 3.5.2015 - LR */

	  JOIN d_eu_etamaat d30 ON d30.id = f.eu_etamaat_id
	  JOIN d_aidinkieli_versio1 d31 ON d31.id = f.aidinkieli_versio1_id
	  JOIN d_valtio d32 ON d32.id = f.kansalaisuus_maanosa_id

WHERE d9.oppilaitoskoodi <> 02557 AND d9.oppilaitoskoodi <> 10031 AND (d1.koulutusaste2002_koodi = 62 OR d1.koulutusaste2002_koodi = 71) AND NOT (sijoittuminen_1v_tutkinnon_jalkeen = 0 AND sijoittuminen_3v_tutkinnon_jalkeen = 0 AND sijoittuminen_5v_tutkinnon_jalkeen = 0)













' 
GO
/****** Object:  View [dbo].[v_f_tab_tyollistyminen_amm]    Script Date: 21.6.2017 10:17:26 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_tyollistyminen_amm]'))
EXEC dbo.sp_executesql @statement = N'













CREATE view [dbo].[v_f_tab_tyollistyminen_amm] as
Select [lkm_1vr2] = sijoittuminen_1v_tutkinnon_jalkeen
,[lkm_3vr2] = sijoittuminen_3v_tutkinnon_jalkeen
,[lkm_5vr2] = sijoittuminen_5v_tutkinnon_jalkeen
,[Tilastointivuosi] as Tilastovuosi
,d1.koulutusala2002 as "Koulutusala"
,d1.jarjestys_koulutusala2002
,d1.opintoala2002 as "Opintoala"
,d1.jarjestys_opintoala2002
,d1.koulutus as "Koulutusnimike"
,d1.koulutusaste2002 as "Koulutusaste"
,d1.jarjestys_koulutusaste2002
,d2.paaasiallinen_toiminta_ja_maasta_muuttaneet as "Pääasiallinen toiminta"
,d2.jarjestys as "p_toim_jarj"
,d2.paaasiallinen_toiminta_ja_maasta_muuttaneet_koodi as "paaskoodi"
,d3.tutkintolaji_tyollistymiseen as "Tutkintotyyppi"
,d3.jarjestys as "tutklaj_jarj"
,d3.tutkintolaji_tyollistymiseen_koodi as "tutklajikoodi"
,d4.ammattiluokitus_2010 as "Ammatti"
,d5.ammattiasema as "Ammattiasema"
,d5.jarjestys as "amas_jarj"
,d6.maassaolo as "Maassaolo"
--placeholder
/*
,Case when d6.maassaolo_koodi=''1'' Or d6.maassaolo_koodi=''2''
			then ''Tuntematon''
			else ''Tuntematon'' end AS "Kansalaisuus"
,Case when d6.maassaolo_koodi=''1'' Or d6.maassaolo_koodi=''2''
			then ''Information saknas''
			else ''Information saknas'' end AS "Medborgarskap"
,Case when d6.maassaolo_koodi=''1'' Or d6.maassaolo_koodi=''2''
			then ''Missing data''
			else ''Missing data'' end AS "Nationality"
,Case when d6.maassaolo_koodi=''1'' Or d6.maassaolo_koodi=''2''
			then ''-1''
			else ''-1'' end AS jarj_kansalaisuus
			*/
--
,d7.oppisopimuskoulutus as "Oppisopimuskoulutus"
,d7.jarjestys as "opsop_jarj"
,d8.aikuisopiskelija as "Nuori/aikuisopiskelija"
,d8.jarjestys as "aik_jarj"
,d9.oppilaitos as "Oppilaitos"
,d9.oppilaitostyyppi as "Oppilaitostyyppi"
,d9.jarjestys_oppilaitostyyppi
,d9.opetuskieli as "Opetuskieli"
,d9.jarjestys_opetuskieli
,d9.oppilaitoksen_omistajatyyppi as "Oppilaitoksen omistajatyyppi"
,d9.jarjestys_omistajatyyppi
,d10.koulutuksen_jarjestaja as "Koulutuksen järjestäjä"
,d10.koulutuksen_jarjestajan_kieli as "Koul. järjestäjän kieli"
,d10.jarjestys_koulutuksen_jarjestajan_kieli
,d11.avi as "Tutk. suorituspaikan AVI"
,d11.jarjestys_avi as "suorjavi"
,d11.ely as "Tutk. suorituspaikan ELY"
,d11.jarjestys_ely as "suorjely"
,d11.maakunta as "Tutk. suoritusmaakunta"
,d11.jarjestys_maakunta as "suorjmaak"
,d11.maakunta_koodi as "suormaakkoodi"
,d12.avi as "Asuinalueen AVI"
,d12.jarjestys_avi as "ajavi"
,d12.ely as "Asuinalueen ELY"
,d12.jarjestys_ely as "ajely"
,d12.maakunta as "Asuinmaakunta"
,d12.jarjestys_maakunta as "ajmaak"
,d12.maakunta_koodi as "asmaakkoodi"
,d21.koulutusmuoto as "Koulutusmuoto"
,d21.jarjestys as "koulmuotojarj"
,d22.ammatillisen_koulutuksen_koulutuslaji_tutkintorekisterissa as "Amm. koul. koulutuslaji"
,d22.jarjestys as "amkouljarj"
,d25.paaasiallinen_toiminta_okm as "Pääasiallinen toiminta I"
,d25.jarjestys as paastoim2jarj

/* Uudet kentät 3.5.2016 -LR */
,d30.eu_etamaat as ''Kansalaisuus''
,d30.jarjestys as jarj_kansalaisuus
,d31.aidinkieli_versio1 as ''Äidinkieli''
,d31.jarjestys as jarj_aidinkieli
,d32.maanosa as ''Kansalaisuus (maanosa)''
,d32.jarjestys_maanosa as jarj_kans_maanosa
,d4.ammattiluokitus_2010_paataso as ''Ammattiluokitus taso 1''
,d4.ammattiluokitus_2010_2_taso as ''Ammattiluokitus taso 2''
,d4.[jarjestys_ammattiluokitus_2010_paataso] as ''jarj_ammattiluokitustaso1''
,d4.[jarjestys_ammattiluokitus_2010_taso2] as ''jarj_ammattiluokitustaso2''



--englanti
,[Tilastointivuosi] as "Statistical year"
,d1.koulutusala2002_EN as "Field of education (2002)"
,d1.opintoala2002_EN as "Subfield of ed. (2002)"
,d1.koulutus_EN as "Name of education"
,d1.koulutusaste2002_EN as "Level of education (2002)"
,d2.paaasiallinen_toiminta_ja_maasta_muuttaneet_EN as "Main type of activity II"
,d3.tutkintolaji_tyollistymiseen_EN as "Qualification type"
,d4.ammattiluokitus_2010_2_taso_EN as "Profession"
,d5.ammattiasema_EN as "Status in employment"
,d6.maassaolo_EN as "Residency in Finland"
,d7.oppisopimuskoulutus_EN as "Apprenticeship training"
,d8.aikuisopiskelija_EN as "Youth/adult student"
,d9.oppilaitos_EN as "Educational institution"
,d9.oppilaitostyyppi_EN as "Type of ed. institution"
,d9.opetuskieli_EN as "Language of the ed. institution"
,d9.oppilaitoksen_omistajatyyppi_EN as "Type of ed. institution owner"
,d10.koulutuksen_jarjestaja_EN as "Education provider"
,d10.koulutuksen_jarjestajan_kieli_EN as "Language of the ed. provider"
,d11.avi_EN as "AVI area of qualification"
,d11.ely_EN as "ELY area of quafification"
,d11.maakunta_EN as "Region of qualification"
,d12.avi_EN as "AVI area of residence"
,d12.ely_EN as "ELY area of residence"
,d12.maakunta_EN as "Region of residence"
,d25.paaasiallinen_toiminta_okm_EN as "Main type of activity I"

/* Uudet kentät 3.5.2016 -LR */
,d30.eu_etamaat_EN as ''Nationality''
,d31.aidinkieli_versio1_EN as ''Mother tongue''
,d32.maanosa_EN as ''Nationality (continent)''
,d4.ammattiluokitus_2010_paataso_EN as ''Profession group 1''
,d4.ammattiluokitus_2010_2_taso_EN as ''Profession group 2''


--ruotsi
,[Tilastointivuosi] as Statistikår
,d1.koulutusala2002_SV as "Utbildningsområde (2002)"
,d1.opintoala2002_SV as "Studieområde (2002)"
,d1.koulutus_SV as "Utbildningsbenämning"
,d1.koulutusaste2002_SV as "Utbildningsnivå (2002)"
,d2.paaasiallinen_toiminta_ja_maasta_muuttaneet_SV as "Huvudsaklig verksamhet II"
,d3.tutkintolaji_tyollistymiseen_SV as "Typ av examen"
,d4.ammattiluokitus_2010_2_taso_SV as "Yrke"
,d5.ammattiasema_SV as "Yrkesställning"
,d6.maassaolo_SV as "Bosatt i Finland"
,d7.oppisopimuskoulutus_SV as "Läroavtalsutbildning"
,d8.aikuisopiskelija_SV as "Ungdoms-/vuxenstuderande"
,d9.oppilaitos_SV as "Läroanstalt"
,d9.oppilaitostyyppi_SV as "Läroanstaltstyp"
,d9.opetuskieli_SV as "Läroanstaltens undervis.språk"
,d9.oppilaitoksen_omistajatyyppi_SV as "Läroanstaltens ägartyp"
,d10.koulutuksen_jarjestaja_SV as "Utbildningsanordnare"
,d10.koulutuksen_jarjestajan_kieli_SV as "Utbildningsanordnarens språk"
,d11.avi_SV as "RFV-område där examen avlagts"
,d11.ely_SV as "NMT-område där examen avlagts"
,d11.maakunta_SV as "Landskap där examen avlagts"
,d12.avi_SV as "Bostadsortens RFV-område"
,d12.ely_SV as "Bostadsortens NTM-område"
,d12.maakunta_SV as "Bostadslandskap"
,d25.paaasiallinen_toiminta_okm_SV as "Huvudsaklig verksamhet I"


/* Uudet kentät 3.5.2016 -LR */
,d30.eu_etamaat_SV as ''Medborgarskap''
,d31.aidinkieli_versio1_SV as ''Modersmål''
,d32.maanosa_SV as ''Medborgarskap (världsdel)''
,d4.ammattiluokitus_2010_paataso_SV as ''Yrkesgrupp 1''
,d4.ammattiluokitus_2010_2_taso_SV as ''Yrkesgrupp 2''


--koodimuuttujat
,d1.koulutusala2002_koodi as "Koodit Koulutusala 2002"
,d1.opintoala2002_koodi as "Koodit Opintoala 2002"
,d1.koulutus_koodi as "Koodit Koulutusnimike"
,d1.koulutusaste2002_koodi as "Koodit Koulutusaste 2002"
,d3.tutkintolaji_tyollistymiseen_koodi as "Koodit Tutkintotyyppi"
,d9.oppilaitoskoodi as "Koodit Oppilaitos"
,d10.koulutuksen_jarjestajakoodi as "Koodit Koul. järjestäjä"
,d11.maakunta_koodi as "Koodit Tutk. suor.maakunta"
,d12.maakunta_koodi as "Koodit Asuinmaakunta"
,d1.iscle2011_koodi as "Koodit Koulutusaste, taso 1"
,d1.Koulutusaste_taso2_koodi as "Koodit Koulutusaste, taso 2"
,d1.iscfibroad2013_koodi as "Koodit Koulutusala, taso 1"
,d1.iscfinarrow2013_koodi as "Koodit Koulutusala, taso 2"
,d1.iscfi2013_koodi as "Koodit Koulutusala, taso 3"

/* Uudet kentät 3.5.2016 -LR */
,d31.aidinkieli_versio1_koodi as ''Koodit Äidinkieli''
,d4.ammattiluokitus_2010_paataso_koodi as [Koodit Ammattiluokitus taso 1]
,d4.ammattiluokitus_2010_2_taso_koodi as [Koodit Ammattiluokitus taso 2]


--isced
,d1.iscle2011 as "Koulutusaste, taso 1"
,d1.Koulutusaste_taso2 as "Koulutusaste, taso 2"
,d1.iscfibroad2013 as "Koulutusala, taso 1"
,d1.iscfinarrow2013 as "Koulutusala, taso 2"
,d1.iscfi2013 as "Koulutusala, taso 3"
,d1.iscle2011_SV as "Utbildn.nivå, nivå 1"
,d1.Koulutusaste_taso2_SV as "Utbildn.nivå, nivå 2"
,d1.iscfibroad2013_SV as "Utbildn.område, nivå 1"
,d1.iscfinarrow2013_SV as "Utbildn.område, nivå 2"
,d1.iscfi2013_SV as "Utbildn.område, nivå 3"
,d1.iscle2011_EN as "Level of education, tier 1"
,d1.Koulutusaste_taso2_EN as "Level of education, tier 2"
,d1.iscfibroad2013_EN as "Field of education, tier 1"
,d1.iscfinarrow2013_EN as "Field of education, tier 2"
,d1.iscfi2013_EN as "Field of education, tier 3"
,d1.jarjestys_iscle2011 as jarj_isced_koulast1
,d1.jarjestys_Koulutusaste_taso2 as jarj_isced_koulast2
,d1.jarjestys_iscfibroad2013 as jarj_isced_koulala1
,d1.jarjestys_iscfinarrow2013 as jarj_isced_koulala2
,d1.jarjestys_iscfi2013 as jarj_isced_koulala3
FROM dbo.f_TJ_4_3_Tutkinnon_suorittaneiden_paaasiallinen_toiminta f
	  JOIN d_koulutusluokitus d1 on d1.id = koulutusluokitus_id
	  JOIN d_paaasiallinen_toiminta_ja_maasta_muuttaneet d2 on d2.id = paaasiallinen_toiminta_ja_maasta_muuttaneet_id
	  JOIN d_tutkintolaji_tyollistymiseen d3 on d3.id = tutkintolaji_tyollistymiseen_id
	  JOIN d_ammattiluokitus_2010 d4 on d4.id = ammattiluokitus_2010_id
	  JOIN d_ammattiasema d5 on d5.id = ammattiasema_id
	  JOIN d_maassaolo d6 on d6.id = maassaolo_id
	  JOIN d_oppisopimuskoulutus d7 on d7.id = oppisopimuskoulutus_id
	  JOIN d_aikuisopiskelija d8 on d8.id = aikuisopiskelija_id
	  JOIN d_oppilaitoksen_taustatiedot d9 on d9.id = oppilaitos_id
	  JOIN d_oppilaitoksen_taustatiedot d10 on d10.id = koulutuksen_jarjestaja_id
	  JOIN d_alueluokitus d11 on d11.id = tutkinnon_suorittamismaakunta_id
	  JOIN d_alueluokitus d12 on d12.id = asuinmaakunta_id
	  JOIN d_koulutusmuoto d21 on d21.id = koulutusmuoto_id
	  JOIN d_ammatillisen_koulutuksen_koulutuslaji_tutkintorekisterissa d22 on d22.id = ammatillisen_koulutuksen_koulutuslaji_tutkintorekisterissa_id
	  JOIN d_paaasiallinen_toiminta_okm d25 on d25.id = paaasiallinen_toiminta_okm_id

/* uudet dimensiot 3.5.2015 - LR */

	  JOIN d_eu_etamaat d30 ON d30.id = f.eu_etamaat_id
	  JOIN d_aidinkieli_versio1 d31 ON d31.id = f.aidinkieli_versio1_id
	  JOIN d_valtio d32 ON d32.id = f.kansalaisuus_maanosa_id

WHERE d1.koulutusaste2002_koodi = 32 AND NOT (sijoittuminen_1v_tutkinnon_jalkeen = 0 AND sijoittuminen_3v_tutkinnon_jalkeen = 0 AND sijoittuminen_5v_tutkinnon_jalkeen = 0)












' 
GO
/****** Object:  View [dbo].[v_f_tab_tyollistyminen_extra]    Script Date: 21.6.2017 10:17:26 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_tyollistyminen_extra]'))
EXEC dbo.sp_executesql @statement = N'
















CREATE view [dbo].[v_f_tab_tyollistyminen_extra] as
Select [lkm_r2] = lukumaara
,[Tilastointivuosi] as Tilastovuosi
,[tutkinnon_suoritusvuosi] as "Tutkinnon suoritusvuosi"
,d1.koulutusala2002 as "Koulutusala"
,d1.jarjestys_koulutusala2002
,d1.koulutusala2002 as "Koulutusala (02 luokitus)"
,d1.opintoala1995 as "Koulutusala (95 luokitus)"
,d1.jarjestys_opintoala1995
,d1.opintoala2002 as "Opintoala (02 luokitus)"
,d1.opintoala2002 as "Opintoala"
,d1.jarjestys_opintoala2002
,d1.koulutus as "Koulutusnimike"
,d1.koulutusaste2002 as "Koulutusaste"
,d1.jarjestys_koulutusaste2002
,d2.paaasiallinen_toiminta_ja_maasta_muuttaneet as "Pääasiallinen toiminta"
,d2.jarjestys as "p_toim_jarj"
,d2.paaasiallinen_toiminta_ja_maasta_muuttaneet_koodi as "paaskoodi"
,d3.tutkintolaji_tyollistymiseen as "Tutkintolaji"
,d3.tutkintolaji_tyollistymiseen as "Tutkintotyyppi"
,d3.jarjestys as "tutklaj_jarj"
,d3.tutkintolaji_tyollistymiseen_koodi as "tutklajikoodi"
,d4.ammattiluokitus_2010 as "Ammatti"
,d5.ammattiasema as "Ammattiasema"
,d5.jarjestys as "amas_jarj"
,d6.maassaolo as "Maassaolo"
--placeholder
,Case when d6.maassaolo_koodi=''1'' Or d6.maassaolo_koodi=''2''
			then ''Tuntematon''
			else ''Tuntematon'' end AS "Kansalaisuus"
,Case when d6.maassaolo_koodi=''1'' Or d6.maassaolo_koodi=''2''
			then ''Information saknas''
			else ''Information saknas'' end AS "Medborgarskap"
,Case when d6.maassaolo_koodi=''1'' Or d6.maassaolo_koodi=''2''
			then ''Missing data''
			else ''Missing data'' end AS "Nationality"
,Case when d6.maassaolo_koodi=''1'' Or d6.maassaolo_koodi=''2''
			then ''-1''
			else ''-1'' end AS jarj_kansalaisuus
--
,d7.oppisopimuskoulutus as "Oppisopimuskoulutus"
,d7.jarjestys as "opsop_jarj"
,d8.aikuisopiskelija as "Nuori/aikuisopiskelija"
,d8.jarjestys as "aik_jarj"
,d9.oppilaitos as "Oppilaitos"
,d9.oppilaitos as "Ammattikorkeakoulu"
,d9.oppilaitos as "Yliopisto"
,d9.oppilaitostyyppi as "Oppilaitostyyppi"
,d9.jarjestys_oppilaitostyyppi
,d9.opetuskieli as "Opetuskieli"
,d9.jarjestys_opetuskieli
,d9.oppilaitoksen_omistajatyyppi as "Oppilaitoksen omistajatyyppi"
,d9.jarjestys_omistajatyyppi
,d10.koulutuksen_jarjestaja as "Koulutuksen järjestäjä"
,d10.koulutuksen_jarjestajan_kieli as "Koul. järjestäjän kieli"
,d10.jarjestys_koulutuksen_jarjestajan_kieli
,d11.avi as "Tutk. suorituspaikan AVI"
,d11.jarjestys_avi as "suorjavi"
,d11.ely as "Tutk. suorituspaikan ELY"
,d11.jarjestys_ely as "suorjely"
,d11.maakunta as "Tutk. suoritusmaakunta"
,d11.jarjestys_maakunta as "suorjmaak"
,d11.maakunta_koodi as "suormaakkoodi"
,d12.avi as "Asuinalueen AVI"
,d12.jarjestys_avi as "ajavi"
,d12.ely as "Asuinalueen ELY"
,d12.jarjestys_ely as "ajely"
,d12.maakunta as "Asuinmaakunta"
,d12.jarjestys_maakunta as "ajmaak"
,d12.maakunta_koodi as "asmaakkoodi"
,d13.valiaikainen_amk as "Väliaikainen amk"
,d13.jarjestys as "amkvaljarj"
,d21.koulutusmuoto as "Koulutusmuoto"
,d21.jarjestys as "koulmuotojarj"
,d22.ammatillisen_koulutuksen_koulutuslaji_tutkintorekisterissa as "Amm. koul. koulutuslaji"
,d22.jarjestys as "amkouljarj"
,d25.paaasiallinen_toiminta_okm as "Pääasiallinen toiminta I"
,d25.jarjestys as paastoim2jarj
--englanti
,[Tilastointivuosi] as "Statistical year"
,d1.koulutusala2002_EN as "Field of education (2002)"
,d1.opintoala1995_EN as "Field of education (1995)"
,d1.opintoala2002_EN as "Subfield of ed. (2002)"
,d1.koulutus_EN as "Name of education"
,d1.koulutusaste2002_EN as "Level of education (2002)"
,d2.paaasiallinen_toiminta_ja_maasta_muuttaneet_EN as "Main type of activity II"
,d3.tutkintolaji_tyollistymiseen_EN as "Form of qualification"
,d3.tutkintolaji_tyollistymiseen_EN as "Form of degree"
,d3.tutkintolaji_tyollistymiseen_EN as "Qualification type"
,d4.ammattiluokitus_2010_2_taso_EN as "Profession"
,d5.ammattiasema_EN as "Status in employment"
,d6.maassaolo_EN as "Residency in Finland"
,d7.oppisopimuskoulutus_EN as "Apprenticeship training"
,d8.aikuisopiskelija_EN as "Youth/adult student"
,d9.oppilaitos_EN as "Educational institution"
,d9.oppilaitos_EN as "Polytechnic"
,d9.oppilaitos_EN as "University"
,d9.oppilaitostyyppi_EN as "Type of ed. institution"
,d9.opetuskieli_EN as "Language of the ed. institution"
,d9.oppilaitoksen_omistajatyyppi_EN as "Type of ed. institution owner"
,d10.koulutuksen_jarjestaja_EN as "Education provider"
,d10.koulutuksen_jarjestajan_kieli_EN as "Language of the ed. provider"
,d11.avi_EN as "AVI area of qualification"
,d11.ely_EN as "ELY area of quafification"
,d11.maakunta_EN as "Region of qualification"
,d11.avi_EN as "AVI area of degree"
,d11.ely_EN as "ELY area of degree"
,d11.maakunta_EN as "Region of degree"
,d12.avi_EN as "AVI area of residence"
,d12.ely_EN as "ELY area of residence"
,d12.maakunta_EN as "Region of residence"
,d25.paaasiallinen_toiminta_okm_EN as "Main type of activity I"
--ruotsi
,[Tilastointivuosi] as Statistikår
,d1.koulutusala2002_SV as "Utbildningsområde (2002)"
,d1.opintoala1995_SV as "Utbildningsområde (1995)"
,d1.opintoala2002_SV as "Studieområde (2002)"
,d1.koulutus_SV as "Utbildningsbenämning"
,d1.koulutusaste2002_SV as "Utbildningsnivå (2002)"
,d2.paaasiallinen_toiminta_ja_maasta_muuttaneet_SV as "Huvudsaklig verksamhet II"
,d3.tutkintolaji_tyollistymiseen_SV as "Examensslag"
,d3.tutkintolaji_tyollistymiseen_SV as "Typ av examen"
,d4.ammattiluokitus_2010_2_taso_SV as "Yrke"
,d5.ammattiasema_SV as "Yrkesställning"
,d6.maassaolo_SV as "Bosatt i Finland"
,d7.oppisopimuskoulutus_SV as "Läroavtalsutbildning"
,d8.aikuisopiskelija_SV as "Ungdoms-/vuxenstuderande"
,d9.oppilaitos_SV as "Läroanstalt"
,d9.oppilaitos_SV as "Yrkehögskola"
,d9.oppilaitos_SV as "Universitet"
,d9.oppilaitostyyppi_SV as "Läroanstaltstyp"
,d9.opetuskieli_SV as "Läroanstaltens undervis.språk"
,d9.oppilaitoksen_omistajatyyppi_SV as "Läroanstaltens ägartyp"
,d10.koulutuksen_jarjestaja_SV as "Utbildningsanordnare"
,d10.koulutuksen_jarjestajan_kieli_SV as "Utbildningsanordnarens språk"
,d11.avi_SV as "RFV-område där examen avlagts"
,d11.ely_SV as "NMT-område där examen avlagts"
,d11.maakunta_SV as "Landskap där examen avlagts"
,d12.avi_SV as "Bostadsortens RFV-område"
,d12.ely_SV as "Bostadsortens NTM-område"
,d12.maakunta_SV as "Bostadslandskap"
,d25.paaasiallinen_toiminta_okm_SV as "Huvudsaklig verksamhet I"
--koodimuuttujat
,d1.koulutusala2002_koodi as "Koodit Koulutusala 2002"
,d1.opintoala1995_koodi as "Koodit Koulutusala 1995"
,d1.opintoala2002_koodi as "Koodit Opintoala 2002"
,d1.koulutus_koodi as "Koodit Koulutusnimike"
,d1.koulutusaste2002_koodi as "Koodit Koulutusaste 2002"
,d3.tutkintolaji_tyollistymiseen_koodi as "Koodit Tutkintolaji"
,d3.tutkintolaji_tyollistymiseen_koodi as "Koodit Tutkintotyyppi"
,d9.oppilaitoskoodi as "Koodit Oppilaitos"
,d10.koulutuksen_jarjestajakoodi as "Koodit Koul. järjestäjä"
,d11.maakunta_koodi as "Koodit Tutk. suor.maakunta"
,d12.maakunta_koodi as "Koodit Asuinmaakunta"
,d1.iscle2011_koodi as "Koodit Koulutusaste, taso 1"
,d1.Koulutusaste_taso2_koodi as "Koodit Koulutusaste, taso 2"
,d1.iscfibroad2013_koodi as "Koodit Koulutusala, taso 1"
,d1.iscfinarrow2013_koodi as "Koodit Koulutusala, taso 2"
,d1.iscfi2013_koodi as "Koodit Koulutusala, taso 3"
,d1.OKM_ohjauksen_ala_koodi as "Koodit OKM ohjauksen ala, korkeak."
--isced
,d1.iscle2011 as "Koulutusaste, taso 1"
,d1.Koulutusaste_taso2 as "Koulutusaste, taso 2"
,d1.iscfibroad2013 as "Koulutusala, taso 1"
,d1.iscfinarrow2013 as "Koulutusala, taso 2"
,d1.iscfi2013 as "Koulutusala, taso 3"
,d1.OKM_ohjauksen_ala as "OKM ohjauksen ala, korkeak."
,d1.iscle2011_SV as "Utbildn.nivå, nivå 1"
,d1.Koulutusaste_taso2_SV as "Utbildn.nivå, nivå 2"
,d1.iscfibroad2013_SV as "Utbildn.område, nivå 1"
,d1.iscfinarrow2013_SV as "Utbildn.område, nivå 2"
,d1.iscfi2013_SV as "Utbildn.område, nivå 3"
,d1.OKM_ohjauksen_ala_SV as "UKM-styrningsområde, högskolor"
,d1.iscle2011_EN as "Level of education, tier 1"
,d1.Koulutusaste_taso2_EN as "Level of education, tier 2"
,d1.iscfibroad2013_EN as "Field of education, tier 1"
,d1.iscfinarrow2013_EN as "Field of education, tier 2"
,d1.iscfi2013_EN as "Field of education, tier 3"
,d1.OKM_ohjauksen_ala_EN as "Field of ed., HE steering"
,d1.jarjestys_iscle2011 as jarj_isced_koulast1
,d1.jarjestys_Koulutusaste_taso2 as jarj_isced_koulast2
,d1.jarjestys_iscfibroad2013 as jarj_isced_koulala1
,d1.jarjestys_iscfinarrow2013 as jarj_isced_koulala2
,d1.jarjestys_iscfi2013 as jarj_isced_koulala3
,d1.jarjestys_OKM_ohjauksen_ala as jarj_isced_okmohjaus1
FROM dbo.f_TJ_4_3_Tutkinnon_suorittaneiden_paaasiallinen_toiminta
	  JOIN d_koulutusluokitus d1 on d1.id = koulutusluokitus_id
	  JOIN d_paaasiallinen_toiminta_ja_maasta_muuttaneet d2 on d2.id = paaasiallinen_toiminta_ja_maasta_muuttaneet_id
	  JOIN d_tutkintolaji_tyollistymiseen d3 on d3.id = tutkintolaji_tyollistymiseen_id
	  JOIN d_ammattiluokitus_2010 d4 on d4.id = ammattiluokitus_2010_id
	  JOIN d_ammattiasema d5 on d5.id = ammattiasema_id
	  JOIN d_maassaolo d6 on d6.id = maassaolo_id
	  JOIN d_oppisopimuskoulutus d7 on d7.id = oppisopimuskoulutus_id
	  JOIN d_aikuisopiskelija d8 on d8.id = aikuisopiskelija_id
	  JOIN d_oppilaitoksen_taustatiedot d9 on d9.id = oppilaitos_id
	  JOIN d_oppilaitoksen_taustatiedot d10 on d10.id = koulutuksen_jarjestaja_id
	  JOIN d_alueluokitus d11 on d11.id = tutkinnon_suorittamismaakunta_id
	  JOIN d_alueluokitus d12 on d12.id = asuinmaakunta_id
	  JOIN d_valiaikainen_amk d13 on d13.id = valiaikainen_amk_id
	  JOIN d_koulutusmuoto d21 on d21.id = koulutusmuoto_id
	  JOIN d_ammatillisen_koulutuksen_koulutuslaji_tutkintorekisterissa d22 on d22.id = ammatillisen_koulutuksen_koulutuslaji_tutkintorekisterissa_id
	  JOIN d_paaasiallinen_toiminta_okm d25 on d25.id = paaasiallinen_toiminta_okm_id
WHERE d9.oppilaitoskoodi <> 02557 AND d9.oppilaitoskoodi <> 10031 AND tutkinnon_suoritusvuosi > ''2008''
















' 
GO
/****** Object:  View [dbo].[v_f_tab_tyollistyminen_koulyht]    Script Date: 21.6.2017 10:17:26 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_tyollistyminen_koulyht]'))
EXEC dbo.sp_executesql @statement = N'














CREATE view [dbo].[v_f_tab_tyollistyminen_koulyht] as





Select [lkm_1vr2] = sijoittuminen_1v_tutkinnon_jalkeen
,[lkm_3vr2] = sijoittuminen_3v_tutkinnon_jalkeen
,[lkm_5vr2] = sijoittuminen_5v_tutkinnon_jalkeen
,[Tilastointivuosi] as Tilastovuosi


,d1.koulutusala2002 as "Koulutusala"
,d1.jarjestys_koulutusala2002
,d1.koulutusala2002 as "Koulutusala (02 luokitus)"
,d1.opintoala1995 as "Koulutusala (95 luokitus)"
,d1.jarjestys_opintoala1995
,d1.opintoala2002 as "Opintoala (02 luokitus)"
,d1.opintoala2002 as "Opintoala"
,d1.jarjestys_opintoala2002
,d1.koulutus as "Koulutusnimike"
,d1.koulutusaste2002 as "Koulutusaste"
,d1.jarjestys_koulutusaste2002
,d2.paaasiallinen_toiminta_ja_maasta_muuttaneet as "Pääasiallinen toiminta"
,d2.jarjestys as "p_toim_jarj"
,d2.paaasiallinen_toiminta_ja_maasta_muuttaneet_koodi as "paaskoodi"
,d3.tutkintolaji_tyollistymiseen as "Tutkintolaji"
,d3.tutkintolaji_tyollistymiseen as "Tutkintotyyppi"
,d3.jarjestys as "tutklaj_jarj"
,d3.tutkintolaji_tyollistymiseen_koodi as "tutklajikoodi"

,d4.ammattiluokitus_2010 as "Ammatti"



,d5.ammattiasema as "Ammattiasema"
,d5.jarjestys as "amas_jarj"
,d6.maassaolo as "Maassaolo"


,d7.oppisopimuskoulutus as "Oppisopimuskoulutus"
,d7.jarjestys as "opsop_jarj"
,d8.aikuisopiskelija as "Nuori/aikuisopiskelija"
,d8.jarjestys as "aik_jarj"
,(case 
	when d9.oppilaitos in (op.oppilaitos) then d9.oppilaitos + '' ('' + d9.oppilaitoskoodi + '')'' 
	else d9.oppilaitos 
  end) 
as "Oppilaitos"
,d9.oppilaitos as "Ammattikorkeakoulu"
,d9.oppilaitos as "Yliopisto"
,d9.oppilaitostyyppi as "Oppilaitostyyppi"
,d9.jarjestys_oppilaitostyyppi
,d9.opetuskieli as "Opetuskieli"
,d9.jarjestys_opetuskieli
,d9.oppilaitoksen_omistajatyyppi as "Oppilaitoksen omistajatyyppi"
,d9.jarjestys_omistajatyyppi
,d10.koulutuksen_jarjestaja as "Koulutuksen järjestäjä"
,d10.koulutuksen_jarjestajan_kieli as "Koul. järjestäjän kieli"
,d10.jarjestys_koulutuksen_jarjestajan_kieli
,d11.avi as "Tutk. suorituspaikan AVI"
,d11.jarjestys_avi as "suorjavi"
,d11.ely as "Tutk. suorituspaikan ELY"
,d11.jarjestys_ely as "suorjely"
,d11.maakunta as "Tutk. suoritusmaakunta"
,d11.jarjestys_maakunta as "suorjmaak"
,d11.maakunta_koodi as "suormaakkoodi"
,d12.avi as "Asuinalueen AVI"
,d12.jarjestys_avi as "ajavi"
,d12.ely as "Asuinalueen ELY"
,d12.jarjestys_ely as "ajely"
,d12.maakunta as "Asuinmaakunta"
,d12.jarjestys_maakunta as "ajmaak"
,d12.maakunta_koodi as "asmaakkoodi"
,d13.valiaikainen_amk as "Väliaikainen amk"
,d13.jarjestys as "amkvaljarj"
,d21.koulutusmuoto as "Koulutusmuoto"
,d21.jarjestys as "koulmuotojarj"
,d22.ammatillisen_koulutuksen_koulutuslaji_tutkintorekisterissa as "Amm. koul. koulutuslaji"
,d22.jarjestys as "amkouljarj"
,d25.paaasiallinen_toiminta_okm as "Pääasiallinen toiminta I"
,d25.jarjestys as paastoim2jarj

/* Uudet kentät 3.5.2016 -LR */
,d30.eu_etamaat as ''Kansalaisuus''
,d30.jarjestys as jarj_kansalaisuus

,d31.aidinkieli_versio1 as ''Äidinkieli''
,d31.jarjestys as jarj_aidinkieli

,d32.maanosa as ''Kansalaisuus (maanosa)''
,d32.jarjestys_maanosa as jarj_kans_maanosa

,d4.ammattiluokitus_2010_paataso as ''Ammattiluokitus taso 1''
,d4.ammattiluokitus_2010_2_taso as ''Ammattiluokitus taso 2''

,d4.[jarjestys_ammattiluokitus_2010_paataso] as ''jarj_ammattiluokitustaso1''
,d4.[jarjestys_ammattiluokitus_2010_taso2] as ''jarj_ammattiluokitustaso2''

--englanti
,[Tilastointivuosi] as "Statistical year"
,d1.koulutusala2002_EN as "Field of education (2002)"
,d1.opintoala1995_EN as "Field of education (1995)"
,d1.opintoala2002_EN as "Subfield of ed. (2002)"
,d1.koulutus_EN as "Name of education"
,d1.koulutusaste2002_EN as "Level of education (2002)"
,d2.paaasiallinen_toiminta_ja_maasta_muuttaneet_EN as "Main type of activity II"
,d3.tutkintolaji_tyollistymiseen_EN as "Form of qualification"
,d3.tutkintolaji_tyollistymiseen_EN as "Form of degree"
,d3.tutkintolaji_tyollistymiseen_EN as "Qualification type"
,d4.ammattiluokitus_2010_2_taso_EN as "Profession"
,d5.ammattiasema_EN as "Status in employment"
,d6.maassaolo_EN as "Residency in Finland"
,d7.oppisopimuskoulutus_EN as "Apprenticeship training"
,d8.aikuisopiskelija_EN as "Youth/adult student"
,(case 
	when d9.oppilaitos in (op.oppilaitos) then d9.oppilaitos_EN + '' ('' + d9.oppilaitoskoodi + '')'' 
	else d9.oppilaitos_EN 
  end)  as "Educational institution"
,d9.oppilaitos_EN as "Polytechnic"
,d9.oppilaitos_EN as "University"
,d9.oppilaitostyyppi_EN as "Type of ed. institution"
,d9.opetuskieli_EN as "Language of the ed. institution"
,d9.oppilaitoksen_omistajatyyppi_EN as "Type of ed. institution owner"
,d10.koulutuksen_jarjestaja_EN as "Education provider"
,d10.koulutuksen_jarjestajan_kieli_EN as "Language of the ed. provider"
,d11.avi_EN as "AVI area of qualification"
,d11.ely_EN as "ELY area of quafification"
,d11.maakunta_EN as "Region of qualification"
,d11.avi_EN as "AVI area of degree"
,d11.ely_EN as "ELY area of degree"
,d11.maakunta_EN as "Region of degree"
,d12.avi_EN as "AVI area of residence"
,d12.ely_EN as "ELY area of residence"
,d12.maakunta_EN as "Region of residence"
,d25.paaasiallinen_toiminta_okm_EN as "Main type of activity I"

/* Uudet kentät 3.5.2016 -LR */
,d30.eu_etamaat_EN as ''Nationality''
,d31.aidinkieli_versio1_EN as ''Mother tongue''
,d32.maanosa_EN as ''Nationality (continent)''

,d4.ammattiluokitus_2010_paataso_EN as ''Profession group 1''
,d4.ammattiluokitus_2010_2_taso_EN as ''Profession group 2''

--ruotsi
,[Tilastointivuosi] as Statistikår
,d1.koulutusala2002_SV as "Utbildningsområde (2002)"
,d1.opintoala1995_SV as "Utbildningsområde (1995)"
,d1.opintoala2002_SV as "Studieområde (2002)"
,d1.koulutus_SV as "Utbildningsbenämning"
,d1.koulutusaste2002_SV as "Utbildningsnivå (2002)"
,d2.paaasiallinen_toiminta_ja_maasta_muuttaneet_SV as "Huvudsaklig verksamhet II"
,d3.tutkintolaji_tyollistymiseen_SV as "Examensslag"
,d3.tutkintolaji_tyollistymiseen_SV as "Typ av examen"
,d4.ammattiluokitus_2010_2_taso_SV as "Yrke"
,d5.ammattiasema_SV as "Yrkesställning"
,d6.maassaolo_SV as "Bosatt i Finland"
,d7.oppisopimuskoulutus_SV as "Läroavtalsutbildning"
,d8.aikuisopiskelija_SV as "Ungdoms-/vuxenstuderande"
,(case 
	when d9.oppilaitos in (op.oppilaitos) then d9.oppilaitos_SV + '' ('' + d9.oppilaitoskoodi + '')'' 
	else d9.oppilaitos_SV
  end)  as "Läroanstalt"
,d9.oppilaitos_SV as "Yrkehögskola"
,d9.oppilaitos_SV as "Universitet"
,d9.oppilaitostyyppi_SV as "Läroanstaltstyp"
,d9.opetuskieli_SV as "Läroanstaltens undervis.språk"
,d9.oppilaitoksen_omistajatyyppi_SV as "Läroanstaltens ägartyp"
,d10.koulutuksen_jarjestaja_SV as "Utbildningsanordnare"
,d10.koulutuksen_jarjestajan_kieli_SV as "Utbildningsanordnarens språk"
,d11.avi_SV as "RFV-område där examen avlagts"
,d11.ely_SV as "NMT-område där examen avlagts"
,d11.maakunta_SV as "Landskap där examen avlagts"
,d12.avi_SV as "Bostadsortens RFV-område"
,d12.ely_SV as "Bostadsortens NTM-område"
,d12.maakunta_SV as "Bostadslandskap"
,d25.paaasiallinen_toiminta_okm_SV as "Huvudsaklig verksamhet I"

/* Uudet kentät 3.5.2016 -LR */
,d30.eu_etamaat_SV as ''Medborgarskap''
,d31.aidinkieli_versio1_SV as ''Modersmål''
,d32.maanosa_SV as ''Medborgarskap (världsdel)''

,d4.ammattiluokitus_2010_paataso_SV as ''Yrkesgrupp 1''
,d4.ammattiluokitus_2010_2_taso_SV as ''Yrkesgrupp 2''

--koodimuuttujat
,d1.koulutusala2002_koodi as "Koodit Koulutusala 2002"
,d1.opintoala1995_koodi as "Koodit Koulutusala 1995"
,d1.opintoala2002_koodi as "Koodit Opintoala 2002"
,d1.koulutus_koodi as "Koodit Koulutusnimike"
,d1.koulutusaste2002_koodi as "Koodit Koulutusaste 2002"
,d3.tutkintolaji_tyollistymiseen_koodi as "Koodit Tutkintolaji"
,d3.tutkintolaji_tyollistymiseen_koodi as "Koodit Tutkintotyyppi"
,coalesce(d9.oppilaitoksen_korvaavakoodi,d9.oppilaitoskoodi) as "Koodit Oppilaitos"
,d10.koulutuksen_jarjestajakoodi as "Koodit Koul. järjestäjä"
,d11.maakunta_koodi as "Koodit Tutk. suor.maakunta"
,d12.maakunta_koodi as "Koodit Asuinmaakunta"
,d1.iscle2011_koodi as "Koodit Koulutusaste, taso 1"
,d1.Koulutusaste_taso2_koodi as "Koodit Koulutusaste, taso 2"
,d1.iscfibroad2013_koodi as "Koodit Koulutusala, taso 1"
,d1.iscfinarrow2013_koodi as "Koodit Koulutusala, taso 2"
,d1.iscfi2013_koodi as "Koodit Koulutusala, taso 3"
,d1.OKM_ohjauksen_ala_koodi as "Koodit OKM ohjauksen ala, korkeak."

/* Uudet kentät 3.5.2016 -LR */
,d31.aidinkieli_versio1_koodi as ''Koodit Äidinkieli''
,d4.ammattiluokitus_2010_paataso_koodi as [Koodit Ammattiluokitus taso 1]
,d4.ammattiluokitus_2010_2_taso_koodi as [Koodit Ammattiluokitus taso 2]


--isced
,d1.iscle2011 as "Koulutusaste, taso 1"
,d1.Koulutusaste_taso2 as "Koulutusaste, taso 2"
,d1.iscfibroad2013 as "Koulutusala, taso 1"
,d1.iscfinarrow2013 as "Koulutusala, taso 2"
,d1.iscfi2013 as "Koulutusala, taso 3"
,d1.OKM_ohjauksen_ala as "OKM ohjauksen ala, korkeak."


,d1.iscle2011_SV as "Utbildn.nivå, nivå 1"
,d1.Koulutusaste_taso2_SV as "Utbildn.nivå, nivå 2"
,d1.iscfibroad2013_SV as "Utbildn.område, nivå 1"
,d1.iscfinarrow2013_SV as "Utbildn.område, nivå 2"
,d1.iscfi2013_SV as "Utbildn.område, nivå 3"
,d1.OKM_ohjauksen_ala_SV as "UKM-styrningsområde, högskolor"


,d1.iscle2011_EN as "Level of education, tier 1"
,d1.Koulutusaste_taso2_EN as "Level of education, tier 2"
,d1.iscfibroad2013_EN as "Field of education, tier 1"
,d1.iscfinarrow2013_EN as "Field of education, tier 2"
,d1.iscfi2013_EN as "Field of education, tier 3"
,d1.OKM_ohjauksen_ala_EN as "Field of ed., HE steering"


,d1.jarjestys_iscle2011 as jarj_isced_koulast1
,d1.jarjestys_Koulutusaste_taso2 as jarj_isced_koulast2
,d1.jarjestys_iscfibroad2013 as jarj_isced_koulala1
,d1.jarjestys_iscfinarrow2013 as jarj_isced_koulala2
,d1.jarjestys_iscfi2013 as jarj_isced_koulala3
,d1.jarjestys_OKM_ohjauksen_ala as jarj_isced_okmohjaus1


FROM dbo.f_TJ_4_3_Tutkinnon_suorittaneiden_paaasiallinen_toiminta f
	  JOIN d_koulutusluokitus d1 on d1.id = koulutusluokitus_id
	  JOIN d_paaasiallinen_toiminta_ja_maasta_muuttaneet d2 on d2.id = paaasiallinen_toiminta_ja_maasta_muuttaneet_id
	  JOIN d_tutkintolaji_tyollistymiseen d3 on d3.id = tutkintolaji_tyollistymiseen_id
	  JOIN d_ammattiluokitus_2010 d4 on d4.id = ammattiluokitus_2010_id
	  JOIN d_ammattiasema d5 on d5.id = ammattiasema_id
	  JOIN d_maassaolo d6 on d6.id = maassaolo_id
	  JOIN d_oppisopimuskoulutus d7 on d7.id = oppisopimuskoulutus_id
	  JOIN d_aikuisopiskelija d8 on d8.id = aikuisopiskelija_id
	  JOIN d_oppilaitoksen_taustatiedot d9 on d9.id = oppilaitos_id
	  JOIN d_oppilaitoksen_taustatiedot d10 on d10.id = koulutuksen_jarjestaja_id
	  JOIN d_alueluokitus d11 on d11.id = tutkinnon_suorittamismaakunta_id
	  JOIN d_alueluokitus d12 on d12.id = asuinmaakunta_id
	  JOIN d_valiaikainen_amk d13 on d13.id = valiaikainen_amk_id
	  JOIN d_koulutusmuoto d21 on d21.id = koulutusmuoto_id
	  JOIN d_ammatillisen_koulutuksen_koulutuslaji_tutkintorekisterissa d22 on d22.id = ammatillisen_koulutuksen_koulutuslaji_tutkintorekisterissa_id
	  JOIN d_paaasiallinen_toiminta_okm d25 on d25.id = paaasiallinen_toiminta_okm_id

/* uudet dimensiot 3.5.2015 - LR */

	  JOIN d_eu_etamaat d30 ON d30.id = f.eu_etamaat_id
	  JOIN d_aidinkieli_versio1 d31 ON d31.id = f.aidinkieli_versio1_id
	  JOIN d_valtio d32 ON d32.id = f.kansalaisuus_maanosa_id

--Haetaan oppilaitokset joilla enemmän kuin yksi koodi ja eri sijaintikunnat
outer apply
(
SELECT o.Oppilaitos
FROM dbo.f_TJ_4_3_Tutkinnon_suorittaneiden_paaasiallinen_toiminta f2
left join vipunentk.dbo.d_oppilaitoksen_taustatiedot o on o.id=f2.oppilaitos_id
WHERE o.oppilaitoskoodi <> 02557 AND o.oppilaitoskoodi <> 10031 AND NOT (f2.sijoittuminen_1v_tutkinnon_jalkeen = 0 AND f2.sijoittuminen_3v_tutkinnon_jalkeen = 0 AND f2.sijoittuminen_5v_tutkinnon_jalkeen = 0) and o.oppilaitos=d9.oppilaitos
group by o.oppilaitos
having count(distinct o.oppilaitoskoodi)>1 and count(distinct o.oppilaitoksen_sijaintikunta)>1
) op

WHERE d9.oppilaitoskoodi <> 02557 AND d9.oppilaitoskoodi <> 10031 AND NOT (f.sijoittuminen_1v_tutkinnon_jalkeen = 0 AND f.sijoittuminen_3v_tutkinnon_jalkeen = 0 AND f.sijoittuminen_5v_tutkinnon_jalkeen = 0)




















' 
GO
/****** Object:  View [dbo].[v_f_tab_tyollistyminen_lukio]    Script Date: 21.6.2017 10:17:26 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_tyollistyminen_lukio]'))
EXEC dbo.sp_executesql @statement = N'








CREATE view [dbo].[v_f_tab_tyollistyminen_lukio] as
Select [lkm_1vr2] = sijoittuminen_1v_tutkinnon_jalkeen
,[lkm_3vr2] = sijoittuminen_3v_tutkinnon_jalkeen
,[lkm_5vr2] = sijoittuminen_5v_tutkinnon_jalkeen
,[Tilastointivuosi] as Tilastovuosi
,d1.koulutusala2002 as "Koulutusala"
,d1.jarjestys_koulutusala2002
,d1.opintoala2002 as "Opintoala"
,d1.jarjestys_opintoala2002
,d1.koulutus as "Koulutusnimike"
,d1.koulutusaste2002 as "Koulutusaste"
,d1.jarjestys_koulutusaste2002
,d2.paaasiallinen_toiminta_ja_maasta_muuttaneet as "Pääasiallinen toiminta"
,d2.jarjestys as "p_toim_jarj"
,d2.paaasiallinen_toiminta_ja_maasta_muuttaneet_koodi as "paaskoodi"
,d3.tutkintolaji_tyollistymiseen as "Tutkintolaji"
,d3.jarjestys as "tutklaj_jarj"
,d3.tutkintolaji_tyollistymiseen_koodi as "tutklajikoodi"
,d4.ammattiluokitus_2010 as "Ammatti"
,d5.ammattiasema as "Ammattiasema"
,d5.jarjestys as "amas_jarj"
,d6.maassaolo as "Maassaolo"
--placeholder
/*
,Case when d6.maassaolo_koodi=''1'' Or d6.maassaolo_koodi=''2''
			then ''Tuntematon''
			else ''Tuntematon'' end AS "Kansalaisuus"
,Case when d6.maassaolo_koodi=''1'' Or d6.maassaolo_koodi=''2''
			then ''Information saknas''
			else ''Information saknas'' end AS "Medborgarskap"
,Case when d6.maassaolo_koodi=''1'' Or d6.maassaolo_koodi=''2''
			then ''Missing data''
			else ''Missing data'' end AS "Nationality"
,Case when d6.maassaolo_koodi=''1'' Or d6.maassaolo_koodi=''2''
			then ''-1''
			else ''-1'' end AS jarj_kansalaisuus
			*/
--
,d8.aikuisopiskelija as "Nuori/aikuisopiskelija"
,d8.jarjestys as "aik_jarj"
,d9.oppilaitos as "Oppilaitos"
,d9.oppilaitostyyppi as "Oppilaitostyyppi"
,d9.jarjestys_oppilaitostyyppi
,d9.opetuskieli as "Opetuskieli"
,d9.jarjestys_opetuskieli
,d9.oppilaitoksen_omistajatyyppi as "Oppilaitoksen omistajatyyppi"
,d9.jarjestys_omistajatyyppi
,d10.koulutuksen_jarjestaja as "Koulutuksen järjestäjä"
,d10.koulutuksen_jarjestajan_kieli as "Koul. järjestäjän kieli"
,d10.jarjestys_koulutuksen_jarjestajan_kieli
,d11.avi as "Tutk. suorituspaikan AVI"
,d11.jarjestys_avi as "suorjavi"
,d11.ely as "Tutk. suorituspaikan ELY"
,d11.jarjestys_ely as "suorjely"
,d11.maakunta as "Tutk. suoritusmaakunta"
,d11.jarjestys_maakunta as "suorjmaak"
,d11.maakunta_koodi as "suormaakkoodi"
,d12.avi as "Asuinalueen AVI"
,d12.jarjestys_avi as "ajavi"
,d12.ely as "Asuinalueen ELY"
,d12.jarjestys_ely as "ajely"
,d12.maakunta as "Asuinmaakunta"
,d12.jarjestys_maakunta as "ajmaak"
,d12.maakunta_koodi as "asmaakkoodi"
,d25.paaasiallinen_toiminta_okm as "Pääasiallinen toiminta I"
,d25.jarjestys as paastoim2jarj

/* Uudet kentät 3.5.2016 -LR */
,d30.eu_etamaat as ''Kansalaisuus''
,d30.jarjestys as jarj_kansalaisuus
,d31.aidinkieli_versio1 as ''Äidinkieli''
,d31.jarjestys as jarj_aidinkieli
,d32.maanosa as ''Kansalaisuus (maanosa)''
,d32.jarjestys_maanosa as jarj_kans_maanosa
,d4.ammattiluokitus_2010_paataso as ''Ammattiluokitus taso 1''
,d4.ammattiluokitus_2010_2_taso as ''Ammattiluokitus taso 2''
,d4.[jarjestys_ammattiluokitus_2010_paataso] as ''jarj_ammattiluokitustaso1''
,d4.[jarjestys_ammattiluokitus_2010_taso2] as ''jarj_ammattiluokitustaso2''

--englanti
,[Tilastointivuosi] as "Statistical year"
,d1.koulutusala2002_EN as "Field of education (2002)"
,d1.opintoala2002_EN as "Subfield of ed. (2002)"
,d1.koulutus_EN as "Name of education"
,d1.koulutusaste2002_EN as "Level of education (2002)"
,d2.paaasiallinen_toiminta_ja_maasta_muuttaneet_EN as "Main type of activity II"
,d3.tutkintolaji_tyollistymiseen_EN as "Form of qualification"
,d4.ammattiluokitus_2010_2_taso_EN as "Profession"
,d5.ammattiasema_EN as "Status in employment"
,d6.maassaolo_EN as "Residency in Finland"
,d8.aikuisopiskelija_EN as "Youth/adult student"
,d9.oppilaitos_EN as "Educational institution"
,d9.oppilaitostyyppi_EN as "Type of ed. institution"
,d9.opetuskieli_EN as "Language of the ed. institution"
,d9.oppilaitoksen_omistajatyyppi_EN as "Type of ed. institution owner"
,d10.koulutuksen_jarjestaja_EN as "Education provider"
,d10.koulutuksen_jarjestajan_kieli_EN as "Language of the ed. provider"
,d11.avi_EN as "AVI area of qualification"
,d11.ely_EN as "ELY area of quafification"
,d11.maakunta_EN as "Region of qualification"
,d12.avi_EN as "AVI area of residence"
,d12.ely_EN as "ELY area of residence"
,d12.maakunta_EN as "Region of residence"
,d25.paaasiallinen_toiminta_okm_EN as "Main type of activity I"

/* Uudet kentät 3.5.2016 -LR */
,d30.eu_etamaat_EN as ''Nationality''
,d31.aidinkieli_versio1_EN as ''Mother tongue''
,d32.maanosa_EN as ''Nationality (continent)''
,d4.ammattiluokitus_2010_paataso_EN as ''Profession group 1''
,d4.ammattiluokitus_2010_2_taso_EN as ''Profession group 2''


--ruotsi
,[Tilastointivuosi] as Statistikår
,d1.koulutusala2002_SV as "Utbildningsområde (2002)"
,d1.opintoala2002_SV as "Studieområde (2002)"
,d1.koulutus_SV as "Utbildningsbenämning"
,d1.koulutusaste2002_SV as "Utbildningsnivå (2002)"
,d2.paaasiallinen_toiminta_ja_maasta_muuttaneet_SV as "Huvudsaklig verksamhet II"
,d3.tutkintolaji_tyollistymiseen_SV as "Examensslag"
,d4.ammattiluokitus_2010_2_taso_SV as "Yrke"
,d5.ammattiasema_SV as "Yrkesställning"
,d6.maassaolo_SV as "Bosatt i Finland"
,d8.aikuisopiskelija_SV as "Ungdoms-/vuxenstuderande"
,d9.oppilaitos_SV as "Läroanstalt"
,d9.oppilaitostyyppi_SV as "Läroanstaltstyp"
,d9.opetuskieli_SV as "Läroanstaltens undervis.språk"
,d9.oppilaitoksen_omistajatyyppi_SV as "Läroanstaltens ägartyp"
,d10.koulutuksen_jarjestaja_SV as "Utbildningsanordnare"
,d10.koulutuksen_jarjestajan_kieli_SV as "Utbildningsanordnarens språk"
,d11.avi_SV as "RFV-område där examen avlagts"
,d11.ely_SV as "NMT-område där examen avlagts"
,d11.maakunta_SV as "Landskap där examen avlagts"
,d12.avi_SV as "Bostadsortens RFV-område"
,d12.ely_SV as "Bostadsortens NTM-område"
,d12.maakunta_SV as "Bostadslandskap"
,d25.paaasiallinen_toiminta_okm_SV as "Huvudsaklig verksamhet I"


/* Uudet kentät 3.5.2016 -LR */
,d30.eu_etamaat_SV as ''Medborgarskap''
,d31.aidinkieli_versio1_SV as ''Modersmål''
,d32.maanosa_SV as ''Medborgarskap (världsdel)''
,d4.ammattiluokitus_2010_paataso_SV as ''Yrkesgrupp 1''
,d4.ammattiluokitus_2010_2_taso_SV as ''Yrkesgrupp 2''

--koodimuuttujat
,d1.koulutusala2002_koodi as "Koodit Koulutusala 2002"
,d1.opintoala2002_koodi as "Koodit Opintoala 2002"
,d1.koulutus_koodi as "Koodit Koulutusnimike"
,d1.koulutusaste2002_koodi as "Koodit Koulutusaste 2002"
,d3.tutkintolaji_tyollistymiseen_koodi as "Koodit Tutkintolaji"
,d9.oppilaitoskoodi as "Koodit Oppilaitos"
,d10.koulutuksen_jarjestajakoodi as "Koodit Koul. järjestäjä"
,d11.maakunta_koodi as "Koodit Tutk. suor.maakunta"
,d12.maakunta_koodi as "Koodit Asuinmaakunta"
,d1.iscle2011_koodi as "Koodit Koulutusaste, taso 1"
,d1.Koulutusaste_taso2_koodi as "Koodit Koulutusaste, taso 2"
,d1.iscfibroad2013_koodi as "Koodit Koulutusala, taso 1"
,d1.iscfinarrow2013_koodi as "Koodit Koulutusala, taso 2"
,d1.iscfi2013_koodi as "Koodit Koulutusala, taso 3"

/* Uudet kentät 3.5.2016 -LR */
,d31.aidinkieli_versio1_koodi as ''Koodit Äidinkieli''
,d4.ammattiluokitus_2010_paataso_koodi as [Koodit Ammattiluokitus taso 1]
,d4.ammattiluokitus_2010_2_taso_koodi as [Koodit Ammattiluokitus taso 2]


--isced
,d1.iscle2011 as "Koulutusaste, taso 1"
,d1.Koulutusaste_taso2 as "Koulutusaste, taso 2"
,d1.iscfibroad2013 as "Koulutusala, taso 1"
,d1.iscfinarrow2013 as "Koulutusala, taso 2"
,d1.iscfi2013 as "Koulutusala, taso 3"
,d1.iscle2011_SV as "Utbildn.nivå, nivå 1"
,d1.Koulutusaste_taso2_SV as "Utbildn.nivå, nivå 2"
,d1.iscfibroad2013_SV as "Utbildn.område, nivå 1"
,d1.iscfinarrow2013_SV as "Utbildn.område, nivå 2"
,d1.iscfi2013_SV as "Utbildn.område, nivå 3"
,d1.iscle2011_EN as "Level of education, tier 1"
,d1.Koulutusaste_taso2_EN as "Level of education, tier 2"
,d1.iscfibroad2013_EN as "Field of education, tier 1"
,d1.iscfinarrow2013_EN as "Field of education, tier 2"
,d1.iscfi2013_EN as "Field of education, tier 3"
,d1.jarjestys_iscle2011 as jarj_isced_koulast1
,d1.jarjestys_Koulutusaste_taso2 as jarj_isced_koulast2
,d1.jarjestys_iscfibroad2013 as jarj_isced_koulala1
,d1.jarjestys_iscfinarrow2013 as jarj_isced_koulala2
,d1.jarjestys_iscfi2013 as jarj_isced_koulala3
FROM dbo.f_TJ_4_3_Tutkinnon_suorittaneiden_paaasiallinen_toiminta f
	  JOIN d_koulutusluokitus d1 on d1.id = koulutusluokitus_id
	  JOIN d_paaasiallinen_toiminta_ja_maasta_muuttaneet d2 on d2.id = paaasiallinen_toiminta_ja_maasta_muuttaneet_id
	  JOIN d_tutkintolaji_tyollistymiseen d3 on d3.id = tutkintolaji_tyollistymiseen_id
	  JOIN d_ammattiluokitus_2010 d4 on d4.id = ammattiluokitus_2010_id
	  JOIN d_ammattiasema d5 on d5.id = ammattiasema_id
	  JOIN d_maassaolo d6 on d6.id = maassaolo_id
	  JOIN d_aikuisopiskelija d8 on d8.id = aikuisopiskelija_id
	  JOIN d_oppilaitoksen_taustatiedot d9 on d9.id = oppilaitos_id
	  JOIN d_oppilaitoksen_taustatiedot d10 on d10.id = koulutuksen_jarjestaja_id
	  JOIN d_alueluokitus d11 on d11.id = tutkinnon_suorittamismaakunta_id
	  JOIN d_alueluokitus d12 on d12.id = asuinmaakunta_id
	  JOIN d_paaasiallinen_toiminta_okm d25 on d25.id = paaasiallinen_toiminta_okm_id

/* uudet dimensiot 3.5.2015 - LR */

	  JOIN d_eu_etamaat d30 ON d30.id = f.eu_etamaat_id
	  JOIN d_aidinkieli_versio1 d31 ON d31.id = f.aidinkieli_versio1_id
	  JOIN d_valtio d32 ON d32.id = f.kansalaisuus_maanosa_id

WHERE d1.koulutusaste2002_koodi = 31 AND NOT (sijoittuminen_1v_tutkinnon_jalkeen = 0 AND sijoittuminen_3v_tutkinnon_jalkeen = 0 AND sijoittuminen_5v_tutkinnon_jalkeen = 0)









' 
GO
/****** Object:  View [dbo].[v_f_tab_tyollistyminen_yo]    Script Date: 21.6.2017 10:17:26 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_tyollistyminen_yo]'))
EXEC dbo.sp_executesql @statement = N'










CREATE view [dbo].[v_f_tab_tyollistyminen_yo] as
Select [lkm_1vr2] = sijoittuminen_1v_tutkinnon_jalkeen
,[lkm_3vr2] = sijoittuminen_3v_tutkinnon_jalkeen
,[lkm_5vr2] = sijoittuminen_5v_tutkinnon_jalkeen
,[Tilastointivuosi] as Tilastovuosi
,d1.koulutusala2002 as "Koulutusala (02 luokitus)"
,d1.jarjestys_koulutusala2002
,d1.opintoala1995 as "Koulutusala (95 luokitus)"
,d1.jarjestys_opintoala1995
,d1.opintoala2002 as "Opintoala (02 luokitus)"
,d1.jarjestys_opintoala2002
,d1.koulutus as "Koulutusnimike"
,d1.koulutusaste2002 as "Koulutusaste"
,d1.jarjestys_koulutusaste2002
,d2.paaasiallinen_toiminta_ja_maasta_muuttaneet as "Pääasiallinen toiminta"
,d2.jarjestys as "p_toim_jarj"
,d2.paaasiallinen_toiminta_ja_maasta_muuttaneet_koodi as "paaskoodi"
,d3.tutkintolaji_tyollistymiseen as "Tutkintolaji"
,d3.jarjestys as "tutklaj_jarj"
,d3.tutkintolaji_tyollistymiseen_koodi as "tutklajikoodi"
,d4.ammattiluokitus_2010 as "Ammatti"
,d5.ammattiasema as "Ammattiasema"
,d5.jarjestys as "amas_jarj"
,d6.maassaolo as "Maassaolo"
/*
,Case when d6.maassaolo_koodi=''1'' Or d6.maassaolo_koodi=''2''
			then ''Tuntematon''
			else ''Tuntematon'' end AS "Kansalaisuus"
,Case when d6.maassaolo_koodi=''1'' Or d6.maassaolo_koodi=''2''
			then ''Information saknas''
			else ''Information saknas'' end AS "Medborgarskap"
,Case when d6.maassaolo_koodi=''1'' Or d6.maassaolo_koodi=''2''
			then ''Missing data''
			else ''Missing data'' end AS "Nationality"
,Case when d6.maassaolo_koodi=''1'' Or d6.maassaolo_koodi=''2''
			then ''-1''
			else ''-1'' end AS jarj_kansalaisuus
--
*/
,d9.oppilaitos as "Yliopisto"
,d9.oppilaitostyyppi as "Oppilaitostyyppi"
,d9.jarjestys_oppilaitostyyppi
,d9.opetuskieli as "Opetuskieli"
,d9.jarjestys_opetuskieli
,d9.oppilaitoksen_omistajatyyppi as "Oppilaitoksen omistajatyyppi"
,d9.jarjestys_omistajatyyppi
,d11.avi as "Tutk. suorituspaikan AVI"
,d11.jarjestys_avi as "suorjavi"
,d11.ely as "Tutk. suorituspaikan ELY"
,d11.jarjestys_ely as "suorjely"
,d11.maakunta as "Tutk. suoritusmaakunta"
,d11.jarjestys_maakunta as "suorjmaak"
,d11.maakunta_koodi as "suormaakkoodi"
,d12.avi as "Asuinalueen AVI"
,d12.jarjestys_avi as "ajavi"
,d12.ely as "Asuinalueen ELY"
,d12.jarjestys_ely as "ajely"
,d12.maakunta as "Asuinmaakunta"
,d12.jarjestys_maakunta as "ajmaak"
,d12.maakunta_koodi as "asmaakkoodi"
,d25.paaasiallinen_toiminta_okm as "Pääasiallinen toiminta I"
,d25.jarjestys as paastoim2jarj

/* Uudet kentät 3.5.2016 -LR */
,d30.eu_etamaat as ''Kansalaisuus''
,d30.jarjestys as jarj_kansalaisuus
,d31.aidinkieli_versio1 as ''Äidinkieli''
,d31.jarjestys as jarj_aidinkieli
,d32.maanosa as ''Kansalaisuus (maanosa)''
,d32.jarjestys_maanosa as jarj_kans_maanosa
,d4.ammattiluokitus_2010_paataso as ''Ammattiluokitus taso 1''
,d4.ammattiluokitus_2010_2_taso as ''Ammattiluokitus taso 2''
,d4.[jarjestys_ammattiluokitus_2010_paataso] as ''jarj_ammattiluokitustaso1''
,d4.[jarjestys_ammattiluokitus_2010_taso2] as ''jarj_ammattiluokitustaso2''

--englanti
,[Tilastointivuosi] as "Statistical year"
,d1.koulutusala2002_EN as "Field of education (2002)"
,d1.opintoala1995_EN as "Field of education (1995)"
,d1.opintoala2002_EN as "Subfield of ed. (2002)"
,d1.koulutus_EN as "Name of education"
,d1.koulutusaste2002_EN as "Level of education (2002)"
,d2.paaasiallinen_toiminta_ja_maasta_muuttaneet_EN as "Main type of activity II"
,d3.tutkintolaji_tyollistymiseen_EN as "Form of degree"
,d4.ammattiluokitus_2010_2_taso_EN as "Profession"
,d5.ammattiasema_EN as "Status in employment"
,d6.maassaolo_EN as "Residency in Finland"
,d9.oppilaitos_EN as "University"
,d9.oppilaitostyyppi_EN as "Type of ed. institution"
,d9.opetuskieli_EN as "Language of the ed. institution"
,d9.oppilaitoksen_omistajatyyppi_EN as "Type of ed. institution owner"
,d11.avi_EN as "AVI area of degree"
,d11.ely_EN as "ELY area of degree"
,d11.maakunta_EN as "Region of degree"
,d12.avi_EN as "AVI area of residence"
,d12.ely_EN as "ELY area of residence"
,d12.maakunta_EN as "Region of residence"
,d25.paaasiallinen_toiminta_okm_EN as "Main type of activity I"

/* Uudet kentät 3.5.2016 -LR */
,d30.eu_etamaat_EN as ''Nationality''
,d31.aidinkieli_versio1_EN as ''Mother tongue''
,d32.maanosa_EN as ''Nationality (continent)''
,d4.ammattiluokitus_2010_paataso_EN as ''Profession group 1''
,d4.ammattiluokitus_2010_2_taso_EN as ''Profession group 2''

--ruotsi
,[Tilastointivuosi] as Statistikår
,d1.koulutusala2002_SV as "Utbildningsområde (2002)"
,d1.opintoala1995_SV as "Utbildningsområde (1995)"
,d1.opintoala2002_SV as "Studieområde (2002)"
,d1.koulutus_SV as "Utbildningsbenämning"
,d1.koulutusaste2002_SV as "Utbildningsnivå (2002)"
,d2.paaasiallinen_toiminta_ja_maasta_muuttaneet_SV as "Huvudsaklig verksamhet II"
,d3.tutkintolaji_tyollistymiseen_SV as "Examensslag"
,d4.ammattiluokitus_2010_2_taso_SV as "Yrke"
,d5.ammattiasema_SV as "Yrkesställning"
,d6.maassaolo_SV as "Bosatt i Finland"
,d9.oppilaitos_SV as "Universitet"
,d9.oppilaitostyyppi_SV as "Läroanstaltstyp"
,d9.opetuskieli_SV as "Läroanstaltens undervis.språk"
,d9.oppilaitoksen_omistajatyyppi_SV as "Läroanstaltens ägartyp"
,d11.avi_SV as "RFV-område där examen avlagts"
,d11.ely_SV as "NMT-område där examen avlagts"
,d11.maakunta_SV as "Landskap där examen avlagts"
,d12.avi_SV as "Bostadsortens RFV-område"
,d12.ely_SV as "Bostadsortens NTM-område"
,d12.maakunta_SV as "Bostadslandskap"
,d25.paaasiallinen_toiminta_okm_SV as "Huvudsaklig verksamhet I"

/* Uudet kentät 3.5.2016 -LR */
,d30.eu_etamaat_SV as ''Medborgarskap''
,d31.aidinkieli_versio1_SV as ''Modersmål''
,d32.maanosa_SV as ''Medborgarskap (världsdel)''
,d4.ammattiluokitus_2010_paataso_SV as ''Yrkesgrupp 1''
,d4.ammattiluokitus_2010_2_taso_SV as ''Yrkesgrupp 2''

--koodimuuttujat
,d1.koulutusala2002_koodi as "Koodit Koulutusala 2002"
,d1.opintoala1995_koodi as "Koodit Koulutusala 1995"
,d1.opintoala2002_koodi as "Koodit Opintoala 2002"
,d1.koulutus_koodi as "Koodit Koulutusnimike"
,d1.koulutusaste2002_koodi as "Koodit Koulutusaste 2002"
,d3.tutkintolaji_tyollistymiseen_koodi as "Koodit Tutkintolaji"
,d9.oppilaitoskoodi as "Koodit Oppilaitos"
,d11.maakunta_koodi as "Koodit Tutk. suor.maakunta"
,d12.maakunta_koodi as "Koodit Asuinmaakunta"
,d1.iscle2011_koodi as "Koodit Koulutusaste, taso 1"
,d1.Koulutusaste_taso2_koodi as "Koodit Koulutusaste, taso 2"
,d1.iscfibroad2013_koodi as "Koodit Koulutusala, taso 1"
,d1.iscfinarrow2013_koodi as "Koodit Koulutusala, taso 2"
,d1.iscfi2013_koodi as "Koodit Koulutusala, taso 3"
,d1.OKM_ohjauksen_ala_koodi as "Koodit OKM ohjauksen ala, korkeak."

/* Uudet kentät 3.5.2016 -LR */
,d31.aidinkieli_versio1_koodi as ''Koodit Äidinkieli''
,d4.ammattiluokitus_2010_paataso_koodi as [Koodit Ammattiluokitus taso 1]
,d4.ammattiluokitus_2010_2_taso_koodi as [Koodit Ammattiluokitus taso 2]

--isced
,d1.iscle2011 as "Koulutusaste, taso 1"
,d1.Koulutusaste_taso2 as "Koulutusaste, taso 2"
,d1.iscfibroad2013 as "Koulutusala, taso 1"
,d1.iscfinarrow2013 as "Koulutusala, taso 2"
,d1.iscfi2013 as "Koulutusala, taso 3"
,d1.OKM_ohjauksen_ala as "OKM ohjauksen ala, korkeak."
,d1.iscle2011_SV as "Utbildn.nivå, nivå 1"
,d1.Koulutusaste_taso2_SV as "Utbildn.nivå, nivå 2"
,d1.iscfibroad2013_SV as "Utbildn.område, nivå 1"
,d1.iscfinarrow2013_SV as "Utbildn.område, nivå 2"
,d1.iscfi2013_SV as "Utbildn.område, nivå 3"
,d1.OKM_ohjauksen_ala_SV as "UKM-styrningsområde, högskolor"
,d1.iscle2011_EN as "Level of education, tier 1"
,d1.Koulutusaste_taso2_EN as "Level of education, tier 2"
,d1.iscfibroad2013_EN as "Field of education, tier 1"
,d1.iscfinarrow2013_EN as "Field of education, tier 2"
,d1.iscfi2013_EN as "Field of education, tier 3"
,d1.OKM_ohjauksen_ala_EN as "Field of ed., HE steering"
,d1.jarjestys_iscle2011 as jarj_isced_koulast1
,d1.jarjestys_Koulutusaste_taso2 as jarj_isced_koulast2
,d1.jarjestys_iscfibroad2013 as jarj_isced_koulala1
,d1.jarjestys_iscfinarrow2013 as jarj_isced_koulala2
,d1.jarjestys_iscfi2013 as jarj_isced_koulala3
,d1.jarjestys_OKM_ohjauksen_ala as jarj_isced_okmohjaus1


FROM dbo.f_TJ_4_3_Tutkinnon_suorittaneiden_paaasiallinen_toiminta f
	  JOIN d_koulutusluokitus d1 on d1.id = koulutusluokitus_id
	  JOIN d_paaasiallinen_toiminta_ja_maasta_muuttaneet d2 on d2.id = paaasiallinen_toiminta_ja_maasta_muuttaneet_id
	  JOIN d_tutkintolaji_tyollistymiseen d3 on d3.id = tutkintolaji_tyollistymiseen_id
	  JOIN d_ammattiluokitus_2010 d4 on d4.id = ammattiluokitus_2010_id
	  JOIN d_ammattiasema d5 on d5.id = ammattiasema_id
	  JOIN d_maassaolo d6 on d6.id = maassaolo_id
	  JOIN d_oppilaitoksen_taustatiedot d9 on d9.id = oppilaitos_id
	  JOIN d_alueluokitus d11 on d11.id = tutkinnon_suorittamismaakunta_id
	  JOIN d_alueluokitus d12 on d12.id = asuinmaakunta_id
	  JOIN d_paaasiallinen_toiminta_okm d25 on d25.id = paaasiallinen_toiminta_okm_id

/* uudet dimensiot 3.5.2015 - LR */

	  JOIN d_eu_etamaat d30 ON d30.id = f.eu_etamaat_id
	  JOIN d_aidinkieli_versio1 d31 ON d31.id = f.aidinkieli_versio1_id
	  JOIN d_valtio d32 ON d32.id = f.kansalaisuus_maanosa_id

WHERE d1.koulutusaste2002_koodi in (''63'',''72'',''73'',''81'',''82'') AND NOT (sijoittuminen_1v_tutkinnon_jalkeen = 0 AND sijoittuminen_3v_tutkinnon_jalkeen = 0 AND sijoittuminen_5v_tutkinnon_jalkeen = 0)










' 
GO
/****** Object:  View [dbo].[v_f_tab_ulkomaalaiset_maan_kansalaisuuden_aidinkielen_mukaan]    Script Date: 21.6.2017 10:17:26 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_ulkomaalaiset_maan_kansalaisuuden_aidinkielen_mukaan]'))
EXEC dbo.sp_executesql @statement = N'



















CREATE VIEW [dbo].[v_f_tab_ulkomaalaiset_maan_kansalaisuuden_aidinkielen_mukaan] AS
SELECT 
	   [opiskelijoiden_lkm] AS lkm_op2
	  ,CASE WHEN [tilastovuosi] = [koulutuksen_aloittamislukuvuosi] THEN [opiskelijoiden_lkm] ELSE 0 END AS lkm_aloit2
	  ,CASE WHEN d13.opiskelijan_olo_koodi = 1 THEN [opiskelijoiden_lkm] ELSE 0 END AS lkm_opiskolo2
	  ,[tilastovuosi] AS Tilastovuosi
	  ,[Nakokulma] AS Näkökulma
	  ,d1.lahde AS Lähde
      ,d2.koulutus AS [Koulutusnimike]
	  ,d2.opintoala2002 AS [Opintoala]
	  ,d2.koulutusala2002 AS [Koulutusala]
	  ,d2.opintoala1995 AS [Koulutusala (95 luokitus)]
	  ,d2.koulutusala2002 AS [Koulutusala (02 luokitus)]
	  ,d2.koulutusaste2002 AS [Koulutusaste]
	  ,d3.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus AS Järjestämistapa
	  ,d4.ammatillisen_koulutuksen_koulutuslaji AS Tutkintotyyppi
	  ,d5.opetushallinnon_koulutus AS Hallinnonala
	  ,d6.kieli AS Opetuskieli
	  ,d7.nuorten_aikuisten_koulutus_amm AS ''Nuorten koulutus/aikuiskoulutus''
	  ,d8.maakunta AS ''Koulutuksen maakunta''
	  ,d8.ely AS ''Koulutuksen ELY-alue''
	  ,d8.avi AS ''Koulutuksen AVI-alue''
	  ,d9.sukupuoli AS Sukupuoli
	  ,d10.aikuisopiskelija AS ''Nuori opiskelija/aikuisopiskelija''
	  ,d11.lukukausiselite AS ''Aloituslukukausi''
	  ,d11.lukuvuosi AS ''Aloituslukuvuosi''
	  ,d11.vuosiselite AS Aloitusvuosi
	  ,d12.opiskelijan_olo AS ''Kirjoillaolo (tammi)''
	  ,d13.opiskelijan_olo AS ''Kirjoillaolo (syys)''
	  ,d14.kuntaryhma AS Kuntaryhmä
	  ,d15.jarjestamismuoto AS Järjestämismuoto
	  ,d15.koulutuslaji3 AS Koulutuslaji
	  ,d16.maa AS ''Kansalaisuus (maa)''
	  ,d16.maanosa AS ''Kansalaisuus (maanosa)''
	  ,d16.etamaa AS ''ETA-maan kansalainen''
	  ,d16.eumaa AS ''EU-maan kansalainen''
	  ,d17.kansalaisuus_versio1 AS ''Kansalaisuus (suomi/muu)''
	  ,d18.maa AS Syntymävaltio
	  ,d18.maanosa AS ''Syntymävaltio (maanosa)''
	  ,d19.kansalaisuus_versio1 AS ''Syntymävaltio (suomi/muu)''
	  ,d20.kieli AS Äidinkieli
	  ,d21.aidinkieli_versio3 AS ''Äidinkieli (suomi/muu)''
	  ,d22.koulutussektori AS Koulutussektori
	  ,d1.lahde_koodi

	  --Ruotsi
	  ,[tilastovuosi] AS Statistikår
      ,d2.koulutus_SV AS [Utbildningsbenämning]
	  ,d2.opintoala2002_SV AS [Studieområde]
	  ,d2.koulutusala2002_SV AS [Utbildningsområde]
	  ,d2.opintoala1995_SV AS [Utbildningsområde (1995)]
	  ,d2.koulutusala2002_SV AS [Utbildningsområde (2002)]
	  ,d2.koulutusaste2002_SV AS [Utbildningsnivå]
	  ,d3.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_SV AS [Sättet på vilket utbildningen ordnas]
	  ,d4.ammatillisen_koulutuksen_koulutuslaji_SV AS [Typ av examen]
	  ,d5.opetushallinnon_koulutus_SV AS Förvaltningsområde
	  ,d6.kieli_SV AS [Utbildningens språk]
	  ,d7.nuorten_aikuisten_koulutus_amm_SV AS [Ungdoms-/vuxenutbildning]
	  ,d8.maakunta_SV AS [Utbildningens landskap]
	  ,d8.ely_SV AS [Utbildningens NTM-område]
	  ,d8.avi_SV AS [Utbildningens RFV-område]
	  ,d9.sukupuoli_SV AS Kön
	  ,d10.aikuisopiskelija_SV AS [Ungdoms-/vuxenstuderande]
	  ,d11.lukukausiselite_SV AS [Begynnelsetermin]
	  ,d11.lukuvuosi AS [Begynnelseläsår]
	  ,d11.vuosiselite_SV AS Begynnelseår
	  ,d12.opiskelijan_olo_SV AS [Inskrivning (januari)]
	  ,d13.opiskelijan_olo_SV AS [Inskrivning (september)]
	  ,d14.kuntaryhma_SV AS Kommungruppen
	  ,d15.jarjestamismuoto_SV AS [Formen i vilken utbildningen ordnas]
	  ,d15.koulutuslaji3_SV AS Utbildningsslag
	  ,d16.maa_SV AS [Medborgarskap (land)]
	  ,d16.maanosa_SV AS [Medborgarskap (världsdel)]
	  ,d16.etamaa_SV AS [Medborgare i ett EES-land]
	  ,d16.eumaa_SV AS [Medborgare i ett EU-land]
	  ,d17.kansalaisuus_versio1_SV AS [Medborgarskap (finska/andra)]
	  ,d18.maa_SV AS Födelseland
	  ,d18.maanosa_SV AS [Födelseland (världsdel)]
	  ,d19.kansalaisuus_versio1_SV AS [Födelseland (Finland/andra)]
	  ,d20.kieli_SV AS Modersmål
	  ,d21.aidinkieli_versio3_SV AS [Modersmål (finska/andra)]
	  ,d22.koulutussektori_SV AS Utbildningssektor

	  --Englanti
	  ,[tilastovuosi] AS [Statistical year]
      ,d2.koulutus_EN AS [Name of education]
	  ,d2.opintoala2002_EN AS [Subfield of education]
	  ,d2.koulutusala2002_EN AS [Field of education]
	  ,d2.opintoala1995_EN AS [Field of education (1995)]
	  ,d2.koulutusala2002_EN AS [Field of education (2002)]
	  ,d2.koulutusaste2002_EN AS [Level of education]
	  ,d3.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_EN AS [Method of vocational education and training]
	  ,d4.ammatillisen_koulutuksen_koulutuslaji_EN AS [Qualification type]
	  ,d5.opetushallinnon_koulutus_EN AS [Administrative sector]
	  ,d6.kieli_EN AS [Language of education]
	  ,d7.nuorten_aikuisten_koulutus_amm_EN [Youth/adult education]
	  ,d8.maakunta_EN AS [Region of education]
	  ,d8.ely_EN AS [ELY area of education]
	  ,d8.avi_EN AS [AVI area of education]
	  ,d9.sukupuoli_EN AS Gender
	  ,d10.aikuisopiskelija_EN AS [Young person/adult student]
	  ,d11.lukukausiselite_EN AS [First term]
	  ,d11.lukuvuosi AS [First academic year]
	  ,d11.vuosiselite_EN AS [First year]
	  ,d12.opiskelijan_olo_EN AS [Enrollment status (January)]
	  ,d13.opiskelijan_olo_EN AS [Enrollment status (September)]
	  ,d14.kuntaryhma_EN AS [Municipality type]
	  ,d15.jarjestamismuoto_EN AS [Form of vocational education and training]
	  ,d15.koulutuslaji3_EN AS [Form of education and training]
	  ,d16.maa_EN AS [Nationality (country)]
	  ,d16.maanosa_EN AS [Nationality (continent)]
	  ,d16.etamaa_EN AS [Citizen of EEA nation]
	  ,d16.eumaa_EN AS [Citizen of EU nation]
	  ,d17.kansalaisuus_versio1_EN AS [Nationality (Finn/Other)]
	  ,d18.maa_EN AS [Country of birth]
	  ,d18.maanosa_EN AS [Country of birth (continent)]
	  ,d19.kansalaisuus_versio1_EN AS [Country of birth (Finland/Other)]
	  ,d20.kieli_EN AS [Mother tongue]
	  ,d21.aidinkieli_versio3_EN AS [Mother tongue (Finnish/Other)]
	  ,d22.koulutussektori_EN AS [Sector of education]

	  --isced
	  ,d2.iscle2011 as "Koulutusaste, taso 1"
	  ,d2.Koulutusaste_taso2 as "Koulutusaste, taso 2"
	  ,d2.iscfibroad2013 as "Koulutusala, taso 1"
	  ,d2.iscfinarrow2013 as "Koulutusala, taso 2"
	  ,d2.iscfi2013 as "Koulutusala, taso 3"
	  ,d2.OKM_ohjauksen_ala as "OKM ohjauksen ala, korkeak."
	  ,d2.iscle2011_SV as "Utbildn.nivå, nivå 1"
	  ,d2.Koulutusaste_taso2_SV as "Utbildn.nivå, nivå 2"
	  ,d2.iscfibroad2013_SV as "Utbildn.område, nivå 1"
	  ,d2.iscfinarrow2013_SV as "Utbildn.område, nivå 2"
	  ,d2.iscfi2013_SV as "Utbildn.område, nivå 3"
	  ,d2.OKM_ohjauksen_ala_SV as "UKM-styrningsområde, högskolor"
	  ,d2.iscle2011_EN as "Level of education, tier 1"
	  ,d2.Koulutusaste_taso2_EN as "Level of education, tier 2"
	  ,d2.iscfibroad2013_EN as "Field of education, tier 1"
	  ,d2.iscfinarrow2013_EN as "Field of education, tier 2"
	  ,d2.iscfi2013_EN as "Field of education, tier 3"
	  ,d2.OKM_ohjauksen_ala_EN as "Field of ed., HE steering"

	  --koodit
      ,d2.koulutus_koodi AS [Koodit Koulutusnimike]
	  ,d2.opintoala2002_koodi AS [Koodit Opintoala]
	  ,d2.koulutusala2002_koodi AS [Koodit Koulutusala]
	  ,d2.opintoala1995_koodi AS [Koodit Koulutusala (95 luokitus)]
	  ,d2.koulutusala2002_koodi AS [Koodit Koulutusala (02 luokitus)]
	  ,d8.maakunta AS [Koodit Koulutuksen maakunta]

	  --järjestys
	  ,d2.jarjestys AS jarj_koulnimike
	  ,d2.jarjestys_opintoala2002 AS jarj_opintoala
	  ,d2.jarjestys_koulutusala2002
	  ,d2.jarjestys_opintoala1995
	  ,d2.jarjestys_koulutusaste2002
	  ,d3.jarjestys AS jarj_jarjtapa
	  ,d4.jarjestys AS jarj_tutktyyppi
	  ,d5.jarjestys AS jarj_hallinnonala
	  ,d6.jarjestys AS jarj_opetuskieli
	  ,d7.jarjestys AS jarj_nuoretaikuiset
	  ,d8.jarjestys_maakunta
	  ,d8.jarjestys_ely
	  ,d8.jarjestys_avi
	  ,d9.jarjestys AS jarj_sukupuoli
	  ,d10.jarjestys AS jarj_nuoriaikuinen
	  ,d11.lukukausi AS jarj_lukukausi
	  ,d12.jarjestys AS jarj_kirjtammi
	  ,d13.jarjestys AS jarj_kirjsyys
	  ,d14.jarjestys AS jarj_kuntaryhma
	  ,d15.jarjestys_jarjestamismuoto AS jarj_jarjmuoto
	  ,d15.jarjestys_koulutuslaji3
	  ,d16.jarjestys AS jarj_maa
	  ,d16.jarjestys_maanosa
	  ,d16.jarjestys_etamaa
	  ,d16.jarjestys_eumaa
	  ,d17.jarjestys AS jarj_kans
	  ,d18.jarjestys AS jarj_syntvaltio
	  ,d18.jarjestys_maanosa AS jarj_syntmaanosa
	  ,d19.jarjestys AS jarj_syntsuomimuu
	  ,d20.jarjestys AS jarj_aidinkieli
	  ,d21.jarjestys AS jarj_aidinkielisuomi
	  ,d22.jarjestys AS jarj_koulsektori
	  ,d2.koulutusaste2002_koodi
	  ,[koulutuksen_aloittamislukuvuosi]
	  ,[Nakokulma] AS Aineistonäkökulma
	  ,d21.aidinkieli_versio3_koodi AS koodi_ai
	  ,d17.kansalaisuus_versio1_koodi AS koodi_kan
	  ,d19.kansalaisuus_versio1_koodi AS koodi_syn
	  ,d2.jarjestys_iscle2011 as jarj_isced_koulast1
	  ,d2.jarjestys_Koulutusaste_taso2 as jarj_isced_koulast2
	  ,d2.jarjestys_iscfibroad2013 as jarj_isced_koulala1
	  ,d2.jarjestys_iscfinarrow2013 as jarj_isced_koulala2
	  ,d2.jarjestys_iscfi2013 as jarj_isced_koulala3
	  ,d2.jarjestys_OKM_ohjauksen_ala as jarj_isced_okmohjaus1
FROM            dbo.f_ulkomaalaiset_maan_kansalaisuuden_aidinkielen_mukaan_2_13_14_15
	JOIN d_lahde d1 ON d1.id = [lahde_id]
	JOIN d_koulutusluokitus d2 on d2.id = [koulutusluokitus_id]
	JOIN d_opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus d3 on d3.id = [opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_id]
	JOIN d_ammatillisen_koulutuksen_koulutuslaji d4 on d4.id = [ammatillisen_koulutuksen_koulutuslaji_id]
	JOIN d_opetushallinnon_koulutus d5 on d5.id = [opetushallinnon_koulutus_id]
	JOIN d_kieli d6 on d6.id = [koulutuksen_opetuskieli_id]
	JOIN d_nuorten_aikuisten_koulutus_amm d7 on d7.id = [nuorten_aikuisten_koulutus_amm_id]
	JOIN d_alueluokitus d8 on d8.id = [koulutuksen_sijaintimaakunta_id]
	JOIN d_sukupuoli d9 on d9.id = [sukupuoli_id]
	JOIN d_aikuisopiskelija d10 on d10.id = [aikuisopiskelija_id]
	JOIN d_kausi d11 on d11.kausi_id = [koulutuksen_aloittamislukukausi_id]
	JOIN d_opiskelijan_olo d12 on d12.id = [kirjoillaolo_tammikuu_id]
	JOIN d_opiskelijan_olo d13 on d13.id = [kirjoillaolo_syyskuu_id]
	JOIN d_kuntaryhma d14 on d14.id = [kotikunnan_kuntaryhma_id]
	JOIN d_koulutuslaji3 d15 on d15.id = [koulutusryhma_koulutuslaji3_id]
	JOIN d_valtio d16 on d16.id = [kansalaisuus_maa_id]
	JOIN d_kansalaisuus_versio1 d17 on d17.id = [kansalaisuus_versio1_id]
	JOIN d_valtio d18 on d18.id = [syntymavaltio_maa_id]
	JOIN d_kansalaisuus_versio1 d19 on d19.id = [syntymavaltio_kansalaisuus_versio1_id]
	JOIN d_kieli d20 on d20.id = [aidinkieli_kieli_id]
	JOIN d_aidinkieli_versio3 d21 on d21.id = [aidinkieli_versio3_id]
	JOIN d_koulutussektori d22 on d22.id = [koulutussektori_id]
WHERE d13.opiskelijan_olo_koodi <> ''-1''
















' 
GO
/****** Object:  View [dbo].[v_f_tab_ulkomaalaiset_maan_kansalaisuuden_aidinkielen_mukaan_amk]    Script Date: 21.6.2017 10:17:26 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_ulkomaalaiset_maan_kansalaisuuden_aidinkielen_mukaan_amk]'))
EXEC dbo.sp_executesql @statement = N'

















CREATE VIEW [dbo].[v_f_tab_ulkomaalaiset_maan_kansalaisuuden_aidinkielen_mukaan_amk] AS
SELECT 
	   [opiskelijoiden_lkm] AS lkm_op2
	  ,CASE WHEN [tilastovuosi] = [koulutuksen_aloittamislukuvuosi] THEN [opiskelijoiden_lkm] ELSE 0 END AS lkm_aloit2
	  ,CASE WHEN d13.opiskelijan_olo_koodi = 1 THEN [opiskelijoiden_lkm] ELSE 0 END AS lkm_opiskolo2
	  ,[tilastovuosi] AS Tilastovuosi
	  ,[Nakokulma] AS Näkökulma
	  ,d1.lahde AS Lähde
      ,d2.koulutus AS [Koulutusnimike]
	  ,d2.opintoala2002 AS [Opintoala]
	  ,d2.koulutusala2002 AS [Koulutusala]
	  ,d2.opintoala1995 AS [Koulutusala (95 luokitus)]
	  ,d2.koulutusala2002 AS [Koulutusala (02 luokitus)]
	  ,d2.koulutusaste2002 AS [Koulutusaste]
	  ,d3.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus AS Järjestämistapa
	  ,d4.ammatillisen_koulutuksen_koulutuslaji AS Tutkintotyyppi
	  ,d5.opetushallinnon_koulutus AS Hallinnonala
	  ,d6.kieli AS Opetuskieli
	  ,d7.nuorten_aikuisten_koulutus_amm AS ''Nuorten koulutus/aikuiskoulutus''
	  ,d8.maakunta AS ''Koulutuksen maakunta''
	  ,d8.ely AS ''Koulutuksen ELY-alue''
	  ,d8.avi AS ''Koulutuksen AVI-alue''
	  ,d9.sukupuoli AS Sukupuoli
	  ,d10.aikuisopiskelija AS ''Nuori opiskelija/aikuisopiskelija''
	  ,d11.lukukausiselite AS ''Aloituslukukausi''
	  ,d11.lukuvuosi AS ''Aloituslukuvuosi''
	  ,d11.vuosiselite AS Aloitusvuosi
	  ,d12.opiskelijan_olo AS ''Kirjoillaolo (tammi)''
	  ,d13.opiskelijan_olo AS ''Kirjoillaolo (syys)''
	  ,d14.kuntaryhma AS Kuntaryhmä
	  ,d15.jarjestamismuoto AS Järjestämismuoto
	  ,d15.koulutuslaji3 AS Koulutuslaji
	  ,d16.maa AS ''Kansalaisuus (maa)''
	  ,d16.maanosa AS ''Kansalaisuus (maanosa)''
	  ,d16.etamaa AS ''ETA-maan kansalainen''
	  ,d16.eumaa AS ''EU-maan kansalainen''
	  ,d17.kansalaisuus_versio1 AS ''Kansalaisuus (suomi/muu)''
	  ,d18.maa AS Syntymävaltio
	  ,d18.maanosa AS ''Syntymävaltio (maanosa)''
	  ,d19.kansalaisuus_versio1 AS ''Syntymävaltio (suomi/muu)''
	  ,d20.kieli AS Äidinkieli
	  ,d21.aidinkieli_versio3 AS ''Äidinkieli (suomi/muu)''
	  ,d22.koulutussektori AS Koulutussektori
	  ,d1.lahde_koodi

	  --Ruotsi
	  ,[tilastovuosi] AS Statistikår
      ,d2.koulutus_SV AS [Utbildningsbenämning]
	  ,d2.opintoala2002_SV AS [Studieområde]
	  ,d2.koulutusala2002_SV AS [Utbildningsområde]
	  ,d2.opintoala1995_SV AS [Utbildningsområde (1995)]
	  ,d2.koulutusala2002_SV AS [Utbildningsområde (2002)]
	  ,d2.koulutusaste2002_SV AS [Utbildningsnivå]
	  ,d3.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_SV AS [Sättet på vilket utbildningen ordnas]
	  ,d4.ammatillisen_koulutuksen_koulutuslaji_SV AS [Typ av examen]
	  ,d5.opetushallinnon_koulutus_SV AS Förvaltningsområde
	  ,d6.kieli_SV AS [Utbildningens språk]
	  ,d7.nuorten_aikuisten_koulutus_amm_SV AS [Ungdoms-/vuxenutbildning]
	  ,d8.maakunta_SV AS [Utbildningens landskap]
	  ,d8.ely_SV AS [Utbildningens NTM-område]
	  ,d8.avi_SV AS [Utbildningens RFV-område]
	  ,d9.sukupuoli_SV AS Kön
	  ,d10.aikuisopiskelija_SV AS [Ungdoms-/vuxenstuderande]
	  ,d11.lukukausiselite_SV AS [Begynnelsetermin]
	  ,d11.lukuvuosi AS [Begynnelseläsår]
	  ,d11.vuosiselite_SV AS Begynnelseår
	  ,d12.opiskelijan_olo_SV AS [Inskrivning (januari)]
	  ,d13.opiskelijan_olo_SV AS [Inskrivning (september)]
	  ,d14.kuntaryhma_SV AS Kommungruppen
	  ,d15.jarjestamismuoto_SV AS [Formen i vilken utbildningen ordnas]
	  ,d15.koulutuslaji3_SV AS Utbildningsslag
	  ,d16.maa_SV AS [Medborgarskap (land)]
	  ,d16.maanosa_SV AS [Medborgarskap (världsdel)]
	  ,d16.etamaa_SV AS [Medborgare i ett EES-land]
	  ,d16.eumaa_SV AS [Medborgare i ett EU-land]
	  ,d17.kansalaisuus_versio1_SV AS [Medborgarskap (finska/andra)]
	  ,d18.maa_SV AS Födelseland
	  ,d18.maanosa_SV AS [Födelseland (världsdel)]
	  ,d19.kansalaisuus_versio1_SV AS [Födelseland (Finland/andra)]
	  ,d20.kieli_SV AS Modersmål
	  ,d21.aidinkieli_versio3_SV AS [Modersmål (finska/andra)]
	  ,d22.koulutussektori_SV AS Utbildningssektor

	  --Englanti
	  ,[tilastovuosi] AS [Statistical year]
      ,d2.koulutus_EN AS [Name of education]
	  ,d2.opintoala2002_EN AS [Subfield of education]
	  ,d2.koulutusala2002_EN AS [Field of education]
	  ,d2.opintoala1995_EN AS [Field of education (1995)]
	  ,d2.koulutusala2002_EN AS [Field of education (2002)]
	  ,d2.koulutusaste2002_EN AS [Level of education]
	  ,d3.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_EN AS [Method of vocational education and training]
	  ,d4.ammatillisen_koulutuksen_koulutuslaji_EN AS [Qualification type]
	  ,d5.opetushallinnon_koulutus_EN AS [Administrative sector]
	  ,d6.kieli_EN AS [Language of education]
	  ,d7.nuorten_aikuisten_koulutus_amm_EN [Youth/adult education]
	  ,d8.maakunta_EN AS [Region of education]
	  ,d8.ely_EN AS [ELY area of education]
	  ,d8.avi_EN AS [AVI area of education]
	  ,d9.sukupuoli_EN AS Gender
	  ,d10.aikuisopiskelija_EN AS [Young person/adult student]
	  ,d11.lukukausiselite_EN AS [First term]
	  ,d11.lukuvuosi AS [First academic year]
	  ,d11.vuosiselite_EN AS [First year]
	  ,d12.opiskelijan_olo_EN AS [Enrollment status (January)]
	  ,d13.opiskelijan_olo_EN AS [Enrollment status (September)]
	  ,d14.kuntaryhma_EN AS [Municipality type]
	  ,d15.jarjestamismuoto_EN AS [Form of vocational education and training]
	  ,d15.koulutuslaji3_EN AS [Form of education and training]
	  ,d16.maa_EN AS [Nationality (country)]
	  ,d16.maanosa_EN AS [Nationality (continent)]
	  ,d16.etamaa_EN AS [Citizen of EEA nation]
	  ,d16.eumaa_EN AS [Citizen of EU nation]
	  ,d17.kansalaisuus_versio1_EN AS [Nationality (Finn/Other)]
	  ,d18.maa_EN AS [Country of birth]
	  ,d18.maanosa_EN AS [Country of birth (continent)]
	  ,d19.kansalaisuus_versio1_EN AS [Country of birth (Finland/Other)]
	  ,d20.kieli_EN AS [Mother tongue]
	  ,d21.aidinkieli_versio3_EN AS [Mother tongue (Finnish/Other)]
	  ,d22.koulutussektori_EN AS [Sector of education]

	  --isced
	  ,d2.iscle2011 as "Koulutusaste, taso 1"
	  ,d2.Koulutusaste_taso2 as "Koulutusaste, taso 2"
	  ,d2.iscfibroad2013 as "Koulutusala, taso 1"
	  ,d2.iscfinarrow2013 as "Koulutusala, taso 2"
	  ,d2.iscfi2013 as "Koulutusala, taso 3"
	  ,d2.OKM_ohjauksen_ala as "OKM ohjauksen ala, korkeak."
	  ,d2.iscle2011_SV as "Utbildn.nivå, nivå 1"
	  ,d2.Koulutusaste_taso2_SV as "Utbildn.nivå, nivå 2"
	  ,d2.iscfibroad2013_SV as "Utbildn.område, nivå 1"
	  ,d2.iscfinarrow2013_SV as "Utbildn.område, nivå 2"
	  ,d2.iscfi2013_SV as "Utbildn.område, nivå 3"
	  ,d2.OKM_ohjauksen_ala_SV as "UKM-styrningsområde, högskolor"
	  ,d2.iscle2011_EN as "Level of education, tier 1"
	  ,d2.Koulutusaste_taso2_EN as "Level of education, tier 2"
	  ,d2.iscfibroad2013_EN as "Field of education, tier 1"
	  ,d2.iscfinarrow2013_EN as "Field of education, tier 2"
	  ,d2.iscfi2013_EN as "Field of education, tier 3"
	  ,d2.OKM_ohjauksen_ala_EN as "Field of ed., HE steering"

	  --koodit
      ,d2.koulutus_koodi AS [Koodit Koulutusnimike]
	  ,d2.opintoala2002_koodi AS [Koodit Opintoala]
	  ,d2.koulutusala2002_koodi AS [Koodit Koulutusala]
	  ,d2.opintoala1995_koodi AS [Koodit Koulutusala (95 luokitus)]
	  ,d2.koulutusala2002_koodi AS [Koodit Koulutusala (02 luokitus)]
	  ,d8.maakunta AS [Koodit Koulutuksen maakunta]

	  --järjestys
	  ,d2.jarjestys AS jarj_koulnimike
	  ,d2.jarjestys_opintoala2002 AS jarj_opintoala
	  ,d2.jarjestys_koulutusala2002
	  ,d2.jarjestys_opintoala1995
	  ,d2.jarjestys_koulutusaste2002
	  ,d3.jarjestys AS jarj_jarjtapa
	  ,d4.jarjestys AS jarj_tutktyyppi
	  ,d5.jarjestys AS jarj_hallinnonala
	  ,d6.jarjestys AS jarj_opetuskieli
	  ,d7.jarjestys AS jarj_nuoretaikuiset
	  ,d8.jarjestys_maakunta
	  ,d8.jarjestys_ely
	  ,d8.jarjestys_avi
	  ,d9.jarjestys AS jarj_sukupuoli
	  ,d10.jarjestys AS jarj_nuoriaikuinen
	  ,d11.lukukausi AS jarj_lukukausi
	  ,d12.jarjestys AS jarj_kirjtammi
	  ,d13.jarjestys AS jarj_kirjsyys
	  ,d14.jarjestys AS jarj_kuntaryhma
	  ,d15.jarjestys_jarjestamismuoto AS jarj_jarjmuoto
	  ,d15.jarjestys_koulutuslaji3
	  ,d16.jarjestys AS jarj_maa
	  ,d16.jarjestys_maanosa
	  ,d16.jarjestys_etamaa
	  ,d16.jarjestys_eumaa
	  ,d17.jarjestys AS jarj_kans
	  ,d18.jarjestys AS jarj_syntvaltio
	  ,d18.jarjestys_maanosa AS jarj_syntmaanosa
	  ,d19.jarjestys AS jarj_syntsuomimuu
	  ,d20.jarjestys AS jarj_aidinkieli
	  ,d21.jarjestys AS jarj_aidinkielisuomi
	  ,d22.jarjestys AS jarj_koulsektori
	  ,d2.koulutusaste2002_koodi
	  ,[koulutuksen_aloittamislukuvuosi]
	  ,[Nakokulma] AS Aineistonäkökulma
	  ,d21.aidinkieli_versio3_koodi AS koodi_ai
	  ,d17.kansalaisuus_versio1_koodi AS koodi_kan
	  ,d19.kansalaisuus_versio1_koodi AS koodi_syn
	  ,d2.jarjestys_iscle2011 as jarj_isced_koulast1
	  ,d2.jarjestys_Koulutusaste_taso2 as jarj_isced_koulast2
	  ,d2.jarjestys_iscfibroad2013 as jarj_isced_koulala1
	  ,d2.jarjestys_iscfinarrow2013 as jarj_isced_koulala2
	  ,d2.jarjestys_iscfi2013 as jarj_isced_koulala3
	  ,d2.jarjestys_OKM_ohjauksen_ala as jarj_isced_okmohjaus1
FROM            dbo.f_ulkomaalaiset_maan_kansalaisuuden_aidinkielen_mukaan_2_13_14_15
	JOIN d_lahde d1 ON d1.id = [lahde_id]
	JOIN d_koulutusluokitus d2 on d2.id = [koulutusluokitus_id]
	JOIN d_opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus d3 on d3.id = [opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_id]
	JOIN d_ammatillisen_koulutuksen_koulutuslaji d4 on d4.id = [ammatillisen_koulutuksen_koulutuslaji_id]
	JOIN d_opetushallinnon_koulutus d5 on d5.id = [opetushallinnon_koulutus_id]
	JOIN d_kieli d6 on d6.id = [koulutuksen_opetuskieli_id]
	JOIN d_nuorten_aikuisten_koulutus_amm d7 on d7.id = [nuorten_aikuisten_koulutus_amm_id]
	JOIN d_alueluokitus d8 on d8.id = [koulutuksen_sijaintimaakunta_id]
	JOIN d_sukupuoli d9 on d9.id = [sukupuoli_id]
	JOIN d_aikuisopiskelija d10 on d10.id = [aikuisopiskelija_id]
	JOIN d_kausi d11 on d11.kausi_id = [koulutuksen_aloittamislukukausi_id]
	JOIN d_opiskelijan_olo d12 on d12.id = [kirjoillaolo_tammikuu_id]
	JOIN d_opiskelijan_olo d13 on d13.id = [kirjoillaolo_syyskuu_id]
	JOIN d_kuntaryhma d14 on d14.id = [kotikunnan_kuntaryhma_id]
	JOIN d_koulutuslaji3 d15 on d15.id = [koulutusryhma_koulutuslaji3_id]
	JOIN d_valtio d16 on d16.id = [kansalaisuus_maa_id]
	JOIN d_kansalaisuus_versio1 d17 on d17.id = [kansalaisuus_versio1_id]
	JOIN d_valtio d18 on d18.id = [syntymavaltio_maa_id]
	JOIN d_kansalaisuus_versio1 d19 on d19.id = [syntymavaltio_kansalaisuus_versio1_id]
	JOIN d_kieli d20 on d20.id = [aidinkieli_kieli_id]
	JOIN d_aidinkieli_versio3 d21 on d21.id = [aidinkieli_versio3_id]
	JOIN d_koulutussektori d22 on d22.id = [koulutussektori_id]
WHERE koulutusaste2002_koodi in (62,71) AND d13.opiskelijan_olo_koodi <> ''-1'' AND d2.koulutusala2002_koodi <> ''9''















' 
GO
/****** Object:  View [dbo].[v_f_tab_ulkomaalaiset_maan_kansalaisuuden_aidinkielen_mukaan_amm]    Script Date: 21.6.2017 10:17:26 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_ulkomaalaiset_maan_kansalaisuuden_aidinkielen_mukaan_amm]'))
EXEC dbo.sp_executesql @statement = N'



















CREATE VIEW [dbo].[v_f_tab_ulkomaalaiset_maan_kansalaisuuden_aidinkielen_mukaan_amm] AS
SELECT 
	     [opiskelijoiden_lkm] AS lkm_op2
	  ,CASE WHEN [tilastovuosi] = [koulutuksen_aloittamislukuvuosi] THEN [opiskelijoiden_lkm] ELSE 0 END AS lkm_aloit2
	  ,CASE WHEN d13.opiskelijan_olo_koodi = 1 THEN [opiskelijoiden_lkm] ELSE 0 END AS lkm_opiskolo2
	  ,[tilastovuosi] AS Tilastovuosi
	  ,[Nakokulma] AS Näkökulma
	  ,d1.lahde AS Lähde
      ,d2.koulutus AS [Koulutusnimike]
	  ,d2.opintoala2002 AS [Opintoala]
	  ,d2.koulutusala2002 AS [Koulutusala]
	  ,d2.opintoala1995 AS [Koulutusala (95 luokitus)]
	  ,d2.koulutusala2002 AS [Koulutusala (02 luokitus)]
	  --,d2.koulutusaste2002 AS [Koulutusaste]
	  ,d3.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus AS Järjestämistapa
	  ,d4.ammatillisen_koulutuksen_koulutuslaji AS Tutkintotyyppi
	  ,d5.opetushallinnon_koulutus AS Hallinnonala
	  ,d6.kieli AS Opetuskieli
	  ,d7.nuorten_aikuisten_koulutus_amm AS ''Nuorten koulutus/aikuiskoulutus''
	  ,d8.maakunta AS ''Koulutuksen maakunta''
	  ,d8.ely AS ''Koulutuksen ELY-alue''
	  ,d8.avi AS ''Koulutuksen AVI-alue''
	  ,d9.sukupuoli AS Sukupuoli
	  ,d10.aikuisopiskelija AS ''Nuori opiskelija/aikuisopiskelija''
	  ,d11.lukukausiselite AS ''Aloituslukukausi''
	  ,d11.lukuvuosi AS ''Aloituslukuvuosi''
	  ,d11.vuosiselite AS Aloitusvuosi
	  ,d12.opiskelijan_olo AS ''Kirjoillaolo (tammi)''
	  ,d13.opiskelijan_olo AS ''Kirjoillaolo (syys)''
	  ,d14.kuntaryhma AS Kuntaryhmä
	  ,d15.jarjestamismuoto AS Järjestämismuoto
	  ,d15.koulutuslaji3 AS Koulutuslaji
	  ,d16.maa AS ''Kansalaisuus (maa)''
	  ,d16.maanosa AS ''Kansalaisuus (maanosa)''
	  ,d16.etamaa AS ''ETA-maan kansalainen''
	  ,d16.eumaa AS ''EU-maan kansalainen''
	  ,d17.kansalaisuus_versio1 AS ''Kansalaisuus (suomi/muu)''
	  ,d18.maa AS Syntymävaltio
	  ,d18.maanosa AS ''Syntymävaltio (maanosa)''
	  ,d19.kansalaisuus_versio1 AS ''Syntymävaltio (suomi/muu)''
	  ,d20.kieli AS Äidinkieli
	  ,d21.aidinkieli_versio3 AS ''Äidinkieli (suomi/muu)''
	  --,d22.koulutussektori AS Koulutussektori
	  ,d1.lahde_koodi

	  --Ruotsi
	  ,[tilastovuosi] AS Statistikår
      ,d2.koulutus_SV AS [Utbildningsbenämning]
	  ,d2.opintoala2002_SV AS [Studieområde]
	  ,d2.koulutusala2002_SV AS [Utbildningsområde]
	  ,d2.opintoala1995_SV AS [Utbildningsområde (1995)]
	  ,d2.koulutusala2002_SV AS [Utbildningsområde (2002)]
	  --,d2.koulutusaste2002_SV AS [Utbildningsnivå]
	  ,d3.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_SV AS [Sättet på vilket utbildningen ordnas]
	  ,d4.ammatillisen_koulutuksen_koulutuslaji_SV AS [Typ av examen]
	  ,d5.opetushallinnon_koulutus_SV AS Förvaltningsområde
	  ,d6.kieli_SV AS [Utbildningens språk]
	  ,d7.nuorten_aikuisten_koulutus_amm_SV AS [Ungdoms-/vuxenutbildning]
	  ,d8.maakunta_SV AS [Utbildningens landskap]
	  ,d8.ely_SV AS [Utbildningens NTM-område]
	  ,d8.avi_SV AS [Utbildningens RFV-område]
	  ,d9.sukupuoli_SV AS Kön
	  ,d10.aikuisopiskelija_SV AS [Ungdoms-/vuxenstuderande]
	  ,d11.lukukausiselite_SV AS [Begynnelsetermin]
	  ,d11.lukuvuosi AS [Begynnelseläsår]
	  ,d11.vuosiselite_SV AS Begynnelseår
	  ,d12.opiskelijan_olo_SV AS [Inskrivning (januari)]
	  ,d13.opiskelijan_olo_SV AS [Inskrivning (september)]
	  ,d14.kuntaryhma_SV AS Kommungruppen
	  ,d15.jarjestamismuoto_SV AS [Formen i vilken utbildningen ordnas]
	  ,d15.koulutuslaji3_SV AS Utbildningsslag
	  ,d16.maa_SV AS [Medborgarskap (land)]
	  ,d16.maanosa_SV AS [Medborgarskap (världsdel)]
	  ,d16.etamaa_SV AS [Medborgare i ett EES-land]
	  ,d16.eumaa_SV AS [Medborgare i ett EU-land]
	  ,d17.kansalaisuus_versio1_SV AS [Medborgarskap (finska/andra)]
	  ,d18.maa_SV AS Födelseland
	  ,d18.maanosa_SV AS [Födelseland (världsdel)]
	  ,d19.kansalaisuus_versio1_SV AS [Födelseland (Finland/andra)]
	  ,d20.kieli_SV AS Modersmål
	  ,d21.aidinkieli_versio3_SV AS [Modersmål (finska/andra)]
	  --,d22.koulutussektori_SV AS Utbildningssektor

	  --Englanti
	  ,[tilastovuosi] AS [Statistical year]
      ,d2.koulutus_EN AS [Name of education]
	  ,d2.opintoala2002_EN AS [Subfield of education]
	  ,d2.koulutusala2002_EN AS [Field of education]
	  ,d2.opintoala1995_EN AS [Field of education (1995)]
	  ,d2.koulutusala2002_EN AS [Field of education (2002)]
	  --,d2.koulutusaste2002_EN AS [Level of education]
	  ,d3.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_EN AS [Method of vocational education and training]
	  ,d4.ammatillisen_koulutuksen_koulutuslaji_EN AS [Qualification type]
	  ,d5.opetushallinnon_koulutus_EN AS [Administrative sector]
	  ,d6.kieli_EN AS [Language of education]
	  ,d7.nuorten_aikuisten_koulutus_amm_EN [Youth/adult education]
	  ,d8.maakunta_EN AS [Region of education]
	  ,d8.ely_EN AS [ELY area of education]
	  ,d8.avi_EN AS [AVI area of education]
	  ,d9.sukupuoli_EN AS Gender
	  ,d10.aikuisopiskelija_EN AS [Young person/adult student]
	  ,d11.lukukausiselite_EN AS [First term]
	  ,d11.lukuvuosi AS [First academic year]
	  ,d11.vuosiselite_EN AS [First year]
	  ,d12.opiskelijan_olo_EN AS [Enrollment status (January)]
	  ,d13.opiskelijan_olo_EN AS [Enrollment status (September)]
	  ,d14.kuntaryhma_EN AS [Municipality type]
	  ,d15.jarjestamismuoto_EN AS [Form of vocational education and training]
	  ,d15.koulutuslaji3_EN AS [Form of education and training]
	  ,d16.maa_EN AS [Nationality (country)]
	  ,d16.maanosa_EN AS [Nationality (continent)]
	  ,d16.etamaa_EN AS [Citizen of EEA nation]
	  ,d16.eumaa_EN AS [Citizen of EU nation]
	  ,d17.kansalaisuus_versio1_EN AS [Nationality (Finn/Other)]
	  ,d18.maa_EN AS [Country of birth]
	  ,d18.maanosa_EN AS [Country of birth (continent)]
	  ,d19.kansalaisuus_versio1_EN AS [Country of birth (Finland/Other)]
	  ,d20.kieli_EN AS [Mother tongue]
	  ,d21.aidinkieli_versio3_EN AS [Mother tongue (Finnish/Other)]
	  --,d22.koulutussektori_EN AS [Sector of education]

	  --isced
	  ,d2.iscle2011 as "Koulutusaste, taso 1"
	  ,d2.Koulutusaste_taso2 as "Koulutusaste, taso 2"
	  ,d2.iscfibroad2013 as "Koulutusala, taso 1"
	  ,d2.iscfinarrow2013 as "Koulutusala, taso 2"
	  ,d2.iscfi2013 as "Koulutusala, taso 3"
	  ,d2.OKM_ohjauksen_ala as "OKM ohjauksen ala, korkeak."
	  ,d2.iscle2011_SV as "Utbildn.nivå, nivå 1"
	  ,d2.Koulutusaste_taso2_SV as "Utbildn.nivå, nivå 2"
	  ,d2.iscfibroad2013_SV as "Utbildn.område, nivå 1"
	  ,d2.iscfinarrow2013_SV as "Utbildn.område, nivå 2"
	  ,d2.iscfi2013_SV as "Utbildn.område, nivå 3"
	  ,d2.OKM_ohjauksen_ala_SV as "UKM-styrningsområde, högskolor"
	  ,d2.iscle2011_EN as "Level of education, tier 1"
	  ,d2.Koulutusaste_taso2_EN as "Level of education, tier 2"
	  ,d2.iscfibroad2013_EN as "Field of education, tier 1"
	  ,d2.iscfinarrow2013_EN as "Field of education, tier 2"
	  ,d2.iscfi2013_EN as "Field of education, tier 3"
	  ,d2.OKM_ohjauksen_ala_EN as "Field of ed., HE steering"

	  --koodit
      ,d2.koulutus_koodi AS [Koodit Koulutusnimike]
	  ,d2.opintoala2002_koodi AS [Koodit Opintoala]
	  ,d2.koulutusala2002_koodi AS [Koodit Koulutusala]
	  ,d2.opintoala1995_koodi AS [Koodit Koulutusala (95 luokitus)]
	  ,d2.koulutusala2002_koodi AS [Koodit Koulutusala (02 luokitus)]
	  ,d8.maakunta AS [Koodit Koulutuksen maakunta]

	  --järjestys
	  ,d2.jarjestys AS jarj_koulnimike
	  ,d2.jarjestys_opintoala2002 AS jarj_opintoala
	  ,d2.jarjestys_koulutusala2002
	  ,d2.jarjestys_opintoala1995
	  ,d2.jarjestys_koulutusaste2002
	  ,d3.jarjestys AS jarj_jarjtapa
	  ,d4.jarjestys AS jarj_tutktyyppi
	  ,d5.jarjestys AS jarj_hallinnonala
	  ,d6.jarjestys AS jarj_opetuskieli
	  ,d7.jarjestys AS jarj_nuoretaikuiset
	  ,d8.jarjestys_maakunta
	  ,d8.jarjestys_ely
	  ,d8.jarjestys_avi
	  ,d9.jarjestys AS jarj_sukupuoli
	  ,d10.jarjestys AS jarj_nuoriaikuinen
	  ,d11.lukukausi AS jarj_lukukausi
	  ,d12.jarjestys AS jarj_kirjtammi
	  ,d13.jarjestys AS jarj_kirjsyys
	  ,d14.jarjestys AS jarj_kuntaryhma
	  ,d15.jarjestys_jarjestamismuoto AS jarj_jarjmuoto
	  ,d15.jarjestys_koulutuslaji3
	  ,d16.jarjestys AS jarj_maa
	  ,d16.jarjestys_maanosa
	  ,d16.jarjestys_etamaa
	  ,d16.jarjestys_eumaa
	  ,d17.jarjestys AS jarj_kans
	  ,d18.jarjestys AS jarj_syntvaltio
	  ,d18.jarjestys_maanosa AS jarj_syntmaanosa
	  ,d19.jarjestys AS jarj_syntsuomimuu
	  ,d20.jarjestys AS jarj_aidinkieli
	  ,d21.jarjestys AS jarj_aidinkielisuomi
	  --,d22.jarjestys AS jarj_koulsektori
	  ,d2.koulutusaste2002_koodi
	  ,[koulutuksen_aloittamislukuvuosi]
	  ,[Nakokulma] AS Aineistonäkökulma
	  ,d21.aidinkieli_versio3_koodi AS koodi_ai
	  ,d17.kansalaisuus_versio1_koodi AS koodi_kan
	  ,d19.kansalaisuus_versio1_koodi AS koodi_syn
	  ,d2.jarjestys_iscle2011 as jarj_isced_koulast1
	  ,d2.jarjestys_Koulutusaste_taso2 as jarj_isced_koulast2
	  ,d2.jarjestys_iscfibroad2013 as jarj_isced_koulala1
	  ,d2.jarjestys_iscfinarrow2013 as jarj_isced_koulala2
	  ,d2.jarjestys_iscfi2013 as jarj_isced_koulala3
	  ,d2.jarjestys_OKM_ohjauksen_ala as jarj_isced_okmohjaus1
FROM            dbo.f_ulkomaalaiset_maan_kansalaisuuden_aidinkielen_mukaan_2_13_14_15
	JOIN d_lahde d1 ON d1.id = [lahde_id]
	JOIN d_koulutusluokitus d2 on d2.id = [koulutusluokitus_id]
	JOIN d_opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus d3 on d3.id = [opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_id]
	JOIN d_ammatillisen_koulutuksen_koulutuslaji d4 on d4.id = [ammatillisen_koulutuksen_koulutuslaji_id]
	JOIN d_opetushallinnon_koulutus d5 on d5.id = [opetushallinnon_koulutus_id]
	JOIN d_kieli d6 on d6.id = [koulutuksen_opetuskieli_id]
	JOIN d_nuorten_aikuisten_koulutus_amm d7 on d7.id = [nuorten_aikuisten_koulutus_amm_id]
	JOIN d_alueluokitus d8 on d8.id = [koulutuksen_sijaintimaakunta_id]
	JOIN d_sukupuoli d9 on d9.id = [sukupuoli_id]
	JOIN d_aikuisopiskelija d10 on d10.id = [aikuisopiskelija_id]
	JOIN d_kausi d11 on d11.kausi_id = [koulutuksen_aloittamislukukausi_id]
	JOIN d_opiskelijan_olo d12 on d12.id = [kirjoillaolo_tammikuu_id]
	JOIN d_opiskelijan_olo d13 on d13.id = [kirjoillaolo_syyskuu_id]
	JOIN d_kuntaryhma d14 on d14.id = [kotikunnan_kuntaryhma_id]
	JOIN d_koulutuslaji3 d15 on d15.id = [koulutusryhma_koulutuslaji3_id]
	JOIN d_valtio d16 on d16.id = [kansalaisuus_maa_id]
	JOIN d_kansalaisuus_versio1 d17 on d17.id = [kansalaisuus_versio1_id]
	JOIN d_valtio d18 on d18.id = [syntymavaltio_maa_id]
	JOIN d_kansalaisuus_versio1 d19 on d19.id = [syntymavaltio_kansalaisuus_versio1_id]
	JOIN d_kieli d20 on d20.id = [aidinkieli_kieli_id]
	JOIN d_aidinkieli_versio3 d21 on d21.id = [aidinkieli_versio3_id]
	--JOIN d_koulutussektori d22 on d22.id = [koulutussektori_id]
WHERE koulutusaste2002_koodi = 32 AND d13.opiskelijan_olo_koodi <> ''-1''

















' 
GO
/****** Object:  View [dbo].[v_f_tab_ulkomaalaiset_maan_kansalaisuuden_aidinkielen_mukaan_lukio]    Script Date: 21.6.2017 10:17:26 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_ulkomaalaiset_maan_kansalaisuuden_aidinkielen_mukaan_lukio]'))
EXEC dbo.sp_executesql @statement = N'


















CREATE VIEW [dbo].[v_f_tab_ulkomaalaiset_maan_kansalaisuuden_aidinkielen_mukaan_lukio] AS
SELECT 
  [opiskelijoiden_lkm] AS lkm_op2
	  ,CASE WHEN [tilastovuosi] = [koulutuksen_aloittamislukuvuosi] THEN [opiskelijoiden_lkm] ELSE 0 END AS lkm_aloit2
	  ,CASE WHEN d13.opiskelijan_olo_koodi = 1 THEN [opiskelijoiden_lkm] ELSE 0 END AS lkm_opiskolo2
	  ,[tilastovuosi] AS Tilastovuosi
	  ,[Nakokulma] AS Näkökulma
	  ,d1.lahde AS Lähde
      ,d2.koulutus AS [Koulutusnimike]
	  --,d2.opintoala2002 AS [Opintoala]
	  --,d2.koulutusala2002 AS [Koulutusala]
	  --,d2.opintoala1995 AS [Koulutusala (95 luokitus)]
	  --,d2.koulutusala2002 AS [Koulutusala (02 luokitus)]
	  --,d2.koulutusaste2002 AS [Koulutusaste]
	  --,d3.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus AS Järjestämistapa
	  --,d4.ammatillisen_koulutuksen_koulutuslaji AS Tutkintotyyppi
	  --,d5.opetushallinnon_koulutus AS Hallinnonala
	  ,d6.kieli AS ''Opetuskieli''
	  --,d7.nuorten_aikuisten_koulutus_amm AS ''Nuorten koulutus/aikuiskoulutus''
	  ,d8.maakunta AS ''Koulutuksen maakunta''
	  ,d8.ely AS ''Koulutuksen ELY-alue''
	  ,d8.avi AS ''Koulutuksen AVI-alue''
	  ,d9.sukupuoli AS Sukupuoli
	  --,d10.aikuisopiskelija AS ''Nuori opiskelija/aikuisopiskelija''
	  ,d11.lukukausiselite AS ''Aloituslukukausi''
	  ,d11.lukuvuosi AS ''Aloituslukuvuosi''
	  ,d11.vuosiselite AS Aloitusvuosi
	  ,d12.opiskelijan_olo AS ''Kirjoillaolo (tammi)''
	  ,d13.opiskelijan_olo AS ''Kirjoillaolo (syys)''
	  ,d14.kuntaryhma AS Kuntaryhmä
	  ,d15.jarjestamismuoto AS Järjestämismuoto
	  ,d15.koulutuslaji3 AS Koulutuslaji
	  ,d16.maa AS ''Kansalaisuus (maa)''
	  ,d16.maanosa AS ''Kansalaisuus (maanosa)''
	  ,d16.etamaa AS ''ETA-maan kansalainen''
	  ,d16.eumaa AS ''EU-maan kansalainen''
	  ,d17.kansalaisuus_versio1 AS ''Kansalaisuus (suomi/muu)''
	  ,d18.maa AS Syntymävaltio
	  ,d18.maanosa AS ''Syntymävaltio (maanosa)''
	  ,d19.kansalaisuus_versio1 AS ''Syntymävaltio (suomi/muu)''
	  ,d20.kieli AS Äidinkieli
	  ,d21.aidinkieli_versio3 AS ''Äidinkieli (suomi/muu)''
	  --,d22.koulutussektori AS Koulutussektori
	  ,d1.lahde_koodi

	  --Ruotsi
	  ,[tilastovuosi] AS Statistikår
      ,d2.koulutus_SV AS [Utbildningsbenämning]
	  --,d2.opintoala2002_SV AS [Studieområde]
	  --,d2.koulutusala2002_SV AS [Utbildningsområde]
	  --,d2.opintoala1995_SV AS [Utbildningsområde (1995)]
	  --,d2.koulutusala2002_SV AS [Utbildningsområde (2002)]
	  --,d2.koulutusaste2002_SV AS [Utbildningsnivå]
	  --,d3.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_SV AS [Sättet på vilket utbildningen ordnas]
	  --,d4.ammatillisen_koulutuksen_koulutuslaji_SV AS [Typ av examen]
	  --,d5.opetushallinnon_koulutus_SV AS Förvaltningsområde
	  ,d6.kieli_SV AS [Utbildningens språk]
	  --,d7.nuorten_aikuisten_koulutus_amm_SV AS [Ungdoms-/vuxenutbildning]
	  ,d8.maakunta_SV AS [Utbildningens landskap]
	  ,d8.ely_SV AS [Utbildningens NTM-område]
	  ,d8.avi_SV AS [Utbildningens RFV-område]
	  ,d9.sukupuoli_SV AS Kön
	  --,d10.aikuisopiskelija_SV AS [Ungdoms-/vuxenstuderande]
	  ,d11.lukukausiselite_SV AS [Begynnelsetermin]
	  ,d11.lukuvuosi AS [Begynnelseläsår]
	  ,d11.vuosiselite_SV AS Begynnelseår
	  ,d12.opiskelijan_olo_SV AS [Inskrivning (januari)]
	  ,d13.opiskelijan_olo_SV AS [Inskrivning (september)]
	  ,d14.kuntaryhma_SV AS Kommungruppen
	  ,d15.jarjestamismuoto_SV AS [Formen i vilken utbildningen ordnas]
	  ,d15.koulutuslaji3_SV AS Utbildningsslag
	  ,d16.maa_SV AS [Medborgarskap (land)]
	  ,d16.maanosa_SV AS [Medborgarskap (världsdel)]
	  ,d16.etamaa_SV AS [Medborgare i ett EES-land]
	  ,d16.eumaa_SV AS [Medborgare i ett EU-land]
	  ,d17.kansalaisuus_versio1_SV AS [Medborgarskap (finska/andra)]
	  ,d18.maa_SV AS Födelseland
	  ,d18.maanosa_SV AS [Födelseland (världsdel)]
	  ,d19.kansalaisuus_versio1_SV AS [Födelseland (Finland/andra)]
	  ,d20.kieli_SV AS Modersmål
	  ,d21.aidinkieli_versio3_SV AS [Modersmål (finska/andra)]
	  --,d22.koulutussektori_SV AS Utbildningssektor

	  --Englanti
	  ,[tilastovuosi] AS [Statistical year]
      ,d2.koulutus_EN AS [Name of education]
	  --,d2.opintoala2002_EN AS [Subfield of education]
	  --,d2.koulutusala2002_EN AS [Field of education]
	  --,d2.opintoala1995_EN AS [Field of education (1995)]
	  --,d2.koulutusala2002_EN AS [Field of education (2002)]
	  --,d2.koulutusaste2002_EN AS [Level of education]
	  --,d3.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_EN AS [Method of vocational education and training]
	  --,d4.ammatillisen_koulutuksen_koulutuslaji_EN AS [Qualification type]
	  --,d5.opetushallinnon_koulutus_EN AS [Administrative sector]
	  ,d6.kieli_EN AS [Language of education]
	  --,d7.nuorten_aikuisten_koulutus_amm_EN [Youth/adult education]
	  ,d8.maakunta_EN AS [Region of education]
	  ,d8.ely_EN AS [ELY area of education]
	  ,d8.avi_EN AS [AVI area of education]
	  ,d9.sukupuoli_EN AS Gender
	  --,d10.aikuisopiskelija_EN AS [Young person/adult student]
	  ,d11.lukukausiselite_EN AS [First term]
	  ,d11.lukuvuosi AS [First academic year]
	  ,d11.vuosiselite_EN AS [First year]
	  ,d12.opiskelijan_olo_EN AS [Enrollment status (January)]
	  ,d13.opiskelijan_olo_EN AS [Enrollment status (September)]
	  ,d14.kuntaryhma_EN AS [Municipality type]
	  ,d15.jarjestamismuoto_EN AS [Form of vocational education and training]
	  ,d15.koulutuslaji3_EN AS [Form of education and training]
	  ,d16.maa_EN AS [Nationality (country)]
	  ,d16.maanosa_EN AS [Nationality (continent)]
	  ,d16.etamaa_EN AS [Citizen of EEA nation]
	  ,d16.eumaa_EN AS [Citizen of EU nation]
	  ,d17.kansalaisuus_versio1_EN AS [Nationality (Finn/Other)]
	  ,d18.maa_EN AS [Country of birth]
	  ,d18.maanosa_EN AS [Country of birth (continent)]
	  ,d19.kansalaisuus_versio1_EN AS [Country of birth (Finland/Other)]
	  ,d20.kieli_EN AS [Mother tongue]
	  ,d21.aidinkieli_versio3_EN AS [Mother tongue (Finnish/Other)]
	  --,d22.koulutussektori_EN AS [Sector of education]

	  --isced
	  --,d2.iscle2011 as "Koulutusaste, taso 1"
	  --,d2.Koulutusaste_taso2 as "Koulutusaste, taso 2"
	  --,d2.iscfibroad2013 as "Koulutusala, taso 1"
	  --,d2.iscfinarrow2013 as "Koulutusala, taso 2"
	  --,d2.iscfi2013 as "Koulutusala, taso 3"
	  --,d2.OKM_ohjauksen_ala as "OKM ohjauksen ala, korkeak."
	  --,d2.iscle2011_SV as "Utbildn.nivå, nivå 1"
	  --,d2.Koulutusaste_taso2_SV as "Utbildn.nivå, nivå 2"
	  --,d2.iscfibroad2013_SV as "Utbildn.område, nivå 1"
	  --,d2.iscfinarrow2013_SV as "Utbildn.område, nivå 2"
	  --,d2.iscfi2013_SV as "Utbildn.område, nivå 3"
	  --,d2.OKM_ohjauksen_ala_SV as "UKM-styrningsområde, högskolor"
	  --,d2.iscle2011_EN as "Level of education, tier 1"
	  --,d2.Koulutusaste_taso2_EN as "Level of education, tier 2"
	  --,d2.iscfibroad2013_EN as "Field of education, tier 1"
	  --,d2.iscfinarrow2013_EN as "Field of education, tier 2"
	  --,d2.iscfi2013_EN as "Field of education, tier 3"
	  --,d2.OKM_ohjauksen_ala_EN as "Field of ed., HE steering"

	  --koodit
      ,d2.koulutus_koodi AS [Koodit Koulutusnimike]
	  ,d2.opintoala2002_koodi AS [Koodit Opintoala]
	  ,d2.koulutusala2002_koodi AS [Koodit Koulutusala]
	  ,d2.opintoala1995_koodi AS [Koodit Koulutusala (95 luokitus)]
	  ,d2.koulutusala2002_koodi AS [Koodit Koulutusala (02 luokitus)]
	  ,d8.maakunta AS [Koodit Koulutuksen maakunta]

	  --järjestys
	  ,d2.jarjestys AS jarj_koulnimike
	  ,d2.jarjestys_opintoala2002 AS jarj_opintoala
	  ,d2.jarjestys_koulutusala2002
	  ,d2.jarjestys_opintoala1995
	  ,d2.jarjestys_koulutusaste2002
	  --,d3.jarjestys AS jarj_jarjtapa
	  --,d4.jarjestys AS jarj_tutktyyppi
	  --,d5.jarjestys AS jarj_hallinnonala
	  ,d6.jarjestys AS jarj_opetuskieli
	  --,d7.jarjestys AS jarj_nuoretaikuiset
	  ,d8.jarjestys_maakunta
	  ,d8.jarjestys_ely
	  ,d8.jarjestys_avi
	  ,d9.jarjestys AS jarj_sukupuoli
	  --,d10.jarjestys AS jarj_nuoriaikuinen
	  ,d11.lukukausi AS jarj_lukukausi
	  ,d12.jarjestys AS jarj_kirjtammi
	  ,d13.jarjestys AS jarj_kirjsyys
	  ,d14.jarjestys AS jarj_kuntaryhma
	  ,d15.jarjestys_jarjestamismuoto AS jarj_jarjmuoto
	  ,d15.jarjestys_koulutuslaji3
	  ,d16.jarjestys AS jarj_maa
	  ,d16.jarjestys_maanosa
	  ,d16.jarjestys_etamaa
	  ,d16.jarjestys_eumaa
	  ,d17.jarjestys AS jarj_kans
	  ,d18.jarjestys AS jarj_syntvaltio
	  ,d18.jarjestys_maanosa AS jarj_syntmaanosa
	  ,d19.jarjestys AS jarj_syntsuomimuu
	  ,d20.jarjestys AS jarj_aidinkieli
	  ,d21.jarjestys AS jarj_aidinkielisuomi
	  --,d22.jarjestys AS jarj_koulsektori
	  ,d2.koulutusaste2002_koodi
	  ,[koulutuksen_aloittamislukuvuosi]
	  ,[Nakokulma] AS Aineistonäkökulma
	  ,d21.aidinkieli_versio3_koodi AS koodi_ai
	  ,d17.kansalaisuus_versio1_koodi AS koodi_kan
	  ,d19.kansalaisuus_versio1_koodi AS koodi_syn
	  ,d2.jarjestys_iscle2011 as jarj_isced_koulast1
	  ,d2.jarjestys_Koulutusaste_taso2 as jarj_isced_koulast2
	  ,d2.jarjestys_iscfibroad2013 as jarj_isced_koulala1
	  ,d2.jarjestys_iscfinarrow2013 as jarj_isced_koulala2
	  ,d2.jarjestys_iscfi2013 as jarj_isced_koulala3
	  ,d2.jarjestys_OKM_ohjauksen_ala as jarj_isced_okmohjaus1
FROM            dbo.f_ulkomaalaiset_maan_kansalaisuuden_aidinkielen_mukaan_2_13_14_15
	JOIN d_lahde d1 ON d1.id = [lahde_id]
	JOIN d_koulutusluokitus d2 on d2.id = [koulutusluokitus_id]
	--JOIN d_opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus d3 on d3.id = [opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_id]
	--JOIN d_ammatillisen_koulutuksen_koulutuslaji d4 on d4.id = [ammatillisen_koulutuksen_koulutuslaji_id]
	--JOIN d_opetushallinnon_koulutus d5 on d5.id = [opetushallinnon_koulutus_id]
	JOIN d_kieli d6 on d6.id = [koulutuksen_opetuskieli_id]
	--JOIN d_nuorten_aikuisten_koulutus_amm d7 on d7.id = [nuorten_aikuisten_koulutus_amm_id]
	JOIN d_alueluokitus d8 on d8.id = [koulutuksen_sijaintimaakunta_id]
	JOIN d_sukupuoli d9 on d9.id = [sukupuoli_id]
	--JOIN d_aikuisopiskelija d10 on d10.id = [aikuisopiskelija_id]
	JOIN d_kausi d11 on d11.kausi_id = [koulutuksen_aloittamislukukausi_id]
	JOIN d_opiskelijan_olo d12 on d12.id = [kirjoillaolo_tammikuu_id]
	JOIN d_opiskelijan_olo d13 on d13.id = [kirjoillaolo_syyskuu_id]
	JOIN d_kuntaryhma d14 on d14.id = [kotikunnan_kuntaryhma_id]
	JOIN d_koulutuslaji3 d15 on d15.id = [koulutusryhma_koulutuslaji3_id]
	JOIN d_valtio d16 on d16.id = [kansalaisuus_maa_id]
	JOIN d_kansalaisuus_versio1 d17 on d17.id = [kansalaisuus_versio1_id]
	JOIN d_valtio d18 on d18.id = [syntymavaltio_maa_id]
	JOIN d_kansalaisuus_versio1 d19 on d19.id = [syntymavaltio_kansalaisuus_versio1_id]
	JOIN d_kieli d20 on d20.id = [aidinkieli_kieli_id]
	JOIN d_aidinkieli_versio3 d21 on d21.id = [aidinkieli_versio3_id]
	--JOIN d_koulutussektori d22 on d22.id = [koulutussektori_id]
WHERE koulutusaste2002_koodi = 31 AND d13.opiskelijan_olo_koodi <> ''-1'' AND d2.koulutusala2002_koodi <> ''9''
















' 
GO
/****** Object:  View [dbo].[v_f_tab_ulkomaalaiset_maan_kansalaisuuden_aidinkielen_mukaan_yo]    Script Date: 21.6.2017 10:17:26 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_ulkomaalaiset_maan_kansalaisuuden_aidinkielen_mukaan_yo]'))
EXEC dbo.sp_executesql @statement = N'















CREATE VIEW [dbo].[v_f_tab_ulkomaalaiset_maan_kansalaisuuden_aidinkielen_mukaan_yo] AS
SELECT 
	   [opiskelijoiden_lkm] AS lkm_op2
	  ,CASE WHEN [tilastovuosi] = [koulutuksen_aloittamislukuvuosi] THEN [opiskelijoiden_lkm] ELSE 0 END AS lkm_aloit2
	  ,CASE WHEN d13.opiskelijan_olo_koodi = 1 THEN [opiskelijoiden_lkm] ELSE 0 END AS lkm_opiskolo2
	  ,[tilastovuosi] AS Tilastovuosi
	  ,[Nakokulma] AS Näkökulma
	  ,d1.lahde AS Lähde
      ,d2.koulutus AS [Koulutusnimike]
	  ,d2.opintoala2002 AS [Opintoala]
	  ,d2.koulutusala2002 AS [Koulutusala]
	  ,d2.opintoala1995 AS [Koulutusala (95 luokitus)]
	  ,d2.koulutusala2002 AS [Koulutusala (02 luokitus)]
	  ,d2.koulutusaste2002 AS [Koulutusaste]
	  ,d3.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus AS Järjestämistapa
	  ,d4.ammatillisen_koulutuksen_koulutuslaji AS Tutkintotyyppi
	  ,d5.opetushallinnon_koulutus AS Hallinnonala
	  ,d6.kieli AS Opetuskieli
	  ,d7.nuorten_aikuisten_koulutus_amm AS ''Nuorten koulutus/aikuiskoulutus''
	  ,d8.maakunta AS ''Koulutuksen maakunta''
	  ,d8.ely AS ''Koulutuksen ELY-alue''
	  ,d8.avi AS ''Koulutuksen AVI-alue''
	  ,d9.sukupuoli AS Sukupuoli
	  ,d10.aikuisopiskelija AS ''Nuori opiskelija/aikuisopiskelija''
	  ,d11.lukukausiselite AS ''Aloituslukukausi''
	  ,d11.lukuvuosi AS ''Aloituslukuvuosi''
	  ,d11.vuosiselite AS Aloitusvuosi
	  ,d12.opiskelijan_olo AS ''Kirjoillaolo (tammi)''
	  ,d13.opiskelijan_olo AS ''Kirjoillaolo (syys)''
	  ,d14.kuntaryhma AS Kuntaryhmä
	  ,d15.jarjestamismuoto AS Järjestämismuoto
	  ,d15.koulutuslaji3 AS Koulutuslaji
	  ,d16.maa AS ''Kansalaisuus (maa)''
	  ,d16.maanosa AS ''Kansalaisuus (maanosa)''
	  ,d16.etamaa AS ''ETA-maan kansalainen''
	  ,d16.eumaa AS ''EU-maan kansalainen''
	  ,d17.kansalaisuus_versio1 AS ''Kansalaisuus (suomi/muu)''
	  ,d18.maa AS Syntymävaltio
	  ,d18.maanosa AS ''Syntymävaltio (maanosa)''
	  ,d19.kansalaisuus_versio1 AS ''Syntymävaltio (suomi/muu)''
	  ,d20.kieli AS Äidinkieli
	  ,d21.aidinkieli_versio3 AS ''Äidinkieli (suomi/muu)''
	  ,d22.koulutussektori AS Koulutussektori
	  ,d1.lahde_koodi

	  --Ruotsi
	  ,[tilastovuosi] AS Statistikår
      ,d2.koulutus_SV AS [Utbildningsbenämning]
	  ,d2.opintoala2002_SV AS [Studieområde]
	  ,d2.koulutusala2002_SV AS [Utbildningsområde]
	  ,d2.opintoala1995_SV AS [Utbildningsområde (1995)]
	  ,d2.koulutusala2002_SV AS [Utbildningsområde (2002)]
	  ,d2.koulutusaste2002_SV AS [Utbildningsnivå]
	  ,d3.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_SV AS [Sättet på vilket utbildningen ordnas]
	  ,d4.ammatillisen_koulutuksen_koulutuslaji_SV AS [Typ av examen]
	  ,d5.opetushallinnon_koulutus_SV AS Förvaltningsområde
	  ,d6.kieli_SV AS [Utbildningens språk]
	  ,d7.nuorten_aikuisten_koulutus_amm_SV AS [Ungdoms-/vuxenutbildning]
	  ,d8.maakunta_SV AS [Utbildningens landskap]
	  ,d8.ely_SV AS [Utbildningens NTM-område]
	  ,d8.avi_SV AS [Utbildningens RFV-område]
	  ,d9.sukupuoli_SV AS Kön
	  ,d10.aikuisopiskelija_SV AS [Ungdoms-/vuxenstuderande]
	  ,d11.lukukausiselite_SV AS [Begynnelsetermin]
	  ,d11.lukuvuosi AS [Begynnelseläsår]
	  ,d11.vuosiselite_SV AS Begynnelseår
	  ,d12.opiskelijan_olo_SV AS [Inskrivning (januari)]
	  ,d13.opiskelijan_olo_SV AS [Inskrivning (september)]
	  ,d14.kuntaryhma_SV AS Kommungruppen
	  ,d15.jarjestamismuoto_SV AS [Formen i vilken utbildningen ordnas]
	  ,d15.koulutuslaji3_SV AS Utbildningsslag
	  ,d16.maa_SV AS [Medborgarskap (land)]
	  ,d16.maanosa_SV AS [Medborgarskap (världsdel)]
	  ,d16.etamaa_SV AS [Medborgare i ett EES-land]
	  ,d16.eumaa_SV AS [Medborgare i ett EU-land]
	  ,d17.kansalaisuus_versio1_SV AS [Medborgarskap (finska/andra)]
	  ,d18.maa_SV AS Födelseland
	  ,d18.maanosa_SV AS [Födelseland (världsdel)]
	  ,d19.kansalaisuus_versio1_SV AS [Födelseland (Finland/andra)]
	  ,d20.kieli_SV AS Modersmål
	  ,d21.aidinkieli_versio3_SV AS [Modersmål (finska/andra)]
	  ,d22.koulutussektori_SV AS Utbildningssektor

	  --Englanti
	  ,[tilastovuosi] AS [Statistical year]
      ,d2.koulutus_EN AS [Name of education]
	  ,d2.opintoala2002_EN AS [Subfield of education]
	  ,d2.koulutusala2002_EN AS [Field of education]
	  ,d2.opintoala1995_EN AS [Field of education (1995)]
	  ,d2.koulutusala2002_EN AS [Field of education (2002)]
	  ,d2.koulutusaste2002_EN AS [Level of education]
	  ,d3.opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_EN AS [Method of vocational education and training]
	  ,d4.ammatillisen_koulutuksen_koulutuslaji_EN AS [Qualification type]
	  ,d5.opetushallinnon_koulutus_EN AS [Administrative sector]
	  ,d6.kieli_EN AS [Language of education]
	  ,d7.nuorten_aikuisten_koulutus_amm_EN [Youth/adult education]
	  ,d8.maakunta_EN AS [Region of education]
	  ,d8.ely_EN AS [ELY area of education]
	  ,d8.avi_EN AS [AVI area of education]
	  ,d9.sukupuoli_EN AS Gender
	  ,d10.aikuisopiskelija_EN AS [Young person/adult student]
	  ,d11.lukukausiselite_EN AS [First term]
	  ,d11.lukuvuosi AS [First academic year]
	  ,d11.vuosiselite_EN AS [First year]
	  ,d12.opiskelijan_olo_EN AS [Enrollment status (January)]
	  ,d13.opiskelijan_olo_EN AS [Enrollment status (September)]
	  ,d14.kuntaryhma_EN AS [Municipality type]
	  ,d15.jarjestamismuoto_EN AS [Form of vocational education and training]
	  ,d15.koulutuslaji3_EN AS [Form of education and training]
	  ,d16.maa_EN AS [Nationality (country)]
	  ,d16.maanosa_EN AS [Nationality (continent)]
	  ,d16.etamaa_EN AS [Citizen of EEA nation]
	  ,d16.eumaa_EN AS [Citizen of EU nation]
	  ,d17.kansalaisuus_versio1_EN AS [Nationality (Finn/Other)]
	  ,d18.maa_EN AS [Country of birth]
	  ,d18.maanosa_EN AS [Country of birth (continent)]
	  ,d19.kansalaisuus_versio1_EN AS [Country of birth (Finland/Other)]
	  ,d20.kieli_EN AS [Mother tongue]
	  ,d21.aidinkieli_versio3_EN AS [Mother tongue (Finnish/Other)]
	  ,d22.koulutussektori_EN AS [Sector of education]

	  --isced
	  ,d2.iscle2011 as "Koulutusaste, taso 1"
	  ,d2.Koulutusaste_taso2 as "Koulutusaste, taso 2"
	  ,d2.iscfibroad2013 as "Koulutusala, taso 1"
	  ,d2.iscfinarrow2013 as "Koulutusala, taso 2"
	  ,d2.iscfi2013 as "Koulutusala, taso 3"
	  ,d2.OKM_ohjauksen_ala as "OKM ohjauksen ala, korkeak."
	  ,d2.iscle2011_SV as "Utbildn.nivå, nivå 1"
	  ,d2.Koulutusaste_taso2_SV as "Utbildn.nivå, nivå 2"
	  ,d2.iscfibroad2013_SV as "Utbildn.område, nivå 1"
	  ,d2.iscfinarrow2013_SV as "Utbildn.område, nivå 2"
	  ,d2.iscfi2013_SV as "Utbildn.område, nivå 3"
	  ,d2.OKM_ohjauksen_ala_SV as "UKM-styrningsområde, högskolor"
	  ,d2.iscle2011_EN as "Level of education, tier 1"
	  ,d2.Koulutusaste_taso2_EN as "Level of education, tier 2"
	  ,d2.iscfibroad2013_EN as "Field of education, tier 1"
	  ,d2.iscfinarrow2013_EN as "Field of education, tier 2"
	  ,d2.iscfi2013_EN as "Field of education, tier 3"
	  ,d2.OKM_ohjauksen_ala_EN as "Field of ed., HE steering"

	  --koodit
      ,d2.koulutus_koodi AS [Koodit Koulutusnimike]
	  ,d2.opintoala2002_koodi AS [Koodit Opintoala]
	  ,d2.koulutusala2002_koodi AS [Koodit Koulutusala]
	  ,d2.opintoala1995_koodi AS [Koodit Koulutusala (95 luokitus)]
	  ,d2.koulutusala2002_koodi AS [Koodit Koulutusala (02 luokitus)]
	  ,d8.maakunta AS [Koodit Koulutuksen maakunta]

	  --järjestys
	  ,d2.jarjestys AS jarj_koulnimike
	  ,d2.jarjestys_opintoala2002 AS jarj_opintoala
	  ,d2.jarjestys_koulutusala2002
	  ,d2.jarjestys_opintoala1995
	  ,d2.jarjestys_koulutusaste2002
	  ,d3.jarjestys AS jarj_jarjtapa
	  ,d4.jarjestys AS jarj_tutktyyppi
	  ,d5.jarjestys AS jarj_hallinnonala
	  ,d6.jarjestys AS jarj_opetuskieli
	  ,d7.jarjestys AS jarj_nuoretaikuiset
	  ,d8.jarjestys_maakunta
	  ,d8.jarjestys_ely
	  ,d8.jarjestys_avi
	  ,d9.jarjestys AS jarj_sukupuoli
	  ,d10.jarjestys AS jarj_nuoriaikuinen
	  ,d11.lukukausi AS jarj_lukukausi
	  ,d12.jarjestys AS jarj_kirjtammi
	  ,d13.jarjestys AS jarj_kirjsyys
	  ,d14.jarjestys AS jarj_kuntaryhma
	  ,d15.jarjestys_jarjestamismuoto AS jarj_jarjmuoto
	  ,d15.jarjestys_koulutuslaji3
	  ,d16.jarjestys AS jarj_maa
	  ,d16.jarjestys_maanosa
	  ,d16.jarjestys_etamaa
	  ,d16.jarjestys_eumaa
	  ,d17.jarjestys AS jarj_kans
	  ,d18.jarjestys AS jarj_syntvaltio
	  ,d18.jarjestys_maanosa AS jarj_syntmaanosa
	  ,d19.jarjestys AS jarj_syntsuomimuu
	  ,d20.jarjestys AS jarj_aidinkieli
	  ,d21.jarjestys AS jarj_aidinkielisuomi
	  ,d22.jarjestys AS jarj_koulsektori
	  ,d2.koulutusaste2002_koodi
	  ,[koulutuksen_aloittamislukuvuosi]
	  ,[Nakokulma] AS Aineistonäkökulma
	  ,d21.aidinkieli_versio3_koodi AS koodi_ai
	  ,d17.kansalaisuus_versio1_koodi AS koodi_kan
	  ,d19.kansalaisuus_versio1_koodi AS koodi_syn
	  ,d2.jarjestys_iscle2011 as jarj_isced_koulast1
	  ,d2.jarjestys_Koulutusaste_taso2 as jarj_isced_koulast2
	  ,d2.jarjestys_iscfibroad2013 as jarj_isced_koulala1
	  ,d2.jarjestys_iscfinarrow2013 as jarj_isced_koulala2
	  ,d2.jarjestys_iscfi2013 as jarj_isced_koulala3
	  ,d2.jarjestys_OKM_ohjauksen_ala as jarj_isced_okmohjaus1
FROM            dbo.f_ulkomaalaiset_maan_kansalaisuuden_aidinkielen_mukaan_2_13_14_15
	JOIN d_lahde d1 ON d1.id = [lahde_id]
	JOIN d_koulutusluokitus d2 on d2.id = [koulutusluokitus_id]
	JOIN d_opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus d3 on d3.id = [opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_id]
	JOIN d_ammatillisen_koulutuksen_koulutuslaji d4 on d4.id = [ammatillisen_koulutuksen_koulutuslaji_id]
	JOIN d_opetushallinnon_koulutus d5 on d5.id = [opetushallinnon_koulutus_id]
	JOIN d_kieli d6 on d6.id = [koulutuksen_opetuskieli_id]
	JOIN d_nuorten_aikuisten_koulutus_amm d7 on d7.id = [nuorten_aikuisten_koulutus_amm_id]
	JOIN d_alueluokitus d8 on d8.id = [koulutuksen_sijaintimaakunta_id]
	JOIN d_sukupuoli d9 on d9.id = [sukupuoli_id]
	JOIN d_aikuisopiskelija d10 on d10.id = [aikuisopiskelija_id]
	JOIN d_kausi d11 on d11.kausi_id = [koulutuksen_aloittamislukukausi_id]
	JOIN d_opiskelijan_olo d12 on d12.id = [kirjoillaolo_tammikuu_id]
	JOIN d_opiskelijan_olo d13 on d13.id = [kirjoillaolo_syyskuu_id]
	JOIN d_kuntaryhma d14 on d14.id = [kotikunnan_kuntaryhma_id]
	JOIN d_koulutuslaji3 d15 on d15.id = [koulutusryhma_koulutuslaji3_id]
	JOIN d_valtio d16 on d16.id = [kansalaisuus_maa_id]
	JOIN d_kansalaisuus_versio1 d17 on d17.id = [kansalaisuus_versio1_id]
	JOIN d_valtio d18 on d18.id = [syntymavaltio_maa_id]
	JOIN d_kansalaisuus_versio1 d19 on d19.id = [syntymavaltio_kansalaisuus_versio1_id]
	JOIN d_kieli d20 on d20.id = [aidinkieli_kieli_id]
	JOIN d_aidinkieli_versio3 d21 on d21.id = [aidinkieli_versio3_id]
	JOIN d_koulutussektori d22 on d22.id = [koulutussektori_id]
WHERE koulutusaste2002_koodi in (63,72,73,81,82) AND d13.opiskelijan_olo_koodi <> ''-1'' AND d2.koulutusala2002_koodi <> ''9''













' 
GO
/****** Object:  View [dbo].[v_f_tab_ulkomaalaiset_ulk_ja_vieraskieliset_yhteiset]    Script Date: 21.6.2017 10:17:26 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_ulkomaalaiset_ulk_ja_vieraskieliset_yhteiset]'))
EXEC dbo.sp_executesql @statement = N'


















CREATE VIEW [dbo].[v_f_tab_ulkomaalaiset_ulk_ja_vieraskieliset_yhteiset] AS

Select
[Tilastovuosi]

,d4.sukupuoli as ''Sukupuoli''

,CASE 
	WHEN f.Aineisto = ''2.3'' THEN d3b.avi
	ELSE d3.avi 
END 
as ''Asuinalueen AVI''

,CASE 
	WHEN f.Aineisto = ''2.3'' THEN d3b.ely
	ELSE d3.ely
END 

as ''Asuinalueen ELY''

,CASE 
	WHEN f.Aineisto = ''2.3'' THEN d3b.maakunta
	ELSE d3.maakunta
END 

as Asuinmaakunta

,d3.kielisuhde as ''Asuinkunnan kielisuhde''
,d3.kunta as Asuinkunta


/*

- Asuinmaakunta aineistojen välille (+ AVI + ELY), eli kuntataso olisi 2.8 2.9 ja K2.17 kohtainen ja tuntematon 2.3 ja 2.4:llä
  - CASE ehdolla tabularnäkymään

d3b -> maakunta
*/

,d20.opetushallinnon_koulutus as ''Hallinnonala''

--,d21.koulutusaste2002 as ''Koulutusaste (2002)''
,d21.koulutusala2002 as ''Koulutusala (2002)''
--,d21.opintoala1995 as ''Koulutusala (1995)''
,d21.opintoala2002 as ''Opintoala (2002)''
--,d21.koulutus as ''Koulutusnimike'' ei tarvita

,d16.kieli as ''Koulutuksen kieli''

,d22.avi as ''Koulutuksen AVI''
,d22.ely as ''Koulutuksen ELY''
,d22.maakunta as ''Koulutuksen maakunta''
,d22.kielisuhde as ''Koul. kunnan kielisuhde''
,d22.kunta as ''Koulutuksen kunta''


,d12.opiskelijan_olo as ''Kirjoillaolo (syys)''

--,d1.aineisto as ''Aineisto (ennakko / lopullinen)'' hoidetaan taustarajauksena

,d19.koulutussektori as ''Koulutussektori''

--,d5.ika as ''Ikä''
--,d5.ika5v as ''Ikäryhmä 5v''
,d5b.ika5v as ''Ikäryhmä I''
,d5c.ika as ''Ikäryhmä II''

,d2.aidinkieli_versio1 as ''Äidinkieli I'' --muutettu
--,d2b.aidinkieli_versio2 as ''Äidinkieli (versio 2)''

,d50.asuinkunta_sama_vai_eri_kuin_aiemmin AS ''Asuinkunta sama/eri ed. tilv''  --muutettu

,d51.edeltavan_vuoden_asuinpaikka AS ''Edeltävän vuoden asuinpaikka''

,[suomeen_muuttamisvuosi] AS ''Suomeen muuttamisvuosi''

,d52.kieli AS ''Äidinkieli II'' --muutettu

,d53.maa as ''Kansalaisuus''
,d53.maanosa as ''Kansalaisuus (maanosa)''
,d53.eumaa as ''EU-maan kansalainen''
,d53.etamaa as ''ETA-maan kansalainen''


/* ei kieliversioita vielä */
,d53b.maa as ''Syntymämaa''
,d53b.maanosa as ''Syntymämaa (maanosa)''

,d53c.maa as ''Äidin syntymämaa''
,d53c.maanosa as ''Äidin syntymämaa (maanosa)''

,d53d.maa as ''Isän syntymämaa''
,d53d.maanosa as ''Isän syntymämaa (maanosa)''

,d54.hetu_ok as ''Henkilötunnuksen oikeellisuus''
,d55.koulutusryhma as ''Koulutusryhmä II''
,d55.koulutusryhma2 as ''Koulutusryhmä''

,d56.maassaolo AS ''Maassaolo''
,d57.tutkinnon_toteuma AS ''Koko tutkinto/tutkinnon osa''

,[suoritusaika] -- miten tuntemattoman käännökset hoidetaan?

,d58.maahantulo_ja_opiskelun_aloittaminen as ''Maahantulo ja II asteen koul. aloittaminen'' --muutettu
,d59.maahantulo_ja_opiskelun_aloittaminen as ''Maahantulo ja korkeakoul. aloittaminen''  --muutettu

,d60.koulutuksen_jarjestamismuoto AS ''Koulutuksen järjestämismuoto''

,CASE
	WHEN d19.koulutussektori_koodi IN (''1'', ''2'', ''3'') THEN ''Toisen asteen koulutus''
	WHEN d19.koulutussektori_koodi IN (''4'', ''5'') THEN ''Korkeakoulutus''
	ELSE ''Tuntematon''
END AS ''Toinen aste / Korkea-aste''

/*

Kaisu pyysi juuri myös Toinen aste/Korkeakoulutus jaottelun, jonka voi edelleen johtaa tästä.
  - CASE ehdolla koulutussektorista tabularnäkymään

*/

/*** JÄRJESTYSMUUTTUJAT ***/

,CASE 
	WHEN f.Aineisto = ''2.3'' THEN d3b.jarjestys_avi
	ELSE d3.jarjestys_avi
END as jarj_as_avi
,CASE 
	WHEN f.Aineisto = ''2.3'' THEN d3b.jarjestys_ely
	ELSE d3.jarjestys_ely
END as jarj_as_ely
,CASE 
	WHEN f.Aineisto = ''2.3'' THEN d3b.jarjestys_maakunta
	ELSE d3.jarjestys_maakunta
END as jarj_as_maakunta

,d3.jarjestys_kielisuhde as jarj_as_kielisuhde
,d3.jarjestys as jarj_as_kunta

,d20.jarjestys as jarj_hallinnonala

--,d21.jarjestys_koulutusaste2002
,d21.jarjestys_koulutusala2002
--,d21.jarjestys_opintoala1995
,d21.jarjestys_opintoala2002
--,d21.jarjestys as jarj_koulnimike

,d16.jarjestys as jarj_koulkiel
,d16.jarjestys_iso3kirjainta as jarj_koulkiel2

,d22.jarjestys_avi
,d22.jarjestys_ely
,d22.jarjestys_maakunta
,d22.jarjestys_kielisuhde
,d22.jarjestys as jarj_kunta


,d12.jarjestys as jarj_kirjolosyys

,d19.jarjestys as jarj_koulsek

,d5.jarjestys_ika
,d5.jarjestys_ika5v as jarj_ika5v

,d5b.jarjestys_ika5v as jarj_ikaryhma1
,d5c.jarjestys_ika as jarj_ikaryhma2


,d2.jarjestys as jarj_aidinkieli1
--,d2b.jarjestys as jarj_aidinkieli2


,CASE
		WHEN d52.kieli_avain IN (''90'', ''99'') THEN ''ZZY''
	    WHEN d52.kieli_avain IN (''-1'', ''-2'') THEN ''ZZZ''
		ELSE left(d52.kieli,3) 
	END AS jarj_aidinkieli

,d53.jarjestys as jarj_kansallisuus
,d53.jarjestys_maanosa as jarj_kans_maanosa
,d53.jarjestys_etamaa as jarj_kans_etamaa
,d53.jarjestys_eumaa as jarj_kans_eumaa

,d53b.jarjestys as jarj_syntmaa
,d53b.jarjestys_maanosa as jarj_syntmaa_maanosa

,d53c.jarjestys as jarj_syntmaa_aiti
,d53c.jarjestys_maanosa as jarj_syntmaa_aiti_maanosa

,d53d.jarjestys as jarj_syntmaa_isa
,d53d.jarjestys_maanosa as jarj_syntmaa_isa_maanosa

,case when d55.koulutusryhma2=''Ammattikorkeakoulututkinto'' then 1080 else d55.jarjestys end as jarj_koulutusryhma

,jarjestys_suoritusaika 
,jarjestys_syntymavuosi
,[jarjestys_suomeen_muuttamisvuosi]

/*** KOODIMUUTTUJAT ***/

,f.Aineisto as ''Koodit Aineisto''
,d3.maakunta_koodi as ''Koodit Asuinmaakunta''
,d3.kunta_koodi as ''Koodit Asuinkunta''

,d21.koulutusaste2002_koodi as ''Koodit Koulutusaste 2002''
,d21.koulutusala2002_koodi as ''Koodit Koulutusala 2002''
,d21.opintoala1995_koodi as ''Koodit Koulutusala 1995''
,d21.opintoala2002_koodi as ''Koodit Opintoala 2002''
,d21.koulutus_koodi as ''Koodit Koulutusnimike''

,d22.maakunta_koodi as ''Koodit Koulutuksen maakunta''
,d22.kunta_koodi as ''Koodit Koulutuksen kunta''

,d12.opiskelijan_olo_koodi as ''Koodit Kirjoillaolo''

,d1.aineisto_koodi as ''Koodit Aineisto Ennakko / Lopullinen''

,d2.aidinkieli_versio1_koodi as ''Koodit Äidinkieli1''
--,d2b.aidinkieli_versio2_koodi as aidinkieli2_koodi

,d52.kieli_koodi AS ''Koodit Äidinkieli''

,d53.maa_koodi AS ''Koodit Kansalaisuus (maa)''
,d53b.maa_koodi AS ''Koodit Syntymämaa''
,d53c.maa_koodi AS ''Koodit Syntymämaa (äiti)''
,d53d.maa_koodi AS ''Koodit Syntymämaa (isä)''

/*** Lukumäärämuuttujat ***/

,[aloittaneet]
,[opiskelijat]
,[tutkinnot]
,[aloittaneet2_17]
,[opiskelijat2_17]
,[tutkinnot2_17]= 
CASE 
		WHEN tilastovuosi = 2010 AND d55.koulutusryhma_koodi IN (''21'',''22'') AND f.aineisto = ''K2.17'' THEN NULL
		ELSE [tutkinnot2_17]
 END
,[aloittaneet_ulkomaalaistausta_kielen_mukaan]
,[opiskelijat_ulkomaalaistausta_kielen_mukaan]
,[tutkinnot_ulkomaalaistausta_kielen_mukaan] = 
CASE 
		WHEN tilastovuosi = 2010 AND d55.koulutusryhma_koodi IN (''21'',''22'') AND f.aineisto = ''K2.17'' THEN NULL
		ELSE [tutkinnot_ulkomaalaistausta_kielen_mukaan]
 END
,[aloittaneet_ulkomaalaistausta_vanhempien_synnyinmaan_mukaan]
,[opiskelijat_ulkomaalaistausta_vanhempien_synnyinmaan_mukaan]
,[tutkinnot_ulkomaalaistausta_vanhempien_synnyinmaan_mukaan] = 
CASE 
		WHEN tilastovuosi = 2010 AND d55.koulutusryhma_koodi IN (''21'',''22'') AND f.aineisto = ''K2.17'' THEN NULL
		ELSE [tutkinnot_ulkomaalaistausta_vanhempien_synnyinmaan_mukaan]
 END
,[aloittaneet_ulkomaalaiset]
,[opiskelijat_ulkomaalaiset]
,[tutkinnot_ulkomaalaiset] =
CASE 
		WHEN tilastovuosi = 2010 AND d55.koulutusryhma_koodi IN (''21'',''22'') AND f.aineisto = ''K2.17'' THEN NULL
		ELSE [tutkinnot_ulkomaalaiset]
 END
,[aloittaneet_ulkomailla_syntyneet]
,[opiskelijat_ulkomailla_syntyneet]
,[tutkinnot_ulkomailla_syntyneet] =
CASE 
		WHEN tilastovuosi = 2010 AND d55.koulutusryhma_koodi IN (''21'',''22'') AND f.aineisto = ''K2.17'' THEN NULL
		ELSE [tutkinnot_ulkomailla_syntyneet]
 END


/*** RUOTSI - tehdään kieliversiot vasta lopuksi ***/

,tilastovuosi as Statistikår
,d20.opetushallinnon_koulutus_SV as Förvaltningsområde
,d4.sukupuoli_SV as Kön
,d5b.ika5v_SV as ''Åldersgrupp''
,d55.koulutusryhma2_SV as ''Utbildningsgrupp''
,d21.koulutusala2002_SV as ''Utbildningsområde (2002)''
,d22.maakunta_SV as ''Utbildningens landskap''
,CASE
	WHEN d19.koulutussektori_koodi IN (''1'', ''2'', ''3'') THEN ''Andra stadiets utbildning''
	WHEN d19.koulutussektori_koodi IN (''4'', ''5'') THEN ''Högskoleutbildning''
	ELSE ''Okänd''
END AS ''Andra stadiet / Hög nivå''
,d19.koulutussektori_SV as Utbildningssektor

/*
,d3.avi_SV as ''Asuinalueen AVISV''
,d3.ely_SV as ''Asuinalueen ELYSV''
,d3.kielisuhde_SV as ''Asuinkunnan kielisuhdeSV''
,d3.maakunta_SV as Bostadslandskap
,d3.kunta_SV as Bostadskommun

,d21.koulutusaste2002_SV as ''Utbildningsnivå (2002)''

,d21.opintoala1995_SV as ''Utbildningsområde (1995)''
,d21.opintoala2002_SV as ''Studieområde (2002)''
,d21.koulutus_SV as Utbildningsbenämning

,d16.kieli_SV as ''Koulutuksen kieliSV''

,d22.avi_SV as ''Koulutuksen AVISV''
,d22.ely_SV as ''Koulutuksen ELYSV''

,d22.kielisuhde_SV as ''Koul. kunnan kielisuhdeSV''
,d22.kunta_SV as ''Utbildningens kommun''

,d12.opiskelijan_olo_SV as ''Inskrivning (september)''

,d1.aineisto_SV as AineistoSV



,d2.aidinkieli_versio1_SV as Modersmål
,d2b.aidinkieli_versio2_SV as ''Modersmål (utbildningsstruktur)''


,d50.asuinkunta_sama_vai_eri_kuin_aiemmin_SV AS ''Asuinkunta sama vai eri kuin aiemmin SV''

,d51.edeltavan_vuoden_asuinpaikka_SV AS ''Edeltävän vuoden asuinpaikka SV''

,[suomeen_muuttamisvuosi] AS ''Suomeen muuttamisvuosi SV''

,d52.kieli_SV AS ''Äidinkieli SV''

,d53.maa_sv as kansalaisuus_sv
,d53.maanosa_SV as ''Medborgarskap (världsdel)''
,d53.eumaa_sv as eumaa_sv
,d53.etamaa_sv as etamaa_sv
*/



/*** ENGLANTI ***/

,tilastovuosi as ''Statistical year''
,d20.opetushallinnon_koulutus_EN as ''Administrative sector''
,d4.sukupuoli_EN as Gender
,d5b.ika5v_EN as ''Age group''
,d55.koulutusryhma2_EN as ''Education group''
,d21.koulutusala2002_EN as ''Field of education (2002)''
,d22.maakunta_EN as ''Region of education''
,CASE
	WHEN d19.koulutussektori_koodi IN (''1'', ''2'', ''3'') THEN ''Upper secondary education''
	WHEN d19.koulutussektori_koodi IN (''4'', ''5'') THEN ''Higher education''
	ELSE ''Tuntematon''
END AS ''Upper secondary / Tertiary''
,d19.koulutussektori_EN as ''Sector of education''

/*

,d20.opetushallinnon_koulutus_EN as HallinnonalaEN
,d3.avi_EN as ''Asuinalueen AVIEN''
,d3.ely_EN as ''Asuinalueen ELYEN''
,d3.kielisuhde_EN as ''Asuinkunnan kielisuhdeEN''
,d3.maakunta_EN as ''Region of residence''
,d3.kunta_EN as ''Municipality of residence''
,d21.koulutusaste2002_EN as ''Level of education (2002)''
,d21.koulutusala2002_EN as ''Field of education (2002)''
,d21.opintoala1995_EN as ''Field of education (1995)''
,d21.opintoala2002_EN as ''Subfield of ed. (2002)''
,d21.koulutus_EN as ''Name of education''

,d16.kieli_EN as ''Koulutuksen kieliEN''

,d22.avi_EN as ''Koulutuksen AVIEN''
,d22.ely_EN as ''Koulutuksen ELYEN''
,d22.maakunta_EN as ''Region of education''
,d22.kielisuhde_EN as ''Koul. kunnan kielisuhdeEN''
,d22.kunta_EN as ''Municipality of education''


,d12.opiskelijan_olo_EN as ''Enrollment status (sept.)''

,d1.aineisto_EN as AineistoEN



,d2.aidinkieli_versio1_EN as ''Mother tongue''
,d2b.aidinkieli_versio2_EN as ''Mother tongue (ed. structure)''


,d50.asuinkunta_sama_vai_eri_kuin_aiemmin_EN AS ''Asuinkunta sama vai eri kuin aiemmin EN''

,d51.edeltavan_vuoden_asuinpaikka_EN AS ''Edeltävän vuoden asuinpaikka EN''

,[suomeen_muuttamisvuosi] AS ''Suomeen muuttamisvuosi EN''

,d52.kieli_EN AS ''Äidinkieli EN''

,d53.maa_en as kansalaisuus_en
,d53.maanosa_EN as ''Nationality (continent)''
,d53.eumaa_en as eumaa_en
,d53.etamaa_en as etamaa_en
*/

/*** käyttämättömät

,d1b.aineisto as Aineisto_OTV
,d1b.kaikkien_asteiden_koulutus as ''Kaikkien asteiden koulutus''
,d1b.tilastointivuosi as OTV_Tilv

,d3b.avi as ''Til.v:tta edeltävä AVI''
,d3b.ely as ''Til.v:tta edeltävä ELY''
,d3b.kielisuhde as ''Til.v:tta ed. asuinkunnan kielisuhde''
,d3b.maakunta as ''Til.v:tta ed. asuinmaakunta''
,d3b.kunta as ''Til.v:tta ed. asuinkunta''
,d3c.avi as ''2v til.v:tta ed. AVI''
,d3c.ely as ''2v til.v:tta ed. ELY''
,d3c.kielisuhde as ''2v til.v:tta ed. asuinkunnan kielisuhde''
,d3c.maakunta as ''2v til.v:tta ed. asuinmaakunta''
,d3c.kunta as ''2v til.v:tta ed. asuinkunta''


,d5b.vuosiselite as Syntymävuosi
,d5c.kuukausiselite as Syntymäkuukausi
,d6a.tutkinto_amk as ''Tutkinto (amk)''
,d6b.tutkinto_yo as ''Tutkinto (yo)''
,d7.koulutustyyppi as Koulutustyyppi
,d8.kansalaisuus_versio2 as Kansalaisuus
,d8b.kansalaisuus_versio1 as ''Kansalaisuus (väestörakenne)''
--luodaan yhdistetty kansalaisuus-muuttuja, joka toimii aineistojen 2.8, 2.9, ja 4.9 välillä
,CASE WHEN d8.kansalaisuus_versio2_koodi = ''1'' Or d8b.kansalaisuus_versio1_koodi = ''1'' THEN
''suomi'' When d8.kansalaisuus_versio2_koodi = ''2'' Or d8.kansalaisuus_versio2_koodi = ''9'' Or d8b.kansalaisuus_versio1_koodi = ''2'' THEN ''muu''
 Else ''Tuntematon'' End AS ''Kansalaisuus (suomi/muu)''
--
,d9.oppilaitos as Oppilaitos
,d9.oppilaitos as Yliopisto
,d9.oppilaitos as Ammattikorkeakoulu
,d9.opetuskieli as Opetuskieli
,d9.oppilaitoksen_omistajatyyppi as ''Oppil. omistajatyyppi''
,d9.oppilaitostyyppi as Oppilaitostyyppi
,d9b.koulutuksen_jarjestaja as ''Koulutuksen järjestäjä''
,d9b.koulutuksen_jarjestajan_omistajatyyppi as ''Koul. järj. omistajatyyppi''
,d10.lahde as Lähde
,d11.koulutusohjelma_amk as Koulutusohjelma

,d12b.opiskelijan_olo_tamm as ''Kirjoillaolo (tammi)''
,d13.rahoituslahde as Rahoituslähde
,d15.suuntautumisvaihtoehto_amk as Suuntautumisvaihtoehto

,d17.ensisijainen_opintooikeus as ''Ensisijainen opinto-oikeus''
,d18.tilauskoulutuksen_sijaintimaa as ''Tilauskoulutuksen sijaintimaa''



,d21b.koulutuslaji_okm as Koulutuslaji
,d21b.koulutuslaji_okm2 as Koulutuslaji2

--
,d22b.avi as ''Koul. järjestäjän AVI''
,d22b.ely as ''Koul. järjestäjän ELY''
,d22b.maakunta as ''Koul. järjestäjän maakunta''
,d22b.kielisuhde as ''Koul. järj. kunnan kielisuhde''
,d22b.kunta as ''Koul. järjestäjän kunta''
,d22c.avi as ''Oppilaitoksen AVI''
,d22c.ely as ''Oppilaitoksen ELY''
,d22c.maakunta as ''Oppilaitoksen maakunta''
,d22c.kielisuhde as ''Oppil. kunnan kielisuhde''
,d22c.kunta as ''Oppilaitoksen kunta''
,d23.vuosiselite as ''Kirjoihintulovuosi''
,d23b.lukukausiselite as ''Kirjoihintulokausi''
,d24b.vuosiselite as ''Kirjoihintulovuosi (kk-sek.)''
,d24c.vuosiselite as ''Kirjoihintulovuosi (kk-sek. läsna)''
,d24d.vuosiselite as ''Kirjoihintulovuosi (sek.)''
,d24e.vuosiselite as ''Kirjoihintulovuosi (sek. läsnä)''
,d24f.vuosiselite as ''Kirjoihintulovuosi (kk)''
,d24f2.lukukausiselite as ''Kirjoihintulokausi (kk)''
,d24g.vuosiselite as ''Kirjoihintulovuosi (kk läsnä)''
,d24h.vuosiselite as ''Kirjoihintulovuosi (op.ala)''
,d24i.vuosiselite as ''Kirjoihintulovuosi (op.ala läsnä)''
,d24j.vuosiselite as ''Kirjoihintulovuosi (tutk.)''
,d24k.lukukausiselite as ''Kirjoihintulokausi (tutk.)''
,d28.vahintaan_55_op_suorittanut as ''Suorittanut väh. 55 op''
,d29.opiskelijan_fte_tieto as ''Opiskelijan FTE-tieto''
--,d30.opiskelumuoto as Opiskelumuoto
,d31.yliopisto as Yliopistotunnus
,d32.tiedekunta_yo as Tiedekunta
,d33.uusi_vanha_opiskelija as ''Uusi/vanha opiskelija''
,d35.opettajankelpoisuus as Opettajankelpoisuus
,d36.avoinvayla as ''Hyväksytty avoimen yliop. suoritusten kautta''
,d37.vuosiselite as ''Tutkinnon suoritusvuosi''
,d38.lukukausiselite as ''Tutk. suorituslukukausi''
,d39.kuukausiselite as ''Tutk. suorituskuukausi''
,d40.maanosa as ''Kansalaisuus (maanosa)''
,d41.eumaa as ''EU-maan kansalainen''
,d42.etamaa as ''ETA-maan kansalainen''
,d43.pohjoismaa as ''Pohjoismaan kansalainen''



/*** JÄRJESTYSMUUTTUJAT ***/

,d1b.jarjestys as aineisto_otv_jarj


,d3b.jarjestys_avi as jarj_as_avi1x
,d3b.jarjestys_ely as jarj_as_ely1x
,d3b.jarjestys_kielisuhde as jarj_as_kielisuhde1x
,d3b.jarjestys_maakunta as jarj_as_maakunta1x
,d3b.jarjestys as jarj_as_kunta1x
,d3c.jarjestys_avi as jarj_as_avi2x
,d3c.jarjestys_ely as jarj_as_ely2x
,d3c.jarjestys_kielisuhde as jarj_as_kielisuhde2x
,d3c.jarjestys_maakunta as jarj_as_maakunta2x
,d3c.jarjestys as jarj_as_kunta2x

,d5b.jarjestys as jarj_syntv
,d6a.jarjestys as jarj_tutk_amk
,d6b.jarjestys as jarj_tutk_yo
,d7.jarjestys as jarj_koultyyppi
,d8.jarjestys as jarj_kansalaisuus
,d8b.jarjestys as jarj_kansalaisuus2
--yhdistetyn muuttujan järjestys
,CASE WHEN d8.kansalaisuus_versio2_koodi = ''1'' Or d8b.kansalaisuus_versio1_koodi = ''1'' THEN
''1'' When d8.kansalaisuus_versio2_koodi = ''2'' Or d8.kansalaisuus_versio2_koodi = ''9'' Or d8b.kansalaisuus_versio1_koodi = ''2'' THEN ''2''
 Else ''99'' End AS ''jarj_kansalaisuus3''
--
,d9.jarjestys_oppilaitos
,d9.jarjestys_opetuskieli
,d9.jarjestys_omistajatyyppi
,d9.jarjestys_oppilaitostyyppi
,d11.jarjestys as jarj_koulohjelma_amk

,d12b.jarjestys as jarj_kirjolotammi
,d13.jarjestys as jarj_rahoitus
,d15.jarjestys as jarj_suunnvaiht

,d17.jarjestys as jarj_ensop
,d18.jarjestys as jarj_tilauskoul



,d21b.jarjestys as jarj_koullaji
,d21b.jarjestys2 as jarj_koullaji2

--
,d22b.jarjestys_avi as jarjestys_avi2
,d22b.jarjestys_ely as jarjestys_ely2
,d22b.jarjestys_maakunta as jarjestys_maakunta2
,d22b.jarjestys_kielisuhde as jarjestys_kielisuhde2
,d22b.jarjestys as jarj_kunta2
,d22c.jarjestys_avi as jarjestys_avi3
,d22c.jarjestys_ely as jarjestys_ely3
,d22c.jarjestys_maakunta as jarjestys_maakunta3
,d22c.jarjestys_kielisuhde as jarjestys_kielisuhde3
,d22c.jarjestys as jarj_kunta3
,d23b.jarjestys as jarj_lukukausi
,d24f2.jarjestys as jarj_lukukausi_kk
,d28.jarjestys as jarj_vah55
,d29.jarjestys as jarj_op_fte
--,d30.jarjestys as jarj_opmuoto
,d32.jarjestys as jarj_tiedekunta
,d33.jarjestys as jarj_uusivanha
,d35.jarjestys as jarj_opettajankelpoisuus
,d36.jarjestys as jarj_avoinvayla
,d39.jarjestys as jarj_suor_kk

,d41.jarjestys_eumaa
,d42.jarjestys_etamaa
,d43.jarjestys as jarj_pohj_kans




/*** KOODIMUUTTUJAT ***/


,d1b.aineisto_koodi as ainesto_koodi_otv


,d3b.maakunta_koodi as asmaak1xmk
,d3b.kunta_koodi as asmaak1xk
,d5c.kuukausi as syntk
,d6a.tutkinto_amk_koodi as ''Koodit Tutkinto (amk)''
,d6b.tutkinto_yo_koodi as ''Koodit Tutkinto (yo)''
,d7.koulutustyyppi_koodi as ''Koodit Koulutustyyppi''
,d8.kansalaisuus_versio2_koodi as kansalaisuus_koodi
,d8b.kansalaisuus_versio1_koodi as kansalaisuus2_koodi
--yhdistetyn muuttujan koodi
,CASE WHEN d8.kansalaisuus_versio2_koodi = ''1'' Or d8b.kansalaisuus_versio1_koodi = ''1'' THEN
''1'' When d8.kansalaisuus_versio2_koodi = ''2'' Or d8.kansalaisuus_versio2_koodi = ''9'' Or d8b.kansalaisuus_versio1_koodi = ''2'' THEN ''2''
 Else ''-1'' End AS ''kansalaisuus3_koodi''
--
,d9.oppilaitoskoodi as ''Koodit Oppilaitos''
,d9b.koulutuksen_jarjestajakoodi as ''Koodit Koulutuksen järjestäjä''
,d10.lahde_koodi
,d11.koulutusohjelma_amk_koodi as ''Koodit Koulutusohjelma''

,d12b.opiskelijan_olo_tamm_koodi as kirjoillaolotammi_koodi
,d17.ensisijainen_opintooikeus_koodi as ensiop


--
,d22b.maakunta_koodi as ''Koodit Koul. järj. maakunta''
,d22b.kunta_koodi as ''Koodit Koul. järj. kunta''
,d22c.maakunta_koodi as ''Koodit Oppil. maakunta''
,d22c.kunta_koodi as ''Koodit Oppil. kunta''
,d23.vuosi as alvv
,d23b.lukukausi as alkk
,d24b.vuosi as alvv_kksek
,d24c.vuosi as alvv_kksek_lasna
,d24d.vuosi as alvv_sek
,d24e.vuosi as alvv_sek_lasna
,d24f.vuosi as alvv_kk
,d24f2.lukukausi as alkk_kk
,d24g.vuosi as alvv_kk_lasna
,d24h.vuosi as alvv_opa
,d24i.vuosi as alvv_opa_lasna
,d24j.vuosi as kirtu1v
,d24k.lukukausi as kirtu1k
,d28.vahintaan_55_op_suorittanut_koodi as op55_koodi
,d37.vuosi as suorv
,d38.lukukausi as suor_lk
,d39.kuukausi as suor_kk






/***  RUOTSI ***/
,[Tilastovuosi] as Statistikår

--,d3.avi_SV as ''Asuinalueen AVISV''
--,d3.ely_SV as ''Asuinalueen ELYSV''
--,d3.kielisuhde_SV as ''Asuinkunnan kielisuhdeSV''
,d3.maakunta_SV as Bostadslandskap
,d3.kunta_SV as Bostadskommun
--,d3b.avi_SV as ''Til.v:tta edeltävä AVISV''
--,d3b.ely_SV as ''Til.v:tta edeltävä ELYSV''
--,d3b.kielisuhde_SV as ''Til.v:tta ed. asuinkunnan kielisuhdeSV''
--,d3b.maakunta_SV as ''Til.v:tta ed. asuinmaakuntaSV''
--,d3b.kunta_SV as ''Til.v:tta ed. asuinkuntaSV''
--,d3c.avi_SV as ''2v til.v:tta ed. AVISV''
--,d3c.ely_SV as ''2v til.v:tta ed. ELYSV''
--,d3c.kielisuhde_SV as ''2v til.v:tta ed. asuinkunnan kielisuhdeSV''
--,d3c.maakunta_SV as ''2v til.v:tta ed. asuinmaakuntaSV''
--,d3c.kunta_SV as ''2v til.v:tta ed. asuinkuntaSV''

,d5.ika_SV as Ålder
,d5.ika5v_SV as Åldersgrupp
,d5b.vuosiselite_SV as Födelseår
--,d5c.kuukausiselite_SV as SyntymäkuukausiSV
,d6a.tutkinto_amk_SV as ''Examen (yrkehögskola)''
,d6b.tutkinto_yo_SV as ''Examen (universitet)''
,d7.koulutustyyppi_SV as ''Typ av utbildning''
,d8.kansalaisuus_versio2_SV as Medborgarskap
,d8b.kansalaisuus_versio1_SV as ''Medborgarskap (utbildningsstruktur)''
--luodaan yhdistetty kansalaisuus-muuttuja, joka toimii aineistojen 2.8, 2.9, ja 4.9 välillä
,CASE WHEN d8.kansalaisuus_versio2_koodi = ''1'' Or d8b.kansalaisuus_versio1_koodi = ''1'' THEN
''finländare'' When d8.kansalaisuus_versio2_koodi = ''2'' Or d8.kansalaisuus_versio2_koodi = ''9'' Or d8b.kansalaisuus_versio1_koodi = ''2'' THEN ''andra''
 Else ''Okänd'' End as ''Medborgarskap (finska/andra)''
--
,d9.oppilaitos_SV as Läroanstalt
,d9.oppilaitos_SV as Universitet
,d9.oppilaitos_SV as Yrkeshögskola
--,d9.opetuskieli_SV as OpetuskieliSV
--,d9.oppilaitoksen_omistajatyyppi_SV as ''Oppil. omistajatyyppiSV''
--,d9.oppilaitostyyppi_SV as OppilaitostyyppiSV
--,d9b.koulutuksen_jarjestaja_SV as ''Koulutuksen järjestäjäSV''
--,d9b.koulutuksen_jarjestajan_omistajatyyppi_SV as ''Koul. järj. omistajatyyppiSV''
--,d10.lahde_SV as LähdeSV
,d11.koulutusohjelma_amk_SV as Utbildningsprogram

,d12b.opiskelijan_olo_tamm_SV as ''Inskrivning (januari)''
,d13.rahoituslahde_SV as Finansieringskälla
--,d15.suuntautumisvaihtoehto_amk_SV as SuuntautumisvaihtoehtoSV

--,d17.ensisijainen_opintooikeus_SV as ''Ensisijainen opinto-oikeusSV''
--,d18.tilauskoulutuksen_sijaintimaa_SV as ''Tilauskoulutuksen sijaintimaaSV''



,d21b.koulutuslaji_okm_SV as Utbildningsslag
,d21b.koulutuslaji_okm2_SV as Utbildningsslag2

--
--,d22b.avi_SV as ''Koul. järjestäjän AVISV''
--,d22b.ely_SV as ''Koul. järjestäjän ELYSV''
--,d22b.maakunta_SV as ''Koul. järjestäjän maakuntaSV''
--,d22b.kielisuhde_SV as ''Koul. järj. kunnan kielisuhdeSV''
--,d22b.kunta_SV as ''Koul. järjestäjän kuntaSV''
--,d22c.avi_SV as ''Oppilaitoksen AVISV''
--,d22c.ely_SV as ''Oppilaitoksen ELYSV''
--,d22c.maakunta_SV as ''Oppilaitoksen maakuntaSV''
--,d22c.kielisuhde_SV as ''Oppil. kunnan kielisuhdeSV''
--,d22c.kunta_SV as ''Oppilaitoksen kuntaSV''
--,d23.vuosiselite_SV as ''KirjoihintulovuosiSV''
--,d23b.lukukausiselite_SV as ''KirjoihintulokausiSV''
--,d24b.vuosiselite_SV as ''Kirjoihintulovuosi (kk-sek.)SV''
--,d24c.vuosiselite_SV as ''Kirjoihintulovuosi (kk-sek. läsna)SV''
--,d24d.vuosiselite_SV as ''Kirjoihintulovuosi (sek.)SV''
--,d24e.vuosiselite_SV as ''Kirjoihintulovuosi (sek. läsnä)SV''
--,d24f.vuosiselite_SV as ''Kirjoihintulovuosi (kk)SV''
--,d24f2.lukukausiselite_SV as ''Kirjoihintulokausi (kk)SV''
--,d24g.vuosiselite_SV as ''Kirjoihintulovuosi (kk läsnä)SV''
--,d24h.vuosiselite_SV as ''Kirjoihintulovuosi (op.ala)SV''
--,d24i.vuosiselite_SV as ''Kirjoihintulovuosi (op.ala läsnä)SV''
--,d24j.vuosiselite_SV as ''Kirjoihintulovuosi (tutk.)SV''
--,d24k.lukukausiselite_SV as ''Kirjoihintulokausi (tutk.)SV''
--,d28.vahintaan_55_op_suorittanut_SV as ''Suorittanut väh. 55 opSV''
--,d29.opiskelijan_fte_tieto_SV as ''Opiskelijan FTE-tietoSV''
--,d30.opiskelumuoto_SV as OpiskelumuotoSV
--,d31.yliopisto_SV as YliopistotunnusSV
--,d32.tiedekunta_yo_SV as TiedekuntaSV
--,d33.uusi_vanha_opiskelija_SV as ''Uusi/vanha opiskelijaSV''
--,d35.opettajankelpoisuus_SV as OpettajankelpoisuusSV
--,d36.avoinvayla_SV as ''Hyväksytty avoimen yliop. suoritusten kauttaSV''
,d37.vuosiselite_SV as ''År då utbildningen avlagts''
--,d38.lukukausiselite_SV as ''Tutk. suorituslukukausiSV''
--,d39.kuukausiselite_SV as ''Tutk. suorituskuukausiSV''

,d41.eumaa_SV as ''Medborgare i ett EU-land''
,d42.etamaa_SV as ''Medborgare i ett EES-land''
,d43.pohjoismaa_SV as ''Medborgare i ett nordiskt land''



/*** ENGLANTI ***/
,[Tilastovuosi] as ''Statistical year''


--,d3b.avi_EN as ''Til.v:tta edeltävä AVIEN''
--,d3b.ely_EN as ''Til.v:tta edeltävä ELYEN''
--,d3b.kielisuhde_EN as ''Til.v:tta ed. asuinkunnan kielisuhdeEN''
--,d3b.maakunta_EN as ''Til.v:tta ed. asuinmaakuntaEN''
--,d3b.kunta_EN as ''Til.v:tta ed. asuinkuntaEN''
--,d3c.avi_EN as ''2v til.v:tta ed. AVIEN''
--,d3c.ely_EN as ''2v til.v:tta ed. ELYEN''
--,d3c.kielisuhde_EN as ''2v til.v:tta ed. asuinkunnan kielisuhdeEN''
--,d3c.maakunta_EN as ''2v til.v:tta ed. asuinmaakuntaEN''
--,d3c.kunta_EN as ''2v til.v:tta ed. asuinkuntaEN''

,d5.ika_EN as Age
,d5.ika5v_EN as Agegroup
,d5b.vuosiselite_EN as ''Year of birth''
--,d5c.kuukausiselite_EN as SyntymäkuukausiEN
,d6a.tutkinto_amk_EN as ''Degree (polytechnic)''
,d6b.tutkinto_yo_EN as ''Degree (university)''
,d7.koulutustyyppi_EN as ''Type of education''
,d8.kansalaisuus_versio2_EN as Nationality
,d8b.kansalaisuus_versio1_EN as ''Nationality (ed. structure)''
--luodaan yhdistetty kansalaisuus-muuttuja, joka toimii aineistojen 2.8, 2.9, ja 4.9 välillä
,CASE WHEN d8.kansalaisuus_versio2_koodi = ''1'' Or d8b.kansalaisuus_versio1_koodi = ''1'' THEN
''Finn'' When d8.kansalaisuus_versio2_koodi = ''2'' Or d8.kansalaisuus_versio2_koodi = ''9'' Or d8b.kansalaisuus_versio1_koodi = ''2'' THEN ''Other''
 Else ''Unknown'' End as ''Nationality (Finn/Other)''
--
,d9.oppilaitos_EN as ''Educational institution''
,d9.oppilaitos_EN as University
,d9.oppilaitos_EN as Polytechnic
--,d9.opetuskieli_EN as OpetuskieliEN
--,d9.oppilaitoksen_omistajatyyppi_EN as ''Oppil. omistajatyyppiEN''
--,d9.oppilaitostyyppi_EN as OppilaitostyyppiEN
--,d9b.koulutuksen_jarjestaja_EN as ''Koulutuksen järjestäjäEN''
--,d9b.koulutuksen_jarjestajan_omistajatyyppi_EN as ''Koul. järj. omistajatyyppiEN''
--,d10.lahde_EN as LähdeEN
,d11.koulutusohjelma_amk_EN as ''Degree programme''

,d12b.opiskelijan_olo_tamm_EN as ''Enrollment status (jan.)''
,d13.rahoituslahde_EN as ''Source of funding''
--,d15.suuntautumisvaihtoehto_amk_EN as SuuntautumisvaihtoehtoEN

--,d17.ensisijainen_opintooikeus_EN as ''Ensisijainen opinto-oikeusEN''
--,d18.tilauskoulutuksen_sijaintimaa_EN as ''Tilauskoulutuksen sijaintimaaEN''



,d21b.koulutuslaji_okm_EN as ''Form of education''
,d21b.koulutuslaji_okm2_EN as ''Form of education2''
--,d22.avi_EN as ''Koulutuksen AVIEN''

--
--,d22b.avi_EN as ''Koul. järjestäjän AVIEN''
--,d22b.ely_EN as ''Koul. järjestäjän ELYEN''
--,d22b.maakunta_EN as ''Koul. järjestäjän maakuntaEN''
--,d22b.kielisuhde_EN as ''Koul. järj. kunnan kielisuhdeEN''
--,d22b.kunta_EN as ''Koul. järjestäjän kuntaEN''
--,d22c.avi_EN as ''Oppilaitoksen AVIEN''
--,d22c.ely_EN as ''Oppilaitoksen ELYEN''
--,d22c.maakunta_EN as ''Oppilaitoksen maakuntaEN''
--,d22c.kielisuhde_EN as ''Oppil. kunnan kielisuhdeEN''
--,d22c.kunta_EN as ''Oppilaitoksen kuntaEN''
,d23.vuosiselite_EN as ''Year of enrollment''
,d23b.lukukausiselite_EN as ''Term of enrollment''
,d24b.vuosiselite_EN as ''Year of enrollment (HE sec.)''
,d24c.vuosiselite_EN as ''Year of enrollment (HE sec. present)''
,d24d.vuosiselite_EN as ''Year of enrollment (sec.)''
,d24e.vuosiselite_EN as ''Year of enrollment (sec. present)''
,d24f.vuosiselite_EN as ''Year of enrollment (ed. inst.)''
,d24f2.lukukausiselite_EN as ''Term of enrollment (ed. inst.)''
,d24g.vuosiselite_EN as ''Year of enrollment (ed. inst. present)''
,d24h.vuosiselite_EN as ''Year of enrollment (subfield of ed.)''
,d24i.vuosiselite_EN as ''Year of enrollment (subfield of ed. present)''
,d24j.vuosiselite_EN as ''Year of enrollment (degree)''
,d24k.lukukausiselite_EN as ''Term of enrollment (degree)''
--,d28.vahintaan_55_op_suorittanut_EN as ''Suorittanut väh. 55 opEN''
--,d29.opiskelijan_fte_tieto_EN as ''Opiskelijan FTE-tietoEN''
--,d30.opiskelumuoto_EN as OpiskelumuotoEN
--,d31.yliopisto_EN as YliopistotunnusEN
--,d32.tiedekunta_yo_EN as TiedekuntaEN
--,d33.uusi_vanha_opiskelija_EN as ''Uusi/vanha opiskelijaEN''
--,d35.opettajankelpoisuus_EN as OpettajankelpoisuusEN
--,d36.avoinvayla_EN as ''Hyväksytty avoimen yliop. suoritusten kauttaEN''
,d37.vuosiselite_EN as ''Year of graduation''
,d38.lukukausiselite_EN as ''Term of graduation''
,d39.kuukausiselite_EN as ''Month of graduation''

,d41.eumaa_EN as ''Citizen of EU nation''
,d42.etamaa_EN as ''Citizen of EEA nation''
,d43.pohjoismaa_EN as ''Citizen of a nordic nation''
--isced
,d21.iscle2011 as ''Koulutusaste, taso 1''
,d21.Koulutusaste_taso2 as ''Koulutusaste, taso 2''
,d21.iscfibroad2013 as ''Koulutusala, taso 1''
,d21.iscfinarrow2013 as ''Koulutusala, taso 2''
,d21.iscfi2013 as ''Koulutusala, taso 3''
,d21.OKM_ohjauksen_ala as ''OKM ohjauksen ala, korkeak.''
,d21.iscle2011_SV as ''Utbildn.nivå, nivå 1''
,d21.Koulutusaste_taso2_SV as ''Utbildn.nivå, nivå 2''
,d21.iscfibroad2013_SV as ''Utbildn.område, nivå 1''
,d21.iscfinarrow2013_SV as ''Utbildn.område, nivå 2''
,d21.iscfi2013_SV as ''Utbildn.område, nivå 3''
,d21.OKM_ohjauksen_ala_SV as ''UKM-styrningsområde, högskolor''
,d21.iscle2011_EN as ''Level of ed., tier 1''
,d21.Koulutusaste_taso2_EN as ''Level of ed., tier 2''
,d21.iscfibroad2013_EN as ''Field of education, tier 1''
,d21.iscfinarrow2013_EN as ''Field of education, tier 2''
,d21.iscfi2013_EN as ''Field of education, tier 3''
,d21.OKM_ohjauksen_ala_EN as ''Field of ed., HE steering''
,d21.jarjestys_iscle2011 as jarj_isced_koulast1
,d21.jarjestys_Koulutusaste_taso2 as jarj_isced_koulast2
,d21.jarjestys_iscfibroad2013 as jarj_isced_koulala1
,d21.jarjestys_iscfinarrow2013 as jarj_isced_koulala2
,d21.jarjestys_iscfi2013 as jarj_isced_koulala3
,d21.jarjestys_OKM_ohjauksen_ala as jarj_isced_okmohjaus1
,d21.iscle2011_koodi as ''Koodit Koulutusaste, taso 1''
,d21.Koulutusaste_taso2_koodi as ''Koodit Koulutusaste, taso 2''
,d21.iscfibroad2013_koodi as ''Koodit Koulutusala, taso 1''
,d21.iscfinarrow2013_koodi as ''Koodit Koulutusala, taso 2''
,d21.iscfi2013_koodi as ''Koodit Koulutusala, taso 3''
,d21.OKM_ohjauksen_ala_koodi as ''Koodit OKM ohjauksen ala, korkeak.''



/*** Lukumäärämuuttujat ***/
,[Opisk2]
,[Aloit2]
,[lkm_op55] = CAST((case when d28.vahintaan_55_op_suorittanut_koodi = 1 then [Opisk2] end) as int)
,[lkm_op0]
,[lkm_op1_14]
,[lkm_op15_29]
,[lkm_op30_44]
,[lkm_op45_59]
,[lkm_op60_74]
,[lkm_op75_89]
,[lkm_op90_104]
,[lkm_op105_119]
,[lkm_op120_]
,[aloittaneet_kirjoihintulovuosi]
,[aloittaneet_korkeakoulusektori]
,[aloittaneet_korkeakoulusektori_lasnaoleva]
,[aloittaneet_sektori]
,[aloittaneet_sektori_lasnaoleva]
,[aloittaneet_korkeakoulu]
,[aloittaneet_korkeakoulu_lasnaoleva]
,[aloittaneet_opintoala]
,[aloittaneet_opintoala_lasnaoleva]
,[opiskelijat_lasna]
,[opiskelijat_fte]
,[lkm_lasnalk]
,[lkm_poissalk]
,[op_suoritettavien_laajuus]
,[op_edellinen_syksy]
,[op_edellinen_kevat]
,[op_kertyma_edel_lkv_loppu]
,[Tutk2]
,[op_amk_yhteensa]
,[op_amk_yleissiv_amm_opplait]
,[op_amk_muualla]
,[op_amk_oma_amk]
,[op_amk_muu_amk]
,[op_amk_yliopistoissa]
,[op_amk_ulkomailla]
,[op_yo_yhteensa]
,[op_yo_ulkomailla]
,[op_yo_muualla]
,[op_yo_oma_yo]
,[op_yo_avoimessa]
,[op_yo_muu_yo]
,[op_yo_ammattikorkeakouluissa]
,[ika19_21_lkm]
,[ika20_24_lkm]
,[ika25_34_lkm]
,[ika25_64_lkm]


*/

FROM (

/* K2.17 */
SELECT 

/* kaikille yhteiset dimensiot */
	   [tilastovuosi]
	  ,''K2.17'' AS Aineisto
      ,[sukupuoli_id]
      ,[kotikunta_id]

	  ,CASE 
			WHEN tilastovuosi between 2009 AND 2012 AND koulutussektori_id = 3 THEN -1
			WHEN koulutussektori_id <> 3 THEN 1
			ELSE [opetushallinnon_koulutus_id]
	   END AS [opetushallinnon_koulutus_id]

      ,[opiskelijan_olo_id]
      ,[koulutusluokitus_id]
      ,[koulutuksen_opetuskieli_id]
      ,[koulutuksen_sijaintikunta_id]
      ,[ika_id]
	  ,ikaryhma1_id

      ,[aidinkieli_versio1_id]
	  ,tutkinnon_aloittamisvuosi
	  ,jarjestys_tutkinnon_aloittamisvuosi
      ,[koulutussektori_id]
      ,[koulutusryhma_id]

/* osittain yhteiset dimensiot */
      ,[aineisto_id]
      ,[tutkinnon_toteuma_id] 
      ,[koulutuksen_jarjestamismuoto_id]
	  ,ikaryhma2_id
	  ,-1 as asuinmaakunta_id

/* K2.17 dimensiot */

      ,[asuinkunta_sama_vai_eri_kuin_aiemmin_id]	
      ,[edeltavan_vuoden_asuinpaikka_id]	 
      ,[suomeen_muuttamisvuosi]	  
      ,[aidinkieli_versio4_id]	
      ,[kansalaisuus_id]	 
      ,[syntymamaa_id]	 
      ,[aidin_syntymamaa_id]	 
      ,[isan_syntymamaa_id]	 
      ,[henkilotunnuksen_oikeellisuus_id]	
      ,[maassaolo_id] 
      ,[suoritusaika] 
	  ,[jarjestys_suoritusaika]
      ,[aidinkieli_versio2_id]
      ,[maahantulo_ja_toisen_asteen_koul_aloittaminen_id]
      ,[maahantulo_ja_korkeakoulutuksen_aloittaminen_id]
	  ,jarjestys_syntymavuosi
      ,[jarjestys_suomeen_muuttamisvuosi]

/*** yhteiset mittarit ***/

      ,NULL AS [aloittaneet]
      ,NULL AS [opiskelijat]
      ,NULL AS [tutkinnot]

/*** K2.17 mittarit ***/
	  ,aloittaneet AS aloittaneet2_17
	  ,opiskelijat AS opiskelijat2_17
	  ,tutkinnot AS tutkinnot2_17

      ,[aloittaneet_ulkomaalaistausta_kielen_mukaan]
      ,[opiskelijat_ulkomaalaistausta_kielen_mukaan]

      ,[tutkinnot_ulkomaalaistausta_kielen_mukaan]
      ,[aloittaneet_ulkomaalaistausta_vanhempien_synnyinmaan_mukaan]
      ,[opiskelijat_ulkomaalaistausta_vanhempien_synnyinmaan_mukaan]

      ,[tutkinnot_ulkomaalaistausta_vanhempien_synnyinmaan_mukaan]
      ,[aloittaneet_ulkomaalaiset]
      ,[opiskelijat_ulkomaalaiset]

      ,[tutkinnot_ulkomaalaiset]
      ,[aloittaneet_ulkomailla_syntyneet]
      ,[opiskelijat_ulkomailla_syntyneet]

      ,[tutkinnot_ulkomailla_syntyneet]

  FROM [dbo].[f_K2_17_ulkomaalaistaustaiset_opisk_ja_tutk]

UNION ALL

/* 2.3 */

SELECT

/* kaikille yhteiset dimensiot */
	   [tilv] AS Tilastovuosi
	  ,''2.3'' AS Aineisto
      ,[sukupuoli_id]
      ,''-1'' AS [kotikunta_id] --      ,[asuinmaakunta_id] 2.3

	  ,CASE 
			WHEN tilv between 2009 AND 2012 AND koulutussektori_id = 3 THEN -1
			WHEN tilv between 2009 AND 2012 AND koulutussektori_id <> 3 THEN 1
			ELSE [opetushallinnon_koulutus_id]
	   END AS [opetushallinnon_koulutus_id]

      ,[opiskelijan_olo_syys_id]
      ,[koulutusluokitus_id]
      ,[koulutuksen_kieli_id]
      ,[yht_koulutuksen_kunta_id]
      ,[ika_id]
	  ,ika_id as ikaryhma1_id

      ,[aidinkieli_versio1_id]
      ,[kirjoihintulovuosi]
	  ,jarjestys_kirjoihintulovuosi
      ,[koulutussektori_id]
      ,[koulutusryhma_id]

/* osittain yhteiset dimensiot */
      ,[aineisto_id]
      ,''-1'' AS [tutkinnon_toteuma_id] 
      ,''-1'' AS [koulutuksen_jarjestamismuoto_id]
	  ,-1 AS ikaryhma2_id
	  ,asuinmaakunta_id

/* K2.17 dimensiot */

      ,''-1'' AS [asuinkunta_sama_vai_eri_kuin_aiemmin_id]	
      ,''-1'' AS [edeltavan_vuoden_asuinpaikka_id]	 
      ,''Tuntematon'' AS [suomeen_muuttamisvuosi]
      ,''-1'' AS [aidinkieli_versio4_id]	
      ,''-1'' AS [kansalaisuus_id]	 
      ,''-1'' AS [syntymamaa_id]	 
      ,''-1'' AS [aidin_syntymamaa_id]	 
      ,''-1'' AS [isan_syntymamaa_id]	 
      ,''-1'' AS [henkilotunnuksen_oikeellisuus_id]	
      ,''-1'' AS [maassaolo_id] 
      ,''Tuntematon'' AS [suoritusaika] 
      ,9999 AS [jarjestys_suoritusaika] 
      ,''-1'' AS [aidinkieli_versio2_id]
      ,''-1'' AS [maahantulo_ja_toisen_asteen_koul_aloittaminen_id]
      ,''-1'' AS [maahantulo_ja_korkeakoulutuksen_aloittaminen_id]
	  ,9999 AS jarjestys_syntymavuosi
      ,9999 AS [jarjestys_suomeen_muuttamisvuosi]

/*** yhteiset mittarit ***/

      ,[aloittaneet]
      ,[opiskelijat]
      ,NULL AS [tutkinnot]

/*** K2.17 mittarit ***/
	  ,NULL AS aloittaneet2_17
	  ,NULL AS opiskelijat2_17
	  ,NULL AS tutkinnot2_17
      ,NULL AS [aloittaneet_ulkomaalaistausta_kielen_mukaan]
      ,NULL AS [opiskelijat_ulkomaalaistausta_kielen_mukaan]
      ,NULL AS [tutkinnot_ulkomaalaistausta_kielen_mukaan]
      ,NULL AS [aloittaneet_ulkomaalaistausta_vanhempien_synnyinmaan_mukaan]
      ,NULL AS [opiskelijat_ulkomaalaistausta_vanhempien_synnyinmaan_mukaan]
      ,NULL AS [tutkinnot_ulkomaalaistausta_vanhempien_synnyinmaan_mukaan]
      ,NULL AS [aloittaneet_ulkomaalaiset]
      ,NULL AS [opiskelijat_ulkomaalaiset]
      ,NULL AS [tutkinnot_ulkomaalaiset]
      ,NULL AS [aloittaneet_ulkomailla_syntyneet]
      ,NULL AS [opiskelijat_ulkomailla_syntyneet]
      ,NULL AS [tutkinnot_ulkomailla_syntyneet]

/* 2.3
SELECT 

	   [tilv]

      ,[oppilaitos]
      ,[oppilaitos_id]
      ,[oppilaitos_historia_id]
      ,[koulutuksen_jarjestaja]
      ,[koulutuksen_jarjestaja_id]
      ,[koulutuksen_jarjestaja_historia_id]
      ,[oppisopimuskoulutuksen_jarjestaja]
      ,[oppisopimuskoulutuksen_jarjestaja_id]
      ,[oppisopimuskoulutuksen_jarjestaja_historia_id]
      ,[koulutusluokitus]
      ,[koulutusluokitus_id]
      ,[koulutusluokitus_historia_id]
      ,[koulutuksen_kieli]
      ,[koulutuksen_kieli_id]
      ,[koulutuksen_kunta]
      ,[koulutuksen_kunta_id]
      ,[koulutuksen_kunta_historia_id]
      ,[opetushallinnon_koulutus]
      ,[opetushallinnon_koulutus_id]

      ,[aidinkieli_versio1]
      ,[aidinkieli_versio1_id]
      ,[kirjoihintulovuosi]
      ,[kirjoihintulovuosi_id]
      ,[kirjoihintulokausi]
      ,[kirjoihintulokausi_id]
      ,[opiskelijan_olo_tamm]
      ,[opiskelijan_olo_tamm_id]
      ,[opiskelijan_olo_syys]
      ,[opiskelijan_olo_syys_id]
      ,[aikuisopiskelija]
      ,[aikuisopiskelija_id]
      ,[ika_5v]
      ,[ika_id]
      ,[lukumaara]
      ,[lukiokoulutuksen_koulutuslaji]
      ,[lukiokoulutuksen_koulutuslaji_id]
      ,[nuorten_aikuisten_koulutus]
      ,[nuorten_aikuisten_koulutus_id]
      ,[koulutuksen_tutkinnon_aloitusvuosi]
      ,[koulutuksen_tutkinnon_aloitusvuosi_id]
      ,[koulutuksen_tutkinnon_aloituskausi]
      ,[koulutuksen_tutkinnon_aloituskausi_id]
      ,[ammatillisen_koulutuksen_koulutuslaji]
      ,[ammatillisen_koulutuksen_koulutuslaji_id]
      ,[tutkintonimike_ammpk]
      ,[tutkintonimike_ammpk_id]
      ,[koulutusohjelma_ammpk]
      ,[koulutusohjelma_ammpk_id]
      ,[opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus]
      ,[opetussuunnitelmaperusteinen_koulutus_nayttotutkintoon_valmistava_koulutus_id]
      ,[tyovoimapoliittinen_koulutus]
      ,[tyovoimapoliittinen_koulutus_id]
      ,[rahoituslahde_amm]
      ,[rahoituslahde_amm_id]
      ,[alkamispaivamaara]
      ,[alkamispaivamaara_id]
      ,[paattymispaivamaara]
      ,[paattymispaivamaara_id]
      ,[tutkinnon_tavoite]
      ,[tutkinnon_tavoite_id]
      ,[yrittajan_oppisopimuskoulutus]
      ,[yrittajan_oppisopimuskoulutus_id]
      ,[oppisopimus_purkautunut]
      ,[oppisopimus_purkautunut_id]
      ,[todistus_oppisopimuskoulutuksen_suorittamisesta]
      ,[todistus_oppisopimuskoulutuksen_suorittamisesta_id]
      ,[toimiala_2008]
      ,[toimiala_2008_id]
      ,[oppisopimus_yrityksen_koko]
      ,[oppisopimus_yrityksen_koko_id]
      ,[tyonantajasektori]
      ,[tyonantajasektori_id]
      ,[asuinmaakunta]
      ,[asuinmaakunta_id]
      ,[asuinmaakunta_historia_id]
      ,[tietolahde]
      ,[rivinumero]
      ,[aineistotunnus]
      ,[koulutussektori]
      ,[koulutussektori_id]
      ,[hallinnonala]
      ,[hallinnonala_id]
      ,[koulutuksen_jarjestamismuoto]
      ,[koulutuksen_jarjestamismuoto_id]
      ,[ammatillinen_peruskoulutus_lisakoulutus]
      ,[ammatillinen_peruskoulutus_lisakoulutus_id]
      ,[koulutuksen_tavoite_toteuma]
      ,[koulutuksen_tavoite_toteuma_id]
      ,[tyovoimapoliittinen]
      ,[tyovoimapoliittinen_id]
      ,[aloittaneet]
      ,[opiskelijat]
      ,[opiskelijat_lasna]
      ,[aineisto_id]
      ,[aineisto_OTV_id]
      ,[koulutuksen_jarjestaja_kunta_id]
      ,[koulutuksen_jarjestaja_kunta_historia_id]
      ,[oppilaitos_kunta_id]
      ,[oppilaitos_kunta_historia_id]
      ,[nuorten_aikuisten_koulutus_amm_id]
      ,[koulutuslaji_OKM_id]
      ,[yht_koulutuksen_jarjestaja_id]
      ,[yht_koulutuksen_jarjestaja_historia_id]
      ,[yht_oppilaitos_id]
      ,[yht_oppilaitos_historia_id]
      ,[yht_koulutuksen_jarjestaja_kunta_id]
      ,[yht_koulutuksen_jarjestaja_kunta_historia_id]
      ,[yht_oppilaitos_kunta_id]
      ,[yht_oppilaitos_kunta_historia_id]
      ,[yht_koulutuksen_kunta_id]
      ,[yht_koulutuksen_kunta_historia_id]

*/

   FROM [VipunenTK].[dbo].[f_OTV_2_3_Lukiokoulutuksen_ja_ammatillisen_koulutuksen_opiskelijat]

UNION ALL

/* 2.4 */

SELECT

/* kaikille yhteiset dimensiot */
	   [tilastointivuosi] AS Tilastovuosi
	  ,''2.4'' AS Aineisto
      ,[sukupuoli_id]
      ,''-1'' AS [kotikunta_id] --      ,[asuinmaakunta_id] 2.3

	  ,CASE 
			WHEN tilastointivuosi between 2009 AND 2012 AND koulutussektori_id = 3 THEN -1
			WHEN tilastointivuosi between 2009 AND 2012 AND koulutussektori_id <> 3 THEN 1
			ELSE [opetushallinnon_koulutus_id]
	   END AS [opetushallinnon_koulutus_id]

      ,''-1'' AS [opiskelijan_olo_syys_id]
      ,[koulutusluokitus_id]
      ,[koulutuksen_kieli_id]
      ,[yht_koulutuksen_kunta_id]
      ,[ika_id]
	  ,ika_id as ikaryhma1_id
      ,[aidinkieli_versio1_id]
      ,[kirjoihintulovuosi]
	  ,jarjestys_kirjoihintulovuosi
      ,[koulutussektori_id]
      ,[koulutusryhma_id]	 

/* osittain yhteiset dimensiot */
      ,[aineisto_id]
      ,[tutkinnon_toteuma_id] 
      ,[koulutuksen_jarjestamismuoto_id]
	  ,-1 AS ikaryhma2_id
	  ,-1 AS asuinmaakunta_id

/* K2.17 dimensiot */

      ,''-1'' AS [asuinkunta_sama_vai_eri_kuin_aiemmin_id]	
      ,''-1'' AS [edeltavan_vuoden_asuinpaikka_id]	 
      ,''Tuntematon'' AS [suomeen_muuttamisvuosi]	  
      ,''-1'' AS [aidinkieli_versio4_id]	
      ,''-1'' AS [kansalaisuus_id]	 
      ,''-1'' AS [syntymamaa_id]	 
      ,''-1'' AS [aidin_syntymamaa_id]	 
      ,''-1'' AS [isan_syntymamaa_id]	 
      ,''-1'' AS [henkilotunnuksen_oikeellisuus_id]	
      ,''-1'' AS [maassaolo_id] 
      ,''Tuntematon'' AS [suoritusaika] 
      ,9999 AS [jarjestys_suoritusaika] 
      ,''-1'' AS [aidinkieli_versio2_id]
      ,''-1'' AS [maahantulo_ja_toisen_asteen_koul_aloittaminen_id]
      ,''-1'' AS [maahantulo_ja_korkeakoulutuksen_aloittaminen_id]
	  ,9999 AS jarjestys_syntymavuosi
      ,9999 AS [jarjestys_suomeen_muuttamisvuosi]

/*** yhteiset mittarit ***/

      ,NULL AS [aloittaneet]
      ,NULL AS [opiskelijat]
      ,[tutkinnot]

/*** K2.17 mittarit ***/
	  ,NULL AS aloittaneet2_17
	  ,NULL AS opiskelijat2_17
	  ,NULL AS tutkinnot2_17
      ,NULL AS [aloittaneet_ulkomaalaistausta_kielen_mukaan]
      ,NULL AS [opiskelijat_ulkomaalaistausta_kielen_mukaan]
      ,NULL AS [tutkinnot_ulkomaalaistausta_kielen_mukaan]
      ,NULL AS [aloittaneet_ulkomaalaistausta_vanhempien_synnyinmaan_mukaan]
      ,NULL AS [opiskelijat_ulkomaalaistausta_vanhempien_synnyinmaan_mukaan]
      ,NULL AS [tutkinnot_ulkomaalaistausta_vanhempien_synnyinmaan_mukaan]
      ,NULL AS [aloittaneet_ulkomaalaiset]
      ,NULL AS [opiskelijat_ulkomaalaiset]
      ,NULL AS [tutkinnot_ulkomaalaiset]
      ,NULL AS [aloittaneet_ulkomailla_syntyneet]
      ,NULL AS [opiskelijat_ulkomailla_syntyneet]
      ,NULL AS [tutkinnot_ulkomailla_syntyneet]


   FROM [VipunenTK].[dbo].[f_OTV_2_4_Ammatillisen_koulutuksen_tutkinnot]

UNION ALL

/* 2.8 */

SELECT 

/* kaikille yhteiset dimensiot */
	   [tilastointivuosi] AS Tilastovuosi
	  ,''2.8'' AS Aineisto
      ,[sukupuoli_id]
      ,[kotikunta_id] --      ,[asuinmaakunta_id] 2.3
      ,[opetushallinnon_koulutus_id]
      ,[opiskelijan_olo_syys_id]
      ,[koulutusluokitus_id]
      ,[koulutuksen_kieli_id]
      ,[koulutuksen_kunta_id]
      ,[ika_id]
	  ,ikaryhma1_id
      ,[aidinkieli_versio1_id]
      ,[kirjoihintulovuosi]
	  ,jarjestys_kirjoihintulovuosi
      ,[koulutussektori_id]
      ,[koulutusryhma_id]	

/* osittain yhteiset dimensiot */
      ,[aineisto_id]
      ,''-1'' AS [tutkinnon_toteuma_id] 
      ,''-1'' AS [koulutuksen_jarjestamismuoto_id]
	  ,ikaryhma2_id
	  ,-1 AS asuinmaakunta_id

/* K2.17 dimensiot */

      ,''-1'' AS [asuinkunta_sama_vai_eri_kuin_aiemmin_id]	
      ,''-1'' AS [edeltavan_vuoden_asuinpaikka_id]	 
      ,''Tuntematon'' AS [suomeen_muuttamisvuosi]	  
      ,''-1'' AS [aidinkieli_versio4_id]	
      ,''-1'' AS [kansalaisuus_id]	 
      ,''-1'' AS [syntymamaa_id]	 
      ,''-1'' AS [aidin_syntymamaa_id]	 
      ,''-1'' AS [isan_syntymamaa_id]	 
      ,''-1'' AS [henkilotunnuksen_oikeellisuus_id]	
      ,''-1'' AS [maassaolo_id] 
      ,''Tuntematon'' AS [suoritusaika] 
      ,9999 AS [jarjestys_suoritusaika] 
      ,''-1'' AS [aidinkieli_versio2_id]
      ,''-1'' AS [maahantulo_ja_toisen_asteen_koul_aloittaminen_id]
      ,''-1'' AS [maahantulo_ja_korkeakoulutuksen_aloittaminen_id]
	  ,9999 AS jarjestys_syntymavuosi
      ,9999 AS [jarjestys_suomeen_muuttamisvuosi]

/*** yhteiset mittarit ***/

      ,[aloittaneet]
      ,[opiskelijat]
      ,NULL AS [tutkinnot]

/*** K2.17 mittarit ***/
	  ,NULL AS aloittaneet2_17
	  ,NULL AS opiskelijat2_17
	  ,NULL AS tutkinnot2_17
      ,NULL AS [aloittaneet_ulkomaalaistausta_kielen_mukaan]
      ,NULL AS [opiskelijat_ulkomaalaistausta_kielen_mukaan]
      ,NULL AS [tutkinnot_ulkomaalaistausta_kielen_mukaan]
      ,NULL AS [aloittaneet_ulkomaalaistausta_vanhempien_synnyinmaan_mukaan]
      ,NULL AS [opiskelijat_ulkomaalaistausta_vanhempien_synnyinmaan_mukaan]
      ,NULL AS [tutkinnot_ulkomaalaistausta_vanhempien_synnyinmaan_mukaan]
      ,NULL AS [aloittaneet_ulkomaalaiset]
      ,NULL AS [opiskelijat_ulkomaalaiset]
      ,NULL AS [tutkinnot_ulkomaalaiset]
      ,NULL AS [aloittaneet_ulkomailla_syntyneet]
      ,NULL AS [opiskelijat_ulkomailla_syntyneet]
      ,NULL AS [tutkinnot_ulkomailla_syntyneet]

  FROM [VipunenTK].[dbo].[f_OTV_2_8_Korkeakouluopiskelijat]

UNION ALL

/* 2.9 */

SELECT 

/* kaikille yhteiset dimensiot */
	   [tilastointivuosi] AS Tilastovuosi
	  ,''2.9'' AS Aineisto
      ,[sukupuoli_id]
      , [kotikunta_id] --      ,[asuinmaakunta_id] 2.3
      ,[opetushallinnon_koulutus_id]
      ,''-1'' AS [opiskelijan_olo_syys_id]
      ,[koulutusluokitus_id]
      ,[koulutuksen_kieli_id]
      ,[koulutuksen_kunta_id]
      ,[ika_id]
	  ,ikaryhma1_id
      ,[aidinkieli_versio1_id]
      ,[kirjoihintulovuosi]
	  ,jarjestys_kirjoihintulovuosi
      ,[koulutussektori_id]
      ,[koulutusryhma_id]	 

/* osittain yhteiset dimensiot */
      ,[aineisto_id]
      ,''-1'' AS [tutkinnon_toteuma_id] 
      ,''-1'' AS [koulutuksen_jarjestamismuoto_id]
	  ,ikaryhma2_id
	  ,-1 AS asuinmaakunta_id

/* K2.17 dimensiot */

      ,''-1'' AS [asuinkunta_sama_vai_eri_kuin_aiemmin_id]	
      ,''-1'' AS [edeltavan_vuoden_asuinpaikka_id]	 
      ,''Tuntematon'' AS [suomeen_muuttamisvuosi]	  
      ,''-1'' AS [aidinkieli_versio4_id]	
      ,''-1'' AS [kansalaisuus_id]	 
      ,''-1'' AS [syntymamaa_id]	 
      ,''-1'' AS [aidin_syntymamaa_id]	 
      ,''-1'' AS [isan_syntymamaa_id]	 
      ,''-1'' AS [henkilotunnuksen_oikeellisuus_id]	
      ,''-1'' AS [maassaolo_id] 
      ,''Tuntematon'' AS [suoritusaika] 
      ,9999 AS [jarjestys_suoritusaika] 
      ,''-1'' AS [aidinkieli_versio2_id]
      ,''-1'' AS [maahantulo_ja_toisen_asteen_koul_aloittaminen_id]
      ,''-1'' AS [maahantulo_ja_korkeakoulutuksen_aloittaminen_id]
	  ,9999 AS jarjestys_syntymavuosi
      ,9999 AS [jarjestys_suomeen_muuttamisvuosi]

/*** yhteiset mittarit ***/

      ,NULL AS [aloittaneet]
      ,NULL AS [opiskelijat]
      ,[tutkinnot]

/*** K2.17 mittarit ***/
	  ,NULL AS aloittaneet2_17
	  ,NULL AS opiskelijat2_17
	  ,NULL AS tutkinnot2_17
      ,NULL AS [aloittaneet_ulkomaalaistausta_kielen_mukaan]
      ,NULL AS [opiskelijat_ulkomaalaistausta_kielen_mukaan]
      ,NULL AS [tutkinnot_ulkomaalaistausta_kielen_mukaan]
      ,NULL AS [aloittaneet_ulkomaalaistausta_vanhempien_synnyinmaan_mukaan]
      ,NULL AS [opiskelijat_ulkomaalaistausta_vanhempien_synnyinmaan_mukaan]
      ,NULL AS [tutkinnot_ulkomaalaistausta_vanhempien_synnyinmaan_mukaan]
      ,NULL AS [aloittaneet_ulkomaalaiset]
      ,NULL AS [opiskelijat_ulkomaalaiset]
      ,NULL AS [tutkinnot_ulkomaalaiset]
      ,NULL AS [aloittaneet_ulkomailla_syntyneet]
      ,NULL AS [opiskelijat_ulkomailla_syntyneet]
      ,NULL AS [tutkinnot_ulkomailla_syntyneet]


   FROM [VipunenTK].[dbo].[f_OTV_2_9_Korkeakoulututkinnot]

  ) f

	LEFT JOIN [dbo].d_sukupuoli d4 ON d4.id = f.sukupuoli_id
	LEFT JOIN [dbo].d_alueluokitus d3 ON d3.id = f.kotikunta_id
	LEFT JOIN [dbo].d_alueluokitus d3b ON d3b.id = f.asuinmaakunta_id


	LEFT JOIN [dbo].d_opetushallinnon_koulutus d20 ON d20.id = f.opetushallinnon_koulutus_id
	LEFT JOIN [dbo].d_koulutusluokitus d21 ON d21.id = f.koulutusluokitus_id
	LEFT JOIN [dbo].d_kieli d16 ON d16.id = f.koulutuksen_opetuskieli_id
	LEFT JOIN [dbo].d_alueluokitus d22 ON d22.id = f.koulutuksen_sijaintikunta_id
	LEFT JOIN [dbo].d_opiskelijan_olo d12 ON d12.id = f.opiskelijan_olo_id
	LEFT JOIN [dbo].d_aineisto d1 ON d1.id = f.aineisto_id
	LEFT JOIN [dbo].d_koulutussektori d19 ON d19.id = f.koulutussektori_id

	LEFT JOIN [dbo].d_ika d5 ON d5.id = f.ika_id
	LEFT JOIN [dbo].d_ika d5b ON d5b.id = f.ikaryhma1_id
	LEFT JOIN [dbo].d_ika d5c ON d5c.id = f.ikaryhma2_id

	LEFT JOIN [dbo].d_aidinkieli_versio1 d2 ON d2.id = f.aidinkieli_versio1_id
--	LEFT JOIN [dbo].d_aidinkieli_versio2 d2b ON d2b.id = f.aidinkieli_versio2_id
	/** tähän asti löytyi vanhasta näkymästä valmiita joineja **/

	LEFT JOIN [dbo].d_asuinkunta_sama_vai_eri_kuin_aiemmin d50 ON d50.id = f.asuinkunta_sama_vai_eri_kuin_aiemmin_id

	LEFT JOIN [dbo].d_edeltavan_vuoden_asuinpaikka d51 ON d51.id = f.edeltavan_vuoden_asuinpaikka_id

	LEFT JOIN [dbo].d_kieli d52 ON d52.id = f.aidinkieli_versio4_id

	LEFT JOIN [dbo].d_valtio d53 ON d53.id = f.kansalaisuus_id
	LEFT JOIN [dbo].d_valtio d53b ON d53b.id = f.syntymamaa_id
	LEFT JOIN [dbo].d_valtio d53c ON d53c.id = f.aidin_syntymamaa_id
	LEFT JOIN [dbo].d_valtio d53d ON d53d.id = f.isan_syntymamaa_id
 
	LEFT JOIN [dbo].d_hetu_ok d54 ON d54.id = f.henkilotunnuksen_oikeellisuus_id
	LEFT JOIN [dbo].d_koulutusryhma d55 ON d55.id = f.koulutusryhma_id

	LEFT JOIN [dbo].d_maassaolo d56 ON d56.id = f.maassaolo_id

	LEFT JOIN [dbo].d_tutkinnon_toteuma d57 ON d57.id = f.tutkinnon_toteuma_id

	LEFT JOIN [dbo].d_maahantulo_ja_opiskelun_aloittaminen d58 ON d58.id = f.maahantulo_ja_toisen_asteen_koul_aloittaminen_id
	LEFT JOIN [dbo].d_maahantulo_ja_opiskelun_aloittaminen d59 ON d59.id = f.maahantulo_ja_korkeakoulutuksen_aloittaminen_id

	LEFT JOIN [dbo].d_koulutuksen_jarjestamismuoto d60 ON d60.id = f.[koulutuksen_jarjestamismuoto_id]


WHERE tilastovuosi > 2009
AND d1.aineisto_koodi in (''L'',''-1'') -- lisätään ennakot myöhemmin
AND d57.tutkinnon_toteuma_koodi in (''1'', ''-1'') -- koko tutkinnot, tuntemattomat

AND NOT (d5c.ika_avain in (''-1'',''ikaryh2_12'', ''ikaryh2_15'', ''ikaryh2_18'') AND d19.koulutussektori_koodi IN (''4'', ''5'') )-- rajataan korkeakoulupuolelta nuoremmat ikäryhmä2:t pois pois, koska muuttujaa käytetään vain korkeakouluraportoinnissa

AND NOT (d21.koulutusala2002_koodi = 9 AND d19.koulutussektori_koodi IN (''4'', ''5''))     -- rajataan muu koulutus pois kk-puolelta



  /*

 

	INNER JOIN [dbo].d_aineisto_OTV d1b ON d1b.id = f.aineisto_OTV_id


	INNER JOIN [dbo].d_alueluokitus d3b ON d3b.id = f.kotikunta1x_id



	INNER JOIN [dbo].d_alueluokitus d3c ON d3c.id = f.kotikunta2x_id


	INNER JOIN [dbo].d_kausi d5b ON d5b.kausi_id = f.syntymavuosi_id
	INNER JOIN [dbo].d_kausi d5c ON d5c.kausi_id = f.syntymakuukausi_id
	INNER JOIN [dbo].d_tutkinto_amk d6a ON d6a.id = f.tutkinto_amk_id
	INNER JOIN [dbo].d_tutkinto_yo d6b ON d6b.id = f.tutkinto_yo_id
	INNER JOIN [dbo].d_koulutustyyppi d7 ON d7.id = f.koulutustyyppi_id
	INNER JOIN [dbo].d_kansalaisuus_versio2 d8 ON d8.id = f.kansalaisuus_versio2_id
	INNER JOIN [dbo].d_kansalaisuus_versio1 d8b ON d8b.id = f.kansalaisuus_versio1_id
	INNER JOIN [dbo].d_oppilaitoksen_taustatiedot d9 ON d9.id = f.oppilaitos_id
	INNER JOIN [dbo].d_oppilaitoksen_taustatiedot d9b ON d9b.id = f.koulutuksen_jarjestaja_id
	INNER JOIN [dbo].d_lahde d10 ON d10.id = f.lahde_id
	INNER JOIN [dbo].d_koulutusohjelma_amk d11 ON d11.id = f.koulutusohjelma_amk_id

	INNER JOIN [dbo].d_opiskelijan_olo_tamm d12b ON d12b.id = f.opiskelijan_olo_tamm_id
	INNER JOIN [dbo].d_rahoituslahde d13 ON d13.id = f.rahoituslahde_id
	INNER JOIN [dbo].d_suuntautumisvaihtoehto_amk d15 ON d15.id = f.suuntautumisvaihtoehto_amk_id

	INNER JOIN [dbo].d_ensisijainen_opintooikeus d17 ON d17.id = f.ensisijainen_opintooikeus_id
	INNER JOIN [dbo].d_tilauskoulutuksen_sijaintimaa d18 ON d18.id = f.tilauskoulutuksen_sijaintimaa_id


	INNER JOIN [dbo].d_koulutusluokitus d21 ON d21.id = f.koulutusluokitus_id
	INNER JOIN [dbo].d_koulutuslaji_okm d21b ON d21b.id = f.koulutuslaji_OKM_id

	INNER JOIN [dbo].d_alueluokitus d22b ON d22b.id = f.koulutuksen_jarjestaja_kunta_id
	INNER JOIN [dbo].d_alueluokitus d22c ON d22c.id = f.oppilaitos_kunta_id
	INNER JOIN [dbo].d_kausi d23 ON d23.kausi_id = f.kirjoihintulovuosi_id
	INNER JOIN [dbo].d_kausi d23b ON d23b.kausi_id = f.kirjoihintulokausi_id
	INNER JOIN [dbo].d_kausi d24b ON d24b.kausi_id = f.kirjoihintulovuosi_korkeakoulusektori_id
	INNER JOIN [dbo].d_kausi d24c ON d24c.kausi_id = f.kirjoihintulovuosi_korkeakoulusektori_lasnaoleva_id
	INNER JOIN [dbo].d_kausi d24d ON d24d.kausi_id = f.kirjoihintulovuosi_sektori_id
	INNER JOIN [dbo].d_kausi d24e ON d24e.kausi_id = f.kirjoihintulovuosi_sektori_lasnaoleva_id
	INNER JOIN [dbo].d_kausi d24f ON d24f.kausi_id = f.kirjoihintulovuosi_korkeakoulu_id
	INNER JOIN [dbo].d_kausi d24f2 ON d24f2.kausi_id = f.kirjoihintulokausi_korkeakoulu_id
	INNER JOIN [dbo].d_kausi d24g ON d24g.kausi_id = f.kirjoihintulovuosi_korkeakoulu_lasnaoleva_id
	INNER JOIN [dbo].d_kausi d24h ON d24h.kausi_id = f.kirjoihintulovuosi_opintoala_id
	INNER JOIN [dbo].d_kausi d24i ON d24i.kausi_id = f.kirjoihintulovuosi_opintoala_lasnaoleva_id
	INNER JOIN [dbo].d_kausi d24j ON d24j.kausi_id = f.kirjoihintulovuosi_tutkinto_id
	INNER JOIN [dbo].d_kausi d24k ON d24k.kausi_id = f.kirjoihintulokausi_tutkinto_id
	INNER JOIN [dbo].d_vahintaan_55_op_suorittanut d28 ON d28.id = f.vahintaan_55_op_suorittanut_id
	INNER JOIN [dbo].d_opiskelijan_fte_tieto d29 ON d29.id = f.opiskelijan_fte_tieto_id
	--INNER JOIN [dbo].d_opiskelumuoto d30 ON d30.id = f.opiskelumuoto_id
	INNER JOIN [dbo].d_yliopisto d31 ON d31.id = f.yliopisto_id
	INNER JOIN [dbo].d_tiedekunta_yo d32 ON d32.id = f.tiedekunta_yo_id
	INNER JOIN [dbo].d_uusi_vanha_opiskelija d33 ON d33.id = f.uusi_vanha_opiskelija_id
	--INNER JOIN [dbo].d_kausi d34 ON d34.kausi_id = f.tutkintooikeusvuosi_id
	INNER JOIN [dbo].d_opettajankelpoisuus d35 ON d35.id = f.opettajankelpoisuus_id
	INNER JOIN [dbo].d_avoinvayla d36 ON d36.id = f.avoinvayla_id
	INNER JOIN [dbo].d_kausi d37 ON d37.kausi_id = f.tutkinnon_suoritusvuosi_id
	INNER JOIN [dbo].d_kausi d38 ON d38.kausi_id = f.tutkinnon_suorituslukukausi_id
	INNER JOIN [dbo].d_kausi d39 ON d39.kausi_id = f.tutkinnon_suorituskuukausi_id
	INNER JOIN [dbo].d_valtio_historia d40 ON d40.id = f.maanosa_id
	INNER JOIN [dbo].d_valtio_historia d41 ON d41.id = f.eumaa_id
	INNER JOIN [dbo].d_valtio_historia d42 ON d42.id = f.etamaa_id
	INNER JOIN [dbo].d_pohjoismaa d43 ON d43.id = f.pohjoismaa_id


WHERE d1.aineisto_koodi in (''L'',''-1'') AND d9.oppilaitoskoodi <> ''02557'' AND d9.oppilaitoskoodi <> ''10031'' AND d9.oppilaitoskoodi <> ''02358''

	*/























' 
GO
/****** Object:  View [dbo].[v_f_tab_ulkomaalaistaustaiset]    Script Date: 21.6.2017 10:17:26 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_ulkomaalaistaustaiset]'))
EXEC dbo.sp_executesql @statement = N'

CREATE VIEW [dbo].[v_f_tab_ulkomaalaistaustaiset] AS
SELECT [aloittaneet] AS aloit2
	  ,[opiskelijat] AS opisk2
	  ,[tutkinnot] AS tutk2
	  ,[aloittaneet_ulkomaalaistausta_kielen_mukaan]
	  ,[opiskelijat_ulkomaalaistausta_kielen_mukaan]
	  ,[tutkinnot_ulkomaalaistausta_kielen_mukaan]
	  ,[aloittaneet_ulkomaalaistausta_vanhempien_synnyinmaan_mukaan]
	  ,[opiskelijat_ulkomaalaistausta_vanhempien_synnyinmaan_mukaan]
	  ,[tutkinnot_ulkomaalaistausta_vanhempien_synnyinmaan_mukaan]
	  ,[aloittaneet_ulkomaalaiset]
	  ,[opiskelijat_ulkomaalaiset]
	  ,[tutkinnot_ulkomaalaiset]
	  ,[aloittaneet_ulkomailla_syntyneet]
	  ,[opiskelijat_ulkomailla_syntyneet]
	  ,[tutkinnot_ulkomailla_syntyneet]
	  ,[tilastovuosi] AS Tilastovuosi
	  ,d1.aineisto AS Aineisto
	  ,d2.opintoala2002 AS [Opintoala]
	  ,d2.koulutusala2002 AS [Koulutusala]
	  ,d2.opintoala1995 AS [Koulutusala (95 luokitus)]
	  ,d2.koulutusala2002 AS [Koulutusala (02 luokitus)]
	  ,d2.koulutusaste2002 AS [Koulutusaste]
	  ,d3.koulutusryhma AS Koulutuslaji
	  ,d4.maassaolo AS Maassaolo
	  ,d5.opetushallinnon_koulutus AS Hallinnonala
	  ,[syntymavuosi] AS Syntymävuosi
	  ,[suomeen_muuttamisvuosi] AS [Suomeen muuttamisvuosi]
	  ,[tutkinnon_aloittamisvuosi] AS [Aloitusvuosi]
	  ,[suoritusaika] AS Suoritusaika
	  ,d6.kieli AS Opetuskieli
	  ,d7.tutkinnon_toteuma AS [Koko tutkinto/tutkinnon osa]
	  ,d8.kunta AS [Koulutuksen kunta]
	  ,d8.maakunta AS [Koulutuksen maakunta]
	  ,d8.ely AS [Koulutuksen ELY-alue]
	  ,d8.avi AS [Koulutuksen AVI-alue]
	  ,d8b.kunta AS [Asuinkunta]
	  ,d8b.maakunta AS [Asuinmaakunta]
	  ,d8b.ely AS [Asuinalueen ELY]
	  ,d8b.avi AS [Asuinalueen AVI]
	  ,d8c.asuinkunta_sama_vai_eri_kuin_aiemmin AS [Asuinkunta sama/eri kuin aikaisemmin]
	  ,d8d.edeltavan_vuoden_asuinpaikka AS [Edeltävän vuoden asuinpaikka]
	  ,d9.sukupuoli AS Sukupuoli
	  ,d10.hetu_ok AS [Henkilötunnuksen oikeellisuus]
	  ,d11.ika AS [Ikä]
	  ,d11.ika5v [Ikäryhmä]
	  ,d13.opiskelijan_olo AS [Kirjoillaolo (syys)]
	  ,d16.maa AS [Kansalaisuus (maa)]
	  ,d16.maanosa AS [Kansalaisuus (maanosa)]
	  ,d16.etamaa AS [ETA-maan kansalainen]
	  ,d16.eumaa AS [EU-maan kansalainen]
	  ,d18.maa AS [Syntymävaltio]
	  ,d18.maanosa AS [Syntymävaltio (maanosa)]
	  ,d18b.maa AS [Äidin syntymävaltio]
	  ,d18b.maanosa AS [Äidin syntymävaltio (maanosa)]
	  ,d18c.maa AS [Isän syntymävaltio]
	  ,d18c.maanosa AS [Isän syntymävaltio (maanosa)]
	  ,d19.maahantulo_ja_opiskelun_aloittaminen AS [Maahantulo ja toisen asteen koul. aloittaminen]
	  ,d20.maahantulo_ja_opiskelun_aloittaminen AS [Maahantulo ja korkeakoul. aloittaminen]
	  ,d21.aidinkieli_versio1 AS [Äidinkieli]
	  ,d21b.aidinkieli_versio2 AS [Äidinkieli (tarkennus)]
	  ,d21c.kieli AS [Äidinkieli (maa)]
	  ,d22.koulutussektori AS [Koulutussektori]
	  ,d1.aineisto_koodi
	  ,d2.jarjestys_opintoala2002 AS jarj_opintoala
	  ,d2.jarjestys_koulutusala2002
	  ,d2.jarjestys_opintoala1995
	  ,d2.jarjestys_koulutusaste2002
	  ,d3.jarjestys AS jarj_koullaji
	  ,d4.jarjestys AS jarj_maassaolo
	  ,d5.jarjestys AS jarj_hallinnonala
	  ,d6.jarjestys AS jarj_opetuskieli
	  ,d7.tutkinnon_toteuma_koodi
	  ,d7.jarjestys AS jarj_kokotutkinto
	  ,d8.jarjestys_maakunta
	  ,d8.jarjestys_ely
	  ,d8.jarjestys_avi
	  ,d8b.jarjestys as jarj_kunta
	  ,d8b.jarjestys_maakunta as jarj_asmaak
	  ,d8b.jarjestys_ely as jarj_ely
	  ,d8b.jarjestys_avi as jarj_avi
	  ,d8c.jarjestys as jarj_askuntasamaeri
	  ,d8d.jarjestys as jarj_edvuodenasuinpaikka
	  ,d9.jarjestys AS jarj_sukupuoli
	  ,d10.jarjestys as jarj_hetuok
	  ,d11.jarjestys_ika5v
	  ,d13.jarjestys AS jarj_kirjsyys
	  ,d16.jarjestys AS jarj_maa
	  ,d16.jarjestys_maanosa
	  ,d16.jarjestys_etamaa
	  ,d16.jarjestys_eumaa
	  ,d18.jarjestys AS jarj_syntvaltio
	  ,d18.jarjestys_maanosa AS jarj_syntmaanosa
	  ,d18b.jarjestys AS jarj_syntvaltioai
	  ,d18b.jarjestys_maanosa AS jarj_syntmaanosaai
	  ,d18c.jarjestys AS jarj_syntvaltiois
	  ,d18c.jarjestys_maanosa AS jarj_syntmaanosais
	  ,d19.jarjestys AS jarj_maahantulotoinenaste
	  ,d20.jarjestys AS jarj_maahantulokorkeak
	  ,d21.jarjestys AS jarj_aidinkieli
	  ,d21b.jarjestys AS jarj_aidinkieli2
	  ,d21c.jarjestys AS jarj_aidinkieli4
	  ,d22.jarjestys AS jarj_koulsektori
	  ,d2.koulutusaste2002_koodi
	  ,jarjestys_suoritusaika =
			CASE 
				WHEN suoritusaika = ''Tuntematon'' or suoritusaika IS NULL THEN 999
				ELSE cast(suoritusaika AS int)
			END


FROM            vipunentk.dbo.f_K2_17_ulkomaalaistaustaiset_opisk_ja_tutk
	JOIN d_aineisto d1 on d1.id = [aineisto_id]
	JOIN d_koulutusluokitus d2 on d2.id = [koulutusluokitus_id]
	JOIN d_koulutusryhma d3 on d3.id = [koulutusryhma_id]
	JOIN d_maassaolo d4 on d4.id = [maassaolo_id]
	JOIN d_opetushallinnon_koulutus d5 on d5.id = [opetushallinnon_koulutus_id]
	JOIN d_kieli d6 on d6.id = [koulutuksen_opetuskieli_id]
	JOIN d_tutkinnon_toteuma d7 on d7.id = [tutkinnon_toteuma_id]
	JOIN d_alueluokitus d8 on d8.id = [koulutuksen_sijaintikunta_id]
	JOIN d_alueluokitus d8b on d8b.id = [kotikunta_id]
	JOIN d_asuinkunta_sama_vai_eri_kuin_aiemmin d8c on d8c.id = [asuinkunta_sama_vai_eri_kuin_aiemmin_id]
	JOIN d_edeltavan_vuoden_asuinpaikka d8d on d8d.id = [edeltavan_vuoden_asuinpaikka_id]
	JOIN d_sukupuoli d9 on d9.id = [sukupuoli_id]
	JOIN d_hetu_ok d10 on d10.id = [henkilotunnuksen_oikeellisuus_id]
	JOIN d_ika d11 on d11.id = [ika_id]
	JOIN d_opiskelijan_olo d13 on d13.id = [opiskelijan_olo_id]
	JOIN d_valtio d16 on d16.id = [kansalaisuus_id]
	JOIN d_valtio d18 on d18.id = [syntymamaa_id]
	JOIN d_valtio d18b on d18b.id = [aidin_syntymamaa_id]
	JOIN d_valtio d18c on d18c.id = [isan_syntymamaa_id]
	JOIN d_maahantulo_ja_opiskelun_aloittaminen d19 on d19.id = [maahantulo_ja_toisen_asteen_koul_aloittaminen_id]
	JOIN d_maahantulo_ja_opiskelun_aloittaminen d20 on d20.id = [maahantulo_ja_korkeakoulutuksen_aloittaminen_id]
	JOIN d_aidinkieli_versio1 d21 on d21.id = [aidinkieli_versio1_id]
	JOIN d_aidinkieli_versio2 d21b on d21b.id = [aidinkieli_versio2_id]
	JOIN d_kieli d21c on d21c.id = [aidinkieli_versio4_id]
	JOIN d_koulutussektori d22 on d22.id = [koulutussektori_id]
WHERE d1.aineisto_koodi = ''L'' AND [tilastovuosi] <> ''2009''








' 
GO
/****** Object:  View [dbo].[v_f_tab_vaesto]    Script Date: 21.6.2017 10:17:26 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_vaesto]'))
EXEC dbo.sp_executesql @statement = N'










CREATE view [dbo].[v_f_tab_vaesto] as

Select
      [Tilastovuosi] = f.tilastointivuosi
	  
	  ,[Kunta] = d1.kunta
	  ,[Maakunta] = d1.maakunta
	  ,[Seutukunta] = d1.seutukunta
	  ,[Kuntaryhmitys] = d1.kuntaryhma
	  ,[AVI] = d1.avi
	  ,[ELY] = d1.ely
	  ,[Suuralue] = d1.suuralue
	  ,[Sukupuoli] = d2.sukupuoli
	  ,[Äidinkieli] = d4.aidinkieli_versio2
	  ,[Ikä] = d3.ika
	  ,[Ikäryhmä I] = d3.ika5v
	  ,[Ikäryhmä II] = d10.ika
	  /*
						case 
							when d3.ika in (''0'',''1'',''2'') then ''0-2-vuotiaat''
							when d3.ika in (''3'',''4'',''5'') then ''3-5-vuotiaat''
							when d3.ika=''6'' then ''6-vuotiaat''
							when d3.ika in (''7'',''8'',''9'',''10'',''11'',''12'') then ''7-12-vuotiaat''
							when d3.ika in (''13'',''14'',''15'') then ''13-15-vuotiaat''
							when d3.ika in (''16'',''17'',''18'') then ''16-18-vuotiaat''
							when d3.ika in (''19'',''20'',''21'') then ''19-21-vuotiaat''
							when d3.ika in (''22'',''23'',''24'') then ''22-24-vuotiaat''
							when d3.ika in (''25'',''26'',''27'',''28'',''29'') then ''25-29-vuotiaat''
							when d3.ika in (''30'',''31'',''32'',''33'',''34'') then ''30-34-vuotiaat''
							when d3.ika in (''35'',''36'',''37'',''38'',''39'') then ''35-39-vuotiaat''
							when d3.ika in (''40'',''41'',''42'',''43'',''44'') then ''40-44-vuotiaat''
							when d3.ika in (''45'',''46'',''47'',''48'',''49'') then ''45-49-vuotiaat''
							when d3.ika in (''50'',''51'',''52'',''53'',''54'') then ''50-54-vuotiaat''
							when d3.ika in (''55'',''56'',''57'',''58'',''59'') then ''55-59-vuotiaat''
							when d3.ika in (''60'',''61'',''62'',''63'',''64'') then ''60-64-vuotiaat''
							when d3.ika > ''64'' or d3.ika like ''10%'' then ''yli 64-vuotiaat''
							else ''Tuntematon''
						end
		*/
	  ,[Kansalaisuus (Suomi/muu)] = d5.kansalaisuus_versio1
	  ,[Kansalaisuus (maanosa)] = d9.maanosa
	  ,[Kansalaisuus (Pohjoismaa)] = d6.pohjoismaa
	  ,[Kansalaisuus (EU-maa)] = d7.eumaa
	  ,[Kansalaisuus (ETA-maa)] = d8.etamaa

	  ,[Lukumäärä] = f.lukumaara

	  --Ruotsi
	  ,[Statistikår] = f.tilastointivuosi
	  ,[Kommun] = d1.kunta_SV
	  ,[Landskap] = d1.maakunta_SV
	  ,[Ekonomisk region] = d1.seutukunta
	  ,[Kommungruppering] = d1.kuntaryhma_SV
	  ,[RFV] = d1.avi_SV
	  ,[NTM] = d1.ely_SV
	  ,[Storområde] = d1.suuralue
	  ,[Kön] = d2.sukupuoli_SV
	  ,[Modersmål] = d4.aidinkieli_versio2_SV
	  ,[Ålder] = d3.ika_SV
	  ,[Åldersgrupp I] = d3.ika5v_SV
	  ,[Åldersgrupp II] = d10.ika_SV
	  ,[Medborgarskap (finska/andra)] = d5.kansalaisuus_versio1_SV
	  ,[Medborgarskap (världsdel)] = d9.maanosa_SV
	  ,[Medborgare i ett nordiskt land] = d6.pohjoismaa_SV
	  ,[Medborgare i ett EU-land] = d7.eumaa_SV
	  ,[Medborgare i ett EES-land] = d8.etamaa_SV
						

	  --Englanti
	  ,[Statistical year] = f.tilastointivuosi
	  ,[Municipality] = d1.kunta_EN
	  ,[Region] = d1.maakunta_EN
	  ,[Subregion] = d1.seutukunta
	  ,[Municipality type] = d1.kuntaryhma_EN
	  ,[AVI area] = d1.avi_EN
	  ,[ELY area] = d1.ely_EN
	  ,[Major region] = d1.suuralue
	  ,[Gender] = d2.sukupuoli_EN
	  ,[Mother tongue] = d4.aidinkieli_versio2_EN
	  ,[Age] = d3.ika_EN
	  ,[Age group I] = d3.ika5v_EN
	  ,[Age group II] = d10.ika_EN
						/*case 
							when d3.ika in (''0'',''1'',''2'') then ''Aged 0–2''
							when d3.ika in (''3'',''4'',''5'') then ''Aged 3–5''
							when d3.ika=''6'' then ''Aged 6''
							when d3.ika in (''7'',''8'',''9'',''10'',''11'',''12'') then ''Aged 7–12''
							when d3.ika in (''13'',''14'',''15'') then ''Aged 13–15''
							when d3.ika in (''16'',''17'',''18'') then ''Aged 16–18''
							when d3.ika in (''19'',''20'',''21'') then ''Aged 19–21''
							when d3.ika in (''22'',''23'',''24'') then ''Aged 22–24''
							when d3.ika in (''25'',''26'',''27'',''28'',''29'') then ''Aged 25–29''
							when d3.ika in (''30'',''31'',''32'',''33'',''34'') then ''Aged 30–34''
							when d3.ika in (''35'',''36'',''37'',''38'',''39'') then ''Aged 35–39''
							when d3.ika in (''40'',''41'',''42'',''43'',''44'') then ''Aged 40–44''
							when d3.ika in (''45'',''46'',''47'',''48'',''49'') then ''Aged 45–49''
							when d3.ika in (''50'',''51'',''52'',''53'',''54'') then ''Aged 50–54''
							when d3.ika in (''55'',''56'',''57'',''58'',''59'') then ''Aged 55–59''
							when d3.ika in (''60'',''61'',''62'',''63'',''64'') then ''Aged 60–64''
							when d3.ika > ''64'' or d3.ika like ''10%'' then ''Over 64''
							else ''Tuntematon''
						end*/

	  ,[Nationality (Finn/Other)] = d5.kansalaisuus_versio1_EN
	  ,[Nationality (continent)] = d9.maanosa_EN
	  ,[Citizen of a nordic nation] = d6.pohjoismaa_EN
	  ,[Citizen of EU nation] = d7.eumaa_EN
	  ,[Citizen of EEA nation] = d8.etamaa_EN

	  --Järjestys
	  ,[Maakunta järjestys] = d1.jarjestys_maakunta
	  ,[Kuntaryhmä järjestys] = d1.jarjestys_kuntaryhma
	  ,[Seutukunta järjestys] = d1.jarjestys_seutukunta
	  ,[AVI järjestys] = d1.jarjestys_avi
	  ,[ELY järjestys] = d1.jarjestys_ely
	  ,[Suuralue järjestys] = d1.jarjestys_suuralue
      ,[Sukupuoli järjestys] = d2.jarjestys
	  ,[Äidinkieli järjestys] = d4.jarjestys
	  ,[Ikä järjestys] = case d3.jarjestys_ika when ''1v100'' then ''1v99v22'' else d3.jarjestys_ika end
	  ,[Ikäryhmä I järjestys] = d3.jarjestys_ika5v
	  ,[Ikäryhmä II järjestys] = CAST(
						case 
							when d3.ika in (''0'',''1'',''2'') then 1
							when d3.ika in (''3'',''4'',''5'') then 2
							when d3.ika=''6'' then 3
							when d3.ika in (''7'',''8'',''9'',''10'',''11'',''12'') then 4
							when d3.ika in (''13'',''14'',''15'') then 5
							when d3.ika in (''16'',''17'',''18'') then 6
							when d3.ika in (''19'',''20'',''21'') then 7
							when d3.ika in (''22'',''23'',''24'') then 8
							when d3.ika in (''25'',''26'',''27'',''28'',''29'') then 9
							when d3.ika in (''30'',''31'',''32'',''33'',''34'') then 10
							when d3.ika in (''35'',''36'',''37'',''38'',''39'') then 11
							when d3.ika in (''40'',''41'',''42'',''43'',''44'') then 12
							when d3.ika in (''45'',''46'',''47'',''48'',''49'') then 13
							when d3.ika in (''50'',''51'',''52'',''53'',''54'') then 14
							when d3.ika in (''55'',''56'',''57'',''58'',''59'') then 15
							when d3.ika in (''60'',''61'',''62'',''63'',''64'') then 16
							when d3.ika > ''64'' or d3.ika like ''10%'' then 17
							else 18
						end
						AS int)
	  ,[Kansalaisuus järj] = d5.jarjestys
	  ,[Kansalaisuus (maanosa) järj] = d9.jarjestys_maanosa
	  ,[Kansalaisuus (Pohjoismaa) järj] = d6.jarjestys
	  ,[Kansalaisuus (EU-maa) järj] = d7.jarjestys_eumaa
	  ,[Kansalaisuus (ETA-maa) järj] = d8.jarjestys_etamaa

	  --Koodit
	  ,[Koodit Kotikunta] = d1.kunta_koodi
	  ,[Koodit Kotimaakunta] = d1.maakunta_koodi

FROM [dbo].[f_4_9_Vaestorakenne_kunnittain] f
LEFT JOIN VipunenTK.dbo.d_alueluokitus d1 on d1.id=f.kotikunta_id
LEFT JOIN VipunenTK.dbo.d_sukupuoli d2 on d2.id=f.sukupuoli_id
LEFT JOIN VipunenTK.dbo.d_ika d3 on d3.id=f.ika_id
LEFT JOIN VipunenTK.dbo.d_aidinkieli_versio2 d4 on d4.id=f.aidinkieli_versio2_id
LEFT JOIN VipunenTK.dbo.d_kansalaisuus_versio1 d5 on d5.id=f.kansalaisuus_versio1_id
LEFT JOIN VipunenTK.dbo.d_pohjoismaa d6 on d6.id=f.pohjoismaa_id
LEFT JOIN VipunenTK.dbo.d_valtio d7 on d7.id=f.eumaa_id
LEFT JOIN VipunenTK.dbo.d_valtio d8 on d8.id=f.etamaa_id
LEFT JOIN VipunenTK.dbo.d_valtio d9 on d9.id=f.maanosa_id
LEFT JOIN VipunenTK.dbo.d_ika d10 on d10.ika_avain=
						case 
							when d3.ika in (''0'',''1'',''2'') then ''ikar2b_2''
							when d3.ika in (''3'',''4'',''5'') then ''ikar2b_5''
							when d3.ika=''6'' then ''ikar2b_6''
							when d3.ika in (''7'',''8'',''9'',''10'',''11'',''12'') then ''ikar2b_12''
							when d3.ika in (''13'',''14'',''15'') then ''ikar2b_15''
							when d3.ika in (''16'',''17'',''18'') then ''ikar2b_18''
							when d3.ika in (''19'',''20'',''21'') then ''ikar2b_21''
							when d3.ika in (''22'',''23'',''24'') then ''ikar2b_24''
							when d3.ika in (''25'',''26'',''27'',''28'',''29'') then ''ikaryh2_29''
							when d3.ika in (''30'',''31'',''32'',''33'',''34'') then ''ikaryh2_34''
							when d3.ika in (''35'',''36'',''37'',''38'',''39'') then ''ikaryh2_39''
							when d3.ika in (''40'',''41'',''42'',''43'',''44'') then ''ikaryh2_44''
							when d3.ika in (''45'',''46'',''47'',''48'',''49'') then ''ikaryh2_49''
							when d3.ika in (''50'',''51'',''52'',''53'',''54'') then ''ikaryh2_54''
							when d3.ika in (''55'',''56'',''57'',''58'',''59'') then ''ikaryh2_59''
							when d3.ika in (''60'',''61'',''62'',''63'',''64'') then ''ikaryh2_64''
							when d3.ika > ''64'' or d3.ika like ''10%'' then ''ikaryh2_65''
							else ''-1''
						end


























' 
GO
/****** Object:  View [dbo].[v_f_tab_vaestoennuste]    Script Date: 21.6.2017 10:17:26 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_vaestoennuste]'))
EXEC dbo.sp_executesql @statement = N'








CREATE view [dbo].[v_f_tab_vaestoennuste] as

Select
      [Ennustevuosi] = f.ennv
	  
	  ,[Kunta] = d1.kunta
	  ,[Maakunta] = d1.maakunta
	  ,[Seutukunta] = d1.seutukunta
	  ,[Kuntaryhmitys] = d1.kuntaryhma
	  ,[AVI] = d1.avi
	  ,[ELY] = d1.ely
	  ,[Suuralue] = d1.suuralue

      ,[Sukupuoli] = d2.sukupuoli
	  ,[Ikä] = d3.ika
	  ,[Ikäryhmä I] = d3.ika5v
	  ,[Ikäryhmä II] = d10.ika
	  /*
						case 
							when d3.ika in (''0'',''1'',''2'') then ''0-2-vuotiaat''
							when d3.ika in (''3'',''4'',''5'') then ''3-5-vuotiaat''
							when d3.ika=''6'' then ''6-vuotiaat''
							when d3.ika in (''7'',''8'',''9'',''10'',''11'',''12'') then ''7-12-vuotiaat''
							when d3.ika in (''13'',''14'',''15'') then ''13-15-vuotiaat''
							when d3.ika in (''16'',''17'',''18'') then ''16-18-vuotiaat''
							when d3.ika in (''19'',''20'',''21'') then ''19-21-vuotiaat''
							when d3.ika in (''22'',''23'',''24'') then ''22-24-vuotiaat''
							when d3.ika in (''25'',''26'',''27'',''28'',''29'') then ''25-29-vuotiaat''
							when d3.ika in (''30'',''31'',''32'',''33'',''34'') then ''30-34-vuotiaat''
							when d3.ika in (''35'',''36'',''37'',''38'',''39'') then ''35-39-vuotiaat''
							when d3.ika in (''40'',''41'',''42'',''43'',''44'') then ''40-44-vuotiaat''
							when d3.ika in (''45'',''46'',''47'',''48'',''49'') then ''45-49-vuotiaat''
							when d3.ika in (''50'',''51'',''52'',''53'',''54'') then ''50-54-vuotiaat''
							when d3.ika in (''55'',''56'',''57'',''58'',''59'') then ''55-59-vuotiaat''
							when d3.ika in (''60'',''61'',''62'',''63'',''64'') then ''60-64-vuotiaat''
							when d3.ika > ''64'' or d3.ika like ''10%'' then ''yli 64-vuotiaat''
							else ''Tuntematon''
						end
		*/			

	  ,[Lukumäärä] = f.lkm

	  --Ruotsi
	  ,[Prognosår] = f.ennv
	  ,[Kommun] = d1.kunta_SV
	  ,[Landskap] = d1.maakunta_SV
	  ,[Ekonomisk region] = d1.seutukunta_SV
	  ,[Kommungruppering] = d1.kuntaryhma_SV
	  ,[RFV] = d1.avi_SV
	  ,[NTM] = d1.ely_SV
	  ,[Storområde] = d1.suuralue_SV
	  ,[Kön] = d2.sukupuoli_SV
	  ,[Ålder] = d3.ika_SV
	  ,[Åldersgrupp I] = d3.ika5v_SV
	  ,[Åldersgrupp II] = d10.ika_SV

	  --Englanti
	  ,[Year] = f.ennv
	  ,[Municipality] = d1.kunta_EN
	  ,[Region] = d1.maakunta_EN
	  ,[Subregion] = d1.seutukunta_EN
	  ,[Municipality type] = d1.kuntaryhma_EN
	  ,[AVI area] = d1.avi_EN
	  ,[ELY area] = d1.ely_EN
	  ,[Major region] = d1.suuralue_EN
	  ,[Gender] = d2.sukupuoli_EN
	  ,[Age] = d3.ika_EN
	  ,[Age group I] = d3.ika5v_EN
	  ,[Age group II] = d10.ika_EN

	  --Järjestys
	  ,[Maakunta järjestys] = d1.jarjestys_maakunta
	  ,[Kuntaryhmä järjestys] = d1.jarjestys_kuntaryhma
	  ,[Seutukunta järjestys] = d1.jarjestys_seutukunta
	  ,[AVI järjestys] = d1.jarjestys_avi
	  ,[ELY järjestys] = d1.jarjestys_ely
	  ,[Suuralue järjestys] = d1.jarjestys_suuralue
      ,[Sukupuoli järjestys] = d2.jarjestys
	  ,[Ikä järjestys] = d3.jarjestys_ika
	  ,[Ikäryhmä I järjestys] = d3.jarjestys_ika5v
	  ,[Ikäryhmä II järjestys] = CAST(
						case 
							when d3.ika in (''0'',''1'',''2'') then 1
							when d3.ika in (''3'',''4'',''5'') then 2
							when d3.ika=''6'' then 3
							when d3.ika in (''7'',''8'',''9'',''10'',''11'',''12'') then 4
							when d3.ika in (''13'',''14'',''15'') then 5
							when d3.ika in (''16'',''17'',''18'') then 6
							when d3.ika in (''19'',''20'',''21'') then 7
							when d3.ika in (''22'',''23'',''24'') then 8
							when d3.ika in (''25'',''26'',''27'',''28'',''29'') then 9
							when d3.ika in (''30'',''31'',''32'',''33'',''34'') then 10
							when d3.ika in (''35'',''36'',''37'',''38'',''39'') then 11
							when d3.ika in (''40'',''41'',''42'',''43'',''44'') then 12
							when d3.ika in (''45'',''46'',''47'',''48'',''49'') then 13
							when d3.ika in (''50'',''51'',''52'',''53'',''54'') then 14
							when d3.ika in (''55'',''56'',''57'',''58'',''59'') then 15
							when d3.ika in (''60'',''61'',''62'',''63'',''64'') then 16
							when d3.ika > ''64'' or d3.ika like ''10%'' then 17
							else 18
						end
						AS int)

	  --Koodit
	  ,[Koodit Kotikunta] = d1.kunta_koodi
	  ,[Koodit Kotimaakunta] = d1.maakunta_koodi

FROM [dbo].[f_Vaestoennuste] f
LEFT JOIN VipunenTK.dbo.d_alueluokitus d1 on d1.id=f.tilvaskun_id
LEFT JOIN VipunenTK.dbo.d_sukupuoli d2 on d2.id=f.sp_id
LEFT JOIN VipunenTK.dbo.d_ika d3 on d3.id=f.ika_id
LEFT JOIN VipunenTK.dbo.d_ika d10 on d10.ika_avain=
						case 
							when d3.ika in (''0'',''1'',''2'') then ''ikar2b_2''
							when d3.ika in (''3'',''4'',''5'') then ''ikar2b_5''
							when d3.ika=''6'' then ''ikar2b_6''
							when d3.ika in (''7'',''8'',''9'',''10'',''11'',''12'') then ''ikar2b_12''
							when d3.ika in (''13'',''14'',''15'') then ''ikar2b_15''
							when d3.ika in (''16'',''17'',''18'') then ''ikar2b_18''
							when d3.ika in (''19'',''20'',''21'') then ''ikar2b_21''
							when d3.ika in (''22'',''23'',''24'') then ''ikar2b_24''
							when d3.ika in (''25'',''26'',''27'',''28'',''29'') then ''ikaryh2_29''
							when d3.ika in (''30'',''31'',''32'',''33'',''34'') then ''ikaryh2_34''
							when d3.ika in (''35'',''36'',''37'',''38'',''39'') then ''ikaryh2_39''
							when d3.ika in (''40'',''41'',''42'',''43'',''44'') then ''ikaryh2_44''
							when d3.ika in (''45'',''46'',''47'',''48'',''49'') then ''ikaryh2_49''
							when d3.ika in (''50'',''51'',''52'',''53'',''54'') then ''ikaryh2_54''
							when d3.ika in (''55'',''56'',''57'',''58'',''59'') then ''ikaryh2_59''
							when d3.ika in (''60'',''61'',''62'',''63'',''64'') then ''ikaryh2_64''
							when d3.ika > ''64'' or d3.ika like ''10%'' then ''ikaryh2_65''
							else ''-1''
						end

where lkm>0 --AND d3.ika<>''Tuntematon''






















' 
GO
/****** Object:  View [dbo].[v_f_tab_vaeston_maassamuutto_asuinmaakunnan_ja_koulutuksen_mukaan]    Script Date: 21.6.2017 10:17:26 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_vaeston_maassamuutto_asuinmaakunnan_ja_koulutuksen_mukaan]'))
EXEC dbo.sp_executesql @statement = N'



CREATE VIEW [dbo].[v_f_tab_vaeston_maassamuutto_asuinmaakunnan_ja_koulutuksen_mukaan] AS

SELECT 
--Aikamuuttujat
		  ''Tilastovuosi'' = [tilastovuosi]
--Henkilömuuttujat
		  --,''Asuinalueen AVI'' = d1.avi
		  --,''Asuinalueen ELY'' = d1.ely
		  ,''Asuinmaakunta'' = d1.maakunta

--Koulutusmuuttujat
      ,''Koulutusnimike'' = d6.koulutus
	  ,''Opintoala (02 luokitus)'' = d6.opintoala2002
	  ,''Koulutusala (95 luok.)'' = d6.opintoala1995
	  ,''Koulutusala (02 luok.)'' = d6.koulutusala2002
	  ,''Koulutusala, taso 1'' = d6.iscfibroad2013
	  ,''Koulutusala, taso 2'' = d6.iscfinarrow2013
	  ,''Koulutusala, taso 3'' = d6.iscfi2013
	  ,''Koulutusaste, taso 1'' = d6.iscle2011
	  ,''Koulutusaste, taso 2'' = d6.Koulutusaste_taso2

--Järjestykset
	  --,jarjestys_avi = d1.jarjestys_avi
	  --,jarjestys_ely = d1.jarjestys_ely
	  ,jarjestys_maakunta = d1.jarjestys_maakunta
	  ,jarjestys_koulutus = d6.jarjestys
	  ,jarjestys_koulutus_SV = Cast(Case when d6.id = -1 then ''ööö1'' when d6.id = -2 then ''ööö2'' else left(d6.koulutus_SV,10) end as nvarchar(10))
	  ,jarjestys_koulutus_EN = Cast(Case when d6.id = -1 then ''ööö1'' when d6.id = -2 then ''ööö2'' else left(d6.koulutus_EN,10) end as nvarchar(10))
	  ,jarjestys_opintoala2002 = d6.jarjestys_opintoala2002
	  ,jarjestys_koulutusala1995 = d6.jarjestys_opintoala1995
	  ,jarjestys_koulutusala2002 = d6.jarjestys_koulutusala2002
	  ,jarjestys_Koulutusala_taso1 = d6.jarjestys_iscfibroad2013
	  ,jarjestys_Koulutusala_taso2 = d6.jarjestys_iscfinarrow2013
	  ,jarjestys_Koulutusala_taso3 = d6.jarjestys_iscfi2013
	  ,jarjestys_Koulutusaste_taso1 = d6.jarjestys_iscle2011
	  ,jarjestys_Koulutusaste_taso2 = d6.jarjestys_koulutusaste_taso2

--Koodit
	  ,[Koodit Asuinmaakunta] = d1.maakunta_koodi
	  ,[Koodit Koulutuskoodi] = d6.koulutus_koodi
	  ,[Koodit Opintoala (02 luokitus)] = d6.opintoala2002_koodi
	  ,[Koodit Koulutusala (95 luokitus)] = d6.opintoala1995_koodi
	  ,[Koodit Koulutusala (02 luokitus)] = d6.koulutusala2002_koodi
	  ,[Koodit Koulutusala taso 1] = d6.iscfibroad2013_koodi
	  ,[Koodit Koulutusala taso 2] = d6.iscfinarrow2013_koodi
	  ,[Koodit Koulutusala taso 3] = d6.iscfi2013_koodi
	  ,[Koodit Koulutusaste taso 1] = d6.iscle2011_koodi
	  ,[Koodit Koulutusaste taso 2] = d6.Koulutusaste_taso2_koodi

--Lukumäärämuuttujat
      ,''Sisäänmuuttaneiden lkm'' = f.sisaanmuutto
      ,''Ulosmuuttaneiden lkm'' = f.ulosmuutto

--RUOTSI
--Aikamuuttujat
		  ,''Statistikår'' = [tilastovuosi]
--Henkilömuuttujat
		  --,''Bostadsortens RFV-område'' = d1.avi_SV
		  --,''Bostadsortens NTM-område'' = d1.ely_SV
		  ,''Bostadslandskap'' = d1.maakunta_SV
--Koulutusmuuttujat
      ,''Utbildningsbenämning'' = d6.koulutus_SV
	  ,''Studieområde (2002)'' = d6.opintoala2002_SV
	  ,''Utbildningsområde (1995)'' = d6.opintoala1995_SV
	  ,''Utbildningsområde (2002)'' = d6.koulutusala2002_SV
	  ,''Utbildn.område, nivå 1'' = d6.iscfibroad2013_SV
	  ,''Utbildn.område, nivå 2'' = d6.iscfinarrow2013_SV
	  ,''Utbildn.område, nivå 3'' = d6.iscfi2013_SV
	  ,''Utbildn.nivå, nivå 1'' = d6.iscle2011_SV
	  ,''Utbildn.nivå, nivå 2'' = d6.Koulutusaste_taso2_SV

--ENGLANTI
--Aikamuuttujat
		  ,''Statistical year'' = [tilastovuosi]
--Henkilömuuttujat
		  --,''AVI area of the place of residence'' = d1.avi_EN
		  --,''ELY area of the place of residence'' = d1.ely_EN
		  ,''Region of residence '' = d1.maakunta_EN
--Koulutusmuuttujat
      ,''Name of education'' = d6.koulutus_EN
	  ,''Subfield of education (2002)'' = d6.opintoala2002_EN
	  ,''Field of education (1995)'' = d6.opintoala1995_EN
	  ,''Field of education (2002)'' = d6.koulutusala2002_EN
	  ,''Field of ed. tier 1'' = d6.iscfibroad2013_EN
	  ,''Field of ed. tier 2'' = d6.iscfinarrow2013_EN
	  ,''Field of ed. tier 3'' = d6.iscfi2013_EN
	  ,''Level of ed. tier 1'' = d6.iscle2011_EN
	  ,''Level of ed. tier 2'' = d6.Koulutusaste_taso2_EN

FROM VipunenTK.[dbo].[f_4_11_Vaeston_maassamuutto_asuinmaakunnan_ja_koulutuksen_mukaan] f
  LEFT JOIN VipunenTK.[dbo].d_alueluokitus d1
    ON d1.id = f.[asuinmaakunta_id]
  LEFT JOIN VipunenTK.[dbo].d_koulutusluokitus d6
    ON d6.id = f.[koulutusluokitus_id]










' 
GO
/****** Object:  View [dbo].[v_f_tab_vaestorakenne_aidinkielen_mukaan_maakunnittain]    Script Date: 21.6.2017 10:17:26 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_vaestorakenne_aidinkielen_mukaan_maakunnittain]'))
EXEC dbo.sp_executesql @statement = N'

CREATE VIEW [dbo].[v_f_tab_vaestorakenne_aidinkielen_mukaan_maakunnittain] AS

SELECT 
--Aikamuuttyjat
		  ''Tilastovuosi'' = [tilastovuosi]
--Henkilömuuttujat
          ,''Äidinkieli'' = d_kieli.kieli
		  ,''Asuinalueen AVI'' = d_alueluokitus.avi
		  ,''Asuinalueen ELY'' = d_alueluokitus.ely
		  ,''Asuinmaakunta'' = d_alueluokitus.maakunta
		  ,''Kansalaisuus'' = d_kansalaisuus_versio1.kansalaisuus_versio1
		  ,''EU-maan kansalainen'' = eu.eumaa
		  ,''ETA-maan kansalainen'' = eta.etamaa
		  ,''Ikä'' = ika1v.ika
		  ,''Ikäryhmä 1'' = ika1v.ika5v
		  ,''Ikäryhmä 2'' = ikar2.ika
		  ,''Ikäryhmä 2b'' = ikar2b.ika

--Järjestykset
          ,jarjestys_aidinkieli = 
			case 
				when d_kieli.kieli=''suomi'' then ''aaa'' 
				when d_kieli.kieli=''ruotsi'' then ''aab'' 
				when d_kieli.kieli=''saame'' then ''aac'' 
				else left(d_kieli.kieli ,3)
			end
		  ,jarjestys_avi = d_alueluokitus.jarjestys_avi
		  ,jarjestys_ely = d_alueluokitus.jarjestys_ely
		  ,jarjestys_maakunta = d_alueluokitus.jarjestys_maakunta
		  ,jarjestys_kansalaisuus = d_kansalaisuus_versio1.jarjestys
		  ,jarjestys_eumaa = eu.jarjestys_eumaa
		  ,jarjestys_etamaa = eta.jarjestys_etamaa
		  ,jarjestys_ika = ika1v.jarjestys_ika
		  ,jarjestys_ikaryhma1 = ika1v.jarjestys_ika5v
		  ,jarjestys_ikaryhma2 = ikar2.jarjestys_ika
		  ,jarjestys_ikaryhma2b = ikar2b.jarjestys_ika

--Koodit
		  ,koodit_asuinmaakunta = d_alueluokitus.maakunta_koodi
		  ,koodit_aidinkieli = d_kieli.kieli_koodi
		  ,koodit_kansalaisuus= d_kansalaisuus_versio1.kansalaisuus_versio1_koodi
		  ,koodit_ika = ika1v.ika_int

--Lukumäärämuuttujat
      ,''Henkilöiden lkm'' = f.[henkiloiden_lkm]

--RUOTSI
--Aikamuuttyjat
		  ,''Statistikår'' = [tilastovuosi]
--Henkilömuuttujat
		  ,''Modersmål'' = d_kieli.kieli_SV
		  ,''Bostadsortens RFV-område'' = d_alueluokitus.avi_SV
		  ,''Bostadsortens NTM-område'' = d_alueluokitus.ely_SV
		  ,''Bostadslandskap'' = d_alueluokitus.maakunta_SV
		  ,''Medborgarskap'' = d_kansalaisuus_versio1.kansalaisuus_versio1_SV
		  ,''Medborgare i ett EU-land'' = eu.eumaa_SV
		  ,''Medborgare i ett EES-land'' = eta.etamaa_SV
		  ,''Ålder'' = ika1v.ika_SV
		  ,''Åldersgrupp 1'' = ika1v.ika5v_SV
		  ,''Åldersgrupp 2'' = ikar2.ika_SV
		  ,''Åldersgrupp 2b'' = ikar2b.ika_SV

--ENGLANTI
--Aikamuuttyjat
		  ,''Statistical year'' = [tilastovuosi]
--Henkilömuuttujat
		  ,''Mother tongue'' = d_kieli.kieli_EN
		  ,''AVI area of the place of residence'' = d_alueluokitus.avi_EN
		  ,''ELY area of the place of residence'' = d_alueluokitus.ely_EN
		  ,''Region of residence '' = d_alueluokitus.maakunta_EN
		  ,''Nationality'' = d_kansalaisuus_versio1.kansalaisuus_versio1_EN
		  ,''Citizen of EU nation'' = eu.eumaa_EN
		  ,''Citizen of EEA nation'' = eta.etamaa_EN
		  ,''Age'' = ika1v.ika_EN
		  ,''Age group 1'' = ika1v.ika5v_EN
		  ,''Age group 2'' = ikar2.ika_EN
		  ,''Age group 2b'' = ikar2b.ika_EN

FROM VipunenTK.[dbo].[f_4_10_Vaestorakenne_aidinkielen_mukaan_maakunnittain] f
  LEFT JOIN VipunenTK.[dbo].d_alueluokitus
    ON d_alueluokitus.id = f.[asuinmaakunta_id]
  LEFT JOIN VipunenTK.[dbo].d_kieli
	ON d_kieli.id = f.[aidinkieli_id]
  LEFT JOIN VipunenTK.[dbo].d_kansalaisuus_versio1
	ON d_kansalaisuus_versio1.id = f.kansalaisuus_id
  LEFT JOIN VipunenTK.[dbo].d_valtio eu
    ON eu.id = f.eumaa_valtio_id
  LEFT JOIN VipunenTK.[dbo].d_valtio eta
    ON eta.id = f.etamaa_valtio_id
  LEFT JOIN VipunenTK.[dbo].d_ika ika1v
    ON ika1v.id = f.ika1v_id
  LEFT JOIN VipunenTK.[dbo].d_ika ikar2
    ON ikar2.id = f.ikar2_id
  LEFT JOIN VipunenTK.[dbo].d_ika ikar2b
    ON ikar2b.id = f.ikar2b_id









' 
GO
/****** Object:  View [dbo].[v_f_tab_yosairaalojen_tutkimus_ja_kehitys]    Script Date: 21.6.2017 10:17:26 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_tab_yosairaalojen_tutkimus_ja_kehitys]'))
EXEC dbo.sp_executesql @statement = N'





CREATE VIEW [dbo].[v_f_tab_yosairaalojen_tutkimus_ja_kehitys] AS

SELECT 
--Aikamuuttyjat
		  ''Tilastovuosi'' = [tilastovuosi]
--Aluemuuttujat
		  ,''AVI-alue (tutkimusmenot)'' = d_alueluokitus_historia.avi
		  ,''ELY-alue (tutkimusmenot)'' = d_alueluokitus_historia.ely
		  ,''Maakunta (tutkimusmenot)'' = d_alueluokitus_historia.maakunta
		  ,''Kunta (tutkimusmenot)'' = d_alueluokitus_historia.kunta
--Henkilömuuttujat
          ,''Sukupuoli'' = d_sukupuoli.sukupuoli
          ,''Tutkintotaso'' = d_tutkintotaso.tutkintotaso
		  ,''Tutkimustehtävä'' = d_tutkimus_tehtava.tutkimus_tehtava
		  ,''AVI-alue (T&K henkilökunta)'' = d_alueluokitus_historia.avi
		  ,''ELY-alue (T&K henkilökunta)'' = d_alueluokitus_historia.ely
		  ,''Maakunta (T&K henkilökunta)'' = d_alueluokitus_historia.maakunta
		  ,''Kunta (T&K henkilökunta)'' = d_alueluokitus_historia.kunta
--Organisaatiomuuttujat
          ,''YO-sairaala'' = d_yosairaala.yosairaala
--Tieteenalamuuttujat
          ,''Päätieteenala (2007 luokitus)'' = d_tieteenala.paatieteenala2007
          ,''Päätieteenala (2010 luokitus)'' = d_tieteenala.paatieteenala2010
          ,''Tieteenala (2007 luokitus)'' = d_tieteenala.tieteenala2007
          ,''Tieteenala (2010 luokitus)'' = d_tieteenala.tieteenala2010
--Rahoitus- ja menomuuttujat
          ,''Rahoituslähde'' = d_tutkimuksen_rahoituslahde.rahoituslahde
          ,''Rahoituksen laatu'' = d_tutkimuksen_rahoituslahde.rahoituksen_laatu
          ,''Rahoituslähteen tyyppi'' = d_tutkimuksen_rahoituslahde.rahoituslahteen_tyyppi
          ,''Ulkop. rahoituksen kansainvälisyys'' = d_tutkimuksen_rahoituslahde.ulkopuolisen_rahoituksen_kansainvalisyys
          ,''Rahoituslähdetarkennus'' = d_tutkimuksen_rahoituslahde.rahoituslahdetarkennus
          ,''Tutkimusmenojen kohde'' = d_tutkimusmenojen_kohde.menokohde
          ,''Tutkimusmenotyyppi'' = d_tutkimusmenojen_kohde.menotyyppi
--Järjestykset
          ,jarjestys_yosairaala = d_yosairaala.jarjestys_yosairaala
          ,jarjestys_sukupuoli = d_sukupuoli.jarjestys
		  ,jarjestys_tutkimustehtava = d_tutkimus_tehtava.jarjestys
		  ,jarjestys_avi = d_alueluokitus_historia.jarjestys_avi
		  ,jarjestys_ely = d_alueluokitus_historia.jarjestys_ely
		  ,jarjestys_maakunta = d_alueluokitus_historia.jarjestys_maakunta
          ,d_tieteenala.jarjestys_paatieteenala2007
          ,d_tieteenala.jarjestys_paatieteenala2010
          ,d_tieteenala.jarjestys_tieteenala2007
          ,d_tieteenala.jarjestys_tieteenala2010
          ,jarjestys_tutkintotaso = d_tutkintotaso.jarjestys
          ,d_tutkimuksen_rahoituslahde.jarjestys_rahoituslahde
          ,d_tutkimuksen_rahoituslahde.jarjestys_rahoituksen_laatu
          ,d_tutkimuksen_rahoituslahde.jarjestys_rahoituslahteen_tyyppi
          ,d_tutkimuksen_rahoituslahde.jarjestys_ulkopuolisen_rahoituksen_kansainvalisyys
          ,d_tutkimuksen_rahoituslahde.jarjestys_rahoituslahdetarkennus
          ,d_tutkimusmenojen_kohde.jarjestys_menokohde
          ,d_tutkimusmenojen_kohde.jarjestys_menotyyppi
--Lukumäärämuuttujat
      ,''Tutkimusrahoitus (1000 euroa)2'' = [tutkimusrahoitus]
      ,''Tutkimushenkilökunnan lkm (alueittain)2'' = lkm_tutkimushenkilokunta_alueittain
	  ,''Tutkimushenkilökunnan lkm (tehtävittäin)2'' = lkm_tutkimushenkilokunta_paatieteenaloittain_tehtavittain
	  ,''Tutkimushenkilökunnan lkm (tutkintotasoittain)2'' = lkm_tutkimushenkilokunta_tutkintotasoittain
	  ,''Tutkimusmenot (1000 euroa)2'' = [tutkimusmenot]
	  ,''Tutkimusmenot (1000 euroa) arvio seuraavasta tilastovuodesta2'' = [tutkimusmenot_arvio_seuraavatilastovuosi]
	  ,''Tutkimusmenot (1000 euroa) (alueittain)2'' = [tutkimusmenot_alueittain]
	  ,''Tutkimusmenot (1000 euroa) (tieteenaloittain)2'' = [tutkimusmenot_tieteenaloittain]
	  ,''Tutkimustyövuodet (alueittain)2'' = [lkm_tutkimustyovuodet_alueittain]
	  ,''Tutkimustyövuodet (tehtävittäin)2'' = [lkm_tutkimustyovuodet_tehtavittain]
	  ,''Tutkimustyövuodet (tutkintotasoittain)2'' = [lkm_tutkimustyovuodet_tutkintotasoittain]

--RUOTSI
--Aikamuuttyjat
		  ,''Statistikår'' = [tilastovuosi]
--Aluemuuttujat
		  ,''RFV-område (forskningsutgifter)'' = d_alueluokitus_historia.avi_SV
		  ,''NTM-område (forskningsutgifter)'' = d_alueluokitus_historia.ely_SV
		  ,''Landskap (forskningsutgifter)'' = d_alueluokitus_historia.maakunta_SV
		  ,''Kommun (forskningsutgifter)'' = d_alueluokitus_historia.kunta_SV
--Henkilömuuttujat
          ,''Kön'' = d_sukupuoli.sukupuoli_SV
          ,''Examensnivå'' = d_tutkintotaso.tutkintotaso_SV
		  ,''Forskningsuppgift'' = d_tutkimus_tehtava.tutkimus_tehtava_SV
		  ,''RFV-område (F&U personal)'' = d_alueluokitus_historia.avi_SV
		  ,''NTM-område (F&U personal)'' = d_alueluokitus_historia.ely_SV
		  ,''Landskap (F&U personal)'' = d_alueluokitus_historia.maakunta_SV
		  ,''Kommun (F&U personal)'' = d_alueluokitus_historia.kunta_SV
--Organisaatiomuuttujat
          ,''Universitetssjukhus'' = d_yosairaala.yosairaala_SV
--Tieteenalamuuttujat
          ,''Huvudvetenskapsgren (2007)'' = d_tieteenala.paatieteenala2007_SV
          ,''Huvudvetenskapsgren (2010)'' = d_tieteenala.paatieteenala2010_SV
          ,''Vetenskapsgren (2007)'' = d_tieteenala.tieteenala2007_SV
          ,''Vetenskapsgren (2010)'' = d_tieteenala.tieteenala2010_SV
--Rahoitus- ja menomuuttujat
          ,''Finansieringskälla'' = d_tutkimuksen_rahoituslahde.rahoituslahde_SV
          ,''Finansieringstyp'' = d_tutkimuksen_rahoituslahde.rahoituksen_laatu_SV
          ,''Finansieringskällans typ'' = d_tutkimuksen_rahoituslahde.rahoituslahteen_tyyppi_SV
          ,''Externa finansieringens internat.'' = d_tutkimuksen_rahoituslahde.ulkopuolisen_rahoituksen_kansainvalisyys_SV
          ,''Spec. av finansieringskällan'' = d_tutkimuksen_rahoituslahde.rahoituslahdetarkennus_SV
          ,''Forskningsutgifternas mål'' = d_tutkimusmenojen_kohde.menokohde_SV
          ,''Typ av forskningsutgifter'' = d_tutkimusmenojen_kohde.menotyyppi_SV

--ENGLANTI
--Aikamuuttyjat
		  ,''Statistical year'' = [tilastovuosi]
--Aluemuuttujat
		  ,''AVI area (R&D budget funds)'' = d_alueluokitus_historia.avi_EN
		  ,''ELY area (R&D budget funds)'' = d_alueluokitus_historia.ely_EN
		  ,''Region (R&D budget funds)'' = d_alueluokitus_historia.maakunta_EN
		  ,''Municipality (R&D budget funds)'' = d_alueluokitus_historia.kunta_EN
--Henkilömuuttujat
          ,''Gender'' = d_sukupuoli.sukupuoli_EN
          ,''Level of degree'' = d_tutkintotaso.tutkintotaso_EN
		  ,''R&D task'' = d_tutkimus_tehtava.tutkimus_tehtava_EN
		  ,''AVI area (R&D personnel)'' = d_alueluokitus_historia.avi_EN
		  ,''ELY area (R&D personnel)'' = d_alueluokitus_historia.ely_EN
		  ,''Region (R&D personnel)'' = d_alueluokitus_historia.maakunta_EN
		  ,''Municipality (R&D personnel)'' = d_alueluokitus_historia.kunta_EN
--Organisaatiomuuttujat
          ,''University hospital'' = d_yosairaala.yosairaala_EN
--Tieteenalamuuttujat
          ,''Main discipline (2007)'' = d_tieteenala.paatieteenala2007_EN
          ,''Main discipline (2010)'' = d_tieteenala.paatieteenala2010_EN
          ,''Discipline (2007)'' = d_tieteenala.tieteenala2007_EN
          ,''Discipline (2010)'' = d_tieteenala.tieteenala2010_EN
--Rahoitus- ja menomuuttujat
          ,''Source of funding I'' = d_tutkimuksen_rahoituslahde.rahoituslahde_EN
          ,''Type of funding II'' = d_tutkimuksen_rahoituslahde.rahoituksen_laatu_EN
          ,''Type of funding I'' = d_tutkimuksen_rahoituslahde.rahoituslahteen_tyyppi_EN
          ,''External funding (internat.)'' = d_tutkimuksen_rahoituslahde.ulkopuolisen_rahoituksen_kansainvalisyys_EN
          ,''Source of funding II'' = d_tutkimuksen_rahoituslahde.rahoituslahdetarkennus_EN
          ,''Target of budget funds'' = d_tutkimusmenojen_kohde.menokohde_EN
          ,''Type of budget funds'' = d_tutkimusmenojen_kohde.menotyyppi_EN

FROM (
SELECT [tilastovuosi]
	  ,yosairaala_id
	  ,rahoituslahde_id
	  ,alueluokitus_id = -1
	  ,sukupuoli_id = -1
	  ,tehtava_id = -1
	  ,tieteenala_id = -1
	  ,tutkintotaso_id = -1
	  ,menokohde_id = -1
      ,tutkimusrahoitus
	  ,lkm_tutkimushenkilokunta_alueittain = NULL
	  ,lkm_tutkimushenkilokunta_paatieteenaloittain_tehtavittain = NULL
	  ,lkm_tutkimushenkilokunta_tutkintotasoittain = NULL
	  ,tutkimusmenot = NULL
	  ,tutkimusmenot_arvio_seuraavatilastovuosi = NULL
	  ,tutkimusmenot_alueittain = NULL
	  ,tutkimusmenot_tieteenaloittain = NULL
	  ,lkm_tutkimustyovuodet_alueittain = NULL
	  ,lkm_tutkimustyovuodet_tehtavittain = NULL
	  ,lkm_tutkimustyovuodet_tutkintotasoittain = NULL
  FROM [dbo].[f_Yosairaaloiden_tutkimus_ja_kehitys_rahoitus]

UNION ALL
SELECT [tilastovuosi]
	  ,yosairaala_id
	  ,rahoituslahde_id = -1
	  ,alueluokitus_id
	  ,sukupuoli_id = -1
	  ,tehtava_id = -1
	  ,tieteenala_id = -1
	  ,tutkintotaso_id = -1
	  ,menokohde_id = -1
      ,tutkimusrahoitus = NULL
	  ,lkm_tutkimushenkilokunta_alueittain
	  ,lkm_tutkimushenkilokunta_paatieteenaloittain_tehtavittain = NULL
	  ,lkm_tutkimushenkilokunta_tutkintotasoittain = NULL
	  ,tutkimusmenot = NULL
	  ,tutkimusmenot_arvio_seuraavatilastovuosi = NULL
	  ,tutkimusmenot_alueittain = NULL
	  ,tutkimusmenot_tieteenaloittain = NULL
	  ,lkm_tutkimustyovuodet_alueittain = NULL
	  ,lkm_tutkimustyovuodet_tehtavittain = NULL
	  ,lkm_tutkimustyovuodet_tutkintotasoittain = NULL
  FROM VipunenTK.[dbo].[f_Yosairaaloiden_tutkimus_ja_kehitys_tutkimushenkilokunta_alueittain]

UNION ALL
SELECT [tilastovuosi]
	  ,yosairaala_id
	  ,rahoituslahde_id = -1
	  ,alueluokitus_id = -1
	  ,sukupuoli_id
	  ,tehtava_id
	  ,tieteenala_id
	  ,tutkintotaso_id = -1
	  ,menokohde_id = -1
      ,tutkimusrahoitus = NULL
	  ,lkm_tutkimushenkilokunta_alueittain = NULL
	  ,lkm_tutkimushenkilokunta_paatieteenaloittain_tehtavittain
	  ,lkm_tutkimushenkilokunta_tutkintotasoittain = NULL
	  ,tutkimusmenot = NULL
	  ,tutkimusmenot_arvio_seuraavatilastovuosi = NULL
	  ,tutkimusmenot_alueittain = NULL
	  ,tutkimusmenot_tieteenaloittain = NULL
	  ,lkm_tutkimustyovuodet_alueittain = NULL
	  ,lkm_tutkimustyovuodet_tehtavittain = NULL
	  ,lkm_tutkimustyovuodet_tutkintotasoittain = NULL
  FROM VipunenTK.[dbo].[f_Yosairaaloiden_tutkimus_ja_kehitys_tutkimushenkilokunta_paatieteenaloittain_tehtavittain]

UNION ALL
SELECT [tilastovuosi]
	  ,yosairaala_id
	  ,rahoituslahde_id = -1
	  ,alueluokitus_id = -1
	  ,sukupuoli_id
	  ,tehtava_id = -1
	  ,tieteenala_id = -1
	  ,tutkintotaso_id
	  ,menokohde_id = -1
      ,tutkimusrahoitus = NULL
	  ,lkm_tutkimushenkilokunta_alueittain = NULL
	  ,lkm_tutkimushenkilokunta_paatieteenaloittain_tehtavittain = NULL
	  ,lkm_tutkimushenkilokunta_tutkintotasoittain
	  ,tutkimusmenot = NULL
	  ,tutkimusmenot_arvio_seuraavatilastovuosi = NULL
	  ,tutkimusmenot_alueittain = NULL
	  ,tutkimusmenot_tieteenaloittain = NULL
	  ,lkm_tutkimustyovuodet_alueittain = NULL
	  ,lkm_tutkimustyovuodet_tehtavittain = NULL
	  ,lkm_tutkimustyovuodet_tutkintotasoittain = NULL
  FROM VipunenTK.[dbo].[f_Yosairaaloiden_tutkimus_ja_kehitys_tutkimushenkilokunta_tutkintotasoittain]

UNION ALL
SELECT [tilastovuosi]
	  ,yosairaala_id
	  ,rahoituslahde_id = -1
	  ,alueluokitus_id = -1
	  ,sukupuoli_id = -1
	  ,tehtava_id = -1
	  ,tieteenala_id = -1
	  ,tutkintotaso_id = -1
	  ,menokohde_id
      ,tutkimusrahoitus = NULL
	  ,lkm_tutkimushenkilokunta_alueittain = NULL
	  ,lkm_tutkimushenkilokunta_paatieteenaloittain_tehtavittain = NULL
	  ,lkm_tutkimushenkilokunta_tutkintotasoittain = NULL
	  ,tutkimusmenot
	  ,tutkimusmenot_arvio_seuraavatilastovuosi
	  ,tutkimusmenot_alueittain = NULL
	  ,tutkimusmenot_tieteenaloittain = NULL
	  ,lkm_tutkimustyovuodet_alueittain = NULL
	  ,lkm_tutkimustyovuodet_tehtavittain = NULL
	  ,lkm_tutkimustyovuodet_tutkintotasoittain = NULL
  FROM VipunenTK.[dbo].[f_Yosairaaloiden_tutkimus_ja_kehitys_tutkimusmenot]

UNION ALL
SELECT [tilastovuosi]
	  ,yosairaala_id
	  ,rahoituslahde_id = -1
	  ,alueluokitus_id
	  ,sukupuoli_id = -1
	  ,tehtava_id = -1
	  ,tieteenala_id = -1
	  ,tutkintotaso_id = -1
	  ,menokohde_id = -1
      ,tutkimusrahoitus = NULL
	  ,lkm_tutkimushenkilokunta_alueittain = NULL
	  ,lkm_tutkimushenkilokunta_paatieteenaloittain_tehtavittain = NULL
	  ,lkm_tutkimushenkilokunta_tutkintotasoittain = NULL
	  ,tutkimusmenot = NULL
	  ,tutkimusmenot_arvio_seuraavatilastovuosi = NULL
	  ,tutkimusmenot_alueittain
	  ,tutkimusmenot_tieteenaloittain = NULL
	  ,lkm_tutkimustyovuodet_alueittain = NULL
	  ,lkm_tutkimustyovuodet_tehtavittain = NULL
	  ,lkm_tutkimustyovuodet_tutkintotasoittain = NULL
  FROM VipunenTK.[dbo].[f_Yosairaaloiden_tutkimus_ja_kehitys_tutkimusmenot_alueittain]

UNION ALL
SELECT [tilastovuosi]
	  ,yosairaala_id
	  ,rahoituslahde_id = -1
	  ,alueluokitus_id = -1
	  ,sukupuoli_id = -1
	  ,tehtava_id = -1
	  ,tieteenala_id
	  ,tutkintotaso_id = -1
	  ,menokohde_id = -1
      ,tutkimusrahoitus = NULL
	  ,lkm_tutkimushenkilokunta_alueittain = NULL
	  ,lkm_tutkimushenkilokunta_paatieteenaloittain_tehtavittain = NULL
	  ,lkm_tutkimushenkilokunta_tutkintotasoittain = NULL
	  ,tutkimusmenot = NULL
	  ,tutkimusmenot_arvio_seuraavatilastovuosi = NULL
	  ,tutkimusmenot_alueittain = NULL
	  ,tutkimusmenot_tieteenaloittain
	  ,lkm_tutkimustyovuodet_alueittain = NULL
	  ,lkm_tutkimustyovuodet_tehtavittain = NULL
	  ,lkm_tutkimustyovuodet_tutkintotasoittain = NULL
  FROM VipunenTK.[dbo].[f_Yosairaaloiden_tutkimus_ja_kehitys_tutkimusmenot_tieteenaloittain]

UNION ALL
SELECT [tilastovuosi]
	  ,yosairaala_id
	  ,rahoituslahde_id = -1
	  ,alueluokitus_id
	  ,sukupuoli_id = -1
	  ,tehtava_id = -1
	  ,tieteenala_id = -1
	  ,tutkintotaso_id = -1
	  ,menokohde_id = -1
      ,tutkimusrahoitus = NULL
	  ,lkm_tutkimushenkilokunta_alueittain = NULL
	  ,lkm_tutkimushenkilokunta_paatieteenaloittain_tehtavittain = NULL
	  ,lkm_tutkimushenkilokunta_tutkintotasoittain = NULL
	  ,tutkimusmenot = NULL
	  ,tutkimusmenot_arvio_seuraavatilastovuosi = NULL
	  ,tutkimusmenot_alueittain = NULL
	  ,tutkimusmenot_tieteenaloittain = NULL
	  ,lkm_tutkimustyovuodet_alueittain
	  ,lkm_tutkimustyovuodet_tehtavittain = NULL
	  ,lkm_tutkimustyovuodet_tutkintotasoittain = NULL
  FROM VipunenTK.[dbo].[f_Yosairaaloiden_tutkimus_ja_kehitys_tutkimustyovuodet_alueittain]

UNION ALL
SELECT [tilastovuosi]
	  ,yosairaala_id
	  ,rahoituslahde_id = -1
	  ,alueluokitus_id = -1
	  ,sukupuoli_id = -1
	  ,tehtava_id
	  ,tieteenala_id = -1
	  ,tutkintotaso_id = -1
	  ,menokohde_id = -1
      ,tutkimusrahoitus = NULL
	  ,lkm_tutkimushenkilokunta_alueittain = NULL
	  ,lkm_tutkimushenkilokunta_paatieteenaloittain_tehtavittain = NULL
	  ,lkm_tutkimushenkilokunta_tutkintotasoittain = NULL
	  ,tutkimusmenot = NULL
	  ,tutkimusmenot_arvio_seuraavatilastovuosi = NULL
	  ,tutkimusmenot_alueittain = NULL
	  ,tutkimusmenot_tieteenaloittain = NULL
	  ,lkm_tutkimustyovuodet_alueittain = NULL
	  ,lkm_tutkimustyovuodet_tehtavittain
	  ,lkm_tutkimustyovuodet_tutkintotasoittain = NULL
  FROM VipunenTK.[dbo].[f_Yosairaaloiden_tutkimus_ja_kehitys_tutkimustyovuodet_tehtavittain]

UNION ALL
SELECT [tilastovuosi]
	  ,yosairaala_id
	  ,rahoituslahde_id = -1
	  ,alueluokitus_id = -1
	  ,sukupuoli_id = -1
	  ,tehtava_id = -1
	  ,tieteenala_id = -1
	  ,tutkintotaso_id
	  ,menokohde_id = -1
      ,tutkimusrahoitus = NULL
	  ,lkm_tutkimushenkilokunta_alueittain = NULL
	  ,lkm_tutkimushenkilokunta_paatieteenaloittain_tehtavittain = NULL
	  ,lkm_tutkimushenkilokunta_tutkintotasoittain = NULL
	  ,tutkimusmenot = NULL
	  ,tutkimusmenot_arvio_seuraavatilastovuosi = NULL
	  ,tutkimusmenot_alueittain = NULL
	  ,tutkimusmenot_tieteenaloittain = NULL
	  ,lkm_tutkimustyovuodet_alueittain = NULL
	  ,lkm_tutkimustyovuodet_tehtavittain = NULL
	  ,lkm_tutkimustyovuodet_tutkintotasoittain
  FROM VipunenTK.[dbo].[f_Yosairaaloiden_tutkimus_ja_kehitys_tutkimustyovuodet_tutkintotasoittain]

  ) f
  INNER JOIN VipunenTK.[dbo].d_yosairaala
	ON d_yosairaala.id = f.yosairaala_id
  INNER JOIN VipunenTK.[dbo].d_tutkimuksen_rahoituslahde
	ON d_tutkimuksen_rahoituslahde.id = f.rahoituslahde_id
  INNER JOIN VipunenTK.[dbo].d_alueluokitus_historia
    ON d_alueluokitus_historia.id = f.alueluokitus_id
  INNER JOIN VipunenTK.[dbo].d_sukupuoli
	ON d_sukupuoli.id = f.sukupuoli_id
  INNER JOIN VipunenTK.[dbo].d_tutkimus_tehtava
    ON d_tutkimus_tehtava.id = f.tehtava_id
  INNER JOIN VipunenTK.[dbo].d_tieteenala
	ON d_tieteenala.id = f.tieteenala_id
  INNER JOIN VipunenTK.[dbo].d_tutkintotaso
	ON d_tutkintotaso.id = f.tutkintotaso_id
  INNER JOIN VipunenTK.[dbo].d_tutkimusmenojen_kohde
	ON d_tutkimusmenojen_kohde.id = f.menokohde_id





' 
GO
/****** Object:  View [dbo].[v_f_vaeston_koulutusrakenne]    Script Date: 21.6.2017 10:17:26 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_vaeston_koulutusrakenne]'))
EXEC dbo.sp_executesql @statement = N'









CREATE VIEW [dbo].[v_f_vaeston_koulutusrakenne]
AS
Select [15 vuotta täyttäneen väestön lukumäärä2] = lukumaara
,[Tilastointivuosi] as Tilastovuosi
,d1.koulutusala2002 as "Koulutusala"
,d1.jarjestys_koulutusala2002 as "koul02"
,d1.opintoala2002 as "Opintoala"
,d1.jarjestys_opintoala2002 as "op02"
,d1.koulutus as "Koulutusnimike"
,d1.koulutusaste2002 as "Koulutusaste"
,d1.jarjestys_koulutusaste2002 as "kast02"
,d1.koulutusaste2002_koodi
,d1.opintoala1995 as "Koulutusala (95 luokitus)"
,d1.jarjestys_opintoala1995 as "op95"
,d2.vuosiselite as "Tutkinnon suoritusvuosi"
,d2.jarjestys as "tutksuorvj"
,d3.vuosiselite as "Syntymävuosi"
,d3.jarjestys as "syntjarj"
,d4.oppisopimuskoulutus as "Oppisopimuskoulutus"
,d4.jarjestys as "opsopj"
,d5.sukupuoli as "Sukupuoli"
,d6.ika5v as "Ikäryhmä"
,d6.jarjestys_ika5v
,d7.aidinkieli_versio1 as "Äidinkieli"
,d7.jarjestys as "aid_jarj"
,d8.eumaa as "EU-maan kansalainen"
,d8.jarjestys_eumaa as "eujarj"
,d8.eumaa_koodi as "eukoodi"
,d9.etamaa as "ETA-maan kansalainen"
,d9.jarjestys_etamaa as "etajarj"
,d9.etamaa_koodi as "etakoodi"
,d10.pohjoismaa as "Pohjoismaan kansalainen"
,d10.jarjestys as "pohjjarj"
,d11.avi as "Tutk. suorituspaikan AVI"
,d11.jarjestys_avi as "suorjavi"
,d11.ely as "Tutk. suorituspaikan ELY"
,d11.jarjestys_ely as "suorjely"
,d11.maakunta as "Tutk. suoritusmaakunta"
,d11.jarjestys_maakunta as "suorjmaak"
,d12.avi as "Asuinalueen AVI"
,d12.jarjestys_avi as "asavij"
,d12.ely as "Asuinalueen ELY"
,d12.jarjestys_ely as "aselyj"
,d12.maakunta as "Asuinmaakunta"
,d12.jarjestys_maakunta as "asmaakj"
,d13.kansalaisuus_versio1 as "Kansalaisuus"
,d13.jarjestys as "kansjarj"
,d18.ika as "Ikä"
,d18.jarjestys_ika as "ikajarj"
,d19.ika as "Tutkinnon suoritusikä"
,d19.jarjestys_ika as "suorikajarj"
,d20.ika as "Tutkinnon ikä"
,d20.jarjestys_ika as "tutkikajarj"
,d21.koulutusmuoto as "Koulutusmuoto"
,d21.jarjestys as "koulmuotojarj"
,d22.ammatillisen_koulutuksen_koulutuslaji_tutkintorekisterissa as "Amm. koul. koulutuslaji"
,[Koulutuslaji] = case d22.ammatillisen_koulutuksen_koulutuslaji_tutkintorekisterissa
					when ''ammatillinen peruskoulutus; toinen aste, opistoaste, ammatillinen korkea-aste, (opetushallinnon 2002 koulutusluokituksen asteet 32, 50, 61)  sisältää myös sotilasalan ja ulkomailla suoritetut ammatilliset tutkinnot'' then ''Ammatillinen perustutkinto''
					when ''ammatillinen lisäkoulutus, ammattitutkinto v. 1994 alkaen'' then ''Ammattitutkinto''
					when ''ammatillinen lisäkoulutus, erikoisammattitutkinto v. 1994 alkaen'' then ''Erikoisammattitutkinto''
					else d22.ammatillisen_koulutuksen_koulutuslaji_tutkintorekisterissa
				  end
,[Koulutuslaji apu] = case d22.ammatillisen_koulutuksen_koulutuslaji_tutkintorekisterissa
						when ''muu kuin ammatillinen koulutus; ylioppilas-, ammattikorkeakoulu- ja yliopistotutkinnot, työllisyyskurssikoulutukset (kouljat=2), aikuiskoulutuksen jatkolinjat (kouljat=9)'' then 1
						else 0
					end
,[Ikä 10v] = case 
				when d18.ika >= ''15'' and d18.ika <= ''24'' then ''15-24-vuotiaat''
				when d18.ika >= ''25'' and d18.ika <= ''34'' then ''25-34-vuotiaat''
				when d18.ika >= ''35'' and d18.ika <= ''44'' then ''35-44-vuotiaat''
				when d18.ika >= ''45'' and d18.ika <= ''54'' then ''45-54-vuotiaat''
				when d18.ika >= ''55'' and d18.ika <= ''64'' then ''55-64-vuotiaat''
				when d18.ika >= ''65'' and d18.ika <= ''74'' then ''65-74-vuotiaat''
				when d18.ika > ''74'' then ''yli 74-vuotiaat''
				else ''Tuntematon''
			end
,[Ikä 10v jarj] = case 
					when d18.ika >= ''15'' and d18.ika <= ''24'' then 1
					when d18.ika >= ''25'' and d18.ika <= ''34'' then 2
					when d18.ika >= ''35'' and d18.ika <= ''44'' then 3
					when d18.ika >= ''45'' and d18.ika <= ''54'' then 4
					when d18.ika >= ''55'' and d18.ika <= ''64'' then 5
					when d18.ika >= ''65'' and d18.ika <= ''74'' then 6
					when d18.ika > ''74'' then 7
					else 8
				  end
,d22.jarjestys as "amkouljarj"

--ruotsi
,[Tilastointivuosi] as Statistikår
,d1.koulutusala2002_SV as "Utbildningsområde (2002)"
,d1.opintoala2002_SV as "Studieområde (2002)"
,d1.koulutus_SV as "Utbildningsbenämning"
,d1.koulutusaste2002_SV as "Utbildningsnivå (2002)"
,d1.opintoala1995_SV as "Utbildningsområde (1995)"
,d2.vuosiselite_SV as "År då utbildningen avlagts"
,d3.vuosiselite_SV as "Födelseår"
,d4.oppisopimuskoulutus_SV as "Läroavtalsutbildning"
,d5.sukupuoli_SV as "Kön"
,d6.ika5v_SV as "Åldersgrupp"
,d7.aidinkieli_versio1_SV as "Modersmål"
,d8.eumaa_SV as "Medborgare i ett EU-land"
,d9.etamaa_SV as "Medborgare i ett EES-land"
,d10.pohjoismaa_SV as "Medborgare i ett nordiskt land"
,d11.avi_SV as "RFV-område där examen avlagts"
,d11.ely_SV as "NMT-område där examen avlagts"
,d11.maakunta_SV as "Landskap där examen avlagts"
,d12.avi_SV as "Bostadsortens RFV-område"
,d12.ely_SV as "Bostadsortens NTM-område"
,d12.maakunta_SV as "Bostadslandskap"
,d13.kansalaisuus_versio1_SV as "Medborgarskap"
,d18.ika_SV as "Ålder"
--englanti
,[Tilastointivuosi] as "Statistical year"
,d1.koulutusala2002_EN as "Field of education (2002)"
,d1.opintoala2002_EN as "Subfield of ed. (2002)"
,d1.koulutus_EN as "Name of education"
,d1.koulutusaste2002_EN as "Level of education (2002)"
,d1.opintoala1995_EN as "Field of education (1995)"
,d2.vuosiselite_EN as "Graduation year"
,d3.vuosiselite_EN as "Birth year"
,d4.oppisopimuskoulutus_EN as "Apprenticeship training"
,d5.sukupuoli_EN as "Gender"
,d6.ika5v_EN as "Age group"
,d7.aidinkieli_versio1_EN as "Mother tongue"
,d8.eumaa_EN as "Citizen of EU nation"
,d9.etamaa_EN as "Citizen of EEA nation"
,d10.pohjoismaa_EN as "Citizen of a nordic nation"
,d11.avi_EN as "AVI area of degree/qualif."
,d11.ely_EN as "ELY area of degree/qualif."
,d11.maakunta_EN as "Region of degree/qualif."
,d12.avi_EN as "AVI area of residence"
,d12.ely_EN as "ELY area of residence"
,d12.maakunta_EN as "Region of residence"
,d13.kansalaisuus_versio1_EN as "Nationality"
,d18.ika_EN as "Age"
--koodit
,d12.maakunta_koodi as ''Koodit Asuinmaakunta''
,d1.koulutusaste2002_koodi as ''Koodit Koulutusaste 2002''
,d1.koulutusala2002_koodi as ''Koodit Koulutusala 2002''
,d1.opintoala1995_koodi as ''Koodit Koulutusala 1995''
,d1.opintoala2002_koodi as ''Koodit Opintoala 2002''
,d1.koulutus_koodi as ''Koodit Koulutusnimike''
,d11.maakunta_koodi as ''Koodit Tutkinnon suoritusmaakunta''
--isced
,d1.iscle2011 as "Koulutusaste, taso 1"
,d1.Koulutusaste_taso2 as "Koulutusaste, taso 2"
,d1.iscfibroad2013 as "Koulutusala, taso 1"
,d1.iscfinarrow2013 as "Koulutusala, taso 2"
,d1.iscfi2013 as "Koulutusala, taso 3"
,d1.OKM_ohjauksen_ala as "OKM ohjauksen ala, korkeak."
,d1.iscle2011_SV as "Utbildn.nivå, nivå 1"
,d1.Koulutusaste_taso2_SV as "Utbildn.nivå, nivå 2"
,d1.iscfibroad2013_SV as "Utbildn.område, nivå 1"
,d1.iscfinarrow2013_SV as "Utbildn.område, nivå 2"
,d1.iscfi2013_SV as "Utbildn.område, nivå 3"
,d1.OKM_ohjauksen_ala_SV as "UKM-styrningsområde, högskolor"
,d1.iscle2011_EN as "Level of ed., tier 1"
,d1.Koulutusaste_taso2_EN as "Level of ed., tier 2"
,d1.iscfibroad2013_EN as "Field of education, tier 1"
,d1.iscfinarrow2013_EN as "Field of education, tier 2"
,d1.iscfi2013_EN as "Field of education, tier 3"
,d1.OKM_ohjauksen_ala_EN as "Field of ed., HE steering"
,d1.jarjestys_iscle2011 as jarj_isced_koulast1
,d1.jarjestys_Koulutusaste_taso2 as jarj_isced_koulast2
,d1.jarjestys_iscfibroad2013 as jarj_isced_koulala1
,d1.jarjestys_iscfinarrow2013 as jarj_isced_koulala2
,d1.jarjestys_iscfi2013 as jarj_isced_koulala3
,d1.jarjestys_OKM_ohjauksen_ala as jarj_isced_okmohjaus1
,d1.iscle2011_koodi as "Koodit Koulutusaste, taso 1"
,d1.Koulutusaste_taso2_koodi as "Koodit Koulutusaste, taso 2"
,d1.iscfibroad2013_koodi as "Koodit Koulutusala, taso 1"
,d1.iscfinarrow2013_koodi as "Koodit Koulutusala, taso 2"
,d1.iscfi2013_koodi as "Koodit Koulutusala, taso 3"
,d1.OKM_ohjauksen_ala_koodi as "Koodit OKM ohjauksen ala, korkeak."

FROM dbo.f_VKP_4_2_Vaeston_koulutusrakenne_ja_paaasiallinen_toiminta
	  JOIN d_koulutusluokitus d1 on d1.id = koulutusluokitus_id
	  JOIN d_kausi d2 on d2.kausi_id = tutkinnon_suoritusvuosi_id
	  JOIN d_kausi d3 on d3.kausi_id = syntymavuosi_id
	  JOIN d_oppisopimuskoulutus d4 on d4.id = oppisopimuskoulutus_id
	  JOIN d_sukupuoli d5 on d5.id = sukupuoli_id
	  JOIN d_ika d6 on d6.id = vaeston_ika_5v_id
	  JOIN d_aidinkieli_versio1 d7 on d7.id = aidinkieli_versio1_id
	  JOIN d_valtio d8 on d8.id = eumaa_id
	  JOIN d_valtio d9 on d9.id = etamaa_id
	  JOIN d_pohjoismaa d10 on d10.id = pohjoismaa_id
	  JOIN d_alueluokitus d11 on d11.id = tutkinnon_suoritusmaakunta_id
	  JOIN d_alueluokitus d12 on d12.id = asuinmaakunta_id
	  JOIN d_kansalaisuus_versio1 d13 on d13.id = kansalaisuus_versio1_id
	  JOIN d_ika d18 on d18.id = vaeston_ika_1v_id
	  JOIN d_ika d19 on d19.id = tutkinnon_suoritusika_1v_id
	  JOIN d_ika d20 on d20.id = tutkinnon_ika_1v_id
	  JOIN d_koulutusmuoto d21 on d21.id = koulutusmuoto_id
	  JOIN d_ammatillisen_koulutuksen_koulutuslaji_tutkintorekisterissa d22 on d22.id = ammatillisen_koulutuksen_koulutuslaji_tutkintorekisterissa_id
	  WHERE aineisto = ''R''












' 
GO
/****** Object:  View [dbo].[v_f_vaeston_koulutusrakenne_ja_paaasiallinen_toiminta]    Script Date: 21.6.2017 10:17:26 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_f_vaeston_koulutusrakenne_ja_paaasiallinen_toiminta]'))
EXEC dbo.sp_executesql @statement = N'







CREATE VIEW [dbo].[v_f_vaeston_koulutusrakenne_ja_paaasiallinen_toiminta]
AS
Select [15 vuotta täyttäneen väestön lukumäärä2] = lukumaara
,[Tilastointivuosi] as Tilastovuosi
,d1.koulutusala2002 as "Koulutusala"
,d1.jarjestys_koulutusala2002 as "koul02"
,d1.opintoala2002 as "Opintoala"
,d1.jarjestys_opintoala2002 as "op02"
,d1.koulutus as "Koulutusnimike"
,d1.koulutusaste2002 as "Koulutusaste"
,d1.jarjestys_koulutusaste2002 as "kast02"
,d1.opintoala1995 as "Koulutusala (95 luokitus)"
,d1.jarjestys_opintoala1995 as "op95"
,d2.vuosiselite as "Tutkinnon suoritusvuosi"
,d2.jarjestys as "tutksuorvj"
,d3.vuosiselite as "Syntymävuosi"
,d3.jarjestys as "syntjarj"
,d4.oppisopimuskoulutus as "Oppisopimuskoulutus"
,d4.jarjestys as "opsopj"
,d5.sukupuoli as "Sukupuoli"
,d6.ika5v as "Ikäryhmä"
,d6.jarjestys_ika5v
,d7.aidinkieli_versio1 as "Äidinkieli"
,d7.jarjestys as "aid_jarj"
,d8.eumaa as "EU-maan kansalainen"
,d8.jarjestys_eumaa as "eujarj"
,d8.eumaa_koodi as "eukoodi"
,d9.etamaa as "ETA-maan kansalainen"
,d9.jarjestys_etamaa as "etajarj"
,d9.etamaa_koodi as "etakoodi"
,d10.pohjoismaa as "Pohjoismaan kansalainen"
,d10.jarjestys as "pohjjarj"
,d11.avi as "Tutk. suorituspaikan AVI"
,d11.jarjestys_avi as "suorjavi"
,d11.ely as "Tutk. suorituspaikan ELY"
,d11.jarjestys_ely as "suorjely"
,d11.maakunta as "Tutk. suoritusmaakunta"
,d11.jarjestys_maakunta as "suorjmaak"
,d12.avi as "Asuinalueen AVI"
,d12.jarjestys_avi as "asavij"
,d12.ely as "Asuinalueen ELY"
,d12.jarjestys_ely as "aselyj"
,d12.maakunta as "Asuinmaakunta"
,d12.jarjestys_maakunta as "asmaakj"
,d13.kansalaisuus_versio1 as "Kansalaisuus"
,d13.jarjestys as "kansjarj"
,d14.paaasiallinen_toiminta_versio2 as "Pääasiallinen toiminta"
,d14.jarjestys as "pastoim"
,d14.paaasiallinen_toiminta_versio2_koodi
,d15.ammattiluokitus_2010_paataso as "Ammattiryhmä"
,d15.jarjestys_ammattiluokitus_2010_paataso as "am2010paajarj"
,d15.ammattiluokitus_2010_2_taso as "Ammatti"
,d15.jarjestys_ammattiluokitus_2010_taso2 as "am2010taso2jarj"
,d16.tyossakayntitilaston_tyonantajasektori as "Työnantajasektori"
,d16.jarjestys as "tantj"
,d17.ammattiluokitus_2001 as "Ammatti (2001 luokitus)"
,d17.jarjestys as "am2001jarj"
,d18.ika as "Ikä"
,d18.jarjestys_ika as "ikajarj"
,d19.ika as "Tutkinnon suoritusikä"
,d19.jarjestys_ika as "suorikajarj"
,d20.ika as "Tutkinnon ikä"
,d20.jarjestys_ika as "tutkikajarj"
,d21.koulutusmuoto as "Koulutusmuoto"
,d21.jarjestys as "koulmuotojarj"
,d22.ammatillisen_koulutuksen_koulutuslaji_tutkintorekisterissa as "Amm. koul. koulutuslaji"
,d22.jarjestys as "amkouljarj"
--ruotsi
,[Tilastointivuosi] as Statistikår
,d1.koulutusala2002_SV as "Utbildningsområde (2002)"
,d1.opintoala2002_SV as "Studieområde (2002)"
,d1.koulutus_SV as "Utbildningsbenämning"
,d1.koulutusaste2002_SV as "Utbildningsnivå (2002)"
,d1.opintoala1995_SV as "Utbildningsområde (1995)"
,d2.vuosiselite_SV as "År då utbildningen avlagts"
,d3.vuosiselite_SV as "Födelseår"
,d4.oppisopimuskoulutus_SV as "Läroavtalsutbildning"
,d5.sukupuoli_SV as "Kön"
,d6.ika5v_SV as "Åldersgrupp"
,d7.aidinkieli_versio1_SV as "Modersmål"
,d8.eumaa_SV as "Medborgare i ett EU-land"
,d9.etamaa_SV as "Medborgare i ett EES-land"
,d10.pohjoismaa_SV as "Medborgare i ett nordiskt land"
,d11.avi_SV as "RFV-område där examen avlagts"
,d11.ely_SV as "NMT-område där examen avlagts"
,d11.maakunta_SV as "Landskap där examen avlagts"
,d12.avi_SV as "Bostadsortens RFV-område"
,d12.ely_SV as "Bostadsortens NTM-område"
,d12.maakunta_SV as "Bostadslandskap"
,d13.kansalaisuus_versio1_SV as "Medborgarskap"
,d14.paaasiallinen_toiminta_versio2_SV as "Huvudsaklig verksamhet"
,d15.ammattiluokitus_2010_paataso_SV as "Yrkesgrupp"
,d15.ammattiluokitus_2010_2_taso_SV as "Yrke"
,d16.tyossakayntitilaston_tyonantajasektori_SV as "Arbetsgivarens sektor"
,d17.ammattiluokitus_2001_SV as "Yrke (2001)"
,d18.ika_SV as "Ålder"
--,d19.ika_SV as "Tutkinnon suoritusikä"
--,d20.ika_SV as "Tutkinnon ikä"
--,d21.koulutusmuoto_SV as "Koulutusmuoto"
--,d22.ammatillisen_koulutuksen_koulutuslaji_tutkintorekisterissa_SV as "Amm. koul. koulutuslaji"
--englanti
,[Tilastointivuosi] as "Statistical year"
,d1.koulutusala2002_EN as "Field of education (2002)"
,d1.opintoala2002_EN as "Subfield of ed. (2002)"
,d1.koulutus_EN as "Name of education"
,d1.koulutusaste2002_EN as "Level of education (2002)"
,d1.opintoala1995_EN as "Field of education (1995)"
,d2.vuosiselite_EN as "Graduation year"
,d3.vuosiselite_EN as "Birth year"
,d4.oppisopimuskoulutus_EN as "Apprenticeship training"
,d5.sukupuoli_EN as "Gender"
,d6.ika5v_EN as "Age group"
,d7.aidinkieli_versio1_EN as "Mother tongue"
,d8.eumaa_EN as "Citizen of EU nation"
,d9.etamaa_EN as "Citizen of EEA nation"
,d10.pohjoismaa_EN as "Citizen of a nordic nation"
,d11.avi_EN as "AVI area of degree/qualif."
,d11.ely_EN as "ELY area of degree/qualif."
,d11.maakunta_EN as "Region of degree/qualif."
,d12.avi_EN as "AVI area of residence"
,d12.ely_EN as "ELY area of residence"
,d12.maakunta_EN as "Region of residence"
,d13.kansalaisuus_versio1_EN as "Nationality"
,d14.paaasiallinen_toiminta_versio2_EN as "Main type of activity"
,d15.ammattiluokitus_2010_paataso_EN as "Profession group"
,d15.ammattiluokitus_2010_2_taso_EN as "Profession"
,d16.tyossakayntitilaston_tyonantajasektori_EN as "Employer''s sector"
,d17.ammattiluokitus_2001_EN as "Profession (2001)"
,d18.ika_EN as "Age"
--,d19.ika_EN as "Tutkinnon suoritusikä"
--,d20.ika_EN as "Tutkinnon ikä"
--,d21.koulutusmuoto_EN as "Koulutusmuoto"
--,d22.ammatillisen_koulutuksen_koulutuslaji_tutkintorekisterissa_EN as "Amm. koul. koulutuslaji"
--koodit
,d12.maakunta_koodi as ''Koodit Asuinmaakunta''
,d1.koulutusaste2002_koodi as ''Koodit Koulutusaste 2002''
,d1.koulutusala2002_koodi as ''Koodit Koulutusala 2002''
,d1.opintoala1995_koodi as ''Koodit Koulutusala 1995''
,d1.opintoala2002_koodi as ''Koodit Opintoala 2002''
,d1.koulutus_koodi as ''Koodit Koulutusnimike''
,d11.maakunta_koodi as ''Koodit Tutkinnon suoritusmaakunta''
--isced
,d1.iscle2011 as "Koulutusaste, taso 1"
,d1.Koulutusaste_taso2 as "Koulutusaste, taso 2"
,d1.iscfibroad2013 as "Koulutusala, taso 1"
,d1.iscfinarrow2013 as "Koulutusala, taso 2"
,d1.iscfi2013 as "Koulutusala, taso 3"
,d1.OKM_ohjauksen_ala as "OKM ohjauksen ala, korkeak."
,d1.iscle2011_SV as "Utbildn.nivå, nivå 1"
,d1.Koulutusaste_taso2_SV as "Utbildn.nivå, nivå 2"
,d1.iscfibroad2013_SV as "Utbildn.område, nivå 1"
,d1.iscfinarrow2013_SV as "Utbildn.område, nivå 2"
,d1.iscfi2013_SV as "Utbildn.område, nivå 3"
,d1.OKM_ohjauksen_ala_SV as "UKM-styrningsområde, högskolor"
,d1.iscle2011_EN as "Level of ed., tier 1"
,d1.Koulutusaste_taso2_EN as "Level of ed., tier 2"
,d1.iscfibroad2013_EN as "Field of education, tier 1"
,d1.iscfinarrow2013_EN as "Field of education, tier 2"
,d1.iscfi2013_EN as "Field of education, tier 3"
,d1.OKM_ohjauksen_ala_EN as "Field of ed., HE steering"
,d1.jarjestys_iscle2011 as jarj_isced_koulast1
,d1.jarjestys_Koulutusaste_taso2 as jarj_isced_koulast2
,d1.jarjestys_iscfibroad2013 as jarj_isced_koulala1
,d1.jarjestys_iscfinarrow2013 as jarj_isced_koulala2
,d1.jarjestys_iscfi2013 as jarj_isced_koulala3
,d1.jarjestys_OKM_ohjauksen_ala as jarj_isced_okmohjaus1
,d1.iscle2011_koodi as "Koodit Koulutusaste, taso 1"
,d1.Koulutusaste_taso2_koodi as "Koodit Koulutusaste, taso 2"
,d1.iscfibroad2013_koodi as "Koodit Koulutusala, taso 1"
,d1.iscfinarrow2013_koodi as "Koodit Koulutusala, taso 2"
,d1.iscfi2013_koodi as "Koodit Koulutusala, taso 3"
,d1.OKM_ohjauksen_ala_koodi as "Koodit OKM ohjauksen ala, korkeak."

FROM dbo.f_VKP_4_2_Vaeston_koulutusrakenne_ja_paaasiallinen_toiminta
	  JOIN d_koulutusluokitus d1 on d1.id = koulutusluokitus_id
	  JOIN d_kausi d2 on d2.kausi_id = tutkinnon_suoritusvuosi_id
	  JOIN d_kausi d3 on d3.kausi_id = syntymavuosi_id
	  JOIN d_oppisopimuskoulutus d4 on d4.id = oppisopimuskoulutus_id
	  JOIN d_sukupuoli d5 on d5.id = sukupuoli_id
	  JOIN d_ika d6 on d6.id = vaeston_ika_5v_id
	  JOIN d_aidinkieli_versio1 d7 on d7.id = aidinkieli_versio1_id
	  JOIN d_valtio d8 on d8.id = eumaa_id
	  JOIN d_valtio d9 on d9.id = etamaa_id
	  JOIN d_pohjoismaa d10 on d10.id = pohjoismaa_id
	  JOIN d_alueluokitus d11 on d11.id = tutkinnon_suoritusmaakunta_id
	  JOIN d_alueluokitus d12 on d12.id = asuinmaakunta_id
	  JOIN d_kansalaisuus_versio1 d13 on d13.id = kansalaisuus_versio1_id
	  JOIN d_paaasiallinen_toiminta_versio2 d14 on d14.paaasiallinen_toiminta_versio2_koodi = paaasiallinen_toiminta_versio6
	  JOIN d_ammattiluokitus_2010 d15 on d15.id = ammattiluokitus_2010_id
	  JOIN d_tyossakayntitilaston_tyonantajasektori d16 on d16.id = tyossakayntitilaston_tyonantajasektori_id
	  JOIN d_ammattiluokitus_2001 d17 on d17.id = ammattiluokitus_2001_id
	  JOIN d_ika d18 on d18.id = vaeston_ika_1v_id
	  JOIN d_ika d19 on d19.id = tutkinnon_suoritusika_1v_id
	  JOIN d_ika d20 on d20.id = tutkinnon_ika_1v_id
	  JOIN d_koulutusmuoto d21 on d21.id = koulutusmuoto_id
	  JOIN d_ammatillisen_koulutuksen_koulutuslaji_tutkintorekisterissa d22 on d22.id = ammatillisen_koulutuksen_koulutuslaji_tutkintorekisterissa_id
	  WHERE (tilastointivuosi in(''2009'',''2010'',''2011'',''2012'',''2013'') and aineisto = ''L'') or (tilastointivuosi = ''2014'' and aineisto = ''P'')









' 
GO
/****** Object:  View [dbo].[v_vuosikello]    Script Date: 21.6.2017 10:17:26 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_vuosikello]'))
EXEC dbo.sp_executesql @statement = N'


/****** Script for SelectTopNRows command from SSMS  ******/

CREATE VIEW [dbo].[v_vuosikello] AS

/* Jarmo CSC 14.8.2015
Palautetaan kuluvan kuukauden alusta 12 kuukautta eteenpäin uusien tietojen julkaisuajankohdat
Julkaisuajankohdat haetaan manuaalisen koodiston aineisto-, kuutio- ja raporttitiedoista.

Select * from VipunenTK.dbo.v_vuosikello order by julkaisupvm_Vipuseen
*/

Select 
	julkaisukuukausi_Vipuseen
	,julkaisupvm_Vipuseen
	,sektori = Case when left(sektori,1)=''#'' then ''Tuntematon'' else sektori end
	,kokonaisuus = Case when left(kokonaisuus,1)=''#'' then ''Tuntematon'' else kokonaisuus end
	,julkaisun_tilastovuosi
	,raporttien_lkm = count(*)
from (
SELECT [aineisto_nimi]
      ,[Vipunen_aineisto].[aineisto_avain]
      ,[aineistoryhma]
      ,[aineisto_julkaisukuukausi]
	  ,julkaisukuukausi_Vipuseen = Case aineisto_julkaisukuukausi
		when ''1'' then ''Helmikuu''
		when ''2'' then ''Maaliskuu''
		when ''3'' then ''Huhtikuu''
		when ''4'' then ''Toukokuu''
		when ''5'' then ''Kesäkuu''
		when ''6'' then ''Heinäkuu''
		when ''7'' then ''Elokuu''
		when ''8'' then ''Syyskuu''
		when ''9'' then ''Lokakuu''
		when ''10'' then ''Marraskuu''
		when ''11'' then ''Joulukuu''
		when ''12'' then ''Tammikuu''
		else ''Ei tiedossa'' end
	  ,julkaisuaika_Vipuseen = Case aineisto_julkaisukuukausi
		when ''1'' then ''8.2.''
		when ''2'' then ''8.3.''
		when ''3'' then ''8.4.''
		when ''4'' then ''8.5.''
		when ''5'' then ''8.6.''
		when ''6'' then ''8.7.''
		when ''7'' then ''8.8.''
		when ''8'' then ''8.9.''
		when ''9'' then ''8.10.''
		when ''10'' then ''8.11.''
		when ''11'' then ''8.12.''
		when ''12'' then ''8.1.''
		else ''Ei tiedossa'' end
	  ,julkaisupvm_Vipuseen = Cast(Case 
		when nullif(aineisto_julkaisukuukausi, '''') is null 
			then NULL
		when aineisto_julkaisukuukausi = ''12'' 
			then cast(case when month(getdate())=12 then year(dateadd(yyyy,2,getdate())) else year(dateadd(yyyy,1,getdate())) end as char(4)) + ''-01-08''
		else cast(case when month(getdate())>cast(aineisto_julkaisukuukausi as int)+1 then year(dateadd(yyyy,1,getdate())) else year(getdate()) end as char(4))
				+ case aineisto_julkaisukuukausi 
					when ''1'' then ''-02-08''
					when ''2'' then ''-03-08''
					when ''3'' then ''-04-08''
					when ''4'' then ''-05-08''
					when ''5'' then ''-06-08''
					when ''6'' then ''-07-08''
					when ''7'' then ''-08-08''
					when ''8'' then ''-09-08''
					when ''9'' then ''-10-08''
					when ''10'' then ''-11-08''
					when ''11'' then ''-12-08''
				  end
		end
		as date)
      ,[aineisto_tilastovuosi]
	  ,julkaisun_tilastovuosi = year(getdate()) + [aineisto_tilastovuosi]
	  ,[Vipunen_raportti].sektori
	  ,[Vipunen_raportti].kokonaisuus

  FROM [VipunenTK_lisatiedot].[dbo].[Vipunen_aineisto]

  JOIN [VipunenTK_lisatiedot].[dbo].[Vipunen_aineisto_kuutio]
	ON [Vipunen_aineisto_kuutio].aineisto_avain = [Vipunen_aineisto].aineisto_avain

  JOIN [VipunenTK_lisatiedot].[dbo].[Vipunen_raportti]
	ON [Vipunen_raportti].kuutio_avain = [Vipunen_aineisto_kuutio].kuutio_avain

  ) data

  WHERE julkaisupvm_Vipuseen is not null
  --and sektori = ''Esi- ja perusopetus''
  --and sektori = ''Lukiokoulutus''
  
  GROUP BY
  	julkaisukuukausi_Vipuseen
	,julkaisupvm_Vipuseen
	,sektori
	,kokonaisuus
	,julkaisun_tilastovuosi

  --order by data.julkaisupvm_Vipuseen



' 
GO
IF NOT EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_DiagramPane1' , N'SCHEMA',N'dbo', N'VIEW',N'v_d_aloittaneiden_lapaisy_aikamuuttujat', NULL,NULL))
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[40] 4[20] 2[20] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 1440
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'v_d_aloittaneiden_lapaisy_aikamuuttujat'
GO
IF NOT EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_DiagramPaneCount' , N'SCHEMA',N'dbo', N'VIEW',N'v_d_aloittaneiden_lapaisy_aikamuuttujat', NULL,NULL))
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'v_d_aloittaneiden_lapaisy_aikamuuttujat'
GO
IF NOT EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_DiagramPane1' , N'SCHEMA',N'dbo', N'VIEW',N'v_d_aloittaneiden_lapaisy_henkilomuuttujat', NULL,NULL))
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[40] 4[20] 2[20] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
      Begin ColumnWidths = 13
         Width = 284
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 1440
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'v_d_aloittaneiden_lapaisy_henkilomuuttujat'
GO
IF NOT EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_DiagramPaneCount' , N'SCHEMA',N'dbo', N'VIEW',N'v_d_aloittaneiden_lapaisy_henkilomuuttujat', NULL,NULL))
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'v_d_aloittaneiden_lapaisy_henkilomuuttujat'
GO
IF NOT EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_DiagramPane1' , N'SCHEMA',N'dbo', N'VIEW',N'v_f_vaeston_koulutusrakenne', NULL,NULL))
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[40] 4[20] 2[20] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "f_VKP_4_2_Vaeston_koulutusrakenne_ja_paaasiallinen_toiminta (dbo)"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 136
               Right = 450
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "d1"
            Begin Extent = 
               Top = 6
               Left = 488
               Bottom = 136
               Right = 715
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "d4"
            Begin Extent = 
               Top = 6
               Left = 753
               Bottom = 136
               Right = 992
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "d5"
            Begin Extent = 
               Top = 6
               Left = 1030
               Bottom = 136
               Right = 1206
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "d6"
            Begin Extent = 
               Top = 138
               Left = 38
               Bottom = 268
               Right = 208
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "d7"
            Begin Extent = 
               Top = 138
               Left = 246
               Bottom = 268
               Right = 459
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "d8"
            Begin Extent = 
               Top = 138
               Left = 497
               Bottom = 268
               Right = 687
            End
    ' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'v_f_vaeston_koulutusrakenne'
GO
IF NOT EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_DiagramPane2' , N'SCHEMA',N'dbo', N'VIEW',N'v_f_vaeston_koulutusrakenne', NULL,NULL))
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane2', @value=N'        DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "d9"
            Begin Extent = 
               Top = 138
               Left = 725
               Bottom = 268
               Right = 915
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "d10"
            Begin Extent = 
               Top = 138
               Left = 953
               Bottom = 268
               Right = 1139
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "d11"
            Begin Extent = 
               Top = 270
               Left = 38
               Bottom = 400
               Right = 321
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "d12"
            Begin Extent = 
               Top = 270
               Left = 359
               Bottom = 400
               Right = 642
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "d13"
            Begin Extent = 
               Top = 270
               Left = 680
               Bottom = 400
               Right = 912
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "d18"
            Begin Extent = 
               Top = 270
               Left = 950
               Bottom = 400
               Right = 1120
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "d19"
            Begin Extent = 
               Top = 402
               Left = 38
               Bottom = 532
               Right = 208
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "d20"
            Begin Extent = 
               Top = 402
               Left = 246
               Bottom = 532
               Right = 416
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "d21"
            Begin Extent = 
               Top = 402
               Left = 454
               Bottom = 532
               Right = 660
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "d22"
            Begin Extent = 
               Top = 402
               Left = 698
               Bottom = 532
               Right = 1130
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
      Begin ColumnWidths = 9
         Width = 284
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 1440
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'v_f_vaeston_koulutusrakenne'
GO
IF NOT EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_DiagramPaneCount' , N'SCHEMA',N'dbo', N'VIEW',N'v_f_vaeston_koulutusrakenne', NULL,NULL))
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=2 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'v_f_vaeston_koulutusrakenne'
GO
IF NOT EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_DiagramPane1' , N'SCHEMA',N'dbo', N'VIEW',N'v_f_vaeston_koulutusrakenne_ja_paaasiallinen_toiminta', NULL,NULL))
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[40] 4[20] 2[20] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "f_VKP_4_2_Vaeston_koulutusrakenne_ja_paaasiallinen_toiminta"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 136
               Right = 450
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "d1"
            Begin Extent = 
               Top = 138
               Left = 38
               Bottom = 268
               Right = 265
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "d4"
            Begin Extent = 
               Top = 270
               Left = 38
               Bottom = 400
               Right = 277
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "d5"
            Begin Extent = 
               Top = 402
               Left = 38
               Bottom = 532
               Right = 214
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "d6"
            Begin Extent = 
               Top = 138
               Left = 303
               Bottom = 268
               Right = 473
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "d7"
            Begin Extent = 
               Top = 402
               Left = 252
               Bottom = 532
               Right = 465
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "d8"
            Begin Extent = 
               Top = 534
               Left = 38
               Bottom = 664
               Right = 228
            End
         ' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'v_f_vaeston_koulutusrakenne_ja_paaasiallinen_toiminta'
GO
IF NOT EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_DiagramPane2' , N'SCHEMA',N'dbo', N'VIEW',N'v_f_vaeston_koulutusrakenne_ja_paaasiallinen_toiminta', NULL,NULL))
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane2', @value=N'   DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "d9"
            Begin Extent = 
               Top = 534
               Left = 266
               Bottom = 664
               Right = 456
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "d10"
            Begin Extent = 
               Top = 666
               Left = 38
               Bottom = 796
               Right = 224
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "d11"
            Begin Extent = 
               Top = 798
               Left = 38
               Bottom = 928
               Right = 321
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "d12"
            Begin Extent = 
               Top = 930
               Left = 38
               Bottom = 1060
               Right = 321
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "d13"
            Begin Extent = 
               Top = 1062
               Left = 38
               Bottom = 1192
               Right = 270
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "d14"
            Begin Extent = 
               Top = 6
               Left = 488
               Bottom = 136
               Right = 772
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "d15"
            Begin Extent = 
               Top = 6
               Left = 810
               Bottom = 136
               Right = 1050
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "d16"
            Begin Extent = 
               Top = 138
               Left = 511
               Bottom = 268
               Right = 835
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "d17"
            Begin Extent = 
               Top = 138
               Left = 873
               Bottom = 268
               Right = 1113
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "d18"
            Begin Extent = 
               Top = 666
               Left = 262
               Bottom = 796
               Right = 432
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "d19"
            Begin Extent = 
               Top = 1194
               Left = 38
               Bottom = 1324
               Right = 208
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "d20"
            Begin Extent = 
               Top = 1194
               Left = 246
               Bottom = 1324
               Right = 416
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "d21"
            Begin Extent = 
               Top = 1326
               Left = 38
               Bottom = 1456
               Right = 244
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "d22"
            Begin Extent = 
               Top = 1458
               Left = 38
               Bottom = 1588
               Right = 470
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin D' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'v_f_vaeston_koulutusrakenne_ja_paaasiallinen_toiminta'
GO
IF NOT EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_DiagramPane3' , N'SCHEMA',N'dbo', N'VIEW',N'v_f_vaeston_koulutusrakenne_ja_paaasiallinen_toiminta', NULL,NULL))
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane3', @value=N'ataPane = 
      Begin ParameterDefaults = ""
      End
      Begin ColumnWidths = 61
         Width = 284
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 2310
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 1440
         Alias = 3030
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'v_f_vaeston_koulutusrakenne_ja_paaasiallinen_toiminta'
GO
IF NOT EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_DiagramPaneCount' , N'SCHEMA',N'dbo', N'VIEW',N'v_f_vaeston_koulutusrakenne_ja_paaasiallinen_toiminta', NULL,NULL))
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=3 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'v_f_vaeston_koulutusrakenne_ja_paaasiallinen_toiminta'
GO

USE [ANTERO]